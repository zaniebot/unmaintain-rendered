<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feat(clap-complete/unstable-dynamic): add '~' to HOME dir completion support - clap-rs/clap #5998</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>feat(clap-complete/unstable-dynamic): add &#x27;~&#x27; to HOME dir completion support</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/pull/5998">#5998</a>
        opened by <a href="https://github.com/eatradish">@eatradish</a>
        on 2025-05-10 15:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/eatradish">@eatradish</a></div>
            <div class="timeline-body"><p>if input starts with &#x27;~&#x27; will complete to <code>/home/USER</code></p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-05-11 00:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/src/engine/custom.rs</code>:283 on 2025-05-11 00:40</div>
            <div class="timeline-body"><p>This is marked as unix-only but the dep is always added</p>
<p>However, should we support this on Windows?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-05-11 00:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/src/engine/custom.rs</code>:283 on 2025-05-11 00:41</div>
            <div class="timeline-body"><p>Technically, there are other variants of <code>~</code> expansion.  Should we support that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-05-11 00:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/src/engine/custom.rs</code>:298 on 2025-05-11 00:41</div>
            <div class="timeline-body"><p>Why are we changing this to be more restrictive?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-05-11 00:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/src/engine/custom.rs</code>:280 on 2025-05-11 00:42</div>
            <div class="timeline-body"><p>We shouldn&#x27;t be doing this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-05-11 00:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/Cargo.toml</code>:43 on 2025-05-11 00:43</div>
            <div class="timeline-body"><p>With <code>std::env::home_dir</code> being undeprecated, we should be using this through a polyfll.  I&#x27;ll need to go create one before this can move forward.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-05-11 00:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/Cargo.toml</code>:43 on 2025-05-11 00:43</div>
            <div class="timeline-body"><p>(if it wasn&#x27;t for that, I&#x27;d be hesitant to add this out of question of whether the extra dep is worth it)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/eatradish">@eatradish</a> reviewed on 2025-05-11 03:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/eatradish">@eatradish</a> on <code>clap_complete/src/engine/custom.rs</code>:298 on 2025-05-11 03:38</div>
            <div class="timeline-body"><p>There doesn&#x27;t seem to be a way for me to get <code>&amp;OsStr</code> directly from <code>String</code>, maybe I should? (The reason for the change to String is that the <code>replace_range</code> method is only available for <code>String</code>)</p>
<pre><code>let mut new_current = OsString::new();
new_current.write_str(&amp;current).ok();

let mut candidates = complete_path(&amp;new_current, current_dir, filter);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/eatradish">@eatradish</a> reviewed on 2025-05-11 03:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/eatradish">@eatradish</a> on <code>clap_complete/src/engine/custom.rs</code>:283 on 2025-05-11 03:41</div>
            <div class="timeline-body"><p>I&#x27;m not sure if this feature should be supported on Windows, as it does not seem to be used on Windows.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/eatradish">@eatradish</a> reviewed on 2025-05-11 03:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/eatradish">@eatradish</a> on <code>clap_complete/src/engine/custom.rs</code>:280 on 2025-05-11 03:44</div>
            <div class="timeline-body"><p>Maybe I should have used  <code>let mut current = current.to_string_lossy().to_string();</code> ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/eatradish">@eatradish</a> reviewed on 2025-05-11 03:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/eatradish">@eatradish</a> on <code>clap_complete/src/engine/custom.rs</code>:283 on 2025-05-11 03:47</div>
            <div class="timeline-body"><p>I&#x27;m not sure about what they are, can you explain?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/eatradish">@eatradish</a> reviewed on 2025-05-11 03:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/eatradish">@eatradish</a> on <code>clap_complete/Cargo.toml</code>:43 on 2025-05-11 03:57</div>
            <div class="timeline-body"><p>Perhaps we could copy that function from std? https://github.com/rust-lang/rust/blob/2682b88c526d493edeb2d3f2df358f44db69b73f/library/std/src/sys/unix/os.rs#L595</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 20:00:49 UTC
    </footer>
</body>
</html>
