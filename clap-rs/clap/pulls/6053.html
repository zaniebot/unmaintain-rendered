<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support default field values - clap-rs/clap #6053</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support default field values</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/pull/6053">#6053</a>
        opened by <a href="https://github.com/DJMcNab">@DJMcNab</a>
        on 2025-06-30 16:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/DJMcNab">@DJMcNab</a> on 2025-06-30 16:34</div>
            <div class="timeline-body"><p>This uses my fork of syn defined at https://github.com/dtolnay/syn/pull/1870, and is intended to validate that. This PR is not necessarily intended to merged/reviewed, as things stand. In particular, if the syn PR is never merged, this won't be the right solution.</p>
<ul>
<li>RFC: https://github.com/rust-lang/rfcs/pull/3681</li>
<li>Tracking issue: https://github.com/rust-lang/rust/issues/132162</li>
<li>Feature gate: <code>#![feature(default_field_values)]</code></li>
</ul>
<pre><code class="language-rust">#[derive(Parser)]
struct Opt {
    arg: i32 = 42,
    //       ^^^^
}
</code></pre>
<p>Some notes:</p>
<ul>
<li>Supporting default field values is frustratingly involved, because of how the support has to be hacked into syn 2.0. See the suggestion in https://github.com/dtolnay/syn/pull/1851#discussion_r1983947505 of the only way to move this forward. This will need to filter through the ecosystem if approved, which this PR is part of.</li>
<li>Testing the use of this feature in CI is hard because it requires nightly</li>
<li>There are some pretty nasty hacks in here; obviously those can be cleaned up before landing.</li>
</ul>
<p>The test can be ran with:</p>
<pre><code class="language-sh">RUSTFLAGS=&quot;--cfg=nightly&quot; cargo +nightly test --test default_field_values --features derive --features help --features usage
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:36:28 UTC
    </footer>
</body>
</html>
