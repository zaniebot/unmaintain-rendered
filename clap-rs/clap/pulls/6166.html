<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fix(clap_complete): improve powershell registration script - clap-rs/clap #6166</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fix(clap_complete): improve powershell registration script</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/clap-rs/clap/pull/6166">#6166</a>
        opened by <a href="https://github.com/fabalchemy">@fabalchemy</a>
        on 2025-10-29 22:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/fabalchemy">@fabalchemy</a> on 2025-10-29 22:28</div>
            <div class="timeline-body"><!--
Thanks for helping out!

Please link the appropriate issue from your PR.

If you don't have an issue, we'd recommend starting with one first so the PR can focus on the
implementation (unless its an obvious bug or documentation fix that will have
little conversation).
-->

<p>This PR modifies the PowerShell registration script for dynamic completions to handle the situation where the cursor is not on an partial argument. Previously, <code>clap_complete</code> would not generate any completion when hitting TAB for the first argument, and would generate a duplicate of the previous argument when present.</p>
<pre><code class="language-console">&gt; dynamic [TAB]
# tries to complete with a path
dynamic ./

&gt; dynamic --format [TAB]
# duplicates the previous argument
dynamic --format --format
</code></pre>
<p>The proposed solution is to trim the argument list at the cursor position (matching the behavior of the Fish implementation), and to add an empty argument if the word to complete is empty.</p>
<p>With these changes, both the use-cases shown above work as expected:</p>
<pre><code class="language-console">&gt; dynamic [TAB]
dynamic --

&gt; dynamic --[TAB]
--input   --format  --help

&gt; dynamic --format [TAB]
json  yaml  toml
</code></pre>
<p>Fixes https://github.com/clap-rs/clap/issues/6010</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> approved on 2025-10-29 22:33</div>
            <div class="timeline-body"></div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:36:28 UTC
    </footer>
</body>
</html>
