<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fix: added visible long flag aliases in help - clap-rs/clap #6068</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fix: added visible long flag aliases in help</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/clap-rs/clap/pull/6068">#6068</a>
        opened by <a href="https://github.com/GilShoshan94">@GilShoshan94</a>
        on 2025-07-09 23:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on 2025-07-09 23:01</div>
            <div class="timeline-body"><p>fix https://github.com/clap-rs/clap/issues/6067</p>
<p>fix https://github.com/clap-rs/clap/issues/6073</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>tests/ui/arg_required_else_help_stderr.toml</code>:12 on 2025-07-10 14:38</div>
            <div class="timeline-body"><p>The fact that no source changed in this commit suggests these commits are not atomic (tests should pass on every commit)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-07-10 14:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-07-10 14:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_builder/src/output/help_template.rs</code>:1 on 2025-07-10 14:40</div>
            <div class="timeline-body"><p><code>tests/builder/flag_subcommands.rs</code> has a test for <code>visible_short_flag_aliases</code>, could you</p>
<ul>
<li>Add a parallel test for long flag aliases?</li>
<li>Add a test for both for help output in <code>tests/builder/help.rs</code>?</li>
</ul>
<p>Like normal, ideally new tests would be added in a commit before this one and would pass on that commit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>tests/ui/arg_required_else_help_stderr.toml</code>:12 on 2025-07-10 15:20</div>
            <div class="timeline-body"><p>Oh, ok, I will squash them together as one commit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-10 15:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-10 15:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>clap_builder/src/output/help_template.rs</code>:1 on 2025-07-10 15:32</div>
            <div class="timeline-body"><p>@epage
Yes, I will add the tests, no problem.</p>
<p>I'm not sure I understand what you want with the commit/git history exactly.</p>
<p>From what I understand, you want:</p>
<ul>
<li><p><strong>1st commit</strong>: add the tests for <code>long_flag_aliases</code> in <code>tests/builder/flag_subcommands.rs</code> and <code>tests/builder/help.rs</code> and fix the tests in UI ?
This commit would result in a failed CI and that would be normal.</p>
</li>
<li><p><strong>2nd commit</strong>: add the fix in <code>clap_builder/src/output/help_template.rs</code> to shows the visible long flag aliases.
This commit would pass the CI.</p>
</li>
</ul>
<p>So in total 2 commits, one to fix and update the tests, the second to fix the source code.</p>
<p>Did I understand correctly?
Shall I do that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>tests/ui/arg_required_else_help_stderr.toml</code>:12 on 2025-07-10 15:32</div>
            <div class="timeline-body"><p>I will wait for your answer about the commits order you want (in the other comment)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-10 15:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-07-10 15:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_builder/src/output/help_template.rs</code>:1 on 2025-07-10 15:53</div>
            <div class="timeline-body"><p>Commit 1: Adds tests, <code>cargo test</code> should pass: this means the test shows the current behavior</p>
<p>Commit 2: Change behavior, update tests to reflect the change in behavior.</p>
<p>#5520 serves as an example of this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-14 19:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>clap_builder/src/output/help_template.rs</code>:1 on 2025-07-14 19:35</div>
            <div class="timeline-body"><p>Hi @epage,</p>
<p>I followed your example.
I added a test in <code>tests/builder/flag_subcommands.rs</code>.</p>
<p>I am working now on tests in <code>tests/builder/help.rs</code>.</p>
<p>Sorry for the delay, I was not available.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-14 21:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>tests/ui/arg_required_else_help_stderr.toml</code>:12 on 2025-07-14 21:58</div>
            <div class="timeline-body"><p>I fixed it, now the commits are atomic (I check that the tests pass on every commit).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-14 22:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>clap_builder/src/output/help_template.rs</code>:1 on 2025-07-14 22:01</div>
            <div class="timeline-body"><p>I add the tests on the aliases in 'tests/builder/help.rs'.</p>
<p>I also followed your instructions, 2 atomic commits, first that add the tests, the second that change the behavior + update in the tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-07-18 17:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>tests/builder/help.rs</code>:955 on 2025-07-18 17:28</div>
            <div class="timeline-body"><p>An alias functionality test isn't appropriate in this file</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-18 18:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>tests/builder/help.rs</code>:955 on 2025-07-18 18:32</div>
            <div class="timeline-body"><p>Should I move it to another file or simply remove it completely?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-07-18 18:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>tests/builder/help.rs</code>:955 on 2025-07-18 18:38</div>
            <div class="timeline-body"><p>We have a lot of existing alias tests.  If a case isn't covered, we should add a test similar to those next to where the related tests are.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-21 19:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>tests/builder/help.rs</code>:955 on 2025-07-21 19:59</div>
            <div class="timeline-body"><p>Hi,
I looked into the tests and the tests for aliases are distributed between several files:</p>
<p>For <code>Arg</code>:
-<code>tests/builder/arg_aliases_short.rs</code>
-<code>tests/builder/arg_aliases.rs</code>
It covers well everything I think regarding aliases.</p>
<p>For <code>Command</code> (on the subcommand):
-<code>tests/builder/flag_subcommands.rs</code>
-<code>tests/builder/subcommands.rs</code>
It does not 100% fully cover in my opinion as it is missing the following cases:</p>
<ul>
<li><a href="https://docs.rs/clap/4.5.41/clap/struct.Command.html#method.visible_aliases">visible_aliases</a> (but <code>visible_alias</code> is tested, but only to match the help, not tested with a <code>try_get_matches_from</code>)</li>
<li><a href="https://docs.rs/clap/4.5.41/clap/struct.Command.html#method.visible_short_flag_alias">visible_short_flag_alias</a> (but <code>visible_short_flag_aliases</code> is properly tested)</li>
<li><a href="https://docs.rs/clap/4.5.41/clap/struct.Command.html#method.visible_long_flag_alias">visible_long_flag_alias</a> (but <code>visible_long_flag_aliases</code> is properly tested)</li>
</ul>
<p>I will open an issue for that and remove this alias test from this PR so you can merge</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/GilShoshan94">@GilShoshan94</a> reviewed on 2025-07-21 21:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/GilShoshan94">@GilShoshan94</a> on <code>tests/builder/help.rs</code>:955 on 2025-07-21 21:27</div>
            <div class="timeline-body"><p>In the end, I just edited my first commit to incorporate the missing cases.
I will close the issue https://github.com/clap-rs/clap/issues/6073 as well.</p>
<p>I removed the alias functionality test from this place as you asked</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:36:28 UTC
    </footer>
</body>
</html>
