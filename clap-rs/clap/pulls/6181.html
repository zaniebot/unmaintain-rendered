<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>docs(complete): Fix instructions for sourcing PowerShell completions - clap-rs/clap #6181</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>docs(complete): Fix instructions for sourcing PowerShell completions</h1>

    <div class="meta">
        <span class="state state-merged">Merged</span>
        <a href="https://github.com/clap-rs/clap/pull/6181">#6181</a>
        opened by <a href="https://github.com/jgreitemann">@jgreitemann</a>
        on 2025-11-09 15:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/jgreitemann">@jgreitemann</a> on 2025-11-09 15:55</div>
            <div class="timeline-body"><p>The previous instructions were wrong in that they set the <code>COMPLETE</code> env var only while the <code>$PROFILE</code> script was written. This was akin to</p>
<pre><code>COMPLETE=bash echo &quot;source &lt;(your_program)&quot; &gt;&gt; ~/.bashrc</code></pre>
<p>whereas the corrected version sets <code>COMPLETE</code> as part of the <code>$PROFILE</code> script, mirroring the instructions for sourcing completion in the other shells.</p>
<p>Extending <code>$PROFILE</code> in this way also requires that scripts are allowed to be executed. This requires changing the execution policy from its default value <code>Restricted</code> on Windows. There's no such issue when using PowerShell on macOS or Linux.</p>
<!--
Thanks for helping out!

Please link the appropriate issue from your PR.

If you don't have an issue, we'd recommend starting with one first so the PR can focus on the
implementation (unless its an obvious bug or documentation fix that will have
little conversation).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/src/env/mod.rs</code>:40 on 2025-11-10 15:46</div>
            <div class="timeline-body"><p>Please revert the unrelated changes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-11-10 15:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jgreitemann">@jgreitemann</a> on <code>clap_complete/src/env/mod.rs</code>:40 on 2025-11-10 16:21</div>
            <div class="timeline-body"><p>Ok, sorry about conflating things. My thinking was that a little structure would help to discern the Powershell-related note from the shell &quot;headings&quot;. In particular, I'm still not 100% sure whether the line &quot;To disable completions, you can set <code>COMPLETE=</code> or <code>COMPLETE=0</code>&quot; is supposed to apply to all shells or just zsh.</p>
<p>Do you want me to revert the list entirely, or do you just want me to split the commits into one reformatting the module doc comment and one fixing the PowerShell bug? If you don't like the list, I could instead reformat this page further to introduce hierarchy though different levels of Markdown headings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jgreitemann">@jgreitemann</a> reviewed on 2025-11-10 16:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/epage">@epage</a> on <code>clap_complete/src/env/mod.rs</code>:40 on 2025-11-10 16:31</div>
            <div class="timeline-body"><p>If we move forward with it, it should be two commits.  By isolating the diffs, it makes it easier to inspect the content under review.</p>
<p>I am not thrilled with using a bullet list for the shells.  I'm fine with them being bolded.</p>
<p>No strong thoughts on how to handle the note for Powershell or our generic note at the end.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a> reviewed on 2025-11-10 16:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jgreitemann">@jgreitemann</a> reviewed on 2025-11-10 17:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jgreitemann">@jgreitemann</a> on <code>clap_complete/src/env/mod.rs</code>:40 on 2025-11-10 17:12</div>
            <div class="timeline-body"><p>Split off the bold headings, removed the bullet list. Got no solution for the generic note, so it remains ambiguous for now.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:10 UTC
    </footer>
</body>
</html>
