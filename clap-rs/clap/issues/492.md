```yaml
number: 492
title: Requiring another argument by name from an argument that is itself required creates a duplicate error message
type: issue
state: closed
author: stensonowen
labels:
  - C-bug
  - A-parsing
assignees: []
created_at: 2016-05-01T01:45:47Z
updated_at: 2018-08-02T03:29:49Z
url: https://github.com/clap-rs/clap/issues/492
synced_at: 2026-01-10T01:57:40Z
```

# Requiring another argument by name from an argument that is itself required creates a duplicate error message

---

_Issue opened by @stensonowen on 2016-05-01 01:45_

Hopefully the title is clear. In the example, argument `foo` is `required`, and it also `requires` `bar`. 

``` rust
let matches = App::new("MyApp")
                        .arg(Arg::with_name("foo")
                                    .help("FOO")
                                    .short("f")
                                    .required(true)
                                    .takes_value(true)
                                    .conflicts_with("c")
                                    .requires("bar")
                            )
                         .arg(Arg::with_name("bar")
                                    .short("b")
                                    .takes_value(true)
                                    .help("BAR")
                                    //.required(true)
                            )
                        .get_matches();
```

Calling `./prog --help` returns what you'd expect (`foo` and `bar` are required, with the correct usage string), but supplying the `-f` flag produces the following error:

```
error: The following required arguments were not provided:
    -b <bar>
    -b <bar>

USAGE:
    repeat_errors [FLAGS] [OPTIONS] -f <foo> -b <bar> -b <bar>
```

(Uncommenting the `bar.required(true)` adds another `-b <bar>` to the error and usage.)
It's conceivable that someone would want a `required` argument that `requires` another, so there is understandably a use case in which this error occurs. Additionally, it is certainly possible for a user to have accidentally made `bar` `required`, and the usage mistake might easily go unnoticed. 
Apologies if there's already a way to avoid these kinds of redundancies, but I didn't see any. 
It seems like an interesting (albiet niche) problem, so I'll probably take a crack at solving it and make a pull request. 


---

_Comment by @kbknapp on 2016-05-03 01:49_

Thanks for filing! Yep, the title is clear :smile:

I agree it's possible someone could end up doing this either by accident, or just not knowing there are other ways to accomplish this (i.e. if an arg is required by another required arg, it's not necessary to set).

I should have this fixed shortly!


---

_Label `T: bug` added by @kbknapp on 2016-05-03 01:49_

---

_Label `P2: need to have` added by @kbknapp on 2016-05-03 01:49_

---

_Label `C: args` added by @kbknapp on 2016-05-03 01:49_

---

_Label `D: easy` added by @kbknapp on 2016-05-03 01:49_

---

_Label `C: parsing` added by @kbknapp on 2016-05-03 01:49_

---

_Label `W: 2.x` added by @kbknapp on 2016-05-03 01:49_

---

_Closed by @kbknapp on 2016-05-04 01:09_

---
