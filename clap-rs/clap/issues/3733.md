```yaml
number: 3733
title: Setting external subcommand type is inconsistent with args
type: issue
state: closed
author: epage
labels:
  - C-bug
  - M-breaking-change
  - A-builder
  - E-easy
assignees: []
created_at: 2022-05-18T00:21:26Z
updated_at: 2022-07-25T19:46:29Z
url: https://github.com/clap-rs/clap/issues/3733
synced_at: 2026-01-10T01:57:47Z
```

# Setting external subcommand type is inconsistent with args

---

_Issue opened by @epage on 2022-05-18 00:21_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.57.0 (f1edd0429 2021-11-29)

### Clap Version

master

### Minimal reproducible code

`arg.value_parser(clap::value_parser!(OsString))`

vs

`cmd.allow_invalid_utf8_for_external_subcommands(true)`

### Steps to reproduce the bug with the above code

Build code around it

### Actual Behaviour

Inconsistent

### Expected Behaviour

Being able to set a `ValueParser` for external subcommands

### Additional Context

The `PartialEq` requirement on commands is what held this back from being in #3732

### Debug Output

_No response_

---

_Label `C-bug` added by @epage on 2022-05-18 00:21_

---

_Label `M-breaking-change` added by @epage on 2022-05-18 00:21_

---

_Label `A-builder` added by @epage on 2022-05-18 00:21_

---

_Label `E-easy` added by @epage on 2022-05-18 00:21_

---

_Referenced in [clap-rs/clap#3732](../../clap-rs/clap/pulls/3732.md) on 2022-05-18 00:21_

---

_Added to milestone `4.0` by @epage on 2022-05-18 00:25_

---

_Referenced in [clap-rs/clap#3990](../../clap-rs/clap/pulls/3990.md) on 2022-07-25 19:19_

---

_Closed by @epage on 2022-07-25 19:46_

---
