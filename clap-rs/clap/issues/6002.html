<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>derive: Read metadata from the fields of the `Cargo.toml` and embeds those to the long version - clap-rs/clap #6002</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>derive: Read metadata from the fields of the <code>Cargo.toml</code> and embeds those to the long version</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/6002">#6002</a>
        opened by <a href="https://github.com/sorairolake">@sorairolake</a>
        on 2025-05-12 19:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sorairolake">@sorairolake</a></div>
            <div class="timeline-body">Please complete the following tasks
<ul>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
Clap Version
<p>4.5.38</p>
Describe your use case
<p>The version flag for some commands prints more information than just the version.</p>
<p><code>ls --version</code>:</p>
<pre><code>ls (GNU coreutils) 9.7
Copyright (C) 2025 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;https://gnu.org/licenses/gpl.html&gt;.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Written by Richard M. Stallman and David MacKenzie.
</code></pre>
<p><code>pandoc --version</code>:</p>
<pre><code>pandoc 3.1.12.1
Features: +server +lua
Scripting engine: Lua 5.4
User data directory: $XDG_DATA_HOME/pandoc
Copyright (C) 2006-2023 John MacFarlane. Web: https://pandoc.org
This is free software; see the source for copying conditions. There is no
warranty, not even for merchantability or fitness for a particular purpose.
</code></pre>
<p>I think the following fields of the <code>Cargo.toml</code> file can be used to embed metadata to the long version:</p>
<ul>
<li><a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-homepage-field"><code>homepage</code></a></li>
<li><a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-repository-field"><code>repository</code></a></li>
<li><a href="https://doc.rust-lang.org/cargo/reference/manifest.html#the-license-and-license-file-fields"><code>license</code></a></li>
</ul>
Describe the solution you&#x27;d like
<p><code>Cargo.toml</code>:</p>
<pre><code>[package]
name = &quot;demo&quot;
version = &quot;0.1.0&quot;
homepage = &quot;https://demo.org/&quot;
repository = &quot;https://github.com/ghost/demo&quot;
license = &quot;Apache-2.0 OR MIT&quot;
</code></pre>
<p>Snippet:</p>
<pre><code>use clap::Parser;

#[derive(Debug, Parser)]
#[command(version, long_version)]
struct Opt {
    /// Name to print.
    name: String,
}

fn main() {
    let opt = Opt::parse();
    println!(&quot;{}&quot;, opt.name);
}
</code></pre>
<p><code>demo -V</code>:</p>
<pre><code>demo 0.1.0
</code></pre>
<p><code>demo --version</code>:</p>
<pre><code>demo 0.1.0
Home page: https://demo.org/
Repository: https://github.com/ghost/demo
License: Apache-2.0 OR MIT
</code></pre>
<ul>
<li>When the <code>long_version</code> attribute is not present: follow the <code>version</code> attribute.</li>
<li>When the <code>long_version</code> attribute is present with a value: use the specified value instead.</li>
<li>When the field is undefined: skip that field.</li>
</ul>
Alternatives, if applicable
<p>Define a string with the same content as above, and pass it as a parameter to the <code>long_version</code> method.</p>
Additional Context
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by <a href="https://github.com/sorairolake">@sorairolake</a> on 2025-05-12 19:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by <a href="https://github.com/epage">@epage</a> on 2025-05-21 15:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-derive</span> added by <a href="https://github.com/epage">@epage</a> on 2025-05-21 15:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by <a href="https://github.com/epage">@epage</a> on 2025-05-21 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-05-21 16:01</div>
            <div class="timeline-body"><p>For myself, I feel like there will be too much of a gap for what we can generate for <code>long_version</code> compared to what people people who set <code>long_version</code> will want that this would be better left up to users, with crates like <code>shadow-rs</code> and <code>vergen</code>.  Looks like someone has even created a helper for <code>vergen</code>, <a href="https://crates.io/crates/clap-vergen"><code>clap-vergen</code></a>.</p>
<p>I will leave this open for now to help it have more visibility for any additional feedback from the community on whether and how this should be handled.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 20:00:30 UTC
    </footer>
</body>
</html>
