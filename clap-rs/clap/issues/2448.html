<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Singleton optional values should use `[&lt;name&gt;]` in help message - clap-rs/clap #2448</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Singleton optional values should use <code>[&lt;name&gt;]</code> in help message</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/2448">#2448</a>
        opened by <a href="https://github.com/mina86">@mina86</a>
        on 2021-04-20 20:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mina86">@mina86</a> on 2021-04-20 20:59</div>
            <div class="timeline-body"><h3>Rust Version</h3>
<p>rustc 1.53.0-nightly (9d9c2c92b 2021-04-19)</p>
<h3>Affected Version of clap</h3>
<p>3.0.0-beta.2</p>
<h3>Expected Behavior Summary</h3>
<p>Help message for <code>Option&lt;Option&lt;type&gt;&gt;</code> switches uses <code>[&lt;name&gt;]</code> rather than <code>&lt;name&gt;...</code> to indicate that the value is optional.  For example, for switch <code>opt</code> the help screen reads <code>--opt [&lt;opt&gt;]</code>.  Ellipsis suggests that the value can be provided more than once (which is not correct) whereas square brackets correctly indicate the value can be given at most once.</p>
<h3>Actual Behavior Summary</h3>
<p>Ellipsis is used in help message.  For switch <code>opt</code> the help screen reads <code>--opt &lt;opt&gt;...</code>.</p>
<h3>Steps to Reproduce the issue</h3>
<pre><code>use clap::Clap;

#[derive(Clap, Debug)]
struct Opts {
    #[clap(long)]
    opt: Option&lt;Option&lt;i32&gt;&gt;
}

fn main() {
    println!(&quot;{:?}&quot;, Opts::parse());
}
</code></pre>
<pre><code>$ cargo --quiet run -- --help |grep -e --opt
        --opt &lt;opt&gt;...
# Expected:         --opt [&lt;opt&gt;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-04-25 15:55</div>
            <div class="timeline-body"><p>Can you please add more context on why <code>Option&lt;Option&lt;i32&gt;&gt;</code> is used instead of <code>Option&lt;i32&gt;</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.1" by @pksunkara on 2021-04-25 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: derive macros</span> added by @pksunkara on 2021-04-25 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by @pksunkara on 2021-04-25 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mina86">@mina86</a> on 2021-04-25 20:01</div>
            <div class="timeline-body"><p><code>Option&lt;i32&gt;</code> makes the argument of the switch required which is something I donâ€™t want.  I want <code>--opt</code> to enable particular feature while allow <code>--opt=&lt;value&gt;</code> to customise an argument of that feature. For example, it could be <code>--parallel=[&lt;count&gt;]</code> switch which enables parallel processing defaulting to number of jobs equal number of CPUs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">:money_with_wings: $5</span> added by @pksunkara on 2021-06-16 03:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2653.html">clap-rs/clap#2653</a> on 2021-08-01 22:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-08-02 08:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:44 UTC
    </footer>
</body>
</html>
