<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ignore extra macos parameter - clap-rs/clap #1608</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ignore extra macos parameter</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/1608">#1608</a>
        opened by <a href="https://github.com/sixcorners">@sixcorners</a>
        on 2019-12-18 11:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sixcorners">@sixcorners</a></div>
            <div class="timeline-body"><p>When you start an app on macos it will sometimes pass a process serial number. This blows up apps that use clap.
The place where it is getting passed for me is from the &quot;App downloaded from the internet&quot; dialog box. When you click open it will try to open the rust app but fail and do nothing. If you ignored a parameter that looks like this <code>-psn_0_5539144</code> on macos then this would be fixed for all apps using clap.</p>
Rust Version
<p>rustc 1.39.0</p>
Affected Version of clap
<p>whatever the latest is (v2.31.2)</p>
Expected Behavior Summary
<p>App doesn&#x27;t fail when running from the &quot;App downloaded from the internet&quot; dialog box.</p>
Actual Behavior Summary
<p>&quot;error: Found argument &#x27;-p&#x27; which wasn&#x27;t expected, or isn&#x27;t valid in this context&quot;</p>
Steps to Reproduce the issue
<p>Launch a rust application on macos from the &quot;App downloaded from the internet&quot; warning dialog box.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Handle macos process serial number&quot; to &quot;ignore extra macos parameter&quot; by <a href="https://github.com/sixcorners">@sixcorners</a> on 2019-12-19 16:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>alacritty/alacritty#2998</a> on 2020-01-03 16:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nixpulvis">@nixpulvis</a> on 2020-01-03 16:41</div>
            <div class="timeline-body"><p>IMO, this is a tragic interface being forced upon the community by Apple. Why should argument parsers need to deal with this, or applications without a need for the PSN. Couldn&#x27;t it be passed in the <code>ENV</code> much more transparently?</p>
<p>Either way it seems many applications don&#x27;t care about this PSN, for example:</p>
<p>https://github.com/bitcoin/bitcoin/blob/b6e34afe9735faf97d6be7a90fafd33ec18c0cbb/src/util/system.cpp#L383-L389</p>
<p>So adding an option to ignore it on macOS may make sense. I wouldn&#x27;t want non-macOS code to need to care though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chrisduerr">@chrisduerr</a> on 2020-01-03 20:05</div>
            <div class="timeline-body"><p>If this was ignored in clap directly, I also think that it probably shouldn&#x27;t just be done automatically without any compile-time checks. If a user wants to add their own <code>-psn</code> flag, things shouldn&#x27;t explode.</p>
<p>Though I don&#x27;t think it&#x27;s possible to build the string <code>-psn_</code> as  option right now, so that should be fine. But blocking just <code>-psn</code> would certainly cause huge troubles.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: after v3 release</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: maybe</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: after v3 release</span> removed by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-07 07:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: args</span> added by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-01 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new setting</span> added by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-01 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> removed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-01 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> removed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-10-26 07:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woelper">@woelper</a> on 2021-03-04 15:39</div>
            <div class="timeline-body"><p>I had this issue, too - in case it helps anyone, i used <code>.get_matches_from()</code> and filtered incoming arguments before with <code>let args: Vec&lt;String&gt; = std::env::args().filter(|a| !a.contains(&quot;psn_&quot;)).collect();</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> removed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-08-13 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>epage/clapng#130</a> on 2021-12-06 18:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: args</span> removed by <a href="https://github.com/epage">@epage</a> on 2021-12-08 20:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-parsing</span> added by <a href="https://github.com/epage">@epage</a> on 2021-12-08 20:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new setting</span> removed by <a href="https://github.com/epage">@epage</a> on 2021-12-08 20:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by <a href="https://github.com/epage">@epage</a> on 2021-12-08 20:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> removed by <a href="https://github.com/epage">@epage</a> on 2021-12-09 20:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:57:33 UTC
    </footer>
</body>
</html>
