<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Required argument for subcommand? - clap-rs/clap #548</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Required argument for subcommand?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/548">#548</a>
        opened by <a href="https://github.com/kherge">@kherge</a>
        on 2016-06-29 20:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kherge">@kherge</a> on 2016-06-29 20:21</div>
            <div class="timeline-body"><p>When using <code>.value_of()</code> to get the value of a required subcommand argument, <code>None</code> is returned which causes a panic when I <code>unwrap</code> the value I was expecting to be available. I get <code>None</code> even if a value is provided.</p>
<p>Could you please help me understand what I am doing incorrectly?</p>
<pre><code class="language-rust">extern crate clap;

use self::clap::{App, AppSettings, Arg, SubCommand};

fn main() {
    let input = App::new(&quot;Bug&quot;)
        .about(&quot;Example code to demonstrate a bug.&quot;)
        .setting(AppSettings::SubcommandRequiredElseHelp)
        .subcommand(SubCommand::with_name(&quot;trigger&quot;)
                    .arg(Arg::with_name(&quot;culprit&quot;)
                         .required(true)))
        .get_matches();

    if Some(&quot;trigger&quot;) == input.subcommand_name() {
        let culprit = input.value_of(&quot;culprit&quot;).unwrap();

        println!(&quot;Culprit: {}&quot;, culprit);
    } else {
        println!(&quot;No match on: {}&quot;, input.subcommand_name().unwrap());
    }
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-06-30 01:17</div>
            <div class="timeline-body"><p><code>&quot;culprit&quot;</code> is an argument of the subcommand <code>&quot;trigger&quot;</code>'s matches, not the parent <code>&quot;Bug&quot;</code>'s matches (stored in <code>input</code>).</p>
<p>You must first get the <code>&quot;trigger&quot;</code>'s matches in in order to see values of arguments defined on that subcommand. This is because any subcommands could have argument names that overlap, and it's also more efficent to pass around a small &quot;subcommand matches&quot; vice an all encompassing &quot;all arguments of all subcommands&quot; matches.</p>
<p>If you change your code slightly it'll work as intended:</p>
<pre><code class="language-rust">extern crate clap;

use self::clap::{App, AppSettings, Arg, SubCommand};

fn main() {
    let input = App::new(&quot;Bug&quot;)
        .about(&quot;Example code to demonstrate a bug.&quot;)
        .setting(AppSettings::SubcommandRequiredElseHelp)
        .subcommand(SubCommand::with_name(&quot;trigger&quot;)
                    .arg(Arg::with_name(&quot;culprit&quot;)
                         .required(true)))
        .get_matches();

    match input.subcommand() {
        (&quot;trigger&quot;, Some(sub_input)) =&gt; {
            let culprit = sub_input.value_of(&quot;culprit&quot;).unwrap();

            println!(&quot;Culprit: {}&quot;, culprit);
        _ =&gt; /* no subcommand */,
    }
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2016-06-30 01:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kherge">@kherge</a> on 2016-06-30 15:43</div>
            <div class="timeline-body"><p>That worked perfectly. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kherge on 2016-06-30 15:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:31 UTC
    </footer>
</body>
</html>
