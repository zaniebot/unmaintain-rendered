<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Confusing error reason when option has no &quot;long&quot; name - clap-rs/clap #1260</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Confusing error reason when option has no &quot;long&quot; name</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1260">#1260</a>
        opened by <a href="https://github.com/vn971">@vn971</a>
        on 2018-04-23 16:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/vn971">@vn971</a> on 2018-04-23 16:44</div>
            <div class="timeline-body"><h3>Rust Version</h3>
<ul>
<li>rustc 1.25.0 (84203cac6 2018-03-25)</li>
</ul>
<h3>Affected Version of clap</h3>
<ul>
<li>2.31.2</li>
</ul>
<h3>Steps to Reproduce the issue</h3>
<ul>
<li>define an arg like this: <code>.arg(clap::Arg::with_name(&quot;--test&quot;))</code></li>
<li>start a clap program with  ./app_name --test</li>
</ul>
<h3>Actual Behavior Summary</h3>
<pre><code>error: Found argument '--test' which wasn't expected, or isn't valid in this context

USAGE:
    wwrap [--test]

For more information try --help
</code></pre>
<p>As you see, the logging is kinda self-contradictory. &quot;We don't accept --test because we only accept --test&quot;.</p>
<h3>Expected Behavior Summary</h3>
<p>runtime error at parse time, or any other solution giving correct error reasons</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vn971">@vn971</a> on 2018-04-23 18:12</div>
            <div class="timeline-body"><p>UPD: actually the error reason seems to be different. I didn't provide a &quot;long&quot; name for an option, which is why it didn't work. The &quot;Actual Behavior&quot; above seems to be misleading anyway, IMO, so I'm leaving the issue open.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Double dash argument name" to "Confusing error reason when option has no "long" name" by @vn971 on 2018-04-23 18:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-06-05 01:34</div>
            <div class="timeline-body"><p>It looks like maybe the intent was to use <a href="https://docs.rs/clap/2.31.2/clap/struct.Arg.html#method.from_usage"><code>Arg::from_usage</code></a> instead of <code>with_name</code>. I agree it's a slightly confusing message, but I can't actually think of a better way to word it. Perhaps a debug lint if an arg name starts with a single or double hyphen?</p>
<p>I'm going to close this for now as it's working as intended, and a lint against this would need a way to turn off the lint which is more complicated than I think this issue warrants.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2018-06-05 01:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
