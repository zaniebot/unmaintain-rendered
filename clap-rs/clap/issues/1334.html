<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display help for all subcommands at the same time - clap-rs/clap #1334</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Display help for all subcommands at the same time</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1334">#1334</a>
        opened by <a href="https://github.com/mmstick">@mmstick</a>
        on 2018-08-24 17:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mmstick">@mmstick</a> on 2018-08-24 17:55</div>
            <div class="timeline-body"><p><strong>Maintainer's note: Proposed solution</strong></p>
<p>Setting:</p>
<ul>
<li><code>help_includes_subcommands</code> or <code>help_shows_subcommands</code><ul>
<li>trying to keep what the setting impacts first, otherwise I would have done <code>flatten_subcommands_in_help</code></li>
<li>not starting with <code>subcommand</code> because this is set on the parent of the subcommands rather than a subcommand itself</li>
</ul>
</li>
</ul>
<p>Help output:</p>
<ul>
<li>USAGE includes regular usage and usage for each subcommand that is visible in short help</li>
<li>Show current command's subcommand and arguments like normal<ul>
<li>Even if parent has <code>help_includes_subcommands</code> set (this diverges from <code>git stash &lt;command&gt; -h</code> which shows <code>git stash -h</code>)</li>
</ul>
</li>
<li>After current command's arguments, for each subcommand visible in short help<ul>
<li>Show a header for the subcommand</li>
<li>Show short-help arguments under the above heading (ie ignore help headings)<ul>
<li>Ideally, hide all generated and global arguments</li>
</ul>
</li>
<li>Do not list subcommands</li>
</ul>
</li>
</ul>
<p>Man page:</p>
<ul>
<li>Same as above but show long-help</li>
<li>This will actually be split out into a separate issue</li>
</ul>
<p>Open question:</p>
<ul>
<li>Do we recurse?<ul>
<li>If so, we should elide intermediate subcommands that only have generated arguments</li>
</ul>
</li>
</ul>
<p>Implementation:</p>
<ul>
<li>Usage generation will need to be refactored so we can request the parts of it that we need</li>
</ul>
<hr />
<p>The API is very large and I've struggled to find any examples or hints pointing to this possibility. Is it possible for the help page for a program to list the help pages of all subcommands at the same time, rather than just the current scope? That way the user does not need to also request for the help info from each subcommand.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: subcommands</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: intermediate</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by @CreepySkeleton on 2020-02-02 06:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> removed by @pksunkara on 2021-08-13 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/99.html">epage/clapng#99</a> on 2021-12-06 17:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: subcommands</span> removed by @epage on 2021-12-08 20:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-08 20:15</div>
            <div class="timeline-body"><p>Do you have examples of commands that do that today?  I'm having a hard time picturing this not being overwhelming.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmstick">@mmstick</a> on 2021-12-08 20:32</div>
            <div class="timeline-body"><p>I would have examples if clap supported it. Command line applications don't always have 100s of options. Underwhelming is how I'd describe the current usefulness of the help info generated right now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmstick">@mmstick</a> on 2021-12-08 20:34</div>
            <div class="timeline-body"><pre><code># system76-power -h
system76-power 1.1.20
Utility for managing graphics and power profiles

USAGE:
    system76-power &lt;SUBCOMMAND&gt;

OPTIONS:
    -h, --help       Prints help information
    -V, --version    Prints version information

SUBCOMMANDS:
    charge-thresholds    Set thresholds for battery charging
    daemon               Runs the program in daemon mode
    graphics             Query or set the graphics mode
    help                 Prints this message or the help of the given subcommand(s)
    profile              Query or set the power profile
</code></pre>
<pre><code># system76-power profile -h
system76-power-profile
Queries or sets the power profile.

 - If an argument is not provided, the power profile will be queried
 - Otherwise, that profile will be set, if it is a valid profile

USAGE:
    system76-power profile [profile]

OPTIONS:
    -h, --help    Prints help information

ARGS:
    &lt;profile&gt;    set the power profile [possible values: battery, balanced, performance]
</code></pre>
<p>Would be much more useful combined.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mkayaalp">@mkayaalp</a> on 2021-12-08 20:40</div>
            <div class="timeline-body"><pre><code># opkg
opkg must have one sub-command argument
usage: opkg [options...] sub-command [arguments...]
where sub-command is one of:

Package Manipulation:
	update			Update list of available packages
	upgrade &lt;pkgs&gt;		Upgrade packages
	install &lt;pkgs&gt;		Install package(s)
	configure &lt;pkgs&gt;	Configure unpacked package(s)
	remove &lt;pkgs|regexp&gt;	Remove package(s)
	flag &lt;flag&gt; &lt;pkgs&gt;	Flag package(s)
	 &lt;flag&gt;=hold|noprune|user|ok|installed|unpacked (one per invocation)

Informational Commands:
	list			List available packages
	list-installed		List installed packages
	list-upgradable		List installed and upgradable packages
	list-changed-conffiles	List user modified configuration files
	files &lt;pkg&gt;		List files belonging to &lt;pkg&gt;
	search &lt;file|regexp&gt;	List package providing &lt;file&gt;
	find &lt;regexp&gt;		List packages whose name or description matches &lt;regexp&gt;
	info [pkg|regexp]	Display all info for &lt;pkg&gt;
	status [pkg|regexp]	Display all status for &lt;pkg&gt;
	download &lt;pkg&gt;		Download &lt;pkg&gt; to current directory
	compare-versions &lt;v1&gt; &lt;op&gt; &lt;v2&gt;
	                    compare versions using &lt;= &lt; &gt; &gt;= = &lt;&lt; &gt;&gt;
	print-architecture	List installable package architectures
	depends [-A] [pkgname|pat]+
	whatdepends [-A] [pkgname|pat]+
	whatdependsrec [-A] [pkgname|pat]+
	whatrecommends[-A] [pkgname|pat]+
	whatsuggests[-A] [pkgname|pat]+
	whatprovides [-A] [pkgname|pat]+
	whatconflicts [-A] [pkgname|pat]+
	whatreplaces [-A] [pkgname|pat]+

Options:
	-A			Query all packages not just those installed
	-V[&lt;level&gt;]		Set verbosity level to &lt;level&gt;.
	--verbosity[=&lt;level&gt;]	Verbosity levels:
					0 errors only
					1 normal messages (default)
					2 informative messages
					3 debug
					4 debug level 2
	-f &lt;conf_file&gt;		Use &lt;conf_file&gt; as the opkg configuration file
	--conf &lt;conf_file&gt;
	--cache &lt;directory&gt;	Use a package cache
	-d &lt;dest_name&gt;		Use &lt;dest_name&gt; as the the root directory for
	--dest &lt;dest_name&gt;	package installation, removal, upgrading.
				&lt;dest_name&gt; should be a defined dest name from
				the configuration file, (but can also be a
				directory name in a pinch).
	-o &lt;dir&gt;		Use &lt;dir&gt; as the root directory for
	--offline-root &lt;dir&gt;	offline installation of packages.
	--verify-program &lt;path&gt;	Use the given program to verify usign signatures
	--add-arch &lt;arch&gt;:&lt;prio&gt;	Register architecture with given priority
	--add-dest &lt;name&gt;:&lt;path&gt;	Register destination with given path

Force Options:
	--force-depends		Install/remove despite failed dependencies
	--force-maintainer	Overwrite preexisting config files
	--force-reinstall	Reinstall package(s)
	--force-overwrite	Overwrite files from other package(s)
	--force-downgrade	Allow opkg to downgrade packages
	--force-space		Disable free space checks
	--force-postinstall	Run postinstall scripts even in offline mode
	--force-remove	Remove package even if prerm script fails
	--force-checksum	Don't fail on checksum mismatches
	--no-check-certificate Don't validate SSL certificates
	--noaction		No action -- test only
	--download-only	No action -- download only
	--nodeps		Do not follow dependencies
	--nocase		Perform case insensitive pattern matching
	--size			Print package size when listing available packages
	--strip-abi		Print package name without appended ABI version
	--force-removal-of-dependent-packages
				Remove package and all dependencies
	--autoremove		Remove packages that were installed
				automatically to satisfy dependencies
	-t			Specify tmp-dir.
	--tmp-dir		Specify tmp-dir.
	-l			Specify lists-dir.
	--lists-dir		Specify lists-dir.

 regexp could be something like 'pkgname*' '*file*' or similar
 e.g. opkg info 'libstd*' or opkg search '*libop*' or opkg remove 'libncur*'
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> removed by @epage on 2021-12-08 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2021-12-08 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-08 21:50</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Do you have examples of commands that do that today? I'm having a hard time picturing this not being overwhelming.</p>
</blockquote>
</blockquote>
<blockquote>
<p>I would have examples if clap supported it. Command line applications don't always have 100s of options. Underwhelming is how I'd describe the current usefulness of the help info generated right now.</p>
</blockquote>
<p>I was hoping for precedent from another CLI to take inspiration from and to see how well it works in practice</p>
<p>@mkayaalp I see that opkg shows subcommand usage.  Is that your proposal for this?  Looks similar to https://github.com/clap-rs/clap/issues/962</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> removed by @epage on 2021-12-09 18:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: medium</span> removed by @epage on 2021-12-09 18:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-help-wanted</span> removed by @epage on 2021-12-09 18:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2021-12-09 18:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1535.html">clap-rs/clap#1535</a> on 2021-12-09 20:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dpc">@dpc</a> on 2021-12-09 20:27</div>
            <div class="timeline-body"><blockquote>
<p>I was hoping for precedent from another CLI to take inspiration from and to see how well it works in practice</p>
</blockquote>
<p><code>cargo-crev</code> has many, often multiple level commands, like <code>cargo crev repo fetch all --someoptions</code>. There's currently no way for the users to get all the possible commands in one go, which hurts discoverability.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 20:38</div>
            <div class="timeline-body"><p>@dpc mind hacking up example output of what your ideal would look like with <code>cargo-crev</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dpc">@dpc</a> on 2021-12-09 20:56</div>
            <div class="timeline-body"><p>No strong opinions, but seems to me like just expanding every subcommand under <code>SUBCOMMANDS</code> and displaying instead what <code>&lt;command&gt; &lt;that-subcommand&gt; -h</code> would.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-10 16:22</div>
            <div class="timeline-body"><p>With clap, we are trying to balance ease of use, flexibility, and compile-time / binary size.</p>
<p>We have plans for <a href="https://github.com/clap-rs/clap/issues/2913">decoupling help generation</a>, allowing <a href="https://github.com/clap-rs/clap/issues/2914">custom formatting</a>.  I have a feeling that this might be the best way forward for this.  We wouldn't have a built-in &quot;show all subcommands&quot; flag but give you the tools to auto-generate the help output to look like you want it to.</p>
<p>I'm going to mark this issue as blocked on https://github.com/clap-rs/clap/issues/2914 to make sure we track the requirements needed for this and I'm assuming we will close this out when https://github.com/clap-rs/clap/issues/2914 is resolved.</p>
<p>If there are concerns about this plan, let us know!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> removed by @epage on 2021-12-10 16:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-blocked</span> added by @epage on 2021-12-10 16:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3174.html">clap-rs/clap#3174</a> on 2021-12-14 18:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-blocked</span> removed by @epage on 2021-12-18 00:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2021-12-18 00:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-18 00:07</div>
            <div class="timeline-body"><p>Been thinking on this as we've been iterating on #3174.  I realized there is a good template for us to use for this, <code>git stash -h</code> / <code>git stash --help</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-01-04 14:02</div>
            <div class="timeline-body"><p>One idea I was toying with</p>
<p>Setting:</p>
<ul>
<li><code>help_includes_subcommands</code> or <code>help_shows_subcommands</code><ul>
<li>trying to keep what the setting impacts first, otherwise I would have done <code>flatten_subcommands_in_help</code></li>
<li>not starting with <code>subcommand</code> because this is set on the parent of the subcommands rather than a subcommand itself</li>
</ul>
</li>
</ul>
<p>Help output:</p>
<ul>
<li>USAGE includes regular usage and usage for each subcommand that is visible in short help</li>
<li>Show current command's subcommand and arguments like normal<ul>
<li>Even if parent has <code>help_includes_subcommands</code> set (this diverges from <code>git stash &lt;command&gt; -h</code> which shows <code>git stash -h</code>)</li>
</ul>
</li>
<li>After current command's arguments, for each subcommand visible in short help<ul>
<li>Show a header for the subcommand</li>
<li>Show short-help arguments under the above heading (ie ignore help headings)<ul>
<li>Ideally, hide all generated and global arguments</li>
</ul>
</li>
<li>Do not list subcommands</li>
</ul>
</li>
</ul>
<p>Man page:</p>
<ul>
<li>Same as above but show long-help</li>
</ul>
<p>Open question:</p>
<ul>
<li>Do we recurse?<ul>
<li>If so, we should elide intermediate subcommands that only have generated arguments</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> removed by @epage on 2022-01-04 14:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-decision</span> added by @epage on 2022-01-04 14:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1431.html">clap-rs/clap#1431</a> on 2022-01-04 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-01-10 15:41</div>
            <div class="timeline-body"><p>Anyone have thoughts on how to refer to / what to call the difference in subcommands between <code>git</code> and <code>git stash</code>?  <code>git</code>s subcommands act like external subcommands though whether all of them are is an implementation detail.  Since external subcommands are about the implementation, it'd be hard to reuse that name.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2513.html">clap-rs/clap#2513</a> on 2022-01-10 15:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3365.html">clap-rs/clap#3365</a> on 2022-01-28 21:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lu-zero">@lu-zero</a> on 2022-01-31 09:10</div>
            <div class="timeline-body"><p>decoupled/coupled subcommand help maybe? Assuming you want to mention all the subcommand in the same <code>--help</code> for the latter and show it for <code>--all-help</code> for the former.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1382.html">clap-rs/clap#1382</a> on 2022-02-03 14:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3418.html">clap-rs/clap#3418</a> on 2022-02-08 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/962.html">clap-rs/clap#962</a> on 2022-02-09 15:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Q: Display help for all subcommands at the same time" to "Display help for all subcommands at the same time" by @epage on 2022-11-08 04:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1761.html">clap-rs/clap#1761</a> on 2022-11-08 04:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "4.x" by @epage on 2022-11-18 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../cargo-public-api/cargo-public-api/issues/238.html">cargo-public-api/cargo-public-api#238</a> on 2022-12-11 08:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4813.html">clap-rs/clap#4813</a> on 2023-03-30 23:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../rust-lang/cargo/pulls/11879.html">rust-lang/cargo#11879</a> on 2023-04-03 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4818.html">clap-rs/clap#4818</a> on 2023-04-03 20:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4897.html">clap-rs/clap#4897</a> on 2023-05-09 19:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5042.html">clap-rs/clap#5042</a> on 2023-07-24 15:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5204.html">clap-rs/clap#5204</a> on 2023-11-09 18:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5206.html">clap-rs/clap#5206</a> on 2023-11-09 21:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-11-09 21:24</div>
            <div class="timeline-body"><p>Would love feedback on #5206</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2023-11-10 22:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:51 UTC
    </footer>
</body>
</html>
