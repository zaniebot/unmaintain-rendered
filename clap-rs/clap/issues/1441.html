<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`unique` command line arguments - clap-rs/clap #1441</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`unique` command line arguments</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1441">#1441</a>
        opened by <a href="https://github.com/suhr">@suhr</a>
        on 2019-03-29 17:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/suhr">@suhr</a> on 2019-03-29 17:05</div>
            <div class="timeline-body"><p>This feature request is inspired by <a href="https://github.com/tox-rs/tox-node/issues/53">this discussion</a>.</p>
<p>Long story short: at this moment, tox-node uses the <code>config</code> subcommand to run a node with the configuration from a configuration file. The reason for this is because tox-node can be also run without a configuration file, with all required options passed as command line arguments. The usage of subcommand allows to avoid the situation when both configuration file and command line arguments are provides simultaneously.</p>
<p>The problem is, I believe that this is in no way a valid usage of subcommands. The purpose of subcommands is to provide <em>actions</em>, but <code>config</code> is not an action. So instead of <code>config</code> subcommand there should be the <code>--config</code> command line option.</p>
<p>At this moment, clap-rs provides no ergonomic way to specify an option that excludes all other options. This issue proposes adding a method for specifying such options.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2019-04-05 02:42</div>
            <div class="timeline-body"><p>There is quite a bit of discussion about the handling of configuration files. This is one of the main goals v3 is trying to solve.</p>
<p>I'm not clear on if you're currently handling the configuration files manually? If so, I would recommend the follow instead of a <code>unique</code>:</p>
<p><em>note:</em> This mainly works if the number of required by default arguments is relatively low</p>
<ul>
<li>Create a <code>--mode=MODE</code> option, which only accepts two values <code>config|cli</code>, and defaults to <code>cli</code></li>
<li>In your required arguments use <code>Arg::required_if</code> to only be required if <code>--mode=cli</code></li>
<li>In your user-code, if <code>--mode=config</code> you can ignore CLI passed options (or allow CLI passed options to override the config options you've manually determined).</li>
</ul>
<p>This is assuming I understood the problem correctly. While I'm not opposed to a <code>unique</code> option, I think there are better ways to handle the validation you're searching for. (Part of which will only become a thing once v3 is released though).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2019-04-05 02:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-07-01 02:53</div>
            <div class="timeline-body"><blockquote>
<p>At this moment, clap-rs provides no ergonomic way to specify an option that excludes all other options</p>
</blockquote>
<p>I believe this is solved by <code>Arg::exclusive</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @CreepySkeleton on 2020-07-01 02:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:07 UTC
    </footer>
</body>
</html>
