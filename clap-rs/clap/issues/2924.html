<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stablize `ArgMatches::grouped_value_of` Tracking Issue - clap-rs/clap #2924</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Stablize `ArgMatches::grouped_value_of` Tracking Issue</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/2924">#2924</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2021-10-23 14:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/epage">@epage</a> on 2021-10-23 14:57</div>
            <div class="timeline-body"><p>Original request: https://github.com/clap-rs/clap/issues/1026</p>
<p>Original PR: https://github.com/clap-rs/clap/pull/2297</p>
<p>Feature flag: <code>unstable-grouped</code></p>
<p>Known issues</p>
<ul>
<li>[x] Open question: how should this be exposed in <code>clap_derive</code> (see also #1772)</li>
<li>[x] Open question: update for new <code>get</code>/<code>remove</code> API (#4372)</li>
<li>[x] Evaluate new names as this can be confusing with <code>ArgGroup</code>, <code>occurrence</code> is normally what we call this</li>
<li>[x] Function is not documented (#3551)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @epage by @epage on 2021-10-23 14:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2926.html">clap-rs/clap#2926</a> on 2021-10-23 15:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: stabilisation</span> added by @pksunkara on 2021-10-27 22:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: matches</span> added by @pksunkara on 2021-10-27 22:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-11-04 18:40</div>
            <div class="timeline-body"><p>For <code>_t</code> and <code>_os</code> variants, should we wait on https://github.com/clap-rs/clap/issues/2683 which will remove the need for them?  Or at least not block this feature on them?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-11-05 07:24</div>
            <div class="timeline-body"><p>I think that's a good idea, since I am getting the impression that we will probably be working on #2683 as the next big thing after v3 release. Unless you have different plans?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-11-05 13:27</div>
            <div class="timeline-body"><blockquote>
<p>Unless you have different plans?</p>
</blockquote>
<p>That and a couple other changes that will lay the ground work for help, parser, and other validation changes.  I don't think we need to cram them all in but should keep an eye for changes that make it easier to get them in later.  #2911 is one example because it means we can attach the reflection traits to the <code>AppParser</code> without making them <code>&amp;mut</code> to allow building since the type system will enforce that building has occurred.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2993.html">clap-rs/clap#2993</a> on 2021-11-05 14:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1772.html">clap-rs/clap#1772</a> on 2021-11-05 14:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/229.html">epage/clapng#229</a> on 2021-12-06 22:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: matches</span> removed by @epage on 2021-12-08 20:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-parsing</span> added by @epage on 2021-12-08 20:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-blocked</span> added by @epage on 2021-12-13 21:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3551.html">clap-rs/clap#3551</a> on 2022-03-10 04:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmccombs">@tmccombs</a> on 2022-06-24 04:25</div>
            <div class="timeline-body"><p>With the new action API, and typed arguments API, I wonder if the best way to expose this would be as a new <code>ArgAction::GroupedAppend</code> action, which is similar to the <code>ArgAction::Append</code> action, but, then the argument type changes from <code>T</code> to <code>Vec&lt;T&gt;</code>, and captures all arguments for each occurance/group. So then <code>get_many::&lt;Vec&lt;T&gt;&gt;()</code> would return a <code>ValuesRef&lt;'_, Vec&lt;T&gt;&gt;</code>.</p>
<p>Or perhaps a more general API could be to have a way to specify an additional parsing function, that takes an iterator over the arguments to a single occurrence/group and returns a new single value. I'm not sure exactly how the typing would work on that though, if you were to allow using this in addition to a <code>value_parser</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-06-26 03:06</div>
            <div class="timeline-body"><p>Yes, <code>ArgAction</code> will hopefully help with this.  I don't think we can reuse <code>get_many</code> for this as the <code>value_parser</code> setting the stored type happens at a different level than the processing of actions and so the underlying type cannot be modified.  I suspect we'll need yet another set of functions.  We'll need to distinguish their name from <code>get_many</code> / <code>remove_many</code>.</p>
<p>Depending on how this works out, my thought is to have <code>ArgAction::Extend</code> (current behavior) and <code>ArgAction::Append</code> (groups).  I think the reason I used <code>ArgAction::Append</code> in v3.2 is because internally we are appending right now and if we add a new function it'll just expose that.  We'd then just add <code>Extend</code> to not do that.   The downside is that it will have a higher migration cost as people are using <code>Append</code> now when they mean <code>Extend</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../sharkdp/fd/pulls/1067.html">sharkdp/fd#1067</a> on 2022-09-06 15:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1404.html">clap-rs/clap#1404</a> on 2022-11-14 23:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4544.html">clap-rs/clap#4544</a> on 2022-12-09 08:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmccombs">@tmccombs</a> on 2022-12-10 05:52</div>
            <div class="timeline-body"><p>For using the new get/remove API, what should the names of the functions be. In #4544 I used <code>get_groups</code>, <code>remove_groups</code>, etc. However, I'm not sure that is the best name, and would be happy to change it to something else. Some other possible options I can think of:</p>
<ul>
<li><code>get_many_grouped</code></li>
<li><code>get_grouped</code></li>
<li><code>get_grouped_values</code></li>
<li><code>get_as_groups</code></li>
<li><code>get_many_per_occurrence</code></li>
</ul>
<p>I don't have a strong preference, among those, and maybe there is one I haven't thought of that would be better.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-12-10 12:28</div>
            <div class="timeline-body"><p>I don't remember where the original conversation happened but the problem is that <code>group</code> is overloaded with <code>ArgGroup</code> and can be confusing.  We generally refer to each time an argument shows up as an &quot;occurrence&quot;, so I think something like that in the name of each part of this feature would make sense.</p>
<p>For example, <code>get_occurrences</code> could possibly work now that we've removed <code>occurrences_of</code>.  You had mentioned <code>get_many_per_occurrence</code> which I;m not as thrilled with but I am open to other ideas people have.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmccombs">@tmccombs</a> on 2022-12-10 18:29</div>
            <div class="timeline-body"><p><code>get_occurences</code> would be fine with me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4600.html">clap-rs/clap#4600</a> on 2023-01-03 06:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-10 14:44</div>
            <div class="timeline-body"><p>@tmccombs any concerns with stablizing?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmccombs">@tmccombs</a> on 2023-01-10 16:04</div>
            <div class="timeline-body"><p>Not from me</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4635.html">clap-rs/clap#4635</a> on 2023-01-13 03:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2023-01-13 12:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2419.html">clap-rs/clap#2419</a> on 2023-06-14 13:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:33 UTC
    </footer>
</body>
</html>
