<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add ability to easily create interactive CLI - clap-rs/clap #235</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Add ability to easily create interactive CLI</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/235">#235</a>
        opened by <a href="https://github.com/kbknapp">@kbknapp</a>
        on 2015-09-07 20:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-09-07 20:57</div>
            <div class="timeline-body"><p>As discussed in #228 this issue is to track progress and discuss implementation.</p>
<p>Off the top of my head, this seems decently simple. We'd just need a non-consuming <code>.get_matches_from_safe()</code>.</p>
<p>The idea being something like:</p>
<pre><code class="language-rust">fn main() {
    // build App like normal...

    // Start the interactive CLI
    loop {
        print!(&quot;&gt;&gt;&gt; &quot;);
        io::stdout().flush().unwrap();
        let mut s = String::new();
        io::stdin()
            .read_line(&amp;mut s)
            .ok()
            .expect(&quot;failed to read line&quot;);
        let mut argv: Vec&lt;_&gt; = s.trim().split(&quot; &quot;).collect();
        // you have to insert the binary name since clap expects it
        argv.insert(0, &quot;prog&quot;);
        match app.get_matches_from_safe_borrow(argv) {
            Ok(matches) =&gt; execute(matches),
            Err(e) =&gt; {
                // handle error, display message, etc.
                continue
            }
        }
    }

}

fn execute(m: ArgMatches) {
    // do stuff
}
</code></pre>
<p><strong>EDIT:</strong> Just tested this and works perfectly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @kbknapp on 2015-09-07 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> added by @kbknapp on 2015-09-07 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: intermediate</span> added by @kbknapp on 2015-09-07 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2015-09-07 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WildCryptoFox">@WildCryptoFox</a> on 2015-09-08 00:30</div>
            <div class="timeline-body"><p>Depending on the application, the current mock won't work with a single thread. Anything that has networking or other events, will need another thread. Might need to make sure that whatever the implementation ends up being, is suitable to fit with <code>mio</code>. I.e. Wake up on input. Also needs to be able to clear the prompt, insert messages and re-write the progress on the prompt. (Otherwise, messages will break input as the user types)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-09-08 01:16</div>
            <div class="timeline-body"><p>Ah yeah, I'm purely thinking single threaded. I'm pushing some changes which make the current mock up work in a single threaded environment, but beyond that it'll take a bit more massaging.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-09-08 01:19</div>
            <div class="timeline-body"><p>#236 is what I was talking about</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-09-08 01:20</div>
            <div class="timeline-body"><p>So maybe this is a base...or at least some building blocks to allow further work on this topic. Using with <code>mio</code> is an interesting idea or even across a network stream. You've piqued my interest :wink:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WildCryptoFox">@WildCryptoFox</a> on 2015-09-08 01:45</div>
            <div class="timeline-body"><p>I'm pretty sure it would just need to hook <code>mio</code> through using <code>stdin</code> as an <code>Evented</code> input; throwing all input into a buffer. When required forcefully delete the line, do so and print the respective information.</p>
<p>This logging could even hook <code>env_logger</code> to capture these messages to write with this policy too. My <code>scoped_log</code> crate already hooks <code>log</code> for tracking hierarchy in <code>mio</code>'s thread.</p>
<p>My expectation will be just some <code>struct Terminal</code> which the <code>mio</code> based application would include in it's server <code>struct</code> and just interact with it accordingly.</p>
<p><strong>Note</strong>: clap would at most need to implement <code>mio::Handler</code>, and have the consuming application map some token to our <code>struct Terminal</code>, who owns the stdin file descriptor.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/259.html">clap-rs/clap#259</a> on 2015-09-19 10:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wdv4758h">@wdv4758h</a> on 2016-07-29 15:14</div>
            <div class="timeline-body"><p>Using <code>mio</code> looks interesting. How does it go on now ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-04-05 18:34</div>
            <div class="timeline-body"><p>Closed due to inactivity. I don't personally see myself working on this anytime soon with so much else to work on. Perhaps this will come back up someday.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2017-04-05 18:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1471.html">clap-rs/clap#1471</a> on 2020-01-10 18:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benaryorg">@benaryorg</a> on 2022-02-09 16:26</div>
            <div class="timeline-body"><p>Only just now found this issue by chance and wanted to point over at <a href="https://github.com/benaryorg/dsa-cli">benaryorg/dsa-cli</a> which does implement something of sorts, albeit with clap 2.x and I'm not sure anything about that project is either production grade <em>or</em> current, but if anyone stumbles upon this, well, there's <em>something</em>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:31 UTC
    </footer>
</body>
</html>
