<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better documentation for --(&quot;hyphenated-name&quot;) longs with clap_app! macro - clap-rs/clap #919</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Better documentation for --(&quot;hyphenated-name&quot;) longs with clap_app! macro</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/919">#919</a>
        opened by <a href="https://github.com/robotmay">@robotmay</a>
        on 2017-03-28 12:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/robotmay">@robotmay</a> on 2017-03-28 12:44</div>
            <div class="timeline-body"><h3>Rust Version</h3>
<p>1.15.0</p>
<h3>Affected Version of clap</h3>
<p>2.22.1</p>
<h3>Expected Behavior Summary</h3>
<p>Adding options with similar but unique names separated by hyphens should not throw an error.</p>
<h3>Actual Behavior Summary</h3>
<p>Adding multiple options with similar names, like in the example below, causes numerous issues with duplicate long/short flags.</p>
<h3>Sample Code or Link to Sample Code</h3>
<pre><code>(@arg power_on_value: -o --power-on-value +takes_value &quot;Value for the pins when power should be on&quot;)
(@arg power_off_value: -f --power-off-value +takes_value &quot;Value for the pins when power should be off&quot;)
</code></pre>
<h3>Debug output</h3>
<p>Here's the output from the definitions as above:</p>
<pre><code>    Finished debug [unoptimized + debuginfo] target(s) in 2.15 secs
     Running `target/debug/lightship --pins 18 --http http://www.google.com/teapot`
thread 'main' panicked at 'Argument long must be unique

        --power is already in use', /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/parser.rs:125
stack backtrace:
   1:     0x5624e7c9caba - std::sys::imp::backtrace::tracing::imp::write::h3188f035833a2635
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42
   2:     0x5624e7c9f37f - std::panicking::default_hook::{{closure}}::h6385b6959a2dd25b
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:349
   3:     0x5624e7c9ef7e - std::panicking::default_hook::he4f3b61755d7fa95
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:365
   4:     0x5624e7c9f827 - std::panicking::rust_panic_with_hook::hf00b8130f73095ec
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:553
   5:     0x5624e7c9f664 - std::panicking::begin_panic::h6227f62cb2cdaeb4
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:515
   6:     0x5624e7c9f5d9 - std::panicking::begin_panic_fmt::h173eadd80ae64bec
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:499
   7:     0x5624e79f14f3 - clap::app::parser::Parser::debug_asserts::h5e3927975f9767bb
                        at /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/parser.rs:125
   8:     0x5624e79f2372 - clap::app::parser::Parser::add_arg::h03b60cbb45075aa5
                        at /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/parser.rs:217
   9:     0x5624e78e8844 - clap::app::App::arg::he7712f3aae28dd64
                        at /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/mod.rs:709
  10:     0x5624e78f9590 - lightship::main::h9a983c637a63540d
                        at /home/robotmay/Development/piratestudios/lightship/src/main.rs:82
  11:     0x5624e7ca674a - __rust_maybe_catch_panic
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98
  12:     0x5624e7c9ff66 - std::rt::lang_start::h65647f6e36cffdae
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:434
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panic.rs:351
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/rt.rs:57
  13:     0x5624e78fa692 - main
  14:     0x7fc54017082f - __libc_start_main
  15:     0x5624e78e4758 - _start
  16:                0x0 - &lt;unknown&gt;
</code></pre>
<p>Here's the output if you modify the two options to be <code>--poweron-value</code> and <code>--poweroff-value</code>:</p>
<pre><code>    Finished debug [unoptimized + debuginfo] target(s) in 2.20 secs
     Running `target/debug/lightship --pins 18 --http http://www.google.com/teapot`
thread 'main' panicked at 'Argument short must be unique

        -v is already in use', /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/parser.rs:130
stack backtrace:
   1:     0x557b8d9a5a7a - std::sys::imp::backtrace::tracing::imp::write::h3188f035833a2635
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42
   2:     0x557b8d9a833f - std::panicking::default_hook::{{closure}}::h6385b6959a2dd25b
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:349
   3:     0x557b8d9a7f3e - std::panicking::default_hook::he4f3b61755d7fa95
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:365
   4:     0x557b8d9a87e7 - std::panicking::rust_panic_with_hook::hf00b8130f73095ec
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:553
   5:     0x557b8d9a8624 - std::panicking::begin_panic::h6227f62cb2cdaeb4
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:515
   6:     0x557b8d9a8599 - std::panicking::begin_panic_fmt::h173eadd80ae64bec
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:499
   7:     0x557b8d6fa5dc - clap::app::parser::Parser::debug_asserts::h5e3927975f9767bb
                        at /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/parser.rs:130
   8:     0x557b8d6fb332 - clap::app::parser::Parser::add_arg::h03b60cbb45075aa5
                        at /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/parser.rs:217
   9:     0x557b8d5f1844 - clap::app::App::arg::he7712f3aae28dd64
                        at /home/robotmay/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.22.1/src/app/mod.rs:709
  10:     0x557b8d60254a - lightship::main::h9a983c637a63540d
                        at /home/robotmay/Development/piratestudios/lightship/src/main.rs:82
  11:     0x557b8d9af70a - __rust_maybe_catch_panic
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98
  12:     0x557b8d9a8f26 - std::rt::lang_start::h65647f6e36cffdae
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:434
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panic.rs:351
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/rt.rs:57
  13:     0x557b8d603652 - main
  14:     0x7f0b5227582f - __libc_start_main
  15:     0x557b8d5ed758 - _start
  16:                0x0 - &lt;unknown&gt;
</code></pre>
<p>It compiles fine if you swap them both to <code>poweronvalue</code> and <code>poweroffvalue</code>.</p>
<p>I hope this info helps. I think it's a bug, but I'm not familiar enough with the repo to fix it myself at the moment :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-03-28 18:22</div>
            <div class="timeline-body"><p>This is because to use hyphenated longs with the macro, you must use <code>--(&quot;some-hyphenated-name&quot;)</code> due to limitations of the Rust macro system.</p>
<p>I'll keep this open as a docs issue though, as that limitation should be clearly articulated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: docs</span> added by @kbknapp on 2017-03-28 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: macros</span> added by @kbknapp on 2017-03-28 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2017-03-28 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P2: need to have</span> added by @kbknapp on 2017-03-28 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by @kbknapp on 2017-03-28 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2017-03-28 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Issue with similar, but unique, hyphenated options" to "Better documentation for --("hyphenated-name") longs with clap_app! macro" by @kbknapp on 2017-03-28 18:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @homu on 2017-04-05 12:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:29 UTC
    </footer>
</body>
</html>
