```yaml
number: 1575
title: "method `parse` is private"
type: issue
state: closed
author: chris13524
labels: []
assignees: []
created_at: 2019-10-18T17:41:55Z
updated_at: 2020-09-16T17:17:09Z
url: https://github.com/clap-rs/clap/issues/1575
synced_at: 2026-01-12T16:14:11Z
```

# method `parse` is private

---

_@chris13524_

I'm using the new v3 macro parsing feature. I want to put my options structure in a separate file and import it in another file. However, when I try to call `parse()` on it, I get the error ```method `parse` is private```. How do I make this parse function public?

```
#[derive(Clap)]
#[clap(version = "0.1", author = "Chris Smith")]
#[derive(Debug)]
pub struct Options {
    #[clap(short = "l", long = "listen", default_value = "127.0.0.1")]
    pub listen_address: IpAddr,
    
    #[clap(short = "p", long = "port", default_value = "53")]
    pub listen_port: u16,
}
```

---

_Comment by @CreepySkeleton on 2019-10-18 19:10_

@chris13524 Are you sure *this* is the code sample to reproduce your issue? I can compile the sample just fine with:
```toml
[dependencies]
clap = { git = "https://github.com/clap-rs/clap" }
```

---

_Comment by @deg4uss3r on 2019-10-18 19:12_

@CreepySkeleton I am able to help reproduce this issue like so:

`main.rs`:
```rust
// (Full example with detailed comments in examples/01d_quick_example.rs)
//
// This example demonstrates clap's full 'custom derive' style of creating arguments which is the
// simplest method of use, but sacrifices some flexibility.
extern crate clap;

mod outside;

fn main() {
    let opts: outside::Opts = outside::Opts::parse();

    // Gets a value for config if supplied by user, or defaults to "default.conf"
    println!("Value for config: {}", opts.config);
    println!("Using input file: {}", opts.input);

    // Vary the output based on how many times the user used the "verbose" flag
    // (i.e. 'myprog -v -v -v' or 'myprog -vvv' vs 'myprog -v'
    match opts.verbose.unwrap_or(0) {
        0 => println!("No verbose info"),
        1 => println!("Some verbose info"),
        2 => println!("Tons of verbose info"),
        3 | _ => println!("Don't be crazy"),
    }

}
```

outside.rs:
```rust
// simplest method of use, but sacrifices some flexibility.
#[macro_use]
use clap::Clap;

/// This doc string acts as a help message when the user runs '--help'
/// as do all doc strings on fields
#[derive(Clap)]
#[clap(version = "1.0", author = "Kevin K.")]
pub struct Opts {
    /// Sets a custom config file. Could have been an Option<T> with no default too
    #[clap(short = "c", long = "config", default_value = "default.conf")]
    pub config: String,
    /// Some input. Because this isn't an Option<T> it's required to be used
    pub input: String, 
    /// A level of verbosity, and can be used multiple times
    #[clap(short = "v", long = "verbose")]
    pub verbose: Option<i32>,
    #[clap(subcommand)]
    pub subcmd: SubCommand,
}

#[derive(Clap)]
pub enum SubCommand {
    /// A subcommand for controlling testing
    #[clap(name = "test", version = "1.3", author = "Someone Else")]
    Test {
        /// Print debug info 
        #[clap(short = "d")]
        debug: bool
    }
}
```

Getting the same error: 
```
error[E0624]: method `parse` is private
  --> src/main.rs:10:31
   |
10 |     let opts: outside::Opts = outside::Opts::parse();
   |                               ^^^^^^^^^^^^^^^^^^^^

error: aborting due to previous error
```

Looking into how to fix it now, any suggestions? 

---

_Comment by @CreepySkeleton on 2019-10-18 19:24_

@chris13524 @deg4uss3r It looks like [`fn parse()` generated by `clap_derive` is not `pub`](https://github.com/clap-rs/clap_derive/blob/4a46684b1c522fe3fd45d653d6ba6c7cb885baa5/src/derives/clap.rs#L315), so it's local to the module your `Options` placed in. Workaround here is to reexport the `fn` manually 
```rust
/////////////
// outside.rs
pub fn parse_opts() -> Opts {
    Opts::parse()
}

/////////////
// main.rs

fn main() {
    let opts: outside::Opts = outside::parse_opts();
}
```


---

_Comment by @deg4uss3r on 2019-10-18 19:32_

the question is should these functions in `clap_derive` **be** public? If so I'm happy to put in a quick PR

---

_Comment by @chris13524 on 2019-10-18 19:36_

@deg4uss3r I think some libraries have flags that allow you to choose the visibility. For instance [this](https://docs.rs/crate/derive_builder/0.8.0) one.

---

_Referenced in [clap-rs/clap_derive#21](../../clap-rs/clap_derive/pulls/21.md) on 2019-10-18 19:55_

---

_Comment by @CreepySkeleton on 2020-02-01 11:29_

This is fixed. Furthermore, we're planning to change this stuff so it will   become irrelevant soon.

---

_Closed by @CreepySkeleton on 2020-02-01 11:29_

---

_Comment by @chris13524 on 2020-09-16 15:38_

@CreepySkeleton could you expand on how this is becoming irrelevant?

---

_Comment by @CreepySkeleton on 2020-09-16 17:17_

The methods have been moved to traits. Visibility doesn't apply to trait methods - they are always public.

---
