<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improve documentation for clap::Args::augment_args and clap::Args::augment_args_for_update - clap-rs/clap #5682</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Improve documentation for clap::Args::augment_args and clap::Args::augment_args_for_update</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/clap-rs/clap/issues/5682">#5682</a>
        opened by <a href="https://github.com/nwalfield">@nwalfield</a>
        on 2024-08-16 16:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/nwalfield">@nwalfield</a> on 2024-08-16 16:43</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Rust Version</h3>
<p>rustc 1.75.0 (82e1608df 2023-12-21)</p>
<h3>Clap Version</h3>
<p>4.4.18</p>
<h3>Minimal reproducible code</h3>
<p>Read the documentation for <a href="https://docs.rs/clap/4.5.16/clap/trait.Args.html"><code>clap::Args</code></a>:</p>
<blockquote>
<p><code>fn</code> <a href="https://docs.rs/clap/4.5.16/clap/trait.Args.html#tymethod.augment_args"><code>augment_args</code></a>(cmd: <a href="https://docs.rs/clap/4.5.16/clap/struct.Command.html">Command</a>) -&gt; <a href="https://docs.rs/clap/4.5.16/clap/struct.Command.html">Command</a>`</p>
<p>Append to <a href="https://docs.rs/clap/4.5.16/clap/struct.Command.html">Command</a> so it can instantiate Self.</p>
<p>See also <a href="https://docs.rs/clap/4.5.16/clap/trait.CommandFactory.html">CommandFactory</a>.
<a href="https://docs.rs/clap_builder/4.5.15/x86_64-unknown-linux-gnu/src/clap_builder/derive.rs.html#228">source</a></p>
<p><code>fn</code> <a href="https://docs.rs/clap/4.5.16/clap/trait.Args.html#tymethod.augment_args_for_update"><code>augment_args_for_update</code></a>(cmd: <a href="https://docs.rs/clap/4.5.16/clap/struct.Command.html">Command</a>) -&gt; <a href="https://docs.rs/clap/4.5.16/clap/struct.Command.html">Command</a>`</p>
<p>Append to <a href="https://docs.rs/clap/4.5.16/clap/struct.Command.html">Command</a> so it can update self.</p>
<p>This is used to implement #[command(flatten)]</p>
<p>See also <a href="https://docs.rs/clap/4.5.16/clap/trait.CommandFactory.html">CommandFactory</a>.</p>
</blockquote>
<p>The documentation does not describe how to implement <a href="https://docs.rs/clap/4.5.16/clap/trait.Args.html#tymethod.augment_args"><code>Args::augment_args</code></a> or <a href="https://docs.rs/clap/4.5.16/clap/trait.Args.html#tymethod.augment_args_for_update"><code>Args::augment_args_for_update</code></a>, and it only hints at the difference between them.  The documentation links to <a href="https://docs.rs/clap/4.5.16/clap/trait.CommandFactory.html"><code>CommandFactory</code></a>, but that doesn't really help either.  The <a href="https://github.com/clap-rs/clap/blob/704d0e7/examples/derive_ref/flatten_hand_args.rs"><code>flatten_hand_args.rs</code> example</a> provides a basic idea, but I still have to guess at the semantics.  Further, the example's implementation of <code>augment_args</code> and <code>augment_args_for_update</code> are identical, which is baffling.  I tried reading the source code, but still couldn't figure out the difference between the two.</p>
<h3>Steps to reproduce the bug with the above code</h3>
<p>Read the above documentation.</p>
<h3>Actual Behaviour</h3>
<p>The current documentation is missing details.  The example is good, but incomplete.</p>
<h3>Expected Behaviour</h3>
<p>The documentation should describe the semantics of the two methods.  It should also make clearer what the difference between the two is (what does <em>so it can instantiate Self</em> vs <em>so it can update Self</em> mean).</p>
<h3>Additional Context</h3>
<p>This seemed like the most appropriate template for this documentation issue.  I apologize if I should have chosen a different template.</p>
<h3>Debug Output</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by @nwalfield on 2024-08-16 16:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-16 19:12</div>
            <div class="timeline-body"><p>5488bcfa, df165a2d, a3a47640 tweaked the wording.</p>
<p>Whether the <code>update</code> calls need any different logic is dependent on the situation.  The main situation I can remember when polishing it up for release was that there are no required arguments.</p>
<p>Overall, <code>update</code> adds a lot of complexity for a very small number of users that I am tempted to just remove it (#4974).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:09 UTC
    </footer>
</body>
</html>
