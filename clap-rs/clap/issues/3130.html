<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parse command line on existing config instance - clap-rs/clap #3130</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Parse command line on existing config instance</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/3130">#3130</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2021-12-09 16:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:34</div>
            <div class="timeline-body"><p><a href="https://github.com/Morganamilo"><img src="https://avatars.githubusercontent.com/u/16593899?v=4" align="left" width="96" height="96" hspace="10"></img></a> <strong>Issue by <a href="https://github.com/Morganamilo">Morganamilo</a></strong>
<em>Saturday Jul 25, 2020 at 10:26 GMT</em>
<em>Originally opened as https://github.com/TeXitoi/structopt/issues/416</em></p>
<hr />
<p>There have been a couple of issues to allow parsing from a config file.</p>
<p>What I want is something more flexible. Instead of having to do <code>Config::from_args()</code>, I would Like to be able to do. <code>let mut config = Config::new(); config.parse_args()</code>.</p>
<p>This would allow for config parsing and any other processing to happen before parsing arguments.</p>
<pre><code class="language-rust">let mut config = Config::new();
config.parse_config(config_file);
config.parse_args();
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:34</div>
            <div class="timeline-body"><p><a href="https://github.com/CreepySkeleton"><img src="https://avatars.githubusercontent.com/u/50968528?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/CreepySkeleton">CreepySkeleton</a></strong>
<em>Sunday Jul 26, 2020 at 19:34 GMT</em></p>
<hr />
<p>Could you please say a few more words? Your comment doesn't give me any useful context or new information. Most importantly, I would appreciate an elaborated explanation of how your request is different from #72 .</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:34</div>
            <div class="timeline-body"><p><a href="https://github.com/Morganamilo"><img src="https://avatars.githubusercontent.com/u/16593899?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/Morganamilo">Morganamilo</a></strong>
<em>Sunday Jul 26, 2020 at 19:48 GMT</em></p>
<hr />
<p>#72 seems to want to integrate with some config parsing crate.</p>
<p>I simply want the Structopt trait to be able to operate on an already existing struct instance. While <code>from_args()</code> creates the struct for  you, I want <code>parse_args()</code> to take in <code>&amp;mut self</code> instead.</p>
<p>In my example above <code>parse_config()</code> is unrelated to structopt and would be a function implemented myself.</p>
<pre><code class="language-rust">let mut config = Config::new(); // create an instance of my struct that implements Structopt
config.parse_config(config_file); // my own config parsing, make sure we do this before arg parsing so args have priority
config.parse_args(); //  structopt now modifies the struct and applies the arguments on top of the existing values
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:34</div>
            <div class="timeline-body"><p><a href="https://github.com/CreepySkeleton"><img src="https://avatars.githubusercontent.com/u/50968528?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/CreepySkeleton">CreepySkeleton</a></strong>
<em>Monday Jul 27, 2020 at 05:32 GMT</em></p>
<hr />
<p>I see. I don't think I'll ever be working on it (I'm simply not interested), but I'd approve such a PR.</p>
<p>We will need to decide on the precise specification (update vs replace aka <code>config[true] + args[false] = false</code> vs <code>= true</code>) and the signature (the <code>parse_args</code> takes <code>enum { Replace, Update }</code>), but I think we can discuss it when somebody has actually stepped in and volunteered.</p>
<p>This should also solve #72 as &quot;good enough&quot; solution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:37</div>
            <div class="timeline-body"><p>The new update API I think covers this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2021-12-09 16:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-derive</span> added by @epage on 2021-12-09 16:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:46 UTC
    </footer>
</body>
</html>
