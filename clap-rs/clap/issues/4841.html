<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prettier typography when `unicode` feature is set? - clap-rs/clap #4841</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Prettier typography when <code>unicode</code> feature is set?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/4841">#4841</a>
        opened by <a href="https://github.com/virtualritz">@virtualritz</a>
        on 2023-04-17 17:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/virtualritz">@virtualritz</a> on 2023-04-17 17:52</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.2</p>
<h3>Describe your use case</h3>
<p>A typical example is the ellipsis for arguments that can be specified multiple times or quotes in help texts.</p>
<p>Consider this:</p>
<pre><code>Options:
  -v, --verbose...  Verbosity level ('-v', '-vv', '-vvv', etc.)
  -h, --help        Print help (see more with '--help')
</code></pre>
<p>vs.:</p>
<pre><code>Options:
  -v, --verbose…  Verbosity level (‘-v’, ‘-vv’, ‘-vvv’, etc.)
  -h, --help      Print help (see more with ‘--help’)
</code></pre>
<h3>Describe the solution you'd like</h3>
<p>I'm interested in working on this if it had a chance for a PR to be accepted.</p>
<p>I would probably add another feature flag, <code>typography</code> that depends on <code>unicode</code> so users are not forced to use this just because they have the latter switched on.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @virtualritz on 2023-04-17 17:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-17 18:11</div>
            <div class="timeline-body"><p>Personally, I've never had a good experience with paired quotes or smart quotes...</p>
<p>I see this not just a question of whether this is enabled in a feature flag but whether the terminal supports it.  There are crates like https://crates.io/crates/supports-unicode to help with that.</p>
<p>Probably my biggest concern is that there are so few places that this is relevant that the benefits would not outweigh the costs (code complexity, build times, binary size).  Yes, some of those can be toggled with feature flags but those have their own complexity and I try to keep the number of feature flags down (we already have more than I'd like)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-decision</span> added by @epage on 2023-04-17 18:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by @epage on 2023-04-17 18:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/virtualritz">@virtualritz</a> on 2023-04-17 18:46</div>
            <div class="timeline-body"><p>I'm not sure what 'good experience' means here. For example, <code>docs.rs</code> does smart quotes and dashes (<code>--</code> becomes an en-dash etc.) via some <a href="https://daringfireball.net/projects/smartypants/">Smartypants</a>-like implementation. And this is not opt-in, afaik.</p>
<p>But I wasn't talking about this. I was solelty talking about the parts of help text that are generated by/built-into <code>clap</code>.
I was not talking about a custom Smartypants-like implementation that swaps stuff out at runtime (or compile time, via a macro) in user help strings.</p>
<p>I.e. in the above case, the <code>--help</code> text and the ellipsis on <code>--verbose</code> are from <code>clap</code> but the user would be responsible to use matching quotes in their text for the <code>--verbose</code> flag. And I think this is acceptable as someone who cares about <code>unicode</code> stuff in their help would likely go the extra mile for the same reason they need this feature in the first place: to have stuff look neater/more polished.</p>
<p>So all this would be for now would be some string constants looking different when a feature flag is set. I.e. binary size/code complexity would be the same.</p>
<p>I do see your point with feature flag creep though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/virtualritz">@virtualritz</a> on 2023-04-17 18:50</div>
            <div class="timeline-body"><blockquote>
<p>I see this not just a question of whether this is enabled in a feature flag but whether the terminal supports it.</p>
</blockquote>
<p>Do I understand this correctly that <code>clap</code> already filters user strings for unicode codepoints outside ASCII and replaces them when <code>unicode</code> is set and it detects a terminal that doesn't support it? With what are they replaced?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-17 18:57</div>
            <div class="timeline-body"><p><code>clap</code> only does filtering for ANSI escape codes.</p>
<p>The <code>unicode</code> feature is for things like</p>
<ul>
<li>calculating how many columns some help text takes up so we know when to wrap.</li>
<li>case insensitive comparisons</li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:50 UTC
    </footer>
</body>
</html>
