<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change default help and version message to infinitive form - clap-rs/clap #2500</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Change default help and version message to infinitive form</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/2500">#2500</a>
        opened by <a href="https://github.com/ajeetdsouza">@ajeetdsouza</a>
        on 2021-05-26 19:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ajeetdsouza">@ajeetdsouza</a> on 2021-05-26 19:25</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
<h3>Describe your use case</h3>
<p>There are two problems here.</p>
<ol>
<li><code>clap</code> uses an unconventional sentence form in its auto-generated help messages (i.e. <code>&quot;Prints a help message&quot;</code> vs <code>&quot;Print a help message&quot;</code>). A lot of users (as shown in the links above) would like to change this, because practically every other UNIX program shows it in the infinitive form:</li>
</ol>
<pre><code class="language-sh">$ grep --help
-b, --byte-offset    print the byte offset with output lines

$ git init --help
--bare    create a bare repository

$ rg -h
--debug    Show debug messages.
</code></pre>
<ol start="2">
<li>There's no way to set this help message manually if you use <code>clap_derive</code>.</li>
</ol>
<h3>Describe the solution you'd like</h3>
<p>I'd like a way to set <code>global_help_message</code> and <code>global_version_message</code> in my app.</p>
<h3>Alternatives, if applicable</h3>
<p><code>app.mut_arg(&quot;help&quot;, |a| a.about(&quot;help info&quot;))</code> is a solution, but it does not work for apps using <code>clap_derive</code>.</p>
<h3>Additional Context</h3>
<p>There's plenty of demand for this feature:</p>
<ul>
<li>https://github.com/clap-rs/clap/issues/2080</li>
<li>https://github.com/clap-rs/clap/issues/1640</li>
<li>https://github.com/clap-rs/clap/issues/1646</li>
<li>https://github.com/clap-rs/clap/issues/1512</li>
<li>https://github.com/clap-rs/clap/issues/889</li>
<li>https://github.com/clap-rs/clap/issues/1665</li>
<li>https://github.com/clap-rs/clap/discussions/2152</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @ajeetdsouza on 2021-05-26 19:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-05-26 23:46</div>
            <div class="timeline-body"><ol>
<li>We can change the default help string in clap.</li>
<li>You can use <code>mut_arg(&quot;help&quot;, |a| a.about(&quot;help info&quot;))</code> in clap_derive. Try pasting that on a struct in clap attribute.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ajeetdsouza">@ajeetdsouza</a> on 2021-05-27 05:44</div>
            <div class="timeline-body"><ol>
<li>Would you be open to accepting a PR to change the default string?</li>
<li>Perhaps I'm doing something wrong, but I wasn't able to get this working. I'm using this on a struct with <code>AppSettings::DisableHelpSubcommand</code> and I ran it with <code>cargo run -- -h</code>:</li>
</ol>
<pre><code class="language-sh"># mut_arg(&quot;-h&quot;, |a| a.about(&quot;help info&quot;))
USAGE:
    app [-h] &lt;SUBCOMMAND&gt;

ARGS:
    &lt;-h&gt;    help info

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information
</code></pre>
<pre><code class="language-sh"># mut_arg(&quot;--help&quot;, |a| a.about(&quot;help info&quot;))
USAGE:
    zoxide [--help] &lt;SUBCOMMAND&gt;

ARGS:
    &lt;--help&gt;    help info

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information
</code></pre>
<pre><code class="language-sh"># mut_arg(&quot;help&quot;, |a| a.about(&quot;help info&quot;))
error: Found argument '-h' which wasn't expected, or isn't valid in this context

If you tried to supply `-h` as a PATTERN use `-- -h`

USAGE:
    zoxide [help] &lt;SUBCOMMAND&gt;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-05-27 09:43</div>
            <div class="timeline-body"><ol>
<li><p>Yes.</p>
</li>
<li><p>Try master</p>
</li>
</ol>
<p>On Thu, May 27, 2021, 06:44 ajeetdsouza <em><strong>@</strong></em>.***&gt; wrote:</p>
<blockquote>
<ol>
<li>Would you be open to accepting a PR to change the default string?</li>
<li>Perhaps I'm doing something wrong, but I wasn't able to get this
working. I'm using this on a struct with
AppSettings::DisableHelpSubcommand and I ran it with cargo run -- -h:</li>
</ol>
<h1>mut_arg(&quot;-h&quot;, |a| a.about(&quot;help info&quot;))</h1>
<p>USAGE:
app [-h] <SUBCOMMAND></p>
<p>ARGS:
&lt;-h&gt;    help info</p>
<p>FLAGS:
-h, --help       Prints help information
-V, --version    Prints version information</p>
<h1>mut_arg(&quot;--help&quot;, |a| a.about(&quot;help info&quot;))</h1>
<p>USAGE:
zoxide [--help] <SUBCOMMAND></p>
<p>ARGS:
&lt;--help&gt;    help info</p>
<p>FLAGS:
-h, --help       Prints help information
-V, --version    Prints version information</p>
<h1>mut_arg(&quot;help&quot;, |a| a.about(&quot;help info&quot;))</h1>
<p>error: Found argument '-h' which wasn't expected, or isn't valid in this context</p>
<p>If you tried to supply <code>-h</code> as a PATTERN use <code>-- -h</code></p>
<p>USAGE:
zoxide [help] <SUBCOMMAND></p>
<p>â€”
You are receiving this because you commented.
Reply to this email directly, view it on GitHub
<a href="https://github.com/clap-rs/clap/issues/2500#issuecomment-849339774">https://github.com/clap-rs/clap/issues/2500#issuecomment-849339774</a>, or
unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/AABKU36F4BU5SUEMW2RNIZDTPXL5VANCNFSM45SW3DKA">https://github.com/notifications/unsubscribe-auth/AABKU36F4BU5SUEMW2RNIZDTPXL5VANCNFSM45SW3DKA</a>
.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Bring back help_message and version_message" to "Change default help and version message to infinitive form" by @ajeetdsouza on 2021-05-27 11:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ajeetdsouza">@ajeetdsouza</a> on 2021-05-27 11:56</div>
            <div class="timeline-body"><ol>
<li>Thanks! I tried doing a simple find-and-replace for this, but a couple of tests have started failing due to whitespace issues (which are impossible to track down due to the way they're printed). Have you considered using some diff library like <a href="https://crates.io/crates/pretty_assertions"><code>pretty_assertions</code></a> so that whitespace issues can be detected more easily?</li>
<li>Just checked, this is fixed on master.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-05-27 12:05</div>
            <div class="timeline-body"><p>Make sure that you save without formatting the <code>tests/help.rs</code> while fixing the tests and it should be okay. We have an issue with no version printing blank space that's being tracked.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ajeetdsouza">@ajeetdsouza</a> on 2021-05-27 12:16</div>
            <div class="timeline-body"><p>I did save without formatting, and then I disabled removing trailing whitespaces in the settings, but VS Code simply refused to stop formatting the line. It's probably a bug. I resorted to just using <code>sed</code>:</p>
<pre><code class="language-sh">sed -i 's/Prints version information/Print version information/g'  **/*.*
sed -i 's/Prints help information/Print help information/g'  **/*.*
sed -i 's/Prints this message or the help of the given subcommand/Print this message or the help of the given subcommand/g'  **/*.*
</code></pre>
<p>Now, a lot more tests pass, but a few are still failing due to whitespace issues. I switched to <code>pretty_assertions</code> locally to see what was going on, apparently a bunch of random whitespace is being inserted towards the end of the help string, not sure why.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-06-01 21:49</div>
            <div class="timeline-body"><p>As I said, We have an issue with no version printing blank space that's being tracked.</p>
<p>If you change only the messages without any whitespace changes, it should be fixed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> removed by @pksunkara on 2021-06-01 21:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by @pksunkara on 2021-06-01 21:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @pksunkara on 2021-06-01 21:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by @pksunkara on 2021-06-01 21:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">:money_with_wings: $5</span> added by @pksunkara on 2021-06-08 23:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2642.html">clap-rs/clap#2642</a> on 2021-07-30 03:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-07-30 07:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:08 UTC
    </footer>
</body>
</html>
