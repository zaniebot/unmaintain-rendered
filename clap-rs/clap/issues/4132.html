<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Polishing `--help` output - clap-rs/clap #4132</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Polishing `--help` output</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/4132">#4132</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2022-08-27 00:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/epage">@epage</a> on 2022-08-27 00:59</div>
            <div class="timeline-body"><p>We are looking to polish the help as part of the v4 release since some parts of an applications help might be dependent on how clap renders things (e.g. to match clap's ALL CAPS <a href="https://docs.rs/clap/latest/clap/builder/struct.App.html#method.next_help_heading">help headings</a>, a user might put theirs in ALL CAPS).</p>
<p>So far we have made the following changes:</p>
<ul>
<li>The greens and yellows are gone, instead using bold, underline, and ~~dimmed~~: <a href="https://github.com/clap-rs/clap/pull/4117">PR 4117</a> though <a href="https://github.com/clap-rs/clap/issues/3108">some more work might be needed to enable colored help, depending on the needs</a><ul>
<li><strong>See PR for screenshot</strong></li>
<li>Dimmed was removed from placeholders in https://github.com/clap-rs/clap/pull/4126</li>
<li>Some liked the colors (<a href="https://github.com/clap-rs/clap/issues/4132#issuecomment-1229099561">example</a>), some hated them (<a href="https://github.com/clap-rs/clap/discussions/2906">example</a>)</li>
<li>Color makes it easier to scan</li>
<li>Some applications have specific branding that it clashed with (#2963)</li>
<li>True colors would be prettier but requires getting into terminal theme detection to make sure it plays nice and hesistant to do that at the moment</li>
<li><strong>Users can't rollback until theming support is in (https://github.com/clap-rs/clap/issues/3234) though they can just disable the coloring with <code>Command::disable_colored_help(true)</code></strong></li>
</ul>
</li>
<li>Reduce the ALL CAPS: <a href="https://github.com/clap-rs/clap/pull/4123">PR 4123</a><ul>
<li><strong>See PR for screenshot</strong></li>
<li>ARGS and OPTIONS matched the usage and worked as non-colored headings but it feels a bit unpolished</li>
<li>I was hard pressed to find other CLIs that do this</li>
<li>All caps mirrors man pages</li>
<li>Mixed with underlining, it can be hard to see the bottom of &quot;y&quot;, &quot;g&quot;, etc.</li>
<li><strong>Users can rollback to the old behavior with <code>Command::help_template</code>, <code>Command:subcommand_help_heading</code>, and <code>Arg::help_heading</code></strong></li>
</ul>
</li>
<li>List subcommands before args/options: <a href="https://github.com/clap-rs/clap/pull/4125">PR 4125</a><ul>
<li><strong>See PR for screenshot</strong></li>
<li>At the end represents where someone might put it in the usage compared to everything else but generally a user's primary focus is on the subcommand they are going to call so that is where the help's focus should be</li>
<li><strong>Users can rollback to the old behavior with <code>Command::help_template</code></strong></li>
</ul>
</li>
<li>List of positional Arguments use <code>[]</code> for optional <a href="https://github.com/clap-rs/clap/pull/4144">PR 4144</a></li>
<li>Always show optional positional arguments in usage, rather than collapsing them <a href="https://github.com/clap-rs/clap/pull/4151">PR 4151</a><ul>
<li>Generally there will be few enough positional arguments that this shouldn't be a big deal</li>
<li>Optional flags/options can be more numerous and clog up the usage, making it impossible to deal with (e.g. <code>git</code>)</li>
</ul>
</li>
<li>Renaming SUBCOMMAND value name and Subcommand section headers to COMMAND and Command: <a href="https://github.com/clap-rs/clap/pull/4155">PR 4155</a><ul>
<li>&quot;Subcommand&quot; looks weird to me</li>
<li>Hard pressed to find other CLIs that do this</li>
<li><strong>Users can rollback to the old behavior with <code>Command::subcommand_help_heading</code> and <code>Command::subcommand_value_name</code></strong></li>
</ul>
</li>
<li>Hint to the user the difference between <code>-h</code> and <code>--help</code>: <a href="https://github.com/clap-rs/clap/pull/4159">PR 4159</a></li>
<li>Remove <code>&lt;name&gt; &lt;verson&gt;</code> from the start of <code>--help</code>: <a href="https://github.com/clap-rs/clap/pull/4160">PR 4160</a><ul>
<li>It takes up precious vertical space but doesn't seem justified, especially when <code>--version</code> exists and when a subcommand doesn't have a version, it feels out of place (see <code>cargo check -h</code>)</li>
<li>Again, hard pressed to find other CLIs that do this</li>
<li>This does leave where to put authors if people specify them</li>
<li>Since all help is rendered from a template, this runs into problems when <code>Command::about</code> is unspecified as it leaves a blank line at the top of the help.  https://github.com/clap-rs/clap/pull/4156 resolves that</li>
<li><strong>Users can rollback to the old behavior with <code>Command::help_template</code></strong></li>
</ul>
</li>
<li>Collapse usage to one line <a href="https://github.com/clap-rs/clap/pull/4188">PR 4188</a><ul>
<li>After looking at several CLIs, it seemed to fit and helps reduce length of output</li>
<li>See https://github.com/clap-rs/clap/issues/4132#issuecomment-1233007144 for alternatives considered</li>
</ul>
</li>
<li>Reduce blank lines when overflowing short help onto next line <a href="https://github.com/clap-rs/clap/pull/4190">PR 4190</a></li>
<li>Reduce indentation from 4 to 2 to reduce the chance of wrapping <a href="https://github.com/clap-rs/clap/pull/4192">PR 4192</a><ul>
<li>flags/options already have a lot of whitespace, we probably don't need as much everywhere</li>
<li>Inspired by <code>podman -h</code></li>
<li>While https://github.com/clap-rs/clap/pull/4161 will make it easier to do on the implementation side, I'm losing steam and don't want to go update all of those tests</li>
</ul>
</li>
</ul>
<p>Rejected</p>
<ul>
<li>Some CLIs put Usage before the <code>&lt;about&gt;</code> and collapse it to <code>Usage: &lt;usage&gt;</code> if its a single line (e.g. <code>find --help</code>)<ul>
<li>Putting usage closer to the arguments seems better</li>
<li>Otherwise, the difference seems trivial without a reason to go one way or the other</li>
</ul>
</li>
<li>Should Arguments and Options be under a single heading by default?<ul>
<li>I feel like there is a distinct enough difference in how they are used to call them out separately</li>
<li>A user can force them to be merged via <code>Arg::help_heading</code></li>
</ul>
</li>
</ul>
<p>Future improvements</p>
<ul>
<li>https://github.com/clap-rs/clap/issues/2389</li>
<li>https://github.com/clap-rs/clap/issues/3234</li>
<li>https://github.com/clap-rs/clap/issues/3108</li>
<li>https://github.com/clap-rs/clap/issues/1433</li>
<li>https://github.com/clap-rs/clap/issues/1553</li>
</ul>
<p><strong>Note:</strong> While I mentioning non-clap CLIs, I want to be clear that we don't just want to conform to what is out there.  We should be aiming to make the defaults as polished as possible which can include taking inspiration from others.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2022-08-27 00:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by @epage on 2022-08-27 00:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2022-08-27 00:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "4.0" by @epage on 2022-08-27 00:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 01:30</div>
            <div class="timeline-body"><p>Gonna dump some comparisons/notes here and then do a summary of my thoughts once I've seen it all.</p>
<p>Here's a before (3.2.17, left) and after (current git tip, right) of <a href="https://github.com/rust-minidump/rust-minidump/blob/main/minidump-stackwalk/src/main.rs">minidump-stackwalk</a> on powershell:</p>
<p>Fixes I needed to make (fairly painless with <a href="https://github.com/clap-rs/clap/blob/master/CHANGELOG.md">the CHANGELOG's advice, nice!</a>):</p>
<ul>
<li><code>possible_values = [...]</code> =&gt; <code>value_parser([...])</code></li>
<li><code>DeriveDisplayOrder</code> =&gt; <code>&lt;deleted, now the default, sick!&gt;</code></li>
</ul>
<p><img src="https://user-images.githubusercontent.com/1136864/187008852-27f35481-4eb8-4fee-a335-30905782e30d.png" alt="image" />
<img src="https://user-images.githubusercontent.com/1136864/187008886-b0f78ca4-c7bc-40fc-9e0c-943ebd2e0562.png" alt="image" />
<img src="https://user-images.githubusercontent.com/1136864/187008900-63b567f0-24c8-4cc7-b1fd-2182166ed3f3.png" alt="image" />
<img src="https://user-images.githubusercontent.com/1136864/187008909-a11e896c-d2b8-4099-b7ba-493c12083a04.png" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 01:41</div>
            <div class="timeline-body"><blockquote>
<p>Here's a before (3.2.17, left) and after (current git tip, right) of <a href="https://github.com/rust-minidump/rust-minidump/blob/main/minidump-stackwalk/src/main.rs">minidump-stackwalk</a> on powershell:</p>
<p>Fixes I needed to make ...</p>
</blockquote>
<p>For anyone else, I want to say that I only consider the changelog to be in draft form at the moment plus we'll write a migration guide like we did for clap 3.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 01:49</div>
            <div class="timeline-body"><p><a href="https://github.com/mozilla/cargo-vet/blob/main/src/cli.rs">cargo-vet</a> (this one is a bit messier because we have proper subcommands so lining things up is gonna be wonky...):</p>
<p>required diff</p>
<pre><code class="language-diff">@@ -215,6 +225,18 @@ dependencies = [
PS C:\Users\ninte\dev\cargo-vet&gt; git diff .\src\cli.rs
diff --git a/src/cli.rs b/src/cli.rs
index f19d89d..2ad2914 100644
--- a/src/cli.rs
+++ b/src/cli.rs
@@ -18,7 +18,6 @@ pub enum FakeCli {
 #[clap(version)]
 #[clap(bin_name = &quot;cargo vet&quot;)]
 #[clap(args_conflicts_with_subcommands = true)]
-#[clap(global_setting(clap::AppSettings::DeriveDisplayOrder))]
 /// Supply-chain security for Rust
 ///
 /// When run without a subcommand, `cargo vet` will invoke the `check`
@@ -30,7 +29,7 @@ pub struct Cli {

     // Top-level flags
     /// Path to Cargo.toml
-    #[clap(long, name = &quot;PATH&quot;, parse(from_os_str))]
+    #[clap(long, name = &quot;PATH&quot;, value_parser)]
     #[clap(help_heading = &quot;GLOBAL OPTIONS&quot;, global = true)]
     pub manifest_path: Option&lt;PathBuf&gt;,

@@ -48,7 +47,7 @@ pub struct Cli {
     pub no_default_features: bool,

     /// Space-separated list of features to activate
-    #[clap(long, action, require_value_delimiter = true, value_delimiter = ' ')]
+    #[clap(long, action, value_delimiter = ' ')]
     #[clap(help_heading = &quot;GLOBAL OPTIONS&quot;, global = true)]
     pub features: Vec&lt;String&gt;,

@@ -73,7 +72,7 @@ pub struct Cli {
     /// How verbose logging should be (log level)
     #[clap(long, action)]
     #[clap(default_value_t = LevelFilter::WARN)]
-    #[clap(possible_values = [&quot;off&quot;, &quot;error&quot;, &quot;warn&quot;, &quot;info&quot;, &quot;debug&quot;, &quot;trace&quot;])]
+    #[clap(value_parser([&quot;off&quot;, &quot;error&quot;, &quot;warn&quot;, &quot;info&quot;, &quot;debug&quot;, &quot;trace&quot;]))]
     #[clap(help_heading = &quot;GLOBAL OPTIONS&quot;, global = true)]
     pub verbose: LevelFilter,
</code></pre>
<p><img src="https://user-images.githubusercontent.com/1136864/187009404-9da3125b-ad42-4324-8283-35f57dfeeb06.png" alt="image" />
<img src="https://user-images.githubusercontent.com/1136864/187009413-ad403abb-aa31-469f-9685-b4db226612a1.png" alt="image" />
<img src="https://user-images.githubusercontent.com/1136864/187009446-2dcd11ec-016b-447b-a835-02208c6944c6.png" alt="image" />
<img src="https://user-images.githubusercontent.com/1136864/187009490-5bd70185-ff91-41ee-95e9-1237d9b252b7.png" alt="image" /></p>
<p>Looking at subcommand's --help:</p>
<p><img src="https://user-images.githubusercontent.com/1136864/187009533-d7a56cc2-5b78-483f-b25a-3eb96765a431.png" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 01:54</div>
            <div class="timeline-body"><p>@Gankra</p>
<p>Tip: <code>value_parser</code> (without a value) was only needed in clap 3.2 to opt-in to the new clap v4 behavior.  In v4 it is assumed and not needed.</p>
<pre><code class="language-diff">@@ -30,7 +29,7 @@ pub struct Cli {
     // Top-level flags
     /// Path to Cargo.toml
-    #[clap(long, name = &quot;PATH&quot;, parse(from_os_str))]
+    #[clap(long, name = &quot;PATH&quot;, value_parser)]
     #[clap(help_heading = &quot;GLOBAL OPTIONS&quot;, global = true)]
     pub manifest_path: Option&lt;PathBuf&gt;,
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 01:59</div>
            <div class="timeline-body"><p>Seeing <code>cargo-vet-vert-certify</code></p>
<ul>
<li>I think there is a bug with the positional arguments, they should probably be using <code>[]</code></li>
<li>We collapse options because there can be so many but we should probably not collapse down to <code>[ARGS]</code> as that is most likely the core of what people are doing and the usage is a bit meaningless otherwise.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 02:02</div>
            <div class="timeline-body"><p>Seeing <code>--filter-graph</code>s help, you might find https://github.com/clap-rs/clap/issues/3108 useful (ie allow formatting in user provided strings).  Everything in the v4 API that accepts <code>StyledStr</code> will allow user styling once we implement #3108.  We have a placeholder type in there for now so it isn't a breaking change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 02:07</div>
            <div class="timeline-body"><p>So the fact that <code>cargo-vet 0.3.0</code> and <code>cargo-vet-certify 0.3.0</code> is now <code>cargo-vet-vet 0.3.0</code> and <code>cargo-vet-vet-certify 0.3.0</code> seems like a minor regression/mess for cargo-subcommands, not sure if the CHANGELOG notes something about this or if I'm using the wrong &quot;hack&quot; for cargo-subcommands to work right.</p>
<p>I definitely like that subcommands come first! I had been considering a hack to do that in the <a href="https://mozilla.github.io/cargo-vet/commands.html">post-processed markdown version of this output</a> (<a href="https://github.com/mozilla/cargo-vet/blob/main/src/main.rs#L1578">the impl if you want to see my current horrors, which are almost certainly going to be broken by 4.0 but I begrudge no one but myself for this fact</a>).</p>
<p>I definitely like that DeriveDisplayOrder is the default! I am very particular about my output! In this vein I've also been hurting for a way to create extra headings for subcommand families, a la git (cargo-vet has too many subcommands because it has both plumbing and porcelain commands, and it's hard to indicate that some commands are &quot;core functionality, use these every day&quot; and these others are &quot;utilities that are good to know about but you'll probably never need&quot;):</p>
<p><img src="https://user-images.githubusercontent.com/1136864/187009821-cdeb345c-dd08-4291-9c04-07817760e35d.png" alt="image" /></p>
<p>I'm a bit sad to lose the splash of color, I find that it helps me quickly scan the verbose help output and breaks up the monotony. That said my opinion isn't strong enough for me to kick up a fuss.</p>
<p>ARGS vs Arguments I could take or leave, don't really care either way. (And I've never really understood the motivation of distinguishing arguments from options...)</p>
<p>Looking at these screenshots I am reminded that a higher-impact thing clap could be doing with my help messages is doing some cleanup of artifacts in the text that exist for rustdoc's sake (since this is pulling from docstrings which need to be valid markdown). Obviously &quot;add a fuckin' markdown parser to clap&quot; is a big ask, but it's unfortunate (and iirc I had to do some very careful work to not have the bullets in --filter-graph get completely messed up).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 02:11</div>
            <div class="timeline-body"><blockquote>
<p>We collapse options because there can be so many but we should probably not collapse down to [ARGS] as that is most likely the core of what people are doing and the usage is a bit meaningless otherwise.</p>
</blockquote>
<p>I'm increasingly of the opinion that usage strings basically suck at the best of times, and actually am already hardcoding them away in rust-minidump (3 years ago or whatever clap was deriving absolute nonsense so I just burnt it to the ground).</p>
<p>Like I don't know how anyone ever looks at something like this and goes &quot;yes this helps me&quot; lol</p>
<p><img src="https://user-images.githubusercontent.com/1136864/187010195-13a0ee5d-dc73-4973-b392-cd6c47a6f6c7.png" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 02:15</div>
            <div class="timeline-body"><p>Oh wait oh god I in fact did not do the migration correct, my cli tests now all die with</p>
<pre><code>---- tests::violations::mock_simple_violation_cur_exemptions stdout ----
thread 'tests::violations::mock_simple_violation_cur_exemptions' panicked at 'Mismatch between definition and access of `verbose`. Could not downcast to tracing_core::metadata::LevelFilter, need to downcast to alloc::string::String
', src\cli.rs:77:18
</code></pre>
<p>Why is --verbose of all things the flag that keeps breaking between clap versions x3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 02:18</div>
            <div class="timeline-body"><blockquote>
<p>So the fact that cargo-vet 0.3.0 and cargo-vet-certify 0.3.0 is now cargo-vet-vet 0.3.0 and cargo-vet-vet-certify 0.3.0 seems like a minor regression/mess for cargo-subcommands, not sure if the CHANGELOG notes something about this or if I'm using the wrong &quot;hack&quot; for cargo-subcommands to work right.</p>
</blockquote>
<p>I might need to play with that to see whats going on.  We switched up how we render the name to fix https://github.com/clap-rs/clap/issues/992 and I'm unsure if your code is needing a change or if this is a bug.</p>
<blockquote>
<p>In this vein I've also been hurting for a way to create extra headings for subcommand families,</p>
</blockquote>
<p>https://github.com/clap-rs/clap/issues/1553 which I'm hoping to fit into v4 but it could probably be made in any 4.x release once I get the derive macros done for #1807</p>
<blockquote>
<p>I'm a bit sad to lose the splash of color, I find that it helps me quickly scan the verbose help output and breaks up the monotony. That said my opinion isn't strong enough for me to kick up a fuss.</p>
</blockquote>
<p>I agree that color helps.</p>
<p>The concerns with color</p>
<ul>
<li>Do the colors picked have enough of a polished look</li>
<li>Do the colors work well with terminal's theme (e.g. I'm trying to avoid true colors due to extra complexity of working with the theme)</li>
<li>Do the colors work well with application's theme  (#2963)</li>
</ul>
<p>We do plan to allow people to customize colors during the 4.x release, see https://github.com/clap-rs/clap/issues/3234</p>
<blockquote>
<p>(And I've never really understood the motivation of distinguishing arguments from options...)</p>
</blockquote>
<p>Hey, at least we stopped distinguishing between flags and options!</p>
<p>I'll have to give this some thought.</p>
<blockquote>
<p>Obviously &quot;add a fuckin' markdown parser to clap&quot; is a big ask, but it's unfortunate (and iirc I had to do some very careful work to not have the bullets in --filter-graph get completely messed up).</p>
</blockquote>
<p>Its a big ask but we need to at least make it possible, even if we make it either opt-in or opt-out: https://github.com/clap-rs/clap/issues/2389 (which builds on top of the other issue I linked to for <code>--filter-graph</code>)</p>
<blockquote>
<p>Like I don't know how anyone ever looks at something like this and goes &quot;yes this helps me&quot; lol</p>
</blockquote>
<p>Yes, this is why I still think we should collapse to <code>[OPTIONS]</code> as they are more plentiful and can easily overwhelm the user.  <code>[ARGS]</code> tend to not do that so much.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 02:21</div>
            <div class="timeline-body"><blockquote>
<p>Oh wait oh god I in fact did not do the migration correct, my cli tests now all die with</p>
<pre><code>---- tests::violations::mock_simple_violation_cur_exemptions stdout ----
thread 'tests::violations::mock_simple_violation_cur_exemptions' panicked at 'Mismatch between definition and access of `verbose`. Could not downcast to tracing_core::metadata::LevelFilter, need to downcast to alloc::string::String
', src\cli.rs:77:18
</code></pre>
<p>Why is --verbose of all things the flag that keeps breaking between clap versions x3</p>
</blockquote>
<pre><code class="language-rust">    /// How verbose logging should be (log level)
    #[clap(long, action)]
    #[clap(default_value_t = LevelFilter::WARN)]
    #[clap(possible_values = [&quot;off&quot;, &quot;error&quot;, &quot;warn&quot;, &quot;info&quot;, &quot;debug&quot;, &quot;trace&quot;])]
    #[clap(help_heading = &quot;GLOBAL OPTIONS&quot;, global = true)]
    pub verbose: LevelFilter,
</code></pre>
<p>See https://github.com/clap-rs/clap/discussions/3855</p>
<p>EDIT: I guess that points back to https://github.com/clap-rs/clap/issues/3822#issuecomment-1155075962 which is a reply to you...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mozilla/cargo-vet/pulls/316.html">mozilla/cargo-vet#316</a> on 2022-08-27 02:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 02:56</div>
            <div class="timeline-body"><p>Yeah I think I was working on migrating to the new 4.0 API and then you added a way to silence the deprecations and I decided to forget about it for now, hoping a better answer would come along.</p>
<p>I just did a hacked up TypedParser and some quick fixups to the markdown hack to get it working again. You can see the full snapshot diffs here, if you're curious: https://github.com/mozilla/cargo-vet/pull/316</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-27 03:05</div>
            <div class="timeline-body"><p>Oh also: big fan of killing the version info at the start of help, it's not very helpful and also makes snapshots tests randomly churn whenever I cut a releases, which is mildly annoying (my code is also riddled with <code>#[clap(disable_version_flag = true)]</code> because subcommand version flags are also weird noise).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-27 11:16</div>
            <div class="timeline-body"><blockquote>
<p>it's not very helpful and also makes snapshots tests randomly churn</p>
</blockquote>
<p>Which snapshot solution do you use?  With <code>snapbox</code>, we support wildcards like <code>[..]</code>, see <a href="https://github.com/clap-rs/clap/blob/master/examples/demo.md">one of clap's examples</a></p>
<blockquote>
<p>my code is also riddled with #[clap(disable_version_flag = true)] because subcommand version flags are also weird noise</p>
</blockquote>
<p>Why not just drop <code>propagate_version = true</code>? That will make it so you only get the version flag on the commands you explicitly apply the <code>version</code> attribute to.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2022-08-28 16:44</div>
            <div class="timeline-body"><p>We use <a href="https://insta.rs/">cargo-insta</a> in the most naive possible way, because I <em>do</em> want to get notified about any and all changes to output (and insta makes it really easy to go &quot;yep fine&quot;). Version bumps are just the more annoying one, probably because I haven't setup cargo-release for my projects. X3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ducaale">@ducaale</a> on 2022-08-29 09:43</div>
            <div class="timeline-body"><blockquote>
<p>The greens and yellows are gone, instead using bold, underline, and dimmed: https://github.com/clap-rs/clap/pull/4117 though https://github.com/clap-rs/clap/issues/3108</p>
<ul>
<li>Dimmed was removed from placeholders in https://github.com/clap-rs/clap/pull/4126</li>
</ul>
<p>Reduce the ALL CAPS: https://github.com/clap-rs/clap/pull/4123</p>
<ul>
<li>ARGS and OPTIONS matched the usage and worked as non-colored headings but it feels a bit unpolished</li>
<li>I was hard pressed to find other CLIs that do this</li>
</ul>
</blockquote>
<p>One argument for keeping ALL CAPS is that it mirrors the heading in man pages. Also, I find the underline to hurt the readability of lowercased headings (see how <code>g</code> and <code>p</code> are rendered when underlined in https://github.com/clap-rs/clap/issues/4132#issuecomment-1229091197).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4143.html">clap-rs/clap#4143</a> on 2022-08-29 20:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4145.html">clap-rs/clap#4145</a> on 2022-08-29 20:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4148.html">clap-rs/clap#4148</a> on 2022-08-30 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4151.html">clap-rs/clap#4151</a> on 2022-08-30 21:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4155.html">clap-rs/clap#4155</a> on 2022-08-31 13:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-31 14:22</div>
            <div class="timeline-body"><p>I thought I'd record my usage experiments</p>
<p>Current:</p>
<pre><code>git-stash

Usage:
    git-derive stash [OPTIONS]
    git-derive stash &lt;COMMAND&gt;

Commands:
    push
    pop
    apply
    help     Print this message or the help of the given subcommand(s)

Options:
    -m, --message &lt;MESSAGE&gt;
    -h, --help                 Print help information
</code></pre>
<ul>
<li>Takes up an extra line</li>
</ul>
<p>Same line</p>
<pre><code>git-stash

Usage: git-derive stash [OPTIONS]
       git-derive stash &lt;COMMAND&gt;

Commands:
    push
    pop
    apply
    help     Print this message or the help of the given subcommand(s)

Options:
    -m, --message &lt;MESSAGE&gt;
    -h, --help                 Print help information
</code></pre>
<ul>
<li>Extra indentation</li>
</ul>
<p>git-style</p>
<pre><code>git-stash

Usage: git-derive stash [OPTIONS]
   or: git-derive stash &lt;COMMAND&gt;

Commands:
    push
    pop
    apply
    help     Print this message or the help of the given subcommand(s)

Options:
    -m, --message &lt;MESSAGE&gt;
    -h, --help                 Print help information
</code></pre>
<ul>
<li>Extra indentation and noisier</li>
</ul>
<p>Shell prompt</p>
<pre><code>git-stash

$ git-derive stash [OPTIONS]
$ git-derive stash &lt;COMMAND&gt;

Commands:
    push
    pop
    apply
    help     Print this message or the help of the given subcommand(s)

Options:
    -m, --message &lt;MESSAGE&gt;
    -h, --help                 Print help information
</code></pre>
<ul>
<li>Too clever?</li>
</ul>
<p>Overall, I'm leaning towards leaving the usage the same</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4156.html">clap-rs/clap#4156</a> on 2022-08-31 14:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-31 14:59</div>
            <div class="timeline-body"><p>I believe the original issue has been updated to reflect the current conversation, including dispositions on decisions and links out to any newer PRs</p>
<p>Before I remove name/version/about from the <strong>default</strong> template, I've pinged a couple more people directly to try to make sure this conversation is fairly representative</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-31 15:02</div>
            <div class="timeline-body"><p>Looking at <code>docker -h</code>, I'm thinking it might be worth dropping the indentation level from 4 to 2 to reduce the likelihood of wrapping.</p>
<p>For flags/options, there already is a lot of space taken up due to the flags.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2022-08-31 15:20</div>
            <div class="timeline-body"><p>I think removing name/version/about is fine. I agree that's probably a good change.</p>
<p>I do personally like <code>ALLCAPS</code> headings though. In part because they look natural to me given their use in man pages. The underlining is nice, but it is pretty common for me to do things like <code>cmd --help | less</code>, in which case, I imagine the underlining will get disabled by default.</p>
<p>But I don't think I have any super strong opinions since I think this is all pretty customizable by using your own template right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-31 15:38</div>
            <div class="timeline-body"><blockquote>
<p>But I don't think I have any super strong opinions since I think this is all pretty customizable by using your own template right?</p>
</blockquote>
<p>Yes, I've included in each item in the issue and in the changelog how to get back the original behavior.   The one that cannot be revert is the choice in coloring but that is planned for next after 4.0.0 but people can continue to work around it with <code>Command::disable_colored_help(true)</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4159.html">clap-rs/clap#4159</a> on 2022-08-31 19:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4160.html">clap-rs/clap#4160</a> on 2022-08-31 20:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4161.html">clap-rs/clap#4161</a> on 2022-08-31 21:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4188.html">clap-rs/clap#4188</a> on 2022-09-07 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4190.html">clap-rs/clap#4190</a> on 2022-09-07 19:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4192.html">clap-rs/clap#4192</a> on 2022-09-07 22:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-09-09 19:20</div>
            <div class="timeline-body"><p>Should we provide built-in pager support for help?  We'd skip the pager if the output isn't a tty</p>
<p>I lean towards doing this for long help (<code>--help</code>) to encourage having short help (<code>-h</code>) be very short.</p>
<p>I would expect this to be behind an on-by-default feature flag <code>pager</code>.</p>
<p>Unsure if there is something newer/fancier but I was looking at the <a href="https://crates.io/crates/pager">pager</a> crate.</p>
<p>(inspired by <a href="https://clig.dev/#output">clig.dev output section</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-09-09 19:26</div>
            <div class="timeline-body"><p>And/or we can provide a way for users to tell us what the man page is and to look it up to show instead</p>
<blockquote>
<p>However, not everyone knows about man, and it doesnâ€™t run on all platforms, so you should also make sure your terminal docs are accessible via your tool itself. For example, git and npm make their man pages accessible via the help subcommand, so npm help ls is equivalent to man npm-ls.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tshepang">@tshepang</a> on 2022-09-10 04:04</div>
            <div class="timeline-body"><blockquote>
<p>Should we provide built-in pager support for help? We'd skip the pager if the output isn't a tty</p>
</blockquote>
<p>yes please</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4201.html">clap-rs/clap#4201</a> on 2022-09-10 11:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-09-10 11:43</div>
            <div class="timeline-body"><p>I've started planning pager support in https://github.com/clap-rs/clap/issues/4201</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-09-13 12:21</div>
            <div class="timeline-body"><p>Within the scope of the 4.0.0 release, I feel like this is resolved.  Pager support is likely to start as an <code>unstable-pager</code> feature and can come after 4.0.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2022-09-13 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4218.html">clap-rs/clap#4218</a> on 2022-09-16 12:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../rsadsb/adsb_deku/pulls/181.html">rsadsb/adsb_deku#181</a> on 2022-09-21 01:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-09-21 15:09</div>
            <div class="timeline-body"><p>More color feedback</p>
<blockquote>
<p>Will clap v4 come with the ability to turn help colors back on? I think it might be a good idea if it did, even if it was only rudimentary. I'd like to upgrade projects to v4, but I quite like having colored help.
...
I find that colors set off the different parts of the help message much better than bolding underlining, and give it a sort of visual structure that makes it easy to skim.</p>
<pre><code>Any thoughts on how to have defaults that meet the majority case of needs?</code></pre>
<p>I think that there should be a few options:</p>
<pre><code>No colors or style
Bold and underling only
Default colors (a la the current colors)
Custom colors</code></pre>
<p>I would go for the third option, and people who didn't like colors would probably go for the second option. 1, 2, or 3 would all be reasonable defaults.</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ip9ihv1/
https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ipa8e0g/</p>
<blockquote>
<p>I also like the coloring essentially as-is. More customization is nice, but I always liked and enabled the defaults. I find it makes it very clear what is what in help output and is more pleasant to read than monochromatic.</p>
<p>My preferred solution would be that, when customization is figured out, have the existing color behavior as some sort of easy to select &quot;preset&quot;.</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ipa403b/</p>
<blockquote>
<p>I also prefer the colored output and I think it's for the same reason I switched to a colored prompt over a decade ago. Monochromatic output in a context other than something like a Macintosh SE feels stark and unsatisfying to me.</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ip9n5lp/</p>
<blockquote>
<p>The best thing about colours was that I could be sure: the app is written in Rust and uses clap, and that means a certain baseline of quality and behaviour. It also looks pretty and easy to read - assuming that it is visible on your background.</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ipb0z0k/</p>
<blockquote>
<p>For the record, I just made a &quot;Downgrade to Clap 3.x to wait for actual colored output&quot; commit on a brand new &quot;shell script written in Rust for compile-time correctness&quot; I wrote today because I find the use of intense white and underlines so unacceptable for something I intend to dogfood, and I'll probably add an explicit version bound to the ~/bin/add <crate name> shell script I use to block typos and inject preferred default features on commonly used crates.)</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/irxnh6s/?context=3</p>
<blockquote>
<p>I like the old style of clap much more than the new one.
The colored output was much prettier as the new underlined text.</p>
</blockquote>
<p>#4429</p>
<hr />
<blockquote>
<p>Yay!</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ip9flx3/</p>
<blockquote>
<p>No no, that wasn't what I meant. I like the bold and underline output more than the color. While colors are nice, they get boring fast and the choice of colors wasn't also my favorite. I am currently reading the report and saw the future plans, which BTW was the reason of my mentioning of the future additions.</p>
</blockquote>
<p>https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ip9kwxi/</p>
<blockquote>
<p>Also, I have to agree, I like the new help text better after letting it sink in a little.</p>
</blockquote>
<p>https://twitter.com/ConradLudgate/status/1572466091334459394</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4256.html">clap-rs/clap#4256</a> on 2022-09-26 15:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4267.html">clap-rs/clap#4267</a> on 2022-09-27 03:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../ProvableHQ/snarkVM/pulls/1124.html">ProvableHQ/snarkVM#1124</a> on 2022-09-30 08:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pkolaczk/fclones/issues/169.html">pkolaczk/fclones#169</a> on 2022-09-30 16:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4308.html">clap-rs/clap#4308</a> on 2022-09-30 18:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../planus-org/planus/pulls/147.html">planus-org/planus#147</a> on 2022-10-03 18:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-03 21:42</div>
            <div class="timeline-body"><p>Another idea came up for help output: https://github.com/clap-rs/clap/issues/4341</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mindvalley/wukong-cli/pulls/21.html">mindvalley/wukong-cli#21</a> on 2022-10-06 08:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chevdor">@chevdor</a> on 2022-10-06 09:40</div>
            <div class="timeline-body"><p>From what I read color vs no color is very opinionated and this is fine. A good option should be to <strong>not</strong> decide for the end user.</p>
<p>I am one of those missing coloring :) but I agree that safer defaults is a better solution.</p>
<p>Ideally the coloring choice should be left to the <strong>end user</strong> (ie not the dev) of the CLI.</p>
<p>I would not mind a &quot;safe&quot; default (even if this is without any color) as long as the <strong>end user</strong> can set an ENV to turn on help coloring. It would actually be cool to be able to control the coloring of all installed &quot;clap_v4-based-cli&quot; based on a single ENV such as <code>CLAP_HELP_COLORING=SHOW_ME_RAINBOWS</code> or <code>CLAP_HELP_COLORING=KEEP_IT_BORING</code> ðŸ˜„  and simply let each <strong>end</strong> user makes his/her own choice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-07 00:55</div>
            <div class="timeline-body"><p>If an application decides to publicly expose themes to the user, that is for the application to decide.  I don't think its appropriate though for there to be a clap specific variable for it.</p>
<ul>
<li>Part of an applications behavior is now tied to a library its using</li>
<li>The user is using the application and not clap.  Similarly, I dislike <code>RUST_BACKTRACE</code>.  People don't want &quot;a clap&quot; application or a &quot;rust applicatuion&quot; (ok some do) but people want an application that solves there problems.  It feels unpolished to be accessing &quot;internals&quot; like rust env variables or arg parser env variables.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tshepang">@tshepang</a> on 2022-10-07 05:34</div>
            <div class="timeline-body"><p>@epage do you mean a better way to have color control on the terminal should be with a generic thing like <code>$COLOR=(auto|always|never)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-07 11:58</div>
            <div class="timeline-body"><p>A <code>COLOR</code> would only control detection.  I'm referring to application-specific theme config or env variables with maybe looking at generalized versions of it.  For example, I believe <code>bat</code> has <code>BAT_THEME</code>.  <code>delta</code> and <code>broot</code> reuse some of <code>bat</code>s assets, so it could make sense to have a more general theme env variable that all apps can fall back on, like a <code>COLOR</code> or a <code>PAGER</code> env variable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3234.html">clap-rs/clap#3234</a> on 2022-10-07 15:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../wfxr/csview/pulls/93.html">wfxr/csview#93</a> on 2022-10-09 09:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/memark">@memark</a> on 2022-10-13 16:32</div>
            <div class="timeline-body"><p>Perhaps we unpin this issue now that it's closed/finished?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-13 16:38</div>
            <div class="timeline-body"><p>I've been keeping it pinned for easy finding for people migrating to clap v4 that have feedback on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/melMass">@melMass</a> on 2022-10-26 21:20</div>
            <div class="timeline-body"><p>Sorry I read the whole issue (after not finding anything in the doc), but how do we either bring back colors, or customize the help output all together?</p>
<p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-27 01:51</div>
            <div class="timeline-body"><p>That is not supported yet, see</p>
<ul>
<li>#3234 (customize colors)</li>
<li>#3108 (provide styled content)</li>
</ul>
<p>Those are the highest priority focus area for clap v4.  However, some other things have taken my attention away from clap for a little bit (e.g. the recent cargo-release release) and some Real World stuff has come up.  Hopefully I'll be able to get back to this soon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../quickwit-oss/quickwit/issues/2236.html">quickwit-oss/quickwit#2236</a> on 2022-11-03 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4470.html">clap-rs/clap#4470</a> on 2022-11-09 19:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AmionSky">@AmionSky</a> on 2022-11-12 12:01</div>
            <div class="timeline-body"><p>I just want to say I'm definitely one of those people who likes the colored help. It's way more readable, I can see what I want from a quick glance. Having the color completly removed from the help has been a big dissapointment. (I actually went back to v3)</p>
<p>I would really like to have the option to bring back the colors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../Yamato-Security/hayabusa/pulls/817.html">Yamato-Security/hayabusa#817</a> on 2022-11-19 07:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Seltyk">@Seltyk</a> on 2022-12-07 03:06</div>
            <div class="timeline-body"><p>The <code>man</code>-like output of v3 was something I really liked, so the move to a moreâ€¦ dare I say, Pythonic style in v4 is a letdown. But more importantly, not having colors is a total dealbreaker, for the exact same reasons as AmionSky wrote above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tijoer">@tijoer</a> on 2022-12-21 12:37</div>
            <div class="timeline-body"><p>I saw this wall of text linked on Stackoverflow. I cannot get colors in my help pages to work, even though I have the following: #[clap(author, version, about, arg_required_else_help = true, color=ColorChoice::Always)]</p>
<p>How can I get colors back, as it helps to understand the information in the help page way better.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-12-21 13:55</div>
            <div class="timeline-body"><p>The very first item in the issue is about that.  Other styling was selected instead for clap v4's default (#4117).</p>
<p>The item ends with</p>
<blockquote>
<p>Users can't rollback until theming support is in (Allow good/warning/error/hint color to be customizedÂ #3234) though they can just disable the coloring with Command::disable_colored_help(true)</p>
</blockquote>
<p>If you follow that issue, it is still open though it is my priority to work on when I am able to focus more on clap.  I am trying to get some stuff done on another project atm.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DianaNites">@DianaNites</a> on 2022-12-21 23:34</div>
            <div class="timeline-body"><p>The only way to get the colors back is stay on the previous clap version. This is what I do in my new and existing projects, just use clap v3.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tijoer">@tijoer</a> on 2022-12-22 12:50</div>
            <div class="timeline-body"><p>Thank you for the answer.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../youki-dev/youki/pulls/1443.html">youki-dev/youki#1443</a> on 2022-12-23 23:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NuSkooler">@NuSkooler</a> on 2023-01-06 03:50</div>
            <div class="timeline-body"><p>I'm having a hard time following this -- I was surprised when I upgraded to 4.x and the color went away. Is the official answer to stick with v3? That seems quite off. Is an option for re-enabling the color for --help in the pipeline?</p>
<p>Additionally, was https://no-color.org/ considered?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-06 03:57</div>
            <div class="timeline-body"><p>@NuSkooler</p>
<p>From the Issue's description</p>
<blockquote>
<p>The greens and yellows are gone, instead using bold, underline, and dimmed: https://github.com/clap-rs/clap/pull/4117 though https://github.com/clap-rs/clap/issues/3108</p>
</blockquote>
<p>towards the end is</p>
<blockquote>
<p>Users can't rollback until theming support is in (Allow good/warning/error/hint color to be customizedÂ #3234) though they can just disable the coloring with Command::disable_colored_help(true)</p>
</blockquote>
<p>This is my top clap priority (though I have another project that is a higher priority atm). If this is a blocker for someone then, yes using clap v3 is the answer.</p>
<blockquote>
<p>Additionally, was https://no-color.org/ considered?</p>
</blockquote>
<p>Unsure how this is relevant.  #2963 captures the motivation which in summary which led us to be more neutral in our default terminal styling. no-color would not help with that but instead helps with enabling/disabling application styling.  I also hope to respect more env variables like this by default in the future.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NuSkooler">@NuSkooler</a> on 2023-01-06 04:05</div>
            <div class="timeline-body"><p>@epage Thanks for the quick response!</p>
<p>Understood on priority et al., 'tis life!</p>
<p><code>NO_COLOR</code> is specifically designed to allow applications to default to color terminal output unless told otherwise. In general, the <em>styling</em> falls into this category as well as various terminals or environments (say stdout captured to file for example) become full of ANSI escape sequences with any of it enabled.</p>
<p>From the page:</p>
<blockquote>
<p>Command-line software which adds ANSI color to its output by default should check for a NO_COLOR environment variable that, when present and not an empty string (regardless of its value), prevents the addition of ANSI color.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dtolnay">@dtolnay</a> on 2023-01-06 05:09</div>
            <div class="timeline-body"><p>It's wild how opposite my point of view is to all the ones voiced above. I agree with many of the comments from https://github.com/clap-rs/clap/discussions/2906 -- I always hated the v3 <code>--help</code> color scheme, I found it gaudy and I disabled it in all of my CLIs. I love the v4 color scheme. I think it looks refined and I think Ed did a terrific job with it.</p>
<p>I've been wondering how much of the difference is people's legitimate personal preference vs people's terminals being differently configured to make one or the other theme look bad.</p>
<table><tr><td><img src="https://user-images.githubusercontent.com/1940490/210934098-a2af5550-d19e-4236-9561-f9b8a5dd893f.png" width="500"></td><td><img src="https://user-images.githubusercontent.com/1940490/210934093-ba3b93eb-8aa8-420f-8146-d38d02765a8d.png" width="500"></td></tr></table>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-06 05:24</div>
            <div class="timeline-body"><p>@dtolnay thanks for providing another voice.  As there is no way to make accurate internet polls on these types of things, its hard to sift through the bias of who is currently speaking.</p>
<p>I look forward to the experimentation and the learning that will happen when theming support is in and am curious to see if someone is able to popularize an alternative that meets the needs discussed in #2906.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LuckyTurtleDev">@LuckyTurtleDev</a> on 2023-01-06 11:30</div>
            <div class="timeline-body"><blockquote>
<p>I've been wondering how much of the difference is people's legitimate personal preference vs people's terminals being differently configured to make one or the other</p>
</blockquote>
<p>After seeing @dtolnay's screenshots I think the terminal / terminal-theme has an huge effect on this. At the provided screenshots the v3 theme looks more ugly and the v4 theme looks much nicer and modern.
But for example at the <a href="https://crates.io/crates/alacritty">alacritty</a> terminal with the default configuration it is the opposite.
I extremely like the colored output here, but found the v4 theme ugly and less easy to survey. The v3 looks much modern here.</p>
<p>|v3|v4|
|---|---|
| <img src="https://user-images.githubusercontent.com/44570204/210998254-12d39acd-2de4-44e6-ab6b-373c277a8855.png" alt="image" /> | <img src="https://user-images.githubusercontent.com/44570204/210999206-e9665d46-1ddc-4daf-8094-3d81e885a24f.png" alt="image" /> |</p>
<p>Of course this is probably also only a personal preference.</p>
<p>I think the <code>NO_COLOR</code> idea would be a very good compromise. So the user can decide what they will prefer and is not bound to the choose of the developer.
So clap can use the v3 theme if <code>NO_COLOR</code> is not present otherwise it can use the v4 theme.
The problem with this would be that many users are not aware of this option.
So the developer with does not like v3 would probably hard code v4 again. So we need also on option to explicit enable it again, by the user. Sadly <code>NO_COLOR=false</code> is not supported by https://no-color.org/ and will even leads other programs to disable colors. So maybe using a different environment variable like <code>CLAP_COLOR</code>  and only fall back to <code>NO_COLOR</code>, if <code>CLAP_COLOR</code>  does not exist  would be an better option. The downside of this would be that this would be a island solution, only supported by clap.  Maybe suggesting to add a <code>PREFER_COLOR</code>  to https://no-color.org/ would be an better option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-06 12:55</div>
            <div class="timeline-body"><blockquote>
<p>I think the NO_COLOR idea would be a very good compromise. So the user can decide what they will prefer and is not bound to the choose of the developer.</p>
</blockquote>
<p>Except <code>NO_COLOR</code> really means &quot;no ansi codes&quot; which means it would disable all formatting.  Ideally, the rest of the application would also support it so it would remove everything completely.  This is why I was wondering why it was relevant to this conversation.</p>
<p>At one point someone requested a clap-specific environment variable to allow users to control this but that is a policy that I don't think clap should take on but application authors.  Users interact with the author's application, not clap, and we shouldn't bypass that relationship.  This also gets into compatibility issues for the author if they switch parsers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NuSkooler">@NuSkooler</a> on 2023-01-06 16:56</div>
            <div class="timeline-body"><p>Just to be clear around formatting, this is ANSI/Escape code formatting only (ie: color, underlines, bold, so on).</p>
<p>I don't want to be a dead horse, but I'd think the following would be the proper path, reflecting what other tools do and <code>NO_COLOR</code>:</p>
<ul>
<li>Reinstate the previous colors as the <em>default</em> that Clap provides unless told otherwise by the developer</li>
<li>Proceed with the support of themes (this is a great enhancement!)</li>
<li>Respect <code>NO_COLOR</code>. Users that don't want color at all set this in their terminals. Some users may for example use a <code>--no-color</code> CLI option as well either built in or supplied by the dev</li>
</ul>
<p>An aside: By using the base 16 ANSI colors, users can control what &quot;red&quot; for example looks like in their terminal emulator; Or in other words, allows user to control what <em>their</em> terminal looks like without you going much at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-06 17:12</div>
            <div class="timeline-body"><p>@NuSkooler while I plan to eventually have <code>NO_COLOR</code> support, it is not part of solution to this because</p>
<ul>
<li>It disables colors for error messages</li>
<li>It disables colors through the rest of the application</li>
</ul>
<p>When all a user or developer wanted is to disable color in the help.  Yes, we have <code>disable_colored_help</code> for application authors but we are trying to pair down the number of knobs to control things.</p>
<p>The path forward is</p>
<ol>
<li>Theming support</li>
<li>People experiment with ideas and a de facto standard arises</li>
<li>We evaluate and possibly update <code>clap</code> to that de facto standard with theming support being an escape hatch for people who are not happy with it.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NuSkooler">@NuSkooler</a> on 2023-01-06 17:48</div>
            <div class="timeline-body"><p>@epage I think that all makes sense. I guess the main thing I'm confused about is why now <em>default</em> to no color -- even when I as a developer told Clap to explicitly utilize it? Most if not all of the modern CLI apps that I can think of that support color at all, default to using that color.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-06 18:54</div>
            <div class="timeline-body"><p>@NuSkooler</p>
<blockquote>
<p>even when I as a developer told Clap  to explicitly utilize it</p>
</blockquote>
<p>Because &quot;color&quot; is a common stand-in word for &quot;terminal styling&quot;</p>
<blockquote>
<p>. I guess the main thing I'm confused about is why now default to no color</p>
</blockquote>
<ul>
<li>I agree with the sentiment that there were problems with the old colors.</li>
<li>We want to have &quot;safe&quot; defaults</li>
<li>In coming up with a solution, I mostly had to do it alone.  Few people were willing to collaborate on this, to try understand needs outside of their own position and finding new solutions.  Instead people have been very reactionary, wanting hardline solution that are non-starters (no terminal styling by default, clap v2 colors are the only way)</li>
<li>I expected theming support to be released soon after.  I was working on it directly after 4.0 but then (1) a higher priority came in and (2) I needed to take some family leave, severely limiting my availability for the last couple of months</li>
<li>Addressing terminal styling would have gone faster if just a few of those complaining had stepped up to help despite mentioning in various places what the work is that we need to do.</li>
<li>In contrast to the above, I've had a drag on my time repeatedly answering the same questions in the same threads.</li>
</ul>
<blockquote>
<p>Most if not all of the modern CLI apps that I can think of that support color at all, default to using that color.</p>
</blockquote>
<p>I feel like there is something missing in this statement as it comes across as circular to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NuSkooler">@NuSkooler</a> on 2023-01-06 19:23</div>
            <div class="timeline-body"><p>@epage Firstly, I appreciate your willingness to debate here! I hope I'm not coming off as complaining, it's certainly not my intent. Your work is extremely appreciated. I maintain a number of OSS projects myself and know how it can be!</p>
<p>Understood on all notes. FWIW, I'm happy to try and help! I don't know the Clap code base well other than my external usage, but I do know terminals, ANSI, and some of the various standards, caveats, so on around them.</p>
<p>I may not be following the last statement about &quot;circular&quot;:
What I'm suggesting is that modern terminal applications that themselves have color at all (some are still just plain text) provide color by default, and generally follow the <code>NO_COLOR</code> and/or <code>--no-color</code> or similar CLI options. But again, by default, they provide color in a 'default' theme even if exposing the ability for users to provide alternate themes.</p>
<p>And to further point out: Instead of disabling colors all together, one can use the &quot;base&quot; ANSI 0-16 colors, allowing the terminal emulator itself (generally exposed to the user in configuration -- you can see this in MS terminal now even!). This allows the user to define what each of the 0-16 resolve to. In other words, if you say set the &quot;Usage&quot; to color 4, my terminal and your terminal may look quite different based on our individual preferences. If you instead set the color to a <em>specific</em> value (using 256 or true color syntax), the terminal will just show that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-06 19:39</div>
            <div class="timeline-body"><p>@NuSkooler</p>
<blockquote>
<p>Understood on all notes. FWIW, I'm happy to try and help! I don't know the Clap code base well other than my external usage, but I do know terminals, ANSI, and some of the various standards, caveats, so on around them.</p>
</blockquote>
<p>Thats actually more what we need than clap help.  My requirements for theming and custom user styled text is that we don't take on a whole terminal styling API in clap.  The path forward</p>
<ul>
<li>A minimal API for defining terminal styles with no other policy.  The remaining work is being tracked at https://github.com/epage/anstyle/issues/14 and #3234 is for the clap side of things</li>
<li>Leverage ANSI escape codes in <code>String</code>s as the stable API for styled text.  The bulk of the work is being tracked in https://github.com/epage/anstyle/issues/5 and #1433 and #3108 are for the clap side to track the work</li>
</ul>
<blockquote>
<p>What I'm suggesting is that modern terminal applications that themselves have color at all (some are still just plain text) provide color by default, and generally follow the NO_COLOR and/or --no-color or similar CLI options. But again, by default, they provide color in a 'default' theme even if exposing the ability for users to provide alternate themes.</p>
</blockquote>
<p>I feel like we are talking in circles on this topic which makes me think one of us is missing something about the other's responses.  I've previously replied on why I think <code>NO_COLOR</code>, while a useful feature to support, is unrelated to this topic.</p>
<blockquote>
<p>And to further point out: Instead of disabling colors all together, one can use the &quot;base&quot; ANSI 0-16 colors, allowing the terminal emulator itself (generally exposed to the user in configuration -- you can see this in MS terminal now even!). This allows the user to define what each of the 0-16 resolve to. In other words, if you say set the &quot;Usage&quot; to color 4, my terminal and your terminal may look quite different based on our individual preferences. If you instead set the color to a specific value (using 256 or true color syntax), the terminal will just show that.</p>
</blockquote>
<p>Yes, I'm aware.  That is one of the reasons I prefer the basic 16 / other effects over 256 and truecolor, we are more likely to be able to adapt to the users theme.  However, different themes still optimize for different colors having better contrast or not.  People are not going to theme their terminal specifically for clap.   If we do use any colors, they likely need to have the widest theme compatibility for contrast, light and dark (I know, I'm one of those weird people who prefers light themes).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../NNPDF/pineappl/issues/145.html">NNPDF/pineappl#145</a> on 2023-02-01 10:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-18 20:54</div>
            <div class="timeline-body"><blockquote>
<p>Support for [theming] is now available as <code>Command::styles</code> with v4.2.3 when the <code>unstable-styles</code> feature is enabled.</p>
<p>Note: we are not guaranteeing semver compatibility on this feature until the feature flag is removed.</p>
</blockquote>
<p>Please post feedback on #3234</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/corneliusroemer">@corneliusroemer</a> on 2023-07-13 11:16</div>
            <div class="timeline-body"><p>Thanks for working on bringing colors back @epage! Questions of taste are always tricky.</p>
<p>@Gankra</p>
<blockquote>
<p>I'm increasingly of the opinion that usage strings basically suck at the best of times, and actually am already hardcoding them away in rust-minidump (3 years ago or whatever clap was deriving absolute nonsense so I just burnt it to the ground).
Like I don't know how anyone ever looks at something like this and goes &quot;yes this helps me&quot; lol</p>
</blockquote>
<p>I find the compact usage useful to quickly remember exact option names, when I have a rough idea but can't remember the exact syntax. Like in this case with <code>--interactive</code> which I would otherwise almost need to scroll for:</p>
<details>
<summary>Show `git commit -h` screenshot</summary>
<img width="2475" alt="image" src="https://github.com/clap-rs/clap/assets/25161793/6f876974-2714-45ee-8f06-6abbea9f1941">
</details>

<p>But I agree that when the dense options become too many, they become useless, like for snakemake (this goes one for another screen...).</p>
<details>
<summary>Show `snakemake -h` screenshot</summary>
<img width="2504" alt="image" src="https://github.com/clap-rs/clap/assets/25161793/d4962d1b-70f4-4f4f-bcc2-cfc30341879e">
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-07-13 12:43</div>
            <div class="timeline-body"><p>To prevent usages from being overwhelming is why clap only shows positionals and commands and not options.</p>
<p>The downside to overriding the usage is we show that in errors rather than the &quot;smart&quot; usage that adapts to the users arguments.</p>
<p>#4191 explores some ideas for improving usage with hints like</p>
<ul>
<li>split a mutually exclusive arg group into its own usage</li>
<li>force showing an option</li>
<li>force showing the options in an arg group, with one usage per arg group</li>
</ul>
<p>There is another issue for flattening the help for subcommands much like <code>git stash</code> which will show a usage per subcommand rather than a generic usage</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5071.html">clap-rs/clap#5071</a> on 2023-08-15 13:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../rust-lang/cargo/issues/2290.html">rust-lang/cargo#2290</a> on 2023-09-20 19:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/uv/issues/3473.html">astral-sh/uv#3473</a> on 2024-05-15 19:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/rye/issues/1209.html">astral-sh/rye#1209</a> on 2024-07-09 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../robiot/rustcat/pulls/69.html">robiot/rustcat#69</a> on 2024-07-17 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../jj-vcs/jj/pulls/5716.html">jj-vcs/jj#5716</a> on 2025-02-16 01:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:35:08 UTC
    </footer>
</body>
</html>
