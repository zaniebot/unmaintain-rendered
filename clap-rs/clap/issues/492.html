<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Requiring another argument by name from an argument that is itself required creates a duplicate error message - clap-rs/clap #492</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Requiring another argument by name from an argument that is itself required creates a duplicate error message</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/492">#492</a>
        opened by <a href="https://github.com/stensonowen">@stensonowen</a>
        on 2016-05-01 01:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/stensonowen">@stensonowen</a> on 2016-05-01 01:45</div>
            <div class="timeline-body"><p>Hopefully the title is clear. In the example, argument <code>foo</code> is <code>required</code>, and it also <code>requires</code> <code>bar</code>.</p>
<pre><code class="language-rust">let matches = App::new(&quot;MyApp&quot;)
                        .arg(Arg::with_name(&quot;foo&quot;)
                                    .help(&quot;FOO&quot;)
                                    .short(&quot;f&quot;)
                                    .required(true)
                                    .takes_value(true)
                                    .conflicts_with(&quot;c&quot;)
                                    .requires(&quot;bar&quot;)
                            )
                         .arg(Arg::with_name(&quot;bar&quot;)
                                    .short(&quot;b&quot;)
                                    .takes_value(true)
                                    .help(&quot;BAR&quot;)
                                    //.required(true)
                            )
                        .get_matches();
</code></pre>
<p>Calling <code>./prog --help</code> returns what you'd expect (<code>foo</code> and <code>bar</code> are required, with the correct usage string), but supplying the <code>-f</code> flag produces the following error:</p>
<pre><code>error: The following required arguments were not provided:
    -b &lt;bar&gt;
    -b &lt;bar&gt;

USAGE:
    repeat_errors [FLAGS] [OPTIONS] -f &lt;foo&gt; -b &lt;bar&gt; -b &lt;bar&gt;
</code></pre>
<p>(Uncommenting the <code>bar.required(true)</code> adds another <code>-b &lt;bar&gt;</code> to the error and usage.)
It's conceivable that someone would want a <code>required</code> argument that <code>requires</code> another, so there is understandably a use case in which this error occurs. Additionally, it is certainly possible for a user to have accidentally made <code>bar</code> <code>required</code>, and the usage mistake might easily go unnoticed.
Apologies if there's already a way to avoid these kinds of redundancies, but I didn't see any.
It seems like an interesting (albiet niche) problem, so I'll probably take a crack at solving it and make a pull request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-05-03 01:49</div>
            <div class="timeline-body"><p>Thanks for filing! Yep, the title is clear :smile:</p>
<p>I agree it's possible someone could end up doing this either by accident, or just not knowing there are other ways to accomplish this (i.e. if an arg is required by another required arg, it's not necessary to set).</p>
<p>I should have this fixed shortly!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @kbknapp on 2016-05-03 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P2: need to have</span> added by @kbknapp on 2016-05-03 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: args</span> added by @kbknapp on 2016-05-03 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2016-05-03 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2016-05-03 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2016-05-03 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2016-05-04 01:09</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:18 UTC
    </footer>
</body>
</html>
