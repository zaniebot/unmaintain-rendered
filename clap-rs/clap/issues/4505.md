```yaml
number: 4505
title: "`flatten` is not an `Arg` attribute in derive API"
type: issue
state: closed
author: emersonford
labels:
  - C-bug
assignees: []
created_at: 2022-11-23T21:10:44Z
updated_at: 2022-11-28T15:50:42Z
url: https://github.com/clap-rs/clap/issues/4505
synced_at: 2026-01-10T01:57:48Z
```

# `flatten` is not an `Arg` attribute in derive API

---

_Issue opened by @emersonford on 2022-11-23 21:10_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

1.65.0

### Clap Version

4.0.26

### Minimal reproducible code

```rust
use clap::Args;

#[derive(Args)]
struct CommonArgs {
    #[arg(long)]
    pub foo: u32
}

#[derive(Args)]
struct SomeArgs {
    pub bar: u32,
    
    #[arg(flatten)]
    pub common: CommonArgs,
}
```


### Steps to reproduce the bug with the above code

build; [playground link](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=f697d5e44bd8c36d2b77b627f86c2d07)

### Actual Behaviour

fails to compile with
```
error: Expected `command` attribute instead of `arg`
  --> src/lib.rs:13:7
   |
13 |     #[arg(flatten)]
   |       ^^^

error: could not compile `playground` due to previous error
```

### Expected Behaviour

should compile, the derive reference (see [here](https://docs.rs/clap/latest/clap/_derive/index.html#arg-attributes)) says that `flatten` is a valid `Arg` attribute.

### Additional Context

workaround is to use `#[command(flatten)]` or `#[clap(flatten)]` instead of `#[arg(flatten)]`. the former feels... incorrect? and iirc the latter is no longer recommended in favor of `#[arg(...)]`.

### Debug Output

_No response_

---

_Label `C-bug` added by @emersonford on 2022-11-23 21:10_

---

_Closed by @epage on 2022-11-28 15:49_

---

_Comment by @epage on 2022-11-28 15:50_

Thanks for catching this!  The documentation is updated in master.

`#[command(flatten)]` is the correct route to go as you are merging together information about the command, rather than setting attributes related to a specific `Arg`

---
