<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help output does not indicate `ArgAction::Append` - clap-rs/clap #4681</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Help output does not indicate <code>ArgAction::Append</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/4681">#4681</a>
        opened by <a href="https://github.com/cd-work">@cd-work</a>
        on 2023-01-27 22:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cd-work">@cd-work</a> on 2023-01-27 22:43</div>
            <div class="timeline-body"><p>Maintainer's note: any proposed syntax should include a mockup of <code>cargo check -h</code> (<a href="https://github.com/clap-rs/clap/issues/4681#issuecomment-1410392153">details</a>)</p>
<hr />
<h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.1.4</p>
<h3>Describe your use case</h3>
<p>To my knowledge, the correct way to allow an argument to be specified multiple times is to use <code>ArgAction::Append</code>. This correctly allows passing the option multiple times and returns a <code>Vec</code> with <code>get_many</code>.</p>
<p>However, when getting the <code>--help</code> output it looks like this:</p>
<pre><code>Options:
  -o, --option &lt;OPTION&gt;   My Option
</code></pre>
<p>It seems like the <code>--help</code> output does not communicate at all that the option can be passed multiple times.</p>
<h3>Describe the solution you'd like</h3>
<p>Considering that <code>--option &lt;OPTION&gt;...</code> is already used to indicate that one option can has multiple arguments, the best solution I can see would be <code>--option... &lt;OPTION&gt;</code>. This would be consistent with <code>--flag...</code>.</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @cd-work on 2023-01-27 22:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../phylum-dev/cli/pulls/927.html">phylum-dev/cli#927</a> on 2023-01-27 22:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by @epage on 2023-01-27 22:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2023-01-27 22:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-27 22:51</div>
            <div class="timeline-body"><p>More options are being discussed in https://github.com/clap-rs/clap/discussions/3272.</p>
<p>Personally, I think <code>--open... &lt;OPTION&gt;</code> isn't too clear.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cd-work">@cd-work</a> on 2023-01-28 00:03</div>
            <div class="timeline-body"><blockquote>
<p>Personally, I think <code>--open... &lt;OPTION&gt;</code> isn't too clear.</p>
</blockquote>
<p>That's a fair point, but I think it's one of the least offensive options considering the existing output. But yeah I can see how people might struggle to understand its exact purpose, I'm just looking for <strong>any</strong> indication to the user that this isn't a normal flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maxrake">@maxrake</a> on 2023-01-30 17:41</div>
            <div class="timeline-body"><p>This community is likely already aware of it, but there is an <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html">IEEE Std 1003.1-2017 for Utility Conventions</a> that describes the argument syntax for standard utilities used throughout POSIX. It covers the use of ellipses:</p>
<blockquote>
<p>Ellipses ( &quot;...&quot; ) are used to denote that one or more occurrences of an operand are allowed. When an option or an operand followed by ellipses is enclosed in brackets, zero or more options or operands can be specified. The form:
<code>utility_name [-g option_argument]... [operand...]</code>
indicates that multiple occurrences of the option and its option-argument preceding the ellipses are valid, with semantics as indicated in the OPTIONS section of the utility. (See also Guideline 11 in <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap12.html#tag_12_02">Utility Syntax Guidelines</a> .)
The form:
<code>utility_name -f option_argument [-f option_argument]... [operand...]</code>
indicates that the -f option is required to appear at least once and may appear multiple times.</p>
</blockquote>
<p>Granted, this syntax is meant for the <code>Usage:</code> section and this issue appears to be discussing how to represent the format in the <code>Options:</code> section of the help output. Still, with that in mind, the <code>--option... &lt;OPTION_ARGUMENT&gt;</code> format appears to be a close match.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-30 17:54</div>
            <div class="timeline-body"><p><code>[-g option_argument]</code> came up in #3272 in a couple of threads.</p>
<p>Quoting myself from that thread</p>
<blockquote>
<p><code>[-S Rev]...</code> doesn't quite work as we have both the short and long being shown. I also worry it could get quite noisy.</p>
</blockquote>
<p>As for that being a cause to use <code>--option... &lt;OPTION_ARGUMENT&gt;</code>, I don't feel these are connected enough to draw that conclusion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-30 17:54</div>
            <div class="timeline-body"><p>Pulling in another idea from #3272 is putting <code>[+]</code> after the short/long in the argument list which is what at least <code>hg</code> does.  My main concern is how well people will understand what it means.  I'd like to see more examples of who all uses it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cd-work">@cd-work</a> on 2023-01-31 09:34</div>
            <div class="timeline-body"><blockquote>
<p>Pulling in another idea from https://github.com/clap-rs/clap/discussions/3272 is putting [+] after the short/long in the argument list which is what at least hg does. My main concern is how well people will understand what it means. I'd like to see more examples of who all uses it.</p>
</blockquote>
<p>Honestly just my 2 cents but I <strong>really</strong> am not a fan of <code>[+]</code>. It's entirely unheard of in the CLI for me and does not fit in with the rest of clap's indicators.</p>
<p>I think what @maxrake suggested with <code>[-t, --test &lt;OPTION&gt;]...</code> is the most sensible and uncontroversial option (no need to reinvent the wheel).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-31 13:49</div>
            <div class="timeline-body"><p>I think context will be important for this thread, so I'm going to ask that any proposal for new output syntax include a mockup of <code>cargo check -h</code> with the syntax.</p>
<p>Arguments affected by this discussion include</p>
<ul>
<li><code>--package</code></li>
<li><code>--exclude</code></li>
<li><code>--bin</code></li>
<li><code>--example</code></li>
<li><code>--features</code></li>
<li><code>--target</code></li>
<li><code>--mesage-format</code></li>
</ul>
<details>
<summary>Current output:</summary>

<pre><code class="language-console">$ cargo check -h
Check a local package and all of its dependencies for errors

Usage: cargo check [OPTIONS]

Options:
  -q, --quiet                   Do not print cargo log messages
  -p, --package [&lt;SPEC&gt;]        Package(s) to check
      --workspace               Check all packages in the workspace
      --exclude &lt;SPEC&gt;          Exclude packages from the check
  -v, --verbose...              Use verbose output (-vv very verbose/build.rs output)
      --all                     Alias for --workspace (deprecated)
      --color &lt;WHEN&gt;            Coloring: auto, always, never
  -j, --jobs &lt;N&gt;                Number of parallel jobs, defaults to # of CPUs
      --frozen                  Require Cargo.lock and cache are up to date
      --keep-going              Do not abort the build as soon as there is an error (unstable)
      --lib                     Check only this package's library
      --locked                  Require Cargo.lock is up to date
      --bin [&lt;NAME&gt;]            Check only the specified binary
      --offline                 Run without accessing the network
      --bins                    Check all binaries
      --config &lt;KEY=VALUE&gt;      Override a configuration value
      --example [&lt;NAME&gt;]        Check only the specified example
  -Z &lt;FLAG&gt;                     Unstable (nightly-only) flags to Cargo, see 'cargo -Z help' for details
      --examples                Check all examples
      --test [&lt;NAME&gt;]           Check only the specified test target
      --tests                   Check all tests
      --bench [&lt;NAME&gt;]          Check only the specified bench target
      --benches                 Check all benches
      --all-targets             Check all targets
  -r, --release                 Check artifacts in release mode, with optimizations
      --profile &lt;PROFILE-NAME&gt;  Check artifacts with the specified profile
  -F, --features &lt;FEATURES&gt;     Space or comma separated list of features to activate
      --all-features            Activate all available features
      --no-default-features     Do not activate the `default` feature
      --target &lt;TRIPLE&gt;         Check for the target triple
      --target-dir &lt;DIRECTORY&gt;  Directory for all generated artifacts
      --manifest-path &lt;PATH&gt;    Path to Cargo.toml
      --ignore-rust-version     Ignore `rust-version` specification in packages
      --message-format &lt;FMT&gt;    Error format
      --unit-graph              Output build graph in JSON (unstable)
      --future-incompat-report  Outputs a future incompatibility report at the end of the build
      --timings[=&lt;FMTS&gt;]        Timing output formats (unstable) (comma separated): html, json
  -h, --help                    Print help information

Run `cargo help check` for more detailed information.
</code></pre>
</details>

</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:48 UTC
    </footer>
</body>
</html>
