<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>method `parse` is private - clap-rs/clap #1575</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>method `parse` is private</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1575">#1575</a>
        opened by <a href="https://github.com/chris13524">@chris13524</a>
        on 2019-10-18 17:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/chris13524">@chris13524</a> on 2019-10-18 17:41</div>
            <div class="timeline-body"><p>I'm using the new v3 macro parsing feature. I want to put my options structure in a separate file and import it in another file. However, when I try to call <code>parse()</code> on it, I get the error <code>method `parse` is private</code>. How do I make this parse function public?</p>
<pre><code>#[derive(Clap)]
#[clap(version = &quot;0.1&quot;, author = &quot;Chris Smith&quot;)]
#[derive(Debug)]
pub struct Options {
    #[clap(short = &quot;l&quot;, long = &quot;listen&quot;, default_value = &quot;127.0.0.1&quot;)]
    pub listen_address: IpAddr,
    
    #[clap(short = &quot;p&quot;, long = &quot;port&quot;, default_value = &quot;53&quot;)]
    pub listen_port: u16,
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2019-10-18 19:10</div>
            <div class="timeline-body"><p>@chris13524 Are you sure <em>this</em> is the code sample to reproduce your issue? I can compile the sample just fine with:</p>
<pre><code class="language-toml">[dependencies]
clap = { git = &quot;https://github.com/clap-rs/clap&quot; }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/deg4uss3r">@deg4uss3r</a> on 2019-10-18 19:12</div>
            <div class="timeline-body"><p>@CreepySkeleton I am able to help reproduce this issue like so:</p>
<p><code>main.rs</code>:</p>
<pre><code class="language-rust">// (Full example with detailed comments in examples/01d_quick_example.rs)
//
// This example demonstrates clap's full 'custom derive' style of creating arguments which is the
// simplest method of use, but sacrifices some flexibility.
extern crate clap;

mod outside;

fn main() {
    let opts: outside::Opts = outside::Opts::parse();

    // Gets a value for config if supplied by user, or defaults to &quot;default.conf&quot;
    println!(&quot;Value for config: {}&quot;, opts.config);
    println!(&quot;Using input file: {}&quot;, opts.input);

    // Vary the output based on how many times the user used the &quot;verbose&quot; flag
    // (i.e. 'myprog -v -v -v' or 'myprog -vvv' vs 'myprog -v'
    match opts.verbose.unwrap_or(0) {
        0 =&gt; println!(&quot;No verbose info&quot;),
        1 =&gt; println!(&quot;Some verbose info&quot;),
        2 =&gt; println!(&quot;Tons of verbose info&quot;),
        3 | _ =&gt; println!(&quot;Don't be crazy&quot;),
    }

}
</code></pre>
<p>outside.rs:</p>
<pre><code class="language-rust">// simplest method of use, but sacrifices some flexibility.
#[macro_use]
use clap::Clap;

/// This doc string acts as a help message when the user runs '--help'
/// as do all doc strings on fields
#[derive(Clap)]
#[clap(version = &quot;1.0&quot;, author = &quot;Kevin K.&quot;)]
pub struct Opts {
    /// Sets a custom config file. Could have been an Option&lt;T&gt; with no default too
    #[clap(short = &quot;c&quot;, long = &quot;config&quot;, default_value = &quot;default.conf&quot;)]
    pub config: String,
    /// Some input. Because this isn't an Option&lt;T&gt; it's required to be used
    pub input: String, 
    /// A level of verbosity, and can be used multiple times
    #[clap(short = &quot;v&quot;, long = &quot;verbose&quot;)]
    pub verbose: Option&lt;i32&gt;,
    #[clap(subcommand)]
    pub subcmd: SubCommand,
}

#[derive(Clap)]
pub enum SubCommand {
    /// A subcommand for controlling testing
    #[clap(name = &quot;test&quot;, version = &quot;1.3&quot;, author = &quot;Someone Else&quot;)]
    Test {
        /// Print debug info 
        #[clap(short = &quot;d&quot;)]
        debug: bool
    }
}
</code></pre>
<p>Getting the same error:</p>
<pre><code>error[E0624]: method `parse` is private
  --&gt; src/main.rs:10:31
   |
10 |     let opts: outside::Opts = outside::Opts::parse();
   |                               ^^^^^^^^^^^^^^^^^^^^

error: aborting due to previous error
</code></pre>
<p>Looking into how to fix it now, any suggestions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2019-10-18 19:24</div>
            <div class="timeline-body"><p>@chris13524 @deg4uss3r It looks like <a href="https://github.com/clap-rs/clap_derive/blob/4a46684b1c522fe3fd45d653d6ba6c7cb885baa5/src/derives/clap.rs#L315"><code>fn parse()</code> generated by <code>clap_derive</code> is not <code>pub</code></a>, so it's local to the module your <code>Options</code> placed in. Workaround here is to reexport the <code>fn</code> manually</p>
<pre><code class="language-rust">/////////////
// outside.rs
pub fn parse_opts() -&gt; Opts {
    Opts::parse()
}

/////////////
// main.rs

fn main() {
    let opts: outside::Opts = outside::parse_opts();
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/deg4uss3r">@deg4uss3r</a> on 2019-10-18 19:32</div>
            <div class="timeline-body"><p>the question is should these functions in <code>clap_derive</code> <strong>be</strong> public? If so I'm happy to put in a quick PR</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chris13524">@chris13524</a> on 2019-10-18 19:36</div>
            <div class="timeline-body"><p>@deg4uss3r I think some libraries have flags that allow you to choose the visibility. For instance <a href="https://docs.rs/crate/derive_builder/0.8.0">this</a> one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../clap-rs/clap_derive/pulls/21.html">clap-rs/clap_derive#21</a> on 2019-10-18 19:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 11:29</div>
            <div class="timeline-body"><p>This is fixed. Furthermore, we're planning to change this stuff so it will   become irrelevant soon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @CreepySkeleton on 2020-02-01 11:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chris13524">@chris13524</a> on 2020-09-16 15:38</div>
            <div class="timeline-body"><p>@CreepySkeleton could you expand on how this is becoming irrelevant?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-09-16 17:17</div>
            <div class="timeline-body"><p>The methods have been moved to traits. Visibility doesn't apply to trait methods - they are always public.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
