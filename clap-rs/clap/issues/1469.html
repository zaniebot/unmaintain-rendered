<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>optionally wrap help lines at less than terminal width - clap-rs/clap #1469</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>optionally wrap help lines at less than terminal width</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1469">#1469</a>
        opened by <a href="https://github.com/wookietreiber">@wookietreiber</a>
        on 2019-05-13 16:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/wookietreiber">@wookietreiber</a> on 2019-05-13 16:03</div>
            <div class="timeline-body"><p>Maintainer's notes:</p>
<p>Workaround</p>
<pre><code class="language-rust">let max_width = std::env::var(&quot;FOO_MAX_WIDTH&quot;)
    .and_then(|s| s.parse::&lt;usize&gt;().ok())
    .unwrap_or(100);
app
    .max_term_width(max_width)
</code></pre>
<hr />
<!--
Please use the following template to assist with creating an issue and to ensure a speedy resolution. If an area is not applicable, feel free to delete the area or mark with `N/A`
-->

<h3>Rust Version</h3>
<ul>
<li>rustc 1.34.1 (fc50f328b 2019-04-24)</li>
</ul>
<h3>Affected Version of clap</h3>
<ul>
<li>2.33.0</li>
</ul>
<h3>Bug or Feature Request Summary</h3>
<p>I have just browsed through quite some <code>man</code> pages (mostly <code>git help cmd</code>) and clap-generated long help outputs (<code>bat</code>, <code>fd</code>, some of my own tools). While doing that, I have noticed that <code>man</code> wraps <strong>paragraphs</strong> not at terminal width but less than that. This can be considered a follow-up to #428 and #451.</p>
<p>I think, I have noticed this because I have been looking at <code>man</code> pages for quite some time and, while the clap-generated <strong>long</strong> help output (<code>--help</code>) looks very similar to a <code>man</code> page (thank you for that, it's awesome!), it sometimes looked a bit weird (to me). I finally noticed what was bugging me and it is the wrapping.</p>
<p>In my opinion (yes, subjectively, I'm getting to that), it is more readable to wrap at less than terminal width. Maybe you feel the same way. Even if you do not feel the same way, you might (objectively) consider for clap-generated <strong>long</strong> help output to emulate the behavior of <code>man</code> pages in this regard.</p>
<p>It is <em>subjective</em> what looks best, to wrap at term width or to wrap at term width minus some value. Thus, <em>objectively</em>, this is not something that the CLI app <strong>developer</strong> should decide, but the user herself/himself. For this <em>objective</em> reason, I am suggesting to let the app <strong>user</strong> have the final say in this, not the <strong>developer</strong> as is done now. I suggest to add an environment variable that clap looks for, e.g. like in this <code>~/.bash_profile</code> snippet:</p>
<pre><code class="language-bash"># this if executes only if shell is interactive
if [[ $- == *i* ]]
then
  # if set, will override max_term_width
  # man for man page style
  # max for max term width
  # u64 for whatever unsigned integer you want
  export CLAP_WRAP_STYLE=&quot;[man|max|u64]&quot;
fi
</code></pre>
<hr />
<p><strong>Note:</strong> I tested how <code>man</code> wraps with different terminal sizes. On standard terminal of 80 x 24 the wrapping is at column 78, so <code>columns - 2</code> and with my usual terminal of 147 columns it's at <code>columns - 4</code>. I guess, they decide somehow. I haven't looked at their code yet.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by @CreepySkeleton on 2020-02-01 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @CreepySkeleton on 2020-02-01 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: maybe</span> added by @CreepySkeleton on 2020-02-01 13:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.1" by @pksunkara on 2020-04-09 07:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/118.html">epage/clapng#118</a> on 2021-12-06 18:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> removed by @epage on 2021-12-08 21:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2021-12-08 21:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "3.1" by @epage on 2021-12-09 20:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 20:01</div>
            <div class="timeline-body"><p>How is this different than <code>max_term_width</code> requested in https://github.com/clap-rs/clap/issues/653 and added in #654?  Am I missing some context for how the two differ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-decision</span> removed by @epage on 2021-12-09 20:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-author</span> added by @epage on 2021-12-09 20:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-12-09 20:30</div>
            <div class="timeline-body"><p>From what I understood when the issue was created, they are asking some kind of runtime max width specifying capability.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 20:36</div>
            <div class="timeline-body"><p>You are right, I missed this part:</p>
<blockquote>
<p>Thus, objectively, this is not something that the CLI app developer should decide, but the user herself/himself. For this objective reason, I am suggesting to let the app user have the final say in this, not the developer as is done now</p>
</blockquote>
<p>If there is a standard env variable across apps, I can see reading it, like https://no-color.org/, otherwise, I think this is best left to the app developer to define and read the variable, setting <code>max_term_width</code>, like</p>
<pre><code class="language-rust">let max_width = std::env::var(&quot;FOO_MAX_WIDTH&quot;)
    .and_then(|s| s.parse::&lt;usize&gt;().ok())
    .unwrap_or(100);
app
    .max_term_width(max_width)
</code></pre>
<p>The developer can read this and then apply it to other areas of their app as well.</p>
<p>Any reason for us to own this behavior in clap?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-12-10 02:29</div>
            <div class="timeline-body"><blockquote>
<p>Any reason for us to own this behavior in clap?</p>
</blockquote>
<p>The only scenario I can think of is allow the user to specify the width via an arg. But this might be niche?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-10 18:04</div>
            <div class="timeline-body"><p>I've noted the way for users to directly do this in the Issue description.  I think for now we should consider that the recommended solution.  If there are concerns with this, feel free to speak up!  It will help us know whether to re-evaluate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2021-12-10 18:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:07 UTC
    </footer>
</body>
</html>
