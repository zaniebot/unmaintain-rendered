```yaml
number: 968
title: Unable to add a validator to an arg from a subcommand using YAML
type: issue
state: closed
author: craigzour
labels:
  - C-enhancement
  - A-validators
assignees: []
created_at: 2017-05-25T14:08:20Z
updated_at: 2018-08-02T03:30:07Z
url: https://github.com/clap-rs/clap/issues/968
synced_at: 2026-01-10T01:57:41Z
```

# Unable to add a validator to an arg from a subcommand using YAML

---

_Issue opened by @craigzour on 2017-05-25 14:08_

Hi,

I am not able to make my validator work with an argument attached to a subcommand. I would like to attach a validator to something I declared in my YAML file.

### Rust Version

rustc 1.17.0 (56124baa9 2017-04-24)

### Affected Version of clap

clap 2.23.2

### Expected Behavior Summary

Validator error should be thrown when my argument is not valid

### Actual Behavior Summary

When I run the code my argument is treated as valid even though it is not

### Sample Code or Link to Sample Code

My cli.yml file:
```
name: blabla
version: "0.0.4"
author: blabla
about: blabla

settings:
    - ColorAlways
    - ColoredHelp
    - VersionlessSubcommands
    - DisableHelpSubcommand
    - DeriveDisplayOrder
    - SubcommandRequiredElseHelp

args:
    - format:
        help: blabla
        global: true
        possible_values: [json, csv]
        short: f
        long: format
        takes_value: true

subcommands:
    - info:
        about: blabla
    - firmware-update:
        about: blabla
        args:
          - firmware-file-path:
              help: blala
              required: true
              takes_value: true
```

My main.rs file:
```
let yaml = load_yaml!("cli.yml");
let cli = App::from_yaml(yaml);
let cli_with_validators = cli.subcommand(SubCommand::with_name("firmware-update").arg(Arg::with_name("firmware-file-path").validator(validate_firmware_file_path)));
let matches = cli_with_validators.get_matches();

fn validate_firmware_file_path(file_path: String) -> Result<(), String> {
  let path = Path::new(&file_path);

  if path.starts_with("bla") && path.ends_with(".bla") {
    return Ok(());
  } else {
    return Err(String::from("Firmware file name is not valid."));
  }
}
```

Thanks !

---

_Comment by @kbknapp on 2017-05-29 21:01_

Thanks for the details and taking the time to file this! This is a known issue, but the workaround is decently simply. Any args which contain validators, will need to be defined in the Rust source.

I'm actively working on a solution to allow mutating args once they've been added which will solve this particular issue.

---

_Label `C: validators` added by @kbknapp on 2017-05-29 21:01_

---

_Label `D: intermediate` added by @kbknapp on 2017-05-29 21:01_

---

_Label `P4: nice to have` added by @kbknapp on 2017-05-29 21:01_

---

_Label `T: enhancement` added by @kbknapp on 2017-05-29 21:01_

---

_Label `W: 3.x` added by @kbknapp on 2017-05-29 21:01_

---

_Comment by @craigzour on 2017-05-30 13:29_

@kbknapp Great ! Thank you :)

---

_Closed by @craigzour on 2017-05-30 13:29_

---
