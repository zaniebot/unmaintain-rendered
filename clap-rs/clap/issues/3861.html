<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[clap_mangen] possible values not shown in generated man page - clap-rs/clap #3861</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[clap_mangen] possible values not shown in generated man page</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/3861">#3861</a>
        opened by <a href="https://github.com/RubixDev">@RubixDev</a>
        on 2022-06-22 12:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/RubixDev">@RubixDev</a> on 2022-06-22 12:45</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Rust Version</h3>
<p>rustc 1.61.0 (fe5b13d68 2022-05-18)</p>
<h3>Clap Version</h3>
<p>3.2.6</p>
<h3>Minimal reproducible code</h3>
<pre><code class="language-rust">use clap::{Parser, CommandFactory};
use clap_mangen::Man;

#[derive(Parser)]
struct Cli {
    #[clap(long, action)]
    pub test: Option&lt;bool&gt;,
}

fn main() -&gt; std::io::Result&lt;()&gt; {
    let mut cmd = Cli::command();

    cmd.write_long_help(&amp;mut std::io::stderr())?;
    eprintln!(&quot;{}&quot;, &quot;-&quot;.repeat(30));

    let man = Man::new(cmd);
    let mut buffer: Vec&lt;u8&gt; = Default::default();
    man.render(&amp;mut buffer)?;
    println!(&quot;{}&quot;, String::from_utf8_lossy(&amp;buffer));

    Ok(())
}
</code></pre>
<h3>Steps to reproduce the bug with the above code</h3>
<ol>
<li>Add <code>clap = { version = &quot;3.2.6&quot;, features = [&quot;derive&quot;] }</code> and <code>clap_mangen = &quot;0.1.9&quot;</code> to <code>Cargo.toml</code></li>
<li>Run <code>cargo run | man -P cat -l -</code></li>
</ol>
<h3>Actual Behaviour</h3>
<p>The above example prints both the normal help message generated by <code>clap</code> and the man page generated by <code>clap_mangen</code> (example output is provided below). The man page does not mention the possible values (<code>true</code> and <code>false</code>) anywhere. The same is true for enums.</p>
<h3>Expected Behaviour</h3>
<p>The man page should mention the possible values just like the help message does (<code>[possible values: true, false]</code>).</p>
<h3>Additional Context</h3>
<p>Output of above example:</p>
<pre><code>asd

USAGE:
    asd [OPTIONS]

OPTIONS:
    -h, --help
            Print help information

        --test &lt;TEST&gt;
            [possible values: true, false]
------------------------------
asd(1)      General Commands Manual      asd(1)

NAME
       asd

SYNOPSIS
       asd [-h|--help] [--test]

DESCRIPTION
OPTIONS
       -h, --help
              Print help information

       --test=TEST

                      asd                asd(1)
</code></pre>
<h3>Debug Output</h3>
<pre><code>    Finished dev [unoptimized + debuginfo] target(s) in 0.02s
     Running `/home/silas/.cache/cargo/debug/asd`
[      clap::builder::command] 	Command::_build: name=&quot;asd&quot;
[      clap::builder::command] 	Command::_propagate:asd
[      clap::builder::command] 	Command::_check_help_and_version: asd
[      clap::builder::command] 	Command::_check_help_and_version: Removing generated version
[      clap::builder::command] 	Command::_propagate_global_args:asd
[      clap::builder::command] 	Command::_derive_display_order:asd
[clap::builder::debug_asserts] 	Command::_debug_asserts
[clap::builder::debug_asserts] 	Arg::_debug_asserts:help
[clap::builder::debug_asserts] 	Arg::_debug_asserts:test
[clap::builder::debug_asserts] 	Command::_verify_positionals
[          clap::output::help] 	Help::new cmd=asd, use_long=true
[          clap::output::help] 	Help::write_help
[          clap::output::help] 	should_show_arg: use_long=true, arg=help
[          clap::output::help] 	Help::write_templated_help
[          clap::output::help] 	Help::write_before_help
[          clap::output::help] 	Help::write_bin_name
asd 

USAGE:
    [         clap::output::usage] 	Usage::create_usage_no_title
[         clap::output::usage] 	Usage::create_help_usage; incl_reqs=true
[         clap::output::usage] 	Usage::get_required_usage_from: incls=[], matcher=false, incl_last=false
[         clap::output::usage] 	Usage::get_required_usage_from: unrolled_reqs={}
[         clap::output::usage] 	Usage::get_required_usage_from: ret_val={}
[         clap::output::usage] 	Usage::needs_options_tag
[         clap::output::usage] 	Usage::needs_options_tag:iter: f=help
[         clap::output::usage] 	Usage::needs_options_tag:iter Option is built-in
[         clap::output::usage] 	Usage::needs_options_tag:iter: f=test
[      clap::builder::command] 	Command::groups_for_arg: id=test
[         clap::output::usage] 	Usage::needs_options_tag:iter: [OPTIONS] required
[         clap::output::usage] 	Usage::create_help_usage: usage=asd [OPTIONS]
asd [OPTIONS]

[          clap::output::help] 	Help::write_all_args
[          clap::output::help] 	should_show_arg: use_long=true, arg=help
[          clap::output::help] 	should_show_arg: use_long=true, arg=test
OPTIONS:
[          clap::output::help] 	Help::write_args OPTIONS
[          clap::output::help] 	should_show_arg: use_long=true, arg=help
[          clap::output::help] 	Help::write_args: arg=&quot;help&quot; longest=6
[          clap::output::help] 	should_show_arg: use_long=true, arg=test
[          clap::output::help] 	Help::write_args: arg=&quot;test&quot; longest=13
[          clap::output::help] 	should_show_arg: use_long=true, arg=help
[          clap::output::help] 	Help::spec_vals: a=--help
[          clap::output::help] 	Help::spec_vals: a=--help
[          clap::output::help] 	Help::short
    -h[          clap::output::help] 	Help::long
, --help[          clap::output::help] 	Help::val: arg=help
[          clap::output::help] 	Help::align_to_about: arg=help, next_line_help=true, longest=13
[          clap::output::help] 	Help::align_to_about: printing long help so skip alignment
[          clap::output::help] 	Help::help
[          clap::output::help] 	Help::help: Next Line...true

            [          clap::output::help] 	Help::help: Too long...
[          clap::output::help] 	No
Print help information

[          clap::output::help] 	Help::spec_vals: a=--test &lt;TEST&gt;
[          clap::output::help] 	Help::spec_vals: Found possible vals...[PossibleValue { name: &quot;true&quot;, help: None, aliases: [], hide: false }, PossibleValue { name: &quot;false&quot;, help: None, aliases: [], hide: false }]
[          clap::output::help] 	Help::short
        [          clap::output::help] 	Help::long
--test[          clap::output::help] 	Help::val: arg=test
 &lt;TEST&gt;[          clap::output::help] 	Help::align_to_about: arg=test, next_line_help=true, longest=13
[          clap::output::help] 	Help::align_to_about: printing long help so skip alignment
[          clap::output::help] 	Help::help
[          clap::output::help] 	Help::help: Next Line...true

            [          clap::output::help] 	Help::help: Too long...
[          clap::output::help] 	No
[possible values: true, false][          clap::output::help] 	Help::write_after_help

------------------------------
[      clap::builder::command] 	Command::_build: name=&quot;asd&quot;
[      clap::builder::command] 	Command::_build: already built
[      clap::builder::command] 	Command::_build_bin_names
[         clap::output::usage] 	Usage::get_required_usage_from: incls=[], matcher=false, incl_last=true
[         clap::output::usage] 	Usage::get_required_usage_from: unrolled_reqs={}
[         clap::output::usage] 	Usage::get_required_usage_from: ret_val={}
.ie \n(.g .ds Aq \(aq
.el .ds Aq '
.TH asd 1  &quot;asd &quot; 
.SH NAME
asd
.SH SYNOPSIS
\fBasd\fR [\fB\-h\fR|\fB\-\-help\fR] [\fB\-\-test\fR] 
.SH DESCRIPTION
.SH OPTIONS
.TP
\fB\-h\fR, \fB\-\-help\fR
Print help information
.TP
\fB\-\-test\fR=\fITEST\fR



</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by @RubixDev on 2022-06-22 12:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-06-22 13:57</div>
            <div class="timeline-body"><p>Huh, we have #3360 for improving possible values but not an issue for tracking showing them in the first place.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2022-06-22 13:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-man</span> added by @epage on 2022-06-22 13:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Calder-Ty">@Calder-Ty</a> on 2022-08-07 18:54</div>
            <div class="timeline-body"><p>I wouldn't mind working on this if it's not being handled already</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-08 14:00</div>
            <div class="timeline-body"><p>Go for it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4082.html">clap-rs/clap#4082</a> on 2022-08-16 01:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2022-08-24 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2022-08-24 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4146.html">clap-rs/clap#4146</a> on 2022-08-30 04:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:08 UTC
    </footer>
</body>
</html>
