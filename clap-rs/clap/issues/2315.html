<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add completion support for `help` subcommand in all shells - clap-rs/clap #2315</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add completion support for `help` subcommand in all shells</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/2315">#2315</a>
        opened by <a href="https://github.com/dkg">@dkg</a>
        on 2021-01-28 18:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dkg">@dkg</a> on 2021-01-28 18:38</div>
            <div class="timeline-body"><p>Maintainer's notes</p>
<ul>
<li>Remember that you can do <code>cmd help sub1 sub2</code> which should be supported</li>
</ul>
<hr />
<p>Sequoia's <code>sq</code> uses clap to generate bash bindings.</p>
<p><code>sq</code> has a subcommand interface, including the subcommand <code>help</code>.  <code>sq help</code> behaves the way that <code>sq --help</code> does.</p>
<p>That is, you can do <code>sq help inspect</code> (<code>inspect</code> is one of the <code>sq</code> subcommands).</p>
<p>The tab completion when a bash user types <code>sq help &lt;TAB&gt;&lt;TAB&gt;</code> does <em>not</em> show the list of subcommands the way that <code>sq --help &lt;TAB&gt;&lt;TAB&gt;</code> does.  Rather, it only shows the options like <code>-h</code>, <code>-V</code>, <code>--version</code>, etc.</p>
<p>I <a href="https://gitlab.com/sequoia-pgp/sequoia/-/issues/656">reported this concern to sequoia</a> and they indicated that it is a bug in clap.</p>
<h3>Versions</h3>
<ul>
<li><strong>Rust</strong>: 1.48.0</li>
<li><strong>Clap</strong>: 2.33.3</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @dkg on 2021-01-28 18:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-01-28 18:40</div>
            <div class="timeline-body"><p>Hello,</p>
<p>We really appreciate your enthusiasm to contribute to this open source project and to help make it better. To make use of the maintainers' time more productively, we have set up a few issue templates that should be used when creating an issue.</p>
<p>We see that you made an accidental mistake because the issue you created doesn't follow the template. We will be closing this until that is rectified. Please do so and message here and we will gladly re-open this.</p>
<p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-01-28 18:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @pksunkara on 2021-01-28 18:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: generator</span> added by @pksunkara on 2021-01-28 18:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by @pksunkara on 2021-01-28 18:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> removed by @pksunkara on 2021-01-28 18:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">:money_with_wings: $10</span> added by @pksunkara on 2021-01-28 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "bash tab completion for clap-generated subcommand CLI doesn't show subcommands after "foo help <TAB><TAB>"" to "Add completion support for `help` subcommand in all shells" by @pksunkara on 2021-01-28 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.1" by @pksunkara on 2021-01-28 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dkg">@dkg</a> on 2021-01-28 18:47</div>
            <div class="timeline-body"><p>thanks, @pksunkara !</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/175.html">epage/clapng#175</a> on 2021-12-06 20:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "3.1" by @epage on 2021-12-13 15:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2021-12-13 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4077.html">clap-rs/clap#4077</a> on 2022-08-15 04:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4100.html">clap-rs/clap#4100</a> on 2022-08-20 23:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/talklittle">@talklittle</a> on 2022-08-23 08:49</div>
            <div class="timeline-body"><p>Update: My second attempt was to put the help completion in <code>clap_complete/src/generator/utils.rs</code> (see #4077 discussion). It went poorly. Modifying the command tree after it has been built feels wrong, especially with the current Command API that treats a Command as mostly immutable. I couldn't get it working, and even if I did, it feels like it would easily break in the future.</p>
<p>My next attempt will be closer to #4077, putting the subtree-copy logic back in the parser where the &quot;help&quot; subcommand is first created. Plus fixing the missing recursion cases and adding a parser flag to toggle this slow logic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4115.html">clap-rs/clap#4115</a> on 2022-08-25 21:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2022-08-26 20:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5547.html">clap-rs/clap#5547</a> on 2024-06-26 22:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:25 UTC
    </footer>
</body>
</html>
