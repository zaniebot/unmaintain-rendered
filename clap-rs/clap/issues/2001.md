```yaml
number: 2001
title: "When taking in an input file as \"tes.txt\" or \"test.txt\", clap tries to treat it as a subcommand and it fails"
type: issue
state: closed
author: embeddedpenguin
labels:
  - C-bug
assignees: []
created_at: 2020-07-05T16:07:17Z
updated_at: 2020-07-05T16:57:56Z
url: https://github.com/clap-rs/clap/issues/2001
synced_at: 2026-01-10T01:57:44Z
```

# When taking in an input file as "tes.txt" or "test.txt", clap tries to treat it as a subcommand and it fails

---

_Issue opened by @embeddedpenguin on 2020-07-05 16:07_

### Code

```rust
// You code goes here. Please try to write a complete program,
// including `fn main() { ... }`
extern crate clap;
use clap::{Arg, App, SubCommand};

fn main()
{
	let matches = App::new("Igloo")
		.version("0.0.1")
		.author("Penguin <>")
		.about("Stuff")
		.arg(Arg::with_name("config")
			 .short("c")
			 .long("config")
			 .value_name("FILE")
			 .help("Sets a custom config file")
			 .takes_value(true))
		.arg(Arg::with_name("INPUT")
			 .help("Sets the input file to use")
			 .required(true)
			 .index(1))
		.arg(Arg::with_name("v")
			 .short("v")
			 .multiple(true)
			 .help("Sets the level of verbosity"))
		.subcommand(SubCommand::with_name("test")
					.about("Controls testing features")
					.version("1.3")
					.author("Name <>")
					.arg(Arg::with_name("debug")
						 .long("debug")
						 .short("d")
						 .help("print debug information verbosely")))
		.get_matches();

	// gets a value for config if supplied by a user, or defaults to "default.conf"
	let config = matches.value_of("config").unwrap_or("default.conf");
	println!("Value for config: {}", config);

	// vary the output based on how many times the user used the "verbose" flag
	// i.e. 'myprog -v -v -v' or 'myprog -vvv' vs 'myprog -v'
	match matches.occurrences_of("v")
	{
		0 => println!("No verbose info"),
		1 => println!("Some verbose info"),
		2 => println!("Tons of verbose info"),
		3 | _ => println!("Don't be crazy"),
	}

	// You can handle information about subcommands by requesting their matches by name
	// (as below), requesting just the name used, or both at the same time
	if let Some(matches) = matches.subcommand_matches("test")
	{
		if matches.is_present("debug")
		{
			println!("Printing debug info...");
		}
		else
		{
			println!("printing normally...");
		}
	}
}
```

### Steps to reproduce the issue

1. build as normal with `cargo build`
2. run with `./target/release/<bin> <subcommand name here>.txt`
3. PROFIT $$$$$
### Version

* **Rust**: rustc 1.44.1 (c7087fe00 2020-06-17)
* **Clap**: "~2.33.1"

### Actual Behavior Summary

I'm following the example from this video: https://www.youtube.com/watch?v=7z9L6NOjbqM&list=PLza5oFLQGTl2Z5T8g1pRkIynR3E0_pc7U

I am using the name "test.txt" as my input file and running it with the following command:
`./target/release/<bin> test.txt`

I get the following output:
```
./target/release/igloo test.txt
error: The subcommand 'test.txt' wasn't recognized
	Did you mean 'test'?

If you believe you received this message in error, try re-running with 'igloo -- test.txt'

USAGE:
    igloo [FLAGS] [OPTIONS] <INPUT> [SUBCOMMAND]

For more information try --help
```
### Expected Behavior Summary

It shouldn't be looking for a command if it is a file, right? So why is it trying to autocorrect a required input to a subcommand? Does this mean I can't make any subcommands that might be related to the file names that a user might input?




---

_Label `T: bug` added by @embeddedpenguin on 2020-07-05 16:07_

---

_Comment by @CreepySkeleton on 2020-07-05 16:44_

Yeah, this is a bug, but it appears to be fixed in master:
```rust
use clap::{Arg, App};

fn main()
{
    let matches = App::new("Igloo")
        .version("0.0.1")
        .author("Penguin <>")
        .about("Stuff")
        .arg(Arg::new("config")
             .short('c')
             .long("config")
             .value_name("FILE")
             .about("Sets a custom config file")
             .takes_value(true))
        .arg(Arg::new("INPUT")
             .about("Sets the input file to use")
             .required(true)
             .index(1))
        .arg(Arg::new("v")
             .short('v')
             .multiple(true)
             .about("Sets the level of verbosity"))
        .subcommand(App::new("test")
                    .about("Controls testing features")
                    .version("1.3")
                    .author("Name <>")
                    .arg(Arg::new("debug")
                         .long("debug")
                         .short('d')
                         .about("print debug information verbosely")))
        .get_matches();

    println!("{:#?}", matches);
}
```

```
[Running: cargo run --message-format=json -- test.txt]
   Compiling probe v0.2.0 (D:\workspace\probe)
    Finished dev [unoptimized + debuginfo] target(s) in 1.79s
     Running `target\debug\probe.exe test.txt`
ArgMatches {
    args: {
        INPUT: MatchedArg {
            occurs: 1,
            ty: CommandLine,
            indices: [
                1,
            ],
            vals: [
                "test.txt",
            ],
        },
    },
    subcommand: None,
}
```

We don't really work on `clap 2` anymore (unless it's a security vulnerability), so I guess you're going to have to wait for `3.0` to be released. Sorry.

---

_Closed by @CreepySkeleton on 2020-07-05 16:44_

---

_Comment by @embeddedpenguin on 2020-07-05 16:49_

I'm perfectly fine with using the version 3 even if its in beta. I'm just new to rust and didn't know if beta meant not working. Thanks for the quick response!

---

_Comment by @CreepySkeleton on 2020-07-05 16:57_

"Beta" means "you're outside of normal semver guarantees and we still hold the right to break public API until proper `3.0.0` is released". It's also documented poorly. 

But otherwise, it works, mostly fine. 

---

_Referenced in [getsentry/sentry-cli#686](../../getsentry/sentry-cli/issues/686.md) on 2020-07-10 10:03_

---
