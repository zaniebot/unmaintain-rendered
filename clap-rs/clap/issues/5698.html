<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `default_values_if` to match `default_values` - clap-rs/clap #5698</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add `default_values_if` to match `default_values`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/5698">#5698</a>
        opened by <a href="https://github.com/SuspiciousDuck">@SuspiciousDuck</a>
        on 2024-08-24 05:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/SuspiciousDuck">@SuspiciousDuck</a> on 2024-08-24 05:13</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.5.16</p>
<h3>Describe your use case</h3>
<p>I have an argument which takes a tuple. I also have a previous argument which is a <code>String</code>. I want to create 2 different defaults, depending on what the <code>String</code> is. This is impossible to implement because <code>default_value_if</code> does not accept a list [] for the value.</p>
<h3>Describe the solution you'd like</h3>
<p>I would like to see <code>default_values_if</code> and or <code>default_values_ifs</code> implemented.</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @SuspiciousDuck on 2024-08-24 05:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-builder</span> added by @epage on 2024-08-25 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-parsing</span> added by @epage on 2024-08-25 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2024-08-25 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "default_values_if" to "Add `default_values_if` to match `default_values`" by @epage on 2025-08-07 20:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> removed by @epage on 2025-08-07 20:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2025-08-07 20:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-08-07 20:15</div>
            <div class="timeline-body"><p>Sorry for not responding earlier.  Looking at this again, it makes sense for us to update the conditional to support multiple values like the unconditional version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cooronx">@cooronx</a> on 2025-09-08 07:12</div>
            <div class="timeline-body"><p>hi @epage , Iâ€™d like to work on this issue as my first contribution to clap. Could you point me to where in the codebase I should start and any tests/examples to check the result?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-09-08 15:47</div>
            <div class="timeline-body"><p>I'd recommend starting with the <a href="https://docs.rs/clap/latest/clap/struct.Arg.html#method.default_value_if"><code>default_value_if</code></a> and <a href="https://docs.rs/clap/latest/clap/struct.Arg.html#method.default_value_ifs"><code>default_value_ifs</code></a>.  From there, you see that the field you'll be working with is
https://github.com/clap-rs/clap/blob/2c04acd3607e5c4676477ca14948419bb31c73a1/clap_builder/src/builder/arg.rs#L84</p>
<p>You'll need to update that to be similar to
https://github.com/clap-rs/clap/blob/2c04acd3607e5c4676477ca14948419bb31c73a1/clap_builder/src/builder/arg.rs#L83</p>
<p>and then update the callers to be similar to <code>default_value</code> / <code>default_values</code>.</p>
<p>The compiler errors should then also point to you were in the parser this is used which is
https://github.com/clap-rs/clap/blob/2c04acd3607e5c4676477ca14948419bb31c73a1/clap_builder/src/parser/parser.rs#L1448
and update that in a similar way to <code>default_values</code> below it
https://github.com/clap-rs/clap/blob/2c04acd3607e5c4676477ca14948419bb31c73a1/clap_builder/src/parser/parser.rs#L1484-L1512</p>
<p>As for <code>examples/</code>, we don't provide those for every feature</p>
<p>As for tests, if you search in <code>tests/</code> you'll see that we generally group things and <code>default_value_if</code> tests are in
https://github.com/clap-rs/clap/blob/master/tests/builder/default_vals.rs
Add tests similar to what we do for <code>default_value_if</code> and <code>default_values</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cooronx">@cooronx</a> on 2025-09-10 09:06</div>
            <div class="timeline-body"><p>@epage which branch I should be working on(fork)?  currently working in the master branch, not sure if it's correct</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-09-10 13:49</div>
            <div class="timeline-body"><p>All development happens on master.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/6127.html">clap-rs/clap#6127</a> on 2025-09-13 14:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/6129.html">clap-rs/clap#6129</a> on 2025-09-13 14:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2025-11-19 20:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:09 UTC
    </footer>
</body>
</html>
