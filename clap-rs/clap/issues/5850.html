<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrate initial OSS-Fuzz support - clap-rs/clap #5850</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Integrate initial OSS-Fuzz support</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/5850">#5850</a>
        opened by <a href="https://github.com/initializedd">@initializedd</a>
        on 2024-12-21 01:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/initializedd">@initializedd</a> on 2024-12-21 01:54</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>master</p>
<h3>Describe your use case</h3>
<p>Initial support for fuzzing clap to discover and fix bugs.</p>
<p>If my fuzzer is merged, I will open a pull request in the <a href="https://github.com/google/oss-fuzz">OSS-Fuzz repository</a> to run the fuzzers for this library on Google's infrastructure. Maintainers of clap will be notified if any bugs are discovered.</p>
<p>Please see the <a href="https://google.github.io/oss-fuzz/">OSS-Fuzz documentation</a> and <a href="https://google.github.io/oss-fuzz/getting-started/bug-disclosure-guidelines/">Bug disclosure guidelines</a> before merging.</p>
<p>Thanks!</p>
<h3>Describe the solution you'd like</h3>
<p>PR #5851</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @initializedd on 2024-12-21 01:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5851.html">clap-rs/clap#5851</a> on 2024-12-21 01:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-12-24 02:42</div>
            <div class="timeline-body"><p>I've wondered about fuzzing but whats not too clear to me is what would provide the best value, or in other words, what are the high risk areas.  Like in #5851, its parsing strings (not <code>OsString</code>s) against a limited, static CLI definition.  I feel like this is unlikely to uncover anything of interest.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/initializedd">@initializedd</a> on 2024-12-24 13:47</div>
            <div class="timeline-body"><blockquote>
<p>I've wondered about fuzzing but whats not too clear to me is what would provide the best value, or in other words, what are the high risk areas. Like in #5851, its parsing strings (not <code>OsString</code>s) against a limited, static CLI definition. I feel like this is unlikely to uncover anything of interest.</p>
</blockquote>
<p>Thanks for your response.</p>
<p>I agree that the fuzzer in #5851 is unlikely to uncover anything of interest, but Iâ€™d like to emphasize that that this is more about integrating OSS-Fuzz support than the specific fuzzers themselves at this stage. We need to ensure that we have the necessary approvals from both parties before diving deep into the fuzzers. The aim is to eventually reach 100% fuzzing coverage through an iterative process of constant refinement.</p>
<p>I've updated #5851 to parse <code>OsString</code>s instead.</p>
<p>I am open to any further suggestions you may have.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-01-02 20:45</div>
            <div class="timeline-body"><p>An <code>OsString</code> from a <code>String</code> doesn't make much of a difference.</p>
<p>For me, the big question is &quot;will this be worth it&quot; which is dependent on what a proposed fuzzer looks like.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/popematt">@popematt</a> on 2025-01-07 16:54</div>
            <div class="timeline-body"><p>@initializedd, I'm sorry, I over-reacted based on my own bad experience with some unknown 3rd party actor.  I realize now that it sounds like I am accusing <em>you</em> of malicious behavior. I know nothing about you, and so I cannot fairly comment on your intentions. In retrospect, I don't think my original comment has any value, so I will delete it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/initializedd">@initializedd</a> on 2025-01-07 18:17</div>
            <div class="timeline-body"><blockquote>
<p>@initializedd, I'm sorry, I over-reacted based on my own bad experience with some unknown 3rd party actor. I realize now that it sounds like I am accusing <em>you</em> of malicious behavior. I know nothing about you, and so I cannot fairly comment on your intentions. In retrospect, I don't think my original comment has any value, so I will delete it.</p>
</blockquote>
<p>Thanks for understanding.</p>
<p>@epage Are there any specific examples that you would suggest drawing inspiration from to improve the proposed fuzzer?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-01-07 18:41</div>
            <div class="timeline-body"><p>I don't know of an example that would be relevant for fuzzing.  What I'm asking of you is to propose fuzzing that would provide enough value to be worth it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/initializedd">@initializedd</a> on 2025-03-12 21:04</div>
            <div class="timeline-body"><p>@epage Apologies for my absence.</p>
<p>I am still keen to integrate fuzzing support for your library.</p>
<p>I've taken a further look at the codebase, and it seems to me that we will get the most value out of this by fuzzing the internal functions. Usages of <code>unsafe</code> (although few in the codebase) should probably be prioritized for extra assurance.</p>
<p>Some ideas of internal functions that we could start with:</p>
<ul>
<li><a href="https://github.com/clap-rs/clap/blob/master/clap_lex/src/lib.rs#L492">is_number</a></li>
<li><a href="https://github.com/clap-rs/clap/blob/master/clap_lex/src/lib.rs#L432">is_negative_number</a></li>
<li><a href="https://github.com/clap-rs/clap/blob/master/clap_lex/src/ext.rs#L201">strip_prefix</a></li>
<li><a href="https://github.com/clap-rs/clap/blob/master/clap_lex/src/ext.rs#L223">split_once</a></li>
<li><a href="https://github.com/clap-rs/clap/blob/master/clap_lex/src/ext.rs#L275">split_at</a></li>
<li><a href="https://github.com/clap-rs/clap/blob/352e99f59e7aabf2a34e5e9fd334e568a0b197e6/clap_lex/src/lib.rs#L453">next_value_os</a></li>
</ul>
<p>Absolutely happy to implement support for all of those (providing that you agree), and any more that you think would be good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-03-17 18:25</div>
            <div class="timeline-body"><p>Note that the goal for any of those <code>ext.rs</code> functions is for them to be moved into <code>std</code> and for us to use that, see rust-lang/libs-team#311</p>
<p><code>clap_lex</code>s public API is a possibility, depending on what the fuzzing would like.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/initializedd">@initializedd</a> on 2025-04-28 22:18</div>
            <div class="timeline-body"><p>@epage I've updated the PR to fuzz <code>clap_lex</code> as suggested, specifically <code>ShortFlags::next_value_os</code>, what are your thoughts?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-04-29 15:36</div>
            <div class="timeline-body"><p>In re-evaluating this, I feel like fuzzing is not offering enough of a benefit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2025-04-29 15:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:35 UTC
    </footer>
</body>
</html>
