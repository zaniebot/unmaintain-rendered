<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing generated help for --help and --version with `clap::App::write_help` - clap-rs/clap #1924</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Missing generated help for --help and --version with `clap::App::write_help`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1924">#1924</a>
        opened by <a href="https://github.com/SlooowAndFurious">@SlooowAndFurious</a>
        on 2020-05-13 10:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/SlooowAndFurious">@SlooowAndFurious</a> on 2020-05-13 10:37</div>
            <div class="timeline-body"><h3>Code</h3>
<p>This code shows the differences between calling this program with <code>--help</code> and displaying the help with <code>clap::App::write_help</code>.</p>
<pre><code class="language-rust">use std::io;

extern crate clap;
use clap::{App, Arg};

fn main() {
    let app = App::new(&quot;hello&quot;)
        .version(&quot;0.1&quot;)
        .arg(
            Arg::with_name(&quot;foo&quot;)
            .help(&quot;Help about foo&quot;)
        )
        .arg(
            Arg::with_name(&quot;bar&quot;)
            .help(&quot;Help about bar&quot;)
        );

    println!(&quot;App::write_help&quot;);
    app.write_help(&amp;mut io::stdout());

    println!(&quot;\n\n&quot;);
    println!(&quot;App::get_matches&quot;);
    app.get_matches();
}
</code></pre>
<h3>Steps to reproduce the issue</h3>
<p>Just run <code>cargo run -- --help</code></p>
<h3>Version</h3>
<ul>
<li><strong>Rust</strong>: rustc 1.43.1 (8d69840ab 2020-05-04)</li>
<li><strong>Clap</strong>: 2.33.1</li>
</ul>
<h3>Actual Behavior Summary</h3>
<p><code>clap::App::write_help</code> writes the following to the given argument (<code>std::io::stdout()</code>)</p>
<pre><code>hello 0.1

USAGE:
    hello [ARGS]

ARGS:
    &lt;foo&gt;    Help about foo
    &lt;bar&gt;    Help about bar
</code></pre>
<h3>Expected Behavior Summary</h3>
<p>I think the help generated for <code>--help</code> and <code>--version</code> should be written too <em>or</em> the doc should <em>explicitly</em> warn these sections won't be written (and suggest an alternative method to do this).</p>
<p>The code above should show this</p>
<pre><code>hello 0.1

USAGE:
    clap-bug [ARGS]

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;foo&gt;    Help about foo
    &lt;bar&gt;    Help about bar

</code></pre>
<p>for both <code>clap::App::write_help</code> and <code>clap::App::get_matches</code>.</p>
<h3>Debug output</h3>
<details>
<summary> Debug Output </summary>
<pre>
<code>

<p>App::write_help
DEBUG:clap:Help::write_app_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Parser::color;
DEBUG:clap:Parser::color: Color setting...Auto
DEBUG:clap:is_a_tty: stderr=false
DEBUG:clap:Help::new;
DEBUG:clap:Help::write_help;
DEBUG:clap:Help::write_default_help;
DEBUG:clap:Help::write_bin_name;
hello DEBUG:clap:Help::write_version;
0.1</p>
<p>USAGE:DEBUG:clap:usage::create_usage_no_title;
DEBUG:clap:usage::get_required_usage_from: reqs=[], extra=None
DEBUG:clap:usage::get_required_usage_from: after init desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: no more children
DEBUG:clap:usage::get_required_usage_from: final desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: args_in_groups=[]
DEBUG:clap:usage::needs_flags_tag;
DEBUG:clap:usage::needs_flags_tag: [FLAGS] not required
DEBUG:clap:usage::get_args_tag;
DEBUG:clap:usage::get_args_tag:iter:foo:
DEBUG:clap:Parser::groups_for_arg: name=foo
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::get_args_tag:iter: 1 Args not required or hidden
DEBUG:clap:usage::get_args_tag:iter:bar:
DEBUG:clap:Parser::groups_for_arg: name=bar
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::get_args_tag:iter: 2 Args not required or hidden
DEBUG:clap:usage::get_args_tag:iter: More than one, returning [ARGS]
DEBUG:clap:usage::create_help_usage: usage=hello [ARGS]</p>
<pre><code>hello [ARGS]</code></pre>
<p>DEBUG:clap:Help::write_all_args;
ARGS:
DEBUG:clap:Help::write_args_unsorted;
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=<foo>
<foo>DEBUG:clap:Help::spec_vals: a=<foo>
DEBUG:clap:Help::val: Has switch...No, and not next_line
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
Help about foo
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=<bar>
<bar>DEBUG:clap:Help::spec_vals: a=<bar>
DEBUG:clap:Help::val: Has switch...No, and not next_line
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
Help about bar</p>
<p>App::get_matches
DEBUG:clap:Parser::propagate_settings: self=hello, g_settings=AppFlags(
(empty),
)
DEBUG:clap:Parser::get_matches_with;
DEBUG:clap:Parser::create_help_and_version;
DEBUG:clap:Parser::create_help_and_version: Building --help
DEBUG:clap:Parser::create_help_and_version: Building --version
DEBUG:clap:Parser::get_matches_with: Begin parsing '&quot;--help&quot;' ([45, 45, 104, 101, 108, 112])
DEBUG:clap:Parser::is_new_arg:&quot;--help&quot;:NotFound
DEBUG:clap:Parser::is_new_arg: arg_allows_tac=false
DEBUG:clap:Parser::is_new_arg: -- found
DEBUG:clap:Parser::is_new_arg: starts_new_arg=true
DEBUG:clap:Parser::possible_subcommand: arg=&quot;--help&quot;
DEBUG:clap:Parser::get_matches_with: possible_sc=false, sc=None
DEBUG:clap:ArgMatcher::process_arg_overrides:None;
DEBUG:clap:Parser::parse_long_arg;
DEBUG:clap:Parser::parse_long_arg: Does it contain '='...No
DEBUG:clap:Parser::parse_long_arg: Found valid flag '--help'
DEBUG:clap:Parser::check_for_help_and_version_str;
DEBUG:clap:Parser::check_for_help_and_version_str: Checking if --help is help or version...Help
DEBUG:clap:Parser::_help: use_long=true
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Parser::color;
DEBUG:clap:Parser::color: Color setting...Auto
DEBUG:clap:is_a_tty: stderr=false
DEBUG:clap:Help::new;
DEBUG:clap:Help::write_help;
DEBUG:clap:Help::write_default_help;
DEBUG:clap:Help::write_bin_name;
DEBUG:clap:Help::write_version;
DEBUG:clap:usage::create_usage_no_title;
DEBUG:clap:usage::get_required_usage_from: reqs=[], extra=None
DEBUG:clap:usage::get_required_usage_from: after init desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: no more children
DEBUG:clap:usage::get_required_usage_from: final desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: args_in_groups=[]
DEBUG:clap:usage::needs_flags_tag;
DEBUG:clap:usage::needs_flags_tag:iter: f=hclap_help;
DEBUG:clap:usage::needs_flags_tag:iter: f=vclap_version;
DEBUG:clap:usage::needs_flags_tag: [FLAGS] not required
DEBUG:clap:usage::get_args_tag;
DEBUG:clap:usage::get_args_tag:iter:foo:
DEBUG:clap:Parser::groups_for_arg: name=foo
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::get_args_tag:iter: 1 Args not required or hidden
DEBUG:clap:usage::get_args_tag:iter:bar:
DEBUG:clap:Parser::groups_for_arg: name=bar
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::get_args_tag:iter: 2 Args not required or hidden
DEBUG:clap:usage::get_args_tag:iter: More than one, returning [ARGS]
DEBUG:clap:usage::create_help_usage: usage=clap-bug [ARGS]
DEBUG:clap:Help::write_all_args;
DEBUG:clap:Help::write_args;
DEBUG:clap:Help::write_args: Current Longest...2
DEBUG:clap:Help::write_args: New Longest...6
DEBUG:clap:Help::write_args: Current Longest...6
DEBUG:clap:Help::write_args: New Longest...9
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--help
DEBUG:clap:Help::spec_vals: a=--help
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width &gt; (width - taken)...23 &gt; (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=7
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--version
DEBUG:clap:Help::spec_vals: a=--version
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width &gt; (width - taken)...26 &gt; (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_args_unsorted;
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=<foo>
DEBUG:clap:Help::spec_vals: a=<foo>
DEBUG:clap:Help::val: Has switch...No, and not next_line
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=<bar>
DEBUG:clap:Help::spec_vals: a=<bar>
DEBUG:clap:Help::val: Has switch...No, and not next_line
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
hello 0.1</p>
<p>USAGE:
clap-bug [ARGS]</p>
<p>FLAGS:
-h, --help       Prints help information
-V, --version    Prints version information</p>
<p>ARGS:
<foo>    Help about foo
<bar>    Help about bar</p>
</code>
</pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @SlooowAndFurious on 2020-05-13 10:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.0" by @pksunkara on 2020-05-13 10:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SlooowAndFurious">@SlooowAndFurious</a> on 2020-05-13 11:55</div>
            <div class="timeline-body"><p>Oops, not noticed issue #808 (which is closed), and actually, the doc mentions it. Sorry, I close this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @SlooowAndFurious on 2020-05-13 11:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
