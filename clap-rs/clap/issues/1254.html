<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Appsetting::InferSubcommands can't match a command whose name is a substring of another - clap-rs/clap #1254</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Appsetting::InferSubcommands can't match a command whose name is a substring of another</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1254">#1254</a>
        opened by <a href="https://github.com/vincentdephily">@vincentdephily</a>
        on 2018-04-19 10:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/vincentdephily">@vincentdephily</a></div>
            <div class="timeline-body"><h3>Rust Version</h3>
<p>1.25.0</p>
<h3>Affected Version of clap</h3>
<p>2.31.2</p>
<h3>Expected Behavior Summary</h3>
<p>Assuming I have subcommands &quot;foo&quot;, &quot;foobar&quot;, and &quot;football&quot; with Appsetting::InferSubcommands, I should be able to give &quot;foo&quot;, &quot;foob&quot;, or &quot;foot&quot; parameters (it's ok to fail if I give &quot;f&quot; or &quot;fo&quot;).</p>
<h3>Actual Behavior Summary</h3>
<pre><code>$ ./inferbug.crs foo
error: The subcommand 'foo' wasn't recognized
        Did you mean 'foo'?
</code></pre>
<h3>Sample Code or Link to Sample Code</h3>
<pre><code class="language-rust">#!/usr/bin/env run-cargo-script
//! ```cargo                                                                                                                                                                                                                                 
//! [dependencies]                                                                                                                                                                                                                           
//! clap = &quot;2.31.2&quot;                                                                                                                                                                                                                          
//! ```                                                                                                                                                                                                                                      
extern crate clap;
use clap::{App, AppSettings, SubCommand};
fn main() {
    let cli = App::new(&quot;clap-infer-bug&quot;)
        .setting(AppSettings::InferSubcommands)
        .setting(AppSettings::SubcommandRequiredElseHelp)
        .subcommand(SubCommand::with_name(&quot;foo&quot;))
        .subcommand(SubCommand::with_name(&quot;foobar&quot;))
        .subcommand(SubCommand::with_name(&quot;football&quot;))
        .get_matches();
    println!(&quot;{:?}&quot;, cli.subcommand().0);
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-06-05 02:19</div>
            <div class="timeline-body"><p>Sorry for the wait, I've been away with my day job for a few weeks.</p>
<p>Interesting. At first glance I instantly wonder why you'd have a subcommand match the substring of another <em>and</em> use the infersubcommands...however after thinking about it for a second I find it valid <code>foo</code> isn't ambiguous if it exactly matches a subcommand.</p>
<p>This is a simple fix and I'd be happy to mentor someone to get the commit. What's happening is when <code>InferSubcommands</code> is used, it checks how many subcommands match the substring <code>foo</code> in this case, and if it returns only 1 it consider it a match. However, in this case it returns 3, and therefore considers it ambiguous.</p>
<p>Someone would probably just have to massage <a href="https://github.com/kbknapp/clap-rs/blob/f74646de8c94d98db3e50f19846f050f6fee9c76/src/app/parser.rs#L680-L699">these lines</a> to fix this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: subcommands</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">M: mentored</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @kbknapp on 2018-06-05 02:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1298.html">clap-rs/clap#1298</a> on 2018-06-13 10:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2018-06-18 00:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:47:08 UTC
    </footer>
</body>
</html>
