<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Set up a single job for completion testing - clap-rs/clap #5540</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Set up a single job for completion testing</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/5540">#5540</a>
        opened by <a href="https://github.com/shannmu">@shannmu</a>
        on 2024-06-19 17:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/shannmu">@shannmu</a> on 2024-06-19 17:14</div>
            <div class="timeline-body"><p>I found a issue when running the clap_complete tests locally (on the clap master branch) using the command:</p>
<pre><code class="language-shell=">cargo test --features=&quot;unstable-dynamic&quot;
</code></pre>
<p>The result was:</p>
<pre><code class="language-shell=">---- expected: tests/testsuite/fish.rs:186:20
++++ actual:   In-memory
   1      - % exhaustive
        1 + % exhaustive
   2    2 | action                                                             last              -V         (Print version)
   3    3 | alias                                                              pacman            --generate      (generate)
   4    4 | complete            (Register shell completions for this program)  quote             --global      (everywhere)
   5    5 | help  (Print this message or the help of the given subcommand(s))  value             --help        (Print help)
   6    6 | hint                                                               -h  (Print help)  --version  (Print version)âˆ…

Update with SNAPSHOTS=overwrite

note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace


failures:
    fish::complete_dynamic

test result: FAILED. 72 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 2.87s

</code></pre>
<p>There is a difference of a space between them. However, this test case error was not reported in the CI. The issue is may due to this line https://github.com/clap-rs/clap/blob/70e84174a72f766020f5f65f354e16f1e1a49bed/clap_complete/tests/testsuite/fish.rs#L146. So I think that we should make sure the job's environment includes bash, fish, elvish, and zsh shells to cover all test cases in CI.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5551.html">clap-rs/clap#5551</a> on 2024-06-29 10:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5567.html">clap-rs/clap#5567</a> on 2024-07-05 20:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2024-07-05 20:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:09 UTC
    </footer>
</body>
</html>
