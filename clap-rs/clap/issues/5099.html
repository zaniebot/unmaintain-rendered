<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Provide CLI arguments in config file - clap-rs/clap #5099</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Provide CLI arguments in config file</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/5099">#5099</a>
        opened by <a href="https://github.com/SamuelMarks">@SamuelMarks</a>
        on 2023-08-29 00:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/SamuelMarks">@SamuelMarks</a> on 2023-08-29 00:15</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.4.0</p>
<h3>Describe your use case</h3>
<p>Writing version and daemon managers. So you begin by <code>download</code>ing, <code>install</code>ing, and <code>start</code>ing a package. Then you <code>stop</code>, <code>install-service</code> (daemon).</p>
<p>Either by including all the arguments with you every step of the way, or using a config file.</p>
<h3>Describe the solution you'd like</h3>
<p>My use case:</p>
<ul>
<li>Store JSON of <code>version</code> â†’ all provided CLI arguments (uses ENV if not provided otherwise the default value)</li>
</ul>
<p>To give a concrete of what the JSON would look like:</p>
<pre><code class="language-json">{
  &quot;15.3.1&quot;: {
    &quot;Port&quot;: 5430,
    &quot;Database&quot;: &quot;my_15_3_db&quot;,
    &quot;Username&quot;: &quot;thespp&quot;,
    &quot;Password&quot;: &quot;cxvsd&quot;,
  },
  &quot;15.4.0&quot;: {
    &quot;Port&quot;: 5432,
    &quot;Database&quot;: &quot;my_15_4_db&quot;,
    &quot;Username&quot;: &quot;cvxvx&quot;,
    &quot;Password&quot;: &quot;45j45lF&quot;,
  }
}
</code></pre>
<h3>Alternatives, if applicable</h3>
<p>Working prototype (in Go, but planning a Rust rewrite): https://github.com/offscale/postgres-version-manager-go</p>
<p>I suppose I could use
https://github.com/aobatact/clap-serde</p>
<p>Or straight up <code>serde</code> on the <code>struct</code> in question and use it that way. But there seems to be a lot of intricacies to consider, like how do I know when:</p>
<ul>
<li>A default value has been overriden by an env var or by a CLI arg or given in a config file</li>
</ul>
<p>Also how do I deserialise it with a version per JSON key. It was pretty hacky to get working in Go.</p>
<h3>Additional Context</h3>
<p>Related: #3113</p>
<p>That way you can either provide this JSON file in a <code>--config</code> or it will use the default location (assuming you don't have <code>--no-config-write</code> set).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @SamuelMarks on 2023-08-29 00:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-08-29 00:39</div>
            <div class="timeline-body"><p>Closing in favor of #2763</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2023-08-29 00:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:09 UTC
    </footer>
</body>
</html>
