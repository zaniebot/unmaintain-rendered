```yaml
number: 787
title: "Add AppSettings to disable automatic \"help\" subcommand"
type: issue
state: closed
author: Xion
labels:
  - C-bug
assignees: []
created_at: 2016-12-27T20:34:30Z
updated_at: 2016-12-31T06:15:13Z
url: https://github.com/clap-rs/clap/issues/787
synced_at: 2026-01-10T01:57:41Z
```

# Add AppSettings to disable automatic "help" subcommand

---

_Issue opened by @Xion on 2016-12-27 20:34_

When using `SubCommand`s, clap will automatically include a "help" subcommand:
```
SUBCOMMANDS:
    help     Prints this message or the help of the given subcommand(s)
```

This is redundant, as subcommand help can also be obtained via `$SUBCOMMAND --help`. 

Right now, it seems there is no way to hide that superfluous subcommand, as this doesn't work:
```rust
app.subcommand(SubCommand::with_name("help").setting(AppSettings::Hidden))
```

Consequently, the "help" subcommand may have to be [handled explicitly](https://github.com/Xion/gisht/blob/69e8aad4a1743beb57184dc38150ef02b306a0a1/src/args.rs#L45).

Suggestion: introduce `AppSettings::NoHelpSubcommand` which, if set on the root `App`, hides the "help" subcommand from usage output.

---

_Comment by @kbknapp on 2016-12-27 21:14_

Interesting, the fact that

```rust
app.subcommand(SubCommand::with_name("help").setting(AppSettings::Hidden))
```

Isn't hiding the subcommand looks like a bug. I'll dig into this further, because that's the intended behavior, and I would prefer that to an `AppSettings::NoHelpSubcommand`.

Also, small note, the `help` subcommand does a little more than the `--help` flag. It allows pulling the help from arbitrary other subcommands as well.

For instance, the following invocations are equivalent:

```
$ prog help push
$ prog push --help

$ prog help subcmd othercmd
$ prog subcmd othercmd --help

$ prog help
$ prog --help
```

---

_Label `C: subcommands` added by @kbknapp on 2016-12-27 21:15_

---

_Label `D: easy` added by @kbknapp on 2016-12-27 21:15_

---

_Label `P2: need to have` added by @kbknapp on 2016-12-27 21:15_

---

_Label `T: bug` added by @kbknapp on 2016-12-27 21:15_

---

_Label `W: 2.x` added by @kbknapp on 2016-12-27 21:15_

---

_Added to milestone `2.20.0` by @kbknapp on 2016-12-27 21:15_

---

_Comment by @Xion on 2016-12-28 00:10_

For the record, I'm also using `UnifiedHelpMessage`. Not sure if it affects this.

What's also curious is that "help" subcommand is actually gone from the output of `App::write_help`, but it's there in the `Err` from `App::get_matches_safe` (so probably also in the stdout output of regular `App::get_matches`) called against empty argv, or argv with just `help`.

---

_Comment by @kbknapp on 2016-12-28 01:59_

`UnifiedHelpMessage` shouldn't affect it at all. The part about being missing from `write_help` I'm assuming `--help` and `--version` are missing too. This is because unless a parsing method was calld (`get_matches_*`) those arguments and subcommands aren't built yet, since they're built lazily to allow users to override them (which is why this is a bug :wink:)

---

_Assigned to @kbknapp by @kbknapp on 2016-12-31 02:10_

---

_Label `T: new setting` added by @kbknapp on 2016-12-31 02:10_

---

_Comment by @kbknapp on 2016-12-31 03:13_

I have this fixed in a local branch and will upload shortly. You can now either do as you were, `Subcommand::with_name("help").setting(AppSettings::Hidden))` or use the new setting `app.setting(AppSettings::DisableHelpSubcommand)`. The benefit of using the new setting is it actually disables the subcommand entirely, not just hides it. Also you can make it a global setting, and it will disable the help subcommand of all child subcommands as well.

---

_Closed by @homu on 2016-12-31 06:15_

---
