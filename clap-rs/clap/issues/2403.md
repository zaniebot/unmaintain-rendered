```yaml
number: 2403
title: "regression: \"ArgSettings::TakesValue is required when ArgSettings::MultipleValues is set\""
type: issue
state: closed
author: ensc
labels:
  - C-bug
assignees: []
created_at: 2021-03-10T11:15:19Z
updated_at: 2021-03-10T11:40:19Z
url: https://github.com/clap-rs/clap/issues/2403
synced_at: 2026-01-10T01:57:44Z
```

# regression: "ArgSettings::TakesValue is required when ArgSettings::MultipleValues is set"

---

_Issue opened by @ensc on 2021-03-10 11:15_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Rust Version

rustc 1.52.0-nightly (e37a13cc3 2021-02-28)

### Clap Version

975ceed904290069b7cf65e177677ecea12e4dd6

### Minimal reproducible code

```rust
fn main() {
    let matches = clap::App::new("test")
	.arg(clap::Arg::new("debug")
	     .short('D')
	     .long("debug")
	     .multiple(true)
	     .takes_value(false))
	.get_matches();

    if matches.occurrences_of("debug") > 3 {
	println!("high debug level");
    }
}
```


### Steps to reproduce the bug with the above code

cargo run -- -DDDD

### Actual Behaviour

```
thread 'main' panicked at '
ArgSettings::TakesValue is required when ArgSettings::MultipleValues is set.
', /home/ensc/.cargo/git/checkouts/clap-78dbe9b58f9073fe/975ceed/src/build/arg/debug_asserts.rs:77:5
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

### Expected Behaviour

```
high debug level
```

(tested with rev 09009761ec5f6be4d406f70042d85fca543eeca8)

### Additional Context

Worked (at last) with 09009761ec5f6be4d406f70042d85fca543eeca8

### Debug Output

_No response_



---

_Label `T: bug` added by @ensc on 2021-03-10 11:15_

---

_Comment by @ldm0 on 2021-03-10 11:19_

`multiple` implies `multiple_values` and `multiple_occurrences`. and `MultipleValues` is only valid with `TakeValues` on. Please check this:
```rust
fn main() {
    let matches = clap::App::new("test")
	.arg(clap::Arg::new("debug")
	     .short('D')
	     .long("debug")
	     .multiple_occurrences(true)
	     .takes_value(false))
	.get_matches();

    if matches.occurrences_of("debug") > 3 {
	println!("high debug level");
    }
}
```

---

_Closed by @ldm0 on 2021-03-10 11:32_

---

_Locked by @clap-rs on 2021-03-10 11:40_

---
