<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delegate completions for a specific argument to the completions of an external program - clap-rs/clap #5424</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Delegate completions for a specific argument to the completions of an external program</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/clap-rs/clap/issues/5424">#5424</a>
        opened by <a href="https://github.com/alerque">@alerque</a>
        on 2024-03-25 14:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/alerque">@alerque</a> on 2024-03-25 14:07</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.5</p>
<h3>Describe your use case</h3>
<p>I have an app that has several subcommands, some of which are wrappers around other CLI tools. For example <code>casile</code> has several subcommands, but one of them is <code>casile make</code> that sets up a special environment and this passes all the remaining args to <code>make</code>. I have it setup something like this:</p>
<pre><code class="language-rust">#[derive(Subcommand)]
pub enum Commands {
    Make {
        target: Vec&lt;String&gt;,
    },
}
</code></pre>
<p>The <code>Vec&lt;String&gt;</code> seems to be the best way to collect further arguments and pass them through to the subprocess. Since passing other flags to <code>make</code> is valid here the arguments beyond this point may or may not be filenames, and even if they are they may or may not exist yet which makes filename completion (as I would get if I made this a <code>Vec&lt;PathBuf&gt;</code> or similar not very useful.</p>
<h3>Describe the solution you'd like</h3>
<p>I'd like to be able to specify something in the CLI that specifically called out the command for which to use completions for:</p>
<pre><code class="language-rust">#[derive(Subcommand)]
pub enum Commands {
    Make {
        #[clap_complete(delegate=&quot;make&quot;)]
        target: Vec&lt;String&gt;,
    },
}
</code></pre>
<p>I don't know what the exact ergonomics should be, but somehow I'd like the final generated completion scripts to delegate completions for arguments in this position to the completion script of a different external command.</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p>I'm not sure all supported shells have a way to handle this, but at least bash and zsh do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @alerque on 2024-03-25 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-completion</span> added by @epage on 2024-03-25 15:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-03-25 15:12</div>
            <div class="timeline-body"><p>This is blocked on #1232</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2024-03-25 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-blocked</span> added by @epage on 2024-03-25 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alerque">@alerque</a> on 2024-03-25 17:53</div>
            <div class="timeline-body"><p>I looked at that issue before opening this, but don't think it's related. Implementing this does not require dynamic completion support. Delegating to the completions of another command is not at all the same thing as using the output of a command as completions, and the plumbing needed to make shells do this is different (and simpler).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-03-25 18:20</div>
            <div class="timeline-body"><p>We plan to completely change our completion system, see #3166.</p>
<p>Doing major re-work of our existing completions to fit this is a bit of a dead end and could put us in a design bind for when we get to the end state of #3166.</p>
<p>#3166 is also responsible for us tracking being able to add more dynamic completion state to arguments, like your proposed <code>delegate</code> attribute.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5449.html">clap-rs/clap#5449</a> on 2024-04-09 03:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:35 UTC
    </footer>
</body>
</html>
