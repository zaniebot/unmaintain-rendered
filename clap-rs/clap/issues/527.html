<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Normal method for embedding git commit in the version? - clap-rs/clap #527</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Normal method for embedding git commit in the version?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/527">#527</a>
        opened by <a href="https://github.com/lilith">@lilith</a>
        on 2016-06-11 10:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/lilith">@lilith</a></div>
            <div class="timeline-body"><p>I want to be able to track down what version of the software a user is using, based on git commit ID.</p>
<p>I see this showing up in most Rust command-line tools, but I haven't figured out how it's done.</p>
<p>Any suggestions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-06-12 19:36</div>
            <div class="timeline-body"><p>You can either manually add the commit hash and just add it your version with <code>App::version</code> as in:</p>
<pre><code class="language-rust">const LATEST_COMMIT: &amp;'static str = &quot;abcd1234&quot;;
fn main() {
    App::new(&quot;prog&quot;).version(&amp;*format!(&quot;v1.2.3 ({})&quot;, LATEST_COMMIT));
}
</code></pre>
<p>But what I think most people do is add a <a href="http://doc.crates.io/build-script.html"><code>build.rs</code></a> script to pull the latest commit hash automatically.</p>
<p>Although this isn't really anything specific to <code>clap</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2016-06-12 19:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lilith">@lilith</a> on 2016-06-12 19:51</div>
            <div class="timeline-body"><p>Thanks! I found this approach based on your suggestion:</p>
<ol>
<li>Write it out to a text file during build: https://github.com/rust-lang-nursery/rustup.rs/blob/master/build.rs</li>
<li>Read the text file in at runtime: https://github.com/rust-lang-nursery/rustup.rs/blob/27f64753d016acbf93b833fc3618ce09f14ab9a3/src/rustup-cli/common.rs#L339</li>
</ol>
<p>I'm distributing a single binary, so maybe I'll write code to write code. You can change .rs files in build.rs, right? Or do you know of a project that's already doing this?</p>
<p>Definitely not specific to clap, but I'd like to add an example when I figure it out, since it seems like a ubiquitous need.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jhelwig">@jhelwig</a> on 2016-06-12 20:53</div>
            <div class="timeline-body"><p>https://github.com/cstorey/git-build-version/ is an example of how to do this without requiring files be available at runtime.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2016-06-23 19:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zmlgirl">@zmlgirl</a> on 2023-04-27 06:46</div>
            <div class="timeline-body"><p>for now it's a good idea to use creat <a href="https://github.com/baoyachi/shadow-rs">shadow-rs</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/acro5piano">@acro5piano</a> on 2024-07-18 06:18</div>
            <div class="timeline-body"><p>Great example for integrating clap struct with shadow-rs.</p>
<p>https://github.com/baoyachi/shadow-rs/issues/86#issuecomment-1073030931</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:46:35 UTC
    </footer>
</body>
</html>
