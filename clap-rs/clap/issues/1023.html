<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Override setting for groups - clap-rs/clap #1023</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Override setting for groups</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/1023">#1023</a>
        opened by <a href="https://github.com/Phlosioneer">@Phlosioneer</a>
        on 2017-08-09 03:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Phlosioneer">@Phlosioneer</a> on 2017-08-09 03:26</div>
            <div class="timeline-body"><p>There are many instances of command line utilities that have groups of flags, all able to override each other.</p>
<p>For example, as mentioned in <a href="https://github.com/uutils/coreutils/issues/1006">this issue</a>, the <code>od</code> utility has 10 flags that all override each other: <code>abcdfilosx</code>. The last appearing flag is the one that is used. Likewise, the <code>ls</code> utility has similar &quot;groups&quot; of overriding flags: <a href="https://man.openbsd.org/ls.1">ls manual</a></p>
<pre><code>It is not an error to specify more than one of the following mutually exclusive options:
-1, -C, -g, -l, -m, -n, and -x; and -c, -f, -S, -t, and -u. Where more than one option is specified
from the same mutually exclusive group, the last option given overrides the others, except
that -l always overrides -g; and -f always overrides -c, -S, -t, and -u.
</code></pre>
<p>If this feature existed, one could input it into clap like this:</p>
<pre><code>// Note, my syntax might not be perfect.
let foo = App::new(&quot;ls&quot;)
  .args(&amp;[&quot;1&quot;, &quot;C&quot;, &quot;g&quot;, &quot;l&quot;, &quot;m&quot;, &quot;n&quot;, &quot;x&quot;])
  .group(ArgGroup::with_name(&quot;formatting&quot;)
    .override_with_self(true);  // New feature.
  );
</code></pre>
<p>This is technically already do-able; just set every individual argument to overload every other argument. However, that's inefficient, unreasonably difficult to input, and grows faster than exponentially.</p>
<p>The proposed feature would be one new function: <code>ArgGroup::override_with_self(value: bool) -&gt; Self</code>.</p>
<p>Implementation for just flags would imply <code>Arg::multiple(true)</code> for its args and then simply force <code>ArgMatches::value_of</code> to return the <em>last</em> parsed value. It may be more complicated to account for arguments with values (<code>--foo bar</code>)? I'm not familiar with the internal workings of clap-rs, so I don't know how difficult it would be to add this feature.</p>
<p>This feature would be <em>very</em> useful when re-writing old command-line apps, as this kind of group-override pattern shows up a lot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-10-04 03:18</div>
            <div class="timeline-body"><p>I like this idea! It would also help with a similar issue I had when converting <code>exa</code> to use clap. I can't say I'll implement this tomorrow, as my plate is super full, but I <em>do</em> want this feature think it'd making specifying these large groups of overrides <em>much</em> easier.</p>
<p>Thanks for the details and the suggestion! :+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: arg groups</span> added by @kbknapp on 2017-10-04 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: flags</span> added by @kbknapp on 2017-10-04 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: intermediate</span> added by @kbknapp on 2017-10-04 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P3: want to have</span> added by @kbknapp on 2017-10-04 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by @kbknapp on 2017-10-04 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2017-10-04 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Phlosioneer">@Phlosioneer</a> on 2017-10-04 05:46</div>
            <div class="timeline-body"><p>Note: another option is to simply have a method like ArgMatches::values_of_group that just lists the command matches, in order, within the group, and their values. Then the application can worry about overrides; this would help in particular with nasty corner cases like the above &quot;except that -l always overrides -g&quot; etc.</p>
<p>this option exposes more API to worry about... but, there's very little state to keep track of, so parsing logic might be made easier. Still not familiar with the internals of clap, though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-10-04 14:33</div>
            <div class="timeline-body"><p>Values can already be checked by group, but since it's a relatively unused feature (or rather undocumented feature) I can't speak to any edge case bugs that exist.</p>
<p><code>matches.value_of(&quot;group&quot;)</code> should work for testing purposes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Phlosioneer">@Phlosioneer</a> on 2017-10-05 14:13</div>
            <div class="timeline-body"><p>good to know, thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by @kbknapp on 2018-07-22 02:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> removed by @kbknapp on 2018-07-22 02:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.1" by @pksunkara on 2020-04-09 07:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> removed by @pksunkara on 2021-08-13 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/77.html">epage/clapng#77</a> on 2021-12-06 16:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: arg groups</span> removed by @epage on 2021-12-08 19:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: flags</span> removed by @epage on 2021-12-08 19:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-builder</span> added by @epage on 2021-12-08 19:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: validators</span> added by @epage on 2021-12-08 20:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: medium</span> removed by @epage on 2021-12-09 17:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P3: want to have</span> removed by @epage on 2021-12-09 17:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-medium</span> added by @epage on 2021-12-09 17:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "3.1" by @epage on 2021-12-09 17:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:36 UTC
    </footer>
</body>
</html>
