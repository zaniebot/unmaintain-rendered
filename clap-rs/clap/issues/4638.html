<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`note: the argument '--option' exists` is too gruff - clap-rs/clap #4638</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>note: the argument '--option' exists</code> is too gruff</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/4638">#4638</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2023-01-13 19:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/epage">@epage</a> on 2023-01-13 19:30</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Rust Version</h3>
<p>n/a</p>
<h3>Clap Version</h3>
<p>4.1.0</p>
<h3>Minimal reproducible code</h3>
<p>N/A</p>
<h3>Steps to reproduce the bug with the above code</h3>
<p><code>cmd --optio</code></p>
<h3>Actual Behaviour</h3>
<pre><code>error: unexpected argument '--optio'

  note: argument '--option' exists

Usage: clap-test --option &lt;opt&gt;... [positional] [positional2] [positional3]...

For more information, try '--help'.
</code></pre>
<p>The suggestion is too gruff</p>
<h3>Expected Behaviour</h3>
<p>Ideas for lightening things:</p>
<ul>
<li>Change <code>note</code> to <code>tip</code> or <code>help</code><ul>
<li>rustc uses <code>help</code></li>
<li>I prefer <code>tip</code> as <code>help</code>  is used as a word elsewhere in these messages</li>
</ul>
</li>
<li>Call out that it is a &quot;similar&quot; argument, value, subcommand, etc<ul>
<li>rustc does this</li>
</ul>
</li>
</ul>
<pre><code>error: unexpected argument '--optio'

  tip: a similar argument, '--option', exists

Usage: clap-test --option &lt;opt&gt;... [positional] [positional2] [positional3]...

For more information, try '--help'.
</code></pre>
<h3>Additional Context</h3>
<p>We changed from &quot;did you mean&quot; to &quot;note&quot; in #4385.</p>
<p>This is split out of a <a href="https://www.reddit.com/r/rust/comments/10axc9u/clap_v41_a_rust_cli_argument_parser/j47gcpx/">reddit thread</a></p>
<p>The problem is changing this is pervasive enough that it would be a minor incompatibility according to our new contributing guidelines.</p>
<h3>Debug Output</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by @epage on 2023-01-13 19:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by @epage on 2023-01-13 19:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "4.x" by @epage on 2023-01-13 19:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Mehrbod2002">@Mehrbod2002</a> on 2023-01-29 16:10</div>
            <div class="timeline-body"><p>@epage
Can I work on this ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-30 13:57</div>
            <div class="timeline-body"><p>@Mehrbod2002 the first step for this is going through the reddit thread, comparing the different options, and proposing a specific wording with justification for why that wording.</p>
<p>After that depends on where this falls on the line for our <a href="https://github.com/clap-rs/clap/blob/master/CONTRIBUTING.md#compatibility-expectations">compatibility expectations</a>.  If we decide this falls under &quot;minor&quot; then we need to wait longer before we can release 4.2.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-03-23 17:24</div>
            <div class="timeline-body"><p>As a reminder, the rustc error:</p>
<pre><code>error[E0425]: cannot find value `i` in this scope
   --&gt; src/builder/arg.rs:108:27
    |
108 |         Arg::default().id(i)
    |                           ^ help: a local variable with a similar name exists: `id`

For more information about this error, try `rustc --explain E0425`.
error: could not compile `clap` due to previous error
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-03-23 17:26</div>
            <div class="timeline-body"><p>reddit comments</p>
<blockquote>
<p>It comes across as possible passive aggressive to me. The other changes to the message are good, though.</p>
</blockquote>
<hr />
<blockquote>
<p>unless the output is colored to highlight the diff it might be helpful to have 'similar' in there. Users might think this means --option exists but is not valid in this context (not realizing there is a typo, reading too fast)
e.g. :
an argument with a similar name exists: <code>--option</code>
which is even closer to your rustc example</p>
</blockquote>
<blockquote>
<p>Not a fan. Too much filler before getting to the actual suggestion.</p>
<p>I don't even think rustc diagnostics are a suitable comparison (I know the blog brought it up), as it has to show significantly more types of different errors and across multiple contexts.</p>
</blockquote>
<blockquote>
<p>Less filler, which is good, but still has the suggestion at the end. &quot;Similar&quot; has a minor ambiguity about similar behaviour or meaning, rather than the name itself.</p>
<p>The more concise your goal, the more challenging English becomes (various famous quotes about this).</p>
<p>See what you think of my <a href="https://www.reddit.com/r/rust/comments/10axc9u/clap_v41_a_rust_cli_argument_parser/j48fmnz/">other comment</a> I posted after that one. I started off undecided, but had strongly convinced myself by the time I reached my conclusion. :)</p>
</blockquote>
<hr />
<blockquote>
<p>I think that replacing &quot;note&quot; with &quot;help&quot; would make it quite a bit friendlier.</p>
</blockquote>
<blockquote>
<p>All three are fine, though I prefer tip: &gt;&gt; note: &gt; help:.</p>
<ul>
<li>note: has a slight implication that it is part of the reason / explanation, like an addendum, rather than a suggestion / action / next step.</li>
<li>help:, to me, has a burned-in ambiguity of &quot;here is some help for you&quot; vs &quot;help me!&quot;. :)</li>
<li>hint: wasn't mentioned, but implies that clap already knows that this suggestion is the correct action (like a gentler form try:). rustc can get away with these being a compiler with far more context, but clap cannot.</li>
</ul>
</blockquote>
<hr />
<blockquote>
<p>The exists part sounds a little odd, but also exists doesn't work either as the also can imply they both exist, rather than instead of. I've seen possible candidate used sometimes, but that's long and formal. The argument part is not needed, as the error has already said it is an argument, but then it would look really short.</p>
<p>How about:</p>
<p><code>tip: '--option' has a similar name</code></p>
<p>Bonus Points: Re-wording / re-ordering the error so that the bad argument name is at the front means that it also aligns with the argument name in the tip makes typos much easier to see due to that alignment. Example:</p>
</blockquote>
<pre><code>error: '--optiom' argument unexpected or not valid here

  tip: '--option' has a similar name  

Usage: clap-test --option &lt;opt&gt;... [positional]...</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-03-23 17:32</div>
            <div class="timeline-body"><p>Errors from other ecosystems</p>
<pre><code class="language-console">$ grep --gfdgfg
grep: unrecognized option '--gfdgfg'
Usage: grep [OPTION]... PATTERNS [FILE]...
Try 'grep --help' for more information.
</code></pre>
<pre><code class="language-console">$ python3 --jkhjk
unknown option --jkhjk
usage: python3 [option] ... [-c cmd | -m mod | file | -] [arg] ...
Try `python -h' for more information.
</code></pre>
<pre><code class="language-console">$ podman --jkhhjk
Error: unknown flag: --jkhhjk
</code></pre>
<pre><code class="language-console"> git --lkjjkhk
unknown option: --lkjjkhk
usage: git [--version] [--help] [-C &lt;path&gt;] [-c &lt;name&gt;=&lt;value&gt;]
           [--exec-path[=&lt;path&gt;]] [--html-path] [--man-path] [--info-path]
           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]
           [--git-dir=&lt;path&gt;] [--work-tree=&lt;path&gt;] [--namespace=&lt;name&gt;]
           [--super-prefix=&lt;path&gt;] [--config-env=&lt;name&gt;=&lt;envvar&gt;]
           &lt;command&gt; [&lt;args&gt;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-03-23 17:42</div>
            <div class="timeline-body"><p>Quick thoughts</p>
<ul>
<li>Do we use ~~&quot;unrecognized&quot;~~, ~~&quot;unknown&quot;~~, &quot;unexpected&quot;?<ul>
<li>Unexpected works best with this also being used with positionals</li>
</ul>
</li>
<li>Do we use &quot;tip&quot;, ~~&quot;note&quot;, &quot;help&quot;, &quot;hint&quot;~~<ul>
<li>~~help~~ while used by rustc, within argument parsing &quot;help&quot; draws attention for other meanings (<code>--help</code>)</li>
<li>~~<code>hint</code>~~ sounds too opinionated (we know the answer), that we are stringing them along</li>
<li>I prefer <code>note:</code> but there seems to be enough interest in this changing that my next preference is towards <code>tip</code></li>
</ul>
</li>
<li>How much we favor a nicer message or easier comparison of the unexpected / suggested</li>
<li>~~&quot;argument&quot;, &quot;flag&quot;, or &quot;option&quot;?~~ the error exisits for any type of argument<ul>
<li>In older versions of clap, &quot;flag&quot; strictly meant it didn't take a value (a FLAGS section in help) and &quot;option&quot; strictly meant it did</li>
<li>Flag and option are briefer and adds an extra bit of context</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4797.html">clap-rs/clap#4797</a> on 2023-03-28 02:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4798.html">clap-rs/clap#4798</a> on 2023-03-28 03:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../rust-lang/cargo/pulls/11905.html">rust-lang/cargo#11905</a> on 2023-04-12 13:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-07-17 14:12</div>
            <div class="timeline-body"><p>As this has been addressed for a while and there hasn't been any further concerns raised, I'm going to consider this resolved</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2023-07-17 14:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:48 UTC
    </footer>
</body>
</html>
