<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Value terminator is not included anywhere in help message - clap-rs/clap #4812</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Value terminator is not included anywhere in help message</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/4812">#4812</a>
        opened by <a href="https://github.com/epbuennig">@epbuennig</a>
        on 2023-03-30 16:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/epbuennig">@epbuennig</a> on 2023-03-30 16:22</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>v4.2.0</p>
<h3>Describe your use case</h3>
<p>The following rust program:</p>
<pre><code class="language-rust">use clap::{Command, Arg};

Command::new(&quot;cmd&quot;)
    .arg(Arg::new(&quot;multiple_options&quot;).num_args(0..).value_terminator(&quot;:&quot;))
    .arg(Arg::new(&quot;last&quot;).required(false))
    .get_matches_from([&quot;cmd&quot;, &quot;-h&quot;]);
</code></pre>
<p>currently produces this output:</p>
<pre><code>Usage: cmd [multiple_options]... [last]

Arguments:
  [multiple_options]...  
  [last]                 

Options:
  -h, --help  Print help
</code></pre>
<p>For a user, it is not clear that the options before <code>last</code> must be delimited with <code>:</code> so the last argument is not assumed to be part of <code>multiple_options</code>.</p>
<p>Ideally, it should be included in both the usage itself and the Argument list in some way, mentioning it in the help message for each argument which may use this style would become tedious.</p>
<h3>Describe the solution you'd like</h3>
<p>I would expect the program to output something similar to this:</p>
<pre><code>Usage: cmd [&lt;multiple_options&gt;... :] [last]

Arguments:
  [&lt;multiple_options&gt;... :]  
  [last]                 

Options:
  -h, --help  Print help
</code></pre>
<p>without any additional changes by default.</p>
<h3>Alternatives, if applicable</h3>
<p>An alternative to this is specifying the usage directly, but this falls flat as soon as <code>a</code> is turned into an option, as it's representation in the option list cannot be changed.</p>
<p>It could also be explained in the help message of the argument itself, but I feel like the automatically generated usage strings should include this.</p>
<h3>Additional Context</h3>
<p>The following program already produces includes the <code>--</code> token for arguments specified as <code>required(false)</code> and <code>last(true)</code> (although only in the usage), which is why I believe my feature request falls inline with the current design philosophy of clap.</p>
<pre><code class="language-rust">use clap::{Command, Arg};

fn main() {
    Command::new(&quot;cmd&quot;)
        .arg(Arg::new(&quot;multiple_options&quot;).num_args(1..))
        .arg(Arg::new(&quot;last&quot;).required(false).last(true))
        .get_matches_from([&quot;cmd&quot;, &quot;-h&quot;]);
}
</code></pre>
<pre><code>Usage: cmd [multiple_options]... [-- &lt;last&gt;]

Arguments:
  [multiple_options]...  
  [last]                 

Options:
  -h, --help  Print help
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epbuennig on 2023-03-30 16:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by @epage on 2023-03-30 18:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2023-03-30 18:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-03-30 18:15</div>
            <div class="timeline-body"><p>I think your idea for having it in the argument list and in the usage like that works.  My only concern is how much this increases the binary size as this is a less commonly used feature and users can provide custom usages.  I'm open to at least an experimental implementation being made for us to evaluate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epbuennig">@epbuennig</a> on 2023-03-30 21:35</div>
            <div class="timeline-body"><p>My main concern is that, if this is on one or multiple options instead of positional arguments, then trying to do it with a custom usage won't work quite so well. We can't currently overwrite the usage that is displayed in the Argument/Options list.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/toddATavail">@toddATavail</a> on 2023-04-06 00:47</div>
            <div class="timeline-body"><p>I like this proposal, @epbuennig; I've used the underlying feature of Clap before, and it would definitely be nice if the help generator would show you the stop delimiter without the developer having to write a custom usage message. I'm generally for anything that quickly improves documentation quality and usability, and this feels like an easy win. I'm busy tonight, but I have some dedicated time tomorrow to work on this. I'll see what it does to binary size (seems like it should be a small positive delta?), and then we can see if your team likes it, @epage.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4829.html">clap-rs/clap#4829</a> on 2023-04-07 03:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/toddATavail">@toddATavail</a> on 2023-04-07 04:40</div>
            <div class="timeline-body"><p>Okay, my PR is in. Ended up thrashing against the CI for a bit, so sorry if that generated any annoying transient noise. Looks like CI is happy now, and all tests (including the 3 that I added to test this small feature) are passing. I only checked the binary delta on my M2, and it was negligible. I've used Clap for years, and this was a fun way to give something (admittedly small) back on a quiet evening. Thanks for the great tool!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5392.html">clap-rs/clap#5392</a> on 2024-03-11 14:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5817.html">clap-rs/clap#5817</a> on 2024-11-14 15:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Aethelflaed">@Aethelflaed</a> on 2024-11-14 16:22</div>
            <div class="timeline-body"><p>I'm keen on working on that, what's the desired solution in the end?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5995.html">clap-rs/clap#5995</a> on 2025-05-09 14:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:35:22 UTC
    </footer>
</body>
</html>
