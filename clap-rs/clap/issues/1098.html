<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ignore HYPHEN-MINUS (dash) in arg_enum!() - clap-rs/clap #1098</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ignore HYPHEN-MINUS (dash) in arg_enum!()</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1098">#1098</a>
        opened by <a href="https://github.com/behnam">@behnam</a>
        on 2017-11-07 22:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/behnam">@behnam</a> on 2017-11-07 22:03</div>
            <div class="timeline-body"><p>Ref: <a href="https://docs.rs/clap/2.27.1/clap/macro.arg_enum.html">https://docs.rs/clap/2.27.1/clap/macro.arg_enum.html</a></p>
<p>Would be great to support ignoring ASCII dash character (HYPHEN-MINUS) in the <code>FromStr</code> implementations inside the <code>arg_enum!()</code> macro.</p>
<p>The HYPHEN-MINUS character cannot be part of an enum variant name because of the limits of the language, and therefore, this won't be a breaking change to the current behavior, but only expanding acceptable values for values using an arg_enum-defined type.</p>
<p>Optionally, we would also do so for UNDERSCORE (U+005F LOW LINE), since it's recommended to not use them for Enum variant names. BUT, there are cases where it exists.</p>
<h2>Alternate approach</h2>
<p>Except alternate strings to match per-variant, so <code>&quot;some-bar&quot;</code> can be defined as an alternate string form for <code>SomeBar</code> variant explicitly.</p>
<p>This approach gives users all the control, but makes it too verbose for simple, common use-cases.</p>
<h2>Another alternate approach</h2>
<p>Having both solutions above, as they don't overlap: staying agile and flexible.</p>
<hr />
<h3>Rust Version</h3>
<p>rustc 1.23.0-nightly (e340996ff 2017-11-02)</p>
<h3>Affected Version of clap</h3>
<p>2.27.1</p>
<h3>Expected Behavior Summary</h3>
<p>Running command with <code>--foo some-bar</code> should match <code>Foo::SomeBar</code>.</p>
<h3>Actual Behavior Summary</h3>
<p>Only <code>--foo somebar</code> matches <code>Foo::SomeBar</code> and <code>--foo some-bar</code> results in an error.</p>
<h3>Steps to Reproduce the issue</h3>
<p>Add the above example to a clap app file.</p>
<h3>Sample Code or Link to Sample Code</h3>
<pre><code class="language-rust">arg_enum!{
    #[derive(Debug)]
    pub enum Foo {
        SomeBar,
        AnotherBaz
    }
}
</code></pre>
<h3>Debug output</h3>
<p>N/A</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-11-09 01:50</div>
            <div class="timeline-body"><p>I would be hesitant to simply ignore <code>-</code> when matching as this could lead to typos, plus would cause us to match <code>Foo::SomeBar</code> to <code>s-omebar</code>, <code>so-mebar</code>, <code>som-ebar</code>, etc.</p>
<p>I would consider <code>Foo::Some_Bar</code> allowing <code>foo_bar</code> or <code>foo-bar</code> and this would be acceptable. Thoughts?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2017-11-09 01:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/behnam">@behnam</a> on 2017-11-09 19:52</div>
            <div class="timeline-body"><p>Well, I see your point, @kbknapp.</p>
<p>I also like to point out that case-insensitive matching already has a similar issue, where value <code>AbcDef</code> is equal to <code>AbCedf</code>.</p>
<p>Ideally, instead of case-insensitive matching, we would use a case-aware matching, converting the input into CamelCase and perform exact match on the variant names.</p>
<p><code>to_camel_case()</code> is provided by <a href="https://crates.io/crates/case">https://crates.io/crates/case</a> and similar crates.</p>
<p>I'm not sure how much people rely on the current behavior and how far we can go with breaking compatibility. If we don't want to break anything, maybe we can do both in parallel: case-insensitive AND case-aware matching.</p>
<p>This would address your concern, while not expecting people to use underscores in variant names. And is backwards-compatible.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1103.html">clap-rs/clap#1103</a> on 2017-11-12 19:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1037.html">clap-rs/clap#1037</a> on 2017-11-12 19:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-11-12 19:50</div>
            <div class="timeline-body"><p>I'm going to move this over to the <code>clap-derives</code>]() repo as I intend on this being solved in 3.x via CustomDerive which will replace this macro call.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-11-12 19:51</div>
            <div class="timeline-body"><p>This issue was moved to kbknapp/clap-derives#3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2017-11-12 19:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1662.html">clap-rs/clap#1662</a> on 2020-02-03 09:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:07 UTC
    </footer>
</body>
</html>
