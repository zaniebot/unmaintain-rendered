<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optional option uses angle brackets in OPTIONS list - clap-rs/clap #586</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Optional option uses angle brackets in OPTIONS list</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/586">#586</a>
        opened by <a href="https://github.com/joshtriplett">@joshtriplett</a>
        on 2016-07-18 22:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2016-07-18 22:25</div>
            <div class="timeline-body"><p>If I write the following:</p>
<pre><code class="language-rust">.arg_from_usage(&quot;--in-reply-to [Message-Id] 'Make the first mail a reply to the specified Message-Id'&quot;)
</code></pre>
<p>the corresponding --help output looks like this:</p>
<pre><code>        --in-reply-to &lt;Message-Id&gt;    Make the first mail a reply to the specified Message-Id
</code></pre>
<p>Note the angle brackets, which normally indicate a required argument.</p>
<p>For an optional option, which is the normal case, I'd suggest leaving out both square brackets and angle brackets; the usage string indicates what options you have to supply.  The --help output should look like this:</p>
<pre><code>        --in-reply-to Message-Id    Make the first mail a reply to the specified Message-Id
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-08-20 21:59</div>
            <div class="timeline-body"><p>@joshtriplett Do you mean if the <code>Message-Id</code> itself is optional, or the entire <code>--in-reply-to</code> is optional?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2016-08-20 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: args</span> added by @kbknapp on 2016-08-20 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by @kbknapp on 2016-08-20 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2016-08-20 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2016-08-20 22:02</div>
            <div class="timeline-body"><p>The entire --in-reply-to=some-message-id is optional.  (Wrapping the square brackets around the whole thing, <code>[--in-reply-to Message-Id]</code>, seems to produce a different issue; in that case, clap seems to treat it as a positional argument with a strange name.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-08-20 23:12</div>
            <div class="timeline-body"><p>Ah ok, I understand now. I have mixed feelings on this, particularly because I <em>do</em> like not having the option to not place any brackets in the <em>declaration</em> (i.e. <code>arg_from_usage</code>), but in the help text I'm mixed because the <code>&lt;message-id&gt;</code> is <em>required</em> for <code>--in-reply-to</code>, even though <code>--in-reply-to</code> isn't required as a whole.</p>
<p>Perhaps in a usage string it'd be possible to place the whole thing in square brackets, and leave off the brackets for the value?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2016-08-20 23:24</div>
            <div class="timeline-body"><p>If the option appears in the usage string displayed at the top of the help, the square brackets should go around the entire thing, yes: <code>[--in-reply-to Message-Id]</code>.  Down in the list of options, however, that seems excessive, since almost all <code>--options</code> (as opposed to positional parameters) default to optional.  Mandatory <code>--options</code> seem like the uncommon case that needs more explicit marking.</p>
<p>In <code>args_from_usage</code>, I've tried specifying <code>&quot;[--in-reply-to Message-Id] '...help...'&quot;</code> , and that produced unexpected results as mentioned above (clap thought that defined a positional argument with a strange name).</p>
<p>Ideally, all of the following should have some consistent syntax in both <code>args_from_usage</code> and in the generated help, documented in the clap documentation:</p>
<ul>
<li>A required <code>--option</code> with no value.</li>
<li>A required <code>--option=value</code> with required value.</li>
<li>A required <code>--option=value</code> with optional value.</li>
<li>An optional <code>--option</code> with no value.</li>
<li>An optional <code>--option</code> with required value (if you specify the option, you must specify its value).</li>
<li>An optional <code>--option</code> with optional value.</li>
</ul>
<p>So far, I've had to infer some of the syntax for <code>args_from_usage</code>, possibly incorrectly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-10-25 17:59</div>
            <div class="timeline-body"><p>Not exactly what you're asking for in this issue, but what are you feelings when displaying a help message with an option that takes 0 or more values?</p>
<p>Currently in clap it gets displayed like this:</p>
<pre><code>OPTIONS:
    -o, --option &lt;value&gt;    help message
</code></pre>
<p>But I'm wanting to move to something like:</p>
<pre><code>OPTIONS:
    -o, --option [&lt;value&gt;]    help message
</code></pre>
<p>I can't necessarily remove the angled brackets without some larger refactoring, but adding square brackets would be a very quick change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2016-10-30 01:42</div>
            <div class="timeline-body"><p>Adding the square brackets seems like an improvement, even though the additional angle brackets make it still a bit confusing.</p>
<p>If it's &quot;zero or more&quot; rather than &quot;zero or one&quot;, then it should have a <code>...</code> inside the square brackets, as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2018-07-22 00:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:18 UTC
    </footer>
</body>
</html>
