<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to express &quot;either ... or ...&quot; relationship - clap-rs/clap #3121</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>How to express &quot;either ... or ...&quot; relationship</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/3121">#3121</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2021-12-09 16:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:14</div>
            <div class="timeline-body"><p><a href="https://github.com/vbrandl"><img src="https://avatars.githubusercontent.com/u/20639051?v=4" align="left" width="96" height="96" hspace="10"></img></a> <strong>Issue by <a href="https://github.com/vbrandl">vbrandl</a></strong>
<em>Monday Oct 08, 2018 at 14:58 GMT</em>
<em>Originally opened as https://github.com/TeXitoi/structopt/issues/141</em></p>
<hr />
<p>I want to express the following relationship using structopt: The positional parameter should either be two strings (username and password) or a PathBuf (from where the credentials will be read).</p>
<p>I tried the following:</p>
<pre><code class="language-rust">#[derive(Debug, StructOpt)]
enum Opt {
    #[structopt(name = &quot;login&quot;)]
    Login { param: LoginCredentials },
    #[structopt(name = &quot;logout&quot;)]
    Logout,
}
#[derive(Debug, StructOpt)]
enum LoginCredentials {
    UserPass { loginid: String, password: String },
    File { path: PathBuf },
}
</code></pre>
<p>But this will create another subcommand for the <code>login</code> subcommand. What would be the right way to express this relationship? Is there even a way to do so?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:14</div>
            <div class="timeline-body"><p><a href="https://github.com/TeXitoi"><img src="https://avatars.githubusercontent.com/u/5787066?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/TeXitoi">TeXitoi</a></strong>
<em>Thursday Oct 11, 2018 at 14:38 GMT</em></p>
<hr />
<p>You might want to look at https://github.com/TeXitoi/structopt/blob/master/examples/group.rs and https://github.com/TeXitoi/structopt/issues/126</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:14</div>
            <div class="timeline-body"><p><a href="https://github.com/vbrandl"><img src="https://avatars.githubusercontent.com/u/20639051?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/vbrandl">vbrandl</a></strong>
<em>Thursday Oct 11, 2018 at 14:59 GMT</em></p>
<hr />
<p>I found that one already but I think it would be cool if we were able to describe groups using enums. That way it is impossible to represent an illegal state and you could simply match over the group variants.</p>
<p>Is it possible to implement this for structopt?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:14</div>
            <div class="timeline-body"><p><a href="https://github.com/TeXitoi"><img src="https://avatars.githubusercontent.com/u/5787066?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/TeXitoi">TeXitoi</a></strong>
<em>Thursday Oct 11, 2018 at 15:14 GMT</em></p>
<hr />
<p>That's a new feature, that's why I've tagged this issue enhancement. Then, we can design the details here, and anyone can implement that and do a PR to add it.</p>
<p>I will not implement this feature in short term, as I have others priorities, in this repo and in others. But I encourage anyone interested to contribute, and I'll try to answer any questions as fast as possible.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:15</div>
            <div class="timeline-body"><p><a href="https://github.com/vbrandl"><img src="https://avatars.githubusercontent.com/u/20639051?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/vbrandl">vbrandl</a></strong>
<em>Thursday Oct 11, 2018 at 21:42 GMT</em></p>
<hr />
<p>Just a few thoughts:</p>
<ul>
<li>How this might be implemented</li>
</ul>
<pre><code class="language-rust">#[derive(Debug, StructOpt)]
#[structopt(type = &quot;subcommand&quot;)] // this should be implicit
enum Opt {
    #[structopt(name = &quot;login&quot;)]
    Login { param: LoginCredentials },
    #[structopt(name = &quot;logout&quot;)]
    Logout,
}
#[derive(Debug, StructOpt)]
#[structopt(type = &quot;group&quot;)]
enum LoginCredentials {
    UserPass { loginid: String, password: String },
    File { path: PathBuf },
}
</code></pre>
<ul>
<li>Problem: Enums with variants that contain the same types and should be parsed as positional parameters cannot be distinguished and these cases should be compile errors</li>
</ul>
<pre><code class="language-rust">#[derive(Debug, StructOpt)]
#[structopt(type = &quot;group&quot;)]
enum Group1 {
    Var1 { a: String, b: String },
    Var2 { c: String, d: String }, // this should fail
}

#[derive(Debug, StructOpt)]
#[structopt(type = &quot;group&quot;)]
enum Group2 {
    Var1 { 
        #[structopt(short = &quot;a&quot;)]
        a: String,
        b: String
    },
    Var2 { c: String, d: String },
} // this should work since the variants are distingushable
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:15</div>
            <div class="timeline-body"><p><a href="https://github.com/TeXitoi"><img src="https://avatars.githubusercontent.com/u/5787066?v=4" align="left" width="48" height="48" hspace="10"></img></a> <strong>Comment by <a href="https://github.com/TeXitoi">TeXitoi</a></strong>
<em>Friday Oct 12, 2018 at 10:08 GMT</em></p>
<hr />
<p>This is similar to #104</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:23</div>
            <div class="timeline-body"><p>I believe this is covered by #2621</p>
<p>If there is something I'm missing though, let me know!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2021-12-09 16:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-derive</span> added by @epage on 2021-12-09 16:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:46 UTC
    </footer>
</body>
</html>
