<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boolean argument accepts a value, even with takes_value = false - clap-rs/clap #2484</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Boolean argument accepts a value, even with takes_value = false</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/2484">#2484</a>
        opened by <a href="https://github.com/sjackman">@sjackman</a>
        on 2021-05-18 01:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sjackman">@sjackman</a> on 2021-05-18 01:27</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
<h3>Rust Version</h3>
<p>rustc 1.51.0 (2fd73fabe 2021-03-23)</p>
<h3>Clap Version</h3>
<p>3.0.0-beta.2</p>
<h3>Minimal reproducible code</h3>
<pre><code class="language-rust">use clap::Clap;

#[derive(clap::Clap)]
struct Opts {
    /// Verbose logging
    #[clap(long, takes_value = false)]
    verbose: bool,
}

fn main() {
    println!(&quot;Value for verbose: {}&quot;, Opts::parse().verbose);
}
</code></pre>
<h3>Steps to reproduce the bug with the above code</h3>
<pre><code class="language-bash">cargo run -- --verbose=foobar
</code></pre>
<h3>Actual Behaviour</h3>
<pre><code class="language-console">$ cargo run
Value for verbose: false
$ cargo run -- --verbose
Value for verbose: true
$ cargo run -- --verbose=
Value for verbose: true
$ cargo run -- --verbose=foobar
Value for verbose: true
</code></pre>
<h3>Expected Behaviour</h3>
<pre><code class="language-console">$ cargo run
Value for verbose: false
$ cargo run -- --verbose
Value for verbose: true
$ cargo run -- --verbose=
Error: option '--verbose' doesn't accept an argument
$ cargo run -- --verbose=foobar
Error: option '--verbose' doesn't accept an argument
</code></pre>
<h3>Additional Context</h3>
<p><em>No response</em></p>
<h3>Debug Output</h3>
<pre><code>$ cargo run -- --verbose=foobar
[            clap::build::app] 	App::_do_parse
[            clap::build::app] 	App::_build
[            clap::build::app] 	App::_propagate:hello
[            clap::build::app] 	App::_derive_display_order:hello
[            clap::build::app] 	App::_create_help_and_version
[            clap::build::app] 	App::_create_help_and_version: Building --help
[            clap::build::app] 	App::_create_help_and_version: Building --version
[clap::build::app::debug_asserts] 	App::_debug_asserts
[            clap::build::arg] 	Arg::_debug_asserts:verbose
[            clap::build::arg] 	Arg::_debug_asserts:help
[            clap::build::arg] 	Arg::_debug_asserts:version
[         clap::parse::parser] 	Parser::get_matches_with
[         clap::parse::parser] 	Parser::_build
[         clap::parse::parser] 	Parser::_verify_positionals
[         clap::parse::parser] 	Parser::get_matches_with: Begin parsing '&quot;--verbose=foobar&quot;' ([45, 45, 118, 101, 114, 98, 111, 115, 101, 61, 102, 111, 111, 98, 97, 114])
[         clap::parse::parser] 	Parser::is_new_arg: &quot;--verbose=foobar&quot;:NotFound
[         clap::parse::parser] 	Parser::is_new_arg: arg_allows_tac=false
[         clap::parse::parser] 	Parser::is_new_arg: -- found
[         clap::parse::parser] 	Parser::is_new_arg: starts_new_arg=true
[         clap::parse::parser] 	Parser::possible_subcommand: arg=&quot;--verbose=foobar&quot;
[         clap::parse::parser] 	Parser::get_matches_with: possible_sc=false, sc=None
[         clap::parse::parser] 	Parser::parse_long_arg
[         clap::parse::parser] 	Parser::parse_long_arg: Does it contain '='...
[         clap::parse::parser] 	Yes '&quot;=foobar&quot;'
[         clap::parse::parser] 	Parser::parse_long_arg: Found valid opt or flag '--verbose'
[         clap::parse::parser] 	Parser::check_for_help_and_version_str
[         clap::parse::parser] 	Parser::check_for_help_and_version_str: Checking if --&quot;verbose&quot; is help or version...
[         clap::parse::parser] 	Neither
[         clap::parse::parser] 	Parser::parse_flag
[    clap::parse::arg_matcher] 	ArgMatcher::inc_occurrence_of: arg=verbose
[    clap::parse::arg_matcher] 	ArgMatcher::inc_occurrence_of: first instance
[            clap::build::app] 	App::groups_for_arg: id=verbose
[         clap::parse::parser] 	Parser::get_matches_with: After parse_long_arg Flag(verbose)
[         clap::parse::parser] 	Parser::maybe_inc_pos_counter: arg = verbose
[         clap::parse::parser] 	Parser::maybe_inc_pos_counter: is it positional?
[         clap::parse::parser] 	No
[            clap::build::app] 	App::groups_for_arg: id=verbose
[         clap::parse::parser] 	Parser::remove_overrides
[         clap::parse::parser] 	Parser::remove_overrides:iter:verbose
[      clap::parse::validator] 	Validator::validate
[         clap::parse::parser] 	Parser::add_defaults
[      clap::parse::validator] 	Validator::validate_conflicts
[      clap::parse::validator] 	Validator::validate_exclusive
[      clap::parse::validator] 	Validator::validate_exclusive:iter:verbose
[      clap::parse::validator] 	Validator::gather_conflicts
[      clap::parse::validator] 	Validator::gather_conflicts:iter: id=verbose
[            clap::build::app] 	App::groups_for_arg: id=verbose
[      clap::parse::validator] 	Validator::validate_required: required=ChildGraph([])
[      clap::parse::validator] 	Validator::gather_requirements
[      clap::parse::validator] 	Validator::gather_requirements:iter:verbose
[      clap::parse::validator] 	Validator::validate_required_unless
[      clap::parse::validator] 	Validator::validate_matched_args
[      clap::parse::validator] 	Validator::validate_matched_args:iter:verbose: vals=[]
[      clap::parse::validator] 	Validator::validate_arg_num_vals
[      clap::parse::validator] 	Validator::validate_arg_values: arg=&quot;verbose&quot;
[      clap::parse::validator] 	Validator::validate_arg_requires:&quot;verbose&quot;
[      clap::parse::validator] 	Validator::validate_arg_num_occurs: &quot;verbose&quot;=1
[    clap::parse::arg_matcher] 	ArgMatcher::get_global_values: global_arg_vec=[]
Value for verbose: true
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @sjackman on 2021-05-18 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sjackman">@sjackman</a> on 2021-05-18 01:33</div>
            <div class="timeline-body"><p>Looks like this issue may be a duplicate of https://github.com/clap-rs/clap/issues/1543.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-05-18 09:24</div>
            <div class="timeline-body"><p>Yup.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">R: duplicate</span> added by @pksunkara on 2021-05-18 09:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-05-18 09:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:28 UTC
    </footer>
</body>
</html>
