<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for comma separated values - clap-rs/clap #348</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for comma separated values</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/348">#348</a>
        opened by <a href="https://github.com/kbknapp">@kbknapp</a>
        on 2015-11-17 19:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-11-17 19:29</div>
            <div class="timeline-body"><p>Example, these should all parse to exactly the same matches</p>
<pre><code>$ prog --opt val1 val2 val3 
$ prog --opt val1,val2,val3
$ prog --opt=val1,val2,val3
$ prog -oval1,val2,val3
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2015-11-17 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2015-11-17 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P3: want to have</span> added by @kbknapp on 2015-11-17 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @kbknapp on 2015-11-17 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 1.x</span> added by @kbknapp on 2015-11-17 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">M: mentored</span> added by @kbknapp on 2015-11-17 19:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/psyomn">@psyomn</a> on 2015-11-23 01:41</div>
            <div class="timeline-body"><p>I'm going to start looking at this. I'll ping you back if I have questions!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-11-23 04:30</div>
            <div class="timeline-body"><p>:+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-11-23 05:21</div>
            <div class="timeline-body"><p>You should be able to look at the <code>App:::add_value_to_arg</code> in <code>src/app/mod.rs</code> to start</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/psyomn">@psyomn</a> on 2015-11-30 07:05</div>
            <div class="timeline-body"><p>Hey! Sorry for the late reply, it's been a little busy for me lately. I had the chance to work on this a little this weekend. I have a few questions!</p>
<p>Would introducing something like this be on the right path (notice <code>take_list</code>) ?</p>
<pre><code class="language-rust">let matches = App::new(&quot;MyApp&quot;)
        .arg(Arg::with_name(&quot;input&quot;)
                        .help(&quot;the input file to use&quot;)
                        .takes_value(true)
                        .short(&quot;i&quot;)
                        .long(&quot;input&quot;)
                        .multiple(true)
                        .takes_list(true)
                        .required(true)
                        .conflicts_with(&quot;output&quot;))
        .get_matches();
</code></pre>
<p>So let's say this implementation works. When we're asking for <code>value_of</code> of <code>input</code> for this example, we're expecting a <code>&amp;str</code> right? I was thinking of returning a vector, but that doesn't seem that it would be going in the right direction. So in fact, we'd expect to get a string instead of a list, and leave the user to deal with said input.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-11-30 07:31</div>
            <div class="timeline-body"><p>No problem! :+1:</p>
<p>Assuming the user runs <code>MyApp -i val1,vla2,val3</code> calling <code>value_of(&quot;input&quot;)</code> would return <code>val1</code> which isn't super useful, but that's how it works with other multiple values so this is fine. calling <code>values_of(&quot;intput&quot;)</code> you'll get a <code>Vec&lt;&amp;str&gt;</code> which contains <code>[&quot;val1&quot;, &quot;val2&quot;, &quot;val3&quot;]</code>. This is actually something that needs to be changed (and I'll put the issue in for it in just a minute), it should return a <code>&amp;[&amp;str]</code>.</p>
<p>For this issue, you shouldn't have to worry about anything in <code>arg_matches.rs</code>, it should only require changes <code>src/app/mod.rs:add_val_to_arg</code> and maybe <code>src/args/arg_matcher.rs</code> where you split the value by <code>,</code>.</p>
<p>But you bring up a very interesting idea, that I like. Changing your <code>takes_list(true)</code> to <code>allow_value_delims(bool)</code> (and defaults to <code>true</code>). This would assume most people would be OK with <code>-i val1,val2,val3</code> parsing to 3 values, but also give them the option to parse <code>-i val1,val2,val3</code> as a single value if their application requires such. (i.e. most users would never have to use <code>.allow_value_delims(true)</code> because that's the default, they only need to use <code>.allow_value_delims(false)</code> if they want to turn that feature OFF)</p>
<p>Another setting that would go along very nicely with this is making the delimiter selectable but defaulting to <code>,</code> (comma). This would require something like <code>value_delim(char)</code> and allow things like <code>-i val1;val2;val3</code> if <code>.value_delim(';')</code> was used.</p>
<p>For the above two features though I will create two issues, instead of trying to solve all three in this one issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/352.html">clap-rs/clap#352</a> on 2015-11-30 07:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/353.html">clap-rs/clap#353</a> on 2015-11-30 07:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "1.6.0" by @kbknapp on 2015-12-18 08:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-12-18 08:58</div>
            <div class="timeline-body"><p>@psyomn How's it going?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/psyomn">@psyomn</a> on 2015-12-18 09:50</div>
            <div class="timeline-body"><p>Hey, sorry for disappearing! I haven't had a chance to work on clap these
last weeks because I'm occupied with marking, trying to publish a paper
with a teacher, and on a job hunt as well! I will have time during holidays
if that's cool. If I'm holding people back, then I'll snatch another issue
when I'm not as pressed for time.</p>
<p>Thank you for the extensive writeup by the way. I wanted to express my
thanks, but didn't want to add too much noise to the issue tracker.</p>
<p>Hope everything is well on your end!</p>
<p>On Fri, Dec 18, 2015 at 3:58 AM, Kevin K. notifications@github.com wrote:</p>
<blockquote>
<p>@psyomn https://github.com/psyomn How's it going?</p>
<p>â€”
Reply to this email directly or view it on GitHub
https://github.com/kbknapp/clap-rs/issues/348#issuecomment-165717559.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-12-18 10:30</div>
            <div class="timeline-body"><p>No worries :) Just wanted to check up. We may go ahead and implement this, but if its still open when your time frees up feel free to keep at it and put in a PR or ask if you have questions :wink:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v2.0" by @kbknapp on 2016-01-23 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "1.6.0" by @kbknapp on 2016-01-23 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-01-26 12:08</div>
            <div class="timeline-body"><p>Closed with #387</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2016-01-26 12:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:06 UTC
    </footer>
</body>
</html>
