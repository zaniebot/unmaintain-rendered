```yaml
number: 384
title: Unnamed argument incorrectly matched as incorrect subcommand if prefix
type: issue
state: closed
author: b333z
labels:
  - A-parsing
assignees: []
created_at: 2016-01-25T06:53:30Z
updated_at: 2018-08-02T03:29:47Z
url: https://github.com/clap-rs/clap/issues/384
synced_at: 2026-01-10T01:57:40Z
```

# Unnamed argument incorrectly matched as incorrect subcommand if prefix

---

_Issue opened by @b333z on 2016-01-25 06:53_

Running first example from readme.md, supplying an <INPUT> argument, that is prefixed with the text of a subcommand is being matched as an incorrect sub command:

Given this configuration:

``` rust
let matches = App::new("myapp")
          .version("1.0")
          .author("Kevin K. <kbknapp@gmail.com>")
          .about("Does awesome things")
          .args_from_usage(
              "-c --config=[CONFIG] 'Sets a custom config file'
              <INPUT> 'Sets the input file to use'
              [debug]... -d 'Sets the level of debugging information'")
          .subcommand(SubCommand::with_name("test")
                      .about("controls testing features")
                      .version("1.3")
                      .author("Someone E. <someone_else@other.com>")
                      .arg_from_usage("-v --verbose 'Print test information verbosely'"))
          .get_matches(); 
```

Passing "test.txt" for <INPUT> will be matched as a incorrect subcommand ( I think because a subcommand is a prefix ) 

``` bash
$ cargo run -- "test.txt"
   Compiling test1 v0.1.0 (file:///data/projects/rust/test1)
main.rs:6:12: 6:15 warning: unused import, #[warn(unused_imports)] on by default
main.rs:6 use clap::{Arg, App, SubCommand};
                     ^~~
     Running `/data/projects/rust/test1/target/debug/test1 test.txt`
error: The subcommand 'test.txt' isn't valid
        Did you mean 'test' ?

If you received this message in error, try re-running with 'test1 -- test.txt'

USAGE:
        test1 [FLAGS] [OPTIONS] <INPUT> [SUBCOMMAND]

For more information try --help
Process didn't exit successfully: `/data/projects/rust/test1/target/debug/test1 test.txt` (exit code: 1)
```

Passing "best.txt" works as expected so I'm thinking that is because it does not have a prefix of a subcommand:

``` bash
$ cargo run -- "best.txt"
     Running `/data/projects/rust/test1/target/debug/test1 best.txt`
Using input file: best.txt
Value for config: default.conf
Debug mode is off
```

Present on clap v1.5.5, rust {1.5.0, git}


---

_Comment by @kbknapp on 2016-01-25 09:48_

Thanks for taking the time to file this! :+1: I'll update back here with any issues.


---

_Label `T: bug` added by @kbknapp on 2016-01-25 09:49_

---

_Label `P2: need to have` added by @kbknapp on 2016-01-25 09:49_

---

_Label `C: subcommands` added by @kbknapp on 2016-01-25 09:49_

---

_Label `D: easy` added by @kbknapp on 2016-01-25 09:49_

---

_Label `C: parsing` added by @kbknapp on 2016-01-25 09:49_

---

_Label `W: 2.x` added by @kbknapp on 2016-01-25 09:49_

---

_Label `W: 1.x` added by @kbknapp on 2016-01-25 09:49_

---

_Added to milestone `1.5.6` by @kbknapp on 2016-01-25 09:49_

---

_Comment by @kbknapp on 2016-01-25 10:06_

After some further investigation, think this is because of how it's being run (i.e. with `cargo run`)

Compiling the same program under 1.5.5 and running the program itself yields the expected results:

```
$ fake test.txt
error: The subcommand 'test.txt' isn't valid
    Did you mean 'test' ?

If you received this message in error, try re-running with 'fake -- test.txt'

USAGE:
    fake [FLAGS] [ARGS] [SUBCOMMAND]

For more information try --help

$ fake -- test.txt   
file: text.txt
```


---

_Label `T: RFC / question` added by @kbknapp on 2016-01-25 10:08_

---

_Label `P2: need to have` removed by @kbknapp on 2016-01-25 10:08_

---

_Label `T: bug` removed by @kbknapp on 2016-01-25 10:08_

---

_Label `W: 1.x` removed by @kbknapp on 2016-01-25 10:08_

---

_Label `W: 2.x` removed by @kbknapp on 2016-01-25 10:08_

---

_Label `D: easy` removed by @kbknapp on 2016-01-25 10:09_

---

_Removed from milestone `1.5.6` by @kbknapp on 2016-01-25 10:09_

---

_Comment by @kbknapp on 2016-01-25 10:09_

@b333z can you confirm? If so I can close this.


---

_Comment by @b333z on 2016-01-25 10:39_

Thanks for looking into this, yes same results here, close away, so cargo consumes the -- and so conflicts with clap-rs's use of --

Dumped out the args here:

``` rust
$ cargo run -- test.txt
     Running `target/debug/test1 test.txt`
arg0: target/debug/test1
arg1: test.txt
error: The subcommand 'test.txt' isn't valid
        Did you mean 'test' ?

If you received this message in error, try re-running with 'test1 -- test.txt'

USAGE:
        test1 [FLAGS] [OPTIONS] <INPUT> [SUBCOMMAND]

For more information try --help
Process didn't exit successfully: `target/debug/test1 test.txt` (exit code: 1)
$ target/debug/test1 -- test.txt
arg0: target/debug/test1
arg1: --
arg2: test.txt
Using input file: test.txt
Value for config: default.conf
Debug mode is off
```


---

_Comment by @kbknapp on 2016-01-25 11:02_

:+1: No worries!


---

_Closed by @kbknapp on 2016-01-25 11:02_

---

_Referenced in [clap-rs/clap#385](../../clap-rs/clap/issues/385.md) on 2016-01-25 15:08_

---
