<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clap doesn't allow a short last argument - clap-rs/clap #1011</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Clap doesn't allow a short last argument</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1011">#1011</a>
        opened by <a href="https://github.com/marmistrz">@marmistrz</a>
        on 2017-07-24 08:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/marmistrz">@marmistrz</a> on 2017-07-24 08:32</div>
            <div class="timeline-body"><h3>Rust Version</h3>
<p>1.19.0</p>
<h3>Affected Version of clap</h3>
<p>2.25.1</p>
<h3>Expected Behavior Summary</h3>
<p>I want to accept one of the following command lines:</p>
<pre><code>./my_app -l foo -l bar -- pacman -S rust
</code></pre>
<pre><code>./my_app -l foo -l bar pacman -S rust
</code></pre>
<p>There may be 0,1,2,... <code>-l</code> arguments.</p>
<p>So I did</p>
<pre><code>    let matches = App::new(APP)
        .version(VERSION)
        .author(AUTHOR)
        .about(&quot;about&quot;)
        .arg(
            Arg::with_name(&quot;library&quot;)
                .short(&quot;l&quot;)
                .required(false)
                .takes_value(true)
                .multiple(true)
                .last(true),
        )
        .get_matches();
</code></pre>
<h3>Actual Behavior Summary</h3>
<p>This panicks with</p>
<pre><code>thread 'main' panicked at 'Flags or Options may not have last(true) set. library has both a short and last(true) set.', /home/marcin/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.25.1/src/app/parser.rs:210
</code></pre>
<p>It's unclear to me why the library dislikes flags having a <code>last</code> option. I could not find another way of achieving the command line I want to parse.</p>
<p>When I found out how to do this, I'll contribute documentation. :)</p>
<h3>Sample Code or Link to Sample Code</h3>
<p>https://play.rust-lang.org/?gist=659376caba48dcc6eae0cb3f7fb3854e&amp;version=stable
(couldn't try compiling it, playground is currently out of memory)</p>
<h3>Debug output</h3>
<p>No new output appeared.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/marmistrz">@marmistrz</a> on 2017-07-24 10:40</div>
            <div class="timeline-body"><p>I got it. I'll contribute an example so that other can avoid that pitfall.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @marmistrz on 2017-07-24 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snowe2010">@snowe2010</a> on 2017-08-24 16:43</div>
            <div class="timeline-body"><p>I'm seeing this issue but with no <code>last(true)</code> setting</p>
<pre><code>   Compiling clap v2.26.0
   Compiling pt v0.2.2 (file:///Users/tylerthrailkill/Dropbox/rustup/cli)
    Finished dev [unoptimized + debuginfo] target(s) in 31.36 secs
     Running `target/debug/pt start -g -i -s -b`
error: Found argument '-b' which wasn't expected, or isn't valid in this context

USAGE:
    pt start --gateway &lt;BRANCH&gt; --iam-service &lt;BRANCH&gt; --server &lt;BRANCH&gt;

For more information try --help
</code></pre>
<pre><code>cargo run start -- -g -i -s --blah
    Finished dev [unoptimized + debuginfo] target(s) in 0.0 secs
     Running `target/debug/pt start -g -i -s --blah`
works here....âœ”
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:35 UTC
    </footer>
</body>
</html>
