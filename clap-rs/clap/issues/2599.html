<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`multiple_occurrences` behaviour does not match documentation - clap-rs/clap #2599</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`multiple_occurrences` behaviour does not match documentation</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/2599">#2599</a>
        opened by <a href="https://github.com/sstadick">@sstadick</a>
        on 2021-07-15 14:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sstadick">@sstadick</a> on 2021-07-15 14:43</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
<h3>Clap Version</h3>
<p>3.0.0-beta.2</p>
<h3>Where?</h3>
<p>https://docs.rs/clap/3.0.0-beta.2/clap/struct.Arg.html#method.multiple_occurrences</p>
<h3>What's wrong?</h3>
<p>The documentation claims that with the above method set to true, something like <code>-a 1 2</code> would be disallowed and only <code>-a 1 -a 2</code> would be allowed. However, the tests don't agree:</p>
<p>https://github.com/clap-rs/clap/blob/412b71efb64d9ac88667b6206c4110460c8d93e1/clap_derive/tests/options.rs#L225</p>
<p>And questions have been answered based on the docs: https://github.com/clap-rs/clap/discussions/2259#discussioncomment-220052</p>
<h3>How to fix?</h3>
<p>Make behavior match the docs, unless there is some other way of getting the behavior described in the discussions link above.</p>
<p>To clarify further, I'd expect the test case:</p>
<pre><code class="language-rust">    assert_eq!(
        Opt {
            arg: Some(vec![1, 2])
        },
        Opt::parse_from(&amp;[&quot;test&quot;, &quot;-a&quot;, &quot;1&quot;, &quot;2&quot;])
    );
</code></pre>
<p>to instead be</p>
<pre><code class="language-rust">    assert_eq!(
        Opt {
            arg: Some(vec![1])
        },
        Opt::parse_from(&amp;[&quot;test&quot;, &quot;-a&quot;, &quot;1&quot;, &quot;2&quot;])
    );
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: docs</span> added by @sstadick on 2021-07-15 14:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @pksunkara on 2021-07-16 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: docs</span> removed by @pksunkara on 2021-07-16 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.0" by @pksunkara on 2021-07-16 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-07-16 15:17</div>
            <div class="timeline-body"><p>It's not a doc issue, but looks like a bug with how <code>Vec</code> adapter in clap_derive interacts with <code>multiple*</code> methods. Possibly a duplicate of #1772</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ldm0">@ldm0</a> on 2021-07-20 18:05</div>
            <div class="timeline-body"><p>Nope, I don't think it's a bug. <code>Option&lt;Vec&lt;T&gt;&gt;</code> implies <code>multiple_values</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-07-21 20:40</div>
            <div class="timeline-body"><p>When <code>multiple</code> was removed, <code>Vec&lt;_&gt;</code> was switched to <code>multiple_values</code> but I think what people would expect is that <code>Vec&lt;_&gt;</code> would map to <code>multiple_occurrences</code>.</p>
<p>I plan to bring this up in my work on #1772</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1772.html">clap-rs/clap#1772</a> on 2021-07-22 15:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-07-25 14:11</div>
            <div class="timeline-body"><p>Yeah, we need to allow combination of <code>values</code>, <code>occurrences</code> and both.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: derive macros</span> added by @pksunkara on 2021-08-13 21:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2993.html">clap-rs/clap#2993</a> on 2021-11-05 14:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3024.html">clap-rs/clap#3024</a> on 2021-11-14 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/190.html">epage/clapng#190</a> on 2021-12-06 21:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-07 21:58</div>
            <div class="timeline-body"><p>Something like #2993 was recently merged, along with a new derive reference.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2021-12-07 21:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:08 UTC
    </footer>
</body>
</html>
