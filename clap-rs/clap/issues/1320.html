<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cargo test --release fails - clap-rs/clap #1320</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>cargo test --release fails</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1320">#1320</a>
        opened by <a href="https://github.com/matthiaskrgr">@matthiaskrgr</a>
        on 2018-07-18 13:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/matthiaskrgr">@matthiaskrgr</a> on 2018-07-18 13:42</div>
            <div class="timeline-body"><p>Found this while trying to gather info on another ticket.</p>
<p>repo is @ 570b4e1a77f033dd99de587b6883afb0bb104399</p>
<p><code>cargo test</code> passes, but in release mode
<code>cargo test --release</code> it does not:</p>
<pre><code>
failures:
failures:
    low_index_positional_last_multiple_too
    low_index_positional_not_required
    low_index_positional_too_far_back
test result: FAILED. 48 passed; 3 failed; 0 ignored; 0 measured; 0 filtered out
error: test failed, to rerun pass '--test multiple_values'
</code></pre>
<p>rustc 1.29.0-nightly (4f3c7a472 2018-07-17)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1321.html">clap-rs/clap#1321</a> on 2018-07-18 13:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-07-21 02:43</div>
            <div class="timeline-body"><p>Interesting, thanks for reporting! I'm curious how often this occurs that tests in crates pass on debug but not release...as I've never thought to test both cases. I'll play with this and see if I can get to the root of it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P2: need to have</span> added by @kbknapp on 2018-07-21 02:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: tests</span> added by @kbknapp on 2018-07-21 02:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-07-21 14:56</div>
            <div class="timeline-body"><p>Ah, ok I found the cause. It's because the tests that are failing on <code>--release</code> are marked with <code>#[should_panic]</code> and those panics only happen in debug builds (i.e. <code>debug_assertions</code>).</p>
<p>I'm going to close this as by-design. :smile:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2018-07-21 14:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
