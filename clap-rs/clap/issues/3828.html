<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Replace lazy_static with once_cell - clap-rs/clap #3828</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Replace lazy_static with once_cell</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/3828">#3828</a>
        opened by <a href="https://github.com/jplatte">@jplatte</a>
        on 2022-06-14 13:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jplatte">@jplatte</a> on 2022-06-14 13:57</div>
            <div class="timeline-body"><p>Many other projects have switched from <code>lazy_static</code> to <code>once_cell</code> because it offers a macro-free solution to the same problem (with the only caveat being missing <code>no_std</code> support which I'm pretty sure is irrelevant for clap). Would you be open to a PR that does the same thing here?</p>
<p>In the future, the <code>once_cell</code> dependency can likely be removed in favor of <a href="https://github.com/rust-lang/rust/issues/74465">the same functionality in <code>std</code></a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matklad">@matklad</a> on 2022-06-14 14:11</div>
            <div class="timeline-body"><blockquote>
<p>with the only caveat being missing no_std support</p>
</blockquote>
<p>FWIW, the subset of the API which <em>can</em> be reasonably implented in no-std is available:</p>
<p>https://docs.rs/once_cell/latest/once_cell/race/index.html</p>
<p>The &quot;I can't notify OS that I am blocked, so I am just going to spin&quot; part is indeed not available, but I'd argue that is a feature :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3829.html">clap-rs/clap#3829</a> on 2022-06-14 14:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-06-14 14:13</div>
            <div class="timeline-body"><p>Huh, I thought there was a reason why I had kept it but not seeing a reason to.  #3829 will switch us over.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jplatte">@jplatte</a> on 2022-06-14 14:26</div>
            <div class="timeline-body"><blockquote>
<p>The &quot;I can't notify OS that I am blocked, so I am just going to spin&quot; part is indeed not available, but I'd argue that is a feature :-)</p>
</blockquote>
<p>Hmm, I think that's what tracing wants.. (https://github.com/tokio-rs/tracing/issues/1165#issuecomment-752718278) ðŸ˜•</p>
<p>I guess that also means https://github.com/matklad/once_cell/issues/61 should be closed? In any case that issue is probably the place to continue this conversation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2022-06-14 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../xiph/rav1e/pulls/2962.html">xiph/rav1e#2962</a> on 2022-07-04 17:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../BurntSushi/bstr/issues/124.html">BurntSushi/bstr#124</a> on 2022-09-02 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mindvalley/wukong-cli/pulls/50.html">mindvalley/wukong-cli#50</a> on 2023-01-04 05:07</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:35:02 UTC
    </footer>
</body>
</html>
