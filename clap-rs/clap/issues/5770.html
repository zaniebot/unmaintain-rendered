<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom help for subcommands - clap-rs/clap #5770</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Custom help for subcommands</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/clap-rs/clap/issues/5770">#5770</a>
        opened by <a href="https://github.com/htngr">@htngr</a>
        on 2024-10-08 12:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/htngr">@htngr</a> on 2024-10-08 12:05</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.5.19</p>
<h3>Describe your use case</h3>
<p>I'm currently trying to implement <a href="https://github.com/Canop/clap-help/issues/1">https://github.com/Canop/clap-help/issues/1</a> (showing a custom help message for subcommands). Without subcommands I can catch if <code>--help</code> was requested (<code>Parser::try_parse</code> and <code>ErrorKind::DisplayHelp</code>). But with subcommands, I couldn't find a way (without manually reparsing the arguments) to check if help for a subcommand was issued.</p>
<p>Did I miss something?</p>
<h3>Describe the solution you'd like</h3>
<p>A solution might be to attach the current <code>clap::Command</code> to the <code>clap_builder::error::Error</code>.</p>
<p>Manually adding help flags is tedious and doesn't work if there are required arguments:</p>
<pre><code class="language-rust">#[derive(Parser, Debug)]
#[command(
    name = &quot;subcommand&quot;,
    author,
    version,
    about,
    disable_help_subcommand = true,
    disable_help_flag = true
)]
struct Args {
    /// Print help
    #[arg(long)]
    help: bool,

    /// A subcommand
    #[command(subcommand)]
    pub command: Option&lt;Subcmd&gt;,
}

#[derive(Subcommand, Clone, Debug)]
enum Subcmd {
    /// Some info for A
    #[clap(disable_help_flag = true)]
    A {
        /// Print help
        #[arg(long)]
        help: bool,
    },
    
    /// Some info for B
    #[clap(disable_help_flag = true)]
    B {
        /// Print help
        #[arg(long)]
        help: bool,

        /// An arg
        x: u8,
    },
}
</code></pre>
<p>For example, this does not work:</p>
<pre><code class="language-bash">&gt; cargo run -- -- b --help
error: the following required arguments were not provided:
  &lt;X&gt;

Usage: subcommands b --help &lt;X&gt;
</code></pre>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @htngr on 2024-10-08 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5815.html">clap-rs/clap#5815</a> on 2024-11-13 22:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:09 UTC
    </footer>
</body>
</html>
