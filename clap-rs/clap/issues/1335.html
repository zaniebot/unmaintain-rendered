<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support excluding a subcommand from shell completion - clap-rs/clap #1335</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support excluding a subcommand from shell completion</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1335">#1335</a>
        opened by <a href="https://github.com/kpcyrd">@kpcyrd</a>
        on 2018-08-27 21:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kpcyrd">@kpcyrd</a> on 2018-08-27 21:39</div>
            <div class="timeline-body"><h3>Feature Request Summary</h3>
<p>I would like to exclude some subcommands from the generated shell completion. For example, the command to generate those completions is usually only used during installation and shouldn't be suggested to the user. I've managed to hide the subcommand from the help text with <code>AppSettings::Hidden</code>, but it's still included in the shell completion.</p>
<h3>Expected Behavior Summary</h3>
<p><code>foo &lt;tab&gt;&lt;tab&gt;</code></p>
<p>All commands that are marked with <code>AppSettings::Hidden</code> are not suggested</p>
<h3>Actual Behavior Summary</h3>
<p><code>foo &lt;tab&gt;&lt;tab&gt;</code></p>
<p>All commands are suggested.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: completion gen</span> added by @CreepySkeleton on 2020-02-02 07:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: subcommands</span> added by @CreepySkeleton on 2020-02-02 07:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @CreepySkeleton on 2020-02-02 07:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by @CreepySkeleton on 2020-02-02 07:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.1" by @CreepySkeleton on 2020-02-02 07:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> removed by @pksunkara on 2021-08-13 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/100.html">epage/clapng#100</a> on 2021-12-06 17:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../gleam-lang/gleam/pulls/1374.html">gleam-lang/gleam#1374</a> on 2021-12-07 06:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: subcommands</span> removed by @epage on 2021-12-08 20:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-08 20:14</div>
            <div class="timeline-body"><p>Related:</p>
<ul>
<li>https://github.com/clap-rs/clap/issues/2541</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "3.1" by @epage on 2021-12-08 20:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2021-12-09 18:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by @epage on 2021-12-09 18:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2541.html">clap-rs/clap#2541</a> on 2021-12-10 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-12-10 16:30</div>
            <div class="timeline-body"><p>Ideally, we would want this to be configured while creating the generator, but there's a lot more generation related work we would want to look at first to see if the current code is viable for future or not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-07-19 14:17</div>
            <div class="timeline-body"><p>See also #3951 for native completion support</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4265.html">clap-rs/clap#4265</a> on 2022-09-26 22:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4853.html">clap-rs/clap#4853</a> on 2023-04-21 14:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../JuliaLang/juliaup/issues/789.html">JuliaLang/juliaup#789</a> on 2024-01-15 10:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fingolfin">@fingolfin</a> on 2024-01-15 12:37</div>
            <div class="timeline-body"><p>This issue has labels marking it as &quot;easy&quot; and &quot;help wanted&quot;. But at the same time it sounds like there are open fundamental questions about whether you want it: e.g. from issue #2541 @pksunkara said Jun 17, 2021:</p>
<blockquote>
<p>Need the version you are looking at because this is fixed in master.</p>
</blockquote>
<p>and then in Dec 10, 2021:</p>
<blockquote>
<p>I think we went back on the decision regarding this and are currently generating hidden subcommands too.</p>
</blockquote>
<p>And earlier on this issue, also on Dec 10, 2021</p>
<blockquote>
<p>Ideally, we would want this to be configured while creating the generator, but there's a lot more generation related work we would want to look at first to see if the current code is viable for future or not.</p>
</blockquote>
<p>So... which is it, is this &quot;easy&quot; and &quot;help wanted&quot;, or is there in contrast actually need for design work and experiments and what not? In other words, if someone made a PR for this, would it actually have a chance of being merged?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-help-wanted</span> removed by @epage on 2024-01-15 22:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> removed by @epage on 2024-01-15 22:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2024-01-15 22:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> removed by @epage on 2024-01-15 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-help-wanted</span> added by @epage on 2024-01-15 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2024-01-15 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-01-15 22:16</div>
            <div class="timeline-body"><p>Its been a couple years and I unfortunately didn't take enough notes here.  I think it'd be reasonable to emulate what we can from the proposal in #3951 would be reasonable.  That basically means (1) don't suggest hidden items but (2) complete within them where we can.  The part we likely can't emulate is &quot;complete the hidden item if its the only choice left&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kpcyrd">@kpcyrd</a> on 2024-01-16 18:34</div>
            <div class="timeline-body"><p>For my specific use case it would be fine to have it fully excluded, without the need for (2). (however I wouldn't mind having (2)).</p>
<p>The subcommand is <code>foo generate-completions ...</code> and probably only ever used when generating a package. It's useful to have this subcommand available but the user would likely never want to invoke it themselves (if they really want to they could however).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-10 00:34</div>
            <div class="timeline-body"><p>This was resolved in #5549.  When using <code>clap_complete::dynamic</code>, we only show hidden subcommands if there is no other valid completion option.</p>
<p>To track stabilization, see #3166</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2024-08-10 00:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:51 UTC
    </footer>
</body>
</html>
