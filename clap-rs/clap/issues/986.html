<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thoughts on a different format for zsh completions? - clap-rs/clap #986</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Thoughts on a different format for zsh completions?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/986">#986</a>
        opened by <a href="https://github.com/nerdrew">@nerdrew</a>
        on 2017-06-10 05:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/nerdrew">@nerdrew</a></div>
            <div class="timeline-body"><p>I have a custom zsh completion file for rustup that I like. I have attached my custom one and the clap generated completions. Objections to using a different zsh completion format?</p>
<p>Other questions: for rustup it is nice to have completions that are context specific, i.e. when using <code>rustup run &lt;toolchain&gt; &lt;blah&gt;</code> it is nice to have toolchain completed to the actually installed toolchains <code>rustup toolchain list</code>, does clap support specifying that kind of metadata on arguments? Essentially, a dynamically generated list of valid arguments.</p>
<p><a href="https://github.com/kbknapp/clap-rs/files/1065614/clap-generated-rustup.txt">clap-generated-rustup.txt</a>
<a href="https://github.com/kbknapp/clap-rs/files/1065613/my-custom-rustup.txt">my-custom-rustup.txt</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-06-16 15:33</div>
            <div class="timeline-body"><p>I'm totally open to new and better formats for ZSH completions. In fact, I'm a ZSH completion expert by <strong>no means</strong> ðŸ˜„ My problem is finding time to not only implement them, but also the time to learn them first.</p>
<p>If you'd like to dive into the ZSH generation, I'd be more than willing to mentor you through clap's internal workings. All the ZSH related bits can be found in <a href="https://github.com/kbknapp/clap-rs/blob/master/src/completions/zsh.rs"><code>src/completions/zsh.rs</code></a></p>
<blockquote>
<p>does clap support specifying that kind of metadata on arguments? Essentially, a dynamically generated list of valid arguments.</p>
</blockquote>
<p>Yes, using <a href="https://docs.rs/clap/2.24.2/clap/struct.Arg.html#method.possible_values"><code>Arg::possible_values</code></a>. Since the valid arguments aren't actually built until runtime, it's absolutely possible to build a list of &quot;valid toolchains&quot; dynamically which are passed off to <code>possible_values</code>. The problem you'll run into is then passing those values to this ZSH completion script that does <em>not</em> get dynamically updated.</p>
<p>This is the topic of #568</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2017-06-16 15:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2018-07-22 02:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:46:56 UTC
    </footer>
</body>
</html>
