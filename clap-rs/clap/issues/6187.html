<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clap always prints short help (even with `--help`) if all help messages set with #[arg(help = &quot;...&quot;)] - clap-rs/clap #6187</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>clap always prints short help (even with <code>--help</code>) if all help messages set with #[arg(help = &quot;...&quot;)]</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/6187">#6187</a>
        opened by <a href="https://github.com/Sk7Str1p3">@Sk7Str1p3</a>
        on 2025-11-24 15:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Sk7Str1p3">@Sk7Str1p3</a></div>
            <div class="timeline-body">Please complete the following tasks
<ul>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
Rust Version
<p>rustc 1.93.0-nightly (25d319a0f 2025-11-11)</p>
Clap Version
<p>4.5.53</p>
Minimal reproducible code
<pre><code>#[derive(clap::Parser)]
struct Cli {
    #[arg(
        short,
        default_value = &quot;hello&quot;,
        help = &quot;\
        do some job

\
        the job is print hello world\
        &quot;
    )]
    arg: String
}

fn main() {
    use clap::Parser as _;
    Cli::parse();
}

</code></pre>
Steps to reproduce the bug with the above code
<p>cargo run</p>
Actual Behaviour
<p>output:</p>
<pre><code>Usage: testclap [OPTIONS]

Options:
  -a &lt;ARG&gt;    do some job
              
              the job is print hello world [default: hello]
  -h, --help  Print help
</code></pre>
Expected Behaviour
<pre><code>Usage: testclap [OPTIONS]

Options:
  -a &lt;ARG&gt;
          do some job
          
          the job is print hello world
          
          [default: hello]

  -h, --help
          Print help (see a summary with &#x27;-h&#x27;)
</code></pre>
Additional Context
<p>code with help set with doc comment</p>
<pre><code>#[derive(clap::Parser)]
struct Cli {
    /// do some job
    ///
    /// the job is print hello world
    #[arg(
        short,
        default_value = &quot;hello&quot;,
    )]
    arg: String
}

fn main() {
    use clap::Parser as _;
    Cli::parse();
}
</code></pre>
<p>why not just use doc comment? i have to use attribute for localized help messages - with <a href="https://crates.io/crates/i18n-embed-fl"><code>fl!</code></a> macro</p>
Debug Output
<p>output with help set with <code>#[arg(help = &quot;...&quot;)]</code>:</p>
<pre><code>[clap_builder::builder::command]Command::_do_parse
[clap_builder::builder::command]Command::_build: name=&quot;testclap&quot;
[clap_builder::builder::command]Command::_propagate:testclap
[clap_builder::builder::command]Command::_check_help_and_version:testclap expand_help_tree=false
[clap_builder::builder::command]Command::long_help_exists
[clap_builder::builder::command]Command::_check_help_and_version: Building default --help
[clap_builder::builder::command]Command::_propagate_global_args:testclap
[clap_builder::builder::debug_asserts]Command::_debug_asserts
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:arg
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:help
[clap_builder::builder::debug_asserts]Command::_verify_positionals
[clap_builder::parser::parser]Parser::get_matches_with
[clap_builder::parser::parser]Parser::parse
[clap_builder::parser::parser]Parser::get_matches_with: Begin parsing &#x27;&quot;--help&quot;&#x27;
[clap_builder::parser::parser]Parser::possible_subcommand: arg=Ok(&quot;--help&quot;)
[clap_builder::parser::parser]Parser::get_matches_with: sc=None
[clap_builder::parser::parser]Parser::parse_long_arg
[clap_builder::parser::parser]Parser::parse_long_arg: Does it contain &#x27;=&#x27;...
[clap_builder::parser::parser]Parser::parse_long_arg: Found valid arg or flag &#x27;--help&#x27;
[clap_builder::parser::parser]Parser::parse_long_arg(&quot;help&quot;): Presence validated
[clap_builder::parser::parser]Parser::react action=Help, identifier=Some(Long), source=CommandLine
[clap_builder::parser::parser]Help: use_long=true
[clap_builder::builder::command]Command::long_help_exists: false
[clap_builder::builder::command]Command::write_help_err: testclap, use_long=false
[clap_builder::builder::command]Command::long_help_exists: false
[  clap_builder::output::help]write_help
[clap_builder::output::help_template]HelpTemplate::new cmd=testclap, use_long=false
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=arg
[clap_builder::output::help_template]HelpTemplate::write_templated_help
[clap_builder::output::help_template]HelpTemplate::write_before_help
[ clap_builder::output::usage]Usage::create_usage_no_title
[ clap_builder::output::usage]Usage::create_usage_no_title
[ clap_builder::output::usage]Usage::write_help_usage
[ clap_builder::output::usage]Usage::write_arg_usage; incl_reqs=true
[ clap_builder::output::usage]Usage::needs_options_tag
[ clap_builder::output::usage]Usage::needs_options_tag:iter: f=arg
[clap_builder::builder::command]Command::groups_for_arg: id=&quot;arg&quot;
[ clap_builder::output::usage]Usage::needs_options_tag:iter:iter: grp_s=&quot;Cli&quot;
[ clap_builder::output::usage]Usage::needs_options_tag:iter: [OPTIONS] required
[ clap_builder::output::usage]Usage::write_args: incls=[]
[ clap_builder::output::usage]Usage::get_args: unrolled_reqs=[]
[ clap_builder::output::usage]Usage::write_subcommand_usage
[ clap_builder::output::usage]Usage::create_usage_no_title: usage=testclap [OPTIONS]
[clap_builder::output::help_template]HelpTemplate::write_all_args
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=arg
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]HelpTemplate::write_args Options
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=arg
[clap_builder::output::help_template]HelpTemplate::write_args: arg=&quot;arg&quot; longest=8
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]HelpTemplate::write_args: arg=&quot;help&quot; longest=10
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=arg
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=-a &lt;ARG&gt;
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found default value...[[&quot;hello&quot;]]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--help
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=-a &lt;ARG&gt;
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found default value...[[&quot;hello&quot;]]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::short
[clap_builder::output::help_template]HelpTemplate::long
[clap_builder::output::help_template]HelpTemplate::align_to_about: arg=arg, next_line_help=false, longest=10
[clap_builder::output::help_template]HelpTemplate::align_to_about: positional=false arg_len=12, spaces=4
[clap_builder::output::help_template]HelpTemplate::help
[clap_builder::output::help_template]HelpTemplate::help: help_width=14, spaces=11, avail=86
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--help
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::short
[clap_builder::output::help_template]HelpTemplate::long
[clap_builder::output::help_template]HelpTemplate::align_to_about: arg=help, next_line_help=false, longest=10
[clap_builder::output::help_template]HelpTemplate::align_to_about: positional=false arg_len=10, spaces=2
[clap_builder::output::help_template]HelpTemplate::help
[clap_builder::output::help_template]HelpTemplate::help: help_width=14, spaces=10, avail=86
[clap_builder::output::help_template]HelpTemplate::write_after_help
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
Usage: testclap [OPTIONS]

Options:
  -a &lt;ARG&gt;    do some job
              
              the job is print hello world [default: hello]
  -h, --help  Print help
</code></pre>
<p>output with help set with doc comment</p>
<pre><code>[clap_builder::builder::command]Command::_do_parse
[clap_builder::builder::command]Command::_build: name=&quot;testclap&quot;
[clap_builder::builder::command]Command::_propagate:testclap
[clap_builder::builder::command]Command::_check_help_and_version:testclap expand_help_tree=false
[clap_builder::builder::command]Command::long_help_exists
[clap_builder::builder::command]Command::_check_help_and_version: Building default --help
[clap_builder::builder::command]Command::_propagate_global_args:testclap
[clap_builder::builder::debug_asserts]Command::_debug_asserts
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:arg
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:help
[clap_builder::builder::debug_asserts]Command::_verify_positionals
[clap_builder::parser::parser]Parser::get_matches_with
[clap_builder::parser::parser]Parser::parse
[clap_builder::parser::parser]Parser::get_matches_with: Begin parsing &#x27;&quot;--help&quot;&#x27;
[clap_builder::parser::parser]Parser::possible_subcommand: arg=Ok(&quot;--help&quot;)
[clap_builder::parser::parser]Parser::get_matches_with: sc=None
[clap_builder::parser::parser]Parser::parse_long_arg
[clap_builder::parser::parser]Parser::parse_long_arg: Does it contain &#x27;=&#x27;...
[clap_builder::parser::parser]Parser::parse_long_arg: Found valid arg or flag &#x27;--help&#x27;
[clap_builder::parser::parser]Parser::parse_long_arg(&quot;help&quot;): Presence validated
[clap_builder::parser::parser]Parser::react action=Help, identifier=Some(Long), source=CommandLine
[clap_builder::parser::parser]Help: use_long=true
[clap_builder::builder::command]Command::long_help_exists: true
[clap_builder::builder::command]Command::write_help_err: testclap, use_long=true
[clap_builder::builder::command]Command::long_help_exists: true
[  clap_builder::output::help]write_help
[clap_builder::output::help_template]HelpTemplate::new cmd=testclap, use_long=true
[clap_builder::output::help_template]should_show_arg: use_long=true, arg=arg
[clap_builder::output::help_template]HelpTemplate::write_templated_help
[clap_builder::output::help_template]HelpTemplate::write_before_help
[ clap_builder::output::usage]Usage::create_usage_no_title
[ clap_builder::output::usage]Usage::create_usage_no_title
[ clap_builder::output::usage]Usage::write_help_usage
[ clap_builder::output::usage]Usage::write_arg_usage; incl_reqs=true
[ clap_builder::output::usage]Usage::needs_options_tag
[ clap_builder::output::usage]Usage::needs_options_tag:iter: f=arg
[clap_builder::builder::command]Command::groups_for_arg: id=&quot;arg&quot;
[ clap_builder::output::usage]Usage::needs_options_tag:iter:iter: grp_s=&quot;Cli&quot;
[ clap_builder::output::usage]Usage::needs_options_tag:iter: [OPTIONS] required
[ clap_builder::output::usage]Usage::write_args: incls=[]
[ clap_builder::output::usage]Usage::get_args: unrolled_reqs=[]
[ clap_builder::output::usage]Usage::write_subcommand_usage
[ clap_builder::output::usage]Usage::create_usage_no_title: usage=testclap [OPTIONS]
[clap_builder::output::help_template]HelpTemplate::write_all_args
[clap_builder::output::help_template]should_show_arg: use_long=true, arg=arg
[clap_builder::output::help_template]should_show_arg: use_long=true, arg=help
[clap_builder::output::help_template]HelpTemplate::write_args Options
[clap_builder::output::help_template]should_show_arg: use_long=true, arg=arg
[clap_builder::output::help_template]HelpTemplate::write_args: arg=&quot;arg&quot; longest=8
[clap_builder::output::help_template]should_show_arg: use_long=true, arg=help
[clap_builder::output::help_template]HelpTemplate::write_args: arg=&quot;help&quot; longest=10
[clap_builder::output::help_template]should_show_arg: use_long=true, arg=arg
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=-a &lt;ARG&gt;
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found default value...[[&quot;hello&quot;]]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=-a &lt;ARG&gt;
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found default value...[[&quot;hello&quot;]]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::short
[clap_builder::output::help_template]HelpTemplate::long
[clap_builder::output::help_template]HelpTemplate::align_to_about: arg=arg, next_line_help=true, longest=10
[clap_builder::output::help_template]HelpTemplate::align_to_about: printing long help so skip alignment
[clap_builder::output::help_template]HelpTemplate::help
[clap_builder::output::help_template]HelpTemplate::help: Next Line...true
[clap_builder::output::help_template]HelpTemplate::help: help_width=10, spaces=11, avail=90
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--help
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::short
[clap_builder::output::help_template]HelpTemplate::long
[clap_builder::output::help_template]HelpTemplate::align_to_about: arg=help, next_line_help=true, longest=10
[clap_builder::output::help_template]HelpTemplate::align_to_about: printing long help so skip alignment
[clap_builder::output::help_template]HelpTemplate::help
[clap_builder::output::help_template]HelpTemplate::help: Next Line...true
[clap_builder::output::help_template]HelpTemplate::help: help_width=10, spaces=36, avail=90
[clap_builder::output::help_template]HelpTemplate::write_after_help
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
Usage: testclap [OPTIONS]

Options:
  -a &lt;ARG&gt;
          do some job
          
          the job is print hello world
          
          [default: hello]

  -h, --help
          Print help (see a summary with &#x27;-h&#x27;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by <a href="https://github.com/Sk7Str1p3">@Sk7Str1p3</a> on 2025-11-24 15:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-triage</span> added by <a href="https://github.com/Sk7Str1p3">@Sk7Str1p3</a> on 2025-11-24 15:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;long help (`--help`) is not being printed if all help messages set with #[arg(help = &quot;...&quot;)&quot; to &quot;clap always prints short help (even with `--help`) if all help messages set with #[arg(help = &quot;...&quot;)]&quot; by <a href="https://github.com/Sk7Str1p3">@Sk7Str1p3</a> on 2025-11-24 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by <a href="https://github.com/epage">@epage</a> on 2025-11-24 16:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-11-24 16:07</div>
            <div class="timeline-body"><p>Note that doc comments do not directly map to <code>#[arg(help = &quot;&quot;)]</code> but are processed into <code>#[arg(help = &quot;&quot;)]</code> and maybe also <code>#[arg(long_help = &quot;&quot;)]</code>, see https://docs.rs/clap/latest/clap/_derive/index.html#doc-comments</p>
<p>The long help view is only shown to the user when long help is configured in the application by using fields like <code>long_help</code>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 20:00:39 UTC
    </footer>
</body>
</html>
