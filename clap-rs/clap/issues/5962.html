<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docs: Add a derive example for Help where it's disabled - clap-rs/clap #5962</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Docs: Add a derive example for Help where it's disabled</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/clap-rs/clap/issues/5962">#5962</a>
        opened by <a href="https://github.com/joshka">@joshka</a>
        on 2025-03-28 14:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/joshka">@joshka</a> on 2025-03-28 14:34</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.5</p>
<h3>Describe your use case</h3>
<p>In an old CLI I'm upgrading from clap 2, the current cli uses -h for a host param, so this can't be used for help.
It took me a bit of digging to get this to work right. My roadblocks were missing docs in the derive tutorial / reference for disable_help_flag and the help related ArgActions.</p>
<pre><code class="language-rust">#[derive(Debug, Parser)
#[command(disable_help_flag = true)
struct Args {
    // The hostname
    #[arg(short, long)
    host: Uri,

    // Print help
    #[arg(long, action = ArgAction::HelpLong)]
    help: Option&lt;bool&gt;,
}
</code></pre>
<h3>Describe the solution you'd like</h3>
<p>Add the following docs to the derive tutorial and reference:</p>
<ol>
<li>disable_help_flag</li>
<li>ArgAction::{Help, HelpShort, HelpLong}</li>
<li>The need to use <code>Option</code> when using one of those variants</li>
</ol>
<h3>Alternatives, if applicable</h3>
<p>Something that could be worth considering as a wider effort that might make it easier to find each of these docs is adding the derive code as examples to each of the various enums / options (e.g. ArgAction). This would be in addition to the current examples which only show the builder code, and it would make it clear how the builder and the derive syntax are aligned generally.</p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @joshka on 2025-03-28 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-docs</span> added by @epage on 2025-03-28 17:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-03-28 17:44</div>
            <div class="timeline-body"><p>We frequently get requests for a problem someone ran into to be specifically called out in the documentation and I generally push for there to be a specific reason why that problem should be called out compared to any other, and to instead rely in principles otherwise, to help keep the documentation a manageable size so people can discover the content in there (rather than being even more overwhelmed than they already are) and to help with maintenance.</p>
<p>I think the particular problem here is the non-obvious way of adapting the principles to the derive API, that <code>Option&lt;bool&gt;</code> is needed or <code>()</code> with a value parser.</p>
<p>btw our test for this, using <code>()</code>, is at
https://github.com/clap-rs/clap/blob/master/tests/derive/help.rs#L438-L452</p>
<p><code>Option&lt;bool&gt;</code> does shorten it a bit.</p>
<blockquote>
<p>Something that could be worth considering as a wider effort that might make it easier to find each of these docs is adding the derive code as examples to each of the various enums / options (e.g. ArgAction). This would be in addition to the current examples which only show the builder code, and it would make it clear how the builder and the derive syntax are aligned generally.</p>
</blockquote>
<p>This would fall more squarely under #4090.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-03-28 17:45</div>
            <div class="timeline-body"><blockquote>
<p>I think the particular problem here is the non-obvious way of adapting the principles to the derive API, that Option<bool> is needed or () with a value parser.</p>
</blockquote>
<p>If we move are considering forward with this, the question then becomes where would this best fit within the documentation such that it is discoverable and fits the flow (with any of the caveats of #4090 applied)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshka">@joshka</a> on 2025-03-28 23:32</div>
            <div class="timeline-body"><p>Taking the step back from the general solution much and solving just this problem, it's clear to me that a derive example of each ArgAction belongs in https://docs.rs/clap/latest/clap/enum.ArgAction.html and a derive example for the use of the action attribute belongs in https://docs.rs/clap/latest/clap/struct.Arg.html#method.action. This makes these docs available in the search results in docs.rs without having to text search withing some large non-idiomatic narrative. What are the downsides of just that approach (aside from the work to make it happen)?</p>
<blockquote>
<p>btw our test for this, using (), is at
https://github.com/clap-rs/clap/blob/master/tests/derive/help.rs#L438-L452</p>
</blockquote>
<p>This didn't come up in github searches as I was looking specifically for ShortHelp which has no example code. https://github.com/search?q=repo%3Aclap-rs%2Fclap+helpshort&amp;type=code</p>
<p>My search path for this was docs.rs derive tutorial, reference, trying to understand how the action stuff worked from the docs, trying to look for code that showed this in examples, using just a bool for the field and not knowing why it wasn't interpreting as false when the flag wasn't set, trying setting the default value to false, giving up and commenting it out before eventually trying a Option<bool>. All told, this was many many steps rather than search, find example, implement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-03-31 14:11</div>
            <div class="timeline-body"><blockquote>
<p>Taking the step back from the general solution much and solving just this problem, it's clear to me that a derive example of each ArgAction belongs in https://docs.rs/clap/latest/clap/enum.ArgAction.html and a derive example for the use of the action attribute belongs in https://docs.rs/clap/latest/clap/struct.Arg.html#method.action. This makes these docs available in the search results in docs.rs without having to text search withing some large non-idiomatic narrative. What are the downsides of just that approach (aside from the work to make it happen)?</p>
</blockquote>
<p>It is not clear to me why this specific attribute / enum should have it while none of the other ones should.  I'd like to focus on the general problem.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:09 UTC
    </footer>
</body>
</html>
