<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using a struct's `Default::default`, instead of a field type's `Default::default` - clap-rs/clap #3116</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using a struct&#x27;s <code>Default::default</code>, instead of a field type&#x27;s <code>Default::default</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/3116">#3116</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2021-12-09 16:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a></div>
            <div class="timeline-body"><p>Maintainer&#x27;s notes</p>
<ul>
<li>We can use the field&#x27;s <code>Default::default</code> with <code>#[clap(default_value_t)]</code></li>
<li>Design work is needed for using the container&#x27;s <code>Default::default</code></li>
</ul>
<hr>
<p><a href="https://github.com/epage"><img src="https://avatars.githubusercontent.com/u/60961?v=4"></a> <strong>Issue by <a href="https://github.com/epage">epage</a></strong>
<em>Thursday May 03, 2018 at 13:17 GMT</em>
<em>Originally opened as <a href="https://github.com/TeXitoi/structopt/issues/105">TeXitoi/structopt#105</a></em></p>
<hr>
<p>It&#x27;d be nice to have annotations like serde for default values</p>
<ul>
<li>Use the struct&#x27;s Default impl</li>
<li>Use the field&#x27;s Default impl</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:11</div>
            <div class="timeline-body"><p><a href="https://github.com/TeXitoi"><img src="https://avatars.githubusercontent.com/u/5787066?v=4"></a> <strong>Comment by <a href="https://github.com/TeXitoi">TeXitoi</a></strong>
<em>Thursday May 03, 2018 at 13:38 GMT</em></p>
<hr>
<p>The problem is that, most of the time, clap will not be able to show the default value (because just a few types implement Display).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:17</div>
            <div class="timeline-body"><p><code>default_value_t</code> allows you to do the type&#x27;s <code>Default</code> impl or a custom value of the type, so long as the type implements <code>Display</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-derive</span> added by <a href="https://github.com/epage">@epage</a> on 2021-12-09 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-14 14:29</div>
            <div class="timeline-body"><p>I missed the case of using the container&#x27;s <code>Default::default</code>.  The question is how to specify this.  Serde does this by having a container-level <code>default</code> attribute but for us to do that, we would make all fields optional.  This would require a weird handling of structs to use <code>flatten</code> to leverage it or a new way to specify it at the field level</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by <a href="https://github.com/epage">@epage</a> on 2021-12-14 14:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by <a href="https://github.com/epage">@epage</a> on 2021-12-14 14:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#748</a> on 2021-12-14 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by <a href="https://github.com/epage">@epage</a> on 2022-05-11 20:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#3720</a> on 2022-05-11 20:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-10-13 14:46</div>
            <div class="timeline-body"><p>From #6128</p>
<blockquote>
<p>An unstable Rust feature allows for setting default values on fields directly. We&#x27;ll need to evaluate how to integrate that into clap as that moves towards stabilization.</p>
</blockquote>
<p>Would also be good to see how serde handles that and seek to mirror it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`serde`-like default value behavior&quot; to &quot;Using a struct&#x27;s `Default::default`, instead of a field type&#x27;s `Default::default`&quot; by <a href="https://github.com/epage">@epage</a> on 2025-10-13 14:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:58:33 UTC
    </footer>
</body>
</html>
