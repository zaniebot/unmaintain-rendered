<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Names of missing required arguments are always colorized - clap-rs/clap #775</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Names of missing required arguments are always colorized</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/775">#775</a>
        opened by <a href="https://github.com/dotdash">@dotdash</a>
        on 2016-12-12 16:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dotdash">@dotdash</a></div>
            <div class="timeline-body">Affected Version of clap
<p>2.19.2</p>
Expected Behavior Summary
<p>Coloring is only applied when output is sent to a terminal.</p>
Actual Behavior Summary
<p>The name of the missing required argument is always colorized, giving messed up output e.g. capturing output into vim&#x27;s quickfix buffer.</p>
<pre><code>|| [cargo run --bin render]                                                                                                                  
|| unused variable: `matches`, #[warn(unused_variables)] on by default                                                                       
||    |                                                                                                                                      
|| 33 |     let matches = App::new(&quot;My  app&quot;)                                                                                                
||    |         ^^^^^^^                                                                                                                      
||-                                                                                                                                          
||      Running `target/debug/render`                                                                                                        
|| The following required arguments were not provided:                                                                                       
||     ^[[1;31m&lt;CONFIG&gt;^[[0m                                                                                                                 
||-                                                                                                                                          
|| USAGE:                                                                                                                                    
||     render &lt;CONFIG&gt; &lt;WIDTH&gt; &lt;HEIGHT&gt;                                                                                                      
||-                                                                                                                                          
|| For more information try --help                                                                                                           
|| [Finished in 1 seconds with code 1]              
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-18 20:21</div>
            <div class="timeline-body"><p>Is this with using <a href="https://docs.rs/clap/2.19.2/clap/enum.AppSettings.html#variant.ColorNever"><code>AppSettings::ColorNever</code></a>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-18 20:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dotdash">@dotdash</a> on 2016-12-19 15:04</div>
            <div class="timeline-body"><p>It&#x27;s not, but even with it, that one thing is still colored.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dotdash">@dotdash</a> on 2016-12-19 15:27</div>
            <div class="timeline-body"><p>OK, this is because the closure in <code>validate_required</code> directly uses <code>Format::Error</code> instead of the <code>Colorizer</code> and thus unconditonally emits ANSI color codes. The quick fix would be to create a <code>Colorizer</code> there, and using its <code>error()</code> method instead. Is that an acceptable approach (I&#x27;m not familiar with the code base)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-19 15:48</div>
            <div class="timeline-body"><p>Great catch! Yeah that would be an acceptable fix. I&#x27;m on mobile right now, so if you&#x27;d like to do the PR feel free :wink:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#781</a> on 2016-12-19 15:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-19 18:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:56:40 UTC
    </footer>
</body>
</html>
