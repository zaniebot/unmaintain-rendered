<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Two multiple positional arguments with one being &quot;last&quot; are displayed in usage incorrectly if the &quot;last&quot; one is required - clap-rs/clap #944</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Two multiple positional arguments with one being &quot;last&quot; are displayed in usage incorrectly if the &quot;last&quot; one is required</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/944">#944</a>
        opened by <a href="https://github.com/netvl">@netvl</a>
        on 2017-05-03 20:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/netvl">@netvl</a> on 2017-05-03 20:20</div>
            <div class="timeline-body"><h3>Rust Version</h3>
<p>rustc 1.19.0-nightly (afa1240e5 2017-04-29)</p>
<h3>Affected Version of clap</h3>
<p>2.23.3</p>
<h3>Expected Behavior Summary</h3>
<p>Expected this usage text:</p>
<pre><code>USAGE:
    example &lt;FIRST&gt;... -- &lt;SECOND&gt;...
</code></pre>
<h3>Actual Behavior Summary</h3>
<p>Got this usage text:</p>
<pre><code>USAGE:
    example &lt;FIRST&gt;...
</code></pre>
<h3>Steps to Reproduce the issue</h3>
<p>Configure two positional required multiple-type arguments, with the second one being the &quot;last&quot;. See the code below.</p>
<p>Also, adding an explicit <code>AppSettings::DontCollapseArgsInUsage</code> flag does not help.</p>
<h3>Sample Code or Link to Sample Code</h3>
<pre><code class="language-rust">#[macro_use(clap_app)] extern crate clap;

fn main() {
    clap_app!(example =&gt;
        (@arg FIRST: ... * &quot;First&quot;)
        (@arg SECOND: ... * +last &quot;Second&quot;)
    ).get_matches();
}
</code></pre>
<p>Curiously, if you make the second arg not required:</p>
<pre><code>(@arg SECOND: ... +last &quot;Second&quot;)
</code></pre>
<p>the output is correct:</p>
<pre><code>USAGE:
    pwatch &lt;FIRST&gt;... [-- &lt;SECOND&gt;...]
</code></pre>
<h3>Debug output</h3>
<pre><code>DEBUG:clap:Parser::propogate_settings: self=example, g_settings=AppFlags(
    NEEDS_LONG_HELP | NEEDS_LONG_VERSION | NEEDS_SC_HELP | UTF8_NONE | COLOR_AUTO
)
DEBUG:clap:Parser::get_matches_with;
DEBUG:clap:Parser::create_help_and_version;
DEBUG:clap:Parser::create_help_and_version: Building --help
DEBUG:clap:Parser::create_help_and_version: Building --version
DEBUG:clap:Parser::get_matches_with: Begin parsing '&quot;--help&quot;' ([45, 45, 104, 101, 108, 112])
DEBUG:clap:Parser::is_new_arg: arg=&quot;--help&quot;, Needs Val of=None
DEBUG:clap:Parser::is_new_arg: Arg::allow_leading_hyphen(false)
DEBUG:clap:Parser::is_new_arg: -- found
DEBUG:clap:Parser::is_new_arg: starts_new_arg=true
DEBUG:clap:Parser::possible_subcommand: arg=&quot;--help&quot;
DEBUG:clap:Parser::get_matches_with: possible_sc=false, sc=None
DEBUG:clap:Parser::parse_long_arg;
DEBUG:clap:Parser::parse_long_arg: Does it contain '='...No
DEBUG:clap:Parser::parse_long_arg: Found valid flag '--help'
DEBUG:clap:Parser::check_for_help_and_version_str;
DEBUG:clap:Parser::check_for_help_and_version_str: Checking if --help is help or version...Help
DEBUG:clap:Parser::_help: use_long=true
DEBUG:clap:Parser::use_long_help: ret=false
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Parser::color;
DEBUG:clap:Parser::color: Color setting...Auto
DEBUG:clap:Help::new;
DEBUG:clap:Help::write_help;
DEBUG:clap:Help::write_default_help;
DEBUG:clap:Help::write_bin_name;
DEBUG:clap:Help::wrap_help: longest_w=7, avail_chars=190
DEBUG:clap:Help::wrap_help: Enough space to wrap...Yes
DEBUG:clap:Help::wrap_help:iter: idx=0, g=e
DEBUG:clap:Help::wrap_help:iter: idx=1, g=x
DEBUG:clap:Help::wrap_help:iter: idx=2, g=a
DEBUG:clap:Help::wrap_help:iter: idx=3, g=m
DEBUG:clap:Help::wrap_help:iter: idx=4, g=p
DEBUG:clap:Help::wrap_help:iter: idx=5, g=l
DEBUG:clap:Help::wrap_help:iter: idx=6, g=e
DEBUG:clap:Help::write_version;
DEBUG:clap:usage::create_usage_no_title;
DEBUG:clap:usage::get_required_usage_from: reqs=[&quot;FIRST&quot;, &quot;SECOND&quot;], extra=None
DEBUG:clap:usage::get_required_usage_from: after init desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: no more children
DEBUG:clap:usage::get_required_usage_from: final desc_reqs=[&quot;FIRST&quot;, &quot;SECOND&quot;]
DEBUG:clap:usage::get_required_usage_from: args_in_groups=[]
DEBUG:clap:usage::needs_flags_tag;
DEBUG:clap:usage::needs_flags_tag:iter: f=hclap_help;
DEBUG:clap:usage::needs_flags_tag:iter: f=vclap_version;
DEBUG:clap:usage::needs_flags_tag: [FLAGS] not required
DEBUG:clap:usage::create_help_usage: usage=pwatch &lt;FIRST&gt;...
DEBUG:clap:Help::write_all_args;
DEBUG:clap:Help::write_args;
DEBUG:clap:Help::write_args: Current Longest...2
DEBUG:clap:Help::write_args: New Longest...6
DEBUG:clap:Help::write_args: Current Longest...6
DEBUG:clap:Help::write_args: New Longest...9
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--help
DEBUG:clap:Help::spec_vals: a=--help
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width &gt; (width - taken)...23 &gt; (190 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=7
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--version
DEBUG:clap:Help::spec_vals: a=--version
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width &gt; (width - taken)...26 &gt; (190 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_args_unsorted;
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=&lt;FIRST&gt;...
DEBUG:clap:Help::spec_vals: a=&lt;FIRST&gt;...
DEBUG:clap:Help::val: Has switch...No, and not next_line
DEBUG:clap:write_spaces!: num=5
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=&lt;SECOND&gt;...
DEBUG:clap:Help::spec_vals: a=&lt;SECOND&gt;...
DEBUG:clap:Help::val: Has switch...No, and not next_line
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-05-05 01:03</div>
            <div class="timeline-body"><p>Interesting, thanks for taking the time to file this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: usage strings</span> added by @kbknapp on 2017-05-05 01:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2017-05-05 01:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P3: want to have</span> added by @kbknapp on 2017-05-05 01:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @kbknapp on 2017-05-05 01:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2017-05-05 01:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "2.24.1" by @kbknapp on 2017-05-06 18:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2017-05-07 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-05-07 14:48</div>
            <div class="timeline-body"><p>2.24.1 is on crates.io</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
