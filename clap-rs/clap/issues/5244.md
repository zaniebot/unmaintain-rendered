```yaml
number: 5244
title: "Clap completion can't tell regular and `last` positionals apart"
type: issue
state: open
author: Morganamilo
labels:
  - C-bug
  - E-hard
  - A-completion
assignees: []
created_at: 2023-12-04T04:54:06Z
updated_at: 2025-08-15T13:46:36Z
url: https://github.com/clap-rs/clap/issues/5244
synced_at: 2026-01-10T01:57:49Z
```

# Clap completion can't tell regular and `last` positionals apart

---

_Issue opened by @Morganamilo on 2023-12-04 04:54_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.71.0-nightly (f5559e338 2023-04-24)

### Clap Version

4.4.10

### Minimal reproducible code

```rust
use clap::Parser;
use clap::ValueHint;

#[derive(Parser, Debug)]
#[command(args_override_self = true)]
pub struct Args {
    #[arg(required = true)]
    pub targets: Vec<String>,
    #[arg(
        value_hint = ValueHint::AnyPath,
    )]
    #[arg(required = true, last = true)]
    pub files: Vec<String>,
}
```

### Steps to reproduce the bug with the above code

`command <tab>` should and does complete files but `command foo -- <tab>` should not complete files.

If you swap the hints then `command <tab>` does not complete files and neither does `command foo -- <tab>` .

### Actual Behaviour

Clap uses the hint for the first arg to complete both args.

### Expected Behaviour

Clap should complete each arg according to hint.

### Additional Context

_No response_

### Debug Output

_No response_

---

_Label `C-bug` added by @Morganamilo on 2023-12-04 04:54_

---

_Label `A-completion` added by @epage on 2023-12-04 16:30_

---

_Label `E-hard` added by @epage on 2023-12-04 16:30_

---

_Referenced in [astral-sh/uv#3249](../../astral-sh/uv/issues/3249.md) on 2024-05-14 18:19_

---

_Renamed from "Clap completion can't tell positional args apart" to "Clap completion can't tell regular and `last` positionals apart" by @epage on 2025-08-15 13:46_

---
