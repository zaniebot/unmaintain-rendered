<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing newline at the end of help - clap-rs/clap #1536</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Missing newline at the end of help</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1536">#1536</a>
        opened by <a href="https://github.com/mb64">@mb64</a>
        on 2019-08-27 20:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mb64">@mb64</a> on 2019-08-27 20:35</div>
            <div class="timeline-body"><p>I have the following <code>main.rs</code>:</p>
<pre><code class="language-rust">fn main() {
    clap::App::new(&quot;app&quot;).print_help().unwrap();
}
</code></pre>
<p>It outputs no newline at the end, so the bash prompt appears like this:</p>
<pre><code>[me@my-computer clap-test]$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.05s
     Running `target/debug/clap-test`
app 

USAGE:
    app

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information[me@my-computer clap-test]$ 
</code></pre>
<p>Instead of:</p>
<pre><code>[me@my-computer clap-test]$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.05s
     Running `target/debug/clap-test`
app 

USAGE:
    app

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information
[me@my-computer clap-test]$ 
</code></pre>
<p>I'm using the latest version (2.33.0).  It also happens on the playground: <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;code=fn%20main(">here's a playground example.</a>%20%7B%0A%20%20%20%20clap%3A%3AApp%3A%3Anew(%22app%22).print_help().unwrap()%3B%0A%20%20%20%20println!(%22%3C-%20there%20is%20no%20newline%20here%22)%0A%7D)</p>
<p>Debug output:</p>
<details>
<summary> Debug Output </summary>
<pre>
<code>

<p>DEBUG:clap:Parser::propagate_settings: self=app, g_settings=AppFlags(
(empty),
)
DEBUG:clap:Parser::create_help_and_version;
DEBUG:clap:Parser::create_help_and_version: Building --help
DEBUG:clap:Parser::create_help_and_version: Building --version
DEBUG:clap:Help::write_app_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Parser::color;
DEBUG:clap:Parser::color: Color setting...Auto
DEBUG:clap:is_a_tty: stderr=false
DEBUG:clap:Help::new;
DEBUG:clap:Help::write_help;
DEBUG:clap:Help::write_default_help;
DEBUG:clap:Help::write_bin_name;
DEBUG:clap:Help::write_version;
DEBUG:clap:usage::create_usage_no_title;
DEBUG:clap:usage::get_required_usage_from: reqs=[], extra=None
DEBUG:clap:usage::get_required_usage_from: after init desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: no more children
DEBUG:clap:usage::get_required_usage_from: final desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: args_in_groups=[]
DEBUG:clap:usage::needs_flags_tag;
DEBUG:clap:usage::needs_flags_tag:iter: f=hclap_help;
DEBUG:clap:usage::needs_flags_tag:iter: f=vclap_version;
DEBUG:clap:usage::needs_flags_tag: [FLAGS] not required
DEBUG:clap:usage::create_help_usage: usage=app
DEBUG:clap:Help::write_all_args;
DEBUG:clap:Help::write_args;
DEBUG:clap:Help::write_args: Current Longest...2
DEBUG:clap:Help::write_args: New Longest...6
DEBUG:clap:Help::write_args: Current Longest...6
DEBUG:clap:Help::write_args: New Longest...9
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--help
DEBUG:clap:Help::spec_vals: a=--help
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width &gt; (width - taken)...23 &gt; (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=7
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--version
DEBUG:clap:Help::spec_vals: a=--version
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width &gt; (width - taken)...26 &gt; (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...false
DEBUG:clap:Help::help: Too long...No</p>
</code>
</pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../interledger/interledger-rs/pulls/236.html">interledger/interledger-rs#236</a> on 2019-09-05 19:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Dylan-DPC-zz">@Dylan-DPC-zz</a> on 2019-09-24 14:43</div>
            <div class="timeline-body"><p>@mb64 are you still having this issue? I just checked and it works as expected. Could be something related to your shell?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mb64">@mb64</a> on 2019-09-24 23:20</div>
            <div class="timeline-body"><p>This is still an issue.  It does not work as I expect, so we must have different expectations.  In terms of the raw data written to stdout by clap, I would expect it to output <code>... help stuff ...\n</code>; however, it outputs <code>... help stuff ...</code> without a final newline – neither in the playground, nor with the current master.</p>
<p>If you compare that to any other program, you can see that e.g. <code>ls</code> outputs with a final newline, and <code>rustc</code> outputs with two final newlines to make a blank line at the end.</p>
<p>The difference is like <code>echo -n</code> vs <code>echo</code> (on *nix – I don't know of any Windows equivalent).</p>
<p><strong>Edit:</strong> I just tested it on the <code>v3-master</code> branch, and it works fine (outputs <code>...help stuff...\n</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 12:55</div>
            <div class="timeline-body"><p>I can confirm this is fixed in <code>master</code>, so closing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @CreepySkeleton on 2020-02-01 12:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../sharkdp/fd/pulls/750.html">sharkdp/fd#750</a> on 2021-05-16 19:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zitudu">@zitudu</a> on 2021-10-18 01:56</div>
            <div class="timeline-body"><p>Do you have any plan to fix this issue on v2? @CreepySkeleton</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-10-18 07:40</div>
            <div class="timeline-body"><p>No, only in v3.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:07 UTC
    </footer>
</body>
</html>
