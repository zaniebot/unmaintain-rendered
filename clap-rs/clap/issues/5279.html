<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete multiple path elements at once - clap-rs/clap #5279</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Complete multiple path elements at once</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/5279">#5279</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2024-01-02 19:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a></div>
            <div class="timeline-body"><p>#3166 is adding Rust-implemented completions.  In reviewing nu's changelog, they added support for offering <code>./target/debug/incremental</code> as a completion for <code>tar/de/inc</code> (see https://www.nushell.sh/blog/2023-10-17-nushell_0_86.html#improving-the-completions-in-the-repl-toc).  It could be really nice for us to include that as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2024-01-02 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-completion</span> added by @epage on 2024-01-02 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-easy</span> added by @epage on 2024-01-02 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3166.html">clap-rs/clap#3166</a> on 2024-01-02 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Path abbreviation completions" to "Complete multiple path elements at once" by @epage on 2024-01-02 19:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nair-sreerag">@nair-sreerag</a> on 2025-04-13 16:39</div>
            <div class="timeline-body"><p>Hello @epage,
I went through the nushell demo (the gif demonstrating the feature).I would like to pick this issue up but  i have a few questions before I start.</p>
<pre><code>root
    - target1
        - src1
            - main.rs
        - src2
            - main.rs
    - target2
        - src
            - main.rs
        - src2
            - main.rs
    - target3
        - src
            - main.rs
        - src2
            - main.rs
</code></pre>
<p>If I write  <strong>./ta/src/m</strong> and press TAB, it should show a list of 6 entries. Now this is a small generated list. But in real life scenarios, the list generated can be huge. So should there be a limit to the list that can be displayed? If yes, then how much?</p>
<p>And on what ordering condition should the list be generated? I am thinking alphabetical, but would like to hear your thoughts.</p>
<p>One small help I would like is to understand the usecase of this feature that I will be building. Are there any related examples in the codebase that I can play around with??</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-04-14 15:16</div>
            <div class="timeline-body"><blockquote>
<p>If I write ./ta/src/m and press TAB, it should show a list of 6 entries. Now this is a small generated list. But in real life scenarios, the list generated can be huge. So should there be a limit to the list that can be displayed? If yes, then how much?</p>
</blockquote>
<p>I wouldn't limit the list.  If the person is in a situation where its too much, they can expand one of the sections to be less ambiguous</p>
<blockquote>
<p>And on what ordering condition should the list be generated? I am thinking alphabetical, but would like to hear your thoughts.</p>
</blockquote>
<p>I would prioritize matches where a path element has an exact match.  The more exact matches, the higher the priority.  Maybe we could just put this in the <code>display_order</code> and have <code>clap_complete</code> do the ordering for us.  Huh, why is that a <code>usize</code>?  Could be much easier as an <code>isize</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-04-14 15:29</div>
            <div class="timeline-body"><blockquote>
<p>One small help I would like is to understand the usecase of this feature that I will be building.</p>
</blockquote>
<p>So I've not used it with nushell and fish (which also has it) but my assumption is that this is to allow short-hands without explicitly tabbing / selecting at every level.</p>
<p>Say I'm using <code>cargo</code> in the root of https://github.com/toml-rs/toml</p>
<pre><code>root
- crates
  - benchmarks
    - Cargo.toml
  - serde_spanned
    - Cargo.toml
  - serde_toml
    - Cargo.toml
  - toml
    - Cargo.toml
  - toml_datetime
    - Cargo.toml
  - tom,_edit
    - Cargo.toml
  - toml_edit_fuzz
    - Cargo.toml
</code></pre>
<p>I could then do</p>
<pre><code class="language-console">$ cargo check --manifest-path c/b/C[TAB]
$ cargo check --manifest-path crates/benchmarks/Cargo.toml
$ cargo check --manifest-path c/s/C[TAB]
crates/serde_spanned/Cargo.toml
crates/serde_toml/Cargo.toml
$ cargo check --manifest-path c/t/C[TAB]
crates/toml/Cargo.toml
crates/toml_datetime/Cargo.toml
crates/toml_edit/Cargo.toml
crates/toml_edit_fuzz/Cargo.toml
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nair-sreerag">@nair-sreerag</a> on 2025-04-19 20:19</div>
            <div class="timeline-body"><p>Thanks for the reply, @epage. My question was more of as to how this feature will be used in clap. I wanted an example (or more like a short tutorial) on its usage in clap</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nair-sreerag">@nair-sreerag</a> on 2025-04-19 21:35</div>
            <div class="timeline-body"><p>Is there some kind of implementation for such completion; like in my example above, if i enter <strong>ro</strong>[TAB], it should complete it to <strong>root/</strong> .Pressing [TAB] again will list all the files and folders in root.</p>
<p>Again, I am asking this because we are emulating this feature from nushell which is a full fledged shell like zsh or bash whereas clap is not a shell, its an argument parser. So I am having difficulty fitting this path expansion feature in clap.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-04-21 14:38</div>
            <div class="timeline-body"><p>All this issue is responsible for is updating <code>complete_path</code> to report all <code>CompletionCandidate</code> assuming that each path component is a prefix (prioritizing exact matches)
https://github.com/clap-rs/clap/blob/f88be5738e33018f3298fabb7b67835eefbc55e0/clap_complete/src/engine/custom.rs#L285-L348</p>
<p>Any other behavior is either owned by the shell or the completion engine itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Unique-Usman">@Unique-Usman</a> on 2025-08-27 20:19</div>
            <div class="timeline-body"><p>Hi @epage,</p>
<p>I will be working on this simultaneously with the other issue.</p>
<p>Thank you.</p>
<p>Also, is it okay to model our solution just like the way Nushell implemented theirs ?</p>
<p>Thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-08-28 15:19</div>
            <div class="timeline-body"><blockquote>
<p>Also, is it okay to model our solution just like the way Nushell implemented theirs ?</p>
</blockquote>
<p>As I mentioned, I'm not fully aware of how nushell does it.  I think I heard that fish will take <code>cb/ad</code> and will check for any  directory that matches <code>.*c.*b.*</code> and then any file that matches `.<em>a.</em>d.* and this frustrated people because it caused irrelevant matches.</p>
<p>I would lean towards prefix checks (<code>cb/ad</code> -&gt; <code>cb.*</code> and `ad.*).  That could be annoying if there is a long common prefix to a path element and a lot in common among the children directories.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Unique-Usman">@Unique-Usman</a> on 2025-08-28 17:11</div>
            <div class="timeline-body"><p>Ok, thank you, I will work towards implementing the prefix check.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:49:16 UTC
    </footer>
</body>
</html>
