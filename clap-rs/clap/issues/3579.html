<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Separate section for Positional Arguments in generated manpages - clap-rs/clap #3579</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Separate section for Positional Arguments in generated manpages</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/clap-rs/clap/issues/3579">#3579</a>
        opened by <a href="https://github.com/ducaale">@ducaale</a>
        on 2022-03-26 16:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ducaale">@ducaale</a> on 2022-03-26 16:52</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>3.1.0</p>
<h3>Describe your use case</h3>
<p>N/A</p>
<h3>Describe the solution you'd like</h3>
<p>I would like <code>clap_mangen</code> to group positional arguments into their own section.</p>
<pre><code>POSITIONAL ARGUMENTS
       PATTERN
           A regular expression used for searching. To match a pattern beginning with a dash, use the -e/--regexp
           option.

       PATH
           A file or directory to search. Directories are searched recursively. Paths specified explicitly on the
           command line override glob and ignore rules.

OPTIONS
       -A, --after-context NUM
           Show NUM lines after each match.

           This overrides the --context flag.

       --auto-hybrid-regex
           When this flag is used, ripgrep will dynamically choose between supported regex engines depending on the
           features used in a pattern. When ripgrep chooses a regex engine, it applies that choice for every regex
           provided to ripgrep (e.g., via multiple -e/--regexp or -f/--file flags).
</code></pre>
<h3>Alternatives, if applicable</h3>
<p>Because <code>clap_mangen</code> allows rendering sections as needed, I can copy code from <code>clap_mangen</code> and customise it as needed</p>
<pre><code class="language-rs">let items: Vec&lt;_&gt; = app
    .get_arguments()
    .filter(|i| !i.is_hide_set())
    .map(|i| i.clone())
    .collect();

let man = clap_mangen::Man::new(app);
let mut buf = Vec::new();

man.render_title(&amp;mut buf).unwrap();
man.render_name_section(&amp;mut buf).unwrap();
man.render_synopsis_section(&amp;mut buf).unwrap();
man.render_description_section(&amp;mut buf).unwrap();

let mut roff = roff::Roff::new();
roff.control(&quot;SH&quot;, [&quot;POSITIONAL ARGUMENTS&quot;]);
for pos in items.iter().filter(|a| a.is_positional()) {
    let mut name = pos.get_value_names().unwrap()[0];
    let header = vec![roff::bold(&amp;name)];
    let mut body = vec![];
    if let Some(help) = pos.get_long_help().or_else(|| pos.get_help()) {
        body.push(roff::roman(&amp;help.to_string()));
    }
    roff.control(&quot;TP&quot;, []).text(header).text(body);
}
roff.to_writer(&amp;mut buf).unwrap();
</code></pre>
<h3>Additional Context</h3>
<p>N/A</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @ducaale on 2022-03-26 16:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2022-03-26 17:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-man</span> added by @epage on 2022-03-26 17:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-03-26 17:12</div>
            <div class="timeline-body"><p>What happens if put them in a &quot;POSITION ARGUMENTS&quot; <code>help_heading</code>, is the result good enough for your purposes?</p>
<p>Any thoughts @larswirzenius or @sondr3 about what we should be doing generally?  Putting them in a separate section would match with <code>--help</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ducaale">@ducaale</a> on 2022-03-26 17:18</div>
            <div class="timeline-body"><blockquote>
<p>What happens if put them in a &quot;POSITION ARGUMENTS&quot; help_heading, is the result good enough for your purposes?</p>
</blockquote>
<p>Unfortunately, I don't think that works at the moment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3580.html">clap-rs/clap#3580</a> on 2022-03-26 17:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-03-26 18:03</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>What happens if put them in a &quot;POSITION ARGUMENTS&quot; help_heading, is the result good enough for your purposes?</p>
</blockquote>
<p>Unfortunately, I don't think that works at the moment.</p>
</blockquote>
<p>Right, looks like we don't support help headings, thats discussed in #3363</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-03-26 18:04</div>
            <div class="timeline-body"><p>Found where this was discussed in the https://github.com/clap-rs/clap/pull/3174#discussion_r768905319</p>
<p>epage:</p>
<blockquote>
<p>So we are putting named arguments before positionals. I see that <code>git</code> does this.</p>
<p>Whether this or many other formatting details, how standardized are these practices? What kinds of things are people likely to disagree with and want different from what is provided?</p>
</blockquote>
<p>@sondr3</p>
<blockquote>
<p>I honestly have no idea, I though about maybe sorting them alphabetically but from the manpages I looked at there seemed to be no good rhyme or reason to the order for them, so I just used an arbitrary one.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ducaale">@ducaale</a> on 2022-03-26 18:34</div>
            <div class="timeline-body"><p>Thanks for linking previous discussions about this. I have been using curl and ripgrep as a reference but didn't look into other programs that have positional args.</p>
<ul>
<li>ripgrep: positional arguments are grouped into their own section before the options section</li>
<li>curl: each positional argument has its own section and these come before the options section</li>
</ul>
<p>By the way, isn't git's positional args the same as clap's subcommands? If that is the case, then <code>clap_mangen</code> already renders subcommands into its own section after the options section.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/larswirzenius">@larswirzenius</a> on 2022-03-27 06:59</div>
            <div class="timeline-body"><p>From a long-time man page mass consumer point of view, putting positional arguments into their own section would be unusual, and as such would make the man page different from other man pages. It might be better, of course, but for someone who uses man pages as a quick reference, any unusual structure makes it harder to find what I want quickly.</p>
<p>A subsection would make more sense.</p>
<p>However, as a personal opinion, I would structure the command line argument structure so that there are very few different kinds of positional arguments. For grep, a pattern and filenames are needed, but I don't think that warrants its own section, or even subsection.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-03-28 18:11</div>
            <div class="timeline-body"><blockquote>
<p>By the way, isn't git's positional args the same as clap's subcommands? If that is the case, then clap_mangen already renders subcommands into its own section after the options section.</p>
</blockquote>
<p>If you run <code>man git-diff</code>, you'll see <code>&lt;path&gt;...</code> at the very bottom of <code>OPTIONS</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ducaale">@ducaale</a> on 2022-03-28 19:55</div>
            <div class="timeline-body"><p>Oh, I see.</p>
<p>Now that I know <code>clap_mangen</code> closely follows how git's man page is structured, I am changing my opinion and wouldn't mind if this issue and PR #3579 get closed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-03-28 20:20</div>
            <div class="timeline-body"><p>I wouldn't say its a requirement to follow git but that we are looking to prior art to help guide what the man generation should look like and git is a good example because it both gets a lot of attention and is complex enough to have examples of anything we come across.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../chmln/sd/pulls/231.html">chmln/sd#231</a> on 2023-10-02 01:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:34 UTC
    </footer>
</body>
</html>
