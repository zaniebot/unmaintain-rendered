<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Argument and command inference are buggy - clap-rs/clap #4603</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Argument and command inference are buggy</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/4603">#4603</a>
        opened by <a href="https://github.com/SUPERCILEX">@SUPERCILEX</a>
        on 2023-01-04 02:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/SUPERCILEX">@SUPERCILEX</a> on 2023-01-04 02:00</div>
            <div class="timeline-body"><ul>
<li>Long argument inference randomly picks an argument on conflicts (https://github.com/clap-rs/clap/pull/4584).</li>
<li>Command name inference fails with conflicting aliases (https://github.com/clap-rs/clap/pull/4583).</li>
</ul>
<p>Note that the other way around works: long args handle conflicting aliases and command names reject non-aliasing conflicts.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-04 20:18</div>
            <div class="timeline-body"><p>Please fill out the bug report template, including a code sample and reproduction steps.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SUPERCILEX">@SUPERCILEX</a> on 2023-01-04 20:29</div>
            <div class="timeline-body"><p>This is just a tracking issue so people know these bugs exist. As I said, I'm not going to waste my time on that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-01-04 21:27</div>
            <div class="timeline-body"><p>Except you are wasting your time further because I don't have time to clean up after this.  Without reproduction steps, this is being closed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2023-01-04 21:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SUPERCILEX">@SUPERCILEX</a> on 2023-03-29 03:25</div>
            <div class="timeline-body"><pre><code class="language-rust">#!/usr/bin/env rust-script
//! ```cargo
//! [dependencies]
//! clap = { version = &quot;4.2.0&quot;, features = [&quot;derive&quot;] }
//! ```

use clap::*;

#[derive(Parser, Debug)]
#[command(infer_subcommands = true, infer_long_args = true)]
struct Infer {
    // Try ./clap.rs --a delete. This should fail since there's ambiguity.
    #[arg(long, alias = &quot;abc&quot;)]
    first: bool,
    #[arg(long, alias = &quot;aaa&quot;)]
    second: bool,

    #[command(subcommand)]
    cmd: Cmd,
}

#[derive(Subcommand, Debug)]
enum Cmd {
    // Try ./clap.rs d. This should work since the ambiguity is within the command.
    #[command(alias = &quot;destroy&quot;)]
    Delete
}

fn main() {
    dbg!(Infer::parse());
}
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:34 UTC
    </footer>
</body>
</html>
