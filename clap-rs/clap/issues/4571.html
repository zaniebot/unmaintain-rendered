<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can't build with any version of Clap 4 due to rustix dependency - clap-rs/clap #4571</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Can&#x27;t build with any version of Clap 4 due to rustix dependency</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/4571">#4571</a>
        opened by <a href="https://github.com/ghuh">@ghuh</a>
        on 2022-12-22 18:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ghuh">@ghuh</a></div>
            <div class="timeline-body">Please complete the following tasks
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
Rust Version
<p>rustc 1.66.0 (69f9c33d7 2022-12-12)</p>
Clap Version
<p>4.0.x (All patch versions up to at least 30)</p>
Minimal reproducible code
<p>Just build with any version of Clap 4.0 and above.</p>
Steps to reproduce the bug with the above code
<p>Need to be on Rust stable.</p>
Actual Behaviour
<pre><code>   Compiling rustix v0.36.5
error[E0554]: `#![feature]` may not be used on the stable release channel
  --&gt; /Users/sambas/.cargo/registry/src/github.com-1ecc6299db9ec823/rustix-0.36.5/src/lib.rs:99:26
   |
99 | #![cfg_attr(rustc_attrs, feature(rustc_attrs))]
   |                          ^^^^^^^^^^^^^^^^^^^^

For more information about this error, try `rustc --explain E0554`.
error: could not compile `rustix` due to previous error
</code></pre>
Expected Behaviour
<p>The build should complete.  If I downgrade to Clap 3.2 and change nothing else, it builds fine.</p>
Additional Context
<p><em>No response</em></p>
Debug Output
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by <a href="https://github.com/ghuh">@ghuh</a> on 2022-12-22 18:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-12-22 18:52</div>
            <div class="timeline-body"><p>I believe we got our dependence on rustic in 4.0.27.</p>
<p>Unfortunately, I can&#x27;t reproduce this</p>
<ul>
<li>I&#x27;m on 1.66 and updated my rustix version and I can&#x27;t reproduce this.</li>
<li>CI is running on all major platforms with rustix 0.35.13 and 0.36.4 in the dependency tree and building successfully.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghuh">@ghuh</a> on 2022-12-22 19:02</div>
            <div class="timeline-body"><p>I just tried reproducing on two other computers and the build worked fine on both of them so this must be something specific to the environment on this one computer.  Thanks for checking!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ghuh">@ghuh</a> on 2022-12-22 19:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghuh">@ghuh</a> on 2022-12-22 19:07</div>
            <div class="timeline-body"><p>For posterity: this can be fixed with a simple <code>cargo clean</code></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:59:33 UTC
    </footer>
</body>
</html>
