```yaml
number: 429
title: Clarify documentation regarding AppSettings and child subcommand propagation
type: issue
state: closed
author: andresv
labels:
  - C-enhancement
  - A-docs
assignees: []
created_at: 2016-02-18T20:28:05Z
updated_at: 2018-08-02T03:29:48Z
url: https://github.com/clap-rs/clap/issues/429
synced_at: 2026-01-10T01:57:40Z
```

# Clarify documentation regarding AppSettings and child subcommand propagation

---

_Issue opened by @andresv on 2016-02-18 20:28_

Clap 2.1.0

Example code is here (i have not yet pushed minor tweaks needed for clap 2.x, but overall concept is the same): https://github.com/cubehub/doppler/blob/master/src/usage.rs#L153.

If negative number like `-6400` is given to `--shift`, i get this:

```
> cat ~/Downloads/rtl_fm_i16_raw_48k_145864_2.iq | ./target/debug/doppler const -i i16 -o i16 -s 48000 --shift -6400 > ~/Downloads/shifted.iq
error: Found argument '-6' which wasn't expected, or isn't valid in this context
```


---

_Renamed from "Cannot give negative number as argument value" to "Cannot take negative number as argument value" by @andresv on 2016-02-18 21:20_

---

_Comment by @Vinatorul on 2016-02-19 07:46_

Thank you for example. I am not sure, but I think negative arguments should be passed in quotes. Let's wait for the @kbknapp answer.


---

_Label `T: RFC / question` added by @Vinatorul on 2016-02-19 07:47_

---

_Comment by @andresv on 2016-02-19 07:48_

I tried with quotes, still no go.


---

_Label `T: bug` added by @Vinatorul on 2016-02-19 08:19_

---

_Label `C: args` added by @Vinatorul on 2016-02-19 08:19_

---

_Label `T: RFC / question` removed by @Vinatorul on 2016-02-19 08:19_

---

_Comment by @kbknapp on 2016-02-19 08:21_

You have to use the [`AppSettings::AllowLeadingHyphen`](http://kbknapp.github.io/clap-rs/clap/enum.AppSettings.html). 

I'll leave this open until you can confirm that's working for you. :wink:


---

_Label `T: RFC / question` added by @kbknapp on 2016-02-19 08:22_

---

_Label `C: args` removed by @kbknapp on 2016-02-19 08:22_

---

_Label `T: bug` removed by @kbknapp on 2016-02-19 08:22_

---

_Comment by @andresv on 2016-02-19 08:30_

Basically tried with that:

``` Rust
let matches = App::new("doppler")
            .setting(AppSettings::AllowLeadingHyphen)
            .version(env!("CARGO_PKG_VERSION"))
            .about("Compensates IQ data stream doppler shift based on TLE information, also can be used for doing constant baseband shifting")


            .subcommand(SubCommand::with_name("const")
                .about("Constant shift mode")
                .arg(Arg::with_name("SHIFT")
                   .long("shift")
                   .help("frequency shift in Hz")
                   .required(true)
                   .takes_value(true)))

            .get_matches();
```

And still got:

```
> cat ~/Downloads/rtl_fm_i16_raw_48k_145864_2.iq | ./target/debug/doppler const -i i16 -o i16 -s 48000 --shift -5700 > ~/Downloads/shifted.iq
error: Found argument '-5' which wasn't expected, or isn't valid in this context
```


---

_Comment by @Vinatorul on 2016-02-19 08:46_

You should specify setting for subcommand, because it is also an `App`, like this:

``` rust
let matches = App::new("doppler")
            .version(env!("CARGO_PKG_VERSION"))
            .about("Compensates IQ data stream doppler shift based on TLE information, also can be used for doing constant baseband shifting")
            .subcommand(SubCommand::with_name("const")
                .about("Constant shift mode")
                .setting(AppSettings::AllowLeadingHyphen)
                .arg(Arg::with_name("SHIFT")
                   .long("shift")
                   .help("frequency shift in Hz")
                   .required(true)
                   .takes_value(true)))

            .get_matches();
```


---

_Comment by @kbknapp on 2016-02-19 08:46_

Ah ok, that's because the `AppSettings` only apply to the current command, and are not propagated down through child subcommands. This should be cleared up in the docs.

Edit: Oops @Vinatorul beat me to it! :wink: 


---

_Label `T: enhancement` added by @kbknapp on 2016-02-19 08:47_

---

_Label `P4: nice to have` added by @kbknapp on 2016-02-19 08:47_

---

_Label `C: docs` added by @kbknapp on 2016-02-19 08:47_

---

_Label `D: easy` added by @kbknapp on 2016-02-19 08:47_

---

_Label `W: 2.x` added by @kbknapp on 2016-02-19 08:47_

---

_Label `T: RFC / question` removed by @kbknapp on 2016-02-19 08:47_

---

_Comment by @andresv on 2016-02-19 08:49_

Very good now it works. I guess I can close it.


---

_Closed by @andresv on 2016-02-19 08:49_

---

_Comment by @Vinatorul on 2016-02-19 08:51_

@andresv thank you for response. I think it will be reclassified as documentation issue. 
Negative values and subcomands are not clear enough


---

_Reopened by @Vinatorul on 2016-02-19 08:51_

---

_Renamed from "Cannot take negative number as argument value" to "Clarify documentation regarding AppSettings and child subcommand propagation" by @kbknapp on 2016-02-19 08:52_

---

_Referenced in [clap-rs/clap#425](../../clap-rs/clap/pulls/425.md) on 2016-02-19 09:18_

---

_Closed by @homu on 2016-02-19 13:53_

---
