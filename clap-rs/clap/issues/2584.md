```yaml
number: 2584
title: derive(ArgEnum) should be distinct from derive(Clap)
type: issue
state: closed
author: epage
labels:
  - C-bug
  - A-derive
assignees: []
created_at: 2021-07-14T15:29:41Z
updated_at: 2021-07-14T17:01:31Z
url: https://github.com/clap-rs/clap/issues/2584
synced_at: 2026-01-10T01:57:45Z
```

# derive(ArgEnum) should be distinct from derive(Clap)

---

_Issue opened by @epage on 2021-07-14 15:29_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Rust Version

rustc 1.53.0 (53cb7b09b 2021-06-17)

### Clap Version

3be79b9e1bc0e90b12185a219f4418540b975359

### Minimal reproducible code

Naively just using the "magic" struct
```rust
#[derive(clap::Clap)]
enum Level {
  Info,
  Warn,
  Error,
}
```

Intentionally creating subcommand
```rust
#[derive(clap::Clap)]
enum Action {
  Add,
  Remove,
}
```

### Steps to reproduce the bug with the above code

Can use arg in wrong case
```rust
#[derive(clap::Clap)]
struct Args {
  #[clap(subcommand)]
  level: Level,
}
```

Can use subcommand in wrong case
```rust
#[derive(clap::Clap)]
struct Args {
    #[clap(arg_enum)]
    action: Action,
}
```

### Actual Behaviour

API can be used in the wrong way

### Expected Behaviour

Compile errors

### Additional Context

This is split out of #2005, see
- https://github.com/clap-rs/clap/issues/2005#issuecomment-879499659 
- https://github.com/clap-rs/clap/issues/2005#issuecomment-879748536

### Debug Output

_No response_

---

_Label `T: bug` added by @epage on 2021-07-14 15:29_

---

_Added to milestone `3.0` by @pksunkara on 2021-07-14 15:51_

---

_Label `C: derive macros` added by @pksunkara on 2021-07-14 15:51_

---

_Referenced in [clap-rs/clap#2585](../../clap-rs/clap/pulls/2585.md) on 2021-07-14 15:53_

---

_Closed by @pksunkara on 2021-07-14 17:01_

---
