<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order of arguments looks wrong when using AllowMissingPositional - clap-rs/clap #1737</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Order of arguments looks wrong when using AllowMissingPositional</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1737">#1737</a>
        opened by <a href="https://github.com/jgilchrist">@jgilchrist</a>
        on 2020-03-09 23:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jgilchrist">@jgilchrist</a></div>
            <div class="timeline-body">

Rust Version
<pre><code>rustc 1.41.1 (f3e1a954d 2020-02-24)
</code></pre>
Code
<pre><code>use clap::{App, Arg};

fn main() {
    let args: Vec&lt;String&gt; = std::env::args_os()
        .map(|x| x.into_string().expect(&quot;Invalid argument&quot;))
        .collect();

    let args_as_str: Vec&lt;&amp;str&gt; = args.iter()
        .map(AsRef::as_ref)
        .collect();

    let clap_app = App::new(&quot;&quot;)
        .setting(clap::AppSettings::AllowMissingPositional)
        .arg(
            Arg::with_name(&quot;first&quot;)
                .required(false)
                .default_value(&quot;default&quot;)
                .index(1),
        )
        .arg(
            Arg::with_name(&quot;second&quot;)
                .required(true)
                .index(2),
        );

    let matches = clap_app.get_matches_from(args);
}
</code></pre>
Steps to reproduce the issue
<p>Run <code>cargo run -- --help</code></p>
Affected Version of <code>clap*</code>
<pre><code>2.33.0
</code></pre>
<p>Also tested with <code>3.0.0-beta.1</code> which has the same behaviour.</p>
Actual Behavior Summary
<p>The indexes for parameters <code>first</code> and <code>second</code> specify that <code>first</code> should come first, then <code>second</code>. <code>first</code> is optional (using <code>AllowMissingPositional</code>). However, the usage shows <code>second</code> first, then <code>first</code>:</p>
<pre><code>USAGE:
    httpx &lt;second&gt; [first]

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;first&gt;      [default: default]
    &lt;second&gt;    
</code></pre>
Expected Behavior Summary
<pre><code>USAGE:
    httpx [first] &lt;second&gt;

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;first&gt;      [default: default]
    &lt;second&gt;    
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by <a href="https://github.com/jgilchrist">@jgilchrist</a> on 2020-03-09 23:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-10 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;3.1&quot; by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-09 08:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>ridhoq/af#2</a> on 2021-02-08 06:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2648</a> on 2021-07-31 00:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-07-31 06:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:57:40 UTC
    </footer>
</body>
</html>
