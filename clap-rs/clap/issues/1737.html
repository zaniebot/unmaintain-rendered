<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order of arguments looks wrong when using AllowMissingPositional - clap-rs/clap #1737</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Order of arguments looks wrong when using AllowMissingPositional</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1737">#1737</a>
        opened by <a href="https://github.com/jgilchrist">@jgilchrist</a>
        on 2020-03-09 23:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jgilchrist">@jgilchrist</a> on 2020-03-09 23:42</div>
            <div class="timeline-body"><!--
Please use the following template to assist with creating an issue and to ensure a speedy resolution. If an area is not applicable, feel free to delete the area or mark with `N/A`
-->

<h3>Rust Version</h3>
<pre><code>rustc 1.41.1 (f3e1a954d 2020-02-24)
</code></pre>
<h3>Code</h3>
<pre><code class="language-rust">use clap::{App, Arg};

fn main() {
    let args: Vec&lt;String&gt; = std::env::args_os()
        .map(|x| x.into_string().expect(&quot;Invalid argument&quot;))
        .collect();

    let args_as_str: Vec&lt;&amp;str&gt; = args.iter()
        .map(AsRef::as_ref)
        .collect();

    let clap_app = App::new(&quot;&quot;)
        .setting(clap::AppSettings::AllowMissingPositional)
        .arg(
            Arg::with_name(&quot;first&quot;)
                .required(false)
                .default_value(&quot;default&quot;)
                .index(1),
        )
        .arg(
            Arg::with_name(&quot;second&quot;)
                .required(true)
                .index(2),
        );

    let matches = clap_app.get_matches_from(args);
}
</code></pre>
<h3>Steps to reproduce the issue</h3>
<p>Run <code>cargo run -- --help</code></p>
<h3>Affected Version of <code>clap*</code></h3>
<pre><code>2.33.0
</code></pre>
<p>Also tested with <code>3.0.0-beta.1</code> which has the same behaviour.</p>
<h3>Actual Behavior Summary</h3>
<p>The indexes for parameters <code>first</code> and <code>second</code> specify that <code>first</code> should come first, then <code>second</code>. <code>first</code> is optional (using <code>AllowMissingPositional</code>). However, the usage shows <code>second</code> first, then <code>first</code>:</p>
<pre><code class="language-sh">USAGE:
    httpx &lt;second&gt; [first]

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;first&gt;      [default: default]
    &lt;second&gt;    
</code></pre>
<h3>Expected Behavior Summary</h3>
<pre><code class="language-sh">USAGE:
    httpx [first] &lt;second&gt;

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;first&gt;      [default: default]
    &lt;second&gt;    
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @jgilchrist on 2020-03-09 23:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by @CreepySkeleton on 2020-03-10 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.1" by @pksunkara on 2020-04-09 08:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../ridhoq/af/pulls/2.html">ridhoq/af#2</a> on 2021-02-08 06:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2648.html">clap-rs/clap#2648</a> on 2021-07-31 00:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-07-31 06:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:08 UTC
    </footer>
</body>
</html>
