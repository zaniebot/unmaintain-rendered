<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Don't collapse optional positional arguments into `[ARGS]` in the usage string - clap-rs/clap #769</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Don&#x27;t collapse optional positional arguments into <code>[ARGS]</code> in the usage string</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/769">#769</a>
        opened by <a href="https://github.com/dotdash">@dotdash</a>
        on 2016-12-07 14:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dotdash">@dotdash</a></div>
            <div class="timeline-body">Rust Version
<p>rustc 1.15.0-nightly (daf8c1dfc 2016-12-05)</p>
Affected Version of clap
<p>2.19.1</p>
Expected Behavior Summary
<p>If I have one required and two optional positional arguments, I expect the usage string to say:</p>
<pre><code>USAGE:
    clap-test &lt;FILE&gt; [&lt;WIDTH&gt; [&lt;HEIGHT&gt;]]
</code></pre>
<p>to properly represent the order in which the arguments need to be given.</p>
Actual Behavior Summary
<p>The optional positional arguments are collapsed into a single <code>[ARGS]</code> placeholder, and I have to look at the <code>ARGS</code> block and know it tells me the required order.</p>
<pre><code>USAGE:
    clap-test &lt;FILE&gt; [ARGS]

FLAGS:
        --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;FILE&gt;      the configuration file
    &lt;WIDTH&gt;     texture width [default: 512]
    &lt;HEIGHT&gt;    texture height [default: 512]
</code></pre>
Steps to Reproduce the issue
<p>Run the program with <code>--help</code>.</p>
Sample Code or Link to Sample Code
<pre><code>extern crate clap;
use clap::{Arg, App};

fn main() {
    let matches = App::new(&quot;My  app&quot;)
        .version(&quot;0.1&quot;)
        .author(&quot;Me &lt;me@ma.il&gt;&quot;)
        .about(&quot;Does stuff&quot;)
        .arg(Arg::with_name(&quot;config&quot;)
             .value_name(&quot;FILE&quot;)
             .help(&quot;the configuration file&quot;)
             .required(true)
             .takes_value(true)
             .index(1))
        .arg(Arg::with_name(&quot;width&quot;)
             .value_name(&quot;WIDTH&quot;)
             .help(&quot;texture width&quot;)
             .takes_value(true)
             .default_value(&quot;512&quot;)
             .index(2))
        .arg(Arg::with_name(&quot;height&quot;)
             .value_name(&quot;HEIGHT&quot;)
             .help(&quot;texture height&quot;)
             .takes_value(true)
             .default_value(&quot;512&quot;)
             .index(3))
        .get_matches();
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-07 20:01</div>
            <div class="timeline-body"><p>I do agree, but at the same time I worry about applications that have lots of positional arguments. I&#x27;d like to get some others opinions on this issue before merging.</p>
<p>One point I&#x27;d like to change from your proposal though is the <code>$ prog &lt;required&gt; [&lt;optional1&gt; &lt;optional2&gt;]</code></p>
<p>I&#x27;d prefer that go to <code>$ prog &lt;required&gt; [optional1] [optional2]</code>. This is personal preference but I dislike the CLIs that give me a usage strings like <code>$ prog &lt;opt&gt; [[&lt;req&gt;|[-e &lt;some&gt;]] | [other]]</code> It gests difficult to parse (mentally) very quickly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-07 20:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dotdash">@dotdash</a> on 2016-12-08 11:00</div>
            <div class="timeline-body"><p>Oh, I meant to mention that I&#x27;d be fine with not nesting the square brackets. Not sure what the best option is for handling lots of optional positional arguments, but the same problem already exists for required positional arguments, so a common solution would be nice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-08 14:51</div>
            <div class="timeline-body"><p>So we already don&#x27;t collapse them down if it&#x27;s only 2 positional arguments (I believe...I can&#x27;t remember :stuck_out_tongue_winking_eye: ). So it&#x27;s entirely possible that we only collapse them after only after a [higher] certain number (perhaps up the number to...5?).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dotdash">@dotdash</a> on 2016-12-09 09:43</div>
            <div class="timeline-body"><p>They&#x27;re collapsed to [ARGS] if there are two or more. I guess I could live with collapsing only if there are more than X items, or even just an option that allows me to just disable it altogether.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-09 14:39</div>
            <div class="timeline-body"><p>Adding an option to just disable the collapsing is easy, and I think the route I&#x27;ll go since that won&#x27;t mess with current usage strings (i.e. it&#x27;s an opt-in feature).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;2.20.0&quot; by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: help message</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P4: nice to have</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> removed by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-10 04:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new setting</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-31 02:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> removed by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-31 02:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/kbknapp">@kbknapp</a> by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-12-31 02:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/homu">@homu</a> on 2016-12-31 06:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#4151</a> on 2022-08-30 21:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:56:40 UTC
    </footer>
</body>
</html>
