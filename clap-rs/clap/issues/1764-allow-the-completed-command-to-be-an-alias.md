```yaml
number: 1764
title: Allow the completed command to be an alias
type: issue
state: open
author: d-e-s-o
labels:
  - C-enhancement
  - E-medium
  - A-completion
assignees: []
created_at: 2020-03-26T21:05:00Z
updated_at: 2021-12-09T21:15:06Z
url: https://github.com/clap-rs/clap/issues/1764
synced_at: 2026-01-12T16:14:11Z
```

# Allow the completed command to be an alias

---

_@d-e-s-o_

It would be great if the shell completion was more flexible in what commands it applies to. Let's say I have a program `foo` and a completion script `foo.bash` as generated by `clap`. If I source `foo.bash` I now have completion for `foo`'s arguments. Fine.

However, what if I have aliased `f` to `foo`? Naturally, I'd want to have completion for `f` as well. Usually that's not a problem. The completion script just registers the completion functionality for a certain command. E.g.,
```bash
complete -F _foo -o bashdefault -o default foo
```
can be found in `foo.bash`.

Unfortunately, though, just changing that to
```bash
complete -F _foo -o bashdefault -o default f
```
doesn't work, because, well, the script itself has the command/name coded into its logic.

That doesn't have to be the case, however, as [`git`](https://github.com/git/git/blob/master/contrib/completion/git-completion.bash) for example shows. Here all I have to do is register my alias as follows:
```bash
__git_complete g __git_main
```
and bam, `g` has completion.

Would be great to have such a more flexible completion script.

---

_Label `T: new feature` added by @d-e-s-o on 2020-03-26 21:05_

---

_Comment by @pksunkara on 2020-03-26 21:09_

We are always open to PRs. I am not exactly good at the completion scripts. I couldn't even get zsh running locally ðŸ˜ž 

---

_Comment by @d-e-s-o on 2020-03-26 21:23_

My bash completion days are also behind me (and I happily flushed 90% I knew from memory). That being said, this patch seems to be doing the trick:
```patch
--- src/completions/bash.rs
+++ src/completions/bash.rs
@@ -33,8 +33,8 @@ impl<'a, 'b> BashGen<'a, 'b> {
     for i in ${{COMP_WORDS[@]}}
     do
         case "${{i}}" in
-            {name})
-                cmd="{name}"
+            "${{1}}")
+                cmd="${{1}}"
                 ;;
             {subcmds}
             *)
@@ -43,7 +43,7 @@ impl<'a, 'b> BashGen<'a, 'b> {
     done

     case "${{cmd}}" in
-        {name})
+        "${{1}}")
             opts="{name_opts}"
             if [[ ${{cur}} == -* || ${{COMP_CWORD}} -eq 1 ]] ; then
                 COMPREPLY=( $(compgen -W "${{opts}}" -- "${{cur}}") )
```

I'll probably open a PR unless I find an issue...

---

_Referenced in [clap-rs/clap#1765](../../clap-rs/clap/pulls/1765.md) on 2020-03-26 21:53_

---

_Comment by @pickfire on 2020-04-04 03:32_

I believe this is fixed.

---

_Comment by @d-e-s-o on 2020-04-04 15:11_

> I believe this is fixed.

Mind sharing details as to why you believe that to be the case?

---

_Comment by @pksunkara on 2020-04-04 15:27_

@pickfire How is this fixed?

---

_Referenced in [d-e-s-o/nitrocli#107](../../d-e-s-o/nitrocli/pulls/107.md) on 2020-04-05 06:24_

---

_Comment by @pickfire on 2020-04-05 14:16_

Because there was a pull request for it? Ah, I didn't notice it was closed instead of merged.

---

_Comment by @pksunkara on 2020-04-05 16:40_

And it was closed without merging because it didn't actually fix the issue.

---

_Added to milestone `3.1` by @pksunkara on 2020-04-05 16:41_

---

_Label `C: generator` added by @pksunkara on 2020-04-09 08:31_

---

_Referenced in [clap-rs/clap#1898](../../clap-rs/clap/issues/1898.md) on 2020-05-03 07:02_

---

_Referenced in [clap-rs/clap#3022](../../clap-rs/clap/issues/3022.md) on 2021-11-14 01:52_

---

_Referenced in [clap-rs/clap#1232](../../clap-rs/clap/issues/1232.md) on 2021-11-15 14:31_

---

_Referenced in [epage/clapng#92](../../epage/clapng/issues/92.md) on 2021-12-06 17:34_

---

_Referenced in [epage/clapng#146](../../epage/clapng/issues/146.md) on 2021-12-06 19:14_

---

_Referenced in [epage/clapng#238](../../epage/clapng/issues/238.md) on 2021-12-06 22:24_

---

_Label `T: new feature` removed by @epage on 2021-12-08 21:13_

---

_Label `C-enhancement` added by @epage on 2021-12-08 21:13_

---

_Renamed from "More flexible shell completion" to "Allow the completed command to be an alias" by @epage on 2021-12-09 21:14_

---

_Label `E-medium` added by @epage on 2021-12-09 21:15_

---

_Removed from milestone `3.1` by @epage on 2021-12-09 21:15_

---

_Referenced in [clap-rs/clap#3166](../../clap-rs/clap/issues/3166.md) on 2021-12-13 17:55_

---
