```yaml
number: 3847
title: A feature to make assertions unconditional
type: issue
state: closed
author: stepancheg
labels:
  - C-enhancement
assignees: []
created_at: 2022-06-17T00:32:20Z
updated_at: 2022-06-17T12:27:33Z
url: https://github.com/clap-rs/clap/issues/3847
synced_at: 2026-01-10T01:57:47Z
```

# A feature to make assertions unconditional

---

_Issue opened by @stepancheg on 2022-06-17 00:32_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Clap Version

3.1.8

### Describe your use case

Currently, `ArgMatches` with subcommands is fragile: when requesting indices of non-existing flag, no error is produced in release mode. This is inconvenient when working with complex clap setup: typo in flag name or missing `.subcommand` call results in `ArgMatches` returning empty indices.

Panic is sometimes more convenient when test coverage is less than 100%.

### Describe the solution you'd like

Enabled assertions when any of this is true:
* `cfg(debug_assertions)`
* `cfg(feature = assertions)`

### Alternatives, if applicable

_No response_

### Additional Context

_No response_

---

_Label `C-enhancement` added by @stepancheg on 2022-06-17 00:32_

---

_Comment by @epage on 2022-06-17 12:27_

I'm assuming this is split out of #3845 as an alternative idea.

Like with that issue, I lean towards rejecting this.  We are working to trim the API surface of clap and we need to weigh out the benefit (across all users) against another thing to have listed in our documentation.  We recently added the `deprecated` feature but that was only after feedback from a lot of users over a period of time and it fitting into our wider API evolution strategy

---

_Closed by @epage on 2022-06-17 12:27_

---
