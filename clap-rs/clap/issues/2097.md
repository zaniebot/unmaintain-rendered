```yaml
number: 2097
title: "Error trait not implemented for clap::Error"
type: issue
state: closed
author: jzrake
labels:
  - C-bug
assignees: []
created_at: 2020-08-22T19:34:22Z
updated_at: 2020-08-29T15:58:56Z
url: https://github.com/clap-rs/clap/issues/2097
synced_at: 2026-01-10T01:57:44Z
```

# Error trait not implemented for clap::Error

---

_Issue opened by @jzrake on 2020-08-22 19:34_

### Description
Function should return a result with a generic error, `Result<(), Box<dyn std::error::Error>>`. Even though Clap seems to implement the `std::error::Error` trait, the following fails to compile:

### Code

```rust
use clap::Clap;

fn main() {
    #[derive(Clap)]
    struct Opts {}

    let _result: Box<dyn std::error::Error> = Box::new(Opts::try_parse().err().unwrap());
}
```

Compiling fails with:
```
the trait `std::error::Error` is not implemented for `clap::parse::errors::Error`
```

### Version

* **Rust**: 1.45.2
* **Clap**: 3.0.0-beta.1


---

_Label `T: bug` added by @jzrake on 2020-08-22 19:34_

---

_Comment by @pksunkara on 2020-08-23 04:54_

Yeah, we removed in 3.0.0-beta.1. @CreepySkeleton What do you think about this?

---

_Added to milestone `3.0` by @pksunkara on 2020-08-23 04:54_

---

_Label `C: errors` added by @pksunkara on 2020-08-23 04:54_

---

_Comment by @CreepySkeleton on 2020-08-23 05:49_

I have nothing against, but let's wait until Refactor is landed (rebasing it is kinda painful process). 

(It's literally one line by the way).

---

_Referenced in [clap-rs/clap#2116](../../clap-rs/clap/pulls/2116.md) on 2020-08-28 17:59_

---

_Closed by @bors[bot] on 2020-08-29 08:49_

---

_Comment by @CreepySkeleton on 2020-08-29 14:06_

> Function should return a result with a generic error, Result<(), Box<dyn std::error::Error>>. 

It really shouldn't. As long as the Err type implements `std:;error::Error`, the snippet above should compile just fine (and it does). @jzrake I'm curious what led you to think that the return type should necessarily be boxed?  

---

_Comment by @jzrake on 2020-08-29 14:11_

Right, good question. I had a function that could fail with a different category of error, in addition to a Clap error. I intended to handle this by erasing the error type. However I am new to Rust -- is there is a more idiomatic way to solve that situation?

---

_Comment by @pksunkara on 2020-08-29 14:18_

You should look into crates called thiserror and anyhow. Also read some
blog articles about these crates and how they are used.

On Sat, Aug 29, 2020, 16:11 jzrake <notifications@github.com> wrote:

> Right, good question. I had a function that could fail with a different
> category of error, in addition to a Clap error. I intended to handle this
> by erasing the error type. However I am new to Rust -- is there is a more
> idiomatic way to solve that situation?
>
> â€”
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/clap-rs/clap/issues/2097#issuecomment-683295986>, or
> unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AABKU32WY5LPFIMZQGCZDT3SDEEBNANCNFSM4QIH7S2A>
> .
>


---

_Comment by @CreepySkeleton on 2020-08-29 15:58_

I recommend [this arcticle](http://www.sheshbabu.com/posts/rust-error-handling/) for a beginner. The "Applications vs Libraries" section explains why exactly we have a custom error type, not `Box`.

---
