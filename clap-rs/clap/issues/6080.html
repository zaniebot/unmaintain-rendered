<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ignore empty arguments split by `value_delimiter` - clap-rs/clap #6080</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ignore empty arguments split by <code>value_delimiter</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/6080">#6080</a>
        opened by <a href="https://github.com/Andrew15-5">@Andrew15-5</a>
        on 2025-07-29 08:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Andrew15-5">@Andrew15-5</a></div>
            <div class="timeline-body">Please complete the following tasks
<ul>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
Clap Version
<p>master</p>
Describe your use case
<p>Additionally to <a href="https://github.com/clap-rs/clap/issues/6079">clap-rs/clap#6079</a>, the cargo <code>--features</code> parser eliminates empty arguments that were produced by splitting, therefore not causing an error for, e.g., <code>--features a,b,</code>. If this can be done declaratively with clap (and <a href="https://github.com/clap-rs/clap/issues/6079">clap-rs/clap#6079</a>), then cargo can remove the custom parser and use a built-in solution. This also can be used by any other CLI, including <code>dx</code>, to offer a very flexible and friendly way to pass multiple arguments to the same flag.</p>
Describe the solution you&#x27;d like
<p>Something like <code>ignore_empty_delimited_values(true)</code>. It probably should only apply to <code>Vec&lt;_&gt;</code> flags. Not sure how useful it would be for <code>Option&lt;_&gt;</code> ones (<code>--flag &#x27;&#x27;</code>).</p>
Alternatives, if applicable
<p>Using custom parser, like <code>cargo</code> does.</p>
Additional Context
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by <a href="https://github.com/Andrew15-5">@Andrew15-5</a> on 2025-07-29 08:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-decision</span> added by <a href="https://github.com/epage">@epage</a> on 2025-07-29 19:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-parsing</span> added by <a href="https://github.com/epage">@epage</a> on 2025-07-29 19:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-07-29 19:05</div>
            <div class="timeline-body"><p>This can be worked around on the callers side by ignoring empty strings.</p>
<p>What I&#x27;m unsure of is there is enough gain over the workaround to outweigh the costs</p>
<ul>
<li>Binary size</li>
<li>Build times</li>
<li>API size (the more that exists in the API, the harder it is to find things, the less people use anything in the API including the new feature, the less value gained by these features)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Andrew15-5">@Andrew15-5</a> on 2025-07-29 19:33</div>
            <div class="timeline-body"><p>Wait, what? I thought clap errors on empty argument. Is this only true for custom types and not <code>String</code>? In <code>Vec&lt;_&gt;</code>.</p>
<p>That was half of why I thought it would be nice to have. The other half is that cargo could use this. And by eliminating this and <a href="https://github.com/clap-rs/clap/issues/6079">clap-rs/clap#6079</a>, it can remove the custom parser.</p>
<p>I personally never really thought of having a delimiter to the end of an argument. And to make it not error. But cargo does this for <em>some</em> reason, right? If there is no good reason, then I guess there is not really enough demand/reasoning for having this feature in clap, and https://github.com/rust-lang/cargo/blob/37eeab7c165aaccc7c70dfdf2bbd239cbd2b7269/src/bin/cargo/commands/add.rs?plain=1#L416 should be removed or made into a hard error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-07-29 20:19</div>
            <div class="timeline-body"><blockquote>
<p>Wait, what? I thought clap errors on empty argument. Is this only true for custom types and not String? In Vec&lt;_&gt;.</p>
</blockquote>
<p>It accepts them, see https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2024&amp;gist=ed97e604a1b30e7af53eae904a84bd1f</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Andrew15-5">@Andrew15-5</a> on 2025-07-30 10:17</div>
            <div class="timeline-body"><p>TIL</p>
<blockquote>
<p>API size (the more that exists in the API, the harder it is to find things, the less people use anything in the API including the new feature, the less value gained by these features)</p>
</blockquote>
<p>I don&#x27;t think this is how it works. If a library can do things, then there is almost no reason not to use it. Although my only gripe was that clap&#x27;s docs, at least for derived stuff, was very confusing, and I often got lost in it. This was like 1 or 2 years ago. I don&#x27;t use it enough to know how it has changed. But now I know roughly how things work, so it&#x27;s much easier to search for specific features/API.</p>
<blockquote>
<p>Binary size</p>
</blockquote>
<p>Weeell... It looks like with derive clap it&#x27;s exactly 1 MiB, without derive it&#x27;s about 1000 KiB. But without clap it&#x27;s almost 0.5 MiB, so for zero-config binaries you still ain&#x27;t getting anywhere close to sub 100 KiB or whatever. I think binary size is not an issue, since it is drastically increased by many or even few other dependencies. For example, Typst is just shy of 40 MiB, while <code>dx</code> is 84 MiB for me.</p>
<blockquote>
<p>Build times</p>
</blockquote>
<p>This can be true, it does take about 4 s on my machine. But it is probably not that noticeable if you still use any alternative to clap. I assume it would be something like 2 s vs. 4 s, or 3 vs. 4. Not sure if this will add 0.1 s, or less, or more.</p>
<p>With that said, I don&#x27;t know how many CLIs will actually want to use this, so it might still be a niche feature.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-07-31 15:22</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>API size (the more that exists in the API, the harder it is to find things, the less people use anything in the API including the new feature, the less value gained by these features)</p>
</blockquote>
<p>I don&#x27;t think this is how it works. If a library can do things, then there is almost no reason not to use it.</p>
</blockquote>
<p>Yes, it is; I&#x27;m speaking from the experience of supporting users. The key word is &quot;find&quot;. People have to assume a feature exists and the right terms to find them to use it.</p>
<blockquote>
<blockquote>
<p>Binary size</p>
</blockquote>
<p>Weeell... It looks like with derive clap it&#x27;s exactly 1 MiB, without derive it&#x27;s about 1000 KiB. But without clap it&#x27;s almost 0.5 MiB, so for zero-config binaries you still ain&#x27;t getting anywhere close to sub 100 KiB or whatever. I think binary size is not an issue, since it is drastically increased by many or even few other dependencies. For example, Typst is just shy of 40 MiB, while <code>dx</code> is 84 MiB for me.</p>
<blockquote>
<p>Build times</p>
</blockquote>
<p>This can be true, it does take about 4 s on my machine. But it is probably not that noticeable if you still use any alternative to clap. I assume it would be something like 2 s vs. 4 s, or 3 vs. 4. Not sure if this will add 0.1 s, or less, or more.</p>
<p>With that said, I don&#x27;t know how many CLIs will actually want to use this, so it might still be a niche feature.</p>
</blockquote>
<p>I&#x27;m not speaking of the impact of any one feature but the impact if we add every feature people ask for. We have to weigh the benefit to the users who want the feature against the costs to all users.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Andrew15-5">@Andrew15-5</a> on 2025-08-01 13:51</div>
            <div class="timeline-body"><p>I assume we have to wait for a third party/others to give an opinion.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 20:00:35 UTC
    </footer>
</body>
</html>
