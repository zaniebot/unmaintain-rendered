```yaml
number: 3146
title: Support multiple arguments writing to the same destination
type: issue
state: open
author: epage
labels:
  - C-enhancement
  - A-builder
  - A-parsing
  - A-validators
  - S-experimental
assignees: []
created_at: 2021-12-10T21:34:56Z
updated_at: 2023-06-30T13:03:58Z
url: https://github.com/clap-rs/clap/issues/3146
synced_at: 2026-01-10T01:57:46Z
```

# Support multiple arguments writing to the same destination

---

_Issue opened by @epage on 2021-12-10 21:34_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Clap Version

3.0.0-rc.0

### Describe your use case

Related issues
- #1820
- #815

### Describe the solution you'd like

In Python's `argparse`, you can assign the `dest` (for us, `name`) for an argument in the `Namespace` (for us, `ArgMatches`).  This gives a lot of power.  One example is #1820 with migrating flags.  The thing I used this most frequently for was negations (#815).

The code would look something like
```rust
parser.add_argument("--flag", dest="flag", action="store_true")
parser.add_argument("--no-flag", dest="flag", action="store_false")
... some line about setting the default
```

This makes it easy to define and handle and gives good semantics (last writer wins)

For now, I'm doing stuff like
```rust
fn resolve_bool_arg(yes: bool, no: bool) -> Option<bool> {
    match (yes, no) {
        (true, false) => Some(true),
        (false, true) => Some(false),
        (false, false) => None,
        (_, _) => unreachable!("StructOpt should make this impossible"),
    }
}
```
https://github.com/epage/git-stack/blob/main/src/bin/git-stack/args.rs#L105

and haven't played with `overrides_with` to see what a last-writer-wins would look like with clap.

### Alternatives, if applicable

_No response_

### Additional Context

See #1820 which has several concerns over doing this.  I especially expect problems with
- Interaction with `global(true)`
- Validation rules (they have to be aware of and operate on the dest)
- Derives reading the right dest
- Derives dealing with multiple "arguments" pointing to the same dest

See #3119 for more use cases

---

_Label `C-enhancement` added by @epage on 2021-12-10 21:34_

---

_Label `A-builder` added by @epage on 2021-12-10 21:34_

---

_Label `A-parsing` added by @epage on 2021-12-10 21:34_

---

_Label `A-validators` added by @epage on 2021-12-10 21:34_

---

_Label `S-experimental` added by @epage on 2021-12-10 21:34_

---

_Referenced in [clap-rs/clap#1820](../../clap-rs/clap/issues/1820.md) on 2021-12-10 21:36_

---

_Referenced in [clap-rs/clap#3119](../../clap-rs/clap/issues/3119.md) on 2021-12-13 22:28_

---

_Referenced in [clap-rs/clap#3405](../../clap-rs/clap/issues/3405.md) on 2022-05-09 21:54_

---

_Comment by @tmccombs on 2022-06-27 08:34_

Is there a good workaround for this? I have a lot of options that are negatable (mostly using `no-` prefixed options), and it would be really nice to avoid having duplicate boolean fields for all of them that I have to check both of.

---

_Comment by @ducaale on 2022-06-27 08:47_

@tmccombs would a workaround like [this](https://github.com/clap-rs/clap/issues/815#issuecomment-1040848452) work for your use case?

---

_Comment by @tmccombs on 2022-06-28 06:45_

Maybe. In my case I only want these options for a few of the options, and in some cases I the man option starts with `--no-` and the negating option doesn't have the prefix (or in other words, the option without the `--no` prefix is the default). 

I'm also not really sure what the best way to do that when using the derive api would be.

---

_Comment by @epage on 2022-06-28 12:42_

@tmccombs if your interest is in negation flags, be sure to watch the more specific #815.  In it, I do bring up a more unusual [solution using ArgAction](https://github.com/clap-rs/clap/issues/815#issuecomment-1154205312) so there is room for solutions outside of this issue.

---

_Comment by @tmccombs on 2022-07-01 07:13_

Some other use cases for this:

- having an option that is a shortcut for passing a specific value to another option. For example `-1` as an alias for `--max-results=1`
- Allowing an argument to be passed either as a positional argument or an option
- Options that take the same value, but with different meanings. for example `--include` and `--exclude` might feed into a single list of filters, where relative order matters, and the difference is just which variant of an enum is used  (or maybe one type is prefixed with some delimiter like "!").

---

_Referenced in [neovide/neovide#1885](../../neovide/neovide/pulls/1885.md) on 2023-06-02 21:50_

---

_Referenced in [r0gue-io/pop-cli#361](../../r0gue-io/pop-cli/pulls/361.md) on 2024-12-06 09:14_

---

_Referenced in [clap-rs/clap#815](../../clap-rs/clap/issues/815.md) on 2025-09-16 18:43_

---
