<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Parsing unknown arguments - clap-rs/clap #1847</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Parsing unknown arguments</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1847">#1847</a>
        opened by <a href="https://github.com/elichai">@elichai</a>
        on 2020-04-21 09:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/elichai">@elichai</a></div>
            <div class="timeline-body"><p>Hi,
I&#x27;m writing a wrapper around another program, I have my own flags and inputs and the rest I want to pass through to the other program without knowing what are they.
I managed to do that using something like this:</p>
<pre><code>let app: App = ...;
let mut unknwon = Vec::new();
let matches = match app.clone().get_matches_safe() {
    Ok(matches) =&gt; matches,
    Err(e) =&gt; match e.kind {
        ErrorKind::UnknownArgument =&gt; {
            unknwon = e.info.unwrap();
            let commands: Vec&lt;Arg&gt; =
                unknwon.iter().map(|c| clap::Arg::from_usage(&amp;c)).collect();
            app.args(&amp;commands).get_matches()
        }
        _ =&gt; e.exit(),
    },
};
</code></pre>
<p>https://play.rust-lang.org/?gist=21efe2e89012e9b0583d3eb96d872ef8</p>
<p>It would be a lot nicer if I could get both the <code>ArgMatches</code> and the unknown arguments.<br>
Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by <a href="https://github.com/elichai">@elichai</a> on 2020-04-21 09:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-21 09:31</div>
            <div class="timeline-body"><p>The standard way to do that in Unix world is <code>-- external_args</code>. Take a look at <code>Arg::raw</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elichai">@elichai</a> on 2020-04-21 09:41</div>
            <div class="timeline-body"><p>Right. but I&#x27;m wrapping git, so it also has a <code>--</code>, and I want to have the same interface as <code>git-diff</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-21 09:48</div>
            <div class="timeline-body"><p>From git-diff man page:</p>
<pre><code>git diff [&lt;options&gt;] [&lt;commit&gt;] [--] [&lt;path&gt;…​]
git diff [&lt;options&gt;] --cached [&lt;commit&gt;] [--] [&lt;path&gt;…​]
git diff [&lt;options&gt;] &lt;commit&gt; &lt;commit&gt; [--] [&lt;path&gt;…​]
git diff [&lt;options&gt;] &lt;blob&gt; &lt;blob&gt;
git diff [&lt;options&gt;] --no-index [--] &lt;path&gt; &lt;path&gt;
</code></pre>
<p>You&#x27;d be having the same interface as <code>git-diff</code> with <code>--</code> if you use <code>Arg::raw</code>, right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elichai">@elichai</a> on 2020-04-21 09:52</div>
            <div class="timeline-body"><p>Raw is pretty cool, but I&#x27;m not sure if it solves my problem.</p>
<blockquote>
<p>You&#x27;d be having the same interface as <code>git-diff</code> with <code>--</code> if you use <code>Arg::raw</code>, right?</p>
</blockquote>
<p>yeah, so I want to be able to do <code>my-git HEAD HEAD^ --my-command -- file</code> for that I need to be able to parse <code>--my-command</code> but forward everything else into git-diff</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-21 10:05</div>
            <div class="timeline-body"><p>Then I believe <a href="https://docs.rs/clap/2.33.0/clap/enum.AppSettings.html#variant.AllowMissingPositional"><code>AppSettings::AllowMissingPositional</code></a> is what you are looking for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-21 10:06</div>
            <div class="timeline-body"><p>The only other way is to reimplement git&#x27; cli</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-28 10:09</div>
            <div class="timeline-body"><p>@elichai Have you found a solution?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elichai">@elichai</a> on 2020-04-28 10:24</div>
            <div class="timeline-body"><p>I&#x27;m using my original solution for now, but I might reimplement git-diff&#x27;s CLI arguments and flags.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-28 10:31</div>
            <div class="timeline-body"><p>Then I&#x27;m closing this because I don&#x27;t thin there&#x27;s any more left for us to do here. Good luck!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-04-28 10:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>drager/wasm-pack#851</a> on 2020-10-02 23:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:57:46 UTC
    </footer>
</body>
</html>
