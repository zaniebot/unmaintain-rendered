<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panic when Arg::requires_if contains an unknown argument - clap-rs/clap #929</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Panic when Arg::requires_if contains an unknown argument</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/929">#929</a>
        opened by <a href="https://github.com/RazrFalcon">@RazrFalcon</a>
        on 2017-04-11 15:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/RazrFalcon">@RazrFalcon</a> on 2017-04-11 15:54</div>
            <div class="timeline-body"><h3>Rust Version</h3>
<p>rustc 1.16.0 (30cf806ef 2017-03-10)</p>
<h3>Affected Version of clap</h3>
<p>clap 2.23.2</p>
<h3>Sample Code</h3>
<pre><code class="language-rust">extern crate clap;
use clap::{Arg, App};
fn main() {
    let m = App::new(&quot;test&quot;)
        .arg(Arg::with_name(&quot;test1&quot;)
            .long(&quot;test1&quot;)
            .requires_if(&quot;test2&quot;, &quot;value&quot;))
        .get_matches();
}
</code></pre>
<h3>Output</h3>
<pre><code>% cargo run -- --test1=q --test-args=q
   Compiling args v0.0.0 (file:///...)
    Finished dev [unoptimized + debuginfo] target(s) in 0.71 secs
     Running `target/debug/args --test1=q --test-args=q`
thread 'main' panicked at 'Fatal internal error. Please consider filing a bug report at https://github.com/kbknapp/clap-rs/issues', /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libcore/option.rs:715
stack backtrace:
   1:     0x564f207bee3c - std::sys::imp::backtrace::tracing::imp::write::hf33ae72d0baa11ed
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/sys/unix/backtrace/tracing/gcc_s.rs:42
   2:     0x564f207c13be - std::panicking::default_hook::{{closure}}::h59672b733cc6a455
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:351
   3:     0x564f207c0fc4 - std::panicking::default_hook::h1670459d2f3f8843
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:367
   4:     0x564f207c17fb - std::panicking::rust_panic_with_hook::hcf0ddb069e7beee7
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:555
   5:     0x564f207c1694 - std::panicking::begin_panic::hd6eb68e27bdf6140
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:517
   6:     0x564f207c15b9 - std::panicking::begin_panic_fmt::hfea5965948b877f8
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:501
   7:     0x564f207c1547 - rust_begin_unwind
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:477
   8:     0x564f207e8e1d - core::panicking::panic_fmt::hc0f6d7b2c300cdd9
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libcore/panicking.rs:69
   9:     0x564f207e8ead - core::option::expect_failed::h43c73e9bd7dbebbc
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libcore/option.rs:715
  10:     0x564f205860ea - &lt;core::option::Option&lt;T&gt;&gt;::expect::h474935a2057d9000
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libcore/option.rs:293
  11:     0x564f20790ea1 - clap::app::usage::get_required_usage_from::{{closure}}::h976429bcd63c354c
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/usage.rs:418
  12:     0x564f20579e40 - &lt;core::option::Option&lt;T&gt;&gt;::unwrap_or_else::hb293490079019918
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libcore/option.rs:358
  13:     0x564f2078fcbe - clap::app::usage::get_required_usage_from::he972597b8db0b059
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/usage.rs:415
  14:     0x564f2078c4d2 - clap::app::usage::create_smart_usage::h633df59a71bd565a
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/usage.rs:163
  15:     0x564f2078b073 - clap::app::usage::create_usage_no_title::h6bfd4766eab833c5
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/usage.rs:53
  16:     0x564f2078aab5 - clap::app::usage::create_usage_with_title::h2c19c8dbd10b61e7
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/usage.rs:17
  17:     0x564f2078ad56 - clap::app::usage::create_error_usage::habf9ad0011a53920
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/usage.rs:42
  18:     0x564f20757aaf - clap::app::parser::Parser::did_you_mean_error::hb7ea653c4b97d48a
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/parser.rs:1608
  19:     0x564f2074bb9e - clap::app::parser::Parser::parse_long_arg::h1317d3e6f872c643
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/parser.rs:1365
  20:     0x564f207386f9 - clap::app::parser::Parser::get_matches_with::h1b055c1455453a10
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/parser.rs:821
  21:     0x564f20791f8d - clap::app::App::get_matches_from_safe_borrow::hf758b949519b316a
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/mod.rs:1615
  22:     0x564f207914e1 - clap::app::App::get_matches_from::h5915e7c7dae2ed41
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/mod.rs:1500
  23:     0x564f207913e7 - clap::app::App::get_matches::h841c40b77359f10b
                        at /home/razr/.cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.23.2/src/app/mod.rs:1443
  24:     0x564f20550fee - args::main::h49dd4b29aab0116c
                        at /media/data/Programming/Projects/rust/args/src/main.rs:9
  25:     0x564f207c868a - __rust_maybe_catch_panic
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libpanic_unwind/lib.rs:98
  26:     0x564f207c1f66 - std::rt::lang_start::hd7c880a37a646e81
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panicking.rs:436
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/panic.rs:361
                        at /buildslave/rust-buildbot/slave/stable-dist-rustc-linux/build/src/libstd/rt.rs:57
  27:     0x564f20551102 - main
  28:     0x7f223c3af78f - __libc_start_main
  29:     0x564f20548338 - _start
  30:                0x0 - &lt;unknown&gt;
</code></pre>
<h3>Debug output</h3>
<p>The <code>debug</code> feature didn't change anything.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-04-18 00:41</div>
            <div class="timeline-body"><p>This is a known &quot;issue&quot; or rather by design, but I should add it to a <code># Panics</code> section in the docs for that method. Thanks! #604 is also relevant here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: docs</span> added by @kbknapp on 2017-04-18 00:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2017-04-18 00:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P2: need to have</span> added by @kbknapp on 2017-04-18 00:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by @kbknapp on 2017-04-18 00:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2017-04-18 00:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RazrFalcon">@RazrFalcon</a> on 2017-04-18 07:52</div>
            <div class="timeline-body"><p>I see.</p>
<p>It says <em>Please consider filing a bug report</em> so here I am.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-04-18 10:55</div>
            <div class="timeline-body"><p>Yep that's the default internal error message for any panic. In this case it worked too, because you filing the bug report reminded me to add a blurb in the docs and also switch from the default internal error message :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by @kbknapp on 2018-07-22 01:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> removed by @kbknapp on 2018-07-22 01:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v3-alpha.1" by @kbknapp on 2018-07-22 01:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">M: mentored</span> added by @kbknapp on 2018-07-22 01:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @kbknapp on 2018-07-22 01:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-07-22 01:36</div>
            <div class="timeline-body"><p>Relates to #604 and should either happen in debug builds via <code>debug_asserts</code> or behind a feature flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spwitt">@spwitt</a> on 2018-10-07 01:36</div>
            <div class="timeline-body"><p>@kbknapp I'm interested in working on this issue.</p>
<p>What exactly does the &quot;mentored&quot; label mean?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../TeXitoi/structopt/issues/255.html">TeXitoi/structopt#255</a> on 2019-09-09 14:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2019-09-09 21:55</div>
            <div class="timeline-body"><p>@Dylan-DPC It seems like it's replaced by another problem in <code>v3-master</code>. Snipped above works just fine, i.e. <code>clap</code> does not check that <code>test2</code> is a valid arg while it should</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "v3-alpha.2" by @pksunkara on 2020-02-01 07:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v3.0" by @pksunkara on 2020-02-01 07:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: asserts</span> added by @pksunkara on 2020-04-09 07:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @bors[bot] on 2020-04-10 02:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:07 UTC
    </footer>
</body>
</html>
