<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Testing with ArgMatches - clap-rs/clap #1616</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Testing with ArgMatches</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1616">#1616</a>
        opened by <a href="https://github.com/MichaelAquilina">@MichaelAquilina</a>
        on 2019-12-29 21:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaelAquilina">@MichaelAquilina</a></div>
            <div class="timeline-body">

Rust Version
<p>rustc 1.38.0</p>
Affected Version of clap
<p>2.33.0</p>
Expected Behavior Summary
<p>I want to write some tests for functions that take <code>ArgMatches</code> as input. However this currently does not seem possible due to the fact that you cannot access <code>MatchedArg</code> to construct them. There also does not seem to be a way of generating <code>ArgMatches</code> from custom inputs (e.g. a list of strings) with <code>get_matches()</code>.</p>
<p>I would expect to be able to do something like:</p>
<pre><code>let mut matches = ArgMatches::new();
matches.args[&quot;foo&quot;] = MatchedArg { occurs: 1, indices: [1], vals: [&quot;red&quot;] };

let result = my_function(&amp;matches);
</code></pre>
<p>Or alternatively something like</p>
<pre><code>let app = get_app_config();
let matches = app.get_matches(&amp;[&quot;--foo&quot;, &quot;bar&quot;, &quot;baz&quot;]);

let result = my_function(&amp;matches);
</code></pre>
<p>The first option could be easily solved by adding <code>MatchedArg</code> to the <code>pub use</code> line in lib.rs but I wanted to see what you all thought (perhaps there is already a solution to this that exists but is not documented)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Testing&quot; to &quot;Testing with ArgMatches&quot; by <a href="https://github.com/MichaelAquilina">@MichaelAquilina</a> on 2019-12-29 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: tests</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;3.0&quot; by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-01 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pickfire">@pickfire</a> on 2020-03-07 15:37</div>
            <div class="timeline-body"><p>Is <code>pub(crate)</code> useful for this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;3.0&quot; by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-09 08:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;3.1&quot; by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-09 08:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> removed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-09 08:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> removed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-09 08:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> removed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-04-09 08:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2290</a> on 2021-01-10 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2408</a> on 2021-03-11 13:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mgrachev">@mgrachev</a> on 2021-03-12 17:02</div>
            <div class="timeline-body"><p>@pksunkara Maybe close this issue?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-03-12 17:12</div>
            <div class="timeline-body"><p>We recommend using https://docs.rs/clap/3.0.0-beta.2/clap/struct.App.html#method.get_matches_from</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-03-12 17:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:57:33 UTC
    </footer>
</body>
</html>
