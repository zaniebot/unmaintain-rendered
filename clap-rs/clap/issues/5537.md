```yaml
number: 5537
title: docs.rs failed to build clap_complete
type: issue
state: closed
author: rucub100
labels:
  - C-bug
assignees: []
created_at: 2024-06-18T19:00:38Z
updated_at: 2024-06-19T21:04:40Z
url: https://github.com/clap-rs/clap/issues/5537
synced_at: 2026-01-10T01:57:49Z
```

# docs.rs failed to build clap_complete

---

_Issue opened by @rucub100 on 2024-06-18 19:00_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

1.80.0-nightly

### Clap Version

clap_complete = "4.5.5"

### Minimal reproducible code

```rust
fn main() {}
```


### Steps to reproduce the bug with the above code

N/A

### Actual Behaviour

N/A

### Expected Behaviour

N/A

### Additional Context
Discovered here: https://docs.rs/crate/clap_complete/4.5.5
Build log source: https://docs.rs/crate/clap_complete/4.5.5/builds/1243175

# rustc version
rustc 1.80.0-nightly (98489f248 2024-06-06)
# docs.rs version
docsrs 0.6.0 (2d4f32bd 2024-05-19)

# build log
[INFO] running `Command { std: "docker" "create" "-v" "/home/cratesfyi/workspace-builder/builds/clap_complete-4.5.5/target:/opt/rustwide/target:rw,Z" "-v" "/home/cratesfyi/workspace-builder/builds/clap_complete-4.5.5/source:/opt/rustwide/workdir:ro,Z" "-v" "/home/cratesfyi/workspace-builder/cargo-home:/opt/rustwide/cargo-home:ro,Z" "-v" "/home/cratesfyi/workspace-builder/rustup-home:/opt/rustwide/rustup-home:ro,Z" "-e" "SOURCE_DIR=/opt/rustwide/workdir" "-e" "CARGO_TARGET_DIR=/opt/rustwide/target" "-e" "DOCS_RS=1" "-e" "CARGO_HOME=/opt/rustwide/cargo-home" "-e" "RUSTUP_HOME=/opt/rustwide/rustup-home" "-w" "/opt/rustwide/workdir" "-m" "6442450944" "--cpus" "6" "--user" "1001:1001" "--network" "none" "ghcr.io/rust-lang/crates-build-env/linux@sha256:dff56e7819e73ed36160586b3445e93eb0be776c16704aeeded9c3fb668b2384" "/opt/rustwide/cargo-home/bin/cargo" "+nightly" "rustdoc" "--lib" "-Zrustdoc-map" "--features" "unstable-doc" "--config" "build.rustdocflags=[\"--cfg\", \"docsrs\", \"--cfg\", \"docsrs\", \"--generate-link-to-definition\", \"-Z\", \"unstable-options\", \"--emit=invocation-specific\", \"--resource-suffix\", \"-20240606-1.80.0-nightly-98489f248\", \"--static-root-path\", \"/-/rustdoc.static/\", \"--cap-lints\", \"warn\", \"--extern-html-root-takes-precedence\"]" "--offline" "-Zunstable-options" "--config=doc.extern-map.registries.crates-io=\"https://docs.rs/{pkg_name}/{version}/x86_64-unknown-linux-gnu\"" "-Zrustdoc-scrape-examples" "-j6" "--target" "x86_64-unknown-linux-gnu" "-Zunstable-options" "-Zrustdoc-scrape-examples", kill_on_drop: false }`
[INFO] [stderr] WARNING: Your kernel does not support swap limit capabilities or the cgroup is not mounted. Memory limited without swap.
[INFO] [stdout] bc41e321af0d9d344fe2f83cb254c598d42b2bbe1dd89057b01b4ab33f57c53c
[INFO] running `Command { std: "docker" "start" "-a" "bc41e321af0d9d344fe2f83cb254c598d42b2bbe1dd89057b01b4ab33f57c53c", kill_on_drop: false }`
[INFO] [stderr] warning: Rustdoc did not scrape the following examples because they require dev-dependencies: completion, completion-derive, dynamic, exhaustive
[INFO] [stderr]     If you want Rustdoc to scrape these examples, then add `doc-scrape-examples = true`
[INFO] [stderr]     to the [[example]] target configuration of at least one example.
[INFO] [stderr] warning: target filter specified, but no targets matched; this is a no-op
[INFO] [stderr]  Documenting clap_complete v4.5.5 (/opt/rustwide/workdir)
[INFO] [stderr] error[E0636]: the feature `doc_auto_cfg` has already been declared
[INFO] [stderr]   --> src/lib.rs:59:29
[INFO] [stderr]    |
[INFO] [stderr] 59 | #![cfg_attr(docsrs, feature(doc_auto_cfg))]
[INFO] [stderr]    |                             ^^^^^^^^^^^^
[INFO] [stderr] 
[INFO] [stderr] For more information about this error, try `rustc --explain E0636`.
[INFO] [stderr] error: could not document `clap_complete`
[INFO] running `Command { std: "docker" "inspect" "bc41e321af0d9d344fe2f83cb254c598d42b2bbe1dd89057b01b4ab33f57c53c", kill_on_drop: false }`
[INFO] running `Command { std: "docker" "rm" "-f" "bc41e321af0d9d344fe2f83cb254c598d42b2bbe1dd89057b01b4ab33f57c53c", kill_on_drop: false }`
[INFO] [stdout] bc41e321af0d9d344fe2f83cb254c598d42b2bbe1dd89057b01b4ab33f57c53c

### Debug Output

_No response_

---

_Label `C-bug` added by @rucub100 on 2024-06-18 19:00_

---

_Comment by @epage on 2024-06-19 21:04_

This was fixed in b3effeae10c4258156c5b263f6b24e44e8af17c3 and released in 4.5.6

---

_Closed by @epage on 2024-06-19 21:04_

---
