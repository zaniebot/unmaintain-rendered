<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>after_version for consistency with after_help? - clap-rs/clap #899</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>after_version for consistency with after_help?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/899">#899</a>
        opened by <a href="https://github.com/swsnr">@swsnr</a>
        on 2017-03-13 11:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/swsnr">@swsnr</a> on 2017-03-13 11:40</div>
            <div class="timeline-body"><p>Is there anything like <code>after_version</code>, to print an additional string after the default text for <code>--version</code>?</p>
<p>I'd like to include licensing information and some additional statistics in <code>--version</code> (like GNU programs do); currently I use <code>get_matches_safe</code> and directly <code>println!</code> if the error is <code>VersionDisplayed</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-13 11:43</div>
            <div class="timeline-body"><p>One possibility is to give an internal name of your <code>--version</code> flag something distinct from <code>version</code> and then handle printing the version info yourself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-13 11:44</div>
            <div class="timeline-body"><p>You can use the <a href="https://docs.rs/clap/2.21.1/clap/macro.crate_version.html"><code>crate_version!</code></a> macro to get the current version of your crate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/swsnr">@swsnr</a> on 2017-03-13 11:49</div>
            <div class="timeline-body"><p>@BurntSushi Thanks for getting back so quickly ‚ù§Ô∏è</p>
<p>I should like to not, though, that I'm not actually adding my own <code>--version</code>.  Sorry for being unclear üòû</p>
<p>I just rely on the default one, but use <code>get_matches_safe</code> and if the error is <code>VersionDisplayed</code> I print my additional text before exiting.</p>
<p>Making my own version flag is not as easy, not due to the actual version, but because of the binary name, which you can only get from <code>app.get_bin_name()</code> after the args were parsed, but <code>get_matches</code> consumes the app so I can't call anything on it afterwards.  There's <code>get_matches_from_safe_borrow</code> but its doc says &quot;not normally desired functionality&quot; so I'm unsure whether its okay to use it (new to Rust, so I can't always make sense of the borrow/move semantics :blush:).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-03-14 02:06</div>
            <div class="timeline-body"><p><code>get_matches_from_safe_borrow</code> is safe to use (and actually what's used internally. I should update the docs. Having said that, having to resort to that is usually not required.</p>
<p>You could also look at using <code>App::template</code> which may give you the functionality you need. (Sorry I'm on mobile so I don't have a link at the moment).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-03-14 02:12</div>
            <div class="timeline-body"><p>Ah I may have misunderstood, if you'd like this info to be displayed when the user runs <code>--version</code> but not <code>--help</code> there isn't support for that yet, short of doing exactly what you're doing now.</p>
<p>Although I'm working adding a differentiated &quot;long help&quot; vs &quot;short help&quot; which this may fit nearly with. I'll link the issues once I get to a computer.</p>
<p>This would allow you place this extra information in the <code>--version</code> text.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/900.html">clap-rs/clap#900</a> on 2017-03-14 02:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/swsnr">@swsnr</a> on 2017-03-28 08:31</div>
            <div class="timeline-body"><p>@kbknapp Sorry for the late reply.</p>
<blockquote>
<p>if you'd like this info to be displayed when the user runs --version but not --help there isn't support for that yet, short of doing exactly what you're doing now.</p>
</blockquote>
<p>Yes, that's exactly my use case.  Specifically, I'd like to include licensing information in <code>--version</code>, similar to what GNU programs show (e.g. <code>emacs --version</code>).</p>
<p>It's not too important, since it's possible to add this output in other ways as described above, but it'd simplify the code a bit if I were able to put it into <code>App</code> directly instead of manually printing it after the default <code>--version</code> output.  In other words, it'd be great if there was an <code>.after_version()</code> method on <code>App</code> like the existing <code>.after_help()</code>.</p>
<p>So, I'm looking forward to #900 :blush:</p>
<p>Thanks for your help &lt;3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-04-05 12:59</div>
            <div class="timeline-body"><p>Closed now that <code>long_version</code> is a thing</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2017-04-05 12:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:31 UTC
    </footer>
</body>
</html>
