<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow good/warning/error/hint color to be customized - clap-rs/clap #3234</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow good/warning/error/hint color to be customized</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/3234">#3234</a>
        opened by <a href="https://github.com/milesj">@milesj</a>
        on 2021-12-31 03:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/milesj">@milesj</a> on 2021-12-31 03:17</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
<h3>Clap Version</h3>
<p>3.0.0-rc.9</p>
<h3>Describe your use case</h3>
<p>I would like to use colored help/errors/etc in our CLI, but would like to change the colors to match our &quot;brand&quot;.</p>
<h3>Describe the solution you'd like</h3>
<p>Provide a setting for good/warning/error/hint that allows the ANSI color code to be provided, based on the 256 table (or maybe 16m if you're crazy). https://upload.wikimedia.org/wikipedia/commons/1/15/Xterm_256color_chart.svg</p>
<p>It may be better to name the colors based on their actual usage, like arg/bin/label, etc.</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @milesj on 2021-12-31 03:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-help</span> added by @epage on 2021-12-31 12:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-triage</span> added by @epage on 2021-12-31 12:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-31 12:46</div>
            <div class="timeline-body"><p>One challenge with this is the API.  We can't accept ANSI escape codes because clap3 intentionally added support for non-ANSI Windows terminals.  We could copy the <code>enum</code>s for color selections but we'd also need styling and the ability to compose them together.  We end up starting to duplicate a decent chunk of a terminal styling API which we are hesitant to do (#1790 is a bit more extreme of an example).</p>
<p>We've been instead preferring for feedback on #2963 for improving our defaults and https://github.com/clap-rs/clap/issues/2914 for allowing people to more thoroughly customize things when those defaults don't work.</p>
<blockquote>
<p>It may be better to name the colors based on their actual usage, like arg/bin/label, etc.</p>
</blockquote>
<p>We've been moving in that direction.  Originally, it was named after the color but the color also implied some other styling with it.  The next step is for us to split off <code>--help</code> parts from abusing the existing semantics and giving them their own.  Since this is internal, this isn't too much of a priority though will be addressed as part of #2963 and #2389.</p>
<blockquote>
<p>would like to change the colors to match our &quot;brand&quot;.</p>
</blockquote>
<p>Mind elaborating what is &quot;ok&quot; and what runs counter to your &quot;brand&quot;?  In what way does it run counter?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/milesj">@milesj</a> on 2022-01-08 23:08</div>
            <div class="timeline-body"><p>@epage That all makes sense. I've had enough experience with ANSI and CLI tools so I totally get it.</p>
<p>As for the branding piece, the colors are shades of purple/blue/teal. Here's an example of the log output.</p>
<img width="1033" alt="Screen Shot 2022-01-08 at 3 07 30 PM" src="https://user-images.githubusercontent.com/143744/148662922-4dfe0418-232c-4be9-8952-76ff41910006.png">

<p>And this is where the colors are configured if you're curious: https://github.com/milesj/moon/blob/master/crates/logger/src/color.rs</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-01-11 17:19</div>
            <div class="timeline-body"><p>If you have any feedback or proposals for https://github.com/clap-rs/clap/issues/2963, could you post it there?</p>
<p>Also, how important are errors or is the main concern the help?</p>
<p>Also, for anyone finding this issue, something that can help for re-evaluating is examples of precedence for this (like <a href="https://docs.rs/dialoguer/latest/dialoguer/">dialoguer</a>) and proposals for how this would work either with older Windows support or why we can justify only supporting ANSI escape codes.</p>
<p>Otherwise, at this time I am closing out this issue, since there is no plan to grow the clap API to support this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2022-01-11 17:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-triage</span> removed by @epage on 2022-01-11 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-wont-fix</span> added by @epage on 2022-01-11 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3407.html">clap-rs/clap#3407</a> on 2022-02-05 15:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-08-18 13:30</div>
            <div class="timeline-body"><p>Since this was closed, I've started work on https://github.com/epage/anstyle which aims to allow color definitions to be used in an API independent of the implementation which will allow users to define their stylesheet.</p>
<p>Blocked on https://github.com/epage/anstyle/issues/14</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @epage on 2022-08-18 13:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-wont-fix</span> removed by @epage on 2022-08-18 13:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-blocked</span> added by @epage on 2022-08-18 13:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4110.html">clap-rs/clap#4110</a> on 2022-08-24 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4114.html">clap-rs/clap#4114</a> on 2022-08-25 18:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2963.html">clap-rs/clap#2963</a> on 2022-08-26 12:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4132.html">clap-rs/clap#4132</a> on 2022-08-27 02:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "4.x" by @epage on 2022-08-30 21:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-09-21 14:12</div>
            <div class="timeline-body"><p>From <a href="https://www.reddit.com/r/rust/comments/xjlie4/preannouncing_clap_40_a_rust_cli_argument_parser/ipa403b/">reddit</a></p>
<blockquote>
<p>My preferred solution would be that, when customization is figured out, have the existing color behavior as some sort of easy to select &quot;preset&quot;.</p>
</blockquote>
<p>We could include presets for color schemes to help get people going.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyurik">@nyurik</a> on 2022-10-07 15:19</div>
            <div class="timeline-body"><p>I recently switch to v4, and the lack of help colors is a bit disheartening - I grew fond of seeing colors in all the &quot;cool new Rust-based Linux tools&quot;, and that color is what instantly made these tools stand apart from the old GNU tools.  Now Clap only uses bold/underline, while continuing to call it &quot;color&quot;. I tried to re-enable the legacy colors somehow, but despite searching all the release notes that only mention it in passing, and skimming through a very lengthy discussion on removing colors, I am beginning to suspect it is not (yet) possible.</p>
<p>To avoid breaking existing functionality, I feel v4 should have included the support for existing color styling from the beginning, even if it would require something like <code>#[clap(legacy_color_scheme = true)]</code>.</p>
<p>Is this what is planned for the next release?  Regardless of the minor grief above, thank you for all the hard work on Clap - it's one of the best crates we have in Rust! :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-07 15:36</div>
            <div class="timeline-body"><p>@nyurik</p>
<blockquote>
<p>I tried to re-enable the legacy colors somehow, but despite searching all the release notes that only mention it in passing, and skimming through a very lengthy discussion on removing colors, I am beginning to suspect it is not (yet) possible.</p>
</blockquote>
<p>#4132 summarizes all of the help changes and includes workarounds, where possible.</p>
<p>For this case, it says</p>
<blockquote>
<p>Users can't rollback until theming support is in (https://github.com/clap-rs/clap/issues/3234) though they can just disable the coloring with Command::disable_colored_help(true)</p>
</blockquote>
<p>@nyurik</p>
<blockquote>
<p>legacy_color_scheme</p>
</blockquote>
<p>Such a flag is not going to be supported.  Instead, our focus will be to theming</p>
<p>@nyurik</p>
<blockquote>
<p>Is this what is planned for the next release</p>
</blockquote>
<p>We do not commit to specific features for a &quot;next release&quot; as we we release on almost every PR made.</p>
<p>Addressing color support, in general, is a priority though.   The main thing blocking theming support is releasing a 1.0 of https://docs.rs/anstyle/latest/anstyle/ which is blocked on getting more feedback on the API / more runtime to make sure the API is good for a 1.0 release, see https://github.com/epage/anstyle/issues/14, see also <a href="https://github.com/clap-rs/clap/issues/3234#issuecomment-1219495963">my earlier comment</a></p>
<p>As it becomes a chicken and egg problem, my plan has been to implement styling support in #3108 / #1433 as that will at least give me some experience with <code>anstyle</code> to decide when its ready to go 1.0 and be safe to use in other crate's APIs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyurik">@nyurik</a> on 2022-10-07 15:46</div>
            <div class="timeline-body"><p>Thanks @epage for such a great in-depth reply!   I think we should modify the CHANGELOG file (and possibly the release v4 comment) -- to make it clearer.  I searched for the word &quot;color&quot;, and nothing came up. I found this</p>
<blockquote>
<p>We've moved to a more neutral palette for highlighting elements (not highlighted above)</p>
</blockquote>
<p>which is not a good explanation when a highly visible breaking change is introduced. Perhaps something like this text?  I will be happy to make a pull request.</p>
<blockquote>
<p>We have removed colored help in favor of bold and underlined text. There is currently no way to re-enable the old color scheme until the styling (#3108 / #1433) is implemented.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-10-07 15:53</div>
            <div class="timeline-body"><p>As I'm trying to focus to get other things done so I can get back to that work, I do not have time to litigate a discussion about how to handle this (sorry, you are partly getting the short end of the stick from some other individuals taking up too much time / attention).  As that is the case, we'll leave it as-is for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../sharkdp/bat/pulls/2327.html">sharkdp/bat#2327</a> on 2022-10-07 17:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4429.html">clap-rs/clap#4429</a> on 2022-10-29 12:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2389.html">clap-rs/clap#2389</a> on 2022-11-03 02:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4444.html">clap-rs/clap#4444</a> on 2022-11-03 02:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../ProvableHQ/snarkOS/pulls/2113.html">ProvableHQ/snarkOS#2113</a> on 2022-11-29 16:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../lu-zero/cargo-c/pulls/299.html">lu-zero/cargo-c#299</a> on 2022-12-18 17:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/casey">@casey</a> on 2022-12-25 22:54</div>
            <div class="timeline-body"><p>Is this the issue to follow for color support? I'd like to upgrade to clap v4, but the lack of colored help is a blocker. I found this issue, but the title is a little ambiguous.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-12-25 23:21</div>
            <div class="timeline-body"><p>Yes, this is the issue in that it will let you color the help as you wish</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4674.html">clap-rs/clap#4674</a> on 2023-01-25 04:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../NNPDF/pineappl/issues/145.html">NNPDF/pineappl#145</a> on 2023-02-01 10:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dream-dasher">@dream-dasher</a> on 2023-02-04 07:24</div>
            <div class="timeline-body"><p>Same as @casey.
A sea of almost identical white text adds a lot of parse work to the user.  And drains a lot of joy.  A hard no for any app with an ounce of kindness, imo.</p>
<p>I'm glad to see that v3 documentation still exists though!</p>
<p>Is the plan to make color default again with specification possible or only allow color via manual specification?  (If the later then that's a level of friction not consistent with my use case [I'm just looking to for very basic, readable user interfaces] and would just like to have a sense of trajectory before I invest in this system.  [new to rust and trying to find cli app frameworks that let me focus on non-interface elements -- thanks in advance for any answer] )</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-02-04 15:04</div>
            <div class="timeline-body"><p>The plan is to add customization of whats already there. If someone wants to come up with a counter proposal for colors that meets the stated goals, we'll evaluate adopting it. So far, no one has taken up that offer. Once we allow customization, we're hoping people will do that implicitly and we'll watch to see what develops in the community.</p>
<p>As for other Rust CLI parsers, I believe they all have less text styling than clap.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dream-dasher">@dream-dasher</a> on 2023-02-04 16:14</div>
            <div class="timeline-body"><p>Thanks for the response @epage.
I'm not at a place in my journey where I can fruitfully offer help on that issue. (maybe eventually!)
I'll look into front-ending my rust code with another language and use one of their frameworks. (which seems funny for a cli, but different eco-systems are in different places)</p>
<p>Thanks for all the work you are doing!
I can only imagine being the de facto face of argument parsing for the language is a lot of responsibility and makes decisions that leave any given set-up less supported feel very weighty.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dream-dasher">@dream-dasher</a> on 2023-02-04 20:00</div>
            <div class="timeline-body"><p>I've noticed that piping the output of clap into <a href="https://github.com/sharkdp/bat">bat</a> ü¶à ü¶á  gives <em>excellent</em> default highlighting.  (i.e. easy to scan and parse)</p>
<p>Having only just begun looking at these crates (clap &amp; bat's library) it's not immediately clear how to run the clap output through <a href="https://docs.rs/bat/latest/bat/">bat library</a> and gain syntax advantages.  (much less apply syntax processing during compilation vs runtime)</p>
<p>But a crate extension that enabled coloring that works on __many_/<em>most</em> terminals, but, being an extension, needn't support the same breadth as clap seems to me to be a possible workaround.</p>
<p>Having an extension that deals with colorschemes and plugs into output syntax also seems like it might be a nice decoupling for the project.</p>
<p>Not sure how many suggestions you want from the peanut gallery. ü•ú üé™
But as far as the core code existing (though possibly not cleanly interfaceable ways ü§∑) -- this does look like a promising approach from the outside.</p>
<p>Any thoughts?
Has this been considered and reject previously?  (e.g. due to code being so runtime focused that it couldn't easily get worked into a compile time extension)</p>
<hr />
<p>Below, an example of <em>runtime</em> syntax parsing and highlighting of clap output, using the <a href="https://docs.rs/clap/4.1.4/clap/_derive/_tutorial/index.html">QuickStart Derive example</a> from current docs (v4.1)
<img width="645" alt="clap_v4 with bathelp" src="https://user-images.githubusercontent.com/33399972/216786888-fe2ceb47-7270-4a52-9822-270c8f22bf51.png"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-02-04 21:53</div>
            <div class="timeline-body"><blockquote>
<p>Not sure how many suggestions you want from the peanut gallery. ü•ú üé™
But as far as the core code existing (though possibly not cleanly interfaceable ways ü§∑) -- this does look like a promising approach from the outside.</p>
<p>Any thoughts?
Has this been considered and reject previously? (e.g. due to code being so runtime focused that it couldn't easily get worked into a compile time extension)</p>
</blockquote>
<p>This is a fairly complex solution with a large binary size and build-time impact.  The proposed solution in this PR is relatively simple and mall; I just need to wrap up another project first.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4786.html">clap-rs/clap#4786</a> on 2023-03-24 21:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mozilla/grcov/pulls/1000.html">mozilla/grcov#1000</a> on 2023-03-26 06:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4843.html">clap-rs/clap#4843</a> on 2023-04-18 20:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-18 20:54</div>
            <div class="timeline-body"><p>Support for this is now available as <code>Command::styles</code> with v4.2.3 when the <code>unstable-styles</code> feature is enabled.</p>
<p>Note: we are not guaranteeing semver compatibility on this feature until the feature flag is removed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvkb">@dhruvkb</a> on 2023-04-19 15:48</div>
            <div class="timeline-body"><p>Thank you @epage! Are there any examples/docs we can refer to? The docs for <code>Command::styles</code> seem to be incorrectly copied from <code>Command::color</code>.</p>
<img width="1012" alt="Screenshot 2023-04-19 at 7 47 57 PM" src="https://user-images.githubusercontent.com/16580576/233130245-381d2121-b550-4e94-b806-c226021fbe05.png">

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-19 16:03</div>
            <div class="timeline-body"><p>clap-rs/clap#4845 is correcting it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-19 16:16</div>
            <div class="timeline-body"><p>I guess one question is whether we should re-export anstyle (and how) or require people to depend on it directly.</p>
<p>Re-exports are more convenient (no need for extra dep) and keep things in sync (though anstyle will hopefully never go 2.0 or if it does, we;'ll have a long time inbetween).</p>
<p>My guess is we could expose it as <code>clap::builder::style</code>.</p>
<p>Thoughts?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvkb">@dhruvkb</a> on 2023-04-19 19:11</div>
            <div class="timeline-body"><p>I like the idea of re-exporting as it prevents the developer from needing to worry about compatibility üëç.</p>
<p>On a side note, I use the, derive notation but have to import <code>Styles</code> from <code>clap::builder</code>.</p>
<pre><code class="language-rust">#[command(styles=clap::builder::Styles::plain())]
pub struct Arguments {
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DianaNites">@DianaNites</a> on 2023-04-19 20:06</div>
            <div class="timeline-body"><p>As a user, I always prefer when a libraries public dependencies are re-exported, the way I see it, its not <em>my</em> dependency, its the libraries, and I don't want to have to manage it in my <code>Cargo.toml</code></p>
<p>As for how, I think re-exporting from the crate root is the best when its an entire dependency rather than just a type or few.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-19 20:32</div>
            <div class="timeline-body"><blockquote>
<p>On a side note, I use the, derive notation but have to import Styles from clap::builder.</p>
</blockquote>
<p>That is true of a lot of functionality.  We onlyh re-export the core types in the root.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-19 20:35</div>
            <div class="timeline-body"><blockquote>
<p>As for how, I think re-exporting from the <strong>crate root</strong> is the best when its an entire dependency rather than just a type or few.</p>
</blockquote>
<p><em>(Emphasis mine)</em></p>
<p>If <code>anstyle</code> wasn't an independent crate, I'd most likely expose it in <code>clap::builder</code> or <code>clap::builder::style</code>.</p>
<p>I feel like a similar approach should be taken with re-exports.  I feel like dumping it in the root without taking into account any other considerations can lead to a bloated root, making it harder to find things, and a less cohesive experience.</p>
<p>But getting opinions out like this is why I didn't immediately re-export but brought it up here so I can see what different people's thoughts were.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bryantbiggs">@bryantbiggs</a> on 2023-04-19 21:21</div>
            <div class="timeline-body"><p>any pointers on how to enabled styled output - I've followed @dhruvkb snippet above but the output looks the same as before (and I enabled the <code>colors</code> and <code>unstable-styles</code> features as well)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-19 21:40</div>
            <div class="timeline-body"><p>@bryantbiggs can you provide a minimal, complete reproduction case for whats not working for you, with a description of what you'd expect?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvkb">@dhruvkb</a> on 2023-04-20 07:50</div>
            <div class="timeline-body"><p>I was able to color the section headers and argument names using this snippet (building on the <a href="https://docs.rs/clap_builder/4.2.3/src/clap_builder/builder/styled_str.rs.html#229"><code>styled_str.rs</code> source file</a>.</p>
<pre><code class="language-rust">pub fn get_styles() -&gt; clap::builder::Styles {
	clap::builder::Styles::styled()
		.header(
			anstyle::Style::new()
				.bold()
				.underline()
				.fg_color(Some(anstyle::Color::Ansi(anstyle::AnsiColor::Blue))),
		)
		.literal(
			anstyle::Style::new()
				.bold()
				.fg_color(Some(anstyle::Color::Ansi(anstyle::AnsiColor::Cyan))),
		)
}

#[command(styles=get_styles())]
pub struct Arguments {
	// ...
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eatradish">@eatradish</a> on 2023-04-20 11:33</div>
            <div class="timeline-body"><p>Doesn't seem to be available in the builder api? (clap 4.2.4 with &quot;cargo&quot;, &quot;wrap_help&quot;, &quot;unstable-styles&quot;, &quot;color&quot; features, rustc 1.68.2)</p>
<pre><code>error[E0603]: struct `Styles` is private
  --&gt; src/args.rs:1:37
   |
1  | use clap::{builder::{PossibleValue, Styles}, command, Arg, ArgAction, Command};
   |                                     ^^^^^^ private struct
   |
note: the struct `Styles` is defined here
  --&gt; /home/saki/.cargo/registry/src/github.com-1ecc6299db9ec823/clap_builder-4.2.4/src/builder/mod.rs:66:16
   |
66 | pub(crate) use styled_str::Styles;
   |                ^^^^^^^^^^^^^^^^^^

error[E0599]: no method named `styles` found for struct `Command` in the current scope
  --&gt; src/args.rs:49:10
   |
49 |         .styles(Styles::styled().usage(Default::default()))
   |          ^^^^^^ help: there is a method with a similar name: `get_styles`

Some errors have detailed explanations: E0599, E0603.
For more information about an error, try `rustc --explain E0599`.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-20 13:42</div>
            <div class="timeline-body"><p>@eatradish did you run <code>cargo add clap -F unstable-styles</code>?</p>
<p>I wish rustc would partially parse disabled <code>cfg</code>s so it could tell suggest the feature to you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../build-trust/ockam/pulls/4652.html">build-trust/ockam#4652</a> on 2023-04-20 14:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eatradish">@eatradish</a> on 2023-04-20 18:02</div>
            <div class="timeline-body"><blockquote>
<p>@eatradish did you run <code>cargo add clap -F unstable-styles</code>?</p>
<p>I wish rustc would partially parse disabled <code>cfg</code>s so it could tell suggest the feature to you</p>
</blockquote>
<p>My fault, I have set this version in Cargo.toml:</p>
<pre><code>clap = { version = &quot;4.2&quot;, features = [&quot;cargo&quot;, &quot;wrap_help&quot;, &quot;color&quot;, &quot;unstable-styles&quot;] }
</code></pre>
<p>But the right thing to do is:</p>
<pre><code>clap = { version = &quot;4.2.4&quot;, features = [&quot;cargo&quot;, &quot;wrap_help&quot;, &quot;color&quot;, &quot;unstable-styles&quot;] }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvkb">@dhruvkb</a> on 2023-04-26 09:51</div>
            <div class="timeline-body"><p>I cannot find the style to use to change the appearance of the default and possible values. They always appear white. Is that not currently supported?</p>
<img width="973" alt="Screenshot 2023-04-26 at 1 51 01 PM" src="https://user-images.githubusercontent.com/16580576/234539329-81d4ab72-858c-4991-82db-8cfe02cb740e.png">

<p>I understand that this might not be directly related to this issue, so I can open a new one if that's more appropriate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-26 11:59</div>
            <div class="timeline-body"><p>We do not yet have a style set apart for those.  Any thoughts on a name?  I was originally thinking &quot;hint&quot; though that might be confused the the &quot;tip&quot;s in error messages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvkb">@dhruvkb</a> on 2023-04-26 12:26</div>
            <div class="timeline-body"><p>&quot;default&quot; could be a good name for the default value, and &quot;possibilities&quot; for the possible values. That seems the most intuitive to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-04-26 12:42</div>
            <div class="timeline-body"><p>I don't want to create a style per one of these bracketed items as that doesn't scale well for us to add more in the future.</p>
<p>Note: there is also one for env variables</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-05-02 14:04</div>
            <div class="timeline-body"><p>Besides naming the styling element for defaults, possible values, and env variables, I'm curious on how people think we should style it.</p>
<p>Some options I thought of:</p>
<ul>
<li><code>{spec}[default: true]{reset}</code> (all styled the same)</li>
<li><code>{spec}[default: {literal}true{reset}{spec}]{reset}</code> (outer-styled, value stuled)</li>
<li><code>[{spec}default:{reset} {literal}true{reset}]</code> (key-styled, values-styled)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyurik">@nyurik</a> on 2023-05-02 17:38</div>
            <div class="timeline-body"><p>I might be misunderstanding the last post - if <code>{spec}</code>, <code>{literal}</code>, and <code>{reset}</code> are ANSI color escape sequences, why does it say &quot;all styled the same&quot;?</p>
<p>I think the 1st variant is a subset of the 2nd (i.e. if literal style is the same as the spec) - so I would think the 2nd variant is preferred as it offers more flexibility. I also think that by default literal and spec should be the same color (thus producing the 1st variant) - as less color-disruptive (I wouldn't want my help screen to look like the early days of MS Word with word-art, with everyone using every single font available to print a flier).  I am not a big fan of the 3rd.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-05-02 17:45</div>
            <div class="timeline-body"><blockquote>
<p>I might be misunderstanding the last post - if {spec}, {literal}, and {reset} are ANSI color escape sequences, why does it say &quot;all styled the same&quot;?</p>
</blockquote>
<p>Sorry, forgot to go back and fix those</p>
<blockquote>
<p>I think the 1st variant is a subset of the 2nd (i.e. if literal style is the same as the spec) - so I would think the 2nd variant is preferred as it offers more flexibility. I also think that by default literal and spec should be the same color (thus producing the 1st variant) - as less color-disruptive (I wouldn't want my help screen to look like the early days of MS Word with word-art, with everyone using every single font available to print a flier). I am not a big fan of the 3rd.</p>
</blockquote>
<p>The difference between (1) and (2) is <code>literal</code> is an existing style, used by <code>--flags</code> and acts like backticks in markdown.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyurik">@nyurik</a> on 2023-05-02 17:50</div>
            <div class="timeline-body"><p>thx, in that case yes, I think the 2nd is the best because it would allow this help screen (from above):</p>
<img alt="Screenshot 2023-04-26 at 1 51 01 PM" width="973" src="https://user-images.githubusercontent.com/16580576/234539329-81d4ab72-858c-4991-82db-8cfe02cb740e.png">

<p>to be consistent for both the default and possible values:</p>
<blockquote>
<p>display icons next to node names {spec}[default: <code>true</code>] [possible values: <code>true</code>, <code>false</code>]{reset}</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-05-02 17:56</div>
            <div class="timeline-body"><p>To be clear, (2) would cause <code>true</code>, <code>true</code>, and <code>false</code> to be teal like <code>--icons</code>, <code>--align</code>, and <code>--multi-cols</code>.</p>
<p>I hesitate about (2) because we want to draw attention to literals in the first column and in usage but it feels weird to in the help description, it might be too bus.</p>
<p>btw this is the current way we highlight something similar in errors</p>
<pre><code>                        let _ = write!(styled, &quot;\n{TAB}[possible values: &quot;);
                        if let Some((last, elements)) = possible_values.split_last() {
                            for v in elements {
                                let _ = write!(
                                    styled,
                                    &quot;{}{}{}, &quot;,
                                    valid.render(),
                                    Escape(v),
                                    valid.render_reset()
                                );
                            }
                            let _ = write!(
                                styled,
                                &quot;{}{}{}&quot;,
                                valid.render(),
                                Escape(last),
                                valid.render_reset()
                            );
                        }
                        styled.push_str(&quot;]&quot;);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyurik">@nyurik</a> on 2023-05-02 19:18</div>
            <div class="timeline-body"><p>I think the most ideal for discussion is some real rendering image of all variants, perhaps in a few default variants (console vs markdown)?  Kinda tricky to discuss it in a plain text format.</p>
<p>P.S. your code example made me realize it could use some DRY, so I made a https://github.com/clap-rs/clap/pull/4876 PR - hope its ok - deletes 23 lines :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AndreasBackx">@AndreasBackx</a> on 2023-05-25 14:21</div>
            <div class="timeline-body"><p>I was working on some tooling that makes it easier for people to switch over from x to Rust and came across this Python Click library to add colours to <code>--help</code>. I noticed it allows overriding colours per command as well. I could see it being useful where you colour some subcommands red to showcase they might be destructive or might require you being an admin or something (not referring to OS level root/admin but for whatever tool is being built). https://github.com/click-contrib/click-help-colors</p>
<p>Food for thought, could be something that needs thinking about for this particular issue as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-05-25 14:43</div>
            <div class="timeline-body"><p>I think that would be a useful feature and, with the plugin system I've been adding to clap, it should minimize some of the negative effects of adding it.</p>
<p>The question for this thread is if there is anything about that that would require breaking changes to the existing feature before we stabilize it.  The rest can be deferred out into its own issue.</p>
<p>Unfortunately, not seeing a quick reference, so from what I gather they allow</p>
<ul>
<li>help_headers_color</li>
<li>help_options_color</li>
<li>help_options_custom_colors (maps arg or command to color)</li>
<li>prog_name_color (for <code>--version</code>)</li>
<li>version_color (for <code>--version</code>)</li>
<li>message_color (for <code>--version</code>)</li>
</ul>
<p>All of that can be set on a per-command basis</p>
<p>One problem I see with what we currently do is we copy out styles to subcommand but we overwrite the subcommand, rather than allowing the subcommand to have special behavior.</p>
<p>Our style sheet is more fine grained in areas but doesn't allow controlling prog name and version separately.  Our plugin system would offer a better way for coloring most things (color set directly on arg rather than in a map) but it won't let us easily hit things like version <strong>but</strong> we allow setting the version as styled./</p>
<p>For if/when we support per-arg and per-command styling, we'll need to make sure <code>StyledStr</code> can be sorted agnostic of styling.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5016.html">clap-rs/clap#5016</a> on 2023-07-17 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-07-18 01:27</div>
            <div class="timeline-body"><p>A new release is out that re-exports <code>anstyle</code> and includes some more examples</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-07-18 01:28</div>
            <div class="timeline-body"><p>As for styling of defaults, https://github.com/Canop/clap-help is somewhat similar to one of the options being considered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gibfahn">@gibfahn</a> on 2023-07-27 22:37</div>
            <div class="timeline-body"><p>The default example in https://github.com/Canop/clap-help#with-clap-help seems quite hard to read to me (compared to the current output), it's hard to see which option in the left column maps to which description on the right column, and it's hard to see where one option's help ends and the next one begins in the right column.</p>
<p>This is even more true when you have more detailed help text with examples for the options.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-07-28 00:32</div>
            <div class="timeline-body"><p>I was more wanting to highlight how it styling the text (which ties into this issue) and  not the wider formatting change</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-08-28 14:37</div>
            <div class="timeline-body"><p>At this point, the remaining open questions are</p>
<ul>
<li>How should <code>[default: value]</code> be styled / support styling<ul>
<li>I'm leaning towards a uniform style for the whole block of text which means we won't use an existing style and can add this later. I'll create an issue for tracking this</li>
<li>EDIT: #5093</li>
</ul>
</li>
<li>Any future extensibility for customization<ul>
<li>I'm thinking we shouldn't further block on this and create a separaet issue.  @AndreasBackx mind creating an issue?</li>
</ul>
</li>
</ul>
<p>So at this point, I think I'm going to move towards stabilization</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5093.html">clap-rs/clap#5093</a> on 2023-08-28 14:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5094.html">clap-rs/clap#5094</a> on 2023-08-28 14:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2023-08-28 15:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5095.html">clap-rs/clap#5095</a> on 2023-08-28 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5098.html">clap-rs/clap#5098</a> on 2023-08-28 17:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/donovanglover">@donovanglover</a> on 2023-10-28 13:59</div>
            <div class="timeline-body"><p>It took me some time to figure this out, but <a href="https://github.com/donovanglover/hyprdim/commit/c9be9b037616c5b929d177c8c5dfb82f34242d8d">here's an example</a> of adding color to <code>--help</code>.</p>
<pre><code class="language-rust">use clap::builder::styling::{AnsiColor, Effects, Styles};
use clap::Parser;

fn styles() -&gt; Styles {
    Styles::styled()
        .header(AnsiColor::Red.on_default() | Effects::BOLD)
        .usage(AnsiColor::Red.on_default() | Effects::BOLD)
        .literal(AnsiColor::Blue.on_default() | Effects::BOLD)
        .placeholder(AnsiColor::Green.on_default())
}

#[derive(Parser)]
#[command(author, version, about, styles = styles())]
pub struct Cli {
    // ...
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../chrissimpkins/siz/issues/14.html">chrissimpkins/siz#14</a> on 2023-12-22 05:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../rustic-rs/rustic/issues/1003.html">rustic-rs/rustic#1003</a> on 2024-01-13 21:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/murlakatamenka">@murlakatamenka</a> on 2024-03-12 23:54</div>
            <div class="timeline-body"><blockquote>
<p>It took me some time to figure this out, but <a href="https://github.com/donovanglover/hyprdim/commit/c9be9b037616c5b929d177c8c5dfb82f34242d8d">here's an example</a> of adding color to <code>--help</code>.</p>
<pre><code class="language-rust">use clap::builder::styling::{AnsiColor, Effects, Styles};
use clap::Parser;

fn styles() -&gt; Styles {
    Styles::styled()
        .header(AnsiColor::Red.on_default() | Effects::BOLD)
        .usage(AnsiColor::Red.on_default() | Effects::BOLD)
        .literal(AnsiColor::Blue.on_default() | Effects::BOLD)
        .placeholder(AnsiColor::Green.on_default())
}

#[derive(Parser)]
#[command(author, version, about, styles = styles())]
pub struct Cli {
    // ...
}
</code></pre>
</blockquote>
<p>Piggybacking on this, since <code>Styles::styled</code> is <a href="https://docs.rs/clap/4.5.2/clap/builder/struct.Styles.html">const</a>:</p>
<pre><code class="language-rs">use clap::{
    builder::styling::{AnsiColor as Ansi, Styles},
    Parser,
};

const MY_AWESOME_STYLE: Styles = Styles::styled()
    .header(Ansi::Red.on_default().bold())
    .usage(Ansi::Red.on_default().bold())
    .literal(Ansi::Blue.on_default().bold())
    .placeholder(Ansi::Green.on_default());

#[derive(Parser)]
#[command(styles = MY_AWESOME_STYLE)]
pub struct Cli {
    // ...
}

fn main() {
    let _cli = Cli::parse();
}
</code></pre>
<p>Clap v3 Style:</p>
<ul>
<li>https://docs.rs/clap/4.5.2/clap/builder/struct.Styles.html#example</li>
</ul>
<p><code>rustic</code>'s style:</p>
<ul>
<li>https://github.com/rustic-rs/rustic/blob/6fffaad1cc1aeebf874063fc62125f4ce3b490b5/src/commands.rs#L143-L149</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MilesCranmer">@MilesCranmer</a> on 2024-04-15 11:09</div>
            <div class="timeline-body"><p>Here's an example of manually customizing the colors in the help template:</p>
<p>https://github.com/MilesCranmer/rip2/blob/29b46efbff046515360cf5a16bdbae678db90b37/src/args.rs#L8-L83</p>
<p>Both in the text (with anstyle render) and by letting clap do it.</p>
<p>On white background:</p>
<p><img src="https://github.com/clap-rs/clap/assets/7593028/d48e1704-1eab-40bc-b49c-c0cc798c7cb1" alt="Screenshot 2024-04-15 at 12 12 41" /></p>
<p>And dark:</p>
<p><img src="https://github.com/clap-rs/clap/assets/7593028/eb3df6e2-e83f-4df8-b82e-9583875792f8" alt="Screenshot 2024-04-15 at 12 13 15" /></p>
<p>(Same color scheme as <code>cargo</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/uv/issues/3473.html">astral-sh/uv#3473</a> on 2024-07-07 18:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../robiot/rustcat/pulls/69.html">robiot/rustcat#69</a> on 2024-07-17 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-07 08:33</div>
            <div class="timeline-body"><blockquote>
<p>We can't accept ANSI escape codes because clap3 intentionally added support for non-ANSI Windows terminals.</p>
</blockquote>
<p>I've started digging into this problem and came across this. As someone who's worked a lot with the Windows Terminal team who added conpty support to both wt.exe and conhost.exe circa Windows 10, as well as helped the GitHub CLI team with a bunch of ANSI color issues, this is solvable. There are a lot of linked issues so I'm not sure if this has been discussed, but effectively, if you call <code>GetConsoleMode()</code> to get the current console mode, OR that with <code>ENABLE_VIRTUAL_TERMINAL_PROCESSING</code>, and call <code>SetConsoleMode()</code>. If that returns non-zero, conpty was enabled and you can safely use ANSI colors.</p>
<p>See <a href="https://github.com/microsoft/vswhere/blob/9fd6f2c6df9ccff186412121f2016b81ff4d9e4c/src/vswhere.lib/Console.cpp#L116">https://github.com/microsoft/vswhere/blob/9fd6f2c6df9ccff186412121f2016b81ff4d9e4c/src/vswhere.lib/Console.cpp#L116</a> or <a href="https://github.com/cli/go-gh/blob/25db6b99518c88e03f71dbe9e58397c4cfb62caf/pkg/term/console_windows.go#L12">https://github.com/cli/go-gh/blob/25db6b99518c88e03f71dbe9e58397c4cfb62caf/pkg/term/console_windows.go#L12</a>. Any terminal from Windows 10 TH2 (IIRC) in the OS will support this, though third-party solutions may not; however, they should fail that call as well, so you know not to write ANSI escape sequences (or filter them out on write - whichever is easier since parsing them out is fairly trivial e.g., <a href="https://github.com/heaths/go-console/blob/d0d8e65f7196273cfb7f2354f48c13beae9d60d8/internal/writer/writer.go#L27">https://github.com/heaths/go-console/blob/d0d8e65f7196273cfb7f2354f48c13beae9d60d8/internal/writer/writer.go#L27</a>).</p>
<p>Or, does this really come down to just being able to theme the colors reliably and easily? There are quite a few linked issues/discussions about this. I've read through a couple. But there are quite a few just about the lack of color at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-07 14:20</div>
            <div class="timeline-body"><p>@heaths that is a pretty stale comment you are replying to and so a lot of your reply doesn't seem relevant.  This issue has long since been resolved,  We knew of and take care of enabling ANSI escape codes on Windows.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-08 06:41</div>
            <div class="timeline-body"><p>v4 still shows non-colored text. Searching the issues, I found this issue and nothing obvious more recent. Is there something more recent? Again reviewing the docs and writing a quick sample, I only see underlined text.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gibfahn">@gibfahn</a> on 2024-08-08 12:53</div>
            <div class="timeline-body"><p>I believe this is how you style the text: https://docs.rs/clap/latest/clap/struct.Command.html#method.styles</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5636.html">clap-rs/clap#5636</a> on 2024-08-08 13:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-08 13:51</div>
            <div class="timeline-body"><p>@heaths the fact that you saw underlined (and I assume bold) means you were getting ANSI escape codes.</p>
<p>In <a href="https://github.com/clap-rs/clap/blob/master/CHANGELOG.md#400---2022-09-28">4.0.0</a></p>
<blockquote>
<p>We've moved to a more neutral palette for highlighting elements (not highlighted above)</p>
</blockquote>
<p>See also #2963 which was linked to from the first post of mine that you quoted from.  In CLIs, the term &quot;color&quot; tends to be a placeholder for &quot;any ansi escape codes&quot;.</p>
<p>This issue is about customizing it so you don't have to use that color palette and <code>cargo --help</code> is an example of that in practice.</p>
<p>With this issue closed, we can be a bit more &quot;daring&quot; with our choice and I am open to people discussing what would be a good &quot;universal&quot; / &quot;safe&quot; default color palette in its own issue.  Note though that changing the color palette would be considered a breaking change according to <a href="https://github.com/clap-rs/clap/blob/master/CONTRIBUTING.md#compatibility-expectations">our guidelines</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-08 14:57</div>
            <div class="timeline-body"><p>Are their docs on how to change the ANSI escape sequences? I looked prior to replying originally - understanding at least part of this issue was about that - but found nothing. To be honest, I care less about the defaults if it's easy to customize.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-08 15:10</div>
            <div class="timeline-body"><p>@heaths they were linked to earlier in https://github.com/clap-rs/clap/issues/3234#issuecomment-2275752109, see https://docs.rs/clap/latest/clap/struct.Command.html#method.styles</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-08 15:12</div>
            <div class="timeline-body"><p>Apologies. I missed that. Any objection to linking that or even adding an example to the tutorial docs? I'd be happy to submit a PR if you're cool with that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-08 15:19</div>
            <div class="timeline-body"><p>Actually, looking more carefully through https://docs.rs/clap/latest/clap/_derive/index.html#command-attributes it seems that's not currently possible. I will open a separate issue to perhaps accept a function to supply styles or something, or has that been discussed already as well? I prefer derive to builder myself and would love to more easily take advantage of this behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-08 15:21</div>
            <div class="timeline-body"><p>@heaths I've found that each person has their own problem they've run into and &quot;put it in the tutorial&quot; is a common solution proposed.  To do that in all cases would make it as hard to find things in the tutorial as the API.  I don't have a good answer for where the &quot;line&quot; should be.</p>
<p>However, cargo has adopted custom colors and so it would be reasonable to add color support to our cargo <a href="https://docs.rs/clap/latest/clap/_derive/_cookbook/index.html">cookbook entry</a> and highlight in the summary that its using custom colors.</p>
<blockquote>
<p>Actually, looking more carefully through https://docs.rs/clap/latest/clap/_derive/index.html#command-attributes it seems that's not currently possible. I will open a separate issue to perhaps accept a function to supply styles or something, or has that been discussed already as well?</p>
</blockquote>
<p>What in that is giving the impression its not supported?  I'm using it in cargo-release
https://github.com/crate-ci/cargo-release/blob/e30b1c6c645700f4189b76130de0896e19f8d0b1/src/bin/cargo-release.rs#L54</p>
<p>If its because the attribute isn't explicitly named, thats because it falls under the catch-all &quot;raw attribute&quot; section, see also #4090</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-08 15:31</div>
            <div class="timeline-body"><p>Fair point about where to draw the line, but seems styles is a pretty major feature to at least warrant an example. As much attention as the lack of colors in v4 got across a few projects, seems like a good idea to have a section or even chapter about.</p>
<p>That thread about raw attributes also points out how there's no mention in the tutorial docs. Clap has an expansive API and it seems that features like this getting called out in the tutorial with links to the to docs could help. Personally, your tutorials are good enough that I typically don't need to dig into the ref docs too much. The only time I remember was when writing my own value parser. I don't imagine I'm alone in this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5638.html">clap-rs/clap#5638</a> on 2024-08-08 15:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-08 15:36</div>
            <div class="timeline-body"><p>#5638 is up to add it to the cookbook.  Part of the role of the cookbook is for people to say &quot;I want this feature from this command, how do I do it&quot;.</p>
<blockquote>
<p>That thread about raw attributes also points out how there's no mention in the tutorial docs.</p>
</blockquote>
<p>It is called out in the tutorial, likely added based on that feedback, e.g.</p>
<blockquote>
<p>Any <a href="https://docs.rs/clap/latest/clap/struct.Command.html">Command</a> builder function can be used as an attribute, like <a href="https://docs.rs/clap/latest/clap/struct.Command.html#method.next_line_help">Command::next_line_help</a>.</p>
</blockquote>
<p>See https://docs.rs/clap/latest/clap/_derive/_tutorial/chapter_1/index.html</p>
<p>I'm likely to write a documentation generator based on <code>cargo doc --json</code> but haven't gotten to it yet.  If someone wants to take that on, I can give them rough guidelines of what I expect (and what is left undecided).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-08 18:34</div>
            <div class="timeline-body"><blockquote>
<p>I'm likely to write a documentation generator based on cargo doc --json but haven't gotten to it yet. If someone wants to take that on, I can give them rough guidelines of what I expect (and what is left undecided).</p>
</blockquote>
<p>Are these written down somewhere, or do we want to take that to a new issue or zulip? I might be game.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2024-08-08 18:51</div>
            <div class="timeline-body"><p>The current write up is at https://github.com/clap-rs/clap/discussions/4090#discussioncomment-6973754 but moving to an issue could make it easier to track</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heaths">@heaths</a> on 2024-08-09 02:23</div>
            <div class="timeline-body"><p>https://github.com/clap-rs/clap/issues/5639</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../stellar/stellar-cli/issues/1624.html">stellar/stellar-cli#1624</a> on 2024-09-25 20:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../jj-vcs/jj/pulls/5716.html">jj-vcs/jj#5716</a> on 2025-02-16 02:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:50 UTC
    </footer>
</body>
</html>
