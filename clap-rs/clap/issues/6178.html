<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Completion of FilePath adds space in zsh - clap-rs/clap #6178</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Completion of FilePath adds space in zsh</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/6178">#6178</a>
        opened by <a href="https://github.com/windsource">@windsource</a>
        on 2025-11-05 09:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/windsource">@windsource</a> on 2025-11-05 09:54</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[x] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Rust Version</h3>
<p>rustc 1.91.0 (f8297e351 2025-10-28)</p>
<h3>Clap Version</h3>
<p>clap 4.5.51, clap_complete 4.5.60</p>
<h3>Minimal reproducible code</h3>
<pre><code class="language-rust">use std::path::PathBuf;

use clap::{CommandFactory, Parser, ValueHint};
use clap_complete::CompleteEnv;

#[derive(Parser, Debug, PartialEq)]
#[command(name = &quot;mycomp&quot;)]
struct Opt {
    #[arg(value_hint = ValueHint::FilePath)]
    file: PathBuf,
}

fn main() {
    CompleteEnv::with_factory(|| Opt::command()).complete();
    let opt = Opt::parse();

    println!(&quot;{:#?}&quot;, opt.file);
}
</code></pre>
<h3>Steps to reproduce the bug with the above code</h3>
<p>If the binary is called <code>mycomp</code>, then in zsh (not bash!):</p>
<pre><code class="language-shell">source &lt;(COMPLETE=zsh mycomp)
</code></pre>
<p>Then assume your current folder looks like</p>
<pre><code>. -
  +- sub1
     +- sub2
</code></pre>
<p>Then using completion like</p>
<pre><code>mycomp &lt;TAB&gt;
</code></pre>
<h3>Actual Behaviour</h3>
<p>You get</p>
<pre><code>mycomp sub1/&lt;SPACE&gt;
</code></pre>
<p>so pressing tab again will not show <code>sub2</code>. In bash the behavior is correct (not adding space here).</p>
<h3>Expected Behaviour</h3>
<p>If there are still files or sub folders available for completion, no space should be added (same as in bash).</p>
<h3>Additional Context</h3>
<p>Based on discussion in https://github.com/clap-rs/clap/discussions/6176</p>
<h3>Debug Output</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-bug</span> added by @windsource on 2025-11-05 09:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-triage</span> added by @windsource on 2025-11-05 09:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-completion</span> added by @epage on 2025-11-05 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-medium</span> added by @epage on 2025-11-05 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">E-help-wanted</span> added by @epage on 2025-11-05 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-triage</span> removed by @epage on 2025-11-05 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../eclipse-ankaios/ankaios/issues/614.html">eclipse-ankaios/ankaios#614</a> on 2025-11-06 08:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/6203.html">clap-rs/clap#6203</a> on 2025-12-30 05:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2025-12-30 13:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:35 UTC
    </footer>
</body>
</html>
