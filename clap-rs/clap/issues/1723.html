<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Would like path_of - clap-rs/clap #1723</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Would like path_of</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1723">#1723</a>
        opened by <a href="https://github.com/njaard">@njaard</a>
        on 2020-03-04 23:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/njaard">@njaard</a> on 2020-03-04 23:47</div>
            <div class="timeline-body"><h3>Use case</h3>
<p>It's common to get a filename from clap with <code>value_of_os</code> and its companion <code>values_of_os</code>. You often want to turn it into a <code>Path</code> in order to pass it to <code>std::fs::File::open()</code>.</p>
<p>The only way I've been able to find to turn an <code>OsStr</code> into a <code>Path</code> is with <code>Path::new()</code>, which is a bit wordy. Therefor, it'd be nice be able to get Path objects directly.</p>
<h3>Proposed solution</h3>
<p>It'd be nice if there were a function like <code>Matches::path_of(name: &amp;str) -&gt; Option&lt;&amp;Path&gt;</code> so that you can get a <code>Path</code> in a single function call.</p>
<p>Alternate names for <code>path_of</code> might be the consistent but less concise <code>value_of_path</code> but that somehow reads grammatically different than <code>value_of_os</code>, not to mention being longer. Therefor, <code>path_of</code> sounds better.</p>
<p>Additionally, you'd want <code>paths_of</code> the way there is <code>values_of_os</code></p>
<p>Hypothetically, one could also make it reject (at <code>get_matches</code>-time) impossible <code>Path</code>s (on Windows, not all Paths are valid).</p>
<h3>Alternative solutions</h3>
<p>The standard library could get some sort of convenient shorthand for turning <code>OsStr</code> into <code>Path</code>. I think adding the function into <code>clap</code> serves the purpose better because it self-documents better while keeping std clean and explicit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @njaard on 2020-03-04 23:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Would like value_of_path" to "Would like path_of" by @njaard on 2020-03-04 23:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-05 07:36</div>
            <div class="timeline-body"><p>I'm not very excited about adding yet another output format, but we can make it if paths are really so common, perhaps under <code>value_of_as_path</code> and <code>values_of_as_paths</code> names. cc @pksunkara @Dylan-DPC what do you think?</p>
<blockquote>
<p>Hypothetically, one could also make it reject (at get_matches-time) impossible Paths (on Windows, not all Paths are valid).</p>
</blockquote>
<p>That's definitely up to user. Even <code>Path::from</code> doesn't validate it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njaard">@njaard</a> on 2020-03-05 19:14</div>
            <div class="timeline-body"><blockquote>
<p>I'm not very excited about adding yet another output format, but we can make it if paths are really so common, perhaps under <code>value_of_as_path</code> and <code>values_of_as_paths</code> names.</p>
</blockquote>
<p>CLI tools of course have filenames as a common use case.</p>
<blockquote>
<p>That's definitely up to user. Even Path::from doesn't validate it.</p>
</blockquote>
<p>Well, I was just speculating, but naturally if the user doesn't want it validated, they could just use <code>value_of_os</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-05 19:16</div>
            <div class="timeline-body"><p>Except, what does &quot;valid path&quot; means?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njaard">@njaard</a> on 2020-03-05 19:24</div>
            <div class="timeline-body"><blockquote>
<p>Except, what does &quot;valid path&quot; means?</p>
</blockquote>
<p>On Windows, a Path may not contain <code>&lt;</code>, <code>&gt;</code>, <code>|</code>, <code>&quot;</code>, <code>?</code>, <code>*</code>, and outside of drive letters, <code>:</code> <a href="https://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words">according to Wikipedia</a>. (I don't use Windows)</p>
<p>On Linux, I think there are no restrictions other than of course the null termination.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-05 19:38</div>
            <div class="timeline-body"><p>This kind of checking would be largely useless. The os facilities would check it anyway (<code>std::fs::*</code> in Rust), so I don't see the point to check it on our side.</p>
<p>Come to think about it, <code>value_of_as_path</code> is a trivial <code>value_of().map(Path::from)</code>; I'm very unconvinced about your proposal,  no offense. Let's hear out the other maintainers @TeXitoi @pksunkara @Dylan-DPC .</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TeXitoi">@TeXitoi</a> on 2020-03-05 20:12</div>
            <div class="timeline-body"><p>It would be only me, I'd say no. I'm not really convinced by the added feature.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-03-06 10:35</div>
            <div class="timeline-body"><p>It is definitely trivial. I would consider this one of those things where if more people request it, I wouldn't mind adding it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-06 11:37</div>
            <div class="timeline-body"><p>@pksunkara Which one? The checking or the conversion?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-03-06 11:43</div>
            <div class="timeline-body"><p>Conversion</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njaard">@njaard</a> on 2020-03-13 22:13</div>
            <div class="timeline-body"><p>Another compelling argument in favor is that I believe it's more teachable: If a user has an &amp;str, they can pass it directly into <code>File::open</code>, however, <code>OsStr</code> cannot be, it needs to be converted into a <code>Path</code> and not making it easy and automatic acts as another barrier to writing correct code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-13 22:57</div>
            <div class="timeline-body"><blockquote>
<p>If a user has an &amp;str, they can pass it directly into File::open, however, OsStr cannot be</p>
</blockquote>
<p>Good try, <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=6ea05e62eea4e6297d1ca97e6cdf9efe">but it can ðŸ˜®</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njaard">@njaard</a> on 2020-03-18 20:17</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>If a user has an &amp;str, they can pass it directly into File::open, however, OsStr cannot be</p>
</blockquote>
<p>Good try, <a href="https://play.rust-lang.org/?version=stable&amp;mode=debug&amp;edition=2018&amp;gist=6ea05e62eea4e6297d1ca97e6cdf9efe">but it can open_mouth</a></p>
</blockquote>
<p>Doh. Yes because File accepts <code>AsRef&lt;Path&gt;</code>, but when one writes basic application code, I think <code>&amp;Path</code> is more common. At least it is for me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-18 23:36</div>
            <div class="timeline-body"><blockquote>
<p>Doh. Yes because File accepts AsRef<Path>, but when one writes basic application code, I think &amp;Path is more common. At least it is for me.</p>
</blockquote>
<p>Well, the argument was about flattening the learning curve, wasn't it? I've swept through <code>std::fs::*</code> and found that the API uses <code>AsRef&lt;Path&gt;</code> instead of <code>&amp;Path</code> literally everywhere. In fact, you would want to use <code>Path</code> explicitly only when you want to query some property of the <code>Path</code> itself, like <code>extension</code> or <code>is_file</code>.</p>
<p>I see your point about <code>Path</code>s being commonplace, but it could use some acknowledgement. If and when at least two more people come here to ask for it, I'll have become open to accepting such a PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-06-30 10:13</div>
            <div class="timeline-body"><p>Closing as inactive. I don't think this feature is of any use, and, evidently, almost nobody wants it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @CreepySkeleton on 2020-06-30 10:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Dylan-DPC-zz">@Dylan-DPC-zz</a> on 2020-06-30 10:19</div>
            <div class="timeline-body"><p>Please don't close any issues just because nobody commented they needed it. There could always be a future feature request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @Dylan-DPC-zz on 2020-06-30 10:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/751.html">clap-rs/clap#751</a> on 2020-07-07 14:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/142.html">epage/clapng#142</a> on 2021-12-06 19:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> removed by @epage on 2021-12-08 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2021-12-08 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-08 21:15</div>
            <div class="timeline-body"><p>I believe https://github.com/clap-rs/clap/issues/2683 should supersede this, closing it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2021-12-08 21:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:34:08 UTC
    </footer>
</body>
</html>
