<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFC: Invalid Unicode Handling - clap-rs/clap #269</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>RFC: Invalid Unicode Handling</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/269">#269</a>
        opened by <a href="https://github.com/kbknapp">@kbknapp</a>
        on 2015-09-22 17:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kbknapp">@kbknapp</a> on 2015-09-22 17:49</div>
            <div class="timeline-body"><p>This issue is to discuss how invalid unicode should be handled in 2.x <strong>and</strong> 1.x</p>
<h3>Currently</h3>
<ul>
<li>Consumers have the option to <code>panic!</code> on invalid unicode (the default)</li>
<li>Consumers can get an <code>Err</code> on invalid unicode using the <code>*_safe()</code> methods</li>
<li>Consumers can get a lossy value where invalid unicode is replaced with <code>U+FFFD</code> using <code>*_lossy()</code> methods</li>
</ul>
<h4>Problems</h4>
<ul>
<li>Users <strong>cannot</strong> get values with invalid unicode (which is allowed on Unix systems for file names, paths, etc.)</li>
<li>All the <code>lossy</code>, <code>safe</code>, and <code>regular</code> version of <code>get_matches</code> is somewhat messy. Granted in practice it's not an issue because you only use one version of that method...but for API space it looks a mess.</li>
</ul>
<h3>Future</h3>
<p>One idea is to store the values internally in the <code>ArgMatches</code> struct as an <code>OsString</code> and by default give a <code>&amp;str</code>, but allows the users the option to get an <code>OsStr</code> instead. This is the <strong>opt-in</strong> to invalid unicode. I am a firm believer the default should be strict unicode, but we <strong>should</strong> allows users to handle invalid unicode if they so choose.</p>
<h4>Questions</h4>
<p>How does this affect Windows? Or does it even affect Windows? If yes, should we use a <code>#[cfg(not(windows))]</code>, or similar?</p>
<hr />
<p>Question, comments, suggestions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: intermediate</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P3: want to have</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: matches</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 1.x</span> added by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> removed by @kbknapp on 2015-09-22 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Tracking Issue: Invalid Unicode Handling" to "RFC: Invalid Unicode Handling" by @kbknapp on 2015-09-22 17:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/262.html">clap-rs/clap#262</a> on 2015-09-22 17:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sru">@sru</a> on 2015-09-22 18:15</div>
            <div class="timeline-body"><p>:+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "1.5" by @kbknapp on 2015-10-28 14:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "1.6.0" by @kbknapp on 2015-12-18 08:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "1.5" by @kbknapp on 2015-12-18 08:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-01-27 20:32</div>
            <div class="timeline-body"><p>Closed with 2x</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2016-01-27 20:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/remram44">@remram44</a> on 2016-02-08 17:20</div>
            <div class="timeline-body"><p>This is awesome! The ability to accept any filename is great, and the API is cool, and I love you all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2623.html">clap-rs/clap#2623</a> on 2021-08-02 08:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:31 UTC
    </footer>
</body>
</html>
