<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panics when parsing a single hyphen - clap-rs/clap #410</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Panics when parsing a single hyphen</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/410">#410</a>
        opened by <a href="https://github.com/cite-reader">@cite-reader</a>
        on 2016-02-03 02:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/cite-reader">@cite-reader</a></div>
            <div class="timeline-body"><p>Given the following minimal test case:</p>
<pre><code class="language-toml">[package]
name = &quot;repro&quot;
version = &quot;0.1.0&quot;

[dependencies]
clap = &quot;2.0.2&quot;
</code></pre>
<pre><code class="language-rust">extern crate clap;

fn main() {
    clap::App::new(&quot;repro&quot;).get_matches();
}
</code></pre>
<p>running the resulting executable as <code>./target/debug/repro -</code> produces the error <code>thread '&lt;main&gt;' panicked at 'index out of bounds: the len is 1 but the index is 1', /home/cite-reader/.multirust/toolchains/stable/cargo/registry/src/github.com-88ac128001ac3a9a/clap-2.0.2/src/osstringext.rs:42</code>.</p>
<p>Running with <code>RUST_BACKTRACE=1</code> additionally produces this wall of text:</p>
<pre><code>stack backtrace:
   1:     0x55d96739e470 - sys::backtrace::tracing::imp::write::haa19c02b4de52f3bG0t
   2:     0x55d9673a07a5 - panicking::log_panic::_&lt;closure&gt;::closure.41218
   3:     0x55d9673a0220 - panicking::log_panic::h527fe484e9de8fe1W7x
   4:     0x55d9673961a3 - sys_common::unwind::begin_unwind_inner::h51f64b1a34c60827fTs
   5:     0x55d967396538 - sys_common::unwind::begin_unwind_fmt::h0845853a1913f45blSs
   6:     0x55d96739dad1 - rust_begin_unwind
   7:     0x55d9673ccf2f - panicking::panic_fmt::h3967afc085fe8067LFK
   8:     0x55d9673cd0a2 - panicking::panic_bounds_check::h3ef0001c29fc27faREK
   9:     0x55d9673120ef - osstringext::_&lt;impl&gt;::starts_with::h26506bceadbe96d4Gkj
                        at /home/cite-reader/.multirust/toolchains/stable/cargo/registry/src/github.com-88ac128001ac3a9a/clap-2.0.2/src/osstringext.rs:42
  10:     0x55d967309837 - app::parser::_&lt;impl&gt;::get_matches_with::h2749516486128734984
                        at /home/cite-reader/.multirust/toolchains/stable/cargo/registry/src/github.com-88ac128001ac3a9a/clap-2.0.2/src/app/parser.rs:475
  11:     0x55d967307ed3 - app::_&lt;impl&gt;::get_matches_from_safe_borrow::h15298357069185562126
                        at /home/cite-reader/.multirust/toolchains/stable/cargo/registry/src/github.com-88ac128001ac3a9a/clap-2.0.2/src/app/mod.rs:788
  12:     0x55d967305b9f - app::_&lt;impl&gt;::get_matches_from::h16246934518760431591
                        at /home/cite-reader/.multirust/toolchains/stable/cargo/registry/src/github.com-88ac128001ac3a9a/clap-2.0.2/src/app/mod.rs:700
  13:     0x55d967305a9d - app::_&lt;impl&gt;::get_matches::h2e07d26000a6a67e1xf
                        at /home/cite-reader/.multirust/toolchains/stable/cargo/registry/src/github.com-88ac128001ac3a9a/clap-2.0.2/src/app/mod.rs:653
  14:     0x55d9672af440 - main::h3ed4f383bb959950faa
                        at src/main.rs:4
  15:     0x55d96739ffc4 - sys_common::unwind::try::try_fn::h11901883998771707766
  16:     0x55d96739d918 - __rust_try
  17:     0x55d96739fc66 - rt::lang_start::hc150f651dd2af18b44x
  18:     0x55d9672b2339 - main
  19:     0x7f67d556360f - __libc_start_main
  20:     0x55d9672af2e8 - _start
  21:                0x0 - &lt;unknown&gt;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cite-reader">@cite-reader</a> on 2016-02-03 05:02</div>
            <div class="timeline-body"><p>Is there a reason that <code>starts_with</code> method isn't just the following?</p>
<pre><code class="language-rust">fn starts_with(&amp;self, s: &amp;[u8]) -&gt; bool {
    self.as_bytes().starts_with(s)
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-02-03 14:35</div>
            <div class="timeline-body"><p>Thanks for taking the time to file this! I see you pushed a commit to your fork, feel free to submit the PR!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @kbknapp on 2016-02-03 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P2: need to have</span> added by @kbknapp on 2016-02-03 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @kbknapp on 2016-02-03 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2016-02-03 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 2.x</span> added by @kbknapp on 2016-02-03 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-02-03 14:48</div>
            <div class="timeline-body"><p>@cite-reader Also, your commit message is excellent! This is one of many things I need to work harder on (read, &quot;actually do&quot;).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/411.html">clap-rs/clap#411</a> on 2016-02-03 17:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @homu on 2016-02-04 07:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2016-02-04 11:07</div>
            <div class="timeline-body"><p>once #413 merges I'll put out the new version on crates.io</p>
<p>That PR also adds tests so we shouldn't run into this issue again.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:46:31 UTC
    </footer>
</body>
</html>
