```yaml
number: 3948
title: "Derive's case conversion removes non-ASCII BMP char"
type: issue
state: open
author: Rudxain
labels:
  - C-bug
  - E-medium
  - A-derive
assignees: []
created_at: 2022-07-19T07:49:31Z
updated_at: 2022-07-19T21:12:58Z
url: https://github.com/clap-rs/clap/issues/3948
synced_at: 2026-01-10T01:57:47Z
```

# Derive's case conversion removes non-ASCII BMP char

---

_Issue opened by @Rudxain on 2022-07-19 07:49_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

1.62.0 (a8314ef7d 2022-06-27)

### Clap Version

3.2.12

### Minimal reproducible code

```rust
use clap::Parser;

#[derive(Parser)]
#[clap()]
struct Cli {
	#[clap(long, action)]
	olé: bool,
	#[clap(long = "olé!", action)]
	olé1: bool,
	#[clap(long, action)]
	olé2: bool
}

fn main() {
	let cli = Cli::parse();
	println!("{} {} {}", cli.olé, cli.olé1, cli.olé2);
}
```

### Steps to reproduce the bug with the above code

```sh
cargo run -- --olé2
cargo run -- -h
cargo run -- --olé
```

### Actual Behaviour

`cargo run -- -h` output:
```
clap_bug 

USAGE:
    clap_bug [OPTIONS]

OPTIONS:
    -h, --help    Print help information
        --ol      
        --ol-2    
        --olé!
```

It affects both the `help` and the argument recognition. `--ol` is recognized, but not `--olé`, same happens to `--olé2`

### Expected Behaviour

`--olé`, `--olé!`, and `--olé2`should be recognized as-is

### Additional Context

_No response_

### Debug Output

_No response_

---

_Label `C-bug` added by @Rudxain on 2022-07-19 07:49_

---

_Label `A-derive` added by @epage on 2022-07-19 14:28_

---

_Renamed from "Non-ASCII BMP char disappears if not followed by another char" to "Derive's case conversion removes non-ASCII BMP char" by @epage on 2022-07-19 14:29_

---

_Comment by @epage on 2022-07-19 14:30_

Whats happening is that the derive will implicitly convert field names from snake_case to kebab-case.  This is what is dropping the characters and is why an explicit `long` works.

For example, the following works for me
```rust
#!/usr/bin/env -S rust-script --debug

//! ```cargo
//! [dependencies]
//! clap = { version = "3.2.8", features = ["derive"] }
//! ```

use clap::Parser;

#[derive(Parser)]
#[clap(rename_all = "verbatim")]
struct Cli {
    #[clap(long, action)]
    olé: bool,
    #[clap(long = "olé!", action)]
    olé1: bool,
    #[clap(long, action)]
    olé2: bool,
}

fn main() {
    let cli = Cli::parse();
    println!("{} {} {}", cli.olé, cli.olé1, cli.olé2);
}
```

---

_Label `E-medium` added by @epage on 2022-07-19 21:12_

---
