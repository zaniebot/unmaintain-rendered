<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>arg_enum! case insensitivity doesn't work with `possible_values` - clap-rs/clap #891</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>arg_enum! case insensitivity doesn&#x27;t work with <code>possible_values</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/891">#891</a>
        opened by <a href="https://github.com/LegNeato">@LegNeato</a>
        on 2017-03-07 19:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/LegNeato">@LegNeato</a></div>
            <div class="timeline-body"><p>Enum case insensitivity was add in <a href="https://github.com/kbknapp/clap-rs/issues/104">kbknapp/clap-rs#104</a>.</p>
<p>Unfortunetly, if you use <code>possible_values()</code> with your enum (for example, <code>possible_values(&amp;MyEnum::variants())</code>) case insensitivity is lost.</p>
<p>This means the helpful <code>clap</code> error message listing supported values cannot be used and one must handle it manually.</p>
Rust Version
<p><code>rustc 1.15.1 (021bd294c 2017-02-08)</code></p>
Affected Version of clap
<p><code>clap 2.20.3</code></p>
Expected Behavior Summary
<p>Because the enums are case-insensitive, I expected <code>possible_values</code> to be case insensitive as well.</p>
Actual Behavior Summary
<p>Using <code>possible_values</code> makes enums act like they are case-sensitive again.</p>
Steps to Reproduce the issue
<ol>
<li>Create an enum using <code>arg_enum!</code></li>
<li>Make sure a variant has a capital letter</li>
<li>Create an arg, set <code>possible_values</code> to the enum</li>
<li>See that clap treats <code>foo</code> and <code>Foo</code> input values differently</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-03-10 01:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-03-10 01:29</div>
            <div class="timeline-body"><p>Unfortunately, using <code>possible_values</code> has always been case sensitive. This is partly by design though, as there may exist cases where people wish to support different values which differ only in capitalization. Assuming you only want to support lowercase variants (which is the most common case by far), you could use something like</p>
<pre><code>&amp;MyEnum::variants().iter()
                   .map(std::ascii::AsciiExt::to_ascii_lowercase)
                   .collect::&lt;Vec&lt;_&gt;&gt;()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LegNeato">@LegNeato</a> on 2017-03-10 21:49</div>
            <div class="timeline-body"><p>Ah, ok. It was a bit counter-intuitive to read the issues about adding case-insentivity to <code>arg_enum</code> but still seeing case-sensitive behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/LegNeato">@LegNeato</a> on 2017-03-10 21:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:56:47 UTC
    </footer>
</body>
</html>
