<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pass `None` to `default_value_if`, or better adding `default_value_if_not_set`? - clap-rs/clap #2748</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Pass `None` to `default_value_if`, or better adding `default_value_if_not_set`?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/2748">#2748</a>
        opened by <a href="https://github.com/runapp">@runapp</a>
        on 2021-08-31 21:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/runapp">@runapp</a> on 2021-08-31 21:17</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
<h3>Clap Version</h3>
<p>2.33.3</p>
<h3>Describe your use case</h3>
<p>I found that I can't make an option that only has default value if another option (doesn't takes value) is not set. The closest way is like this:</p>
<pre><code class="language-rust">    let matches = App::new(&quot;test&quot;)
        .arg(Arg::with_name(&quot;A&quot;).short(&quot;A&quot;))
        .arg(Arg::with_name(&quot;B&quot;).short(&quot;B&quot;).default_value_if(&quot;A&quot;, None, &quot;&quot;).default_value(&quot;A not set&quot;))
        .get_matches();
    println!(&quot;A={} B={}&quot;,
        matches.value_of(&quot;A&quot;).unwrap_or(&quot;###&quot;),
        matches.value_of(&quot;B&quot;).unwrap_or(&quot;###&quot;),
    );
</code></pre>
<p>I was thinking of passing <code>None</code> to <code>default_value_if</code> might help emulate as if <code>-B</code> is never set (<code>is_present(&quot;B&quot;)==false</code>). But <code>default_value_if</code> only accepts <code>&amp;str</code> rather than <code>Option</code>.</p>
<h3>Describe the solution you'd like</h3>
<p>I don't know which would be better. Modifying current signature of <code>default_value_if</code> seems painful, and might bring endless <code>Some</code> to most common cases. So would add <code>default_value_if_not_set</code> be a choice?</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @runapp on 2021-08-31 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-09-04 10:11</div>
            <div class="timeline-body"><p>This is fixed on v3/master through a PR. What search terms did you use when searching for issues like this as requested?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-09-04 10:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:33 UTC
    </footer>
</body>
</html>
