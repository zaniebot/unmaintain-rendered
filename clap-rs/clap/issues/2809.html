<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triage Structopt PRs since the fork - clap-rs/clap #2809</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Triage Structopt PRs since the fork</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/2809">#2809</a>
        opened by <a href="https://github.com/epage">@epage</a>
        on 2021-10-04 19:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/epage">@epage</a></div>
            <div class="timeline-body">Discussed in https://github.com/clap-rs/clap/discussions/2658


<p>Originally posted by <strong>epage</strong> August  2, 2021
Dependabot notified me of a structopt update that included <a href="https://github.com/TeXitoi/structopt/pull/483">TeXitoi/structopt#483</a>.  This seems relevant for clap but made me wonder about the problem generally.</p>
<p>When was our last sync-up with structopt and how do we track it so things don&#x27;t fall through the cracks for future changes?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by <a href="https://github.com/epage">@epage</a> on 2021-10-04 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: enhancement</span> added by <a href="https://github.com/epage">@epage</a> on 2021-10-04 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: medium</span> added by <a href="https://github.com/epage">@epage</a> on 2021-10-04 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: derive macros</span> added by <a href="https://github.com/epage">@epage</a> on 2021-10-04 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;3.0&quot; by <a href="https://github.com/epage">@epage</a> on 2021-10-04 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-04 20:56</div>
            <div class="timeline-body"><p>ea76fa1b1b273e65e3b0b1046643715b49bec51f is the last commit in  https://github.com/clap-rs/clap_derive/commits/master?after=acea444f962a0d7c8126273739d4df8bdb152624+34&amp;branch=master from purely structopt.  It looks like some fixes went in since then but unsure which</p>
<p>Post fork, already ported</p>
<ul>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/143">TeXitoi/structopt#143</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/148">TeXitoi/structopt#148</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/146">TeXitoi/structopt#146</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/154">TeXitoi/structopt#154</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/158">TeXitoi/structopt#158</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/161">TeXitoi/structopt#161</a></li>
<li>[x] https://github.com/TeXitoi/structopt/commit/3d5f9bd063613dde84528624f7192c9eefb6ae21</li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/169">TeXitoi/structopt#169</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/186">TeXitoi/structopt#186</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/190">TeXitoi/structopt#190</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/191">TeXitoi/structopt#191</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/192">TeXitoi/structopt#192</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/193">TeXitoi/structopt#193</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/194">TeXitoi/structopt#194</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/195">TeXitoi/structopt#195</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/204">TeXitoi/structopt#204</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/198">TeXitoi/structopt#198</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/216">TeXitoi/structopt#216</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/213">TeXitoi/structopt#213</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/218">TeXitoi/structopt#218</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/221">TeXitoi/structopt#221</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/225">TeXitoi/structopt#225</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/231">TeXitoi/structopt#231</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/234">TeXitoi/structopt#234</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/236">TeXitoi/structopt#236</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/239">TeXitoi/structopt#239</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/244">TeXitoi/structopt#244</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/246">TeXitoi/structopt#246</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/248">TeXitoi/structopt#248</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/250">TeXitoi/structopt#250</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/252">TeXitoi/structopt#252</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/260">TeXitoi/structopt#260</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/271">TeXitoi/structopt#271</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/275">TeXitoi/structopt#275</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/279">TeXitoi/structopt#279</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/278">TeXitoi/structopt#278</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/282">TeXitoi/structopt#282</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/284">TeXitoi/structopt#284</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/281">TeXitoi/structopt#281</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/287">TeXitoi/structopt#287</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/290">TeXitoi/structopt#290</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/293">TeXitoi/structopt#293</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/302">TeXitoi/structopt#302</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/296">TeXitoi/structopt#296</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/313">TeXitoi/structopt#313</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/312">TeXitoi/structopt#312</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/325">TeXitoi/structopt#325</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/334">TeXitoi/structopt#334</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/314">TeXitoi/structopt#314</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/334">TeXitoi/structopt#334</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/346">TeXitoi/structopt#346</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/342">TeXitoi/structopt#342</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/381">TeXitoi/structopt#381</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/399">TeXitoi/structopt#399</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/400">TeXitoi/structopt#400</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/401">TeXitoi/structopt#401</a></li>
</ul>
<p>Start of new port series</p>
<ul>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/414">TeXitoi/structopt#414</a>, see #2821</li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/412">TeXitoi/structopt#412</a>, see <a href="https://github.com/clap-rs/clap/pull/2822">clap-rs/clap#2822</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/440">TeXitoi/structopt#440</a>, re-implemented in <a href="https://github.com/clap-rs/clap/pull/1992">clap-rs/clap#1992</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/448">TeXitoi/structopt#448</a>, see <a href="https://github.com/clap-rs/clap/pull/2823">clap-rs/clap#2823</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/450">TeXitoi/structopt#450</a>, <a href="https://github.com/clap-rs/clap/pull/2824">clap-rs/clap#2824</a></li>
<li>[ ] <a href="https://github.com/TeXitoi/structopt/pull/483">TeXitoi/structopt#483</a>, split out into <a href="https://github.com/clap-rs/clap/issues/2769">clap-rs/clap#2769</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/491">TeXitoi/structopt#491</a>, see <a href="https://github.com/clap-rs/clap/pull/2825">clap-rs/clap#2825</a></li>
<li>[x] <a href="https://github.com/TeXitoi/structopt/pull/494">TeXitoi/structopt#494</a>, see <a href="https://github.com/clap-rs/clap/pull/2826">clap-rs/clap#2826</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-04 20:58</div>
            <div class="timeline-body"><p>@pksunkara and @CreepySkeleton since you two were involved a lot during the late stages of <code>clap_derive</code>, <strong>if</strong> its quick to do a scan to see what is already ported to <code>clap_derive</code>, that&#x27;d be appreciated.  If not, I&#x27;m fully willing to take on doing this deep dive.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-05 21:33</div>
            <div class="timeline-body"><p>Looks like I found the point of divergence.  We have everything up to 401 and need 414 and after</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2821</a> on 2021-10-06 17:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2822</a> on 2021-10-06 17:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2823</a> on 2021-10-06 18:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2824</a> on 2021-10-06 18:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2825</a> on 2021-10-06 18:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2826</a> on 2021-10-06 18:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-10-09 02:24</div>
            <div class="timeline-body"><ul>
<li>[ ] No coverage for <a href="https://github.com/TeXitoi/structopt/pull/401/files#diff-57e8e1f836204e3d43fdd26c8c05d8aa25edc6db8c921f99f5d482c3f56e05a9R134">test</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2769</a> on 2021-10-11 19:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-11 19:28</div>
            <div class="timeline-body"><blockquote>
<pre><code>* [ ]  No coverage for [test](<a href="https://github.com/TeXitoi/structopt/pull/401">TeXitoi/structopt#401</a>/files#diff-57e8e1f836204e3d43fdd26c8c05d8aa25edc6db8c921f99f5d482c3f56e05a9R134)</code></pre>
</blockquote>
<p>I&#x27;m not even sure what that is trying to test; I forgot what structopt does when <code>flatten</code>ing in that context.</p>
<p>As for <code>clap_derive</code>, we don&#x27;t even allow an <code>enum</code> to <code>flatten</code> a <code>struct</code>, its a compiler error due to mismatched types.  Of the various combinations of bad <code>flatten</code> and <code>subcommand</code>, it looks like the only one we cover is</p>
<pre><code>#[derive(clap::Parser)]
struct Opt {
    #[clap(flatten)]
    sub: SubCmd,
}

#[derive(clap::Parser)]
enum SubCmd {}

fn main() {}
</code></pre>
<p>I&#x27;m mixed on the value of expanding out the rest of the combinations but either way, don&#x27;t think it would block 3.0.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-11 19:29</div>
            <div class="timeline-body"><p>I&#x27;m delegating the generics work to <a href="https://github.com/clap-rs/clap/issues/2769">clap-rs/clap#2769</a> which means we are done or practically done with this.  Rather than this lingering on for each new issue, I&#x27;m going to go ahead and close it.  We can create new issues for each additional structopt porting effort and prioritize accordingly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/epage">@epage</a> on 2021-10-11 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-10-11 20:33</div>
            <div class="timeline-body"><blockquote>
<p>As for clap_derive, we don&#x27;t even allow an enum to flatten a struct, its a compiler error due to mismatched types.</p>
</blockquote>
<p>Yeah, we need an UI test for that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a>clap-rs/clap#2850</a> on 2021-10-11 20:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:58:21 UTC
    </footer>
</body>
</html>
