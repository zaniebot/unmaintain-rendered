<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Please default to DisableVersionForSubcommands - clap-rs/clap #2812</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Please default to DisableVersionForSubcommands</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/2812">#2812</a>
        opened by <a href="https://github.com/joshtriplett">@joshtriplett</a>
        on 2021-10-04 21:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2021-10-04 21:46</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
<h3>Clap Version</h3>
<p>3.0.0-beta.4</p>
<h3>Describe your use case</h3>
<p>I have various subcommands, each of which has various options, and in the help for those subcommands, the display space and cognitive space of the user is precious. I don't want to show the <code>--version</code> option on subcommands, because it takes up one more line and one more bit of &quot;complexity at a glance&quot;.</p>
<h3>Describe the solution you'd like</h3>
<p>I'd propose that either <code>DisableVersionForSubcommands</code> should become the default, or a new <code>HideVersionForSubcommands</code> should become the default.</p>
<h3>Alternatives, if applicable</h3>
<p>I think it'd be fine if <code>--version</code> <em>worked</em> on subcommands; I just don't want it to show up in the help output. So, a <code>HideVersionForSubcommands</code> option would be fine, and would avoid any potential backwards compatibility issues.</p>
<h3>Additional Context</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @joshtriplett on 2021-10-04 21:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-05 15:18</div>
            <div class="timeline-body"><p>I'll be upfront, I'm unsure how we should go about a decision like this.</p>
<p>Something that might help is if we have an idea what precedent there is for current behavior and any of the proposed behaviors like we did for https://github.com/clap-rs/clap/issues/2808</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-10-05 18:51</div>
            <div class="timeline-body"><p>Forgot to mention, this is being carried over from https://github.com/clap-rs/clap/discussions/2627#discussioncomment-1308589</p>
<p>Two concerns I raised there</p>
<ul>
<li>As a user, its handy to be able to add a flag to my last command and it just work, rather than having to edit the entire command or type it over</li>
<li><code>cargo subcmd</code> maps to <code>cargo-subcmd subcmd</code>.  If we make DisableVersionForSubcommands the default, then <code>cargo subcmd --version</code> will not work by default.<ul>
<li>I wonder how often this pattern for external subcommands exists.  I know git doesn't do it</li>
<li>However, <code>cargo</code> is likely enough for people to plug into that I worry about people releasing without knowing they are missing <code>--version</code> and then them having to discover how to get it back</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2021-10-06 00:02</div>
            <div class="timeline-body"><p>Agreed that subcommands are rarely individually versioned. I'd be in favor of making the global version the default.</p>
<p>As for wanting to hide or disable <code>--version</code> from all subcommands I think that should be opt-in via <code>DisableVersionForSubcommands</code>.</p>
<p>Actually...now that I think about it. Why do we build/show a <code>--version</code> when no version exists? I.e. if the user hasn't set a version, we shouldn't present that as a flag. Granted, if we did this, my first statement about making global version the default would then still require @joshtriplett or similar use cases to do something like <code>DisableVersionForSubcommands</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2021-10-06 00:03</div>
            <div class="timeline-body"><p>To be clear, I'd like to address the building a <code>--version</code> when no version exists regardless. Doing that would solve the problem of this issue outright with no additional changes.</p>
<p>Making global versions the default could then be either addressed separately and either kicked down the road, or rejected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2831.html">clap-rs/clap#2831</a> on 2021-10-08 18:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @bors[bot] on 2021-10-09 16:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2021-10-11 09:25</div>
            <div class="timeline-body"><p>FWIW, another approach to solve this would be a different method to set the version, which only sets it for the top level command; effectively, combine setting version with setting a common option about --version.</p>
<p>That can be done post-3.0, so I don't think it needs to be a blocker.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../SeaQL/sea-orm/issues/664.html">SeaQL/sea-orm#664</a> on 2022-04-10 05:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../solana-labs/solana-program-library/issues/4511.html">solana-labs/solana-program-library#4511</a> on 2023-06-08 23:33</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:33 UTC
    </footer>
</body>
</html>
