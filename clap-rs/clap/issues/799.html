<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question: Can subcommands define arguments? - clap-rs/clap #799</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Question: Can subcommands define arguments?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/799">#799</a>
        opened by <a href="https://github.com/matthiasbeyer">@matthiasbeyer</a>
        on 2016-12-31 22:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/matthiasbeyer">@matthiasbeyer</a> on 2016-12-31 22:14</div>
            <div class="timeline-body"><p>I would love to have a way to pass arguments to subcommands, to build CLIs like this:</p>
<pre><code>foo bar &lt;argument&gt;
</code></pre>
<p>(I removed the template because no section applied to my problem). I'm not sure whether I told you this before... but a short google search and github search did not bring up anything useful...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthiasbeyer">@matthiasbeyer</a> on 2016-12-31 22:21</div>
            <div class="timeline-body"><p>@panicbit said on IRC that I should write &quot;positional arguments&quot;. :smile:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/panicbit">@panicbit</a> on 2016-12-31 23:54</div>
            <div class="timeline-body"><p>This actually seems to work already. Oddly I remember it not working though. Was this added recently?
Maybe it was subcommands and positional args being mutually exclusive?</p>
<p>Anyways, here is an example:</p>
<pre><code class="language-rust">extern crate clap;

use clap::{Arg, App, SubCommand};

fn main() {
    let matches = App::new(&quot;My Super Program&quot;)
        .subcommand(SubCommand::with_name(&quot;foo&quot;)
            .arg(Arg::with_name(&quot;BAR&quot;)
                .index(1)
                .required(true)
            )
        )
        .get_matches();
}
</code></pre>
<p>Which yields the following with <code>foo --help</code>:</p>
<pre><code>clapper-foo 

USAGE:
    clapper foo &lt;BAR&gt;

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;BAR&gt; 
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-01-01 03:41</div>
            <div class="timeline-body"><p>@panicbit Thanks!</p>
<p>@matthiasbeyer yep, they aleady work exactly like that. Subcommands are actually just aliases for <code>App</code>s. So anything <code>App</code> can do, so can a <code>SubCommand</code>. I know it's somewhat confusing so I'm actually just considering going to <code>Cmd</code> for both the <code>App</code> and <code>SubCommand</code> since're identical.</p>
<p>The reasoning behind going through two different names was they originally didn't have the same functionality. And it allowed you &quot;switch mental contexts&quot; between what you were doing.</p>
<p>Edit: <a href="https://docs.rs/clap/2.19.3/clap/struct.SubCommand.html">Here's the docs page</a>, which I think could be worded a little better to reduce confusion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2017-01-01 03:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Feature request: Arguments for subcommands." to "Quesiton: Can subcommands define arguments?" by @kbknapp on 2017-01-01 03:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Quesiton: Can subcommands define arguments?" to "Question: Can subcommands define arguments?" by @kbknapp on 2017-01-01 03:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-01-01 04:08</div>
            <div class="timeline-body"><blockquote>
<p>Was this added recently? Maybe it was subcommands and positional args being mutually exclusive?</p>
</blockquote>
<p>It's been in for quite a while. There may have been a bug at the time you tried it? Also there are some oddities like trying to use a value for a positional argument which happens to be the same as one of your subcommands (i.e.  trying to use <code>$ prog foo</code> for <code>$ prog &lt;positional&gt;</code> when <code>prog foo</code> is a valid subcommand as well...but this is super rare in reality, and would just require to use <code>$ prog -- foo</code> to solve it which is also conventional.). Recently added (as of last night) there is also a new setting to combat that issue, if it ever comes up (such as designing a CLI where you'd like some positional values to be the same your subcommands), see <a href="https://github.com/kbknapp/clap-rs/blob/3ca4a08f0f7da9046ceccc9debebc156f79053b1/src/app/settings.rs#L228-L248"><code>AppSettings::ArgsNegateSubcommands</code></a> for details (sorry it's not on docs.rs yet as I haven't put out the new version yet!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/panicbit">@panicbit</a> on 2017-01-03 12:08</div>
            <div class="timeline-body"><p>Sorry, I had some other stuff to do.</p>
<p>I just replicated my scenario and minified it:</p>
<pre><code>    App::new(&quot;App&quot;)
        .arg(Arg::with_name(&quot;foo&quot;)
            .required_unless(&quot;bar&quot;)
        )
        .subcommand(SubCommand::with_name(&quot;quux&quot;))
        .get_matches()
</code></pre>
<p>Results in:</p>
<pre><code>App 

USAGE:
    super &lt;foo&gt; [SUBCOMMAND]

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

ARGS:
    &lt;foo&gt;    

SUBCOMMANDS:
    bar     
    help    Prints this message or the help of the given subcommand(s)
</code></pre>
<p>I guess this is not a bug because of the <code>.required_unless</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/panicbit">@panicbit</a> on 2017-01-03 12:15</div>
            <div class="timeline-body"><p>But you can't specify subcommands in <code>required_unless</code> and co, which is an issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-01-03 13:18</div>
            <div class="timeline-body"><p>@panicbit you can use <a href="https://docs.rs/clap/2.19.3/clap/enum.AppSettings.html#variant.SubcommandsNegateReqs"><code>AppSettings:: SubcommandsNegateReqs</code></a> which does what you're looking for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/panicbit">@panicbit</a> on 2017-01-03 14:01</div>
            <div class="timeline-body"><p>Cool, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2017-01-03 21:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:07 UTC
    </footer>
</body>
</html>
