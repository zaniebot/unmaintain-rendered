<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add functions `required_unless_eq_any` and `required_unless_eq_all` for `Arg` and `ArgGroup` - clap-rs/clap #4682</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add functions `required_unless_eq_any` and `required_unless_eq_all` for `Arg` and `ArgGroup`</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/clap-rs/clap/issues/4682">#4682</a>
        opened by <a href="https://github.com/rob-p">@rob-p</a>
        on 2023-01-28 05:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/rob-p">@rob-p</a> on 2023-01-28 05:26</div>
            <div class="timeline-body"><h3>Please complete the following tasks</h3>
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/issues">open</a> and <a href="https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed">rejected</a> issues</li>
</ul>
<h3>Clap Version</h3>
<p>4.1.4</p>
<h3>Describe your use case</h3>
<p>I would like to define an argument or argument group that is required <em>unless</em> some other argument takes on a specific value.</p>
<p>This would be very useful in my use case (a tool processing single-cell gene expression data), because in some situations, when a particular common protocol is used and passed as the value to some argument (in this case called <code>--geometry</code>), the values of several other arguments can be inferred and should no longer be required.  However, if the <code>--geometry</code> is not one of these common values, then the other arguments should be required.</p>
<p>If the <code>--geometry</code> argument only took on a small number of possible values, then something like this might be possible with <code>required_if</code>, by listing all of the other values for which the argument should still be required.  However, in my use case, the potential values to <code>--geometry</code> are potentially unbounded since the user can provide custom values that are later parsed and interpreted by the program.  Thus, I need a way to specify a list of specific values for which other arguments should <em>not</em> be required.</p>
<h3>Describe the solution you'd like</h3>
<p>Just as there are now methods on <code>Arg</code> (and <code>ArgGroup</code>, I believe?) like <code>required_ifs</code> and <code>required_if_eq_any</code> and, I propose the addition of methods:</p>
<ul>
<li><code>required_unless_eq_any</code> and</li>
<li><code>required_unless_eq_all</code></li>
</ul>
<p>These do pretty much what it says on the label. The first says an argument or argument group is required unless <em>any</em> of the listed conditions are satisfied (i.e. some other argument has a particular value), and the second says an argument or argument group is required unless <em>all</em> of the listed conditions are satisfied.</p>
<p>Given the existence of the other functions that are already present for related functionality, these seem a natural addition.</p>
<h3>Alternatives, if applicable</h3>
<p><em>No response</em></p>
<h3>Additional Context</h3>
<p>I brought up a discussion about this <a href="https://github.com/clap-rs/clap/discussions/4677">here</a>, but I am pretty sure that no way currently exists to accomplish this without the functionality requested above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @rob-p on 2023-01-28 05:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2023-02-23 21:23</div>
            <div class="timeline-body"><p>Sorry for the slow response!</p>
<p>Another route for this is to extend <a href="https://docs.rs/clap/latest/clap/builder/enum.ArgPredicate.html"><code>ArgPredicate</code></a>.</p>
<p>A challenge we have is there is an arbitrary set of functionality people ask of clap while we are working on shrinking clap (#2037, #1365) and we have been exploring other ways of handling this in #3476. This makes me hesitant every time there is a new request for an additional variant of existing functionality.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-decision</span> added by @epage on 2023-02-23 21:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-validators</span> added by @epage on 2023-02-23 21:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3008.html">clap-rs/clap#3008</a> on 2023-05-03 14:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/6030.html">clap-rs/clap#6030</a> on 2025-06-10 15:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:35:20 UTC
    </footer>
</body>
</html>
