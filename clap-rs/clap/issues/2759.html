<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow iterating over ArgMatches and check whether a match uses default value - clap-rs/clap #2759</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow iterating over ArgMatches and check whether a match uses default value</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/2759">#2759</a>
        opened by <a href="https://github.com/romange">@romange</a>
        on 2021-09-09 09:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/romange">@romange</a></div>
            <div class="timeline-body">Please complete the following tasks
<ul>
<li>[X] I have searched the <a href="https://github.com/clap-rs/clap/discussions">discussions</a></li>
<li>[X] I have searched the existing issues</li>
</ul>
Clap Version
<p>3.0.0-beta</p>
Describe your use case
<p>Use case: I would like to merge ArgMatches into Config settings using the following rules:</p>
<ol>
<li>ArgMatches have higher precedence over Config if they are explicitly set.</li>
<li>If config setting is present but ArgMatches has an argument with default value then config value is taken.</li>
<li>If config does not set the setting, then ArgMatches default value it taken.</li>
</ol>
<p>In order to do this, I would need to iterate over ArgMatches.args and query  <code>MatchedArg.ty</code> field.</p>
Describe the solution you&#x27;d like
<p>Some sort of interface that allows me to do this.</p>
Alternatives, if applicable
<p>Currently, I have to declare all fields in clap structure with <code>Option&lt;&gt;</code> and without default values in order to expose similar semantics. For example,</p>
<pre><code>struct MyOpts {
    #[clap(short, long, default_value=&quot;80&quot;)]
    port: Option&lt;u16&gt;,
}
</code></pre>
<p>instead of</p>
<pre><code>struct MyOpts {
    #[clap(short, long, default_value=&quot;8080&quot;)]
    port: u16,
}
</code></pre>
Additional Context
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by <a href="https://github.com/romange">@romange</a> on 2021-09-09 09:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-09-09 13:54</div>
            <div class="timeline-body"><p>While, in general, I think there is value in</p>
<ul>
<li>Allowing iterating</li>
<li>exposing <code>ArgType</code> (though maybe giving it a more meaningful name, like <code>ArgSource</code></li>
</ul>
<p>For layered config, I&#x27;m a bit unsure on this approach.  I&#x27;ve split layered config talk out to <a href="https://github.com/clap-rs/clap/discussions/2763">a discussion</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-09-23 12:54</div>
            <div class="timeline-body"><p>This issue is a duplicate of #1206 and thus we are closing this.</p>
<p>I would appreciate if you could tell us more about why you were not able to find the original issue. You marked that you have searched the existing issues. What search terms did you use?</p>
<p>This questions is asked in the attempt to understand if there are any other contexts/cases related to the issue that we missed discussing originally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-09-23 12:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:58:17 UTC
    </footer>
</body>
</html>
