<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>clap_derive does not respect name attribute for enums - clap-rs/clap #2181</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>clap_derive does not respect name attribute for enums</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/2181">#2181</a>
        opened by <a href="https://github.com/newAM">@newAM</a>
        on 2020-10-22 23:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/newAM">@newAM</a></div>
            <div class="timeline-body"><h3>Code</h3>
<pre><code class="language-rust">use clap::Clap;

#[derive(Clap)]
#[clap(name = &quot;mybin&quot;, version = clap::crate_version!())]
enum Opts {}

fn main() {
    Opts::parse();
}
</code></pre>
<p>Full repository here: https://github.com/newAM/clap-issue</p>
<h3>Steps to reproduce the issue</h3>
<ol>
<li><code>git clone git@github.com:newAM/clap-issue.git</code></li>
<li><code>cd clap-issue</code></li>
<li><code>cargo run -- -V</code></li>
</ol>
<h3>Version</h3>
<ul>
<li><strong>Rust</strong>: <code>rustc 1.47.0 (18bf6b4f0 2020-10-07)</code></li>
<li><strong>Clap</strong>: fad3d9632ebde36004455084df2c9052afe40855 (<code>master</code>)</li>
</ul>
<h3>Actual Behavior Summary</h3>
<pre><code>$ cargo run -- -V                                          
    Finished dev [unoptimized + debuginfo] target(s) in 0.01s
     Running `target/debug/cli -V`
cli 0.1.0
</code></pre>
<h3>Expected Behavior Summary</h3>
<p>I expect <code>name = &quot;mybin&quot;</code> to set the name for the application, and the output should then look like this.</p>
<pre><code>$ cargo run -- -V                                          
    Finished dev [unoptimized + debuginfo] target(s) in 0.01s
     Running `target/debug/cli -V`
mybin 0.1.0
</code></pre>
<h3>Additional context</h3>
<p>This <em>only</em> occurs for enums, when using a struct this matches the expected behaviour:</p>
<pre><code class="language-rust">use clap::Clap;

#[derive(Clap)]
#[clap(name = &quot;mybin&quot;, version = clap::crate_version!())]
struct Opts {}

fn main() {
    Opts::parse();
}
</code></pre>
<pre><code>$ cargo run -- -V                                          
    Finished dev [unoptimized + debuginfo] target(s) in 0.01s
     Running `target/debug/cli -V`
mybin 0.1.0
</code></pre>
<p>In addition to impacting <code>-V</code> and <code>--version</code> this also impacts completion scripts generated with <code>clap</code>.</p>
<h3>Debug output</h3>
<details>
<summary> Debug Output </summary>
<pre>
<code>
[            clap::build::app]  App::_do_parse
[            clap::build::app]  App::_build
[            clap::build::app]  App::_propagate:cli
[            clap::build::app]  App::_derive_display_order:cli
[            clap::build::app]  App::_create_help_and_version
[            clap::build::app]  App::_create_help_and_version: Building --help
[            clap::build::app]  App::_create_help_and_version: Building --version
[clap::build::app::debug_asserts]       App::_debug_asserts
[            clap::build::arg]  Arg::_debug_asserts:help
[            clap::build::arg]  Arg::_debug_asserts:version
[         clap::parse::parser]  Parser::get_matches_with
[         clap::parse::parser]  Parser::_build
[         clap::parse::parser]  Parser::_verify_positionals
[         clap::parse::parser]  Parser::get_matches_with: Begin parsing '"-V"' ([45, 86])
[         clap::parse::parser]  Parser::is_new_arg: "-V":NotFound
[         clap::parse::parser]  Parser::is_new_arg: arg_allows_tac=false
[         clap::parse::parser]  Parser::is_new_arg: - found
[         clap::parse::parser]  Parser::is_new_arg: starts_new_arg=true
[         clap::parse::parser]  Parser::possible_subcommand: arg="-V"
[         clap::parse::parser]  Parser::get_matches_with: possible_sc=false, sc=None
[         clap::parse::parser]  Parser::parse_short_arg: full_arg="-V"
[         clap::parse::parser]  Parser::parse_short_arg:iter:V
[         clap::parse::parser]  Parser::parse_short_arg:iter:V: Found valid opt or flag
[         clap::parse::parser]  Parser::check_for_help_and_version_char
[         clap::parse::parser]  Parser::check_for_help_and_version_char: Checking if -V is help or version...
[         clap::parse::parser]  Version
[         clap::parse::parser]  Parser::version_err
[            clap::build::app]  App::_render_version
[         clap::parse::parser]  Parser::color_help
[           clap::output::fmt]  is_a_tty: stderr=false
cli 0.1.0
</code>
</pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: bug</span> added by @newAM on 2020-10-22 23:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">:money_with_wings: $5</span> added by @pksunkara on 2020-10-23 09:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: derive macros</span> added by @pksunkara on 2020-10-23 09:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "3.0" by @pksunkara on 2020-10-23 09:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2189.html">clap-rs/clap#2189</a> on 2020-10-30 15:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: easy</span> added by @pksunkara on 2021-02-08 05:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">Z: good first issue</span> added by @pksunkara on 2021-02-08 05:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-02-22 09:35</div>
            <div class="timeline-body"><p>@logansquirel This is a good one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2358.html">clap-rs/clap#2358</a> on 2021-02-22 14:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pksunkara on 2021-02-22 16:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:47:47 UTC
    </footer>
</body>
</html>
