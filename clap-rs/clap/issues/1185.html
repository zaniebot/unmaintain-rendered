<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Provide a `Arg::custom_parse` style function - clap-rs/clap #1185</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Provide a <code>Arg::custom_parse</code> style function</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/clap-rs/clap/issues/1185">#1185</a>
        opened by <a href="https://github.com/kbknapp">@kbknapp</a>
        on 2018-02-16 03:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-02-16 03:10</div>
            <div class="timeline-body"><p>Something I've been thinking about for a while and mentioned in BurntSushi/ripgrep#809 is to add some additional functions which allow users to do something mid parse. From the linked issue:</p>
<blockquote>
<p>The other way would involve something I've been thinking about, which is to provide companions to the validators, namely the ability to provide functions to Filter/Skip, Map, and Action arguments mid parse. These would do things such as do something potentially impure (Action), allow one to filter/skip values (Filter/Skip haven't decide on naming yet), or transform actual values themselves (Map) to be saved in the matches struct. These would all have access to the matches struct as it exists at that time, in order to perform decisions or possibly even mutate. I should say though that this method is further off and would not be available until v3 at the earliest (if ever, pending design and implementation, etc.).</p>
</blockquote>
<p>However, now that I'm thinking about it, all three of those could actually be combined into a single <code>Arg::custom_parse</code> which accepts a function that takes the arg/value currently being parsed, and returns an <code>Option&lt;T&gt;</code> where <code>None</code> is skip this value (i.e. parse it as a different arg), or <code>Some(T)</code> is &quot;save this to the matches&quot; it could be the value as passed in, or it could be something different entirely (i.e. a <code>map</code>).</p>
<p>This could also require a few companion methods on the matches struct that allows mutation. I'd like to expose these on a newtype wrapper <code>PartialMatches(ArgMatches)</code> so as not to expose these mutation functions on a regular basis. Functions could be something like <code>PartialMatches::remove_{value,arg}</code>, <code>PartialMatches::add_{value,arg}</code>, etc. It would also have all the normal <code>ArgMatches</code> methods provided via a facade.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @kbknapp on 2018-02-16 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">D: intermediate</span> added by @kbknapp on 2018-02-16 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">P3: want to have</span> added by @kbknapp on 2018-02-16 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C: parsing</span> added by @kbknapp on 2018-02-16 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> added by @kbknapp on 2018-02-16 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v3.0" by @kbknapp on 2018-07-22 02:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zooce">@Zooce</a> on 2019-07-16 15:55</div>
            <div class="timeline-body"><p>This is exactly what I'm looking for. I have a use case where I'd like to give the user the ability to abbreviate a positional argument if they want to. I could then use the <code>custom_parse</code> (or whatever) function to see if they did abbreviate, and if so, map it to the full argument.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1206.html">clap-rs/clap#1206</a> on 2020-04-27 17:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: 3.x</span> removed by @pksunkara on 2021-05-26 03:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "3.0" by @pksunkara on 2021-05-26 10:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2021-05-26 10:57</div>
            <div class="timeline-body"><p>Probably related #1880</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../bootandy/dust/pulls/147.html">bootandy/dust#147</a> on 2021-06-05 13:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/88.html">epage/clapng#88</a> on 2021-12-06 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/90.html">epage/clapng#90</a> on 2021-12-06 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> removed by @epage on 2021-12-08 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2021-12-08 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2683.html">clap-rs/clap#2683</a> on 2021-12-09 18:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2021-12-09 18:10</div>
            <div class="timeline-body"><p>Going to close this in favor of #2683.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2021-12-09 18:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-wont-fix</span> added by @epage on 2022-01-11 18:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:40 UTC
    </footer>
</body>
</html>
