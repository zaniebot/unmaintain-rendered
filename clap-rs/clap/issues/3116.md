```yaml
number: 3116
title: "Using a struct's `Default::default`, instead of a field type's `Default::default`"
type: issue
state: open
author: epage
labels:
  - C-enhancement
  - A-derive
  - S-waiting-on-design
assignees: []
created_at: 2021-12-09T16:11:56Z
updated_at: 2025-10-13T14:47:33Z
url: https://github.com/clap-rs/clap/issues/3116
synced_at: 2026-01-10T01:57:46Z
```

# Using a struct's `Default::default`, instead of a field type's `Default::default`

---

_Issue opened by @epage on 2021-12-09 16:11_

Maintainer's notes
- We can use the field's `Default::default` with `#[clap(default_value_t)]`
- Design work is needed for using the container's `Default::default`
---
<a href="https://github.com/epage"><img src="https://avatars.githubusercontent.com/u/60961?v=4" align="left" width="96" height="96" hspace="10"></img></a> **Issue by [epage](https://github.com/epage)**
_Thursday May 03, 2018 at 13:17 GMT_
_Originally opened as https://github.com/TeXitoi/structopt/issues/105_

----

It'd be nice to have annotations like serde for default values
- Use the struct's Default impl
- Use the field's Default impl


---

_Comment by @epage on 2021-12-09 16:11_

<a href="https://github.com/TeXitoi"><img src="https://avatars.githubusercontent.com/u/5787066?v=4" align="left" width="48" height="48" hspace="10"></img></a> **Comment by [TeXitoi](https://github.com/TeXitoi)**
_Thursday May 03, 2018 at 13:38 GMT_

----

The problem is that, most of the time, clap will not be able to show the default value (because just a few types implement Display).


---

_Comment by @epage on 2021-12-09 16:17_

`default_value_t` allows you to do the type's `Default` impl or a custom value of the type, so long as the type implements `Display`.

---

_Closed by @epage on 2021-12-09 16:17_

---

_Label `A-derive` added by @epage on 2021-12-09 16:41_

---

_Comment by @epage on 2021-12-14 14:29_

I missed the case of using the container's `Default::default`.  The question is how to specify this.  Serde does this by having a container-level `default` attribute but for us to do that, we would make all fields optional.  This would require a weird handling of structs to use `flatten` to leverage it or a new way to specify it at the field level

---

_Reopened by @epage on 2021-12-14 14:29_

---

_Label `S-waiting-on-design` added by @epage on 2021-12-14 14:29_

---

_Referenced in [clap-rs/clap#748](../../clap-rs/clap/issues/748.md) on 2021-12-14 14:38_

---

_Label `C-enhancement` added by @epage on 2022-05-11 20:27_

---

_Referenced in [clap-rs/clap#3720](../../clap-rs/clap/issues/3720.md) on 2022-05-11 20:28_

---

_Comment by @epage on 2025-10-13 14:46_

From #6128

> An unstable Rust feature allows for setting default values on fields directly. We'll need to evaluate how to integrate that into clap as that moves towards stabilization.

Would also be good to see how serde handles that and seek to mirror it

---

_Renamed from "`serde`-like default value behavior" to "Using a struct's `Default::default`, instead of a field type's `Default::default`" by @epage on 2025-10-13 14:47_

---
