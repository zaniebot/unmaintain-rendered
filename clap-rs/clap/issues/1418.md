```yaml
number: 1418
title: "[feature request] derive for enums from outside of clap lib"
type: issue
state: closed
author: xoac
labels:
  - A-derive
assignees: []
created_at: 2019-02-19T15:13:14Z
updated_at: 2020-04-23T02:18:11Z
url: https://github.com/clap-rs/clap/issues/1418
synced_at: 2026-01-10T01:57:42Z
```

# [feature request] derive for enums from outside of clap lib

---

_Issue opened by @xoac on 2019-02-19 15:13_

It would be great to allow people to not include `clap` in library but still easy allow use that enums in CLI (binary) without execs of code. I think the current solution is quite good. But in my opinion it would be better instead of using `args_enum!` show that u can use for example [strum](https://crates.io/crates/strum) to derive `FromStr`, `Display` and `Iterator` over that enum, and easy use it with clap. Rust love code reusing. This could be done for 0.3 as it could require some breaking changes. 

The current strum version compile and work with clap but I wrote some extra code to make it work. 

Example:
```rust
#[derive(Debug, ParialEq, Clone, Hash, Deserialize, Serialize)]
#[derive(Display, EnumString, EnumIter)] //to work with clap
#[serde(rename_all = "lowercase")]
pub enum Gain {
    X1,
    X2,
    X4,
    X8,
    X16,
}    

// the extra code that is ugly!
let possible_values = Gain::iter()
          .map(|item| item.to_string())
          .collect::<Vec<_>>();

let possible_values_ref = possible_values
          .iter()
          .map(|st| st.as_ref())
          .collect::<Vec<_>>();


let gain_subcmd = SubCommand::with_name("gain")
                .about("Set gain for module")
                .arg(
                    Arg::with_name("current")
                        .long("current")
                        .takes_value(true)
                        .number_of_values(1)
                        .possible_values(&possible_values_ref)
                        .case_insensitive(true)
                );
```

What do u guys think to:
- add this to example for possible usecase?
- add additional information to doc -- that u don't need to use `arg_enum!` if u don't like.
- do this as default behavior for 0.3.x

Of course this is only idea. It doesn't need to be `strum` and if it may require some PR to clap or stum for example `possible_values()` can accept iterator instead of slice or strum should generate slice of possible string. 



---

_Renamed from "derive for enums from outside of clap lib" to "[feature request] derive for enums from outside of clap lib" by @xoac on 2019-02-20 11:41_

---

_Comment by @lpil on 2019-10-07 19:12_

strum seems to now have a `EnumVariantNames` for this situation

---

_Label `clap-derive-related` added by @CreepySkeleton on 2020-02-01 15:07_

---

_Label `C: derive macros` added by @pksunkara on 2020-02-03 09:19_

---

_Label `clap-derive-related` removed by @pksunkara on 2020-02-03 09:19_

---

_Added to milestone `3.0` by @pksunkara on 2020-04-12 20:28_

---

_Label `C: arg enums` added by @pksunkara on 2020-04-12 20:28_

---

_Comment by @pksunkara on 2020-04-22 08:34_

Unfortunately, this is not enough. The `from_str` needs to also care about `case_insensitive` which is not supported by strum. You can see the linked PR for the trait's function signatures.

---

_Closed by @bors[bot] on 2020-04-22 18:24_

---

_Comment by @xoac on 2020-04-23 02:18_

@pksunkara 
The idea was just to use separate crate (not exactly strum) that just works with string and enums. The case_insensitive feature could be added to that external crate if author would like to cooperate. But it looks like more complicated task (for example there is also need support for aliases). 

For example [EnumString](https://github.com/Peternator7/strum/wiki/Derive-EnumString) do some magic with `Default::default()`.

Probably the best option for now is use `From`  `Into` traits and just copy fields for outside enum.


---
