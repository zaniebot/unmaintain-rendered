<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#[derive(Clap)] should support empty structs - clap-rs/clap #1705</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>#[derive(Clap)] should support empty structs</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1705">#1705</a>
        opened by <a href="https://github.com/emilazy">@emilazy</a>
        on 2020-02-25 16:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/emilazy">@emilazy</a> on 2020-02-25 16:42</div>
            <div class="timeline-body"><h3>Describe your use case</h3>
<p>This is obviously trivial compared to just doing <code>struct Args {}</code>, but it would be nice to maintain Rust's general consistency in allowing the same things for all three forms.</p>
<h3>Describe the solution you'd like</h3>
<pre><code>#[derive(Clap)]
struct UnitLikeStruct;

#[derive(Clap)]
struct EmptyTupleStruct();
</code></pre>
<h3>Additional context</h3>
<pre><code>error: `#[derive(Clap)]` only supports non-tuple structs and enums
   |
   | #[derive(Clap)]
   |          ^^^^
   |
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: new feature</span> added by @emilazy on 2020-02-25 16:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/emilazy">@emilazy</a> on 2020-02-25 16:43</div>
            <div class="timeline-body"><p>Arguably newtypes (single-element tuple structs) could be supported too, but that's less clear-cut.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pksunkara">@pksunkara</a> on 2020-02-25 16:47</div>
            <div class="timeline-body"><p>There was already some discussion on this, https://github.com/clap-rs/clap_derive/pull/19</p>
<blockquote>
<p>I don't really see why this is useful. There's no real difference between struct Foo and struct Foo {}, the second works already. We may also want to give some special meaning to unit structs in future, so let's leave it as is for now.</p>
</blockquote>
<p>Empty tuple structs would fall into the same category.</p>
<p>But, single tuple struct could be a different issue. Do we support any tuple structs at all in the derive library?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/emilazy">@emilazy</a> on 2020-02-25 16:52</div>
            <div class="timeline-body"><p>I don't think it would be a good idea to give them a different meaning; in general Rust tries to make them all behave as similarly as possible, and there's been a consistent pattern of RFCs unifying functionality and behaviour between all three so that everything works between them (<code>.0</code> etc.).</p>
<p>I tend to make all empty structs unit-like structs by default, for general style reasons, and it does have one slight &quot;advantage&quot; (you get a free <code>const</code> for it); I found it surprising to be unable to derive Clap for them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-27 15:36</div>
            <div class="timeline-body"><p>@emilazy I'm not very excited of &quot;general style reasons&quot; argument because, you know, so many man, so many minds. Everybody tends to push their own way of making things roll; some people (myself included) like &quot;different types of items - different behavior&quot;, some adore &quot;similar enough - same behavior&quot;. It's merely a matter of taste, and whenever you start arguing about personal taste it becomes &quot;it must change just because I think it's beautiful&quot; thing real quick. So I'm going to be tenacious here and just stubbornly say that unless I hear very strong voice for the unification (something like a dozen of &quot;I want it too&quot; comments here) I'm not changing my mind.</p>
<blockquote>
<p>in general Rust tries to make them all behave as similarly as possible, and there's been a consistent pattern of RFCs unifying functionality and behaviour between all three so that everything works between them (.0 etc.).</p>
</blockquote>
<p><em>This</em> is pretty good argument but only if <strong>some of those RFCs were accepted</strong>. Unfortunately, I haven't been able to find one of those; could you please share a link or two with us?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Dylan-DPC-zz">@Dylan-DPC-zz</a> on 2020-03-02 09:27</div>
            <div class="timeline-body"><p>I agree with @emilazy here. If in rust <code>struct Foo {}</code> and <code>struct Foo;</code>are the same, then the corresponding derive behaviour should also be equivalent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-03-02 09:36</div>
            <div class="timeline-body"><p>Hmm, according to the <a href="https://doc.rust-lang.org/stable/reference/items/structs.html">Rust reference</a>, they are the same-ish <code>StructStruct</code> entity, indeed:</p>
<pre><code>Struct :
      StructStruct
   | TupleStruct

StructStruct :
   struct IDENTIFIER  Generics? WhereClause? ( { StructFields? } | ; )

TupleStruct :
   struct IDENTIFIER  Generics? ( TupleFields? ) WhereClause? ;
</code></pre>
<p>So <em>maybe</em> it really worth the candle, but tuple structs differ from the others even at the syntax level.</p>
<p>I think that, if the other members think unit structs should be supported, than we can do that, but I'm not OK with tuple structs, empty or not, unless somebody comes up with a real world use case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TeXitoi">@TeXitoi</a> on 2020-03-02 09:49</div>
            <div class="timeline-body"><p>Empty struct with braces was added quite later, thus there is no really difference between <code>struct Foo {}</code> and <code>struct Foo;</code></p>
<p>https://github.com/rust-lang/rfcs/blob/master/text/0218-empty-struct-with-braces.md (edited with the official repository)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1716.html">clap-rs/clap#1716</a> on 2020-03-02 10:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @bors[bot] on 2020-03-02 16:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
