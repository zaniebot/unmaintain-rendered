<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question/Feature request: Any way to do required_ifs &quot;flags exists&quot;. - clap-rs/clap #1126</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Question/Feature request: Any way to do required_ifs &quot;flags exists&quot;.</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/clap-rs/clap/issues/1126">#1126</a>
        opened by <a href="https://github.com/8176135">@8176135</a>
        on 2017-12-12 04:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/8176135">@8176135</a> on 2017-12-12 04:54</div>
            <div class="timeline-body"><p>Clap version: 2.29.0</p>
<p>I'll start with the problem I am trying to solve:
I have the flags -A, -B, -C, which are all optional by themselves. However, if <strong>both</strong> -A, and -B are used, -C must also be used. (-C takes some values that -A and -B need)</p>
<ul>
<li><p>Clap has <code>required_unless_all(name)</code>, but doesn't have the opposite of that e.g. <code>required_if_all(name)</code>?</p>
</li>
<li><p>I know clap has <code>required_ifs()</code>, but that compares the input from an argument with a value, but the value doesn't matter in this case, only that the flags are present or not.</p>
</li>
<li><p>Having <code>requires()</code> on -A and -B also won't work in this case, as only having one of them will make -C required.</p>
</li>
<li><p><code>requires_all()</code> does the opposite of what I want, requiring both -A and -B to be used -C can be used</p>
</li>
</ul>
<p>None of the above is unexpected, (the documentation is really good at explaining each option üëç ), but there doesn't seem to be a <code>required_if_all([names])</code>. Any ideas?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-01-09 16:51</div>
            <div class="timeline-body"><p>I'm not opposed to adding something like that, however I'll explain why it doesn't exist (yet).</p>
<p>When dealing with flags and requirements, since they are a simple on/off switch, if you know <code>-A</code> and <code>-B</code> requires <code>-C</code> (as the programmer), you could just act <em>as if</em> <code>-C</code> was used. I'd recommend telling the user via a help message or something, (&quot;using <code>-A</code> and <code>-B</code> together <em>implies</em> <code>-C</code>&quot;, etc.).</p>
<p>From a UX standpoint, the user isn't supplying any additional information by being forced to pass <code>-C</code> since it's a flag. The only thing they're saying is essentially, &quot;I know the -C switch is required.&quot;</p>
<p>The only time requiring an additional flag is a good idea is when the task is destructive (like deleting, etc.) and the user needs to confirm that they're sure they know what they're doing (by including the flag) such as <code>--force</code> usually, or <code>-D</code> in <code>git branch</code>.</p>
<p>However, in these circumstances it's far better to have a custom error message telling the user what is about to happen and <em>why</em> the extra flag is required. A generic clap error of, &quot;-C is required but wasn't used&quot; could actually be harmful here, since the user will almost always just blindly copy the <code>-C</code> argument and not know why.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> added by @kbknapp on 2018-01-09 16:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-07-22 02:49</div>
            <div class="timeline-body"><p>Closing for now to get 3.x out the door. We can re-address after release if needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kbknapp on 2018-07-22 02:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: after v3 release</span> added by @kbknapp on 2018-07-22 02:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CreepySkeleton">@CreepySkeleton</a> on 2020-02-02 02:18</div>
            <div class="timeline-body"><p>I'm leaving it closed for the time being</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">W: after v3 release</span> removed by @pksunkara on 2021-05-26 11:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @pksunkara on 2021-05-26 11:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../epage/clapng/issues/84.html">epage/clapng#84</a> on 2021-12-06 16:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">T: RFC / question</span> removed by @epage on 2021-12-08 21:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">C-enhancement</span> added by @epage on 2021-12-08 21:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">A-validators</span> added by @epage on 2021-12-09 18:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">S-waiting-on-design</span> added by @epage on 2021-12-09 18:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/messense">@messense</a> on 2022-01-15 08:59</div>
            <div class="timeline-body"><p>Is there any way to do &quot;required if other options present&quot;? For example <code>--tls-key &lt;PATH&gt;</code> is only required if <code>--tls-cert &lt;PATH&gt;</code> is present.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2022-01-17 15:48</div>
            <div class="timeline-body"><p>Interesting.  We support &quot;present&quot; for defaults but not requires or required.</p>
<p>#3008 has the potential for making our required, requires, defaults, etc more general.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/epage">@epage</a> on 2025-06-10 15:35</div>
            <div class="timeline-body"><p>Also, this is focused on items that are now <code>ArgAction::SetTrue</code>.  There is a value for those now that can be checked.</p>
<p>A more general &quot;if another argument is present, regardless of value&quot; is needed, let's track that in a separate issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @epage on 2025-06-10 15:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:32 UTC
    </footer>
</body>
</html>
