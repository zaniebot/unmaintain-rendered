<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add docs for Ruff language server - astral-sh/ruff #12344</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add docs for Ruff language server</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12344">#12344</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-07-16 09:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR adds documentation for the Ruff language server.</p>
<p>It mainly does the following:</p>
<ol>
<li>Combines various READMEs containing instructions for different editor setup in their respective section on the online docs</li>
<li>Provide an enumerated list of server settings. Additionally, it also provides a section for VS Code specific options.</li>
<li>Adds a &quot;Features&quot; section which enumerates all the current capabilities of the native server</li>
</ol>
<p>For (2), the settings documentation is done manually but a future improvement (easier after <code>ruff-lsp</code> is deprecated) is to move the docs in to Rust struct and generate the documentation from the code itself. And, the VS Code extension specific options can be generated by diffing against the <code>package.json</code> in <code>ruff-vscode</code> repository.</p>
<h3>Structure</h3>
<ol>
<li>Setup: This section contains the configuration for setting up the language server for different editors</li>
<li>Features: This section contains a list of capabilities provided by the server along with short GIF to showcase it</li>
<li>Settings: This section contains an enumerated list of settings in a similar format to the one for the linter / formatter</li>
<li>Migrating from <code>ruff-lsp</code></li>
</ol>
<blockquote>
<p>[!NOTE]</p>
<p>The settings page is manually written but could possibly be auto-generated via a macro similar to <code>OptionsMetadata</code> on the <code>ClientSettings</code> struct</p>
</blockquote>
<p>resolves: #11217</p>
<h2>Test Plan</h2>
<p>Generate and open the documentation locally using:</p>
<ol>
<li><code>python scripts/generate_mkdocs.py</code></li>
<li><code>mkdocs serve -f mkdocs.insiders.yml</code></li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @dhruvmanila on 2024-07-16 09:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @dhruvmanila on 2024-07-16 09:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Ruff Server: Stable" by @dhruvmanila on 2024-07-16 09:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-07-16 10:05</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>ℹ️ ecosystem check <strong>encountered format errors</strong>. (no format changes; 1 project error)</p>
<details><summary><a href="https://github.com/openai/openai-cookbook">openai/openai-cookbook</a> (error)</summary>
<p>

<pre><code>warning: Detected debug build without --no-cache.
error: Failed to parse examples/chatgpt/gpt_actions_library/gpt_action_outlook.ipynb:13:1:1: Expected an expression
</code></pre>
</p>
</details>

<h3>Formatter (preview)</h3>
<p>ℹ️ ecosystem check <strong>encountered format errors</strong>. (no format changes; 1 project error)</p>
<details><summary><a href="https://github.com/openai/openai-cookbook">openai/openai-cookbook</a> (error)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<pre><code>warning: Detected debug build without --no-cache.
error: Failed to parse examples/chatgpt/gpt_actions_library/gpt_action_outlook.ipynb:13:1:1: Expected an expression
</code></pre>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @dhruvmanila on 2024-07-17 02:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-17 10:04</div>
            <div class="timeline-body"><p>Thanks for putting the entire documentation together. It's very pretty and I like the overall structure.</p>
<p>I haven't read through the original PR, so it's likely that some of what I bring up here has been discussed on that PR.</p>
<p>My first impression is that we shouldn't set <code>ruff server</code> in the spotlight. The server is an implementation detail. What people are looking for is how they can use Ruff in their editor. The beauty of the server is that most VS code users will unlikely ever know that they use <code>ruff server</code>. It just works for them.</p>
<p>I don't think the documentation has to change significantly. It's just the structure that needs to change a little. I suggest renaming the top-level <em>Ruff Server</em> navigation entry to <em>Editors</em>, similar to <a href="https://prettier.io/docs/en/">Prettier</a>, and change <em>Integrations</em> only to cover what's <em>Other integrations</em> today.</p>
<p>I think this will also help to reduce some overlap between <em>Integrations</em> and <em>Ruff Server</em> today where both cover the server and <em>Ruff LSP</em>.</p>
<p>This raises a few questions.</p>
<ul>
<li>What should we do with <code>python-lsp-server</code> and <code>python-lsp-ruff</code>. I'm leaning toward not mentioning them anymore. Or are there any workflows that these LSPs support that we don't?</li>
<li>The main unclear thing is how we document the unofficially supported editors. But maybe that becomes a sub-section at the very end in editors?</li>
</ul>
<p>A small side note. Why is the ruff server section expandable and the other sections aren't?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-17 11:33</div>
            <div class="timeline-body"><blockquote>
<p>My first impression is that we shouldn't set <code>ruff server</code> in the spotlight. The server is an implementation detail. What people are looking for is how they can use Ruff in their editor. The beauty of the server is that most VS code users will unlikely ever know that they use <code>ruff server</code>. It just works for them.</p>
</blockquote>
<p>I see what you mean. I like that way of framing Ruff's editor integration.</p>
<blockquote>
<p>I don't think the documentation has to change significantly. It's just the structure that needs to change a little. I suggest renaming the top-level <em>Ruff Server</em> navigation entry to <em>Editors</em>, similar to <a href="https://prettier.io/docs/en/">Prettier</a>, and change <em>Integrations</em> only to cover what's <em>Other integrations</em> today.</p>
<p>I think this will also help to reduce some overlap between <em>Integrations</em> and <em>Ruff Server</em> today where both cover the server and <em>Ruff LSP</em>.</p>
</blockquote>
<p>I'm assuming that integrations using the <code>ruff</code> CLI would be moved in the specific editor setup section? For example, there are various plugins which can also be used for Neo(Vim) editor via <code>ruff</code> CLI as seen <a href="https://docs.astral.sh/ruff/integrations/#vim-neovim">at the end</a>.</p>
<blockquote>
<ul>
<li>What should we do with <code>python-lsp-server</code> and <code>python-lsp-ruff</code>. I'm leaning toward not mentioning them anymore. Or are there any workflows that these LSPs support that we don't?</li>
</ul>
</blockquote>
<p>I think it might be ok to remove <code>python-lsp-ruff</code>. The only difference between workflows I see based on the README is <a href="https://github.com/python-lsp/python-lsp-ruff#custom-severities">custom severities</a> and providing more <a href="https://github.com/python-lsp/python-lsp-ruff#configuration">configuration</a> options directly in the server settings instead of <code>pyproject.toml</code>.</p>
<blockquote>
<ul>
<li>The main unclear thing is how we document the unofficially supported editors. But maybe that becomes a sub-section at the very end in editors?</li>
</ul>
</blockquote>
<p>By this, I'm assuming you mean editors like PyCharm and Textmate. If so, then I think it should just be included in the &quot;Editors&quot; section given the rename. It wasn't included alongside other editors because the &quot;The Ruff Language Server &gt; Setup&quot; section was specific to setting up the language server in those editors.</p>
<blockquote>
<p>A small side note. Why is the ruff server section expandable and the other sections aren't?</p>
</blockquote>
<p>It's because each section is in it's own file, otherwise the entire page becomes too cluttered with a lot of information. This is inspired by the uv docs. Internal message thread: https://discord.com/channels/1039017663004942429/1080996377611489350/1262939217437261907</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-17 11:36</div>
            <div class="timeline-body"><p>Thinking about it a bit more...</p>
<p>Overall, there are two ways one could setup Ruff in their editor (except for VS Code where we provide an official extension):</p>
<ol>
<li>Setting up the language server via some mechanism</li>
<li>Using the executable directly via some builtin mechanism or an external plugin</li>
</ol>
<p>If there's just an &quot;Editors&quot; section, then we could include all different ways to setup Ruff in individual editors. But then I'm not sure if other sections (features, settings, etc.) goes under &quot;Editors&quot; because those sections are specific to the language server.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-17 12:25</div>
            <div class="timeline-body"><p>I tried to find other projects that document their editors along with the tool itself and couldn't find any good examples.</p>
<blockquote>
<p>If there's just an &quot;Editors&quot; section, then we could include all different ways to setup Ruff in individual editors. But then I'm not sure if other sections (features, settings, etc.) goes under &quot;Editors&quot; because those sections are specific to the language server.</p>
</blockquote>
<p>I think the features section fits well because it's the features you (might) get when using Ruff in your editor. Assuming the editor supports the required LSP features.</p>
<p>I agree, that the settings are a bit more LSP specific. But I think we have a VS code setting for every LSP setting? We could even discuss the Common settings, followed by the editor specific settings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/T-256">@T-256</a> on <code>docs/integrations.md</code>:96 on 2024-07-17 12:55</div>
            <div class="timeline-body"><p>Could also add Helix and KATE which mentioned in ruff server?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/T-256">@T-256</a> on <code>docs/server/features.md</code>:16 on 2024-07-17 13:12</div>
            <div class="timeline-body"><pre><code class="language-suggestion">In addition to receive updates from editor settings, it can dynamically refresh the diagnostics when a configuration file is changed in the
</code></pre>
<p>Since changing editor settings also dynamically applies to server.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/T-256">@T-256</a> reviewed on 2024-07-17 14:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-07-17 17:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_server/docs/MIGRATION.md</code>:3 on 2024-07-17 17:26</div>
            <div class="timeline-body"><p><code>migratin</code> looks like a typo.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/server/features.md</code>:16 on 2024-07-17 17:27</div>
            <div class="timeline-body"><p>Maybe: &quot;The server dynamically refreshes diagnostics...&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-07-17 17:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-07-17 17:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/server/features.md</code>:17 on 2024-07-17 17:28</div>
            <div class="timeline-body"><p>&quot;in the workspace, whether it's a <code>pyproject.toml</code>, <code>ruff.toml</code>, or <code>.ruff.toml</code> file.&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-07-17 17:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/server/features.md</code>:20 on 2024-07-17 17:28</div>
            <div class="timeline-body"><p>I would remove &quot;This means that&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-07-17 17:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/server/setup.md</code>:3 on 2024-07-17 17:29</div>
            <div class="timeline-body"><p>&quot;depending on your editor of choice&quot;, maybe? Or &quot;for each editor&quot;?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-07-17 17:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-07-18 07:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>docs/server/features.md</code>:16 on 2024-07-18 07:42</div>
            <div class="timeline-body"><p>This isn't implemented yet: #11897</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-07-18 09:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>docs/integrations.md</code>:96 on 2024-07-18 09:05</div>
            <div class="timeline-body"><p>I've changed the structure a bit as discussed with Micha, so this isn't required now. Thanks for the suggestion</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @dhruvmanila on 2024-07-18 09:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-18 09:07</div>
            <div class="timeline-body"><p>@MichaReiser I've updated the structure and changed some wording as well. I might need to read through it once to update the &quot;Ruff Language Server&quot; references. What do you think of the new structure?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dhruvmanila on 2024-07-18 12:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-07-18 12:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-18 12:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tartley">@tartley</a> on 2024-07-18 17:53</div>
            <div class="timeline-body"><p>Thank you for this PR, this is amazing, perfect for me.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:05:20 UTC
    </footer>
</body>
</html>
