<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`airflow`] passing positional argument into `airflow.lineage.hook.HookLineageCollector.create_asset` is not allowed (`AIR301`) - astral-sh/ruff #21096</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>airflow</code>] passing positional argument into <code>airflow.lineage.hook.HookLineageCollector.create_asset</code> is not allowed (<code>AIR301</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/21096">#21096</a>
        opened by <a href="https://github.com/Lee-W">@Lee-W</a>
        on 2025-10-27 13:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-10-27 13:14</div>
            <div class="timeline-body"><p>…e_asset has positional arguments</p>
<!--
Thank you for contributing to Ruff/ty! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title? (Please prefix with `[ty]` for ty pull
  requests.)
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<!-- What's the purpose of the change? What does it do, and why? -->

<ul>
<li>passing positional argument into <code>airflow.lineage.hook.HookLineageCollector.create_asset</code> is not allowed<ul>
<li>check whether positional argument with 0 index can be found</li>
</ul>
</li>
</ul>
<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>update the test fixture accordingly and reorganize in the next commit</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-27 13:25</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "feat(AIR301): warn if airflow.lineage.hook.HookLineageCollector.creat…" to "[`airflow`] passing positional argument into `airflow.lineage.hook.HookLineageCollector.create_asset` is not allowed (`AIR301`)" by @Lee-W on 2025-10-28 09:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @Lee-W on 2025-10-28 09:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/snapshots/ruff_linter__rules__airflow__tests__AIR301_AIR301_class_attribute.py.snap</code>:420 on 2025-10-28 19:19</div>
            <div class="timeline-body"><p>Is this the intended message you want to show to users? Shouldn't it say instead that position arguments are disallowed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-28 19:20</div>
            <div class="timeline-body"><p>I haven't followed the airflow PRs closely so I don't know if this is the first check for positional arguments.</p>
<p>Did airflow 2 allow position arguments but airflow 3 does no more?</p>
<p>I can see how this check is useful but it's something a type checker could catch too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-10-29 01:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/snapshots/ruff_linter__rules__airflow__tests__AIR301_AIR301_class_attribute.py.snap</code>:420 on 2025-10-29 01:12</div>
            <div class="timeline-body"><p>Let me reword it again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-10-29 01:13</div>
            <div class="timeline-body"><blockquote>
<p>I haven't followed the airflow PRs closely so I don't know if this is the first check for positional arguments.</p>
</blockquote>
<p>Yes, I think this is the first one</p>
<blockquote>
<p>Did airflow 2 allow position arguments but airflow 3 does no more?</p>
</blockquote>
<p>Yes.</p>
<blockquote>
<p>I can see how this check is useful but it's something a type checker could catch too.</p>
</blockquote>
<p>Yes, but we think it would still be helpful if these rules can also detect it here. As most of our users would be data engineers and might not care type checking that much</p>
<p>https://github.com/apache/airflow/issues/47615#issuecomment-2720143869</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/snapshots/ruff_linter__rules__airflow__tests__AIR301_AIR301_class_attribute.py.snap</code>:420 on 2025-10-29 01:24</div>
            <div class="timeline-body"><p>After reading the whole message yet again, we should probably add a AIR303 for function signature change. I have another local branch working on something similar and moving this one there might be better as <code>create_asset</code> is not removed. Only its signature changed.</p>
<p>WDTY?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-10-29 01:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @Lee-W on 2025-10-29 01:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-30 13:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/snapshots/ruff_linter__rules__airflow__tests__AIR301_AIR301_class_attribute.py.snap</code>:420 on 2025-10-30 13:44</div>
            <div class="timeline-body"><p>Agree, AIR301 feels out of place for a signature change because it's not a removal</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-30 13:45</div>
            <div class="timeline-body"><blockquote>
<p>Yes, but we think it would still be helpful if these rules can also detect it here. As most of our users would be data engineers and might not care type checking that much</p>
</blockquote>
<p>Fair enough. I'd prefer a separate rule because that would also make it easier to deprecate said rule when we introduce a general-purpose rule that detects positional arguments that should have been passed as keyword arguments (which we already have in ty)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-10 17:37</div>
            <div class="timeline-body"><p>Thanks for working on this PR.</p>
<p>I'll close this PR as it seems stale. @Lee-W, don't hesitate to submit a new PR if you plan to get back to this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-12-10 17:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sjyangkevin">@sjyangkevin</a> on 2025-12-14 04:08</div>
            <div class="timeline-body"><p>thank you @Lee-W for working on this, and thank you @MichaReiser for sharing the feedback. I discussed with @Lee-W , and I would like to pick up the work for adding this rule. As I am new to ruff, so I am still reviewing the contribution guide, and would like to start by asking some basic questions.</p>
<h3>Create a new code AIR303</h3>
<p>I am wondering if I need to open an issue to discuss the creation of the code AIR303 before starting the implementation. Have we decided on the naming for the new rule (e.g., detect_positional_argument, ...)?</p>
<h3>High-level thinking on implementation</h3>
<p>From my high-level understanding, the new code could be added to the <code>code.rs</code>, and then I need to create a new file under <code>crates/ruff_linter/src/rules/airflow/rules</code> to implement the rule, and link it with the new code. I am looking into the code change in this PR and trying to understand the process (https://docs.astral.sh/ruff/contributing/#example-adding-a-new-lint-rule) to get a deeper understanding on the details.</p>
<p>https://github.com/astral-sh/ruff/blob/c7eea1f2e33ba67480d4367a45559bf8f2bd1e49/crates/ruff_linter/src/codes.rs#L1119-L1124</p>
<p>Thanks,</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-12-15 09:49</div>
            <div class="timeline-body"><blockquote>
<p>I am wondering if I need to open an issue to discuss the creation of the code AIR303 before starting the implementation.</p>
</blockquote>
<p>I think we're good? given that I didn't create an issue for this one.</p>
<blockquote>
<p>Have we decided on the naming for the new rule (e.g., detect_positional_argument, ...)?</p>
</blockquote>
<p>function_signature_change or something similar might be better</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 16:42:34 UTC
    </footer>
</body>
</html>
