<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stabilise rules RUF024 and RUF026 - astral-sh/ruff #12026</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Stabilise rules RUF024 and RUF026</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12026">#12026</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-06-25 11:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Stabilise the following rules in the <code>RUF</code> category for Ruff v0.5:</p>
<ul>
<li><code>mutable-fromkeys-value</code></li>
<li>~~<code>unnecessary-dict-comprehension</code>~~</li>
<li><code>default-factory-kwarg</code></li>
<li>~~<code>parenthesize-chained-operators</code>~~</li>
<li>~~<code>unsorted-dunder-all</code>~~</li>
<li>~~<code>unsorted-dunder-slots</code>~~</li>
</ul>
<p>These rules have been in the preview category for several minor releases, and were released to users &gt;90 days ago. There are no open issues about any of them, and there have not been any open issues about any of them for several months. I skimmed over the implementations for all of them, and they all look reasonable to me (except for one test fixture for <code>RUF026</code> that wasn't testing what it was meant to be testing -- I fix that here as part of this PR).</p>
<h2>Test Plan</h2>
<p><code>cargo test</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @AlexWaygood on 2024-06-25 11:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @AlexWaygood on 2024-06-25 11:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-06-25 11:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-25 11:50</div>
            <div class="timeline-body"><p>Generally looks reasonable (though we should review the ecosystem results when we can). <code>ParenthesizeChainedOperators</code> is the only one I'm unsure of because it's more opinionated but let's see what the ecosystem says.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-25 12:49</div>
            <div class="timeline-body"><blockquote>
<p><code>unsorted-dunder-all</code>, <code>unsorted-dunder-slots</code></p>
</blockquote>
<p>could also be considered very-opinionated, but I'm not sure if this should prevent us from stabilizing rules (I don't think we should implement new once until we figured out rule categorization).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-06-25 13:04</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+1 -11 violations, +0 -0 fixes in 3 projects; 47 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -3 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/apache/airflow/blob/c310159bc2363c12110b11febd5febaab8670210/airflow/providers/microsoft/azure/hooks/msgraph.py#L327'>airflow/providers/microsoft/azure/hooks/msgraph.py:327:12:</a> PLR1701 [*] Merge `isinstance` calls: `isinstance(data, (BytesIO, bytes, str))`
- <a href='https://github.com/apache/airflow/blob/c310159bc2363c12110b11febd5febaab8670210/airflow/serialization/pydantic/dag.py#L45'>airflow/serialization/pydantic/dag.py:45:9:</a> PLR1701 [*] Merge `isinstance` calls
- <a href='https://github.com/apache/airflow/blob/c310159bc2363c12110b11febd5febaab8670210/airflow/serialization/pydantic/taskinstance.py#L70'>airflow/serialization/pydantic/taskinstance.py:70:8:</a> PLR1701 [*] Merge `isinstance` calls: `isinstance(x, (BaseOperator, MappedOperator))`
</pre>

</p>
</details>
<details><summary><a href="https://github.com/demisto/content">demisto/content</a> (+0 -8 violations, +0 -0 fixes)</summary>
<p>

<pre>
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/ANYRUN/Integrations/ANYRUN/ANYRUN.py#L196'>Packs/ANYRUN/Integrations/ANYRUN/ANYRUN.py:196:16:</a> PLR1701 Merge `isinstance` calls: `isinstance(val, dict | list)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/AWS-GuardDuty/Integrations/AWSGuardDutyEventCollector/AWSGuardDutyEventCollector.py#L33'>Packs/AWS-GuardDuty/Integrations/AWSGuardDutyEventCollector/AWSGuardDutyEventCollector.py:33:12:</a> PLR1701 Merge `isinstance` calls: `isinstance(obj, date | datetime)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py#L187'>Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py:187:23:</a> PLR1701 Merge `isinstance` calls: `isinstance(x, bool | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py#L192'>Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py:192:37:</a> PLR1701 Merge `isinstance` calls: `isinstance(v, bool | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py#L422'>Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py:422:8:</a> PLR1701 Merge `isinstance` calls: `isinstance(obj, list | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/BluecatAddressManager/Integrations/BluecatAddressManager/BluecatAddressManager.py#L256'>Packs/BluecatAddressManager/Integrations/BluecatAddressManager/BluecatAddressManager.py:256:12:</a> PLR1701 Merge `isinstance` calls
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/ExpanseV2/Scripts/ExpanseEvidenceDynamicSection/ExpanseEvidenceDynamicSection.py#L15'>Packs/ExpanseV2/Scripts/ExpanseEvidenceDynamicSection/ExpanseEvidenceDynamicSection.py:15:8:</a> PLR1701 Merge `isinstance` calls: `isinstance(v, float | int | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/TOPdesk/Integrations/TOPdesk/TOPdesk.py#L577'>Packs/TOPdesk/Integrations/TOPdesk/TOPdesk.py:577:16:</a> PLR1701 Merge `isinstance` calls: `isinstance(value, bool | str)`
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pytest-dev/pytest">pytest-dev/pytest</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/pytest-dev/pytest/blob/53bf1889993696d4471cdaeffce9db1646b89ffa/testing/test_runner.py#L536'>testing/test_runner.py:536:39:</a> RUF024 Do not pass mutable objects as values to `dict.fromkeys`
</pre>

</p>
</details>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLR1701 | 11 | 0 | 11 | 0 | 0 |
| RUF024 | 1 | 1 | 0 | 0 | 0 |</p>
</p>
</details>

<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+0 -11 violations, +0 -0 fixes in 2 projects; 48 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -3 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/apache/airflow/blob/c310159bc2363c12110b11febd5febaab8670210/airflow/providers/microsoft/azure/hooks/msgraph.py#L327'>airflow/providers/microsoft/azure/hooks/msgraph.py:327:12:</a> PLR1701 [*] Merge `isinstance` calls: `isinstance(data, (BytesIO, bytes, str))`
- <a href='https://github.com/apache/airflow/blob/c310159bc2363c12110b11febd5febaab8670210/airflow/serialization/pydantic/dag.py#L45'>airflow/serialization/pydantic/dag.py:45:9:</a> PLR1701 [*] Merge `isinstance` calls
- <a href='https://github.com/apache/airflow/blob/c310159bc2363c12110b11febd5febaab8670210/airflow/serialization/pydantic/taskinstance.py#L70'>airflow/serialization/pydantic/taskinstance.py:70:8:</a> PLR1701 [*] Merge `isinstance` calls: `isinstance(x, (BaseOperator, MappedOperator))`
</pre>

</p>
</details>
<details><summary><a href="https://github.com/demisto/content">demisto/content</a> (+0 -8 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/ANYRUN/Integrations/ANYRUN/ANYRUN.py#L196'>Packs/ANYRUN/Integrations/ANYRUN/ANYRUN.py:196:16:</a> PLR1701 Merge `isinstance` calls: `isinstance(val, dict | list)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/AWS-GuardDuty/Integrations/AWSGuardDutyEventCollector/AWSGuardDutyEventCollector.py#L33'>Packs/AWS-GuardDuty/Integrations/AWSGuardDutyEventCollector/AWSGuardDutyEventCollector.py:33:12:</a> PLR1701 Merge `isinstance` calls: `isinstance(obj, date | datetime)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py#L187'>Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py:187:23:</a> PLR1701 Merge `isinstance` calls: `isinstance(x, bool | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py#L192'>Packs/Base/Scripts/DBotMLFetchData/DBotMLFetchData.py:192:37:</a> PLR1701 Merge `isinstance` calls: `isinstance(v, bool | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py#L422'>Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py:422:8:</a> PLR1701 Merge `isinstance` calls: `isinstance(obj, list | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/BluecatAddressManager/Integrations/BluecatAddressManager/BluecatAddressManager.py#L256'>Packs/BluecatAddressManager/Integrations/BluecatAddressManager/BluecatAddressManager.py:256:12:</a> PLR1701 Merge `isinstance` calls
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/ExpanseV2/Scripts/ExpanseEvidenceDynamicSection/ExpanseEvidenceDynamicSection.py#L15'>Packs/ExpanseV2/Scripts/ExpanseEvidenceDynamicSection/ExpanseEvidenceDynamicSection.py:15:8:</a> PLR1701 Merge `isinstance` calls: `isinstance(v, float | int | str)`
- <a href='https://github.com/demisto/content/blob/e08a0b5fecc83a91a0ed07de6f7887553d43f98f/Packs/TOPdesk/Integrations/TOPdesk/TOPdesk.py#L577'>Packs/TOPdesk/Integrations/TOPdesk/TOPdesk.py:577:16:</a> PLR1701 Merge `isinstance` calls: `isinstance(value, bool | str)`
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLR1701 | 11 | 0 | 11 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Stabilise rules RUF021-RUF026" to "Stabilise rules RUF024-RUF026" by @AlexWaygood on 2024-06-25 13:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-25 13:38</div>
            <div class="timeline-body"><p>For now, I've struck the following rules (all authored by me üò≠) off the list:</p>
<ul>
<li>RUF021 (<code>parenthesize-chained-operators</code>)</li>
<li>RUF022 (<code>unsorted-dunder-all</code>)</li>
<li>RUF023 (<code>unsorted-dunder-slots</code>)</li>
</ul>
<p>These rules are all working as designed, but they're all quite opinionated. Right now, it seems like promoting them to stable would be too disruptive for users who select the entire <code>RUF</code> category in their configuration file. Long-term, we'll need to figure out how to stabilise opinionated rules while minimising disruption for our users (which relates to our long-term ambition to rework our rule categorisation)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-06-25 13:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-25 15:03</div>
            <div class="timeline-body"><blockquote>
<p>For now, I've struck the following rules (all authored by me üò≠) off the list:</p>
</blockquote>
<p>And I've now struck off RUF025 for similar reasons. Somewhat opinionated; has a fair few ecosystem hits; we can maybe consider it separately, but not for this PR...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Stabilise rules RUF024-RUF026" to "Stabilise rules RUF024 and RUF026" by @AlexWaygood on 2024-06-25 15:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @AlexWaygood on 2024-06-25 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2024-06-25 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-06-25 15:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:05:00 UTC
    </footer>
</body>
</html>
