<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preserve indent around multiline strings - astral-sh/ruff #9637</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Preserve indent around multiline strings</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9637">#9637</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2024-01-24 17:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-24 17:22</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR changes our <code>multiline_string</code> preview style implementation (added in https://github.com/astral-sh/ruff/pull/9243) to only hug strings in call arguments when there's no newline between the <code>(</code> and the string's quotes.</p>
<p>This is to address the feedback raised in Black's repository (<a href="https://github.com/psf/black/issues/4159">issue</a>)</p>
<p>The stable formatting always indents strings:</p>
<pre><code class="language-python">dedent(
    &quot;&quot;&quot;
    value
    &quot;&quot;&quot;
)
</code></pre>
<p>The preview style as it is implemented today (not this PR) tries to hug multiline strings, and only falls back to indenting the string if the first line of the string exceeds the configured line width:</p>
<pre><code class="language-python">dedent(&quot;&quot;&quot;
    value
&quot;&quot;&quot;)
</code></pre>
<p>The benefit of the new style is that it reduces vertical spacing (The two strings in the examples aren't equivalent because of the whitespace before the closing quotes but the whitespace before the closing quotes with <code>indent</code> is only used to align the quotes.</p>
<p>The main concern with the new preview style is that it messes up the multiline string formatting for existing Black users because it can dealign the quotes and fixing the quote alignment isn't possible without knowing if the argument is whitespace sensitive or not.</p>
<p>For example, it turns...</p>
<pre><code class="language-python">dedent(
    &quot;&quot;&quot;
    value
    &quot;&quot;&quot;
)
</code></pre>
<p>into...</p>
<pre><code class="language-python">dedent(&quot;&quot;&quot;
    value
    &quot;&quot;&quot;)
</code></pre>
<p>which looks worse.</p>
<p>However, the preview style improves formatting for new black users or new code written when you have:</p>
<pre><code class="language-python">def test():
    a = dedent(&quot;&quot;&quot;
      Some code
      that needs dedenting
    &quot;&quot;&quot;)
</code></pre>
<p>because it no longer changes it to</p>
<pre><code class="language-python">def test():
    a = dedent(
        &quot;&quot;&quot;
      Some code
      that needs dedenting
    &quot;&quot;&quot;
    )
</code></pre>
<p>This PR refiens the <code>multiline_string</code> preview style with a heuristic of when to hug the multiline string and when not.</p>
<p>The idea is to honor the author's decision by checking if the opening parentheses and the string both start on the same line. If so, hug the multline string, otherwise don't.</p>
<p>There are two advantages to this:</p>
<ul>
<li>Existing Blacked code won't change because the formatter detects the newline between the opening parentheses and the quotes and continues to indent the multiline string</li>
<li>Existing Blacked or Ruffed code using preview style won't change because the formatter detects that there's no newline between the opening parentheses and the string start and, because of it, won't indent the multiline string.</li>
</ul>
<p>This heuristic is the same as Prettier uses for single-argument, multiline string call expressions.</p>
<h2>Downsides</h2>
<p>The downside of this heuristic over always hugging single argument multiline strings is that existing calls to <code>dedent</code> need manual updating to match the desired formatting. I think that's fine because the new formatting also requires to manually updating the spacing before the closing <code>&quot;&quot;&quot;</code> to match indentation:</p>
<pre><code class="language-python">dedent(&quot;&quot;&quot;
	Multiline
	&quot;&quot;&quot;)
</code></pre>
<p>Doesn't look good. You want</p>
<pre><code class="language-python">dedent(&quot;&quot;&quot;
	Multiline
&quot;&quot;&quot;)
</code></pre>
<p>which ruff can't do without changing the string's semantics.</p>
<h2>Test Plan</h2>
<p><strong>Running Ruff before introducing the <code>multline-string</code> preview style and then this branch</strong>:</p>
<p>There are no upgrade changes, compared to the original <code>multiline-string</code> preview style PR that changed+2971 -5900 lines in 374 files in 31 projects.</p>
<p>ℹ️ ecosystem check <strong>detected format changes</strong>. (+7 -8 lines in 3 files in 3 projects; 1 project error; 39 projects unchanged)</p>
<details><summary><a href="https://github.com/demisto/content">demisto/content</a> (+2 -5 lines across 1 file)</summary>
<p>
<pre>ruff format --preview --exclude Packs/ThreatQ/Integrations/ThreatQ/ThreatQ.py</pre>
</p>
<p>

<p><a href='https://github.com/demisto/content/blob/3d621f512f4575d87e68e317570dcd90411b9607/Packs/IntegrationsAndIncidentsHealthCheck/Scripts/GetFailedTasks/GetFailedTasks.py#L107'>Packs/IntegrationsAndIncidentsHealthCheck/Scripts/GetFailedTasks/GetFailedTasks.py~L107</a></p>
<pre><code class="language-diff">     )
 
     if is_error(response):
-        error = (
-            f'Failed retrieving tasks for incident ID {incident[&quot;id&quot;]}.\n \
+        error = f'Failed retrieving tasks for incident ID {incident[&quot;id&quot;]}.\n \
            Make sure that the API key configured in the Core REST API integration \
-is one with sufficient permissions to access that incident.\n'
-            + get_error(response)
-        )
+is one with sufficient permissions to access that incident.\n' + get_error(response)
         raise Exception(error)
 
     return response[0][&quot;Contents&quot;][&quot;response&quot;]
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/reflex-dev/reflex">reflex-dev/reflex</a> (+3 -1 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/reflex-dev/reflex/blob/0d8efb9b5570425615db00cd65e6070317488f6f/reflex/components/markdown/markdown.py#L253'>reflex/components/markdown/markdown.py~L253</a></p>
<pre><code class="language-diff">         }
 
         # Separate out inline code and code blocks.
-        components[&quot;code&quot;] = f&quot;&quot;&quot;{{({{node, inline, className, {_CHILDREN._var_name}, {_PROPS._var_name}}}) =&gt; {{
+        components[
+            &quot;code&quot;
+        ] = f&quot;&quot;&quot;{{({{node, inline, className, {_CHILDREN._var_name}, {_PROPS._var_name}}}) =&gt; {{
     const match = (className || '').match(/language-(?&lt;lang&gt;.*)/);
     const language = match ? match[1] : '';
     if (language) {{
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/rotki/rotki">rotki/rotki</a> (+2 -2 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/rotki/rotki/blob/5b72d2f90a87d5f82df519cbe385edd7a61474fd/rotkehlchen/rotkehlchen.py#L1196'>rotkehlchen/rotkehlchen.py~L1196</a></p>
<pre><code class="language-diff">         if oracle != HistoricalPriceOracle.CRYPTOCOMPARE:
             return  # only for cryptocompare for now
 
-        with (
-            contextlib.suppress(UnknownAsset)
+        with contextlib.suppress(
+            UnknownAsset
         ):  # if suppress -&gt; assets are not crypto or fiat, so we can't query cryptocompare  # noqa: E501
             self.cryptocompare.create_cache(
                 from_asset=from_asset,
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/openai/openai-cookbook">openai/openai-cookbook</a> (error)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<pre><code>error: Failed to parse examples/dalle/Image_generations_edits_and_variations_with_DALL-E.ipynb:3:7:8: Unexpected token 'prompt'
</code></pre>
</p>
</details>

<p><strong>Running ruff preview (main) and then this branch</strong>:</p>
<p>Results in no changes</p>
<p>ℹ️ ecosystem check <strong>encountered format errors</strong>. (no format changes; 1 project error)</p>
<details><summary><a href="https://github.com/openai/openai-cookbook">openai/openai-cookbook</a> (error)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<pre><code>error: Failed to parse examples/dalle/Image_generations_edits_and_variations_with_DALL-E.ipynb:3:7:8: Unexpected token 'prompt'
</code></pre>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2024-01-24 17:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2024-01-24 17:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-01-24 17:32</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected format changes</strong>. (+10156 -5096 lines in 500 files in 30 projects; 13 projects unchanged)</p>
<details><summary><a href="https://github.com/DisnakeDev/disnake">DisnakeDev/disnake</a> (+4 -2 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/DisnakeDev/disnake/blob/a24abf43297215b6fe70e0bc61b2ec1dada84b9f/scripts/codemods/typed_flags.py#L104'>scripts/codemods/typed_flags.py~L104</a></p>
<pre><code class="language-diff">             else:
                 # one doesn't currently exist, great.
                 # so we have two options here... we could make a typechecking block from scratch or... we could cheat
-                code = textwrap.dedent(&quot;&quot;&quot;
+                code = textwrap.dedent(
+                    &quot;&quot;&quot;
                     if TYPE_CHECKING:
                         @_generated
                         def __init__(self):
                             ...
-                    &quot;&quot;&quot;)
+                    &quot;&quot;&quot;
+                )
                 if_block = cast(
                     &quot;cst.If&quot;, cst.parse_statement(code, config=self.module.config_for_parsing)
                 )
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+892 -446 lines across 32 files)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/cli/telemetry.py#L57'>rasa/cli/telemetry.py~L57</a></p>
<pre><code class="language-diff">         )
 
     print(
-        textwrap.dedent(&quot;&quot;&quot;
+        textwrap.dedent(
+            &quot;&quot;&quot;
             Rasa uses telemetry to report anonymous usage information. This information
-            is essential to help improve Rasa Open Source for all users.&quot;&quot;&quot;)
+            is essential to help improve Rasa Open Source for all users.&quot;&quot;&quot;
+        )
     )
 
     if not is_enabled:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/telemetry.py#L105'>rasa/telemetry.py~L105</a></p>
<pre><code class="language-diff"> 
 def print_telemetry_reporting_info() -&gt; None:
     &quot;&quot;&quot;Print telemetry information to std out.&quot;&quot;&quot;
-    message = textwrap.dedent(f&quot;&quot;&quot;
+    message = textwrap.dedent(
+        f&quot;&quot;&quot;
         Rasa Open Source reports anonymous usage telemetry to help improve the product
         for all its users.
 
         If you'd like to opt-out, you can use `rasa telemetry disable`.
-        To learn more, check out {DOCS_URL_TELEMETRY}.&quot;&quot;&quot;).strip()
+        To learn more, check out {DOCS_URL_TELEMETRY}.&quot;&quot;&quot;
+    ).strip()
 
     table = SingleTable([[message]])
     print(table.table)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L357'>tests/cli/test_utils.py~L357</a></p>
<pre><code class="language-diff">     file_type: Text, data_type: Text, tmp_path: Path
 ):
     file_name = tmp_path / f&quot;{file_type}.yml&quot;
-    file_name.write_text(f&quot;&quot;&quot;
+    file_name.write_text(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         {file_type}:
         - {data_type}: test path
           steps:
           - intent: goodbye
           - action: action_test
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     importer = TrainingDataImporter.load_from_config(
         &quot;data/test_config/config_defaults.yml&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L387'>tests/cli/test_utils.py~L387</a></p>
<pre><code class="language-diff">     file_type: Text, data_type: Text, tmp_path: Path
 ):
     file_name = tmp_path / f&quot;{file_type}.yml&quot;
-    file_name.write_text(f&quot;&quot;&quot;
+    file_name.write_text(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         {file_type}:
         - {data_type}: test path
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L395'>tests/cli/test_utils.py~L395</a></p>
<pre><code class="language-diff">             - intent: request_restaurant
             - action: restaurant_form
             - active_loop: restaurant_form
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     importer = TrainingDataImporter.load_from_config(
         &quot;data/test_config/config_defaults.yml&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L421'>tests/cli/test_utils.py~L421</a></p>
<pre><code class="language-diff">     )
     nlu_file = &quot;data/test_nlu/test_nlu_validate_files_with_active_loop_null.yml&quot;
     file_name = tmp_path / f&quot;{file_type}.yml&quot;
-    file_name.write_text(f&quot;&quot;&quot;
+    file_name.write_text(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         {file_type}:
         - {data_type}: test path
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L431'>tests/cli/test_utils.py~L431</a></p>
<pre><code class="language-diff">             - active_loop: restaurant_form
             - active_loop: null
             - action: action_search_restaurants
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     importer = TrainingDataImporter.load_from_config(
         &quot;data/test_config/config_unique_assistant_id.yml&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L458'>tests/cli/test_utils.py~L458</a></p>
<pre><code class="language-diff"> 
 def test_validate_files_form_slots_not_matching(tmp_path: Path):
     domain_file_name = tmp_path / &quot;domain.yml&quot;
-    domain_file_name.write_text(f&quot;&quot;&quot;
+    domain_file_name.write_text(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         forms:
           name_form:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L474'>tests/cli/test_utils.py~L474</a></p>
<pre><code class="language-diff">                 type: text
                 mappings:
                 - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     importer = TrainingDataImporter.load_from_config(
         &quot;data/test_config/config_defaults.yml&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L528'>tests/cli/test_utils.py~L528</a></p>
<pre><code class="language-diff">     tested_slot = &quot;duration&quot;
     form_name = &quot;booking_form&quot;
     # form required_slots does not include the tested_slot
-    domain.write_text(f&quot;&quot;&quot;
+    domain.write_text(
+        f&quot;&quot;&quot;
             version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
             intents:
             - state_length_of_time
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/cli/test_utils.py#L552'>tests/cli/test_utils.py~L552</a></p>
<pre><code class="language-diff">               {form_name}:
                 required_slots:
                 - location
-                &quot;&quot;&quot;)
+                &quot;&quot;&quot;
+    )
     importer = TrainingDataImporter.load_from_config(
         &quot;data/test_config/config_defaults.yml&quot;, str(domain), None
     )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/conftest.py#L172'>tests/conftest.py~L172</a></p>
<pre><code class="language-diff"> def simple_config_path(tmp_path_factory: TempPathFactory) -&gt; Text:
     project_path = tmp_path_factory.mktemp(uuid.uuid4().hex)
 
-    config = textwrap.dedent(f&quot;&quot;&quot;
+    config = textwrap.dedent(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         assistant_id: placeholder_default
         pipeline:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/conftest.py#L183'>tests/conftest.py~L183</a></p>
<pre><code class="language-diff">         - name: AugmentedMemoizationPolicy
           max_history: 3
         - name: RulePolicy
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     config_path = project_path / &quot;config.yml&quot;
     rasa.shared.utils.io.write_text_file(config, config_path)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L44'>tests/core/actions/test_forms.py~L44</a></p>
<pre><code class="language-diff">     form_name = &quot;my form&quot;
     action = FormAction(form_name, None)
     slot_name = &quot;num_people&quot;
-    domain = textwrap.dedent(f&quot;&quot;&quot;
+    domain = textwrap.dedent(
+        f&quot;&quot;&quot;
     slots:
       {slot_name}:
         type: float
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L58'>tests/core/actions/test_forms.py~L58</a></p>
<pre><code class="language-diff">     responses:
       utter_ask_num_people:
       - text: &quot;How many people?&quot;
-      &quot;&quot;&quot;)
+      &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain)
 
     events = await action.run(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L79'>tests/core/actions/test_forms.py~L79</a></p>
<pre><code class="language-diff">     domain_required_slot_name = &quot;num_people&quot;
     slot_set_by_remote_custom_extraction_method = &quot;some_slot&quot;
     slot_value_set_by_remote_custom_extraction_method = &quot;anything&quot;
-    domain = textwrap.dedent(f&quot;&quot;&quot;
+    domain = textwrap.dedent(
+        f&quot;&quot;&quot;
     slots:
       {domain_required_slot_name}:
         type: float
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L99'>tests/core/actions/test_forms.py~L99</a></p>
<pre><code class="language-diff">       - text: &quot;How many people?&quot;
     actions:
       - validate_{form_name}
-      &quot;&quot;&quot;)
+      &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain)
 
     form_validation_events = [
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L137'>tests/core/actions/test_forms.py~L137</a></p>
<pre><code class="language-diff">     form_name = &quot;my form&quot;
     action = FormAction(form_name, None)
     slot_name = &quot;num_people&quot;
-    domain = textwrap.dedent(f&quot;&quot;&quot;
+    domain = textwrap.dedent(
+        f&quot;&quot;&quot;
     slots:
       {slot_name}:
         type: float
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L153'>tests/core/actions/test_forms.py~L153</a></p>
<pre><code class="language-diff">     responses:
       utter_ask_num_people:
       - text: &quot;How many people?&quot;
-      &quot;&quot;&quot;)
+      &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain)
 
     events = await action.run(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L863'>tests/core/actions/test_forms.py~L863</a></p>
<pre><code class="language-diff"> def test_temporary_tracker():
     extra_slot = &quot;some_slot&quot;
     sender_id = &quot;test&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         slots:
           {extra_slot}:
             type: any
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     previous_events = [ActionExecuted(ACTION_LISTEN_NAME)]
     old_tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1535'>tests/core/actions/test_forms.py~L1535</a></p>
<pre><code class="language-diff">     form = FormAction(form_name, None)
 
     domain = Domain.from_yaml(
-        textwrap.dedent(f&quot;&quot;&quot;
+        textwrap.dedent(
+            f&quot;&quot;&quot;
             version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
             intent:
             - greet
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1564'>tests/core/actions/test_forms.py~L1564</a></p>
<pre><code class="language-diff">                required_slots:
                  - email
                  - name
-            &quot;&quot;&quot;)
+            &quot;&quot;&quot;
+        )
     )
 
     tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1605'>tests/core/actions/test_forms.py~L1605</a></p>
<pre><code class="language-diff">     form = FormAction(form_name, None)
 
     domain = Domain.from_yaml(
-        textwrap.dedent(f&quot;&quot;&quot;
+        textwrap.dedent(
+            f&quot;&quot;&quot;
             version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
             intent:
             - greet
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1634'>tests/core/actions/test_forms.py~L1634</a></p>
<pre><code class="language-diff">                required_slots:
                  - email
                  - name
-            &quot;&quot;&quot;)
+            &quot;&quot;&quot;
+        )
     )
 
     tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1673'>tests/core/actions/test_forms.py~L1673</a></p>
<pre><code class="language-diff"> 
 
 async def test_action_extract_slots_custom_mapping_with_condition():
-    domain_yaml = textwrap.dedent(f&quot;&quot;&quot;
+    domain_yaml = textwrap.dedent(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
 
         slots:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1692'>tests/core/actions/test_forms.py~L1692</a></p>
<pre><code class="language-diff"> 
         actions:
         - validate_some_form
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain_yaml)
     events = [ActiveLoop(&quot;some_form&quot;), UserUttered(&quot;Hi&quot;)]
     tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1733'>tests/core/actions/test_forms.py~L1733</a></p>
<pre><code class="language-diff"> 
 async def test_form_slots_empty_with_restart():
     domain = Domain.from_yaml(
-        textwrap.dedent(f&quot;&quot;&quot;
+        textwrap.dedent(
+            f&quot;&quot;&quot;
             version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
             intent:
             - greet
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1753'>tests/core/actions/test_forms.py~L1753</a></p>
<pre><code class="language-diff">              some_form:
                required_slots:
                  - name
-            &quot;&quot;&quot;)
+            &quot;&quot;&quot;
+        )
     )
 
     tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1795'>tests/core/actions/test_forms.py~L1795</a></p>
<pre><code class="language-diff"> 
     form_name = &quot;test_form&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
     entities:
     - {entity_name}
     slots:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1810'>tests/core/actions/test_forms.py~L1810</a></p>
<pre><code class="language-diff">       {form_name}:
         {REQUIRED_SLOTS_KEY}:
             - {slot_name}
-    &quot;&quot;&quot;)
+    &quot;&quot;&quot;
+    )
 
     events = [
         ActionExecuted(&quot;action_listen&quot;),
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1861'>tests/core/actions/test_forms.py~L1861</a></p>
<pre><code class="language-diff">     action_server = EndpointConfig(ACTION_SERVER_URL)
     action = FormAction(form_name, action_server)
     slot_name = &quot;num_people&quot;
-    domain = textwrap.dedent(f&quot;&quot;&quot;
+    domain = textwrap.dedent(
+        f&quot;&quot;&quot;
     slots:
       {slot_name}:
         type: float
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1877'>tests/core/actions/test_forms.py~L1877</a></p>
<pre><code class="language-diff">       - text: &quot;How many people?&quot;
     actions:
       - validate_{form_name}
-    &quot;&quot;&quot;)
+    &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain)
     form_validation_events = [
         {
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1929'>tests/core/actions/test_forms.py~L1929</a></p>
<pre><code class="language-diff">     required_slot = &quot;send_sms&quot;
     global_slot = &quot;membership&quot;
 
-    domain = textwrap.dedent(f&quot;&quot;&quot;
+    domain = textwrap.dedent(
+        f&quot;&quot;&quot;
     intents:
     - start_form
     entities:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L1967'>tests/core/actions/test_forms.py~L1967</a></p>
<pre><code class="language-diff">       - text: &quot;Would you like to receive an SMS?&quot;
     actions:
       - validate_{form}
-    &quot;&quot;&quot;)
+    &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain)
 
     tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L2033'>tests/core/actions/test_forms.py~L2033</a></p>
<pre><code class="language-diff">     dynamic_slot = &quot;customer_name&quot;
     bot_utterance = &quot;What is your name?&quot;
 
-    domain = textwrap.dedent(f&quot;&quot;&quot;
+    domain = textwrap.dedent(
+        f&quot;&quot;&quot;
     intents:
     - start_form
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_forms.py#L2052'>tests/core/actions/test_forms.py~L2052</a></p>
<pre><code class="language-diff">       - text: &quot;{bot_utterance}&quot;
     actions:
       - validate_{form}
-    &quot;&quot;&quot;)
+    &quot;&quot;&quot;
+    )
     domain = Domain.from_yaml(domain)
 
     tracker = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/actions/test_two_stage_fallback.py#L157'>tests/core/actions/test_two_stage_fallback.py~L157</a></p>
<pre><code class="language-diff">         ],
     )
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         responses:
             utter_ask_rephrase:
             - text: {rephrase_text}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     action = TwoStageFallbackAction()
 
     events = await action.run(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L89'>tests/core/nlg/test_generator.py~L89</a></p>
<pre><code class="language-diff">     )
     output_channel = &quot;default&quot;
 
-    domain_yaml = textwrap.dedent(&quot;&quot;&quot;
+    domain_yaml = textwrap.dedent(
+        &quot;&quot;&quot;
         version: &quot;3.1&quot;
 
         intents:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L124'>tests/core/nlg/test_generator.py~L124</a></p>
<pre><code class="language-diff">               - type: slot
                 name: logged_in
                 value: true
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     domain = Domain.from_yaml(domain_yaml)
     response_variation_filter = ResponseVariationFilter(domain.responses)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L161'>tests/core/nlg/test_generator.py~L161</a></p>
<pre><code class="language-diff">     )
     output_channel = &quot;default&quot;
 
-    domain_yaml = textwrap.dedent(&quot;&quot;&quot;
+    domain_yaml = textwrap.dedent(
+        &quot;&quot;&quot;
         version: &quot;3.1&quot;
 
         intents:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L192'>tests/core/nlg/test_generator.py~L192</a></p>
<pre><code class="language-diff">               - type: slot
                 name: membership
                 value: gold
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     domain = Domain.from_yaml(domain_yaml)
     response_variation_filter = ResponseVariationFilter(domain.responses)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L220'>tests/core/nlg/test_generator.py~L220</a></p>
<pre><code class="language-diff">         sender_id=&quot;crv_channel&quot;, evts=[UserUttered(&quot;Hello&quot;)], slots=[membership_slot]
     )
 
-    domain_yaml = textwrap.dedent(&quot;&quot;&quot;
+    domain_yaml = textwrap.dedent(
+        &quot;&quot;&quot;
         version: &quot;3.1&quot;
 
         intents:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L257'>tests/core/nlg/test_generator.py~L257</a></p>
<pre><code class="language-diff">                 name: membership
                 value: gold
               channel: web
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     domain = Domain.from_yaml(domain_yaml)
     response_variation_filter = ResponseVariationFilter(domain.responses)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L312'>tests/core/nlg/test_generator.py~L312</a></p>
<pre><code class="language-diff">         sender_id=&quot;edge_cases&quot;, evts=[UserUttered(&quot;Hello&quot;)], slots=[membership_slot]
     )
 
-    domain_yaml = textwrap.dedent(&quot;&quot;&quot;
+    domain_yaml = textwrap.dedent(
+        &quot;&quot;&quot;
         version: &quot;3.1&quot;
 
         intents:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L363'>tests/core/nlg/test_generator.py~L363</a></p>
<pre><code class="language-diff">               - type: slot
                 name: membership
                 value: gold
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     domain = Domain.from_yaml(domain_yaml)
     response_variation_filter = ResponseVariationFilter(domain.responses)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L391'>tests/core/nlg/test_generator.py~L391</a></p>
<pre><code class="language-diff">         sender_id=&quot;duplicate_ids&quot;, evts=[UserUttered(&quot;Hello&quot;)], slots=[membership_slot]
     )
 
-    domain_yaml = textwrap.dedent(&quot;&quot;&quot;
+    domain_yaml = textwrap.dedent(
+        &quot;&quot;&quot;
         version: &quot;3.1&quot;
 
         intents:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_generator.py#L418'>tests/core/nlg/test_generator.py~L418</a></p>
<pre><code class="language-diff"> 
             - text: &quot;&quot;
               id: &quot;ID_1&quot;
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     domain = Domain.from_yaml(domain_yaml)
     response_variation_filter = ResponseVariationFilter(domain.responses)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L368'>tests/core/nlg/test_response.py~L368</a></p>
<pre><code class="language-diff"> 
 
 async def test_nlg_non_matching_channel():
-    domain = Domain.from_yaml(&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        &quot;&quot;&quot;
     version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
     responses:
         utter_hi:
         - text: &quot;Hello&quot;
         - text: &quot;Hello Slack&quot;
           channel: &quot;slack&quot;
-    &quot;&quot;&quot;)
+    &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     tracker = DialogueStateTracker(sender_id=&quot;test&quot;, slots=[])
     r = await t.generate(&quot;utter_hi&quot;, tracker, &quot;signal&quot;)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L383'>tests/core/nlg/test_response.py~L383</a></p>
<pre><code class="language-diff"> 
 
 async def test_nlg_conditional_response_variations_with_none_slot():
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         responses:
             utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L392'>tests/core/nlg/test_response.py~L392</a></p>
<pre><code class="language-diff">               - type: slot
                 name: account
                 value: &quot;A&quot;
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     slot = AnySlot(
         name=&quot;account&quot;, mappings=[{}], initial_value=None, influence_conversation=False
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L403'>tests/core/nlg/test_response.py~L403</a></p>
<pre><code class="language-diff"> 
 
 async def test_nlg_conditional_response_variations_with_slot_not_a_constraint():
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
             version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
             responses:
                 utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L412'>tests/core/nlg/test_response.py~L412</a></p>
<pre><code class="language-diff">                   - type: slot
                     name: account
                     value: &quot;A&quot;
-            &quot;&quot;&quot;)
+            &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     slot = TextSlot(
         name=&quot;account&quot;, mappings=[{}], initial_value=&quot;B&quot;, influence_conversation=False
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L423'>tests/core/nlg/test_response.py~L423</a></p>
<pre><code class="language-diff"> 
 
 async def test_nlg_conditional_response_variations_with_null_slot():
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
                 version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
                 responses:
                     utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L432'>tests/core/nlg/test_response.py~L432</a></p>
<pre><code class="language-diff">                       - type: slot
                         name: account
                         value: null
-                &quot;&quot;&quot;)
+                &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     slot = AnySlot(
         name=&quot;account&quot;, mappings=[{}], initial_value=None, influence_conversation=False
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L447'>tests/core/nlg/test_response.py~L447</a></p>
<pre><code class="language-diff"> 
 
 async def test_nlg_conditional_response_variations_channel_no_condition_met():
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         responses:
            utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L458'>tests/core/nlg/test_response.py~L458</a></p>
<pre><code class="language-diff">                   value: A
                channel: os
              - text: &quot;default&quot;
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     tracker = DialogueStateTracker(sender_id=&quot;test&quot;, slots=[])
     r = await t.generate(&quot;utter_action&quot;, tracker, &quot;os&quot;)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L466'>tests/core/nlg/test_response.py~L466</a></p>
<pre><code class="language-diff"> 
 
 async def test_nlg_conditional_response_variation_condition_met_channel_mismatch():
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         responses:
            utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L478'>tests/core/nlg/test_response.py~L478</a></p>
<pre><code class="language-diff">                channel: os
              - text: &quot;app default&quot;
                channel: app
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     slot = TextSlot(
         &quot;test&quot;, mappings=[{}], initial_value=&quot;A&quot;, influence_conversation=False
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L530'>tests/core/nlg/test_response.py~L530</a></p>
<pre><code class="language-diff">     ],
 )
 async def test_nlg_conditional_edgecases(slots, channel, expected_response):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         responses:
            utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L561'>tests/core/nlg/test_response.py~L561</a></p>
<pre><code class="language-diff">                   value: B
 
              - text: &quot;default&quot;
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     tracker = DialogueStateTracker(sender_id=&quot;test&quot;, slots=slots)
     r = await t.generate(&quot;utter_action&quot;, tracker, channel)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L571'>tests/core/nlg/test_response.py~L571</a></p>
<pre><code class="language-diff"> async def test_nlg_conditional_response_variations_condition_logging(
     caplog: LogCaptureFixture,
 ):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         responses:
            utter_action:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L584'>tests/core/nlg/test_response.py~L584</a></p>
<pre><code class="language-diff">                   name: test_B
                   value: B
              - text: &quot;default&quot;
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     t = TemplatedNaturalLanguageGenerator(domain.responses)
     slot_A = TextSlot(
         name=&quot;test_A&quot;, mappings=[{}], initial_value=&quot;A&quot;, influence_conversation=False
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L157'>tests/core/policies/test_rule_policy.py~L157</a></p>
<pre><code class="language-diff">     # conversation start -&gt; ensure that this isn't flagged as a contradiction.
 
     utter_anti_greet_action = &quot;utter_anti_greet&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
         - {utter_anti_greet_action}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     greet_rule_at_conversation_start = TrackerWithCachedStates.from_events(
         &quot;greet rule at conversation start&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L208'>tests/core/policies/test_rule_policy.py~L208</a></p>
<pre><code class="language-diff">     utter_anti_greet_action = &quot;utter_anti_greet&quot;
     some_slot = &quot;slot1&quot;
     some_slot_initial_value = &quot;slot1value&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L221'>tests/core/policies/test_rule_policy.py~L221</a></p>
<pre><code class="language-diff">             initial_value: {some_slot_initial_value}
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     greet_rule_at_conversation_start = TrackerWithCachedStates.from_events(
         &quot;greet rule at conversation start&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L279'>tests/core/policies/test_rule_policy.py~L279</a></p>
<pre><code class="language-diff">     utter_anti_greet_action = &quot;utter_anti_greet&quot;
     some_slot = &quot;slot1&quot;
     some_slot_initial_value = &quot;slot1value&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L292'>tests/core/policies/test_rule_policy.py~L292</a></p>
<pre><code class="language-diff">             initial_value: {some_slot_initial_value}
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     greet_rule_at_conversation_start = TrackerWithCachedStates.from_events(
         &quot;greet rule at conversation start&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L342'>tests/core/policies/test_rule_policy.py~L342</a></p>
<pre><code class="language-diff"> 
 
 def test_restrict_multiple_user_inputs_in_rules(policy: RulePolicy):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     greet_events = [
         UserUttered(intent={&quot;name&quot;: GREET_INTENT_NAME}),
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L372'>tests/core/policies/test_rule_policy.py~L372</a></p>
<pre><code class="language-diff"> def test_incomplete_rules_due_to_slots(policy: RulePolicy):
     some_action = &quot;some_action&quot;
     some_slot = &quot;some_slot&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L383'>tests/core/policies/test_rule_policy.py~L383</a></p>
<pre><code class="language-diff">             type: text
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     complete_rule = TrackerWithCachedStates.from_events(
         &quot;complete_rule&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L440'>tests/core/policies/test_rule_policy.py~L440</a></p>
<pre><code class="language-diff"> def test_no_incomplete_rules_due_to_slots_after_listen(policy: RulePolicy):
     some_action = &quot;some_action&quot;
     some_slot = &quot;some_slot&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L453'>tests/core/policies/test_rule_policy.py~L453</a></p>
<pre><code class="language-diff">             type: text
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     complete_rule = TrackerWithCachedStates.from_events(
         &quot;complete_rule&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L500'>tests/core/policies/test_rule_policy.py~L500</a></p>
<pre><code class="language-diff">     some_slot_value = &quot;value1&quot;
     some_other_slot = &quot;some_other_slot&quot;
     some_other_slot_value = &quot;value2&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L515'>tests/core/policies/test_rule_policy.py~L515</a></p>
<pre><code class="language-diff">             type: text
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     simple_rule = TrackerWithCachedStates.from_events(
         &quot;simple rule with an action that sets 1 slot&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L553'>tests/core/policies/test_rule_policy.py~L553</a></p>
<pre><code class="language-diff"> 
 def test_incomplete_rules_due_to_loops(policy: RulePolicy):
     some_form = &quot;some_form&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         forms:
           {some_form}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     complete_rule = TrackerWithCachedStates.from_events(
         &quot;complete_rule&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L616'>tests/core/policies/test_rule_policy.py~L616</a></p>
<pre><code class="language-diff"> 
 def test_contradicting_rules(policy: RulePolicy):
     utter_anti_greet_action = &quot;utter_anti_greet&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
         - {utter_anti_greet_action}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     anti_greet_rule = TrackerWithCachedStates.from_events(
         &quot;anti greet rule&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L654'>tests/core/policies/test_rule_policy.py~L654</a></p>
<pre><code class="language-diff"> 
 def test_contradicting_rules_and_stories(policy: RulePolicy):
     utter_anti_greet_action = &quot;utter_anti_greet&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
         - {utter_anti_greet_action}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     anti_greet_story = TrackerWithCachedStates.from_events(
         &quot;anti greet story&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L796'>tests/core/policies/test_rule_policy.py~L796</a></p>
<pre><code class="language-diff"> 
 
 def test_faq_rule(policy: RulePolicy):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
     # remove first ... action and utter_greet and last action_listen from greet rule
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L821'>tests/core/policies/test_rule_policy.py~L821</a></p>
<pre><code class="language-diff"> async def test_predict_form_action_if_in_form(policy: RulePolicy):
     form_name = &quot;some_form&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L836'>tests/core/policies/test_rule_policy.py~L836</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L864'>tests/core/policies/test_rule_policy.py~L864</a></p>
<pre><code class="language-diff"> async def test_predict_loop_action_if_in_loop_but_there_is_e2e_rule(policy: RulePolicy):
     loop_name = &quot;some_loop&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L879'>tests/core/policies/test_rule_policy.py~L879</a></p>
<pre><code class="language-diff">         forms:
           {loop_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     e2e_rule = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L918'>tests/core/policies/test_rule_policy.py~L918</a></p>
<pre><code class="language-diff"> async def test_predict_form_action_if_multiple_turns(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     other_intent = &quot;bye&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L934'>tests/core/policies/test_rule_policy.py~L934</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L966'>tests/core/policies/test_rule_policy.py~L966</a></p>
<pre><code class="language-diff"> 
 
 async def test_predict_slot_initial_value_not_required_in_rule(policy: RulePolicy):
-    domain = Domain.from_yaml(&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        &quot;&quot;&quot;
 intents:
 - i1
 actions:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L980'>tests/core/policies/test_rule_policy.py~L980</a></p>
<pre><code class="language-diff">     initial_value: v1
     mappings:
     - type: from_text
-&quot;&quot;&quot;)
+&quot;&quot;&quot;
+    )
 
     rule = DialogueStateTracker.from_events(
         &quot;slot rule&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1014'>tests/core/policies/test_rule_policy.py~L1014</a></p>
<pre><code class="language-diff"> 
 
 async def test_predict_slot_with_initial_slot_matches_rule(policy: RulePolicy):
-    domain = Domain.from_yaml(&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        &quot;&quot;&quot;
 intents:
 - i1
 actions:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1028'>tests/core/policies/test_rule_policy.py~L1028</a></p>
<pre><code class="language-diff">     initial_value: v1
     mappings:
     - type: from_text
-&quot;&quot;&quot;)
+&quot;&quot;&quot;
+    )
 
     rule = DialogueStateTracker.from_events(
         &quot;slot rule&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1061'>tests/core/policies/test_rule_policy.py~L1061</a></p>
<pre><code class="language-diff"> async def test_predict_action_listen_after_form(policy: RulePolicy):
     form_name = &quot;some_form&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1076'>tests/core/policies/test_rule_policy.py~L1076</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1106'>tests/core/policies/test_rule_policy.py~L1106</a></p>
<pre><code class="language-diff"> async def test_dont_predict_form_if_already_finished(policy: RulePolicy):
     form_name = &quot;some_form&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1121'>tests/core/policies/test_rule_policy.py~L1121</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1155'>tests/core/policies/test_rule_policy.py~L1155</a></p>
<pre><code class="language-diff"> async def test_form_unhappy_path(policy: RulePolicy):
     form_name = &quot;some_form&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1170'>tests/core/policies/test_rule_policy.py~L1170</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1198'>tests/core/policies/test_rule_policy.py~L1198</a></p>
<pre><code class="language-diff"> async def test_form_unhappy_path_from_general_rule(policy: RulePolicy):
     form_name = &quot;some_form&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1213'>tests/core/policies/test_rule_policy.py~L1213</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     # RulePolicy should memorize that unhappy_rule overrides GREET_RULE
     policy.train([GREET_RULE], domain)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1253'>tests/core/policies/test_rule_policy.py~L1253</a></p>
<pre><code class="language-diff">     form_name = &quot;some_form&quot;
     handle_rejection_action_name = &quot;utter_handle_rejection&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1269'>tests/core/policies/test_rule_policy.py~L1269</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     unhappy_rule = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1327'>tests/core/policies/test_rule_policy.py~L1327</a></p>
<pre><code class="language-diff">     form_name = &quot;some_form&quot;
     handle_rejection_action_name = &quot;utter_handle_rejection&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1343'>tests/core/policies/test_rule_policy.py~L1343</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     unhappy_story = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1402'>tests/core/policies/test_rule_policy.py~L1402</a></p>
<pre><code class="language-diff">     form_name = &quot;some_form&quot;
     handle_rejection_action_name = &quot;utter_handle_rejection&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1418'>tests/core/policies/test_rule_policy.py~L1418</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     unhappy_rule = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1491'>tests/core/policies/test_rule_policy.py~L1491</a></p>
<pre><code class="language-diff">     form_name = &quot;some_form&quot;
     handle_rejection_action_name = &quot;utter_handle_rejection&quot;
 
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1507'>tests/core/policies/test_rule_policy.py~L1507</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     unhappy_story = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1559'>tests/core/policies/test_rule_policy.py~L1559</a></p>
<pre><code class="language-diff"> async def test_form_unhappy_path_without_rule(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     other_intent = &quot;bye&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1575'>tests/core/policies/test_rule_policy.py~L1575</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1603'>tests/core/policies/test_rule_policy.py~L1603</a></p>
<pre><code class="language-diff"> async def test_form_activation_rule(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     other_intent = &quot;bye&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1619'>tests/core/policies/test_rule_policy.py~L1619</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     form_activation_rule = _form_activation_rule(domain, form_name, other_intent)
     policy.train([GREET_RULE, form_activation_rule], domain)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1642'>tests/core/policies/test_rule_policy.py~L1642</a></p>
<pre><code class="language-diff"> async def test_failing_form_activation_due_to_no_rule(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     other_intent = &quot;bye&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1658'>tests/core/policies/test_rule_policy.py~L1658</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1681'>tests/core/policies/test_rule_policy.py~L1681</a></p>
<pre><code class="language-diff"> def test_form_submit_rule(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     submit_action_name = &quot;utter_submit&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1697'>tests/core/policies/test_rule_policy.py~L1697</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     form_submit_rule = _form_submit_rule(domain, submit_action_name, form_name)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1733'>tests/core/policies/test_rule_policy.py~L1733</a></p>
<pre><code class="language-diff">     submit_action_name = &quot;utter_submit&quot;
     entity = &quot;some_entity&quot;
     slot = &quot;some_slot&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1755'>tests/core/policies/test_rule_policy.py~L1755</a></p>
<pre><code class="language-diff">             required_slots: []
         entities:
         - {entity}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     form_activation_rule = _form_activation_rule(domain, form_name, GREET_INTENT_NAME)
     form_submit_rule = _form_submit_rule(domain, submit_action_name, form_name)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1837'>tests/core/policies/test_rule_policy.py~L1837</a></p>
<pre><code class="language-diff"> 
 
 async def test_one_stage_fallback_rule(policy: RulePolicy):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         - {DEFAULT_NLU_FALLBACK_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     fallback_recover_rule = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1918'>tests/core/policies/test_rule_policy.py~L1918</a></p>
<pre><code class="language-diff"> def test_default_actions(
     intent_name: Text, expected_action_name: Text, policy: RulePolicy
 ):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     policy.train([GREET_RULE], domain)
     new_conversation = DialogueStateTracker.from_events(
         &quot;bla2&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L1944'>tests/core/policies/test_rule_policy.py~L1944</a></p>
<pre><code class="language-diff">     &quot;intent_name&quot;, [USER_INTENT_RESTART, USER_INTENT_BACK, USER_INTENT_SESSION_START]
 )
 def test_e2e_beats_default_actions(intent_name: Text, policy: RulePolicy):
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         actions:
         - {UTTER_GREET_ACTION}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     e2e_rule = TrackerWithCachedStates.from_events(
         &quot;bla&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2003'>tests/core/policies/test_rule_policy.py~L2003</a></p>
<pre><code class="language-diff">     expected_prediction: Text,
 ):
     other_intent = &quot;other&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2011'>tests/core/policies/test_rule_policy.py~L2011</a></p>
<pre><code class="language-diff">         actions:
         - {UTTER_GREET_ACTION}
         - my_core_fallback
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     rule_policy = policy_with_config(config)
     rule_policy.train([GREET_RULE], domain)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2034'>tests/core/policies/test_rule_policy.py~L2034</a></p>
<pre><code class="language-diff">     policy_with_config: Callable[..., RulePolicy],
 ):
     other_intent = &quot;other&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
         - {other_intent}
         actions:
         - {UTTER_GREET_ACTION}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     policy = policy_with_config({&quot;enable_fallback_prediction&quot;: False})
     policy.train([GREET_RULE], domain)
     new_conversation = DialogueStateTracker.from_events(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2059'>tests/core/policies/test_rule_policy.py~L2059</a></p>
<pre><code class="language-diff"> def test_hide_rule_turn(policy: RulePolicy):
     chitchat = &quot;chitchat&quot;
     action_chitchat = &quot;action_chitchat&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2067'>tests/core/policies/test_rule_policy.py~L2067</a></p>
<pre><code class="language-diff">         actions:
         - {UTTER_GREET_ACTION}
         - {action_chitchat}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     chitchat_story = TrackerWithCachedStates.from_events(
         &quot;chitchat story&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2137'>tests/core/policies/test_rule_policy.py~L2137</a></p>
<pre><code class="language-diff">     some_slot_value = &quot;value1&quot;
     slot_which_is_also_in_story = &quot;slot_which_is_also_in_story&quot;
     some_other_slot_value = &quot;value2&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {some_intent}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2154'>tests/core/policies/test_rule_policy.py~L2154</a></p>
<pre><code class="language-diff">             type: text
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     simple_rule = TrackerWithCachedStates.from_events(
         &quot;simple rule with an action that sets 1 slot&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2262'>tests/core/policies/test_rule_policy.py~L2262</a></p>
<pre><code class="language-diff">     chitchat = &quot;chitchat&quot;
     action_chitchat = &quot;action_chitchat&quot;
     followup_on_chitchat = &quot;followup_on_chitchat&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {chitchat}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2274'>tests/core/policies/test_rule_policy.py~L2274</a></p>
<pre><code class="language-diff">             type: bool
             mappings:
             - type: from_text
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     simple_rule_no_last_action_listen = TrackerWithCachedStates.from_events(
         &quot;simple rule without action listen in the end&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2348'>tests/core/policies/test_rule_policy.py~L2348</a></p>
<pre><code class="language-diff">     activate_another_form = &quot;activate_another_form&quot;
     chitchat = &quot;chitchat&quot;
     action_chitchat = &quot;action_chitchat&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2368'>tests/core/policies/test_rule_policy.py~L2368</a></p>
<pre><code class="language-diff">             required_slots: []
           {another_form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     form_activation_rule = _form_activation_rule(domain, form_name, activate_form)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2454'>tests/core/policies/test_rule_policy.py~L2454</a></p>
<pre><code class="language-diff"> def test_do_not_hide_rule_turn_with_loops_in_stories(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     activate_form = &quot;activate_form&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {activate_form}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2466'>tests/core/policies/test_rule_policy.py~L2466</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     form_activation_rule = _form_activation_rule(domain, form_name, activate_form)
     form_activation_story = form_activation_rule.copy()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2507'>tests/core/policies/test_rule_policy.py~L2507</a></p>
<pre><code class="language-diff"> def test_hide_rule_turn_with_loops_as_followup_action(policy: RulePolicy):
     form_name = &quot;some_form&quot;
     activate_form = &quot;activate_form&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {GREET_INTENT_NAME}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2522'>tests/core/policies/test_rule_policy.py~L2522</a></p>
<pre><code class="language-diff">         forms:
           {form_name}:
             required_slots: []
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
 
     form_activation_rule = _form_activation_rule(domain, form_name, activate_form)
     form_activation_story = form_activation_rule.copy()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2609'>tests/core/policies/test_rule_policy.py~L2609</a></p>
<pre><code class="language-diff">     intent_1 = &quot;intent_1&quot;
     utter_1 = &quot;utter_1&quot;
     utter_2 = &quot;utter_2&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {intent_1}
         actions:
         - {utter_1}
         - {utter_2}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     rule = TrackerWithCachedStates.from_events(
         &quot;conditioned on action&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2652'>tests/core/policies/test_rule_policy.py~L2652</a></p>
<pre><code class="language-diff">     utter_1 = &quot;utter_1&quot;
     utter_2 = &quot;utter_2&quot;
     utter_3 = &quot;utter_3&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {intent_1}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2660'>tests/core/policies/test_rule_policy.py~L2660</a></p>
<pre><code class="language-diff">         - {utter_1}
         - {utter_2}
         - {utter_3}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     rule = TrackerWithCachedStates.from_events(
         &quot;action_listen after predictable action&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2696'>tests/core/policies/test_rule_policy.py~L2696</a></p>
<pre><code class="language-diff">     intent_1 = &quot;intent_1&quot;
     utter_1 = &quot;utter_1&quot;
     utter_2 = &quot;utter_2&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {intent_1}
         actions:
         - {utter_1}
         - {utter_2}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     rule = TrackerWithCachedStates.from_events(
         &quot;last prediction is action_listen&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2735'>tests/core/policies/test_rule_policy.py~L2735</a></p>
<pre><code class="language-diff">     intent_1 = &quot;intent_1&quot;
     utter_1 = &quot;utter_1&quot;
     utter_2 = &quot;utter_2&quot;
-    domain = Domain.from_yaml(f&quot;&quot;&quot;
+    domain = Domain.from_yaml(
+        f&quot;&quot;&quot;
         version: &quot;{LATEST_TRAINING_DATA_FORMAT_VERSION}&quot;
         intents:
         - {intent_1}
         actions:
         - {utter_1}
         - {utter_2}
-        &quot;&quot;&quot;)
+        &quot;&quot;&quot;
+    )
     rule = TrackerWithCachedStates.from_events(
         &quot;conditioned on action&quot;,
         domain=domain,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/policies/test_rule_policy.py#L2776'>tests/core/policies/test_rule_policy.py~L2776</a></p>
<pre><code class="language-diff">     intent_1 = &quot;intent_1&quot;
     utter_1 = &quot;utter_1&quot;
     utter_2 = &quot;utter_2&quot;
-    domain = Domain.from_yaml(f&quot;&quot;...*[Comment body truncated]*
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @MichaReiser on 2024-01-25 08:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @MichaReiser on 2024-01-25 08:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @MichaReiser on 2024-01-25 08:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-01-25 17:40</div>
            <div class="timeline-body"><p>Looks great.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-25 17:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/src/expression/parentheses.rs</code>:199 on 2024-01-25 17:41</div>
            <div class="timeline-body"><p>So this got much simpler because we no longer check if indenting would allow us to avoid line-length violations?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/src/expression/parentheses.rs</code>:199 on 2024-01-26 07:18</div>
            <div class="timeline-body"><p>Yes. Breaking only if the first line doesn't fit required a more complicated IR. Now it's simpler, because we always or never indent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-01-26 07:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-01-26 07:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-01-26 07:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-26 07:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:58:06 UTC
    </footer>
</body>
</html>
