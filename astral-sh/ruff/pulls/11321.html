<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider with statements for too many branches lint - astral-sh/ruff #11321</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider with statements for too many branches lint</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11321">#11321</a>
        opened by <a href="https://github.com/blueraft">@blueraft</a>
        on 2024-05-07 10:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/blueraft">@blueraft</a></div>
            <div class="timeline-body"><p>Resolves <a href="https://github.com/astral-sh/ruff/issues/11313">astral-sh/ruff#11313</a></p>
Summary
<p>PLR0912(too-many-branches) did not count branches inside with: blocks. With this fix, the branches inside with statements are also counted.</p>
Test Plan
<p>Added a new test case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-05-07 10:33</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+45 -16 violations, +0 -0 fixes in 3 projects; 41 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+29 -6 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/connection_command.py#L209">airflow/cli/commands/connection_command.py:209:5:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/connection_command.py#L209">airflow/cli/commands/connection_command.py:209:5:</a> PLR0912 Too many branches (19 &gt; 12)
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L404">airflow/cli/commands/task_command.py:404:5:</a> PLR0912 Too many branches (15 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L404">airflow/cli/commands/task_command.py:404:5:</a> PLR0912 Too many branches (16 &gt; 12)
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L631">airflow/cli/commands/task_command.py:631:5:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L631">airflow/cli/commands/task_command.py:631:5:</a> PLR0912 Too many branches (18 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/dagrun.py#L755">airflow/models/dagrun.py:755:9:</a> PLR0912 Too many branches (15 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/taskinstance.py#L2489">airflow/models/taskinstance.py:2489:9:</a> PLR0912 Too many branches (24 &gt; 12)
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/taskinstance.py#L400">airflow/models/taskinstance.py:400:5:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/taskinstance.py#L400">airflow/models/taskinstance.py:400:5:</a> PLR0912 Too many branches (22 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/apache/hive/transfers/s3_to_hive.py#L141">airflow/providers/apache/hive/transfers/s3_to_hive.py:141:9:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/apache/livy/hooks/livy.py#L496">airflow/providers/apache/livy/hooks/livy.py:496:15:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py#L213">airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py:213:9:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py#L379">airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py:379:9:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/common/sql/hooks/sql.py#L356">airflow/providers/common/sql/hooks/sql.py:356:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/databricks/hooks/databricks_sql.py#L199">airflow/providers/databricks/hooks/databricks_sql.py:199:9:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/databricks/operators/databricks_sql.py#L126">airflow/providers/databricks/operators/databricks_sql.py:126:9:</a> PLR0912 Too many branches (13 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/elasticsearch/log/es_task_handler.py#L216">airflow/providers/elasticsearch/log/es_task_handler.py:216:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/exasol/hooks/exasol.py#L187">airflow/providers/exasol/hooks/exasol.py:187:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/google/cloud/operators/gcs.py#L792">airflow/providers/google/cloud/operators/gcs.py:792:9:</a> PLR0912 Too many branches (20 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/http/hooks/http.py#L318">airflow/providers/http/hooks/http.py:318:15:</a> PLR0912 Too many branches (24 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/openlineage/utils/utils.py#L305">airflow/providers/openlineage/utils/utils.py:305:9:</a> PLR0912 Too many branches (13 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/snowflake/hooks/snowflake.py#L340">airflow/providers/snowflake/hooks/snowflake.py:340:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/utils/db.py#L1554">airflow/utils/db.py:1554:5:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/www/views.py#L3424">airflow/www/views.py:3424:9:</a> PLR0912 Too many branches (13 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/www/views.py#L739">airflow/www/views.py:739:9:</a> PLR0912 Too many branches (36 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/dev/breeze/src/airflow_breeze/commands/release_management_commands.py#L2021">dev/breeze/src/airflow_breeze/commands/release_management_commands.py:2021:5:</a> PLR0912 Too many branches (23 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/dev/breeze/src/airflow_breeze/commands/release_management_commands.py#L3277">dev/breeze/src/airflow_breeze/commands/release_management_commands.py:3277:5:</a> PLR0912 Too many branches (19 &gt; 12)
... 7 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+2 -2 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/command/subcommands/serve.py#L802">src/bokeh/command/subcommands/serve.py:802:9:</a> PLR0912 Too many branches (25 &gt; 12)
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/command/subcommands/serve.py#L802">src/bokeh/command/subcommands/serve.py:802:9:</a> PLR0912 Too many branches (31 &gt; 12)
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L259">src/bokeh/embed/bundle.py:259:5:</a> PLR0912 Too many branches (15 &gt; 12)
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L259">src/bokeh/embed/bundle.py:259:5:</a> PLR0912 Too many branches (17 &gt; 12)
</pre>

</p>

<a href="https://github.com/zulip/zulip">zulip/zulip</a> (+14 -8 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/corporate/lib/stripe.py#L1700">corporate/lib/stripe.py:1700:9:</a> PLR0912 Too many branches (19 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/corporate/lib/stripe.py#L2770">corporate/lib/stripe.py:2770:9:</a> PLR0912 Too many branches (27 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/corporate/lib/stripe.py#L2770">corporate/lib/stripe.py:2770:9:</a> PLR0912 Too many branches (28 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/create_realm.py#L155">zerver/actions/create_realm.py:155:5:</a> PLR0912 Too many branches (19 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/create_realm.py#L155">zerver/actions/create_realm.py:155:5:</a> PLR0912 Too many branches (22 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/message_send.py#L846">zerver/actions/message_send.py:846:5:</a> PLR0912 Too many branches (29 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/message_send.py#L846">zerver/actions/message_send.py:846:5:</a> PLR0912 Too many branches (34 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/scheduled_messages.py#L129">zerver/actions/scheduled_messages.py:129:5:</a> PLR0912 Too many branches (18 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L775">zerver/lib/import_realm.py:775:5:</a> PLR0912 Too many branches (32 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L775">zerver/lib/import_realm.py:775:5:</a> PLR0912 Too many branches (33 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L966">zerver/lib/import_realm.py:966:5:</a> PLR0912 Too many branches (38 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L966">zerver/lib/import_realm.py:966:5:</a> PLR0912 Too many branches (48 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/push_notifications.py#L1267">zerver/lib/push_notifications.py:1267:5:</a> PLR0912 Too many branches (17 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/management/commands/export_search.py#L101">zerver/management/commands/export_search.py:101:9:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/management/commands/export_search.py#L101">zerver/management/commands/export_search.py:101:9:</a> PLR0912 Too many branches (18 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/views/message_fetch.py#L99">zerver/views/message_fetch.py:99:5:</a> PLR0912 Too many branches (22 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/views/streams.py#L699">zerver/views/streams.py:699:5:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/worker/base.py#L166">zerver/worker/base.py:166:9:</a> PLR0912 Too many branches (14 &gt; 12)
... 4 additional changes omitted for project
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLR0912 | 61 | 45 | 16 | 0 | 0 |</p>
</p>


Linter (preview)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+45 -16 violations, +0 -0 fixes in 3 projects; 41 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+29 -6 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/connection_command.py#L209">airflow/cli/commands/connection_command.py:209:5:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/connection_command.py#L209">airflow/cli/commands/connection_command.py:209:5:</a> PLR0912 Too many branches (19 &gt; 12)
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L404">airflow/cli/commands/task_command.py:404:5:</a> PLR0912 Too many branches (15 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L404">airflow/cli/commands/task_command.py:404:5:</a> PLR0912 Too many branches (16 &gt; 12)
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L631">airflow/cli/commands/task_command.py:631:5:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/cli/commands/task_command.py#L631">airflow/cli/commands/task_command.py:631:5:</a> PLR0912 Too many branches (18 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/dagrun.py#L755">airflow/models/dagrun.py:755:9:</a> PLR0912 Too many branches (15 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/taskinstance.py#L2489">airflow/models/taskinstance.py:2489:9:</a> PLR0912 Too many branches (24 &gt; 12)
- <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/taskinstance.py#L400">airflow/models/taskinstance.py:400:5:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/models/taskinstance.py#L400">airflow/models/taskinstance.py:400:5:</a> PLR0912 Too many branches (22 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/apache/hive/transfers/s3_to_hive.py#L141">airflow/providers/apache/hive/transfers/s3_to_hive.py:141:9:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/apache/livy/hooks/livy.py#L496">airflow/providers/apache/livy/hooks/livy.py:496:15:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py#L213">airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py:213:9:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py#L379">airflow/providers/cncf/kubernetes/executors/kubernetes_executor.py:379:9:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/common/sql/hooks/sql.py#L356">airflow/providers/common/sql/hooks/sql.py:356:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/databricks/hooks/databricks_sql.py#L199">airflow/providers/databricks/hooks/databricks_sql.py:199:9:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/databricks/operators/databricks_sql.py#L126">airflow/providers/databricks/operators/databricks_sql.py:126:9:</a> PLR0912 Too many branches (13 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/elasticsearch/log/es_task_handler.py#L216">airflow/providers/elasticsearch/log/es_task_handler.py:216:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/exasol/hooks/exasol.py#L187">airflow/providers/exasol/hooks/exasol.py:187:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/google/cloud/operators/gcs.py#L792">airflow/providers/google/cloud/operators/gcs.py:792:9:</a> PLR0912 Too many branches (20 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/http/hooks/http.py#L318">airflow/providers/http/hooks/http.py:318:15:</a> PLR0912 Too many branches (24 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/openlineage/utils/utils.py#L305">airflow/providers/openlineage/utils/utils.py:305:9:</a> PLR0912 Too many branches (13 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/providers/snowflake/hooks/snowflake.py#L340">airflow/providers/snowflake/hooks/snowflake.py:340:9:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/utils/db.py#L1554">airflow/utils/db.py:1554:5:</a> PLR0912 Too many branches (16 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/www/views.py#L3424">airflow/www/views.py:3424:9:</a> PLR0912 Too many branches (13 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/airflow/www/views.py#L739">airflow/www/views.py:739:9:</a> PLR0912 Too many branches (36 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/dev/breeze/src/airflow_breeze/commands/release_management_commands.py#L2021">dev/breeze/src/airflow_breeze/commands/release_management_commands.py:2021:5:</a> PLR0912 Too many branches (23 &gt; 12)
+ <a href="https://github.com/apache/airflow/blob/f5c86edb7967102d26435018e367354735044f56/dev/breeze/src/airflow_breeze/commands/release_management_commands.py#L3277">dev/breeze/src/airflow_breeze/commands/release_management_commands.py:3277:5:</a> PLR0912 Too many branches (19 &gt; 12)
... 7 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+2 -2 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/command/subcommands/serve.py#L802">src/bokeh/command/subcommands/serve.py:802:9:</a> PLR0912 Too many branches (25 &gt; 12)
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/command/subcommands/serve.py#L802">src/bokeh/command/subcommands/serve.py:802:9:</a> PLR0912 Too many branches (31 &gt; 12)
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L259">src/bokeh/embed/bundle.py:259:5:</a> PLR0912 Too many branches (15 &gt; 12)
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L259">src/bokeh/embed/bundle.py:259:5:</a> PLR0912 Too many branches (17 &gt; 12)
</pre>

</p>

<a href="https://github.com/zulip/zulip">zulip/zulip</a> (+14 -8 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/corporate/lib/stripe.py#L1700">corporate/lib/stripe.py:1700:9:</a> PLR0912 Too many branches (19 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/corporate/lib/stripe.py#L2770">corporate/lib/stripe.py:2770:9:</a> PLR0912 Too many branches (27 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/corporate/lib/stripe.py#L2770">corporate/lib/stripe.py:2770:9:</a> PLR0912 Too many branches (28 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/create_realm.py#L155">zerver/actions/create_realm.py:155:5:</a> PLR0912 Too many branches (19 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/create_realm.py#L155">zerver/actions/create_realm.py:155:5:</a> PLR0912 Too many branches (22 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/message_send.py#L846">zerver/actions/message_send.py:846:5:</a> PLR0912 Too many branches (29 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/message_send.py#L846">zerver/actions/message_send.py:846:5:</a> PLR0912 Too many branches (34 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/actions/scheduled_messages.py#L129">zerver/actions/scheduled_messages.py:129:5:</a> PLR0912 Too many branches (18 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L775">zerver/lib/import_realm.py:775:5:</a> PLR0912 Too many branches (32 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L775">zerver/lib/import_realm.py:775:5:</a> PLR0912 Too many branches (33 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L966">zerver/lib/import_realm.py:966:5:</a> PLR0912 Too many branches (38 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/import_realm.py#L966">zerver/lib/import_realm.py:966:5:</a> PLR0912 Too many branches (48 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/lib/push_notifications.py#L1267">zerver/lib/push_notifications.py:1267:5:</a> PLR0912 Too many branches (17 &gt; 12)
- <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/management/commands/export_search.py#L101">zerver/management/commands/export_search.py:101:9:</a> PLR0912 Too many branches (17 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/management/commands/export_search.py#L101">zerver/management/commands/export_search.py:101:9:</a> PLR0912 Too many branches (18 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/views/message_fetch.py#L99">zerver/views/message_fetch.py:99:5:</a> PLR0912 Too many branches (22 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/views/streams.py#L699">zerver/views/streams.py:699:5:</a> PLR0912 Too many branches (14 &gt; 12)
+ <a href="https://github.com/zulip/zulip/blob/a7022bdfecfa82436dfc87f28c6713cbe8b25006/zerver/worker/base.py#L166">zerver/worker/base.py:166:9:</a> PLR0912 Too many branches (14 &gt; 12)
... 4 additional changes omitted for project
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLR0912 | 61 | 45 | 16 | 0 | 0 |</p>
</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:110 on 2024-05-07 10:35</div>
            <div class="timeline-body"><p>I think it should include the <code>with</code> statement <em>and</em> the number of branches in its body.</p>
<pre><code>            Stmt::With(ast::StmtWith { body, .. }) =&gt; 1 + num_branches(body),
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:1 on 2024-05-07 10:36</div>
            <div class="timeline-body"><p>Can you include additional test cases in this file for <code>with</code> statements? They will be at the bottom of this file and they specifically tests the <code>num_branches</code> function.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> requested changes on 2024-05-07 10:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-05-07 10:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-05-07 10:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:110 on 2024-05-07 10:47</div>
            <div class="timeline-body"><p>I think the number of branches is sufficient because the with item itself doesn&#x27;t introduce any branching.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-05-07 11:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:110 on 2024-05-07 11:01</div>
            <div class="timeline-body"><p>The count would then be inconsistent with other branch constructs which <em>do</em> include the statement itself in the final count.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/blueraft">@blueraft</a> reviewed on 2024-05-07 11:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/blueraft">@blueraft</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:110 on 2024-05-07 11:03</div>
            <div class="timeline-body"><p>For the python file below, I get the same amount of branches in both cases from pylint. Seems like pylint doesn&#x27;t include the <code>with</code> statement.</p>
<pre><code>❯ pylint bad.py
************* Module bad
bad.py:6:8: R1705: Unnecessary &quot;elif&quot; after &quot;return&quot;, remove the leading &quot;el&quot; from &quot;elif&quot; (no-else-return)
bad.py:4:0: R0912: Too many branches (11/10) (too-many-branches)
bad.py:31:4: R1705: Unnecessary &quot;elif&quot; after &quot;return&quot;, remove the leading &quot;el&quot; from &quot;elif&quot; (no-else-return)
bad.py:30:0: R0912: Too many branches (11/10) (too-many-branches)
</code></pre>
<pre><code>from contextlib import suppress


def num_to_word_with(x):  # [too-many-branches]
    with suppress(Exception):
        if x == 0:
            return &#x27;zero&#x27;
        elif x == 1:
            return &#x27;one&#x27;
        elif x == 2:
            return &#x27;two&#x27;
        elif x == 3:
            return &#x27;three&#x27;
        elif x == 4:
            return &#x27;four&#x27;
        elif x == 5:
            return &#x27;five&#x27;
        elif x == 6:
            return &#x27;six&#x27;
        elif x == 7:
            return &#x27;seven&#x27;
        elif x == 8:
            return &#x27;eight&#x27;
        elif x == 9:
            return &#x27;nine&#x27;
        else:
            return None


def num_to_word(x):  # [too-many-branches]
    if x == 0:
        return &#x27;zero&#x27;
    elif x == 1:
        return &#x27;one&#x27;
    elif x == 2:
        return &#x27;two&#x27;
    elif x == 3:
        return &#x27;three&#x27;
    elif x == 4:
        return &#x27;four&#x27;
    elif x == 5:
        return &#x27;five&#x27;
    elif x == 6:
        return &#x27;six&#x27;
    elif x == 7:
        return &#x27;seven&#x27;
    elif x == 8:
        return &#x27;eight&#x27;
    elif x == 9:
        return &#x27;nine&#x27;
    else:
        return None
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-05-07 11:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:110 on 2024-05-07 11:04</div>
            <div class="timeline-body"><blockquote>
<p>The count would then be inconsistent with other branch constructs which do include the statement itself in the final count.</p>
</blockquote>
<p>I think that inconsistency is desired because with items don&#x27;t introduce a new branch. They are not branching instructions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-05-07 11:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:110 on 2024-05-07 11:45</div>
            <div class="timeline-body"><p>Oh yeah, that makes sense. I&#x27;ll mark this as resolved then. Thanks @blueraft for looking into pylint.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:282 on 2024-05-07 11:46</div>
            <div class="timeline-body"><p>Thanks for clarifying this with a comment but I think it would be better suited where the original code is in <code>num_branches</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-05-07 11:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-05-07 11:47</div>
            <div class="timeline-body"><p>Thank you for working on this! Welcome to Ruff :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/blueraft">@blueraft</a> on <code>crates/ruff_linter/src/rules/pylint/rules/too_many_branches.rs</code>:282 on 2024-05-07 11:52</div>
            <div class="timeline-body"><p>I&#x27;ve moved it :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/blueraft">@blueraft</a> reviewed on 2024-05-07 11:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-08 03:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-08 03:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-05-08 08:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:03:59 UTC
    </footer>
</body>
</html>
