<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assignment from none - astral-sh/ruff #4532</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Assignment from none</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/4532">#4532</a>
        opened by <a href="https://github.com/ghost">@ghost</a>
        on 2023-05-19 16:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ghost">@ghost</a></div>
            <div class="timeline-body"><p>Here is a draft of implementing PLE1128. I have a skeleton implementation and need assistance finishing it using Visitor or something similar. Looking for feedback, and suggestions on how to finish this off.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-19 16:39</div>
            <div class="timeline-body"><p>Thank you for this!</p>
<p>Looking at the rule... I don't think we have the compiler infrastructure necessary to support implementing this rule reliably (yet). We could <em>maybe</em> support it in some limited cases (e.g., calling a function from within the file that defines it), but we'd have a lot of false negatives, since we don't yet resolve references across files.</p>
<p>Could I help you pick out a different Pylint rule in lieu of this one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghost">@ghost</a> on 2023-05-19 16:42</div>
            <div class="timeline-body"><p>Ah, cross-file support is not something I had considered just yet... what an interesting problem, I will spend some time considering how to do that once I better understand how Ruff works.</p>
<p>I would absolutely be open to suggestions! I'm from Dish Network and we use ruff across all our Python automation. I'm working with Dish internal teams to set up a process for more Dish devs to contribute to FOSS projects like ruff, so expect some more from us in the near future!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-19 16:58</div>
            <div class="timeline-body"><p>That's amazing to hear! Thanks so much for getting involved.</p>
<p>A good chunk of the outstanding Pylint rules can't be implemented yet without improving some of our internal infrastructure, but from scanning the list, here are a few that are doable: <code>W1507</code>, <code>W0124</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-19 17:13</div>
            <div class="timeline-body"><p>(Edit: <code>R0206</code> is already implemented, just not reflected in the issue. Removed it from my suggestion.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> on 2023-05-19 17:27</div>
            <div class="timeline-body"><p>@charliermarsh Is there an open issue/discussion about the said infrastructure? If there are knowledge gaps or decisions that require input, I'd like to help.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-20 15:25</div>
            <div class="timeline-body"><p>@tusharsadhwani - There isn't, it's not yet a priority, but I'll keep this in mind as we start to think through it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-20 15:25</div>
            <div class="timeline-body"><p>(Going to close for now as I don't think we're able to implement this with our current infra.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-05-20 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghost">@ghost</a> on 2023-06-05 20:45</div>
            <div class="timeline-body"><p>@charliermarsh I believe I have an idea for cross-file support, I don't quite know where I would begin tho:</p>
<p>What are your thoughts on having a lookup table that stores all declarations from all files in a given directory/workspace, (exact logic needs to be fleshed out). So at runtime, Ruff would first index all python files and store the filename and line number of any declaration, (class, function, etc). When Ruff encounters one of these objects, it would use the lookup table to find the declaration of that object, and proceed from there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> on 2023-06-05 21:12</div>
            <div class="timeline-body"><p>@wiwa5606 as it turns out it's actually not that straightforward.</p>
<p>Even if you had a way to reliably detect every import as a relative import (as opposed to one coming from the built-in modules, 3rd party libraries or a modified sys.path), you still have the problem of having multiple definitions of the thing in the same file, figuring out whether only one of them is reachable, sometimes multiple declarations can be under a <code>sys.version</code> check to support multiple python versions, the thing you're looking for could be nested inside another scope (like a class), ...</p>
<p>Building an import graph and finding the declaration for the said name or attribute are both really complex problems.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-05 21:17</div>
            <div class="timeline-body"><p>I hope to end up building support for all of those things, but it will admittedly take a lot of time and work. The core ideas are likely correct though: learn to resolve imports (including non-first party imports), do a pass over every file to build its symbol table, and lookup in the module symbol table as you analyze bindings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghost">@ghost</a> on 2023-06-05 22:05</div>
            <div class="timeline-body"><p>Right, 3rd party imports and sys.path manipulation. There's always another thing...</p>
<p>It almost sounds like Ruff needs its own interpreter to do that resolution, I don't know if that will be too slow though. I'm obviously lacking a solid understanding of how Ruff does what it does today, so I don't quite know the specifics. I'm more than willing to pitch in if that's something that is being considered.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:57:31 UTC
    </footer>
</body>
</html>
