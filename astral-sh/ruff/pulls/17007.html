<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] `reveal-type` should return the revaled type - astral-sh/ruff #17007</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] <code>reveal-type</code> should return the revaled type</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17007">#17007</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-03-27 02:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Return the revealed-type from the monkey-patched <code>revale_type</code> implementation to
preserve the identity behavior.</p>
<p>This PR also isolates different script runs by assigning a different <code>globals</code> dict for each script-run. See https://github.com/pyodide/pyodide/issues/703</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">playground</span> added by @MichaReiser on 2025-03-27 02:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @MichaReiser on 2025-03-27 02:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @Copilot by @MichaReiser on 2025-03-27 02:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/copilot-pull-request-reviewer[bot]">@copilot-pull-request-reviewer[bot]</a> reviewed on 2025-03-27 02:57</div>
            <div class="timeline-body"><h2>Pull Request Overview</h2>
<p>This PR enhances the Python script execution in the playground by patching the reveal_type behavior to return the revealed type and by isolating script runs with a separate globals dictionary. It also updates file path specifications in the workflow configuration to include all nested changes.</p>
<ul>
<li>Updated SecondaryPanel.tsx to capture the selected file name and apply a custom reveal_type function that prints the runtime value and returns its type.</li>
<li>Isolated the globals for each script-run and ensured proper destruction of proxy objects.</li>
<li>Modified the workflow file to use recursive path patterns for directory changes.</li>
</ul>
<h3>Reviewed Changes</h3>
<p>Copilot reviewed 2 out of 2 changed files in this pull request and generated 1 comment.</p>
<p>| File                                           | Description                                                                              |
| ---------------------------------------------- | ---------------------------------------------------------------------------------------- |
| playground/knot/src/Editor/SecondaryPanel.tsx  | Enhances the reveal_type patch and isolates globals for each Python script-run execution. |
| .github/workflows/publish-knot-playground.yml  | Adjusts file path patterns to include nested directories.                                |</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Copilot">@Copilot</a> on <code>playground/knot/src/Editor/SecondaryPanel.tsx</code>:166 on 2025-03-27 02:57</div>
            <div class="timeline-body"><p>The usage of backticks inside the f-string may lead to unintended formatting issues when the string is passed within a template literal. Consider using alternative quoting (for example, single quotes inside the f-string) to avoid potential syntax errors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-03-27 03:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-03-27 03:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-03-27 03:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:11:01 UTC
    </footer>
</body>
</html>
