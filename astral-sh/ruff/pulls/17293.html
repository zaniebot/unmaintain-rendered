<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`airflow`] Refactor `AIR301` logic and fix typos (`AIR301`) - astral-sh/ruff #17293</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>airflow</code>] Refactor <code>AIR301</code> logic and fix typos (<code>AIR301</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17293">#17293</a>
        opened by <a href="https://github.com/Lee-W">@Lee-W</a>
        on 2025-04-08 11:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-04-08 11:18</div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<!-- What's the purpose of the change? What does it do, and why? -->

<ul>
<li>Simplify match conditions in AIR301</li>
<li>Fix<ul>
<li><code>airflow.datasets.manager.DatasetManager</code> ‚Üí <code>airflow.assets.manager.AssetManager</code></li>
<li><code>airflow.www.auth.has_access_dataset</code> ‚Üí <code>airflow.www.auth.has_access_dataset</code></li>
</ul>
</li>
</ul>
<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>The test fixture has been updated accordingly</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-04-08 11:25</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚úÖ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+0 -19 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -19 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/amazon/src/airflow/providers/amazon/aws/links/base_aws.py#L41'>providers/amazon/src/airflow/providers/amazon/aws/links/base_aws.py:41:19:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/databricks/src/airflow/providers/databricks/operators/databricks.py#L251'>providers/databricks/src/airflow/providers/databricks/operators/databricks.py:251:28:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/databricks/src/airflow/providers/databricks/plugins/databricks_workflow.py#L238'>providers/databricks/src/airflow/providers/databricks/plugins/databricks_workflow.py:238:26:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/databricks/src/airflow/providers/databricks/plugins/databricks_workflow.py#L272'>providers/databricks/src/airflow/providers/databricks/plugins/databricks_workflow.py:272:38:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/databricks/src/airflow/providers/databricks/plugins/databricks_workflow.py#L366'>providers/databricks/src/airflow/providers/databricks/plugins/databricks_workflow.py:366:39:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/dbt/cloud/src/airflow/providers/dbt/cloud/operators/dbt.py#L50'>providers/dbt/cloud/src/airflow/providers/dbt/cloud/operators/dbt.py:50:34:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/cloud/links/base.py#L38'>providers/google/src/airflow/providers/google/cloud/links/base.py:38:22:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/cloud/links/datafusion.py#L44'>providers/google/src/airflow/providers/google/cloud/links/datafusion.py:44:22:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/cloud/links/dataproc.py#L136'>providers/google/src/airflow/providers/google/cloud/links/dataproc.py:136:24:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/cloud/links/dataproc.py#L83'>providers/google/src/airflow/providers/google/cloud/links/dataproc.py:83:20:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/cloud/operators/dataproc_metastore.py#L112'>providers/google/src/airflow/providers/google/cloud/operators/dataproc_metastore.py:112:37:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/cloud/operators/dataproc_metastore.py#L64'>providers/google/src/airflow/providers/google/cloud/operators/dataproc_metastore.py:64:29:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/google/src/airflow/providers/google/marketing_platform/links/analytics_admin.py#L39'>providers/google/src/airflow/providers/google/marketing_platform/links/analytics_admin.py:39:31:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/microsoft/azure/src/airflow/providers/microsoft/azure/operators/data_factory.py#L52'>providers/microsoft/azure/src/airflow/providers/microsoft/azure/operators/data_factory.py:52:53:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/microsoft/azure/src/airflow/providers/microsoft/azure/operators/powerbi.py#L42'>providers/microsoft/azure/src/airflow/providers/microsoft/azure/operators/powerbi.py:42:19:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/microsoft/azure/src/airflow/providers/microsoft/azure/operators/synapse.py#L133'>providers/microsoft/azure/src/airflow/providers/microsoft/azure/operators/synapse.py:133:35:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/standard/src/airflow/providers/standard/operators/trigger_dagrun.py#L71'>providers/standard/src/airflow/providers/standard/operators/trigger_dagrun.py:71:25:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/standard/src/airflow/providers/standard/sensors/external_task.py#L63'>providers/standard/src/airflow/providers/standard/sensors/external_task.py:63:23:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
- <a href='https://github.com/apache/airflow/blob/c874e8dbe61e376d2415c98ae9374db8a9621e5e/providers/yandex/src/airflow/providers/yandex/links/yq.py#L43'>providers/yandex/src/airflow/providers/yandex/links/yq.py:43:14:</a> AIR301 `airflow.models.baseoperatorlink.BaseOperatorLink` is removed in Airflow 3.0
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| AIR301 | 19 | 0 | 19 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Refactor air301" to "[Airflow] Refactor AIR301 logic and fix typos (AIR301)" by @Lee-W on 2025-04-08 13:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @Lee-W on 2025-04-08 13:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-04-08 13:32</div>
            <div class="timeline-body"><p>The TODOs are intentionally kept. They're things I think might be outdated but I'll need to confirm with the airflow community. Also, I would like to keep this PR simple</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @ntBre by @ntBre on 2025-04-08 18:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:78 on 2025-04-08 18:57</div>
            <div class="timeline-body"><p>These can't be combined because <code>name</code> has a different type in the two arms? I think that's right but just double-checking.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:822 on 2025-04-08 19:03</div>
            <div class="timeline-body"><p>Is the comment just above this outdated or are they both covered here now?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:850 on 2025-04-08 19:03</div>
            <div class="timeline-body"><p>Same here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-04-08 19:04</div>
            <div class="timeline-body"><p>Thanks! A couple of questions, but this looks good otherwise.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-04-09 01:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:78 on 2025-04-09 01:49</div>
            <div class="timeline-body"><p>Yep, just tired it a bit</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-04-09 01:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:822 on 2025-04-09 01:51</div>
            <div class="timeline-body"><p><code>airflow.providers.google</code> is a package installable from PyPI. Even though we only need to check airflow.providers.google.<code>datasets</code>, I think it might be better to keep comments this way to align airflow logic</p>
<pre><code class="language-rust">// airflow.providers.google
// airflow.providers.google.datasets
some logic
// airflow.providers.google.some_other_module
some other logic

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-04-09 01:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:850 on 2025-04-09 01:51</div>
            <div class="timeline-body"><p>Same as https://github.com/astral-sh/ruff/pull/17293#discussion_r2034312971</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-09 14:36</div>
            <div class="timeline-body"><p>Is this ready to merge?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-04-09 14:43</div>
            <div class="timeline-body"><blockquote>
<p>Is this ready to merge?</p>
</blockquote>
<p>Yep, this is ready üôÇ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-04-09 14:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[Airflow] Refactor AIR301 logic and fix typos (AIR301)" to "[`airflow`] Refactor `AIR301` logic and fix typos (`AIR301`)" by @ntBre on 2025-04-09 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @ntBre on 2025-04-09 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @ntBre on 2025-04-09 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @ntBre on 2025-04-09 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> removed by @ntBre on 2025-04-09 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> removed by @ntBre on 2025-04-09 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-04-09 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-04-09 14:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 19:41:06 UTC
    </footer>
</body>
</html>
