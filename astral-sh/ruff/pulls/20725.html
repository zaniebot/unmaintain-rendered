<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update default and latest Python versions for 3.14 - astral-sh/ruff #20725</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update default and latest Python versions for 3.14</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/20725">#20725</a>
        opened by <a href="https://github.com/ntBre">@ntBre</a>
        on 2025-10-06 16:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-06 16:31</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Closes #19467 and also removes the warning about using Python 3.14 without
preview enabled.</p>
<p>I also bumped <code>PythonVersion::default</code> to 3.9 because it reaches EOL this month,
but we could also defer that for now if we wanted.</p>
<p>The first three commits are related to the <code>latest</code> bump to 3.14; the fourth commit
bumps the default to 3.10.</p>
<p>Note that this PR also bumps the default Python version for ty to 3.10 because
there was a test asserting that it stays in sync with <code>ast::PythonVersion</code>.</p>
<h2>Test Plan</h2>
<p>Existing tests</p>
<p>I spot-checked the ecosystem report, and I believe these are all expected. Inbits doesn't specify a target Python version, so I guess we're applying the default. UP007, UP035, and UP045 all use the new default value to emit new diagnostics.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-06 16:33</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/d4f39b27a4a47aac8b6d4019e1b0b5b3156fabdc/conformance">typing conformance tests</a></h2>
<p>No changes detected when running ty on typing conformance tests ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @ntBre on 2025-10-06 16:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">python314</span> added by @ntBre on 2025-10-06 16:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-06 16:34</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<p>No ecosystem changes detected ✅
No memory usage changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-06 16:43</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+409 -0 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<details><summary><a href="https://github.com/lnbits/lnbits">lnbits/lnbits</a> (+409 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/app.py#L281'>lnbits/app.py:281:26:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/app.py#L9'>lnbits/app.py:9:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L158'>lnbits/commands.py:158:42:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L215'>lnbits/commands.py:215:11:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L216'>lnbits/commands.py:216:12:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L217'>lnbits/commands.py:217:13:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L218'>lnbits/commands.py:218:14:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L306'>lnbits/commands.py:306:43:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L357'>lnbits/commands.py:357:16:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L358'>lnbits/commands.py:358:21:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L359'>lnbits/commands.py:359:17:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L360'>lnbits/commands.py:360:18:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L361'>lnbits/commands.py:361:10:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L362'>lnbits/commands.py:362:17:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L447'>lnbits/commands.py:447:17:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L448'>lnbits/commands.py:448:18:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L449'>lnbits/commands.py:449:10:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L450'>lnbits/commands.py:450:17:</a> UP045 [*] Use `X | None` for type annotations
... 374 additional changes omitted for rule UP045
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/models/misc.py#L3'>lnbits/core/models/misc.py:3:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/tasks.py#L4'>lnbits/core/tasks.py:4:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/views/auth_api.py#L6'>lnbits/core/views/auth_api.py:6:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/views/generic.py#L164'>lnbits/core/views/generic.py:164:42:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/decorators.py#L140'>lnbits/decorators.py:140:36:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/decorators.py#L141'>lnbits/decorators.py:141:36:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/decorators.py#L142'>lnbits/decorators.py:142:36:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/lnurl.py#L2'>lnbits/lnurl.py:2:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/middleware.py#L65'>lnbits/middleware.py:65:10:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/tasks.py#L6'>lnbits/tasks.py:6:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/utils/crypto.py#L43'>lnbits/utils/crypto.py:43:29:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/utils/logger.py#L6'>lnbits/utils/logger.py:6:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/utils/nostr.py#L152'>lnbits/utils/nostr.py:152:22:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/wallets/nwc.py#L362'>lnbits/wallets/nwc.py:362:38:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/wallets/nwc.py#L516'>lnbits/wallets/nwc.py:516:49:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/tests/wallets/fixtures/models.py#L27'>tests/wallets/fixtures/models.py:27:15:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/tests/wallets/test_rest_wallets.py#L62'>tests/wallets/test_rest_wallets.py:62:29:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/tests/wallets/test_rest_wallets.py#L84'>tests/wallets/test_rest_wallets.py:84:22:</a> UP007 [*] Use `X | Y` for type annotations
... 373 additional changes omitted for project
</pre>

</p>
</details>
<details><summary>Changes by rule (3 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| UP045 | 390 | 390 | 0 | 0 | 0 |
| UP007 | 12 | 12 | 0 | 0 | 0 |
| UP035 | 7 | 7 | 0 | 0 | 0 |</p>
</p>
</details>

<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+409 -0 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<details><summary><a href="https://github.com/lnbits/lnbits">lnbits/lnbits</a> (+409 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/app.py#L281'>lnbits/app.py:281:26:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/app.py#L9'>lnbits/app.py:9:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L158'>lnbits/commands.py:158:42:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L215'>lnbits/commands.py:215:11:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L216'>lnbits/commands.py:216:12:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L217'>lnbits/commands.py:217:13:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L218'>lnbits/commands.py:218:14:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L306'>lnbits/commands.py:306:43:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L357'>lnbits/commands.py:357:16:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L358'>lnbits/commands.py:358:21:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L359'>lnbits/commands.py:359:17:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L360'>lnbits/commands.py:360:18:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L361'>lnbits/commands.py:361:10:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L362'>lnbits/commands.py:362:17:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L447'>lnbits/commands.py:447:17:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L448'>lnbits/commands.py:448:18:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L449'>lnbits/commands.py:449:10:</a> UP045 [*] Use `X | None` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/commands.py#L450'>lnbits/commands.py:450:17:</a> UP045 [*] Use `X | None` for type annotations
... 374 additional changes omitted for rule UP045
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/models/misc.py#L3'>lnbits/core/models/misc.py:3:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/tasks.py#L4'>lnbits/core/tasks.py:4:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/views/auth_api.py#L6'>lnbits/core/views/auth_api.py:6:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/core/views/generic.py#L164'>lnbits/core/views/generic.py:164:42:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/decorators.py#L140'>lnbits/decorators.py:140:36:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/decorators.py#L141'>lnbits/decorators.py:141:36:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/decorators.py#L142'>lnbits/decorators.py:142:36:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/lnurl.py#L2'>lnbits/lnurl.py:2:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/middleware.py#L65'>lnbits/middleware.py:65:10:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/tasks.py#L6'>lnbits/tasks.py:6:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/utils/crypto.py#L43'>lnbits/utils/crypto.py:43:29:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/utils/logger.py#L6'>lnbits/utils/logger.py:6:1:</a> UP035 [*] Import from `collections.abc` instead: `Callable`
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/utils/nostr.py#L152'>lnbits/utils/nostr.py:152:22:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/wallets/nwc.py#L362'>lnbits/wallets/nwc.py:362:38:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/lnbits/wallets/nwc.py#L516'>lnbits/wallets/nwc.py:516:49:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/tests/wallets/fixtures/models.py#L27'>tests/wallets/fixtures/models.py:27:15:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/tests/wallets/test_rest_wallets.py#L62'>tests/wallets/test_rest_wallets.py:62:29:</a> UP007 [*] Use `X | Y` for type annotations
+ <a href='https://github.com/lnbits/lnbits/blob/88b01e60795c488ae9fd8c2e634f3d218b901aaa/tests/wallets/test_rest_wallets.py#L84'>tests/wallets/test_rest_wallets.py:84:22:</a> UP007 [*] Use `X | Y` for type annotations
... 373 additional changes omitted for project
</pre>

</p>
</details>
<details><summary>Changes by rule (3 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| UP045 | 390 | 390 | 0 | 0 | 0 |
| UP007 | 12 | 12 | 0 | 0 | 0 |
| UP035 | 7 | 7 | 0 | 0 | 0 |</p>
</p>
</details>

<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2025-10-06 16:43</div>
            <div class="timeline-body"><!-- __CODSPEED_PERFORMANCE_REPORT_COMMENT__ -->

<h2><a href="https://codspeed.io/astral-sh/ruff/branches/brent%2F314">CodSpeed Performance Report</a></h2>
<h3>Merging #20725 will <strong>improve performances by 7.28%</strong></h3>
<p><sub>Comparing <code>brent/314</code> (e77312d) with <code>main</code> (8fb29ea)</sub></p>
<h3>Summary</h3>
<p><code>⚡ 2</code> improvements<br />
<code>✅ 49</code> untouched</p>
<h3>Benchmarks breakdown</h3>
<p>|     | Mode | Benchmark | <code>BASE</code> | <code>HEAD</code> | Change |
| --- | ---- | --------- | ------ | ------ | ------ |
| ⚡ | Instrumentation | <a href="https://codspeed.io/astral-sh/ruff/branches/brent%2F314?uri=crates%2Fruff_benchmark%2Fbenches%2Flinter.rs%3A%3Aall_rules%3A%3Abenchmark_all_rules%3A%3Alinter%2Fall-rules%5Bpydantic%2Ftypes.py%5D&amp;runnerMode=Instrumentation"><code>linter/all-rules[pydantic/types.py]</code></a> | 8.7 ms | 8.1 ms | +7.28% |
| ⚡ | Instrumentation | <a href="https://codspeed.io/astral-sh/ruff/branches/brent%2F314?uri=crates%2Fruff_benchmark%2Fbenches%2Flinter.rs%3A%3Apreview_rules%3A%3Abenchmark_preview_rules%3A%3Alinter%2Fall-with-preview-rules%5Bpydantic%2Ftypes.py%5D&amp;runnerMode=Instrumentation"><code>linter/all-with-preview-rules[pydantic/types.py]</code></a> | 10.3 ms | 9.7 ms | +6.15% |</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/snapshots/ruff_linter__rules__flake8_pyi__tests__PYI055_PYI055.py.snap</code>:9 on 2025-10-06 17:27</div>
            <div class="timeline-body"><p>I think these are correct. The check disabling these on earlier Python versions was added in https://github.com/astral-sh/ruff/pull/6457:</p>
<p>https://github.com/astral-sh/ruff/blob/70f51e964855da881c40f87d3eeebf93520042bf/crates/ruff_linter/src/rules/flake8_pyi/rules/unnecessary_type_union.rs#L64-L67</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-10-06 17:57</div>
            <div class="timeline-body"><p>I talked with @dylwil3 on Discord, and we think the removed diagnostics are related to pre-existing issues. He tested at least some of them and found that the diagnostics are also suppressed on earlier Python versions with <code>from __future__ import annotations</code>, so I'm planning to open a follow-up issue and not block the release, if that sounds good to everyone. The rules that look suspicious to me (and I'll include in the follow-up issue) are:</p>
<ul>
<li>FAST001</li>
<li>FAST003</li>
<li>A003</li>
<li>PTH210</li>
<li>RUF001</li>
</ul>
<p>In general, these look like cases where we no longer visit annotations because they aren't evaluated at runtime, but it seems like a worse result not to visit these annotations since it prevents us from emitting helpful diagnostics.</p>
<p>On the other side, the rules with changes that look correct to me are:</p>
<ul>
<li>PYI055</li>
<li>TC001-TC004</li>
<li>F821</li>
<li>UP037</li>
<li>UP006</li>
<li>UP007</li>
<li>UP036</li>
<li>RUF058</li>
</ul>
<p>Somewhere in between I'd put TC010. String union members are allowed on 3.14, but we probably still want to emit <em>some</em> diagnostic for <code>&quot;int&quot; | str</code>; this doesn't seem to <a href="https://play.ruff.rs/d397295d-b8c5-40b5-aca4-c3cad92c9474">trigger</a> any of the TC rules unless I'm missing some additional configuration.</p>
<p>One remaining question is whether it's better to accept these snapshots or pin them to 3.13. I think it's probably easier to pin for now and then remove the pins while addressing the follow-up issue, but I'm curious what others think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.14" by @ntBre on 2025-10-06 18:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dhruvmanila by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @dcreager removed by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @carljm removed by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @sharkdp removed by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @dhruvmanila removed by @ntBre on 2025-10-06 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/src/types/class.rs</code>:5482 on 2025-10-07 07:09</div>
            <div class="timeline-body"><p>Is the change here necessary? It seems to me like we would want to run this test on 3.15 preview soon?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> approved on 2025-10-07 07:13</div>
            <div class="timeline-body"><p>The ty changes look good to me, thank you!</p>
<p>@AlexWaygood Are there any interactions with typeshed here that we should worry about? Going to a higher default version should be fine, I think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-10-07 09:44</div>
            <div class="timeline-body"><blockquote>
<p>@AlexWaygood Are there any interactions with typeshed here that we should worry about? Going to a higher default version should be fine, I think?</p>
</blockquote>
<p>Yes, should be fine!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-10-07 09:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty/src/python_version.rs</code>:1 on 2025-10-07 09:51</div>
            <div class="timeline-body"><p>should we not add a <code>Py314</code> variant to the <code>PythonVersion</code> enum in this file? We should definitely let ty users specify <code>--python-version=3.14</code>!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty/src/python_version.rs</code>:12 on 2025-10-07 09:57</div>
            <div class="timeline-body"><p>We also need to update the default value in the ruff settings documentation <a href="https://github.com/astral-sh/ruff/blob/6b7a9dc2f29b2d8565c32c22189295049e3814a8/crates/ruff_workspace/src/options.rs#L330">here</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/fixtures.rs</code>:43 on 2025-10-07 09:58</div>
            <div class="timeline-body"><p>I think it makes sense to keep <code>latest_preview</code> and use it here as we, very intentionally, want to use the latest preview version for parser tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-07 10:14</div>
            <div class="timeline-body"><p>I agree that we shouldn't block the release if those are pre-existing issues, and creating follow-up issues sounds great. I do think that it's somewhat important to look into what's happening. From a quick investigation, it seems that</p>
<pre><code class="language-rust">return dbg!(semantic.resolve_name(response_mode_name_expr))
            == dbg!(semantic.resolve_name(return_value_name_expr));
</code></pre>
<p>now returns <code>false</code> because <code>resolve_name</code> for the return value returns None. I haven't investigated further. @dylwil3 is this something you could take a look at. Unless @ntBre want's to fix it before the release ;)</p>
<p>Regarding the tests. For tests that regress, I'd prefer to use <code>test_path_with_settings_diff</code> so that it clearly demonstrates the undesired difference. The bugfix PR should then remove all the diffs.</p>
<p>The stringified union example is a bit funny (but also pre-existing).</p>
<pre><code class="language-py">x: &quot;int&quot; | str
</code></pre>
<p>is reported by TC010 but the following isn't, because the rule isn't in a runtime context:</p>
<pre><code class="language-py">
from __future__ import annotations

x: &quot;int&quot; | str
</code></pre>
<p>I'd say this is also a pre-existing issue that doesn't need to block the 3.14 release</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-10-07 10:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-07 15:16</div>
            <div class="timeline-body"><p>Thanks all for the reviews!</p>
<p>I think I've addressed all the feedback and will draft the follow-up issue while CI runs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-10-07 16:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-10-07 16:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-10-07 16:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 17:35:00 UTC
    </footer>
</body>
</html>
