```yaml
number: 6478
title: Use crates.io unicode_names2 0.6.0
type: pull_request
state: merged
author: konstin
labels:
  - internal
assignees: []
merged: true
base: main
head: unicode_names2_0-6-0
created_at: 2023-08-10T12:53:11Z
updated_at: 2023-10-03T04:21:55Z
url: https://github.com/astral-sh/ruff/pull/6478
synced_at: 2026-01-12T15:55:21Z
```

# Use crates.io unicode_names2 0.6.0

---

_@konstin_

Update `unicode_names2` to the crates.io release 0.6.0, removing a git dependency.

@youknowone As far as i can tell, all changes from https://github.com/youknowone/unicode_names2 have been merged into https://github.com/progval/unicode_names2, is it correct that all changes needed for the RustPython parser are in the 0.6.0 release on crates.io?

---

_Label `internal` added by @konstin on 2023-08-10 12:53_

---

_Comment by @github-actions[bot] on 2023-08-10 13:06_

## PR Check Results
### Ecosystem
‚úÖ ecosystem check detected no changes.



---

_@charliermarsh approved on 2023-08-10 14:48_

Cool with this assuming it contains all the changes.

---

_Comment by @youknowone on 2023-08-12 05:27_

I wasn't following up this issue for a while.
As I understand, this patch is required to keep compatibility. https://github.com/progval/unicode_names2/pull/12
But let me look them in again for next a few weeks.
I was not able to working on open source projects for a while due to other stuff. it will takes a few more weeks.

---

_Comment by @charliermarsh on 2023-08-13 01:33_

Ah yeah, I think upstream is still missing some changes that we need.

---

_Comment by @konstin on 2023-08-21 18:04_

i think we need https://github.com/progval/unicode_names2/pull/12, but i don't understand how since none of our tests are failing without it. Upstream is maintained and has just published a 1.0.0, so i'm even more motivated to migrate

---

_Comment by @charliermarsh on 2023-08-21 18:06_

I think this shows a failing test case: https://github.com/RustPython/RustPython/issues/4566

---

_Comment by @charliermarsh on 2023-08-21 18:06_

Unless it no longer fails after switching to the main channel, of course.

---

_Comment by @konstin on 2023-08-21 20:43_

thanks for link! I added the test, it seems that this is already passing.

---

_Marked ready for review by @konstin on 2023-08-21 20:44_

---

_Comment by @charliermarsh on 2023-08-21 20:53_

As annoying as it is... I'd really love to understand why it works now (and didn't before) prior to merging. Does that snippet fail on 0.6.0 (non-Git, like before we pinned)?

---

_Comment by @konstin on 2023-08-21 20:58_

oh, i realized i actually updated only one of two unicode_names2 usages. I updated the other too, and now the test fails as expected.

---

_Converted to draft by @konstin on 2023-08-21 20:58_

---

_Comment by @manmartgarc on 2023-10-02 19:03_

Hey, just checking in on this. I was able to use a temporary `LibCST` crates on https://github.com/astral-sh/ruff/pull/7179. As far as I know `unicode_names2` is the only other git dependency left to vanquish. What is left to do to merge this change?

---

_Comment by @konstin on 2023-10-02 19:21_

I've checked and the relevant PR was merged in the mean time (https://github.com/progval/unicode_names2/pull/12). I've asked for a crates.io release: https://github.com/progval/unicode_names2/issues/28

---

_Comment by @charliermarsh on 2023-10-02 19:35_

Thanks @manmartgarc. By the way: I temporarily moved LibCST back to a Git dependency so that we could get out Python 3.12 support today, but I'll move it back to crates as soon as they publish a new version.

---

_Comment by @konstin on 2023-10-02 21:19_

Current dependencies on/for this PR:
* main
  * **PR #6478** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6478" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a>  üëà

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/6478?utm_source=stack-comment).

---

_Marked ready for review by @konstin on 2023-10-02 21:19_

---

_Comment by @konstin on 2023-10-02 21:19_

The maintainer reacted really quickly, this is now ready to be merged

---

_@konstin reviewed on 2023-10-02 21:20_

---

_Review comment by @konstin on `Cargo.toml`:28 on 2023-10-02 21:20_

Made this consistent while i was at it


---

_@charliermarsh approved on 2023-10-02 21:22_

Great!

---

_Comment by @codspeed-hq[bot] on 2023-10-02 21:36_

## [CodSpeed Performance Report](https://codspeed.io/astral-sh/ruff/branches/unicode_names2_0-6-0)

### Merging #6478 will **degrade performances by 3.69%**

<sub>Comparing <code>unicode_names2_0-6-0</code> (7ab46fc) with <code>main</code> (c6d0bdd)</sub>



### Summary

`‚ùå 1 (üëÅ 1)` regressions
`‚úÖ 24` untouched benchmarks




### Benchmarks breakdown

|     | Benchmark | `main` | `unicode_names2_0-6-0` | Change |
| --- | --------- | ----------------------- | ------------------- | ------ |
| üëÅ | `linter/default-rules[large/dataset.py]` | 92.5 ms | 96 ms | -3.69% |


---

_Merged by @charliermarsh on 2023-10-02 22:17_

---

_Closed by @charliermarsh on 2023-10-02 22:17_

---

_Branch deleted on 2023-10-02 22:17_

---

_Comment by @youknowone on 2023-10-03 04:21_

üëç 

---
