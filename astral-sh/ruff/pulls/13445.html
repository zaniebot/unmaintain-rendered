<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test cases failing with regex changes for S608 - astral-sh/ruff #13445</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Test cases failing with regex changes for S608</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/13445">#13445</a>
        opened by <a href="https://github.com/DataEnggNerd">@DataEnggNerd</a>
        on 2024-09-22 03:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/DataEnggNerd">@DataEnggNerd</a></div>
            <div class="timeline-body"><p>@MichaReiser</p>
<p>I have made the changes as suggested in <a href="https://github.com/astral-sh/ruff/issues/12044">astral-sh/ruff#12044</a>#issuecomment-2357678761.</p>
<p>But this regex is failing for 7 test cases out of 58 in https://github.com/astral-sh/ruff/blob/9259cf91d8dd042f45147fa1be97662833c91919/crates/ruff_linter/resources/test/fixtures/flake8_bandit/S608.py
(For additional test cases, refer - https://github.com/astral-sh/ruff/blob/257359165f845adc1a2bd41aeabfe6d56fbee420/crates/ruff_linter/resources/test/fixtures/flake8_bandit/S608.py#L117 )</p>
<p>I have implemented the regex from bandit as well. Commit - https://github.com/astral-sh/ruff/commit/9259cf91d8dd042f45147fa1be97662833c91919, which is failing for 3 test cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-23 08:26</div>
            <div class="timeline-body"><p>I looked into this more and the reason why the multiline f-strings aren&#x27;t picked up are because of <code>concatenated_f_string</code> that escapes special characters like <code>\n</code>.</p>
<p>https://github.com/astral-sh/ruff/blob/257359165f845adc1a2bd41aeabfe6d56fbee420/crates/ruff_linter/src/rules/flake8_bandit/rules/hardcoded_sql_expression.rs#L124-L129</p>
<p>It&#x27;s not entirely clear to me why @dhruvmanila added the <code>escape_default</code> call but I&#x27;m  sure there&#x27;s a reason. I want to wait for his reply before changing the behavior. However, he&#x27;s off this week, so his reply might be a bit delayed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DataEnggNerd">@DataEnggNerd</a> on 2024-09-23 17:29</div>
            <div class="timeline-body"><p>Meanwhile I will try playing with these configs. Thanks @MichaReiser</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-09-30 10:59</div>
            <div class="timeline-body"><blockquote>
<p>It&#x27;s not entirely clear to me why @dhruvmanila added the <code>escape_default</code> call but I&#x27;m sure there&#x27;s a reason.</p>
</blockquote>
<p>Looking back I&#x27;m not exactly sure why I added this but I suspect that it was to make sure the regex matched multiline strings. I should&#x27;ve updated the regex instead back then to avoid this bug from ever occurring. I would remove it and update the regex and run the tests. Sorry for the churn @DataEnggNerd.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DataEnggNerd">@DataEnggNerd</a> on 2024-09-30 17:07</div>
            <div class="timeline-body"><p>@dhruvmanila @MichaReiser All checks passed while removing <code>concatenated_f_string</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/DataEnggNerd">@DataEnggNerd</a> on 2024-09-30 17:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/DataEnggNerd">@DataEnggNerd</a> on 2024-09-30 17:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-30 17:50</div>
            <div class="timeline-body"><p>What&#x27;s the reason for closing this pr? It sounded like everything working</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DataEnggNerd">@DataEnggNerd</a> on 2024-09-30 17:59</div>
            <div class="timeline-body"><p>CI was failing as I have not updated the snapshot. working on it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:06:54 UTC
    </footer>
</body>
</html>
