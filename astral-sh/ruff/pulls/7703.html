<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feat(rules): implement `flake8-bandit` `S505` - astral-sh/ruff #7703</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>feat(rules): implement <code>flake8-bandit</code> <code>S505</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/7703">#7703</a>
        opened by <a href="https://github.com/mkniewallner">@mkniewallner</a>
        on 2023-09-28 21:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mkniewallner">@mkniewallner</a></div>
            <div class="timeline-body"><p>Part of #1646.</p>
<h2>Summary</h2>
<p>Implement <code>S505</code> (<a href="https://bandit.readthedocs.io/en/latest/plugins/b505_weak_cryptographic_key.html"><code>weak_cryptographic_key</code></a>) rule from <code>bandit</code>.</p>
<p>For this rule, <code>bandit</code> <a href="https://github.com/PyCQA/bandit/blob/1.7.5/bandit/plugins/weak_cryptographic_key.py#L47-L56">reports the issue with</a>:</p>
<ul>
<li>medium severity for DSA/RSA &lt; 2048 bits and EC &lt; 224 bits</li>
<li>high severity for DSA/RSA &lt; 1024 bits and EC &lt; 160 bits</li>
</ul>
<p>Since Ruff does not handle severities for <code>bandit</code>-related rules, we could either report the issue if we have lower values than medium severity, or lower values than high one. Two reasons led me to choose the first option:</p>
<ul>
<li>a medium severity issue is still a security issue we would want to report to the user, who can then decide to either handle the issue or ignore it</li>
<li><code>bandit</code> <a href="https://github.com/PyCQA/bandit/blob/1.7.5/bandit/plugins/weak_cryptographic_key.py#L112-L133">maps the EC key algorithms to their respective key lengths in bits</a>, but there is no value below 160 bits, so technically <code>bandit</code> would never report medium severity issues for EC keys, only high ones</li>
</ul>
<p>Another consideration is that as shared just above, for EC key algorithms, <code>bandit</code> has a mapping to map the algorithms to their respective key lengths. In the implementation in Ruff, I rather went with an explicit list of EC algorithms known to be vulnerable (which would thus be reported) rather than implementing a mapping to retrieve the associated key length and comparing it with the minimum value.</p>
<h2>Test Plan</h2>
<p>Snapshot tests from https://github.com/PyCQA/bandit/blob/1.7.5/examples/weak_cryptographic_key_sizes.py.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-09-28 21:34</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Ecosystem</h3>
<p>✅ ecosystem check detected no changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @mkniewallner on 2023-09-28 21:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2023-09-28 23:21</div>
            <div class="timeline-body"><h2><a href="https://codspeed.io/astral-sh/ruff/branches/mkniewallner:feat/add-flake8-bandit-S505">CodSpeed Performance Report</a></h2>
<h3>Merging #7703 will <strong>not alter performance</strong></h3>
<p><sub>Comparing <code>mkniewallner:feat/add-flake8-bandit-S505</code> (e2e94f7) with <code>main</code> (c2a9cf8)</sub></p>
<h3>Summary</h3>
<p><code>✅ 25</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2023-09-28 23:21</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-28 23:23</div>
            <div class="timeline-body"><blockquote>
<p>Two reasons led me to choose the first option...</p>
</blockquote>
<p>FWIW I agree with this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-09-29 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-09-29 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-09-29 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-09-29 06:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:00:36 UTC
    </footer>
</body>
</html>
