<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Move pycodestyle rules into individual files - astral-sh/ruff #2123</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Move pycodestyle rules into individual files</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/2123">#2123</a>
        opened by <a href="https://github.com/ericroberts">@ericroberts</a>
        on 2023-01-24 12:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a></div>
            <div class="timeline-body"><p>As discussed in <a href="https://github.com/charliermarsh/ruff/pull/2038">charliermarsh/ruff#2038</a> the project is moving to a model where every rule gets its own file.</p>
<p>I did not put the violations with the rules yet, it&#x27;s already a large changeset, figured I could follow up with that in another PR. But let me know if you would like me to add it to this instead.</p>
<p>There&#x27;s one function in <code>/src/rules/pycodestyle/rules/mod.rs</code> called <code>compare</code> that gets used by multiple rules. I&#x27;m not sure if this is where it should live or if there&#x27;s a standard practice for these utility or helper functions. Would appreciate some guidance on that!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-24 12:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 12:40</div>
            <div class="timeline-body"><p>This is small enough that I&#x27;d be fine inlining it at each call site. I think it used to be &quot;longer&quot;.</p>
<p>Alternatively, you could put this in a <code>helpers.rs</code> file in <code>pycodestyle</code>. Totally up to you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-24 12:40</div>
            <div class="timeline-body"><p>Looks great! Thank you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a> reviewed on 2023-01-24 12:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ericroberts">@ericroberts</a> on <code>src/rules/pycodestyle/rules/ambiguous_names.rs</code>:49 on 2023-01-24 12:45</div>
            <div class="timeline-body"><p>I also meant to mention this, I put three different rules here but they are almost exactly the same and use the same helper method. I wasn&#x27;t sure if you wanted to stick to one rule per file or if this is ok @charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a> reviewed on 2023-01-24 12:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ericroberts">@ericroberts</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 12:49</div>
            <div class="timeline-body"><p>OK, I put the function in each rule file that uses it (two of them)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-24 12:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/rules/pycodestyle/rules/ambiguous_names.rs</code>:49 on 2023-01-24 12:59</div>
            <div class="timeline-body"><p>I think it&#x27;d be <em>slightly</em> preferable to split this into three files and reference a shared helper in <code>pycodestyle/helpers.rs</code>, if you don&#x27;t mind?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a> reviewed on 2023-01-24 13:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ericroberts">@ericroberts</a> on <code>src/rules/pycodestyle/rules/ambiguous_names.rs</code>:49 on 2023-01-24 13:06</div>
            <div class="timeline-body"><p>Can do!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-24 13:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/rules/pycodestyle/rules/ambiguous_names.rs</code>:49 on 2023-01-24 13:09</div>
            <div class="timeline-body"><p>The reason being that we may start using the top-level rustdoc at the top of the violation file to automatically generate documentation about the rule (e.g., what does it do, why is it recommended, etc.) -- so having each rule in its own file has benefits unrelated to the code structure itself :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a> reviewed on 2023-01-24 13:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ericroberts">@ericroberts</a> on <code>src/rules/pycodestyle/rules/ambiguous_names.rs</code>:49 on 2023-01-24 13:54</div>
            <div class="timeline-body"><p>Yup totally makes sense. I&#x27;ve made that change!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-24 14:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 14:21</div>
            <div class="timeline-body"><blockquote>
<p>This is small enough that I&#x27;d be fine inlining it at each call site.</p>
</blockquote>
<p>Just a note that Rust supports <code>#[inline]</code> for inlining functions ... personally I&#x27;d prefer us to not duplicate code in general even if it is just 10 lines.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-24 14:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-24 14:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-24 14:27</div>
            <div class="timeline-body"><p>Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-01-24 14:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a> reviewed on 2023-01-24 14:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ericroberts">@ericroberts</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 14:37</div>
            <div class="timeline-body"><p>I looked up #[inline] but I&#x27;m not sure I understand how to use it right away (very new to Rust). Perhaps I misunderstood the original request. I will look into it some more, or if you have an example of how to do it in this case I&#x27;d really appreciate it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-24 14:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 14:42</div>
            <div class="timeline-body"><p><code>#[inline]</code> is a hint to the compiler that it should inline the function wherever it&#x27;s used. It&#x27;s typically not needed, since the compiler is pretty good at figuring out where that&#x27;s a helpful behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-24 14:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 14:43</div>
            <div class="timeline-body"><p>My suggestion to inline the code was more of a WET vs. DRY thing :) But I don&#x27;t feel strongly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-24 14:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 14:44</div>
            <div class="timeline-body"><p>No worries. The term &quot;inlining&quot; is somewhat ambiguous ... I don&#x27;t think Charlie meant inlining as in avoiding a function call. <code>#[inline]</code> can be added  for performance when a function is called very often, see <a href="https://nnethercote.github.io/perf-book/inlining.html">Inlining</a> ... but this is not something we probably actually want here ... I just wanted to mention it.^^</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ericroberts">@ericroberts</a> on <code>src/rules/pycodestyle/rules/mod.rs</code>:6 on 2023-01-24 15:02</div>
            <div class="timeline-body"><p>well since I did end up adding a helpers file for a different change, I could move compare to that file. That seems reasonable to me, I can open another PR for that</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericroberts">@ericroberts</a> reviewed on 2023-01-24 15:02</div>
            <div class="timeline-body"></div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:51:57 UTC
    </footer>
</body>
</html>
