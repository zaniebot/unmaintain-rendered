<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Only run jobs if relevant files changed - astral-sh/ruff #5908</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Only run jobs if relevant files changed</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/5908">#5908</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2023-07-20 07:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">

Summary
<p>Only run the benchmark, ecosystem, and formatter stability checks when relevant files changed:</p>
<ul>
<li>ecosystem: Any rust code, excluding the formatter and dev tools</li>
<li>formatter stability: Any change to <code>ruff_python_formatter</code>, <code>ruff_formatter</code>, <code>ruff_python_ast</code> or <code>ruff_python_trivia</code> or the dependencies</li>
<li>benchmark: Any rust code change, excluding dev tools</li>
</ul>


Test Plan
<ul>
<li><a href="https://github.com/astral-sh/ruff/actions/runs/5609118168?pr=5908">No code changes</a><ul>
<li>skips formatter stability check</li>
<li>Benchmark didn&#x27;t trigger (I can&#x27;t link a non existing job :sweat_smile: )</li>
<li>skips ecosystem check</li>
</ul>
</li>
<li><a href="https://github.com/astral-sh/ruff/actions/runs/5609443499?pr=5908">Linter changes</a><ul>
<li>skips formatter stability check</li>
<li>runs <a href="https://github.com/astral-sh/ruff/actions/runs/5609443502/jobs/10263167796?pr=5908">Benchmark</a></li>
<li>runs ecosystem check</li>
</ul>
</li>
<li><a href="https://github.com/astral-sh/ruff/actions/runs/5609289445?pr=5908">Formatter change</a><ul>
<li>runs formatter stability check</li>
<li>runs <a href="https://github.com/astral-sh/ruff/actions/runs/5609289411?pr=5908">Benchmark</a></li>
<li>skips ecosystem check</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-20 07:53</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #5908</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/5908"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a>  ðŸ‘ˆ</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/5908?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-20 07:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/workflows/benchmark.yaml</code>:11 on 2023-07-20 07:54</div>
            <div class="timeline-body"><p>This is where it would be useful to have all internal tools in a single (xtask, dev) directory</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-20 07:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-20 08:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/workflows/ci.yaml</code>:164 on 2023-07-20 08:05</div>
            <div class="timeline-body"><p>This is silly but GitHub doesn&#x27;t support early returns. The <em>proposed</em> alternative is to have another job but that feels bad in its own way because it pollutes the checks panel with even more output</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-07-20 08:10</div>
            <div class="timeline-body">PR Check Results
Ecosystem
<p>âœ… ecosystem check detected no changes.</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>.github/workflows/ci.yaml</code>:158 on 2023-07-20 08:54</div>
            <div class="timeline-body"><p>Would a single job that determines if {linter, formatted} changed and triggers downstream accordingly be possible? It would mean an extra job, but we would need only one guard per job and the checks list would show what actually ran</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2023-07-20 08:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-20 09:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/workflows/ci.yaml</code>:158 on 2023-07-20 09:00</div>
            <div class="timeline-body"><p>I guess that would be nice... argh, I have to re-do all tests</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-07-20 09:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>.github/workflows/ci.yaml</code>:158 on 2023-07-20 09:04</div>
            <div class="timeline-body"><p>Could we do graphite PRs for the different parts on top? I volunteer #5898 as a dev tools PR ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/workflows/ci.yaml</code>:158 on 2023-07-20 09:13</div>
            <div class="timeline-body"><p>How do you mean? I now changed it to a job. But I have to re-do all my testing... which gets funny because I now can&#x27;t link to jobs that didn&#x27;t run</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-20 09:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-20 09:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-07-20 09:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>.github/workflows/ci.yaml</code>:158 on 2023-07-20 09:57</div>
            <div class="timeline-body"><p>Add PRs on top of this PR that change formatter/linter/dev tools. Graphite can rebase them and you can look at their CI runs</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-20 09:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/workflows/ci.yaml</code>:158 on 2023-07-20 09:59</div>
            <div class="timeline-body"><p>Oh, that would have been clever. Next time</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-20 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-20 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-07-20 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jackton1">@jackton1</a> on <code>.github/workflows/ci.yaml</code>:33 on 2023-07-20 13:22</div>
            <div class="timeline-body"><p>Hi @MichaReiser, ðŸ™Œ author of <a href="https://github.com/tj-actions/changed-files">tj-actions/changed-files</a> here. I just came across your workflow and couldn&#x27;t help but notice a neat little tweak you could make. We&#x27;ve recently introduced a new <code>files_yaml</code> input which supports multiple filters in a single step, while still achieving the same results.</p>
<p>I think you might find it pretty handy! For more details, feel free to have a look at our <a href="https://github.com/tj-actions/changed-files#using-local-git-history">documentation</a>.</p>
<p>Should you have any questions or need further assistance, please don&#x27;t hesitate to ask. Have a fantastic rest of your day!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jackton1">@jackton1</a> reviewed on 2023-07-20 13:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/workflows/ci.yaml</code>:33 on 2023-07-20 14:45</div>
            <div class="timeline-body"><p>Oh wow, this is first-class user support &lt;3</p>
<p>This is cool. Let me create a quick PR for it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-20 14:45</div>
            <div class="timeline-body"></div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:55:30 UTC
    </footer>
</body>
</html>
