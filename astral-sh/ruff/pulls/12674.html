<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expose `unfixable` as an LSP setting - astral-sh/ruff #12674</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Expose <code>unfixable</code> as an LSP setting</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12674">#12674</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-08-05 02:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body">Summary
<p>It&#x27;s common for users to want to disable <code>F401</code> fixes in the editor. Otherwise, imports you just added get removed on-save. I think we should add this as a first-class editor setting.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-05 02:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-05 02:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-05 02:51</div>
            <div class="timeline-body"><p>@dhruvmanila -- I feel like, ideally, the Quick Fix actions would still be available here. What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-08-05 03:04</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-05 03:07</div>
            <div class="timeline-body"><blockquote>
<p>I feel like, ideally, the Quick Fix actions would still be available here. What do you think?</p>
</blockquote>
<p>Yeah, I think that&#x27;s correct but we need to make sure that it&#x27;s only available as a <em>Quick Fix</em> actions and not <em>Source</em> code actions. So, the <code>source.fixAll.ruff</code> action shouldn&#x27;t fix this. I can take that up as a follow-up if you want.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>docs/editors/settings.md</code>:500 on 2024-08-05 03:09</div>
            <div class="timeline-body"><p>I think you meant to add a new <code>unfixable</code> section, right? It seems like this is replacing the <code>extendIgnore</code> section.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-08-05 03:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/editors/settings.md</code>:500 on 2024-08-05 03:16</div>
            <div class="timeline-body"><p>It was intentional to remove though unrelated to the PR. Is extendIgnore supported? I couldn’t find any reference to it in the server crate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-05 03:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-08-05 03:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>docs/editors/settings.md</code>:500 on 2024-08-05 03:21</div>
            <div class="timeline-body"><p>Oh, that&#x27;s correct. Not sure why I thought there&#x27;s a <code>extendIgnore</code> when I wrote the docs. Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-08-05 03:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-05 13:01</div>
            <div class="timeline-body"><p>@dhruvmanila - Do you think that should apply <em>always</em> for <code>--unfixable</code>, or only when it&#x27;s set through the editor like this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-05 13:42</div>
            <div class="timeline-body"><blockquote>
<p>@dhruvmanila - Do you think that should apply <em>always</em> for <code>--unfixable</code>, or only when it&#x27;s set through the editor like this?</p>
</blockquote>
<p>By <code>--unfixable</code>, do you mean whether, in the CLI, we should display the fixes but not apply them?</p>
<p>This actually reminds me of <code>eslint.codeActionsOnSave.rules</code> which is provided by the Eslint VS Code extension and is a list of rules that should be fixed on save which is similar to <code>fixable</code> option.</p>
<p>It seems that the ES Lint extension doesn&#x27;t apply the code actions if it&#x27;s negated in the above list but it still shows the diagnostics and provides code actions to fix it manually. This manual application also includes the &quot;Fix all&quot; code action. So, it&#x27;s only the code actions on save where it&#x27;s excluded.</p>
<p>I think this is an ideal behavior from an editor perspective and the &quot;manual&quot; / &quot;automatic&quot; invocation of code actions can be known by the server as it&#x27;s encoded in the request payload.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-05 13:53</div>
            <div class="timeline-body"><p>Yeah, I think we want something like <code>codeActionsOnSave</code> but for rules. So maybe what I have in this PR isn&#x27;t correct.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-05 14:37</div>
            <div class="timeline-body"><p>I guess that&#x27;s right, we cannot use the existing <code>fixable</code> / <code>unfixable</code> option without affecting the CLI. We&#x27;d want an server (and editor) specific setting and perform the filter at the server level instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-06 02:28</div>
            <div class="timeline-body"><p>Yeah, sounds right to me. So we&#x27;d need both a setting in <code>ruff-server</code> and then in the VS Code extension to connect it together. I can just close this then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-06 02:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-06 06:08</div>
            <div class="timeline-body"><p>Opened <a href="https://github.com/astral-sh/ruff/issues/12709">astral-sh/ruff#12709</a> to keep track of this.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:05:43 UTC
    </footer>
</body>
</html>
