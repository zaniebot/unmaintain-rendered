```yaml
number: 19172
title: Update Rust crate unicode_names2 to v2
type: pull_request
state: open
author: renovate
labels:
  - internal
assignees: []
base: main
head: renovate/unicode_names2-2.x
created_at: 2025-07-07T03:28:00Z
updated_at: 2026-01-12T08:07:47Z
url: https://github.com/astral-sh/ruff/pull/19172
synced_at: 2026-01-12T08:52:59Z
```

# Update Rust crate unicode_names2 to v2

---

_Pull request opened by @renovate on 2025-07-07 03:28_

This PR contains the following updates:

| Package | Type | Update | Change |
|---|---|---|---|
| [unicode_names2](https://redirect.github.com/progval/unicode_names2) | workspace.dependencies | major | `1.2.2` â†’ `2.0.0` |

---

### Release Notes

<details>
<summary>progval/unicode_names2 (unicode_names2)</summary>

### [`v2.0.0`](https://redirect.github.com/progval/unicode_names2/blob/HEAD/CHANGELOG.md#v200)

[Compare Source](https://redirect.github.com/progval/unicode_names2/compare/v1.3.0...v2.0.0)

*2025-06-19*

Breaking:

- In order to implement [UAX#44](https://www.unicode.org/reports/tr44/tr44-34.html#Matching_Names)
  (see below) we had to change code generated by `unicode_names2_generator` in a way that
  was not compatible with `unicode_names2` v1.3.0 (and vice-versa), forcing us to bump
  `unicode_names2_generator` to v2.0.0. In order to keep them in sync, `unicode_names2`
  is bumped accordingly.
  Additionally, implementing [UAX#44](https://redirect.github.com/UAX/unicode_names2/issues/44) might break code if it relies on this crate for some
  sort of validation.

Feature:

- Implement [UAX#44](https://www.unicode.org/reports/tr44/tr44-34.html#Matching_Names)
  to make name matching less strict. ([#&#8203;46](https://redirect.github.com/progval/unicode_names2/pull/46))

Internal:

- Remove unused dependencies ([#&#8203;42](https://redirect.github.com/progval/unicode_names2/pull/42))

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "before 4am on Monday" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR was generated by [Mend Renovate](https://mend.io/renovate/). View the [repository job log](https://developer.mend.io/github/astral-sh/ruff).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiI0MS4xNy4yIiwidXBkYXRlZEluVmVyIjoiNDIuNjYuMTQiLCJ0YXJnZXRCcmFuY2giOiJtYWluIiwibGFiZWxzIjpbImludGVybmFsIl19-->


---

_Label `internal` added by @renovate[bot] on 2025-07-07 03:28_

---

_Comment by @github-actions[bot] on 2025-07-07 03:32_


<!-- generated-comment mypy_primer -->


## `mypy_primer` results


<details>
<summary>Changes were detected when running on open source projects</summary>

```diff
websockets (https://github.com/aaugustin/websockets)
+ src/websockets/cli.py:25:13: error[invalid-syntax] Got unexpected unicode
+ src/websockets/cli.py:31:22: error[invalid-syntax] Got unexpected unicode
+ src/websockets/cli.py:43:13: error[invalid-syntax] Got unexpected unicode
+ src/websockets/cli.py:47:22: error[invalid-syntax] Got unexpected unicode
- Found 34 diagnostics
+ Found 38 diagnostics

jinja (https://github.com/pallets/jinja)
+ tests/test_regression.py:763:47: error[invalid-syntax] Got unexpected unicode
- Found 180 diagnostics
+ Found 181 diagnostics

pydantic (https://github.com/pydantic/pydantic)
- pydantic/fields.py:943:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:943:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:983:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:983:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:1026:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:1026:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:1066:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:1066:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:1109:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:1109:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:1148:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:1148:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:1188:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`
+ pydantic/fields.py:1188:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`
- pydantic/fields.py:1567:13: error[invalid-argument-type] Argument is incorrect: Expected `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) | None`, found `Top[dict[Unknown, Unknown]] | (((dict[str, int | float | str | ... omitted 3 union elements], /) -> None) & ~Top[dict[Unknown, Unknown]]) | None`
+ pydantic/fields.py:1567:13: error[invalid-argument-type] Argument is incorrect: Expected `dict[str, Divergent] | ((dict[str, Divergent], /) -> None) | None`, found `Top[dict[Unknown, Unknown]] | (((dict[str, Divergent], /) -> None) & ~Top[dict[Unknown, Unknown]]) | None`

Tanjun (https://github.com/FasterSpeeding/Tanjun)
- tanjun/dependencies/data.py:347:12: error[invalid-return-type] Return type does not match returned value: expected `_T@cached_inject`, found `Coroutine[Any, Any, _T@cached_inject | Coroutine[Any, Any, _T@cached_inject]] | _T@cached_inject`
+ tanjun/dependencies/data.py:347:12: error[invalid-return-type] Return type does not match returned value: expected `_T@cached_inject`, found `_T@cached_inject | Coroutine[Any, Any, _T@cached_inject | Coroutine[Any, Any, _T@cached_inject]]`

scikit-build-core (https://github.com/scikit-build/scikit-build-core)
+ src/scikit_build_core/build/wheel.py:99:20: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 47 diagnostics
+ Found 48 diagnostics

static-frame (https://github.com/static-frame/static-frame)
+ static_frame/core/series.py:772:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemILocReduces[Series[Any, Any], TVDtype@Series]`, found `InterGetItemILocReduces[Series[Any, Any] | ndarray[Never, Never] | TypeBlocks | ... omitted 6 union elements, TVDtype@Series]`
- Found 1826 diagnostics
+ Found 1827 diagnostics

pandas-stubs (https://github.com/pandas-dev/pandas-stubs)
- pandas-stubs/_typing.pyi:1232:16: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- Found 5170 diagnostics
+ Found 5169 diagnostics

core (https://github.com/home-assistant/core)
- homeassistant/util/variance.py:47:12: error[invalid-return-type] Return type does not match returned value: expected `(**_P@ignore_variance) -> _R@ignore_variance`, found `_Wrapped[_P@ignore_variance, _R@ignore_variance | int | float | datetime, _P@ignore_variance, _R@ignore_variance | int | float | datetime]`
- Found 14504 diagnostics
+ Found 14503 diagnostics


```

</details>


No memory usage changes detected âœ…



---

_Comment by @MichaReiser on 2025-07-07 08:27_

@ntBre would you mind taking a look at this and decide if the changes are expected and are okay to be shipped as part of a minor?

---

_Assigned to @ntBre by @MichaReiser on 2025-07-07 08:27_

---

_Comment by @ntBre on 2025-07-08 17:54_

It sounds like this wasn't supposed to be a breaking change according to https://github.com/progval/unicode_names2/issues/44:

> This would be very useful and shouldn't constitute a breaking change (any name accepted today will still be accepted by the more loose matching rule.

I think it was only marked breaking because of an incompatibility with the (internal?) `unicode_names2_generator` crate (https://github.com/progval/unicode_names2/pull/46#issuecomment-2988876297).

But based on our tests failing, there might be a bug in the new normalization. I created a simple test project:

```rust
fn main() {
    println!("{:?}", unicode_names2::character("CHARACTER TABULATION WITH JUSTIFICATION"));
}
```

This yields `Some('\u{89}')` on 1.3.0 and `None` on 2.0.0 and corresponds to our failing `test_character_tabulation_with_justification_alias` test. This works in Python:

```pycon
>>> "\N{CHARACTER TABULATION WITH JUSTIFICATION}"
'\x89'
```

So I don't think we can merge this in its current state. Should I open an issue upstream?

Our similar tests for `CARRIAGE RETURN` and `FORM FEED` are also failing. I think the FURB157 failure is related to these.

I also checked RustPython since one of their maintainers was pinged on the issue, but they haven't tried to update to 2.0.0 yet, as far as I could tell from a PR search.

---

_Comment by @MichaReiser on 2025-07-09 06:06_

>   Additionally, implementing UAX#44 might break code if it relies on this crate for some sort of validation.

It's a bit hard to spot but this is also a functional breaking change.

> So I don't think we can merge this in its current state. Should I open an issue upstream?


It might be worth it. I only did a quick scan over what UAX44 is and it sounds like it should now accept more names and not less. We should verify if Python has UAX44 enabled (because we can't merge this if it doesn't). 

---

_Comment by @ntBre on 2025-07-09 15:59_

Hmm, it seems that CPython 3.13 (and 3.14b3) isn't fully compliant, at least with this basic test from [Section LM2](https://www.unicode.org/reports/tr44/#UAX44-LM2):

> Ignore case, whitespace, underscore ('_'), and all medial hyphens except the hyphen in U+1180 HANGUL JUNGSEONG O-E.
>  - "zero-width space" is equivalent to "ZERO WIDTH SPACE" or "zerowidthspace"

```pycon
>>> "\N{ZERO WIDTH SPACE}"
'\u200b'
>>> "\N{zero-width space}"
  File "<python-input-1>", line 1
    "\N{zero-width space}"
    ^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: (unicode error) 'unicodeescape' codec can't decode bytes in position 0-19: unknown Unicode character name
>>> "\N{zerowidthspace}"
  File "<python-input-2>", line 1
    "\N{zerowidthspace}"
    ^^^^^^^^^^^^^^^^^^^^
SyntaxError: (unicode error) 'unicodeescape' codec can't decode bytes in position 0-17: unknown Unicode character name
>>> "\N{zero width space}"
'\u200b'
```

So maybe we can't merge this anyway.

More directly, this is a test case in unicode_names2:

```rust
assert_eq!(character("FULL S-T-O-P"), Some('.'));
```

```pycon
>>> "\N{FULL S-T-O-P}"
  File "<python-input-1>", line 1
    "\N{FULL S-T-O-P}"
    ^^^^^^^^^^^^^^^^^^
SyntaxError: (unicode error) 'unicodeescape' codec can't decode bytes in position 0-15: unknown Unicode character name
```

---

_Comment by @github-actions[bot] on 2025-07-30 19:35_


<!-- generated-comment typing_conformance_diagnostics_diff -->


## Diagnostic diff on [typing conformance tests](https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance)

No changes detected when running ty on typing conformance tests âœ…



---

_Comment by @astral-sh-bot[bot] on 2025-12-08 08:10_


<!-- generated-comment ecosystem -->


## `ruff-ecosystem` results

### Linter (stable)
âœ… ecosystem check detected no linter changes.

### Linter (preview)
âœ… ecosystem check detected no linter changes.

### Formatter (stable)
âœ… ecosystem check detected no format changes.

### Formatter (preview)
âœ… ecosystem check detected no format changes.





---
