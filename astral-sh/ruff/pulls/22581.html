<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Remove redundant re-exports that share the same top-most module - astral-sh/ruff #22581</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Remove redundant re-exports that share the same top-most module</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22581">#22581</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2026-01-14 19:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a></div>
            <div class="timeline-body"><p>The idea here is to avoid flooding completions with a bunch of
redundant symbols when those symbols are just re-exports of one
another. And in particular, to avoid suggesting symbols &quot;deeper&quot;
in the module graph.</p>
<p>The implementation here is (to me) surprisingly complicated. The main
constraints leading to some of that complexity are:</p>
<ol>
<li><p>Trying to limit the redundant detection to as few of the symbols
we extract as possible. In particular, while I haven&#x27;t done benchmarking
on this, I perceive the redundancy detection to be somewhat expensive
and auto-import can return lots of symbols. So we&#x27;re careful to only do
this extra checking on (typically) small groups of symbols that could
possibly be merged.</p>
</li>
<li><p>Even by restricting our work, this merging process could still be
called quite a bit. (Thousands of times in my &quot;standard data scienc-y
test environment.&quot;) So I went out of my way to amortize allocs.</p>
</li>
<li><p>Re-exports can form a chain and we want to find all of them.</p>
</li>
<li><p>We (probably) don&#x27;t want to remove redundant re-exports unless
they share the same top-level module. Otherwise, e.g., a library
that re-exports another library&#x27;s symbols could have all of its
re-exports dropped.</p>
</li>
<li><p>We want to only keep the top-most re-exports, and there may be
multiple such re-exports. So we keep all of them.</p>
</li>
<li><p>We can&#x27;t assume anything about the relationship of re-exports
and the original definition. A re-export could be deeper in the
module hierarchy than the original definition or above it.</p>
</li>
</ol>
<p>Reviewers are encouraged to read this PR commit by commit.</p>
<p>Fixes astral-sh/ty#1857</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/Gankra">@Gankra</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/sharkdp">@sharkdp</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:20</div>
            <div class="timeline-body"><p>Demo:</p>
<p>https://github.com/user-attachments/assets/3c141fb3-f48b-489a-b7d9-9b6ec54fa457</p>
<p>Here&#x27;s what the status quo looks like:</p>
<p>https://github.com/user-attachments/assets/a5d8bc24-6537-4d1a-b192-a1b2eed2061b</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-14 19:20</div>
            <div class="timeline-body">

<a href="https://github.com/python/typing/blob/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance/">Typing conformance results</a>
<p>No changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-14 19:22</div>
            <div class="timeline-body">

<code>mypy_primer</code> results

Changes were detected when running on open source projects

<pre><code>prefect (https://github.com/PrefectHQ/prefect)
- src/integrations/prefect-dbt/prefect_dbt/core/settings.py:94:28: error[invalid-assignment] Object of type `T@resolve_block_document_references | int | dict[str, Any] | ... omitted 4 union elements` is not assignable to `dict[str, Any]`
+ src/integrations/prefect-dbt/prefect_dbt/core/settings.py:94:28: error[invalid-assignment] Object of type `T@resolve_block_document_references | dict[str, Any]` is not assignable to `dict[str, Any]`
- src/integrations/prefect-dbt/prefect_dbt/core/settings.py:99:28: error[invalid-assignment] Object of type `int | T@resolve_variables | float | ... omitted 4 union elements` is not assignable to `dict[str, Any]`
+ src/integrations/prefect-dbt/prefect_dbt/core/settings.py:99:28: error[invalid-assignment] Object of type `T@resolve_variables | dict[str, Any]` is not assignable to `dict[str, Any]`
- src/prefect/cli/deploy/_core.py:86:21: error[invalid-assignment] Object of type `T@resolve_block_document_references | int | dict[str, Any] | ... omitted 4 union elements` is not assignable to `dict[str, Any]`
+ src/prefect/cli/deploy/_core.py:86:21: error[invalid-assignment] Object of type `T@resolve_block_document_references | dict[str, Any]` is not assignable to `dict[str, Any]`
- src/prefect/cli/deploy/_core.py:87:21: error[invalid-assignment] Object of type `int | T@resolve_variables | float | ... omitted 4 union elements` is not assignable to `dict[str, Any]`
+ src/prefect/cli/deploy/_core.py:87:21: error[invalid-assignment] Object of type `T@resolve_variables` is not assignable to `dict[str, Any]`
- src/prefect/deployments/steps/core.py:137:38: error[invalid-argument-type] Argument is incorrect: Expected `T@resolve_variables`, found `T@resolve_block_document_references | int | dict[str, Any] | ... omitted 4 union elements`
+ src/prefect/deployments/steps/core.py:137:38: error[invalid-argument-type] Argument is incorrect: Expected `T@resolve_variables`, found `T@resolve_block_document_references | dict[str, Any]`
- src/prefect/utilities/templating.py:320:13: error[invalid-assignment] Invalid subscript assignment with key of type `object` and value of type `T@resolve_block_document_references | int | dict[str, Any] | ... omitted 4 union elements` on object of type `dict[str, Any]`
+ src/prefect/utilities/templating.py:320:13: error[invalid-assignment] Invalid subscript assignment with key of type `object` and value of type `T@resolve_block_document_references | dict[str, Any]` on object of type `dict[str, Any]`
- src/prefect/utilities/templating.py:323:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_block_document_references | dict[str, Any]`, found `list[T@resolve_block_document_references | int | dict[str, Any] | ... omitted 5 union elements]`
+ src/prefect/utilities/templating.py:323:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_block_document_references | dict[str, Any]`, found `list[T@resolve_block_document_references | dict[str, Any] | Unknown]`
- src/prefect/utilities/templating.py:437:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `dict[object, int | T@resolve_variables | float | ... omitted 5 union elements]`
+ src/prefect/utilities/templating.py:437:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `dict[object, T@resolve_variables | Unknown]`
- src/prefect/utilities/templating.py:442:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `list[int | T@resolve_variables | float | ... omitted 5 union elements]`
+ src/prefect/utilities/templating.py:442:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `list[T@resolve_variables | Unknown]`
- src/prefect/workers/base.py:232:13: error[invalid-argument-type] Argument is incorrect: Expected `T@resolve_variables`, found `T@resolve_block_document_references | int | dict[str, Any] | ... omitted 4 union elements`
+ src/prefect/workers/base.py:232:13: error[invalid-argument-type] Argument is incorrect: Expected `T@resolve_variables`, found `T@resolve_block_document_references | dict[str, Any]`
- src/prefect/workers/base.py:234:20: error[invalid-argument-type] Argument expression after ** must be a mapping type: Found `int | T@resolve_variables | float | ... omitted 4 union elements`
+ src/prefect/workers/base.py:234:20: error[invalid-argument-type] Argument expression after ** must be a mapping type: Found `T@resolve_variables`

scikit-build-core (https://github.com/scikit-build/scikit-build-core)
+ src/scikit_build_core/build/wheel.py:99:20: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 47 diagnostics
+ Found 48 diagnostics

static-frame (https://github.com/static-frame/static-frame)
- static_frame/core/bus.py:671:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[Bus[Any], object_]`, found `InterGetItemLocReduces[Bus[Any] | Bottom[Series[Any, Any]] | ndarray[Never, Never] | ... omitted 6 union elements, object_]`
- static_frame/core/bus.py:675:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemILocReduces[Bus[Any], object_]`, found `InterGetItemILocReduces[Bus[Any] | Bottom[Index[Any]] | TypeBlocks | ... omitted 6 union elements, object_ | Self@iloc]`
+ static_frame/core/bus.py:675:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemILocReduces[Bus[Any], object_]`, found `InterGetItemILocReduces[Self@iloc | Bus[Any], object_ | Self@iloc]`
- static_frame/core/node_selector.py:526:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[TVContainer_co@InterfaceSelectQuartet, Any]`, found `InterGetItemLocReduces[Unknown | Bottom[Series[Any, Any]], Any]`
+ static_frame/core/node_selector.py:526:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[TVContainer_co@InterfaceSelectQuartet, Any]`, found `InterGetItemLocReduces[Bottom[Series[Any, Any]] | Unknown, Any]`
- static_frame/core/series.py:772:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemILocReduces[Series[Any, Any], TVDtype@Series]`, found `InterGetItemILocReduces[Series[Any, Any] | ndarray[Never, Never] | TypeBlocks | ... omitted 6 union elements, TVDtype@Series]`
+ static_frame/core/series.py:772:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemILocReduces[Series[Any, Any], TVDtype@Series]`, found `InterGetItemILocReduces[Series[Any, Any] | Bottom[Index[Any]] | TypeBlocks | ... omitted 6 union elements, TVDtype@Series]`
- static_frame/core/yarn.py:418:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemILocReduces[Yarn[Any], object_]`, found `InterGetItemILocReduces[Yarn[Any] | Bottom[Index[Any]] | TypeBlocks | ... omitted 6 union elements, object_]`
- Found 1825 diagnostics
+ Found 1823 diagnostics

core (https://github.com/home-assistant/core)
- homeassistant/util/variance.py:47:12: error[invalid-return-type] Return type does not match returned value: expected `(**_P@ignore_variance) -&gt; _R@ignore_variance`, found `_Wrapped[_P@ignore_variance, _R@ignore_variance | int | float | datetime, _P@ignore_variance, _R@ignore_variance | int | float | datetime]`
- Found 14509 diagnostics
+ Found 14508 diagnostics


</code></pre>


<p>No memory usage changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for <a href="https://github.com/dcreager">@dcreager</a> removed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for <a href="https://github.com/carljm">@carljm</a> removed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for <a href="https://github.com/Gankra">@Gankra</a> removed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for <a href="https://github.com/sharkdp">@sharkdp</a> removed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-14 19:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:79 on 2026-01-15 13:14</div>
            <div class="timeline-body"><p>Nit, it could be assigning the result of <code>AllSymbolInfo::</code> to a variable before acquiring the lock, if whatever we do in <code>::from_module </code>is expensive. The same applies for line 85</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/symbols.rs</code>:294 on 2026-01-15 13:18</div>
            <div class="timeline-body"><p><code>ModuleName</code> is also a compact str, meaning we only clone a heap allocation if the string is more than 24 bytes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/symbols.rs</code>:837 on 2026-01-15 13:19</div>
            <div class="timeline-body"><p>Nit: I have a slight preference for using our own enum here (which could also have methods like <code>symbol_kind</code>). Reading <code>is_left</code>, <code>either</code> in this body feels rather cryptic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_module_resolver/src/module_name.rs</code>:96 on 2026-01-15 13:29</div>
            <div class="timeline-body"><p>Nit: I&#x27;m leaning towards using <code>root</code> here, which IMO goes better with <code>ancestors</code> and <code>parent</code> than <code>top</code>, but I can&#x27;t specifically say why :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:239 on 2026-01-15 13:35</div>
            <div class="timeline-body"><p>One concern that I have with removing it without considering the outer context is if you&#x27;re working on said library. Let&#x27;s say I work on pandas and are writing a module in <code>pandas.io.parsers.readers</code> or a sibling package of it. It&#x27;s probably desired to then import the symbol from the closest module rather than always preferring the outer most module?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:350 on 2026-01-15 13:39</div>
            <div class="timeline-body"><p>This <code>impl</code> block is a bit larger than what I normally would feel comfortable having within a function body. Should we make <code>merge</code> a module?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:347 on 2026-01-15 13:40</div>
            <div class="timeline-body"><p>I&#x27;d find a a short comment on what the meaning of these fields helpful. The code here is complicated enough that I&#x27;m failing to easily infer the meaning (and all the invariants) by simply scanning the method bodies</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:245 on 2026-01-15 13:51</div>
            <div class="timeline-body"><p>All the lints emitted by clippy here seem reasonable to me (except maybe the match one but can we just disable this specific lint). Any specific reason why you disabled all warning lints?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:436 on 2026-01-15 13:55</div>
            <div class="timeline-body"><p>Is this semantically the same as &quot;finishing&quot; a group? If so, should we add a <code>finish_into(&amp;mut self, target: &amp;mut Vec)</code> method (or <code>finish(&amp;mut self) -&gt; impl Iterator&lt;...&gt;</code> ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:447 on 2026-01-15 13:55</div>
            <div class="timeline-body"><p>haha, you&#x27;re not one of the <code>is_some_and</code> fans :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:401 on 2026-01-15 14:01</div>
            <div class="timeline-body"><p>What are cases where the kind between two symbols with the same fully qualified name is different?</p>
<p>Would two different kinds suggest that these are different symbols?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:322 on 2026-01-15 14:05</div>
            <div class="timeline-body"><p>Nit: This might be more annoying, so I leave it up to you. As I understand it, the <code>origin_keep</code> act as a mechanism to remove elements from <code>origin</code> and <code>reexport</code> without having to actually remove them (because <code>swap_remove</code> would change the ordering).</p>
<p>An alternative (but maybe too annoying to deal with) approach would be to &quot;tombstone&quot; elements that have been removed, e.g. by making <code>orign</code> a <code>Vec</code> over <code>Option&lt;AllSymbolInfo&gt;</code> where <code>None</code> is the tombstone.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2026-01-15 14:09</div>
            <div class="timeline-body"><p>This looks good. There&#x27;s certainly a fair amount of complexity in <code>merge</code> (functional but also to avoid allocations) that requires a fair amount of concentration to understand what&#x27;s going on.</p>
<p>I have one design question on whether filtering out re-export must be sensitive to the current module.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_module_resolver/src/module_name.rs</code>:96 on 2026-01-15 14:27</div>
            <div class="timeline-body"><p>I was unsure whether &quot;root&quot; was really appropriate since I&#x27;m not sure, e.g., <code>a.b.c</code> has a &quot;root&quot; at <code>a</code> per se.</p>
<p>I could just make this more verbose and call it <code>first_component</code>. Which I think I kind of like better since it&#x27;s less ambiguous and it isn&#x27;t frequently used either, so the verbosity doesn&#x27;t bother me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:79 on 2026-01-15 15:09</div>
            <div class="timeline-body"><p>Not expensive, but not free. I&#x27;ve moved it outside of the critical section for reasons of good sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:239 on 2026-01-15 15:19</div>
            <div class="timeline-body"><p>Maaaaybe. I think that&#x27;s very plausible, but I&#x27;m not sure.</p>
<p>The other similar thing in this space is that we might only want to do this merging in non-first party code, under the reasoning that in first party code, you probably want to see <em>all</em> your re-exports. That would also I think address this concern without coming up with a notion of what &quot;closest module&quot; means.</p>
<p>(We talked about this in our 1-on-1. The reason I didn&#x27;t go down this route is that it&#x27;s pretty annoying to set up the test infrastructure for it.)</p>
<p>If you&#x27;re okay with it, I&#x27;d like to move forward with this as-is and prioritize future work here based on user feedback. I filed <a href="https://github.com/astral-sh/ty/issues/2519">astral-sh/ty#2519</a> to track this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:245 on 2026-01-15 15:20</div>
            <div class="timeline-body"><p>An uncommented <code>allow(warnings)</code> from me is almost certainly a mistake. :P I sometimes slap it in there when writing code because I find the warnings in my editor very distracting.</p>
<p>I try not to override warnings (Clippy or otherwise) without adding a comment saying something about it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:322 on 2026-01-15 15:22</div>
            <div class="timeline-body"><p>Yeah I see that. I think I&#x27;m going to stick with the current approach though. Using indices avoids borrowck woes <em>and</em> it avoids needing to do an additional <code>unwrap()</code> every time we access something in <code>origin</code> and <code>reexport</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:347 on 2026-01-15 15:30</div>
            <div class="timeline-body"><p>Yes, thank you for the nudge. Done!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:350 on 2026-01-15 15:30</div>
            <div class="timeline-body"><p>It was nice to not have to redo the imports. But sure I don&#x27;t feel strongly. It has been modulized. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:401 on 2026-01-15 15:33</div>
            <div class="timeline-body"><p>Ah good question! I added this comment to the source clarifying why:</p>
<pre><code>                    // The reason why we do this unconditionally is that
                    // reexport symbols usually do not have a very specific
                    // kind, and are typically just assigned a kind of
                    // &quot;variable.&quot; This is because the symbol extraction
                    // reports these symbols as-is by inspecting import
                    // statements and doesn&#x27;t follow them to their original
                    // definition to discover their &quot;true&quot; kind. But that&#x27;s
                    // exactly what we&#x27;re doing here! We have the original
                    // definition. So assign the kind from the original,
                    // even when it crosses package hierarchies.
</code></pre>
<p>Does that help?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:436 on 2026-01-15 15:35</div>
            <div class="timeline-body"><p>Yeah that kind of API is what I started with. But the iterator returned borrows from the <code>Group</code> and that makes it difficult to clear the other state.</p>
<p>This could be fixed with a dedicated iterator type and a <code>Drop</code> impl that does the clearing, but it just seemed like too much ceremony for a one-time-use API. If this were a &quot;real&quot; API with broader scope, yeah absolutely, it&#x27;d be worth some strong encapsulation and coupling reduction.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/all_symbols.rs</code>:447 on 2026-01-15 15:35</div>
            <div class="timeline-body"><p>No I am! I just spent many years writing Rust without it, so I still sometimes forget it exists. :P I changed this to use <code>is_some_and</code>. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/symbols.rs</code>:294 on 2026-01-15 15:36</div>
            <div class="timeline-body"><p>Yeah I just figured it&#x27;d be pretty common for <code>ModuleName</code> to be longer than 24 bytes in this context.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/symbols.rs</code>:837 on 2026-01-15 15:41</div>
            <div class="timeline-body"><p>Fair enough. I don&#x27;t feel strongly!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2026-01-15 15:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-15 17:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2026-01-15 17:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2026-01-15 17:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:23:02 UTC
    </footer>
</body>
</html>
