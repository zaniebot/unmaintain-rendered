<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`ruff server` respects `per-file-ignores` configuration - astral-sh/ruff #11224</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>ruff server</code> respects <code>per-file-ignores</code> configuration</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11224">#11224</a>
        opened by <a href="https://github.com/snowsignal">@snowsignal</a>
        on 2024-05-01 00:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowsignal">@snowsignal</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Fixes #11185
Fixes #11214</p>
<p>Document path and package information is now forwarded to the Ruff linter, which allows <code>per-file-ignores</code> to correctly match against the file name. This also fixes an issue where the import sorting rule didn't distinguish between third-party and first-party packages since we didn't pass in the package root.</p>
<h2>Test Plan</h2>
<p><code>per-file-ignores</code> should ignore files as expected. One quick way to check is by adding this to your <code>pyproject.toml</code>:</p>
<pre><code class="language-toml">[tool.ruff.lint.per-file-ignores]
&quot;__init__.py&quot; = [&quot;ALL&quot;]
</code></pre>
<p>Then, confirm that no diagnostics appear when you add code to an <code>__init__.py</code> file (besides syntax errors).</p>
<p>The import sorting fix can be verified by failing to reproduce the original issue - an <code>I001</code> diagnostic should not appear in <code>other_module.py</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @snowsignal on 2024-05-01 00:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @snowsignal on 2024-05-01 00:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-05-01 00:38</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-05-01 04:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_server/src/fix.rs</code>:26 on 2024-05-01 07:02</div>
            <div class="timeline-body"><p>Can you try what happens if you run <code>fix_all</code> on a new, unnamed and unsaved file. Does the new file already have a valid path?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-05-01 07:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowsignal">@snowsignal</a> reviewed on 2024-05-02 02:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/snowsignal">@snowsignal</a> on <code>crates/ruff_server/src/fix.rs</code>:26 on 2024-05-02 02:24</div>
            <div class="timeline-body"><p>It does, although the workspace edit seems to fail in certain cases, for some reason? I'll investigate the issue in a follow-up, since it seems to be unrelated to this change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @snowsignal on 2024-05-02 02:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @snowsignal on 2024-05-02 02:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-05-02 02:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:04:06 UTC
    </footer>
</body>
</html>
