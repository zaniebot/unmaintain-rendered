<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stabilize `allow_newline_after_block_open` - astral-sh/ruff #22742</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Stabilize <code>allow_newline_after_block_open</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22742">#22742</a>
        opened by <a href="https://github.com/dylwil3">@dylwil3</a>
        on 2026-01-19 20:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a></div>
            <div class="timeline-body"><p><em>No description provided.</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @dylwil3 on 2026-01-19 20:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @dylwil3 on 2026-01-19 20:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @dylwil3 on 2026-01-19 20:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-19 20:54</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Formatter (stable)</h3>
<p>ℹ️ ecosystem check <strong>detected format changes</strong>. (+430 -0 lines in 292 files in 19 projects; 36 projects unchanged)</p>
<details><summary><a href="https://github.com/PostHog/HouseWatch">PostHog/HouseWatch</a> (+2 -0 lines across 2 files)</summary>
<p>

<p><a href='https://github.com/PostHog/HouseWatch/blob/9b126c0d588c1dc33045dfea3dd76f8abf888d29/housewatch/api/async_migration.py#L52'>housewatch/api/async_migration.py~L52</a></p>
<pre><code class="language-diff"> 
     @action(methods=[&quot;POST&quot;], detail=True)
     def trigger(self, request, **kwargs):
+
         migration = self.get_object()
 
         migration.status = MigrationStatus.Starting
</code></pre>
<p><a href='https://github.com/PostHog/HouseWatch/blob/9b126c0d588c1dc33045dfea3dd76f8abf888d29/housewatch/async_migrations/runner.py#L27'>housewatch/async_migrations/runner.py~L27</a></p>
<pre><code class="language-diff"> def start_async_migration(
     migration: AsyncMigration, ignore_posthog_version=False
 ) -&gt; bool:
+
     if migration.status not in [MigrationStatus.Starting, MigrationStatus.NotStarted]:
         logger.error(f&quot;Initial check failed for async migration {migration.name}&quot;)
         return False
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+152 -0 lines across 87 files)</summary>
<p>

<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/data/test_classes/custom_slots.py#L28'>data/test_classes/custom_slots.py~L28</a></p>
<pre><code class="language-diff">         value_reset_delay: Optional[int] = None,
         influence_conversation: bool = True,
     ) -&gt; None:
+
         super().__init__(
             name=name,
             initial_value=initial_value,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/examples/reminderbot/actions/actions.py#L28'>examples/reminderbot/actions/actions.py~L28</a></p>
<pre><code class="language-diff">         tracker: Tracker,
         domain: Dict[Text, Any],
     ) -&gt; List[Dict[Text, Any]]:
+
         dispatcher.utter_message(&quot;I will remind you in 5 seconds.&quot;)
 
         date = datetime.datetime.now() + datetime.timedelta(seconds=5)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/examples/reminderbot/actions/actions.py#L56'>examples/reminderbot/actions/actions.py~L56</a></p>
<pre><code class="language-diff">         tracker: Tracker,
         domain: Dict[Text, Any],
     ) -&gt; List[Dict[Text, Any]]:
+
         name = next(tracker.get_slot(&quot;PERSON&quot;), &quot;someone&quot;)
         dispatcher.utter_message(f&quot;Remember to call {name}!&quot;)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/examples/reminderbot/actions/actions.py#L71'>examples/reminderbot/actions/actions.py~L71</a></p>
<pre><code class="language-diff">     async def run(
         self, dispatcher, tracker: Tracker, domain: Dict[Text, Any]
     ) -&gt; List[Dict[Text, Any]]:
+
         conversation_id = tracker.sender_id
 
         dispatcher.utter_message(f&quot;The ID of this conversation is '{conversation_id}'.&quot;)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/examples/reminderbot/actions/actions.py#L98'>examples/reminderbot/actions/actions.py~L98</a></p>
<pre><code class="language-diff">         tracker: Tracker,
         domain: Dict[Text, Any],
     ) -&gt; List[Dict[Text, Any]]:
+
         plant = next(tracker.get_latest_entity_values(&quot;plant&quot;), &quot;someone&quot;)
         dispatcher.utter_message(f&quot;Your {plant} needs some water!&quot;)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/examples/reminderbot/actions/actions.py#L113'>examples/reminderbot/actions/actions.py~L113</a></p>
<pre><code class="language-diff">     async def run(
         self, dispatcher, tracker: Tracker, domain: Dict[Text, Any]
     ) -&gt; List[Dict[Text, Any]]:
+
         dispatcher.utter_message(&quot;Okay, I'll cancel all your reminders.&quot;)
 
         # Cancel all reminders
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/examples/reminderbot/callback_server.py#L4'>examples/reminderbot/callback_server.py~L4</a></p>
<pre><code class="language-diff"> 
 
 def create_app() -&gt; Sanic:
+
     bot_app = Sanic(&quot;callback_server&quot;, configure_logging=False)
 
     @bot_app.post(&quot;/bot&quot;)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/cli/export.py#L177'>rasa/cli/export.py~L177</a></p>
<pre><code class="language-diff"> 
 
 async def _export_trackers(args: argparse.Namespace) -&gt; None:
+
     _assert_max_timestamp_is_greater_than_min_timestamp(args)
 
     endpoints = rasa.core.utils.read_endpoints_from_path(args.endpoints)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/cli/run.py#L58'>rasa/cli/run.py~L58</a></p>
<pre><code class="language-diff"> 
 
 def _validate_model_path(model_path: Text, parameter: Text, default: Text) -&gt; Text:
+
     if model_path is not None and not os.path.exists(model_path):
         reason_str = f&quot;'{model_path}' not found.&quot;
         if model_path is None:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/actions/action.py#L658'>rasa/core/actions/action.py~L658</a></p>
<pre><code class="language-diff"> 
 class RemoteAction(Action):
     def __init__(self, name: Text, action_endpoint: Optional[EndpointConfig]) -&gt; None:
+
         self._name = name
         self.action_endpoint = action_endpoint
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/agent.py#L503'>rasa/core/agent.py~L503</a></p>
<pre><code class="language-diff">         return await self.handle_message(msg)
 
     def _set_fingerprint(self, fingerprint: Optional[Text] = None) -&gt; None:
+
         if fingerprint:
             self.fingerprint = fingerprint
         else:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/botframework.py#L48'>rasa/core/channels/botframework.py~L48</a></p>
<pre><code class="language-diff">         bot: Text,
         service_url: Text,
     ) -&gt; None:
+
         service_url = (
             f&quot;{service_url}/&quot; if not service_url.endswith(&quot;/&quot;) else service_url
         )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/callback.py#L22'>rasa/core/channels/callback.py~L22</a></p>
<pre><code class="language-diff">         return &quot;callback&quot;
 
     def __init__(self, endpoint: EndpointConfig) -&gt; None:
+
         self.callback_endpoint = endpoint
         super().__init__()
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/facebook.py#L33'>rasa/core/channels/facebook.py~L33</a></p>
<pre><code class="language-diff">         page_access_token: Text,
         on_new_message: Callable[[UserMessage], Awaitable[Any]],
     ) -&gt; None:
+
         self.on_new_message = on_new_message
         self.client = MessengerClient(page_access_token)
         self.last_message: Dict[Text, Any] = {}
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/facebook.py#L171'>rasa/core/channels/facebook.py~L171</a></p>
<pre><code class="language-diff">         return &quot;facebook&quot;
 
     def __init__(self, messenger_client: MessengerClient) -&gt; None:
+
         self.messenger_client = messenger_client
         super().__init__()
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/facebook.py#L349'>rasa/core/channels/facebook.py~L349</a></p>
<pre><code class="language-diff">     def blueprint(
         self, on_new_message: Callable[[UserMessage], Awaitable[Any]]
     ) -&gt; Blueprint:
+
         fb_webhook = Blueprint(&quot;fb_webhook&quot;, __name__)
 
         # noinspection PyUnusedLocal
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/hangouts.py#L40'>rasa/core/channels/hangouts.py~L40</a></p>
<pre><code class="language-diff"> 
     @staticmethod
     def _text_card(message: Dict[Text, Any]) -&gt; Dict:
+
         card = {
             &quot;cards&quot;: [
                 {
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/hangouts.py#L192'>rasa/core/channels/hangouts.py~L192</a></p>
<pre><code class="language-diff"> 
     @classmethod
     def from_credentials(cls, credentials: Optional[Dict[Text, Any]]) -&gt; InputChannel:
+
         if credentials:
             return cls(credentials.get(&quot;project_id&quot;))
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/hangouts.py#L204'>rasa/core/channels/hangouts.py~L204</a></p>
<pre><code class="language-diff">         hangouts_room_added_intent_name: Optional[Text] = &quot;/room_added&quot;,
         hangouts_removed_intent_name: Optional[Text] = &quot;/bot_removed&quot;,
     ) -&gt; None:
+
         self.project_id = project_id
         self.hangouts_user_added_intent_name = hangouts_user_added_intent_name
         self.hangouts_room_added_intent_name = hangouts_room_added_intent_name
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/hangouts.py#L226'>rasa/core/channels/hangouts.py~L226</a></p>
<pre><code class="language-diff"> 
     @staticmethod
     def _extract_sender(req: Request) -&gt; Text:
+
         if req.json[&quot;type&quot;] == &quot;MESSAGE&quot;:
             return req.json[&quot;message&quot;][&quot;sender&quot;][&quot;displayName&quot;]
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/hangouts.py#L233'>rasa/core/channels/hangouts.py~L233</a></p>
<pre><code class="language-diff"> 
     # noinspection PyMethodMayBeStatic
     def _extract_message(self, req: Request) -&gt; Text:
+
         if req.json[&quot;type&quot;] == &quot;MESSAGE&quot;:
             message = req.json[&quot;message&quot;][&quot;text&quot;]
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/hangouts.py#L292'>rasa/core/channels/hangouts.py~L292</a></p>
<pre><code class="language-diff"> 
         @custom_webhook.route(&quot;/webhook&quot;, methods=[&quot;POST&quot;])
         async def receive(request: Request) -&gt; HTTPResponse:
+
             if self.project_id:
                 token = request.headers.get(&quot;Authorization&quot;, &quot;&quot;).replace(&quot;Bearer &quot;, &quot;&quot;)
                 self._check_token(token)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/rocketchat.py#L114'>rasa/core/channels/rocketchat.py~L114</a></p>
<pre><code class="language-diff">         )
 
     def __init__(self, user: Text, password: Text, server_url: Text) -&gt; None:
+
         self.user = user
         self.password = password
         self.server_url = server_url
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/channels/webexteams.py#L78'>rasa/core/channels/webexteams.py~L78</a></p>
<pre><code class="language-diff">         sender_id: Optional[Text],
         metadata: Optional[Dict],
     ) -&gt; Any:
+
         try:
             out_channel = self.get_output_channel()
             user_msg = UserMessage(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/featurizers/single_state_featurizer.py#L186'>rasa/core/featurizers/single_state_featurizer.py~L186</a></p>
<pre><code class="language-diff">         precomputations: Optional[MessageContainerForCoreFeaturization],
         sparse: bool = False,
     ) -&gt; Dict[Text, List[Features]]:
+
         # Remove entities from possible attributes
         attributes = set(
             attribute for attribute in sub_state.keys() if attribute != ENTITIES
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/nlg/callback.py#L62'>rasa/core/nlg/callback.py~L62</a></p>
<pre><code class="language-diff">     &quot;&quot;&quot;
 
     def __init__(self, endpoint_config: EndpointConfig) -&gt; None:
+
         self.nlg_endpoint = endpoint_config
 
     async def generate(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/policies/rule_policy.py#L951'>rasa/core/policies/rule_policy.py~L951</a></p>
<pre><code class="language-diff">     def _find_action_from_loop_happy_path(
         tracker: DialogueStateTracker,
     ) -&gt; Tuple[Optional[Text], Optional[Text]]:
+
         active_loop_name = tracker.active_loop_name
         if active_loop_name is None:
             return None, None
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/policies/ted_policy.py#L1926'>rasa/core/policies/ted_policy.py~L1926</a></p>
<pre><code class="language-diff">         text_output: tf.Tensor,
         text_sequence_lengths: tf.Tensor,
     ) -&gt; tf.Tensor:
+
         text_transformed, text_mask, text_sequence_lengths = self._reshape_for_entities(
             tf_batch_data,
             dialogue_transformer_output,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/policies/ted_policy.py#L2128'>rasa/core/policies/ted_policy.py~L2128</a></p>
<pre><code class="language-diff">         text_output: tf.Tensor,
         text_sequence_lengths: tf.Tensor,
     ) -&gt; Tuple[tf.Tensor, tf.Tensor]:
+
         text_transformed, _, text_sequence_lengths = self._reshape_for_entities(
             tf_batch_data,
             dialogue_transformer_output,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/processor.py#L785'>rasa/core/processor.py~L785</a></p>
<pre><code class="language-diff">     async def _handle_message_with_tracker(
         self, message: UserMessage, tracker: DialogueStateTracker
     ) -&gt; None:
+
         if message.parse_data:
             parse_data = message.parse_data
         else:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/test.py#L702'>rasa/core/test.py~L702</a></p>
<pre><code class="language-diff">     event: ActionExecuted,
     fail_on_prediction_errors: bool,
 ) -&gt; Tuple[EvaluationStore, PolicyPrediction, Optional[EntityEvaluationResult]]:
+
     action_executed_eval_store = EvaluationStore()
 
     expected_action_name = event.action_name
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/core/test.py#L820'>rasa/core/test.py~L820</a></p>
<pre><code class="language-diff">     List[Dict[Text, Any]],
     List[EntityEvaluationResult],
 ]:
+
     processor = agent.processor
     if agent.processor is not None:
         processor = agent.processor
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/engine/recipes/default_recipe.py#L668'>rasa/engine/recipes/default_recipe.py~L668</a></p>
<pre><code class="language-diff">         preprocessors: List[Text],
         train_nodes: Dict[Text, SchemaNode],
     ) -&gt; Dict[Text, SchemaNode]:
+
         predict_config = copy.deepcopy(config)
         predict_nodes = {}
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/engine/storage/local_model_storage.py#L221'>rasa/engine/storage/local_model_storage.py~L221</a></p>
<pre><code class="language-diff"> 
     @staticmethod
     def _persist_metadata(metadata: ModelMetadata, temporary_directory: Path) -&gt; None:
+
         rasa.shared.utils.io.dump_obj_as_json_to_file(
             temporary_directory / MODEL_ARCHIVE_METADATA_FILE, metadata.as_dict()
         )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/engine/validation.py#L485'>rasa/engine/validation.py~L485</a></p>
<pre><code class="language-diff">     parent_return_type: TypeAnnotation,
     required_type: TypeAnnotation,
 ) -&gt; None:
+
     if not typing_utils.issubtype(parent_return_type, required_type):
         parent_node_text = &quot;&quot;
         if parent_node:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/classifiers/diet_classifier.py#L506'>rasa/nlu/classifiers/diet_classifier.py~L506</a></p>
<pre><code class="language-diff">     def _extract_features(
         self, message: Message, attribute: Text
     ) -&gt; Dict[Text, Union[scipy.sparse.spmatrix, np.ndarray]]:
+
         (
             sparse_sequence_features,
             sparse_sentence_features,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/classifiers/diet_classifier.py#L775'>rasa/nlu/classifiers/diet_classifier.py~L775</a></p>
<pre><code class="language-diff">         sparse_feature_sizes: Dict[Text, Dict[Text, List[int]]],
         label_attribute: Optional[Text] = None,
     ) -&gt; Dict[Text, Dict[Text, List[int]]]:
+
         if label_attribute in sparse_feature_sizes:
             del sparse_feature_sizes[label_attribute]
         return sparse_feature_sizes
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/classifiers/diet_classifier.py#L1260'>rasa/nlu/classifiers/diet_classifier.py~L1260</a></p>
<pre><code class="language-diff">         config: Dict[Text, Any],
         finetune_mode: bool,
     ) -&gt; &quot;RasaModel&quot;:
+
         predict_data_example = RasaModelData(
             label_key=model_data_example.label_key,
             data={
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/classifiers/diet_classifier.py#L1502'>rasa/nlu/classifiers/diet_classifier.py~L1502</a></p>
<pre><code class="language-diff">         sequence_feature_lengths: tf.Tensor,
         name: Text,
     ) -&gt; tf.Tensor:
+
         x, _ = self._tf_layers[f&quot;feature_combining_layer.{name}&quot;](
             (sequence_features, sentence_features, sequence_feature_lengths),
             training=self._training,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/classifiers/diet_classifier.py#L1683'>rasa/nlu/classifiers/diet_classifier.py~L1683</a></p>
<pre><code class="language-diff">         return loss
 
     def _update_label_metrics(self, loss: tf.Tensor, acc: tf.Tensor) -&gt; None:
+
         self.intent_loss.update_state(loss)
         self.intent_acc.update_state(acc)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/classifiers/diet_classifier.py#L1841'>rasa/nlu/classifiers/diet_classifier.py~L1841</a></p>
<pre><code class="language-diff">         combined_sequence_sentence_feature_lengths: tf.Tensor,
         text_transformed: tf.Tensor,
     ) -&gt; Dict[Text, tf.Tensor]:
+
         if self.all_labels_embed is None:
             raise ValueError(
                 &quot;The model was not prepared for prediction. &quot;
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/featurizers/dense_featurizer/convert_featurizer.py#L323'>rasa/nlu/featurizers/dense_featurizer/convert_featurizer.py~L323</a></p>
<pre><code class="language-diff">         return texts
 
     def _sentence_encoding_of_text(self, batch: List[Text]) -&gt; np.ndarray:
+
         return self.sentence_encoding_signature(tf.convert_to_tensor(batch))[
             &quot;default&quot;
         ].numpy()
 
     def _sequence_encoding_of_text(self, batch: List[Text]) -&gt; np.ndarray:
+
         return self.sequence_encoding_signature(tf.convert_to_tensor(batch))[
             &quot;sequence_encoding&quot;
         ].numpy()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/featurizers/dense_featurizer/convert_featurizer.py#L407'>rasa/nlu/featurizers/dense_featurizer/convert_featurizer.py~L407</a></p>
<pre><code class="language-diff">             )
 
     def _tokenize(self, sentence: Text) -&gt; Any:
+
         return self.tokenize_signature(tf.convert_to_tensor([sentence]))[
             &quot;default&quot;
         ].numpy()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/featurizers/sparse_featurizer/count_vectors_featurizer.py#L98'>rasa/nlu/featurizers/sparse_featurizer/count_vectors_featurizer.py~L98</a></p>
<pre><code class="language-diff">         return [&quot;sklearn&quot;]
 
     def _load_count_vect_params(self) -&gt; None:
+
         # Use shared vocabulary between text and all other attributes of Message
         self.use_shared_vocab = self._config[&quot;use_shared_vocab&quot;]
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/persistor.py#L95'>rasa/nlu/persistor.py~L95</a></p>
<pre><code class="language-diff"> 
     @staticmethod
     def _tar_name(model_name: Text, include_extension: bool = True) -&gt; Text:
+
         ext = &quot;.tar.gz&quot; if include_extension else &quot;&quot;
         return f&quot;{model_name}{ext}&quot;
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/selectors/response_selector.py#L625'>rasa/nlu/selectors/response_selector.py~L625</a></p>
<pre><code class="language-diff">         config: Dict[Text, Any],
         finetune_mode: bool = False,
     ) -&gt; &quot;RasaModel&quot;:
+
         predict_data_example = RasaModelData(
             label_key=model_data_example.label_key,
             data={
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/selectors/response_selector.py#L721'>rasa/nlu/selectors/response_selector.py~L721</a></p>
<pre><code class="language-diff">             logger.debug(f&quot;  {metric} ({name})&quot;)
 
     def _update_label_metrics(self, loss: tf.Tensor, acc: tf.Tensor) -&gt; None:
+
         self.response_loss.update_state(loss)
         self.response_acc.update_state(acc)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/nlu/test.py#L1568'>rasa/nlu/test.py~L1568</a></p>
<pre><code class="language-diff"> 
 
 def _contains_entity_labels(entity_results: List[EntityEvaluationResult]) -&gt; bool:
+
     for result in entity_results:
         if result.entity_targets or result.entity_predictions:
             return True
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/server.py#L234'>rasa/server.py~L234</a></p>
<pre><code class="language-diff">         async def decorated(
             request: Request, *args: Any, **kwargs: Any
         ) -&gt; response.HTTPResponse:
+
             provided = request.args.get(&quot;token&quot;, None)
 
             # noinspection PyProtectedMember
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/events.py#L317'>rasa/shared/core/events.py~L317</a></p>
<pre><code class="language-diff">     def from_parameters(
         parameters: Dict[Text, Any], default: Optional[Type[&quot;Event&quot;]] = None
     ) -&gt; Optional[&quot;Event&quot;]:
+
         event_name = parameters.get(&quot;event&quot;)
         if event_name is None:
             return None
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/events.py#L1020'>rasa/shared/core/events.py~L1020</a></p>
<pre><code class="language-diff">     def _from_story_string(
         cls, parameters: Dict[Text, Any]
     ) -&gt; Optional[List[&quot;SlotSet&quot;]]:
+
         slots = []
         for slot_key, slot_val in parameters.items():
             slots.append(SlotSet(slot_key, slot_val))
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/events.py#L1221'>rasa/shared/core/events.py~L1221</a></p>
<pre><code class="language-diff">     def _from_story_string(
         cls, parameters: Dict[Text, Any]
     ) -&gt; Optional[List[&quot;ReminderScheduled&quot;]]:
+
         trigger_date_time = parser.parse(parameters.get(&quot;date_time&quot;))
 
         return [
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/events.py#L1472'>rasa/shared/core/events.py~L1472</a></p>
<pre><code class="language-diff">     def _from_story_string(
         cls, parameters: Dict[Text, Any]
     ) -&gt; Optional[List[&quot;FollowupAction&quot;]]:
+
         return [
             FollowupAction(
                 parameters.get(&quot;name&quot;),
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/training_data/story_reader/story_reader.py#L111'>rasa/shared/core/training_data/story_reader/story_reader.py~L111</a></p>
<pre><code class="language-diff">     def _add_checkpoint(
         self, name: Text, conditions: Optional[Dict[Text, Any]]
     ) -&gt; None:
+
         # Ensure story part already has a name
         if not self.current_step_builder:
             raise StoryParseError(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/training_data/story_reader/yaml_story_reader.py#L539'>rasa/shared/core/training_data/story_reader/yaml_story_reader.py~L539</a></p>
<pre><code class="language-diff">         return default_value
 
     def _parse_action(self, step: Dict[Text, Any]) -&gt; None:
+
         action_name = step.get(KEY_ACTION, &quot;&quot;)
         if not action_name:
             rasa.shared.utils.io.raise_warning(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/core/training_data/story_reader/yaml_story_reader.py#L560'>rasa/shared/core/training_data/story_reader/yaml_story_reader.py~L560</a></p>
<pre><code class="language-diff">         self._add_event(ActiveLoop.type_name, {LOOP_NAME: active_loop_name})
 
     def _parse_checkpoint(self, step: Dict[Text, Any]) -&gt; None:
+
         checkpoint_name = step.get(KEY_CHECKPOINT, &quot;&quot;)
         slots = step.get(KEY_CHECKPOINT_SLOTS, [])
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/importers/importer.py#L477'>rasa/shared/importers/importer.py~L477</a></p>
<pre><code class="language-diff">         return original.merge(e2e_domain)
 
     def _get_domain_with_e2e_actions(self) -&gt; Domain:
+
         stories = self.get_stories()
 
         additional_e2e_action_names = set()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/importers/rasa.py#L26'>rasa/shared/importers/rasa.py~L26</a></p>
<pre><code class="language-diff">         domain_path: Optional[Text] = None,
         training_data_paths: Optional[Union[List[Text], Text]] = None,
     ):
+
         self._domain_path = domain_path
 
         self._nlu_files = rasa.shared.data.get_data_files(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/nlu/training_data/formats/rasa_yaml.py#L105'>rasa/shared/nlu/training_data/formats/rasa_yaml.py~L105</a></p>
<pre><code class="language-diff">         )
 
     def _parse_nlu(self, nlu_data: Optional[List[Dict[Text, Any]]]) -&gt; None:
+
         if not nlu_data:
             return
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/shared/nlu/training_data/training_data.py#L47'>rasa/shared/nlu/training_data/training_data.py~L47</a></p>
<pre><code class="language-diff">         lookup_tables: Optional[List[Dict[Text, Any]]] = None,
         responses: Optional[Dict[Text, List[Dict[Text, Any]]]] = None,
     ) -&gt; None:
+
         if training_examples:
             self.training_examples = self.sanitize_examples(training_examples)
         else:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/rasa/utils/tensorflow/models.py#L889'>rasa/utils/tensorflow/models.py~L889</a></p>
<pre><code class="language-diff">         tag_name: Text,
         entity_tags: Optional[tf.Tensor] = None,
     ) -&gt; Tuple[tf.Tensor, tf.Tensor, tf.Tensor]:
+
         tag_ids = tf.cast(tag_ids[:, :, 0], tf.int32)
 
         if entity_tags is not None:
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/cli/test_rasa_data.py#L50'>tests/cli/test_rasa_data.py~L50</a></p>
<pre><code class="language-diff"> 
 
 def test_data_convert_nlu_json(run_in_simple_project: Callable[..., RunResult]):
+
     result = run_in_simple_project(
         &quot;data&quot;,
         &quot;convert&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/cli/test_rasa_data.py#L69'>tests/cli/test_rasa_data.py~L69</a></p>
<pre><code class="language-diff"> def test_data_convert_nlu_yml(
     run: Callable[..., RunResult], tmp_path: Path, request: FixtureRequest
 ):
+
     target_file = tmp_path / &quot;out.yml&quot;
 
     # The request rootdir is required as the `testdir` fixture in `run` changes the
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/cli/test_rasa_train.py#L119'>tests/cli/test_rasa_train.py~L119</a></p>
<pre><code class="language-diff"> def test_train_no_domain_exists(
     run_in_simple_project: Callable[..., RunResult], tmp_path: Path
 ) -&gt; None:
+
     os.remove(&quot;domain.yml&quot;)
     run_in_simple_project(
         &quot;train&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/cli/test_rasa_x.py#L146'>tests/cli/test_rasa_x.py~L146</a></p>
<pre><code class="language-diff"> 
 
 def test_rasa_x_raises_warning_and_exits_without_production_flag():
+
     args = argparse.Namespace(loglevel=None, log_file=None, production=None)
     with pytest.raises(SystemExit):
         with pytest.warns(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_hangouts.py#L9'>tests/core/channels/test_hangouts.py~L9</a></p>
<pre><code class="language-diff"> 
 
 def test_hangouts_channel():
+
     from rasa.core.channels.hangouts import HangoutsInput
     import rasa.core
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_hangouts.py#L161'>tests/core/channels/test_hangouts.py~L161</a></p>
<pre><code class="language-diff"> 
 @pytest.mark.asyncio
 async def test_hangouts_output_channel_functions():
+
     from rasa.core.channels.hangouts import HangoutsOutput
 
     output_channel = HangoutsOutput()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_twilio_voice.py#L15'>tests/core/channels/test_twilio_voice.py~L15</a></p>
<pre><code class="language-diff"> 
 
 async def test_twilio_voice_twiml_response_text():
+
     inputs = {
         &quot;initial_prompt&quot;: &quot;hello&quot;,
         &quot;reprompt_fallback_phrase&quot;: &quot;i didn't get that&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_twilio_voice.py#L43'>tests/core/channels/test_twilio_voice.py~L43</a></p>
<pre><code class="language-diff"> 
 
 async def test_twilio_voice_twiml_response_buttons():
+
     inputs = {
         &quot;initial_prompt&quot;: &quot;hello&quot;,
         &quot;reprompt_fallback_phrase&quot;: &quot;i didn't get that&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_twilio_voice.py#L156'>tests/core/channels/test_twilio_voice.py~L156</a></p>
<pre><code class="language-diff"> 
 
 async def test_twilio_voice_remove_image():
+
     with pytest.warns(UserWarning):
         output_channel = TwilioVoiceCollectingOutputChannel()
         await output_channel.send_response(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_twilio_voice.py#L165'>tests/core/channels/test_twilio_voice.py~L165</a></p>
<pre><code class="language-diff"> 
 
 async def test_twilio_voice_keep_image_text():
+
     output_channel = TwilioVoiceCollectingOutputChannel()
     await output_channel.send_response(
         recipient_id=&quot;Chuck Norris&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_twilio_voice.py#L175'>tests/core/channels/test_twilio_voice.py~L175</a></p>
<pre><code class="language-diff"> 
 
 async def test_twilio_emoji_warning():
+
     with pytest.warns(UserWarning):
         output_channel = TwilioVoiceCollectingOutputChannel()
         await output_channel.send_response(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/channels/test_twilio_voice.py#L183'>tests/core/channels/test_twilio_voice.py~L183</a></p>
<pre><code class="language-diff"> 
 
 async def test_twilio_voice_multiple_responses():
+
     inputs = {
         &quot;initial_prompt&quot;: &quot;hello&quot;,
         &quot;reprompt_fallback_phrase&quot;: &quot;i didn't get that&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/evaluation/test_marker.py#L651'>tests/core/evaluation/test_marker.py~L651</a></p>
<pre><code class="language-diff">     ],
 )
 def test_marker_from_path_adds_special_or_marker(tmp_path: Path, configs: Any):
+
     yaml_file = tmp_path / &quot;config.yml&quot;
     rasa.shared.utils.io.write_yaml(data=configs, target=yaml_file)
     loaded = Marker.from_path(tmp_path)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/evaluation/test_marker_stats.py#L258'>tests/core/evaluation/test_marker_stats.py~L258</a></p>
<pre><code class="language-diff"> 
 @pytest.mark.parametrize(&quot;seed&quot;, [2345, 5654, 2345234])
 def test_per_session_statistics_to_csv(tmp_path: Path, seed: int):
+
     rng = np.random.default_rng(seed=seed)
     (
         per_session_results,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/featurizers/test_precomputation.py#L497'>tests/core/featurizers/test_precomputation.py~L497</a></p>
<pre><code class="language-diff">     collector: CoreFeaturizationCollector,
     messages_with_unique_lookup_key: List[Message],
 ):
+
     messages = messages_with_unique_lookup_key
 
     # pass as training data
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/featurizers/test_single_state_featurizers.py#L418'>tests/core/featurizers/test_single_state_featurizers.py~L418</a></p>
<pre><code class="language-diff"> 
 
 def test_encode_entities__with_entity_roles_and_groups():
+
     # create fake message that has been tokenized and entities have been extracted
     text = &quot;I am flying from London to Paris&quot;
     tokens = [
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/featurizers/test_single_state_featurizers.py#L475'>tests/core/featurizers/test_single_state_featurizers.py~L475</a></p>
<pre><code class="language-diff"> 
 
 def test_encode_entities__with_bilou_entity_roles_and_groups():
+
     # Instantiate domain and configure the single state featurizer for this domain.
     # Note that there are 2 entity tags here.
     entity_tags = [&quot;city&quot;, f&quot;city{ENTITY_LABEL_SEPARATOR}to&quot;]
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/policies/test_ted_policy.py#L101'>tests/core/policies/test_ted_policy.py~L101</a></p>
<pre><code class="language-diff"> class TestTEDPolicy(PolicyTestCollection):
     @staticmethod
     def _policy_class_to_test() -&gt; Type[TEDPolicy]:
+
         return TEDPolicy
 
     def test_train_model_checkpointing(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/policies/test_unexpected_intent_policy.py#L56'>tests/core/policies/test_unexpected_intent_policy.py~L56</a></p>
<pre><code class="language-diff"> class TestUnexpecTEDIntentPolicy(TestTEDPolicy):
     @staticmethod
     def _policy_class_to_test() -&gt; Type[UnexpecTEDIntentPolicy]:
+
         return UnexpecTEDIntentPolicy
 
     @pytest.fixture(scope=&quot;class&quot;)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/policies/test_unexpected_intent_policy.py#L98'>tests/core/policies/test_unexpected_intent_policy.py~L98</a></p>
<pre><code class="language-diff">     def test_label_data_assembly(
         self, trained_policy: UnexpecTEDIntentPolicy, default_domain: Domain
     ):
+
         # Construct input data
         state_featurizer = trained_policy.featurizer.state_featurizer
         encoded_all_labels = state_featurizer.encode_all_labels(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/policies/test_unexpected_intent_policy.py#L846'>tests/core/policies/test_unexpected_intent_policy.py~L846</a></p>
<pre><code class="language-diff">             all_similarities: np.array,
             label_index: int,
         ):
+
             expected_score = all_similarities[0][label_index]
             expected_threshold = (
                 all_thresholds[label_index] if label_index in all_thresholds else None
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_actions.py#L787'>tests/core/test_actions.py~L787</a></p>
<pre><code class="language-diff"> 
 
 async def test_response_channel_specific(default_nlg, default_tracker, domain: Domain):
+
     output_channel = SlackBot(&quot;DummyToken&quot;, &quot;General&quot;)
 
     events = await ActionBotResponse(&quot;utter_channel&quot;).run(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_broker.py#L99'>tests/core/test_broker.py~L99</a></p>
<pre><code class="language-diff"> 
 
 async def test_pika_raise_connection_exception(monkeypatch: MonkeyPatch):
+
     monkeypatch.setattr(
         PikaEventBroker, &quot;connect&quot;, AsyncMock(side_effect=ChannelNotFoundEntity())
     )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_broker.py#L326'>tests/core/test_broker.py~L326</a></p>
<pre><code class="language-diff"> 
 
 async def test_create_pika_invalid_port():
+
     cfg = EndpointConfig(
         username=&quot;username&quot;, password=&quot;password&quot;, type=&quot;pika&quot;, port=&quot;PORT&quot;
     )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_nlg.py#L12'>tests/core/test_nlg.py~L12</a></p>
<pre><code class="language-diff"> 
 
 def nlg_app(base_url=&quot;/&quot;):
+
     app = Sanic(&quot;test_nlg&quot;)
 
     @app.route(base_url, methods=[&quot;POST&quot;])
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_policies.py#L424'>tests/core/test_policies.py~L424</a></p>
<pre><code class="language-diff">         default_domain: Domain,
         stories_path: Text,
     ):
+
         execution_context = dataclasses.replace(execution_context, is_finetuning=True)
         loaded_policy = MemoizationPolicy.load(
             trained_policy.config, model_storage, resource, execution_context
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_test.py#L198'>tests/core/test_test.py~L198</a></p>
<pre><code class="language-diff">     monkeypatch: MonkeyPatch,
     moodbot_domain_path: Path,
 ) -&gt; Callable[[Path, bool], Coroutine]:
+
     # We need `RulePolicy` to predict the correct actions
     # in a particular conversation context as seen during training.
     # Since it can get affected by `action_unlikely_intent` being triggered in
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/core/test_tracker_stores.py#L179'>tests/core/test_tracker_stores.py~L179</a></p>
<pre><code class="language-diff"> 
 
 def test_redis_tracker_store_invalid_key_prefix(domain: Domain):
+
     test_invalid_key_prefix = &quot;$$ &amp;!&quot;
 
     tracker_store = RedisTrackerStore(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/recipes/test_default_recipe.py#L593'>tests/engine/recipes/test_default_recipe.py~L593</a></p>
<pre><code class="language-diff"> 
 
 def test_dump_config_missing_file(tmp_path: Path, capsys: CaptureFixture):
+
     config_path = tmp_path / &quot;non_existent_config.yml&quot;
 
     config = rasa.shared.utils.io.read_config_file(str(SOME_CONFIG))
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/test_caching.py#L50'>tests/engine/test_caching.py~L50</a></p>
<pre><code class="language-diff">         model_storage: ModelStorage,
         output_fingerprint: Text,
     ) -&gt; &quot;TestCacheableOutput&quot;:
+
         value = rasa.shared.utils.io.read_json_file(directory / &quot;cached.json&quot;)
 
         return cls(value, cache_dir=directory)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/test_validation.py#L93'>tests/engine/test_validation.py~L93</a></p>
<pre><code class="language-diff">     language: Optional[Text] = None,
     is_train_graph: bool = True,
 ) -&gt; GraphModelConfiguration:
+
     parent_node = {}
     if parent:
         parent_node = {
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_components.py#L17'>tests/engine/training/test_components.py~L17</a></p>
<pre><code class="language-diff"> 
 
 def test_cached_component_returns_value_from_cache(default_model_storage: ModelStorage):
+
     cached_output = CacheableText(&quot;Cache me!!&quot;)
 
     node = GraphNode(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_components.py#L105'>tests/engine/training/test_components.py~L105</a></p>
<pre><code class="language-diff"> def test_fingerprint_component_hit(
     default_model_storage: ModelStorage, temp_cache: TrainingCache
 ):
+
     cached_output = CacheableText(&quot;Cache me!!&quot;)
     output_fingerprint = uuid.uuid4().hex
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_components.py#L159'>tests/engine/training/test_components.py~L159</a></p>
<pre><code class="language-diff"> def test_fingerprint_component_miss(
     default_model_storage: ModelStorage, temp_cache: TrainingCache
 ):
+
     component_config = {&quot;x&quot;: 1}
 
     node = GraphNode(
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_graph_trainer.py#L112'>tests/engine/training/test_graph_trainer.py~L112</a></p>
<pre><code class="language-diff">     train_with_schema: Callable,
     spy_on_all_components: Callable,
 ):
+
     input_file = tmp_path / &quot;input_file.txt&quot;
     input_file.write_text(&quot;3&quot;)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_graph_trainer.py#L212'>tests/engine/training/test_graph_trainer.py~L212</a></p>
<pre><code class="language-diff">     train_with_schema: Callable,
     spy_on_all_components: Callable,
 ):
+
     input_file = tmp_path / &quot;input_file.txt&quot;
     input_file.write_text(&quot;3&quot;)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_graph_trainer.py#L267'>tests/engine/training/test_graph_trainer.py~L267</a></p>
<pre><code class="language-diff">     train_with_schema: Callable,
     spy_on_all_components: Callable,
 ):
+
     input_file = tmp_path / &quot;input_file.txt&quot;
     input_file.write_text(&quot;3&quot;)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/engine/training/test_graph_trainer.py#L382'>tests/engine/training/test_graph_trainer.py~L382</a></p>
<pre><code class="language-diff">     train_with_schema: Callable,
     caplog: LogCaptureFixture,
 ):
+
     input_file = tmp_path / &quot;input_file.txt&quot;
     input_file.write_text(&quot;3&quot;)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/examples/test_example_bots_training_data.py#L65'>tests/examples/test_example_bots_training_data.py~L65</a></p>
<pre><code class="language-diff">     raise_slot_warning: bool,
     msg: Optional[Text],
 ):
+
     importer = TrainingDataImporter.load_from_config(
         config_file, domain_file, [data_folder]
     )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/graph_components/validators/test_default_recipe_validator.py#L705'>tests/graph_components/validators/test_default_recipe_validator.py~L705</a></p>
<pre><code class="language-diff"> def test_core_warn_if_data_but_no_policy(
     monkeypatch: MonkeyPatch, policy_type: Optional[Type[Policy]]
 ):
+
     importer = TrainingDataImporter.load_from_dict(
         domain_path=&quot;data/test_e2ebot/domain.yml&quot;,
         training_data_paths=[
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/graph_components/validators/test_default_recipe_validator.py#L838'>tests/graph_components/validators/test_default_recipe_validator.py~L838</a></p>
<pre><code class="language-diff"> def test_core_raise_if_a_rule_policy_is_incompatible_with_domain(
     monkeypatch: MonkeyPatch,
 ):
+
     domain = Domain.empty()
 
     num_instances = 2
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/graph_components/validators/test_default_recipe_validator.py#L883'>tests/graph_components/validators/test_default_recipe_validator.py~L883</a></p>
<pre><code class="language-diff">     num_duplicates: bool,
     priority: int,
 ):
+
     assert len(policy_types) &gt;= priority + num_duplicates, (
         f&quot;This tests needs at least {priority + num_duplicates} many types.&quot;
     )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/graph_components/validators/test_default_recipe_validator.py#L947'>tests/graph_components/validators/test_default_recipe_validator.py~L947</a></p>
<pre><code class="language-diff"> 
 @pytest.mark.parametrize(&quot;policy_type_consuming_rule_data&quot;, [RulePolicy])
 def test_core_warn_if_rule_data_missing(policy_type_consuming_rule_data: Type[Policy]):
+
     importer = TrainingDataImporter.load_from_dict(
         domain_path=&quot;data/test_e2ebot/domain.yml&quot;,
         training_data_paths=[
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/graph_components/validators/test_default_recipe_validator.py#L976'>tests/graph_components/validators/test_default_recipe_validator.py~L976</a></p>
<pre><code class="language-diff"> def test_core_warn_if_rule_data_unused(
     policy_type_not_consuming_rule_data: Type[Policy],
 ):
+
     importer = TrainingDataImporter.load_from_dict(
         domain_path=&quot;data/test_moodbot/domain.yml&quot;,
         training_data_paths=[
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/classifiers/test_diet_classifier.py#L132'>tests/nlu/classifiers/test_diet_classifier.py~L132</a></p>
<pre><code class="language-diff">         message_text: Text = &quot;Rasa is great!&quot;,
         expect_intent: bool = True,
     ) -&gt; Message:
+
         if not pipeline:
             pipeline = [
                 {&quot;component&quot;: WhitespaceTokenizer},
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/classifiers/test_regex_message_handler.py#L38'>tests/nlu/classifiers/test_regex_message_handler.py~L38</a></p>
<pre><code class="language-diff"> def test_process_does_not_do_anything(
     regex_message_handler: RegexMessageHandler, text: Text
 ):
+
     message = Message(
         data={TEXT: text, INTENT: &quot;bla&quot;},
         features=[
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/classifiers/test_regex_message_handler.py#L77'>tests/nlu/classifiers/test_regex_message_handler.py~L77</a></p>
<pre><code class="language-diff"> def test_regex_message_handler_adds_extractor_name(
     regex_message_handler: RegexMessageHandler, text: Text
 ):
+
     message = Message(
         data={TEXT: text, INTENT: &quot;bla&quot;},
         features=[
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/conftest.py#L39'>tests/nlu/conftest.py~L39</a></p>
<pre><code class="language-diff">     def inner(
         pipeline: List[Dict[Text, Any]], training_data: Union[Text, TrainingData]
     ) -&gt; Tuple[TrainingData, List[GraphComponent]]:
+
         if isinstance(training_data, str):
             importer = RasaFileImporter(training_data_paths=[training_data])
             training_data: TrainingData = importer.get_nlu_data()
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/conftest.py#L75'>tests/nlu/conftest.py~L75</a></p>
<pre><code class="language-diff"> @pytest.fixture()
 def process_message(default_model_storage: ModelStorage) -&gt; Callable[..., Message]:
     def inner(loaded_pipeline: List[GraphComponent], message: Message) -&gt; Message:
+
         for component in loaded_pipeline:
             component.process([message])
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/extractors/test_crf_entity_extractor.py#L132'>tests/nlu/extractors/test_crf_entity_extractor.py~L132</a></p>
<pre><code class="language-diff">     spacy_nlp_component: SpacyNLP,
     spacy_model: SpacyModel,
 ):
+
     crf_extractor = crf_entity_extractor(config_params)
 
     importer = RasaFileImporter(training_data_paths=[&quot;data/examples/rasa&quot;])
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/extractors/test_mitie_entity_extractor.py#L73'>tests/nlu/extractors/test_mitie_entity_extractor.py~L73</a></p>
<pre><code class="language-diff">     mitie_model: MitieModel,
     with_trainable_examples: bool,
 ):
+
     # some texts where last token is a city
     texts_ending_with_city = [&quot;Bert lives in Berlin&quot;, &quot;Ernie asks where is Bielefeld&quot;]
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/extractors/test_regex_entity_extractor.py#L278'>tests/nlu/extractors/test_regex_entity_extractor.py~L278</a></p>
<pre><code class="language-diff"> def test_process_does_not_overwrite_any_entities(
     create_or_load_extractor: Callable[..., RegexEntityExtractor],
 ):
+
     pre_existing_entity = {
         ENTITY_ATTRIBUTE_TYPE: &quot;person&quot;,
         ENTITY_ATTRIBUTE_VALUE: &quot;Max&quot;,
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_lexical_syntactic_featurizer.py#L235'>tests/nlu/featurizers/test_lexical_syntactic_featurizer.py~L235</a></p>
<pre><code class="language-diff">     resource_lexical_syntactic_featurizer: Resource,
     feature_config: List[Text],
 ) -&gt; Callable[..., LexicalSyntacticFeaturizer]:
+
     config = {&quot;alias&quot;: &quot;lsf&quot;, &quot;features&quot;: feature_config}
     featurizer = create_lexical_syntactic_featurizer(config)
 
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_lexical_syntactic_featurizer.py#L296'>tests/nlu/featurizers/test_lexical_syntactic_featurizer.py~L296</a></p>
<pre><code class="language-diff">     feature_config: Dict[Text, Any],
     expected_features: np.ndarray,
 ):
+
     featurizer = create_lexical_syntactic_featurizer(
         {&quot;alias&quot;: &quot;lsf&quot;, &quot;features&quot;: feature_config}
     )
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_lm_featurizer.py#L810'>tests/nlu/featurizers/test_lm_featurizer.py~L810</a></p>
<pre><code class="language-diff">         [Dict[Text, Any]], LanguageModelFeaturizer
     ],
 ):
+
     config = {&quot;model_name&quot;: &quot;bert&quot;, &quot;model_weights&quot;: &quot;bert-base-chinese&quot;}
 
     lm_featurizer = create_language_model_featurizer(config)
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_mitie_featurizer.py#L57'>tests/nlu/featurizers/test_mitie_featurizer.py~L57</a></p>
<pre><code class="language-diff">     mitie_model: MitieModel,
     mitie_tokenizer: MitieTokenizer,
 ):
+
     featurizer = create({&quot;alias&quot;: &quot;mitie_featurizer&quot;})
 
     sentence = &quot;Hey how are you today&quot;
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_mitie_featurizer.py#L83'>tests/nlu/featurizers/test_mitie_featurizer.py~L83</a></p>
<pre><code class="language-diff">     mitie_model: MitieModel,
     mitie_tokenizer: MitieTokenizer,
 ):
+
     featurizer = create({&quot;alias&quot;: &quot;mitie_featurizer&quot;})
 
     sentence = &quot;Hey how are you today&quot;
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_regex_featurizer.py#L302'>tests/nlu/featurizers/test_regex_featurizer.py~L302</a></p>
<pre><code class="language-diff">     create_featurizer: Callable[..., RegexFeaturizer],
     spacy_tokenizer: SpacyTokenizer,
 ):
+
     patterns = [
         {&quot;pattern&quot;: &quot;[0-9]+&quot;, &quot;name&quot;: &quot;number&quot;, &quot;usage&quot;: &quot;intent&quot;},
         {&quot;pattern&quot;: &quot;\\bhey*&quot;, &quot;name&quot;: &quot;hello&quot;, &quot;usage&quot;: &quot;intent&quot;},
</code></pre>
<p><a href='https://github.com/RasaHQ/rasa/blob/c4069568b4fe2adb5d5a1e55d17ce8cb9dda27fc/tests/nlu/featurizers/test_regex_featurizer.py#L398'>tests/nlu/featurizers/test_regex_featurizer.py~L398</a></p>
<pre><code class="language-diff">     create_featurizer: Callable[..., R

... (truncated 3188 lines) ...

</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-19 21:36:25 UTC
    </footer>
</body>
</html>
