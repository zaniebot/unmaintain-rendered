<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for `NoReturn` in auto-return-typing - astral-sh/ruff #9206</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for <code>NoReturn</code> in auto-return-typing</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9206">#9206</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-12-20 04:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body">Summary
<p>Given a function like:</p>
<pre><code>def func(x: int):
    if not x:
        raise ValueError
    else:
        raise TypeError
</code></pre>
<p>We now correctly use <code>NoReturn</code> as the return type, rather than <code>None</code>.</p>
<p>Closes <a href="https://github.com/astral-sh/ruff/issues/9201">astral-sh/ruff#9201</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Add support for NoReturn in auto-return-typing&quot; to &quot;Add support for `NoReturn` in auto-return-typing&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-20 04:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-20 04:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-20 05:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-20 05:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-12-20 05:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-12-20 05:13</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
Formatter (stable)
<p>✅ ecosystem check detected no format changes.</p>
Formatter (preview)
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tooruu">@tooruu</a> on 2023-12-20 13:46</div>
            <div class="timeline-body"><p>Does this use <code>typing.Never</code> in Python 3.11+?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/max-muoto">@max-muoto</a> on 2023-12-20 21:31</div>
            <div class="timeline-body"><blockquote>
<p>Does this use <code>typing.Never</code> in Python 3.11+?</p>
</blockquote>
<p>They&#x27;re effectively identical in regards to type-checkers. Pyright (for Python 3.11+) <a href="https://pyright-play.net/?code=CYUwZgBGCuB2DGAKAHgLggS1gFwJSoCgJjNJYB7bCNIkugJwEMMBnECANUYBtoQBRevXL1axENzaE6DZmwgAVAJ4AHAUJFA">infers the correct return type for a function like the one given in the example as <code>NoReturn</code></a>. <code>typing.Never</code> is used as a bottom type in situations like this:</p>
<pre><code>def int_or_str(arg: int | str) -&gt; None:
    never_call_me(arg)  # type checker error
    match arg:
        case int():
            print(&quot;It&#x27;s an int&quot;)
        case str():
            print(&quot;It&#x27;s a str&quot;)
        case _: # type checkers considers this unreachable
            never_call_me(arg)  # Pyright would say `arg` is of type `Never`.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tooruu">@tooruu</a> on 2023-12-22 06:53</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Does this use <code>typing.Never</code> in Python 3.11+?</p>
</blockquote>
<p>They&#x27;re effectively identical in regards to type-checkers. Pyright (for Python 3.11+) <a href="https://pyright-play.net/?code=CYUwZgBGCuB2DGAKAHgLggS1gFwJSoCgJjNJYB7bCNIkugJwEMMBnECANUYBtoQBRevXL1axENzaE6DZmwgAVAJ4AHAUJFA">infers the correct return type for a function like the one given in the example as <code>NoReturn</code></a>. <code>typing.Never</code> is used as a bottom type in situations like this:</p>
<pre><code>def int_or_str(arg: int | str) -&gt; None:
    never_call_me(arg)  # type checker error
    match arg:
        case int():
            print(&quot;It&#x27;s an int&quot;)
        case str():
            print(&quot;It&#x27;s a str&quot;)
        case _: # type checkers considers this unreachable
            never_call_me(arg)  # Pyright would say `arg` is of type `Never`.
</code></pre>
</blockquote>
<p><a href="https://docs.python.org/3/library/typing.html#typing.Never">Official Python docs</a> state that starting in 3.11 <code>typing.Never</code> should be used instead of <code>typing.NoReturn</code>. Looks like this has been addressed by #9213.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:00:06 UTC
    </footer>
</body>
</html>
