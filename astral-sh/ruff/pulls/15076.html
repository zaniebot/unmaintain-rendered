<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Adds an allowlist for `unsafe-markup-use` (`RUF035`) - astral-sh/ruff #15076</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Adds an allowlist for <code>unsafe-markup-use</code> (<code>RUF035</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15076">#15076</a>
        opened by <a href="https://github.com/Daverball">@Daverball</a>
        on 2024-12-20 08:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/Daverball">@Daverball</a> on 2024-12-20 08:25</div>
            <div class="timeline-body"><p>Closes: #14523</p>
<h2>Summary</h2>
<p>Adds a whitelist of calls allowed to be used within a <code>markupsafe.Markup</code> call.</p>
<h2>Test Plan</h2>
<p><code>cargo nextest run</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Daverball">@Daverball</a> on <code>crates/ruff_linter/resources/test/fixtures/ruff/RUF035_whitelisted_markup_calls.py</code>:9 on 2024-12-20 08:28</div>
            <div class="timeline-body"><p>I considered making this work. But then we should probably also make the same thing work with string/bytes literals. At which point I would have to change some of the examples, so they still make sense. So I held off for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Daverball">@Daverball</a> reviewed on 2024-12-20 08:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-12-20 08:31</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-20 08:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_workspace/src/options.rs</code>:3128 on 2024-12-20 08:40</div>
            <div class="timeline-body"><p>Should we use <code>allowed_markup_calls</code> instead to be consistent with other settings name?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @dhruvmanila on 2024-12-20 08:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`ruff`] Adds a whitelist for `unsafe-markup-use`." to "[`ruff`] Adds an allowlist for `unsafe-markup-use`." by @MichaReiser on 2024-12-20 08:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-20 09:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/resources/test/fixtures/ruff/RUF035_whitelisted_markup_calls.py</code>:9 on 2024-12-20 09:06</div>
            <div class="timeline-body"><p>I think it's fine for now to limit this to only direct calls.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-20 09:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_workspace/src/options.rs</code>:3122 on 2024-12-20 09:11</div>
            <div class="timeline-body"><p>I think these will need to be surrounded by backticks as the references are otherwise it won't be recognized (I think).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Daverball">@Daverball</a> reviewed on 2024-12-20 09:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Daverball">@Daverball</a> on <code>crates/ruff_workspace/src/options.rs</code>:3122 on 2024-12-20 09:17</div>
            <div class="timeline-body"><p>Looks like you're right, this is already broken in the other setting, which has the same mistake: https://docs.astral.sh/ruff/settings/#lint_ruff_extend-markup-names</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-20 09:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_workspace/src/options.rs</code>:3122 on 2024-12-20 09:17</div>
            <div class="timeline-body"><p>Ok, adding backticks doesn't work (not sure why), you might need to inline the links via <code>[hello](link)</code> method.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Daverball">@Daverball</a> reviewed on 2024-12-20 09:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Daverball">@Daverball</a> on <code>crates/ruff_workspace/src/options.rs</code>:3122 on 2024-12-20 09:23</div>
            <div class="timeline-body"><p>Interesting that none of the CI docs jobs catch this. Seems like an easy mistake to detect statically, but maybe there's something subtle at play, which would result in false positives in other cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-20 09:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_workspace/src/options.rs</code>:3122 on 2024-12-20 09:27</div>
            <div class="timeline-body"><p>It might be something related to mkdocs-material rendering which doesn't allow this, you might need to inline the links.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-12-20 09:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`ruff`] Adds an allowlist for `unsafe-markup-use`." to "[`ruff`] Adds an allowlist for `unsafe-markup-use` (`RUF035`)" by @dhruvmanila on 2024-12-20 09:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Daverball">@Daverball</a> reviewed on 2024-12-20 09:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Daverball">@Daverball</a> on <code>crates/ruff_workspace/src/options.rs</code>:3122 on 2024-12-20 09:28</div>
            <div class="timeline-body"><p>Right, I think the docs for <code>options.rs</code> are a bit special, so a lot of the regular docs stuff doesn't work. You also can't reference other rules by name and instead have to manually link the anchor.</p>
<p>The reference works fine with or without backticks in the rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dhruvmanila on 2024-12-20 09:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-12-20 09:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-12-20 09:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 20:42:57 UTC
    </footer>
</body>
</html>
