<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Indented form feeds (`RUF054`) - astral-sh/ruff #16049</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Indented form feeds (<code>RUF054</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16049">#16049</a>
        opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a>
        on 2025-02-09 00:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-02-09 00:39</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Resolves #12321.</p>
<p>The physical-line-based <code>RUF054</code> checks for form feed characters that are preceded by only tabs and spaces, but not any other characters, including form feeds.</p>
<h2>Test Plan</h2>
<p><code>cargo nextest run</code> and <code>cargo insta test</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-02-09 00:45</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/mod.rs</code>:539 on 2025-02-09 02:14</div>
            <div class="timeline-body"><p>This might be a good use for <code>test_case</code> like some of the other tests up above, if these don't get moved into a <code>.py</code> file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/indented_form_feed.rs</code>:12 on 2025-02-09 02:16</div>
            <div class="timeline-body"><p>nit: it might be nice to have a link to the reference here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/indented_form_feed.rs</code>:22 on 2025-02-09 02:20</div>
            <div class="timeline-body"><p>Does this render properly in the docs? I could imagine both of these just looking like</p>
<pre><code class="language-python">if foo():
    bar()
</code></pre>
<p>but I haven't checked myself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/indented_form_feed.rs</code>:64 on 2025-02-09 02:37</div>
            <div class="timeline-body"><p>I guess you could use <code>memchr</code> again for <code>SPACE</code> and <code>TAB</code> and compare the indices to <code>index_relative_to_line</code>, but this is probably fine too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/mod.rs</code>:537 on 2025-02-09 02:50</div>
            <div class="timeline-body"><p>Emacs might be the outlier here, but it's quite easy for me to insert form feed characters. If it wouldn't be too much hassle in other editors (and thus for other contributors), it might be nice to have some normal snapshot tests instead of, or at least in addition to, these. We're not currently testing the actual diagnostic output, for example.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/registry.rs</code>:261 on 2025-02-09 02:52</div>
            <div class="timeline-body"><p>very small nit: I think these were sorted in alphabetical order before, so <code>IndentedFormFeed</code> would need to move up under <code>DocLineTooLong</code> to preserve that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-02-09 02:55</div>
            <div class="timeline-body"><p>Looks good, thanks! I have a few nits and one slightly larger question/suggestion about the tests, but overall this looks good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-02-09 03:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/ruff/rules/indented_form_feed.rs</code>:22 on 2025-02-09 03:20</div>
            <div class="timeline-body"><p>It does. We are talking three different flavors here, but consider GFM:</p>
<blockquote>
<pre><code class="language-python">if foo():\n    \fbar()
</code></pre>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-02-09 03:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/ruff/rules/indented_form_feed.rs</code>:64 on 2025-02-09 03:20</div>
            <div class="timeline-body"><p>I don't think the first index of a space or tab says anything. For example, <code>def f():\n\tpass \f</code> is not an error, even though <code>\f</code> is preceded by a space and both of them are placed on a tab-indented line.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-02-09 03:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/ruff/mod.rs</code>:537 on 2025-02-09 03:20</div>
            <div class="timeline-body"><blockquote>
<p><a href="https://xkcd.com/378/">Dammit, Emacs.</a></p>
</blockquote>
<hr />
<p><code>\f</code> is not normally visible, so such a file would either trip up the CI checks or that of the editors. I can try, though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-02-09 16:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/indented_form_feed.rs</code>:64 on 2025-02-09 16:49</div>
            <div class="timeline-body"><p>Oh I see now, I guess I ignored the <code>!=</code> checks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-02-09 17:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/mod.rs</code>:537 on 2025-02-09 17:19</div>
            <div class="timeline-body"><blockquote>
<p>Dammit, Emacs.</p>
</blockquote>
<p>:laughing:</p>
<p>Well it's definitely unfortunate that these are completely invisible on GitHub, but I like seeing the diagnostics and reusing the other test code. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-02-09 17:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-02-10 00:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-02-10 00:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-02-10 00:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dhruvmanila on 2025-02-10 12:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @dhruvmanila on 2025-02-10 12:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 19:57:52 UTC
    </footer>
</body>
</html>
