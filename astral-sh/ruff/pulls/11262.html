<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pyflakes`] Treat `if TYPE_CHECKING` blocks like stub files for F821 - astral-sh/ruff #11262</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pyflakes</code>] Treat <code>if TYPE_CHECKING</code> blocks like stub files for F821</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11262">#11262</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-05-03 12:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-05-03 12:45</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Fixes #11245.</p>
<p><code>if TYPE_CHECKING</code> blocks, like stub files, are never executed at runtime -- so I think it makes sense to give them stub-file semantics when it comes to whether forward references are or aren't permitted. Currently we allow forward references in stub files on the r.h.s. of type alias definitions and in class bases; this PR implements the same logic for <code>if TYPE_CHECKING</code> blocks.</p>
<h2>Test Plan</h2>
<p><code>cargo test</code> / <code>cargo insta review</code>. Two fixtures have been extended.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @AlexWaygood on 2024-05-03 12:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @AlexWaygood on 2024-05-03 12:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`pyflakes`] Treat `if `TYPE_CHECKING` blocks like stub files for F821" to "[`pyflakes`] Treat `if TYPE_CHECKING` blocks like stub files for F821" by @AlexWaygood on 2024-05-03 12:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @AlexWaygood on 2024-05-03 12:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">linter</span> added by @AlexWaygood on 2024-05-03 12:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-05-03 12:48</div>
            <div class="timeline-body"><p>Type definitions created in <code>if TYPE_CHECKING</code> blocks obviously won't be available at runtime. If you want to use them elsewhere in the file, you'll either need to quote the definition or (if you only need to use it in an annotation context) put <code>from __future__ import annotations</code> at the top of the file. Possibly we could have an additional lint checking that the user does that, but I think it's out of scope of this PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-05-03 12:57</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+47 -0 violations, +0 -0 fixes in 7 projects; 37 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+28 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L53'>airflow/executors/base_executor.py:53:19:</a> UP006 Use `list` instead of `List` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L59'>airflow/executors/base_executor.py:59:30:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L59'>airflow/executors/base_executor.py:59:54:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L63'>airflow/executors/base_executor.py:63:28:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L63'>airflow/executors/base_executor.py:63:34:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L66'>airflow/executors/base_executor.py:66:17:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L66'>airflow/executors/base_executor.py:66:53:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L66'>airflow/executors/base_executor.py:66:68:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/local_executor.py#L56'>airflow/executors/local_executor.py:56:24:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/local_executor.py#L56'>airflow/executors/local_executor.py:56:30:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/local_executor.py#L56'>airflow/executors/local_executor.py:56:57:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/models/mappedoperator.py#L90'>airflow/models/mappedoperator.py:90:39:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/models/mappedoperator.py#L90'>airflow/models/mappedoperator.py:90:76:</a> UP006 Use `list` instead of `List` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor.py#L98'>airflow/providers/celery/executors/celery_executor.py:98:28:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor.py#L98'>airflow/providers/celery/executors/celery_executor.py:98:64:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor_utils.py#L62'>airflow/providers/celery/executors/celery_executor_utils.py:62:28:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor_utils.py#L62'>airflow/providers/celery/executors/celery_executor_utils.py:62:64:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L28'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:28:25:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L28'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:28:66:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L31'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:31:29:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L31'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:31:52:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L31'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:31:61:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:27:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:43:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:52:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:84:</a> UP006 Use `dict` instead of `Dict` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/microsoft/azure/hooks/cosmos.py#L47'>airflow/providers/microsoft/azure/hooks/cosmos.py:47:24:</a> UP007 Use `X | Y` for type annotations
... 1 additional changes omitted for rule UP007
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/microsoft/azure/hooks/cosmos.py#L47'>airflow/providers/microsoft/azure/hooks/cosmos.py:47:35:</a> UP006 Use `list` instead of `List` for type annotation
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+8 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L98'>src/bokeh/core/has_props.py:98:25:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/document/events.py#L122'>src/bokeh/document/events.py:122:26:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/sources.py#L87'>src/bokeh/models/sources.py:87:37:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/sources.py#L89'>src/bokeh/models/sources.py:89:24:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/sources.py#L89'>src/bokeh/models/sources.py:89:48:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/contour.py#L42'>src/bokeh/plotting/contour.py:42:31:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/contour.py#L43'>src/bokeh/plotting/contour.py:43:40:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/transform.py#L71'>src/bokeh/transform.py:71:26:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/latchbio/latch">latchbio/latch</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/latchbio/latch/blob/5e86e61c29234cb4fe0cc79410a352e8c225b0b9/latch/ldata/_transfer/upload.py#L31'>latch/ldata/_transfer/upload.py:31:39:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/latchbio/latch/blob/5e86e61c29234cb4fe0cc79410a352e8c225b0b9/latch/ldata/_transfer/upload.py#L32'>latch/ldata/_transfer/upload.py:32:42:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pypa/cibuildwheel">pypa/cibuildwheel</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/pypa/cibuildwheel/blob/98d57d9547203fa3b5676ef6960d639989295cf8/cibuildwheel/typing.py#L19'>cibuildwheel/typing.py:19:17:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python/mypy">python/mypy</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/python/mypy/blob/fb31409b392c5533b25173705d62ed385ee39cfb/mypyc/build.py#L58'>mypyc/build.py:58:32:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python-poetry/poetry">python-poetry/poetry</a> (+6 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/repositories/link_sources/base.py#L26'>src/poetry/repositories/link_sources/base.py:26:17:</a> UP006 Use `collections.defaultdict` instead of `DefaultDict` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/repositories/link_sources/base.py#L26'>src/poetry/repositories/link_sources/base.py:26:45:</a> UP006 Use `collections.defaultdict` instead of `DefaultDict` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/repositories/link_sources/base.py#L26'>src/poetry/repositories/link_sources/base.py:26:66:</a> UP006 Use `list` instead of `List` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/tests/inspection/test_lazy_wheel.py#L31'>tests/inspection/test_lazy_wheel.py:31:25:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/tests/inspection/test_lazy_wheel.py#L31'>tests/inspection/test_lazy_wheel.py:31:36:</a> UP006 Use `dict` instead of `Dict` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/tests/inspection/test_lazy_wheel.py#L33'>tests/inspection/test_lazy_wheel.py:33:33:</a> UP006 Use `dict` instead of `Dict` for type annotation
</pre>

</p>
</details>
<details><summary><a href="https://github.com/scikit-build/scikit-build-core">scikit-build/scikit-build-core</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/scikit-build/scikit-build-core/blob/f6ed5a28fc85e621b03d984011d17def888ee0db/src/scikit_build_core/_compat/importlib/metadata.py#L20'>src/scikit_build_core/_compat/importlib/metadata.py:20:23:</a> UP006 Use `list` instead of `typing.List` for type annotation
</pre>

</p>
</details>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| UP007 | 27 | 27 | 0 | 0 | 0 |
| UP006 | 20 | 20 | 0 | 0 | 0 |</p>
</p>
</details>

<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+47 -0 violations, +0 -0 fixes in 7 projects; 37 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+28 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L53'>airflow/executors/base_executor.py:53:19:</a> UP006 Use `list` instead of `List` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L59'>airflow/executors/base_executor.py:59:30:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L59'>airflow/executors/base_executor.py:59:54:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L63'>airflow/executors/base_executor.py:63:28:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L63'>airflow/executors/base_executor.py:63:34:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L66'>airflow/executors/base_executor.py:66:17:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L66'>airflow/executors/base_executor.py:66:53:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/base_executor.py#L66'>airflow/executors/base_executor.py:66:68:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/local_executor.py#L56'>airflow/executors/local_executor.py:56:24:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/local_executor.py#L56'>airflow/executors/local_executor.py:56:30:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/executors/local_executor.py#L56'>airflow/executors/local_executor.py:56:57:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/models/mappedoperator.py#L90'>airflow/models/mappedoperator.py:90:39:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/models/mappedoperator.py#L90'>airflow/models/mappedoperator.py:90:76:</a> UP006 Use `list` instead of `List` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor.py#L98'>airflow/providers/celery/executors/celery_executor.py:98:28:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor.py#L98'>airflow/providers/celery/executors/celery_executor.py:98:64:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor_utils.py#L62'>airflow/providers/celery/executors/celery_executor_utils.py:62:28:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/celery/executors/celery_executor_utils.py#L62'>airflow/providers/celery/executors/celery_executor_utils.py:62:64:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L28'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:28:25:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L28'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:28:66:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L31'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:31:29:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L31'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:31:52:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L31'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:31:61:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:27:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:43:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:52:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py#L34'>airflow/providers/cncf/kubernetes/executors/kubernetes_executor_types.py:34:84:</a> UP006 Use `dict` instead of `Dict` for type annotation
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/microsoft/azure/hooks/cosmos.py#L47'>airflow/providers/microsoft/azure/hooks/cosmos.py:47:24:</a> UP007 Use `X | Y` for type annotations
... 1 additional changes omitted for rule UP007
+ <a href='https://github.com/apache/airflow/blob/a61f393ec4361499fcef9f2854668db85b852ec0/airflow/providers/microsoft/azure/hooks/cosmos.py#L47'>airflow/providers/microsoft/azure/hooks/cosmos.py:47:35:</a> UP006 Use `list` instead of `List` for type annotation
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+8 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L98'>src/bokeh/core/has_props.py:98:25:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/document/events.py#L122'>src/bokeh/document/events.py:122:26:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/sources.py#L87'>src/bokeh/models/sources.py:87:37:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/sources.py#L89'>src/bokeh/models/sources.py:89:24:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/sources.py#L89'>src/bokeh/models/sources.py:89:48:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/contour.py#L42'>src/bokeh/plotting/contour.py:42:31:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/contour.py#L43'>src/bokeh/plotting/contour.py:43:40:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/transform.py#L71'>src/bokeh/transform.py:71:26:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/latchbio/latch">latchbio/latch</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/latchbio/latch/blob/5e86e61c29234cb4fe0cc79410a352e8c225b0b9/latch/ldata/_transfer/upload.py#L31'>latch/ldata/_transfer/upload.py:31:39:</a> UP007 Use `X | Y` for type annotations
+ <a href='https://github.com/latchbio/latch/blob/5e86e61c29234cb4fe0cc79410a352e8c225b0b9/latch/ldata/_transfer/upload.py#L32'>latch/ldata/_transfer/upload.py:32:42:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pypa/cibuildwheel">pypa/cibuildwheel</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pypa/cibuildwheel/blob/98d57d9547203fa3b5676ef6960d639989295cf8/cibuildwheel/typing.py#L19'>cibuildwheel/typing.py:19:17:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python/mypy">python/mypy</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/python/mypy/blob/fb31409b392c5533b25173705d62ed385ee39cfb/mypyc/build.py#L58'>mypyc/build.py:58:32:</a> UP007 Use `X | Y` for type annotations
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python-poetry/poetry">python-poetry/poetry</a> (+6 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/repositories/link_sources/base.py#L26'>src/poetry/repositories/link_sources/base.py:26:17:</a> UP006 Use `collections.defaultdict` instead of `DefaultDict` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/repositories/link_sources/base.py#L26'>src/poetry/repositories/link_sources/base.py:26:45:</a> UP006 Use `collections.defaultdict` instead of `DefaultDict` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/repositories/link_sources/base.py#L26'>src/poetry/repositories/link_sources/base.py:26:66:</a> UP006 Use `list` instead of `List` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/tests/inspection/test_lazy_wheel.py#L31'>tests/inspection/test_lazy_wheel.py:31:25:</a> UP006 Use `tuple` instead of `Tuple` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/tests/inspection/test_lazy_wheel.py#L31'>tests/inspection/test_lazy_wheel.py:31:36:</a> UP006 Use `dict` instead of `Dict` for type annotation
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/tests/inspection/test_lazy_wheel.py#L33'>tests/inspection/test_lazy_wheel.py:33:33:</a> UP006 Use `dict` instead of `Dict` for type annotation
</pre>

</p>
</details>
<details><summary><a href="https://github.com/scikit-build/scikit-build-core">scikit-build/scikit-build-core</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/scikit-build/scikit-build-core/blob/f6ed5a28fc85e621b03d984011d17def888ee0db/src/scikit_build_core/_compat/importlib/metadata.py#L20'>src/scikit_build_core/_compat/importlib/metadata.py:20:23:</a> UP006 Use `list` instead of `typing.List` for type annotation
</pre>

</p>
</details>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| UP007 | 27 | 27 | 0 | 0 | 0 |
| UP006 | 20 | 20 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_linter/resources/test/fixtures/pyflakes/F821_27.py</code>:52 on 2024-05-03 14:49</div>
            <div class="timeline-body"><p>This file says at the top that it is for &quot;Tests for constructs allowed when <code>__future__</code> annotations are enabled but not otherwise&quot;&quot;&quot;</p>
<p>The added tests here are all independent of <code>__future__</code> annotations.</p>
<p>Should these tests not be in this file, or should the docstring of this file be updated?</p>
<p>I can see that we may want to just for completeness test various behaviors with and without <code>__future__.annotations</code>, even if they shouldn't be affected by it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_python_semantic/src/model.rs</code>:1591 on 2024-05-03 18:41</div>
            <div class="timeline-body"><p>Why not use <code>in_typing_only_block</code> that you added in this PR? Currently it's only used in a debug assertion, but it seems like it's equivalent to this line?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_linter/src/checkers/ast/mod.rs</code>:2011 on 2024-05-03 18:42</div>
            <div class="timeline-body"><p>Curious if you've looked at other uses of <code>future_annotations_or_stub</code> -- is there any use of it that we <em>wouldn't</em> want to apply also in a type checking block?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_python_semantic/src/model.rs</code>:1596 on 2024-05-03 18:44</div>
            <div class="timeline-body"><p>looks like there isn't a <code>self.future_annotations()</code>, maybe there should be?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> approved on 2024-05-03 18:44</div>
            <div class="timeline-body"><p>Looks good!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-05-03 20:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_python_semantic/src/model.rs</code>:1591 on 2024-05-03 20:33</div>
            <div class="timeline-body"><p>oops, I think I just added the <code>in_typing_only_block()</code> after I added this bit</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_python_semantic/src/model.rs</code>:1596 on 2024-05-03 20:40</div>
            <div class="timeline-body"><p>I worry that it's a <em>bit</em> of a footgun, as there aren't really very many situations where you want to be able to differentiate between <code>.py</code> files with <code>from __future__ import annotations</code> and stub files, and it's pretty easy to forget that you need to use <code>self.future_annotations_or_stub()</code> rather than <code>self.future_annotations()</code>. It's for those reasons that I... removed our previous <code>self.future_annotations()</code> method in https://github.com/astral-sh/ruff/commit/1dc93107dce911a535bdd9ac0d918f8052b7e326 üòÑ but, I'll add it back</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-05-03 20:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @AlexWaygood on 2024-05-03 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @AlexWaygood on 2024-05-04 17:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-05-05 07:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/checkers/ast/mod.rs</code>:2068 on 2024-05-05 07:50</div>
            <div class="timeline-body"><p>I think honestly PYI020 is a better fit for stub files and <code>if TYPE_CHECKING</code> blocks, so the logic here should probably be changed. But for now I'm just maintaining compatibility with previous versions of Ruff, which emitted this lint on annotations in stub files as well as annotations in <code>.py</code> files. Abruptly reducing the scope of the rule like that would maybe be slightly backwards-incompatible; it at least should be considered in a separate PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @AlexWaygood on 2024-05-05 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Skylion007">@Skylion007</a> reviewed on 2024-05-11 14:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Skylion007">@Skylion007</a> on <code>crates/ruff_linter/resources/test/fixtures/pyflakes/F821_26.py</code>:46 on 2024-05-11 14:50</div>
            <div class="timeline-body"><p>Can we a test for if there is code in an else block after the TYPE_CHECKING? That shouldn't be treated a stub, right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-05-11 14:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/resources/test/fixtures/pyflakes/F821_26.py</code>:46 on 2024-05-11 14:54</div>
            <div class="timeline-body"><p>Sure, I can add a test for that.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:05:57 UTC
    </footer>
</body>
</html>
