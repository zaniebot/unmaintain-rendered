<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Treat functions, methods, and dynamic types as function-like `Callable`s - astral-sh/ruff #20842</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Treat functions, methods, and dynamic types as function-like <code>Callable</code>s</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/20842">#20842</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-10-13 12:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a></div>
            <div class="timeline-body">Summary
<p>Treat functions, methods, and dynamic types as function-like <code>Callable</code>s</p>
<p>closes <a href="https://github.com/astral-sh/ty/issues/1342">astral-sh/ty#1342</a>
closes <a href="https://github.com/astral-sh/ty/issues/1344">astral-sh/ty#1344</a></p>
Ecosystem analysis
<p>All removed diagnostics look like cases of <a href="https://github.com/astral-sh/ty/issues/1344">astral-sh/ty#1344</a></p>
Test Plan
<p>Added regression test</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[ty] Treat functions, methods, and dynamic types as function-like Cal‚Ä¶&quot; to &quot;[ty] Treat functions, methods, and dynamic types as function-like `Callable`s&quot; by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-13 12:23</div>
            <div class="timeline-body">

Diagnostic diff on <a href="https://github.com/python/typing/tree/d4f39b27a4a47aac8b6d4019e1b0b5b3156fabdc/conformance">typing conformance tests</a>
<p>No changes detected when running ty on typing conformance tests ‚úÖ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-13 12:24</div>
            <div class="timeline-body">

<code>mypy_primer</code> results

Changes were detected when running on open source projects

<pre><code>attrs (https://github.com/python-attrs/attrs)
- src/attr/validators.py:175:31: error[unresolved-attribute] Type `(Overload[(pattern: str | Pattern[str], string: str, flags: Unknown = int) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: @Todo, flags: Unknown = int) -&gt; Match[bytes] | None]) &amp; ~AlwaysFalsy` has no attribute `__name__`
- tests/test_validators.py:870:13: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((val: _T@lt) -&gt; @Todo) | ((val: _T@le) -&gt; @Todo) | ((val: _T@ge) -&gt; @Todo) | ((val: _T@gt) -&gt; @Todo)` may be missing
- Found 561 diagnostics
+ Found 559 diagnostics

spack (https://github.com/spack/spack)
- lib/spack/spack/vendor/attr/validators.py:186:31: error[unresolved-attribute] Type `(Overload[(pattern: str | Pattern[str], string: str, flags: Unknown = int) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: @Todo, flags: Unknown = int) -&gt; Match[bytes] | None]) &amp; ~AlwaysFalsy` has no attribute `__name__`
- Found 7521 diagnostics
+ Found 7520 diagnostics

mitmproxy (https://github.com/mitmproxy/mitmproxy)
- examples/contrib/block_dns_over_https.py:357:19: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((flow) -&gt; Unknown)` may be missing
- Found 1843 diagnostics
+ Found 1842 diagnostics

vision (https://github.com/pytorch/vision)
- test/test_transforms_v2.py:6756:40: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((inpt: Unknown) -&gt; Unknown) | ((inpt: Unknown) -&gt; int) | ((pic, mode=None) -&gt; Unknown) | ((inpt: Unknown, displacement: Unknown, interpolation: InterpolationMode | int = InterpolationMode, fill: @Todo = None) -&gt; Unknown)` may be missing
- Found 1482 diagnostics
+ Found 1481 diagnostics

openlibrary (https://github.com/internetarchive/openlibrary)
- openlibrary/records/driver.py:61:36: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((params) -&gt; Unknown)` may be missing
- Found 849 diagnostics
+ Found 848 diagnostics

jax (https://github.com/google/jax)
- jax/experimental/jax2tf/tests/primitives_test.py:146:30: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((x: @Todo, y: @Todo, /) -&gt; Array)` may be missing
- Found 2427 diagnostics
+ Found 2426 diagnostics

sympy (https://github.com/sympy/sympy)
- sympy/benchmarks/bench_symbench.py:134:31: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | (() -&gt; Unknown)` may be missing
- Found 14028 diagnostics
+ Found 14027 diagnostics

materialize (https://github.com/MaterializeInc/materialize)
- test/aws/mzcompose.py:109:34: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((c: Unknown, ctx: TestContext) -&gt; Unknown)` may be missing
- Found 3387 diagnostics
+ Found 3386 diagnostics

scipy (https://github.com/scipy/scipy)
- scipy/optimize/tests/test_zeros.py:539:43: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((f, a, b, args=tuple[()], xtol=float, rtol=Unknown, maxiter=int, full_output=bool, disp=bool) -&gt; Unknown)` may be missing
- scipy/signal/tests/test_filter_design.py:4131:16: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((N, Wn, btype=str, analog=bool, output=str, norm=str, fs=None) -&gt; Unknown) | ((N, Wn, btype=str, analog=bool, output=str, fs=None) -&gt; Unknown) | ... omitted 3 union elements` may be missing
- scipy/signal/tests/test_windows.py:798:25: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((M, *, sym=bool, xp=None, device=None) -&gt; Unknown) | ((M, at, sym=bool, *, xp=None, device=None) -&gt; Unknown) | ... omitted 6 union elements` may be missing
- scipy/sparse/_base.py:676:55: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((a: @Todo, b: @Todo, /) -&gt; Any)` may be missing
- scipy/special/_precompute/gammainc_data.py:117:36: warning[possibly-missing-attribute] Attribute `__name__` on type `Unknown | ((a, x, dps=int, maxterms=int) -&gt; Unknown)` may be missing
- Found 6861 diagnostics
+ Found 6856 diagnostics

</code></pre>

No memory usage changes detected ‚úÖ

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-13 12:31</div>
            <div class="timeline-body">

<code>ecosystem-analyzer</code> results
<p>| Lint rule | Added | Removed | Changed |
|-----------|------:|--------:|--------:|
| <code>possibly-missing-attribute</code> | 0 | 12 | 0 |
| <code>unresolved-attribute</code> | 0 | 2 | 0 |
| <strong>Total</strong> | <strong>0</strong> | <strong>14</strong> | <strong>0</strong> |</p>
<p><strong><a href="https://david-fix-1342-attempt-2.ecosystem-663.pages.dev/diff">Full report with detailed diff</a></strong> (<a href="https://david-fix-1342-attempt-2.ecosystem-663.pages.dev/timing">timing results</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 12:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/type_properties/is_assignable_to.md</code>:1 on 2025-10-13 13:00</div>
            <div class="timeline-body"><p>do we really not already have tests like these somewhere...?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/type_properties/is_equivalent_to.md</code>:479 on 2025-10-13 13:00</div>
            <div class="timeline-body"><pre><code>A function with no explicit return type should be gradually equivalent to a function-like callable
</code></pre>
<p>or</p>
<pre><code>A function with no explicit return type should be gradual-equivalent to a function-like callable
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/type_properties/is_equivalent_to.md</code>:535 on 2025-10-13 13:02</div>
            <div class="timeline-body"><p>üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types.rs</code>:9774 on 2025-10-13 13:05</div>
            <div class="timeline-body"><p>strictly speaking, if we&#x27;re doing it this way rather than with intersections, I suppose we should <em>also</em> have a <code>method_like: bool</code> flag for <code>BoundMethodType</code>s -- methods not only have all the attributes that functions have, but they also have attributes such as <code>__closure__</code> that functions do not have</p>
<p>(Not blocking for this PR, though, of course)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types.rs</code>:9883 on 2025-10-13 13:06</div>
            <div class="timeline-body"><p>This looks identical to the <code>CallableType::function_like</code> method immediately below it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-10-13 13:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-10-13 13:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/resources/mdtest/type_properties/is_assignable_to.md</code>:1 on 2025-10-13 13:09</div>
            <div class="timeline-body"><p>:man_shrugging:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-10-13 13:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/src/types.rs</code>:9774 on 2025-10-13 13:10</div>
            <div class="timeline-body"><p>I very much like the <code>Callable[‚Ä¶] &amp; FunctionType</code> / <code>Callable[‚Ä¶] &amp; BoundMethodType</code> approach, but I&#x27;d like to move on with this for now, to get to <a href="https://github.com/astral-sh/ruff/pull/20802">what I&#x27;m actually trying to achieve</a> :smile:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-10-13 13:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/src/types.rs</code>:9883 on 2025-10-13 13:10</div>
            <div class="timeline-body"><p>Oh, haha. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-10-13 13:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types.rs</code>:9774 on 2025-10-13 13:12</div>
            <div class="timeline-body"><p>yeah ikik, that&#x27;s why I said this is non-blocking üòÑ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 13:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-10-13 13:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-10-13 13:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:19:29 UTC
    </footer>
</body>
</html>
