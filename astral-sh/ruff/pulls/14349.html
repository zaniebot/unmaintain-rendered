<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Implicit class variable in dataclass (`RUF045`) - astral-sh/ruff #14349</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Implicit class variable in dataclass (<code>RUF045</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14349">#14349</a>
        opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a>
        on 2024-11-15 00:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2024-11-15 00:14</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Resolves #12877.</p>
<h2>Test Plan</h2>
<p><code>cargo nextest run</code> and <code>cargo insta test</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-15 00:41</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+8 -0 violations, +0 -0 fixes in 4 projects; 51 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/5e8be07b7a0eed5defced1f548ccb9c0d8b807fa/airflow/executors/base_executor.py#L89'>airflow/executors/base_executor.py:89:5:</a> RUF045 Assignment without annotation found in dataclass body
+ <a href='https://github.com/apache/airflow/blob/5e8be07b7a0eed5defced1f548ccb9c0d8b807fa/dev/breeze/src/airflow_breeze/params/doc_build_params.py#L36'>dev/breeze/src/airflow_breeze/params/doc_build_params.py:36:5:</a> RUF045 Assignment without annotation found in dataclass body
</pre>

</p>
</details>
<details><summary><a href="https://github.com/latchbio/latch">latchbio/latch</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/latchbio/latch/blob/5e0367a180d1d3b321492f1c3939aee4c1665278/src/latch_cli/constants.py#L31'>src/latch_cli/constants.py:31:5:</a> RUF045 Assignment without annotation found in dataclass body
+ <a href='https://github.com/latchbio/latch/blob/5e0367a180d1d3b321492f1c3939aee4c1665278/src/latch_cli/constants.py#L32'>src/latch_cli/constants.py:32:5:</a> RUF045 Assignment without annotation found in dataclass body
+ <a href='https://github.com/latchbio/latch/blob/5e0367a180d1d3b321492f1c3939aee4c1665278/src/latch_cli/constants.py#L39'>src/latch_cli/constants.py:39:5:</a> RUF045 Assignment without annotation found in dataclass body
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python/typeshed">python/typeshed</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select E,F,FA,I,PYI,RUF,UP,W</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/python/typeshed/blob/cc8ca939c0477a49fcce0554fa1743bd5c656a11/stubs/fpdf2/fpdf/fonts.pyi#L33'>stubs/fpdf2/fpdf/fonts.pyi:33:5:</a> RUF045 Assignment without annotation found in dataclass body
</pre>

</p>
</details>
<details><summary><a href="https://github.com/scikit-build/scikit-build-core">scikit-build/scikit-build-core</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/scikit-build/scikit-build-core/blob/7568be0570ff095ffc63edc55413bc9c67fde4eb/src/scikit_build_core/file_api/model/codemodel.py#L129'>src/scikit_build_core/file_api/model/codemodel.py:129:5:</a> RUF045 Assignment without annotation found in dataclass body
+ <a href='https://github.com/scikit-build/scikit-build-core/blob/7568be0570ff095ffc63edc55413bc9c67fde4eb/src/scikit_build_core/file_api/model/directory.py#L23'>src/scikit_build_core/file_api/model/directory.py:23:5:</a> RUF045 Assignment without annotation found in dataclass body
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF045 | 8 | 8 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2024-11-15 00:51</div>
            <div class="timeline-body"><p>False positives found by ecosystem checks:</p>
<p><a href="https://github.com/python/typeshed/blob/5052fa2f18db4493892e0f2775030683c9d06531/stubs/fpdf2/fpdf/fonts.pyi#L33"><code>stubs/fpdf2/fpdf/fonts.pyi</code> (@python/typeshed)</a>:</p>
<pre><code class="language-python">@dataclass
class FontFace:
    family: str | None
    emphasis: TextEmphasis | None
    size_pt: int | None
    color: DeviceGray | DeviceRGB | None
    fill_color: DeviceGray | DeviceRGB | None

    ...

    replace = dataclasses.replace
</code></pre>
<p><a href="https://github.com/pytest-dev/pytest/blob/755083c36cf07ee75952515e2b4abd65e2e91a8f/src/_pytest/fixtures.py#L310"><code>src/_pytest/fixtures.py</code> (@pytest-dev/pytest)</a>:</p>
<pre><code class="language-python">@dataclasses.dataclass(frozen=True)
class FuncFixtureInfo:
    ...

    __slots__ = (&quot;argnames&quot;, &quot;initialnames&quot;, &quot;names_closure&quot;, &quot;name2fixturedefs&quot;)
</code></pre>
<p>Special names can be exempted, but I'm not sure what to do about the first.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dhruvmanila on 2024-11-18 06:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @dhruvmanila on 2024-11-18 06:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-18 08:10</div>
            <div class="timeline-body"><p>I'm not saying we shouldn't do it, but requiring type annotations has been controversial in other instances; for example, there's a <a href="https://github.com/astral-sh/ruff/issues/5243">long thread for RUF012</a> that does something similar. @AlexWaygood I'd be interested on your take on this before I start reviewing the rule itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-11-25 09:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @AlexWaygood by @MichaReiser on 2024-11-27 09:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dylwil3 by @MichaReiser on 2025-02-14 07:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @dylwil3 by @dylwil3 on 2025-02-14 13:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @dylwil3 on 2025-02-15 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a> approved on 2025-02-15 15:06</div>
            <div class="timeline-body"><p>Thank you!</p>
<p>Looking at the ecosystem results, it seems fairly common for users to define a private class variable in their dataclasses. So I've restricted the scope of the rule a little to exempt that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dylwil3 on 2025-02-15 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dylwil3 on 2025-02-15 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-02-16 07:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 19:57:51 UTC
    </footer>
</body>
</html>
