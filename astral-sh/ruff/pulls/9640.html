<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`] Implement `redefined-slots-in-subclass` (`W0244`) - astral-sh/ruff #9640</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pylint</code>] Implement <code>redefined-slots-in-subclass</code> (<code>W0244</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9640">#9640</a>
        opened by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a>
        on 2024-01-25 10:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tsugumi-sys">@tsugumi-sys</a></div>
            <div class="timeline-body">

Summary


<ul>
<li>Implementation of <a href="https://pylint.readthedocs.io/en/latest/user_guide/messages/warning/redefined-slots-in-subclass.html">redefined-slots-in-subclass / W0244</a>.</li>
<li>Related to #970</li>
</ul>
Test Plan


<pre><code>cargo test
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a> on 2024-01-25 10:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-01-25 11:04</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>âœ… ecosystem check detected no linter changes.</p>
Linter (preview)
<p>âœ… ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a> on 2024-01-25 11:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> had review dismissed on 2024-03-06 15:38</div>
            <div class="timeline-body"><p>Hy @tsugumi-sys. Thanks for working on this rule. It seems that the code currently fails to compile. Would you mind taking a look why that is?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a> on 2024-03-07 06:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-07 08:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a> on 2024-03-10 13:27</div>
            <div class="timeline-body"><p>@MichaReiser
I fixed the compile error :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-05 10:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/redefined_slots_in_subclass.py</code>:6 on 2024-04-29 08:42</div>
            <div class="timeline-body"><p>Can you add some more examples for this? Like what would happen if there&#x27;s another class in the hierarchy?</p>
<pre><code>class Grandparent:
    __slots__ = (&quot;a&quot;, &quot;b&quot;)


class Parent(Grandparent):
    pass


class Child(Parent):
    __slots__ = (&quot;c&quot;, &quot;a&quot;)
</code></pre>
<p>Pylint does trigger for the above code but I don&#x27;t think Ruff would do the same.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/codes.rs</code>:302 on 2024-04-29 08:42</div>
            <div class="timeline-body"><p>All new rules should go in preview.</p>
<pre><code>        (Pylint, &quot;W0244&quot;) =&gt; (RuleGroup::Preview, rules::pylint::rules::RedefinedSlotsInSubclass),
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/checkers/ast/analyze/module.rs</code>:14 on 2024-04-29 08:51</div>
            <div class="timeline-body"><p>I think it would be more useful to run this on an individual class otherwise it won&#x27;t check the classes which are nested in other blocks. For example:</p>
<pre><code>class Random:
    class Parent:
        __slots__ = (&quot;a&quot;, &quot;b&quot;)

    class Child(Parent):
        __slots__ = (&quot;c&quot;, &quot;a&quot;)
</code></pre>
<p>This poses a challenge of getting the base classes but it can be done via the semantic model. You can find an example here:</p>
<p>https://github.com/astral-sh/ruff/blob/b0d6fd7343e503f1ec2917db339fe88639d84911/crates/ruff_python_semantic/src/analyze/class.rs#L77-L95</p>
<ul>
<li>There&#x27;s a <code>bases</code> method which returns a slice of all the arguments for a class</li>
<li>It would be useful to use <code>map_subscript</code> as mentioned as it will allow you to go to a generic class like <code>Parent[T]</code></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/redefined_slots_in_subclass.rs</code>:129 on 2024-04-29 08:54</div>
            <div class="timeline-body"><p>As mentioned earlier, I think we&#x27;d need to update this method to consider individual class and climb up the hierarchy to determine if there are any conflicts with any of the names in <code>__slots__</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> requested changes on 2024-04-29 08:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-29 08:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-10-04 05:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-12-17 05:21</div>
            <div class="timeline-body"><p>@tsugumi-sys I&#x27;ve got your branch up-to-date with main (with as few changes as possible). I also moved the proposed rule to preview.</p>
<p>Would you be interested in revisiting this PR and addressing dhruv&#x27;s comments? I&#x27;d be happy to help if you run into any trouble. Let me know either way, and thanks for implementing this rule!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a> on 2024-12-17 06:00</div>
            <div class="timeline-body"><p>@dylwil3
I&#x27;m sorry for not getting around to this PR for so long.
I&#x27;d like to challenge this PR again :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-12-17 06:07</div>
            <div class="timeline-body"><blockquote>
<p>I&#x27;m sorry for not getting around to this PR for so long.</p>
</blockquote>
<p>No need to apologize! Just wanted to check in, not scold ðŸ˜„ Glad to hear you&#x27;re interested in revisiting.</p>
<p>Feel free to ping me with any questions or when you&#x27;re ready for a review, and thanks again!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-16 20:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-16 20:12</div>
            <div class="timeline-body"><p>Hey @tsugumi-sys , since there weren&#x27;t too many changes to make I went ahead and made them. Assuming @dhruvmanila agrees that this fixes the previous concerns, we can get this merged in. Thanks so much for your contribution!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tsugumi-sys">@tsugumi-sys</a> on 2025-01-17 03:02</div>
            <div class="timeline-body"><p>@dylwil3<br>
Hi, I&#x27;m so sorry but I&#x27;m extremely busy recently, and it would be helpful if you take over this PR :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-01-17 04:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/redefined_slots_in_subclass.rs</code>:124 on 2025-01-17 04:56</div>
            <div class="timeline-body"><p>Unrelated to this PR, this is interesting as it seems like a confusing behavior given the name of the function (<code>any_super_class</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/redefined_slots_in_subclass.rs</code>:127 on 2025-01-17 04:56</div>
            <div class="timeline-body"><pre><code>		slots_members(&amp;super_class.body).contains(slot)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/pylint/rules/redefined_slots_in_subclass.rs</code>:49 on 2025-01-17 05:00</div>
            <div class="timeline-body"><p>Not sure if we need the brackets, you&#x27;ll also need to update the snapshots</p>
<pre><code>        format!(&quot;Redefined slots &#x27;{name}&#x27; in subclass&quot;)
</code></pre>
<p>Additionally, I think we can improve the message by including the name of the subclass in which Ruff found the original definition. This can be done in a follow-up PR as I think it&#x27;ll involve either updating <code>any_super_class</code> or adding a <code>iter_super_class</code> function which iterates over all the classes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2025-01-17 05:01</div>
            <div class="timeline-body"><p>Thank you! This looks good</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a> reviewed on 2025-01-17 15:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dylwil3">@dylwil3</a> on <code>crates/ruff_linter/src/rules/pylint/rules/redefined_slots_in_subclass.rs</code>:124 on 2025-01-17 15:25</div>
            <div class="timeline-body"><p>It&#x27;s confusing but I think technically correct since any class is a superclass of itself</p>
<pre><code>&gt;&gt;&gt; class Foo:...
...
&gt;&gt;&gt; issubclass(Foo,Foo)
True
</code></pre>
<p>I like your idea of implementing <code>iter_super_class</code>. Then we can leave <code>any_super_class</code> as is, but use <code>iter_super_class</code> with a <code>skip</code> to get this behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-17 15:47</div>
            <div class="timeline-body"><p>@tsugumi-sys no worries at all! you did the bulk of the work, so not much left on my end. thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-17 15:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-17 15:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:01:00 UTC
    </footer>
</body>
</html>
