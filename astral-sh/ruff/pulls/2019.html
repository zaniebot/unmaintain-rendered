<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change CI to use MSRV for cargo test and build - astral-sh/ruff #2019</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Change CI to use MSRV for cargo test and build</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/2019">#2019</a>
        opened by <a href="https://github.com/not-my-profile">@not-my-profile</a>
        on 2023-01-20 10:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a></div>
            <div class="timeline-body"><p>This was apparently accidentally changed in
79ca66ace5ebba10e94cda9925d19fdfc50ac327.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/akx">@akx</a> requested changes on 2023-01-20 10:24</div>
            <div class="timeline-body"><p>Could you also fix the readme accordingly?</p>
<p>It&#x27;s saying</p>
<pre><code>cargo +nightly test --all
</code></pre>
<p>right now â€“ maybe &quot;For development, we use&quot; should be rephrased so it&#x27;s clear that building and testing should happen with stable Rust, but <code>fmt</code> and <code>clippy</code> should be run with nightly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on 2023-01-20 10:33</div>
            <div class="timeline-body"><p>I think our goal is to be as strict as possible. The <code>rustfmt</code> and <code>clippy</code> from nightly are stricter than their stable versions. However a successful <code>cargo test</code> on stable is stricter than a successful <code>cargo test</code> on nightly (since it cannot use unstable features) and more important (since we use stable for our release builds). So I think it makes sense that our CI enforces rustfmt &amp; clippy on nightly and <code>cargo test</code> &amp; <code>build</code> on stable.</p>
<blockquote>
<p>Could you also fix the readme accordingly?</p>
</blockquote>
<p>Done :)</p>
<p>Couple of other thoughts:</p>
<ul>
<li>We may want to move that information to <code>CONTRIBUTING.md</code> ... I think it&#x27;s a bit out of place in the README.</li>
<li>We could link some editor-specific documentation in <code>CONTRIBUTING.md</code> on how to configure rustfmt/clippy to use nightly while using stable for the rest are alternatively tell the contributor to just run <code>rustup override set nightly</code> within the ruff repository (since a <code>cargo test</code> for ruff that passes on nightly is highly likely to also pass on stable since we don&#x27;t use any unstable features).</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Change CI to use stable Rust for cargo test and build&quot; to &quot;Change CI to use MSRV for cargo test and build&quot; by <a href="https://github.com/not-my-profile">@not-my-profile</a> on 2023-01-20 10:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>.github/workflows/ci.yaml</code>:74 on 2023-01-20 12:38</div>
            <div class="timeline-body"><p>I assume we can just omit this line and <code>toolchain</code> now, since it matches the format file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-20 12:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 12:39</div>
            <div class="timeline-body"><p>Read through the discussion here and in the previous issue. All makes sense. And yes, my intention was to use strictest settings for fmt and clippy (nightly is also required for rustfmt to support most configuration options), but to keep the code itself compiling under stable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 12:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 12:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-20 12:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>.github/workflows/ci.yaml</code>:74 on 2023-01-20 12:40</div>
            <div class="timeline-body"><p>(But, merging anyway, I don&#x27;t mind if it&#x27;s explicit. Welcome to change in a follow-up commit.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-20 12:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>.github/workflows/ci.yaml</code>:74 on 2023-01-20 12:41</div>
            <div class="timeline-body"><p>Ah yes according to the <a href="https://github.com/actions-rs/toolchain#the-toolchain-file">action documentation</a> that should work.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:51:53 UTC
    </footer>
</body>
</html>
