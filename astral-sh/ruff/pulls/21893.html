<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Generics: Respect typevar bounds when matching against a union - astral-sh/ruff #21893</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Generics: Respect typevar bounds when matching against a union</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/21893">#21893</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-12-10 12:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a></div>
            <div class="timeline-body">Summary
<p>Respect typevar bounds and constraints when matching against a union. For example:</p>
<pre><code>def accepts_t_or_int[T_str: str](x: T_str | int) -&gt; T_str:
    raise NotImplementedError

reveal_type(accepts_t_or_int(&quot;a&quot;))  # ok, reveals `Literal[&quot;a&quot;]`
reveal_type(accepts_t_or_int(1))  # ok, reveals `Unknown`

class Unrelated: ...

# error: [invalid-argument-type] &quot;Argument type `Unrelated` does not
# satisfy upper bound `str` of type variable `T_str`&quot;
accepts_t_or_int(Unrelated())
</code></pre>
<p>Previously, the last call succeed without any errors. Worse than that, we also incorrectly solved <code>T_str = Unrelated</code>, which often lead to downstream errors.</p>
<p>closes <a href="https://github.com/astral-sh/ty/issues/1837">astral-sh/ty#1837</a></p>
Ecosystem impact
<p>Looks good!</p>
<ul>
<li>Lots of removed false positives, often because we previously selected a wrong overload for a generic function (because we didn&#x27;t respect the typevar bound in an earlier overload).</li>
<li>We now understand calls to functions accepting an argument of type <code>GenericPath: TypeAlias = AnyStr | PathLike[AnyStr]</code>. Previously, we would incorrectly match a <code>Path</code> argument against the <code>AnyStr</code> typevar (violating its constraints), but now we match against <code>PathLike</code>.</li>
</ul>
Performance
<p>Another regression on <code>colour</code>. This package uses <code>numpy</code> heavily. And <code>numpy</code> is the codebase that originally lead me to this bug. The fix here allows us to infer more precise <code>np.array</code> types in some cases, so it&#x27;s reasonable that we just need to perform more work.</p>
<p>The fix here also requires us to look at more union elements when we would previously short-circuit incorrectly, so some more work needs to be done in the solver.</p>
Test Plan
<p>New Markdown tests</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-10 12:18</div>
            <div class="timeline-body">

Diagnostic diff on <a href="https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance">typing conformance tests</a>
<p>No changes detected when running ty on typing conformance tests âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-10 12:20</div>
            <div class="timeline-body">

<code>mypy_primer</code> results

Changes were detected when running on open source projects

<pre><code>spack (https://github.com/spack/spack)
- lib/spack/spack/environment/environment.py:590:24: error[unresolved-attribute] Object of type `Path` has no attribute `startswith`
- Found 7971 diagnostics
+ Found 7970 diagnostics

graphql-core (https://github.com/graphql-python/graphql-core)
- src/graphql/execution/execute.py:1676:21: error[invalid-assignment] Object of type `BoxedAwaitableOrValue[CoroutineType[Any, Any, ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult]]` is not assignable to attribute `result` of type `BoxedAwaitableOrValue[ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult] | (() -&gt; BoxedAwaitableOrValue[ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult])`
+ src/graphql/execution/execute.py:1676:21: error[invalid-assignment] Object of type `BoxedAwaitableOrValue[CoroutineType[Any, Any, ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult] | ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult]` is not assignable to attribute `result` of type `BoxedAwaitableOrValue[ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult] | (() -&gt; BoxedAwaitableOrValue[ReconcilableDeferredGroupedFieldSetResult | NonReconcilableDeferredGroupedFieldSetResult])`
- src/graphql/execution/execute.py:1828:32: error[invalid-argument-type] Argument to bound method `append` is incorrect: Expected `BoxedAwaitableOrValue[StreamItemResult] | (() -&gt; BoxedAwaitableOrValue[StreamItemResult])`, found `BoxedAwaitableOrValue[CoroutineType[Any, Any, StreamItemResult]]`
+ src/graphql/execution/execute.py:1828:32: error[invalid-argument-type] Argument to bound method `append` is incorrect: Expected `BoxedAwaitableOrValue[StreamItemResult] | (() -&gt; BoxedAwaitableOrValue[StreamItemResult])`, found `BoxedAwaitableOrValue[CoroutineType[Any, Any, StreamItemResult] | StreamItemResult]`

boostedblob (https://github.com/hauntsaninja/boostedblob)
- boostedblob/listing.py:300:19: error[unsupported-operator] Operator `/` is unsupported between objects of type `LocalPath` and `LocalPath`
- boostedblob/listing.py:300:29: error[invalid-argument-type] Argument is incorrect: Expected `str`, found `LocalPath`
- Found 21 diagnostics
+ Found 19 diagnostics

pytest (https://github.com/pytest-dev/pytest)
- src/_pytest/pathlib.py:177:12: error[unresolved-attribute] Object of type `Path` has no attribute `lower`
- Found 443 diagnostics
+ Found 442 diagnostics

dulwich (https://github.com/dulwich/dulwich)
- dulwich/client.py:3689:28: error[invalid-return-type] Return type does not match returned value: expected `tuple[dict[Ref, ObjectID | None], set[bytes], str, dict[Ref, Ref], dict[Ref, ObjectID]]`, found `tuple[dict[Ref, ObjectID | None] | dict[Ref, ObjectID], set[bytes], str | @Todo, dict[Ref, Ref], dict[Ref, ObjectID]]`
+ dulwich/client.py:3689:28: error[invalid-return-type] Return type does not match returned value: expected `tuple[dict[Ref, ObjectID | None], set[bytes], str, dict[Ref, Ref], dict[Ref, ObjectID]]`, found `tuple[dict[Ref, ObjectID | None] | dict[Ref, ObjectID], set[bytes], str, dict[Ref, Ref], dict[Ref, ObjectID]]`

pandera (https://github.com/pandera-dev/pandera)
- tests/pandas/test_dtypes.py:169:43: error[invalid-assignment] Object of type `list[tuple[dict[Unknown, Unknown], list[Unknown]] | tuple[dict[Unknown | &lt;class &#x27;datetime&#x27;&gt; | &lt;class &#x27;datetime64&#x27;&gt; | ... omitted 4 union elements, Unknown | str], Series[pandas._libs.tslibs.timestamps.Timestamp]] | tuple[dict[Unknown | PeriodDtype, Unknown | str], Series[Period]] | tuple[dict[Unknown | &lt;class &#x27;SparseDtype&#x27;&gt; | SparseDtype, Unknown | SparseDtype], Series[list[Unknown | int | None]]] | tuple[dict[Unknown | IntervalDtype, Unknown | str], Series[Interval[int | float]]]]` is not assignable to `list[tuple[dict[Unknown, Unknown], list[Unknown]]]`
+ tests/pandas/test_dtypes.py:169:43: error[invalid-assignment] Object of type `list[tuple[dict[Unknown, Unknown], list[Unknown]] | tuple[dict[Unknown | &lt;class &#x27;datetime&#x27;&gt; | &lt;class &#x27;datetime64&#x27;&gt; | ... omitted 4 union elements, Unknown | str], Series[pandas._libs.tslibs.timestamps.Timestamp]] | tuple[dict[Unknown | PeriodDtype, Unknown | str], Series[Period]] | tuple[dict[Unknown | &lt;class &#x27;SparseDtype&#x27;&gt; | SparseDtype, Unknown | SparseDtype], Series[Any]] | tuple[dict[Unknown | IntervalDtype, Unknown | str], Series[Interval[int | float]]]]` is not assignable to `list[tuple[dict[Unknown, Unknown], list[Unknown]]]`
- tests/pandas/test_schemas.py:157:39: error[invalid-argument-type] Argument to bound method `validate` is incorrect: Expected `DataFrame`, found `Series[Any]`
- tests/pandas/test_schemas.py:175:25: error[invalid-argument-type] Argument to bound method `validate` is incorrect: Expected `DataFrame`, found `Series[Any]`
- tests/pandas/test_schemas.py:177:25: error[invalid-argument-type] Argument to bound method `validate` is incorrect: Expected `DataFrame`, found `Series[Any]`
- Found 1615 diagnostics
+ Found 1612 diagnostics

vision (https://github.com/pytorch/vision)
- torchvision/prototype/datasets/_folder.py:51:12: error[invalid-return-type] Return type does not match returned value: expected `tuple[Unknown, list[str]]`, found `tuple[Unknown, list[Path]]`
- Found 1476 diagnostics
+ Found 1475 diagnostics

antidote (https://github.com/Finistere/antidote)
- tests/lib/interface/test_class.py:282:52: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- tests/lib/interface/test_conditions.py:150:46: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- tests/lib/interface/test_conditions.py:193:59: error[invalid-argument-type] Argument to bound method `when` is incorrect: Expected `Predicate[Weighted] | Predicate[NeutralWeight] | Weighted | ... omitted 3 union elements`, found `Weight | None`
- Found 278 diagnostics
+ Found 275 diagnostics

freqtrade (https://github.com/freqtrade/freqtrade)
- freqtrade/data/converter/converter.py:153:18: error[invalid-assignment] Object of type `Series[Any]` is not assignable to `DataFrame`
- freqtrade/data/converter/converter.py:155:14: error[invalid-assignment] Object of type `Series[Any]` is not assignable to `DataFrame`
- freqtrade/data/converter/trade_converter.py:89:12: error[invalid-return-type] Return type does not match returned value: expected `DataFrame`, found `Series[Any]`
- freqtrade/freqai/data_kitchen.py:389:18: error[invalid-assignment] Object of type `Series[Any]` is not assignable to `DataFrame`
- freqtrade/freqai/data_kitchen.py:391:18: error[invalid-assignment] Object of type `Series[Any]` is not assignable to `DataFrame`
- freqtrade/rpc/rpc.py:1435:29: error[invalid-assignment] Object of type `Series[Any]` is not assignable to `DataFrame`
- Found 689 diagnostics
+ Found 683 diagnostics

pyodide (https://github.com/pyodide/pyodide)
- pyodide-build/pyodide_build/recipe/unvendor.py:101:37: error[invalid-argument-type] Argument to function `fnmatchcase` is incorrect: Argument type `Path` does not satisfy constraints (`str`, `bytes`) of type variable `AnyStr`
- pyodide-build/pyodide_build/recipe/unvendor.py:101:37: error[invalid-argument-type] Argument to function `fnmatchcase` is incorrect: Expected `str`, found `Path`
- pyodide-build/pyodide_build/recipe/unvendor.py:102:40: error[invalid-argument-type] Argument to function `fnmatchcase` is incorrect: Argument type `Path` does not satisfy constraints (`str`, `bytes`) of type variable `AnyStr`
- pyodide-build/pyodide_build/recipe/unvendor.py:102:40: error[invalid-argument-type] Argument to function `fnmatchcase` is incorrect: Expected `str`, found `Path`
- pyodide-build/pyodide_build/recipe/unvendor.py:105:44: error[invalid-argument-type] Argument to function `fnmatchcase` is incorrect: Argument type `Path` does not satisfy constraints (`str`, `bytes`) of type variable `AnyStr`
- pyodide-build/pyodide_build/recipe/unvendor.py:105:44: error[invalid-argument-type] Argument to function `fnmatchcase` is incorrect: Expected `str`, found `Path`
- Found 876 diagnostics
+ Found 870 diagnostics

setuptools (https://github.com/pypa/setuptools)
+ setuptools/_distutils/command/install.py:671:45: error[invalid-argument-type] Argument to function `change_root` is incorrect: Expected `str | PathLike[str]`, found `str | None`
+ setuptools/_distutils/tests/test_version.py:55:42: error[invalid-argument-type] Argument to bound method `_cmp` is incorrect: Argument type `object` does not satisfy upper bound `StrictVersion` of type variable `Self`
+ setuptools/_distutils/tests/test_version.py:55:42: error[invalid-argument-type] Argument to bound method `_cmp` is incorrect: Expected `StrictVersion | str`, found `object`
+ setuptools/_distutils/tests/test_version.py:77:41: error[invalid-argument-type] Argument to bound method `_cmp` is incorrect: Argument type `object` does not satisfy upper bound `LooseVersion` of type variable `Self`
+ setuptools/_distutils/tests/test_version.py:77:41: error[invalid-argument-type] Argument to bound method `_cmp` is incorrect: Expected `LooseVersion | str`, found `object`
- Found 1284 diagnostics
+ Found 1289 diagnostics

cloud-init (https://github.com/canonical/cloud-init)
- cloudinit/sources/DataSourceWSL.py:399:13: error[unresolved-attribute] Object of type `PurePath` has no attribute `casefold`
- Found 1180 diagnostics
+ Found 1179 diagnostics

strawberry (https://github.com/strawberry-graphql/strawberry)
- strawberry/schema/schema.py:826:69: error[invalid-assignment] Object of type `CoroutineType[Any, Any, AsyncIterator[ExecutionResult] | ExecutionResult]` is not assignable to `ExecutionResult | AsyncIterator[ExecutionResult]`
+ strawberry/schema/schema.py:826:69: error[invalid-assignment] Object of type `AsyncIterator[ExecutionResult] | ExecutionResult | CoroutineType[Any, Any, AsyncIterator[ExecutionResult] | ExecutionResult]` is not assignable to `ExecutionResult | AsyncIterator[ExecutionResult]`

dd-trace-py (https://github.com/DataDog/dd-trace-py)
- tests/internal/test_module.py:560:16: error[unresolved-attribute] Object of type `Path` has no attribute `endswith`
- tests/internal/test_module.py:562:57: error[non-subscriptable] Cannot subscript object of type `Path` with no `__getitem__` method
- Found 8473 diagnostics
+ Found 8471 diagnostics

scikit-build-core (https://github.com/scikit-build/scikit-build-core)
+ src/scikit_build_core/_logging.py:153:13: warning[unsupported-base] Unsupported class base with type `&lt;class &#x27;Mapping[str, Style]&#x27;&gt; | &lt;class &#x27;Mapping[str, Divergent]&#x27;&gt;`
+ src/scikit_build_core/build/wheel.py:98:20: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 41 diagnostics
+ Found 43 diagnostics

xarray (https://github.com/pydata/xarray)
- xarray/coding/strings.py:243:12: error[no-matching-overload] No overload of bound method `reshape` matches arguments
- xarray/groupers.py:556:23: error[no-matching-overload] No overload of bound method `groupby` matches arguments
- xarray/tests/test_rolling.py:203:21: error[invalid-argument-type] Argument to bound method `rolling` is incorrect: Argument type `Series[ndarray[tuple[int], dtype[signedinteger[Any]]]]` does not satisfy upper bound `Series[S1@Series]` of type variable `Self`
- xarray/tests/test_rolling.py:222:21: error[invalid-argument-type] Argument to bound method `rolling` is incorrect: Argument type `Series[ndarray[tuple[int], dtype[signedinteger[Any]]]]` does not satisfy upper bound `Series[S1@Series]` of type variable `Self`
- xarray/tests/test_variable.py:2825:36: error[invalid-assignment] Object of type `Series[Index[Any]]` is not assignable to `T_DuckArray@TestAsCompatibleData`
+ xarray/tests/test_variable.py:2825:36: error[invalid-assignment] Object of type `Series[Any]` is not assignable to `T_DuckArray@TestAsCompatibleData`
- Found 1758 diagnostics
+ Found 1754 diagnostics

scipy-stubs (https://github.com/scipy/scipy-stubs)
- tests/special/test_logsumexp.pyi:23:1: error[type-assertion-failure] Type `float64` does not match asserted type `list[int | float]`
+ tests/special/test_logsumexp.pyi:23:1: error[type-assertion-failure] Type `float64` does not match asserted type `Unknown`
- tests/special/test_logsumexp.pyi:25:1: error[type-assertion-failure] Type `complex128` does not match asserted type `list[int | float | complex]`
+ tests/special/test_logsumexp.pyi:25:1: error[type-assertion-failure] Type `complex128` does not match asserted type `Unknown`
- tests/special/test_logsumexp.pyi:27:1: error[type-assertion-failure] Type `floating[_16Bit]` does not match asserted type `ndarray[tuple[int], dtype[floating[_16Bit]]]`
+ tests/special/test_logsumexp.pyi:27:1: error[type-assertion-failure] Type `floating[_16Bit]` does not match asserted type `Unknown`
- tests/special/test_logsumexp.pyi:29:1: error[type-assertion-failure] Type `complexfloating[_32Bit, _32Bit]` does not match asserted type `ndarray[tuple[int], dtype[complexfloating[_32Bit, _32Bit]]]`
+ tests/special/test_logsumexp.pyi:29:1: error[type-assertion-failure] Type `complexfloating[_32Bit, _32Bit]` does not match asserted type `Unknown`
- tests/special/test_logsumexp.pyi:50:1: error[type-assertion-failure] Type `tuple[float64, float64]` does not match asserted type `tuple[list[int | float], list[int | float]]`
+ tests/special/test_logsumexp.pyi:50:1: error[type-assertion-failure] Type `tuple[float64, float64]` does not match asserted type `tuple[Unknown, Unknown]`
- tests/special/test_logsumexp.pyi:52:1: error[type-assertion-failure] Type `tuple[float64, complex128]` does not match asserted type `tuple[list[int | float | complex], list[int | float | complex]]`
+ tests/special/test_logsumexp.pyi:52:1: error[type-assertion-failure] Type `tuple[float64, complex128]` does not match asserted type `tuple[Unknown, Unknown]`
- tests/special/test_logsumexp.pyi:54:1: error[type-assertion-failure] Type `tuple[floating[_16Bit], floating[_16Bit]]` does not match asserted type `tuple[ndarray[tuple[int], dtype[floating[_16Bit]]], ndarray[tuple[int], dtype[floating[_16Bit]]]]`
+ tests/special/test_logsumexp.pyi:54:1: error[type-assertion-failure] Type `tuple[floating[_16Bit], floating[_16Bit]]` does not match asserted type `tuple[Unknown, Unknown]`
- tests/special/test_logsumexp.pyi:55:1: error[type-assertion-failure] Type `tuple[floating[Any], complexfloating[_32Bit, _32Bit]]` does not match asserted type `tuple[complexfloating[_32Bit, _32Bit], complexfloating[_32Bit, _32Bit]]`
+ tests/special/test_logsumexp.pyi:55:1: error[type-assertion-failure] Type `tuple[floating[Any], complexfloating[_32Bit, _32Bit]]` does not match asserted type `tuple[Unknown, Unknown]`
- tests/special/test_logsumexp.pyi:56:1: error[type-assertion-failure] Type `tuple[floating[Any], complexfloating[_32Bit, _32Bit]]` does not match asserted type `tuple[ndarray[tuple[int], dtype[complexfloating[_32Bit, _32Bit]]], ndarray[tuple[int], dtype[complexfloating[_32Bit, _32Bit]]]]`
+ tests/special/test_logsumexp.pyi:56:1: error[type-assertion-failure] Type `tuple[floating[Any], complexfloating[_32Bit, _32Bit]]` does not match asserted type `tuple[Unknown, Unknown]`
- tests/stats/test_mode.pyi:30:1: error[type-assertion-failure] Type `float64` does not match asserted type `list[int | float]`
+ tests/stats/test_mode.pyi:30:1: error[type-assertion-failure] Type `float64` does not match asserted type `integer[Any] | floating[Any]`
- tests/stats/test_mode.pyi:35:1: error[type-assertion-failure] Type `Unknown` does not match asserted type `list[list[int | float]]`
+ tests/stats/test_mode.pyi:35:1: error[type-assertion-failure] Type `Unknown` does not match asserted type `integer[Any] | floating[Any]`
- tests/stats/test_mode.pyi:45:1: error[type-assertion-failure] Type `float64` does not match asserted type `list[int | float]`
+ tests/stats/test_mode.pyi:45:1: error[type-assertion-failure] Type `float64` does not match asserted type `integer[Any] | floating[Any]`
- tests/stats/test_mode.pyi:50:1: error[type-assertion-failure] Type `float64` does not match asserted type `list[list[int | float]]`
+ tests/stats/test_mode.pyi:50:1: error[type-assertion-failure] Type `float64` does not match asserted type `integer[Any] | floating[Any]`

pandas (https://github.com/pandas-dev/pandas)
- pandas/core/arrays/_mixins.py:135:20: error[invalid-return-type] Return type does not match returned value: expected `ExtensionArray | ndarray[tuple[Any, ...], dtype[Any]]`, found `ndarray[tuple[Any, ...], type]`
- pandas/core/arrays/datetimelike.py:1142:42: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[Any, ...], str]`
- pandas/core/arrays/datetimelike.py:1204:43: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[Any, ...], str]`
- pandas/core/arrays/datetimelike.py:1313:20: error[invalid-return-type] Return type does not match returned value: expected `ndarray[tuple[Any, ...], dtype[Any]]`, found `ndarray[tuple[int, ...], dtype[Any] | str]`
- pandas/core/arrays/datetimelike.py:1769:47: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[Any, ...], str]`
- pandas/core/arrays/datetimes.py:534:32: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[Any, ...], str]`
- pandas/core/arrays/datetimes.py:1115:65: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], str], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], str], (key: str, /) -&gt; ndarray[tuple[Any, ...], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[Any, ...], dtype[void]]]` cannot be called with key of type `Literal[0]` on object of type `ndarray[tuple[Any, ...], str]`
- pandas/core/arrays/datetimes.py:1122:33: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[Any, ...], str]`
- pandas/core/arrays/masked.py:185:30: error[invalid-assignment] Object of type `ndarray[tuple[int, ...], dtype[Any] | type]` is not assignable to `ndarray[tuple[Any, ...], dtype[Any]]`
- pandas/core/arrays/timedeltas.py:324:32: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[Any, ...], str] | Unknown`
- pandas/core/dtypes/missing.py:392:12: error[unsupported-operator] Unary operator `~` is unsupported for type `~bool`
+ pandas/core/indexes/datetimelike.py:995:45: error[unsupported-operator] Operator `-` is unsupported between objects of type `Timestamp | NaTType | Timedelta` and `BaseOffset`
- pandas/core/internals/managers.py:2501:42: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[int, ...], str]`
- pandas/core/tools/datetimes.py:454:41: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[Any, ...], str]`
- pandas/core/util/hashing.py:314:16: error[no-matching-overload] No overload of bound method `astype` matches arguments
- pandas/plotting/_matplotlib/converter.py:785:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;val&quot;]` and value of type `ndarray[tuple[int], dtype[signedinteger[Any]]]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:786:14: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;val&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:787:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;fmt&quot;]` and value of type `Literal[&quot;&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:789:16: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;maj&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:790:16: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;fmt&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:794:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;min&quot;]` and value of type `Literal[True]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:811:9: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;fmt&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:812:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;min&quot;]` and value of type `Literal[True]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:819:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;min&quot;]` and value of type `Literal[True]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:828:9: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;min&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:838:9: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;min&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:842:12: error[invalid-return-type] Return type does not match returned value: expected `ndarray[tuple[Any, ...], dtype[Any]]`, found `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:855:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;val&quot;]` and value of type `ndarray[tuple[int], dtype[signedinteger[Any]]]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:856:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;fmt&quot;]` and value of type `Literal[&quot;&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:857:14: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;val&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:858:16: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;maj&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:859:16: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;fmt&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:864:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;min&quot;]` and value of type `Literal[True]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:877:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;min&quot;]` and value of type `Literal[True]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:887:9: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;min&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:890:12: error[invalid-return-type] Return type does not match returned value: expected `ndarray[tuple[Any, ...], dtype[Any]]`, found `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:902:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;val&quot;]` and value of type `ndarray[tuple[int], dtype[signedinteger[Any]]]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:903:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;fmt&quot;]` and value of type `Literal[&quot;&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:904:14: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;val&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:909:5: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;maj&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:910:5: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;min&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:911:5: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;fmt&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/plotting/_matplotlib/converter.py:913:12: error[invalid-return-type] Return type does not match returned value: expected `ndarray[tuple[Any, ...], dtype[Any]]`, found `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;int&#x27;&gt;] | tuple[str, &lt;class &#x27;bool&#x27;&gt;] | tuple[str, str]]]`
- pandas/tests/arrays/test_datetimes.py:62:41: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/arrays/test_datetimes.py:109:41: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/arrays/test_datetimes.py:114:39: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[datetime64[date | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/arrays/test_timedeltas.py:23:43: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/arrays/test_timedeltas.py:27:42: error[invalid-argument-type] Argument to bound method `_simple_new` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/base/test_value_counts.py:300:14: error[unsupported-operator] Operator `+` is unsupported between objects of type `ndarray[tuple[int], str]` and `Timedelta`
- pandas/tests/base/test_value_counts.py:314:11: error[unsupported-operator] Operator `+` is unsupported between objects of type `Timedelta` and `ndarray[tuple[int], str]`
- pandas/tests/io/formats/test_to_string.py:600:13: error[invalid-argument-type] Method `__getitem__` of type `Overload[(key: ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]] | tuple[ndarray[tuple[Any, ...], dtype[integer[Any] | bool[bool]]], ...], /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;object&#x27;&gt;]]], (key: SupportsIndex | tuple[SupportsIndex, ...], /) -&gt; Any, (key: SupportsIndex | slice[Any, Any, Any] | EllipsisType | ... omitted 5 union elements, /) -&gt; ndarray[tuple[Any, ...], list[Unknown | tuple[str, &lt;class &#x27;object&#x27;&gt;]]], (key: str, /) -&gt; ndarray[tuple[int], dtype[Any]], (key: list[str], /) -&gt; ndarray[tuple[int], dtype[void]]]` cannot be called with key of type `Literal[&quot;err&quot;]` on object of type `ndarray[tuple[int], list[Unknown | tuple[str, &lt;class &#x27;object&#x27;&gt;]]]`
- pandas/tests/scalar/interval/test_contains.py:29:16: error[unsupported-operator] Operator `in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:30:16: error[unsupported-operator] Operator `in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:31:16: error[unsupported-operator] Operator `in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:32:16: error[unsupported-operator] Operator `not in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:44:16: error[unsupported-operator] Operator `not in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:47:16: error[unsupported-operator] Operator `not in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:69:20: error[unsupported-operator] Operator `in` is not supported between two objects of type `Interval[int]`
- pandas/tests/scalar/interval/test_contains.py:73:17: error[unsupported-operator] Operator `in` is not supported between two objects of type `Interval[int]`
+ pandas/tests/scalar/timedelta/test_arithmetic.py:728:13: error[unsupported-operator] Operator `//` is unsupported between objects of type `unsignedinteger[_8Bit]` and `Timedelta`
+ pandas/tests/scalar/timedelta/test_arithmetic.py:731:13: error[unsupported-operator] Operator `//` is unsupported between objects of type `signedinteger[_32Bit]` and `Timedelta`
- pandas/tests/test_nanops.py:1165:15: error[no-matching-overload] No overload of bound method `reshape` matches arguments
- pandas/tests/tslibs/test_timedeltas.py:134:31: error[invalid-argument-type] Argument to function `ints_to_pytimedelta` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/tslibs/test_timedeltas.py:137:16: error[no-matching-overload] No overload of bound method `astype` matches arguments
- pandas/tests/tslibs/test_timedeltas.py:140:31: error[invalid-argument-type] Argument to function `ints_to_pytimedelta` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/tslibs/test_timedeltas.py:150:29: error[invalid-argument-type] Argument to function `ints_to_pytimedelta` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[int], str]`
- pandas/tests/tslibs/test_timedeltas.py:153:29: error[invalid-argument-type] Argument to function `ints_to_pytimedelta` is incorrect: Expected `ndarray[tuple[Any, ...], dtype[timedelta64[timedelta | int | None]]]`, found `ndarray[tuple[int], str]`
- Found 3763 diagnostics
+ Found 3702 diagnostics

bokeh (https://github.com/bokeh/bokeh)
+ src/bokeh/layouts.py:189:37: error[invalid-argument-type] Argument to function `_parse_children_arg` is incorrect: Argument type `UIElement` does not satisfy upper bound `LayoutDOM` of type variable `L`
- src/bokeh/models/annotations/annotation.py:67:14: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[DataSource | InstanceDefault[ColumnDataSource]]`
+ src/bokeh/models/annotations/annotation.py:67:35: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[ColumnDataSource]` does not satisfy upper bound `Serializable` of type variable `S`
+ src/bokeh/models/annotations/annotation.py:67:35: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `DataSource | UndefinedType | IntrinsicType`, found `InstanceDefault[ColumnDataSource]`
+ src/bokeh/models/annotations/geometry.py:298:47: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `() -&gt; Unknown` does not satisfy upper bound `Serializable` of type variable `S`
- src/bokeh/models/annotations/geometry.py:298:15: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[BoxInteractionHandles | (() -&gt; Unknown)]`
+ src/bokeh/models/annotations/geometry.py:298:47: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `BoxInteractionHandles | UndefinedType | IntrinsicType`, found `() -&gt; Unknown`
+ src/bokeh/models/annotations/legends.py:170:51: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[NoOverlap]` does not satisfy upper bound `Serializable` of type variable `S`
- src/bokeh/models/annotations/legends.py:170:26: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[LabelingPolicy | InstanceDefault[NoOverlap]]`
+ src/bokeh/models/annotations/legends.py:170:51: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `LabelingPolicy | UndefinedType | IntrinsicType`, found `InstanceDefault[NoOverlap]`
+ src/bokeh/models/annotations/legends.py:592:41: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[MetricLength]` does not satisfy upper bound `Serializable` of type variable `S`
- src/bokeh/models/annotations/legends.py:592:19: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[Dimensional | InstanceDefault[MetricLength]]`
+ src/bokeh/models/annotations/legends.py:592:41: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Dimensional | UndefinedType | IntrinsicType`, found `InstanceDefault[MetricLength]`
+ src/bokeh/models/annotations/legends.py:722:31: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[FixedTicker]` does not satisfy upper bound `Serializable` of type variable `S`
- src/bokeh/models/annotations/legends.py:722:14: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[Ticker | InstanceDefault[FixedTicker]]`
+ src/bokeh/models/annotations/legends.py:722:31: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Ticker | UndefinedType | IntrinsicType`, found `InstanceDefault[FixedTicker]`
+ src/bokeh/models/annotations/legends.py:823:51: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[NoOverlap]` does not satisfy upper bound `Serializable` of type variable `S`
- src/bokeh/models/annotations/legends.py:823:26: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[LabelingPolicy | InstanceDefault[NoOverlap]]`
+ src/bokeh/models/annotations/legends.py:823:51: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `LabelingPolicy | UndefinedType | IntrinsicType`, found `InstanceDefault[NoOverlap]`
+ src/bokeh/models/axes.py:201:51: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[AllLabels]` does not satisfy upper bound `Serializable` of type variable `S`
- src/bokeh/models/axes.py:201:26: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[LabelingPolicy | InstanceDefault[AllLabels]]`
+ src/bokeh/models/axes.py:201:51: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `LabelingPolicy | UndefinedType | IntrinsicType`, found `InstanceDefault[AllLabels]`
- src/bokeh/models/coordinates.py:48:16: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[Range | InstanceDefault[DataRange1d]]`
- src/bokeh/models/coordinates.py:52:16: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[Range | InstanceDefault[DataRange1d]]`
- src/bokeh/models/coordinates.py:56:15: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[Scale | InstanceDefault[LinearScale]]`
- src/bokeh/models/coordinates.py:61:15: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Instance[S@Instance]`, found `Instance[Scale | InstanceDefault[LinearScale]]`
+ src/bokeh/models/coordinates.py:48:32: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[DataRange1d]` does not satisfy upper bound `Serializable` of type variable `S`
+ src/bokeh/models/coordinates.py:48:32: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Range | UndefinedType | IntrinsicType`, found `InstanceDefault[DataRange1d]`
+ src/bokeh/models/coordinates.py:52:32: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[DataRange1d]` does not satisfy upper bound `Serializable` of type variable `S`
+ src/bokeh/models/coordinates.py:52:32: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Range | UndefinedType | IntrinsicType`, found `InstanceDefault[DataRange1d]`
+ src/bokeh/models/coordinates.py:56:31: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Argument type `InstanceDefault[LinearScale]` does not satisfy upper bound `Serializable` of type variable `S`
+ src/bokeh/models/coordinates.py:56:31: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Scale | UndefinedType | IntrinsicType`, found `InstanceDefault[LinearScale]`
+ src/bokeh/models/coordinates.py:61:31: error[invalid-argument-type] Argument to bound method `__ini

... (truncated 693 lines) ...
</code></pre>


<p>No memory usage changes detected âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-10 12:26</div>
            <div class="timeline-body">

<code>ecosystem-analyzer</code> results
<p>| Lint rule | Added | Removed | Changed |
|-----------|------:|--------:|--------:|
| <code>type-assertion-failure</code> | 2 | 121 | 90 |
| <code>invalid-argument-type</code> | 41 | 86 | 36 |
| <code>no-matching-overload</code> | 2 | 96 | 0 |
| <code>unsupported-operator</code> | 4 | 64 | 1 |
| <code>invalid-assignment</code> | 1 | 24 | 4 |
| <code>unused-ignore-comment</code> | 2 | 26 | 0 |
| <code>possibly-missing-attribute</code> | 3 | 21 | 0 |
| <code>invalid-return-type</code> | 0 | 18 | 2 |
| <code>unresolved-attribute</code> | 2 | 13 | 4 |
| <code>non-subscriptable</code> | 0 | 5 | 0 |
| <code>missing-argument</code> | 0 | 4 | 0 |
| <code>not-iterable</code> | 0 | 2 | 0 |
| <code>unsupported-base</code> | 0 | 1 | 0 |
| <strong>Total</strong> | <strong>57</strong> | <strong>481</strong> | <strong>137</strong> |</p>
<p><strong><a href="https://david-fix-1837.ecosystem-663.pages.dev/diff">Full report with detailed diff</a></strong> (<a href="https://david-fix-1837.ecosystem-663.pages.dev/timing">timing results</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> removed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 12:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 12:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2025-12-10 13:11</div>
            <div class="timeline-body">

<a href="https://codspeed.io/astral-sh/ruff/branches/david%2Ffix-1837?utm_source=github&amp;utm_medium=comment&amp;utm_content=header">CodSpeed Performance Report</a>
Merging #21893 will <strong>degrade performances by 9.79%</strong>
<p>Comparing <code>david/fix-1837</code> (7a85fe2) with <code>main</code> (ff7086d)</p>
Summary
<p><code>âŒ 1 (ðŸ‘ 1)</code> regression<br>
<code>âœ… 21</code> untouched<br>
<code>â© 30</code> skipped[^skipped]</p>
Benchmarks breakdown
<p>|     | Mode | Benchmark | <code>BASE</code> | <code>HEAD</code> | Change |
| --- | ---- | --------- | ------ | ------ | ------ |
| ðŸ‘ | WallTime | <a href="https://codspeed.io/astral-sh/ruff/branches/david%2Ffix-1837?uri=crates%2Fruff_benchmark%2Fbenches%2Fty_walltime.rs%3A%3Amedium%5Bcolour-science%5D&amp;runnerMode=WallTime&amp;utm_source=github&amp;utm_medium=comment&amp;utm_content=benchmark"><code>medium[colour-science]</code></a> | 98.5 s | 109.2 s | -9.79% |
[^skipped]: 30 benchmarks were skipped, so the baseline results were used instead. If they were deleted from the codebase, <a href="https://codspeed.io/astral-sh/ruff/branches/david%2Ffix-1837?sectionId=benchmark-comparison-section-baseline-result-skipped&amp;utm_source=github&amp;utm_medium=comment&amp;utm_content=archive">click here and archive them to remove them from the performance reports</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 13:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 13:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 13:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 13:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/generics.rs</code>:1600 on 2025-12-10 13:39</div>
            <div class="timeline-body"><p>Does this work? Might help perf</p>
<pre><code>                            found_matching_element = true;
                            break;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-12-10 13:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-12-10 13:40</div>
            <div class="timeline-body"><p>LGTM. <code>colour</code> is known to have pathological types, that&#x27;s why we added it as a benchmark :/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-12-10 13:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/src/types/generics.rs</code>:1600 on 2025-12-10 13:45</div>
            <div class="timeline-body"><p>That would certainly help with performance, but it&#x27;s not correct (and several tests fail) :smile:. We need to keep iterating in case other union elements help us solve more typevars.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-12-10 13:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/generics.rs</code>:1600 on 2025-12-10 13:47</div>
            <div class="timeline-body"><p>all my reviews are from my iPad today so unlike usual I am not trying out any of my crazy suggestions locally before posting comments ðŸ˜¶</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 13:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 13:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-10 13:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:21:34 UTC
    </footer>
</body>
</html>
