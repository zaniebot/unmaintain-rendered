```yaml
number: 6875
title: Use optional parentheses for tuples in return statements
type: pull_request
state: merged
author: MichaReiser
labels:
  - formatter
assignees: []
merged: true
base: main
head: return-tuple-parentheses
created_at: 2023-08-25T16:15:43Z
updated_at: 2023-08-29T06:30:06Z
url: https://github.com/astral-sh/ruff/pull/6875
synced_at: 2026-01-12T15:55:22Z
```

# Use optional parentheses for tuples in return statements

---

_@MichaReiser_

<!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

## Summary

This PR aligns our tuple formatting in return statements with black. 

Black avoids parenthesizing tuples in return statements if breaking by any other parentheses
can make it fit.

The same behavior applies to `yield`, but implementing it is more involved because yield is an expression (and can be nested). I quickly checked, and implementing it didn't increase similarity for any project. I guess, yielding a tuple isn't as common, so I removed the implementation again.

<!-- What's the purpose of the change? What does it do, and why? -->

## Test Plan

Added tests

<!-- How was it tested? -->


---

_Comment by @MichaReiser on 2023-08-25 16:15_

Current dependencies on/for this PR:
* main
  * **PR #6875** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6875" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.svg" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/6875?utm_source=stack-comment).

---

_Renamed from "Use optional parentheses for tuples in yield/return" to "Use optional parentheses for tuples in return statements" by @MichaReiser on 2023-08-25 16:21_

---

_Marked ready for review by @MichaReiser on 2023-08-25 16:23_

---

_Label `formatter` added by @MichaReiser on 2023-08-25 16:23_

---

_Comment by @github-actions[bot] on 2023-08-25 17:10_

## PR Check Results
### Benchmark
#### Linux
```
group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      4.4Â±0.03ms     9.2 MB/sec    1.01      4.5Â±0.04ms     9.1 MB/sec
formatter/numpy/ctypeslib.py               1.01    855.2Â±5.50Âµs    19.5 MB/sec    1.00    850.3Â±5.13Âµs    19.6 MB/sec
formatter/numpy/globals.py                 1.00     79.8Â±0.26Âµs    37.0 MB/sec    1.00     79.9Â±0.70Âµs    36.9 MB/sec
formatter/pydantic/types.py                1.01  1653.3Â±20.02Âµs    15.4 MB/sec    1.00  1637.3Â±14.70Âµs    15.6 MB/sec
linter/all-rules/large/dataset.py          1.00     10.2Â±0.07ms     4.0 MB/sec    1.01     10.3Â±0.03ms     4.0 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      2.8Â±0.01ms     5.9 MB/sec    1.01      2.8Â±0.01ms     5.9 MB/sec
linter/all-rules/numpy/globals.py          1.00    311.2Â±1.59Âµs     9.5 MB/sec    1.00    311.7Â±1.58Âµs     9.5 MB/sec
linter/all-rules/pydantic/types.py         1.00      5.4Â±0.03ms     4.8 MB/sec    1.00      5.4Â±0.03ms     4.8 MB/sec
linter/default-rules/large/dataset.py      1.00      5.4Â±0.01ms     7.6 MB/sec    1.01      5.4Â±0.01ms     7.5 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00   1141.7Â±4.12Âµs    14.6 MB/sec    1.01   1153.3Â±5.87Âµs    14.4 MB/sec
linter/default-rules/numpy/globals.py      1.00    118.5Â±0.78Âµs    24.9 MB/sec    1.01    119.9Â±0.46Âµs    24.6 MB/sec
linter/default-rules/pydantic/types.py     1.00      2.4Â±0.02ms    10.5 MB/sec    1.00      2.4Â±0.01ms    10.4 MB/sec
```

#### Windows
```
group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      5.3Â±0.09ms     7.7 MB/sec    1.00      5.3Â±0.10ms     7.6 MB/sec
formatter/numpy/ctypeslib.py               1.00  1020.4Â±13.66Âµs    16.3 MB/sec    1.01  1031.2Â±15.01Âµs    16.1 MB/sec
formatter/numpy/globals.py                 1.00     96.9Â±2.04Âµs    30.4 MB/sec    1.02     99.1Â±6.91Âµs    29.8 MB/sec
formatter/pydantic/types.py                1.00  1962.3Â±24.98Âµs    13.0 MB/sec    1.02  1999.8Â±35.26Âµs    12.8 MB/sec
linter/all-rules/large/dataset.py          1.02     12.7Â±0.16ms     3.2 MB/sec    1.00     12.5Â±0.14ms     3.3 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.01      3.5Â±0.04ms     4.8 MB/sec    1.00      3.4Â±0.03ms     4.9 MB/sec
linter/all-rules/numpy/globals.py          1.01    436.9Â±7.22Âµs     6.8 MB/sec    1.00    433.5Â±7.78Âµs     6.8 MB/sec
linter/all-rules/pydantic/types.py         1.03      6.6Â±0.09ms     3.8 MB/sec    1.00      6.5Â±0.06ms     3.9 MB/sec
linter/default-rules/large/dataset.py      1.02      7.0Â±0.08ms     5.8 MB/sec    1.00      6.9Â±0.06ms     5.9 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1488.5Â±20.72Âµs    11.2 MB/sec    1.00  1482.4Â±26.51Âµs    11.2 MB/sec
linter/default-rules/numpy/globals.py      1.00    173.7Â±3.73Âµs    17.0 MB/sec    1.02    177.2Â±4.34Âµs    16.7 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.1Â±0.04ms     8.2 MB/sec    1.00      3.1Â±0.05ms     8.2 MB/sec
```
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

---

_Comment by @codspeed-hq[bot] on 2023-08-27 09:31_

## [CodSpeed Performance Report](https://codspeed.io/astral-sh/ruff/branches/return-tuple-parentheses)

### Merging #6875 will **not alter performance**

<sub>:warning: No base runs were found</sub>

<sub>Falling back to comparing <code>return-tuple-parentheses</code> (19c2c62) with <code>main</code> (f33277a)</sub>



### Summary

`âœ… 16` untouched benchmarks






---

_Review requested from @charliermarsh by @MichaReiser on 2023-08-28 05:49_

---

_@charliermarsh approved on 2023-08-28 17:56_

---

_Merged by @MichaReiser on 2023-08-29 06:30_

---

_Closed by @MichaReiser on 2023-08-29 06:30_

---

_Branch deleted on 2023-08-29 06:30_

---
