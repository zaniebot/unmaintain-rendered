<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Remove parentheses around multiple exception types on Python 3.14+ - astral-sh/ruff #20768</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Remove parentheses around multiple exception types on Python 3.14+</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/20768">#20768</a>
        opened by <a href="https://github.com/ntBre">@ntBre</a>
        on 2025-10-08 15:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR implements the black preview style from https://github.com/psf/black/pull/4720. As of Python 3.14, you're allowed to omit the parentheses around groups of exceptions, as long as there's no <code>as</code> binding:</p>
<p><strong>3.13</strong></p>
<pre><code class="language-pycon">Python 3.13.4 (main, Jun  4 2025, 17:37:06) [Clang 20.1.4 ] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; try: ...
... except (Exception, BaseException): ...
...
Ellipsis
&gt;&gt;&gt; try: ...
... except Exception, BaseException: ...
...
  File &quot;&lt;python-input-1&gt;&quot;, line 2
    except Exception, BaseException: ...
           ^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: multiple exception types must be parenthesized
</code></pre>
<p><strong>3.14</strong></p>
<pre><code class="language-pycon">Python 3.14.0rc2 (main, Sep  2 2025, 14:20:56) [Clang 20.1.4 ] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; try: ...
... except Exception, BaseException: ...
...
Ellipsis
&gt;&gt;&gt; try: ...
... except (Exception, BaseException): ...
...
Ellipsis
&gt;&gt;&gt; try: ...
... except Exception, BaseException as e: ...
...
  File &quot;&lt;python-input-2&gt;&quot;, line 2
    except Exception, BaseException as e: ...
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: multiple exception types must be parenthesized when using 'as'
</code></pre>
<p>I think this ended up being pretty straightforward, at least once Micha showed me where to start :)</p>
<h2>Test Plan</h2>
<p>New tests</p>
<p>At first I thought we were deviating from black in how we handle comments within the exception type tuple, but I think this applies to how we format all tuples, not specifically with the new preview style.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @ntBre on 2025-10-08 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @ntBre on 2025-10-08 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-08 15:32</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @ntBre on 2025-10-08 15:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @ntBre on 2025-10-08 15:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-10-08 15:55</div>
            <div class="timeline-body"><p>Looks great.</p>
<p>I just realized that we haven't updated our black tests in a while. It's something I normally do before working on preview styles because we then &quot;inherit&quot; the black tests</p>
<p>Would you mind updating the black tests in a separate PR that we can merge first to get more test coverage?</p>
<p>Updating is normally very smooth but you might run into problems if Black changed their test structure. All that's needed is to run</p>
<p>https://github.com/astral-sh/ruff/blob/a9efdea113a4f676ef85d89ed2dc285f7087478d/crates/ruff_python_formatter/resources/test/fixtures/import_black_tests.py</p>
<p>I believe it takes a path to black's checkout as an argument</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">great writeup</span> added by @MichaReiser on 2025-10-08 16:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-14 14:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/tests/snapshots/black_compatibility@cases__remove_except_types_parens.py.snap</code>:1 on 2025-10-14 14:50</div>
            <div class="timeline-body"><p>Nice. The most satisfying feeling ever when working on the formatter :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-10-14 15:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-10-14 15:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-10-14 15:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:16:17 UTC
    </footer>
</body>
</html>
