<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Initial test suite for `TypedDict` - astral-sh/ruff #19686</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Initial test suite for <code>TypedDict</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/19686">#19686</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-08-01 13:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a></div>
            <div class="timeline-body">Summary
<p>Adds an initial set of tests based on the highest-priority items in <a href="https://github.com/astral-sh/ty/issues/154">astral-sh/ty#154</a>. This is certainly not yet exhaustive (required/non-required, <code>total</code>, and other things are missing), but will be useful to measure progress on this feature.</p>
Test Plan
<p>Checked intended behavior against runtime and other type checkers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:18 on 2025-08-01 13:58</div>
            <div class="timeline-body"><p>This is a bit nitpicky, but I&#x27;d prefer for us to be very precise with our language here. At runtime, there&#x27;s no object <code>x</code> for which <code>isinstance(x, Person)</code> will return <code>True</code> -- in fact, you get an exception raised if you try to do that!</p>
<pre><code>&gt;&gt;&gt; import typing
&gt;&gt;&gt; class Person(typing.TypedDict):
...     name: str
...     age: int | None
...     
&gt;&gt;&gt; alice: Person = {&quot;name&quot;: &quot;Alice&quot;, &quot;age&quot;: None}
&gt;&gt;&gt; isinstance(alice, Person)
Traceback (most recent call last):
  File &quot;&lt;python-input-4&gt;&quot;, line 1, in &lt;module&gt;
    isinstance(alice, Person)
    ~~~~~~~~~~^^^^^^^^^^^^^^^
  File &quot;/Users/alexw/.pyenv/versions/3.13.1/lib/python3.13/typing.py&quot;, line 3231, in __subclasscheck__
    raise TypeError(&#x27;TypedDict does not support instance and class checks&#x27;)
TypeError: TypedDict does not support instance and class checks
</code></pre>
<p>So rather than <em>instances of the class</em> here (a runtime concept), I would talk about <em>inhabitants of the type</em> (a static concept).</p>
<p>Also: I would describe it as &quot;accessing keys&quot; rather than &quot;accessing properties&quot;:</p>
<pre><code>New inhabitants can be created from dict literals. When accessing keys, the correct types should
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:30 on 2025-08-01 14:00</div>
            <div class="timeline-body"><pre><code>Inhabitants can also be created through a constructor call:
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:36 on 2025-08-01 14:00</div>
            <div class="timeline-body"><pre><code>Methods that are available on `dict` are also available on `TypedDict` inhabitants:
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:42 on 2025-08-01 14:01</div>
            <div class="timeline-body"><pre><code>Construction of inhabitants is checked for type correctness:
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:93 on 2025-08-01 14:03</div>
            <div class="timeline-body"><p>but notably (and, often, confusingly): they <em>cannot</em> be assigned to <code>dict[str, Any]</code>. (I can&#x27;t remember the precise reason for this.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:122 on 2025-08-01 14:04</div>
            <div class="timeline-body"><pre><code>class itself, nor on inhabitants of the type defined by the class:
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:140 on 2025-08-01 14:05</div>
            <div class="timeline-body"><pre><code>`TypedDict` class definitions have some special properties that can be used for introspection:
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:214 on 2025-08-01 14:06</div>
            <div class="timeline-body"><p>could be worth adding a PEP-695 example too?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-08-01 14:06</div>
            <div class="timeline-body"><p>Nice!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:93 on 2025-08-01 14:20</div>
            <div class="timeline-body"><p>I assume it&#x27;s because <code>Mapping</code> is read-only? If they were assignable to <code>dict[str, Any]</code>, we could pass them to a function that modifies/deletes keys in ways that would break <code>TypedDict</code> invariants?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-08-01 14:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-08-01 14:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:93 on 2025-08-01 14:22</div>
            <div class="timeline-body"><p>hmm, yes, that sounds about right</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-08-01 14:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_python_semantic/resources/mdtest/typed_dict.md</code>:18 on 2025-08-01 14:25</div>
            <div class="timeline-body"><p>Thanks. I don&#x27;t mind nitpicky comments, quite the contrary. Keep them coming ;-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-01 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-01 14:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:17:15 UTC
    </footer>
</body>
</html>
