<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add rule to enforce parentheses in `a or b and c` - astral-sh/ruff #9440</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add rule to enforce parentheses in <code>a or b and c</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9440">#9440</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-01-08 15:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 15:22</div>
            <div class="timeline-body"><p>Fixes #8721</p>
<h2>Summary</h2>
<p>This implements the rule proposed in #8721, as RUF021. <code>and</code> always binds more tightly than <code>or</code> when chaining the two together.</p>
<p>(This should definitely be autofixable, but I'm leaving that to a followup PR for now.)</p>
<h2>Test Plan</h2>
<p><code>cargo test</code> / <code>cargo insta review</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-01-08 15:41</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚úÖ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+93 -0 violations, +0 -0 fixes in 11 projects; 32 projects unchanged)</p>
<details><summary><a href="https://github.com/DisnakeDev/disnake">DisnakeDev/disnake</a> (+5 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/DisnakeDev/disnake/blob/a5c1a8f902e9a7e173f71e65827d59de8a445adb/disnake/ext/commands/converter.py#L1168'>disnake/ext/commands/converter.py:1168:12:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/DisnakeDev/disnake/blob/a5c1a8f902e9a7e173f71e65827d59de8a445adb/disnake/interactions/base.py#L1880'>disnake/interactions/base.py:1880:21:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/DisnakeDev/disnake/blob/a5c1a8f902e9a7e173f71e65827d59de8a445adb/disnake/interactions/base.py#L1905'>disnake/interactions/base.py:1905:21:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/DisnakeDev/disnake/blob/a5c1a8f902e9a7e173f71e65827d59de8a445adb/disnake/interactions/base.py#L1923'>disnake/interactions/base.py:1923:18:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/DisnakeDev/disnake/blob/a5c1a8f902e9a7e173f71e65827d59de8a445adb/disnake/interactions/base.py#L213'>disnake/interactions/base.py:213:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+6 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/cli/utils.py#L74'>rasa/cli/utils.py:74:27:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/core/processor.py#L587'>rasa/core/processor.py:587:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/shared/core/training_data/structures.py#L619'>rasa/shared/core/training_data/structures.py:619:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/shared/core/training_data/structures.py#L621'>rasa/shared/core/training_data/structures.py:621:20:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/utils/train_utils.py#L534'>rasa/utils/train_utils.py:534:9:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/utils/train_utils.py#L536'>rasa/utils/train_utils.py:536:12:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+15 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/metrics/validators.py#L217'>airflow/metrics/validators.py:217:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/models/dag.py#L3222'>airflow/models/dag.py:3222:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/models/dagrun.py#L1070'>airflow/models/dagrun.py:1070:20:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/operators/python.py#L369'>airflow/operators/python.py:369:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/providers/cncf/kubernetes/operators/pod.py#L389'>airflow/providers/cncf/kubernetes/operators/pod.py:389:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/providers/oracle/hooks/oracle.py#L298'>airflow/providers/oracle/hooks/oracle.py:298:38:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/serialization/serde.py#L220'>airflow/serialization/serde.py:220:8:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/www/utils.py#L827'>airflow/www/utils.py:827:20:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/www/utils.py#L840'>airflow/www/utils.py:840:20:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/apache/airflow/blob/9264a4b4e21702a2bc71bb77ee3cc4ada9dfd5e7/airflow/www/validators.py#L50'>airflow/www/validators.py:50:32:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
... 5 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/1e932c157d9e3e973617e39065759a2dae4147a9/src/bokeh/core/property/dataspec.py#L334'>src/bokeh/core/property/dataspec.py:334:35:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/bokeh/bokeh/blob/1e932c157d9e3e973617e39065759a2dae4147a9/src/bokeh/plotting/_graph.py#L74'>src/bokeh/plotting/_graph.py:74:8:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/ibis-project/ibis/blob/a46bd4a15eb6bf746541cbb73d40aff18384230b/ibis/expr/analysis.py#L339'>ibis/expr/analysis.py:339:20:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/ibis-project/ibis/blob/a46bd4a15eb6bf746541cbb73d40aff18384230b/ibis/expr/datatypes/cast.py#L122'>ibis/expr/datatypes/cast.py:122:9:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/ibis-project/ibis/blob/a46bd4a15eb6bf746541cbb73d40aff18384230b/ibis/expr/datatypes/cast.py#L124'>ibis/expr/datatypes/cast.py:124:12:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/ibis-project/ibis/blob/a46bd4a15eb6bf746541cbb73d40aff18384230b/ibis/expr/datatypes/cast.py#L127'>ibis/expr/datatypes/cast.py:127:12:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/milvus-io/pymilvus">milvus-io/pymilvus</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/milvus-io/pymilvus/blob/f3933024f8860ebd10e2447c62c5c9dc65e1d9dd/pymilvus/client/check.py#L238'>pymilvus/client/check.py:238:26:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+33 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/asv_bench/benchmarks/groupby.py#L514'>asv_bench/benchmarks/groupby.py:514:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/_testing/asserters.py#L754'>pandas/_testing/asserters.py:754:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/_testing/asserters.py#L756'>pandas/_testing/asserters.py:756:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/_testing/asserters.py#L911'>pandas/_testing/asserters.py:911:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/_testing/asserters.py#L913'>pandas/_testing/asserters.py:913:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/arrays/arrow/array.py#L1407'>pandas/core/arrays/arrow/array.py:1407:20:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/computation/eval.py#L340'>pandas/core/computation/eval.py:340:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/computation/expr.py#L510'>pandas/core/computation/expr.py:510:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/computation/pytables.py#L410'>pandas/core/computation/pytables.py:410:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/computation/pytables.py#L412'>pandas/core/computation/pytables.py:412:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/dtypes/dtypes.py#L1061'>pandas/core/dtypes/dtypes.py:1061:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/dtypes/dtypes.py#L1714'>pandas/core/dtypes/dtypes.py:1714:21:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/frame.py#L4035'>pandas/core/frame.py:4035:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/frame.py#L6894'>pandas/core/frame.py:6894:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/indexes/range.py#L1042'>pandas/core/indexes/range.py:1042:34:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/internals/construction.py#L493'>pandas/core/internals/construction.py:493:24:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/pandas-dev/pandas/blob/8cb60d0e229c1e2ca3661961e98e3365eb65336d/pandas/core/resample.py#L2126'>pandas/core/resample.py:2126:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
... 16 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python-poetry/poetry">python-poetry/poetry</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/python-poetry/poetry/blob/7497e457592336cc9f4f7ec2833225916b8b43d1/src/poetry/console/io/inputs/run_argv_input.py#L48'>src/poetry/console/io/inputs/run_argv_input.py:48:38:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/python-poetry/poetry/blob/7497e457592336cc9f4f7ec2833225916b8b43d1/src/poetry/utils/dependency_specification.py#L161'>src/poetry/utils/dependency_specification.py:161:16:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/python-poetry/poetry/blob/7497e457592336cc9f4f7ec2833225916b8b43d1/src/poetry/utils/env/env_manager.py#L235'>src/poetry/utils/env/env_manager.py:235:33:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/rotki/rotki">rotki/rotki</a> (+17 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/accounting/export/csv.py#L155'>rotkehlchen/accounting/export/csv.py:155:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/accounting/export/csv.py#L156'>rotkehlchen/accounting/export/csv.py:156:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/api/rest.py#L1076'>rotkehlchen/api/rest.py:1076:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/api/rest.py#L1077'>rotkehlchen/api/rest.py:1077:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/api/v1/schemas.py#L3223'>rotkehlchen/api/v1/schemas.py:3223:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/api/v1/schemas.py#L3224'>rotkehlchen/api/v1/schemas.py:3224:13:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/assets/utils.py#L261'>rotkehlchen/assets/utils.py:261:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/chain/ethereum/modules/uniswap/v2/common.py#L134'>rotkehlchen/chain/ethereum/modules/uniswap/v2/common.py:134:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/chain/ethereum/modules/yearn/vaults.py#L153'>rotkehlchen/chain/ethereum/modules/yearn/vaults.py:153:9:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/rotki/rotki/blob/b106564d79ab9a6407df783857bac262fbdbdbb7/rotkehlchen/chain/evm/decoding/metamask/decoder.py#L75'>rotkehlchen/chain/evm/decoding/metamask/decoder.py:75:17:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
... 7 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/scikit-build/scikit-build-core">scikit-build/scikit-build-core</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/scikit-build/scikit-build-core/blob/f8c5798897852e107df0683893de59e15c558baf/tests/test_settings_overrides.py#L401'>tests/test_settings_overrides.py:401:45:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+6 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/zulip/zulip/blob/37c1b8891702716ae13e89c51aa548b54a547020/tools/lib/provision.py#L163'>tools/lib/provision.py:163:4:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/zulip/zulip/blob/37c1b8891702716ae13e89c51aa548b54a547020/tools/lib/provision.py#L163'>tools/lib/provision.py:163:51:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/zulip/zulip/blob/37c1b8891702716ae13e89c51aa548b54a547020/tools/lib/template_parser.py#L677'>tools/lib/template_parser.py:677:52:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/zulip/zulip/blob/37c1b8891702716ae13e89c51aa548b54a547020/zerver/lib/cache.py#L656'>zerver/lib/cache.py:656:12:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/zulip/zulip/blob/37c1b8891702716ae13e89c51aa548b54a547020/zerver/models/users.py#L1049'>zerver/models/users.py:1049:9:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
+ <a href='https://github.com/zulip/zulip/blob/37c1b8891702716ae13e89c51aa548b54a547020/zerver/models/users.py#L1051'>zerver/models/users.py:1051:12:</a> RUF021 Parenthesize `a and b` expressions when chaining `and` and `or` together, to make the precedence clear
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF021 | 93 | 93 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 15:44</div>
            <div class="timeline-body"><blockquote>
<p><code>ruff-ecosystem</code> results</p>
</blockquote>
<p>I found 45 errors on the mypy codebase when running ruff manually with this branch, interestingly (I guess mypy isn't one of the repos in the <code>ruff ecosystem</code> report at the moment). That's much more than any of the ones in the report here. Maybe AST munging in Python is particularly likely to end up with long comparison chains? ü§∑</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 15:59</div>
            <div class="timeline-body"><p>I did a bit of manual testing with some of the mypy hits I found from running ruff manually with this branch. In particular, this span triggers six instances(!) of the new warning: https://github.com/python/mypy/blob/35f402c74205d373b81076ea82f507eb85161a25/mypy/messages.py#L2940-L2955</p>
<p>Applying this diff to mypy fixes all of them, while maintaining an identical Python AST. (And, neither <code>ruff format</code> nor <code>Black</code> would strip away the new parentheses.)</p>
<details>

<pre><code class="language-diff">diff --git a/mypy/messages.py b/mypy/messages.py
index 450faf4c1..7dee269b1 100644
--- a/mypy/messages.py
+++ b/mypy/messages.py
@@ -2938,20 +2938,16 @@ def get_bad_protocol_flags(
     bad_flags = []
     for name, subflags, superflags in all_flags:
         if (
-            IS_CLASSVAR in subflags
-            and IS_CLASSVAR not in superflags
-            and IS_SETTABLE in superflags
-            or IS_CLASSVAR in superflags
-            and IS_CLASSVAR not in subflags
-            or IS_SETTABLE in superflags
-            and IS_SETTABLE not in subflags
-            or IS_CLASS_OR_STATIC in superflags
-            and IS_CLASS_OR_STATIC not in subflags
-            or class_obj
-            and IS_VAR in superflags
-            and IS_CLASSVAR not in subflags
-            or class_obj
-            and IS_CLASSVAR in superflags
+            (
+                IS_CLASSVAR in subflags
+                and IS_CLASSVAR not in superflags
+                and IS_SETTABLE in superflags
+            )
+            or (IS_CLASSVAR in superflags and IS_CLASSVAR not in subflags)
+            or (IS_SETTABLE in superflags and IS_SETTABLE not in subflags)
+            or (IS_CLASS_OR_STATIC in superflags and IS_CLASS_OR_STATIC not in subflags)
+            or (class_obj and IS_VAR in superflags and IS_CLASSVAR not in subflags)
+            or (class_obj and IS_CLASSVAR in superflags)
         ):
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 16:14</div>
            <div class="timeline-body"><p>I skimmed through most of the ecosystem results; I can't <em>see</em> any false positives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:34 on 2024-01-08 17:26</div>
            <div class="timeline-body"><p>I think you're missing a trailing <code>```</code> here? (Although CommonMark will insert an implicit closing <code>```</code> for you.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 17:34</div>
            <div class="timeline-body"><p>Do you need to explicitly match <code>BoolOp::And</code> here? Thinking about this, I <em>think</em> you could also match <code>BoolOp::Or</code> here and the behavior would be unchanged? A quick comment noting this might be useful because the presence of <code>And</code> and not <code>Or</code> confused me for a moment. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> approved on 2024-01-08 17:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-01-08 17:40</div>
            <div class="timeline-body"><p>Looking through the ecosystem results, I see a few instances of the <code>x and y or z</code> idiom flagged. You also commonly see it used as <code>x and y or None</code>. I wonder if we want to flag those? AIUI, it's a somewhat common tactic for a ternary operator in Python, although it <a href="https://stackoverflow.com/questions/39080416/x-and-y-or-z-ternary-operator">has some gotchas</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 17:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 17:51</div>
            <div class="timeline-body"><p>Yeah, I don't <em>think</em> we <em>need</em> to explicitly match <code>BoolOp::And</code> here:</p>
<ul>
<li>An <code>or</code> chained with an <code>or</code> (or an <code>and</code> chained with an <code>and</code>) will just result in a <code>BoolOp</code> with three items in the <code>values</code> list, since the two operators have the same precedence</li>
<li>An <code>and</code> chained with an <code>or</code> (or an <code>or</code> chained with an <code>and</code>) will both result in an <code>And</code> <code>BoolOp</code> inside an <code>Or</code> <code>BoolOp</code>, because the AST reflects the fact that <code>and</code> always binds more tightly than <code>or</code>.</li>
</ul>
<p>Why did I leave this the way I did? Two reasons:</p>
<ol>
<li>I got scared I was incorrect in my reasoning ^above, and it seemed &quot;safer&quot; to explicitly check here that it <em>was</em> an <code>And</code>, for some definition of the word &quot;safe&quot; :) I could maybe turn it into an assertion instead, to check the invariant holds true -- WDYT?</li>
<li>It seemed <em>slightly</em> more readable this way, as now it's obvious to the reader of the code that the subexpression is an <code>And</code> <code>BoolOp</code>. But that could also be done equally well with an assertion, I suppose!</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 17:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:34 on 2024-01-08 17:52</div>
            <div class="timeline-body"><p>oops, good catch üò∂</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 18:02</div>
            <div class="timeline-body"><blockquote>
<p>Looking through the ecosystem results, I see a few instances of the <code>x and y or z</code> idiom flagged. You also commonly see it used as <code>x and y or None</code>. I wonder if we want to flag those? AIUI, it's a somewhat common tactic for a ternary operator in Python, although it <a href="https://stackoverflow.com/questions/39080416/x-and-y-or-z-ternary-operator">has some gotchas</a>.</p>
</blockquote>
<p>Hmmm... I know it's reasonably common, especially in older codebases, but I'd honestly consider that something of an antipattern due to those gotchas. I'd definitely object to it if somebody tried submitting a CPython PR with it üòÑ</p>
<p>I suppose the precedence for <code>x and y or z</code> is less surprising than for <code>x or y and z</code>, so we <em>could</em> exclude it for now. But I lean towards leaving it in -- codebases who find it too opinionated can presumably just not opt into this rule? WDYT?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2024-01-08 18:03</div>
            <div class="timeline-body"><h2><a href="https://codspeed.io/astral-sh/ruff/branches/AlexWaygood:force-parens-lint">CodSpeed Performance Report</a></h2>
<h3>Merging #9440 will <strong>not alter performance</strong></h3>
<p><sub>Comparing <code>AlexWaygood:force-parens-lint</code> (ab36c83) with <code>main</code> (f419af4)</sub></p>
<h3>Summary</h3>
<p><code>‚úÖ 30</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-08 18:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:43 on 2024-01-08 18:03</div>
            <div class="timeline-body"><p>Nit can we say <code>A and B</code> or <code>a and b</code>, instead of <code>foo</code> and <code>bar</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-08 18:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:49 on 2024-01-08 18:04</div>
            <div class="timeline-body"><p>Nit: as a kinda hacky thing, we typically add a rustdoc like <code>/// RUF021</code> to make it easy to jump to a rule definition from a code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-08 18:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:67 on 2024-01-08 18:04</div>
            <div class="timeline-body"><p>Does <code>expr.into()</code> work here, or <code>bool_op.into()</code> above?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-08 18:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 18:04</div>
            <div class="timeline-body"><p>Nit: I think you can omit the <code>{}</code> here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-08 18:05</div>
            <div class="timeline-body"><p>We could probably add an (unsafe) fix for this, if you're interested, by inserting parentheses around the expression.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 18:06</div>
            <div class="timeline-body"><blockquote>
<p>We could probably add an (unsafe) fix for this, if you're interested, by inserting parentheses around the expression.</p>
</blockquote>
<p>Yes, definitely! Would you prefer me to do that as part of this PR, or as a followup?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2024-01-08 18:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 18:08</div>
            <div class="timeline-body"><p>Oh I see now. You don't need to match on the operator at all. Just the existence of a nested <code>BoolOp</code> is enough. Right?</p>
<blockquote>
<p>because the AST reflects the fact that and always binds more tightly than or</p>
</blockquote>
<p>Ah I didn't realize that.</p>
<p>I think I would go with an <code>assert!</code> here. To me, the reasoning is that if your <em>assumption</em> here about the structure of the AST is wrong in some way, then it's likely this code has a bug, right? If so, IMO, it would be better to make that bug loud than to silently continue. i.e., &quot;this tripped a panic&quot; is easier to diagnose as errant behavior than &quot;this lint is producing false negatives.&quot; The latter might not be noticed at all. A short comment on the <code>assert!</code> explaining this would be helpful IMO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-01-08 18:10</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Looking through the ecosystem results, I see a few instances of the <code>x and y or z</code> idiom flagged. You also commonly see it used as <code>x and y or None</code>. I wonder if we want to flag those? AIUI, it's a somewhat common tactic for a ternary operator in Python, although it <a href="https://stackoverflow.com/questions/39080416/x-and-y-or-z-ternary-operator">has some gotchas</a>.</p>
</blockquote>
<p>Hmmm... I know it's reasonably common, especially in older codebases, but I'd honestly consider that something of an antipattern due to those gotchas. I'd definitely object to it if somebody tried submitting a CPython PR with it üòÑ</p>
<p>I suppose the precedence for <code>x and y or z</code> is less surprising than for <code>x or y and z</code>, so we <em>could</em> exclude it for now. But I lean towards leaving it in -- codebases who find it too opinionated can presumably just not opt into this rule? WDYT?</p>
</blockquote>
<p>I don't think I have a strong opinion here honestly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 18:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 18:10</div>
            <div class="timeline-body"><blockquote>
<p>Oh I see now. You don't need to match on the operator at all. Just the existence of a nested <code>BoolOp</code> is enough. Right?</p>
</blockquote>
<p>Precisely!</p>
<blockquote>
<p>I think I would go with an <code>assert!</code> here. To me, the reasoning is that if your <em>assumption</em> here about the structure of the AST is wrong in some way, then it's likely this code has a bug, right? If so, IMO, it would be better to make that bug loud than to silently continue. i.e., &quot;this tripped a panic&quot; is easier to diagnose as errant behavior than &quot;this lint is producing false negatives.&quot; The latter might not be noticed at all.</p>
</blockquote>
<p>Okay, that all makes sense. I'll make the change -- ü§û I'm right.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:67 on 2024-01-08 18:13</div>
            <div class="timeline-body"><p>yes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 18:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 18:33</div>
            <div class="timeline-body"><blockquote>
<p>Merging #9440 will <strong>degrade performances by 5.36%</strong></p>
</blockquote>
<p>That seems suboptimal... Are there any things I'm doing here that are obviously bad, performance-wise? Is this just because there are loads of <code>BoolOp</code> nodes in Python in general, and we have to visit all of them if this rule is enabled?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-08 18:41</div>
            <div class="timeline-body"><p>@AlexWaygood - Can you try rebasing or merging in <code>main</code>? We upgraded the Rust version, so my guess is that it's just comparing against the &quot;wrong&quot; baseline.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 18:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:43 on 2024-01-08 18:49</div>
            <div class="timeline-body"><p>Thoughts on the error message here? I was torn between the current one and this, which is more verbose but maybe easier to understand:</p>
<pre><code class="language-suggestion">            &quot;Parenthesize `a and b` expressions when chaining `and` and `or` together, to make it clear that `and` binds more tightly than `or`&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-08 18:52</div>
            <div class="timeline-body"><blockquote>
<p>Yes, definitely! Would you prefer me to do that as part of this PR, or as a followup?</p>
</blockquote>
<p>Separate PR is probably a better practice, since it'll enable this one to get merged sooner, but it's marginal :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on 2024-01-08 18:53</div>
            <div class="timeline-body"><blockquote>
<p>Hmmm... I know it's reasonably common, especially in older codebases, but I'd honestly consider that something of an antipattern due to those gotchas.</p>
</blockquote>
<p>I think it's mostly a legacy pattern from before the if-else ternary was added to Python (which was <a href="https://peps.python.org/pep-0308/">Python 2.5</a>). I'd be OK with having a linter flag this pattern.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-08 18:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:43 on 2024-01-08 18:53</div>
            <div class="timeline-body"><p>I have a minor pref for the version you already have here. We tend towards having shorter messages, and put motivation in the documentation... In the future, we'll also include links to the documentation in the linter output.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> reviewed on 2024-01-08 18:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:43 on 2024-01-08 18:54</div>
            <div class="timeline-body"><p>Agree with the shorter one too. I would expect most programmers to know what &quot;precedence&quot; means.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 18:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:43 on 2024-01-08 18:55</div>
            <div class="timeline-body"><p>Yeah, I also much prefer to keep things concise where possible. I'll keep this as it is then, thanks.</p>
<blockquote>
<p>In the future, we'll also include links to the documentation in the linter output.</p>
</blockquote>
<p>That sounds awesome!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 18:56</div>
            <div class="timeline-body"><blockquote>
<p>@AlexWaygood - Can you try rebasing or merging in <code>main</code>? We upgraded the Rust version, so my guess is that it's just comparing against the &quot;wrong&quot; baseline.</p>
</blockquote>
<p>Looks like that was the issue, thanks üòÖ By the way, do you have a preference between rebases or merge commits?</p>
<blockquote>
<p>Separate PR is probably a better practice, since it'll enable this one to get merged sooner, but it's marginal :)</p>
</blockquote>
<p>Expect a followup PR tomorrow :D</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-08 18:57</div>
            <div class="timeline-body"><p>@AlexWaygood - Within a PR, it's dealer's choice. But we always squash-and-merge (it's the only option enabled) when merging into <code>main</code>, such that every PR corresponds to a single commit. I personally tend to rebase my PRs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 22:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 22:29</div>
            <div class="timeline-body"><p>Well, the assertion fails on a bunch of stuff in the ecosystem checks, so I was obviously wrong about something somewhere üôÉ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @AlexWaygood on 2024-01-08 22:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 22:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 22:57</div>
            <div class="timeline-body"><p>Right, of course. It's very possible to have an <code>Or</code> inside an <code>And</code> -- but it only happens if the <code>or</code> is explicitly parenthesized (<em>otherwise</em> the <code>and</code> binds more tightly, but the parentheses override that). I.e.:</p>
<pre><code class="language-py">x = a and (b or c)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @AlexWaygood on 2024-01-08 23:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-08 23:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/parenthesize_logical_operators.rs</code>:74 on 2024-01-08 23:29</div>
            <div class="timeline-body"><p>fixed the crash in ab36c8382c4fd663db5f0c1c70b74a25c8fcc81f, and added some more comments :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-08 23:44</div>
            <div class="timeline-body"><p>Fixed the crash I accidentally introduced in 87ddff64a1934a5a0c9c00038551195315da1dd3. The ecosystem check is looking sane again now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @AlexWaygood on 2024-01-08 23:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-01-09 00:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2024-01-09 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @charliermarsh on 2024-01-09 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-01-09 01:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-09 01:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-09 01:28</div>
            <div class="timeline-body"><p>Very nice!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-09 07:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-01-11 11:42</div>
            <div class="timeline-body"><p>Re <code>x and y or z</code>, we have a preview rule, <a href="https://docs.astral.sh/ruff/rules/and-or-ternary/">and-or-ternary (PLR1706)</a>, linting and fixing that case.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:57:59 UTC
    </footer>
</body>
</html>
