<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add automation for updating our vendored typeshed stubs - astral-sh/ruff #11427</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add automation for updating our vendored typeshed stubs</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11427">#11427</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-05-14 17:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>This PR adds a workflow that will create an automated PR every two weeks to update our vendored typeshed stubs. Two notes:</p>
<ul>
<li><p>In order for a GitHub Action to be able to create automated PRs, we will need to tick this checkbox in our repo settings:</p>
<hr>
<p><img src="https://github.com/astral-sh/ruff/assets/66076021/7ca99c44-5cde-47af-8b9d-c00fc356d7ff" alt="image"></p>
<hr>
</li>
<li><p>CI will not be triggered on these automated PRs unless the PR is closed and reopened by a maintainer. I think there are workarounds for this limitation, but we haven&#x27;t succeeded in figuring out how to do them properly at typeshed or mypy, where we also have workflows to trigger automated PRs.</p>
</li>
</ul>
Test Plan
<p>A GitHub workflow cannot be tested unless it is run, and a workflow cannot be run unless it is already merged to the <code>main</code> branch of a repository. So, that&#x27;s what I did -- with my Ruff fork! I temporarily merged this PR to the <code>main</code> branch of my Ruff fork, and ran the workflow. You can see a demo PR here that was automatically created by running this workflow from my fork: <a href="https://github.com/AlexWaygood/ruff/pull/9">AlexWaygood/ruff#9</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-05-14 17:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-05-14 17:37</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> approved on 2024-05-14 17:39</div>
            <div class="timeline-body"><p>Looks good to me!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>.github/workflows/sync_typeshed.yaml</code>:61 on 2024-05-14 18:08</div>
            <div class="timeline-body"><p>Should we use the &quot;internal&quot; label to avoid adding this to the changelog?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-05-14 18:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-05-14 18:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/workflows/sync_typeshed.yaml</code>:61 on 2024-05-14 18:13</div>
            <div class="timeline-body"><p>Hmm, good point. Eventually these updates will have user-facing impacts, so at that point we will want these updates listed in our changelog. But right now, <code>red_knot</code> is a separate crate to the rest of Ruff, so these changes are indeed strictly internal right now. So I&#x27;ll change it for now so that it adds the <code>internal</code> label.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-05-14 18:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/workflows/sync_typeshed.yaml</code>:61 on 2024-05-14 18:17</div>
            <div class="timeline-body"><pre><code>          gh pr create --title &quot;Sync vendored typeshed stubs&quot; --body &quot;Close and reopen this PR to trigger CI&quot; --label &quot;internal&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-05-15 00:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-05-15 00:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-05-15 00:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-05-15 00:41</div>
            <div class="timeline-body"><p>I manually triggered the workflow to check that everything was working. Looks like it is! #11428</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:04:06 UTC
    </footer>
</body>
</html>
