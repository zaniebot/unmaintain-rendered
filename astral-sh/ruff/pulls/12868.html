<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Limit `requirements.txt` files updated by renovate - astral-sh/ruff #12868</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Limit <code>requirements.txt</code> files updated by renovate</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12868">#12868</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-08-13 16:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>Following https://github.com/astral-sh/ruff/commit/50ff5c754421474b353f94edfdc1fed7a8c3b82b, renovate is now filing PRs to update all <code>requirements.txt</code> files in Ruff:</p>
<ul>
<li>https://github.com/astral-sh/ruff/pull/12829</li>
<li>https://github.com/astral-sh/ruff/pull/12823</li>
</ul>
<p>The <code>requirements.txt</code> file being updated in ^both of those PRs isn&#x27;t really appropriate for renovate to update, as it&#x27;s generated by a <code>uv pip compile</code> command, and renovate hasn&#x27;t implemented support for uv yet.</p>
<p>It turns out that the reason that renovate is doing this is because the <code>fileMatch</code> settings is <em>additive</em> -- when you specify a regex under a <code>fileMatch</code> key, renovate uses that pattern <em>in addition</em> to its default. (Specifying the pattern doesn&#x27;t <em>override</em> renovate&#x27;s default.) To actually exclude files from being updated by renovate, we have to use <code>ignorePaths</code>. We haven&#x27;t come across this before now, because the other package managers we have enabled in our renovate configs all have somewhat conservative defaults that will only update files found at the repository root. Renovate&#x27;s <code>pip_requirements</code> package manager, however, will search for <code>requirements.txt</code> files anywhere and everywhere.</p>
Test Plan
<pre><code>~/dev/ruff (renovate-config-fix) % npx --yes --package renovate -- renovate-config-validator --strict    
(node:31231) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
 INFO: Validating .github/renovate.json5
 INFO: Config validated successfully
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ci</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-13 16:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-13 16:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>.github/renovate.json5</code>:30 on 2024-08-13 16:57</div>
            <div class="timeline-body"><p>I haven&#x27;t looked at the docs but do you think it&#x27;s still reasonable to keep the <code>requirements.*\\.txt</code> part?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-08-13 16:57</div>
            <div class="timeline-body"><p>Thanks! This is useful information as well. We should also ignore Cargo updates for <code>fuzz</code> crate (not necessarily by you or in this PR).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-08-13 16:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>.github/renovate.json5</code>:30 on 2024-08-13 16:58</div>
            <div class="timeline-body"><p>I guess the best way to verify this would be to merge and check the dependency dashboard issue?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-08-13 17:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:30 on 2024-08-13 17:01</div>
            <div class="timeline-body"><blockquote>
<p>I haven&#x27;t looked at the docs but do you think it&#x27;s still reasonable to keep the <code>requirements.*\\.txt</code> part?</p>
</blockquote>
<p>The double negative of &quot;ignoring a negative glob pattern&quot; is kind of melting my brain. But I <em>think</em> that makes sense, yes -- thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-08-13 17:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:30 on 2024-08-13 17:06</div>
            <div class="timeline-body"><p>It&#x27;s also so strange to me that <code>fileMatch</code> needs to be a regex whereas <code>ignorePaths</code> needs to be a glob</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-13 17:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-13 17:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-08-13 17:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-13 17:19</div>
            <div class="timeline-body"><p>Looks like everything&#x27;s now working as intended. After merging this PR:</p>
<ul>
<li>renovate autoclosed the two bad PRs it had previously opened:<ul>
<li>https://github.com/astral-sh/ruff/pull/12823#event-13866735546</li>
<li>https://github.com/astral-sh/ruff/pull/12829#event-13866735928</li>
</ul>
</li>
<li>The <code>docs/*requirements.txt</code> files dependencies are still listed as renovate-tracked dependencies in the dependency dashboard: <a href="https://github.com/astral-sh/ruff/issues/10578">astral-sh/ruff#10578</a></li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:06:02 UTC
    </footer>
</body>
</html>
