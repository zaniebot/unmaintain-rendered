<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Avoid f-string false positives in `gettext` calls (`RUF027`) - astral-sh/ruff #10118</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Avoid f-string false positives in <code>gettext</code> calls (<code>RUF027</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10118">#10118</a>
        opened by <a href="https://github.com/robincaloudis">@robincaloudis</a>
        on 2024-02-25 11:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/robincaloudis">@robincaloudis</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>It is a convention to use the <code>_()</code> alias for <code>gettext()</code>. We want to avoid
statement expressions and assignments related to aliases of the gettext API.
See https://docs.python.org/3/library/gettext.html for details. When one
uses `_() to mark a string for translation, the tools look for these markers
and replace the original string with its translated counterpart. If the
string contains variable placeholders or formatting, it can complicate the
translation process, lead to errors or incorrect translations.</p>
<h2>Test Plan</h2>
<ul>
<li>Test file <code>RUF027_1.py</code> was extended such that the test reproduces the false-positive</li>
</ul>
<p>Closes https://github.com/astral-sh/ruff/issues/10023.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-02-25 12:31</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+0 -4 violations, +0 -0 fixes in 1 projects; 42 projects unchanged)</p>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+0 -4 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/zulip/zulip/blob/30aa0a19fe80d2e2a0ec295ec54e86357fad9411/zerver/actions/streams.py#L1575'>zerver/actions/streams.py:1575:13:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/30aa0a19fe80d2e2a0ec295ec54e86357fad9411/zerver/actions/streams.py#L1576'>zerver/actions/streams.py:1576:13:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/30aa0a19fe80d2e2a0ec295ec54e86357fad9411/zerver/actions/streams.py#L1577'>zerver/actions/streams.py:1577:13:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/30aa0a19fe80d2e2a0ec295ec54e86357fad9411/zerver/lib/typed_endpoint.py#L366'>zerver/lib/typed_endpoint.py:366:32:</a> RUF027 Possible f-string without an `f` prefix
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF027 | 4 | 0 | 4 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-02-25 21:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @charliermarsh on 2024-02-25 21:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-02-25 21:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-25 21:09</div>
            <div class="timeline-body"><p>Thank you! Will review.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-25 21:09</div>
            <div class="timeline-body"><p>(The ecosystem checks look good.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-02-25 23:02</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/missing_fstring_syntax.rs</code>:74 on 2024-02-25 23:02</div>
            <div class="timeline-body"><p>I had to generalize this to look at all parent expressions, to catch cases like: <code>print(_(&quot;formatting of {partial} in a translation string is bad practice&quot;))</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-25 23:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Fix false-positive in RUF027" to "[`ruff`] Avoid f-string false positives in `gettext` calls (`RUF027`)" by @charliermarsh on 2024-02-25 23:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-02-25 23:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-25 23:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/robincaloudis">@robincaloudis</a> reviewed on 2024-02-26 05:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/robincaloudis">@robincaloudis</a> on <code>crates/ruff_linter/src/rules/ruff/rules/missing_fstring_syntax.rs</code>:74 on 2024-02-26 05:05</div>
            <div class="timeline-body"><p>Great additions! Thanks.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:02:52 UTC
    </footer>
</body>
</html>
