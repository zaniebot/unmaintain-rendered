<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>build: add libcst from crates - astral-sh/ruff #7179</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>build: add libcst from crates</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/7179">#7179</a>
        opened by <a href="https://github.com/manmartgarc">@manmartgarc</a>
        on 2023-09-06 05:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/manmartgarc">@manmartgarc</a></div>
            <div class="timeline-body">

Summary
<p>This PR is related to <a href="https://github.com/astral-sh/ruff/issues/43">astral-sh/ruff#43</a> and <a href="https://github.com/Instagram/LibCST/issues/967">Instagram/LibCST#967</a>. The good people over at LibCST are in the process of making their packages publishable to <code>crates.io</code> and have already uploaded the version for which <code>ruff</code> is dependent on, namely <code>v1.0.1</code>. This PR removes the git dependency and replaces it for its <a href="https://crates.io/crates/libcst">crates.io</a> distribution.</p>
Test Plan
<p>Ran <code>cargo build</code> locally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-09-06 05:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>Cargo.toml</code>:57 on 2023-09-06 05:52</div>
            <div class="timeline-body"><p>The comment is outdated as I forgot to update it when I updated LibCST to the latest commit in <a href="https://github.com/astral-sh/ruff/pull/7062">astral-sh/ruff#7062</a> (Sorry!). So, we&#x27;ll have to wait until there&#x27;s another release for us to update here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-09-06 06:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>Cargo.toml</code>:57 on 2023-09-06 06:01</div>
            <div class="timeline-body"><p>Or am I mistaken? Does <code>0.1.0</code> indicate the latest version of main as of now i.e., does it include this commit (instagram/libcst@9c263aa8977962a870ce2770d2aa18ee0dacb344)? I think it does as the tests seems to be passing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>Cargo.toml</code>:57 on 2023-09-06 06:06</div>
            <div class="timeline-body"><p>We should to keep the <code>default-features=false</code> because we don&#x27;t need the pyo3 bindings</p>
<pre><code>libcst = { version = &quot;0.1.0&quot;, default-features = false }
</code></pre>
<p>This should also fix the build failures</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>Cargo.toml</code>:57 on 2023-09-06 06:08</div>
            <div class="timeline-body"><p>It seems to be <code>main</code>. Or at least any commit not older than https://github.com/Instagram/LibCST/commit/377a292d0d43a71b1e9704799d7e46b621a97018 where they added the metadata. But I agree, the versioning is a bit confusing</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> requested changes on 2023-09-06 06:10</div>
            <div class="timeline-body"><p>Yeahy. One less git dependency!</p>
<p>This looks good to me but we&#x27;ll need to remove the default-features to get the build passing</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/manmartgarc">@manmartgarc</a> reviewed on 2023-09-06 07:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/manmartgarc">@manmartgarc</a> on <code>Cargo.toml</code>:57 on 2023-09-06 07:55</div>
            <div class="timeline-body"><p>Added a new commit with this setting</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2023-09-06 08:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-06 08:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-06 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-06 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-09-06 08:30</div>
            <div class="timeline-body">PR Check Results
Ecosystem
<p>âœ… ecosystem check detected no changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-09-06 18:07</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:56:58 UTC
    </footer>
</body>
</html>
