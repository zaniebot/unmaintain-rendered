<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement TID251 (banning modules &amp; module members) - astral-sh/ruff #1436</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement TID251 (banning modules &amp; module members)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/1436">#1436</a>
        opened by <a href="https://github.com/not-my-profile">@not-my-profile</a>
        on 2022-12-29 08:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a></div>
            <div class="timeline-body"><p>Resolves  #1422.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 12:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/settings.rs</code>:89 on 2022-12-29 12:17</div>
            <div class="timeline-body"><p>I think we may need to sort this by key to ensure a stable hash. Or use a <code>BTreeMap</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 12:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/settings.rs</code>:65 on 2022-12-29 12:18</div>
            <div class="timeline-body"><p>I know you explicitly preferred <code>banned_api</code>, but given the minor difference, it&#x27;s worth it to me to maintain compatibility with <code>flake8-tidy-imports</code> and keep this as <code>banned-modules</code>. How do you feel about that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 12:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/checks.rs</code>:79 on 2022-12-29 12:19</div>
            <div class="timeline-body"><p>Typically, if methods take <code>checker</code>, then we just call <code>checker.add_check</code> rather than returning an <code>Option&lt;Check&gt;</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/checks.rs</code>:32 on 2022-12-29 12:19</div>
            <div class="timeline-body"><p>Nit: can this take <code>&amp;str</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 12:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 12:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/checks.rs</code>:2454 on 2022-12-29 12:21</div>
            <div class="timeline-body"><p>I&#x27;d probably vote to nix this property and custom message, I think it might be confusing to users (and the false-positive cases here are rare enough that the tradeoff seems not-worth-it).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-29 12:22</div>
            <div class="timeline-body"><p>This looks great! Some minor comments. Thank you for the PR!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2022-12-29 14:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/flake8_tidy_imports/checks.rs</code>:32 on 2022-12-29 14:50</div>
            <div class="timeline-body"><p>Changing it to take <code>&amp;str</code> would result in a needless allocation since the string is firstly formatted in order to be passed to the function and then later has to be owned in order to be part of the CheckKind.</p>
<p>We could change it to instead take two <code>&amp;str</code> and and move the <code>format!</code> into the function but I don&#x27;t really see the point.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2022-12-29 14:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/checks.rs</code>:2454 on 2022-12-29 14:56</div>
            <div class="timeline-body"><p>I think claiming that something is the case when it is not is much more confusing than having a disclaimer that the check result may be wrong. Whether or not false-positive cases are rare depends entirely on the code base. The check is not authoritative, it&#x27;s just an educated guess ... I think the wording of the message should reflect that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2022-12-29 15:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/flake8_tidy_imports/settings.rs</code>:65 on 2022-12-29 15:04</div>
            <div class="timeline-body"><p>Yes I don&#x27;t like <code>banned-modules</code> because it&#x27;s misleading since the setting can also be used for module members. I do think correct semantics make a big difference in terms of usability. And I don&#x27;t get your point about compatibility given that you cannot copy&#x27;n&#x27;paste <code>flake8-tidy-imports</code> config into the ruff config anyway because:</p>
<ol>
<li>flake8-tidy-imports does not use TOML but .cfg which uses a different syntax.</li>
<li>You have to wrap the names in double quotes and appent <code>.msg</code>.</li>
</ol>
<p>If we still want both settings to have the same name despite having different formats, I think it would make more sense if <code>flake8-tidy-imports</code> updated its setting name to <code>banned-api</code> since it&#x27;s the more correct terminology.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 18:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/checks.rs</code>:2454 on 2022-12-29 18:19</div>
            <div class="timeline-body"><p>I hear you but I just don&#x27;t think this is a tenable position. There are so many ways to avoid static detection in Python. By this logic, we should be adding a disclaimer like this to almost every check.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 18:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/checks.rs</code>:32 on 2022-12-29 18:25</div>
            <div class="timeline-body"><p>I think the benefit would be that you could then pass in <code>module: &amp;str</code> and <code>name: Alias</code>, unless I&#x27;m misreading, rather than having to extract part of the alias (<code>let name = &amp;loc_name.node.name</code>) and pass that in + format it beforehand.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 18:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/settings.rs</code>:65 on 2022-12-29 18:31</div>
            <div class="timeline-body"><p>I guess this is fine. There is some mental overhead to deviating (folks that migrate their config have to know to change the setting name) but I understand your point, and I don&#x27;t feel strongly.</p>
<p>What&#x27;s your reaction to <code>banned import</code>? There was some discussion <a href="https://github.com/adamchainz/flake8-tidy-imports/issues/38">here</a> and it looks like that&#x27;s the verbiage that <code>flake8-tidy-imports</code> uses in their <a href="https://github.com/adamchainz/flake8-tidy-imports/pull/40">messages</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 21:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/settings.rs</code>:65 on 2022-12-29 21:43</div>
            <div class="timeline-body"><p>I was thinking about this a bit more, and I prefer <code>banned-imports</code> over <code>banned-api</code>. The issue with <code>banned-api</code> is that it&#x27;s <em>too</em> general, and actually implies things that go beyond what the tool can do. For example, to me, <code>banned-api</code> would also include things like method calls.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/checks.rs</code>:2454 on 2022-12-29 21:46</div>
            <div class="timeline-body"><p>Fair enough, I removed it :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2022-12-29 21:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2022-12-29 21:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/flake8_tidy_imports/checks.rs</code>:32 on 2022-12-29 21:56</div>
            <div class="timeline-body"><p>Ah yes that makes sense; changed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/flake8_tidy_imports/settings.rs</code>:65 on 2022-12-29 22:02</div>
            <div class="timeline-body"><p>(If you agree, I&#x27;m also happy to do the work of renaming, then merge the PR.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2022-12-29 22:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/flake8_tidy_imports/settings.rs</code>:65 on 2022-12-29 22:04</div>
            <div class="timeline-body"><p>Yes &quot;banned import&quot; would be accurate for <code>flake8-tidy-imports</code> but only because they don&#x27;t yet implement the attribute access check (adamchainz/flake8-tidy-imports/issues/63), which this PR implements. Since the check also checks for attribute access &quot;banned import&quot; isn&#x27;t accurate, for example:</p>
<pre><code>import foo
foo.bar # TIDI201 Banned import &#x27;foo.bar&#x27; used
</code></pre>
<p><code>foo.bar</code> here is not an import.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2022-12-29 22:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-30 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-30 03:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:51:40 UTC
    </footer>
</body>
</html>
