<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUF027 no longer has false negatives with string literals inside of method calls - astral-sh/ruff #9865</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>RUF027 no longer has false negatives with string literals inside of method calls</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9865">#9865</a>
        opened by <a href="https://github.com/snowsignal">@snowsignal</a>
        on 2024-02-06 21:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowsignal">@snowsignal</a></div>
            <div class="timeline-body"><p>Fixes #9857.</p>
<h2>Summary</h2>
<p>Statements like <code>logging.info(&quot;Today it is: {day}&quot;)</code> will no longer be ignored by RUF027. As before, statements like <code>&quot;Today it is: {day}&quot;.format(day=&quot;Tuesday&quot;)</code> will continue to be ignored.</p>
<h2>Test Plan</h2>
<p>The snapshot tests were expanded to include new cases. Additionally, the snapshot tests have been split in two to separate positive cases from negative cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @snowsignal on 2024-02-06 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "RUF027 no longer has false negatives with string literals inside of method calls." to "RUF027 no longer has false negatives with string literals inside of method calls" by @snowsignal on 2024-02-06 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @snowsignal on 2024-02-06 21:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-02-06 21:27</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+8 -0 violations, +0 -0 fixes in 3 projects; 40 projects unchanged)</p>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/core/nlg/test_response.py#L372'>tests/core/nlg/test_response.py:372:9:</a> RUF027 Possible f-string without an `f` prefix
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/shared/core/test_slot_mappings.py#L72'>tests/shared/core/test_slot_mappings.py:72:9:</a> RUF027 Possible f-string without an `f` prefix
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/shared/core/training_data/story_writer/test_yaml_story_writer.py#L201'>tests/shared/core/training_data/story_writer/test_yaml_story_writer.py:201:9:</a> RUF027 Possible f-string without an `f` prefix
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/test_model_training.py#L922'>tests/test_model_training.py:922:9:</a> RUF027 Possible f-string without an `f` prefix
</pre>

</p>
</details>
<details><summary><a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/ibis-project/ibis/blob/6f32374fd1add436635c2ea5a6da86ac127c5182/ibis/expr/types/generic.py#L752'>ibis/expr/types/generic.py:752:37:</a> RUF027 Possible f-string without an `f` prefix
</pre>

</p>
</details>
<details><summary><a href="https://github.com/rotki/rotki">rotki/rotki</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/rotki/rotki/blob/96e2ed11f0795e44a3b72a1d6c10087746acfd9c/rotkehlchen/db/dbhandler.py#L2800'>rotkehlchen/db/dbhandler.py:2800:23:</a> RUF027 Possible f-string without an `f` prefix
+ <a href='https://github.com/rotki/rotki/blob/96e2ed11f0795e44a3b72a1d6c10087746acfd9c/rotkehlchen/exchanges/bitpanda.py#L275'>rotkehlchen/exchanges/bitpanda.py:275:47:</a> RUF027 Possible f-string without an `f` prefix
+ <a href='https://github.com/rotki/rotki/blob/96e2ed11f0795e44a3b72a1d6c10087746acfd9c/rotkehlchen/exchanges/kraken.py#L419'>rotkehlchen/exchanges/kraken.py:419:21:</a> RUF027 Possible f-string without an `f` prefix
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF027 | 8 | 8 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-06 21:30</div>
            <div class="timeline-body"><p>The Rasa checks look like false positives (hard to avoid...), the Ibis check looks like a true positive (I think), the Pandas check looks like a false positive (maybe avoidable?), the Rotki checks look like they might be true positives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-06 21:30</div>
            <div class="timeline-body"><p>Perhaps we could avoid the Pandas false positive by also ignoring calls with positional arguments that use the exact same name...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/missing_fstring_syntax.rs</code>:122 on 2024-02-06 23:00</div>
            <div class="timeline-body"><p>What if we have <code>&quot;{test}&quot;.attribute.chaining.call()&quot;</code> Should this be excluded too or is this handled by the <code>value if last_expr == Some(value)</code>? If so, it might be worth adding some comments explaining the cases these branches handle</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-02-06 23:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowsignal">@snowsignal</a> reviewed on 2024-02-07 16:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/snowsignal">@snowsignal</a> on <code>crates/ruff_linter/src/rules/ruff/rules/missing_fstring_syntax.rs</code>:122 on 2024-02-07 16:21</div>
            <div class="timeline-body"><blockquote>
<p>Should this be excluded too or is this handled by the value if <code>last_expr == Some(value)</code>?</p>
</blockquote>
<p>I just tested this, and it is handled by that case! I'll add some clarification though, that's a good idea.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snowsignal">@snowsignal</a> on 2024-02-07 20:48</div>
            <div class="timeline-body"><p>@charliermarsh I added some logic to ignore literals with matching regular arguments in addition to keyword arguments.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2024-02-07 20:54</div>
            <div class="timeline-body"><h2><a href="https://codspeed.io/astral-sh/ruff/branches/jane/linter/RUF027/method-call-fix">CodSpeed Performance Report</a></h2>
<h3>Merging #9865 will <strong>improve performances by 11.53%</strong></h3>
<p><sub>Comparing <code>jane/linter/RUF027/method-call-fix</code> (787ae4e) with <code>main</code> (daae28e)</sub></p>
<h3>Summary</h3>
<p><code>⚡ 10</code> improvements
<code>✅ 20</code> untouched benchmarks</p>
<h3>Benchmarks breakdown</h3>
<p>|     | Benchmark | <code>main</code> | <code>jane/linter/RUF027/method-call-fix</code> | Change |
| --- | --------- | ----------------------- | ------------------- | ------ |
| ⚡ | <code>linter/all-rules[numpy/ctypeslib.py]</code> | 20.6 ms | 18.9 ms | +9.19% |
| ⚡ | <code>linter/all-rules[large/dataset.py]</code> | 92.5 ms | 82.9 ms | +11.53% |
| ⚡ | <code>linter/all-with-preview-rules[numpy/globals.py]</code> | 3.1 ms | 2.9 ms | +5.7% |
| ⚡ | <code>linter/all-with-preview-rules[numpy/ctypeslib.py]</code> | 23.3 ms | 21.5 ms | +8.31% |
| ⚡ | <code>linter/all-with-preview-rules[pydantic/types.py]</code> | 51 ms | 47 ms | +8.66% |
| ⚡ | <code>linter/all-with-preview-rules[large/dataset.py]</code> | 105.1 ms | 95.3 ms | +10.23% |
| ⚡ | <code>linter/all-with-preview-rules[unicode/pypinyin.py]</code> | 11.8 ms | 11.2 ms | +5.21% |
| ⚡ | <code>linter/all-rules[numpy/globals.py]</code> | 2.8 ms | 2.6 ms | +6.35% |
| ⚡ | <code>linter/all-rules[unicode/pypinyin.py]</code> | 10.8 ms | 10.2 ms | +5.8% |
| ⚡ | <code>linter/all-rules[pydantic/types.py]</code> | 43.9 ms | 39.6 ms | +10.71% |</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @snowsignal on 2024-02-08 15:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @snowsignal on 2024-02-08 15:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-02-08 15:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:02:40 UTC
    </footer>
</body>
</html>
