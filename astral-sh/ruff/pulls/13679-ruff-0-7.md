```yaml
number: 13679
title: Ruff 0.7
type: pull_request
state: merged
author: AlexWaygood
labels:
  - breaking
  - release
assignees: []
merged: true
base: main
head: ruff-0.7
created_at: 2024-10-08T11:49:08Z
updated_at: 2024-10-17T15:35:14Z
url: https://github.com/astral-sh/ruff/pull/13679
synced_at: 2026-01-12T15:55:45Z
```

# Ruff 0.7

---

_@AlexWaygood_

## Summary

Feature branch for the Ruff 0.7 release


---

_Marked ready for review by @AlexWaygood on 2024-10-08 11:49_

---

_Label `breaking` added by @AlexWaygood on 2024-10-08 11:49_

---

_Label `release` added by @AlexWaygood on 2024-10-08 11:49_

---

_Assigned to @AlexWaygood by @AlexWaygood on 2024-10-08 11:52_

---

_Comment by @github-actions[bot] on 2024-10-08 12:06_

<!-- generated-comment ecosystem -->
## `ruff-ecosystem` results
### Linter (stable)
‚ÑπÔ∏è ecosystem check **detected linter changes**. (+25 -7 violations, +0 -0 fixes in 7 projects; 47 projects unchanged)

<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+14 -2 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/amazon/aws/hooks/s3.py#L1450'>airflow/providers/amazon/aws/hooks/s3.py:1450:20:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/amazon/aws/transfers/dynamodb_to_s3.py#L247'>airflow/providers/amazon/aws/transfers/dynamodb_to_s3.py:247:29:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/hooks/kubernetes.py#L495'>airflow/providers/cncf/kubernetes/hooks/kubernetes.py:495:9:</a> TRY203 Remove exception handler; error is immediately re-raised
- <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/hooks/kubernetes.py#L495'>airflow/providers/cncf/kubernetes/hooks/kubernetes.py:495:9:</a> TRY302 Remove exception handler; error is immediately re-raised
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/operators/pod.py#L808'>airflow/providers/cncf/kubernetes/operators/pod.py:808:9:</a> TRY203 Remove exception handler; error is immediately re-raised
- <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/operators/pod.py#L808'>airflow/providers/cncf/kubernetes/operators/pod.py:808:9:</a> TRY302 Remove exception handler; error is immediately re-raised
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/docker/operators/docker.py#L487'>airflow/providers/docker/operators/docker.py:487:19:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/google/cloud/hooks/cloud_sql.py#L934'>airflow/providers/google/cloud/hooks/cloud_sql.py:934:22:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L195'>airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:195:27:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L212'>airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:212:35:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L228'>airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:228:34:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/google/cloud/transfers/sql_to_gcs.py#L354'>airflow/providers/google/cloud/transfers/sql_to_gcs.py:354:27:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/google/cloud/transfers/sql_to_gcs.py#L465'>airflow/providers/google/cloud/transfers/sql_to_gcs.py:465:34:</a> SIM115 Use a context manager for opening files
... 4 additional changes omitted for rule SIM115
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/superset">apache/superset</a> (+5 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/superset/blob/a849c292888f32b8912a1a06dfe1591706a53220/superset/commands/dataset/importers/v1/utils.py#L198'>superset/commands/dataset/importers/v1/utils.py:198:16:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/superset/blob/a849c292888f32b8912a1a06dfe1591706a53220/tests/integration_tests/email_tests.py#L160'>tests/integration_tests/email_tests.py:160:22:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/superset/blob/a849c292888f32b8912a1a06dfe1591706a53220/tests/integration_tests/email_tests.py#L44'>tests/integration_tests/email_tests.py:44:22:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/superset/blob/a849c292888f32b8912a1a06dfe1591706a53220/tests/integration_tests/email_tests.py#L64'>tests/integration_tests/email_tests.py:64:22:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/apache/superset/blob/a849c292888f32b8912a1a06dfe1591706a53220/tests/integration_tests/email_tests.py#L95'>tests/integration_tests/email_tests.py:95:22:</a> SIM115 Use a context manager for opening files
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/tests/support/util/filesystem.py#L133'>tests/support/util/filesystem.py:133:9:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/tests/support/util/filesystem.py#L151'>tests/support/util/filesystem.py:151:9:</a> SIM115 Use a context manager for opening files
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/tests/unit/bokeh/command/test_util__command.py#L72'>tests/unit/bokeh/command/test_util__command.py:72:9:</a> SIM115 Use a context manager for opening files
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python-poetry/poetry">python-poetry/poetry</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/inspection/lazy_wheel.py#L278'>src/poetry/inspection/lazy_wheel.py:278:41:</a> SIM115 Use a context manager for opening files
</pre>

</p>
</details>
<details><summary><a href="https://github.com/reflex-dev/reflex">reflex-dev/reflex</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>

<pre>
+ <a href='https://github.com/reflex-dev/reflex/blob/5e3cfecdeab4182e4a405e94fb2d78f7b70eb16a/reflex/utils/prerequisites.py#L722'>reflex/utils/prerequisites.py:722:14:</a> SIM115 Use a context manager for opening files
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/zulip/zulip/blob/c39e86504ad00dbc8a3edfcd3a58d117137f32fa/zerver/management/commands/backup.py#L124'>zerver/management/commands/backup.py:124:36:</a> SIM115 Use a context manager for opening files
</pre>

</p>
</details>
<details><summary><a href="https://github.com/indico/indico">indico/indico</a> (+0 -5 violations, +0 -0 fixes)</summary>
<p>

<pre>
- <a href='https://github.com/indico/indico/blob/a40d8647eac2dd9075bd5052f9a0840146e1fa0f/indico/modules/events/export.py#L151'>indico/modules/events/export.py:151:75:</a> RUF100 [*] Unused `noqa` directive (unused: `SIM115`)
- <a href='https://github.com/indico/indico/blob/a40d8647eac2dd9075bd5052f9a0840146e1fa0f/indico/modules/events/export.py#L416'>indico/modules/events/export.py:416:59:</a> RUF100 [*] Unused `noqa` directive (unused: `SIM115`)
- <a href='https://github.com/indico/indico/blob/a40d8647eac2dd9075bd5052f9a0840146e1fa0f/indico/modules/events/static/offline.py#L91'>indico/modules/events/static/offline.py:91:42:</a> RUF100 [*] Unused `noqa` directive (unused: `SIM115`)
- <a href='https://github.com/indico/indico/blob/a40d8647eac2dd9075bd5052f9a0840146e1fa0f/indico/modules/events/util.py#L710'>indico/modules/events/util.py:710:91:</a> RUF100 [*] Unused `noqa` directive (unused: `SIM115`)
- <a href='https://github.com/indico/indico/blob/a40d8647eac2dd9075bd5052f9a0840146e1fa0f/indico/modules/users/export.py#L79'>indico/modules/users/export.py:79:87:</a> RUF100 [*] Unused `noqa` directive (unused: `SIM115`)
</pre>

</p>
</details>
<details><summary>Changes by rule (4 rules affected)</summary>
<p>

| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| SIM115 | 23 | 23 | 0 | 0 | 0 |
| RUF100 | 5 | 0 | 5 | 0 | 0 |
| TRY203 | 2 | 2 | 0 | 0 | 0 |
| TRY302 | 2 | 0 | 2 | 0 | 0 |

</p>
</details>

### Linter (preview)
‚ÑπÔ∏è ecosystem check **detected linter changes**. (+2 -2 violations, +0 -0 fixes in 1 projects; 53 projects unchanged)

<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+2 -2 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/hooks/kubernetes.py#L495'>airflow/providers/cncf/kubernetes/hooks/kubernetes.py:495:9:</a> TRY203 Remove exception handler; error is immediately re-raised
- <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/hooks/kubernetes.py#L495'>airflow/providers/cncf/kubernetes/hooks/kubernetes.py:495:9:</a> TRY302 Remove exception handler; error is immediately re-raised
+ <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/operators/pod.py#L808'>airflow/providers/cncf/kubernetes/operators/pod.py:808:9:</a> TRY203 Remove exception handler; error is immediately re-raised
- <a href='https://github.com/apache/airflow/blob/c377e7fcebcbf2b2752e937d9b797864329333ef/airflow/providers/cncf/kubernetes/operators/pod.py#L808'>airflow/providers/cncf/kubernetes/operators/pod.py:808:9:</a> TRY302 Remove exception handler; error is immediately re-raised
</pre>

</p>
</details>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| TRY203 | 2 | 2 | 0 | 0 | 0 |
| TRY302 | 2 | 0 | 2 | 0 | 0 |

</p>
</details>




---

_Added to milestone `v0.7` by @AlexWaygood on 2024-10-08 13:44_

---

_Comment by @zanieb on 2024-10-08 14:52_

Interesting SIM115 false positive

https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/tests/support/util/filesystem.py#L129-L138

and another

https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/inspection/lazy_wheel.py#L278

---

_Comment by @Skylion007 on 2024-10-09 14:32_

Any rules leaving preview on this release? Instead of just behaviors?

---

_Comment by @AlexWaygood on 2024-10-09 14:35_

> Any rules leaving preview on this release? Instead of just behaviors?

Just behaviour changes this release, I'm afraid. It's quite a busy month for us, and reviewing whether a rule is ready to leave preview takes up a lot of time üôÇ

We should be able to stabilise some rules in next month's minor release

---

_Comment by @AlexWaygood on 2024-10-17 15:17_

> Interesting SIM115 false positive
> 
> [bokeh/bokeh@`829b2a7`/tests/support/util/filesystem.py#L129-L138](https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/tests/support/util/filesystem.py#L129-L138)
> 
> and another
> 
> [python-poetry/poetry@`500a313`/src/poetry/inspection/lazy_wheel.py#L278](https://github.com/python-poetry/poetry/blob/500a313d68637cbd317171c567280a10eaabae3c/src/poetry/inspection/lazy_wheel.py#L278)

(We chatted about this a bit off GitHub, but just to respond here so others can see -- my feeling is that the accuracy of the rule probably could be improved here, but that these aren't serious enough to delay stabilising the new behaviour. I think it's also sort-of surfacing existing edge cases in the rule rather than this being a new bug that's introduced by the stabilisation. So I'm going to go ahead for now.)

---

_Merged by @AlexWaygood on 2024-10-17 15:35_

---

_Closed by @AlexWaygood on 2024-10-17 15:35_

---

_Branch deleted on 2024-10-17 15:35_

---
