<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `--exit-non-zero-on-format` to formatter exit codes section - astral-sh/ruff #22761</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>--exit-non-zero-on-format</code> to formatter exit codes section</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22761">#22761</a>
        opened by <a href="https://github.com/alejsdev">@alejsdev</a>
        on 2026-01-20 12:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/alejsdev">@alejsdev</a></div>
            <div class="timeline-body">Summary
<p>The formatter&#x27;s exit codes documentation at https://docs.astral.sh/ruff/formatter/#exit-codes doesn&#x27;t mention the <code>--exit-non-zero-on-format</code> flag, even though it exists (it was added in <a href="https://github.com/astral-sh/ruff/pull/16009">astral-sh/ruff#16009</a>) and appears in ruff format --help, and the linter flag --exit-non-zero-on-fix is properly documented in the https://docs.astral.sh/ruff/linter/#exit-codes (which was used as a reference to add the proper section in the formatter, trying to keep the consistency)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-20 12:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2026-01-20 15:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>docs/formatter.md</code>:379 on 2026-01-20 15:37</div>
            <div class="timeline-body"><p>I have a slight preference to extend the list above over adding this section. It does make it clearer which exit code it changes.</p>
<pre><code>`0` if Ruff terminates successfully, and no files would be formatted if `--check` and `--exit-non-zero-on-format` were not specified.
- `1` if Ruff terminates successfully, and one or more files would be formatted if `--check` or `--exit-non-zero-on-format` were specified.
</code></pre>
<p>It also seems that the if <code>--check</code> was not specified for 1, might be incorrect, or do I misunderstand the flags @ntBre ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2026-01-20 15:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>docs/formatter.md</code>:379 on 2026-01-20 15:53</div>
            <div class="timeline-body"><p>I&#x27;m not sure I understand the question entirely, but I did some manual testing, and it seems like the flags work together as I would expect:</p>
<pre><code># no flags, reformatted, exits 0
‚ùØ echo &#x27;def foo(x,y,z): return x+y+z&#x27; &gt; try.py &amp;&amp; ruff format; echo $?
1 file reformatted
0
# --check, would reformat, exits 1
‚ùØ echo &#x27;def foo(x,y,z): return x+y+z&#x27; &gt; try.py &amp;&amp; ruff format --check; echo $?
Would reformat: try.py
1 file would be reformatted
1
# --exit-non-zero-on-format, reformatted, exits 1
‚ùØ echo &#x27;def foo(x,y,z): return x+y+z&#x27; &gt; try.py &amp;&amp; ruff format --exit-non-zero-on-format; echo $?
1 file reformatted
1
# --check AND --exit-non-zero-on-format, would reformat, still exits 1
‚ùØ echo &#x27;def foo(x,y,z): return x+y+z&#x27; &gt; try.py &amp;&amp; ruff format --check --exit-non-zero-on-format; echo $?
Would reformat: try.py
1 file would be reformatted
1
</code></pre>
<p>I think <code>--exit-non-zero-on-format</code> might fit nicely in the first list:</p>
<blockquote>
<p><code>ruff format</code> exits with the following status codes:</p>
<ul>
<li><code>0</code> if Ruff terminates successfully, regardless of whether any files were formatted.</li>
<li><code>2</code> if Ruff terminates abnormally due to invalid configuration, invalid CLI options, or an
internal error.</li>
</ul>
</blockquote>
<p>as:</p>
<ul>
<li><code>1</code> if Ruff terminates successfully, one or more files were formatted, and <code>--exit-non-zero-on-format</code> was specified</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/alejsdev">@alejsdev</a> reviewed on 2026-01-20 19:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/alejsdev">@alejsdev</a> on <code>docs/formatter.md</code>:379 on 2026-01-20 19:14</div>
            <div class="timeline-body"><p>done, thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;üìù Add --exit-non-zero-on-format to formatter exit codes section&quot; to &quot;Add `--exit-non-zero-on-format` to formatter exit codes section&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-21 08:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2026-01-21 08:34</div>
            <div class="timeline-body"><p>Thank you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-21 08:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-21 08:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-21 08:53:27 UTC
    </footer>
</body>
</html>
