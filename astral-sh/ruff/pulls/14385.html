<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ruff 0.8] [`flake8-pytest-style`] Remove deprecated rules PT004 and PT005 - astral-sh/ruff #14385</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ruff 0.8] [<code>flake8-pytest-style</code>] Remove deprecated rules PT004 and PT005</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14385">#14385</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-11-16 19:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>Remove PT004 and PT005. These were deprecated in <a href="https://github.com/astral-sh/ruff/pull/12837">astral-sh/ruff#12837</a>, which landed as part of Ruff 0.6 (released on August 15th). There are no open issues on the tracker asking us to undeprecate them.</p>
Test Plan
<ul>
<li><code>cargo test</code></li>
<li><code>git grep PytestMissingFixtureNameUnderscore</code>, <code>git grep PytestIncorrectFixtureNameUnderscore</code>, <code>git grep PT004</code> and <code>git grep PT005</code> all show no results</li>
<li>Wait to see what the ecosystem report looks like</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-16 19:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[ruff 0.8] Remove deprecated rules PT004 and PT005&quot; to &quot;[ruff 0.8] [`flake8-pytest-style`] Remove deprecated rules PT004 and PT005&quot; by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-16 19:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-16 19:44</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+1 -3 violations, +0 -0 fixes in 2 projects; 52 projects unchanged)</p>
<a href="https://github.com/freedomofpress/securedrop">freedomofpress/securedrop</a> (+1 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/freedomofpress/securedrop/blob/4c9062b078d11c99c85923f93872cffc37548f27/molecule/testinfra/ossec/test_journalist_mail.py#L14">molecule/testinfra/ossec/test_journalist_mail.py:14:45:</a> RUF100 [*] Unused `noqa` directive (non-enabled: `PT004`)
</pre>

</p>

<a href="https://github.com/rotki/rotki">rotki/rotki</a> (+0 -3 violations, +0 -0 fixes)
<p>

<pre>
- <a href="https://github.com/rotki/rotki/blob/e583793a16ebe806b1fffcea1e2689d754f6425d/rotkehlchen/tests/fixtures/globaldb.py#L207">rotkehlchen/tests/fixtures/globaldb.py:207:5:</a> PT004 Fixture `fixture_historical_price_test_data` does not return anything, add leading underscore
- <a href="https://github.com/rotki/rotki/blob/e583793a16ebe806b1fffcea1e2689d754f6425d/rotkehlchen/tests/fixtures/oracles.py#L20">rotkehlchen/tests/fixtures/oracles.py:20:5:</a> PT004 Fixture `fixture_cache_coinlist` does not return anything, add leading underscore
- <a href="https://github.com/rotki/rotki/blob/e583793a16ebe806b1fffcea1e2689d754f6425d/rotkehlchen/tests/fixtures/thegraph.py#L13">rotkehlchen/tests/fixtures/thegraph.py:13:5:</a> PT004 Fixture `fixture_add_subgraph_api_key` does not return anything, add leading underscore
</pre>

</p>

Changes by rule (2 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PT004 | 3 | 0 | 3 | 0 | 0 |
| RUF100 | 1 | 1 | 0 | 0 | 0 |</p>
</p>


Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-16 19:49</div>
            <div class="timeline-body"><p>Ecosystem report analysis:</p>
<ul>
<li>The <code>freedomofpress</code> and <code>rotki</code> codebases see a few errors going away as a result of these removals.</li>
<li>All other hits are TOML parse errors due to the fact that various repos had the rules explicitly ignored before now (which feels like it validates the choice to remove these rules)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-16 19:53</div>
            <div class="timeline-body"><p>Same concern as <a href="https://github.com/astral-sh/ruff/pull/14384">astral-sh/ruff#14384</a>#issuecomment-2480758746 about merging this now...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-11-16 21:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">do-not-merge</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-16 21:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.8&quot; by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-18 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-19 08:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/fixture.rs</code>:233 on 2024-11-19 08:42</div>
            <div class="timeline-body"><pre><code>/// This rule has been removed because marking fixtures that do not return a value with an underscore
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">do-not-merge</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-19 08:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-19 09:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-19 09:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-11-19 09:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:08:33 UTC
    </footer>
</body>
</html>
