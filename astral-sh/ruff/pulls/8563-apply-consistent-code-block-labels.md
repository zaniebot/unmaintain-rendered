```yaml
number: 8563
title: Apply consistent code block labels
type: pull_request
state: merged
author: doolio
labels:
  - documentation
assignees: []
merged: true
base: main
head: apply-consistent-code-block-labels
created_at: 2023-11-08T14:35:36Z
updated_at: 2023-11-09T08:56:25Z
url: https://github.com/astral-sh/ruff/pull/8563
synced_at: 2026-01-10T23:40:55Z
```

# Apply consistent code block labels

---

_Pull request opened by @doolio on 2023-11-08 14:35_

This ensures the python label is used for all python code blocks for consistency.

## Test Plan

Visual inspection of all changes via git client ensuring no other changes were made in error.

---

_Comment by @doolio on 2023-11-08 16:35_

I don't know why these checks fail. I don't think it is related to the changes I made.

---

_Comment by @zanieb on 2023-11-08 17:06_

@doolio you edited a bunch of our test snapshots in which ```py is generated

https://github.com/astral-sh/ruff/blob/317d3dd61218bcc35b20a42403f3c9acc1963be2/crates/ruff_python_formatter/tests/fixtures.rs#L267

That's why the tests are failing now

---

_Comment by @doolio on 2023-11-08 17:34_

Oh ok. So I should not have made the changes in the `.snap` files? I made this PR because I noticed there were many more instances of ` ```python` than ` ```py` code blocks across the codebase even in the `.rs` files.

If I change the string from "py" to "python" in the following and equivalent lines would that allow these checks to pass?

https://github.com/astral-sh/ruff/blob/3ebaca52464e1db3d808adca9c3de09b90dabfaf/crates/ruff_python_formatter/tests/fixtures.rs#L74

If these changes are unwelcome feel free to close this PR.



---

_Comment by @zanieb on 2023-11-08 17:37_

> So I should not have made the changes in the .snap files? 

Yeah the snapshots are generally updated by `cargo insta test` and `cargo insta review`.

This pull request would be simpler if you didn't touch those files, I'm not sure if we care about the language header there cc @konstin 

> If I change the string from "py" to "python" in the following and equivalent lines would that allow these checks to pass?

They might — I'm not sure of all the details for the formatter test fixtures without trying it.

> If these changes are unwelcome feel free to close this PR.

They seem reasonable!


---

_Label `documentation` added by @zanieb on 2023-11-08 17:37_

---

_Comment by @konstin on 2023-11-08 17:59_

Changing `CodeFrame::new("py"` to `CodeFrame::new("python"` and then running the test should give the desired formatting, i'm in favor of changing the snapshot files for consistency. You don't need to edit the snap file automatically, they are generated by [insta](https://insta.rs/).

---

_Comment by @doolio on 2023-11-08 18:02_

OK cool. Is it simpler then for me to close this PR and create a new one?

---

_Comment by @charliermarsh on 2023-11-08 18:03_

It's ok for it to be part of this PR. You can change the reference above, and then run `cargo test` followed by `cargo insta review`. It should ask you about each snapshot change, and you can confirm them all, then check in the changes and push.

---

_Comment by @doolio on 2023-11-08 18:58_

> then run `cargo test` followed by `cargo insta review`. 

`cargo test` seems to have run without issue but I get the following error trying to run the second command.

![image](https://github.com/astral-sh/ruff/assets/13859009/847572fa-5b68-452a-a94d-9956bf6d77ac)

I can confirm though `insta-1.34.0` is in my `cargo` registry. 

I installed `cargo-insta` (necessary?) and re-ran both commands. Again the tests passed without issue but I now get the following output from the second command.

![image](https://github.com/astral-sh/ruff/assets/13859009/aae6e621-f796-4f17-b4bb-94137f7d6bd0)


---

_Comment by @charliermarsh on 2023-11-09 01:42_

@doolio - They may be nothing to review because you already modified the snapshots themselves. (Typically, if you change something, you run tests, then run `cargo insta review` to review and accept the changes.)

---

_Comment by @charliermarsh on 2023-11-09 01:42_

Anyway, this looks good to me! Thanks!

---

_Merged by @charliermarsh on 2023-11-09 01:49_

---

_Closed by @charliermarsh on 2023-11-09 01:49_

---

_Comment by @github-actions[bot] on 2023-11-09 02:00_

<!-- generated-comment ecosystem -->
## `ruff-ecosystem` results
### Linter (stable)
✅ ecosystem check detected no linter changes.

### Linter (preview)
✅ ecosystem check detected no linter changes.

### Formatter (stable)
✅ ecosystem check detected no format changes.

### Formatter (preview)
✅ ecosystem check detected no format changes.




---

_Branch deleted on 2023-11-09 08:56_

---
