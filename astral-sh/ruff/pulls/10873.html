<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improve IPython escape command parsing logic - astral-sh/ruff #10873</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Improve IPython escape command parsing logic</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10873">#10873</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-04-11 09:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body">Summary
<p>This PR reviews the logic for IPython escape command parsing and makes the required changes to almost match the old parsing logic.</p>
<p>~One change I&#x27;ve not incorporated is the <code>unparse_expr</code>. The new parser can use <code>src_text</code> directly but this means that any whitespace is preserved~ Migrated the <code>unparse_expr</code> logic</p>
Test plan
<p>Use the new parser for testing escape commands and verify that there are no snapshot changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">parser</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-11 09:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-11 09:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:259 on 2024-04-11 09:40</div>
            <div class="timeline-body"><p>I don&#x27;t think we should let it use the fallback logic and instead handle it in <code>parse_ipython_escape_command_statement</code> function.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-11 09:40</div>
            <div class="timeline-body"><blockquote>
<p>This PR reviews the logic for IPython escape command parsing and makes the required changes to almost match the old parsing logic.</p>
</blockquote>
<p>What does that mean. Where does it not match the old parsing logic and why is that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:956 on 2024-04-11 09:42</div>
            <div class="timeline-body"><p>I haven&#x27;t migrated the <a href="https://github.com/astral-sh/ruff/blob/62a9cfcda6c789f0baf7a12293a8f24b2261a9f8/crates/ruff_python_parser/src/lalrpop/python.lalrpop#L380-L410"><code>unparse_expr</code></a> used in the old parser.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-04-11 09:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-04-11 09:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:956 on 2024-04-11 09:43</div>
            <div class="timeline-body"><p>@MichaReiser this is where it doesn&#x27;t match.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-04-11 10:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:956 on 2024-04-11 10:13</div>
            <div class="timeline-body"><p>Nevermind, it wasn&#x27;t too much work migrating it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-11 10:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-11 10:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-04-11 10:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2024-04-11 10:20</div>
            <div class="timeline-body"><a href="https://codspeed.io/astral-sh/ruff/branches/dhruv/ipy-escape-command">CodSpeed Performance Report</a>
Merging #10873 will <strong>degrade performances by 5.25%</strong>
<p>Comparing <code>dhruv/ipy-escape-command</code> (90fd01e) with <code>dhruv/parser</code> (6b4e771)</p>
Summary
<p><code>⚡ 2</code> improvements
<code>❌ 1</code> regressions
<code>✅ 27</code> untouched benchmarks</p>
<blockquote>
<p>:warning: <em>Please fix the performance issues or <a href="https://codspeed.io/astral-sh/ruff/branches/dhruv/ipy-escape-command">acknowledge them on CodSpeed</a>.</em></p>
</blockquote>
Benchmarks breakdown
<p>|     | Benchmark | <code>dhruv/parser</code> | <code>dhruv/ipy-escape-command</code> | Change |
| --- | --------- | ----------------------- | ------------------- | ------ |
| ⚡ | <code>parser[large/dataset.py]</code> | 28.9 ms | 26.7 ms | +8.24% |
| ⚡ | <code>parser[pydantic/types.py]</code> | 11.8 ms | 10.9 ms | +8.78% |
| ❌ | <code>parser[unicode/pypinyin.py]</code> | 1.6 ms | 1.7 ms | -5.25% |</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-04-11 10:35</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+7 -7 violations, +0 -0 fixes in 3 projects; 41 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+2 -2 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/migrations/env.py#L33">airflow/migrations/env.py:33:5:</a> SIM103 Return the condition directly
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/migrations/env.py#L33">airflow/migrations/env.py:33:5:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/scripts/ci/pre_commit/check_integrations_list.py#L113">scripts/ci/pre_commit/check_integrations_list.py:113:9:</a> SIM103 Return the condition `j in [&quot;Description&quot;, &quot;Identifier&quot;]` directly
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/scripts/ci/pre_commit/check_integrations_list.py#L113">scripts/ci/pre_commit/check_integrations_list.py:113:9:</a> SIM103 Return the condition `not j in [&quot;Description&quot;, &quot;Identifier&quot;]` directly
</pre>

</p>

<a href="https://github.com/demisto/content">demisto/content</a> (+4 -4 violations, +0 -0 fixes)
<p>

<pre>
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/CimTrak-SystemIntegrityAssurance/Integrations/CimTrak/CimTrak.py#L1606">Packs/CimTrak-SystemIntegrityAssurance/Integrations/CimTrak/CimTrak.py:1606:5:</a> SIM103 Return the condition `not (value.lower() == &quot;false&quot; or value == &quot;0&quot;)` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/CimTrak-SystemIntegrityAssurance/Integrations/CimTrak/CimTrak.py#L1606">Packs/CimTrak-SystemIntegrityAssurance/Integrations/CimTrak/CimTrak.py:1606:5:</a> SIM103 Return the condition `value.lower() == &quot;false&quot; or value == &quot;0&quot;` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/ContentManagement/Scripts/ConfigurationSetup/ConfigurationSetup.py#L221">Packs/ContentManagement/Scripts/ConfigurationSetup/ConfigurationSetup.py:221:5:</a> SIM103 Return the condition directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/ContentManagement/Scripts/ConfigurationSetup/ConfigurationSetup.py#L221">Packs/ContentManagement/Scripts/ConfigurationSetup/ConfigurationSetup.py:221:5:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/Malwarebytes/Integrations/Malwarebytes/Malwarebytes.py#L1432">Packs/Malwarebytes/Integrations/Malwarebytes/Malwarebytes.py:1432:13:</a> SIM103 Return the condition `data.get(&quot;statusCode&quot;) == 201` directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/Malwarebytes/Integrations/Malwarebytes/Malwarebytes.py#L1432">Packs/Malwarebytes/Integrations/Malwarebytes/Malwarebytes.py:1432:13:</a> SIM103 Return the condition `data.get(&#x27;statusCode&#x27;) == 201` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/TrendMicroDDA/Integrations/TrendMicroDDA/TrendMicroDDA.py#L126">Packs/TrendMicroDDA/Integrations/TrendMicroDDA/TrendMicroDDA.py:126:5:</a> SIM103 Return the condition `binary == &#x27;0&#x27;` directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/TrendMicroDDA/Integrations/TrendMicroDDA/TrendMicroDDA.py#L126">Packs/TrendMicroDDA/Integrations/TrendMicroDDA/TrendMicroDDA.py:126:5:</a> SIM103 Return the condition `not binary == &quot;0&quot;` directly
</pre>

</p>

<a href="https://github.com/zulip/zulip">zulip/zulip</a> (+1 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/zulip/zulip/blob/36aa0177bd0312c32503ca3e368f25664e724ef7/zproject/backends.py#L628">zproject/backends.py:628:5:</a> SIM103 Return the condition `bool(find_ldap_users_by_email(email))` directly
+ <a href="https://github.com/zulip/zulip/blob/36aa0177bd0312c32503ca3e368f25664e724ef7/zproject/backends.py#L628">zproject/backends.py:628:5:</a> SIM103 Return the condition `find_ldap_users_by_email(email)` directly
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| SIM103 | 14 | 7 | 7 | 0 | 0 |</p>
</p>


Linter (preview)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+97 -237 violations, +0 -0 fixes in 12 projects; 32 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+24 -62 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/cli/commands/kubernetes_command.py#L70">airflow/cli/commands/kubernetes_command.py:70:14:</a> FURB103 `open` and `write` should be replaced by `Path(...).write_text(yaml.dump(sanitized_pod))`
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/cli/commands/pool_command.py#L147">airflow/cli/commands/pool_command.py:147:10:</a> FURB103 `open` and `write` should be replaced by `Path(filepath)....`
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/configuration.py#L1309">airflow/configuration.py:1309:13:</a> SIM103 Return the condition `not value is None` directly
+ <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/configuration.py#L1309">airflow/configuration.py:1309:13:</a> SIM103 Return the condition `value is None` directly
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/dag_processing/manager.py#L1248">airflow/dag_processing/manager.py:1248:9:</a> SIM103 Return the condition `not self._num_run &lt; self._max_runs` directly
+ <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/dag_processing/manager.py#L1248">airflow/dag_processing/manager.py:1248:9:</a> SIM103 Return the condition `self._num_run &lt; self._max_runs` directly
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/example_dags/example_kubernetes_executor.py#L91">airflow/example_dags/example_kubernetes_executor.py:91:18:</a> FURB103 `open` and `write` should be replaced by `Path(&quot;/foo/volume_mount_test.txt&quot;).write_text(&quot;Hello&quot;)`
+ <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/migrations/env.py#L33">airflow/migrations/env.py:33:5:</a> SIM103 Return the condition directly
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/migrations/env.py#L33">airflow/migrations/env.py:33:5:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/models/taskinstance.py#L385">airflow/models/taskinstance.py:385:5:</a> SIM103 Return the condition `isinstance(value, (bytearray, bytes, str))` directly
... 42 additional changes omitted for rule SIM103
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/providers/databricks/operators/databricks_sql.py#L152">airflow/providers/databricks/operators/databricks_sql.py:152:18:</a> FURB103 `open` and `write` should be replaced by `Path(self._output_path)....`
- <a href="https://github.com/apache/airflow/blob/5ff26586cd3931d223e76aeb73770f062ff9e409/airflow/providers/fab/auth_manager/security_manager/override.py#L776">airflow/providers/fab/auth_manager/security_manager/override.py:776:18:</a> FURB103 `open` and `write` should be replaced by `Path(password_path).write_text(password)`
... 74 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+1 -42 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/models/basic_plot.py#L42">examples/models/basic_plot.py:42:10:</a> FURB103 `open` and `write` should be replaced by `Path(filename)....`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/models/buttons.py#L75">examples/models/buttons.py:75:10:</a> FURB103 `open` and `write` should be replaced by `Path(filename).write_text(file_html(title=&quot;Button widgets&quot;, doc))`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/models/calendars.py#L104">examples/models/calendars.py:104:10:</a> FURB103 `open` and `write` should be replaced by `Path(filename).write_text(file_html(title=&quot;Calendar 2014&quot;, doc))`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/models/colors.py#L69">examples/models/colors.py:69:10:</a> FURB103 `open` and `write` should be replaced by `Path(filename)....`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/models/custom.py#L117">examples/models/custom.py:117:10:</a> FURB103 `open` and `write` should be replaced by `Path(filename)....`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/models/customjs.py#L38">examples/models/customjs.py:38:10:</a> FURB103 `open` and `write` should be replaced by `Path(filename)....`
... 36 additional changes omitted for rule FURB103
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/server/app/server_auth/auth.py#L40">examples/server/app/server_auth/auth.py:40:9:</a> SIM103 Return the condition `bool(username == &quot;bokeh&quot; and password == &quot;bokeh&quot;)` directly
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/server/app/server_auth/auth.py#L40">examples/server/app/server_auth/auth.py:40:9:</a> SIM103 Return the condition `username == &quot;bokeh&quot; and password == &quot;bokeh&quot;` directly
... 35 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/demisto/content">demisto/content</a> (+25 -25 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py#L763">Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py:763:9:</a> SIM103 Return the condition `RDL is None` directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py#L763">Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py:763:9:</a> SIM103 Return the negated condition directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py#L778">Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py:778:9:</a> SIM103 Return the condition `not not self._valid(self.rcs)` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py#L778">Packs/ARIAPacketIntelligence/Integrations/ARIAPacketIntelligence/ARIAPacketIntelligence.py:778:9:</a> SIM103 Return the condition `not self._valid(self.rcs)` directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/Active_Directory_Query/Integrations/Active_Directory_Query/Active_Directory_Query.py#L347">Packs/Active_Directory_Query/Integrations/Active_Directory_Query/Active_Directory_Query.py:347:5:</a> SIM103 Return the condition `bool(entries.get(&#x27;flat&#x27;))` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/Active_Directory_Query/Integrations/Active_Directory_Query/Active_Directory_Query.py#L347">Packs/Active_Directory_Query/Integrations/Active_Directory_Query/Active_Directory_Query.py:347:5:</a> SIM103 Return the condition `entries.get(&#x27;flat&#x27;)` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py#L540">Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py:540:5:</a> SIM103 Return the condition `not 1 &lt; n_labels &lt; n_samples` directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py#L540">Packs/Base/Scripts/DBotTrainClustering/DBotTrainClustering.py:540:5:</a> SIM103 Return the condition `not not 1 &lt; n_labels &lt; n_samples` directly
- <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/CheckPhish/Integrations/CheckPhish/CheckPhish.py#L144">Packs/CheckPhish/Integrations/CheckPhish/CheckPhish.py:144:5:</a> SIM103 Return the condition `bool(res and res[&#x27;status&#x27;] == DONE_STATUS)` directly
+ <a href="https://github.com/demisto/content/blob/e40c6fbe867cbd5e4593ce3bdf8039c2171fc8dc/Packs/CheckPhish/Integrations/CheckPhish/CheckPhish.py#L144">Packs/CheckPhish/Integrations/CheckPhish/CheckPhish.py:144:5:</a> SIM103 Return the condition `res and res[&#x27;status&#x27;] == DONE_STATUS` directly
... 40 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/freedomofpress/securedrop">freedomofpress/securedrop</a> (+6 -6 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/journalist_gui/journalist_gui/SecureDropUpdater.py#L23">journalist_gui/journalist_gui/SecureDropUpdater.py:23:5:</a> SIM103 Return the condition `not pwd_flag == &quot;NP&quot;` directly
+ <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/journalist_gui/journalist_gui/SecureDropUpdater.py#L23">journalist_gui/journalist_gui/SecureDropUpdater.py:23:5:</a> SIM103 Return the condition `pwd_flag == &quot;NP&quot;` directly
- <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1008">securedrop/pretty_bad_protocol/_parsers.py:1008:9:</a> SIM103 Return the condition `bool(self.fingerprint)` directly
+ <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1008">securedrop/pretty_bad_protocol/_parsers.py:1008:9:</a> SIM103 Return the condition `self.fingerprint` directly
+ <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1321">securedrop/pretty_bad_protocol/_parsers.py:1321:9:</a> SIM103 Return the condition `len(self.fingerprints) == 0` directly
- <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1321">securedrop/pretty_bad_protocol/_parsers.py:1321:9:</a> SIM103 Return the condition `not len(self.fingerprints) == 0` directly
+ <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1425">securedrop/pretty_bad_protocol/_parsers.py:1425:9:</a> SIM103 Return the condition `len(self.fingerprints) == 0` directly
- <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1425">securedrop/pretty_bad_protocol/_parsers.py:1425:9:</a> SIM103 Return the condition `not len(self.fingerprints) == 0` directly
- <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1788">securedrop/pretty_bad_protocol/_parsers.py:1788:9:</a> SIM103 Return the condition `bool(self.ok)` directly
+ <a href="https://github.com/freedomofpress/securedrop/blob/6f7a725097fa02df01d3c8dd467a6faf40bdb3e7/securedrop/pretty_bad_protocol/_parsers.py#L1788">securedrop/pretty_bad_protocol/_parsers.py:1788:9:</a> SIM103 Return the condition `self.ok` directly
... 2 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/milvus-io/pymilvus">milvus-io/pymilvus</a> (+5 -5 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/client/check.py#L166">pymilvus/client/check.py:166:5:</a> SIM103 Return the condition `(end_date - start_date).days &lt; 0` directly
- <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/client/check.py#L166">pymilvus/client/check.py:166:5:</a> SIM103 Return the condition `not (end_date - start_date).days &lt; 0` directly
+ <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/client/check.py#L20">pymilvus/client/check.py:20:5:</a> SIM103 Return the condition `not is_legal_host(a[0]) or not is_legal_port(a[1])` directly
- <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/client/check.py#L20">pymilvus/client/check.py:20:5:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/client/check.py#L27">pymilvus/client/check.py:27:5:</a> SIM103 Return the condition directly
- <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/client/check.py#L27">pymilvus/client/check.py:27:5:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/orm/collection.py#L1445">pymilvus/orm/collection.py:1445:9:</a> SIM103 Return the condition directly
- <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/orm/collection.py#L1445">pymilvus/orm/collection.py:1445:9:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/orm/iterator.py#L458">pymilvus/orm/iterator.py:458:9:</a> SIM103 Return the condition `cached_page is None or len(cached_page) &lt; count` directly
- <a href="https://github.com/milvus-io/pymilvus/blob/b6906e1790f2f1e7499a50831fcd456af34c0586/pymilvus/orm/iterator.py#L458">pymilvus/orm/iterator.py:458:9:</a> SIM103 Return the negated condition directly
</pre>

</p>

<a href="https://github.com/mlflow/mlflow">mlflow/mlflow</a> (+9 -9 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/sklearn/utils.py#L929">mlflow/sklearn/utils.py:929:9:</a> SIM103 Return the condition `not len(c.__abstractmethods__)` directly
- <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/sklearn/utils.py#L929">mlflow/sklearn/utils.py:929:9:</a> SIM103 Return the condition `not not len(c.__abstractmethods__)` directly
+ <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/tracking/_tracking_service/utils.py#L25">mlflow/tracking/_tracking_service/utils.py:25:5:</a> SIM103 Return the condition `_tracking_uri or MLFLOW_TRACKING_URI.get()` directly
- <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/tracking/_tracking_service/utils.py#L25">mlflow/tracking/_tracking_service/utils.py:25:5:</a> SIM103 Return the condition `bool(_tracking_uri or MLFLOW_TRACKING_URI.get())` directly
+ <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/transformers/__init__.py#L1473">mlflow/transformers/__init__.py:1473:5:</a> SIM103 Return the condition directly
- <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/transformers/__init__.py#L1473">mlflow/transformers/__init__.py:1473:5:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/utils/logging_utils.py#L101">mlflow/utils/logging_utils.py:101:9:</a> SIM103 Return the condition directly
- <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/utils/logging_utils.py#L101">mlflow/utils/logging_utils.py:101:9:</a> SIM103 Return the negated condition directly
+ <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/utils/search_utils.py#L1199">mlflow/utils/search_utils.py:1199:9:</a> SIM103 Return the condition directly
- <a href="https://github.com/mlflow/mlflow/blob/1b7b4afa84d52ab29e59a08291bc22626799c743/mlflow/utils/search_utils.py#L1199">mlflow/utils/search_utils.py:1199:9:</a> SIM103 Return the negated condition directly
... 8 additional changes omitted for project
</pre>

</p>

<a href="https://github.com/pypa/cibuildwheel">pypa/cibuildwheel</a> (+1 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/pypa/cibuildwheel/blob/9cf99e78bc06d33fb2947de5820be96ad9c7152c/cibuildwheel/projectfiles.py#L42">cibuildwheel/projectfiles.py:42:5:</a> SIM103 Return the condition `len(consts) != 1` directly
- <a href="https://github.com/pypa/cibuildwheel/blob/9cf99e78bc06d33fb2947de5820be96ad9c7152c/cibuildwheel/projectfiles.py#L42">cibuildwheel/projectfiles.py:42:5:</a> SIM103 Return the condition `not len(consts) != 1` directly
</pre>

</p>

<a href="https://github.com/reflex-dev/reflex">reflex-dev/reflex</a> (+1 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/reflex-dev/reflex/blob/9073a2781b88d36cfb830a43c5505ec8e0081d62/reflex/utils/telemetry.py#L85">reflex/utils/telemetry.py:85:5:</a> SIM103 Return the condition `not should_skip_compile()` directly
+ <a href="https://github.com/reflex-dev/reflex/blob/9073a2781b88d36cfb830a43c5505ec8e0081d62/reflex/utils/telemetry.py#L85">reflex/utils/telemetry.py:85:5:</a> SIM103 Return the condition `should_skip_compile()` directly
</pre>

</p>

<a href="https://github.com/rotki/rotki">rotki/rotki</a> (+0 -19 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/package.py#L734">package.py:734:14:</a> FURB103 `open` and `write` should be replaced by `Path(p12).write_bytes(certificate_data)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/chain/ethereum/airdrops.py#L248">rotkehlchen/chain/ethereum/airdrops.py:248:18:</a> FURB103 `open` and `write` should be replaced by `Path(filename).write_text(response.text, encoding=&#x27;utf8&#x27;)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/chain/ethereum/airdrops.py#L284">rotkehlchen/chain/ethereum/airdrops.py:284:14:</a> FURB103 `open` and `write` should be replaced by `Path(filename)....`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/chain/ethereum/utils.py#L224">rotkehlchen/chain/ethereum/utils.py:224:10:</a> FURB103 `open` and `write` should be replaced by `Path(avatars_dir / f&#x27;{ens_name}.png&#x27;).write_bytes(avatar)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/db/dbhandler.py#L300">rotkehlchen/db/dbhandler.py:300:14:</a> FURB103 `open` and `write` should be replaced by `Path(self.user_data_dir / DBINFO_FILENAME).write_text(rlk_jsondumps(dbinfo), encoding=&#x27;utf8&#x27;)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/db/dbhandler.py#L593">rotkehlchen/db/dbhandler.py:593:18:</a> FURB103 `open` and `write` should be replaced by `Path(tempdbpath).write_bytes(unencrypted_db_data)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/icons.py#L190">rotkehlchen/icons.py:190:14:</a> FURB103 `open` and `write` should be replaced by `Path(self.iconfile_path(asset)).write_bytes(response.content)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/tests/api/test_caching.py#L42">rotkehlchen/tests/api/test_caching.py:42:10:</a> FURB103 `open` and `write` should be replaced by `Path(f&#x27;{icons_dir}/ETH_small.png&#x27;).write_bytes(b&#x27;&#x27;)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/tests/api/test_caching.py#L45">rotkehlchen/tests/api/test_caching.py:45:10:</a> FURB103 `open` and `write` should be replaced by `Path(f&#x27;{icons_dir}/BTC_small.png&#x27;).write_bytes(b&#x27;&#x27;)`
- <a href="https://github.com/rotki/rotki/blob/50590f8ab32b3d47f78f366e8cad19a73228216a/rotkehlchen/tests/api/test_caching.py#L48">rotkehlchen/tests/api/test_caching.py:48:10:</a> FURB103 `open` and `write` should be replaced by `Path(f&#x27;{icons_dir}/AVAX_small.png&#x27;).write_bytes(b&#x27;&#x27;)`
... 9 additional changes omitted for project
</pre>

</p>


<p><em>... Truncated remaining completed project reports due to GitHub comment length restrictions</em></p>
Changes by rule (2 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| SIM103 | 194 | 97 | 97 | 0 | 0 |
| FURB103 | 140 | 0 | 140 | 0 | 0 |</p>
</p>


Formatter (stable)
<p>✅ ecosystem check detected no format changes.</p>
Formatter (preview)
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:03:19 UTC
    </footer>
</body>
</html>
