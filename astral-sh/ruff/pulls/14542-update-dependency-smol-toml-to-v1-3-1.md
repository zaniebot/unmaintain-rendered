```yaml
number: 14542
title: Update dependency smol-toml to v1.3.1
type: pull_request
state: merged
author: renovate
labels:
  - internal
assignees: []
merged: true
base: main
head: renovate/npm-smol-toml-vulnerability
created_at: 2024-11-22T21:11:17Z
updated_at: 2024-11-22T21:16:06Z
url: https://github.com/astral-sh/ruff/pull/14542
synced_at: 2026-01-10T20:50:57Z
```

# Update dependency smol-toml to v1.3.1

---

_Pull request opened by @renovate on 2024-11-22 21:11_

This PR contains the following updates:

| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| [smol-toml](https://redirect.github.com/squirrelchat/smol-toml) | [`1.3.0` -> `1.3.1`](https://renovatebot.com/diffs/npm/smol-toml/1.3.0/1.3.1) | [![age](https://developer.mend.io/api/mc/badges/age/npm/smol-toml/1.3.1?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![adoption](https://developer.mend.io/api/mc/badges/adoption/npm/smol-toml/1.3.1?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![passing](https://developer.mend.io/api/mc/badges/compatibility/npm/smol-toml/1.3.0/1.3.1?slim=true)](https://docs.renovatebot.com/merge-confidence/) | [![confidence](https://developer.mend.io/api/mc/badges/confidence/npm/smol-toml/1.3.0/1.3.1?slim=true)](https://docs.renovatebot.com/merge-confidence/) |

### GitHub Vulnerability Alerts

#### [GHSA-pqhp-25j4-6hq9](https://redirect.github.com/squirrelchat/smol-toml/security/advisories/GHSA-pqhp-25j4-6hq9)

### Summary
An attacker can send a maliciously crafted TOML to cause the parser to crash because of a stack overflow caused by a deeply nested inline structure. A similar problem occurs when attempting to stringify deeply nested objects.

The library does not limit the maximum exploration depth while parsing or producing TOML documents, nor does it offer a way to do so.

### Proof of concept
```js
require("smol-toml").parse("e=" + "{e=".repeat(9999) + "{}" + "}".repeat(9999))
```

### Impact
Applications which parse arbitrary TOML documents may suffer availability issues if they receive malicious input. If uncaught, the crash may cause the application itself to crash. The impact is deemed minor, as the function is already likely to throw errors on invalid input and therefore to properly handle errors.

Due to the design of most JavaScript runtimes, the uncontrolled recursion does not lead to excessive memory usage and the execution is quickly aborted.

As a reminder, it is **strongly** advised when working with untrusted user input to expect errors to occur and to appropriately catch them.

### Patches
Version 1.3.1 offers a mechanism to limit the exploration depth before halting with a `TomlError` when parsing, with a default cap of 1000. A same mechanism has been implemented for stringifying objects.

**Please note that the parser will *still* throw an error upon such cases.** It is, however, a now-controlled and documented behavior of the library.

### Workarounds
Wrap all invocations of `parse` and `stringify` in a try/catch block.

---

### Release Notes

<details>
<summary>squirrelchat/smol-toml (smol-toml)</summary>

### [`v1.3.1`](https://redirect.github.com/squirrelchat/smol-toml/compare/v1.3.0...5ed3ead57e7cff51ecd1543c4dc6a8e0825458bd)

[Compare Source](https://redirect.github.com/squirrelchat/smol-toml/compare/v1.3.0...5ed3ead57e7cff51ecd1543c4dc6a8e0825458bd)

</details>

---

### Configuration

ðŸ“… **Schedule**: Branch creation - "" (UTC), Automerge - At any time (no schedule defined).

ðŸš¦ **Automerge**: Disabled by config. Please merge this manually once you are satisfied.

â™» **Rebasing**: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.

ðŸ”• **Ignore**: Close this PR and you won't be reminded about this update again.

---

 - [ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box

---

This PR was generated by [Mend Renovate](https://mend.io/renovate/). View the [repository job log](https://developer.mend.io/github/astral-sh/ruff).
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzOS4xOS4wIiwidXBkYXRlZEluVmVyIjoiMzkuMTkuMCIsInRhcmdldEJyYW5jaCI6Im1haW4iLCJsYWJlbHMiOlsiaW50ZXJuYWwiLCJzZWN1cml0eSJdfQ==-->


---

_Label `internal` added by @renovate[bot] on 2024-11-22 21:11_

---

_Label `security` added by @renovate[bot] on 2024-11-22 21:11_

---

_@MichaReiser approved on 2024-11-22 21:12_

---

_Label `security` removed by @MichaReiser on 2024-11-22 21:12_

---

_Merged by @MichaReiser on 2024-11-22 21:16_

---

_Closed by @MichaReiser on 2024-11-22 21:16_

---

_Branch deleted on 2024-11-22 21:16_

---
