<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix COM819 auto-fix introducing E202 - astral-sh/ruff #4704</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Fix COM819 auto-fix introducing E202</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/4704">#4704</a>
        opened by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a>
        on 2023-05-29 12:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a></div>
            <div class="timeline-body"><ul>
<li>Close #1975</li>
</ul>
<!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>COM819 now removes the spaces after the prohibited comma to avoid introducing <code>E202</code>.</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<p>The fixture already contained examples with spaces after the prohibited comma.
So, the snapshot has been updated.</p>
<!-- How was it tested? -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> reviewed on 2023-05-29 12:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on <code>crates/ruff/src/rules/flake8_commas/rules/trailing_commas.rs</code>:335 on 2023-05-29 12:22</div>
            <div class="timeline-body"><p>No token other than spaces should be between the comma and the closing bracket.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-05-29 12:32</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Ecosystem</h3>
<p>✅ ecosystem check detected no changes.</p>
<h3>Benchmark</h3>
<h4>Linux</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
linter/all-rules/large/dataset.py          1.00     14.9±0.05ms     2.7 MB/sec    1.01     15.0±0.07ms     2.7 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      3.6±0.01ms     4.6 MB/sec    1.00      3.6±0.01ms     4.6 MB/sec
linter/all-rules/numpy/globals.py          1.00    373.1±0.82µs     7.9 MB/sec    1.00    373.5±1.63µs     7.9 MB/sec
linter/all-rules/pydantic/types.py         1.00      6.2±0.01ms     4.1 MB/sec    1.01      6.3±0.01ms     4.1 MB/sec
linter/default-rules/large/dataset.py      1.00      7.4±0.02ms     5.5 MB/sec    1.02      7.5±0.02ms     5.4 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00   1578.3±2.17µs    10.6 MB/sec    1.01   1595.0±3.97µs    10.4 MB/sec
linter/default-rules/numpy/globals.py      1.00    173.1±0.90µs    17.0 MB/sec    1.01    174.5±1.28µs    16.9 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.3±0.01ms     7.6 MB/sec    1.01      3.4±0.01ms     7.5 MB/sec
parser/large/dataset.py                    1.01      5.8±0.00ms     7.0 MB/sec    1.00      5.7±0.01ms     7.1 MB/sec
parser/numpy/ctypeslib.py                  1.01   1137.5±1.56µs    14.6 MB/sec    1.00   1122.7±1.04µs    14.8 MB/sec
parser/numpy/globals.py                    1.02    116.2±0.54µs    25.4 MB/sec    1.00    114.3±0.33µs    25.8 MB/sec
parser/pydantic/types.py                   1.01      2.5±0.00ms    10.3 MB/sec    1.00      2.5±0.00ms    10.4 MB/sec
</code></pre>
<h4>Windows</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
linter/all-rules/large/dataset.py          1.01     16.9±0.09ms     2.4 MB/sec    1.00     16.8±0.07ms     2.4 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      4.3±0.02ms     3.9 MB/sec    1.00      4.3±0.02ms     3.9 MB/sec
linter/all-rules/numpy/globals.py          1.01    448.1±8.72µs     6.6 MB/sec    1.00    443.3±5.69µs     6.7 MB/sec
linter/all-rules/pydantic/types.py         1.00      7.2±0.03ms     3.5 MB/sec    1.00      7.2±0.03ms     3.6 MB/sec
linter/default-rules/large/dataset.py      1.01      8.5±0.03ms     4.8 MB/sec    1.00      8.4±0.03ms     4.8 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1779.2±13.18µs     9.4 MB/sec    1.00  1774.9±11.19µs     9.4 MB/sec
linter/default-rules/numpy/globals.py      1.00    193.5±1.42µs    15.2 MB/sec    1.01    195.4±6.89µs    15.1 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.8±0.01ms     6.7 MB/sec    1.00      3.8±0.05ms     6.7 MB/sec
parser/large/dataset.py                    1.00      6.7±0.03ms     6.1 MB/sec    1.10      7.3±0.02ms     5.6 MB/sec
parser/numpy/ctypeslib.py                  1.00   1262.0±7.79µs    13.2 MB/sec    1.08   1368.4±5.56µs    12.2 MB/sec
parser/numpy/globals.py                    1.00    130.5±1.40µs    22.6 MB/sec    1.07    139.0±0.74µs    21.2 MB/sec
parser/pydantic/types.py                   1.00      2.8±0.01ms     9.0 MB/sec    1.08      3.1±0.01ms     8.3 MB/sec
</code></pre>
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-29 20:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_commas/snapshots/ruff__rules__flake8_commas__tests__COM81.py.snap</code>:551 on 2023-05-29 20:49</div>
            <div class="timeline-body"><p>Hmm, this strikes me as an incorrect fix though. We should probably (?) be mirroring the spacing around the opening bracket, though I'm not sure it's even worth accounting for this in this rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> requested changes on 2023-05-29 20:50</div>
            <div class="timeline-body"><p>I'm not sure on this one -- my current thinking is that I'd rather leave this to formatters, or to <code>E202</code> as an autofix, rather than make this rule whitespace-aware given all the cases it may need to accomodate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> reviewed on 2023-05-29 20:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on <code>crates/ruff/src/rules/flake8_commas/snapshots/ruff__rules__flake8_commas__tests__COM81.py.snap</code>:551 on 2023-05-29 20:54</div>
            <div class="timeline-body"><p>According to <a href="https://peps.python.org/pep-0008/#pet-peeves">PEP8 - Pet Peeves</a>, this style does not respect PEP8.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-05-29 20:55</div>
            <div class="timeline-body"><p>I am ok with closing this PR and leaving the auto-fix to <code>E202</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-29 20:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_commas/snapshots/ruff__rules__flake8_commas__tests__COM81.py.snap</code>:551 on 2023-05-29 20:57</div>
            <div class="timeline-body"><p>I agree, I'm just not sure that this rule should be modifying it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @JonathanPlasse on 2023-05-29 21:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-10-17 11:07</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:57:42 UTC
    </footer>
</body>
</html>
