<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pycodestyle`] Allow `dtype` comparisons in `type-comparison` - astral-sh/ruff #9676</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pycodestyle</code>] Allow <code>dtype</code> comparisons in <code>type-comparison</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9676">#9676</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-29 17:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body">Summary
<p>Per <a href="https://github.com/astral-sh/ruff/issues/9570">astral-sh/ruff#9570</a>:</p>
<blockquote>
<p><code>dtype</code> are a bit of a strange beast, but definitely best thought of as instances, not classes, and they are meant to be comparable not just to their own class, but also to the corresponding scalar types (e.g., <code>x.dtype == np.float32</code>) and strings (e.g., <code>x.dtype == [&#x27;i1,i4&#x27;]</code>; basically, <code>__eq__</code> always tries to do <code>dtype(other)</code>.</p>
</blockquote>
<p>This PR thus allows comparisons to <code>dtype</code> in preview.</p>
<p>Closes <a href="https://github.com/astral-sh/ruff/issues/9570">astral-sh/ruff#9570</a>.</p>
Test Plan
<p><code>cargo test</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-29 17:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-01-29 17:35</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+0 -180 violations, +0 -0 fixes in 5 projects; 38 projects unchanged)</p>
<a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+0 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/tests/utils/tensorflow/test_rasa_layers.py#L832">tests/utils/tensorflow/test_rasa_layers.py:832:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
</pre>

</p>

<a href="https://github.com/alteryx/featuretools">alteryx/featuretools</a> (+0 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/alteryx/featuretools/blob/3681bbb6ceceed9f820473e5055c5bed7a3771bb/featuretools/entityset/entityset.py#L402">featuretools/entityset/entityset.py:402:17:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+0 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/server/app/crossfilter/main.py#L32">examples/server/app/crossfilter/main.py:32:35:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
</pre>

</p>

<a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+0 -2 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/ibis-project/ibis/blob/e087826a3232f058c07d16b780de40c4e1fab68c/ibis/backends/bigquery/tests/system/test_client.py#L222">ibis/backends/bigquery/tests/system/test_client.py:222:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/ibis-project/ibis/blob/e087826a3232f058c07d16b780de40c4e1fab68c/ibis/backends/bigquery/tests/system/test_client.py#L223">ibis/backends/bigquery/tests/system/test_client.py:223:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
</pre>

</p>

<a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+0 -175 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/_numba/extensions.py#L52">pandas/core/_numba/extensions.py:52:8:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/algorithms.py#L533">pandas/core/algorithms.py:533:13:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/algorithms.py#L790">pandas/core/algorithms.py:790:36:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/algorithms.py#L940">pandas/core/algorithms.py:940:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/algorithms.py#L940">pandas/core/algorithms.py:940:38:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/array_algos/putmask.py#L138">pandas/core/array_algos/putmask.py:138:8:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/array_algos/putmask.py#L44">pandas/core/array_algos/putmask.py:44:13:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/datetimelike.py#L661">pandas/core/arrays/datetimelike.py:661:40:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/datetimelike.py#L774">pandas/core/arrays/datetimelike.py:774:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/datetimelike.py#L780">pandas/core/arrays/datetimelike.py:780:20:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/datetimes.py#L2426">pandas/core/arrays/datetimes.py:2426:10:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/interval.py#L257">pandas/core/arrays/interval.py:257:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/masked.py#L968">pandas/core/arrays/masked.py:968:30:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/numeric.py#L164">pandas/core/arrays/numeric.py:164:8:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/string_arrow.py#L656">pandas/core/arrays/string_arrow.py:656:32:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/timedeltas.py#L1040">pandas/core/arrays/timedeltas.py:1040:8:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/arrays/timedeltas.py#L647">pandas/core/arrays/timedeltas.py:647:20:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/computation/expressions.py#L200">pandas/core/computation/expressions.py:200:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/construction.py#L551">pandas/core/construction.py:551:39:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/construction.py#L605">pandas/core/construction.py:605:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/construction.py#L652">pandas/core/construction.py:652:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/astype.py#L103">pandas/core/dtypes/astype.py:103:10:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/astype.py#L131">pandas/core/dtypes/astype.py:131:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/cast.py#L1036">pandas/core/dtypes/cast.py:1036:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/cast.py#L1065">pandas/core/dtypes/cast.py:1065:21:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/cast.py#L1091">pandas/core/dtypes/cast.py:1091:21:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/cast.py#L1179">pandas/core/dtypes/cast.py:1179:45:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/cast.py#L1700">pandas/core/dtypes/cast.py:1700:8:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/dtypes.py#L450">pandas/core/dtypes/dtypes.py:450:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/dtypes/missing.py#L643">pandas/core/dtypes/missing.py:643:10:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/frame.py#L11535">pandas/core/frame.py:11535:33:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/frame.py#L2482">pandas/core/frame.py:2482:24:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/frame.py#L8129">pandas/core/frame.py:8129:20:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/groupby/generic.py#L1670">pandas/core/groupby/generic.py:1670:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/groupby/groupby.py#L1977">pandas/core/groupby/groupby.py:1977:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexers/utils.py#L321">pandas/core/indexers/utils.py:321:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L5558">pandas/core/indexes/base.py:5558:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L7013">pandas/core/indexes/base.py:7013:56:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L7031">pandas/core/indexes/base.py:7031:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L7051">pandas/core/indexes/base.py:7051:17:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L7054">pandas/core/indexes/base.py:7054:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L7054">pandas/core/indexes/base.py:7054:37:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L7124">pandas/core/indexes/base.py:7124:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/base.py#L873">pandas/core/indexes/base.py:873:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/indexes/datetimelike.py#L156">pandas/core/indexes/datetimelike.py:156:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/internals/concat.py#L371">pandas/core/internals/concat.py:371:12:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/internals/managers.py#L509">pandas/core/internals/managers.py:509:16:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
- <a href="https://github.com/pandas-dev/pandas/blob/56b5979f136e72ce78e5221392739481c025d5e7/pandas/core/nanops.py#L1682">pandas/core/nanops.py:1682:14:</a> E721 Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks
... 127 additional changes omitted for project
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| E721 | 180 | 0 | 180 | 0 | 0 |</p>
</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-01-29 17:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-01-29 17:38</div>
            <div class="timeline-body"><p>Ecosystem looks good</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-29 17:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-29 17:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-29 17:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:01:07 UTC
    </footer>
</body>
</html>
