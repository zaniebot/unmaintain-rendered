<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pydoclint`] Implement `docstring-extraneous-parameter` (`DOC102`) - astral-sh/ruff #20376</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pydoclint</code>] Implement <code>docstring-extraneous-parameter</code> (<code>DOC102</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/20376">#20376</a>
        opened by <a href="https://github.com/augustelalande">@augustelalande</a>
        on 2025-09-13 21:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-09-13 21:26</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Implement <code>docstring-extraneous-parameter</code> (<code>DOC102</code>). This rule checks that all parameters present in a functions docstring are also present in its signature.</p>
<p>Split from #13280, per this <a href="https://github.com/astral-sh/ruff/pull/13280#issuecomment-3280575506">comment</a>.</p>
<p>Part of #12434.</p>
<h2>Test Plan</h2>
<p>Test cases added.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-09-13 21:45</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+66 -0 violations, +0 -0 fixes in 4 projects; 51 projects unchanged)</p>
<details><summary><a href="https://github.com/DisnakeDev/disnake">DisnakeDev/disnake</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/DisnakeDev/disnake/blob/dba1a6223ed2a8d9d699ef86a19c0d8ab1d1c92e/disnake/client.py#L814'>disnake/client.py:814:9:</a> DOC102 Documented parameter `Example` is not in the function's signature
+ <a href='https://github.com/DisnakeDev/disnake/blob/dba1a6223ed2a8d9d699ef86a19c0d8ab1d1c92e/disnake/ext/commands/base_core.py#L855'>disnake/ext/commands/base_core.py:855:5:</a> DOC102 Documented parameter `params` is not in the function's signature
+ <a href='https://github.com/DisnakeDev/disnake/blob/dba1a6223ed2a8d9d699ef86a19c0d8ab1d1c92e/disnake/ext/commands/base_core.py#L895'>disnake/ext/commands/base_core.py:895:5:</a> DOC102 Documented parameter `params` is not in the function's signature
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/superset">apache/superset</a> (+24 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset-extensions-cli/tests/utils.py#L186'>superset-extensions-cli/tests/utils.py:186:9:</a> DOC102 Documented parameter `name` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/async_events/api.py#L57'>superset/async_events/api.py:57:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/charts/data/api.py#L105'>superset/charts/data/api.py:105:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/charts/data/api.py#L287'>superset/charts/data/api.py:287:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L1711'>superset/dashboards/api.py:1711:11:</a> DOC102 Documented parameter `requestBody` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L1717'>superset/dashboards/api.py:1717:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L408'>superset/dashboards/api.py:408:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L459'>superset/dashboards/api.py:459:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L518'>superset/dashboards/api.py:518:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L716'>superset/dashboards/api.py:716:11:</a> DOC102 Documented parameter `requestBody` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L723'>superset/dashboards/api.py:723:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L800'>superset/dashboards/api.py:800:11:</a> DOC102 Documented parameter `requestBody` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/dashboards/api.py#L807'>superset/dashboards/api.py:807:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/databases/api.py#L1058'>superset/databases/api.py:1058:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/databases/api.py#L1139'>superset/databases/api.py:1139:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/databases/api.py#L1373'>superset/databases/api.py:1373:11:</a> DOC102 Documented parameter `requestBody` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/databases/api.py#L1380'>superset/databases/api.py:1380:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
+ <a href='https://github.com/apache/superset/blob/1617bbbe7133f0a6ec1196637a0fb26287c347a7/superset/databases/api.py#L989'>superset/databases/api.py:989:11:</a> DOC102 Documented parameter `responses` is not in the function's signature
... 6 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+26 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L427'>src/bokeh/core/has_props.py:427:13:</a> DOC102 Documented parameter `json` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L429'>src/bokeh/core/has_props.py:429:13:</a> DOC102 Documented parameter `models` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/dataspec.py#L450'>src/bokeh/core/property/dataspec.py:450:13:</a> DOC102 Documented parameter `name` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/descriptors.py#L402'>src/bokeh/core/property/descriptors.py:402:13:</a> DOC102 Documented parameter `json` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/descriptors.py#L404'>src/bokeh/core/property/descriptors.py:404:13:</a> DOC102 Documented parameter `models` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/descriptors.py#L671'>src/bokeh/core/property/descriptors.py:671:13:</a> DOC102 Documented parameter `new` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/descriptors.py#L790'>src/bokeh/core/property/descriptors.py:790:13:</a> DOC102 Documented parameter `json` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/query.py#L69'>src/bokeh/core/query.py:69:9:</a> DOC102 Documented parameter `obj` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/validation/decorators.py#L60'>src/bokeh/core/validation/decorators.py:60:9:</a> DOC102 Documented parameter `code` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/document/document.py#L353'>src/bokeh/document/document.py:353:13:</a> DOC102 Documented parameter `patch` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/document/events.py#L395'>src/bokeh/document/events.py:395:13:</a> DOC102 Documented parameter `column_source` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/document/events.py#L487'>src/bokeh/document/events.py:487:13:</a> DOC102 Documented parameter `column_source` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/document/events.py#L585'>src/bokeh/document/events.py:585:13:</a> DOC102 Documented parameter `column_source` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/driving.py#L149'>src/bokeh/driving.py:149:9:</a> DOC102 Documented parameter `x` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L367'>src/bokeh/embed/bundle.py:367:9:</a> DOC102 Documented parameter `objs` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L380'>src/bokeh/embed/bundle.py:380:9:</a> DOC102 Documented parameter `objs` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/bundle.py#L442'>src/bokeh/embed/bundle.py:442:9:</a> DOC102 Documented parameter `objs` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/_tools.py#L86'>src/bokeh/plotting/_tools.py:86:9:</a> DOC102 Documented parameter `tools_map` is not in the function's signature
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/protocol/message.py#L210'>src/bokeh/protocol/message.py:210:13:</a> DOC102 Documented parameter `buf_header` is not in the function's signature
... 7 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/langchain-ai/langchain">langchain-ai/langchain</a> (+13 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/core/langchain_core/callbacks/file.py#L136'>libs/core/langchain_core/callbacks/file.py:136:13:</a> DOC102 Documented parameter `file` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/core/langchain_core/outputs/chat_generation.py#L47'>libs/core/langchain_core/outputs/chat_generation.py:47:13:</a> DOC102 Documented parameter `values` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/core/langchain_core/utils/mustache.py#L451'>libs/core/langchain_core/utils/mustache.py:451:9:</a> DOC102 Documented parameter `partials_path` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/core/langchain_core/utils/mustache.py#L454'>libs/core/langchain_core/utils/mustache.py:454:9:</a> DOC102 Documented parameter `partials_ext` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/core/tests/unit_tests/test_tools.py#L1350'>libs/core/tests/unit_tests/test_tools.py:1350:13:</a> DOC102 Documented parameter `banana` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/core/tests/unit_tests/test_tools.py#L1351'>libs/core/tests/unit_tests/test_tools.py:1351:13:</a> DOC102 Documented parameter `monkey` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/langchain/langchain_classic/agents/agent.py#L1098'>libs/langchain/langchain_classic/agents/agent.py:1098:13:</a> DOC102 Documented parameter `values` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/langchain/langchain_classic/agents/agent.py#L833'>libs/langchain/langchain_classic/agents/agent.py:833:13:</a> DOC102 Documented parameter `values` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/langchain/langchain_classic/agents/openai_functions_agent/base.py#L69'>libs/langchain/langchain_classic/agents/openai_functions_agent/base.py:69:13:</a> DOC102 Documented parameter `values` is not in the function's signature
+ <a href='https://github.com/langchain-ai/langchain/blob/2209878f480aeb6cbfa4fb271f632b832b10e85d/libs/langchain/langchain_classic/evaluation/scoring/eval_chain.py#L306'>libs/langchain/langchain_classic/evaluation/scoring/eval_chain.py:306:13:</a> DOC102 Documented parameter `prediction_b` is not in the function's signature
... 3 additional changes omitted for project
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| DOC102 | 66 | 66 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-09-16 20:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @ntBre on 2025-09-16 20:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:589 on 2025-09-16 20:51</div>
            <div class="timeline-body"><p>This doesn't seem like a big deal either way, but I noticed that <code>parse_raises_google</code> doesn't trim indentation first, unlike <code>parse_raises_numpy</code>. Could we get away with just an immediate <code>split_once</code> call followed by a <code>trim()</code> call to strip the whitespace? Again, it seems fine either way, just an idea to more closely mirror the <code>raises</code> version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/snapshots/ruff_linter__rules__pydoclint__tests__docstring-extraneous-parameter_DOC102_google.py.snap</code>:153 on 2025-09-16 21:34</div>
            <div class="timeline-body"><p>Do you think it would be helpful to show a sub-diagnostic or secondary annotation highlighting the parameter list itself? Obviously they're nearby in the source code, but it might be nice to see them both in the diagnostic. Just an idea since we have support for multiple spans now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/pydoclint/DOC102_numpy.py</code>:11 on 2025-09-16 21:38</div>
            <div class="timeline-body"><p>Could we add a test case without a type? It looked like the code would handle it correctly, but I didn't see a test for it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-09-16 21:43</div>
            <div class="timeline-body"><p>Thanks for your work here and for splitting off the PR! This looks great to me overall, just a few minor ideas/suggestions. Did you look into reusing any code from <code>D417</code>? That seemed like the only <a href="https://github.com/astral-sh/ruff/pull/13280#issuecomment-2362997178">comment</a> from the other PR that wasn't fully resolved.</p>
<p>I'd also like @MichaReiser to have a chance to look since he reviewed #13280 originally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/augustelalande">@augustelalande</a> on <code>crates/ruff_linter/src/rules/pydoclint/snapshots/ruff_linter__rules__pydoclint__tests__docstring-extraneous-parameter_DOC102_google.py.snap</code>:153 on 2025-09-17 03:28</div>
            <div class="timeline-body"><p>lol the original PR predates multiple spans. Can you suggest an example I can reference?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a> reviewed on 2025-09-17 03:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a> reviewed on 2025-09-17 03:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/augustelalande">@augustelalande</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:589 on 2025-09-17 03:49</div>
            <div class="timeline-body"><p>Depends if we care about enforcing indentation. You are right that I'm being inconsistent between raises and parameters. Not sure which is the better approach.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-09-18 14:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/snapshots/ruff_linter__rules__pydoclint__tests__docstring-extraneous-parameter_DOC102_google.py.snap</code>:153 on 2025-09-18 14:30</div>
            <div class="timeline-body"><p>Sure, I copied this from another comment I wrote so hopefully the  links aren't too outdated:</p>
<p>The easiest way is  with <code>secondary_annotation</code> on the guard returned by <code>report_diagnostic</code>:</p>
<p>https://github.com/astral-sh/ruff/blob/2245355931f66def488809a6b9b784f7c294bd49/crates/ruff_linter/src/checkers/ast/mod.rs#L3309-L3311</p>
<p>Here's the one use of it we've added so far:</p>
<p>https://github.com/astral-sh/ruff/blob/2245355931f66def488809a6b9b784f7c294bd49/crates/ruff_linter/src/rules/pyflakes/rules/redefined_while_unused.rs#L195-L198</p>
<p>And an example of the type of diagnostic it produces (the <code>-----</code> underlining is used for secondary annotations):</p>
<p>https://github.com/astral-sh/ruff/blob/2245355931f66def488809a6b9b784f7c294bd49/crates/ruff_linter/src/rules/pyflakes/snapshots/ruff_linter__rules__pyflakes__tests__F811_F811_0.py.snap#L4-L17</p>
<p>There are some other options if that doesn't look good, but that's the easiest place to start.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a> reviewed on 2025-09-19 01:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/augustelalande">@augustelalande</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:589 on 2025-09-19 01:45</div>
            <div class="timeline-body"><p>I think I prefer enforcing consistent indentation. I would rather update parse_raises in a separate PR</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:589 on 2025-09-19 16:50</div>
            <div class="timeline-body"><p>That sounds good to me</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-09-19 16:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/snapshots/ruff_linter__rules__pydoclint__tests__docstring-extraneous-parameter_DOC102_google.py.snap</code>:40 on 2025-09-19 17:05</div>
            <div class="timeline-body"><p>Oh wow, I was actually suggesting to show the parameters in the function definition, which I thought would be a bit easier to implement. Something like:</p>
<pre><code>DOC102 Documented parameter `multiplier` is not in the function's signature
  --&gt; DOC102_google.py:21:5
   |
19 |     Multiplies each element in a list by a given multiplier.
20 |
21 |     Args:
   |     ^^^^
22 |         lst (list of int): A list of integers.
23 |         multiplier (int): The multiplier for each element in the list.
24 |
25 |     Returns:
   |
   | ------------------------------------------------------------
   |
16 | # DOC102
17 | def multiply_list_elements(lst):
   |                           ----- parameters defined here
18 | &quot;&quot;&quot;
   |
help: Remove the extraneous parameter from the docstring
</code></pre>
<p>Now that you've implemented this, though, should we make it the main diagnostic range instead of the section heading? I saw some previous discussion about this <a href="https://github.com/astral-sh/ruff/pull/13280#discussion_r1752784612">here</a>.</p>
<p>After mocking up my original/intended suggestion above, I think it might have been a bad idea, but using the ranges you're computing now as the main diagnostic ranges would be great. What do you think? At that point we could also emit one diagnostic per parameter as Micha suggested in the other PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:678 on 2025-09-19 17:12</div>
            <div class="timeline-body"><p>I think we try to avoid <code>as</code> casts since they can silently misbehave. This should be safe since the ranges are from within the document, and the document has to be less than <code>u32::MAX</code> in length, but let's unwrap in case that assumption ever breaks down:</p>
<pre><code class="language-suggestion">                            content_start + TextSize::try_from(param_start as u32).unwrap(),
                            content_start + TextSize::try_from(param_end).unwrap(),
</code></pre>
<p>Ah this is what clippy is complaining about too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-09-19 17:27</div>
            <div class="timeline-body"><p>Thank you! You went above and beyond my diagnostic suggestion. I think we could use that for the main diagnostic now. The code looks good to me otherwise.</p>
<p>However, I took a quick peek at the ecosystem results, and this one in particular looks pretty suspicious:</p>
<p><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L805">disnake/client.py:805:9:</a> DOC102 These documented parameters are not in the function's signature: <code>Example</code>, <code>--------</code>, <code>.. code-block</code></p>
<p>I know we have some open issues around sphinx docstrings, but ideally we'd eliminate these false positives at least.</p>
<p>This one also looks interesting, I wonder if we should consider skipping <code>*args</code> as well as <code>**kwargs</code>:</p>
<p><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/ext/commands/context.py#L310">disnake/ext/commands/context.py:310:9:</a> DOC102 Documented parameter <code>entity</code> is not in the function's signature</p>
<p>This one looks like it should have been straightforward, but we have a false positive on <code>cls</code>:</p>
<p><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/ext/commands/flag_converter.py#L556">disnake/ext/commands/flag_converter.py:556:9:</a> DOC102 Documented parameter <code>cls</code> is not in the function's signature</p>
<p>We'll need to go through all of the ecosystem results, but those are a few I pulled out from the <code>disnake</code> run.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-09-19 23:14</div>
            <div class="timeline-body"><p>I fixed:</p>
<p><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/ext/commands/context.py#L310">disnake/ext/commands/context.py:310:9:</a> DOC102 Documented parameter entity is not in the function's signature</p>
<p>and</p>
<p><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/ext/commands/flag_converter.py#L556">disnake/ext/commands/flag_converter.py:556:9:</a> DOC102 Documented parameter cls is not in the function's signature</p>
<p>however the problem with</p>
<p><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L805">disnake/client.py:805:9:</a> DOC102 These documented parameters are not in the function's signature: Example, --------, .. code-block</p>
<p>is that <code>Example</code> is not an official numpy docstring section, where <code>Examples</code> is prefered. As defined <a href="https://github.com/astral-sh/ruff/blob/main/crates/ruff_linter/src/docstrings/numpy.rs">here</a> and <a href="https://numpydoc.readthedocs.io/en/latest/format.html#examples">here</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-09-23 12:53</div>
            <div class="timeline-body"><p>Thanks! Have you looked through the other ecosystem results? It looks like airflow has some YAML blocks in docstrings that we're trying to parse as parameter names (lots of <code>-</code> diagnostics), and there are a couple of splitting issues in bokeh like this:</p>
<blockquote>
<p><a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L435">src/bokeh/core/has_props.py:435:13:</a> DOC102 Documented parameter <code>setter(ClientSession</code> is not in the function's signature</p>
</blockquote>
<p>I wonder if we should be a little more permissive with the numpy example(s) section. I don't really like the look of emitting diagnostics like this:</p>
<ul>
<li><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L812">disnake/client.py:812:9:</a> DOC102 Documented parameter <code>Example</code> is not in the function's signature</li>
<li><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L813">disnake/client.py:813:9:</a> DOC102 Documented parameter <code>--------</code> is not in the function's signature</li>
<li><a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L815">disnake/client.py:815:9:</a> DOC102 Documented parameter <code>.. code-block</code> is not in the function's signature</li>
</ul>
<p>It may help in several of these cases to filter out candidates that aren't valid Python identifiers, if we can't avoid checking them in the first place.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-09-23 12:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/snapshots/ruff_linter__rules__pydoclint__tests__docstring-extraneous-parameter_DOC102_numpy.py.snap</code>:10 on 2025-09-23 12:57</div>
            <div class="timeline-body"><p>These new diagnostics look really good! It looks like we're underlining one additional character in some cases, though. The <code>a</code> example above in the Google file looks good, but this one has an extra space.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-09-23 21:44</div>
            <div class="timeline-body"><blockquote>
<p>It may help in several of these cases to filter out candidates that aren't valid Python identifiers, if we can't avoid checking them in the first place.</p>
</blockquote>
<p>I have limited the detection of parameters to those beginning with valid characters.</p>
<blockquote>
<p>I wonder if we should be a little more permissive with the numpy example(s) section. I don't really like the look of emitting diagnostics like this:
<a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L812">disnake/client.py:812:9:</a> DOC102 Documented parameter Example is not in the function's signature
<a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L813">disnake/client.py:813:9:</a> DOC102 Documented parameter -------- is not in the function's signature
<a href="https://github.com/DisnakeDev/disnake/blob/7fa65774938b88565c236474973d1ce942081e9e/disnake/client.py#L815">disnake/client.py:815:9:</a> DOC102 Documented parameter .. code-block is not in the function's signature</p>
</blockquote>
<p>We can, and it is easy to change, but it seems out of scope for this PR</p>
<blockquote>
<p><a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L435">src/bokeh/core/has_props.py:435:13:</a> DOC102 Documented parameter setter(ClientSession is not in the function's signature</p>
</blockquote>
<p>As far as I'm concerned this one is a problem with their formatting, they should have a space between the parameter and the type.</p>
<blockquote>
<p>lots of - diagnostics</p>
</blockquote>
<p>This is also a problem with their docstrings, they aren't using google or numpy style, so we can't parse them properly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:597 on 2025-10-01 18:12</div>
            <div class="timeline-body"><p>I imagine that this would cover the vast majority of cases, but it's not strictly correct. We should try to use something like <a href="https://github.com/astral-sh/ruff/blob/caf48f4bfc54bb587342bf794a4f5167d855f529/crates/ruff_python_stdlib/src/identifiers.rs#L7"><code>is_identifier</code></a> or the helper functions it uses to cover non-ascii cases and any other nuances.</p>
<p>I'm kind of wondering if a regex might be helpful here. Something like <code>\*{0,2}([\w_]+) *:</code> seems like it would work? Then we could apply <code>is_identifier</code> to the capture group and reject any non-identifiers. Then we can be a bit more flexible with missing spaces and such.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-10-01 18:32</div>
            <div class="timeline-body"><p>Thanks! I've been thinking about how to handle the false positives. I think I agree with you that these are technically issues in the ecosystem docs, but they'll still look like false positives in Ruff, so I'd like to err on the side of filtering them out.</p>
<p>I had a couple of ideas about identifier handling in an inline comment that I think could help with some of them.</p>
<p>I'm somewhat less concerned about the <code>Example</code> case and the inline YAML docstrings, but one idea that came to mind is if we can bail out if we're not in a known <code>Args</code> or <code>Parameters</code> section? That seems like it would filter out at least the YAML cases I looked at, which don't fall under any known section heading as far as I can tell.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-10-01 18:51</div>
            <div class="timeline-body"><blockquote>
<p>Thanks! I've been thinking about how to handle the false positives. I think I agree with you that these are technically issues in the ecosystem docs, but they'll still look like false positives in Ruff, so I'd like to err on the side of filtering them out.</p>
<p>I had a couple of ideas about identifier handling in an inline comment that I think could help with some of them.</p>
<p>I'm somewhat less concerned about the <code>Example</code> case and the inline YAML docstrings, but one idea that came to mind is if we can bail out if we're not in a known <code>Args</code> or <code>Parameters</code> section? That seems like it would filter out at least the YAML cases I looked at, which don't fall under any known section heading as far as I can tell.</p>
</blockquote>
<p>If by YAML docstring you are referring to something like this https://github.com/apache/superset/blob/4b71adaa9c89925676e7fed6af0c56c5b0ece863/superset/dashboards/api.py#L1711, the issue is that one of the keys is <a href="https://github.com/apache/superset/blob/4b71adaa9c89925676e7fed6af0c56c5b0ece863/superset/dashboards/api.py#L1705C11-L1705C22"><code>parameters</code></a> which causes our parser to think it is in a parameters section. We already split the docstring into sections, so we are not processing anything outside of identified sections.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a> reviewed on 2025-10-01 20:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/augustelalande">@augustelalande</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:597 on 2025-10-01 20:16</div>
            <div class="timeline-body"><p>Ok I should now only be considering valid identifiers. That should get rid of more false positives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-10-07 20:07</div>
            <div class="timeline-body"><p>@ntBre Any further comments?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-07 21:01</div>
            <div class="timeline-body"><p>No, I think you've convinced me. I might do one more pass over the code, but I think we should land this.</p>
<p>There are still a few false positives for unusual docstring formats, but the ecosystem check is also showing quite a few true positives. I think it's a helpful rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-10-15 23:04</div>
            <div class="timeline-body"><p>@ntBre Sorry to be pushy, but it's been a year since I made the initial pull request, it's been reviewed 3 or 4 times, and every time the conversation just goes silent with no more comments and no merge. I'm fine with making more changes, and fine with it not being merged, but I would really appreciate some transparency about what is holding things up.</p>
<p>Best,</p>
<p>Auguste</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-15 23:06</div>
            <div class="timeline-body"><p>Sorry, just a bit behind on my notifications. This is still in my inbox to do another once-over on the code, but I didn't quite get to it today. I'll make this my first review tomorrow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2025-10-15 23:08</div>
            <div class="timeline-body"><p>@ntBre Thanks for the quick reply, and appreciate everything you guys do</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-10-16 14:46</div>
            <div class="timeline-body"><p>Awesome, thanks for all of your work on this and for your patience with all the reviews!</p>
<p>I pushed one commit using <code>TextSize</code> a bit more heavily in the parameter parsing functions. The  +1 to the length wasn't quite right for files with <code>\r\n</code> line endings, but we can use the <code>full_line_end</code> method from the <code>LineRanges</code> trait to help with that. Then it became a bit easier to use <code>TextSize</code> elsewhere and avoid some unwraps to boot.</p>
<p>I also wrote up a follow-up issue for the last two types of false positives in the ecosystem check: https://github.com/astral-sh/ruff/issues/20923. I think we should go ahead and land this, but I wanted to track those somewhere.</p>
<p>I'll make sure my change doesn't regress the ecosystem check, and then I'll hit merge!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-10-16 15:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-10-16 15:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-10-25 20:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 17:00:12 UTC
    </footer>
</body>
</html>
