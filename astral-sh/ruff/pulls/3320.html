<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `cargo dev generate-all --check` and catch outdated docs in `cargo test` - astral-sh/ruff #3320</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>cargo dev generate-all --check</code> and catch outdated docs in <code>cargo test</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/3320">#3320</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2023-03-03 12:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p><code>cargo test</code> now catches outdated generated docs. You can also run the checks manually with <code>cargo dev generate-all --check</code>.</p>
<p>Follow up for #3309 which i was too slow for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/konstin">@konstin</a> on 2023-03-03 12:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_dev/Cargo.toml</code>:14 on 2023-03-03 12:31</div>
            <div class="timeline-body"><p>i&#x27;m surprised i didn&#x27;t find a better <code>git diff</code> like library but that&#x27;s good enough for this case</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-03-03 12:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-03-03 15:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_dev/src/generate_json_schema.rs</code>:57 on 2023-03-03 15:47</div>
            <div class="timeline-body"><p>Maybe a nit, but how do you think about <code>.unwrap</code> vs. <code>fn test_generate_json_schema() -&gt; Result&lt;&gt;</code> with <code>?</code> and <code>Ok(())</code> etc.?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2023-03-03 15:47</div>
            <div class="timeline-body"><p>LGTM!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-03-03 17:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_dev/src/generate_json_schema.rs</code>:57 on 2023-03-03 17:37</div>
            <div class="timeline-body"><p>good catch</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-03-03 17:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff/src/rule_selector.rs</code>:187 on 2023-03-03 17:38</div>
            <div class="timeline-body"><p>@charliermarsh please have another look i had to add this hack for logical lines</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-03-03 18:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rule_selector.rs</code>:187 on 2023-03-03 18:10</div>
            <div class="timeline-body"><p>Ahh I see, so we want to omit these because as-is, they&#x27;re <em>included</em> when running the tests with <code>--all-features</code>, but <em>excluded</em> when running <code>cargo dev generate-all</code> (and, intentionally, excluded from the docs, schema, etc.).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2023-03-03 18:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/konstin">@konstin</a> on 2023-03-06 10:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2023-03-06 10:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-03-06 10:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sciyoshi">@sciyoshi</a> on 2023-03-07 19:57</div>
            <div class="timeline-body"><p>It seems like this PR removed the <code>cargo-build</code> job in CI. Was that intentional?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sciyoshi">@sciyoshi</a> on 2023-03-07 19:59</div>
            <div class="timeline-body"><p>Actually I suppose the build is already part of <code>cargo test</code>, so that makes sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-07 20:14</div>
            <div class="timeline-body"><p>Yeah that was the reasoning -- that <code>cargo test</code> already does a build.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-03-07 20:35</div>
            <div class="timeline-body"><p>sorry i somehow missed to put that in the commit message</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:52:36 UTC
    </footer>
</body>
</html>
