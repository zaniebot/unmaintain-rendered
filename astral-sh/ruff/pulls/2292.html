<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disable D203, D212, D213 and S101 by default - astral-sh/ruff #2292</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Disable D203, D212, D213 and S101 by default</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/2292">#2292</a>
        opened by <a href="https://github.com/not-my-profile">@not-my-profile</a>
        on 2023-01-28 06:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a></div>
            <div class="timeline-body"><p>(see our discussion in #2289 as well as the commit messages for the reasoning)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @not-my-profile on 2023-01-28 06:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @not-my-profile on 2023-01-28 06:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-01-28 10:36</div>
            <div class="timeline-body"><p>Does specifying <code>tool.ruff.pydocstyle.convention</code> still activates the rules <code>D203</code>, <code>D212</code>, and <code>D213</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on 2023-01-28 11:47</div>
            <div class="timeline-body"><p>Good question. Previously <code>pydocstyle.convention</code>  only disabled rules, it never enabled them, so if you didn't also select them via <code>D</code> it wouldn't turn them on. I do not want the new <code>explicitly_enabled</code> logic to somehow take the presence of a <code>D</code> selector into account since I think that would overcomplicate the rule selection behavior ... so I'll change <code>pydocstyle.convention</code>  to enable these rules even if <code>D</code> isn't selected ... even if that is a bit of a breaking change I think it much better aligns with the probable user intention.</p>
<p>(Marking this as a draft till I implement that ... probably only have time for that in a couple of hours.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @not-my-profile on 2023-01-28 11:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-28 12:20</div>
            <div class="timeline-body"><p><code>D203</code> and <code>D213</code> aren't part of any of the valid conventions. (<code>D212</code> <em>is</em>, and shouldn't be part of any sort of automatic disable list IMO.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-28 12:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>README.md</code>:1227 on 2023-01-28 12:21</div>
            <div class="timeline-body"><p>We ignore comparisons to strings by default. At least, that's the intent (it's parameterizable). If so, this message is incorrect, I think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/settings/nursery.rs</code>:11 on 2023-01-28 12:30</div>
            <div class="timeline-body"><p>I'd like to remove this, <code>Rule::MagicValueComparison</code>, and <code>Rule::MultiLineSummaryFirstLine</code> from this list for now. We can always add them later. But I don't want to couple the debate here to the removal of specific rules, apart from those that motivated the issue. The goal here is really to solve the infinite iteration loop for new users.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-28 12:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-28 12:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/settings/nursery.rs</code>:8 on 2023-01-28 12:31</div>
            <div class="timeline-body"><p>Here's where I'm torn: assume that no user <em>ever</em> enabled this rule. Why support it? Why maintain the code? The tests? Etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-28 14:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>README.md</code>:1227 on 2023-01-28 14:22</div>
            <div class="timeline-body"><p>Ah ... I hadn't noticed the <code>allow-magic-value-types</code> setting you introduced in #1987, which even defaults to <code>[&quot;str&quot;]</code>. Ok yes this addresses the problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Disable D203, D212, D213, PLR2004 and S101 by default" to "Disable D203, D212, D213 and S101 by default" by @not-my-profile on 2023-01-28 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-28 14:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>README.md</code>:1227 on 2023-01-28 14:29</div>
            <div class="timeline-body"><p>I have dropped the default disabling of MagicValueComparison from this PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-28 14:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/settings/nursery.rs</code>:8 on 2023-01-28 14:59</div>
            <div class="timeline-body"><p>I am alright with dropping these rules completely. However you don't want to break configs that currently ignore these rules and since the <code>RuleCodePrefix</code> serde impls are currently automatically derived, I think the easiest way to achieve that would be to introduce a no-op rule and map the legacy codes to that no-op violation that simply never gets triggered ... however since we don't yet have the many-to-many mapping we'd need to assign a rule code to the no-op rule ... which feels wrong since it's very much an implementation detail. So I'd rather have us wait with the dropping of these rules until after the many-to-many mapping has been implemented.</p>
<p>And I also think it would be nice to have some deprecation period with ruff still supporting the rules but printing a warning that we are planning on dropping them with a link to a GitHub issue about that, so that in case these rules are in fact used by some users they can voice their opinions about it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-28 15:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/settings/nursery.rs</code>:11 on 2023-01-28 15:03</div>
            <div class="timeline-body"><blockquote>
<p>D212 (MultiLineSummaryFirstLine) is [part of a valid convention], and shouldn't be part of any sort of automatic disable list IMO</p>
</blockquote>
<p>It is not part of PEP 257, which I'd consider to be the only default convention. I don't think it makes sense to enable convention-specific rules by default just because they are part of some convention ... there are many conventions and unless the user has configured <code>convention</code> we don't  know which convention they use. Case in point: pydocstyle also does not enable D212 by default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-01-28 15:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>src/settings/nursery.rs</code>:8 on 2023-01-28 15:14</div>
            <div class="timeline-body"><p>This is reasonable. I'd like to get these rules out of <code>--select D</code> and <code>--select ALL</code> as soon as we can. And the approach you've proposed here does achieve that (as long as we preserve retaining <code>D212</code> when the appropriate conventions are set, as per the discussion above).</p>
<p>I do think it's strange to put these rules in <code>nursery</code> rather than mark them as explicitly deprecated (and use the strategy you've implemented here to handle those deprecations), since we know we want to remove them. My preference would be to leave <code>S101</code> and <code>D212</code> for now, and use the strategy here for <code>D203</code> and <code>D213</code>, but mark them as deprecated rather than in nursery. To me, nursery suggests that there's a path to stabilizing these rules, but the intent here really is to discourage and stop supporting them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on 2023-01-28 20:53</div>
            <div class="timeline-body"><p>Just an update:</p>
<ul>
<li>I'd firstly like to fix the config resolution situation #2312.</li>
<li>Then I'd like to convert the <code>pydocstyle.convention</code> setting into a rule selector ... so you could e.g. <code>--select pydocstyle:google</code> and then ignore a specific rule from that rule set with <code>--ignore</code></li>
<li>And then finally disable these problematic pydocstyle rules by default by implementing the changes in this PR.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-01-28 20:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>src/settings/nursery.rs</code>:8 on 2023-01-28 20:55</div>
            <div class="timeline-body"><p>I am not convinced that keeping these rules around actually is much of a maintenance burden ... once the conflict / endless iteration issue has been fixed by disabling them by default they really shouldn't be such a hassle anymore ... but if you want to remove them that's very much your call.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluetech">@bluetech</a> on 2023-01-28 21:36</div>
            <div class="timeline-body"><p>Regarding the <code>assert</code> one, clippy deals with this by having a <a href="https://doc.rust-lang.org/clippy/lints.html#restriction"><code>clippy::restriction</code></a> group that is off by default, and is not meant to be enabled wholesale, but contains lints which can be enabled for specific code bases which want to enforce that some feature is not used (see lint list <a href="https://rust-lang.github.io/rust-clippy/stable/index.html">here</a>). I can imagine this being useful for some Python projects, e.g. enforce no <code>assert</code>, <a href="https://github.com/gevent/gevent">no <code>async</code>/<code>await</code></a>, no <code>:=</code>, no <code>breakpoint()</code>, or even <a href="https://github.com/dry-python/returns">no exceptions</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-30 22:54</div>
            <div class="timeline-body"><p>@not-my-profile - This came up again recently (#2368). What can we do to prioritize turning those <code>D</code> rules off by default?</p>
<p>I'd like to start by <em>just</em> disabling the <code>D</code> rules, and we can revisit the other cases later.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on 2023-02-01 15:32</div>
            <div class="timeline-body"><p>Closing this for now since ba26a60e2a49716da4bd0a01b7faad17b9094216 has addressed the issue that prompted this PR.</p>
<p>The tracking issue for the more flexible rule categorization is #1774.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @not-my-profile on 2023-02-01 15:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:55:51 UTC
    </footer>
</body>
</html>
