<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promote `lint.` settings over top-level settings - astral-sh/ruff #9476</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Promote <code>lint.</code> settings over top-level settings</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9476">#9476</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2024-01-11 19:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">Summary
<p>This PR marks the top-level lint settings as deprecated (schema only) and updates the website to document the options under the lint section (removes the top-level settings).</p>
<p>I had to make changes to the documentation generation to now support 3-level deep options</p>
<ul>
<li>The documentation now shows the entire name for sub-sub-sections (e.g. <code>lint.pydocstyle</code> instead of <code>pydocstyle</code>) because sub-sub-sections are rendered at the same level as sub-sections.</li>
<li>The anchor link now contains the entire parent chain: <code>lint.pycodestyle.xxx</code> instead of <code>pycodestyle.xxx</code>.</li>
<li>The anchor link now use <code>_</code> instead of <code>-</code> as a separator to disambiguate between the subsection <code>lint.pydocstyle</code> and option <code>lint-pydocstyle</code></li>
</ul>
<p>I feel undecided about one open question: Should we use the full setting name in READMEs or only the name? For example. Should we write <code>lint.ignore</code> or <code>ignore</code>? Or a more extreme example. Should we write max-complexity<code>or</code>lint.mccabe.max-complexity`. We currently use a mix of both:</p>
<ul>
<li>The tutorial mainly uses the short names</li>
<li>Rules use the full name (until today without the <code>lint</code> prefix)</li>
</ul>
<p>I changed the tutorial to use long names in most positions but it didn&#x27;t always feel right.</p>
Considerations
<p>One downside of removing the top-level settings from the website is that Ruff&#x27;s documentation isn&#x27;t versioned. Users using an older version of ruff that only supports the global settings or use the global options might be confused why the options are missing.</p>
<p>A possible solution is adding aliasing support to our documentation generation, although that might be tricky.</p>
<p>IMO, removing is fine because the <code>lint</code> section has been supported since <a href="https://github.com/astral-sh/ruff/releases/tag/v0.0.292">v0.0.292</a>, which feels like a very long time ago.</p>
Next steps
<p>Emit deprecation messages when a configuration uses any deprecated top-level settings.</p>
Test Plan
<ul>
<li>I built the documentation locally and verified that the lint options are only listed once under the <code>lint</code> section (which helps discoverability).</li>
<li>I read through the documentation and clicked through the setting options to verify that the anchor links work</li>
<li>I reviewed the schema changes and it marks the top level lint settings as deprecated.</li>
</ul>
<p><img src="https://github.com/astral-sh/ruff/assets/1203881/ea5d8bc5-e525-45bb-98ff-57af032b5513" alt="image"></p>
<blockquote>
<p><strong>Danger</strong>: Only merge before the 0.2.0 release</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-11 19:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-11 19:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-11 19:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2024-01-19 14:03</div>
            <div class="timeline-body"><a href="https://codspeed.io/astral-sh/ruff/branches/promote-lint-options-over-top-level-settings">CodSpeed Performance Report</a>
Merging #9476 will <strong>not alter performance</strong>
<p>:warning: No base runs were found</p>
<p>Falling back to comparing <code>promote-lint-options-over-top-level-settings</code> (6a200c0) with <code>main</code> (50122d2)</p>
Summary
<p><code>✅ 30</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-01-19 14:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>docs/formatter.md</code>:333 on 2024-01-19 14:07</div>
            <div class="timeline-body"><p>An example where we don&#x27;t use full qualified setting names.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-19 14:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-19 14:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.2.0&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-19 14:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-19 14:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-01-19 14:31</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
Formatter (stable)
<p>✅ ecosystem check detected no format changes.</p>
Formatter (preview)
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-22 04:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/formatter.md</code>:333 on 2024-01-22 04:34</div>
            <div class="timeline-body"><p>This seems ok to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-22 04:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/linter.md</code>:28 on 2024-01-22 04:35</div>
            <div class="timeline-body"><p>All the changes in here look reasonable to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-22 04:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/flake8_bugbear/rules/function_call_in_argument_default.rs</code>:64 on 2024-01-22 04:41</div>
            <div class="timeline-body"><p>Did you verify manually that these still work, when rendered in the rule documentation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/never_union.rs</code>:33 on 2024-01-22 04:46</div>
            <div class="timeline-body"><p>:)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-22 04:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-22 04:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_dev/src/generate_options.rs</code>:175 on 2024-01-22 04:47</div>
            <div class="timeline-body"><p>This all got so much simpler, where did the simplification come from?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-01-22 04:48</div>
            <div class="timeline-body"><p>The changes you made (to the docs, etc.) generally look good to me. It&#x27;s a shame that existing anchor links won&#x27;t work any more, but it seems really hard to avoid. Thanks for cleaning this up.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-01-22 07:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_bugbear/rules/function_call_in_argument_default.rs</code>:64 on 2024-01-22 07:29</div>
            <div class="timeline-body"><p>I verified some of them ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-01-22 07:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_dev/src/generate_options.rs</code>:175 on 2024-01-22 07:31</div>
            <div class="timeline-body"><p>By writing simpler code :laughing:</p>
<p>I realised that the only difference between the two is whether we add the <code>tool.ruff</code> prefix or not. The fact that <code>parents</code> is now an iter made it more obvious to me that we could use <code>iter.join</code> over manually constructing the string.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-22 07:33</div>
            <div class="timeline-body"><blockquote>
<p>The changes you made (to the docs, etc.) generally look good to me. It&#x27;s a shame that existing anchor links won&#x27;t work any more, but it seems really hard to avoid. Thanks for cleaning this up.</p>
</blockquote>
<p>We could add backwards-compatible anchors. We could add backwards compatible ids if we want to keep anchor links from external websites working (I hope I managed to update all internal references).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-29 17:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-29 17:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-29 17:42</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:00:38 UTC
    </footer>
</body>
</html>
