<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better error recovery for match patterns - astral-sh/ruff #10477</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Better error recovery for match patterns</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10477">#10477</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-03-19 17:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-03-19 17:51</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR updates the match statement's pattern parsing logic to better facilitate the error recovery. The following changes are made:</p>
<h3>Disallow star pattern (<code>*&lt;name&gt;</code>) outside of sequence pattern</h3>
<p>This is done by passing an enum stating whether to allow star pattern or not and is based on where the parser is in the stack.</p>
<details><summary>Call stack for pattern parsing functions:</summary>
<p>

<p>I took notes on where would I requires changing this, so sharing it for documenting purposes:</p>
<ul>
<li><code>parse_match_patterns</code><ul>
<li><code>parse_match_pattern</code> (<code>AllowStarPattern::Yes</code>)<ul>
<li>Error if it’s a star pattern and it's not a sequence pattern</li>
</ul>
</li>
<li><code>parse_sequence_match_pattern</code><ul>
<li><code>parse_match_pattern</code> (<code>AllowStarPattern::Yes</code>)</li>
</ul>
</li>
</ul>
</li>
<li><code>parse_match_pattern</code> (<code>allow_star_pattern: AllowStarPattern</code>)<ul>
<li><code>parse_match_pattern_lhs</code> (<code>allow_star_pattern: AllowStarPattern</code>)<ul>
<li><code>parse_match_pattern_mapping</code><ul>
<li><code>parse_match_pattern_lhs</code> (<code>AllowStarPattern::No</code>)</li>
<li><code>parse_match_pattern</code> (<code>AllowStarPattern::No</code>)</li>
</ul>
</li>
<li><code>parse_match_pattern_star</code></li>
<li><code>parse_delimited_match_pattern</code><ul>
<li><code>parse_match_pattern</code> (<code>AllowStarPattern::Yes</code>)</li>
<li><code>parse_sequence_match_pattern</code></li>
</ul>
</li>
<li><code>parse_match_pattern_literal</code><ul>
<li><code>parse_attr_expr_for_match_pattern</code></li>
</ul>
</li>
<li><code>parse_match_pattern_class</code><ul>
<li><code>parse_match_pattern</code> (<code>AllowStarPattern::No</code>)</li>
</ul>
</li>
<li><code>parse_complex_literal_pattern</code><ul>
<li><code>parse_match_pattern_lhs</code> (<code>AllowStarPattern::No</code>)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</p>
</details> 

<p>The mapping pattern <code>FIRST</code> set has been updated to include <code>*</code> to allow the parser to recover from this error in mapping pattern. Otherwise, the list parsing would completely skip parsing it.</p>
<h3>Convert <code>Pattern</code> to <code>Expr</code></h3>
<p>In certain cases, the parser expects a specific type of pattern and uses that to extract information. For example, in complex literal, we parse the LHS and RHS as patterns but the LHS can only be a real number while the RHS can only be a complex number. This means that if the parser found any other pattern kind then we would convert the pattern into an equivalent expression and add an appropriate error. This will help any downstream tools.</p>
<p>Refer to <code>recovery::pattern_to_expr</code> for more details.</p>
<h3>Extract complex number literal pattern parsing logic</h3>
<p>Earlier, this was inside the <code>parse_match_pattern_lhs</code> which made the method a bit more complex than it needed to be. The logic has been extracted to a new <code>parse_complex_pattern_literal</code> and is called when the parser encounters a pattern followed by either <code>+</code> or <code>-</code>.</p>
<p>The parser only allows a valid complex literal pattern which is <code>real_number +/- complex_number</code>. For any other case, an appropriate error will be raised.</p>
<h2>Review</h2>
<p>Refer to the test cases to help in the review process.</p>
<h2>Test Plan</h2>
<p>Add test cases and update the snapshots.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">parser</span> added by @dhruvmanila on 2024-03-19 17:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-03-19 18:11</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 04:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/resources/valid/statement/match.py</code>:278 on 2024-03-21 04:09</div>
            <div class="timeline-body"><p>Star pattern is only allowed inside a sequence pattern as per the grammar.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 04:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:539 on 2024-03-21 04:37</div>
            <div class="timeline-body"><p>TODO: disallow (<code>-1j + 2j</code>) as well</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 04:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:670 on 2024-03-21 04:38</div>
            <div class="timeline-body"><p>This is mainly moved from down below because class comes first and then the arguments. It's only to maintain the flow of parsing.</p>
<p>The change here is to use <code>recovery::pattern_to_expr</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 04:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:679 on 2024-03-21 04:39</div>
            <div class="timeline-body"><p>To disallow:</p>
<pre><code class="language-python">match subject:
	case Foo(a as b = 1):
		pass
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @dhruvmanila on 2024-03-21 04:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @dhruvmanila on 2024-03-21 04:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/resources/invalid/statements/match/invalid_class_pattern.py</code>:17 on 2024-03-21 08:38</div>
            <div class="timeline-body"><p>Is this intentionally commented out?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-03-21 08:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_class_pattern.py.snap</code>:331 on 2024-03-21 08:43</div>
            <div class="timeline-body"><p>What I understand is that the &quot;invalid&quot; part here is that <code>x as y</code> is not a valid pattern key. Should we only highlight the key and reword the error message to that only names are accepted as keys?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_lhs_or_rhs_pattern.py.snap</code>:812 on 2024-03-21 08:44</div>
            <div class="timeline-body"><p>Nit: It might not be worth, but should we peek ahead and only consume the <code>:</code> if the peeked token isn't an <code>Indent</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_lhs_or_rhs_pattern.py.snap</code>:1086 on 2024-03-21 08:52</div>
            <div class="timeline-body"><p>We should avoid jargon like <code>rhs</code>. Does this match the literal_expr grammar? Does it only allow numbers after a <code>+</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_lhs_or_rhs_pattern.py.snap</code>:843 on 2024-03-21 08:54</div>
            <div class="timeline-body"><p>The wording assignment target is a bit confusing here. Any chance we chould rephrase it to invalid pattern and possibly hint the users to what's not allowed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_mapping_pattern.py.snap</code>:396 on 2024-03-21 08:55</div>
            <div class="timeline-body"><p>Not for now, but we should change our <code>Display</code> implementation of <code>TokenKind</code> to emit <code>'{'</code> instead of Rbrace haha</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_mapping_pattern.py.snap</code>:454 on 2024-03-21 08:55</div>
            <div class="timeline-body"><p>that's really nice!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_mapping_pattern.py.snap</code>:464 on 2024-03-21 08:55</div>
            <div class="timeline-body"><p>You're rocking it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 08:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/resources/invalid/statements/match/invalid_class_pattern.py</code>:17 on 2024-03-21 08:56</div>
            <div class="timeline-body"><p>Yes. So, positional pattern cannot follow keyword pattern in a class pattern (<code>case Foo(x=1, y): ...</code> is invalid) but this means the pre-order assert in the invalid code fails.</p>
<p>I'll probably need to have a mathod on <code>PatternArguments</code> similar to how's one for <code>Arguments</code> (<code>arguments_source_order</code>) to return an argument in the order defined in source.</p>
<p>I need to think about this because it's only required while testing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:71 on 2024-03-21 08:58</div>
            <div class="timeline-body"><pre><code class="language-suggestion">            // We know it's not a sequence pattern now, so check for star pattern usage.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:188 on 2024-03-21 09:11</div>
            <div class="timeline-body"><p>Hm, this is a problem because we now drop &quot;nodes&quot;, meaning the <code>MatchPatternMapping</code> range covers nodes that aren't represented in the AST.</p>
<p>Any chance we could convert the star to a starred expression instead and push a pattern at the right position? If not, then we may need to bail out early here, even if it means that the error recovery isn't as good as it could be (or we have to change the AST representation)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:384 on 2024-03-21 09:12</div>
            <div class="timeline-body"><p>I like the &quot;passing an enum&quot; pattern</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:539 on 2024-03-21 09:13</div>
            <div class="timeline-body"><p>Do you plan to do this as part of this PR or as a follow up PR?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/recovery.rs</code>:140 on 2024-03-21 09:50</div>
            <div class="timeline-body"><p>Does that mean we drop the <code>as &lt;name&gt;</code> part in this case? I'm not quiet sure what we should do in this case to still get as nice error recovery. What are the cases where we need this branch? What I understand is that it is for:</p>
<pre><code class="language-python">match invalid_rhs_pattern:
    case {&quot;x&quot; as y:1 + Foo()}:
        pass
</code></pre>
<p>I think it might be best to disallow <code>As</code> when parsing the <code>key</code> and make recovery panic (or return a Result) if you try to convert a <code>MatchAs</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-03-21 09:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 09:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:539 on 2024-03-21 09:52</div>
            <div class="timeline-body"><p>I just pushed a fix for it (https://github.com/astral-sh/ruff/pull/10477/commits/acbaff2b48a4956b5325cb79207434d3f3bf0377). Sorry, I should've done it in a follow-up PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_lhs_or_rhs_pattern.py.snap</code>:812 on 2024-03-21 09:54</div>
            <div class="timeline-body"><p>This was a bug in the way the pattern parsing logic was coded. It shouldn't have been exclusive and has been fixed in https://github.com/astral-sh/ruff/pull/10477/commits/80b091a91a89d85e7b95124ea5ddab415fcc9aa8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 09:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 09:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_lhs_or_rhs_pattern.py.snap</code>:843 on 2024-03-21 09:55</div>
            <div class="timeline-body"><p>Sorry! This is same bug as mentioned earlier:</p>
<blockquote>
<p>This was a bug in the way the pattern parsing logic was coded. It shouldn't have been exclusive and has been fixed in https://github.com/astral-sh/ruff/pull/10477/commits/80b091a91a89d85e7b95124ea5ddab415fcc9aa8</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 09:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_mapping_pattern.py.snap</code>:396 on 2024-03-21 09:56</div>
            <div class="timeline-body"><p>Yes, I've that in the parser TODO, thanks for the suggestion :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-21 10:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_lhs_or_rhs_pattern.py.snap</code>:1086 on 2024-03-21 10:02</div>
            <div class="timeline-body"><p>I understand.</p>
<blockquote>
<p>Does this match the literal_expr grammar?</p>
</blockquote>
<p>No, I borrowed it from the existing code.</p>
<blockquote>
<p>Does it only allow numbers after a <code>+</code>?</p>
</blockquote>
<p>Only complex literal is allowed after a <code>+</code> or <code>-</code> because it can only occur in a complex literal pattern. I'll update the error message to better reflect that.</p>
<p>I'll update the LHS / RHS terminology in a follow-up PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/snowsignal">@snowsignal</a> on <code>crates/ruff_python_parser/src/error.rs</code>:195 on 2024-03-22 03:17</div>
            <div class="timeline-body"><p>Nit: this should probably be in lowercase to match the other parsing error messages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/snowsignal">@snowsignal</a> on <code>crates/ruff_python_parser/resources/invalid/statements/match/invalid_mapping_pattern.py</code>:20 on 2024-03-22 05:12</div>
            <div class="timeline-body"><p>Nit: should this have a newline at the end?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowsignal">@snowsignal</a> reviewed on 2024-03-22 05:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-22 05:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/tests/snapshots/invalid_syntax@statements__match__invalid_class_pattern.py.snap</code>:331 on 2024-03-22 05:52</div>
            <div class="timeline-body"><p>Yes, your understanding is correct. I've reworded the error message to &quot;Expected an identifier for the keyword pattern&quot;, another option is &quot;Expected an identifier for the key part of a keyword pattern&quot; but I guess that's too verbose. The highlighted range will cover the fact that the identifier was expected at that position.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-22 07:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:188 on 2024-03-22 07:17</div>
            <div class="timeline-body"><blockquote>
<p>Any chance we could convert the star to a starred expression instead and push a pattern at the right position?</p>
</blockquote>
<p>Not really because there's no way to represent a double starred expression in the AST, there's only a <code>ExprStarred</code> which is for <code>*foo</code>.</p>
<blockquote>
<p>If not, then we may need to bail out early here, even if it means that the error recovery isn't as good as it could be (or we have to change the AST representation)</p>
</blockquote>
<p>I could see what bailing would look like but I'd prefer to change the AST representation even it means a bit more work to be done.</p>
<p>Thinking quickly about the AST representation, there are two solutions which comes to my mind:</p>
<ol>
<li>Add a new <code>Pattern</code> variant for <code>**data</code> and store it in <code>MatchPatternMapping::patterns</code> field. This is probably not a good idea</li>
<li>Replace the <code>keys</code>, <code>patterns</code> and <code>rest</code> fields with a single <code>entries</code> field which is an enum with two kind (<code>MappingPattern::DoubleStar</code> and <code>MappingPattern::KeyValue</code>)</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-22 07:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:188 on 2024-03-22 07:19</div>
            <div class="timeline-body"><p>Also, this is happening in a list parsing so might involve using the parser context flags.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-03-22 07:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:188 on 2024-03-22 07:32</div>
            <div class="timeline-body"><p>I'm also leaning on changing the AST (e.g. similar to Pyright's AST). What's important to me is that we don't spend too much time now working on error recovery. I'm also okay marking this as a todo (creating an issue) and following up on this later because the focus now is on replacing the parser, not on perfect error recovery.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:188 on 2024-03-22 07:34</div>
            <div class="timeline-body"><p>Yeah, I'd prefer to not to do it now as well. I'll open an issue for it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-22 07:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-25 12:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/resources/invalid/statements/match/invalid_mapping_pattern.py</code>:20 on 2024-03-25 12:58</div>
            <div class="timeline-body"><p>I don't think it matters but I'll add it anyways. Not sure why my editor removed it lol. Thanks for noticing!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-25 12:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/error.rs</code>:195 on 2024-03-25 12:59</div>
            <div class="timeline-body"><p>The cases are mixed now but I'm consistently trying to use uppercase. I'll look at the error messages later on.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-25 12:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/recovery.rs</code>:140 on 2024-03-25 12:59</div>
            <div class="timeline-body"><p>Fixed in https://github.com/astral-sh/ruff/pull/10523</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-03-25 13:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/pattern.rs</code>:188 on 2024-03-25 13:11</div>
            <div class="timeline-body"><p>#10570</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @dhruvmanila on 2024-03-25 13:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-03-25 14:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dhruvmanila on 2024-03-25 14:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-03-25 14:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-03-25 14:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:48:01 UTC
    </footer>
</body>
</html>
