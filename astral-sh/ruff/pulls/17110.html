<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visit `Identifier` node as part of the `SourceOrderVisitor` - astral-sh/ruff #17110</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Visit <code>Identifier</code> node as part of the <code>SourceOrderVisitor</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17110">#17110</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-04-01 08:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>I don't remember exactly when we made <code>Identifier</code> a node but it is now considered a node (it implements <code>AnyNodeRef</code>, it has a range). However, we never updated
the <code>SourceOrderVisitor</code> to visit identifiers because we never had a use case for it and visiting new nodes can change how the formatter associates comments (breaking change!).
This PR updates the <code>SourceOrderVisitor</code> to visit identifiers and changes the formatter comment visitor to skip identifiers (updating the visitor might be desired because it could help simplifying some comment placement logic but this is out of scope for this PR).</p>
<h2>Test Plan</h2>
<p>Tests, updated snapshot tests</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @MichaReiser on 2025-04-01 08:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-04-01 09:07</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-04-01 14:55</div>
            <div class="timeline-body"><p>Nice! I might have to try using this for the <code>match</code> pattern visitor from #16957.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-01 14:57</div>
            <div class="timeline-body"><p>Yeah, I was too lazy to also change Visitor but I think we could (we just need to be careful and review the call sites to skip visiting if it can change behavior). But you can also just use the <code>SourceOrderVisitor</code> if you don't require semantic order</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-04-01 14:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-04-01 14:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-04-01 14:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:11:08 UTC
    </footer>
</body>
</html>
