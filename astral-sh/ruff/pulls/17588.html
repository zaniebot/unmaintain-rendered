<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] Trust all symbols in stub files - astral-sh/ruff #17588</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] Trust all symbols in stub files</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17588">#17588</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-04-23 17:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-04-23 17:32</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Follow-up on the discussion <a href="https://github.com/astral-sh/ruff/pull/17577#discussion_r2055945909">here</a>. <em>Generally</em> trust undeclared symbols in stubs, not just at the module level.</p>
<h2>Test Plan</h2>
<p>New Markdown test.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @sharkdp on 2025-04-23 17:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[red-knot] Trust *all* symbols in stub files" to "[red-knot] Trust all symbols in stub files" by @sharkdp on 2025-04-23 17:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-04-23 17:37</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<p>No ecosystem changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-04-23 17:45</div>
            <div class="timeline-body"><p>Oh, I suppose a lot of class-level assignments in typeshed are in the context of enum classes (e.g. https://github.com/python/typeshed/blob/ae57d69c9354147bcf7086d6db47af8f8c82bf7b/stdlib/re.pyi#L201-L221 ), and we infer all attributes on enums as <code>Todo</code> anyway...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-04-23 17:49</div>
            <div class="timeline-body"><p>I found one example that we do infer differently on this branch! I'm sure it's <em>widely</em> used:</p>
<pre><code class="language-py">from pdb import Pdb

reveal_type(Pdb.do_b)  # Previously: Unknown | def do_break(self, arg: str, temporary: bool = EllipsisType) -&gt; bool | None
                       # Now:        def do_break(…) -&gt; …
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-04-23 17:51</div>
            <div class="timeline-body"><p>This does still feel more consistent to me, so I do support it still!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @sharkdp on 2025-04-23 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @sharkdp on 2025-04-23 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @sharkdp on 2025-04-23 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @sharkdp on 2025-04-23 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> approved on 2025-04-23 18:02</div>
            <div class="timeline-body"><p>I think this makes sense as well. Sorry I didn't get through my notifications fast enough to comment on the previous PR sooner!</p>
<p>The core &quot;gradual guarantee&quot; idea that we should not emit false positives on working untyped code, when the user hasn't declared their intentions through type annotations, just doesn't apply to stub files in the same way, since they are inherently somebody explicitly providing type information.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-04-23 18:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @sharkdp on 2025-04-23 18:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sharkdp on 2025-04-23 18:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-04-23 18:07</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 19:33:29 UTC
    </footer>
</body>
</html>
