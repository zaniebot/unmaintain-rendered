<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fix: assertTrue()/assertFalse() fixer should not test for identity - astral-sh/ruff #2476</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fix: assertTrue()/assertFalse() fixer should not test for identity</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/2476">#2476</a>
        opened by <a href="https://github.com/spaceone">@spaceone</a>
        on 2023-02-02 13:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/spaceone">@spaceone</a></div>
            <div class="timeline-body"><p>Issue #2456</p>
<p><code>cargo clippy</code> wants this but then <code>_expr</code> is unused:</p>
<pre><code>diff --git src/rules/flake8_pytest_style/rules/unittest_assert.rs src/rules/flake8_pytest_style/rules/unittest_assert.rs
index 29f7ab44..35beaeca 100644
--- src/rules/flake8_pytest_style/rules/unittest_assert.rs
+++ src/rules/flake8_pytest_style/rules/unittest_assert.rs
@@ -266,12 +266,12 @@ impl UnittestAssert {
                     .ok_or_else(|| anyhow!(&quot;Missing argument `expr`&quot;))?;
                 let msg = args.get(&quot;msg&quot;).copied();
                 if matches!(self, UnittestAssert::True) {
-                    let expr = create_expr(ExprKind::UnaryOp {
+                    let _expr = create_expr(ExprKind::UnaryOp {
                         op: Unaryop::Not,
                         operand: Box::new(create_expr(expr.node.clone())),
                     });
                 }
-                Ok(assert(&amp;expr, msg))
+                Ok(assert(expr, msg))
             }
             UnittestAssert::Equal
             | UnittestAssert::Equals
</code></pre>
<p>strange...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-02 13:48</div>
            <div class="timeline-body"><p>If you create a binding like that, it doesn&#x27;t live beyond the curly braces.</p>
<pre><code>let x = 1;
if true {
  let x = 2;
}
println!(&quot;{}&quot;, x);
</code></pre>
<p>This should print <code>1</code>, if I&#x27;m not mistaken, since the binding is scoped to the <code>{}</code>. So in the example above, the inner <code>let expr</code> is unused!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceone">@spaceone</a> on 2023-02-02 14:07</div>
            <div class="timeline-body"><p>oh, good to know! fixed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on <code>src/rules/flake8_pytest_style/rules/unittest_assert.rs</code>:275 on 2023-02-02 15:50</div>
            <div class="timeline-body"><p>I think you want to swap these</p>
<pre><code>                    Ok(assert(expr, msg))
                } else {
                    let unary_expr = create_expr(ExprKind::UnaryOp {
                        op: Unaryop::Not,
                        operand: Box::new(create_expr(expr.node.clone())),
                    });
                    Ok(assert(&amp;unary_expr, msg))
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> reviewed on 2023-02-02 15:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/spaceone">@spaceone</a> reviewed on 2023-02-02 16:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/spaceone">@spaceone</a> on <code>src/rules/flake8_pytest_style/rules/unittest_assert.rs</code>:275 on 2023-02-02 16:10</div>
            <div class="timeline-body"><p>correct, thanks! I adjusted this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-02 16:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-02 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-02 16:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:52:04 UTC
    </footer>
</body>
</html>
