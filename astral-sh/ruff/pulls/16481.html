<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[syntax-errors] Positional-only parameters before Python 3.8 - astral-sh/ruff #16481</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[syntax-errors] Positional-only parameters before Python 3.8</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16481">#16481</a>
        opened by <a href="https://github.com/ntBre">@ntBre</a>
        on 2025-03-03 19:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Detect positional-only parameters before Python 3.8, as marked by the <code>/</code> separator in a parameter list.</p>
<h2>Test Plan</h2>
<p>Inline tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">parser</span> added by @ntBre on 2025-03-03 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @ntBre on 2025-03-03 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @ntBre on 2025-03-03 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dhruvmanila by @ntBre on 2025-03-03 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-03-03 19:49</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/error.rs</code>:452 on 2025-03-04 08:28</div>
            <div class="timeline-body"><p>We try to avoid using abbreviations.</p>
<pre><code class="language-suggestion">    PositionalOnlyParameter,
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:3060 on 2025-03-04 08:29</div>
            <div class="timeline-body"><p>Can you add a test that shows that the parser doesn't emit the diagnostic twice for <code>def foo(a, //): ...</code> or for <code>def foo(a, *args, /, b)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:3017 on 2025-03-04 08:30</div>
            <div class="timeline-body"><p>Is this a TODO?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-03-04 08:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/error.rs</code>:461 on 2025-03-04 11:02</div>
            <div class="timeline-body"><p>What about &quot;positional-only parameter separator&quot; as we're highlighting the <code>/</code> token in the source code? The word &quot;separator&quot; has been used in the <a href="https://peps.python.org/pep-0570/#origin-of-as-a-separator">PEP</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:3060 on 2025-03-04 11:06</div>
            <div class="timeline-body"><p>Maybe <code>def foo(a, /, b, /): ...</code> as well or did you mean something like this with your first example?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2025-03-04 11:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-03-04 19:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:3017 on 2025-03-04 19:39</div>
            <div class="timeline-body"><p>No this is along the lines of my outdated slice comment from the other PR. I'm saying we need to check inside of this <code>if !seen_positional_only_separator { ... }</code> block to avoid duplicates. I'll just delete the comment as that should be pretty obvious. I think it was originally less obvious to me and I had to move the check into the block.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-03-04 19:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:3060 on 2025-03-04 19:55</div>
            <div class="timeline-body"><p>I added all three of these cases.</p>
<ul>
<li><code>def foo(a, //): ...</code> is just a plain <code>ParseError</code></li>
<li><code>def foo(a, *args, /, b): ...</code> gets a <code>ParseError</code> and an <code>UnsupportedSyntaxError</code>, both on the <code>/</code></li>
<li><code>def foo(a, /, b, /): ...</code> gets a <code>ParseError</code> on the second <code>/</code> but an <code>UnsupportedSyntaxError</code> on the first <code>/</code></li>
</ul>
<p>Is that what we expect? The second case feels more like a duplicate to me, but at least the third case points to two different locations. Should we only emit <code>ParseError</code>s here instead?</p>
<p><a href="https://pyright-play.net/?pythonVersion=3.7&amp;strict=true&amp;code=CYUwZgBGAUCGBcECWA7ALgGggeiwI0QGc0AnLbASkQDpag">pyright</a> actually reports three errors for the third case (more than our two) and two errors for the <a href="https://pyright-play.net/?pythonVersion=3.7&amp;strict=true&amp;code=CYUwZgBGD20BQEMBcECWA7ALgGggKgQCcBzAZxQxwgHpcAjCrAShQDp2g">second case</a>, so maybe the current behavior is okay.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-03-05 03:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:3060 on 2025-03-05 03:02</div>
            <div class="timeline-body"><p>I think multiple errors are fine as they both are independent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-03-05 07:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-03-05 13:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-03-05 13:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-03-05 13:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:10:28 UTC
    </footer>
</body>
</html>
