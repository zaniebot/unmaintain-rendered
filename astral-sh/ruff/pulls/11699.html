<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`flake8-pyi`] Implement `PYI063` - astral-sh/ruff #11699</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>flake8-pyi</code>] Implement <code>PYI063</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11699">#11699</a>
        opened by <a href="https://github.com/tusharsadhwani">@tusharsadhwani</a>
        on 2024-06-02 23:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tusharsadhwani">@tusharsadhwani</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Implements <code>Y063</code> from <code>flake8-pyi</code>.</p>
<h2>Test Plan</h2>
<p><code>cargo test</code> / <code>cargo insta review</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @tusharsadhwani on 2024-06-02 23:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> reviewed on 2024-06-02 23:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/old_style_positional_only_arg.rs</code>:55 on 2024-06-02 23:22</div>
            <div class="timeline-body"><p>This call currently doesn't correctly identify methods, which is why the issue is not correctly raised on line 26 of <code>PYI063.pyi</code>. I suspect it is because <code>scope</code> is not correct.</p>
<p>I didn't look super hard into it, but I don't see a very straightforward way to get the correct scope from a <code>FunctionStmt</code> node.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-06-02 23:33</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+23 -0 violations, +0 -0 fixes in 4 projects; 46 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/8b99ad0fbe136371de4c303f7ffee9b5469e77e0/airflow/utils/hashlib_wrapper.py#L28'>airflow/utils/hashlib_wrapper.py:28:9:</a> PYI063 Use PEP 570 syntax for positional-only arguments
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pandas-dev/pandas/blob/76c7274985215c487248fa5640e12a9b32a06e8c/pandas/_typing.py#L282'>pandas/_typing.py:282:20:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/pandas-dev/pandas/blob/76c7274985215c487248fa5640e12a9b32a06e8c/pandas/_typing.py#L297'>pandas/_typing.py:297:20:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/pandas-dev/pandas/blob/76c7274985215c487248fa5640e12a9b32a06e8c/pandas/_typing.py#L303'>pandas/_typing.py:303:21:</a> PYI063 Use PEP 570 syntax for positional-only arguments
</pre>

</p>
</details>
<details><summary><a href="https://github.com/python-trio/trio">python-trio/trio</a> (+18 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1072'>src/trio/_socket.py:1072:26:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1102'>src/trio/_socket.py:1102:21:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1133'>src/trio/_socket.py:1133:25:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1151'>src/trio/_socket.py:1151:17:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1166'>src/trio/_socket.py:1166:26:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1178'>src/trio/_socket.py:1178:15:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1183'>src/trio/_socket.py:1183:15:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L1212'>src/trio/_socket.py:1212:13:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L652'>src/trio/_socket.py:652:22:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L662'>src/trio/_socket.py:662:17:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L678'>src/trio/_socket.py:678:13:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L690'>src/trio/_socket.py:690:13:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L696'>src/trio/_socket.py:696:22:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L701'>src/trio/_socket.py:701:15:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L707'>src/trio/_socket.py:707:9:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/_socket.py#L722'>src/trio/_socket.py:722:13:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/testing/_fake_net.py#L469'>src/trio/testing/_fake_net.py:469:15:</a> PYI063 Use PEP 570 syntax for positional-only arguments
+ <a href='https://github.com/python-trio/trio/blob/2741527ef22e98f4d551c2c7c8ebb15628c4e546/src/trio/testing/_fake_net.py#L475'>src/trio/testing/_fake_net.py:475:9:</a> PYI063 Use PEP 570 syntax for positional-only arguments
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pytest-dev/pytest">pytest-dev/pytest</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pytest-dev/pytest/blob/7be95f9b30ffd418483bdb57112f9339465d4695/testing/example_scripts/dataclasses/test_compare_dataclasses_with_custom_eq.py#L11'>testing/example_scripts/dataclasses/test_compare_dataclasses_with_custom_eq.py:11:26:</a> PYI063 Use PEP 570 syntax for positional-only arguments
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PYI063 | 23 | 23 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-06-03 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2024-06-03 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @charliermarsh on 2024-06-03 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/checkers/ast/analyze/definitions.rs</code>:155 on 2024-06-03 10:36</div>
            <div class="timeline-body"><p>We should make sure only to run this rule if the target version is set to Python 3.8 or greater (Ruff still supports Python 3.7), or we'll be recommending invalid syntax for Python 3.7 users</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/snapshots/ruff_linter__rules__flake8_pyi__tests__PYI063_PYI063.py.snap</code>:1 on 2024-06-03 10:36</div>
            <div class="timeline-body"><p>Any reason not to do this for <code>.py</code> files as well? I think type checkers understand the pre-PEP-570 convention for runtime source code as well as stubs</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-06-03 10:37</div>
            <div class="timeline-body"><p>Nice! The code here looks really clean. Charlie's assigned this to himself so I'll leave a full review to him, but two quick points:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/VascoSch92">@VascoSch92</a> reviewed on 2024-06-03 10:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/VascoSch92">@VascoSch92</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_pyi/PYI063.py</code>:14 on 2024-06-03 10:48</div>
            <div class="timeline-body"><p>Can I suggest the test case</p>
<pre><code class="language-python">def still_fine(_x: int) -&gt; None: ...
</code></pre>
<p>This should be fine right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> reviewed on 2024-06-03 10:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/snapshots/ruff_linter__rules__flake8_pyi__tests__PYI063_PYI063.py.snap</code>:1 on 2024-06-03 10:56</div>
            <div class="timeline-body"><p>For regular python files, code like:</p>
<pre><code class="language-python">def add(__a, __b):
    return __a + __b
</code></pre>
<p>It's not necessary that the user intended to make them positional only. Whereas in stub files it is intended. Raising it on python files can cause false positives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-06-03 10:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/snapshots/ruff_linter__rules__flake8_pyi__tests__PYI063_PYI063.py.snap</code>:1 on 2024-06-03 10:59</div>
            <div class="timeline-body"><p>Although you certainly <em>can</em> do calls such as <code>add(__a=1, __b=2)</code>, in my opinion, I think the vast majority of Python functions with parameters like that have probably been written to take advantage of the type-checker convention to understand those parameters as being positional-only. But let's see what Charlie thinks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> reviewed on 2024-06-03 11:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/tusharsadhwani">@tusharsadhwani</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_pyi/PYI063.py</code>:14 on 2024-06-03 11:07</div>
            <div class="timeline-body"><p>seems good, I'll add it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-06-04 02:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/old_style_positional_only_arg.rs</code>:74 on 2024-06-04 02:36</div>
            <div class="timeline-body"><p>Why is the check limited to the first two arguments?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-06-04 02:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/old_style_positional_only_arg.rs</code>:74 on 2024-06-04 02:50</div>
            <div class="timeline-body"><p>Ah I see, ok.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-06-04 02:50</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-06-04 02:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/snapshots/ruff_linter__rules__flake8_pyi__tests__PYI063_PYI063.py.snap</code>:1 on 2024-06-04 02:50</div>
            <div class="timeline-body"><p>I ended up enabling this based on Alex's suggestion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-06-04 02:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/old_style_positional_only_arg.rs</code>:55 on 2024-06-04 02:51</div>
            <div class="timeline-body"><p>I fixed this by moving it out of the definition phase and into the standard statement checker.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-06-04 03:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-06-04 03:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-06-05 23:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:04:35 UTC
    </footer>
</body>
</html>
