<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Format `if` statements - astral-sh/ruff #4961</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Format <code>if</code> statements</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/4961">#4961</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2023-06-08 13:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">

Summary
<p>This PR implements the formatting of <code>if</code> statements. I haven&#x27;t verified if it covers all edge cases because
that will be easier once we have better coverage (you can simply go througth the black differences), but I believe it covers most reasonable uses pretty well.</p>


Test Plan
<p>A few own unit tests and reviewed (as best as I can) the black differences</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-06-08 13:45</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #4954</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4954"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a><ul>
<li><strong>PR #4921</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4921"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a><ul>
<li><strong>PR #4922</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4922"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a><ul>
<li><strong>PR #4951</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4951"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a><ul>
<li><strong>PR #4961</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4961"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a>  ðŸ‘ˆ
* <strong>PR #4964</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4964"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a>
* <strong>PR #4979</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4979"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a>
* <strong>PR #4978</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4978"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite"></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/4961?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-06-08 14:15</div>
            <div class="timeline-body">PR Check Results
Ecosystem
<p>âœ… ecosystem check detected no changes.</p>
Benchmark
Linux
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      6.8Â±0.01ms     6.0 MB/sec    1.01      6.9Â±0.01ms     5.9 MB/sec
formatter/numpy/ctypeslib.py               1.00   1382.1Â±3.95Âµs    12.0 MB/sec    1.01   1390.5Â±3.18Âµs    12.0 MB/sec
formatter/numpy/globals.py                 1.00    138.3Â±0.21Âµs    21.3 MB/sec    1.01    139.1Â±0.87Âµs    21.2 MB/sec
formatter/pydantic/types.py                1.00      2.8Â±0.01ms     9.2 MB/sec    1.01      2.8Â±0.01ms     9.1 MB/sec
linter/all-rules/large/dataset.py          1.02     15.1Â±0.06ms     2.7 MB/sec    1.00     14.8Â±0.02ms     2.7 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.01      3.6Â±0.00ms     4.6 MB/sec    1.00      3.6Â±0.00ms     4.6 MB/sec
linter/all-rules/numpy/globals.py          1.01    369.8Â±1.42Âµs     8.0 MB/sec    1.00    367.0Â±1.74Âµs     8.0 MB/sec
linter/all-rules/pydantic/types.py         1.01      6.3Â±0.01ms     4.1 MB/sec    1.00      6.2Â±0.01ms     4.1 MB/sec
linter/default-rules/large/dataset.py      1.03      7.5Â±0.01ms     5.4 MB/sec    1.00      7.3Â±0.02ms     5.6 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.02   1568.8Â±5.41Âµs    10.6 MB/sec    1.00   1531.1Â±3.97Âµs    10.9 MB/sec
linter/default-rules/numpy/globals.py      1.02    167.7Â±0.98Âµs    17.6 MB/sec    1.00    164.0Â±0.30Âµs    18.0 MB/sec
linter/default-rules/pydantic/types.py     1.03      3.4Â±0.01ms     7.6 MB/sec    1.00      3.3Â±0.00ms     7.8 MB/sec
</code></pre>
Windows
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      7.8Â±0.02ms     5.2 MB/sec    1.05      8.2Â±0.04ms     5.0 MB/sec
formatter/numpy/ctypeslib.py               1.00  1573.3Â±15.51Âµs    10.6 MB/sec    1.04  1639.9Â±21.41Âµs    10.2 MB/sec
formatter/numpy/globals.py                 1.00    156.3Â±1.60Âµs    18.9 MB/sec    1.03    161.1Â±2.81Âµs    18.3 MB/sec
formatter/pydantic/types.py                1.00      3.2Â±0.02ms     7.9 MB/sec    1.04      3.3Â±0.03ms     7.6 MB/sec
linter/all-rules/large/dataset.py          1.00     16.8Â±0.15ms     2.4 MB/sec    1.01     17.0Â±0.12ms     2.4 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.01      4.3Â±0.03ms     3.9 MB/sec    1.00      4.3Â±0.02ms     3.9 MB/sec
linter/all-rules/numpy/globals.py          1.01    434.8Â±5.22Âµs     6.8 MB/sec    1.00    430.2Â±5.98Âµs     6.9 MB/sec
linter/all-rules/pydantic/types.py         1.00      7.2Â±0.04ms     3.6 MB/sec    1.00      7.2Â±0.05ms     3.6 MB/sec
linter/default-rules/large/dataset.py      1.00      8.4Â±0.04ms     4.8 MB/sec    1.00      8.4Â±0.03ms     4.8 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00   1750.3Â±8.60Âµs     9.5 MB/sec    1.00  1756.1Â±11.41Âµs     9.5 MB/sec
linter/default-rules/numpy/globals.py      1.00    187.9Â±1.56Âµs    15.7 MB/sec    1.00    188.3Â±1.48Âµs    15.7 MB/sec
linter/default-rules/pydantic/types.py     1.01      3.8Â±0.03ms     6.6 MB/sec    1.00      3.8Â±0.03ms     6.7 MB/sec
</code></pre>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-06-08 16:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-06-08 16:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autoformatter</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-06-08 16:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/src/lib.rs</code>:444 on 2023-06-09 07:08</div>
            <div class="timeline-body"><pre><code></code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/src/statement/stmt_if.rs</code>:61 on 2023-06-09 07:29</div>
            <div class="timeline-body"><p>it&#x27;s confusing that those are set in every iteration, maybe a comment would be good</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/src/statement/stmt_if.rs</code>:64 on 2023-06-09 07:34</div>
            <div class="timeline-body"><p>Does this mean there&#x27;s no elif node, just if?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2023-06-09 07:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-06-09 08:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/src/statement/stmt_if.rs</code>:64 on 2023-06-09 08:39</div>
            <div class="timeline-body"><p>Yep. <code>elif</code> is represented as an <code>else</code> body that contains a single <code>if</code> statement. Rome (and Roslyn) model this very similarly where the <code>alternate</code> (else) is either an <code>if</code> statement (in which it is an <code>else if</code>) or a block (an else).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-06-09 08:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/src/lib.rs</code>:444 on 2023-06-09 08:40</div>
            <div class="timeline-body"><p>I would prefer not removing the code. I keep typing this every now and then when debugging comments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-06-09 08:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-06-09 08:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-06-09 08:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:54:21 UTC
    </footer>
</body>
</html>
