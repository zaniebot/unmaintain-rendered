<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Subscript assignment diagnostics follow-up - astral-sh/ruff #21452</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Subscript assignment diagnostics follow-up</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/21452">#21452</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-11-14 13:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Follow up from https://github.com/astral-sh/ruff/pull/21411. Again, there are more things that could be improved here (like the diagnostics for <code>lists</code>, or extending what we have for <code>dict</code> to <code>OrderedDict</code> etc), but that will have to be postponed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @sharkdp on 2025-11-14 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @sharkdp on 2025-11-14 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @sharkdp on 2025-11-14 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @sharkdp on 2025-11-14 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">diagnostics</span> added by @sharkdp on 2025-11-14 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-11-14 13:33</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance">typing conformance tests</a></h2>
<details>
<summary>Changes were detected when running ty on typing conformance tests</summary>

<pre><code class="language-diff">--- old-output.txt	2025-11-17 11:12:13.684914983 +0000
+++ new-output.txt	2025-11-17 11:12:17.143922916 +0000
@@ -963,7 +963,7 @@
 typeddicts_extra_items.py:339:1: error[type-assertion-failure] Argument does not have asserted type `tuple[str, int]`
 typeddicts_extra_items.py:339:13: error[unresolved-attribute] Object of type `IntDictWithNum` has no attribute `popitem`
 typeddicts_extra_items.py:342:27: error[invalid-key] TypedDict `IntDictWithNum` can only be subscripted with a string literal key, got key of type `str`.
-typeddicts_extra_items.py:343:31: error[invalid-key] TypedDict `IntDictWithNum` can only be subscripted with string literal keys, got key of type `str`
+typeddicts_extra_items.py:343:31: error[invalid-key] TypedDict `IntDictWithNum` can only be subscripted with a string literal key, got key of type `str`
 typeddicts_extra_items.py:352:5: error[invalid-assignment] Object of type `dict[str, int]` is not assignable to `IntDict`
 typeddicts_operations.py:22:17: error[invalid-assignment] Invalid assignment to key &quot;name&quot; with declared type `str` on TypedDict `Movie`: value of type `Literal[1982]`
 typeddicts_operations.py:23:17: error[invalid-assignment] Invalid assignment to key &quot;year&quot; with declared type `int` on TypedDict `Movie`: value of type `Literal[&quot;&quot;]`

</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-11-14 13:34</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">spack (https://github.com/spack/spack)
- lib/spack/spack/vendor/markupsafe/__init__.py:248:13: error[invalid-assignment] Method `__setitem__` of type `(Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]) | (bound method _ListOrDict@_escape_argspec.__setitem__(key: Unknown, value: Unknown, /) -&gt; None)` cannot be called with a key of type `Any` and a value of type `Markup` on object of type `_ListOrDict@_escape_argspec`
+ lib/spack/spack/vendor/markupsafe/__init__.py:248:13: error[invalid-assignment] Invalid subscript assignment with key of type `Any` and value of type `Markup` on object of type `_ListOrDict@_escape_argspec`

werkzeug (https://github.com/pallets/werkzeug)
- tests/test_test.py:149:5: error[invalid-assignment] Method `__setitem__` of type `bound method MultiDict[str, str].__setitem__(key: str, value: str) -&gt; None` cannot be called with a key of type `Literal[&quot;test_int&quot;]` and a value of type `Literal[1]` on object of type `MultiDict[str, str]`
+ tests/test_test.py:149:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;test_int&quot;]` and value of type `Literal[1]` on object of type `MultiDict[str, str]`

pytest (https://github.com/pytest-dev/pytest)
- src/_pytest/pastebin.py:43:13: error[invalid-assignment] Method `__setitem__` of type `bound method Stash.__setitem__[T](key: StashKey[T@__setitem__], value: T@__setitem__) -&gt; None` cannot be called with a key of type `StashKey[IO[bytes]]` and a value of type `TextIOWrapper[_WrappedBuffer]` on object of type `Stash`
+ src/_pytest/pastebin.py:43:13: error[invalid-assignment] Invalid subscript assignment with key of type `StashKey[IO[bytes]]` and value of type `TextIOWrapper[_WrappedBuffer]` on object of type `Stash`

scrapy (https://github.com/scrapy/scrapy)
- scrapy/http/headers.py:91:9: error[invalid-assignment] Method `__setitem__` of type `bound method Self@setlist.__setitem__[AnyStr](key: AnyStr@__setitem__, value: Any) -&gt; None` cannot be called with a key of type `AnyStr@setlist` and a value of type `Iterable[@Todo]` on object of type `Self@setlist`
+ scrapy/http/headers.py:91:9: error[invalid-assignment] Invalid subscript assignment with key of type `AnyStr@setlist` and value of type `Iterable[@Todo]` on object of type `Self@setlist`
- scrapy/http/headers.py:101:9: error[invalid-assignment] Method `__setitem__` of type `bound method Self@appendlist.__setitem__[AnyStr](key: AnyStr@__setitem__, value: Any) -&gt; None` cannot be called with a key of type `AnyStr@appendlist` and a value of type `list[bytes]` on object of type `Self@appendlist`
+ scrapy/http/headers.py:101:9: error[invalid-assignment] Invalid subscript assignment with key of type `AnyStr@appendlist` and value of type `list[bytes]` on object of type `Self@appendlist`
- scrapy/utils/python.py:152:13: error[invalid-assignment] Method `__setitem__` of type `bound method WeakKeyDictionary[typing.TypeVar, _T@memoizemethod_noargs].__setitem__(key: typing.TypeVar, value: _T@memoizemethod_noargs) -&gt; None` cannot be called with a key of type `_SelfT@new_method` and a value of type `_T@memoizemethod_noargs` on object of type `WeakKeyDictionary[typing.TypeVar, _T@memoizemethod_noargs]`
+ scrapy/utils/python.py:152:13: error[invalid-assignment] Invalid subscript assignment with key of type `_SelfT@new_method` and value of type `_T@memoizemethod_noargs` on object of type `WeakKeyDictionary[typing.TypeVar, _T@memoizemethod_noargs]`

sockeye (https://github.com/awslabs/sockeye)
- sockeye/log.py:131:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;level&quot;]` and a value of type `Unknown | Literal[20]` on object of type `list[Unknown | str]`
+ sockeye/log.py:131:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;level&quot;]` and value of type `Unknown | Literal[20]` on object of type `list[Unknown | str]`

tornado (https://github.com/tornadoweb/tornado)
- tornado/test/httpclient_test.py:521:17: error[invalid-assignment] Method `__setitem__` of type `bound method HTTPHeaders.__setitem__(name: str, value: str) -&gt; None` cannot be called with a key of type `Literal[&quot;User-Agent&quot;]` and a value of type `Unknown | str | bytes` on object of type `HTTPHeaders`
+ tornado/test/httpclient_test.py:521:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;User-Agent&quot;]` and value of type `Unknown | str | bytes` on object of type `HTTPHeaders`

pandera (https://github.com/pandera-dev/pandera)
- pandera/decorators.py:393:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `int | str` and a value of type `Unknown` on object of type `list[Unknown]`
+ pandera/decorators.py:393:17: error[invalid-assignment] Invalid subscript assignment with key of type `int | str` and value of type `Unknown` on object of type `list[Unknown]`

mitmproxy (https://github.com/mitmproxy/mitmproxy)
- mitmproxy/addons/savehar.py:206:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: dict[Unknown, Unknown], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[dict[Unknown, Unknown]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;text&quot;]` and a value of type `str` on object of type `list[dict[Unknown, Unknown]]`
+ mitmproxy/addons/savehar.py:206:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;text&quot;]` and value of type `str` on object of type `list[dict[Unknown, Unknown]]`
- mitmproxy/addons/savehar.py:207:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: dict[Unknown, Unknown], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[dict[Unknown, Unknown]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;encoding&quot;]` and a value of type `Literal[&quot;base64&quot;]` on object of type `list[dict[Unknown, Unknown]]`
+ mitmproxy/addons/savehar.py:207:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;encoding&quot;]` and value of type `Literal[&quot;base64&quot;]` on object of type `list[dict[Unknown, Unknown]]`
- mitmproxy/addons/savehar.py:211:21: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: dict[Unknown, Unknown], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[dict[Unknown, Unknown]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;text&quot;]` and a value of type `Literal[&quot;&quot;]` on object of type `list[dict[Unknown, Unknown]]`
+ mitmproxy/addons/savehar.py:211:21: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;text&quot;]` and value of type `Literal[&quot;&quot;]` on object of type `list[dict[Unknown, Unknown]]`
- mitmproxy/addons/savehar.py:213:21: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: dict[Unknown, Unknown], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[dict[Unknown, Unknown]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;text&quot;]` and a value of type `str` on object of type `list[dict[Unknown, Unknown]]`
+ mitmproxy/addons/savehar.py:213:21: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;text&quot;]` and value of type `str` on object of type `list[dict[Unknown, Unknown]]`
- test/mitmproxy/test_http.py:602:9: error[invalid-assignment] Method `__setitem__` of type `bound method MultiDictView[str, tuple[str, MultiDict[str, str | None]]].__setitem__(key: str, value: tuple[str, MultiDict[str, str | None]]) -&gt; None` cannot be called with a key of type `Literal[&quot;foo&quot;]` and a value of type `tuple[Literal[&quot;bar&quot;], dict[Unknown, Unknown]]` on object of type `MultiDictView[str, tuple[str, MultiDict[str, str | None]]]`
+ test/mitmproxy/test_http.py:602:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;foo&quot;]` and value of type `tuple[Literal[&quot;bar&quot;], dict[Unknown, Unknown]]` on object of type `MultiDictView[str, tuple[str, MultiDict[str, str | None]]]`

schema_salad (https://github.com/common-workflow-language/schema_salad)
- schema_salad/schema.py:541:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(index: int, value: Any) -&gt; None, (index: slice[Any, Any, Any], value: Iterable[Any]) -&gt; None]` cannot be called with a key of type `Literal[&quot;name&quot;]` and a value of type `str` on object of type `MutableSequence[Any]`
+ schema_salad/schema.py:541:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;name&quot;]` and value of type `str` on object of type `MutableSequence[Any]`
- schema_salad/schema.py:543:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(index: int, value: Any) -&gt; None, (index: slice[Any, Any, Any], value: Iterable[Any]) -&gt; None]` cannot be called with a key of type `Literal[&quot;name&quot;]` and a value of type `str` on object of type `MutableSequence[Any]`
+ schema_salad/schema.py:543:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;name&quot;]` and value of type `str` on object of type `MutableSequence[Any]`
- schema_salad/schema.py:563:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(index: int, value: Any) -&gt; None, (index: slice[Any, Any, Any], value: Iterable[Any]) -&gt; None]` cannot be called with a key of type `Literal[&quot;type&quot;, &quot;items&quot;, &quot;names&quot;, &quot;values&quot;, &quot;fields&quot;]` and a value of type `MutableMapping[str, Any] | MutableSequence[Any] | str | MutableMapping[str, str] | list[Any | MutableMapping[str, str] | str]` on object of type `MutableSequence[Any]`
+ schema_salad/schema.py:563:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;type&quot;, &quot;items&quot;, &quot;names&quot;, &quot;values&quot;, &quot;fields&quot;]` and value of type `MutableMapping[str, Any] | MutableSequence[Any] | str | MutableMapping[str, str] | list[Any | MutableMapping[str, str] | str]` on object of type `MutableSequence[Any]`
- schema_salad/schema.py:572:13: error[invalid-assignment] Method `__setitem__` of type `Overload[(index: int, value: Any) -&gt; None, (index: slice[Any, Any, Any], value: Iterable[Any]) -&gt; None]` cannot be called with a key of type `Literal[&quot;symbols&quot;]` and a value of type `list[str | Unknown]` on object of type `MutableSequence[Any]`
+ schema_salad/schema.py:572:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;symbols&quot;]` and value of type `list[str | Unknown]` on object of type `MutableSequence[Any]`

sphinx (https://github.com/sphinx-doc/sphinx)
- sphinx/environment/__init__.py:1176:17: error[invalid-assignment] Method `__setitem__` of type `bound method Self@update.__setitem__(key: str, value: Any) -&gt; None` cannot be called with a key of type `object` and a value of type `object` on object of type `Self@update`
+ sphinx/environment/__init__.py:1176:17: error[invalid-assignment] Invalid subscript assignment with key of type `object` and value of type `object` on object of type `Self@update`

manticore (https://github.com/trailofbits/manticore)
- manticore/platforms/decree.py:850:13: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | None, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | None], /) -&gt; None]` cannot be called with a key of type `Unknown | int | None` and a value of type `Unknown | int` on object of type `list[Unknown | None]`
- manticore/platforms/decree.py:852:13: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | None, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | None], /) -&gt; None]` cannot be called with a key of type `Unknown | int | None` and a value of type `None` on object of type `list[Unknown | None]`
+ manticore/platforms/decree.py:850:13: error[invalid-assignment] Invalid subscript assignment with key of type `Unknown | int | None` and value of type `Unknown | int` on object of type `list[Unknown | None]`
+ manticore/platforms/decree.py:852:13: error[invalid-assignment] Invalid subscript assignment with key of type `Unknown | int | None` and value of type `None` on object of type `list[Unknown | None]`

discord.py (https://github.com/Rapptz/discord.py)
- discord/message.py:2404:30: error[invalid-key] TypedDict `Message` can only be subscripted with string literal keys, got key of type `str`
+ discord/message.py:2404:30: error[invalid-key] TypedDict `Message` can only be subscripted with a string literal key, got key of type `str`

apprise (https://github.com/caronc/apprise)
- apprise/plugins/d7networks.py:238:13: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | None | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | None | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;originator&quot;]` and a value of type `Unknown &amp; ~AlwaysFalsy` on object of type `list[Unknown | dict[Unknown | str, Unknown | None | str]]`
+ apprise/plugins/d7networks.py:238:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;originator&quot;]` and value of type `Unknown &amp; ~AlwaysFalsy` on object of type `list[Unknown | dict[Unknown | str, Unknown | None | str]]`
- apprise/plugins/email/base.py:1129:17: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEMultipart.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Literal[&quot;Subject&quot;]` and a value of type `Header` on object of type `MIMEMultipart`
- apprise/plugins/email/base.py:1129:17: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEText.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Literal[&quot;Subject&quot;]` and a value of type `Header` on object of type `MIMEText`
+ apprise/plugins/email/base.py:1129:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;Subject&quot;]` and value of type `Header` on object of type `MIMEMultipart`
+ apprise/plugins/email/base.py:1129:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;Subject&quot;]` and value of type `Header` on object of type `MIMEText`
- apprise/plugins/email/base.py:1165:17: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEMultipart.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Unknown` and a value of type `Header` on object of type `MIMEMultipart`
- apprise/plugins/email/base.py:1165:17: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEText.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Unknown` and a value of type `Header` on object of type `MIMEText`
- apprise/plugins/email/base.py:1167:13: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEMultipart.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Literal[&quot;Subject&quot;]` and a value of type `Header` on object of type `MIMEMultipart`
- apprise/plugins/email/base.py:1167:13: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEText.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Literal[&quot;Subject&quot;]` and a value of type `Header` on object of type `MIMEText`
+ apprise/plugins/email/base.py:1165:17: error[invalid-assignment] Invalid subscript assignment with key of type `Unknown` and value of type `Header` on object of type `MIMEMultipart`
+ apprise/plugins/email/base.py:1165:17: error[invalid-assignment] Invalid subscript assignment with key of type `Unknown` and value of type `Header` on object of type `MIMEText`
+ apprise/plugins/email/base.py:1167:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;Subject&quot;]` and value of type `Header` on object of type `MIMEMultipart`
+ apprise/plugins/email/base.py:1167:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;Subject&quot;]` and value of type `Header` on object of type `MIMEText`
- apprise/plugins/ses.py:470:13: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEMultipart.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Literal[&quot;Subject&quot;]` and a value of type `Header` on object of type `MIMEMultipart`
- apprise/plugins/ses.py:470:13: error[invalid-assignment] Method `__setitem__` of type `bound method MIMEText.__setitem__(name: str, val: str) -&gt; None` cannot be called with a key of type `Literal[&quot;Subject&quot;]` and a value of type `Header` on object of type `MIMEText`
+ apprise/plugins/ses.py:470:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;Subject&quot;]` and value of type `Header` on object of type `MIMEMultipart`
+ apprise/plugins/ses.py:470:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;Subject&quot;]` and value of type `Header` on object of type `MIMEText`

cloud-init (https://github.com/canonical/cloud-init)
- cloudinit/net/network_state.py:340:17: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;dns&quot;]` and a value of type `dict[Unknown | str, Unknown]` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:340:17: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;dns&quot;]` and value of type `dict[Unknown | str, Unknown]` on object of type `list[Unknown]`
- cloudinit/net/network_state.py:437:13: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;mac_address&quot;]` and a value of type `Unknown` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:437:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;mac_address&quot;]` and value of type `Unknown` on object of type `list[Unknown]`
- cloudinit/net/network_state.py:456:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;vlan-raw-device&quot;]` and a value of type `Unknown` on object of type `list[Unknown]`
- cloudinit/net/network_state.py:457:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;vlan_id&quot;]` and a value of type `Unknown` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:456:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;vlan-raw-device&quot;]` and value of type `Unknown` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:457:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;vlan_id&quot;]` and value of type `Unknown` on object of type `list[Unknown]`
- cloudinit/net/network_state.py:507:13: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;bond-master&quot;]` and a value of type `Unknown` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:507:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;bond-master&quot;]` and value of type `Unknown` on object of type `list[Unknown]`
- cloudinit/net/network_state.py:558:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;bridge_ports&quot;]` and a value of type `Unknown` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:558:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;bridge_ports&quot;]` and value of type `Unknown` on object of type `list[Unknown]`
- cloudinit/net/network_state.py:616:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;dns&quot;]` and a value of type `dict[Unknown | str, Unknown]` on object of type `list[Unknown]`
+ cloudinit/net/network_state.py:616:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;dns&quot;]` and value of type `dict[Unknown | str, Unknown]` on object of type `list[Unknown]`
- cloudinit/sources/DataSourceVMware.py:1000:48: error[invalid-key] TypedDict `Interface` can only be subscripted with string literal keys, got key of type `Literal[0]`
+ cloudinit/sources/DataSourceVMware.py:1000:48: error[invalid-key] TypedDict `Interface` can only be subscripted with a string literal key, got key of type `Literal[0]`
- cloudinit/sources/DataSourceVMware.py:1001:26: error[invalid-key] TypedDict `Interface` can only be subscripted with string literal keys, got key of type `Literal[0]`
+ cloudinit/sources/DataSourceVMware.py:1001:26: error[invalid-key] TypedDict `Interface` can only be subscripted with a string literal key, got key of type `Literal[0]`
- cloudinit/sources/DataSourceVMware.py:1008:48: error[invalid-key] TypedDict `Interface` can only be subscripted with string literal keys, got key of type `Literal[0]`
+ cloudinit/sources/DataSourceVMware.py:1008:48: error[invalid-key] TypedDict `Interface` can only be subscripted with a string literal key, got key of type `Literal[0]`
- cloudinit/sources/DataSourceVMware.py:1009:26: error[invalid-key] TypedDict `Interface` can only be subscripted with string literal keys, got key of type `Literal[0]`
+ cloudinit/sources/DataSourceVMware.py:1009:26: error[invalid-key] TypedDict `Interface` can only be subscripted with a string literal key, got key of type `Literal[0]`
- cloudinit/sources/DataSourceVMware.py:1018:53: error[invalid-key] TypedDict `Interface` can only be subscripted with string literal keys, got key of type `Literal[0]`
+ cloudinit/sources/DataSourceVMware.py:1018:53: error[invalid-key] TypedDict `Interface` can only be subscripted with a string literal key, got key of type `Literal[0]`
- cloudinit/sources/DataSourceVMware.py:1028:53: error[invalid-key] TypedDict `Interface` can only be subscripted with string literal keys, got key of type `Literal[0]`
+ cloudinit/sources/DataSourceVMware.py:1028:53: error[invalid-key] TypedDict `Interface` can only be subscripted with a string literal key, got key of type `Literal[0]`
- tests/unittests/helpers.py:422:5: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;distro&quot;]` and a value of type `Unknown` on object of type `list[Unknown | str]`
+ tests/unittests/helpers.py:422:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;distro&quot;]` and value of type `Unknown` on object of type `list[Unknown | str]`
- tests/unittests/helpers.py:422:5: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;distro&quot;]` and a value of type `Unknown` on object of type `list[Unknown]`
+ tests/unittests/helpers.py:422:5: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;distro&quot;]` and value of type `Unknown` on object of type `list[Unknown]`
- tests/unittests/helpers.py:424:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;renderers&quot;]` and a value of type `Unknown &amp; ~AlwaysFalsy` on object of type `list[Unknown]`
+ tests/unittests/helpers.py:424:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;renderers&quot;]` and value of type `Unknown &amp; ~AlwaysFalsy` on object of type `list[Unknown]`
- tests/unittests/helpers.py:426:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;activators&quot;]` and a value of type `Unknown &amp; ~AlwaysFalsy` on object of type `list[Unknown]`
+ tests/unittests/helpers.py:426:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;activators&quot;]` and value of type `Unknown &amp; ~AlwaysFalsy` on object of type `list[Unknown]`
- tests/unittests/sources/test_azure.py:4096:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Unknown` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4158:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Literal[&quot;Running&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4281:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Literal[&quot;Running&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4405:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Literal[&quot;Savable&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4537:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Literal[&quot;Savable&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4691:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Literal[&quot;Savable&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4823:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Unknown` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4908:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Unknown` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_azure.py:4951:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;ppsType&quot;]` and a value of type `Literal[&quot;PreprovisionedOSDisk&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4096:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Unknown` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4158:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Literal[&quot;Running&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4281:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Literal[&quot;Running&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4405:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Literal[&quot;Savable&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4537:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Literal[&quot;Savable&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4691:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Literal[&quot;Savable&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4823:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Unknown` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4908:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Unknown` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
+ tests/unittests/sources/test_azure.py:4951:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;ppsType&quot;]` and value of type `Literal[&quot;PreprovisionedOSDisk&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | dict[Unknown | str, Unknown | list[Unknown | dict[Unknown | str, Unknown | str]]] | dict[Unknown | str, Unknown | list[Unknown]] | str]]`
- tests/unittests/sources/test_cloudsigma.py:94:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;base64_fields&quot;]` and a value of type `Literal[&quot;cloudinit-user-data&quot;]` on object of type `list[Unknown]`
- tests/unittests/sources/test_cloudsigma.py:94:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;base64_fields&quot;]` and a value of type `Literal[&quot;cloudinit-user-data&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/sources/test_cloudsigma.py:94:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;base64_fields&quot;]` and value of type `Literal[&quot;cloudinit-user-data&quot;]` on object of type `list[Unknown]`
+ tests/unittests/sources/test_cloudsigma.py:94:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;base64_fields&quot;]` and value of type `Literal[&quot;cloudinit-user-data&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/sources/test_cloudsigma.py:95:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;cloudinit-user-data&quot;]` and a value of type `Literal[&quot;aGkgd29ybGQK&quot;]` on object of type `list[Unknown]`
- tests/unittests/sources/test_cloudsigma.py:95:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;cloudinit-user-data&quot;]` and a value of type `Literal[&quot;aGkgd29ybGQK&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/sources/test_cloudsigma.py:95:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;cloudinit-user-data&quot;]` and value of type `Literal[&quot;aGkgd29ybGQK&quot;]` on object of type `list[Unknown]`
+ tests/unittests/sources/test_cloudsigma.py:95:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;cloudinit-user-data&quot;]` and value of type `Literal[&quot;aGkgd29ybGQK&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/sources/test_init.py:951:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;secure&quot;]` and a value of type `Literal[&quot;redacted&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/sources/test_init.py:961:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;secure&quot;]` and a value of type `Literal[&quot;redacted for non-root user&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/sources/test_init.py:951:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;secure&quot;]` and value of type `Literal[&quot;redacted&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/sources/test_init.py:961:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;secure&quot;]` and value of type `Literal[&quot;redacted for non-root user&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:931:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [ ConfigDrive, IBMCloud ]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
- tests/unittests/test_ds_identify.py:931:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [ ConfigDrive, IBMCloud ]\n&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/test_ds_identify.py:931:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [ ConfigDrive, IBMCloud ]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
+ tests/unittests/test_ds_identify.py:931:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [ ConfigDrive, IBMCloud ]\n&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:936:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [ ConfigDrive, NoCloud ]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
- tests/unittests/test_ds_identify.py:936:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [ ConfigDrive, NoCloud ]\n&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/test_ds_identify.py:936:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [ ConfigDrive, NoCloud ]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
+ tests/unittests/test_ds_identify.py:936:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/99_networklayer_common.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [ ConfigDrive, NoCloud ]\n&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:1034:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/ds-identify.cfg&quot;]` and a value of type `str` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
- tests/unittests/test_ds_identify.py:1034:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/ds-identify.cfg&quot;]` and a value of type `str` on object of type `list[Unknown | str]`
+ tests/unittests/test_ds_identify.py:1034:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/ds-identify.cfg&quot;]` and value of type `str` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
+ tests/unittests/test_ds_identify.py:1034:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/ds-identify.cfg&quot;]` and value of type `str` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:1045:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [\&quot;NoCloud\&quot;]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
- tests/unittests/test_ds_identify.py:1045:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [\&quot;NoCloud\&quot;]\n&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/test_ds_identify.py:1045:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [\&quot;NoCloud\&quot;]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
+ tests/unittests/test_ds_identify.py:1045:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [\&quot;NoCloud\&quot;]\n&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:1057:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [\&quot;Ec2\&quot;, \&quot;None\&quot;]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
- tests/unittests/test_ds_identify.py:1057:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and a value of type `Literal[&quot;datasource_list: [\&quot;Ec2\&quot;, \&quot;None\&quot;]\n&quot;]` on object of type `list[Unknown | str]`
+ tests/unittests/test_ds_identify.py:1057:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [\&quot;Ec2\&quot;, \&quot;None\&quot;]\n&quot;]` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
+ tests/unittests/test_ds_identify.py:1057:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;etc/cloud/cloud.cfg.d/myds.cfg&quot;]` and value of type `Literal[&quot;datasource_list: [\&quot;Ec2\&quot;, \&quot;None\&quot;]\n&quot;]` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:1095:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;sys/class/dmi/id/product_name&quot;]` and a value of type `Unknown | str` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
- tests/unittests/test_ds_identify.py:1095:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | str, /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | str], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;sys/class/dmi/id/product_name&quot;]` and a value of type `Unknown | str` on object of type `list[Unknown | str]`
+ tests/unittests/test_ds_identify.py:1095:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;sys/class/dmi/id/product_name&quot;]` and value of type `Unknown | str` on object of type `list[Unknown | dict[Unknown | str, Unknown | str | int]]`
+ tests/unittests/test_ds_identify.py:1095:9: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;sys/class/dmi/id/product_name&quot;]` and value of type `Unknown | str` on object of type `list[Unknown | str]`
- tests/unittests/test_ds_identify.py:1149:9: error[invalid-assignment] Method `__setitem__` of type `Overload[(key: SupportsIndex, value: Unknown | dict[Unknown | str, Unknown | str | int], /) -&gt; None, (key: slice[Any, Any, Any], value: Iterable[Unknown | dict[Unknown | str, Unknown | str | int]], /) -&gt; None]` cannot be called with a key of type `Literal[&quot;sys/class/dmi/id/chassis_asset_tag&quot;]` and a value of type `Litera

... (truncated 414 lines) ...
</code></pre>
</details>

<p>No memory usage changes detected </p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/infer/builder.rs</code>:3892 on 2025-11-14 13:35</div>
            <div class="timeline-body"><pre><code class="language-suggestion">                                    diagnostic.info(format_args!(
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-11-14 13:35</div>
            <div class="timeline-body"><p>Thank you!!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/infer/builder.rs</code>:3842 on 2025-11-14 13:39</div>
            <div class="timeline-body"><p>you can be a bit more DRY:</p>
<pre><code class="language-diff">diff --git a/crates/ty_python_semantic/src/types/infer/builder.rs b/crates/ty_python_semantic/src/types/infer/builder.rs
index cfc248d42e..9b12ced6d6 100644
--- a/crates/ty_python_semantic/src/types/infer/builder.rs
+++ b/crates/ty_python_semantic/src/types/infer/builder.rs
@@ -3794,18 +3794,18 @@ impl&lt;'db, 'ast&gt; TypeInferenceBuilder&lt;'db, 'ast&gt; {
                                             let assigned_d = rhs_value_ty.display(db);
                                             let object_d = object_ty.display(db);
 
+                                            let mut diagnostic = builder.into_diagnostic(format_args!(
+                                                &quot;Invalid subscript assignment with key of type `{}` and value of \
+                                                    type `{assigned_d}` on object of type `{object_d}`&quot;,
+                                                slice_ty.display(db),
+                                            ));
+
                                             // Special diagnostic for dictionaries
                                             if let Some([expected_key_ty, expected_value_ty]) =
                                                 object_ty
                                                     .known_specialization(db, KnownClass::Dict)
                                                     .map(|s| s.types(db))
                                             {
-                                                let mut diagnostic = builder.into_diagnostic(format_args!(
-                                                    &quot;Invalid subscript assignment with key of type `{}` and value of \
-                                                     type `{assigned_d}` on object of type `{object_d}`&quot;,
-                                                    slice_ty.display(db),
-                                                ));
-
                                                 if !slice_ty.is_assignable_to(db, *expected_key_ty)
                                                 {
                                                     diagnostic.annotate(
@@ -3833,13 +3833,6 @@ impl&lt;'db, 'ast&gt; TypeInferenceBuilder&lt;'db, 'ast&gt; {
                                                     );
                                                 }
 
-                                                attach_original_type_info(&amp;mut diagnostic);
-                                            } else {
-                                                let mut diagnostic = builder.into_diagnostic(format_args!(
-                                                    &quot;Invalid subscript assignment with key of type `{}` and value of \
-                                                     type `{assigned_d}` on object of type `{object_d}`&quot;,
-                                                    slice_ty.display(db),
-                                                ));
                                                 attach_original_type_info(&amp;mut diagnostic);
                                             }
                                         }
</code></pre>
<p>(all tests pass with that patch applied)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-11-14 13:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @sharkdp on 2025-11-17 11:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sharkdp on 2025-11-17 11:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-11-17 11:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:17:16 UTC
    </footer>
</body>
</html>
