<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Add inlay hints for call arguments - astral-sh/ruff #19269</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Add inlay hints for call arguments</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/19269">#19269</a>
        opened by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a>
        on 2025-07-10 18:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a></div>
            <div class="timeline-body">

Summary
<p>Add function argument inlay hints.</p>
<p>Note that the inlay hints here have the structure <code>{name}=</code> instead of <code>{name}:</code> for rust. I think this makes more sense for python.</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/36a09289-ad37-4334-a028-5593d52722b8"></p>
<p>As you can see I have made lots of visibility modifiers public. I don&#x27;t want to do this, but I have for an initial showcase of this feature.</p>
<p>If anyone can advise on a better solution (maybe some function inside the <code>ty_python_semantic</code> crate) that would be greatly appreciated.</p>
Test Plan
<p>Add tests to <code>ty_ide/src/inlay_hints.rs</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
            <div class="timeline-body"><p>Will mark this as ready for review for some initial feedback</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/sharkdp">@sharkdp</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-10 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-07-10 18:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-07-10 18:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-07-10 18:08</div>
            <div class="timeline-body">

<code>mypy_primer</code> results
<p>No ecosystem changes detected ✅
No memory usage changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for <a href="https://github.com/AlexWaygood">@AlexWaygood</a> removed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-07-10 19:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:155 on 2025-07-11 07:22</div>
            <div class="timeline-body"><p>Nit: Do we need to clone here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:156 on 2025-07-11 07:23</div>
            <div class="timeline-body"><p>I think we need to match the signature here to resolve the best matching overload or it will show incorrect results for overloads</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types.rs</code>:1126 on 2025-07-11 07:24</div>
            <div class="timeline-body"><p>Huh, why do we need to call <code>into_callable</code> twice. This looks fairly odd</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-07-11 07:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 07:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:155 on 2025-07-11 07:25</div>
            <div class="timeline-body"><p>No, I forgot to remove that thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 07:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types.rs</code>:1126 on 2025-07-11 07:26</div>
            <div class="timeline-body"><p>ClassLiteral.into_callable can return bound methods, I agree it looks weird, maybe I should change the class literal function instead to convert them</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 07:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:156 on 2025-07-11 07:28</div>
            <div class="timeline-body"><p>Yeah that makes sense, I just took the first one for initial demonstration. I&#x27;ll look into to how to do that</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-07-11 08:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:156 on 2025-07-11 08:26</div>
            <div class="timeline-body"><p>It could make sense to take a look at the <code>signature_help</code> implementation which does something very similar.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 08:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:156 on 2025-07-11 08:29</div>
            <div class="timeline-body"><p>Okay thank you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 18:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:156 on 2025-07-11 18:54</div>
            <div class="timeline-body"><p>This works well, but it also provides inlay hints for positional only, variadic and keyword_variadic, which i don&#x27;t think we want</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 19:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types.rs</code>:1126 on 2025-07-11 19:25</div>
            <div class="timeline-body"><p>I have added more into_callable calls in <code>ClassLiteral.into_callable</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-07-11 19:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:156 on 2025-07-11 19:45</div>
            <div class="timeline-body"><p>Fixed that now</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-11 20:05</div>
            <div class="timeline-body"><p>This doesn&#x27;t seem to work well with overloads. Seems to be because of one of the internal functions from bindings maybe</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-07-14 07:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-24 23:24</div>
            <div class="timeline-body"><p>@MichaReiser what are you&#x27;re thoughts on this PR, what more would you like to see?</p>
<p>Also, is this something we really want?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-08-05 22:18</div>
            <div class="timeline-body">

Diagnostic diff on <a href="https://github.com/python/typing/tree/d4f39b27a4a47aac8b6d4019e1b0b5b3156fabdc/conformance">typing conformance tests</a>
<p>No changes detected when running ty on typing conformance tests ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-05 22:24</div>
            <div class="timeline-body"><p>I&#x27;m aware what I&#x27;ve changed in into callable is out of scope, I&#x27;ll try to move that to another PR</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-06 22:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-06 22:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:62 on 2025-08-07 12:05</div>
            <div class="timeline-body"><p>Is this not given by the visiting order in <code>SourceOrderVisitor</code>?</p>
<p>I think I see. It&#x27;s because of how we walk functions where we add the function argument inlays before we visit the arguments. Would it be possible to change the visiting order so that the sort can be avoided? It&#x27;s not hugely important but would be nice.</p>
<p>I also think we can use <code>sort_unstable_by</code>. It&#x27;s fine if two inlay for the same position (which shouldn&#x27;t happen anyway) get reordered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:167 on 2025-08-07 12:07</div>
            <div class="timeline-body"><p>Can we call walk_expr instead of walking the tree manually or are we intentionally skipping some fields?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:851 on 2025-08-07 12:09</div>
            <div class="timeline-body"><p>Can this be <code>pub(crate)</code> or even private?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-08-07 12:12</div>
            <div class="timeline-body"><blockquote>
<p>Note that the inlay hints here have the structure {name}= instead of {name}: for rust. I think this makes more sense for python.</p>
</blockquote>
<p>Have you looked into what other Python language servers (e.g. pylance) do here?</p>
<p>Nice. This looks great. We can now also gate this behind an option similar to what @dhruvmanila did in <a href="https://github.com/astral-sh/ruff/pull/19780">astral-sh/ruff#19780</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-08-07 13:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:167 on 2025-08-07 13:24</div>
            <div class="timeline-body"><p>I can properly walk the tree as normal, I was just having issues with ordering, but will review this section again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-07 14:14</div>
            <div class="timeline-body"><blockquote>
<p>We can now also gate this behind an option similar to what @dhruvmanila did in #19780</p>
</blockquote>
<p>For reference, this is what Python extension provides:</p>
<pre><code>  // Enable/disable inlay hints for call argument names:
  // ```python
  // datetime(&#x27;year=&#x27;2019, &#x27;month=&#x27;10, &#x27;day=&#x27;27)
  // ```
  // 
  //  - off: Disable inlay hints for call argument names.
  //  - partial: Enable inlay hints for positional-or-keyword arguments while ignoring positional-only and keyword-only.
  //  - all: Enable inlay hints for positional-or-keyword and positional-only arguments while ignoring keyword-only.
  &quot;python.analysis.inlayHints.callArgumentNames&quot;: &quot;off&quot;,
</code></pre>
<p>For now, we can just start with a boolean <code>true</code> / <code>false</code> but the &quot;partial&quot; does seem interesting although not sure about usage metrics.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-07 17:47</div>
            <div class="timeline-body"><p>Cool, thanks. To be honest I didn&#x27;t know the python extension provided this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-07 17:53</div>
            <div class="timeline-body"><p>Should we start with Boolean for all inlay hints or for both call arguments and assignments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-08-07 17:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:62 on 2025-08-07 17:58</div>
            <div class="timeline-body"><p>Yeah I&#x27;ll play around with the order, I should be able to remove the sort</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-08-07 19:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:851 on 2025-08-07 19:40</div>
            <div class="timeline-body"><p>this is used in ty_ide</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-07 19:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-08 07:49</div>
            <div class="timeline-body"><blockquote>
<p>Should we start with Boolean for all inlay hints or for both call arguments and assignments</p>
</blockquote>
<p>I suggest following pylance&#x27;s approach with a separate boolean option for each (we can change it to a non boolean option in the future)</p>
<blockquote>
<p>Have you looked into what other Python language servers (e.g. pylance) do here?</p>
</blockquote>
<p>Were you able to find out how pylance handle call argument names (e.g. how they&#x27;re formatted?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-08 08:17</div>
            <div class="timeline-body"><p>They do it like it is done in this PR.</p>
<p>They also have some guard that prevents argument names prefixed with &quot;_&quot; being displayed, that seems beneficial to add here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-11 14:24</div>
            <div class="timeline-body"><p>Just checking in (no pressure). Is this waiting on any input from my end?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-11 20:44</div>
            <div class="timeline-body"><p>Sorry, no not really, I just haven&#x27;t got to doing what I said was beneficial.</p>
<p>I&#x27;ll get that done, then I think I&#x27;m happy with this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-12 06:39</div>
            <div class="timeline-body"><p>Okay, no worries. I just wanted to make sure it isn&#x27;t blocked on me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-08-12 13:46</div>
            <div class="timeline-body"><p>Okay, that&#x27;s all the changes I think i need to make</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-12 13:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-12 13:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-12 13:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-12 14:21</div>
            <div class="timeline-body"><p>Again, this is great. Thank you. I&#x27;m not yet sure how many inlay hints we want to enable in the playground but that&#x27;s something we can easily tune</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[ty] Function argument inlay hints&quot; to &quot;[ty] Add inlay hints for call arguments&quot; by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:16:29 UTC
    </footer>
</body>
</html>
