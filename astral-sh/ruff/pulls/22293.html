<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Add skip_dunders option to CompletionTestBuilder - astral-sh/ruff #22293</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Add skip_dunders option to CompletionTestBuilder</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22293">#22293</a>
        opened by <a href="https://github.com/RasmusNygren">@RasmusNygren</a>
        on 2025-12-29 23:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/RasmusNygren">@RasmusNygren</a></div>
            <div class="timeline-body"><p>This is useful to remove noise when asserting
snapshots on method or attribute completions.</p>
<h2>Summary</h2>
<p>Most tests that checks completions on attributes and methods are written on the form <code>builder.build().contains(&quot;x&quot;).not_contains(&quot;y&quot;)</code> instead of asserting snapshots. These tests would be more robust if they were asserting exact snapshots (and IMO, in most cases also easier to read). This is however not really sustainable to do as long as we suggest dunders, as the snapshots become very large.</p>
<p>This adds a helper to skip dunder suggestions in the completion test builder.</p>
<h2>Test Plan</h2>
<p>This only changes test ergonomics and is not enabled by default. A single test was changed to use this helper to avoid hitting dead code lints.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @RasmusNygren on 2025-12-29 23:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @RasmusNygren on 2025-12-29 23:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @RasmusNygren on 2025-12-29 23:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @RasmusNygren on 2025-12-29 23:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @RasmusNygren on 2025-12-29 23:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/RasmusNygren">@RasmusNygren</a> reviewed on 2025-12-29 23:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/RasmusNygren">@RasmusNygren</a> on <code>crates/ty_ide/src/completion.rs</code>:4030 on 2025-12-29 23:08</div>
            <div class="timeline-body"><p>Essentially an arbitrary test that I changed (that can make use of this) to not add dead code.</p>
<p>There a lot of other tests that could make nice use of this that I intend to change if this lands, but I didn't want to overdo it ahead of time in case this functionality is not desirable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @carljm removed by @carljm on 2025-12-29 23:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by @MichaReiser on 2025-12-30 07:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @MichaReiser on 2025-12-30 07:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-30 08:06</div>
            <div class="timeline-body"><p>Thank you. This makes sense to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-12-30 08:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-12-30 08:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:18:35 UTC
    </footer>
</body>
</html>
