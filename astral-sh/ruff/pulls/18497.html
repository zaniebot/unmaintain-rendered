<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Stabilize checking for file-level directives in `unused-noqa` (`RUF100`) - astral-sh/ruff #18497</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Stabilize checking for file-level directives in <code>unused-noqa</code> (<code>RUF100</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/18497">#18497</a>
        opened by <a href="https://github.com/dylwil3">@dylwil3</a>
        on 2025-06-06 14:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a></div>
            <div class="timeline-body"><p>Note that the preview behavior was not documented (shame on us!) so the documentation was not modified.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.12&quot; by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-06-06 14:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-06-06 14:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-06-06 14:35</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+19 -0 violations, +0 -0 fixes in 5 projects; 50 projects unchanged)</p>
<a href="https://github.com/apache/superset">apache/superset</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/superset/blob/5541dad32b4ed87ac843c53add71ee4ef1de92d2/superset/commands/importers/v1/__init__.py#L70">superset/commands/importers/v1/__init__.py:70:5:</a> RUF100 [*] Unused `noqa` directive (unused: `C901`)
</pre>

</p>

<a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+1 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/ibis-project/ibis/blob/4a935dc02d0385822e6df26b1b2d8804c39a59fe/ibis/backends/tests/signature/typecheck.py#L8">ibis/backends/tests/signature/typecheck.py:8:1:</a> RUF100 Unused `noqa` directive (unused: `D205`, `D415`, `D400`)
</pre>

</p>

<a href="https://github.com/python/typeshed">python/typeshed</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select E,F,FA,I,PYI,RUF,UP,W</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/python/typeshed/blob/971d6a30f53772e1b03efeca9f8ce0168e803034/stdlib/asyncio/__init__.pyi#L1">stdlib/asyncio/__init__.pyi:1:1:</a> RUF100 [*] Unused `noqa` directive (non-enabled: `PLR5501`)
+ <a href="https://github.com/python/typeshed/blob/971d6a30f53772e1b03efeca9f8ce0168e803034/stdlib/typing.pyi#L2">stdlib/typing.pyi:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `F811`)
</pre>

</p>

<a href="https://github.com/scikit-build/scikit-build-core">scikit-build/scikit-build-core</a> (+7 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/packages/importlib_editable/pkg/pmod_a.py#L1">tests/packages/importlib_editable/pkg/pmod_a.py:1:1:</a> RUF100 [*] Unused `noqa` directive (unused: `I001`)
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/packages/importlib_editable/pkg/sub_a/pmod_b.py#L1">tests/packages/importlib_editable/pkg/sub_a/pmod_b.py:1:1:</a> RUF100 [*] Unused `noqa` directive (unused: `I001`)
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/packages/importlib_editable/pkg/sub_b/pmod_c.py#L1">tests/packages/importlib_editable/pkg/sub_b/pmod_c.py:1:1:</a> RUF100 [*] Unused `noqa` directive (unused: `I001`)
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/packages/importlib_editable/pkg/sub_b/sub_c/pmod_d.py#L1">tests/packages/importlib_editable/pkg/sub_b/sub_c/pmod_d.py:1:1:</a> RUF100 [*] Unused `noqa` directive (unused: `I001`)
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/packages/importlib_editable/pkg/sub_b/sub_d/pmod_e.py#L1">tests/packages/importlib_editable/pkg/sub_b/sub_d/pmod_e.py:1:1:</a> RUF100 [*] Unused `noqa` directive (unused: `I001`)
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/packages/importlib_editable/pmod.py#L1">tests/packages/importlib_editable/pmod.py:1:1:</a> RUF100 [*] Unused `noqa` directive (unused: `I001`)
+ <a href="https://github.com/scikit-build/scikit-build-core/blob/0a29cc1c89c6c79e6f9bb1124d1bbc16bb070cda/tests/test_skbuild_settings.py#L2">tests/test_skbuild_settings.py:2:1:</a> RUF100 [*] Unused `noqa` directive (non-enabled: `PLC1901`)
</pre>

</p>

<a href="https://github.com/astropy/astropy">astropy/astropy</a> (+8 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/cosmology/_src/core.py#L2">astropy/cosmology/_src/core.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `RUF009`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/cosmology/_src/flrw/base.py#L2">astropy/cosmology/_src/flrw/base.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `RUF009`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/cosmology/_src/flrw/w0cdm.py#L2">astropy/cosmology/_src/flrw/w0cdm.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `RUF009`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/cosmology/_src/flrw/w0wacdm.py#L2">astropy/cosmology/_src/flrw/w0wacdm.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `RUF009`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/cosmology/_src/flrw/w0wzcdm.py#L2">astropy/cosmology/_src/flrw/w0wzcdm.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `RUF009`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/cosmology/_src/flrw/wpwazpcdm.py#L2">astropy/cosmology/_src/flrw/wpwazpcdm.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `RUF009`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/units/photometric.py#L14">astropy/units/photometric.py:14:1:</a> RUF100 [*] Unused `noqa` directive (unused: `F821`)
+ <a href="https://github.com/astropy/astropy/blob/09795abdae6ebf71bc58b04be52faf79e198a1a2/astropy/units/tests/test_quantity_annotations.py#L2">astropy/units/tests/test_quantity_annotations.py:2:1:</a> RUF100 [*] Unused `noqa` directive (unused: `FA100`, `FA102`)
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF100 | 19 | 19 | 0 | 0 | 0 |</p>
</p>


Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-06-06 14:49</div>
            <div class="timeline-body"><p>A little confused by this one, which looks incorrect:</p>
<blockquote>
<p><a href="https://github.com/python/typeshed/blob/971d6a30f53772e1b03efeca9f8ce0168e803034/stdlib/typing.pyi#L2">stdlib/typing.pyi:2:1:</a> RUF100 [*] Unused <code>noqa</code> directive (unused: <code>F811</code>)</p>
</blockquote>
<p>Will investigate...</p>
<p>Update: Nope, this is correct! Apparently Ruff has been clever enough to notice that <code>overload</code> is <code>typing.overload</code> here since 0.4.0.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/checkers/noqa.rs</code>:124 on 2025-06-06 20:49</div>
            <div class="timeline-body"><p>I know it was already like this, but do we need to <code>collect</code> here? It looks like we just immediately put this back in a for loop.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-06-06 20:50</div>
            <div class="timeline-body"><p>LGTM, one minor suggestion while we&#x27;re here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a> reviewed on 2025-06-06 21:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dylwil3">@dylwil3</a> on <code>crates/ruff_linter/src/checkers/noqa.rs</code>:124 on 2025-06-06 21:41</div>
            <div class="timeline-body"><p>good catch!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-06-06 21:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-06-06 21:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-06-06 21:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:15:15 UTC
    </footer>
</body>
</html>
