<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introduce a new CST element for slice segments - astral-sh/ruff #3195</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Introduce a new CST element for slice segments</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/3195">#3195</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-02-24 00:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>In Python, both of these slices have the same AST:</p>
<pre><code>x[::]
x[:]
</code></pre>
<p>We need a way to differentiate between them, <em>and</em> we need a way to account for comments within empty segments, like:</p>
<pre><code>x[
  :
  # Comment here
  :
]
</code></pre>
<p>This PR attempts to solve both problems by introducing a new CST node kind, <code>SliceIndex</code>, which can either be an expression or empty. The final segment of a <code>Slice</code> is now optional; if it&#x27;s present but empty, we know to include the trailing colon. Since <code>SliceIndex</code> is <code>Located</code>, we can also attach comments to it.</p>
<p>As an alternative, I also considered creating a new <code>ExprKind::Placeholder</code>, which would only be used here. That <em>might&#x27;ve</em> been more succinct, but this felt like less of a dramatic change to the AST structure.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autoformatter</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-24 00:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-24 00:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-24 00:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-02-24 00:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:52:30 UTC
    </footer>
</body>
</html>
