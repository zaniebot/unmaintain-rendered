<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>new rule: enforce consistent capitalisation of noqa statements - astral-sh/ruff #9713</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>new rule: enforce consistent capitalisation of noqa statements</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9713">#9713</a>
        opened by <a href="https://github.com/danieleades">@danieleades</a>
        on 2024-01-30 19:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/danieleades">@danieleades</a> on 2024-01-30 19:00</div>
            <div class="timeline-body"><p>closes #9596</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "sketch out new rule" to "new rule: enforce consistent capitalisation of noqa statements" by @danieleades on 2024-01-30 19:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-25 22:01</div>
            <div class="timeline-body"><p>@danieleades -- Sorry I missed this! Are you interested in working on it? If so, I can write up some notes on how to implement it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danieleades">@danieleades</a> on 2024-02-25 22:12</div>
            <div class="timeline-body"><blockquote>
<p>@danieleades -- Sorry I missed this! Are you interested in working on it? If so, I can write up some notes on how to implement it.</p>
</blockquote>
<p>If you've got the time, that'd be great. I had a half-hearted attempt but found it a little impenetrable. Seems you need to make a lot of non-local changes to add a new rule</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-25 22:33</div>
            <div class="timeline-body"><p>@danieleades - So first, here's a PR that you can use as a reference for all the stuff outside of the core rule logic: https://github.com/astral-sh/ruff/pull/9728/files (e.g., the addition of the rule in <code>codes.rs</code>, the addition of a fixture, and so on).</p>
<p>For the rule itself... I'd probably do the following:</p>
<ul>
<li>Set the rule source to <code>noqa</code>: https://github.com/astral-sh/ruff/blob/1711bca4a0c97b809bc4c5b2204bc0da564feb99/crates/ruff_linter/src/registry.rs#L249</li>
<li>In <code>checkers/noqa.rs</code>, there's a <code>noqa_directives</code> struct that contains all the parsed <code># noqa</code> comments. I believe the <code>range</code> on the <code>Directive</code> field of <code>NoqaDirectiveLine</code> starts at the start of the comment. So you could iterate over the entries, pass each one to your rule function, and return a diagnostic if they're not &quot;properly&quot; capitalized: https://github.com/astral-sh/ruff/blob/1711bca4a0c97b809bc4c5b2204bc0da564feb99/crates/ruff_linter/src/checkers/noqa.rs#L34</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 17:44</div>
            <div class="timeline-body"><p>I close this PR considering that there has been no work in a while. @danieleades, feel free to reopen if you're still planning to work on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-03-28 17:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:47:48 UTC
    </footer>
</body>
</html>
