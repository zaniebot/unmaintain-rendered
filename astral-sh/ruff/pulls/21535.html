<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add rule to detect unnecessary class properties - astral-sh/ruff #21535</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add rule to detect unnecessary class properties</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/21535">#21535</a>
        opened by <a href="https://github.com/ShaharNaveh">@ShaharNaveh</a>
        on 2025-11-20 08:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ShaharNaveh">@ShaharNaveh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Fixes https://github.com/astral-sh/ruff/issues/21403</p>
<h2>Test Plan</h2>
<p>Added tests</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-11-20 09:01</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+4 -0 violations, +0 -0 fixes in 2 projects; 53 projects unchanged)</p>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pandas-dev/pandas/blob/53c5e30e7149019d18fcec9e34e62923213500fd/pandas/tests/io/excel/test_writers.py#L1708'>pandas/tests/io/excel/test_writers.py:1708:17:</a> RUF069 `sheets` is a property without a `return` statement
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pytest-dev/pytest">pytest-dev/pytest</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pytest-dev/pytest/blob/94f4922d9a73236d88d637e71316ceb446695158/testing/python/raises.py#L346'>testing/python/raises.py:346:17:</a> RUF069 `__class__` is a property without a `return` statement
+ <a href='https://github.com/pytest-dev/pytest/blob/94f4922d9a73236d88d637e71316ceb446695158/testing/test_compat.py#L117'>testing/test_compat.py:117:13:</a> RUF069 `__class__` is a property without a `return` statement
+ <a href='https://github.com/pytest-dev/pytest/blob/94f4922d9a73236d88d637e71316ceb446695158/testing/test_compat.py#L91'>testing/test_compat.py:91:9:</a> RUF069 `raise_fail_outcome` is a property without a `return` statement
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF069 | 4 | 4 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @ShaharNaveh on 2025-11-20 09:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add rule to detect class properties without a return statement" to "Add rule to detect unnecessary class properties" by @ShaharNaveh on 2025-11-20 11:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @ShaharNaveh on 2025-11-20 11:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @amyreese on 2025-11-20 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/ruff/RUF066.py</code>:3 on 2025-11-20 18:23</div>
            <div class="timeline-body"><p>Would you mind adding inline comments marking each case as okay or an error instead of one comment at the top? That way it will appear in each of the snapshots. That makes it a bit easier to review.</p>
<p>And could you renumber the rule to RUF069? I think we have PRs in flight for <a href="https://github.com/astral-sh/ruff/pull/9911">66</a>, <a href="https://github.com/astral-sh/ruff/pull/20585">67</a>, and <a href="https://github.com/astral-sh/ruff/pull/21079">68</a> already.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:16 on 2025-11-20 18:25</div>
            <div class="timeline-body"><p>Should this apply to yield and raises? I kind of expected it only return to suppress the diagnostic, but maybe yield and raise are more common than I thought.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:11 on 2025-11-20 18:25</div>
            <div class="timeline-body"><p>&quot;Unnecessary&quot; doesn't feel like exactly the right description to me. I think something like <code>property-without-return</code> for the rule name, along the lines of the issue title, might make more sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:106 on 2025-11-20 18:50</div>
            <div class="timeline-body"><p>nit: Can we early return here too, like in <code>visit_expr</code> above?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:109 on 2025-11-20 18:52</div>
            <div class="timeline-body"><p>Ah okay, this probably answers my question above about the raise and yield. I was mostly just curious.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:126 on 2025-11-20 18:55</div>
            <div class="timeline-body"><p>I think it's <em>probably</em> okay to skip this since we bail out of <code>visit_stmt</code> itself, but it's also okay with me either way.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> requested changes on 2025-11-20 19:03</div>
            <div class="timeline-body"><p>Thanks! This looks good to me overall, just some minor nits and a suggestion about the rule name and code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @ntBre on 2025-11-20 19:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> reviewed on 2025-11-21 09:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:16 on 2025-11-21 09:00</div>
            <div class="timeline-body"><p>Raise is more common than yields. The reason why I included <code>yield</code> is because of the ecosystem CI report that showed an <a href="https://github.com/apache/airflow/blob/e9d41dc60d3e88b838b8de6464a1322f2667d078/airflow-core/src/airflow/utils/log/log_stream_accumulator.py#L111-L136">instance where apache-airflow would use <code>yield</code> inside a property called &quot;stream&quot;</a> and that made a lot of sense to me, so I decided to include it.</p>
<p>I can remove the <code>yield</code> inclusion if that's desired</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> reviewed on 2025-11-21 09:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:11 on 2025-11-21 09:02</div>
            <div class="timeline-body"><p>The initial name was something like that, but I decided it's no longer accurate after the inclusion of <code>raise</code> and <code>yield</code>, would you still want me to revert it to the old name?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> reviewed on 2025-11-21 09:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:126 on 2025-11-21 09:37</div>
            <div class="timeline-body"><p>Good catch. I prefer to have less code as possible</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @ntBre by @ShaharNaveh on 2025-11-21 09:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:37 on 2025-11-21 19:29</div>
            <div class="timeline-body"><p>tiny nit since I did a release this morning:</p>
<pre><code class="language-suggestion">#[violation_metadata(preview_since = &quot;0.14.7&quot;)]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:16 on 2025-11-21 19:32</div>
            <div class="timeline-body"><p>Thanks, yeah that makes sense to me. I chatted with @amyreese, and I think it makes sense to her too, so it sounds good to leave all three in the rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unnecessary_property.rs</code>:11 on 2025-11-21 19:35</div>
            <div class="timeline-body"><p>Ah, I see what you mean, but I think it's still okay for the name and diagnostic message only to mention <code>return</code>. @amyreese had a good point that <code>return</code> will probably be the most common fix when the diagnostic fires too, so it seems good to emphasize that option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> requested changes on 2025-11-21 19:37</div>
            <div class="timeline-body"><p>Thank you, this looks great!</p>
<p>I think we just need to bump the <code>preview_since</code> version and update the rule name/docs and this is good to go.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/amyreese">@amyreese</a> on <code>crates/ruff_linter/src/rules/ruff/rules/property_without_return.rs</code>:82 on 2025-11-24 16:45</div>
            <div class="timeline-body"><p>Sorry to add one more change needed. We should pick a smaller range for the diagnostic, rather than throwing a yellow squiggle on an entire function in an editor, as changing the diagnostic range later will potentially be a <a href="https://github.com/astral-sh/ruff/issues/14900#issuecomment-2543923625">breaking change</a>.</p>
<p>I think I'd suggest just marking the <code>@property</code> decorator itself, since that's the part that's unfulfilled by the body of the function.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/amyreese">@amyreese</a> requested changes on 2025-11-24 16:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-11-24 17:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/property_without_return.rs</code>:82 on 2025-11-24 17:49</div>
            <div class="timeline-body"><p>In some cases, we highlight the range of the function's name. You can see other usages by searching for references to the <code>Identifier</code> trait</p>
<p>https://github.com/astral-sh/ruff/blob/9ae698fe30cf3526f0e7ae237b800b3ed19a819f/crates/ruff_python_ast/src/identifier.rs#L18-L21</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> reviewed on 2025-11-25 08:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ShaharNaveh">@ShaharNaveh</a> on <code>crates/ruff_linter/src/rules/ruff/rules/property_without_return.rs</code>:82 on 2025-11-25 08:31</div>
            <div class="timeline-body"><p>Thank you @amyreese &amp; @MichaReiser for the suggestions.</p>
<p>I agree with highlighting only one line instead of the entire function block.</p>
<p>I ended up highlighting only the function name (@MichaReiser suggestion), just because it's a personal preference of mine. LMK if you want me to change that to highlight something else instead</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @ShaharNaveh on 2025-11-25 08:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @amyreese by @ShaharNaveh on 2025-11-25 08:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @ntBre by @ShaharNaveh on 2025-11-25 08:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/amyreese">@amyreese</a> on <code>crates/ruff_linter/src/rules/ruff/rules/property_without_return.rs</code>:46 on 2025-11-25 22:04</div>
            <div class="timeline-body"><p>I think we prefer to put the name in backticks for clarity:</p>
<pre><code class="language-suggestion">        format!(&quot;`{name}` is a property without a `return` statement&quot;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/amyreese">@amyreese</a> approved on 2025-11-25 22:05</div>
            <div class="timeline-body"><p>One last nit, but otherwise looks good to me!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @amyreese by @ShaharNaveh on 2025-11-26 07:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-26 08:24</div>
            <div class="timeline-body"><p>Thanks this looks good. I just noticed that you recoded the rule from RUF066 to RUF069 before. Can you tell me why? It seems to me that RUF066 is still available.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-26 08:26</div>
            <div class="timeline-body"><p>Oh, never mind. It's because there are other in-flight PRs using that code. I recoded it back to RUF066, because I want to avoid holes and your PR is going to land first :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-11-26 08:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @ntBre removed by @MichaReiser on 2025-11-26 08:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @ntBre by @MichaReiser on 2025-11-26 08:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-11-26 08:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-11-26 08:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:17:24 UTC
    </footer>
</body>
</html>
