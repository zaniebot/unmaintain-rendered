<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[flake8-return] Only add return None at end of function (RET503) - astral-sh/ruff #11074</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[flake8-return] Only add return None at end of function (RET503)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11074">#11074</a>
        opened by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a>
        on 2024-04-21 16:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<ul>
<li>Fix #5765</li>
</ul>
<p>In <code>RET503</code> documentation, it is said that it only adds <code>return None</code> at the end of functions.
The current behavior can add <code>return None</code> in multiple place in the function, but not at the end of the function.
This behavior does not match the documentation and goes against other <code>flake8-return</code> rules like <code>RET505</code> and caused people to open #5765.
The new behavior only adds <code>return None</code> at the end of functions like in the documentation and results in more readable code.
The new behavior is only available in preview mode.
The range of <code>RET503</code> is changed to be the entire function, as it will be more clear it concerns the entire function.</p>
<p>Before</p>
<pre><code class="language-python">def main(value: str) -&gt; int | None:
    if value == &quot;one&quot;:
        return 1

    if value.startswith(&quot;do_stuff&quot;):
        print(&quot;doing stuff&quot;)

        if value.endswith(&quot;haha&quot;):
            print(&quot;haha&quot;)
            return None
        else:
            print(&quot;Instruction unclear.&quot;)
            return None
    else:
        print(&quot;Doing nothing.&quot;)
        return None
</code></pre>
<p>After</p>
<pre><code class="language-python">def main(value: str) -&gt; int | None:
    if value == &quot;one&quot;:
        return 1

    if value.startswith(&quot;do_stuff&quot;):
        print(&quot;doing stuff&quot;)

        if value.endswith(&quot;haha&quot;):
            print(&quot;haha&quot;)
        else:
            print(&quot;Instruction unclear.&quot;)
    else:
        print(&quot;Doing nothing.&quot;)
    return None
</code></pre>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>I added a preview snapshot for <code>RET503</code>.
I compared the diff between the <code>RET503</code> stable and preview snapshot.
I checked the ecosystem reports and fixed one regression.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-04-21 16:40</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+124 -134 violations, +0 -0 fixes in 6 projects; 48 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+70 -78 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/io/path.py#L370'>airflow/io/path.py:370:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/io/path.py#L390'>airflow/io/path.py:390:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/jobs/triggerer_job_runner.py#L128'>airflow/jobs/triggerer_job_runner.py:128:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/jobs/triggerer_job_runner.py#L129'>airflow/jobs/triggerer_job_runner.py:129:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/metrics/otel_logger.py#L181'>airflow/metrics/otel_logger.py:181:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/metrics/otel_logger.py#L202'>airflow/metrics/otel_logger.py:202:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/metrics/otel_logger.py#L207'>airflow/metrics/otel_logger.py:207:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/metrics/otel_logger.py#L228'>airflow/metrics/otel_logger.py:228:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/models/dag.py#L3958'>airflow/models/dag.py:3958:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/models/dag.py#L3959'>airflow/models/dag.py:3959:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/models/param.py#L268'>airflow/models/param.py:268:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/models/param.py#L271'>airflow/models/param.py:271:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/executors/ecs/ecs_executor.py#L273'>airflow/providers/amazon/aws/executors/ecs/ecs_executor.py:273:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/executors/ecs/ecs_executor.py#L284'>airflow/providers/amazon/aws/executors/ecs/ecs_executor.py:284:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/executors/ecs/ecs_executor.py#L285'>airflow/providers/amazon/aws/executors/ecs/ecs_executor.py:285:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/operators/emr.py#L1412'>airflow/providers/amazon/aws/operators/emr.py:1412:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/operators/emr.py#L1415'>airflow/providers/amazon/aws/operators/emr.py:1415:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/operators/eventbridge.py#L61'>airflow/providers/amazon/aws/operators/eventbridge.py:61:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/amazon/aws/operators/eventbridge.py#L82'>airflow/providers/amazon/aws/operators/eventbridge.py:82:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L347'>airflow/providers/apache/beam/operators/beam.py:347:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L365'>airflow/providers/apache/beam/operators/beam.py:365:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L369'>airflow/providers/apache/beam/operators/beam.py:369:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L403'>airflow/providers/apache/beam/operators/beam.py:403:17:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L540'>airflow/providers/apache/beam/operators/beam.py:540:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L553'>airflow/providers/apache/beam/operators/beam.py:553:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L557'>airflow/providers/apache/beam/operators/beam.py:557:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L605'>airflow/providers/apache/beam/operators/beam.py:605:17:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/airflow/blob/fcc9f3dc0eb0b9c53f59bbe6619a175779db2cbc/airflow/providers/apache/beam/operators/beam.py#L734'>airflow/providers/apache/beam/operators/beam.py:734:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
... 120 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/superset">apache/superset</a> (+3 -3 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/superset/blob/f5d614d80d560adacb35f171568115dfd082098c/superset/migrations/versions/2018-07-05_15-19_3dda56f1c4c6_migrate_num_period_compare_and_period_.py#L112'>superset/migrations/versions/2018-07-05_15-19_3dda56f1c4c6_migrate_num_period_compare_and_period_.py:112:1:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/superset/blob/f5d614d80d560adacb35f171568115dfd082098c/superset/migrations/versions/2018-07-05_15-19_3dda56f1c4c6_migrate_num_period_compare_and_period_.py#L129'>superset/migrations/versions/2018-07-05_15-19_3dda56f1c4c6_migrate_num_period_compare_and_period_.py:129:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/superset/blob/f5d614d80d560adacb35f171568115dfd082098c/tests/integration_tests/utils/hashing_tests.py#L59'>tests/integration_tests/utils/hashing_tests.py:59:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/superset/blob/f5d614d80d560adacb35f171568115dfd082098c/tests/integration_tests/utils/hashing_tests.py#L60'>tests/integration_tests/utils/hashing_tests.py:60:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/apache/superset/blob/f5d614d80d560adacb35f171568115dfd082098c/tests/unit_tests/queries/query_object_test.py#L103'>tests/unit_tests/queries/query_object_test.py:103:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/apache/superset/blob/f5d614d80d560adacb35f171568115dfd082098c/tests/unit_tests/queries/query_object_test.py#L104'>tests/unit_tests/queries/query_object_test.py:104:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+43 -48 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/server/app/clustering/main.py#L82'>examples/server/app/clustering/main.py:82:1:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/examples/server/app/clustering/main.py#L83'>examples/server/app/clustering/main.py:83:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L314'>src/bokeh/core/has_props.py:314:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L340'>src/bokeh/core/has_props.py:340:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L342'>src/bokeh/core/has_props.py:342:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L367'>src/bokeh/core/has_props.py:367:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L386'>src/bokeh/core/serialization.py:386:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L409'>src/bokeh/core/serialization.py:409:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L438'>src/bokeh/core/serialization.py:438:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L469'>src/bokeh/core/serialization.py:469:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L530'>src/bokeh/core/serialization.py:530:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L562'>src/bokeh/core/serialization.py:562:21:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L572'>src/bokeh/core/serialization.py:572:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L578'>src/bokeh/core/serialization.py:578:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L710'>src/bokeh/core/serialization.py:710:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L717'>src/bokeh/core/serialization.py:717:17:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/serialization.py#L723'>src/bokeh/core/serialization.py:723:17:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
... 74 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/ibis-project/ibis/blob/1d64e585dba093b1d030cdd5c280c6d55a1dc997/ibis/backends/duckdb/__init__.py#L520'>ibis/backends/duckdb/__init__.py:520:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/ibis-project/ibis/blob/1d64e585dba093b1d030cdd5c280c6d55a1dc997/ibis/backends/duckdb/__init__.py#L578'>ibis/backends/duckdb/__init__.py:578:39:</a> RUF100 Unused `noqa` directive (unused: `RET503`)
+ <a href='https://github.com/ibis-project/ibis/blob/1d64e585dba093b1d030cdd5c280c6d55a1dc997/ibis/backends/pyspark/__init__.py#L864'>ibis/backends/pyspark/__init__.py:864:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/ibis-project/ibis/blob/1d64e585dba093b1d030cdd5c280c6d55a1dc997/ibis/backends/pyspark/__init__.py#L910'>ibis/backends/pyspark/__init__.py:910:39:</a> RUF100 Unused `noqa` directive (unused: `RET503`)
</pre>

</p>
</details>
<details><summary><a href="https://github.com/milvus-io/pymilvus">milvus-io/pymilvus</a> (+1 -1 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/milvus-io/pymilvus/blob/66c23629cca718f4dc685d9a9efa31a207ea2442/_version_helper.py#L41'>_version_helper.py:41:1:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/milvus-io/pymilvus/blob/66c23629cca718f4dc685d9a9efa31a207ea2442/_version_helper.py#L42'>_version_helper.py:42:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+3 -4 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/lib/addressee.py#L137'>zerver/lib/addressee.py:137:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/lib/addressee.py#L96'>zerver/lib/addressee.py:96:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/tests/test_import_export.py#L1606'>zerver/tests/test_import_export.py:1606:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/tests/test_import_export.py#L1609'>zerver/tests/test_import_export.py:1609:17:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
+ <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/tests/test_openapi.py#L456'>zerver/tests/test_openapi.py:456:5:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/tests/test_openapi.py#L535'>zerver/tests/test_openapi.py:535:9:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
- <a href='https://github.com/zulip/zulip/blob/07c927ae884445935c19c427fa4f882faddc96d5/zerver/tests/test_openapi.py#L536'>zerver/tests/test_openapi.py:536:13:</a> RET503 Missing explicit `return` at the end of function able to return non-`None` value
</pre>

</p>
</details>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RET503 | 256 | 122 | 134 | 0 | 0 |
| RUF100 | 2 | 2 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-04-22 14:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> reviewed on 2024-04-24 16:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on <code>crates/ruff_linter/src/rules/flake8_return/rules/function.rs</code>:482 on 2024-04-24 16:32</div>
            <div class="timeline-body"><p>Early return if in preview mode because we only need to know if the function has at least one implicit return to add a single <code>return None</code> at the end of the function.
The stable version can add multiple return so it cannot return early.
The code should be simplified once the preview version become stable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2024-04-24 16:33</div>
            <div class="timeline-body"><p>A comment should be added that when the preview version becomes stable the code can be simplified with early return everywhere.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2024-06-27 13:03</div>
            <div class="timeline-body"><p>Will it be included in Ruff 0.5.0?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-27 15:05</div>
            <div class="timeline-body"><blockquote>
<p>Will it be included in Ruff 0.5.0?</p>
</blockquote>
<p>Just seen this -- unfortunately I just set the release workflow in motion, so unfortunately not. Sorry :-(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2024-06-27 15:16</div>
            <div class="timeline-body"><p>No worries.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2024-08-13 12:15</div>
            <div class="timeline-body"><p>Will it be included in Ruff 0.6.0?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2024-08-13 15:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @MichaReiser on 2024-08-13 15:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2024-08-13 15:34</div>
            <div class="timeline-body"><h2><a href="https://codspeed.io/astral-sh/ruff/branches/JonathanPlasse:ret503-only-add-return-at-end-of-function">CodSpeed Performance Report</a></h2>
<h3>Merging #11074 will <strong>not alter performance</strong></h3>
<p><sub>Comparing <code>JonathanPlasse:ret503-only-add-return-at-end-of-function</code> (4e575bc) with <code>main</code> (2520ebb)</sub></p>
<h3>Summary</h3>
<p><code>✅ 32</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-13 15:44</div>
            <div class="timeline-body"><p>I don't think this requires a minor release, considering that the change is gated behind preview mode.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-08-13 15:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_return/rules/function.rs</code>:563 on 2024-08-13 15:47</div>
            <div class="timeline-body"><p>I don't have a great solution but I do find it a bit surprising that <code>has_implicit_return</code> adds diagnostics in the non preview mode.</p>
<p>I'm somewhat inclined to duplicate the logic between preview and non-preview mode. That should also make it much easier when stabilizing the new behavior (and it's not that much code that needs copying). Unless you see a way of how we can avoid the side-effects of <code>has_implicit_return</code> in stable (e.g. could it return a <code>Vec</code> with all the statements for which diagnostics should be added?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-08-13 19:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_return/rules/function.rs</code>:563 on 2024-08-13 19:54</div>
            <div class="timeline-body"><p>I don't mind going ahead with the PR as is but I'm interested to hear what you think of duplicating the logic OR maybe you have another idea to make this a bit clearer</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> reviewed on 2024-08-14 06:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on <code>crates/ruff_linter/src/rules/flake8_return/rules/function.rs</code>:563 on 2024-08-14 06:01</div>
            <div class="timeline-body"><p>I used the <code>Vec</code> solution to remove the side effects.
The code is nicer.
Thank you for suggesting it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-08-14 07:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_return/rules/function.rs</code>:563 on 2024-08-14 07:42</div>
            <div class="timeline-body"><p>Thanks. Will merge now and sorry for the long wait</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-08-14 07:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-08-14 07:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-08-14 09:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> reviewed on 2024-08-14 10:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on <code>crates/ruff_linter/src/rules/flake8_return/rules/function.rs</code>:563 on 2024-08-14 10:04</div>
            <div class="timeline-body"><p>You are welcome</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:03:55 UTC
    </footer>
</body>
</html>
