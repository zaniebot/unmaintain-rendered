<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fix(ERA001): detect commented out `case` statements, add more one-line support - astral-sh/ruff #10055</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fix(ERA001): detect commented out <code>case</code> statements, add more one-line support</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10055">#10055</a>
        opened by <a href="https://github.com/ottaviohartman">@ottaviohartman</a>
        on 2024-02-20 00:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on 2024-02-20 00:28</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Closes #10031</p>
<ul>
<li>Detect commented out <code>case</code> statements. Playground repro: https://play.ruff.rs/5a305aa9-6e5c-4fa4-999a-8fc427ab9a23</li>
<li>Add more support for one-line commented out code.</li>
</ul>
<h2>Test Plan</h2>
<p>Unit tested and tested with</p>
<pre><code class="language-sh">cargo run -p ruff -- check crates/ruff_linter/resources/test/fixtures/eradicate/ERA001.py --no-cache --preview --select ERA001
</code></pre>
<p>TODO:</p>
<ul>
<li>[x] <code>cargo insta test</code></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-20 00:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/eradicate/rules/commented_out_code.rs</code>:51 on 2024-02-20 00:29</div>
            <div class="timeline-body"><p>Was this change intentional? Just checking.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-20 00:29</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 00:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 00:30</div>
            <div class="timeline-body"><p>note: this group ends with <code>.*</code> to detect the one-line case:</p>
<pre><code class="language-python">case &quot;hi&quot;: print()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 00:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/rules/commented_out_code.rs</code>:51 on 2024-02-20 00:30</div>
            <div class="timeline-body"><p>Yes, but I can revert! Just was a style lint in VSCode</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-20 00:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 00:32</div>
            <div class="timeline-body"><p>I feel like the other cases don't catch that -- can you try to add a test case with <code>try</code> followed by a one-line body?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 00:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 00:34</div>
            <div class="timeline-body"><p>Yep - I think this will catch more non-code statements though like &quot;to try: use iterators&quot; or something. I'll write some tests to see</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 00:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 00:38</div>
            <div class="timeline-body"><p>Ok seems to work well, should I add <code>.*</code> for all of the cases, and add tests?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "fix(ERA001): detect commented out case statements" to "fix(ERA001): detect commented out `case` statements, add more one-line support" by @ottaviohartman on 2024-02-20 00:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @ottaviohartman on 2024-02-20 00:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-20 02:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 02:34</div>
            <div class="timeline-body"><p>Let's remove the trailing <code>.*</code> from this PR, and we can open a separate PR to add <code>.*</code> to all of the cases. It'll make it easier to approve and merge these as separate changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 03:05</div>
            <div class="timeline-body"><p>Cool will do</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 03:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-20 03:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 03:17</div>
            <div class="timeline-body"><p>Ah sorry, I meant the opposite: can we remove the <code>.*</code> from here, so that we don't support one-line for <em>any</em> of the patterns (like before this PR), and then open a separate PR that adds the <code>.*</code> to all of them at once?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 03:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 03:21</div>
            <div class="timeline-body"><p>Yep, that's what I understood you to mean! I'll do that and open an issue to add <code>.*</code> in another PR</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ottaviohartman">@ottaviohartman</a> reviewed on 2024-02-20 03:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 03:48</div>
            <div class="timeline-body"><p>Done! Ticket opened, I'll open that PR next.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-02-20 03:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-20 03:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-20 03:56</div>
            <div class="timeline-body"><p>Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-20 03:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/eradicate/detection.rs</code>:29 on 2024-02-20 03:57</div>
            <div class="timeline-body"><blockquote>
<p>Yep, that's what I understood you to mean! I'll do that and open an issue to add .* in another PR</p>
</blockquote>
<p>(Oops, sorry, I think I was looking at the code, and thought you'd already pushed!)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:58:19 UTC
    </footer>
</body>
</html>
