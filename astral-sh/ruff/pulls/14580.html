<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] `l.extend([e])` (`RUF043`) - astral-sh/ruff #14580</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] <code>l.extend([e])</code> (<code>RUF043</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14580">#14580</a>
        opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a>
        on 2024-11-25 06:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Resolves #14518.</p>
<h2>Test Plan</h2>
<p><code>cargo nextest run</code> and <code>cargo insta test</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-25 06:42</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+23 -0 violations, +0 -0 fixes in 6 projects; 49 projects unchanged)</p>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/tests/core/actions/test_forms.py#L364'>tests/core/actions/test_forms.py:364:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+16 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/taskinstance.py#L2062'>airflow/models/taskinstance.py:2062:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/taskinstance.py#L2064'>airflow/models/taskinstance.py:2064:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/taskinstance.py#L2066'>airflow/models/taskinstance.py:2066:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/taskinstance.py#L2072'>airflow/models/taskinstance.py:2072:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/taskinstance.py#L2074'>airflow/models/taskinstance.py:2074:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/taskinstance.py#L2078'>airflow/models/taskinstance.py:2078:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/breeze/src/airflow_breeze/utils/docker_command_utils.py#L346'>dev/breeze/src/airflow_breeze/utils/docker_command_utils.py:346:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/breeze/src/airflow_breeze/utils/docker_command_utils.py#L351'>dev/breeze/src/airflow_breeze/utils/docker_command_utils.py:351:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/breeze/src/airflow_breeze/utils/docker_command_utils.py#L358'>dev/breeze/src/airflow_breeze/utils/docker_command_utils.py:358:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/breeze/src/airflow_breeze/utils/docker_command_utils.py#L415'>dev/breeze/src/airflow_breeze/utils/docker_command_utils.py:415:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/breeze/src/airflow_breeze/utils/docker_command_utils.py#L418'>dev/breeze/src/airflow_breeze/utils/docker_command_utils.py:418:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/breeze/src/airflow_breeze/utils/docker_command_utils.py#L542'>dev/breeze/src/airflow_breeze/utils/docker_command_utils.py:542:9:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/docs/conf.py#L210'>docs/conf.py:210:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/cloud/hooks/cloud_sql.py#L697'>providers/src/airflow/providers/google/cloud/hooks/cloud_sql.py:697:9:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/tests/microsoft/psrp/operators/test_psrp.py#L112'>providers/tests/microsoft/psrp/operators/test_psrp.py:112:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/scripts/ci/pre_commit/mypy_folder.py#L68'>scripts/ci/pre_commit/mypy_folder.py:68:5:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/util/structure.py#L242'>src/bokeh/models/util/structure.py:242:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/models/util/structure.py#L243'>src/bokeh/models/util/structure.py:243:13:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/lib/tex.py#L78'>zerver/lib/tex.py:78:9:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pytest-dev/pytest">pytest-dev/pytest</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pytest-dev/pytest/blob/acf130311806cb1a627ea0e21369c7d6f586663a/testing/logging/test_reporting.py#L1020'>testing/logging/test_reporting.py:1020:9:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
</pre>

</p>
</details>
<details><summary><a href="https://github.com/astropy/astropy">astropy/astropy</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/astropy/astropy/blob/4e3ad4b94f5183a8c78cc0c6ee636c6a224dc14b/astropy/modeling/fitting.py#L2011'>astropy/modeling/fitting.py:2011:21:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
+ <a href='https://github.com/astropy/astropy/blob/4e3ad4b94f5183a8c78cc0c6ee636c6a224dc14b/astropy/modeling/fitting.py#L2074'>astropy/modeling/fitting.py:2074:21:</a> RUF043 [*] Literal iterable with single item in `list.extend()` call
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF043 | 23 | 23 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-11-25 07:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-11-25 07:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-27 10:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/mod.rs</code>:409 on 2024-11-27 10:10</div>
            <div class="timeline-body"><p>Nit: I would prefer a slightly longer name, maybe <code>list-extend-single-item-iterable</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-27 10:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/list_extend_single.rs</code>:74 on 2024-11-27 10:10</div>
            <div class="timeline-body"><pre><code class="language-suggestion">fn list_extend_call_with_one_argument&lt;'a&gt;(
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/list_extend_single.rs</code>:63 on 2024-11-27 10:10</div>
            <div class="timeline-body"><pre><code class="language-suggestion">    let list_ref_expr = locator.slice(list_ref);
    let item_expr = locator.slice(item);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/list_extend_single.rs</code>:67 on 2024-11-27 10:11</div>
            <div class="timeline-body"><p>Nit: We should mark this fix as unsafe if the edit range contains comments.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-27 10:13</div>
            <div class="timeline-body"><p>This overall looks good to me. I also tested if there would be many more violations when removing the type-checking guard, which isn't the case.</p>
<p>The original issue also mentions that they would like to handle the following cases</p>
<pre><code>retval.extend([x, y])
retval.append(v)
retval.extend([z, w])
</code></pre>
<p>Is it an intentional decision to exclude those from this rule and if so, what's your reasoning?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2024-11-27 12:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/ruff/mod.rs</code>:409 on 2024-11-27 12:35</div>
            <div class="timeline-body"><p>Done. This rule's name is similar to <a href="https://github.com/astral-sh/ruff/pull/14564"><code>RUF042</code></a>'s. I'll rename that one too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2024-11-27 12:41</div>
            <div class="timeline-body"><p>@MichaReiser This rule is call-based, whereas that pattern requires a statements-based rule. There are also tricky cases like this one:</p>
<pre><code class="language-python"># Should this first line be included in the diagnostic?
l.extend({a, b})  # Append only unique elements
l.append([c])
l.extend([d, e])

# What about this?
l.append([a])
l.extend({b, c})  # Append only unique elements
l.extend([d, e])
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-27 13:07</div>
            <div class="timeline-body"><p>That makes sense. But I don't think the scope of a rule should mainly be defined by how it's implemented.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2024-11-27 13:18</div>
            <div class="timeline-body"><p>Also consider this case, where there are no <code>.extend([single])</code> at all:</p>
<pre><code class="language-python">l.extend([0, 1])
l.extend([2, 3])
l.extend([4, 5])
</code></pre>
<p>I would prefer to keep this rule simple and defer the consecutive-calls pattern to another rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @InSyncWithFoo on 2024-12-08 00:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-12-08 00:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:07:59 UTC
    </footer>
</body>
</html>
