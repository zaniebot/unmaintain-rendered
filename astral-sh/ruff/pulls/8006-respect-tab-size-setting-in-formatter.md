```yaml
number: 8006
title: "Respect `tab-size` setting in formatter"
type: pull_request
state: merged
author: MichaReiser
labels:
  - configuration
  - formatter
assignees: []
merged: true
base: main
head: formatter-respect-tab-size
created_at: 2023-10-17T10:17:25Z
updated_at: 2023-10-20T07:12:14Z
url: https://github.com/astral-sh/ruff/pull/8006
synced_at: 2026-01-12T15:55:25Z
```

# Respect `tab-size` setting in formatter

---

_@MichaReiser_

## Summary

This PR changes the formatter to use the global `tab-size` to configure the number of spaces used for soft-tabs or width of a hard-tab character. 

Closes https://github.com/astral-sh/ruff/issues/7648

## Open Questions

I'm still somewhat undecided whether we should support changing the number of spaces for soft tabs. I only found few projects that set `tab-size = 2` or `pyink-indentation = 2`. 
But we may as well support it for as long as we default to 4 spaces. 

## Test Plan

Changed integration test


---

_Comment by @MichaReiser on 2023-10-17 10:17_

Current dependencies on/for this PR:
* main
  * **PR #8000** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8000" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
    * **PR #8002** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8002" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
      * **PR #8032** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8032" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
      * **PR #8006** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8006" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ
        * **PR #8035** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8035" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
          * **PR #8010** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8010" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
            * **PR #8082** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8082" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
              * **PR #8088** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8088" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
            * **PR #8039** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8039" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
        * **PR #8031** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8031" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/8006?utm_source=stack-comment).

---

_Review requested from @charliermarsh by @MichaReiser on 2023-10-17 10:17_

---

_Review requested from @konstin by @MichaReiser on 2023-10-17 10:17_

---

_Review request for @konstin removed by @MichaReiser on 2023-10-17 10:17_

---

_Review requested from @zanieb by @MichaReiser on 2023-10-17 10:17_

---

_Label `configuration` added by @MichaReiser on 2023-10-17 10:17_

---

_Label `formatter` added by @MichaReiser on 2023-10-17 10:17_

---

_Comment by @github-actions[bot] on 2023-10-18 06:45_

## PR Check Results
### Ecosystem
âœ… ecosystem check detected no changes.



---

_@charliermarsh approved on 2023-10-18 13:49_

Cool, so this both respects the tab width for tab-based indentation and allows changing the number of spaces?

---

_Comment by @eli-schwartz on 2023-10-18 22:30_

Maybe this should look at `.editorconfig` as well?

---

_Comment by @MichaReiser on 2023-10-18 23:47_

> Cool, so this both respects the tab width for tab-based indentation and allows changing the number of spaces?

That's correct. It's the one setting that configures the indentation. 

> Maybe this should look at `.editorconfig` as well?

We may want to support a `ruff init` command eventually that copies the relevant settings from the `editorconfig`. We want to avoid reading the editorconfig ourselves because it then becomes unclear how it would interact with configuration inheritance and it slows down the file traversal (because it increases the number of configuration files that ruff needs to probe for every directory)

---

_Merged by @MichaReiser on 2023-10-18 23:48_

---

_Closed by @MichaReiser on 2023-10-18 23:48_

---

_Branch deleted on 2023-10-18 23:48_

---

_Comment by @NeilGirdhar on 2023-10-20 07:10_

> I'm still somewhat undecided whether we should support changing the number of spaces for soft tabs. I only found few projects that set `tab-size = 2`

Do you mean editor-config's indent size?  If so, Google's Python style guide has it set to two.  So that's practically every Google project.

---

_Comment by @MichaReiser on 2023-10-20 07:12_

> > I'm still somewhat undecided whether we should support changing the number of spaces for soft tabs. I only found few projects that set `tab-size = 2`
> 
> Do you mean editor-config's indent size? If so, Google's Python style guide has it set to two. So that's practically every Google project.

Yes, that's what I was considering. We decided to support configuring the number of spaces. 

---
