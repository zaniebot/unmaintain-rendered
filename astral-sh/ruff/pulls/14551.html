<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`perflint`] - Fix `manual-list-comprehension` for async generators (`PERF401`) - astral-sh/ruff #14551</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>perflint</code>] - Fix <code>manual-list-comprehension</code> for async generators (<code>PERF401</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14551">#14551</a>
        opened by <a href="https://github.com/diceroll123">@diceroll123</a>
        on 2024-11-23 02:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/diceroll123">@diceroll123</a> on 2024-11-23 02:52</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Fixes a current bug in PERF401's preview autofix, where it tries to make an async generator within a list.extend, without wrapping the generator in a list, which does not implement <code>__iter__</code> which makes it an error.</p>
<h2>Test Plan</h2>
<p><code>cargo test</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-23 02:59</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>âœ… ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>âœ… ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/diceroll123">@diceroll123</a> on 2024-11-23 07:10</div>
            <div class="timeline-body"><p><a href="https://play.ruff.rs/9d4b2182-b10b-4c1f-a584-4b40999e90c0">Found a weird issue with comments</a>, this was already present in the autofix in <code>0.8.0</code>, but I decided to fix it and put it in here too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2024-11-23 16:41</div>
            <div class="timeline-body"><p>@w0nder1ng Another edge case. May want to merge this PR with #14369</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/diceroll123">@diceroll123</a> on 2024-11-23 22:53</div>
            <div class="timeline-body"><p>Hm, yeah, my implementation does not do well with this one:</p>
<pre><code class="language-py">def f():
    # make sure that `tmp` is not deleted
    tmp = 1; result = [] # commment should be protected
    for i in range(10):
        result.append(i + 1) # PERF401
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @dylwil3 on 2024-11-26 15:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @dylwil3 on 2024-11-26 15:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-12 08:12</div>
            <div class="timeline-body"><p>@diceroll123 #14369 is now merged. Would you mind rebasing your PR?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> requested changes on 2024-12-12 08:13</div>
            <div class="timeline-body"><p>Needs rebase</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/diceroll123">@diceroll123</a> on 2025-01-15 10:18</div>
            <div class="timeline-body"><p>Woop, destroyed the commit here by accident, but after fixing it locally and coming back from rebase hell, it turns out all of the issues my PR solved were solved by 14369, so I'll close this. Thanks all! ðŸ˜„</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @diceroll123 on 2025-01-15 10:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 10:50</div>
            <div class="timeline-body"><p>Thank you and sorry for the rebase struggles</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 20:34:29 UTC
    </footer>
</body>
</html>
