<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Improve rendering of default values for function args - astral-sh/ruff #22010</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Improve rendering of default values for function args</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22010">#22010</a>
        opened by <a href="https://github.com/Gankra">@Gankra</a>
        on 2025-12-16 17:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-16 17:31</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>We're actually quite good at computing this but the main issue is just that we compute it at the type-level and so wrap it in <code>Literal[...]</code>. So just special-case the rendering of these to omit <code>Literal[...]</code> and fallback to <code>...</code> in cases where the thing we'll show is probably useless (i.e. <code>x: str = str</code>).</p>
<p>Fixes https://github.com/astral-sh/ty/issues/1882</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @Gankra on 2025-12-16 17:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-16 17:32</div>
            <div class="timeline-body"><p>Having now implemented the fallback I think I should probably just land only the fallback and rip out the explicit support for default_value. This would mostly only harm stuff like <code>=sys.maxsize</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-16 17:34</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance">typing conformance tests</a></h2>
<details>
<summary>Changes were detected when running ty on typing conformance tests</summary>

<pre><code class="language-diff">--- old-output.txt	2025-12-16 18:07:49.056442460 +0000
+++ new-output.txt	2025-12-16 18:07:52.556461989 +0000
@@ -137,7 +137,7 @@
 callables_kwargs.py:64:11: error[invalid-argument-type] Argument to function `func2` is incorrect: Expected `str`, found `Literal[1]`
 callables_kwargs.py:64:14: error[parameter-already-assigned] Multiple values provided for parameter `v3` of function `func2`
 callables_kwargs.py:103:19: error[invalid-assignment] Object of type `def func1(**kwargs: @Todo(`Unpack[]` special form)) -&gt; None` is not assignable to `TDProtocol5`
-callables_kwargs.py:134:19: error[invalid-assignment] Object of type `def func7(*, v1: int, v3: str, v2: str = Literal[&quot;&quot;]) -&gt; None` is not assignable to `TDProtocol6`
+callables_kwargs.py:134:19: error[invalid-assignment] Object of type `def func7(*, v1: int, v3: str, v2: str = &quot;&quot;) -&gt; None` is not assignable to `TDProtocol6`
 callables_protocol.py:35:7: error[invalid-assignment] Object of type `def cb1_bad1(*vals: bytes, *, max_items: int | None) -&gt; list[bytes]` is not assignable to `Proto1`
 callables_protocol.py:36:7: error[invalid-assignment] Object of type `def cb1_bad2(*vals: bytes) -&gt; list[bytes]` is not assignable to `Proto1`
 callables_protocol.py:37:7: error[invalid-assignment] Object of type `def cb1_bad3(*vals: bytes, *, max_len: str | None) -&gt; list[bytes]` is not assignable to `Proto1`

</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-16 17:35</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">attrs (https://github.com/python-attrs/attrs)
- src/attr/validators.py:175:24: error[invalid-argument-type] Argument to function `sorted` is incorrect: Argument type `((Overload[(pattern: str | Pattern[str], string: str, flags: int = Literal[0]) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = Literal[0]) -&gt; Match[bytes] | None]) &amp; ~AlwaysTruthy &amp; ~AlwaysFalsy) | (str &amp; ~AlwaysFalsy)` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
+ src/attr/validators.py:175:24: error[invalid-argument-type] Argument to function `sorted` is incorrect: Argument type `((Overload[(pattern: str | Pattern[str], string: str, flags: int = 0) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = 0) -&gt; Match[bytes] | None]) &amp; ~AlwaysTruthy &amp; ~AlwaysFalsy) | (str &amp; ~AlwaysFalsy)` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
- tests/test_validators.py:185:68: error[invalid-argument-type] Argument to function `matches_re` is incorrect: Expected `((str | bytes, str | bytes, int, /) -&gt; Match[str | bytes] | None) | None`, found `Overload[(pattern: str | Pattern[str], string: str, flags: int = Literal[0]) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = Literal[0]) -&gt; Match[bytes] | None]`
+ tests/test_validators.py:185:68: error[invalid-argument-type] Argument to function `matches_re` is incorrect: Expected `((str | bytes, str | bytes, int, /) -&gt; Match[str | bytes] | None) | None`, found `Overload[(pattern: str | Pattern[str], string: str, flags: int = 0) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = 0) -&gt; Match[bytes] | None]`
- tests/test_validators.py:219:56: error[invalid-argument-type] Argument to function `matches_re` is incorrect: Expected `((str | bytes, str | bytes, int, /) -&gt; Match[str | bytes] | None) | None`, found `Overload[(pattern: str | Pattern[str], string: str, flags: int = Literal[0]) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = Literal[0]) -&gt; Match[bytes] | None]`
+ tests/test_validators.py:219:56: error[invalid-argument-type] Argument to function `matches_re` is incorrect: Expected `((str | bytes, str | bytes, int, /) -&gt; Match[str | bytes] | None) | None`, found `Overload[(pattern: str | Pattern[str], string: str, flags: int = 0) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = 0) -&gt; Match[bytes] | None]`
- typing-examples/mypy.py:250:64: error[invalid-argument-type] Argument to function `matches_re` is incorrect: Expected `((str | bytes, str | bytes, int, /) -&gt; Match[str | bytes] | None) | None`, found `Overload[(pattern: str | Pattern[str], string: str, flags: int = Literal[0]) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = Literal[0]) -&gt; Match[bytes] | None]`
+ typing-examples/mypy.py:250:64: error[invalid-argument-type] Argument to function `matches_re` is incorrect: Expected `((str | bytes, str | bytes, int, /) -&gt; Match[str | bytes] | None) | None`, found `Overload[(pattern: str | Pattern[str], string: str, flags: int = 0) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = 0) -&gt; Match[bytes] | None]`

spack (https://github.com/spack/spack)
- lib/spack/spack/vendor/attr/validators.py:186:25: error[invalid-argument-type] Argument to function `sorted` is incorrect: Argument type `((Overload[(pattern: str | Pattern[str], string: str, flags: int = Literal[0]) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = Literal[0]) -&gt; Match[bytes] | None]) &amp; ~AlwaysTruthy &amp; ~AlwaysFalsy) | (str &amp; ~AlwaysFalsy)` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
+ lib/spack/spack/vendor/attr/validators.py:186:25: error[invalid-argument-type] Argument to function `sorted` is incorrect: Argument type `((Overload[(pattern: str | Pattern[str], string: str, flags: int = 0) -&gt; Match[str] | None, (pattern: bytes | Pattern[bytes], string: Buffer, flags: int = 0) -&gt; Match[bytes] | None]) &amp; ~AlwaysTruthy &amp; ~AlwaysFalsy) | (str &amp; ~AlwaysFalsy)` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
- lib/spack/spack/vendor/typing_extensions.py:1119:5: error[unresolved-attribute] Unresolved attribute `__text_signature__` on type `def _typeddict_new(*args, *, total=Literal[True], **kwargs) -&gt; Unknown`.
+ lib/spack/spack/vendor/typing_extensions.py:1119:5: error[unresolved-attribute] Unresolved attribute `__text_signature__` on type `def _typeddict_new(*args, *, total=True, **kwargs) -&gt; Unknown`.

pip (https://github.com/pypa/pip)
- src/pip/_vendor/idna/codec.py:114:9: error[invalid-argument-type] Argument to function `__new__` is incorrect: Expected `_Decoder`, found `bound method Codec.decode(data: bytes, errors: str = Literal[&quot;strict&quot;]) -&gt; tuple[str, int]`
+ src/pip/_vendor/idna/codec.py:114:9: error[invalid-argument-type] Argument to function `__new__` is incorrect: Expected `_Decoder`, found `bound method Codec.decode(data: bytes, errors: str = &quot;strict&quot;) -&gt; tuple[str, int]`

bandersnatch (https://github.com/pypa/bandersnatch)
- src/bandersnatch/tests/test_master.py:173:5: error[unresolved-attribute] Object of type `bound method Master.rpc(method_name: str, serial: int = Literal[0]) -&gt; CoroutineType[Any, Any, Any]` has no attribute `assert_called_once_with`
+ src/bandersnatch/tests/test_master.py:173:5: error[unresolved-attribute] Object of type `bound method Master.rpc(method_name: str, serial: int = 0) -&gt; CoroutineType[Any, Any, Any]` has no attribute `assert_called_once_with`
- src/bandersnatch/tests/test_master.py:239:5: error[unresolved-attribute] Object of type `bound method Master.rpc(method_name: str, serial: int = Literal[0]) -&gt; CoroutineType[Any, Any, Any]` has no attribute `assert_called_once_with`
+ src/bandersnatch/tests/test_master.py:239:5: error[unresolved-attribute] Object of type `bound method Master.rpc(method_name: str, serial: int = 0) -&gt; CoroutineType[Any, Any, Any]` has no attribute `assert_called_once_with`
- src/bandersnatch/tests/test_package.py:31:12: error[unresolved-attribute] Object of type `bound method Master.get_package_metadata(package_name: str, serial: int = Literal[0]) -&gt; CoroutineType[Any, Any, Any]` has no attribute `await_count`
+ src/bandersnatch/tests/test_package.py:31:12: error[unresolved-attribute] Object of type `bound method Master.get_package_metadata(package_name: str, serial: int = 0) -&gt; CoroutineType[Any, Any, Any]` has no attribute `await_count`
- src/bandersnatch/tests/test_package.py:58:12: error[unresolved-attribute] Object of type `bound method Master.get_package_metadata(package_name: str, serial: int = Literal[0]) -&gt; CoroutineType[Any, Any, Any]` has no attribute `await_count`
+ src/bandersnatch/tests/test_package.py:58:12: error[unresolved-attribute] Object of type `bound method Master.get_package_metadata(package_name: str, serial: int = 0) -&gt; CoroutineType[Any, Any, Any]` has no attribute `await_count`

asynq (https://github.com/quora/asynq)
- asynq/mock_.py:96:1: error[unresolved-attribute] Unresolved attribute `object` on type `def patch(target, new=Any, spec=None, create=Literal[False], mocksignature=Literal[False], spec_set=None, autospec=Literal[False], new_callable=None, **kwargs) -&gt; Unknown`.
+ asynq/mock_.py:96:1: error[unresolved-attribute] Unresolved attribute `object` on type `def patch(target, new=..., spec=None, create=False, mocksignature=False, spec_set=None, autospec=False, new_callable=None, **kwargs) -&gt; Unknown`.
- asynq/mock_.py:98:1: error[unresolved-attribute] Unresolved attribute `dict` on type `def patch(target, new=Any, spec=None, create=Literal[False], mocksignature=Literal[False], spec_set=None, autospec=Literal[False], new_callable=None, **kwargs) -&gt; Unknown`.
+ asynq/mock_.py:98:1: error[unresolved-attribute] Unresolved attribute `dict` on type `def patch(target, new=..., spec=None, create=False, mocksignature=False, spec_set=None, autospec=False, new_callable=None, **kwargs) -&gt; Unknown`.
- asynq/mock_.py:99:1: error[unresolved-attribute] Unresolved attribute `TEST_PREFIX` on type `def patch(target, new=Any, spec=None, create=Literal[False], mocksignature=Literal[False], spec_set=None, autospec=Literal[False], new_callable=None, **kwargs) -&gt; Unknown`.
+ asynq/mock_.py:99:1: error[unresolved-attribute] Unresolved attribute `TEST_PREFIX` on type `def patch(target, new=..., spec=None, create=False, mocksignature=False, spec_set=None, autospec=False, new_callable=None, **kwargs) -&gt; Unknown`.
- asynq/mock_.py:100:1: error[unresolved-attribute] Unresolved attribute `stopall` on type `def patch(target, new=Any, spec=None, create=Literal[False], mocksignature=Literal[False], spec_set=None, autospec=Literal[False], new_callable=None, **kwargs) -&gt; Unknown`.
+ asynq/mock_.py:100:1: error[unresolved-attribute] Unresolved attribute `stopall` on type `def patch(target, new=..., spec=None, create=False, mocksignature=False, spec_set=None, autospec=False, new_callable=None, **kwargs) -&gt; Unknown`.

pytest (https://github.com/pytest-dev/pytest)
- src/_pytest/_py/path.py:759:17: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = Literal[&quot;r&quot;], buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | str`
+ src/_pytest/_py/path.py:759:17: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = &quot;r&quot;, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | str`
- src/_pytest/_py/path.py:760:17: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = Literal[&quot;r&quot;], buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | Literal[&quot;r&quot;]`
+ src/_pytest/_py/path.py:760:17: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = &quot;r&quot;, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | Literal[&quot;r&quot;]`
- src/_pytest/_py/path.py:763:41: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = Literal[&quot;r&quot;], buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | str`
+ src/_pytest/_py/path.py:763:41: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = &quot;r&quot;, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | str`
- src/_pytest/_py/path.py:763:55: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = Literal[&quot;r&quot;], buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = Literal[-1], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = Literal[-1], encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = Literal[True], opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | Literal[&quot;r&quot;]`
+ src/_pytest/_py/path.py:763:55: error[invalid-argument-type] Argument to bound method `checked_call` is incorrect: Expected `Overload[(file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, ... omitted 48 literals] = &quot;r&quot;, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: Literal[0], encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 19 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb&quot;, &quot;br&quot;, &quot;rbU&quot;, &quot;rUb&quot;, &quot;Urb&quot;, ... omitted 3 literals], buffering: Literal[-1, 1] = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: Literal[&quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, ... omitted 33 literals], buffering: int = -1, encoding: None = None, errors: None = None, newline: None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown, (file: int | str | bytes | PathLike[str] | PathLike[bytes], mode: str, buffering: int = -1, encoding: str | None = None, errors: str | None = None, newline: str | None = None, closefd: bool = True, opener: ((str, int, /) -&gt; int) | None = None) -&gt; Unknown]`, found `Unknown | Literal[&quot;r&quot;]`

rich (https://github.com/Textualize/rich)
- examples/table_movie.py:62:1: error[invalid-argument-type] Argument to function `contextmanager` is incorrect: Expected `(...) -&gt; Iterator[Unknown]`, found `def beat(length: int = Literal[1]) -&gt; None`
+ examples/table_movie.py:62:1: error[invalid-argument-type] Argument to function `contextmanager` is incorrect: Expected `(...) -&gt; Iterator[Unknown]`, found `def beat(length: int = 1) -&gt; None`

sockeye (https://github.com/awslabs/sockeye)
- sockeye/test_utils.py:147:1: error[invalid-argument-type] Argument to function `contextmanager` is incorrect: Expected `(...) -&gt; Iterator[Unknown]`, found `def tmp_digits_dataset(prefix: str, train_line_count: int, train_line_count_empty: int, train_max_length: int, dev_line_count: int, dev_max_length: int, test_line_count: int, test_line_count_empty: int, test_max_length: int, sort_target: bool = Literal[False], seed_train: int = Literal[13], seed_dev: int = Literal[13], source_text_prefix_token: str = Literal[&quot;&quot;], with_n_source_factors: int = Literal[0], with_n_target_factors: int = Literal[0]) -&gt; dict[str, Any]`
+ sockeye/test_utils.py:147:1: error[invalid-argument-type] Argument to function `contextmanager` is incorrect: Expected `(...) -&gt; Iterator[Unknown]`, found `def tmp_digits_dataset(prefix: str, train_line_count: int, train_line_count_empty: int, train_max_length: int, dev_line_count: int, dev_max_length: int, test_line_count: int, test_line_count_empty: int, test_max_length: int, sort_target: bool = False, seed_train: int = 13, seed_dev: int = 13, source_text_prefix_token: str = &quot;&quot;, with_n_source_factors: int = 0, with_n_target_factors: int = 0) -&gt; dict[str, Any]`

dragonchain (https://github.com/dragonchain/dragonchain)
- dragonchain/job_processor/contract_job_utest.py:269:13: warning[possibly-missing-attribute] Attribute `assert_called_once` may be missing on object of type `Unknown | (bound method SmartContractModel.set_state(state: str | ContractState, msg: str = Literal[&quot;&quot;]) -&gt; None) | MagicMock`
+ dragonchain/job_processor/contract_job_utest.py:269:13: warning[possibly-missing-attribute] Attribute `assert_called_once` may be missing on object of type `Unknown | (bound method SmartContractModel.set_state(state: str | ContractState, msg: str = &quot;&quot;) -&gt; None) | MagicMock`
- dragonchain/lib/database/redis_utest.py:102:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].set(name: str | bytes, value: bytes | int | float | str, ex: None | int | float | timedelta = None, px: None | int | float | timedelta = None, nx: bool = Literal[False], xx: bool = Literal[False], keepttl: bool = Literal[False], get: bool = Literal[False], exat: Any | None = None, pxat: Any | None = None) -&gt; bool | None` has no attribute `assert_called_once_with`
+ dragonchain/lib/database/redis_utest.py:102:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].set(name: str | bytes, value: bytes | int | float | str, ex: None | int | float | timedelta = None, px: None | int | float | timedelta = None, nx: bool = False, xx: bool = False, keepttl: bool = False, get: bool = False, exat: Any | None = None, pxat: Any | None = None) -&gt; bool | None` has no attribute `assert_called_once_with`
- dragonchain/lib/database/redis_utest.py:106:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].set(name: str | bytes, value: bytes | int | float | str, ex: None | int | float | timedelta = None, px: None | int | float | timedelta = None, nx: bool = Literal[False], xx: bool = Literal[False], keepttl: bool = Literal[False], get: bool = Literal[False], exat: Any | None = None, pxat: Any | None = None) -&gt; bool | None` has no attribute `assert_called_once_with`
+ dragonchain/lib/database/redis_utest.py:106:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].set(name: str | bytes, value: bytes | int | float | str, ex: None | int | float | timedelta = None, px: None | int | float | timedelta = None, nx: bool = False, xx: bool = False, keepttl: bool = False, get: bool = False, exat: Any | None = None, pxat: Any | None = None) -&gt; bool | None` has no attribute `assert_called_once_with`
- dragonchain/lib/database/redis_utest.py:122:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].flushall(asynchronous: bool = Literal[False], **kwargs: Any) -&gt; bool` has no attribute `assert_called_once`
+ dragonchain/lib/database/redis_utest.py:122:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].flushall(asynchronous: bool = False, **kwargs: Any) -&gt; bool` has no attribute `assert_called_once`
- dragonchain/lib/database/redis_utest.py:146:9: error[unresolved-attribute] Object of type `Overload[(keys: Iterable[bytes | int | float | str] | int | float, timeout: Literal[0] | None = Literal[0]) -&gt; tuple[Unknown, Unknown], (keys: Iterable[bytes | int | float | str] | int | float, timeout: int | float) -&gt; tuple[Unknown, Unknown] | None]` has no attribute `assert_called_once_with`
+ dragonchain/lib/database/redis_utest.py:146:9: error[unresolved-attribute] Object of type `Overload[(keys: Iterable[bytes | int | float | str] | int | float, timeout: Literal[0] | None = 0) -&gt; tuple[Unknown, Unknown], (keys: Iterable[bytes | int | float | str] | int | float, timeout: int | float) -&gt; tuple[Unknown, Unknown] | None]` has no attribute `assert_called_once_with`
- dragonchain/lib/database/redis_utest.py:150:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].brpoplpush(src, dst, timeout: int | None = Literal[0]) -&gt; Unknown` has no attribute `assert_called_once_with`
+ dragonchain/lib/database/redis_utest.py:150:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].brpoplpush(src, dst, timeout: int | None = 0) -&gt; Unknown` has no attribute `assert_called_once_with`
- dragonchain/lib/database/redis_utest.py:162:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].set(name: str | bytes, value: bytes | int | float | str, ex: None | int | float | timedelta = None, px: None | int | float | timedelta = None, nx: bool = Literal[False], xx: bool = Literal[False], keepttl: bool = Literal[False], get: bool = Literal[False], exat: Any | None = None, pxat: Any | None = None) -&gt; bool | None` has no attribute `assert_called_once_with`
+ dragonchain/lib/database/redis_utest.py:162:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].set(name: str | bytes, value: bytes | int | float | str, ex: None | int | float | timedelta = None, px: None | int | float | timedelta = None, nx: bool = False, xx: bool = False, keepttl: bool = False, get: bool = False, exat: Any | None = None, pxat: Any | None = None) -&gt; bool | None` has no attribute `assert_called_once_with`
- dragonchain/lib/database/redis_utest.py:218:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].zadd(name: str | bytes, mapping: Mapping[str | bytes, bytes | int | float | str], nx: bool = Literal[False], xx: bool = Literal[False], ch: bool = Literal[False], incr: bool = Literal[False], gt: Any | None = Literal[False], lt: Any | None = Literal[False]) -&gt; int` has no attribute `assert_called_once_with`
+ dragonchain/lib/database/redis_utest.py:218:9: error[unresolved-attribute] Object of type `bound method Redis[Unknown].zadd(name: str | bytes, mapping: Mapping[str | bytes, bytes | int | float | str], nx: bool = False, xx: bool = False, ch: bool = False, incr: bool = False, gt: Any | None = False, lt: Any | None = False) -&gt; int` has no attribute `assert_called_once_with`

schemathesis (https://github.com/schemathesis/schemathesis)
- src/schemathesis/schemas.py:687:25: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = NotSet, media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
+ src/schemathesis/schemas.py:687:25: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = ..., media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
- src/schemathesis/schemas.py:732:82: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = NotSet, media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
+ src/schemathesis/schemas.py:732:82: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = ..., media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
- src/schemathesis/schemas.py:763:15: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = NotSet, media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
+ src/schemathesis/schemas.py:763:15: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = ..., media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
- src/schemathesis/schemas.py:807:10: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = NotSet, media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression
+ src/schemathesis/schemas.py:807:10: error[invalid-type-form] Variable of type `def Case(self, *, method: str | None = None, path_parameters: dict[str, Any] | None = None, headers: dict[str, Any] | CaseInsensitiveDict[Unknown] | None = None, cookies: dict[str, Any] | None = None, query: dict[str, Any] | None = None, body: list[Unknown] | dict[str, Any] | str | ... omitted 4 union elements = ..., media_type: str | None = None, multipart_content_types: dict[str, str] | None = None, _meta: CaseMetadata | None = None) -&gt; Unknown` is not allowed in a type expression

mitmproxy (https://github.com/mitmproxy/mitmproxy)
- test/mitmproxy/proxy/layers/http/test_http3.py:89:41: error[invalid-type-form] Invalid subscript of object of type `def Placeholder[T](cls: type[T@Placeholder] = &lt;special-form 'typing.Any'&gt;) -&gt; T@Placeholder | _Placeholder[T@Placeholder]` in type expression
+ test/mitmproxy/proxy/layers/http/test_http3.py:89:41: error[invalid-type-form] Invalid subscript of object of type `def Placeholder[T](cls: type[T@Placeholder] = ...) -&gt; T@Placeholder | _Placeholder[T@Placeholder]` in type expression
- test/mitmproxy/proxy/layers/http/test_http3.py:91:35: error[invalid-type-form] Invalid subscript of object of type `def Placeholder[T](cls: type[T@Placeholder] = &lt;special-form 'typing.Any'&gt;) -&gt; T@Placeholder | _Placeholder[T@Placeholder]` in type expression
+ test/mitmproxy/proxy/layers/http/test_http3.py:91:35: error[invalid-type-form] Invalid subscript of object of type `def Placeholder[T](cls: type[T@Placeholder] = ...) -&gt; T@Placeholder | _Placeholder[T@Placeholder]` in type expression

urllib3 (https://github.com/urllib3/urllib3)
- test/test_http2_connection.py:133:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:133:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:150:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:150:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:173:9: warning[possibly-missing-attribute] Attribute `assert_has_calls` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:173:9: warning[possibly-missing-attribute] Attribute `assert_has_calls` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:205:17: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:205:17: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:229:13: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:229:13: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:259:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:259:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:292:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:292:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:325:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:325:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`
- test/test_http2_connection.py:347:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = Literal[0], /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = Literal[0]) -&gt; None)`
+ test/test_http2_connection.py:347:9: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `(bound method socket.sendall(data: Buffer, flags: int = 0, /) -&gt; None) | Any | (bound method SSLTransport.sendall(data: bytes, flags: int = 0) -&gt; None)`

build (https://github.com/pypa/build)
- tests/test_projectbuilder.py:439:5: error[invalid-assignment] Object of type `Literal[&quot;dist-1.0.dist-info&quot;]` is not assignable to attribute `return_value` on type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = Literal[True]) -&gt; str)`
+ tests/test_projectbuilder.py:439:5: error[invalid-assignment] Object of type `Literal[&quot;dist-1.0.dist-info&quot;]` is not assignable to attribute `return_value` on type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = True) -&gt; str)`
- tests/test_projectbuilder.py:442:5: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = Literal[True]) -&gt; str)`
+ tests/test_projectbuilder.py:442:5: warning[possibly-missing-attribute] Attribute `assert_called_with` may be missing on object of type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = True) -&gt; str)`
- tests/test_projectbuilder.py:450:5: error[invalid-assignment] Object of type `HookMissing` is not assignable to attribute `side_effect` on type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = Literal[True]) -&gt; str)`
+ tests/test_projectbuilder.py:450:5: error[invalid-assignment] Object of type `HookMissing` is not assignable to attribute `side_effect` on type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = True) -&gt; str)`
- tests/test_projectbuilder.py:459:5: error[invalid-assignment] Object of type `&lt;class 'Exception'&gt;` is not assignable to attribute `side_effect` on type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = Literal[True]) -&gt; str)`
+ tests/test_projectbuilder.py:459:5: error[invalid-assignment] Object of type `&lt;class 'Exception'&gt;` is not assignable to attribute `side_effect` on type `Unknown | (bound method BuildBackendHookCaller.prepare_metadata_for_build_wheel(metadata_directory: str, config_settings: Mapping[str, Any] | None = None, _allow_fallback: bool = True) -&gt; str)`

Tanjun (https://github.com/FasterSpeeding/Tanjun)
- tanjun/dependencies/data.py:347:12: error[invalid-return-type] Return type does not match returned value: expected `_T@cached_inject`, found `Coroutine[Any, Any, _T@cached_inject | Coroutine[Any, Any, _T@cached_inject]] | _T@cached_inject`
+ tanjun/dependencies/data.py:347:12: error[invalid-return-type] Return type does not match returned value: expected `_T@cached_inject`, found `

... (truncated 381 lines) ...
</code></pre>
</details>

<p>No memory usage changes detected </p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-12-16 17:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/signatures.rs</code>:919 on 2025-12-16 17:43</div>
            <div class="timeline-body"><p>do we even need to keep the <code>default_type</code> field if we now have a <code>default_value</code> field? I think we literally only use the <code>default_type</code> for rendering in display; I think it's completely irrelevant for type-checking purposes. (For type-checking purposes, all you need to know is whether a parameter <em>has</em> a default; you don't need to know what the default <em>is</em>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[ty] Render default values for function args" to "[ty] Improve rendering of default values for function args" by @Gankra on 2025-12-16 17:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @Gankra on 2025-12-16 17:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @Gankra on 2025-12-16 17:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @Gankra on 2025-12-16 17:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @Gankra on 2025-12-16 17:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @Gankra on 2025-12-16 17:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-16 17:59</div>
            <div class="timeline-body"><p>Ok yeah with the only the type-based fallback this PR is just a slamdunk strict improvement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-16 18:00</div>
            <div class="timeline-body"><p>See https://github.com/astral-sh/ruff/pull/22010/commits/2e2a668b30ae000200296f5bd48b2af40fdef6a7 for what we give up by only using types and not exprs (it's not much).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-16 18:04</div>
            <div class="timeline-body"><blockquote>
<p>See <a href="https://github.com/astral-sh/ruff/commit/2e2a668b30ae000200296f5bd48b2af40fdef6a7">2e2a668</a> for what we give up by only using types and not exprs (it's not much).</p>
</blockquote>
<p>yes, but do we need to be storing the types of these default values at all? Since we literally <em>only</em> use the types of these default values for display rendering, we could probably rip that all out and <em>only</em> store the default value instead. This PR doesn't, for instance, give us parity with Pylance, which supports rendering list/set/dict/tuple literals in parameter default values in its type display:
<img width="972" height="224" alt="image" src="https://github.com/user-attachments/assets/b63382b6-0323-4e62-b270-fb8219d2957a" /></p>
<p>I'm okay with this as an incremental step since it's definitely a big improvement on the status quo but I think some bigger refactors and rethinks are in order here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-16 18:11</div>
            <div class="timeline-body"><blockquote>
<p>yes, but do we need to be storing the types of these default values at all?</p>
</blockquote>
<p>Yes we're actually really good at getting the default values of dataclasses but it only goes through the type machinery and comes out as <code>Literal[1]</code> or whatever. I added the type fallback path to cover that case and then realized, oh, actually, this covers most of the cases I'm catching with the expr anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-12-16 18:36</div>
            <div class="timeline-body"><p>I still think there's much more room for improvement here, but let's get this into the beta. It's a <em>big</em> improvement on the status quo. Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @Gankra on 2025-12-16 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-12-16 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-16 18:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 16:42:36 UTC
    </footer>
</body>
</html>
