<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Ruff 0.5] Stabilise 11 `FURB` rules - astral-sh/ruff #12043</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Ruff 0.5] Stabilise 11 <code>FURB</code> rules</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12043">#12043</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-06-26 10:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>Stabilise the following rules for release 0.5:</p>
<ul>
<li><code>print-empty-string</code> (<code>FURB105</code>)</li>
<li><code>readlines-in-for</code> (<code>FURB129</code>)</li>
<li><code>if-expr-min-max</code> (<code>FURB136</code>)</li>
<li>~~<code>math-constant</code> (<code>FURB152</code>)~~</li>
<li><code>bit-count</code> (<code>FURB161</code>)</li>
<li><code>redundant-log-base</code> (<code>FURB163</code>)</li>
<li><code>regex-flag-alias</code> (<code>FURB167</code>)</li>
<li><code>isinstance-type-none</code> (<code>FURB168</code>)</li>
<li><code>type-none-comparison</code> (<code>FURB169</code>)</li>
<li><code>implicit-cwd</code> (<code>FURB177</code>)</li>
<li><code>hashlib-digest-hex</code> (<code>FURB181</code>)</li>
<li><code>list-reverse-copy</code> (<code>FURB187</code>)</li>
</ul>
<p>These rules have all been in <code>preview</code> for over 90 days and several minor releases. There are no open issues about any of them, and there have not been any open issues about any of them for many months. For each rule, the documentation gives an accurate description of what the rule does and the implementation seems sound.</p>
<p>These are all stylistic rules, but I think their recommendations are all fairly uncontroverisal. Several other Refurb rules have been kept in preview for this release, as there are either outstanding issues with the implementation or their recommendations are (in my opinion) highly opinionated/controversial.</p>
Test Plan
<p><code>cargo test -p ruff_linter</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 10:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 10:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 10:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 10:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-06-26 11:28</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+42 -0 violations, +0 -0 fixes in 3 projects; 47 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+15 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/jobs/backfill_job_runner.py#L923">airflow/jobs/backfill_job_runner.py:923:13:</a> FURB187 [*] Use of assignment of `reversed` on list `dagrun_infos`
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/providers/apache/kafka/operators/consume.py#L158">airflow/providers/apache/kafka/operators/consume.py:158:30:</a> FURB136 [*] Replace `if` expression with `min(messages_left, self.max_batch_size)`
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/providers/apache/spark/hooks/spark_submit.py#L306">airflow/providers/apache/spark/hooks/spark_submit.py:306:19:</a> FURB167 [*] Use of regular expression alias `re.I`
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/providers/cncf/kubernetes/executors/kubernetes_executor_utils.py#L149">airflow/providers/cncf/kubernetes/executors/kubernetes_executor_utils.py:149:17:</a> PERF403 Use a dictionary comprehension instead of a for-loop
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/providers/exasol/hooks/exasol.py#L68">airflow/providers/exasol/hooks/exasol.py:68:17:</a> PERF403 Use a dictionary comprehension instead of a for-loop
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/providers/mysql/hooks/mysql.py#L171">airflow/providers/mysql/hooks/mysql.py:171:17:</a> PERF403 Use a dictionary comprehension instead of a for-loop
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/airflow/providers/postgres/hooks/postgres.py#L173">airflow/providers/postgres/hooks/postgres.py:173:17:</a> PERF403 Use a dictionary comprehension instead of a for-loop
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/dev/breeze/src/airflow_breeze/commands/release_management_commands.py#L2486">dev/breeze/src/airflow_breeze/commands/release_management_commands.py:2486:13:</a> PERF403 Use a dictionary comprehension instead of a for-loop
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/dev/breeze/src/airflow_breeze/global_constants.py#L401">dev/breeze/src/airflow_breeze/global_constants.py:401:21:</a> FURB129 Instead of calling `readlines()`, iterate over file object directly
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/dev/perf/sql_queries.py#L143">dev/perf/sql_queries.py:143:41:</a> FURB129 Instead of calling `readlines()`, iterate over file object directly
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/docs/exts/redirects.py#L44">docs/exts/redirects.py:44:21:</a> FURB129 Instead of calling `readlines()`, iterate over file object directly
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/scripts/ci/pre_commit/newsfragments.py#L36">scripts/ci/pre_commit/newsfragments.py:36:43:</a> FURB129 Instead of calling `readlines()`, iterate over file object directly
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/scripts/ci/testing/summarize_captured_warnings.py#L246">scripts/ci/testing/summarize_captured_warnings.py:246:11:</a> FURB177 Prefer `Path.cwd()` over `Path().resolve()` for current-directory lookups
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/tests/providers/apache/spark/hooks/test_spark_submit.py#L74">tests/providers/apache/spark/hooks/test_spark_submit.py:74:17:</a> PERF403 Use a dictionary comprehension instead of a for-loop
... 1 additional changes omitted for rule PERF403
+ <a href="https://github.com/apache/airflow/blob/dcaf82a155337e36d133ff673bafc5cf50303034/tests/system/providers/google/cloud/gcs/resources/transform_script.py#L26">tests/system/providers/google/cloud/gcs/resources/transform_script.py:26:39:</a> FURB129 Instead of calling `readlines()`, iterate over file object directly
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+3 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/visual.py#L109">src/bokeh/core/property/visual.py:109:116:</a> FURB167 [*] Use of regular expression alias `re.I`
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/util.py#L366">src/bokeh/embed/util.py:366:60:</a> FURB167 [*] Use of regular expression alias `re.S`
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/util.py#L381">src/bokeh/embed/util.py:381:60:</a> FURB167 [*] Use of regular expression alias `re.S`
</pre>

</p>

<a href="https://github.com/zulip/zulip">zulip/zulip</a> (+24 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/tools/lib/provision_inner.py#L101">tools/lib/provision_inner.py:101:51:</a> FURB129 Instead of calling `readlines()`, iterate over file object directly
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/compatibility.py#L46">zerver/lib/compatibility.py:46:60:</a> FURB167 [*] Use of regular expression alias `re.X`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/compatibility.py#L97">zerver/lib/compatibility.py:97:48:</a> FURB167 [*] Use of regular expression alias `re.I`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/compatibility.py#L97">zerver/lib/compatibility.py:97:55:</a> FURB167 [*] Use of regular expression alias `re.X`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/compatibility.py#L99">zerver/lib/compatibility.py:99:61:</a> FURB167 [*] Use of regular expression alias `re.I`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/compatibility.py#L99">zerver/lib/compatibility.py:99:68:</a> FURB167 [*] Use of regular expression alias `re.X`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/markdown/include.py#L30">zerver/lib/markdown/include.py:30:48:</a> FURB167 [*] Use of regular expression alias `re.M`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/lib/user_agent.py#L12">zerver/lib/user_agent.py:12:5:</a> FURB167 [*] Use of regular expression alias `re.X`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/management/commands/create_default_stream_groups.py#L67">zerver/management/commands/create_default_stream_groups.py:67:13:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/management/commands/deactivate_user.py#L38">zerver/management/commands/deactivate_user.py:38:9:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/management/commands/delete_old_unclaimed_attachments.py#L64">zerver/management/commands/delete_old_unclaimed_attachments.py:64:13:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/management/commands/delete_old_unclaimed_attachments.py#L68">zerver/management/commands/delete_old_unclaimed_attachments.py:68:13:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/management/commands/delete_old_unclaimed_attachments.py#L72">zerver/management/commands/delete_old_unclaimed_attachments.py:72:13:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/management/commands/register_server.py#L103">zerver/management/commands/register_server.py:103:13:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/migrations/0041_create_attachments_for_old_messages.py#L14">zerver/migrations/0041_create_attachments_for_old_messages.py:14:52:</a> FURB167 [*] Use of regular expression alias `re.M`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/migrations/0371_invalid_characters_in_topics.py#L35">zerver/migrations/0371_invalid_characters_in_topics.py:35:5:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/migrations/0375_invalid_characters_in_stream_names.py#L33">zerver/migrations/0375_invalid_characters_in_stream_names.py:33:5:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/migrations/0383_revoke_invitations_from_deactivated_users.py#L47">zerver/migrations/0383_revoke_invitations_from_deactivated_users.py:47:5:</a> FURB105 [*] Unnecessary empty string passed to `print`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/migrations/0423_fix_email_gateway_attachment_owner.py#L40">zerver/migrations/0423_fix_email_gateway_attachment_owner.py:40:5:</a> FURB105 [*] Unnecessary empty string passed to `print`
... 3 additional changes omitted for rule FURB105
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/openapi/markdown_extension.py#L173">zerver/openapi/markdown_extension.py:173:42:</a> FURB167 [*] Use of regular expression alias `re.M`
+ <a href="https://github.com/zulip/zulip/blob/dcf2c67f2d084339148cc8397ff37c47da2a0d8e/zerver/openapi/markdown_extension.py#L173">zerver/openapi/markdown_extension.py:173:49:</a> FURB167 [*] Use of regular expression alias `re.S`
... 2 additional changes omitted for rule FURB167
</pre>

</p>

Changes by rule (7 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| FURB167 | 15 | 15 | 0 | 0 | 0 |
| FURB105 | 12 | 12 | 0 | 0 | 0 |
| PERF403 | 6 | 6 | 0 | 0 | 0 |
| FURB129 | 6 | 6 | 0 | 0 | 0 |
| FURB187 | 1 | 1 | 0 | 0 | 0 |
| FURB136 | 1 | 1 | 0 | 0 | 0 |
| FURB177 | 1 | 1 | 0 | 0 | 0 |</p>
</p>


Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 11:35</div>
            <div class="timeline-body"><p>Having seen the ecosystem report, I&#x27;ll remove <code>math-constant</code> from the proposed stabilisations. It seems it has quite a few false positives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[Ruff 0.5] Stabilise 12 `FURB` rules&quot; to &quot;[Ruff 0.5] Stabilise 11 `FURB` rules&quot; by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 11:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 11:56</div>
            <div class="timeline-body"><blockquote>
<p>Having seen the ecosystem report, I&#x27;ll remove <code>math-constant</code> from the proposed stabilisations. It seems it has quite a few false positives.</p>
</blockquote>
<p>Now that I&#x27;ve made that change, the updated ecosystem hits all LGTM. I think in each instance, following the recommendation would be a reasonably uncontroversial style/readability improvement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-06-26 12:01</div>
            <div class="timeline-body"><p>These rules are quite complex so I anticipate some issues. But we&#x27;re clearly not getting more issues by keeping them in preview at this point, so seems fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 12:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-06-26 12:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-06-26 12:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:04:54 UTC
    </footer>
</body>
</html>
