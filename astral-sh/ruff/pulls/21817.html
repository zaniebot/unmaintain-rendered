<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Improve resolution of absolute imports in tests - astral-sh/ruff #21817</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Improve resolution of absolute imports in tests</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/21817">#21817</a>
        opened by <a href="https://github.com/Gankra">@Gankra</a>
        on 2025-12-05 18:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a></div>
            <div class="timeline-body"><p>By teaching desperate resolution to try every possible ancestor that doesn't have an <code>__init__.py(i)</code> when resolving absolute imports.</p>
<ul>
<li>Fixes https://github.com/astral-sh/ty/issues/1782</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @Gankra on 2025-12-05 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by @Gankra on 2025-12-05 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-05 18:44</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance">typing conformance tests</a></h2>
<p>No changes detected when running ty on typing conformance tests âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-12-05 18:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/ty/tests/cli/python_environment.rs</code>:2398 on 2025-12-05 18:46</div>
            <div class="timeline-body"><p>Unfortunately desperate resolution is currently too strict to handle this case, because <code>tests/test_bar</code> imports <code>tests/foo</code> as <code>foo</code> -- you would have to put the pyproject.toml <em>in</em> the tests dir. Loosening desperate resolution to try every ancestor dir would handle this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-05 18:46</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">spack (https://github.com/spack/spack)
- lib/spack/_vendoring/__init__.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.vendor`
- lib/spack/_vendoring/__init__.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.error`
+ lib/spack/docs/conf.py:135:1: error[invalid-assignment] Implicit shadowing of function `__get__`
- lib/spack/docs/conf.py:130:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/docs/conf.py:131:6: error[unresolved-import] Cannot resolve imported module `spack.spec_parser`
- lib/spack/docs/conf.py:315:8: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/docs/conf.py:316:8: error[unresolved-import] Cannot resolve imported module `spack.package`
- lib/spack/llnl/__init__.py:7:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/llnl/__init__.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.llnl`
- lib/spack/spack/__init__.py:9:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/__init__.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.util.git`
- lib/spack/spack/archspec.py:6:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.archspec.cpu`
- lib/spack/spack/archspec.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/audit.py:52:8: error[unresolved-import] Cannot resolve imported module `spack.builder`
- lib/spack/spack/audit.py:53:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/audit.py:54:8: error[unresolved-import] Cannot resolve imported module `spack.fetch_strategy`
- lib/spack/spack/audit.py:55:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/audit.py:56:8: error[unresolved-import] Cannot resolve imported module `spack.patch`
- lib/spack/spack/audit.py:57:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/audit.py:58:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/audit.py:59:8: error[unresolved-import] Cannot resolve imported module `spack.util.crypto`
- lib/spack/spack/audit.py:60:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
- lib/spack/spack/audit.py:61:8: error[unresolved-import] Cannot resolve imported module `spack.variant`
- lib/spack/spack/audit.py:62:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.string`
- lib/spack/spack/audit.py:604:12: error[unresolved-import] Cannot resolve imported module `spack.util.package_hash`
- lib/spack/spack/audit.py:1288:12: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/audit.py:1289:12: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/audit.py:1307:12: error[unresolved-import] Cannot resolve imported module `spack.detection`
- lib/spack/spack/binary_distribution.py:31:8: error[unresolved-import] Cannot resolve imported module `spack.caches`
- lib/spack/spack/binary_distribution.py:32:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/binary_distribution.py:33:8: error[unresolved-import] Cannot resolve imported module `spack.database`
- lib/spack/spack/binary_distribution.py:34:8: error[unresolved-import] Cannot resolve imported module `spack.deptypes`
- lib/spack/spack/binary_distribution.py:35:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/binary_distribution.py:36:8: error[unresolved-import] Cannot resolve imported module `spack.hash_types`
- lib/spack/spack/binary_distribution.py:37:8: error[unresolved-import] Cannot resolve imported module `spack.hooks`
- lib/spack/spack/binary_distribution.py:38:8: error[unresolved-import] Cannot resolve imported module `spack.hooks.sbang`
- lib/spack/spack/binary_distribution.py:39:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/binary_distribution.py:40:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/binary_distribution.py:41:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/binary_distribution.py:42:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/binary_distribution.py:43:8: error[unresolved-import] Cannot resolve imported module `spack.oci.image`
- lib/spack/spack/binary_distribution.py:44:8: error[unresolved-import] Cannot resolve imported module `spack.oci.oci`
- lib/spack/spack/binary_distribution.py:45:8: error[unresolved-import] Cannot resolve imported module `spack.oci.opener`
- lib/spack/spack/binary_distribution.py:46:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/binary_distribution.py:47:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/binary_distribution.py:48:8: error[unresolved-import] Cannot resolve imported module `spack.relocate`
- lib/spack/spack/binary_distribution.py:49:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/binary_distribution.py:50:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/binary_distribution.py:51:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/binary_distribution.py:52:8: error[unresolved-import] Cannot resolve imported module `spack.user_environment`
- lib/spack/spack/binary_distribution.py:53:8: error[unresolved-import] Cannot resolve imported module `spack.util.archive`
- lib/spack/spack/binary_distribution.py:54:8: error[unresolved-import] Cannot resolve imported module `spack.util.crypto`
- lib/spack/spack/binary_distribution.py:55:8: error[unresolved-import] Cannot resolve imported module `spack.util.file_cache`
- lib/spack/spack/binary_distribution.py:56:8: error[unresolved-import] Cannot resolve imported module `spack.util.gpg`
- lib/spack/spack/binary_distribution.py:57:8: error[unresolved-import] Cannot resolve imported module `spack.util.parallel`
- lib/spack/spack/binary_distribution.py:58:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/binary_distribution.py:59:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_json`
- lib/spack/spack/binary_distribution.py:60:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
- lib/spack/spack/binary_distribution.py:61:8: error[unresolved-import] Cannot resolve imported module `spack.util.timer`
- lib/spack/spack/binary_distribution.py:62:8: error[unresolved-import] Cannot resolve imported module `spack.util.url`
- lib/spack/spack/binary_distribution.py:63:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/binary_distribution.py:64:6: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/binary_distribution.py:65:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/binary_distribution.py:66:6: error[unresolved-import] Cannot resolve imported module `spack.oci.image`
- lib/spack/spack/binary_distribution.py:73:6: error[unresolved-import] Cannot resolve imported module `spack.oci.oci`
- lib/spack/spack/binary_distribution.py:80:6: error[unresolved-import] Cannot resolve imported module `spack.package_prefs`
- lib/spack/spack/binary_distribution.py:81:6: error[unresolved-import] Cannot resolve imported module `spack.relocate_text`
- lib/spack/spack/binary_distribution.py:82:6: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/binary_distribution.py:83:6: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/binary_distribution.py:506:84: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- lib/spack/spack/bootstrap/_common.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.archspec.cpu`
- lib/spack/spack/bootstrap/_common.py:16:6: error[unresolved-import] Cannot resolve imported module `spack.vendor.typing_extensions`
- lib/spack/spack/bootstrap/_common.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/bootstrap/_common.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/bootstrap/_common.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/bootstrap/_common.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/bootstrap/_common.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.util.environment`
- lib/spack/spack/bootstrap/_common.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/bootstrap/_common.py:24:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util`
- lib/spack/spack/bootstrap/clingo.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.archspec.cpu`
- lib/spack/spack/bootstrap/clingo.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.compilers.config`
- lib/spack/spack/bootstrap/clingo.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.compilers.libraries`
- lib/spack/spack/bootstrap/clingo.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/bootstrap/clingo.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.package_base`
- lib/spack/spack/bootstrap/clingo.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/bootstrap/clingo.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/bootstrap/clingo.py:24:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/bootstrap/clingo.py:25:8: error[unresolved-import] Cannot resolve imported module `spack.traverse`
- lib/spack/spack/bootstrap/clingo.py:26:8: error[unresolved-import] Cannot resolve imported module `spack.version`
- lib/spack/spack/bootstrap/config.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/bootstrap/config.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/bootstrap/config.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.modules`
- lib/spack/spack/bootstrap/config.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/bootstrap/config.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/bootstrap/config.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/bootstrap/config.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/bootstrap/config.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/bootstrap/config.py:19:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util`
- lib/spack/spack/bootstrap/core.py:32:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/bootstrap/core.py:33:8: error[unresolved-import] Cannot resolve imported module `spack.concretize`
- lib/spack/spack/bootstrap/core.py:34:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/bootstrap/core.py:35:8: error[unresolved-import] Cannot resolve imported module `spack.detection`
- lib/spack/spack/bootstrap/core.py:36:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/bootstrap/core.py:37:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/bootstrap/core.py:38:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/bootstrap/core.py:39:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/bootstrap/core.py:40:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/bootstrap/core.py:41:8: error[unresolved-import] Cannot resolve imported module `spack.user_environment`
- lib/spack/spack/bootstrap/core.py:42:8: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/bootstrap/core.py:43:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/bootstrap/core.py:44:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
- lib/spack/spack/bootstrap/core.py:45:8: error[unresolved-import] Cannot resolve imported module `spack.util.url`
- lib/spack/spack/bootstrap/core.py:46:8: error[unresolved-import] Cannot resolve imported module `spack.version`
- lib/spack/spack/bootstrap/core.py:47:6: error[unresolved-import] Cannot resolve imported module `spack.installer`
- lib/spack/spack/bootstrap/core.py:48:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util`
- lib/spack/spack/bootstrap/core.py:49:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/bootstrap/core.py:225:35: error[invalid-assignment] Object of type `dict[Unknown, Unknown]` is not assignable to `QueryInfo`
+ lib/spack/spack/bootstrap/status.py:24:19: warning[possibly-missing-attribute] Submodule `spec` may not be available as an attribute on module `spack`
- lib/spack/spack/bootstrap/core.py:267:27: error[invalid-assignment] Object of type `dict[Unknown, Unknown]` is not assignable to `QueryInfo`
- lib/spack/spack/bootstrap/core.py:307:27: error[invalid-assignment] Object of type `dict[Unknown, Unknown]` is not assignable to `QueryInfo`
- lib/spack/spack/bootstrap/environment.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.archspec.cpu`
- lib/spack/spack/bootstrap/environment.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/bootstrap/environment.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/bootstrap/environment.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.tengine`
- lib/spack/spack/bootstrap/environment.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/bootstrap/environment.py:17:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util`
- lib/spack/spack/bootstrap/status.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/build_environment.py:64:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.archspec.cpu`
- lib/spack/spack/build_environment.py:66:8: error[unresolved-import] Cannot resolve imported module `spack.builder`
- lib/spack/spack/build_environment.py:67:8: error[unresolved-import] Cannot resolve imported module `spack.compilers.libraries`
- lib/spack/spack/build_environment.py:68:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/build_environment.py:69:8: error[unresolved-import] Cannot resolve imported module `spack.deptypes`
- lib/spack/spack/build_environment.py:70:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/build_environment.py:71:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/build_environment.py:72:8: error[unresolved-import] Cannot resolve imported module `spack.multimethod`
- lib/spack/spack/build_environment.py:73:8: error[unresolved-import] Cannot resolve imported module `spack.package_base`
- lib/spack/spack/build_environment.py:74:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/build_environment.py:75:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/build_environment.py:76:8: error[unresolved-import] Cannot resolve imported module `spack.schema.environment`
- lib/spack/spack/build_environment.py:77:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/build_environment.py:78:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/build_environment.py:79:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/build_environment.py:80:8: error[unresolved-import] Cannot resolve imported module `spack.subprocess_context`
- lib/spack/spack/build_environment.py:81:8: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/build_environment.py:82:6: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/build_environment.py:83:6: error[unresolved-import] Cannot resolve imported module `spack.context`
- lib/spack/spack/build_environment.py:84:6: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/build_environment.py:85:6: error[unresolved-import] Cannot resolve imported module `spack.install_test`
- lib/spack/spack/build_environment.py:86:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.string`
- lib/spack/spack/build_environment.py:87:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/build_environment.py:88:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/build_environment.py:89:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/build_environment.py:90:6: error[unresolved-import] Cannot resolve imported module `spack.util.environment`
- lib/spack/spack/build_environment.py:101:6: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/build_environment.py:102:6: error[unresolved-import] Cannot resolve imported module `spack.util.log_parse`
- lib/spack/spack/build_environment.py:103:6: error[unresolved-import] Cannot resolve imported module `spack.util.module_cmd`
- lib/spack/spack/build_environment.py:833:60: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- lib/spack/spack/buildcache_migrate.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/buildcache_migrate.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.database`
- lib/spack/spack/buildcache_migrate.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/buildcache_migrate.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/buildcache_migrate.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/buildcache_migrate.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/buildcache_migrate.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/buildcache_migrate.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.util.crypto`
- lib/spack/spack/buildcache_migrate.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.util.parallel`
- lib/spack/spack/buildcache_migrate.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.util.url`
- lib/spack/spack/buildcache_migrate.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/buildcache_prune.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/buildcache_prune.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/buildcache_prune.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/buildcache_prune.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/buildcache_prune.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.util.parallel`
- lib/spack/spack/buildcache_prune.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.util.url`
- lib/spack/spack/buildcache_prune.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/buildcache_prune.py:21:6: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/builder.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.directives`
- lib/spack/spack/builder.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/builder.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.multimethod`
- lib/spack/spack/builder.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.package_base`
- lib/spack/spack/builder.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.phase_callbacks`
- lib/spack/spack/builder.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.relocate`
- lib/spack/spack/builder.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/builder.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/builder.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.util.environment`
- lib/spack/spack/builder.py:20:6: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/builder.py:21:6: error[unresolved-import] Cannot resolve imported module `spack.util.prefix`
+ lib/spack/spack/builder.py:219:16: error[invalid-return-type] Return type does not match returned value: expected `str`, found `Unknown | tuple[bool | str, ...] | bool | str`
- lib/spack/spack/builder.py:508:1: error[conflicting-metaclass] The metaclass of a derived class (`Builder`) must be a subclass of the metaclasses of all its bases, but `BuilderMeta` (metaclass of base class `BaseBuilder`) and `type` (metaclass of base class `Sequence`) have no subclass relationship
- lib/spack/spack/caches.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/caches.py:9:8: error[unresolved-import] Cannot resolve imported module `spack.fetch_strategy`
- lib/spack/spack/caches.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/caches.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/caches.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.util.file_cache`
- lib/spack/spack/caches.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/caches.py:14:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/caches.py:33:80: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- lib/spack/spack/caches.py:73:61: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- lib/spack/spack/ci/__init__.py:20:8: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/ci/__init__.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/ci/__init__.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.builder`
- lib/spack/spack/ci/__init__.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/ci/__init__.py:24:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/ci/__init__.py:25:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.path`
- lib/spack/spack/ci/__init__.py:26:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/ci/__init__.py:27:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/ci/__init__.py:28:8: error[unresolved-import] Cannot resolve imported module `spack.main`
- lib/spack/spack/ci/__init__.py:29:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/ci/__init__.py:30:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/ci/__init__.py:31:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/ci/__init__.py:32:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/ci/__init__.py:33:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/ci/__init__.py:34:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/ci/__init__.py:35:8: error[unresolved-import] Cannot resolve imported module `spack.util.git`
- lib/spack/spack/ci/__init__.py:36:8: error[unresolved-import] Cannot resolve imported module `spack.util.gpg`
- lib/spack/spack/ci/__init__.py:37:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
- lib/spack/spack/ci/__init__.py:38:8: error[unresolved-import] Cannot resolve imported module `spack.util.url`
- lib/spack/spack/ci/__init__.py:39:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/ci/__init__.py:40:6: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/ci/__init__.py:41:6: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/ci/__init__.py:42:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/ci/__init__.py:43:6: error[unresolved-import] Cannot resolve imported module `spack.reporters.cdash`
- lib/spack/spack/ci/common.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/ci/common.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/ci/common.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.deptypes`
- lib/spack/spack/ci/common.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/ci/common.py:24:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/ci/common.py:25:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/ci/common.py:26:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/ci/common.py:27:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/ci/common.py:28:8: error[unresolved-import] Cannot resolve imported module `spack.schema`
- lib/spack/spack/ci/common.py:29:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/ci/common.py:30:8: error[unresolved-import] Cannot resolve imported module `spack.util.compression`
- lib/spack/spack/ci/common.py:31:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/ci/common.py:32:6: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/ci/common.py:33:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/ci/common.py:34:6: error[unresolved-import] Cannot resolve imported module `spack.reporters`
- lib/spack/spack/ci/common.py:35:6: error[unresolved-import] Cannot resolve imported module `spack.reporters.cdash`
- lib/spack/spack/ci/common.py:36:6: error[unresolved-import] Cannot resolve imported module `spack.reporters.cdash`
- lib/spack/spack/ci/common.py:37:6: error[unresolved-import] Cannot resolve imported module `spack.url_buildcache`
- lib/spack/spack/ci/generator_registry.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/ci/gitlab.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.ruamel.yaml`
- lib/spack/spack/ci/gitlab.py:12:8: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/ci/gitlab.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/ci/gitlab.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/ci/gitlab.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/ci/gitlab.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/ci/gitlab.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.schema`
- lib/spack/spack/ci/gitlab.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/ci/gitlab.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/ci/gitlab.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
+ lib/spack/spack/cmd/__init__.py:374:16: error[invalid-argument-type] Argument to function `dump` is incorrect: Expected `dict[Unknown, Unknown]`, found `list[Unknown]`
+ lib/spack/spack/cmd/__init__.py:523:20: error[invalid-argument-type] Argument to function `colify` is incorrect: Expected `list[Any]`, found `GeneratorType[Unknown, None, None]`
+ lib/spack/spack/cmd/blame.py:158:38: error[invalid-argument-type] Argument to function `__new__` is incorrect: Expected `str | PathLike[str]`, found `object`
+ lib/spack/spack/cmd/blame.py:168:38: error[invalid-argument-type] Argument to function `__new__` is incorrect: Expected `str | PathLike[str]`, found `object`
- lib/spack/spack/cmd/__init__.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.concretize`
- lib/spack/spack/cmd/__init__.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/__init__.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/cmd/__init__.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/cmd/__init__.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.extensions`
- lib/spack/spack/cmd/__init__.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.string`
- lib/spack/spack/cmd/__init__.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/__init__.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/cmd/__init__.py:24:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/cmd/__init__.py:25:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/__init__.py:26:8: error[unresolved-import] Cannot resolve imported module `spack.spec_parser`
- lib/spack/spack/cmd/__init__.py:27:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/cmd/__init__.py:28:8: error[unresolved-import] Cannot resolve imported module `spack.traverse`
- lib/spack/spack/cmd/__init__.py:29:8: error[unresolved-import] Cannot resolve imported module `spack.user_environment`
- lib/spack/spack/cmd/__init__.py:30:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_json`
- lib/spack/spack/cmd/__init__.py:31:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
- lib/spack/spack/cmd/__init__.py:32:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/cmd/__init__.py:33:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/cmd/__init__.py:34:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.colify`
- lib/spack/spack/cmd/__init__.py:35:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/cmd/add.py:7:8: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/add.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/add.py:9:6: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/arch.py:9:8: error[unresolved-import] Cannot resolve imported module `spack.vendor.archspec.cpu`
- lib/spack/spack/cmd/arch.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.colify`
- lib/spack/spack/cmd/arch.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/cmd/arch.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/cmd/arch.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/audit.py:7:8: error[unresolved-import] Cannot resolve imported module `spack.audit`
- lib/spack/spack/cmd/audit.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/audit.py:9:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.colify`
- lib/spack/spack/cmd/audit.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/cmd/audit.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/cmd/blame.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/blame.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/blame.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/cmd/blame.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.util.git`
- lib/spack/spack/cmd/blame.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_json`
- lib/spack/spack/cmd/blame.py:17:6: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/blame.py:18:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/cmd/blame.py:19:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/cmd/blame.py:20:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.colify`
- lib/spack/spack/cmd/blame.py:21:6: error[unresolved-import] Cannot resolve imported module `spack.util.executable`
- lib/spack/spack/cmd/blame.py:246:30: error[invalid-argument-type] Argument to function `git_prefix` is incorrect: Expected `str | Path`, found `None | Unknown`
+ lib/spack/spack/cmd/blame.py:246:30: error[invalid-argument-type] Argument to function `git_prefix` is incorrect: Expected `str | Path`, found `None | Unknown | str`
- lib/spack/spack/cmd/blame.py:288:17: warning[possibly-unresolved-reference] Name `lines` used when possibly not defined
- lib/spack/spack/cmd/bootstrap.py:11:8: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/cmd/bootstrap.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.bootstrap`
- lib/spack/spack/cmd/bootstrap.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.bootstrap.config`
- lib/spack/spack/cmd/bootstrap.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.bootstrap.core`
- lib/spack/spack/cmd/bootstrap.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.cmd.mirror`
- lib/spack/spack/cmd/bootstrap.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.concretize`
- lib/spack/spack/cmd/bootstrap.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/bootstrap.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/cmd/bootstrap.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/bootstrap.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/cmd/bootstrap.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/cmd/bootstrap.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
+ lib/spack/spack/cmd/bootstrap.py:185:39: error[unresolved-attribute] Object of type `ConfigScope` has no attribute `path`
+ lib/spack/spack/cmd/buildcache.py:342:27: warning[possibly-missing-attribute] Submodule `colify` may not be available as an attribute on module `spack.llnl.util.tty`
+ lib/spack/spack/cmd/checksum.py:164:20: error[invalid-assignment] Object of type `dict[StandardVersion, str] | None` is not assignable to `dict[StandardVersion, str]`
- lib/spack/spack/cmd/bootstrap.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.util.spack_yaml`
- lib/spack/spack/cmd/bootstrap.py:24:6: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/build_env.py:5:8: error[unresolved-import] Cannot resolve imported module `spack.cmd.common.env_utility`
- lib/spack/spack/cmd/build_env.py:6:6: error[unresolved-import] Cannot resolve imported module `spack.context`
- lib/spack/spack/cmd/buildcache.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/cmd/buildcache.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/buildcache.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.concretize`
- lib/spack/spack/cmd/buildcache.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/buildcache.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.deptypes`
- lib/spack/spack/cmd/buildcache.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/cmd/buildcache.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/cmd/buildcache.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/buildcache.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/cmd/buildcache.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.oci.image`
- lib/spack/spack/cmd/buildcache.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.oci.oci`
- lib/spack/spack/cmd/buildcache.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/buildcache.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/cmd/buildcache.py:24:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/cmd/buildcache.py:25:8: error[unresolved-import] Cannot resolve imported module `spack.util.parallel`
- lib/spack/spack/cmd/buildcache.py:26:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/cmd/buildcache.py:27:6: error[unresolved-import] Cannot resolve imported module `spack`
- lib/spack/spack/cmd/buildcache.py:28:6: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/buildcache.py:29:6: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/buildcache.py:30:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.string`
- lib/spack/spack/cmd/buildcache.py:31:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/cmd/buildcache.py:32:6: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/buildcache.py:521:29: warning[possibly-unresolved-reference] Name `specs` used when possibly not defined
- lib/spack/spack/cmd/buildcache.py:525:29: warning[possibly-unresolved-reference] Name `specs` used when possibly not defined
- lib/spack/spack/cmd/buildcache.py:527:22: warning[possibly-unresolved-reference] Name `specs` used when possibly not defined
- lib/spack/spack/cmd/buildcache.py:534:19: warning[possibly-unresolved-reference] Name `specs` used when possibly not defined
- lib/spack/spack/cmd/cd.py:7:8: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/cd.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.cmd.location`
- lib/spack/spack/cmd/change.py:7:8: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/change.py:8:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/change.py:9:6: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/checksum.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.string`
- lib/spack/spack/cmd/checksum.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.lang`
- lib/spack/spack/cmd/checksum.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/cmd/checksum.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/checksum.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/cmd/checksum.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/cmd/checksum.py:16:6: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/checksum.py:17:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util`
- lib/spack/spack/cmd/checksum.py:18:6: error[unresolved-import] Cannot resolve imported module `spack.package_base`
- lib/spack/spack/cmd/checksum.py:24:6: error[unresolved-import] Cannot resolve imported module `spack.util.editor`
- lib/spack/spack/cmd/checksum.py:25:6: error[unresolved-import] Cannot resolve imported module `spack.util.format`
- lib/spack/spack/cmd/checksum.py:26:6: error[unresolved-import] Cannot resolve imported module `spack.version`
- lib/spack/spack/cmd/ci.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.binary_distribution`
- lib/spack/spack/cmd/ci.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.ci`
- lib/spack/spack/cmd/ci.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/ci.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.cmd.buildcache`
- lib/spack/spack/cmd/ci.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.cmd.common.arguments`
- lib/spack/spack/cmd/ci.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/ci.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.environment`
- lib/spack/spack/cmd/ci.py:20:8: error[unresolved-import] Cannot resolve imported module `spack.error`
- lib/spack/spack/cmd/ci.py:21:8: error[unresolved-import] Cannot resolve imported module `spack.fetch_strategy`
- lib/spack/spack/cmd/ci.py:22:8: error[unresolved-import] Cannot resolve imported module `spack.hash_types`
- lib/spack/spack/cmd/ci.py:23:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/cmd/ci.py:24:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/cmd/ci.py:25:8: error[unresolved-import] Cannot resolve imported module `spack.mirrors.mirror`
- lib/spack/spack/cmd/ci.py:26:8: error[unresolved-import] Cannot resolve imported module `spack.package_base`
- lib/spack/spack/cmd/ci.py:27:8: error[unresolved-import] Cannot resolve imported module `spack.repo`
- lib/spack/spack/cmd/ci.py:28:8: error[unresolved-import] Cannot resolve imported module `spack.spec`
- lib/spack/spack/cmd/ci.py:29:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/cmd/ci.py:30:8: error[unresolved-import] Cannot resolve imported module `spack.util.git`
- lib/spack/spack/cmd/ci.py:31:8: error[unresolved-import] Cannot resolve imported module `spack.util.gpg`
- lib/spack/spack/cmd/ci.py:32:8: error[unresolved-import] Cannot resolve imported module `spack.util.timer`
- lib/spack/spack/cmd/ci.py:33:8: error[unresolved-import] Cannot resolve imported module `spack.util.url`
- lib/spack/spack/cmd/ci.py:34:8: error[unresolved-import] Cannot resolve imported module `spack.util.web`
- lib/spack/spack/cmd/ci.py:35:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util`
- lib/spack/spack/cmd/ci.py:36:6: error[unresolved-import] Cannot resolve imported module `spack.version`
- lib/spack/spack/cmd/ci.py:425:18: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:448:61: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:490:50: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:506:51: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:519:29: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:528:17: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:532:43: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:542:13: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:549:42: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:555:50: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:567:30: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:593:46: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:600:24: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:608:20: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/ci.py:616:31: warning[possibly-unresolved-reference] Name `job_spec` used when possibly not defined
- lib/spack/spack/cmd/clean.py:9:8: error[unresolved-import] Cannot resolve imported module `spack.caches`
- lib/spack/spack/cmd/clean.py:10:8: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/clean.py:11:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/clean.py:12:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.filesystem`
- lib/spack/spack/cmd/clean.py:13:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/clean.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.stage`
- lib/spack/spack/cmd/clean.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.store`
- lib/spack/spack/cmd/clean.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.util.path`
- lib/spack/spack/cmd/clean.py:17:6: error[unresolved-import] Cannot resolve imported module `spack.cmd.common`
- lib/spack/spack/cmd/clean.py:18:6: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/cmd/commands.py:14:8: error[unresolved-import] Cannot resolve imported module `spack.cmd`
- lib/spack/spack/cmd/commands.py:15:8: error[unresolved-import] Cannot resolve imported module `spack.config`
- lib/spack/spack/cmd/commands.py:16:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/commands.py:17:8: error[unresolved-import] Cannot resolve imported module `spack.main`
- lib/spack/spack/cmd/commands.py:18:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/cmd/commands.py:19:8: error[unresolved-import] Cannot resolve imported module `spack.platforms`
- lib/spack/spack/cmd/commands.py:20:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.argparsewriter`
- lib/spack/spack/cmd/commands.py:21:6: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.colify`
- lib/spack/spack/cmd/commands.py:22:6: error[unresolved-import] Cannot resolve imported module `spack.main`
- lib/spack/spack/cmd/common/__init__.py:5:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty`
- lib/spack/spack/cmd/common/__init__.py:6:8: error[unresolved-import] Cannot resolve imported module `spack.llnl.util.tty.color`
- lib/spack/spack/cmd/common/__init__.py:7:8: error[unresolved-import] Cannot resolve imported module `spack.paths`
- lib/spack/spack/cmd/common/arguments.py:10:8: error[unre

... (truncated 9855 lines) ...
</code></pre>
</details>

<p>No memory usage changes detected âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-12-05 18:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/ty/tests/cli/python_environment.rs</code>:2398 on 2025-12-05 18:47</div>
            <div class="timeline-body"><p>Alternatively we could also consider a dir named <code>tests</code> as a magic name for desperate resolution?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[ty] don't add tests folders as roots" to "[ty] move pytest search-path handling to desperate resolution" by @Gankra on 2025-12-05 19:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[ty] move pytest search-path handling to desperate resolution" to "[ty] Move pytest search-path handling to desperate resolution" by @Gankra on 2025-12-05 19:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> removed by @Gankra on 2025-12-05 19:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by @Gankra on 2025-12-05 19:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-05 19:14</div>
            <div class="timeline-body"><p>Hmm this is tricky with the tests we have written, I need to look into what pytest actually does/supports.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-05 19:15</div>
            <div class="timeline-body"><p>Can't believe Carl convinced me randomly including tests with or without <code>tests/__init__.py</code> was arbitrary paranoia and not me having dark foresight of the nature of imports.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-12-05 19:15</div>
            <div class="timeline-body"><!-- generated-comment ty ecosystem-analyzer -->

<h2><code>ecosystem-analyzer</code> results</h2>
<p>| Lint rule | Added | Removed | Changed |
|-----------|------:|--------:|--------:|
| <code>unresolved-import</code> | 33 | 7,404 | 57 |
| <code>possibly-missing-attribute</code> | 531 | 10 | 39 |
| <code>unresolved-reference</code> | 0 | 535 | 0 |
| <code>invalid-argument-type</code> | 509 | 4 | 5 |
| <code>unresolved-attribute</code> | 283 | 3 | 0 |
| <code>unused-ignore-comment</code> | 2 | 168 | 0 |
| <code>unknown-argument</code> | 57 | 26 | 0 |
| <code>unsupported-operator</code> | 72 | 0 | 0 |
| <code>missing-argument</code> | 58 | 0 | 0 |
| <code>no-matching-overload</code> | 58 | 0 | 0 |
| <code>invalid-assignment</code> | 46 | 5 | 3 |
| <code>possibly-unresolved-reference</code> | 0 | 50 | 0 |
| <code>invalid-method-override</code> | 42 | 0 | 0 |
| <code>invalid-return-type</code> | 5 | 10 | 1 |
| <code>non-subscriptable</code> | 13 | 0 | 0 |
| <code>not-iterable</code> | 7 | 0 | 4 |
| <code>invalid-exception-caught</code> | 6 | 0 | 0 |
| <code>invalid-raise</code> | 6 | 0 | 0 |
| <code>unsupported-base</code> | 6 | 0 | 0 |
| <code>too-many-positional-arguments</code> | 5 | 0 | 0 |
| <code>call-non-callable</code> | 4 | 0 | 0 |
| <code>deprecated</code> | 4 | 0 | 0 |
| <code>inconsistent-mro</code> | 4 | 0 | 0 |
| <code>parameter-already-assigned</code> | 3 | 0 | 0 |
| <code>conflicting-metaclass</code> | 0 | 2 | 0 |
| <code>invalid-parameter-default</code> | 1 | 0 | 0 |
| <strong>Total</strong> | <strong>1,755</strong> | <strong>8,217</strong> | <strong>109</strong> |</p>
<p><strong><a href="https://gankra-notest.ecosystem-663.pages.dev/diff">Full report with detailed diff</a></strong> (<a href="https://gankra-notest.ecosystem-663.pages.dev/timing">timing results</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-05 19:37</div>
            <div class="timeline-body"><p>Notably having multiple desperate search-paths is problematic for resolving relative imports, with our two-phases <code>file_to_module</code> and then <code>resolve_module</code> system. If <code>.</code> resolves to <code>thismod</code> then file_to_module succeeds but <code>.sibling</code> is syntactically invalid (only <code>sibling</code> works).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-05 19:50</div>
            <div class="timeline-body"><p>One kind of hacky solution would be to refuse to consider the dir the file is in a desperate search-path in <code>file_to_module</code> as we are typically resolving a relative import and so &quot;this is a root module&quot; is not helpful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-05 20:07</div>
            <div class="timeline-body"><p>Tears of joy at how good these docs are omg https://docs.pytest.org/en/stable/explanation/pythonpath.html</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> removed by @Gankra on 2025-12-05 20:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by @Gankra on 2025-12-05 20:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-05 20:17</div>
            <div class="timeline-body"><blockquote>
<p>One kind of hacky solution would be to refuse to consider the dir the file is in a desperate search-path in file_to_module as we are typically resolving a relative import and so &quot;this is a root module&quot; is not helpful.</p>
</blockquote>
<p>The same can be accomplished by reversing the priority of the desperate search-paths: try the <em>farthest</em> ancestor dir first, allowing us to resolve <code>.</code> as the longest-possible-absolute path that is still valid.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> removed by @Gankra on 2025-12-12 12:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by @Gankra on 2025-12-12 12:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> removed by @Gankra on 2025-12-12 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by @Gankra on 2025-12-12 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-12-12 13:23</div>
            <div class="timeline-body"><p>woah oh god those results</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @Gankra on 2025-12-12 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @Gankra on 2025-12-12 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @Gankra on 2025-12-12 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @Gankra on 2025-12-12 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @Gankra on 2025-12-12 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @Gankra on 2025-12-12 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[ty] Move pytest search-path handling to desperate resolution" to "[ty] Improve resolution of absolute imports in tests" by @Gankra on 2025-12-12 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @BurntSushi on 2025-12-12 16:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2025-12-12 16:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-12 16:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-12 17:50</div>
            <div class="timeline-body"><p>If not already done, we need to make sure that the option defaults and documentation reflect the newest change regarding the default root paths.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-12 21:07</div>
            <div class="timeline-body"><p>I think the spack ecosystem results mostly suggest that it ought to have <code>lib/</code> in its <code>environment.roots</code>.</p>
<p>But I guess not doing that makes it a good test case for what happens when ty is used in a project with an unusual layout and no configuration...</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:17:52 UTC
    </footer>
</body>
</html>
