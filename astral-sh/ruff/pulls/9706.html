<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`] Add `__mro_entries__` to known dunder methods (`PLW3201`) - astral-sh/ruff #9706</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pylint</code>] Add <code>__mro_entries__</code> to known dunder methods (<code>PLW3201</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9706">#9706</a>
        opened by <a href="https://github.com/johnslavik">@johnslavik</a>
        on 2024-01-30 15:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/johnslavik">@johnslavik</a></div>
            <div class="timeline-body"><p>Yes, I actually need this dunder in my project.</p>


Summary


<p>This change adds <a href="https://docs.python.org/3/reference/datamodel.html#object.__mro_entries__"><code>__mro_entries__</code></a> to the list of known dunder methods.</p>
Test Plan


<p>8893a3ca5784034101701bad8024e8bf59c6f8b6.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Add __mro_entries__ to known dunder methods&quot; to &quot;Add `__mro_entries__` to known dunder methods&quot; by <a href="https://github.com/johnslavik">@johnslavik</a> on 2024-01-30 15:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Add `__mro_entries__` to known dunder methods&quot; to &quot;[`pylint`] Add `__mro_entries__` to known dunder methods&quot; by <a href="https://github.com/johnslavik">@johnslavik</a> on 2024-01-30 15:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-01-30 15:38</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>âœ… ecosystem check detected no linter changes.</p>
Linter (preview)
<p>âœ… ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[`pylint`] Add `__mro_entries__` to known dunder methods&quot; to &quot;[`pylint`] Add `__mro_entries__` to known dunder methods (`PLW3201`)&quot; by <a href="https://github.com/johnslavik">@johnslavik</a> on 2024-01-30 15:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-01-30 16:40</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-30 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-30 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-30 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-30 16:55</div>
            <div class="timeline-body"><p>I ran a small script to find all the dunders defined in CPython (not thoroughly tested; it might have bugs):</p>
<pre><code>import ast, re, pathlib, pprint

is_dunder = re.compile(r&quot;__[^_](.+[^_])?__&quot;).fullmatch

class DunderCollector(ast.NodeVisitor):
    def visit_FunctionDef(self, node):
        if is_dunder(node.name):
            dunders.add(node.name)
    visit_AsyncFunctionDef = visit_FunctionDef

dunders = set()

for path in pathlib.Path(&quot;.&quot;).rglob(&quot;*.py&quot;):
    try:
        source = path.read_text()
    except Exception as e:
        print(f&quot;Skipping {path} due to {e}&quot;)
        continue
    try:
        tree = ast.parse(tree)
    except Exception as e:
        print(f&quot;Skipping {path} due to {e}&quot;)
        continue
    DunderCollector().visit(tree)

pprint.pprint(sorted(dunders))
</code></pre>
<p>Run it from the CPython repo root, and it gives these results:</p>


<pre><code>[&#x27;__abs__&#x27;,
 &#x27;__add__&#x27;,
 &#x27;__aenter__&#x27;,
 &#x27;__aexit__&#x27;,
 &#x27;__aiter__&#x27;,
 &#x27;__and__&#x27;,
 &#x27;__anext__&#x27;,
 &#x27;__await__&#x27;,
 &#x27;__bool__&#x27;,
 &#x27;__buffer__&#x27;,
 &#x27;__bytes__&#x27;,
 &#x27;__call__&#x27;,
 &#x27;__ceil__&#x27;,
 &#x27;__class__&#x27;,
 &#x27;__class_getitem__&#x27;,
 &#x27;__cmp__&#x27;,
 &#x27;__complex__&#x27;,
 &#x27;__conform__&#x27;,
 &#x27;__contains__&#x27;,
 &#x27;__copy__&#x27;,
 &#x27;__deepcopy__&#x27;,
 &#x27;__del__&#x27;,
 &#x27;__delattr__&#x27;,
 &#x27;__delete__&#x27;,
 &#x27;__delitem__&#x27;,
 &#x27;__dir__&#x27;,
 &#x27;__divmod__&#x27;,
 &#x27;__enter__&#x27;,
 &#x27;__exit__&#x27;,
 &#x27;__float__&#x27;,
 &#x27;__floor__&#x27;,
 &#x27;__floordiv__&#x27;,
 &#x27;__format__&#x27;,
 &#x27;__fspath__&#x27;,
 &#x27;__get__&#x27;,
 &#x27;__getattr__&#x27;,
 &#x27;__getattribute__&#x27;,
 &#x27;__getinitargs__&#x27;,
 &#x27;__getitem__&#x27;,
 &#x27;__getitem_inner__&#x27;,
 &#x27;__getnewargs__&#x27;,
 &#x27;__getnewargs_ex__&#x27;,
 &#x27;__getslice__&#x27;,
 &#x27;__getstate__&#x27;,
 &#x27;__hash__&#x27;,
 &#x27;__iadd__&#x27;,
 &#x27;__iand__&#x27;,
 &#x27;__ilshift__&#x27;,
 &#x27;__import__&#x27;,
 &#x27;__imul__&#x27;,
 &#x27;__index__&#x27;,
 &#x27;__init__&#x27;,
 &#x27;__init_subclass__&#x27;,
 &#x27;__instancecheck__&#x27;,
 &#x27;__int__&#x27;,
 &#x27;__invert__&#x27;,
 &#x27;__ior__&#x27;,
 &#x27;__isabstractmethod__&#x27;,
 &#x27;__isub__&#x27;,
 &#x27;__iter__&#x27;,
 &#x27;__ixor__&#x27;,
 &#x27;__len__&#x27;,
 &#x27;__length_hint__&#x27;,
 &#x27;__lshift__&#x27;,
 &#x27;__members__&#x27;,
 &#x27;__missing__&#x27;,
 &#x27;__mod__&#x27;,
 &#x27;__mro_entries__&#x27;,
 &#x27;__mul__&#x27;,
 &#x27;__neg__&#x27;,
 &#x27;__new__&#x27;,
 &#x27;__newobj__&#x27;,
 &#x27;__newobj_ex__&#x27;,
 &#x27;__next__&#x27;,
 &#x27;__nonzero__&#x27;,
 &#x27;__parameters__&#x27;,
 &#x27;__pos__&#x27;,
 &#x27;__post_init__&#x27;,
 &#x27;__pow__&#x27;,
 &#x27;__prepare__&#x27;,
 &#x27;__radd__&#x27;,
 &#x27;__rand__&#x27;,
 &#x27;__rdivmod__&#x27;,
 &#x27;__reduce__&#x27;,
 &#x27;__reduce_ex__&#x27;,
 &#x27;__repr__&#x27;,
 &#x27;__reversed__&#x27;,
 &#x27;__rfloordiv__&#x27;,
 &#x27;__rich__&#x27;,
 &#x27;__rich_console__&#x27;,
 &#x27;__rich_measure__&#x27;,
 &#x27;__rich_repr__&#x27;,
 &#x27;__rlshift__&#x27;,
 &#x27;__rmod__&#x27;,
 &#x27;__rmul__&#x27;,
 &#x27;__ror__&#x27;,
 &#x27;__round__&#x27;,
 &#x27;__rpow__&#x27;,
 &#x27;__rrshift__&#x27;,
 &#x27;__rshift__&#x27;,
 &#x27;__rsub__&#x27;,
 &#x27;__rtruediv__&#x27;,
 &#x27;__rxor__&#x27;,
 &#x27;__set__&#x27;,
 &#x27;__set_name__&#x27;,
 &#x27;__setattr__&#x27;,
 &#x27;__setitem__&#x27;,
 &#x27;__setslice__&#x27;,
 &#x27;__setstate__&#x27;,
 &#x27;__signature__&#x27;,
 &#x27;__sizeof__&#x27;,
 &#x27;__str__&#x27;,
 &#x27;__sub__&#x27;,
 &#x27;__subclasscheck__&#x27;,
 &#x27;__subclasshook__&#x27;,
 &#x27;__tp_del__&#x27;,
 &#x27;__truediv__&#x27;,
 &#x27;__trunc__&#x27;,
 &#x27;__typing_is_unpacked_typevartuple__&#x27;,
 &#x27;__typing_unpacked_tuple_args__&#x27;,
 &#x27;__unicode__&#x27;,
 &#x27;__version__&#x27;,
 &#x27;__wrapped__&#x27;,
 &#x27;__xor__&#x27;]
</code></pre>


<p>Some of those are internal implementation details that we definitely shouldn&#x27;t add to the list of known dunder methods, in my opinion (<code>__typing_is_unpacked_typevartuple__</code>, etc.), but it might be worth looking through that list to see if there are any we&#x27;re missing that would be worth adding</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trag1c">@trag1c</a> on 2024-01-30 17:03</div>
            <div class="timeline-body"><p>A <a href="https://github.com/trag1c/mcoding-all-dunders">community project I maintain</a> has a spreadsheet with a curated list of all* 224 dunders (iirc it includes docs too) :+1:</p>
<p>*excluding a few false positives like <code>__name___</code> or <code>__dunder__</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-30 19:38</div>
            <div class="timeline-body"><blockquote>
<p>but it might be worth looking through that list to see if there are any we&#x27;re missing that would be worth adding</p>
</blockquote>
<p>having now done this, I think there are 0 true positives (that are not already listed by ruff) in that list my script produced :)</p>
<p>This is the set of dunders that were surfaced in my script and are not currently listed by ruff as excluded from this rule:</p>
<pre><code>[&#x27;__cmp__&#x27;,
 &#x27;__conform__&#x27;,
 &#x27;__getinitargs__&#x27;,
 &#x27;__getitem_inner__&#x27;,
 &#x27;__getslice__&#x27;,
 &#x27;__import__&#x27;,
 &#x27;__isabstractmethod__&#x27;,
 &#x27;__members__&#x27;,
 &#x27;__newobj__&#x27;,
 &#x27;__newobj_ex__&#x27;,
 &#x27;__nonzero__&#x27;,
 &#x27;__parameters__&#x27;,
 &#x27;__rich__&#x27;,
 &#x27;__rich_console__&#x27;,
 &#x27;__rich_measure__&#x27;,
 &#x27;__rich_repr__&#x27;,
 &#x27;__setslice__&#x27;,
 &#x27;__signature__&#x27;,
 &#x27;__tp_del__&#x27;,
 &#x27;__typing_is_unpacked_typevartuple__&#x27;,
 &#x27;__typing_unpacked_tuple_args__&#x27;,
 &#x27;__unicode__&#x27;,
 &#x27;__version__&#x27;,
 &#x27;__wrapped__&#x27;]
</code></pre>
<p>Most of them seem to be definitions in tests, internal implementation details that are undocumented, and/or leftovers from Python 2 that still haven&#x27;t been cleaned up. The <code>__rich_*__</code> ones are because I have <code>rich</code> installed in a venv inside my cpython local clone, I think?</p>
<p>I like that the script surfaced <code>__import__</code> -- that&#x27;s the literal definition of Python&#x27;s <code>import</code> statement right there ðŸ˜„</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/johnslavik">@johnslavik</a> on 2024-01-30 19:44</div>
            <div class="timeline-body"><p>It would be useful to add <code>__wrapped__</code> , <code>__isabstractmethod__</code> and <code>__signature__</code> in case one wants to define those as properties.
<code>__rich_*__</code> should definitely be supported, a lot of critical tools &amp; libraries have integrations with rich (including pip or Pydantic).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/johnslavik">@johnslavik</a> on 2024-01-30 19:51</div>
            <div class="timeline-body"><p>Let&#x27;s move the discussion to #9716.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-30 19:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:01:13 UTC
    </footer>
</body>
</html>
