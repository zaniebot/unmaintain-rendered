<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Track formatting all comments - astral-sh/ruff #6178</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Track formatting all comments</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/6178">#6178</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2023-07-30 13:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>We currently don't format all comments as match statements are not yet implemented. We can work around this for the top level match statement by setting them manually formatted but the mocked-out top level match doesn't call into its children so they would still have unformatted comments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-07-30 14:19</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Benchmark</h3>
<h4>Linux</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      8.2Â±0.09ms     4.9 MB/sec    1.00      8.3Â±0.10ms     4.9 MB/sec
formatter/numpy/ctypeslib.py               1.01  1647.0Â±38.73Âµs    10.1 MB/sec    1.00  1633.4Â±11.28Âµs    10.2 MB/sec
formatter/numpy/globals.py                 1.02    187.6Â±7.25Âµs    15.7 MB/sec    1.00    184.5Â±2.58Âµs    16.0 MB/sec
formatter/pydantic/types.py                1.00      3.5Â±0.09ms     7.3 MB/sec    1.01      3.5Â±0.12ms     7.2 MB/sec
linter/all-rules/large/dataset.py          1.00     10.2Â±0.04ms     4.0 MB/sec    1.00     10.2Â±0.06ms     4.0 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      2.7Â±0.01ms     6.1 MB/sec    1.00      2.7Â±0.02ms     6.1 MB/sec
linter/all-rules/numpy/globals.py          1.00    383.0Â±0.87Âµs     7.7 MB/sec    1.00    382.2Â±0.66Âµs     7.7 MB/sec
linter/all-rules/pydantic/types.py         1.00      5.3Â±0.07ms     4.8 MB/sec    1.00      5.3Â±0.02ms     4.8 MB/sec
linter/default-rules/large/dataset.py      1.01      5.3Â±0.01ms     7.6 MB/sec    1.00      5.3Â±0.02ms     7.7 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.01   1151.5Â±3.99Âµs    14.5 MB/sec    1.00   1144.3Â±2.90Âµs    14.6 MB/sec
linter/default-rules/numpy/globals.py      1.00    132.7Â±2.34Âµs    22.2 MB/sec    1.00    132.1Â±1.60Âµs    22.3 MB/sec
linter/default-rules/pydantic/types.py     1.00      2.4Â±0.01ms    10.6 MB/sec    1.00      2.4Â±0.02ms    10.7 MB/sec
</code></pre>
<h4>Windows</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00     11.9Â±0.29ms     3.4 MB/sec    1.01     12.0Â±0.28ms     3.4 MB/sec
formatter/numpy/ctypeslib.py               1.00      2.3Â±0.07ms     7.3 MB/sec    1.03      2.3Â±0.13ms     7.1 MB/sec
formatter/numpy/globals.py                 1.00   255.3Â±11.24Âµs    11.6 MB/sec    1.01   257.0Â±12.29Âµs    11.5 MB/sec
formatter/pydantic/types.py                1.00      5.0Â±0.15ms     5.1 MB/sec    1.01      5.1Â±0.16ms     5.0 MB/sec
linter/all-rules/large/dataset.py          1.00     15.0Â±0.28ms     2.7 MB/sec    1.02     15.2Â±0.44ms     2.7 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      4.1Â±0.12ms     4.0 MB/sec    1.01      4.1Â±0.10ms     4.0 MB/sec
linter/all-rules/numpy/globals.py          1.00   512.6Â±14.51Âµs     5.8 MB/sec    1.01   515.7Â±17.90Âµs     5.7 MB/sec
linter/all-rules/pydantic/types.py         1.00      7.8Â±0.18ms     3.3 MB/sec    1.01      7.8Â±0.16ms     3.3 MB/sec
linter/default-rules/large/dataset.py      1.00      8.1Â±0.15ms     5.0 MB/sec    1.01      8.2Â±0.13ms     5.0 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1697.9Â±37.91Âµs     9.8 MB/sec    1.01  1712.2Â±64.73Âµs     9.7 MB/sec
linter/default-rules/numpy/globals.py      1.00   195.9Â±11.93Âµs    15.1 MB/sec    1.02   199.6Â±10.26Âµs    14.8 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.6Â±0.07ms     7.0 MB/sec    1.00      3.6Â±0.09ms     7.1 MB/sec
</code></pre>
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-07-31 08:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/src/lib.rs</code>:184 on 2023-07-31 08:50</div>
            <div class="timeline-body"><p>You could implement your own <code>PreorderVisitor</code> that marks the comments of all children as formatted. We probably need something similar for <code>fmt: skip</code> anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-08-01 10:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/src/lib.rs</code>:184 on 2023-08-01 10:13</div>
            <div class="timeline-body"><p>i'll wait until we have match statement formatting instead</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @MichaReiser by @konstin on 2023-08-08 13:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2023-08-08 14:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-08 15:16</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #6422</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6422" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6426</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6426" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6441</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6441" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6178</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6178" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6178?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-08-08 15:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/src/other/match_case.rs</code>:27 on 2023-08-08 15:23</div>
            <div class="timeline-body"><p>This is intentionally ugly to make sure we remove we don't forget to remove the <code>comment.mark_formatted</code> when replacing this with <code>pattern.format()</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @MichaReiser on 2023-08-08 15:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-08 15:24</div>
            <div class="timeline-body"><p>Can I now approve my own PR :sweat_smile:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-08 15:30</div>
            <div class="timeline-body"><p>Â¯\_(ãƒ„)_/Â¯</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2023-08-08 15:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-08 20:26</div>
            <div class="timeline-body"><p>so who'll merge?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-09 06:58</div>
            <div class="timeline-body"><p>I can take care of merging since we have to coordinate with the downstream PRs. All I need is a thumbs up/down from you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-09 07:21</div>
            <div class="timeline-body"><p>:+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-10 07:12</div>
            <div class="timeline-body"><p><a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6178">Graphite</a> rebased this pull request as part of a merge.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2023-08-10 07:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-08-10 07:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-08-10 07:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-10 07:19</div>
            <div class="timeline-body"><p>@MichaReiser merged this pull request with <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6178">Graphite</a>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:59:10 UTC
    </footer>
</body>
</html>
