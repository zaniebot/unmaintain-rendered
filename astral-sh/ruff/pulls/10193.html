<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`] Implement `bad-super-call` (`PLE1003`) - astral-sh/ruff #10193</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pylint</code>] Implement <code>bad-super-call</code> (<code>PLE1003</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10193">#10193</a>
        opened by <a href="https://github.com/chanman3388">@chanman3388</a>
        on 2024-03-02 02:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/chanman3388">@chanman3388</a> on 2024-03-02 02:04</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Implements the <a href="https://pylint.readthedocs.io/en/stable/user_guide/messages/error/bad-super-call.html"><code>bad-super-call</code></a> rule (<code>E1003</code>) from Pylint.</p>
<h2>Test Plan</h2>
<p>A new fixture has been added</p>
<p>Part of #970</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-03-02 02:23</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+3 -0 violations, +0 -0 fixes in 3 projects; 40 projects unchanged)</p>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pandas-dev/pandas/blob/58e63ec12830160c29fde490e7836254068b855e/pandas/core/apply.py#L1578'>pandas/core/apply.py:1578:9:</a> PLE1003 Bad first argument 'GroupByApply' given to super()
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pypa/pip">pypa/pip</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pypa/pip/blob/ae5fff36b0aad6e5e0037884927eaa29163c0611/src/pip/_internal/exceptions.py#L409'>src/pip/_internal/exceptions.py:409:9:</a> PLE1003 Bad first argument 'InstallationSubprocessError' given to super()
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/zulip/zulip/blob/b4d53c7930b01145aa43fef2a8fab5730c8b1bc3/zerver/tests/test_auth_backends.py#L345'>zerver/tests/test_auth_backends.py:345:9:</a> PLE1003 Bad first argument 'UserProfile' given to super()
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLE1003 | 3 | 3 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:80 on 2024-03-04 10:12</div>
            <div class="timeline-body"><p>This seems to be valid python code:</p>
<pre><code class="language-python">class Test:
...     def __init__():
...         super = test
...         
... 
</code></pre>
<p>That means, we have to test if <code>super</code> points to the builtin <code>super</code> call and not a local binding.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:79 on 2024-03-04 10:14</div>
            <div class="timeline-body"><pre><code class="language-suggestion">        if let Expr::Name(ExprName { id, .. }) = &amp;**func {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:10 on 2024-03-04 10:15</div>
            <div class="timeline-body"><pre><code class="language-suggestion">/// Checks to see another argument other than the current class is given as the first argument of the super builtin.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:17 on 2024-03-04 10:15</div>
            <div class="timeline-body"><p>What are the use cases when I would use this rule over <code>super-with-arguments</code> when targeting Python 3+ (the only version ruff supports)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:97 on 2024-03-04 10:18</div>
            <div class="timeline-body"><p>We can avoid the explicit returns</p>
<pre><code class="language-suggestion">        if let Expr::Name(ExprName { id, .. }) = func.as_ref() {
            if id == &quot;super&quot; {
                if let Some(first) = arguments.args.first() {
                    return is_bad_super_call(first, current_class_name).map(|id| {
                        Diagnostic::new(
                            BadSuperCall {
                                bad_super_arg: id.to_owned(),
                            },
                            range.to_owned(),
                        )
                    });
                }
            }
        }
        check_expr(func, current_class_name)
    } else if let Expr::Attribute(ExprAttribute { value, .. }) = expr {
        check_expr(value, current_class_name)
    } else {
        None
    }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:100 on 2024-03-04 10:20</div>
            <div class="timeline-body"><p>I think this will warn about</p>
<pre><code class="language-python">class Test:
    a = super()
</code></pre>
<p>because <code>traverse_body</code> is used to traverse the class and nested function bodies. Is this intentional?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:56 on 2024-03-04 10:21</div>
            <div class="timeline-body"><p>Can we add a test with a nested class to show that it does not traverse into classes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:60 on 2024-03-04 10:21</div>
            <div class="timeline-body"><p>I think the current implementation doesn't catch</p>
<pre><code class="language-python">class Test:
    def test():
        if True:
            super(Tree, self).init()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-03-04 10:22</div>
            <div class="timeline-body"><p>Thanks for working on this rule.</p>
<p>For me, as someone not very proficient in Python, it's unclear when I should use the rule when using Python 3. Is this rule mainly targeted at Python 2 users</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-03-04 10:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chanman3388">@chanman3388</a> on 2024-03-04 11:48</div>
            <div class="timeline-body"><blockquote>
<p>Thanks for working on this rule.</p>
<p>For me, as someone not very proficient in Python, it's unclear when I should use the rule when using Python 3. Is this rule mainly targeted at Python 2 users</p>
</blockquote>
<p>Thanks for the thorough review!
To the best of my knowledge this is meant to be targeted at Python 2 users, though it is still valid syntax for python 3 I believe.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:70 on 2024-03-04 11:58</div>
            <div class="timeline-body"><p>I'd expect a function with a name starting with <code>is_</code> to return <code>bool</code>. Could this function be renamed to something more clear about what it does?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-03-04 12:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-04 13:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:70 on 2024-03-04 13:02</div>
            <div class="timeline-body"><p>Sure, I'll think of something more suitable, maybe...<code>is_bad_super_call_then_some</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-04 22:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:17 on 2024-03-04 22:13</div>
            <div class="timeline-body"><p>I don't think you would to be honest, <code>super-with-arguments</code> is also a &quot;suggestion&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-04 22:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:80 on 2024-03-04 22:34</div>
            <div class="timeline-body"><p>Is there a canonical test for that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-04 22:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:100 on 2024-03-04 22:36</div>
            <div class="timeline-body"><p>I checked it and it doesn't.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-04 22:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:100 on 2024-03-04 22:37</div>
            <div class="timeline-body"><pre><code>$ cat bad_super.py
class Something:
    pass


class Test:
    def __init__(self):
        super = test


class O(Test):
    def __init__(self):
        super(Something, self).__init__()


class Test2:
    a = super()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-04 22:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:100 on 2024-03-04 22:37</div>
            <div class="timeline-body"><pre><code>$ cargo run -p ruff -- check bad_super.py --no-cache --preview --select PLE1003
   Compiling ruff_linter v0.3.0 (/home/chris/projects/ruff/crates/ruff_linter)
   Compiling ruff_workspace v0.0.0 (/home/chris/projects/ruff/crates/ruff_workspace)
   Compiling ruff v0.3.0 (/home/chris/projects/ruff/crates/ruff)
    Finished dev [unoptimized + debuginfo] target(s) in 14.73s
     Running `target/debug/ruff check bad_super.py --no-cache --preview --select PLE1003`
bad_super.py:12:9: PLE1003 Bad first argument 'Something' given to super()
   |
10 | class O(Test):
11 |     def __init__(self):
12 |         super(Something, self).__init__()
   |         ^^^^^^^^^^^^^^^^^^^^^^ PLE1003
   |

Found 1 error.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-05 00:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:60 on 2024-03-05 00:15</div>
            <div class="timeline-body"><p>Good catch</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-05 00:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:56 on 2024-03-05 00:58</div>
            <div class="timeline-body"><p>Something I had to ask about the nested class, why should we not traverse a nested class? Pylint doesn't pick up on it does it seem like it should?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-05 01:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:56 on 2024-03-05 01:07</div>
            <div class="timeline-body"><pre><code>class Tree:
    &quot;&quot;&quot;something&quot;&quot;&quot;


class Animal:
    &quot;&quot;&quot;animal&quot;&quot;&quot;


class A:
    def __init__(self):
        class B(Tree):
            def __init__(self):
                super(Tree, self).__init__()

            def ho(self):
                print(&quot;a&quot;)

        self.b = B()


if __name__ == &quot;__main__&quot;:
    a = A()
    a.b.ho()
</code></pre>
<p>This runs fine, but if you swap out the <code>Tree</code> for <code>Animal</code> for the inner class <code>B</code> you get:</p>
<pre><code>Traceback (most recent call last):
  File &quot;/home/chris/projects/ruff/bad_super.py&quot;, line 22, in &lt;module&gt;
    a = A()
        ^^^
  File &quot;/home/chris/projects/ruff/bad_super.py&quot;, line 18, in __init__
    self.b = B()
             ^^^
  File &quot;/home/chris/projects/ruff/bad_super.py&quot;, line 13, in __init__
    super(Animal, self).__init__()
    ^^^^^^^^^^^^^^^^^^^
TypeError: super(type, obj): obj must be an instance or subtype of type
</code></pre>
<p>So it feels like we should actually pick up on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-05 01:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/src/rules/pylint/rules/bad_super_call.rs</code>:100 on 2024-03-05 01:12</div>
            <div class="timeline-body"><p>I am aware that I should also add all the other statements where it's possible that a <code>class</code> might be defined, I'll get on this next time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @chanman3388 on 2024-03-05 01:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-03-05 09:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:56 on 2024-03-05 09:11</div>
            <div class="timeline-body"><p>It depends on how the rule is supposed to work. I would expect that the <code>Checker</code> calls the rule for every class. That means that nested classes are covered by the <code>Checker</code> and we should not traverse nested classes too avoid flagging/traversing it twice. But maybe I misread how the rule is supposed to work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-05 09:12</div>
            <div class="timeline-body"><p>We're currently discussing internally if we want to support rules targeting Python 2. I recommend holding of with any changes until we get back to you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chanman3388">@chanman3388</a> reviewed on 2024-03-05 10:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/chanman3388">@chanman3388</a> on <code>crates/ruff_linter/resources/test/fixtures/pylint/bad_super_call.py</code>:56 on 2024-03-05 10:33</div>
            <div class="timeline-body"><p>Hm, I believe that when I call ruff on the file that it should be calling the Checker once on the top level class, and once on the inner class...I can check this if you give the go-ahead for the rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 17:47</div>
            <div class="timeline-body"><p>Hy @chanman3388</p>
<p>Thanks for implementing the rule. After discussing this internally, we decided not to support rules that mainly target Python 2, mainly because Python 2 has been EOL for a very long time (and is not supported by Ruff), and because of that, it doesn't feel worth maintaining the rule going forward.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-03-28 17:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chanman3388">@chanman3388</a> on 2024-03-28 17:49</div>
            <div class="timeline-body"><blockquote>
<p>Hy @chanman3388</p>
<p>Thanks for implementing the rule. After discussing this internally, we decided not to support rules that mainly target Python 2, mainly because Python 2 has been EOL for a very long time (and is not supported by Ruff), and because of that, it doesn't feel worth maintaining the rule going forward.</p>
</blockquote>
<p>Could we indicate as such in the issue? I mean both crossing out the rule as well as adding a note to leave it up to contributors to judge if a rule primarily targets python 2 also.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 17:53</div>
            <div class="timeline-body"><p>Oh yeah sorry. I should have done that. Thanks for reminding me.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:47:53 UTC
    </footer>
</body>
</html>
