<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avoid `C417` for `lambda` with default and variadic parameters - astral-sh/ruff #6752</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Avoid <code>C417</code> for <code>lambda</code> with default and variadic parameters</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/6752">#6752</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2023-08-22 04:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Avoid <code>C417</code> for <code>lambda</code> with default and variadic parameters.</p>
<h2>Test Plan</h2>
<p><code>cargo test</code> and checking if it generates any autofix errors as test cases
for <code>lambda</code> with default parameters already exists.</p>
<p>fixes: #6715</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-08-22 04:22</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #6752</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6752" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.svg" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6752?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-08-22 04:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:116 on 2023-08-22 04:22</div>
            <div class="timeline-body"><p>Would it be useful to have this as a method on <code>Parameters</code> node? (<code>has_defaults</code>?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @dhruvmanila on 2023-08-22 04:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-08-22 04:36</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Ecosystem</h3>
<p>âœ… ecosystem check detected no changes.</p>
<h3>Benchmark</h3>
<h4>Linux</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      3.7Â±0.13ms    10.9 MB/sec    1.01      3.8Â±0.10ms    10.8 MB/sec
formatter/numpy/ctypeslib.py               1.00   785.3Â±18.37Âµs    21.2 MB/sec    1.01   791.8Â±20.09Âµs    21.0 MB/sec
formatter/numpy/globals.py                 1.00     84.2Â±3.18Âµs    35.0 MB/sec    1.02     85.9Â±3.08Âµs    34.4 MB/sec
formatter/pydantic/types.py                1.00  1532.1Â±54.52Âµs    16.6 MB/sec    1.01  1541.2Â±43.76Âµs    16.5 MB/sec
linter/all-rules/large/dataset.py          1.00     11.1Â±0.22ms     3.7 MB/sec    1.01     11.2Â±0.23ms     3.6 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.02      3.1Â±0.07ms     5.3 MB/sec    1.00      3.1Â±0.06ms     5.4 MB/sec
linter/all-rules/numpy/globals.py          1.01   435.5Â±10.76Âµs     6.8 MB/sec    1.00   430.9Â±10.94Âµs     6.8 MB/sec
linter/all-rules/pydantic/types.py         1.00      5.9Â±0.18ms     4.3 MB/sec    1.03      6.1Â±0.17ms     4.2 MB/sec
linter/default-rules/large/dataset.py      1.00      6.1Â±0.15ms     6.7 MB/sec    1.01      6.1Â±0.13ms     6.7 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1340.7Â±41.72Âµs    12.4 MB/sec    1.01  1351.3Â±30.23Âµs    12.3 MB/sec
linter/default-rules/numpy/globals.py      1.02    157.1Â±3.86Âµs    18.8 MB/sec    1.00    154.3Â±4.06Âµs    19.1 MB/sec
linter/default-rules/pydantic/types.py     1.00      2.8Â±0.07ms     9.2 MB/sec    1.00      2.8Â±0.08ms     9.2 MB/sec
</code></pre>
<h4>Windows</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      3.8Â±0.07ms    10.7 MB/sec    1.03      3.9Â±0.08ms    10.5 MB/sec
formatter/numpy/ctypeslib.py               1.00   767.7Â±19.84Âµs    21.7 MB/sec    1.02   783.7Â±19.09Âµs    21.2 MB/sec
formatter/numpy/globals.py                 1.00     78.8Â±1.49Âµs    37.5 MB/sec    1.05     82.7Â±3.02Âµs    35.7 MB/sec
formatter/pydantic/types.py                1.00  1533.0Â±25.87Âµs    16.6 MB/sec    1.03  1574.3Â±37.07Âµs    16.2 MB/sec
linter/all-rules/large/dataset.py          1.00     13.1Â±0.22ms     3.1 MB/sec    1.01     13.2Â±0.14ms     3.1 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      3.5Â±0.05ms     4.7 MB/sec    1.01      3.6Â±0.05ms     4.7 MB/sec
linter/all-rules/numpy/globals.py          1.00    443.8Â±7.18Âµs     6.6 MB/sec    1.00    445.5Â±5.46Âµs     6.6 MB/sec
linter/all-rules/pydantic/types.py         1.00      6.8Â±0.11ms     3.8 MB/sec    1.03      7.0Â±0.13ms     3.6 MB/sec
linter/default-rules/large/dataset.py      1.00      7.2Â±0.08ms     5.7 MB/sec    1.04      7.5Â±0.09ms     5.4 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1516.6Â±15.92Âµs    11.0 MB/sec    1.04  1578.9Â±36.20Âµs    10.5 MB/sec
linter/default-rules/numpy/globals.py      1.00    175.6Â±3.90Âµs    16.8 MB/sec    1.03    180.1Â±4.17Âµs    16.4 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.2Â±0.04ms     7.9 MB/sec    1.03      3.3Â±0.05ms     7.6 MB/sec
</code></pre>
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-08-22 14:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:206 on 2023-08-22 14:10</div>
            <div class="timeline-body"><p>Should we also avoid starred arguments and kwargs?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-08-22 15:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:116 on 2023-08-22 15:56</div>
            <div class="timeline-body"><p>I think what we have here is reasonable, maybe if we find ourselves doing this in at least one other place.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-08-22 17:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:206 on 2023-08-22 17:01</div>
            <div class="timeline-body"><p>Yeah, we should otherwise the fix isn't correct either:</p>
<pre><code class="language-python">map(lambda *x: len(x), nums)

# Gets fixed to 
(len(x) for _ in nums)  # where's x?
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-08-22 17:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:220 on 2023-08-22 17:16</div>
            <div class="timeline-body"><p>I think I'd vote not to flag this at all -- wdyt? Also should simplify the implementation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-08-22 17:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:220 on 2023-08-22 17:26</div>
            <div class="timeline-body"><p>Interestingly I was just playing around with that asking the same question. Why should we flag it if it isn't fixable (not from an implementation side but from the user side)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:220 on 2023-08-22 17:32</div>
            <div class="timeline-body"><p>Yeah, I'd go for the same route of not flagging this in the first place. Also, the fix would not yield the same result:</p>
<pre><code class="language-python">In [1]: nums = [[0, 1, 2, 3], [4, 5, 6]]

In [2]: list(map(lambda x, *y: y, nums))
Out[2]: [(), ()]

In [3]: [y for x, *y in nums]
Out[3]: [[1, 2, 3], [5, 6]]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-08-22 17:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-08-22 17:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:220 on 2023-08-22 17:38</div>
            <div class="timeline-body"><p>(Sorry for not mentioning this on the first review.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Avoid `C417` autofix for `lambda` with default parameters" to "Avoid `C417` for `lambda` with default and variadic parameters" by @dhruvmanila on 2023-08-22 17:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2023-08-22 17:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:220 on 2023-08-22 17:43</div>
            <div class="timeline-body"><p>No problem at all :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_comprehensions/rules/unnecessary_map.rs</code>:108 on 2023-08-22 18:17</div>
            <div class="timeline-body"><p>Nit: Let's revert to the <code>is_some_and</code> pattern, I think we intentionally migrated towards that style?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2023-08-22 18:17</div>
            <div class="timeline-body"><p>Thx!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dhruvmanila on 2023-08-22 19:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2023-08-22 19:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-08-22 19:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:59:42 UTC
    </footer>
</body>
</html>
