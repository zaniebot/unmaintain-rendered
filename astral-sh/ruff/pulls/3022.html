<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[pylint] redefined-loop-name (W2901) - astral-sh/ruff #3022</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[pylint] redefined-loop-name (W2901)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/3022">#3022</a>
        opened by <a href="https://github.com/matthewlloyd">@matthewlloyd</a>
        on 2023-02-19 01:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a></div>
            <div class="timeline-body"><p>Slightly broadens W2901 to cover <code>with</code> statements too.</p>
<p>Closes #2972.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sbrugman">@sbrugman</a> reviewed on 2023-02-19 10:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sbrugman">@sbrugman</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:69 on 2023-02-19 10:16</div>
            <div class="timeline-body"><p>Please add documentation here (so that the rule docs can be autogenerated). For an example, look at <a href="https://beta.ruff.rs/docs/rules/yield-in-init/">yield-in-init (PLE0100)</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-02-19 16:29</div>
            <div class="timeline-body"><p>Perhaps update the pylint issue with your findings, quite some nice insights (since it will be closed when merging this)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-19 19:08</div>
            <div class="timeline-body"><blockquote>
<p>Perhaps update the pylint issue with your findings, quite some nice insights (since it will be closed when merging this)</p>
</blockquote>
<p>Done, and opened a new issue with the potential PyCharm-derived inspections: <a href="https://github.com/charliermarsh/ruff/issues/3040">charliermarsh/ruff#3040</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:110 on 2023-02-19 19:31</div>
            <div class="timeline-body"><p>Since these are ultimately passed to <code>extend</code>, can this return an iterator rather than a vector?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-19 19:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-19 19:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:57 on 2023-02-19 19:32</div>
            <div class="timeline-body"><p>Could we make the &quot;binding kind&quot; a parameter on <code>RedefinedLoopName</code>, and use it to narrow this message? (<code>DeferralKeyword</code> in <code>crates/ruff/src/rules/pyflakes/rules/yield_outside_function.rs</code> would be an example of what that might look like.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-19 19:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/resources/test/fixtures/pylint/redefined_loop_name.py</code>:1 on 2023-02-19 19:32</div>
            <div class="timeline-body"><p>(Just out of interest, was this taken from Pylint or is it original?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-19 19:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:182 on 2023-02-19 19:32</div>
            <div class="timeline-body"><p>(Just out of interest, how closely does this match Pylint&#x27;s own implementation? Did you look at the Pylint source, or is it implemented from scratch?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-19 19:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:93 on 2023-02-19 19:33</div>
            <div class="timeline-body"><p>Do we need to avoid recursing in any cases? E.g., what if we enter a function or class definition?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-19 20:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:110 on 2023-02-19 20:54</div>
            <div class="timeline-body"><p>Done - I modified <code>find_names</code> to return an iterator too to avoid the vector allocation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-19 20:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:57 on 2023-02-19 20:54</div>
            <div class="timeline-body"><p>Working on this now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-19 20:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/resources/test/fixtures/pylint/redefined_loop_name.py</code>:1 on 2023-02-19 20:55</div>
            <div class="timeline-body"><p>It&#x27;s original.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-19 21:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:182 on 2023-02-19 21:01</div>
            <div class="timeline-body"><p>It was implemented from scratch, but after I learned Pylint has it too, I did look at the Pylint source later to compare. Pylint has a slightly more efficient algorithm, using a single recursion over the AST, keeping track of defined names using a stack, and pushing and popping the names on entering and leaving each for loop. This could probably be done with a deeper integration into <code>ast.rs</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-19 21:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:93 on 2023-02-19 21:01</div>
            <div class="timeline-body"><p>Great point! Added exclusions for function and class definitions since they have their own scopes, after confirming that is the correct thing to do by running some quick examples.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-19 21:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:57 on 2023-02-19 21:52</div>
            <div class="timeline-body"><p>Done. Example messages:</p>
<pre><code>test.py:2:9: PLW2901 Outer for loop variable `i` overwritten by for loop target with same name
test.py:6:9: PLW2901 Outer with statement variable `i` overwritten by for loop target with same name
test.py:12:5: PLW2901 Outer for loop variable `i` overwritten by assignment target with same name
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-20 17:50</div>
            <div class="timeline-body"><p>So I just ran this over Zulip as a smoke test, and it looks like the rule is currently flagging usages like this:</p>
<pre><code>for email in verified_emails:
    existing_account = common_get_active_user(email, realm, {})
    if existing_account is not None:
        existing_account_emails.append(email)
        avatars[email] = avatar_url(existing_account)
</code></pre>
<p>Also attribute assignments, like <code>scope.fingerprint = [&quot;worker-timeout&quot;, self.queue_name]</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-20 17:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:145 on 2023-02-20 17:52</div>
            <div class="timeline-body"><p>I think it&#x27;d be better to avoid the lexer here, I&#x27;m guessing it&#x27;s the cause of the false positives. Can we instead look for <code>ExprKind::Name</code> references with <code>ExprContext::Store</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-20 18:30</div>
            <div class="timeline-body"><p>Oh gosh, great point! I will know to run on some larger codebases when testing in future. Agreed, we need to avoid the lexer and traverse the AST of the target. It&#x27;s really interesting learning new intricacies of Python syntax. I had never considered these, for example:</p>
<pre><code>&gt;&gt;&gt; d = {}
&gt;&gt;&gt; for d[&quot;i&quot;] in range(2):
...     print(d[&quot;i&quot;])
...
0
1
&gt;&gt;&gt; a = [None]
&gt;&gt;&gt; for a[0] in range(2):
...     print(a[0])
...
0
1
&gt;&gt;&gt; i = 0
&gt;&gt;&gt; for a[i] in range(2):
...     print(a[i])
...     i = 0  # no error
...
0
1
</code></pre>
<p>I&#x27;ll try to think through all these edge cases, add tests, and get this fixed later today or tomorrow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-20 18:35</div>
            <div class="timeline-body"><p>No rush! Sorry for not noticing this earlier :) Let me know if you have questions as you work through it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:145 on 2023-02-21 03:34</div>
            <div class="timeline-body"><p>Done. I&#x27;m comparing the target expressions structurally, while still respecting unpacking of tuples and lists, which resolves the false positives you mentioned.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-21 03:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-21 03:56</div>
            <div class="timeline-body"><p>Ran this new version on Zulip - still quite a few &quot;false positives&quot;, only a few of which are IMO bad code smells. The most noisy false positives tend to be of the form:</p>
<pre><code>for line in file:
    line = line.strip()  # PLW2901
</code></pre>
<p>which are flagged by Pylint&#x27;s redefined-loop-name extension and by my code here, but which in practice are of course commonplace and harmless, and where the developer has to jump through an annoying hoop to avoid the warning e.g. using a new <code>stripped_line</code> name. I&#x27;m in two minds about whether these should always be flagged, or whether reuse by direct assignment should be optional or under a different code.</p>
<p>On the other extreme we have this (from queue_processors.py) which <em>does</em> seem worth flagging, since another developer may not remember Python&#x27;s unique scope rules and might add code that uses the outer <code>scope</code> variable without realizing it has been overwritten:</p>
<pre><code>        with configure_scope() as scope:
            scope.set_context(
              # ...
            )
            if isinstance(exception, WorkerTimeoutError):
                with sentry_sdk.push_scope() as scope:  # PLW2901
                    scope.fingerprint = [&quot;worker-timeout&quot;, self.queue_name]
                    logging.exception(exception, stack_info=True)
            else:
                logging.exception(
                    &quot;Problem handling data on queue %s&quot;, self.queue_name, stack_info=True
                )
</code></pre>
<p>Similarly we have cases like this one (from test_openapi.py) where the code works and is correct, but again another developer may add code to the outer loop expecting <code>element</code> to still be from <code>diff</code> and get tripped up:</p>
<pre><code>        for element in diff:
            vname = element[0]
            for element in openapi_params:  # PLW2901
                if element[0] == vname:
                    opvtype = element[1]
                    break
            for element in function_params:  # PLW2901
                if element[0] == vname:
                    fdvtype = element[1]
                    break
</code></pre>
<p>Finally we have an example in between (from rocketchat.py), where the name reuse is gratuitous, and while not an actual type error, arguably a notional error in regards to the &quot;semantic type&quot; of <code>reaction_dict</code> (by which I mean what keys are present and what the associated values represent). A developer adding code to the outer loop seems unlikely get tripped up here, but I&#x27;d say it&#x27;s still worth flagging since finding a new name improves readability:</p>
<pre><code>    for reaction_dict in reactions:
        emoji_name = reaction_dict[&quot;name&quot;]
        user_id = reaction_dict[&quot;user_id&quot;]
        # Check in realm emoji
        if emoji_name in realmemoji:
          # ...

        reaction_id = NEXT_ID(&quot;reaction&quot;)
        reaction = Reaction(
          # ...
        )

        reaction_dict = model_to_dict(reaction, exclude=[&quot;message&quot;, &quot;user_profile&quot;])  # PLW2901
        reaction_dict[&quot;message&quot;] = message_id
        reaction_dict[&quot;user_profile&quot;] = user_id
        total_reactions.append(reaction_dict)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-21 17:07</div>
            <div class="timeline-body"><p>Awesome! Will review this shortly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-21 20:11</div>
            <div class="timeline-body"><p>I agree with the analysis in your comment. One other lens to apply here: where does this version deviate from Pylint, and where is it the same? (The less it deviates, the less strongly I feel about things that might feel excessive in practice.) (I know you mention that Pylint flags the first example -- wondering if it&#x27;s the case for the others too.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-21 20:27</div>
            <div class="timeline-body"><blockquote>
<p>I agree with the analysis in your comment. One other lens to apply here: where does this version deviate from Pylint, and where is it the same? (The less it deviates, the less strongly I feel about things that might feel excessive in practice.) (I know you mention that Pylint flags the first example -- wondering if it&#x27;s the case for the others too.)</p>
</blockquote>
<p>Good question. As the code currently stands, for the Zulip codebase, this version exactly matches Pylint with the only difference being this version works not just for <code>for</code> but also for <code>with</code> statements.</p>
<p>This version finds 35 (34 <code>for</code> + 1 <code>with</code>):</p>
<pre><code>zulip/manage.py:90:21: PLW2901 Outer for loop variable `app` overwritten by inner assignment target with same name
zulip/manage.py:92:21: PLW2901 Outer for loop variable `app` overwritten by inner assignment target with same name
zulip/scripts/lib/check_rabbitmq_queue.py:142:9: PLW2901 Outer for loop variable `line` overwritten by inner assignment target with same name
zulip/scripts/lib/setup_venv.py:110:13: PLW2901 Outer for loop variable `package` overwritten by inner assignment target with same name
zulip/scripts/lib/setup_venv.py:114:17: PLW2901 Outer for loop variable `package` overwritten by inner assignment target with same name
zulip/scripts/lib/setup_venv.py:116:9: PLW2901 Outer for loop variable `package` overwritten by inner assignment target with same name
zulip/scripts/lib/zulip_tools.py:429:13: PLW2901 Outer for loop variable `line` overwritten by inner assignment target with same name
zulip/tools/lib/capitalization.py:235:9: PLW2901 Outer for loop variable `text` overwritten by inner assignment target with same name
zulip/tools/lib/html_branches.py:46:17: PLW2901 Outer for loop variable `lst` overwritten by inner assignment target with same name
zulip/tools/lib/test_script.py:99:9: PLW2901 Outer for loop variable `file` overwritten by inner assignment target with same name
zulip/zerver/data_import/rocketchat.py:363:9: PLW2901 Outer for loop variable `reaction_dict` overwritten by inner assignment target with same name
zulip/zerver/lib/ccache.py:112:13: PLW2901 Outer for loop variable `tlv` overwritten by inner assignment target with same name
zulip/zerver/lib/events.py:1084:25: PLW2901 Outer for loop variable `sub` overwritten by inner assignment target with same name
zulip/zerver/lib/markdown/__init__.py:1273:21: PLW2901 Outer for loop variable `found_url` overwritten by inner assignment target with same name
zulip/zerver/lib/narrow.py:643:17: PLW2901 Outer for loop variable `term` overwritten by inner assignment target with same name
zulip/zerver/lib/narrow.py:644:17: PLW2901 Outer for loop variable `term` overwritten by inner assignment target with same name
zulip/zerver/lib/test_runner.py:335:21: PLW2901 Outer for loop variable `test_name` overwritten by inner assignment target with same name
zulip/zerver/lib/test_runner.py:348:29: PLW2901 Outer for loop variable `test_name` overwritten by inner assignment target with same name
zulip/zerver/management/commands/enqueue_file.py:17:9: PLW2901 Outer for loop variable `line` overwritten by inner assignment target with same name
zulip/zerver/management/commands/import.py:88:13: PLW2901 Outer for loop variable `path` overwritten by inner assignment target with same name
zulip/zerver/management/commands/makemessages.py:168:17: PLW2901 Outer for loop variable `match` overwritten by inner assignment target with same name
zulip/zerver/management/commands/makemessages.py:169:17: PLW2901 Outer for loop variable `match` overwritten by inner assignment target with same name
zulip/zerver/migrations/0102_convert_muted_topic.py:32:13: PLW2901 Outer for loop variable `stream_name` overwritten by inner assignment target with same name
zulip/zerver/migrations/0102_convert_muted_topic.py:53:13: PLW2901 Outer for loop variable `stream_name` overwritten by inner assignment target with same name
zulip/zerver/migrations/0423_fix_email_gateway_attachment_owner.py:113:13: PLW2901 Outer for loop variable `attachment` overwritten by inner assignment target with same name
zulip/zerver/openapi/openapi.py:468:17: PLW2901 Outer for loop variable `error` overwritten by inner assignment target with same name
zulip/zerver/openapi/test_curl_examples.py:86:17: PLW2901 Outer for loop variable `curl_command_text` overwritten by inner assignment target with same name
zulip/zerver/tests/test_decorators.py:2036:17: PLW2901 Outer for loop variable `line` overwritten by inner assignment target with same name
zulip/zerver/tests/test_openapi.py:376:17: PLW2901 Outer for loop variable `element` overwritten by inner for loop target with same name
zulip/zerver/tests/test_openapi.py:380:17: PLW2901 Outer for loop variable `element` overwritten by inner for loop target with same name
zulip/zerver/tests/test_openapi.py:439:13: PLW2901 Outer for loop variable `defval` overwritten by inner assignment target with same name
zulip/zerver/views/invite.py:104:13: PLW2901 Outer for loop variable `email` overwritten by inner assignment target with same name
zulip/zerver/webhooks/bitbucket2/view.py:437:13: PLW2901 Outer for loop variable `change` overwritten by inner assignment target with same name
zulip/zerver/worker/queue_processors.py:378:49: PLW2901 Outer with statement variable `scope` overwritten by inner with statement target with same name
</code></pre>
<p>Pylint finds 34 (34 <code>for</code>):</p>
<pre><code>zulip/manage.py:90:20: W2901: Redefining &#x27;app&#x27; from loop (line 88) (redefined-loop-name)
zulip/manage.py:92:20: W2901: Redefining &#x27;app&#x27; from loop (line 88) (redefined-loop-name)
zulip/scripts/lib/check_rabbitmq_queue.py:142:8: W2901: Redefining &#x27;line&#x27; from loop (line 141) (redefined-loop-name)
zulip/scripts/lib/setup_venv.py:110:12: W2901: Redefining &#x27;package&#x27; from loop (line 104) (redefined-loop-name)
zulip/scripts/lib/setup_venv.py:114:16: W2901: Redefining &#x27;package&#x27; from loop (line 104) (redefined-loop-name)
zulip/scripts/lib/setup_venv.py:116:8: W2901: Redefining &#x27;package&#x27; from loop (line 104) (redefined-loop-name)
zulip/scripts/lib/zulip_tools.py:429:12: W2901: Redefining &#x27;line&#x27; from loop (line 428) (redefined-loop-name)
zulip/tools/lib/capitalization.py:235:8: W2901: Redefining &#x27;text&#x27; from loop (line 234) (redefined-loop-name)
zulip/tools/lib/html_branches.py:46:16: W2901: Redefining &#x27;lst&#x27; from loop (line 42) (redefined-loop-name)
zulip/tools/lib/test_script.py:99:8: W2901: Redefining &#x27;file&#x27; from loop (line 98) (redefined-loop-name)
zulip/zerver/data_import/rocketchat.py:363:8: W2901: Redefining &#x27;reaction_dict&#x27; from loop (line 341) (redefined-loop-name)
zulip/zerver/lib/ccache.py:112:12: W2901: Redefining &#x27;tlv&#x27; from loop (line 106) (redefined-loop-name)
zulip/zerver/lib/events.py:1084:24: W2901: Redefining &#x27;sub&#x27; from loop (line 1081) (redefined-loop-name)
zulip/zerver/lib/markdown/__init__.py:1273:20: W2901: Redefining &#x27;found_url&#x27; from loop (line 1244) (redefined-loop-name)
zulip/zerver/lib/narrow.py:643:16: W2901: Redefining &#x27;term&#x27; from loop (line 641) (redefined-loop-name)
zulip/zerver/lib/narrow.py:644:16: W2901: Redefining &#x27;term&#x27; from loop (line 641) (redefined-loop-name)
zulip/zerver/lib/test_runner.py:335:20: W2901: Redefining &#x27;test_name&#x27; from loop (line 332) (redefined-loop-name)
zulip/zerver/lib/test_runner.py:348:28: W2901: Redefining &#x27;test_name&#x27; from loop (line 332) (redefined-loop-name)
zulip/zerver/management/commands/enqueue_file.py:17:8: W2901: Redefining &#x27;line&#x27; from loop (line 16) (redefined-loop-name)
zulip/zerver/management/commands/import.py:88:12: W2901: Redefining &#x27;path&#x27; from loop (line 87) (redefined-loop-name)
zulip/zerver/management/commands/makemessages.py:168:16: W2901: Redefining &#x27;match&#x27; from loop (line 167) (redefined-loop-name)
zulip/zerver/management/commands/makemessages.py:169:16: W2901: Redefining &#x27;match&#x27; from loop (line 167) (redefined-loop-name)
zulip/zerver/migrations/0102_convert_muted_topic.py:32:12: W2901: Redefining &#x27;stream_name&#x27; from loop (line 31) (redefined-loop-name)
zulip/zerver/migrations/0102_convert_muted_topic.py:53:12: W2901: Redefining &#x27;stream_name&#x27; from loop (line 52) (redefined-loop-name)
zulip/zerver/migrations/0423_fix_email_gateway_attachment_owner.py:113:12: W2901: Redefining &#x27;attachment&#x27; from loop (line 42) (redefined-loop-name)
zulip/zerver/openapi/openapi.py:468:16: W2901: Redefining &#x27;error&#x27; from loop (line 447) (redefined-loop-name)
zulip/zerver/openapi/test_curl_examples.py:86:16: W2901: Redefining &#x27;curl_command_text&#x27; from loop (line 85) (redefined-loop-name)
zulip/zerver/tests/test_decorators.py:2036:16: W2901: Redefining &#x27;line&#x27; from loop (line 2035) (redefined-loop-name)
zulip/zerver/tests/test_openapi.py:376:12: W2901: Redefining &#x27;element&#x27; from loop (line 374) (redefined-loop-name)
zulip/zerver/tests/test_openapi.py:380:12: W2901: Redefining &#x27;element&#x27; from loop (line 374) (redefined-loop-name)
zulip/zerver/tests/test_openapi.py:439:12: W2901: Redefining &#x27;defval&#x27; from loop (line 438) (redefined-loop-name)
zulip/zerver/views/invite.py:104:12: W2901: Redefining &#x27;email&#x27; from loop (line 101) (redefined-loop-name)
zulip/zerver/webhooks/bitbucket2/view.py:437:12: W2901: Redefining &#x27;change&#x27; from loop (line 433) (redefined-loop-name)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-21 20:36</div>
            <div class="timeline-body"><p>Ok cool, I&#x27;m happy with that level of parity then. I&#x27;ll move on to reviewing the actual code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-21 20:37</div>
            <div class="timeline-body"><p>This raises a couple of questions in my mind learning Ruff&#x27;s &quot;best practices&quot;:</p>
<ul>
<li>Are rules in different sets allowed to overlap?</li>
<li>Do reimplementations of rules from other packages need to exactly match them in semantics?</li>
</ul>
<p>If rules can overlap, perhaps one way out of the dilemma would be to have two rules which share the same codebase:</p>
<ul>
<li>PLW2901, which <em>exactly</em> matches Pylint:<ul>
<li><code>for</code> loops only, no <code>with</code></li>
<li>reuse as a <code>for</code> loop variable is disallowed (signal)</li>
<li>reuse in assignment is disallowed (noisy)</li>
</ul>
</li>
<li>RUF???, which offers a more useful and practical compromise:<ul>
<li><code>for</code> loops <strong>and <code>with</code> statements</strong></li>
<li>reuse as a <code>for</code> loop <strong>or <code>with</code> variable</strong> is disallowed (enhanced signal)</li>
<li>reuse in assignment is <strong>allowed</strong> (cut the noise, but possibly with an option for pedants to disallow these too)</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-21 21:50</div>
            <div class="timeline-body"><p>Good questions!</p>
<blockquote>
<p>Are rules in different sets allowed to overlap?</p>
</blockquote>
<p>It&#x27;s not strictly forbidden but we try to avoid this. In fact over time we&#x27;ve actually removed some rules that turned out to be duplicates.</p>
<blockquote>
<p>Do reimplementations of rules from other packages need to exactly match them in semantics?</p>
</blockquote>
<p>No, but we try to be intentional about deviations (so the upstream package is seen as the reference implementation, and any deviations should be intentional).</p>
<p>We often deviate in the case of clear bugs or Pareto improvements (strictly fewer false positives or false negatives).</p>
<p>There&#x27;s also some precedent for deviating with Pylint rules specifically. For example, we changed the defaults in the magic-value checks to avoid flagging comparisons to string and bytes, which felt noisy. (That&#x27;s another strategy: deviate by way of configuration.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-21 23:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:165 on 2023-02-21 23:40</div>
            <div class="timeline-body"><p>Another approach would be to pass in a mutable vector, and have the various arms push to it. Would that work? Perhaps not as nice conceptually, but a bit simpler.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-21 23:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:266 on 2023-02-21 23:43</div>
            <div class="timeline-body"><p>I think preferable to just omit these if you&#x27;re already using <code>..</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-21 23:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:176 on 2023-02-21 23:44</div>
            <div class="timeline-body"><p>If I understand correctly, subscripts and attributes can never appear in the <code>with</code>, <code>for</code>, etc. bindings. So can these ever trigger a violation? Could we just omit them, and only include <code>ExprKind::Name</code> nodes here? That would simplify the <code>// Compute the textual name of the outer target lazily.</code> step below, since we could just use the name&#x27;s <code>id</code> attribute rather than extracting from the source code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:176 on 2023-02-22 01:12</div>
            <div class="timeline-body"><p>Surprisingly, they very much can, both for attributes and subscripts. I didn&#x27;t know this either until I tried it! I have never seen this in real code, but it&#x27;s valid Python, and it works:</p>
<pre><code>In [1]: class A:
   ...:     pass
   ...: a = A()

In [2]: for a.i in range(5):
   ...:     for a.i in range(1):  # PLW2901
   ...:         print(a.i)
   ...:
0
0
0
0
0

In [3]: a = {}

In [4]: for a[&quot;i&quot;] in range(5):
   ...:     for a[&quot;i&quot;] in range(1):  # PLW2901
   ...:         print(a[&quot;i&quot;])
   ...:
0
0
0
0
0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-22 01:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-22 01:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:165 on 2023-02-22 01:23</div>
            <div class="timeline-body"><p>Certainly could, but may be less efficient overall because it will require an additional temporary vector for each call. This is because the outputs of these methods can&#x27;t be pushed directly to the InnerForWithAssignTargetsVisitor.assignment_targets vector as they first need to be paired with the appropriate BindingKind variant by the caller, which depends on the call path; so the intermediate Vec&lt;Expr&gt; would be immediately discarded each time.</p>
<p>On the other hand, I suppose the Boxes also necessitate a heap allocation, albeit one that has a fixed size and doesn&#x27;t get expanded...</p>
<p>An alternative would be to pass in both a &amp;mut Vec, and also the BindingKind, to these methods, and have them push ExprWithBindingKind into the vector.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:266 on 2023-02-22 01:25</div>
            <div class="timeline-body"><p>Done.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-22 01:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:176 on 2023-02-22 02:59</div>
            <div class="timeline-body"><p>What?? You&#x27;re kidding me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 02:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:68 on 2023-02-22 03:00</div>
            <div class="timeline-body"><p>We tend to wrap these at 80 characters. I can go ahead and wrap it manually.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 03:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:300 on 2023-02-22 03:07</div>
            <div class="timeline-body"><p>In that case, this could do slightly strange things:</p>
<pre><code>for a[
    &quot;i&quot;
] in y:
    pass
</code></pre>
<p>So in that case, we&#x27;d end up including the newlines in the violation message. But seems like an edge case...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 03:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 03:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:300 on 2023-02-22 03:08</div>
            <div class="timeline-body"><p>We <em>could</em> instead use <code>unparse_expr</code> to turn the AST node into a string.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:300 on 2023-02-22 03:12</div>
            <div class="timeline-body"><p>I&#x27;m kind of partial to this -- what do you think?</p>
<pre><code>diff --git a/crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs b/crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs
index ff538d30e..eb383358c 100644
--- a/crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs
+++ b/crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs
@@ -1,4 +1,5 @@
 use crate::ast::comparable::ComparableExpr;
+use crate::ast::helpers::unparse_expr;
 use crate::ast::types::{Node, Range};
 use crate::ast::visitor;
 use crate::ast::visitor::Visitor;
@@ -285,23 +286,14 @@ pub fn redefined_loop_name&lt;&#x27;a, &#x27;b&gt;(checker: &amp;&#x27;a mut Checker&lt;&#x27;b&gt;, node: &amp;Node&lt;&#x27;b&gt;
     };

     for outer_assignment_target in &amp;outer_assignment_targets {
-        let mut outer_name = None;
         for inner_assignment_target in &amp;inner_assignment_targets {
             // Compare the targets structurally.
             if ComparableExpr::from(outer_assignment_target.expr)
                 .eq(&amp;(ComparableExpr::from(inner_assignment_target.expr)))
             {
-                // Compute the textual name of the outer target lazily.
-                if outer_name.is_none() {
-                    outer_name = Some(
-                        checker
-                            .locator
-                            .slice(&amp;Range::from_located(outer_assignment_target.expr)),
-                    );
-                }
                 checker.diagnostics.push(Diagnostic::new(
                     RedefinedLoopName {
-                        name: (*outer_name.unwrap()).to_string(),
+                        name: unparse_expr(outer_assignment_target.expr, checker.stylist),
                         outer_kind: outer_assignment_target.binding_kind,
                         inner_kind: inner_assignment_target.binding_kind,
                     },
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 03:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 03:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:300 on 2023-02-22 03:19</div>
            <div class="timeline-body"><p>(I&#x27;m gonna commit this change in the interest of merging. If you feel strongly either way, let me know and I can always change in a follow-up.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-22 03:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-22 03:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-22 03:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/matthewlloyd">@matthewlloyd</a> reviewed on 2023-02-22 03:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:300 on 2023-02-22 03:40</div>
            <div class="timeline-body"><p>Good point about the newlines - that works for me! (I didn&#x27;t know about unparse_expr!) Now it gets computed once per violation. Oh, the inefficiency... ðŸ˜† Looks good, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-22 03:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:300 on 2023-02-22 03:41</div>
            <div class="timeline-body"><p>Haha I figured it was okay because we were already cloning once per violation?? &gt;.&lt;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-22 03:42</div>
            <div class="timeline-body"><p>Thanks again for the thorough and educational review and the quick merge.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-22 03:43</div>
            <div class="timeline-body"><p>Thank <em>you</em> for all the work! Have been really impressed by your thoroughness and attention to detail, not to mention the quality of your code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-02-22 03:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/spaceone">@spaceone</a> reviewed on 2023-02-22 12:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/spaceone">@spaceone</a> on <code>crates/ruff/src/rules/pylint/rules/redefined_loop_name.rs</code>:176 on 2023-02-22 12:08</div>
            <div class="timeline-body"><p>yes, see also <a href="https://github.com/charliermarsh/ruff/issues/2208">charliermarsh/ruff#2208</a>!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2023-02-27 22:32</div>
            <div class="timeline-body"><p>Was this intended to trigger when the <code>with</code> is outside the loop?</p>
<pre><code>with open(&quot;something&quot;) as f:
    for line in f:
        line = line.strip()
</code></pre>
<p>Produces:</p>
<pre><code>$ pipx run ruff --select PL tmp.py --isolated
tmp.py:3:9: PLW2901 Outer for loop variable `line` overwritten by inner assignment target
Found 1 error.
</code></pre>
<p>This does not produce a warning with pylint. From what I gathered above, this is deviating from pylint intentionally, but the <code>with</code> was supposed to be between the assignment and the loop?</p>
<p>I could go through and change the places where this happens, but it seems like a common and harmless pattern?</p>
<p>(If this was a unique warning number for <code>with</code>&#x27;s, I&#x27;d probably ignore it, since very few blocks in Python make scope, including things that probably should. :) )</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-27 22:52</div>
            <div class="timeline-body"><blockquote>
<p>This does not produce a warning with pylint. From what I gathered above, this is deviating from pylint intentionally, but the <code>with</code> was supposed to be between the assignment and the loop?</p>
</blockquote>
<p>This doesn&#x27;t produce a warning with pylint <em>by default</em> because the entire W2901 check is optional and only enabled if the <code>pylint.extensions.redefined_loop_name</code> plugin is loaded. However, if you do load that plugin, you&#x27;ll find that PyLint does produce an error on the third line here, yes, matching the behavior we decided to add to Ruff.</p>
<p>https://pylint.readthedocs.io/en/latest/user_guide/messages/warning/redefined-loop-name.html</p>
<p>Note that the presence of the outer <code>with</code> is irrelevant here, and both PyLint and this version will produce an error on <code>line = line.strip()</code> even if you have only the <code>for</code> loop.</p>
<p>Ultimately it&#x27;s a matter of personal preference. When I wrote this code, I was thinking I would add an option to disable the error for simple reassignments within a loop, since it seemed over the top. Then when I ran it on my codebase and weighed the pros and cons, I realized I would rather change my harmless habit (that wasn&#x27;t really so harmless!), and instead write:</p>
<pre><code>for raw_line in f:
    line = raw_line.strip()
</code></pre>
<p>The reasons being:</p>
<ul>
<li>Unless you <em>always</em> strip the line every time you iterate over the lines in a file, it&#x27;s easy to misremember whether your <code>line</code> variable represents the line with or without the newline, and end up e.g. printing or writing the newline to another file when it is not wanted or vice versa. Establishing a convention (or some similar convention) where <code>line</code> is newline-stripped and <code>raw_line</code> contains the newline makes this error less likely.</li>
<li>It&#x27;s impossible for a linter tool to distinguish between the above &quot;harmless&quot; case, and more dangerous cases where the loop variable is reassigned accidentally:</li>
</ul>
<pre><code>for i in range(10):
    # ... many lines of code
    i = 10  # possibly buried in nested code
    # ... many lines of code
    print(i)   # developer expected `i` to contain the original iteration value
</code></pre>
<p>We&#x27;d have establish a whitelist of loop variable names that are allowed to be reassigned to, or a privileged position within the loop where it is permitted (e.g. the first line only). However that complicates the rule and is also fragile since it&#x27;s impossible to cover every case.</p>
<p>IMHO it&#x27;s better to just flag it as an error, and rename the variable or add a <code>noqa</code> as needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-27 22:56</div>
            <div class="timeline-body"><p>Practically speaking one option would be to separate out &quot;assignment within a loop&quot; from &quot;reuse as another loop variable&quot; into two separate rules, e.g. PLW2901A and PLW2901, so users could choose to ignore PLW2901A while still catching more obviously unintentional errors like this as PLW2901:</p>
<pre><code>for i in range(10):
    for i in range(10):  # PLW2901
        pass
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2023-02-27 22:58</div>
            <div class="timeline-body"><p>Ahh, I missed that it was an optional pylint flag! I could have sworn I&#x27;ve seen that error before, and I&#x27;m pretty bad about digging up the optional pylint extensions.</p>
<p>Since it&#x27;s not triggering due to the with, I&#x27;m fine with it. The wording of the error (with &quot;outer&quot;) is a tiny bit confusing - if it just said it was a variable reassignment for the loop, I&#x27;d have understood it wasn&#x27;t a false positive. I think. :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewlloyd">@matthewlloyd</a> on 2023-02-27 23:00</div>
            <div class="timeline-body"><blockquote>
<p>if it just said it was a variable reassignment for the loop, I&#x27;d have understood it wasn&#x27;t a false positive.</p>
</blockquote>
<p>That&#x27;s a great point, we should perhaps only use the word &quot;outer&quot; when there are two loops involved. Thanks for your feedback!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2023-02-27 23:01</div>
            <div class="timeline-body"><blockquote>
<p>we should perhaps only use the word &quot;outer&quot; when there are two loops involved</p>
</blockquote>
<p>That would be great!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:52:23 UTC
    </footer>
</body>
</html>
