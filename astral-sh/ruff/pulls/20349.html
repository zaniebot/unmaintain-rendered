<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Inlay hint call argument location - astral-sh/ruff #20349</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Inlay hint call argument location</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/20349">#20349</a>
        opened by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a>
        on 2025-09-11 12:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-11 12:17</div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff/ty! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title? (Please prefix with `[ty]` for ty pull
  requests.)
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>Adds location to the inlay hint label part for call arguments. This allows &quot;goto&quot; on the inlay hint.</p>
<p><a href="https://github.com/user-attachments/assets/9458c4ce-8cd1-4edb-bac6-4379ae913075">inlay-hint-call-argument-location.webm</a></p>
<p>This has not been added to the playground as Monaco doesn't support it.</p>
<h2>Test Plan</h2>
<p>updated a test in <code>ty_server</code>. But other than that im not sure the best way to approach tests for this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-09-11 12:20</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance">typing conformance tests</a></h2>
<p>No changes detected when running ty on typing conformance tests âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-09-11 12:22</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">scikit-build-core (https://github.com/scikit-build/scikit-build-core)
- src/scikit_build_core/build/wheel.py:98:20: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 44 diagnostics
+ Found 43 diagnostics


</code></pre>
</details>

<p>No memory usage changes detected âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-11 12:26</div>
            <div class="timeline-body"><p>Getting this error in playground. It seems like i have broken the goto as well as the inlay hint location still not working. will look into this more</p>
<pre><code class="language-bash">Uncaught Error: can't access property &quot;monaco&quot;, this is undefined

mapNavigationTarget@http://localhost:5173/src/Editor/Editor.tsx:464:13
mapNavigationTargets@http://localhost:5173/src/Editor/Editor.tsx:495:22
provideDefinition@http://localhost:5173/src/Editor/Editor.tsx:391:21
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Inlay hint call argument location" to "[ty] Inlay hint call argument location" by @AlexWaygood on 2025-09-11 12:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @AlexWaygood on 2025-09-11 12:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @AlexWaygood on 2025-09-11 12:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-09-13 04:09</div>
            <div class="timeline-body"><blockquote>
<p>Getting this error in playground. It seems like i have broken the goto as well as the inlay hint location still not working. will look into this more</p>
</blockquote>
<p>I'd be happy to keep the playground changes in a separate PR to get the LSP changes in.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-13 17:24</div>
            <div class="timeline-body"><p>I fixed this error, was a small issue, I fixed in the &quot;Fix Playground&quot; commit</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-15 12:45</div>
            <div class="timeline-body"><blockquote>
<p>I fixed this error, was a small issue, I fixed in the &quot;Fix Playground&quot; commit</p>
</blockquote>
<p>Nice. Does that mean this PR is now ready for review or is there more to do?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-15 13:55</div>
            <div class="timeline-body"><p>I am just looking over it for the final time now, will make it ready for review today</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:933 on 2025-09-15 14:02</div>
            <div class="timeline-body"><p>I could clean this up more by using <code>Option&lt;FileRange&gt;</code>, but this requires a lot more cloning</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-09-15 14:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @MatthewMckee4 on 2025-09-15 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @MatthewMckee4 on 2025-09-15 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @MatthewMckee4 on 2025-09-15 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @MatthewMckee4 on 2025-09-15 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @MatthewMckee4 on 2025-09-15 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @MatthewMckee4 on 2025-09-15 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-09-15 14:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:933 on 2025-09-15 14:08</div>
            <div class="timeline-body"><p>Yeah I'm not too sure about this. I'm not sure if the cloning of a <code>File</code> is &quot;too&quot; expensive. This would simplify the code a bit but not too much really</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-16 07:29</div>
            <div class="timeline-body"><p>@Gankra is this a PR you could take a look at? If not, that's fine. It might just take me a few days before I get to it because I'm still catching up with notifications after my PTO (and have some other time sensitive things that I need to do first)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-09-18 00:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:933 on 2025-09-18 00:28</div>
            <div class="timeline-body"><p>Cloning this kind of File is essentially free, aiui.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:822 on 2025-09-18 00:38</div>
            <div class="timeline-body"><pre><code class="language-suggestion">        // TODO: lambda functions
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:795 on 2025-09-18 00:40</div>
            <div class="timeline-body"><p>Hm is anything added by this being an Option?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:985 on 2025-09-18 00:52</div>
            <div class="timeline-body"><p>I think the body of the and_then can be <code>offsets.get(&amp;param.name()?.to_string())</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> approved on 2025-09-18 01:09</div>
            <div class="timeline-body"><p>The basic approach seems reasonable! I was going to complain that this approach doesn't properly play with stub-mapping and the goto-definition vs goto-declaration distinction, but after looking at the fields provided by the spec it seems like it really does only let you pick one &quot;target&quot; for the inlay hint.</p>
<p>That said the implementation you've chosen implements goto-declaration semantics which is not the default for a cmd+click, which prefers goto-definition. I think it would be fine to have that be a followup, as this is already seemingly strictly better than what pylance does!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @AlexWaygood removed by @AlexWaygood on 2025-09-18 06:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @sharkdp removed by @sharkdp on 2025-09-18 06:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @carljm removed by @carljm on 2025-09-19 15:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-09-19 15:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:795 on 2025-09-19 15:51</div>
            <div class="timeline-body"><p>No not really, removed the option now</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @Gankra by @MichaReiser on 2025-09-22 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-22 20:20</div>
            <div class="timeline-body"><p>hmm there seems to be something quite wrong about the location for the parameters (in playground), and i think there's an issue with my video above</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-22 20:41</div>
            <div class="timeline-body"><p>working fine in vscode, just need to look into the playground not working</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-09-22 21:05</div>
            <div class="timeline-body"><p>really have no clue why it isnt working</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-09-23 08:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:933 on 2025-09-23 08:41</div>
            <div class="timeline-body"><p><code>FileRange</code> is even marked as <code>Copy</code> (it's as expensive as copying a u128)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_wasm/src/lib.rs</code>:936 on 2025-09-23 08:43</div>
            <div class="timeline-body"><p>Nit: We could make this a method on <code>target</code> (<code>target.full_file_range</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-09-23 08:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:933 on 2025-09-23 08:48</div>
            <div class="timeline-body"><p>Okay I'll update this code then</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-09-23 09:27</div>
            <div class="timeline-body"><blockquote>
<p>really have no clue why it isnt working</p>
</blockquote>
<p>Do you mean that the inlay's aren't clickable. I somewhat suspect that this isn't implemented in monaco.</p>
<p>I tried to find an inlay example but couldn't find any (the TypeScript playground also doesn't use inlays). It's quiet possible that monaco doesn't support clickable inlays?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-09-23 16:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>playground/ty/src/Editor/Editor.tsx</code>:439 on 2025-09-23 16:40</div>
            <div class="timeline-body"><p>Given that this doesn't work in Monaco (it seems) I'm inclined to not set location and instead at a comment saying that. As of today (date), location isn't supported by Monaco which is why the field is ommited in the playground.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-09-23 16:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>playground/ty/src/Editor/Editor.tsx</code>:439 on 2025-09-23 16:43</div>
            <div class="timeline-body"><p>yeah that makes sense, will update. Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-09-23 16:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>playground/ty/src/Editor/Editor.tsx</code>:439 on 2025-09-23 16:56</div>
            <div class="timeline-body"><p>I think it would be good to keep all of the updates to <code>ty_wasm</code>, just incase in the future monaco supports this, what do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>playground/ty/src/Editor/Editor.tsx</code>:439 on 2025-09-24 07:54</div>
            <div class="timeline-body"><p>Yeah, I think that's fine. I also don't expect the ty_wasm code to add too much overhead. It only maps a few locations</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-09-24 07:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-24 07:54</div>
            <div class="timeline-body"><p>@Gankra would you mind taking another look at this PR (The playground changes look good to me)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-10-21 16:46</div>
            <div class="timeline-body"><p>I understand this isn't important for the beta but just making sure this doesn't get lost.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-21 16:58</div>
            <div class="timeline-body"><p>Thanks. I think it got lost ðŸ˜“ I'll take another look tomorrow and another ping to @Gankra</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-10-21 21:55</div>
            <div class="timeline-body"><p>Thank you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 06:39</div>
            <div class="timeline-body"><p>I find the byte offsets here hard to understand. This seems to be a perfect use case for a diagnostic with two spans:</p>
<ul>
<li>The first span points to the source (the <code>y</code> in the call)</li>
<li>The second span points to the target (the <code>y</code> in the function declaration)</li>
</ul>
<p>I think that will make it much easier to read those snapshots</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:873 on 2025-10-22 06:41</div>
            <div class="timeline-body"><p>Do we need to use a <code>FileRange</code> here? How does <code>parameter_label_offset</code> get away with using <code>TextRange</code>? Does it use the <code>Definition.file</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:938 on 2025-10-22 06:44</div>
            <div class="timeline-body"><p>Given that <code>CallSignatureDetails</code> stores the function's definition: Can't we compute the definition to parameter offset mapping on demand rather than storing it on <code>CallSignatureDetails</code>? What I mean by that: We could have a method <code>get_parameter_range(self, db, name: &amp;str) -&gt; Option&lt;FileRange&gt;</code> that calls <code>parsed_module</code> ad-hoc, searches the parameter, and returns it.</p>
<p>Or we can build this map closer to where we use it rather than building it for every <code>CallSignatureDetails</code> even when it's never used.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:1143 on 2025-10-22 06:45</div>
            <div class="timeline-body"><p>Given that we already map the parameters. Could we look up the parameter range by param_index instead of by name?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-22 06:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 10:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:1143 on 2025-10-22 10:37</div>
            <div class="timeline-body"><p>The issue i was having was with bound methods with <code>self</code>. If i had a list then the index would be one off.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 10:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:873 on 2025-10-22 10:38</div>
            <div class="timeline-body"><p>Yes we need the <code>File</code> and <code>TextRange</code> for <code>NavigationTarget</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 10:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 10:40</div>
            <div class="timeline-body"><p>Yes, good point</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:938 on 2025-10-22 10:41</div>
            <div class="timeline-body"><p>Yeah, fair point</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 10:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 10:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 10:48</div>
            <div class="timeline-body"><p>Ah the one hard part about this was that when i annotate with a span</p>
<pre><code class="language-rs">source.annotate(Annotation::primary(
                Span::from(self.source.file()).with_range(self.source.range()),
            ));
</code></pre>
<p>I dont get the actual inlay hints in it, so we just point to a &quot;random&quot; part in the file</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-22 11:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:873 on 2025-10-22 11:02</div>
            <div class="timeline-body"><p>Fair, but can't we use <code>definition.file</code> instead of repeating the <code>File</code> for each parameter (which I think is always the same?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-22 11:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 11:03</div>
            <div class="timeline-body"><blockquote>
<p>I dont get the actual inlay hints in it, so we just point to a &quot;random&quot; part in the file</p>
</blockquote>
<p>Can you elaborate on this? Why would we get random parts in the file?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 11:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:873 on 2025-10-22 11:05</div>
            <div class="timeline-body"><p>Yeah, i had that before. Changed in https://github.com/astral-sh/ruff/pull/20349/commits/20364f173946173210255be731b938b0bf71bdea. The code is a lot cleaner like this, since definition is an <code>Option</code> in <code>CallSignatureDetails</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 11:12</div>
            <div class="timeline-body"><p>Yes sorry.Our extra inlay hint labels that we add in the output <code>[a=]</code>. We want to be able to add a <code>source</code> section in the diagnostics section of the snapshots. But when we try to use the original file to show the source of the inlay hint goto <code>a</code> is not in the file. So we cant really show a source, unless there is another way to do this for an arbitrary <code>String</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 11:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 11:17</div>
            <div class="timeline-body"><p>Sorry if this is hard to read, this is the new snapshots from when i try to include the source. We see thee <code>^</code> points to random places where the inlay hint label &quot;would&quot; be.</p>
<pre><code>   18    25 â”‚   |                                      ^
   19    26 â”‚ 3 | foo(1, 'pos', 3.14, False, e=42)
   20    27 â”‚ 4 | foo(1, 'pos', 3.14, e=42, f='custom')
   21    28 â”‚   |
   22       â”‚-info: For inlay hint label 'd' at 115..116
         29 â”‚+info: Source
         30 â”‚+ --&gt; main.py:3:25
         31 â”‚+  |
         32 â”‚+2 | def foo(a: int, b: str, /, c: float, d: bool = True, *, e: int, f: str = 'default'): pass
         33 â”‚+3 | foo(1, 'pos', 3.14, False, e=42)
         34 â”‚+  |                         ^
         35 â”‚+4 | foo(1, 'pos', 3.14, e=42, f='custom')
         36 â”‚+  |
   23    37 â”‚
   24    38 â”‚ info[inlay-hint-location]: Inlay Hint Target
   25    39 â”‚  --&gt; main.py:2:28
   26    40 â”‚   |
â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”¼â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ
   28    42 â”‚   |                            ^
   29    43 â”‚ 3 | foo(1, 'pos', 3.14, False, e=42)
   30    44 â”‚ 4 | foo(1, 'pos', 3.14, e=42, f='custom')
   31    45 â”‚   |
   32       â”‚-info: For inlay hint label 'c' at 146..147
         46 â”‚+info: Source
         47 â”‚+ --&gt; main.py:4:23
         48 â”‚+  |
         49 â”‚+2 | def foo(a: int, b: str, /, c: float, d: bool = True, *, e: int, f: str = 'default'): pass
         50 â”‚+3 | foo(1, 'pos', 3.14, False, e=42)
         51 â”‚+4 | foo(1, 'pos', 3.14, e=42, f='custom')
         52 â”‚+  |                       ^
         53 â”‚+  |
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 11:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-10-22 12:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 12:24</div>
            <div class="timeline-body"><p>What about something like this</p>
<pre><code class="language-patch">Index: crates/ty_ide/src/inlay_hints.rs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
&lt;+&gt;UTF-8
===================================================================
diff --git a/crates/ty_ide/src/inlay_hints.rs b/crates/ty_ide/src/inlay_hints.rs
--- a/crates/ty_ide/src/inlay_hints.rs	(revision 1522cbd742f0e725a1d4725ecfcd465a4b50f7b1)
+++ b/crates/ty_ide/src/inlay_hints.rs	(date 1761135752041)
@@ -435,17 +435,10 @@
                 for part in hint.label.parts() {
                     hint_str.push_str(part.text());
 
-                    let label_length = part.text().len();
-
                     if let Some(target) = part.target() {
-                        let label_range = TextRange::new(
-                            TextSize::try_from(end_position).unwrap(),
-                            TextSize::try_from(end_position + label_length).unwrap(),
-                        );
-
                         diagnostics.push(InlayHintLocationDiagnostic::new(
                             part.text().to_string(),
-                            label_range,
+                            FileRange::new(self.file, TextRange::at(hint.position, TextSize::ZERO)),
                             target,
                         ));
                     }
@@ -555,16 +548,19 @@
         a.y[: Literal[3]] = 3
 
         ---------------------------------------------
-        info[inlay-hint-location]: Inlay Hint Target
+        info[inlay-hint-location]: Inlay Hint part y
          --&gt; main.py:3:24
           |
         2 | class A:
         3 |     def __init__(self, y):
-          |                        ^
+          |                        - points here
         4 |         self.x = 1
         5 |         self.y = y
+        6 |
+        7 | a = A(2)
+          |       ^
+        8 | a.y = 3
           |
-        info: For inlay hint label 'y' at 112..113
         &quot;);
     }
 
@@ -1132,7 +1128,7 @@
          6 |     return y
          7 |
          8 | def baz(a: int, b: str, c: bool): pass
-           |         ^
+           |     ^
          9 |
         10 | baz(foo(5), bar(bar('test')), True)
            |
@@ -1140,11 +1136,11 @@
 
         info[inlay-hint-location]: Inlay Hint Target
          --&gt; main.py:2:9
-          |
-        2 | def foo(x: int) -&gt; int:
+           |
+         2 | def foo(x: int) -&gt; int:
           |         ^
-        3 |     return x * 2
-          |
+         3 |     return x * 2
+           |
         info: For inlay hint label 'x' at 133..134
 
         info[inlay-hint-location]: Inlay Hint Target
@@ -1153,7 +1149,7 @@
          6 |     return y
          7 |
          8 | def baz(a: int, b: str, c: bool): pass
-           |                 ^
+           |             ^
          9 |
         10 | baz(foo(5), bar(bar('test')), True)
            |
@@ -1161,24 +1157,24 @@
 
         info[inlay-hint-location]: Inlay Hint Target
          --&gt; main.py:5:9
-          |
-        3 |     return x * 2
-        4 |
-        5 | def bar(y: str) -&gt; str:
+           |
+         3 |     return x * 2
+         4 |
+         5 | def bar(y: str) -&gt; str:
           |         ^
-        6 |     return y
-          |
+         6 |     return y
+           |
         info: For inlay hint label 'y' at 149..150
 
         info[inlay-hint-location]: Inlay Hint Target
          --&gt; main.py:5:9
-          |
-        3 |     return x * 2
-        4 |
-        5 | def bar(y: str) -&gt; str:
+           |
+         3 |     return x * 2
+         4 |
+         5 | def bar(y: str) -&gt; str:
           |         ^
-        6 |     return y
-          |
+         6 |     return y
+           |
         info: For inlay hint label 'y' at 157..158
 
         info[inlay-hint-location]: Inlay Hint Target
@@ -1400,24 +1396,24 @@
         ---------------------------------------------
         info[inlay-hint-location]: Inlay Hint Target
          --&gt; main.py:5:9
-          |
-        4 | @overload
-        5 | def foo(x: int) -&gt; str: ...
+           |
+         4 | @overload
+         5 | def foo(x: int) -&gt; str: ...
           |         ^
-        6 | @overload
-        7 | def foo(x: str) -&gt; int: ...
-          |
+         6 | @overload
+         7 | def foo(x: str) -&gt; int: ...
+           |
         info: For inlay hint label 'x' at 136..137
 
         info[inlay-hint-location]: Inlay Hint Target
          --&gt; main.py:5:9
-          |
-        4 | @overload
-        5 | def foo(x: int) -&gt; str: ...
+           |
+         4 | @overload
+         5 | def foo(x: int) -&gt; str: ...
           |         ^
-        6 | @overload
-        7 | def foo(x: str) -&gt; int: ...
-          |
+         6 | @overload
+         7 | def foo(x: str) -&gt; int: ...
+           |
         info: For inlay hint label 'x' at 148..149
         &quot;);
     }
@@ -1558,7 +1554,7 @@
                 &quot;Inlay Hint Target&quot;.to_string(),
             );
             main.annotate(Annotation::primary(
-                Span::from(self.target.file()).with_range(self.target.range()),
+                    Span::from(self.target.file()).with_range(self.target.range()),
             ));
             main.info(format!(
                 &quot;For inlay hint label '{}' at {:?}&quot;,
</code></pre>
<p>The alternative is that you:</p>
<ul>
<li>iterate over all hints and collect all parts</li>
<li>Once you have the final buffer, write a new file to the in-memory file system</li>
<li>Now create the diagnostics for all parts</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 12:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:567 on 2025-10-22 12:33</div>
            <div class="timeline-body"><p>That looks good, updated now</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-22 12:48</div>
            <div class="timeline-body"><p>Let me know when this is ready for re-review (you can request a review)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> reviewed on 2025-10-22 13:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on <code>crates/ty_python_semantic/src/types/ide_support.rs</code>:938 on 2025-10-22 13:00</div>
            <div class="timeline-body"><p>added this now</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @MatthewMckee4 on 2025-10-22 13:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-11-17 10:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-11-17 10:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-27 00:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 16:36:41 UTC
    </footer>
</body>
</html>
