<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add tests for `global`, `nonlocal` - astral-sh/ruff #10758</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add tests for <code>global</code>, <code>nonlocal</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10758">#10758</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-04-03 14:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body">Summary
<p>This PR does two things:</p>
<ol>
<li>Adds documentation for <code>continue</code>, <code>break</code>, and <code>pass</code> parsing functions</li>
<li>Adds documentation and tests for <code>nonlocal</code> and <code>global</code> parsing functions</li>
<li>Adds new error type for empty global and nonlocal statement</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">parser</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-03 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-03 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-03 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-04-03 14:24</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
Formatter (stable)
<p>✅ ecosystem check detected no format changes.</p>
Formatter (preview)
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-04-03 20:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:546 on 2024-04-03 20:19</div>
            <div class="timeline-body"><p>Have you been doing this kind of thing elsewhere? Just seems hard to keep in-sync. If it&#x27;s already an established pattern, no worries. Otherwise, I probably would suggest just documenting the cases, but not the test name, like:</p>
<pre><code>// For example:
// ```python
// nonlocal
// ```
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-04-03 20:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-04-04 02:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:546 on 2024-04-04 02:57</div>
            <div class="timeline-body"><p>These are inline tests which gets extracted automatically into their own test file and gets tested.</p>
<p>Refer #10681 and <a href="https://github.com/astral-sh/ruff/blob/dhruv/parser/crates/ruff_python_parser/CONTRIBUTING.md#inline-tests">documentation</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-04-04 03:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:546 on 2024-04-04 03:18</div>
            <div class="timeline-body"><p>That’s really cool!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:539 on 2024-04-04 07:26</div>
            <div class="timeline-body"><p>Unrelated to this PR. I just remembered @BurntSushi&#x27;s codeblock formatter PR and that markdown allows an info string. So we could consider changing this to:</p>
<pre><code>        // ```python test_err nonlocal_stmt_trailing_comma
        // nonlocal ,
        // nonlocal x,
        // nonlocal x, y,
        // ```

        // ```python test_err nonlocal_stmt_expression
        // nonlocal x + 1
        // ```
</code></pre>
<p>It has the obvious downside that it requires an extra line and is probably only useful if editors would start highlighting code blocks in comments :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-04-04 07:29</div>
            <div class="timeline-body"><p>We might soon have the parser tests with the highest coverage!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-04-04 09:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_python_parser/src/parser/statement.rs</code>:539 on 2024-04-04 09:58</div>
            <div class="timeline-body"><p>Yeah that&#x27;s a good idea. I mean usually editor would allow custom query to highlight certain part of the code in a different way. I know Neovim allows it with treesitter ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-04 09:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-04 09:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-04-04 09:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:03:03 UTC
    </footer>
</body>
</html>
