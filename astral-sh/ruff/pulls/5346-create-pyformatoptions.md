```yaml
number: 5346
title: "Create `PyFormatOptions`"
type: pull_request
state: merged
author: MichaReiser
labels:
  - internal
  - formatter
assignees: []
merged: true
base: main
head: py-format-options
created_at: 2023-06-23T21:07:12Z
updated_at: 2023-06-26T12:16:11Z
url: https://github.com/astral-sh/ruff/pull/5346
synced_at: 2026-01-12T03:36:55Z
```

# Create `PyFormatOptions`

---

_Pull request opened by @MichaReiser on 2023-06-23 21:07_

<!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

## Summary

This PR adds a new `PyFormatOptions` struct that stores the python formatter options. 
The new options aren't used yet, with the exception of magical trailing commas and the options passed to the printer. 
I'll follow up with more PRs that use the new options (e.g. `QuoteStyle`).

<!-- What's the purpose of the change? What does it do, and why? -->

## Test Plan

`cargo test` I'll follow up with a new PR that adds support for overriding the options in our fixture tests.



---

_Comment by @MichaReiser on 2023-06-23 21:07_

Current dependencies on/for this PR:
* main
  * **PR #5346** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/5346" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ
    * **PR #5347** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/5347" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a> 
      * **PR #5349** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/5349" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a> 

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/5346?utm_source=stack-comment).

---

_Label `internal` added by @MichaReiser on 2023-06-23 22:08_

---

_Label `formatter` added by @MichaReiser on 2023-06-23 22:08_

---

_Comment by @github-actions[bot] on 2023-06-23 22:18_

## PR Check Results
### Ecosystem
âœ… ecosystem check detected no changes.

### Benchmark
#### Linux
```
group                                      main                                    pr
-----                                      ----                                    --
formatter/large/dataset.py                 1.00      8.7Â±0.42ms     4.7 MB/sec     1.01      8.8Â±0.42ms     4.6 MB/sec
formatter/numpy/ctypeslib.py               1.03  1980.6Â±123.11Âµs     8.4 MB/sec    1.00  1924.5Â±74.13Âµs     8.7 MB/sec
formatter/numpy/globals.py                 1.04    242.6Â±8.40Âµs    12.2 MB/sec     1.00   232.2Â±12.81Âµs    12.7 MB/sec
formatter/pydantic/types.py                1.00      4.4Â±0.21ms     5.8 MB/sec     1.01      4.4Â±0.29ms     5.8 MB/sec
linter/all-rules/large/dataset.py          1.17     20.1Â±0.90ms     2.0 MB/sec     1.00     17.1Â±1.08ms     2.4 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      4.3Â±0.25ms     3.9 MB/sec     1.02      4.4Â±0.33ms     3.8 MB/sec
linter/all-rules/numpy/globals.py          1.07   591.6Â±50.13Âµs     5.0 MB/sec     1.00   554.9Â±36.35Âµs     5.3 MB/sec
linter/all-rules/pydantic/types.py         1.09      8.4Â±0.38ms     3.0 MB/sec     1.00      7.7Â±0.26ms     3.3 MB/sec
linter/default-rules/large/dataset.py      1.19     10.5Â±0.43ms     3.9 MB/sec     1.00      8.8Â±0.47ms     4.6 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.16      2.2Â±0.11ms     7.7 MB/sec     1.00  1869.8Â±177.01Âµs     8.9 MB/sec
linter/default-rules/numpy/globals.py      1.03   239.9Â±15.28Âµs    12.3 MB/sec     1.00   233.6Â±21.71Âµs    12.6 MB/sec
linter/default-rules/pydantic/types.py     1.15      4.6Â±0.19ms     5.5 MB/sec     1.00      4.0Â±0.11ms     6.3 MB/sec
```

#### Windows
```
group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      7.9Â±0.11ms     5.1 MB/sec    1.02      8.0Â±0.20ms     5.1 MB/sec
formatter/numpy/ctypeslib.py               1.00  1813.4Â±20.38Âµs     9.2 MB/sec    1.04  1887.1Â±92.85Âµs     8.8 MB/sec
formatter/numpy/globals.py                 1.01    218.7Â±9.40Âµs    13.5 MB/sec    1.00    217.1Â±5.45Âµs    13.6 MB/sec
formatter/pydantic/types.py                1.00      4.1Â±0.10ms     6.2 MB/sec    1.00      4.1Â±0.11ms     6.2 MB/sec
linter/all-rules/large/dataset.py          1.02     16.1Â±0.29ms     2.5 MB/sec    1.00     15.7Â±0.22ms     2.6 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.01      4.2Â±0.07ms     4.0 MB/sec    1.00      4.1Â±0.07ms     4.0 MB/sec
linter/all-rules/numpy/globals.py          1.01   507.5Â±11.40Âµs     5.8 MB/sec    1.00    504.6Â±6.79Âµs     5.8 MB/sec
linter/all-rules/pydantic/types.py         1.01      7.1Â±0.14ms     3.6 MB/sec    1.00      7.0Â±0.12ms     3.6 MB/sec
linter/default-rules/large/dataset.py      1.01      8.1Â±0.08ms     5.0 MB/sec    1.00      8.0Â±0.10ms     5.1 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.01  1744.9Â±23.09Âµs     9.5 MB/sec    1.00  1736.0Â±22.65Âµs     9.6 MB/sec
linter/default-rules/numpy/globals.py      1.00    204.6Â±3.73Âµs    14.4 MB/sec    1.01    207.4Â±7.57Âµs    14.2 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.7Â±0.04ms     6.9 MB/sec    1.00      3.7Â±0.05ms     6.9 MB/sec
```
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

---

_@charliermarsh approved on 2023-06-25 20:51_

---

_Review comment by @konstin on `crates/ruff_python_formatter/src/options.rs`:9 on 2023-06-26 09:48_

```suggestion
    /// Tabs or spaces
    indent_style: IndentStyle,
    /// Wrap lines that are longer than this 
    line_width: LineWidth,
    /// Single quotes or double quotes
    quote_style: QuoteStyle,
    /// Where to expand lists or elements if they have a trailing comma such as `(a, b,)`
    magic_trailing_comma: MagicTrailingComma,
```

---

_@konstin approved on 2023-06-26 09:49_

thanks

---

_Merged by @MichaReiser on 2023-06-26 12:02_

---

_Closed by @MichaReiser on 2023-06-26 12:02_

---

_Branch deleted on 2023-06-26 12:02_

---

_Comment by @MichaReiser on 2023-06-26 12:02_

@MichaReiser merged this pull request with [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/5346).

---
