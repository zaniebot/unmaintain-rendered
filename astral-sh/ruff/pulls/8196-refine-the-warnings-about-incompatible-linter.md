```yaml
number: 8196
title: Refine the warnings about incompatible linter options
type: pull_request
state: merged
author: MichaReiser
labels:
  - formatter
assignees: []
merged: true
base: main
head: refine-linter-incompatible-option-warnings
created_at: 2023-10-25T03:17:13Z
updated_at: 2023-10-26T16:31:45Z
url: https://github.com/astral-sh/ruff/pull/8196
synced_at: 2026-01-12T15:55:25Z
```

# Refine the warnings about incompatible linter options

---

_@MichaReiser_

## Summary

Avoid warning about incompatible rules except if their configuration directly conflicts with the formatter. This should reduce the noise and potentially the need for https://github.com/astral-sh/ruff/issues/8175 and https://github.com/astral-sh/ruff/issues/8185

I also extended the rule and option documentation to mention any potential formatter incompatibilities or whether they're redundant when using the formatter. 

* `LineTooLong`: This is a use case we explicitly want to support. Don't warn about it
* `TabIndentation`, `IndentWithSpaces`: Only warn if `indent-style="tab"`
* `IndentationWithInvalidMultiple`, `IndentationWithInvalidMultipleComment`: Only warn if `indent-width != 4`
* `OverIndented`: Don't warn, but mention that the rule is redundant
* `BadQuotesInlineString`: Warn if quote setting is different from `format.quote-style`
* `BadQuotesMultilineString`, `BadQuotesDocstring`: Warn if `quote != "double"`

## Test Plan

I added a new integration test for the default configuration with `ALL`. `ruff format` now only shows two incompatible rules, which feels more reasonable. 


---

_Comment by @MichaReiser on 2023-10-25 03:17_

Current dependencies on/for this PR:
* main
  * **PR #8192** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8192" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 
    * **PR #8196** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8196" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ
      * **PR #8244** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8244" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> 

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/8196?utm_source=stack-comment).

---

_@MichaReiser reviewed on 2023-10-25 03:21_

---

_Review comment by @MichaReiser on `crates/ruff_cli/src/commands/format.rs`:705 on 2023-10-25 03:21_

I'm undecided if we should warn about this rule. The formatter might collapse implicit string concatenated lines which then triggers this rule. However, it might be something users want to fix manually. 

Same for `MissingTrailingComma`. The rule might require manual intervention (and `magic-trailing-comma` set to `respect`), but once fixed it remains fixed.

---

_Review requested from @charliermarsh by @MichaReiser on 2023-10-25 08:03_

---

_Label `cli` added by @MichaReiser on 2023-10-25 08:03_

---

_Label `formatter` added by @MichaReiser on 2023-10-25 08:03_

---

_Label `cli` removed by @MichaReiser on 2023-10-25 08:03_

---

_Marked ready for review by @MichaReiser on 2023-10-25 08:08_

---

_Comment by @github-actions[bot] on 2023-10-25 08:20_

## PR Check Results
### Ecosystem
âœ… ecosystem check detected no changes.



---

_Comment by @yakMM on 2023-10-25 09:14_

Looks great, most of my warnings are gone!

---

_@yakMM reviewed on 2023-10-25 09:15_

---

_Review comment by @yakMM on `crates/ruff_cli/src/commands/format.rs`:705 on 2023-10-25 09:15_

If the formatter collapses the strings, I would love to know about it to fix it afterward.

---

_Comment by @MichaReiser on 2023-10-25 09:48_

[yakMM](https://github.com/yakMM) [wrote](https://github.com/astral-sh/ruff/issues/8185#issuecomment-1778845285)

> Tested on my project, only have a warning about ISC001 and isort.split-on-trailing-comma left. I will reply to your comment about this one directly in the PR.

> Don't know if I should open a new issue, but I feel like the warning about isort.split-on-trailing-comma=false is underserved since I already have isort.force-single-line=true, so that isort.split-on-trailing-comma=false will never be applied. I don't know how complicated it is to keep making exceptions to the warning on the implementation side. 

---

_@charliermarsh reviewed on 2023-10-26 15:43_

---

_Review comment by @charliermarsh on `crates/ruff_cli/src/commands/format.rs`:707 on 2023-10-26 15:43_

I these think these are redundant when using tabs in the formatter.

---

_@charliermarsh approved on 2023-10-26 16:02_

---

_@charliermarsh reviewed on 2023-10-26 16:07_

---

_Review comment by @charliermarsh on `crates/ruff_cli/src/commands/format.rs`:712 on 2023-10-26 16:07_

This was removed because the formatter will never output code that triggers it? Is that right?

---

_@charliermarsh reviewed on 2023-10-26 16:08_

---

_Review comment by @charliermarsh on `crates/ruff_cli/src/commands/format.rs`:712 on 2023-10-26 16:08_

Yes, I believe this is the case.

---

_Merged by @charliermarsh on 2023-10-26 16:22_

---

_Closed by @charliermarsh on 2023-10-26 16:22_

---

_Branch deleted on 2023-10-26 16:22_

---
