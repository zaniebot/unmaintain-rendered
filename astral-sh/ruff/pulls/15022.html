<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bump zizmor pre-commit hook to the latest version and fix new warnings - astral-sh/ruff #15022</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Bump zizmor pre-commit hook to the latest version and fix new warnings</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15022">#15022</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-12-16 14:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>(This PR is stacked on top of <a href="https://github.com/astral-sh/ruff/pull/15021">astral-sh/ruff#15021</a>; review that first.)</p>
<p>This updates our zizmor pre-commit hook to the latest version. Zizmor detects potential security vulnerabilities in GitHub Actions workflows. The latest version of zizmor finds some more potential vulnerabilities in our workflows, which this PR fixes.</p>
<p>As with the PR that initially added zizmor to our CI, most of the required changes stem from zizmor&#x27;s <code>template-injection</code> check: https://woodruffw.github.io/zizmor/audits/#template-injection.</p>
Test Plan
<ul>
<li><code>uvx pre-commit run -a</code> passes locally</li>
<li>Let&#x27;s see if CI passes on this PR...</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ci</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-16 14:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-12-16 14:50</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
Formatter (stable)
<p>✅ ecosystem check detected no format changes.</p>
Formatter (preview)
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-16 14:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-16 14:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>.github/workflows/pr-comment.yaml</code>:17 on 2024-12-16 17:23</div>
            <div class="timeline-body"><p>Is this change to isolate the permissions only to a single job (although we only have one in this workflow file)? I&#x27;m just trying to understand the change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-16 17:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-12-16 17:24</div>
            <div class="timeline-body"><p>Looks good!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-12-16 17:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/workflows/pr-comment.yaml</code>:17 on 2024-12-16 17:27</div>
            <div class="timeline-body"><p>Yes -- here&#x27;s the complaint from the latest version of zizmor regarding the workflow as it exists on the Ruff <code>main</code> branch:</p>
<pre><code>error[excessive-permissions]: overly broad workflow or job-level permissions
  --&gt; /Users/alexw/dev/ruff/.github/workflows/pr-comment.yaml:13:1
   |
13 | / permissions:
14 | |   pull-requests: write
   | |______________________^ pull-requests: write is overly broad at the workflow level
   |
   = note: audit confidence → High

163 findings (1 ignored, 161 suppressed): 0 unknown, 0 informational, 0 low, 0 medium, 1 high
</code></pre>
<p>Docs for the zizmor rule: https://woodruffw.github.io/zizmor/audits/#excessive-permissions</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-16 17:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>.github/workflows/pr-comment.yaml</code>:17 on 2024-12-16 17:33</div>
            <div class="timeline-body"><p>Makes sense, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-12-16 17:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.pre-commit-config.yaml</code>:91 on 2024-12-16 17:35</div>
            <div class="timeline-body"><pre><code>  # zizmor detects security vulnerabilities in GitHub Actions workflows.
  # Additional configuration for the tool is found in `.github/zizmor.yml`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-16 17:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-16 17:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-12-16 17:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:09:33 UTC
    </footer>
</body>
</html>
