<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] Implement more types in binary and unary expressions - astral-sh/ruff #13803</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] Implement more types in binary and unary expressions</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/13803">#13803</a>
        opened by <a href="https://github.com/Glyphack">@Glyphack</a>
        on 2024-10-17 22:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a></div>
            <div class="timeline-body"><p>Implemented some points from <a href="https://github.com/astral-sh/ty/issues/244">astral-sh/ty#244</a></p>
<ul>
<li>Handle Unknown and Any in Unary operation</li>
<li>Handle Boolean in binary operations</li>
<li>Handle instances in unary operation</li>
<li>Consider division by False to be division by zero</li>
</ul>
<p>I thinks it&#x27;s easier to review these multiple small things in one go. Let me know if it&#x27;s not to split for next ones.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/Glyphack">@Glyphack</a> on 2024-10-17 22:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/Glyphack">@Glyphack</a> on 2024-10-17 22:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/Glyphack">@Glyphack</a> on 2024-10-17 22:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-10-17 23:00</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/booleans.md</code>:24 on 2024-10-18 01:16</div>
            <div class="timeline-body"><p>nit: this pattern of creating many variables is a legacy holdover from our previous testing infrastructure, which was more limited in the assertions it could make. For cases like this with small expressions and small types, it&#x27;s more readable to just do e.g. <code>reveal_type(a + b)  # revealed: int</code> all in one line. (In fact, a PR changing existing tests to use this style would also be welcome)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/booleans.md</code>:24 on 2024-10-18 01:19</div>
            <div class="timeline-body"><p>I think we can be more precise in all of these cases (except for division, since we don&#x27;t have float literals). For example, we know that <code>True + True == 2</code>, so that can be <code>Literal[2]</code> instead of <code>int</code>. In fact I think the best implementation strategy for all these cases (except for <code>|</code>, where we can return a <code>BooleanLiteral</code>) is to implement the operator for <code>IntLiteral</code> and then just have binary operations on <code>BooleanLiteral</code> call back in to the same operation, but with <code>BooleanLiteral[True]</code> converted to <code>Literal[1]</code> and <code>BooleanLiteral[False]</code> converted to <code>Literal[0]</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/booleans.md</code>:7 on 2024-10-18 01:22</div>
            <div class="timeline-body"><p>Especially if we go for a bit more precision, as I suggest below, it would be useful to also test with <code>True</code> and <code>False</code>, or <code>False</code> and <code>False</code>. We don&#x27;t need the full matrix, but at least some different variants for different operators. And maybe all four possible combinations for <code>|</code>, since that one is special for bools.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/unary/instance.md</code>:4 on 2024-10-18 01:24</div>
            <div class="timeline-body"><p>This test is great! Can we also add a test for a class that implements none of these dunders, and assert that we get an &quot;unsupported operation&quot; diagnostic from each operator? (Unless you decide not to implement that in this PR.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/integers.md</code>:40 on 2024-10-18 01:26</div>
            <div class="timeline-body"><p>This tests dividing by <code>False</code>, which is good, but you also added a line of code below which supports issuing division by zero diagnostic when dividing a bool by zero (i.e. the dividend is a <code>BooleanLiteral</code>). Can we add a test for that, too?</p>
<p>And actually also a test for where the dividend is just <code>bool()</code>, too!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:545 on 2024-10-18 01:27</div>
            <div class="timeline-body"><p>We can also add <code>KnownClass::Bool</code> here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2487 on 2024-10-18 01:31</div>
            <div class="timeline-body"><p>If we get a not-callable outcome here, we should emit an unsupported-operation diagnostic (in the draft PR <a href="https://github.com/astral-sh/ruff/pull/13800">astral-sh/ruff#13800</a> we are currently proposing to use the code <code>operation</code> for that diagnostic, though I&#x27;m kinda thinking I might prefer the more explicit <code>unsupported-operation</code> -- @AlexWaygood ?).</p>
<p>If you&#x27;d rather not implement that in this PR, that&#x27;s fine, but please add a TODO comment for it here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2532 on 2024-10-18 01:37</div>
            <div class="timeline-body"><p>I wouldn&#x27;t include <code>BooleanLiteral</code> here explicitly. (If you did, it should also be included for left operand, as well as right operand, so as to handle e.g. <code>True / 2</code>.) But I&#x27;d instead allow this to be handled by the more generic recursive-call approach described below.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2617 on 2024-10-18 01:41</div>
            <div class="timeline-body"><p><code>BitOr</code> of two <code>BooleanLiteral</code> needs special handling here; I&#x27;d give it its own case, and aim to return the correct <code>BooleanLiteral</code> for all four cases (should be easy to do as one line by just ORing the internal rust bools from each operand).</p>
<p>For everything else, I&#x27;d just have patterns for <code>(left, BooleanLiteral(b), op)</code> and for <code>(BooleanLiteral(b), right, op)</code> where all those cases do is construct the correct 1-or-0 <code>IntLiteral</code> for the <code>BooleanLiteral</code> (see above where that&#x27;s already done in <code>infer_unary_expression</code>) and then re-run this match using that int literal in place of the boolean literal.</p>
<p>This will require extracting an <code>infer_binary_expression_type</code> function, which takes <code>left_ty: Type, right_ty: Type, op</code> arguments and just contains the match statement, so that you can recursively call it with the new types. You can see where we already did that in <a href="https://github.com/astral-sh/ruff/pull/13800">astral-sh/ruff#13800</a>, but it&#x27;s fine to do it here too, one can easily rebase on the other.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_python_ast/src/nodes.rs</code>:3003 on 2024-10-18 01:48</div>
            <div class="timeline-body"><p>Hmm, the other three look good here, but this one can be backwards. Someone can write a class C with <code>def __bool__(self) -&gt; Literal[True]: return True</code>, and now we&#x27;ll think that <code>not C()</code> is <code>Literal[True]</code>, when it should be <code>Literal[False]</code>. (Let&#x27;s add a test for this case!)</p>
<p>I think unfortunately this means that using a direct-translation <code>dunder</code> method here is probably not the right approach for unary ops, and instead this needs to be handled explicitly with a <code>match</code> over the op kinds in type inference, so that we can flip the sense for <code>not</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> requested changes on 2024-10-18 01:49</div>
            <div class="timeline-body"><p>Thank you, this is great! A few comments:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-18 06:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2024-10-18 08:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/booleans.md</code>:24 on 2024-10-18 08:02</div>
            <div class="timeline-body"><blockquote>
<p>a PR changing existing tests to use this style would also be welcome</p>
</blockquote>
<p>I had already started with this, so here it is: <a href="https://github.com/astral-sh/ruff/pull/13806">astral-sh/ruff#13806</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a> reviewed on 2024-10-18 14:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Glyphack">@Glyphack</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/booleans.md</code>:7 on 2024-10-18 14:52</div>
            <div class="timeline-body"><p>I added more tests covering those cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-18 15:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2487 on 2024-10-18 15:47</div>
            <div class="timeline-body"><blockquote>
<p>in the draft PR <a href="https://github.com/astral-sh/ruff/pull/13800">astral-sh/ruff#13800</a> we are currently proposing to use the code <code>operation</code> for that diagnostic, though I&#x27;m kinda thinking I might prefer the more explicit <code>unsupported-operation</code> -- @AlexWaygood ?</p>
</blockquote>
<p>We actually use the <code>operator</code> code in #13800. I don&#x27;t mind using the <code>unsupported-</code> prefix, but I would much prefer to use the operat-<em>or</em> suffix rather than operat-<em>ion</em>. To some extent any type checker diagnostic comes about as a result of an &quot;unsupported operation&quot;; but this error code specifically deals with attempts to use an operat-<em>or</em> in an unsupported way.</p>
<p>TL;DR: <code>unsupported-operator</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> reviewed on 2024-10-18 16:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2487 on 2024-10-18 16:20</div>
            <div class="timeline-body"><p>Oops, my mistake; yeah <code>unsupported-operator</code> sounds good to me!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a> reviewed on 2024-10-19 10:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Glyphack">@Glyphack</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2617 on 2024-10-19 10:22</div>
            <div class="timeline-body"><p>Thanks this definitely works better than what I did.</p>
<p>Just one note, I was thinking to also move the zero division check to the recursive call so if a non trivial zero division is covered in the recursions it&#x27;s also reported but I found that cases like <code>True / False</code> will become <code>Cannot divide object of type </code>Literal[1]<code> by zero</code> so I left it in the parent function.</p>
<p>It makes sense because we can know anything that will become zero  error. But I guess another way to address your previous comment <a href="https://github.com/astral-sh/ruff/pull/13803">astral-sh/ruff#13803</a>#discussion_r1805699455 would be to do the recursive check but when we print the error message we get the type again from boolean expression.
I did this and found that there is a type map of previously calculated types. So I used the <code>types.expressions</code> here.
Let me know if there&#x27;s a better way to do it here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a> reviewed on 2024-10-19 11:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Glyphack">@Glyphack</a> on <code>crates/ruff_python_ast/src/nodes.rs</code>:3003 on 2024-10-19 11:14</div>
            <div class="timeline-body"><p>Thanks. I modified the code to to match other unary ops for instance types. We can also apply your previous suggestion here (match op and instance type and after getting the call type call the function again with return type and op) but I decided to let the Unary::Not case to handle all the Not operators to make it simpler to read.</p>
<p>So not operator will not work on instances now because it&#x27;s not fully implemented but I will implement that part in a separate pr:
https://github.com/Glyphack/ruff/blob/de190b820662478e5cdf53f16f4d48ade8721071/crates/red_knot_python_semantic/src/types.rs#L617</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a> reviewed on 2024-10-19 11:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Glyphack">@Glyphack</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2487 on 2024-10-19 11:31</div>
            <div class="timeline-body"><p>Thanks do you want to create functions to create the error with the right prefix in the future? I just put the string in the error message now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/Glyphack">@Glyphack</a> on 2024-10-19 11:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-19 16:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2487 on 2024-10-19 16:25</div>
            <div class="timeline-body"><p>At some point we&#x27;ll make our diagnostics less &quot;stringly typed&quot;, and we&#x27;ll probably do an audit of all our error codes at around the same time. For now I wouldn&#x27;t much worry about :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2490 on 2024-10-19 17:19</div>
            <div class="timeline-body"><p>Minor nit: since <code>+</code> and <code>-</code> are both unary and binary operators, let&#x27;s make sure this diagnostic is clear which one we&#x27;re talking about:</p>
<pre><code>                            &quot;Unary operator `{op}` is unsupported for type `{}`&quot;,
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2485 on 2024-10-19 17:25</div>
            <div class="timeline-body"><p>There is also the possibility of <code>CallOutcome::Union</code> where some elements of the union were not callable, in which case we should also emit this diagnostic. The way to handle this is to match on <code>call.return_ty_result(db, unary, self)</code>; if we get <code>Ok(return_ty)</code> we just return that and there is no diagnostic, if we get any <code>NotCallableError::Err</code> variant, we do emit the unsupported-operator diagnostic, and return the <code>return_ty</code> field of the <code>Err</code> variant.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2531 on 2024-10-19 17:28</div>
            <div class="timeline-body"><p>I would prefer to leave this check out in <code>infer_binary_expression</code> and not re-check it recursively, and then we don&#x27;t have to bother with <code>original_type</code> and this long comment. The only cost is that we have to explicitly check for <code>BooleanLiteral(False)</code> in the divisor, but that seems totally fine. It doesn&#x27;t seem worth the complexity of adding <code>original_type</code> and needing this long comment, and the efficiency cost of double-checking for division by zero, just so we can match on <code>IntLiteral(0)</code> instead of <code>IntLiteral(0) | BooleanLiteral(False)</code>.</p>
<p>(It would be different if there were lots of different equivalent-to-zero values we might be converting to in a recursive call, but there aren&#x27;t -- there&#x27;s exactly one.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2592 on 2024-10-19 17:34</div>
            <div class="timeline-body"><p>Let&#x27;s add a few mdtests for <code>Pow</code> operator on int literals in <code>binary/integers.md</code>? (One for each possible case here: ok literal result, too large <code>m</code>, too large result.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2652 on 2024-10-19 17:35</div>
            <div class="timeline-body"><p>This can be simplified:</p>
<pre><code>            ) =&gt; Type::BooleanLiteral(b1 | b2),
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2656 on 2024-10-19 17:38</div>
            <div class="timeline-body"><p>Let&#x27;s do it this way instead, like it&#x27;s already done in <code>infer_unary_expression</code>:</p>
<pre><code>            (Type::BooleanLiteral(bool_value), right, op) =&gt; {
                self.infer_binary_expression_type(expr, op, Type::IntLiteral(i64::from(bool_value)), right)
</code></pre>
<p>And same for the case below.</p>
<p>Bool and int literals aren&#x27;t equivalent; the conversion between them should be explicit, it shouldn&#x27;t be done implicitly by <code>expect_int_literal</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/src/types.rs</code>:364 on 2024-10-19 17:40</div>
            <div class="timeline-body"><p>We should not add this; boolean literals are not equivalent to int literals, the conversion should not be implicit. See below comment for how we can handle the conversion explicitly without doing this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_python_ast/src/nodes.rs</code>:3003 on 2024-10-19 17:46</div>
            <div class="timeline-body"><p>Sounds good! I think the results look fine now for this PR (it&#x27;s fine for handling boolean value of instances to be a separate PR), but I still think we need to remove this <code>dunder()</code> method entirely. It&#x27;s simply not correct that the unary Not operator is equivalent to the <code>__bool__</code> dunder, so leaving this method in place with that equivalence in it is asking for future bugs. Instead we should handle matching the <code>op</code> and getting the right dunder method for each op out in <code>infer_unary_expression</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> requested changes on 2024-10-19 17:47</div>
            <div class="timeline-body"><p>Thanks for the updates! This now needs to be rebased now that #13800 has landed; there are some conflicts (should be minor.) And some comments below.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> reviewed on 2024-10-19 18:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ruff_python_ast/src/nodes.rs</code>:3003 on 2024-10-19 18:07</div>
            <div class="timeline-body"><p>Or if you want to leave this method in place, it would have to return an <code>Option</code> and return <code>None</code> for unary <code>Not</code> operator. But at that point I&#x27;m not sure the ergonomics justify having the method at all, especially since I don&#x27;t expect there to be multiple call sites where we need this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a> reviewed on 2024-10-19 18:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Glyphack">@Glyphack</a> on <code>crates/ruff_python_ast/src/nodes.rs</code>:3003 on 2024-10-19 18:18</div>
            <div class="timeline-body"><p>No I&#x27;m removing it I agree with you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-19 19:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2483 on 2024-10-19 19:06</div>
            <div class="timeline-body"><p>I think this should be <code>unreachable!</code> rather than <code>debug_assert!</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Glyphack">@Glyphack</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2483 on 2024-10-19 19:13</div>
            <div class="timeline-body"><p>Oh I didn&#x27;t know about this thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a> reviewed on 2024-10-19 19:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-19 19:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2483 on 2024-10-19 19:16</div>
            <div class="timeline-body"><p>Micro-nit (sorry!!): &quot;it&#x27;s&quot; is short for &quot;it is&quot;; this should be &quot;its&quot;</p>
<pre><code>                        unreachable!(&quot;Not operator is handled in its own case&quot;);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-19 19:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/src/types/infer.rs</code>:2483 on 2024-10-19 19:16</div>
            <div class="timeline-body"><p>No worries!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/Glyphack">@Glyphack</a> on 2024-10-19 19:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/integers.md</code>:23 on 2024-10-20 01:49</div>
            <div class="timeline-body"><pre><code>largest_u32 = 4_294_967_295
reveal_type(2**2)  # revealed: Literal[4]
reveal_type(1 ** (largest_u32 + 1))  # revealed: int
reveal_type(2**largest_u32)  # revealed: int
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/red_knot_python_semantic/resources/mdtest/binary/integers.md</code>:57 on 2024-10-20 01:49</div>
            <div class="timeline-body"><pre><code># error: [division-by-zero] &quot;Cannot divide object of type `Literal[True]` by zero&quot;
True / False
# error: [division-by-zero] &quot;Cannot divide object of type `Literal[True]` by zero&quot;
bool(1) / False
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> approved on 2024-10-20 01:52</div>
            <div class="timeline-body"><p>Looks great, thank you!!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/carljm">@carljm</a> on 2024-10-20 01:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/carljm">@carljm</a> on 2024-10-20 01:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-10-20 07:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:07:32 UTC
    </footer>
</body>
</html>
