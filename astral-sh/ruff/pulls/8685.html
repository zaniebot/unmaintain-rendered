<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[isort] Simplify code structure for ordering imports - astral-sh/ruff #8685</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[isort] Simplify code structure for ordering imports</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/8685">#8685</a>
        opened by <a href="https://github.com/bluthej">@bluthej</a>
        on 2023-11-14 21:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bluthej">@bluthej</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<p>While fixing #8661 I noticed that the code structure for sorting imports could be simplified.</p>
<h2>Summary</h2>
<ul>
<li>Move the logic for <code>force_sort_within_sections</code> from <code>isort/mod.rs</code> to <code>isort/ordering.rs</code> =&gt; now there is just one line in <code>isort/mod.rs</code>: <code>let imports = order_imports(import_block, settings);</code> which yields the sorted imports</li>
<li>Change the function signature of <code>order_imports</code> to directly return a <code>Vec&lt;EitherImport&lt;'a&gt;&gt;</code>  =&gt; no need for <code>OrderedImportBlock</code></li>
</ul>
<p>I think this is a bit of an improvement because the code is simpler and there should be a bit of a speedup when setting <code>force-sort-within-sections</code> to true. Indeed, when it's set to true we're now directly ordering all the imports, whereas before we would first order the straight imports, then the from imports, combine them and finally sort the combination a second time (this is probably not noticeable in practice though).</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<p>No tests added, this is a simple refactor.</p>
<!-- How was it tested? -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2023-11-14 21:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-11-14 21:41</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-11-14 21:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-11-14 21:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @charliermarsh on 2023-11-14 21:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @charliermarsh on 2023-11-14 21:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-14 21:43</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-11-26 16:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:01:26 UTC
    </footer>
</body>
</html>
