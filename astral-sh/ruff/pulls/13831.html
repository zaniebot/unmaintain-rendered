<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] Cleanup generated names of mdtest tests - astral-sh/ruff #13831</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] Cleanup generated names of mdtest tests</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/13831">#13831</a>
        opened by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a>
        on 2024-10-20 10:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on 2024-10-20 10:27</div>
            <div class="timeline-body"><p>Part of #13768</p>
<h2>Summary</h2>
<p>Added <code>dir-test</code> to <code>red_knot_python_semantic</code> and modify <code>mdtest</code> definition.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @Aditya-PS-05 on 2024-10-20 10:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @Aditya-PS-05 on 2024-10-20 10:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @Aditya-PS-05 on 2024-10-20 10:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-10-20 10:46</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>âœ… ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>âœ… ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>âœ… ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>âœ… ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @MichaReiser on 2024-10-20 10:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/Cargo.toml</code>:38 on 2024-10-20 13:07</div>
            <div class="timeline-body"><p>Our preferred style for pinning dependencies is to put the pins in the <code>Cargo.toml</code> file in the repository root. So you'd put <code>dir-test = &quot;0.3.0&quot;</code> in the <code>Cargo.toml</code> file in the repository root, and in this <code>Cargo.toml</code> file you'd just put <code>dir-test = { workspace = true }</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:4 on 2024-10-20 13:07</div>
            <div class="timeline-body"><p>Please add this doc-comment back -- it's very useful!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:22 on 2024-10-20 13:11</div>
            <div class="timeline-body"><p>This certainly makes the tests run a lot faster! Unfortunately, that's because you're not actually testing anything anymore ðŸ˜„ You need to make sure you're actually still calling <code>red_knot_test::run()</code> on the path after you've &quot;cleaned the path up&quot; :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> requested changes on 2024-10-20 13:11</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:22 on 2024-10-20 13:18</div>
            <div class="timeline-body"><p>Sorry, I didn't understand. Are you trying to point out it's wrong and so I need to add <code>red_knot_test::run()</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> reviewed on 2024-10-20 13:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-20 13:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:22 on 2024-10-20 13:24</div>
            <div class="timeline-body"><blockquote>
<p>Sorry, I didn't understand. Are you trying to point out it's wrong and so I need to add <code>red_knot_test::run()</code>?</p>
</blockquote>
<p>Yes.</p>
<p>The way these tests work is a macro generates (at build time) a Rust test for each file in a specific directory. Each generated test runs <code>red_knot_test::run()</code> on a specific Markdown file here. The <code>red_knot_test::run()</code> call is the part of the test that actually makes assertions that red-knot is running correctly:</p>
<p>https://github.com/astral-sh/ruff/blob/7ca357119496ecae3bcc72549e0133e8b69c3ec6/crates/red_knot_python_semantic/tests/mdtest.rs#L13</p>
<p>Your PR currently removes this call, meaning that the macro is generating a lot of tests, but those tests aren't really testing anything :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "modifying markdown test names" to "[red-knot] Cleanup generated names of mdtest tests" by @AlexWaygood on 2024-10-20 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> reviewed on 2024-10-20 14:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:22 on 2024-10-20 14:00</div>
            <div class="timeline-body"><p>Required changes done.
Thanks for review and sorry for blunders.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-10-20 14:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:22 on 2024-10-20 14:14</div>
            <div class="timeline-body"><p>No worries!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2024-10-20 14:16</div>
            <div class="timeline-body"><p>Thanks! This LGTM. I confirmed it implements the feature @MichaReiser asked for, and that the tests still fail correctly if there's an incorrect assertion in a <code>.md</code> file. The tests also <em>appear</em> to be running slightly faster for me locally as well, which is nice!</p>
<p>I'll wait for another approval before merging, though, as I'm pretty new to <code>dir-test</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-10-20 14:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>Cargo.lock</code>:410 on 2024-10-20 14:29</div>
            <div class="timeline-body"><p>Hmm, that's unfortunate that dir-test still uses <code>syn</code> one but so be it. We can always make a PR upstream</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/red_knot_python_semantic/Cargo.toml</code>:38 on 2024-10-20 14:29</div>
            <div class="timeline-body"><p>This should be a dev dependency</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-10-20 14:30</div>
            <div class="timeline-body"><p>This looks good. Thanks. Let's move the <code>dir-test</code> dependency to the dev dependency section and we can land this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>Cargo.toml</code>:68 on 2024-10-20 15:01</div>
            <div class="timeline-body"><pre><code class="language-suggestion">dir-test = { version = &quot;0.3.0&quot; }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/red_knot_python_semantic/Cargo.toml</code>:46 on 2024-10-20 15:01</div>
            <div class="timeline-body"><pre><code class="language-suggestion">ruff_db = { workspace = true, features = [&quot;os&quot;, &quot;testing&quot;] }
ruff_python_parser = { workspace = true }
red_knot_test = { workspace = true }
red_knot_vendored = { workspace = true }

anyhow = { workspace = true }
dir-test = {workspace = true}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-10-20 15:01</div>
            <div class="timeline-body"><p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-10-20 15:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-10-20 15:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-10-20 15:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on 2024-10-20 15:19</div>
            <div class="timeline-body"><p>Can I ask a question?
I am a student and I want to get an internship as in my college internship is necessary. Can you guys please suggest me advice or give me tips to get an work through open-source and how to improve my open-source work?</p>
<p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-10-21 10:47</div>
            <div class="timeline-body"><p>Hey @Aditya-PS-05. Thanks again for the PR! It was really useful, and an important improvement.</p>
<p>GitHub issue trackers and PR threads aren't really the best place to ask for this kind of advice. There are forums such as Reddit and various programming Discord servers where volunteers are often very happy to give this kind of advice, but on GitHub we prefer to be more focussed on specific coding projects and problems :-)</p>
<p>That said, my advice would be:</p>
<ul>
<li><p>Continue submitting open-source PRs! I managed to get hired on the back of my open-source experience, so it's definitely possible.</p>
</li>
<li><p>Focus on PRs where you're confident you understand how to fix the problem. A PR that doesn't really address an issue or that approaches an issue in completely the wrong way can end up meaning that a maintainer has to spend more time reviewing and fixing the PR than they would have spent if they just did it themselves.</p>
<p>This PR wasn't that -- I think it did save us some time! It did also have some important mistakes in it at the start, though, which I think could possibly have been avoided if you'd taken some more time to think about the problem before submitting the PR.</p>
</li>
<li><p>Your ability to make excellent PRs will improve if you continue to improve your programming ability in other ways as well. Read lots of code, watch YouTube programming tutorials, read tutorials/howtos/StackOverflow questions, continue to work on your own hobby projects. You don't have to do all of these, but they're all great ways to continue learning and developing your skills, and they'll all make you a better open-source contributor in the long run.</p>
</li>
</ul>
<p>Hope that helps. Good luck with your coding journey! :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on 2024-10-21 15:56</div>
            <div class="timeline-body"><blockquote>
<p>Hey @Aditya-PS-05. Thanks again for the PR! It was really useful, and an important improvement.</p>
<p>GitHub issue trackers and PR threads aren't really the best place to ask for this kind of advice. There are forums such as Reddit and various programming Discord servers where volunteers are often very happy to give this kind of advice, but on GitHub we prefer to be more focussed on specific coding projects and problems :-)</p>
<p>That said, my advice would be:</p>
<pre><code>* Continue submitting open-source PRs! I managed to get hired on the back of my open-source experience, so it's definitely possible.

* Focus on PRs where you're confident you understand how to fix the problem. A PR that doesn't really address an issue or that approaches an issue in completely the wrong way can end up meaning that a maintainer has to spend more time reviewing and fixing the PR than they would have spent if they just did it themselves.
  This PR wasn't that -- I think it did save us some time! It did also have some important mistakes in it at the start, though, which I think could possibly have been avoided if you'd taken some more time to think about the problem before submitting the PR.

* Your ability to make excellent PRs will improve if you continue to improve your programming ability in other ways as well. Read lots of code, watch YouTube programming tutorials, read tutorials/howtos/StackOverflow questions, continue to work on your own hobby projects. You don't have to do all of these, but they're all great ways to continue learning and developing your skills, and they'll all make you a better open-source contributor in the long run.</code></pre>
<p>Hope that helps. Good luck with your coding journey! :-)</p>
</blockquote>
<p>Thank you @AlexWaygood for such a great advice.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 21:00:08 UTC
    </footer>
</body>
</html>
