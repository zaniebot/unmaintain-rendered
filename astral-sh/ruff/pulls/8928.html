<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`] Add `add_argument` utility and autofix for `PLW1514` - astral-sh/ruff #8928</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pylint</code>] Add <code>add_argument</code> utility and autofix for <code>PLW1514</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/8928">#8928</a>
        opened by <a href="https://github.com/qdegraaf">@qdegraaf</a>
        on 2023-11-30 18:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-11-30 18:38</div>
            <div class="timeline-body"><h2>Summary</h2>
<ul>
<li>Adds <code>add_argument</code> similar to existing <code>remove_argument</code> utility to safely add arguments to functions.</li>
<li>Adds autofix for <code>PLW1514</code> as per specs requested in https://github.com/astral-sh/ruff/issues/8883 as a test</li>
</ul>
<h2>Test Plan</h2>
<p>Checks on existing fixtures as well as additional test and fixture for Python 3.9 and lower fix</p>
<h2>Issue Link</h2>
<p>Closes: https://github.com/astral-sh/ruff/issues/8883</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add autofix for `PLW1514`" to "[`pylint`] Add autofix for `PLW1514`" by @qdegraaf on 2023-11-30 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-11-30 18:57</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-11-30 19:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/pylint/rules/unspecified_encoding.rs</code>:89 on 2023-11-30 19:30</div>
            <div class="timeline-body"><p>Would this introduce a syntax error if the call contains no arguments? Are you interested in writing a more robust <code>add_argument</code> utility, similar to the <code>remove_argument</code> that exists today?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/qdegraaf">@qdegraaf</a> reviewed on 2023-11-30 19:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on <code>crates/ruff_linter/src/rules/pylint/rules/unspecified_encoding.rs</code>:89 on 2023-11-30 19:54</div>
            <div class="timeline-body"><p>Yes it would. <code>open()</code> and similar calls all have a required first argument AFAIK but it's still a pretty dirty and unsafe fix.</p>
<p>I'd be interested in adding that utility for sure! Will set this to draft and use the autofix as a test case for the utility if there is no urgency behind it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`pylint`] Add autofix for `PLW1514`" to "[`pylint`] Add `add_argument` utility and autofix for `PLW1514`" by @qdegraaf on 2023-11-30 19:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @qdegraaf on 2023-11-30 19:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-11-30 20:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/pylint/rules/unspecified_encoding.rs</code>:89 on 2023-11-30 20:16</div>
            <div class="timeline-body"><p>Awesome, thanks @qdegraaf!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on <code>crates/ruff_linter/src/rules/pylint/rules/unspecified_encoding.rs</code>:89 on 2023-12-01 17:07</div>
            <div class="timeline-body"><p>Implemented a coarse first version which only handles keyword arguments, but does check for trailing commas and work with empty calls. It explicitly forbids positional arguments but could still maybe break when adding a first argument to a class instantiation.</p>
<p>I could either use the lexer to check for parentheses and panic if they aren't there and leave the implementation of that to a future PR or implement it in this one. What's your preference? If the latter is preferred, if you happen to know of a rule where something like that happens on which I can test the util in absence of unit test infrastructure let me know.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/qdegraaf">@qdegraaf</a> reviewed on 2023-12-01 17:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @qdegraaf on 2023-12-01 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @charliermarsh on 2023-12-01 17:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autofix</span> added by @charliermarsh on 2023-12-01 17:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-12-01 18:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_linter/src/rules/pylint/rules/unspecified_encoding.rs</code>:89 on 2023-12-01 18:06</div>
            <div class="timeline-body"><p>I think it's fine to leave this as function-only for now, so we can assume the parentheses always exist.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-12-01 18:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-12-01 18:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 02:13:23 UTC
    </footer>
</body>
</html>
