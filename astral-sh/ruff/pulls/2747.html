<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add rendering of rule markdown for terminal output - astral-sh/ruff #2747</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add rendering of rule markdown for terminal output</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/2747">#2747</a>
        opened by <a href="https://github.com/ngnpope">@ngnpope</a>
        on 2023-02-10 22:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ngnpope">@ngnpope</a></div>
            <div class="timeline-body"><p>Add rendering of rule markdown for terminal output</p>
<p>This is achieved by making use of the <code>mdcat</code> crate.</p>
<p>See the following links for details:</p>
<ul>
<li>https://crates.io/crates/mdcat</li>
<li>https://github.com/swsnr/mdcat</li>
<li>https://docs.rs/mdcat/latest/mdcat/</li>
</ul>
<hr />
<p>I'm a rust newbie, so this was interesting...</p>
<p>I thought to look to implement support for piping to a pager, which is implemented in <code>mdcat</code> - the source could be used for guidance on how to achieve that. But I wasn't sure whether that would be better implemented as a global option? This is enough for now and a vast improvement on the current output.</p>
<p>I also implemented support for <code>NO_COLOR</code> which will also give better output.</p>
<hr />
<p><img src="https://user-images.githubusercontent.com/2855582/218208634-9a3e4ca0-01ce-4892-994e-304a7965bd5f.png" alt="Screenshot from 2023-02-10 22-12-12" />
<img src="https://user-images.githubusercontent.com/2855582/218208638-d50f58d8-3770-40bc-bc48-aaeabe88c360.png" alt="Screenshot from 2023-02-10 22-11-48" />
<img src="https://user-images.githubusercontent.com/2855582/218208641-daee0493-f10a-47f6-9c83-eba3e5b76c3e.png" alt="Screenshot from 2023-02-10 22-06-15" />
<img src="https://user-images.githubusercontent.com/2855582/218208642-4ae58a10-e240-42f3-8bab-2c2c8e2c2e72.png" alt="Screenshot from 2023-02-10 22-05-29" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-10 22:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_pyi/rules.rs</code>:29 on 2023-02-10 22:17</div>
            <div class="timeline-body"><p>Do you mind separating this change into a separate PR, to make this one more focused and easier to review?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-10 22:21</div>
            <div class="timeline-body"><p>Thank you for putting this together! The images look really nice. Excited to review.</p>
<p>Is there any way to force it to output raw markdown? We may want to preserve that option somehow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ngnpope">@ngnpope</a> on <code>crates/ruff/src/rules/flake8_pyi/rules.rs</code>:29 on 2023-02-10 22:21</div>
            <div class="timeline-body"><p>See #2749.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ngnpope">@ngnpope</a> reviewed on 2023-02-10 22:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ngnpope">@ngnpope</a> reviewed on 2023-02-10 22:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ngnpope">@ngnpope</a> on <code>crates/ruff/src/rules/flake8_pyi/rules.rs</code>:29 on 2023-02-10 22:23</div>
            <div class="timeline-body"><p>Will also take <a href="https://github.com/charliermarsh/ruff/pull/2747/commits/aecbc08ddb9da34188fe0f8d67b24a47018ac217">Fix some code block markers</a> over there too to avoid conflicts here...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-10 22:50</div>
            <div class="timeline-body"><blockquote>
<p>Is there any way to force it to output raw markdown? We may want to preserve that option somehow.</p>
</blockquote>
<p>Yup. Just coming up with something now...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @ngnpope on 2023-02-10 23:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @charliermarsh removed by @ngnpope on 2023-02-10 23:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @ngnpope on 2023-02-10 23:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-10 23:38</div>
            <div class="timeline-body"><p>Bedtime for me üò¥ Enjoy!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-11 17:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands.rs</code>:335 on 2023-02-11 17:48</div>
            <div class="timeline-body"><p>Ironically I expected <code>HelpFormat::Text</code> to be the &quot;raw text&quot; and <code>HelpFormat::Markdown</code> to be the &quot;rendered Markdown&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands.rs</code>:335 on 2023-02-11 21:13</div>
            <div class="timeline-body"><p>Thinking about it more... I do think it makes sense for <code>--format text</code> to render as plain-text, and <code>--format markdown</code> to render with <code>mdcat</code>. We could then make <code>--format markdown</code> the default. What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-11 21:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ngnpope">@ngnpope</a> reviewed on 2023-02-11 22:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ngnpope">@ngnpope</a> on <code>crates/ruff_cli/src/commands.rs</code>:335 on 2023-02-11 22:09</div>
            <div class="timeline-body"><p>Sure. I won't be able to get around to it for a few days, so feel free to rejig - should be straightforwardüôÇ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-02-11 22:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands.rs</code>:335 on 2023-02-11 22:09</div>
            <div class="timeline-body"><p>Okay cool, will do :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-02-12 02:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-02-12 02:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-02-12 03:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>crates/ruff_cli/src/args.rs</code>:287 on 2023-02-12 03:22</div>
            <div class="timeline-body"><p>I think we should definitely choose a different name for this new format.</p>
<p>Because it's actually the <code>text</code> format that prints Markdown. The new format doesn't print Markdown but some rich text with escape sequences and special formatting. That it uses &quot;mdcat&quot; under the hood is only an implementation detail.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-02-12 03:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>crates/ruff_cli/src/args.rs</code>:287 on 2023-02-12 03:24</div>
            <div class="timeline-body"><p>Maybe <code>pretty</code>? (inspired by the git pretty formats)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/not-my-profile">@not-my-profile</a> reviewed on 2023-02-12 04:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on <code>crates/ruff_cli/src/args.rs</code>:287 on 2023-02-12 04:09</div>
            <div class="timeline-body"><p>Opened #2797 to address this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-02-12 10:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ngnpope">@ngnpope</a> on <code>crates/ruff_cli/src/args.rs</code>:287 on 2023-02-12 10:10</div>
            <div class="timeline-body"><p>üëçüèª</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ngnpope">@ngnpope</a> reviewed on 2023-02-12 10:10</div>
            <div class="timeline-body"></div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:56:08 UTC
    </footer>
</body>
</html>
