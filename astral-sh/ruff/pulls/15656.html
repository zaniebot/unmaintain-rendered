<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update dependency vite to v6.0.9 - astral-sh/ruff #15656</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update dependency vite to v6.0.9</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15656">#15656</a>
        opened by <a href="https://github.com/renovate">@renovate</a>
        on 2025-01-21 21:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/renovate">@renovate</a></div>
            <div class="timeline-body"><p>This PR contains the following updates:</p>
<p>| Package | Change | Age | Adoption | Passing | Confidence |
|---|---|---|---|---|---|
| <a href="https://vite.dev">vite</a> (<a href="https://redirect.github.com/vitejs/vite/tree/HEAD/packages/vite">source</a>) | <a href="https://renovatebot.com/diffs/npm/vite/6.0.7/6.0.9"><code>6.0.7</code> -&gt; <code>6.0.9</code></a> | <a href="https://docs.renovatebot.com/merge-confidence/"><img src="https://developer.mend.io/api/mc/badges/age/npm/vite/6.0.9?slim=true" alt="age" /></a> | <a href="https://docs.renovatebot.com/merge-confidence/"><img src="https://developer.mend.io/api/mc/badges/adoption/npm/vite/6.0.9?slim=true" alt="adoption" /></a> | <a href="https://docs.renovatebot.com/merge-confidence/"><img src="https://developer.mend.io/api/mc/badges/compatibility/npm/vite/6.0.7/6.0.9?slim=true" alt="passing" /></a> | <a href="https://docs.renovatebot.com/merge-confidence/"><img src="https://developer.mend.io/api/mc/badges/confidence/npm/vite/6.0.7/6.0.9?slim=true" alt="confidence" /></a> |</p>
<hr />
<blockquote>
<p>[!WARNING]
Some dependencies could not be looked up. Check the Dependency Dashboard for more information.</p>
</blockquote>
<h3>GitHub Vulnerability Alerts</h3>
<h4><a href="https://redirect.github.com/vitejs/vite/security/advisories/GHSA-vg6x-rcgg-rjx6">CVE-2025-24010</a></h4>
<h3>Summary</h3>
<p>Vite allowed any websites to send any requests to the development server and read the response due to default CORS settings and lack of validation on the Origin header for WebSocket connections.</p>
<h3>Upgrade Path</h3>
<p>Users that does not match either of the following conditions should be able to upgrade to a newer version of Vite that fixes the vulnerability without any additional configuration.</p>
<ul>
<li>Using the backend integration feature</li>
<li>Using a reverse proxy in front of Vite</li>
<li>Accessing the development server via a domain other than <code>localhost</code> or <code>*.localhost</code></li>
<li>Using a plugin / framework that connects to the WebSocket server on their own from the browser</li>
</ul>
<h4>Using the backend integration feature</h4>
<p>If you are using the backend integration feature and not setting <a href="https://vite.dev/config/server-options.html#server-origin"><code>server.origin</code></a>, you need to add the origin of the backend server to the <a href="https://redirect.github.com/expressjs/cors#configuration-options"><code>server.cors.origin</code></a> option. Make sure to set a specific origin rather than <code>*</code>, otherwise any origin can access your development server.</p>
<h4>Using a reverse proxy in front of Vite</h4>
<p>If you are using a reverse proxy in front of Vite and sending requests to Vite with a hostname other than <code>localhost</code> or <code>*.localhost</code>, you need to add the hostname to the new <a href="https://vite.dev/config/server-options.html#server-allowedhosts"><code>server.allowedHosts</code></a> option. For example, if the reverse proxy is sending requests to <code>http://vite:5173</code>, you need to add <code>vite</code> to the <code>server.allowedHosts</code> option.</p>
<h4>Accessing the development server via a domain other than <code>localhost</code> or <code>*.localhost</code></h4>
<p>You need to add the hostname to the new <a href="https://vite.dev/config/server-options.html#server-allowedhosts"><code>server.allowedHosts</code></a> option. For example, if you are accessing the development server via <code>http://foo.example.com:8080</code>, you need to add <code>foo.example.com</code> to the <code>server.allowedHosts</code> option.</p>
<h4>Using a plugin / framework that connects to the WebSocket server on their own from the browser</h4>
<p>If you are using a plugin / framework, try upgrading to a newer version of Vite that fixes the vulnerability. If the WebSocket connection appears not to be working, the plugin / framework may have a code that connects to the WebSocket server on their own from the browser.</p>
<p>In that case, you can either:</p>
<ul>
<li>fix the plugin / framework code to the make it compatible with the new version of Vite</li>
<li>set <code>legacy.skipWebSocketTokenCheck: true</code> to opt-out the fix for [2] while the plugin / framework is incompatible with the new version of Vite<ul>
<li>When enabling this option, <strong>make sure that you are aware of the security implications</strong> described in the impact section of [2] above.</li>
</ul>
</li>
</ul>
<h3>Mitigation without upgrading Vite</h3>
<h4>[1]: Permissive default CORS settings</h4>
<p>Set <code>server.cors</code> to <code>false</code> or limit <code>server.cors.origin</code> to trusted origins.</p>
<h4>[2]: Lack of validation on the Origin header for WebSocket connections</h4>
<p>There aren't any mitigations for this.</p>
<h4>[3]: Lack of validation on the Host header for HTTP requests</h4>
<p>Use Chrome 94+ or use HTTPS for the development server.</p>
<h3>Details</h3>
<p>There are three causes that allowed malicious websites to send any requests to the development server:</p>
<h4>[1]: Permissive default CORS settings</h4>
<p>Vite sets the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a> header depending on <a href="https://vite.dev/config/server-options.html#server-cors"><code>server.cors</code></a> option. The default value was <code>true</code> which sets <code>Access-Control-Allow-Origin: *</code>. This allows websites on any origin to <code>fetch</code> contents served on the development server.</p>
<p>Attack scenario:</p>
<ol>
<li>The attacker serves a malicious web page (<code>http://malicious.example.com</code>).</li>
<li>The user accesses the malicious web page.</li>
<li>The attacker sends a <code>fetch('http://127.0.0.1:5173/main.js')</code> request by JS in that malicious web page. This request is normally blocked by same-origin policy, but that's not the case for the reasons above.</li>
<li>The attacker gets the content of <code>http://127.0.0.1:5173/main.js</code>.</li>
</ol>
<h4>[2]: Lack of validation on the Origin header for WebSocket connections</h4>
<p>Vite starts a WebSocket server to handle HMR and other functionalities. This WebSocket server <a href="https://redirect.github.com/vitejs/vite/blob/v6.0.7/packages/vite/src/node/server/ws.ts#L145-L157">did not perform validation on the Origin header</a> and was vulnerable to Cross-Site WebSocket Hijacking (CSWSH) attacks. With that attack, an attacker can read and write messages on the WebSocket connection. Vite only sends some information over the WebSocket connection (<a href="https://redirect.github.com/vitejs/vite/blob/v6.0.7/packages/vite/types/hmrPayload.d.ts#L12-L72">list of the file paths that changed, the file content where the errored happened, etc.</a>), but plugins can send arbitrary messages and may include more sensitive information.</p>
<p>Attack scenario:</p>
<ol>
<li>The attacker serves a malicious web page (<code>http://malicious.example.com</code>).</li>
<li>The user accesses the malicious web page.</li>
<li>The attacker runs <code>new WebSocket('http://127.0.0.1:5173', 'vite-hmr')</code> by JS in that malicious web page.</li>
<li>The user edits some files.</li>
<li>Vite sends some HMR messages over WebSocket.</li>
<li>The attacker gets the content of the HMR messages.</li>
</ol>
<h4>[3]: Lack of validation on the Host header for HTTP requests</h4>
<p>Unless <a href="https://vite.dev/config/server-options.html#server-https"><code>server.https</code></a> is set, Vite starts the development server on HTTP. Non-HTTPS servers are vulnerable to DNS rebinding attacks without validation on the Host header. But Vite did not perform validation on the Host header. By exploiting this vulnerability, an attacker can send arbitrary requests to the development server bypassing the same-origin policy.</p>
<ol>
<li>The attacker serves a malicious web page that is served on <strong>HTTP</strong> (<code>http://malicious.example.com:5173</code>) (HTTPS won't work).</li>
<li>The user accesses the malicious web page.</li>
<li>The attacker changes the DNS to point to 127.0.0.1 (or other private addresses).</li>
<li>The attacker sends a <code>fetch('/main.js')</code> request by JS in that malicious web page.</li>
<li>The attacker gets the content of <code>http://127.0.0.1:5173/main.js</code> bypassing the same origin policy.</li>
</ol>
<h3>Impact</h3>
<h4>[1]: Permissive default CORS settings</h4>
<p>Users with the default <code>server.cors</code> option may:</p>
<ul>
<li>get the source code stolen by malicious websites</li>
<li>give the attacker access to functionalities that are not supposed to be exposed externally<ul>
<li>Vite core does not have any functionality that causes changes somewhere else when receiving a request, but plugins may implement those functionalities and servers behind <code>server.proxy</code> may have those functionalities.</li>
</ul>
</li>
</ul>
<h4>[2]: Lack of validation on the Origin header for WebSocket connections</h4>
<p>All users may get the file paths of the files that changed and the file content where the error happened be stolen by malicious websites.</p>
<p>For users that is using a plugin that sends messages over WebSocket, that content may be stolen by malicious websites.</p>
<p>For users that is using a plugin that has a functionality that is triggered by messages over WebSocket, that functionality may be exploited by malicious websites.</p>
<h4>[3]: Lack of validation on the Host header for HTTP requests</h4>
<p>Users using HTTP for the development server and using a browser that is not Chrome 94+ may:</p>
<ul>
<li>get the source code stolen by malicious websites</li>
<li>give the attacker access to functionalities that are not supposed to be exposed externally<ul>
<li>Vite core does not have any functionality that causes changes somewhere else when receiving a request, but plugins may implement those functionalities and servers behind <code>server.proxy</code> may have those functionalities.</li>
</ul>
</li>
</ul>
<p>Chrome 94+ users are not affected for [3], because <a href="https://developer.chrome.com/blog/private-network-access-update#chrome_94">sending a request to a private network page from public non-HTTPS page is forbidden</a> since Chrome 94.</p>
<h3>Related Information</h3>
<p>Safari has <a href="https://bugs.webkit.org/show_bug.cgi?id=171934">a bug that blocks requests to loopback addresses from HTTPS origins</a>. This means when the user is using Safari and Vite is listening on lookback addresses, there's another condition of &quot;the malicious web page is served on HTTP&quot; to make [1] and [2] to work.</p>
<h3>PoC</h3>
<h4>[2]: Lack of validation on the Origin header for WebSocket connections</h4>
<ol>
<li>I used the <code>react</code> template which utilizes HMR functionality.</li>
</ol>
<pre><code>npm create vite@latest my-vue-app-react -- --template react
</code></pre>
<ol start="2">
<li>Then on a malicious server, serve the following POC html:</li>
</ol>
<pre><code class="language-html">&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot;&gt;
    &lt;head&gt;
        &lt;meta charset=&quot;utf-8&quot; /&gt;
        &lt;title&gt;vite CSWSH&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id=&quot;logs&quot;&gt;&lt;/div&gt;
        &lt;script&gt;
            const div = document.querySelectorAll('#logs')[0];
            const ws = new WebSocket('ws://localhost:5173','vite-hmr');
            ws.onmessage = event =&gt; {
                const logLine = document.createElement('p');
                logLine.innerHTML = event.data;
                div.append(logLine);
            };
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<ol start="3">
<li>Kick off Vite</li>
</ol>
<pre><code>npm run dev
</code></pre>
<ol start="4">
<li>Load the development server (open <code>http://localhost:5173/</code>) as well as the malicious page in the browser.</li>
<li>Edit <code>src/App.jsx</code> file and intentionally place a syntax error</li>
<li>Notice how the malicious page can view the websocket messages and a snippet of the source code is exposed</li>
</ol>
<p>Here's a video demonstrating the POC:</p>
<p>https://github.com/user-attachments/assets/a4ad05cd-0b34-461c-9ff6-d7c8663d6961</p>
<hr />
<h3>Release Notes</h3>
<details>
<summary>vitejs/vite (vite)</summary>

<h3><a href="https://redirect.github.com/vitejs/vite/blob/HEAD/packages/vite/CHANGELOG.md#small609-2025-01-20-small"><code>v6.0.9</code></a></h3>
<p><a href="https://redirect.github.com/vitejs/vite/compare/v6.0.8...v6.0.9">Compare Source</a></p>
<ul>
<li>fix!: check host header to prevent DNS rebinding attacks and introduce <code>server.allowedHosts</code> (<a href="https://redirect.github.com/vitejs/vite/commit/bd896fb5f312fc0ff1730166d1d142fc0d34ba6d">bd896fb</a>)</li>
<li>fix!: default <code>server.cors: false</code> to disallow fetching from untrusted origins (<a href="https://redirect.github.com/vitejs/vite/commit/b09572acc939351f4e4c50ddf793017a92c678b1">b09572a</a>)</li>
<li>fix: verify token for HMR WebSocket connection (<a href="https://redirect.github.com/vitejs/vite/commit/029dcd6d77d3e3ef10bc38e9a0829784d9760fdb">029dcd6</a>)</li>
</ul>
<h3><a href="https://redirect.github.com/vitejs/vite/blob/HEAD/packages/vite/CHANGELOG.md#small608-2025-01-20-small"><code>v6.0.8</code></a></h3>
<p><a href="https://redirect.github.com/vitejs/vite/compare/v6.0.7...v6.0.8">Compare Source</a></p>
<ul>
<li>fix: avoid SSR HMR for HTML files (<a href="https://redirect.github.com/vitejs/vite/issues/19193">#â€‹19193</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/3bd55bcb7e831d2c4f66c90d7bbb3e1fbf7a02b6">3bd55bc</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19193">#â€‹19193</a></li>
<li>fix: build time display 7m 60s (<a href="https://redirect.github.com/vitejs/vite/issues/19108">#â€‹19108</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/cf0d2c8e232a1af716c71cdd2218d180f7ecc02b">cf0d2c8</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19108">#â€‹19108</a></li>
<li>fix: don't resolve URL starting with double slash (<a href="https://redirect.github.com/vitejs/vite/issues/19059">#â€‹19059</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/35942cde11fd8a68fa89bf25f7aa1ddb87d775b2">35942cd</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19059">#â€‹19059</a></li>
<li>fix: ensure <code>server.close()</code> only called once (<a href="https://redirect.github.com/vitejs/vite/issues/19204">#â€‹19204</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/db81c2dada961f40c0882b5182adf2f34bb5c178">db81c2d</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19204">#â€‹19204</a></li>
<li>fix: resolve.conditions in ResolvedConfig was <code>defaultServerConditions</code> (<a href="https://redirect.github.com/vitejs/vite/issues/19174">#â€‹19174</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/ad75c56dce5618a3a416e18f9a5c3880d437a107">ad75c56</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19174">#â€‹19174</a></li>
<li>fix: tree shake stringified JSON imports (<a href="https://redirect.github.com/vitejs/vite/issues/19189">#â€‹19189</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/f2aed62d0bf1b66e870ee6b4aab80cd1702793ab">f2aed62</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19189">#â€‹19189</a></li>
<li>fix: use shared sigterm callback (<a href="https://redirect.github.com/vitejs/vite/issues/19203">#â€‹19203</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/47039f4643179be31a8d7c7fbff83c5c13deb787">47039f4</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19203">#â€‹19203</a></li>
<li>fix(deps): update all non-major dependencies (<a href="https://redirect.github.com/vitejs/vite/issues/19098">#â€‹19098</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/8639538e6498d1109da583ad942c1472098b5919">8639538</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19098">#â€‹19098</a></li>
<li>fix(optimizer): use correct default install state path for yarn PnP (<a href="https://redirect.github.com/vitejs/vite/issues/19119">#â€‹19119</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/e690d8bb1e5741e81df5b7a6a5c8c3c1c971fa41">e690d8b</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19119">#â€‹19119</a></li>
<li>fix(types): improve <code>ESBuildOptions.include / exclude</code> type to allow <code>readonly (string | RegExp)[]</code>  (<a href="https://redirect.github.com/vitejs/vite/commit/ea53e7095297ea4192490fd58556414cc59a8975">ea53e70</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19146">#â€‹19146</a></li>
<li>chore(deps): update dependency pathe to v2 (<a href="https://redirect.github.com/vitejs/vite/issues/19139">#â€‹19139</a>) (<a href="https://redirect.github.com/vitejs/vite/commit/71506f0a8deda5254cb49c743cd439dfe42859ce">71506f0</a>), closes <a href="https://redirect.github.com/vitejs/vite/issues/19139">#â€‹19139</a></li>
</ul>
</details>

<hr />
<h3>Configuration</h3>
<p>ðŸ“… <strong>Schedule</strong>: Branch creation - &quot;&quot; (UTC), Automerge - At any time (no schedule defined).</p>
<p>ðŸš¦ <strong>Automerge</strong>: Disabled by config. Please merge this manually once you are satisfied.</p>
<p>â™» <strong>Rebasing</strong>: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.</p>
<p>ðŸ”• <strong>Ignore</strong>: Close this PR and you won't be reminded about this update again.</p>
<hr />
<ul>
<li>[ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box</li>
</ul>
<hr />
<p>This PR was generated by <a href="https://mend.io/renovate/">Mend Renovate</a>. View the <a href="https://developer.mend.io/github/astral-sh/ruff">repository job log</a>.</p>
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzOS4xMDcuMCIsInVwZGF0ZWRJblZlciI6IjM5LjEwNy4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiIsImxhYmVscyI6WyJpbnRlcm5hbCIsInNlY3VyaXR5Il19-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @renovate[bot] on 2025-01-21 21:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">security</span> added by @renovate[bot] on 2025-01-21 21:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @AlexWaygood on 2025-01-21 22:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">security</span> removed by @MichaReiser on 2025-01-22 07:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-01-22 07:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-01-22 07:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-22 07:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:09:22 UTC
    </footer>
</body>
</html>
