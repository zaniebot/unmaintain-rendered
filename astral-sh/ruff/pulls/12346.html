<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider expression before statement when determining binding kind - astral-sh/ruff #12346</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider expression before statement when determining binding kind</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12346">#12346</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-07-16 14:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>I believe these should always bind more tightly -- e.g., in:</p>
<pre><code class="language-python">for _ in bar(baz for foo in [1]):
    pass
</code></pre>
<p>The inner <code>baz</code> and <code>foo</code> should be considered comprehension variables, not for loop bindings.</p>
<p>We need to revisit this more holistically. In some of these cases, <code>BindingKind</code> should probably be a flag, not an enum, since the values aren't mutually exclusive. Separately, we should probably be more precise in how we set it (e.g., by passing down from the parent rather than sniffing in <code>handle_node_store</code>).</p>
<p>Closes https://github.com/astral-sh/ruff/issues/12339</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-07-16 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-07-16 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-16 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-16 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-07-16 14:58</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+0 -1 violations, +0 -0 fixes in 1 projects; 53 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -1 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/apache/airflow/blob/ee2be505ec25eb26a7928a5a5ae2b04c7efa8513/dev/breeze/src/airflow_breeze/commands/kubernetes_commands.py#L689'>dev/breeze/src/airflow_breeze/commands/kubernetes_commands.py:689:51:</a> PLR1704 Redefining argument with the local name `python`
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLR1704 | 1 | 0 | 1 | 0 | 0 |</p>
</p>
</details>

<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+0 -1 violations, +0 -0 fixes in 1 projects; 53 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -1 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/apache/airflow/blob/ee2be505ec25eb26a7928a5a5ae2b04c7efa8513/dev/breeze/src/airflow_breeze/commands/kubernetes_commands.py#L689'>dev/breeze/src/airflow_breeze/commands/kubernetes_commands.py:689:51:</a> PLR1704 Redefining argument with the local name `python`
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLR1704 | 1 | 0 | 1 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-16 15:00</div>
            <div class="timeline-body"><p>Ecosystem change is correct.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:05:20 UTC
    </footer>
</body>
</html>
