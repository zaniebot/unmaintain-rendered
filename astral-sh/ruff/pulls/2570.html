<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`]: bad-str-strip-call - astral-sh/ruff #2570</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/2570">#2570</a>
        opened by <a href="https://github.com/colin99d">@colin99d</a>
        on 2023-02-04 16:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/colin99d">@colin99d</a></div>
            <div class="timeline-body"><p>ref #970</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-04 16:57</div>
            <div class="timeline-body"><p>Currently the autofixer can leave complicated strings looking slightly different. To a certain degree this has to happen because duplicate new lines, and other characters, must be removed. Additionally, I think multi-line strips are very rare, especially if you are not allowed to have duplicated characters. If the formatting is an issue, we could implement a feature that only replaces if there is no newline character. Let me know what you think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-04 21:58</div>
            <div class="timeline-body"><p>Can you give an example of what it might change in the way you describe?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-04 21:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-04 22:32</div>
            <div class="timeline-body"><p>Simple Example: <code>&quot;Hello World&quot;.strip(&quot;Hello&quot;)</code> =&gt; <code>&quot;Hello World&quot;.strip(&quot;Helo&quot;)</code></p>
<p>Complex Example:</p>
<pre><code>&quot;Hello World&quot;.strip(&quot;&quot;&quot;
Hello
&quot;&quot;&quot;
)
</code></pre>
<p>=&gt;</p>
<pre><code>&quot;Hello World&quot;.strip(&quot;&quot;&quot;
Helo&quot;&quot;&quot;
)
</code></pre>
<p>The second newline character is removed, which is &quot;correct&quot; but means the formatting is weird.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-05 04:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-05 05:11</div>
            <div class="timeline-body"><p>Yeah those are interesting... I wonder if autofix is unintuitive here. I think I would be surprised by either of those cases, even if I found the lint error itself helpful. Wdyt?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-05 13:37</div>
            <div class="timeline-body"><blockquote>
<p>Yeah those are interesting... I wonder if autofix is unintuitive here. I think I would be surprised by either of those cases, even if I found the lint error itself helpful. Wdyt?</p>
</blockquote>
<p>Personally, I think it is useful. Each snippet of code still does the exact same thing, it has just been reformatted to follow best practices. I could see the formatting on the newlines being annoying; however, we could fix this by not autoformatting if the string contains the newline.</p>
<p>At the end of the day its your decision though, let me know what you want me to do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-05 13:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-05 15:52</div>
            <div class="timeline-body"><p>Also Charlie, I just want to let you know that I am doing pylint fixes in the order they are listed, and skipping ones that I think we cannot do practically right now. But if you see one I skipped that you think we can do let me know, and I will get on it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 20:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 20:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 20:35</div>
            <div class="timeline-body"><blockquote>
<p>Also Charlie, I just want to let you know that I am doing pylint fixes in the order they are listed, and skipping ones that I think we cannot do practically right now. But if you see one I skipped that you think we can do let me know, and I will get on it.</p>
</blockquote>
<p>Definitely you should feel free to implement the rules that you think are most impactful, since the list isn&#x27;t in any opinionated order :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-02-06 20:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-06 21:09</div>
            <div class="timeline-body"><blockquote>
<p>I wonder if autofix is unintuitive here.</p>
</blockquote>
<p>Just came here to say the same thing...</p>
<p>Generally it would seem that the following make sense:</p>
<ul>
<li>If someone used <code>s.lstrip(&quot;Hello&quot;)</code> they probably meant <code>s.removeprefix(&quot;Hello&quot;)</code></li>
<li>If someone used <code>s.rstrip(&quot;World&quot;)</code> they probably meant <code>s.removesuffix(&quot;World&quot;)</code></li>
<li>If someone used <code>s.strip(&quot;something&quot;)</code> they probably wanted <code>.removesuffix()</code> (or maybe <code>.removeprefix()</code>)</li>
<li><code>s.lstrip(&quot;https://&quot;)</code> is 99.99% likely meant to be <code>s.removeprefix(&quot;https://&quot;)</code></li>
</ul>
<p>Maybe the autofix can apply if it looks like there are duplicates in a set of arbitrary characters? And if it looked like a dictionary word, then not? <em>(Although this requires dictionaries, language support, and is likely to be slow, so...)</em></p>
<p>Another thought is that we can somehow provide hints for well-known cases, e.g. &quot;Did you mean <code>.removeprefix()</code>?&quot;
Maybe these things can be displayed, e.g. in <code>ruff rule PLE1310</code> output?</p>
<p>If we keep this autofixable, maybe it should be classed as &quot;unsafe&quot; and/or disabled by default?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 21:23</div>
            <div class="timeline-body"><p>Alright, let&#x27;s just remove the autofix for now. And I&#x27;ll add those suggestions to the error message.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 21:23</div>
            <div class="timeline-body"><p>(I was on the fence, but two votes is enough to err on the side of caution. Can revisit when we have autofix-off-by-default support.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[`pylint`]: bad-str-strip-call (With Autofix)&quot; to &quot;[`pylint`]: bad-str-strip-call&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 21:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-06 21:25</div>
            <div class="timeline-body"><p>With Nick&#x27;s response I totally agree now. Even thought the code is &quot;still correct&quot;, its probably not what the user wants</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-06 21:31</div>
            <div class="timeline-body"><blockquote>
<p>Even thought the code is &quot;still correct&quot;, its probably not what the user wants</p>
</blockquote>
<p>Agreed. It&#x27;s technically correct, but I worry that people will blindly use <code>--fix</code> and miss the true problem being flagged.</p>
<p>Naturally, even this doesn&#x27;t capture all cases, e.g. <code>.rstrip(&quot;word&quot;)</code> wouldn&#x27;t flag because it has no duplicate characters.</p>
<p>But something is better than nothing!</p>
<blockquote>
<p>And I&#x27;ll add those suggestions to the error message.</p>
</blockquote>
<p>Only refer to <code>.removeprefix()</code> and <code>.removesuffix()</code> for Python 3.9+ though...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-06 21:34</div>
            <div class="timeline-body"><p>Yup, the suggestion is gated on 3.9+.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:52:06 UTC
    </footer>
</body>
</html>
