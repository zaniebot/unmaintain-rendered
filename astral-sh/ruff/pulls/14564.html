<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] `d.update({k: v})` (`RUF042`) - astral-sh/ruff #14564</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] <code>d.update({k: v})</code> (<code>RUF042</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14564">#14564</a>
        opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a>
        on 2024-11-24 05:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2024-11-24 05:05</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Resolves #13533.</p>
<h2>Test Plan</h2>
<p><code>cargo nextest run</code> and <code>cargo insta test</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-24 06:19</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+71 -0 violations, +0 -0 fixes in 9 projects; 46 projects unchanged)</p>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+11 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/channels/twilio.py#L58'>rasa/core/channels/twilio.py:58:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/migrate.py#L131'>rasa/core/migrate.py:131:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/migrate.py#L143'>rasa/core/migrate.py:143:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/migrate.py#L177'>rasa/core/migrate.py:177:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/migrate.py#L179'>rasa/core/migrate.py:179:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/migrate.py#L181'>rasa/core/migrate.py:181:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/migrate.py#L185'>rasa/core/migrate.py:185:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/shared/core/domain.py#L393'>rasa/shared/core/domain.py:393:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/shared/core/domain.py#L421'>rasa/shared/core/domain.py:421:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/shared/core/domain.py#L426'>rasa/shared/core/domain.py:426:13:</a> RUF042 [*] `dict.update` with single dictionary argument
... 1 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+34 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/models/abstractoperator.py#L369'>airflow/models/abstractoperator.py:369:17:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/serialization/serialized_objects.py#L1279'>airflow/serialization/serialized_objects.py:1279:25:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/serialization/serialized_objects.py#L1549'>airflow/serialization/serialized_objects.py:1549:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/airflow/utils/file.py#L214'>airflow/utils/file.py:214:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/dev/stats/get_important_pr_candidates.py#L371'>dev/stats/get_important_pr_candidates.py:371:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/helm_tests/other/test_keda.py#L140'>helm_tests/other/test_keda.py:140:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/amazon/aws/hooks/sagemaker.py#L1285'>providers/src/airflow/providers/amazon/aws/hooks/sagemaker.py:1285:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/amazon/aws/hooks/sagemaker.py#L1289'>providers/src/airflow/providers/amazon/aws/hooks/sagemaker.py:1289:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L328'>providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:328:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L329'>providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:329:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L330'>providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:330:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py#L333'>providers/src/airflow/providers/google/cloud/transfers/cassandra_to_gcs.py:333:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/marketing_platform/hooks/search_ads.py#L125'>providers/src/airflow/providers/google/marketing_platform/hooks/search_ads.py:125:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/marketing_platform/hooks/search_ads.py#L127'>providers/src/airflow/providers/google/marketing_platform/hooks/search_ads.py:127:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/google/marketing_platform/hooks/search_ads.py#L195'>providers/src/airflow/providers/google/marketing_platform/hooks/search_ads.py:195:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/openlineage/plugins/adapter.py#L457'>providers/src/airflow/providers/openlineage/plugins/adapter.py:457:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/openlineage/plugins/adapter.py#L465'>providers/src/airflow/providers/openlineage/plugins/adapter.py:465:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/openlineage/plugins/adapter.py#L484'>providers/src/airflow/providers/openlineage/plugins/adapter.py:484:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/openlineage/plugins/adapter.py#L488'>providers/src/airflow/providers/openlineage/plugins/adapter.py:488:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/src/airflow/providers/openlineage/plugins/adapter.py#L496'>providers/src/airflow/providers/openlineage/plugins/adapter.py:496:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/tests/amazon/aws/hooks/test_sagemaker.py#L183'>providers/tests/amazon/aws/hooks/test_sagemaker.py:183:1:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/tests/amazon/aws/hooks/test_sagemaker.py#L189'>providers/tests/amazon/aws/hooks/test_sagemaker.py:189:1:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/airflow/blob/b1a44b4e3db8a3d3c13dfc810ad02f5785f82eca/providers/tests/amazon/aws/sensors/test_sagemaker_training.py#L41'>providers/tests/amazon/aws/sensors/test_sagemaker_training.py:41:1:</a> RUF042 [*] `dict.update` with single dictionary argument
... 11 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/superset">apache/superset</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/superset/blob/0166db96632a5de1e8fcf807b2a0d64943cfb6a2/superset/sql_lab.py#L512'>superset/sql_lab.py:512:17:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/superset/blob/0166db96632a5de1e8fcf807b2a0d64943cfb6a2/superset/sql_lab.py#L538'>superset/sql_lab.py:538:17:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/superset/blob/0166db96632a5de1e8fcf807b2a0d64943cfb6a2/superset/views/core.py#L692'>superset/views/core.py:692:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/apache/superset/blob/0166db96632a5de1e8fcf807b2a0d64943cfb6a2/superset/views/utils.py#L227'>superset/views/utils.py:227:25:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/milvus-io/pymilvus">milvus-io/pymilvus</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/milvus-io/pymilvus/blob/34495134958e89ef7c854d2e31967bb580ab5823/examples/orm/collection.py#L163'>examples/orm/collection.py:163:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/milvus-io/pymilvus/blob/34495134958e89ef7c854d2e31967bb580ab5823/examples/orm/partition.py#L98'>examples/orm/partition.py:98:9:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/rotki/rotki">rotki/rotki</a> (+3 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/rotki/rotki/blob/c2d46b49aa8dff2624125941f600c1e7a7dd85e3/rotkehlchen/exchanges/bitstamp.py#L259'>rotkehlchen/exchanges/bitstamp.py:259:21:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/rotki/rotki/blob/c2d46b49aa8dff2624125941f600c1e7a7dd85e3/rotkehlchen/exchanges/bitstamp.py#L414'>rotkehlchen/exchanges/bitstamp.py:414:17:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/rotki/rotki/blob/c2d46b49aa8dff2624125941f600c1e7a7dd85e3/rotkehlchen/exchanges/poloniex.py#L189'>rotkehlchen/exchanges/poloniex.py:189:13:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+10 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/corporate/views/remote_billing_page.py#L529'>corporate/views/remote_billing_page.py:529:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/corporate/views/remote_billing_page.py#L538'>corporate/views/remote_billing_page.py:538:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/corporate/views/remote_billing_page.py#L548'>corporate/views/remote_billing_page.py:548:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/corporate/views/remote_billing_page.py#L552'>corporate/views/remote_billing_page.py:552:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/tests/test_markdown.py#L1829'>zerver/tests/test_markdown.py:1829:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/tests/test_markdown.py#L1867'>zerver/tests/test_markdown.py:1867:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/tests/test_markdown.py#L1909'>zerver/tests/test_markdown.py:1909:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/tests/test_markdown.py#L1945'>zerver/tests/test_markdown.py:1945:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/tests/test_markdown.py#L1981'>zerver/tests/test_markdown.py:1981:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/zulip/zulip/blob/aa0dd442345234b1559d61ca264c15c020adaf67/zerver/tests/test_markdown.py#L2011'>zerver/tests/test_markdown.py:2011:13:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/indico/indico">indico/indico</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/indico/indico/blob/c5ee75d0f54cef0e7fa8e402989eef86f553ace3/indico/web/forms/widgets.py#L144'>indico/web/forms/widgets.py:144:9:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pdm-project/pdm">pdm-project/pdm</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pdm-project/pdm/blob/263143935b8ed378d9fd72a717b1b16d54a7fef3/src/pdm/formats/uv.py#L219'>src/pdm/formats/uv.py:219:9:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/pdm-project/pdm/blob/263143935b8ed378d9fd72a717b1b16d54a7fef3/src/pdm/project/config.py#L42'>src/pdm/project/config.py:42:17:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/astropy/astropy">astropy/astropy</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/astropy/astropy/blob/4e3ad4b94f5183a8c78cc0c6ee636c6a224dc14b/astropy/io/registry/core.py#L218'>astropy/io/registry/core.py:218:21:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/astropy/astropy/blob/4e3ad4b94f5183a8c78cc0c6ee636c6a224dc14b/astropy/samp/integrated_client.py#L400'>astropy/samp/integrated_client.py:400:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/astropy/astropy/blob/4e3ad4b94f5183a8c78cc0c6ee636c6a224dc14b/astropy/samp/integrated_client.py#L402'>astropy/samp/integrated_client.py:402:13:</a> RUF042 [*] `dict.update` with single dictionary argument
+ <a href='https://github.com/astropy/astropy/blob/4e3ad4b94f5183a8c78cc0c6ee636c6a224dc14b/astropy/visualization/wcsaxes/core.py#L320'>astropy/visualization/wcsaxes/core.py:320:13:</a> RUF042 [*] `dict.update` with single dictionary argument
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF042 | 71 | 71 | 0 | 0 | 0 |</p>
</p>
</details>

<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:22 on 2024-11-25 08:34</div>
            <div class="timeline-body"><p>I suggest removing the mention of performance as discussed in the issue. There's some evidance that directly assigning is faster, but it isn't the rule's primary motivation and it only matters if this code is in a hot loop.</p>
<pre><code class="language-suggestion">/// Calling `dict.update()` with a single-item dictionary
/// is equivalent to setting the item directly, which is simpler and more concise. 
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:43 on 2024-11-25 08:36</div>
            <div class="timeline-body"><p>It's unclear to me what <em>Literal dictionary</em> means in this context.</p>
<pre><code class="language-suggestion">        &quot;`dict.update` with single dictionary argument&quot;.to_string()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:65 on 2024-11-25 08:36</div>
            <div class="timeline-body"><pre><code class="language-suggestion">    let key_expr = locator.slice(key);
    let value_expr = locator.slice(value);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:63 on 2024-11-25 08:36</div>
            <div class="timeline-body"><pre><code class="language-suggestion">    let dict_ref_expr = locator.slice(dict_ref);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:69 on 2024-11-25 08:36</div>
            <div class="timeline-body"><p>The fix should be marked as unsafe if the replacement range contains any comments.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:88 on 2024-11-25 08:38</div>
            <div class="timeline-body"><p>Nit</p>
<pre><code class="language-suggestion">    let Expr::Attribute(ExprAttribute { value, attr, .. }) = &amp;func else {
        return None;
    };
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-25 08:40</div>
            <div class="timeline-body"><p>Thank you.</p>
<p>I think we have to align on the rule's scope first. @AlexWaygood <a href="https://github.com/astral-sh/ruff/issues/13533#issuecomment-2396495345">mentioned</a> that the rule could possibly be extended to cover more cases than just <code>update</code>. In that case, the rule should be named differently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-11-25 08:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2024-11-25 10:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dict_update_single.rs</code>:88 on 2024-11-25 10:08</div>
            <div class="timeline-body"><p>I don't think this compiles. <code>func</code> is of type <code>&amp;Box&lt;Expr&gt;</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @AlexWaygood by @MichaReiser on 2024-11-27 09:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> requested changes on 2024-11-27 13:39</div>
            <div class="timeline-body"><p>Yeah, as I mentioned in https://github.com/astral-sh/ruff/issues/13533#issuecomment-2396495345, I would reframe this rule. Rather than calling it <code>DictUpdateSingleItemDict</code>, I would call it <code>UnnecessaryIntermediateRepresentation</code>. Rather than saying in the docs that it &quot;Checks for <code>dictionary.update({single: item})</code>&quot;, I would say that it &quot;Checks for situations where collections are unnecessarily created and then immediately discarded&quot;. The advantage of this framing is that we can then expand the rule in future PRs so that it also flags statements such as the following, which are all really examples of the same antipattern, just in different ways. None of them are currently flagged by Ruff:</p>
<pre><code class="language-py">lst = []
lst += [&quot;value&quot;]
lst += [&quot;value 1&quot;, &quot;value 2&quot;]

s = set()
s |= {&quot;value&quot;}
s |= {&quot;value 1&quot;, &quot;value 2&quot;}

d = {}
d |= {&quot;key&quot;: &quot;value&quot;}
</code></pre>
<p>These can all be written more efficiently as follows:</p>
<pre><code class="language-py">lst = []
lst.append(&quot;value&quot;)
lst.extend((&quot;value 1&quot;, &quot;value 2&quot;))

s = set()
s.add(&quot;value&quot;)
s.update((&quot;value 1&quot;, &quot;value 2&quot;))

d = {}
d[&quot;key&quot;] = &quot;value&quot;
</code></pre>
<p>(For the <code>lst.extend()</code> and <code>s.update()</code> ones in that snippet: note that Python can evaluate constant tuples at compile time, which it cannot do for lists and sets.)</p>
<p>I think you should also add a <code>## Known issues</code> section to this rule's docs that says similar things to the <code>## Known issues</code> section of our <code>repeated-append</code> rule: https://docs.astral.sh/ruff/rules/repeated-append/#known-problems.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 07:38</div>
            <div class="timeline-body"><p>@InSyncWithFoo are you planning to address @AlexWaygood's feedback? I'd otherwise close this PR and mention it as a good starting point for anyone else interested in finishing it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2024-12-03 12:44</div>
            <div class="timeline-body"><p>@MichaReiser As a matter of fact, I do. I already have a half-working branch locally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @InSyncWithFoo on 2024-12-08 00:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-12-08 00:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 20:42:55 UTC
    </footer>
</body>
</html>
