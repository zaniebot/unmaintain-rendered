<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`flake8-tidy-imports`] Implement `relative-sibling-imports` (`TID254`) - astral-sh/ruff #16772</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>flake8-tidy-imports</code>] Implement <code>relative-sibling-imports</code> (<code>TID254</code>)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16772">#16772</a>
        opened by <a href="https://github.com/noirbizarre">@noirbizarre</a>
        on 2025-03-15 23:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/noirbizarre">@noirbizarre</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<!-- What's the purpose of the change? What does it do, and why? -->

<p>This PR follows the discussion from #1014 and add a new opt-in rule <code>TID254</code> which is requiring relative import for sibling (and nested) modules.
It requires the <code>linter.flake8-tidy-imports.relative-sibling-imports</code> setting to be <code>true</code> to avoid users having enabled all <code>TID</code> to have their imports rewritten if they did not choose to as it is one of <a href="https://peps.python.org/pep-0008/#imports">2 suggested PEP8 alternatives</a>:</p>
<blockquote>
<p>However, explicit relative imports are an acceptable alternative to absolute imports, especially when dealing with complex package layouts where using absolute imports would be unnecessarily verbose:</p>
<pre><code class="language-python">from . import sibling
from .sibling import example
</code></pre>
</blockquote>
<p>Fixes #1014</p>
<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>Multiple test cases have been added to the test suite, with associated expected snapshots, and it has been tested on some external codebases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-16 09:05</div>
            <div class="timeline-body"><p>Thanks for working on this. It might take me a while before I get to thinking through the implications of this change. The concerns are:</p>
<ul>
<li>It creates a new rule that doesn't exist upstream. We've made exceptions for some categories in the past but it comes with its own set of problems, which is why we're more hesitant to keep doing that (e.g. what if upstream adds a TID254...)</li>
<li>Rules that require explicit opt-in with an option tend to be confusing for users. I see the motivation here, but it still applies. What's the rationale for not integrating this into TID252?</li>
<li>I'd have to double check if this rule doesn't conflict with any other rule (that's not really a concern, only a thing that needs doing)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-03-16 09:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2025-03-16 09:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/noirbizarre">@noirbizarre</a> on 2025-03-16 13:15</div>
            <div class="timeline-body"><p>Hi üëãüèº</p>
<p>Thanks for the prompt response.</p>
<p>I'll answer the bullet points in the same order:</p>
<blockquote>
<p>It creates a new rule that doesn't exist upstream. We've made exceptions for some categories in the past but it comes with its own set of problems, which is why we're more hesitant to keep doing that (e.g. what if upstream adds a TID254...)</p>
</blockquote>
<p>I took the liberty of submitting this pull request as the TID namespace already diverged from the upstream (<code>TID253</code> doesn't exist in <code>flake8-tidy-import</code>), so this PR doesn't introduce this problem, it takes benefit from the fact the problem already exists (I know, weird thinking).
I actually submitted an upstream PR 2 years ago (https://github.com/adamchainz/flake8-tidy-imports/pull/441), I didn't have feedback since, and I stop hoping for (I didn't insist either as the maintainer doesn't seem happy about it, and I didn't want to pressure him)</p>
<blockquote>
<p>Rules that require explicit opt-in with an option tend to be confusing for users. I see the motivation here, but it still applies. What's the rationale for not integrating this into TID252?</p>
</blockquote>
<p>Actually, I can, the initial PR (https://github.com/astral-sh/ruff/pull/3986) was doing that.
It was more about the semantic: the rule is advertising &quot;Prefer absolute imports over relative imports from parent modules&quot; and this PR is doing the opposite for siblings. It would mean that the same rule could say &quot;Prefer absolute imports over relative imports from parents modules&quot; and &quot;Prefer relative imports over absolute imports for siblings modules&quot;.
But if this is acceptable, I'll rework this PR to make this a TID252 setting and change the documentation sentence for something more generic.</p>
<blockquote>
<p>I'd have to double check if this rule doesn't conflict with any other rule (that's not really a concern, only a thing that needs doing)</p>
</blockquote>
<p>If TID252 <code>ban-relative-imports</code> is set to <code>all</code>, it is by design contradictory with this rule. That's why I documented that it should be set to <code>parents</code> in the docstring.</p>
<p>What would be acceptable to you if I just integrate it with TID252?</p>
<ol>
<li>Simply use a 3rd <code>ban-relative-import</code> value like <code>parents-with-relative-siblings</code> with would ensure no conflict at the cost of being a bit contradictory with the <code>ban</code> term</li>
<li>Keep the separate setting with a warning about the conflict?</li>
<li>Another better approach</li>
</ol>
<p>I'll do any necessary change to have this feature merged because I still have the need for this and from #1014, I don't seem to be the only one.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:10:46 UTC
    </footer>
</body>
</html>
