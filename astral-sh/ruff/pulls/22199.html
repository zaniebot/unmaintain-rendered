<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ci(zizmor): remove broad zizmor ignores - astral-sh/ruff #22199</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ci(zizmor): remove broad zizmor ignores</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22199">#22199</a>
        opened by <a href="https://github.com/samypr100">@samypr100</a>
        on 2025-12-25 23:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/samypr100">@samypr100</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Follow up to https://github.com/astral-sh/ty/pull/2217</p>
<p>Encountered that ty doesn't have a zizmor.yml with broad ignores. Dropped the file in favor of inline ignores.</p>
<ol>
<li>build-docker.yml could be fixed by re-defining the permissions with an explicit <code>zizmor: ignore[excessive-permissions]</code>. This aligns with what ty does.</li>
<li>publish-docs.yml seems to only need <code>content: read</code> which fixes the errors.</li>
</ol>
<p>Separately, I didn't get errors about cache-poisoning, secrets-inherit, or template-injection so the file has been removed.</p>
<h2>Test Plan</h2>
<p>Published a release from my fork with the changes.</p>
<ul>
<li><a href="https://github.com/samypr100/ruff/actions/runs/20540204455">Release</a></li>
<li><a href="https://github.com/samypr100/ruff/pkgs/container/ruff/versions?filters%5Bversion_type%5D=tagged">Packages</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ci</span> added by @AlexWaygood on 2025-12-25 23:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @samypr100 on 2025-12-27 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/woodruffw">@woodruffw</a> reviewed on 2025-12-28 21:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/woodruffw">@woodruffw</a> on <code>.github/workflows/publish-docs.yml</code>:21 on 2025-12-28 21:44</div>
            <div class="timeline-body"><p>Nit: this could be <code>permissions: {}</code> and then <code>contents: read</code> on the specific job that actually needs it, but that's pretty minor.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/woodruffw">@woodruffw</a> approved on 2025-12-28 21:45</div>
            <div class="timeline-body"><p>LGTM! Another option here would be to remove the inline ignores entirely, and allow these findings to percolate into the advanced security dashboard to be triaged later. I think that'd be fine, although we might need to tweak the CI rulesets to allow the zizmor workflow to produce findings without failing the entire CI.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/samypr100">@samypr100</a> reviewed on 2025-12-28 22:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/samypr100">@samypr100</a> on <code>.github/workflows/publish-docs.yml</code>:21 on 2025-12-28 22:36</div>
            <div class="timeline-body"><p>I deliberately kept it as <a href="https://github.com/astral-sh/ty/blob/95761966c231e40fc615368ebdbef09ebe8158d0/.github/workflows/publish-docs.yml#L20-L21">ty</a> to minimize divergence. From what I see in the workflow though, I agree that <code>{}</code> should suffice. I think <code>contents: read</code> is not even needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-29 09:52</div>
            <div class="timeline-body"><p>Thank you! I'll merge this as is and suggest that we remove the inline ignores for both ty and ruff in separate PRs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-12-29 09:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-12-29 09:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-29 13:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:18:24 UTC
    </footer>
</body>
</html>
