<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`] Fix `unreachable` infinite loop (`PLW0101`) - astral-sh/ruff #15278</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pylint</code>] Fix <code>unreachable</code> infinite loop (<code>PLW0101</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15278">#15278</a>
        opened by <a href="https://github.com/augustelalande">@augustelalande</a>
        on 2025-01-05 21:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>Fix infinite loop issue reported here #15248. Also re-make rule preview. The issue was caused by the break inside the if block, which caused the flow to exit in an unforeseen way. This caused other issues, eventually leading to an infinite loop.</p>
<p>As stated in #15252 we should do more fuzzing, however I'm not sure which scripts to run so please let me know.</p>
<p>Resolves #15248. Resolves #15336.</p>
<h2>Test Plan</h2>
<p>Added failing code to fixture.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-01-05 21:43</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-06 02:39</div>
            <div class="timeline-body"><p>Would it be possible to add a test case that disambiguates this fix from the one in #15276? I believe both of these PRs produce the same CFG for the case in question.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2025-01-06 07:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2025-01-06 07:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dylwil3 by @MichaReiser on 2025-01-06 07:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a> requested changes on 2025-01-07 18:14</div>
            <div class="timeline-body"><p>This is great, thank you!</p>
<p>Let's keep the rule as test for a little longer, and it'd be nice to have add a snapshot that exhibits the new behavior for loops <em>without</em> the presence of a try/finally block (if that's possible?)</p>
<p>Also you may need to rebase against main since I've merged in the PR that fixes the loop if there's a return in a <code>finally</code> block.</p>
<p>I think with those changes I'd be happy to merge!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-01-08 07:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 08:11</div>
            <div class="timeline-body"><p>I merged in main and reverted the changes that weren't necessary for the fix itself. The only thing that needs doing now is to add a test (if possible)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a> approved on 2025-01-08 15:02</div>
            <div class="timeline-body"><p>Added the latest example from the fuzzer, which passes. So let's merge this in and continue to test this rule and improve the CFG implementation.</p>
<p>Thanks so much for this fix - definitely making progress on this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dylwil3 on 2025-01-08 15:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dylwil3 on 2025-01-08 15:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @MichaReiser on 2025-01-08 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> removed by @MichaReiser on 2025-01-08 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @MichaReiser on 2025-01-08 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-09 04:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:08:53 UTC
    </footer>
</body>
</html>
