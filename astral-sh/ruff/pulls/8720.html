<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pycodestyle`] Add blank line(s) rules (`E301`, `E302`, `E303`, `E304`, `E305`, `E306`) - astral-sh/ruff #8720</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pycodestyle</code>] Add blank line(s) rules (<code>E301</code>, <code>E302</code>, <code>E303</code>, <code>E304</code>, <code>E305</code>, <code>E306</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/8720">#8720</a>
        opened by <a href="https://github.com/hoel-bagard">@hoel-bagard</a>
        on 2023-11-16 13:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-11-16 13:54</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR is part of https://github.com/charliermarsh/ruff/issues/2402, it adds the <code>E301</code>, <code>E302</code>, <code>E303</code>, <code>E304</code>, <code>E305</code>, <code>E306</code> error rules along with their fixes.</p>
<p>A first attempt at implementing <code>E305</code> using physical lines was done <a href="https://github.com/charliermarsh/ruff/pull/4635">here</a>, and a second attempt using logical lines <a href="https://github.com/astral-sh/ruff/pull/4694">here</a>. This version uses the fact that comment only lines are now counted as logical lines.</p>
<h2>Test Plan</h2>
<p>The test fixture uses <a href="https://github.com/PyCQA/pycodestyle/blob/main/testsuite/E30.py">the one from pycodestyle</a> with a few added tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-11-16 15:01</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+3911 -26 violations, +0 -0 fixes in 15 projects; 26 projects unchanged)</p>
<details><summary><a href="https://github.com/DisnakeDev/disnake">DisnakeDev/disnake</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/DisnakeDev/disnake/blob/f780cf5d7320210f022eba0d0e4e8b2820db2baa/disnake/utils.py#L1051'>disnake/utils.py:1051:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/DisnakeDev/disnake/blob/f780cf5d7320210f022eba0d0e4e8b2820db2baa/examples/basic_voice.py#L96'>examples/basic_voice.py:96:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
</pre>

</p>
</details>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+13 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/data/test_classes/nlu_component_skeleton.py#L11'>data/test_classes/nlu_component_skeleton.py:11:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/core/agent.py#L117'>rasa/core/agent.py:117:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/core/channels/console.py#L144'>rasa/core/channels/console.py:144:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/core/channels/console.py#L218'>rasa/core/channels/console.py:218:13:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/core/channels/rasa_chat.py#L46'>rasa/core/channels/rasa_chat.py:46:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/rasa/server.py#L579'>rasa/server.py:579:13:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/scripts/evaluate_release_tag.py#L41'>scripts/evaluate_release_tag.py:41:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/stubs/aio_pika/robust_channel.pyi#L10'>stubs/aio_pika/robust_channel.pyi:10:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/stubs/sanic.pyi#L23'>stubs/sanic.pyi:23:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/RasaHQ/rasa/blob/cca30d4e06af5aba177e916d64c60313fc537005/stubs/sanic.pyi#L25'>stubs/sanic.pyi:25:5:</a> E301 [*] Expected 1 blank line, found 0
... 3 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+32 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/compat/functools.pyi#L27'>airflow/compat/functools.pyi:27:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/decorators/__init__.pyi#L158'>airflow/decorators/__init__.pyi:158:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/decorators/__init__.pyi#L314'>airflow/decorators/__init__.pyi:314:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/decorators/__init__.pyi#L61'>airflow/decorators/__init__.pyi:61:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/decorators/__init__.pyi#L642'>airflow/decorators/__init__.pyi:642:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/jobs/triggerer_job_runner.py#L601'>airflow/jobs/triggerer_job_runner.py:601:13:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/providers/amazon/aws/hooks/s3.py#L455'>airflow/providers/amazon/aws/hooks/s3.py:455:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/providers/amazon/aws/hooks/s3.py#L476'>airflow/providers/amazon/aws/hooks/s3.py:476:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/providers/amazon/aws/hooks/s3.py#L582'>airflow/providers/amazon/aws/hooks/s3.py:582:13:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/apache/airflow/blob/a68b4194fe7201bba0544856b60c7d6724da60b3/airflow/providers/amazon/aws/hooks/s3.py#L619'>airflow/providers/amazon/aws/hooks/s3.py:619:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
... 22 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/aws/aws-sam-cli">aws/aws-sam-cli</a> (+114 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/buildcmd/Provided/main.py#L3'>tests/integration/testdata/buildcmd/Provided/main.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/buildcmd/custom_root_dir/main.py#L3'>tests/integration/testdata/buildcmd/custom_root_dir/main.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/buildcmd/custom_root_dir_and_custom_makefile/custom_src_code/main.py#L3'>tests/integration/testdata/buildcmd/custom_root_dir_and_custom_makefile/custom_src_code/main.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/buildcmd/custom_root_dir_custom_makefile_and_custom_working_dir/working_dir/main.py#L3'>tests/integration/testdata/buildcmd/custom_root_dir_custom_makefile_and_custom_working_dir/working_dir/main.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/buildcmd/custom_working_dir_src_code/working_dir/main.py#L3'>tests/integration/testdata/buildcmd/custom_working_dir_src_code/working_dir/main.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/buildcmd/provided_src_code_without_makefile/main.py#L3'>tests/integration/testdata/buildcmd/provided_src_code_without_makefile/main.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
... 108 additional changes omitted for rule E302
+ <a href='https://github.com/aws/aws-sam-cli/blob/4890f4f56fb70ec4e2e66fcc8e1f3fb5154a8ec7/tests/integration/testdata/start_api/lambda_authorizers/app.py#L159'>tests/integration/testdata/start_api/lambda_authorizers/app.py:159:5:</a> E303 [*] Too many blank lines (2)
... 107 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+3208 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/docs/bokeh/source/conf.py#L230'>docs/bokeh/source/conf.py:230:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/gears/gears.py#L102'>examples/advanced/extensions/gears/gears.py:102:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/gears/gears.py#L13'>examples/advanced/extensions/gears/gears.py:13:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/gears/gears.py#L16'>examples/advanced/extensions/gears/gears.py:16:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/gears/gears.py#L21'>examples/advanced/extensions/gears/gears.py:21:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/gears/gears.py#L34'>examples/advanced/extensions/gears/gears.py:34:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/gears/gears.py#L62'>examples/advanced/extensions/gears/gears.py:62:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/parallel_plot/parallel_plot.py#L109'>examples/advanced/extensions/parallel_plot/parallel_plot.py:109:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/putting_together.py#L85'>examples/advanced/extensions/putting_together.py:85:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/putting_together.py#L93'>examples/advanced/extensions/putting_together.py:93:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/tool.py#L74'>examples/advanced/extensions/tool.py:74:1:</a> E302 [*] Expected 2 blank lines, found 1
... 2390 additional changes omitted for rule E302
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/tool.py#L78'>examples/advanced/extensions/tool.py:78:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/advanced/extensions/widget.py#L52'>examples/advanced/extensions/widget.py:52:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/basic/annotations/colorbar_log.py#L19'>examples/basic/annotations/colorbar_log.py:19:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
... 313 additional changes omitted for rule E305
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/output/apis/autoload_static.py#L34'>examples/output/apis/autoload_static.py:34:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/examples/output/apis/autoload_static.py#L43'>examples/output/apis/autoload_static.py:43:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/release/deploy.py#L55'>release/deploy.py:55:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/client/states.py#L110'>src/bokeh/client/states.py:110:5:</a> E303 [*] Too many blank lines (2)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/document/events.py#L234'>src/bokeh/document/events.py:234:5:</a> E303 [*] Too many blank lines (2)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/document/events.py#L518'>src/bokeh/document/events.py:518:9:</a> E303 [*] Too many blank lines (2)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/driving.py#L114'>src/bokeh/driving.py:114:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/driving.py#L170'>src/bokeh/driving.py:170:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/driving.py#L189'>src/bokeh/driving.py:189:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/driving.py#L91'>src/bokeh/driving.py:91:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/embed/__init__.py#L54'>src/bokeh/embed/__init__.py:54:1:</a> E303 [*] Too many blank lines (3)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/layouts.py#L323'>src/bokeh/layouts.py:323:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/layouts.py#L427'>src/bokeh/layouts.py:427:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
... 185 additional changes omitted for rule E306
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/model/model.py#L552'>src/bokeh/model/model.py:552:13:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/model/model.py#L72'>src/bokeh/model/model.py:72:5:</a> E303 [*] Too many blank lines (2)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/models/plots.py#L907'>src/bokeh/models/plots.py:907:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/models/ui/dialogs.py#L58'>src/bokeh/models/ui/dialogs.py:58:5:</a> E303 [*] Too many blank lines (2)
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/models/widgets/tables.py#L154'>src/bokeh/models/widgets/tables.py:154:1:</a> E303 [*] Too many blank lines (3)
... 36 additional changes omitted for rule E303
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/server/server.py#L283'>src/bokeh/server/server.py:283:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/bokeh/server/session.py#L231'>src/bokeh/server/session.py:231:9:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/src/typings/selenium/webdriver/common/action_chains.pyi#L10'>src/typings/selenium/webdriver/common/action_chains.pyi:10:5:</a> E301 [*] Expected 1 blank line, found 0
... 253 additional changes omitted for rule E301
+ <a href='https://github.com/bokeh/bokeh/blob/929ee8ab38207eca08d1601a0164952fb21c9c6a/tests/unit/bokeh/server/test_server__server.py#L469'>tests/unit/bokeh/server/test_server__server.py:469:1:</a> E304 [*] blank lines found after function decorator
... 3172 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/commaai/openpilot">commaai/openpilot</a> (+394 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/api/__init__.py#L10'>common/api/__init__.py:10:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/conversions.py#L3'>common/conversions.py:3:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/ffi_wrapper.py#L14'>common/ffi_wrapper.py:14:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/ffi_wrapper.py#L8'>common/ffi_wrapper.py:8:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/file_helpers.py#L74'>common/file_helpers.py:74:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/gpio.py#L12'>common/gpio.py:12:1:</a> E302 [*] Expected 2 blank lines, found 1
... 305 additional changes omitted for rule E302
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/kalman/tests/test_simple_kalman.py#L86'>common/kalman/tests/test_simple_kalman.py:86:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/logging_extra.py#L216'>common/logging_extra.py:216:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (1)
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/transformations/camera.py#L73'>common/transformations/camera.py:73:1:</a> E303 [*] Too many blank lines (3)
+ <a href='https://github.com/commaai/openpilot/blob/ea7e701052f8da1fb562746c62bdb5a64410ea76/common/transformations/model.py#L14'>common/transformations/model.py:14:1:</a> E305 [*] expected 2 blank lines after class or function definition, found (0)
... 384 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/freedomofpress/securedrop">freedomofpress/securedrop</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/freedomofpress/securedrop/blob/531d08696a145b26dd918abbbc68b19d4ce505c0/molecule/testinfra/app/test_tor_hidden_services.py#L11'>molecule/testinfra/app/test_tor_hidden_services.py:11:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/freedomofpress/securedrop/blob/531d08696a145b26dd918abbbc68b19d4ce505c0/redwood/redwood/__init__.pyi#L6'>redwood/redwood/__init__.pyi:6:1:</a> E302 [*] Expected 2 blank lines, found 1
</pre>

</p>
</details>
<details><summary><a href="https://github.com/fronzbot/blinkpy">fronzbot/blinkpy</a> (+6 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/fronzbot/blinkpy/blob/a8841612641f17527c5b3f43bbf034b6fe7ba743/blinkpy/blinkpy.py#L422'>blinkpy/blinkpy.py:422:17:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/fronzbot/blinkpy/blob/a8841612641f17527c5b3f43bbf034b6fe7ba743/blinkpy/camera.py#L415'>blinkpy/camera.py:415:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/fronzbot/blinkpy/blob/a8841612641f17527c5b3f43bbf034b6fe7ba743/blinksync/forms.py#L56'>blinksync/forms.py:56:5:</a> E301 [*] Expected 1 blank line, found 0
+ <a href='https://github.com/fronzbot/blinkpy/blob/a8841612641f17527c5b3f43bbf034b6fe7ba743/blinksync/forms.py#L71'>blinksync/forms.py:71:5:</a> E303 [*] Too many blank lines (2)
+ <a href='https://github.com/fronzbot/blinkpy/blob/a8841612641f17527c5b3f43bbf034b6fe7ba743/blinksync/forms.py#L77'>blinksync/forms.py:77:1:</a> E302 [*] Expected 2 blank lines, found 1
+ <a href='https://github.com/fronzbot/blinkpy/blob/a8841612641f17527c5b3f43bbf034b6fe7ba743/blinksync/forms.py#L9'>blinksync/forms.py:9:1:</a> E302 [*] Expected 2 blank lines, found 1
</pre>

</p>
</details>
<details><summary><a href="https://github.com/lnbits/lnbits">lnbits/lnbits</a> (+27 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/commands.py#L498'>lnbits/commands.py:498:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/commands.py#L512'>lnbits/commands.py:512:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/commands.py#L547'>lnbits/commands.py:547:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L294'>lnbits/core/services.py:294:9:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L325'>lnbits/core/services.py:325:13:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L347'>lnbits/core/services.py:347:13:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L389'>lnbits/core/services.py:389:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L424'>lnbits/core/services.py:424:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L488'>lnbits/core/services.py:488:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
+ <a href='https://github.com/lnbits/lnbits/blob/e76ba62b46899832f36bdf1ffd85daae3c9b1898/lnbits/core/services.py#L574'>lnbits/core/services.py:574:5:</a> E306 [*] Expected 1 blank line before a nested definition, found 0
... 17 additional changes omitted for project
</pre>

</p>
</details>

<p><em>... Truncated remaining completed projected reports due to GitHub comment length restrictions</em></p>
<details><summary>Changes by rule (7 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| E302 | 2887 | 2887 | 0 | 0 | 0 |
| E305 | 388 | 388 | 0 | 0 | 0 |
| E301 | 270 | 270 | 0 | 0 | 0 |
| E306 | 265 | 265 | 0 | 0 | 0 |
| E303 | 74 | 74 | 0 | 0 | 0 |
| PLR0917 | 52 | 26 | 26 | 0 | 0 |
| E304 | 1 | 1 | 0 | 0 | 0 |</p>
</p>
</details>

<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @hoel-bagard on 2023-11-16 15:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-11-17 14:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-11-19 12:16</div>
            <div class="timeline-body"><p>@charliermarsh I've looked at (most) of the ecosystem changes, and they look like desired violations.</p>
<p>However I noticed one big difference between what I did and the pycodestyle version.
I (at least at first) coded by looking at the pycodestyle rule definitions / PEP8 recommendations rather than the pycodestyle code. Because of this I actually check whether a line is within a function/class rather than just looking at the indentation (see for example how <a href="https://www.flake8rules.com/rules/E303.html">E303</a> or <a href="https://peps.python.org/pep-0008/#blank-lines">PEP8</a> formulate the rule).</p>
<p>This results in the snippet below being a violation for pycodestyle but not for what I did :</p>
<pre><code class="language-python">if True:
    a = 1


    a = 2
</code></pre>
<p>There is no such test example within the pycodestyle tests, so it's not clear whether this is a desired behavior or not.</p>
<p>Matching the pycodestyle results (and modifying the rule definition) would be easy (and simplify the implementation), and I suppose it is the desired behavior to match the previous implementation, but I would like confirmation before doing it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @hoel-bagard on 2023-11-19 16:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/allisonkarlitskaya">@allisonkarlitskaya</a> on 2023-11-20 14:49</div>
            <div class="timeline-body"><blockquote>
<p>There is no such test example within the pycodestyle tests, so it's not clear whether this is a desired behavior or not.</p>
</blockquote>
<p>This is a pretty close match: https://github.com/PyCQA/pycodestyle/blob/main/testing/data/E30.py#L65</p>
<p>It's not an <code>if:</code> at toplevel but rather a function, but it clearly indicates the E303 is intended to be used for more than just spacing between top-level items.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-11-20 15:33</div>
            <div class="timeline-body"><p>Thank you for your answer.
It's a close match, yes, and what I implemented matches the pycodestyle results on that example.</p>
<p>My issue isn't whether E303 should apply only to top-level items or not (it applies everywhere). It's whether 2 blank lines should be allowed only to top-level items, or to any item that is not within a class/function.
(<a href="https://www.flake8rules.com/rules/E303.html">The E303 description</a> does not mention top-level)</p>
<p>This seems like a very arbitrary choice to me, and <a href="https://peps.python.org/pep-0008/#blank-lines">PEP8</a> does not provide a recommendation on that front.</p>
<p>The situation can be sumed-up like this:
| Snipet                                                  | Pycodestyle | Current PR implementation |
|:-------------------------------------------------------:|:-----------:|:-------------------------:|
| <pre>if True:<br>    a = 1<br><br><br><br>    a = 2</pre> | Violation   | Violation                 |
| <pre>if True:<br>    a = 1<br><br><br>    a = 2</pre>     | Violation   | OK                        |
| <pre>if True:<br>    a = 1<br><br>    a = 2</pre>         | OK          | OK                        |</p>
<p>(if the <code>if</code> is replaced by a <code>def</code>, then both implementation would have identical results)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/allisonkarlitskaya">@allisonkarlitskaya</a> on 2023-11-21 10:07</div>
            <div class="timeline-body"><blockquote>
<p>My issue isn't whether E303 should apply only to top-level items or not (it applies everywhere). It's whether 2 blank lines should be allowed only to top-level items, or to any item that is not within a class/function.
(<a href="https://www.flake8rules.com/rules/E303.html">The E303 description</a> does not mention top-level)</p>
</blockquote>
<p>The E303 description talks about spaces between functions and methods.  That's what I meant by top-level, although technically a method defined inside of a class isn't really top-level.</p>
<p>What really motivated me to use the &quot;top level&quot; language though is that when I went hunting for hints about the pycodestyle implementation and how it changed over time, I found this commit from a decade and a half ago by @florentx:</p>
<p>https://github.com/PyCQA/pycodestyle/commit/fc059fb7a07997df83a232018fcdc2907648aa99</p>
<pre><code class="language-python">...
    elif (max_blank_lines &gt; 2 or
         (indent_level and max_blank_lines == 2)):
       return 0, &quot;E303 too many blank lines (%d)&quot; % max_blank_lines
</code></pre>
<p>Which reads as E303 in case of &quot;more than 2 lines anywhere, or 2 lines at any (non-zero-)indented level&quot;.  That meshes with the English language description of the change:</p>
<blockquote>
<p>Reserve &quot;2 blank lines&quot; for module-level logical blocks (E303)</p>
</blockquote>
<p>Note: this happens to be the commit that also added the test case, linked above, in its original form:</p>
<pre><code class="language-python">def a():
    print


    # comment

    print
</code></pre>
<p>So by the code, and by the description of the change, and by the added test case, it seems clear that the intent is that two newlines should only ever appear at top level (meaning: unintended), otherwise E303 is the correct error to issue for that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/allisonkarlitskaya">@allisonkarlitskaya</a> on 2023-11-21 14:37</div>
            <div class="timeline-body"><p>With https://github.com/PyCQA/pycodestyle/pull/1215 merged, the &quot;top-levelness instead of class/def&quot; approach now seems indisputably correct.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:51 on 2023-11-28 02:55</div>
            <div class="timeline-body"><p>You can derive <code>Default</code> if you flip <code>is_first_logical_line</code> to <code>is_not_first_logical_line</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:68 on 2023-11-28 02:58</div>
            <div class="timeline-body"><p>I would either make these module level constants:</p>
<pre><code>const BLANK_LINES_TOP_LEVEL: u32 = 2;
const BLANK_LINES_METHOD_LEVEL: u32 = 1;
</code></pre>
<p>or use an enum</p>
<pre><code class="language-rust">#[derive(Copy, Clone, Debug)]
enum BlankLines {
	TopLevel,
	Method
}

impl BlankLines {
	const fn count(self) -&gt; u32 {
		match self {
			BlankLines::TopLevel =&gt; 2,
			BlankLines::Method =&gt; 1
		}
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:356 on 2023-11-28 02:59</div>
            <div class="timeline-body"><p>Nit</p>
<pre><code class="language-suggestion">    matches!(token, Some(TokenKind::Class | TokenKind::Def | TokenKind::Async))
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:378 on 2023-11-28 03:01</div>
            <div class="timeline-body"><p>Nit: We could implement this as a method on <code>BlankLinesTrackingVars</code> instead (and rename the struct to <code>BlankLinesChecker</code></p>
<pre><code class="language-rust">impl BlankLinesChecker {
	pub(crate) fn check_line(&amp;mut self, line: &amp;LogicalLine, prev_indent_level: Option&lt;usize&gt;, indent_level: usize, ...) {
		...
	}
}
</code></pre>
<p>and you would use it</p>
<pre><code>let mut blank_lines_checker = BlankLinesChecker::default();
...

for line in logical_lines {
	blank_lines_checker.check_line(line, ...);
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:384 on 2023-11-28 03:04</div>
            <div class="timeline-body"><p>Is my assumption correct that <code>is_in_class</code> and <code>follows_comments_after_class</code> should never be <code>true</code> at the same time? If so, could we use a single enum instead that has three states: <code>InClass(indent_level)</code>, <code>CommentAfterClass</code>, <code>OutsideClass</code> (default)? It may even be possible to store the <code>indent_level</code> inside of the state variable.</p>
<p>Encoding the different states more explicitly helps to avoid invalid states when we forget to reset some variable</p>
<p>The same applies for <code>is_in_fn</code>. We can reuse the same enum if you give it more generic names (<code>Inside(indent_level)</code>, <code>CommentAfter</code>, <code>Outside</code>)</p>
<p>We could even go one step further and have a <code>Follows</code> struct with a <code>FollowKind</code> because it is never possible to follow a class and function at the same time.</p>
<pre><code class="language-rust">#[derive(Copy, Clone, Debug)]
enum Follows {
    Class(FollowKind),
    Function(FollowKind)
}

#[derive(Copy, Clone, Debug)]
enum FollowKind {
    Inside(indent_level),
    CommentAfter,
    Outside
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:344 on 2023-11-28 03:13</div>
            <div class="timeline-body"><p>This method seems to always be called with <code>Some(line)</code>. Thus, using <code>Option</code> is unnecessary</p>
<pre><code class="language-suggestion">fn is_docstring(line: &amp;LogicalLine) -&gt; bool {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:415 on 2023-11-28 03:18</div>
            <div class="timeline-body"><p>Nit: I think the code is easier to read when you remove the loop to reduce the nestin.</p>
<pre><code class="language-rust">let first_token = line.tokens().find(|token| !matches!(token.kind, TokenKind::Indent | TokenKind::Dedent));

// The body of the loop
</code></pre>
<p>It makes it clear which tokens are skipped and that the body itself is only executed once (it also removes the need for the <code>break</code> statements in the `match`` below)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:22 on 2023-11-28 03:29</div>
            <div class="timeline-body"><p>I think we can create an enum instead of using 3 boolean because it is only ever possible that one of those is true, but not all of them at once:</p>
<pre><code class="language-rust">#[derive(Copy, Clone, Debug, Default)]
enum Follows {
    #[default]
    Other,
    Decorator,
    Def,
    Docstring
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:480 on 2023-11-28 03:37</div>
            <div class="timeline-body"><p>Would it be possible to compute the blank lines ad-hoc? Storing them for every line seems expensive, especially because they're only needed for fixes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-11-28 03:39</div>
            <div class="timeline-body"><p>Thanks for working on this (again).</p>
<p>I left a few comments on how I think the state could be simplified which should make it easier to reason about and review the code changes.</p>
<p>I still feel somewhat uncomfortable to integrate this into logical lines. Are there examples where it is important that the rule runs on logical lines? If so, then using logical lines is the right thing to do. If not, then it might be overkill and it might be easier to just copy over of what's needed from LogicalLine into a BlankLine checker.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-11-28 04:52</div>
            <div class="timeline-body"><p>I guess I need to get a better understanding when this rule is supposed to run. What I'm wondering is if it is sufficient to only test for empty lines after each Newline (which indicates a new logical line) and use <code>Indent</code> and <code>Dedent</code> to detect the end of a class / function. If that happens to be sufficient, it might be easier to implement it without using logical lines. If there are cases where this is not sufficient, than using logical lines is the right choice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:384 on 2023-11-28 05:46</div>
            <div class="timeline-body"><p>I think your assumption is correct, I'll try to switch to using an enum.</p>
<p>I'm not sure if class and function status can be condensed into a single enum (since it's possible to be in both a class and a function at the same time).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/hoel-bagard">@hoel-bagard</a> reviewed on 2023-11-28 05:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-11-28 06:00</div>
            <div class="timeline-body"><p>Thank you for your review.</p>
<p>I don't know if using logical lines is required. I was under the impression that I could only use physical or logical lines, and with physical lines ruled out there was only logical lines left. As long as it's possible to check for indents/detents, def/async def, class and decorator tokens, I suppose it might be possible to not use logical lines.
I don't have a good idea of what the alternative would be, so it's a bit hard to say.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/hoel-bagard">@hoel-bagard</a> reviewed on 2023-11-28 06:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on <code>crates/ruff_linter/src/rules/pycodestyle/rules/logical_lines/blank_lines.rs</code>:480 on 2023-11-28 06:04</div>
            <div class="timeline-body"><p>There isn't a way to go back to previous logical lines, right ?
Then the only option (afaik) would be to work with text and to go back until finding the end of the previous non-blank line. My understanding is that it would be slow, however if that is run only for fixes, then maybe it's fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-12-01 02:11</div>
            <div class="timeline-body"><p>The alternative is that you create a function similar to <code>check_logical_lines</code> that accepts all tokens. It would be interesting to understand if doing so would require duplicating a lot of logic (in which case it isn't worth it) or if it may even be simpler because you don't need to make it fit into the logical lines structure.</p>
<p>Do you want to play around with it to see how it feels? Feel free to publish it as a separate (or stacked) PR. I don't want that you have to undo the work if logical lines was the right place to begin with.</p>
<p>See</p>
<p>https://github.com/astral-sh/ruff/blob/c38617fa27feff7e9024fbee72354bebc3759b47/crates/ruff_linter/src/checkers/logical_lines.rs#L33-L38</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-12-02 11:46</div>
            <div class="timeline-body"><p>Would the main goal be to not store the number of preceding blank lines/characters for each line ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-12-04 03:45</div>
            <div class="timeline-body"><blockquote>
<p>Would the main goal be to not store the number of preceding blank lines/characters for each line ?</p>
</blockquote>
<p>The main goal is to understand if the rules fit into the logical lines or not. To me, it seems they don't really re-use the logic of logical lines, but it adds complexity to the logical line data structures (making it harder to understand and maintain). Meaning, the overall implementation may be more complicated than it has to. It also has the downside that running the logical line rules only (excluding blank lines) now pays for some of the blank line's runtime cost without using it. .</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-12-10 12:17</div>
            <div class="timeline-body"><p>Ok, I'll try to make the change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/minusf">@minusf</a> on 2023-12-13 16:26</div>
            <div class="timeline-body"><p>very happy to see E303 coming, thank you all! my ocd will thank you &lt;3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2023-12-14 07:47</div>
            <div class="timeline-body"><p>As a note, autofixes for all these rules would cover <code>E3</code> fixes of Autopep8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoel-bagard">@hoel-bagard</a> on 2023-12-16 08:03</div>
            <div class="timeline-body"><p>@MichaReiser I've made a version that does not use logical lines <a href="https://github.com/astral-sh/ruff/pull/9266">here</a>.</p>
<p>Overall I feel like the added logic isn't too complex, especially since it removes some functions from the logical lines version. I still need to operate on logical lines (since pycodestyle did), so I'm still building them, but I only keep track of what I actually need.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2023-12-16 08:11</div>
            <div class="timeline-body"><h2><a href="https://codspeed.io/astral-sh/ruff/branches/hoel-bagard:add_blank_lines_E30_V2">CodSpeed Performance Report</a></h2>
<h3>Merging #8720 will <strong>not alter performance</strong></h3>
<p><sub>Comparing <code>hoel-bagard:add_blank_lines_E30_V2</code> (29849d5) with <code>main</code> (0029b4f)</sub></p>
<h3>Summary</h3>
<p><code>✅ 30</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @hoel-bagard on 2023-12-25 00:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @hoel-bagard on 2024-02-18 10:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:57:54 UTC
    </footer>
</body>
</html>
