<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Default `ty.inlayHints.*` server settings to true - astral-sh/ruff #19910</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Default <code>ty.inlayHints.*</code> server settings to true</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/19910">#19910</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2025-08-14 08:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body">Summary
<p>This PR changes the default of <code>ty.inlayHints.*</code> settings to <code>true</code>.</p>
<p>I somehow missed this in my initial PR.</p>
<p>This is marked as <code>internal</code> because it&#x27;s not yet released.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/sharkdp">@sharkdp</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-08-14 08:11</div>
            <div class="timeline-body">

Diagnostic diff on <a href="https://github.com/python/typing/tree/d4f39b27a4a47aac8b6d4019e1b0b5b3156fabdc/conformance">typing conformance tests</a>

Changes were detected when running ty on typing conformance tests

<pre><code>--- old-output.txt	2025-08-14 08:33:10.270535018 +0000
+++ new-output.txt	2025-08-14 08:33:10.336535119 +0000
@@ -1,5 +1,5 @@
 WARN ty is pre-release software and not ready for production use. Expect to encounter bugs, missing features, and fatal errors.
-fatal[panic] Panicked at /home/runner/.cargo/git/checkouts/salsa-e6f3bb7c2a062968/918d35d/src/function/execute.rs:215:25 when checking `/home/runner/work/ruff/ruff/typing/conformance/tests/aliases_typealiastype.py`: `infer_definition_types(Id(18ab)): execute: too many cycle iterations`
+fatal[panic] Panicked at /home/runner/.cargo/git/checkouts/salsa-e6f3bb7c2a062968/918d35d/src/function/execute.rs:215:25 when checking `/home/runner/work/ruff/ruff/typing/conformance/tests/aliases_typealiastype.py`: `infer_definition_types(Id(48c8)): execute: too many cycle iterations`
 _directives_deprecated_library.py:15:31: error[invalid-return-type] Function always implicitly returns `None`, which is not assignable to return type `int`
 _directives_deprecated_library.py:30:26: error[invalid-return-type] Function always implicitly returns `None`, which is not assignable to return type `str`
 _directives_deprecated_library.py:36:41: error[invalid-return-type] Function always implicitly returns `None`, which is not assignable to return type `Self@__add__`
</code></pre>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-08-14 08:13</div>
            <div class="timeline-body">

<code>mypy_primer</code> results
<p>No ecosystem changes detected ✅
No memory usage changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-14 08:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-14 08:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-08-14 08:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 08:57</div>
            <div class="timeline-body"><p>I&#x27;m not entirely sure about enabling all of them by default. E.g. pylance all inlays by default (which I&#x27;m also not sure if that&#x27;s great). We probably want something in between where we enable the non noisy inlays by default but keep all others disabled.</p>
<p>Having said that. I think defaulting those two settings to true makes sense.</p>
<p>I assume the new default implementation matches the defaults in the VS code settings?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-08-14 08:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 08:59</div>
            <div class="timeline-body"><p>Hmm, good point.</p>
<p>I think I have it backwards. Both of them are disabled by default in Pylance.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-08-14 09:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 09:36</div>
            <div class="timeline-body"><p>As discussed in our 1:1, we&#x27;ve decided to keep it enabled by default, and can change it in the future before GA based on user feedback.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 09:43</div>
            <div class="timeline-body"><p>Hmm, I&#x27;m a bit surprised by this change, and a bit unhappy with that resolution. We discussed this a fair bit as a team in the original PR adding inlay hints (<a href="https://github.com/astral-sh/ruff/pull/17214">astral-sh/ruff#17214</a>#issuecomment-2781460823, and there was also discussion on Discord as well IIRC), and I thought we came to a consensus that we should keep them disabled by default</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-08-14 09:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-08-14 09:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 09:49</div>
            <div class="timeline-body"><p>Oh, I think I forgot about that discussion, thanks for the reminder. I&#x27;ll revert this change back for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-08-14 09:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 09:58</div>
            <div class="timeline-body"><p>@AlexWaygood editors have a global setting to opt in/out of inlay hints. I think it&#x27;s confusing if enabling inlay hints requires both: enabling them globally in the editor and for the extension. In that sense, inlays are disabled by default unless you enable them in your editor.</p>
<p>This behavior also matches rust-analyzers behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-08-14 10:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:03</div>
            <div class="timeline-body"><blockquote>
<p>This behavior also matches rust-analyzers behavior.</p>
</blockquote>
<p>I find inlay hints far more useful when writing Rust than when writing Python, as I described in <a href="https://github.com/astral-sh/ruff/pull/17214">astral-sh/ruff#17214</a>#issuecomment-2781460823.</p>
<p>Does this behaviour match Pylance? I don&#x27;t think I&#x27;ve ever toggled the inlay hints setting in VSCode either for the editor or for any specific extension, but I&#x27;ve always seen inlay hints from rust-analyzer when writing Rust, and I&#x27;ve never seen inlay hints from Pylance when writing Python.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-08-14 10:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:05</div>
            <div class="timeline-body"><blockquote>
<p>Does this behaviour match Pylance?</p>
</blockquote>
<p>It does not. Pylance has them off by default.</p>
<p>I still think we should keep inlays that we find useful and aren&#x27;t noisy on by default. That&#x27;s what users opt-in to by enabling inlay hints at the editor level and I rather change our defaults based on user feedback. Which I think we get more of if we enable them by default and it&#x27;s something we can change very easily moving forward.</p>
<p>E.g. I find the argumet name inlay very useful. Maybe the variable type is less so. But we should discuss them independently</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-08-14 10:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:08</div>
            <div class="timeline-body"><p>I think it&#x27;s a good call out that we should think about why we enable which inlays by default and we can create an issue to revisit this. In the meantime, I&#x27;d prefer to defer this discussion to later.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-08-14 10:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:09</div>
            <div class="timeline-body"><p>That sounds good, I can create an issue and proceed with the release as usual.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:10</div>
            <div class="timeline-body"><p>I&#x27;m afraid I&#x27;m still of the opinion that this is a change that I would definitely not want to see in my editor with what I understand the current state of this feature as being; that it would take me some time to figure out how to change the settings in VSCode (I can never find my way to the right setting on the rare occasion I need to change something); that this is going to be quite surprising to users coming from Pylance; and that this is going to negatively impact most users of the ty server.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-08-14 10:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:14</div>
            <div class="timeline-body"><p>Just for context, the variable type hints were enabled by default when it got added and it only got disabled by default in <a href="https://github.com/astral-sh/ruff/pull/19780">astral-sh/ruff#19780</a> which I did not intend to make. That was the main motivation of this PR which is to turn it back on to return the behavior in the released ty version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2025-08-14 10:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-08-14 10:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/inlay_hints.rs</code>:97 on 2025-08-14 10:22</div>
            <div class="timeline-body"><blockquote>
<p>Just for context, the variable type hints were enabled by default when it got added and it only got disabled by default in #19780 which I did not intend to make. That was the main motivation of this PR which is to turn it back on to return the behavior in the released ty version.</p>
</blockquote>
<p>Ahhh, this I did not realise. I&#x27;m definitely fine with restoring the status quo, in that case, and continuing the discussion in an issue elsewhere.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:17:42 UTC
    </footer>
</body>
</html>
