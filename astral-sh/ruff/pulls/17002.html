<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] Add run panel - astral-sh/ruff #17002</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] Add run panel</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17002">#17002</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-03-26 19:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR adds a new secondary panel to the red knot playground that allows running the python code (current file) with <a href="https://pyodide.org/en/stable/index.html">pyodide</a> (currently Python 3.12 only).</p>
<h2>Test Plan</h2>
<p>https://github.com/user-attachments/assets/7bda8ef7-19fb-4c2f-8e62-8e49a1416be1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">playground</span> added by @MichaReiser on 2025-03-26 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @MichaReiser on 2025-03-26 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @Copilot by @MichaReiser on 2025-03-26 20:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/copilot-pull-request-reviewer[bot]">@copilot-pull-request-reviewer[bot]</a> reviewed on 2025-03-26 20:51</div>
            <div class="timeline-body"><h2>Pull Request Overview</h2>
<p>This pull request adds a new run panel for executing Python code via pyodide, along with the related UI changes.</p>
<ul>
<li>Updated Vite configuration to copy pyodide assets and exclude them from dependency optimization.</li>
<li>Introduced a new Run icon and integrated the Run panel into the SecondaryPanel and Sidebar.</li>
<li>Modified the initialization logic in the Playground to support dynamic loading of the red_knot wasm module.</li>
</ul>
<h3>Reviewed Changes</h3>
<p>Copilot reviewed 6 out of 8 changed files in this pull request and generated 1 comment.</p>
<details>
<summary>Show a summary per file</summary>

<p>| File                             | Description                                                            |
| -------------------------------- | ---------------------------------------------------------------------- |
| playground/knot/vite.config.ts   | Added pyodide asset copying and configuration adjustments              |
| playground/shared/src/Icons.tsx   | Introduced a new Run icon SVG                                          |
| playground/knot/src/Editor/SecondaryPanel.tsx | Added Run tool integration with pyodide loading and run functionality    |
| playground/knot/src/Editor/SecondarySideBar.tsx | Added Run entry to the sidebar using the new icon                         |
| playground/knot/src/Editor/Chrome.tsx          | Updated panel integration to include Run tool behavior                    |
| playground/knot/src/Playground.tsx             | Changed initialization logic via dynamic import of the red_knot wasm module |</p>
</details>

<details>
<summary>Files not reviewed (2)</summary>

<ul>
<li><strong>playground/knot/package.json</strong>: Language not supported</li>
<li><strong>playground/package-lock.json</strong>: Language not supported</details>

</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Copilot">@Copilot</a> on <code>playground/knot/vite.config.ts</code>:23 on 2025-03-26 20:51</div>
            <div class="timeline-body"><p>Remove or conditionally execute the console.log statement to avoid production-level logging.</p>
<pre><code class="language-suggestion">  if (process.env.NODE_ENV !== 'production') {
    console.log(pyodideDir, PYODIDE_EXCLUDE);
  }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @MichaReiser on 2025-03-26 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-03-26 21:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-03-26 21:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-03-26 21:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-03-26 21:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>playground/knot/src/Editor/SecondaryPanel.tsx</code>:155 on 2025-03-26 21:39</div>
            <div class="timeline-body"><p>The patched version of <code>reveal_type</code> that I'd prefer would be something like:</p>
<pre><code class="language-py">def reveal_type(obj):
    print(f&quot;Runtime value is '{obj}'&quot;)
    import typing
    return typing.reveal_type(obj)
</code></pre>
<p>We should definitely have something that still return the original value, otherwise we'll break some code that uses <code>reveal_type</code> on intermediate expressions.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:11:00 UTC
    </footer>
</body>
</html>
