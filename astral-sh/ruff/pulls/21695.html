<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Move `all_members`, and related types/routines, out of `ide_support.rs` - astral-sh/ruff #21695</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Move <code>all_members</code>, and related types/routines, out of <code>ide_support.rs</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/21695">#21695</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-11-29 16:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>These routines and types are now used by several modules elsewhere in <code>ty_python_semantic</code> that have little to do with supporting IDE usecases. @carljm asked in https://github.com/astral-sh/ruff/pull/21436#discussion_r2539331295 for these to therefore be moved out of this module and put somewhere else. I said I'd do that as a followup, so here's the followup!</p>
<h2>Test Plan</h2>
<p>Existing tests all pass</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @AlexWaygood on 2025-11-29 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @AlexWaygood on 2025-11-29 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @AlexWaygood on 2025-11-29 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @AlexWaygood on 2025-11-29 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @AlexWaygood on 2025-11-29 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-11-29 16:36</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance">typing conformance tests</a></h2>
<p>No changes detected when running ty on typing conformance tests ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2025-11-29 16:38</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">scikit-build-core (https://github.com/scikit-build/scikit-build-core)
- src/scikit_build_core/_logging.py:153:13: warning[unsupported-base] Unsupported class base with type `&lt;class 'Mapping[str, Style]'&gt; | &lt;class 'Mapping[str, Divergent]'&gt;`
- src/scikit_build_core/build/_pathutil.py:25:38: error[invalid-argument-type] Argument to function `__new__` is incorrect: Expected `str | PathLike[str]`, found `DirEntry[Path]`
- src/scikit_build_core/build/_pathutil.py:27:24: error[invalid-argument-type] Argument to function `__new__` is incorrect: Expected `str | PathLike[str]`, found `DirEntry[Path]`
- src/scikit_build_core/build/wheel.py:98:20: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 45 diagnostics
+ Found 41 diagnostics

pandas-stubs (https://github.com/pandas-dev/pandas-stubs)
- pandas-stubs/_typing.pyi:1207:16: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- Found 5815 diagnostics
+ Found 5814 diagnostics


</code></pre>
</details>

<p>No memory usage changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-12-01 07:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/list_members.rs</code>:19 on 2025-12-01 07:42</div>
            <div class="timeline-body"><p>This function seems unrelated to <code>members</code>. We also use it to compute the completions for the definitions in the current scope. That's why I think <code>all_members.rs</code> isn't a great fit for it.</p>
<p>I think I'd move it into <code>semantic_index.rs</code> alongside <code>attribute_declarations</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-12-01 08:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/list_members.rs</code>:19 on 2025-12-01 08:06</div>
            <div class="timeline-body"><p>This function returns an Iterator of <code>MemberWithDefinition</code>, which is a type defined in this module and which is intended to be a much higher-level API than what the semantic index has to offer. So to me, it feels very much like it belongs in this module — but maybe we should rename the module? <code>list_members.rs</code> rather than <code>all_members.rs</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-12-01 09:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/list_members.rs</code>:19 on 2025-12-01 09:17</div>
            <div class="timeline-body"><p>I think it depends on the terminology we want here. We should either:</p>
<ul>
<li>Rename the method to <code>all_members</code></li>
<li>Rename <code>MemberWithDefinition</code> to something else, making it clear it's not just class members</li>
</ul>
<p>What's unclear to me is if <code>Member</code> should be reserved to class members only (in which case we should rename the return type) or if we're fine using it for all sort of members (in which case we should rename the method)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-12-01 13:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/types/list_members.rs</code>:19 on 2025-12-01 13:22</div>
            <div class="timeline-body"><p>I've renamed the module and updated some docs. LMK what you think.</p>
<blockquote>
<p>What's unclear to me is if <code>Member</code> should be reserved to class members only (in which case we should rename the return type) or if we're fine using it for all sort of members (in which case we should rename the method)</p>
</blockquote>
<p>We already use the term &quot;member&quot; across the codebase much more broadly than just to refer to &quot;class members only&quot; -- for example, the <code>Type::member()</code> method, which can be called on any type (not just class types or instance types). And <code>all_members()</code> can also be called on any type, not just a class or an instance.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/types/list_members.rs</code>:19 on 2025-12-02 09:13</div>
            <div class="timeline-body"><p>Should we call this <code>all_member_definitions</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-12-02 09:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @AlexWaygood on 2025-12-02 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-12-02 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-02 14:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:17:39 UTC
    </footer>
</body>
</html>
