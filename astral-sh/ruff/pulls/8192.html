<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refine warning about incompatible `isort` settings - astral-sh/ruff #8192</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Refine warning about incompatible <code>isort</code> settings</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/8192">#8192</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2023-10-25 01:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">Summary
<p>This PR refines the warning shown when running <code>ruff format</code> about incompatible <code>isort</code> settings:</p>
<ul>
<li><p>Only warn if <code>I001</code> (unsorted imports) is enabled.</p>
</li>
<li><p><code>lines-after-imports</code>: Warn about values other than <code>-1</code>, <code>1</code>, and <code>2</code> because the formatter enforces at least one empty and at most two empty lines after imports.</p>
</li>
<li><p><code>lines-between-types</code>: Warn about values &gt; 1 because the formatter preserves at most one empty line in nested import blocks.</p>
</li>
<li><p><code>split_on_trailing_comma</code>: Only warn when <code>skip-magic-trailing-comma</code> is <code>true</code> to ensure the formatter preserves the trailing commas.</p>
</li>
<li><p>Remove <code>force-single-line</code>: I think removing the warnings is safe. The setting seems to mainly be about removing parentheses around alieses:</p>
<pre><code>from .utils2 import (
  test_directory as test_directory,
)
from .utils2 import (
    test_id as test_id,
)

 # isorted
from .utils import (
  test_directory as teeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee,
)
from .utils import test_id as t2
from .utils2 import test_directory as test_directory
from .utils2 import test_id as test_id  
</code></pre>
<p>which the formatter leaves unchanged</p>
</li>
<li><p>Only warn about <code>force_wrap_aliases</code> when <code>skip-magic-trailing-comma</code> is <code>true</code>. Isort inserts trailing commas that the formatter respects, except when <code>skip-magic-trailing-comma</code> isn&#x27;t set to <code>true</code>.</p>
</li>
</ul>
Test Plan
<p>Added test plans. Played around with different examples in the playground to identify the <code>isort</code> behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 01:33</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #8192</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8192"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite"></a>  ðŸ‘ˆ<ul>
<li><strong>PR #8196</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8196"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite"></a><ul>
<li><strong>PR #8244</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8244"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite"></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8192?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-10-25 01:51</div>
            <div class="timeline-body">PR Check Results
Ecosystem
<p>âœ… ecosystem check detected no changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 01:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 01:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 02:00</div>
            <div class="timeline-body"><p>@charliermarsh you have a better understanding of <code>isort</code> than I. I would appreciate if you could review the compatibility in detail to make sure we get it right this time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 02:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands/format.rs</code>:723 on 2023-10-25 03:03</div>
            <div class="timeline-body"><p>This one looks right (going through one-by-one).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands/format.rs</code>:727 on 2023-10-25 03:04</div>
            <div class="timeline-body"><p>This makes sense (nit: &quot;isort&quot;, lowercase).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_workspace/src/options.rs</code>:1914 on 2023-10-25 03:04</div>
            <div class="timeline-body"><p>Nit: no apostrophe after <code>Value</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_workspace/src/options.rs</code>:1915 on 2023-10-25 03:04</div>
            <div class="timeline-body"><p>Nit: <code>emty</code>, and space between <code>import</code> and period.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands/format.rs</code>:720 on 2023-10-25 03:05</div>
            <div class="timeline-body"><p>Yeah, this is fine to allow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands/format.rs</code>:727 on 2023-10-25 03:06</div>
            <div class="timeline-body"><p>I think we should have the same logic for <a href="https://docs.astral.sh/ruff/settings/#isort-split-on-trailing-comma"><code>split-on-trailing-comma</code></a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands/format.rs</code>:727 on 2023-10-25 03:08</div>
            <div class="timeline-body"><p><code>split-on-trailing-comma</code> needs to be identical to <code>setting.formatter.magic_trailing_comma</code> (i.e., if <code>split-on-trailing-comma</code> is <code>true</code>, we need <code>setting.formatter.magic_trailing_comma.is_respect()</code>, I think).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-10-25 03:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_cli/src/commands/format.rs</code>:717 on 2023-10-25 03:10</div>
            <div class="timeline-body"><p>Confirmed this is correct...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2023-10-25 03:12</div>
            <div class="timeline-body"><p>These look correct to me. I also scanned through the full list of options and confirmed the omitted settings seem compatible too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 07:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-25 07:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-10-25 07:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:58:42 UTC
    </footer>
</body>
</html>
