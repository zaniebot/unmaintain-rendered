<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control flow: Switch statements - astral-sh/ruff #17268</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Control flow: Switch statements</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17268">#17268</a>
        opened by <a href="https://github.com/dylwil3">@dylwil3</a>
        on 2025-04-07 07:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a></div>
            <div class="timeline-body"><p>This PR implements switch statements in the control flow graph builder.</p>
<p>There are a few false positives in the ecosystem check because we have not implemented the fallback for exception handling statements, but otherwise things are looking good.</p>
<p>Note: This is currently based on the <code>cfg-loops</code> branch, so I will have to rebase after it&#x27;s merged in. But if you want a head start on reviewing, just start with commit <a href="https://github.com/astral-sh/ruff/pull/17268/commits/8d67bf3c193d2118c7cb5eab28650a26da90a3b4">8d67bf3</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-04-07 07:55</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+20 -1 violations, +0 -0 fixes in 12 projects; 43 projects unchanged)</p>
<a href="https://github.com/DisnakeDev/disnake">DisnakeDev/disnake</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/DisnakeDev/disnake/blob/2ab0c535b021dd120b5a6aff67dc1c195b9913ae/disnake/state.py#L2531">disnake/state.py:2531:9:</a> PLW0101 Unreachable code in `_delay_ready`
</pre>

</p>

<a href="https://github.com/apache/airflow">apache/airflow</a> (+3 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/42024188b9553dd50072e717af754cb95c901972/airflow-core/src/airflow/models/dag.py#L2581">airflow-core/src/airflow/models/dag.py:2581:5:</a> PLW0101 Unreachable code in `_run_task`
+ <a href="https://github.com/apache/airflow/blob/42024188b9553dd50072e717af754cb95c901972/airflow-core/src/airflow/triggers/testing.py#L52">airflow-core/src/airflow/triggers/testing.py:52:13:</a> PLW0101 Unreachable code in `run`
+ <a href="https://github.com/apache/airflow/blob/42024188b9553dd50072e717af754cb95c901972/providers/sftp/src/airflow/providers/sftp/triggers/sftp.py#L138">providers/sftp/src/airflow/providers/sftp/triggers/sftp.py:138:9:</a> PLW0101 Unreachable code in `run`
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/tests/support/plugins/file_server.py#L93">tests/support/plugins/file_server.py:93:9:</a> PLW0101 Unreachable code in `__init__`
</pre>

</p>

<a href="https://github.com/fronzbot/blinkpy">fronzbot/blinkpy</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/fronzbot/blinkpy/blob/e2c747b5ad295424b08ff4fb03204129155666fc/blinksync/blinksync.py#L102">blinksync/blinksync.py:102:5:</a> PLW0101 Unreachable code in `main`
</pre>

</p>

<a href="https://github.com/langchain-ai/langchain">langchain-ai/langchain</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/langchain-ai/langchain/blob/8574442c5709c429f01369c5ce969be8065c2f2b/libs/core/langchain_core/runnables/base.py#L5137">libs/core/langchain_core/runnables/base.py:5137:13:</a> PLW0101 Unreachable code in `astream_events`
</pre>

</p>

<a href="https://github.com/latchbio/latch">latchbio/latch</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/latchbio/latch/blob/3d40eb57259fbea100d5022f9ab04f5bb7686857/src/latch_cli/tinyrequests.py#L111">src/latch_cli/tinyrequests.py:111:5:</a> PLW0101 Unreachable code in `_req`
</pre>

</p>

<a href="https://github.com/milvus-io/pymilvus">milvus-io/pymilvus</a> (+1 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
- <a href="https://github.com/milvus-io/pymilvus/blob/b65b4f5c6e46b2b930d48f4593032b86803e848a/examples/iterator/iterator.py#L64">examples/iterator/iterator.py:64:9:</a> PLW0101 Unreachable code in `external_filter_func`
+ <a href="https://github.com/milvus-io/pymilvus/blob/b65b4f5c6e46b2b930d48f4593032b86803e848a/examples/iterator/iterator.py#L65">examples/iterator/iterator.py:65:9:</a> PLW0101 Unreachable code in `external_filter_func`
</pre>

</p>

<a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/pandas-dev/pandas/blob/e5898b8d33ac943a60250e1466006c073a506e8c/pandas/_version.py#L111">pandas/_version.py:111:5:</a> PLW0101 Unreachable code in `run_command`
+ <a href="https://github.com/pandas-dev/pandas/blob/e5898b8d33ac943a60250e1466006c073a506e8c/pandas/io/html.py#L1007">pandas/io/html.py:1007:5:</a> PLW0101 Unreachable code in `_parse`
</pre>

</p>

<a href="https://github.com/rotki/rotki">rotki/rotki</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/rotki/rotki/blob/c624060abdd57e365dcf35fb5aceafae422a0d06/rotkehlchen/chain/evm/decoding/morpho/utils.py#L64">rotkehlchen/chain/evm/decoding/morpho/utils.py:64:5:</a> PLW0101 Unreachable code in `_query_morpho_vaults_api`
</pre>

</p>

<a href="https://github.com/zulip/zulip">zulip/zulip</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/zulip/zulip/blob/18fdbc15196bbb8501435586ff60aab2c67aa345/zerver/actions/message_flags.py#L93">zerver/actions/message_flags.py:93:5:</a> PLW0101 Unreachable code in `do_mark_all_as_read`
+ <a href="https://github.com/zulip/zulip/blob/18fdbc15196bbb8501435586ff60aab2c67aa345/zerver/views/streams.py#L1073">zerver/views/streams.py:1073:5:</a> PLW0101 Unreachable code in `delete_in_topic`
</pre>

</p>

<a href="https://github.com/indico/indico">indico/indico</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/indico/indico/blob/9a96d1acc4957742bfd7bdde6c059562e8e1d759/indico/util/decorators.py#L44">indico/util/decorators.py:44:9:</a> PLW0101 Unreachable code in `__get__`
</pre>

</p>

<a href="https://github.com/astropy/astropy">astropy/astropy</a> (+5 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/astropy/astropy/blob/cd6eda4f84d3b52fcf9e79577188a5ee83f33eac/astropy/coordinates/name_resolve.py#L201">astropy/coordinates/name_resolve.py:201:5:</a> PLW0101 Unreachable code in `get_icrs_coordinates`
+ <a href="https://github.com/astropy/astropy/blob/cd6eda4f84d3b52fcf9e79577188a5ee83f33eac/astropy/io/votable/tree.py#L3146">astropy/io/votable/tree.py:3146:9:</a> PLW0101 Unreachable code in `_parse_binary`
+ <a href="https://github.com/astropy/astropy/blob/cd6eda4f84d3b52fcf9e79577188a5ee83f33eac/astropy/samp/tests/test_helpers.py#L37">astropy/samp/tests/test_helpers.py:37:5:</a> PLW0101 Unreachable code in `assert_output`
+ <a href="https://github.com/astropy/astropy/blob/cd6eda4f84d3b52fcf9e79577188a5ee83f33eac/astropy/table/pprint.py#L137">astropy/table/pprint.py:137:13:</a> PLW0101 Unreachable code in `_auto_format_func`
+ <a href="https://github.com/astropy/astropy/blob/cd6eda4f84d3b52fcf9e79577188a5ee83f33eac/astropy/utils/data.py#L1590">astropy/utils/data.py:1590:5:</a> PLW0101 Unreachable code in `download_file`
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLW0101 | 21 | 20 | 1 | 0 | 0 |</p>
</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">do-not-merge</span> added by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-04-21 19:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-04-21 19:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-04-21 19:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[WIP] Cfg switch&quot; to &quot;Control flow: Switch statements&quot; by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-04-21 19:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-22 16:22</div>
            <div class="timeline-body"><p>Oh, you work on your own fork. For stacked PRs, it&#x27;s beneficial if you submit directly to this repo so that you can then set the base to a different branch.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-22 16:26</div>
            <div class="timeline-body"><p>The PR title is a bit confusing because Python doesn&#x27;t have switch statements and I was surprised to see that this PR also implements <code>if</code> statements. I think it could have made sense to actually split those PRs into <code>if</code> statements and <code>match</code> statement because I can&#x27;t think of a term that unambiously includes both.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-10-24 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-12-10 18:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:13:04 UTC
    </footer>
</body>
</html>
