<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Added `cls.__dict__.get('__annotations__')` check (`RUF063`) - astral-sh/ruff #18233</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Added <code>cls.__dict__.get(&#x27;__annotations__&#x27;)</code> check (<code>RUF063</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/18233">#18233</a>
        opened by <a href="https://github.com/dericcrago">@dericcrago</a>
        on 2025-05-20 21:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a></div>
            <div class="timeline-body"><p>Added <code>cls.__dict__.get(&#x27;__annotations__&#x27;)</code> check for Python 3.10+ and Python &lt; 3.10 with <code>typing-extensions</code> enabled.</p>
<p>Closes #17853</p>


Summary
<p>Added <code>cls.__dict__.get(&#x27;__annotations__&#x27;)</code> check for Python 3.10+ and Python &lt; 3.10 with <code>typing-extensions</code> enabled.</p>
Test Plan
<p><code>cargo test</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-20 21:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-20 21:32</div>
            <div class="timeline-body"><p>looks like you need to regenerate the JSON schema -- running <code>cargo dev generate-all</code> and committing the changes should fix it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-05-20 21:44</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:103 on 2025-05-21 02:00</div>
            <div class="timeline-body"><p>I don&#x27;t think you need this check. There&#x27;s no particular reason the class would be stored directly in a variable and not e.g. in a list.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:12 on 2025-05-21 02:02</div>
            <div class="timeline-body"><p>This is incorrect, the <code>__dict__.get</code> approach is reliable on all Python versions up to 3.14. (On 3.14 it will only return any annotations if the class is defined under <code>from __future__ import annotations</code>.) However, it&#x27;s better to use <code>inspect.get_annotations</code> or one the other functions, because (a) it avoids accessing undocumented internals and (b) it&#x27;s forward-compatible with Python 3.14.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:24 on 2025-05-21 02:04</div>
            <div class="timeline-body"><p>This section is relevant to accessing <code>cls.__annotations__</code>, not <code>cls.__dict__.get(&quot;__annotations__&quot;)</code>. The former is unsafe in the presence of metaclasses (on 3.14+ only if <code>from __future__ import annotations</code> is used; on earlier versions always).</p>
<p>I think Ruff should have a separate rule against accessing <code>cls.__annotations__</code> on a class object, but that&#x27;s not what this rule is about.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> reviewed on 2025-05-21 02:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> reviewed on 2025-05-21 02:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:24 on 2025-05-21 02:20</div>
            <div class="timeline-body"><p>I opened #18236 about this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dericcrago">@dericcrago</a> on 2025-05-21 14:11</div>
            <div class="timeline-body"><p>Thank you for the review @JelleZijlstra! I will work on these changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-05-22 16:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:103 on 2025-05-22 16:58</div>
            <div class="timeline-body"><p>This check has been removed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-05-22 16:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:24 on 2025-05-22 16:59</div>
            <div class="timeline-body"><p>This has been removed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-05-22 16:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:12 on 2025-05-22 16:59</div>
            <div class="timeline-body"><p>This has been updated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:79 on 2025-05-23 02:47</div>
            <div class="timeline-body"><p>&quot;enabled&quot; is an odd word choice, is that used elsewhere in Ruff? I&#x27;d use &quot;installed&quot; (this also occurs a few other times in the file).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> reviewed on 2025-05-23 02:49</div>
            <div class="timeline-body"><p>Looks good, thanks!</p>
<p>The error message might be a bit long with mentioning all the different <code>get_annotations()</code> functions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-05-23 04:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:79 on 2025-05-23 04:50</div>
            <div class="timeline-body"><p>Thanks for taking another look @JelleZijlstra!</p>
<p>You&#x27;re right, the original error message was a bit lengthy. I&#x27;ve trimmed about 25 characters off, but I&#x27;m happy to iterate on this further if you have other suggestions for conciseness.</p>
<p>Regarding &quot;enabled&quot; vs. &quot;installed&quot;; thanks for pointing that out. I think some distinction and mixed use might be necessary. For example, I think that:</p>
<ul>
<li>the module <a href="https://pypi.org/project/typing-extensions/">typing-extensions</a> should be <strong>installed</strong></li>
<li>the ruff setting <a href="https://docs.astral.sh/ruff/settings/#lint_typing-extensions">typing-extensions</a> should be <strong>enabled</strong></li>
</ul>
<p>Does this distinction for using &#x27;enabled&#x27; in the context of the ruff setting seem reasonable to you? I&#x27;m open to suggestions if you still feel like &quot;installed&quot; makes more sense or if a different term would be clearer here.</p>
<p>I&#x27;ve pushed the above changes for review.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> reviewed on 2025-05-23 05:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:79 on 2025-05-23 05:10</div>
            <div class="timeline-body"><p>Oh I see, didn&#x27;t realize that was a reference to a Ruff setting.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dylwil3">@dylwil3</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-23 14:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-23 14:23</div>
            <div class="timeline-body"><p>@dylwil3 could you review this PR (as the author of the issue and it being Python 3.14 related?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">python314</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-23 14:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-05-23 15:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:79 on 2025-05-23 15:37</div>
            <div class="timeline-body"><p>That&#x27;s understandable, the code was a bit ambiguous regarding the <code>typing-extensions</code> module vs setting. I&#x27;m hopeful that the changes in the last commit make that distinction clearer. Please let me know if it&#x27;s still not quite hitting the mark! Thanks for sticking with me @JelleZijlstra!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/ntBre">@ntBre</a> by <a href="https://github.com/ntBre">@ntBre</a> on 2025-05-30 16:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/ruff/RUF061.py</code>:16 on 2025-06-04 18:31</div>
            <div class="timeline-body"><p>nit: I don&#x27;t think the trailing <code># RUF061</code> comments are helpful here. To me that suggests that these <em>should</em> trigger a warning.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:8 on 2025-06-04 18:35</div>
            <div class="timeline-body"><p>I would personally probably lean toward using a generic variable name like <code>x</code> or <code>foo</code> instead of <code>&lt;identifier&gt;</code> throughout the docs. I&#x27;d also omit the <code>[, &lt;default&gt;]</code> here. I think a reader would have to be pretty pedantic to assume that the rule wouldn&#x27;t work if they included a default :laughing:</p>
<pre><code>/// Checks for uses of `foo.__dict__.get(&quot;__annotations__&quot;)`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:132 on 2025-06-04 18:40</div>
            <div class="timeline-body"><p>You might need to rebase on/merge <code>main</code>. I&#x27;ve made some recent changes here that will probably cause CI failures when you next push a commit. I think this will end up looking like:</p>
<pre><code>checker.report_diagnostic(ClassDictAnnotations, call.range());
</code></pre>
<p>So not too bad, just something to be prepared for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:92 on 2025-06-04 18:41</div>
            <div class="timeline-body"><p>What do you think about storing the <code>PythonVersion</code> and <code>typing_extensions</code> bool on the <code>ClassDictAnnotations</code>? Then we could offer a precise message here based on the user&#x27;s actual settings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:70 on 2025-06-04 18:41</div>
            <div class="timeline-body"><p>I would typically omit these rather than say explicitly that they aren&#x27;t provided, but I&#x27;m okay with leaving them, especially if you want to add a fix in a follow-up PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:79 on 2025-06-04 18:42</div>
            <div class="timeline-body"><p>This is also the default, so you could omit this line if you wanted.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:74 on 2025-06-04 18:49</div>
            <div class="timeline-body"><p>Our <a href="https://github.com/astral-sh/ruff/blob/main/CONTRIBUTING.md#rule-naming-convention">naming convention</a> is to make the rule read well as &quot;allow ${rule}&quot; which I think this violates slightly. To me, &quot;allow class dict annotations&quot; reads like we&#x27;re allowing you to annotate a dict like</p>
<pre><code>class C[T]:
    dict: T
</code></pre>
<p>or something. I guess I want to put <code>Get</code> (or maybe <code>Access</code>?) in here somewhere, but I&#x27;m not coming up with any great ideas. What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/codes.rs</code>:1027 on 2025-06-04 18:56</div>
            <div class="timeline-body"><p>I hate to say this because I know it&#x27;s painful to renumber rules, but <a href="https://github.com/astral-sh/ruff/pull/17368">astral-sh/ruff#17368</a> is also using RUF061, and <a href="https://github.com/astral-sh/ruff/pull/17281">astral-sh/ruff#17281</a> is using RUF062. Would you mind renumbering to RUF063?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:102 on 2025-06-04 19:03</div>
            <div class="timeline-body"><p>nit: I think these trailing comments are a bit redundant with the <code>1. ...</code>, <code>2. ...</code> style comments above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:119 on 2025-06-04 19:05</div>
            <div class="timeline-body"><p>nit: I&#x27;d probably convert this part into an early return:</p>
<pre><code>    if !call.arguments.keywords.is_empty() || call.arguments.len() &gt; 2 {
        return;
    }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:132 on 2025-06-04 19:10</div>
            <div class="timeline-body"><p>Then you can also do something like this:</p>
<pre><code>    let Some(first_arg) = &amp;call.arguments.find_positional(0) else {
        return;
    };

    let is_first_arg_correct = first_arg
        .as_string_literal_expr()
        .is_some_and(|s| s.value.to_str() == &quot;__annotations__&quot;);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:128 on 2025-06-04 19:11</div>
            <div class="timeline-body"><pre><code></code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-06-04 19:15</div>
            <div class="timeline-body"><p>Thanks, this is looking great overall! I just have a few stylistic nits/suggestions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 19:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:102 on 2025-06-08 19:31</div>
            <div class="timeline-body"><p>removed trailing comments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/codes.rs</code>:1027 on 2025-06-08 19:31</div>
            <div class="timeline-body"><p>renumbered to RUF063</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 19:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 19:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:132 on 2025-06-08 19:33</div>
            <div class="timeline-body"><p>thanks for this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 19:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/resources/test/fixtures/ruff/RUF061.py</code>:16 on 2025-06-08 19:34</div>
            <div class="timeline-body"><p>removed trailing comments on ones that should not trigger</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 20:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:92 on 2025-06-08 20:21</div>
            <div class="timeline-body"><p>that&#x27;s a great idea! I&#x27;ve implemented it in b5a45a8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:74 on 2025-06-08 20:40</div>
            <div class="timeline-body"><p>Thanks, that&#x27;s really helpful. How about using <code>GetAnnotationsFromClassDict</code> for the name?</p>
<p>Thinking more about your suggestion to use <code>Access</code> also made me wonder about a related case: should this rule also consider <code>foo.__dict__[&quot;__annotations__&quot;]</code>?</p>
<p>Curious what you think about both of those questions. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 20:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 20:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:70 on 2025-06-08 20:48</div>
            <div class="timeline-body"><p>Thanks, that makes sense. I had started working on fixes in this PR originally but pulled them out to keep this PR focused.</p>
<p>My plan is to create a ticket for it and handle it in an immediate follow-up PR. Does that sound good to you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-08 20:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:79 on 2025-06-08 20:49</div>
            <div class="timeline-body"><p>see <a href="https://github.com/astral-sh/ruff/pull/18233#discussion_r2134823374">comment</a> above</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-06-18 16:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:70 on 2025-06-18 16:50</div>
            <div class="timeline-body"><p>Yep, sounds good!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-06-18 16:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:74 on 2025-06-18 16:57</div>
            <div class="timeline-body"><p>I think <code>GetAnnotationsFromClassDict</code> sounds pretty good. I do like the simplicity of the current name, but a longer one is probably more precise and helpful.</p>
<p>And I think you&#x27;re right about <code>foo.__dict__[&quot;__annotations__&quot;]</code>. I tried both out in a Python 3.14 REPL, and they both seem to fail:</p>
<pre><code>&gt;&gt;&gt; class C:
...     x: int
...
&gt;&gt;&gt; C.__dict__.get(&quot;__annotations__&quot;)
&gt;&gt;&gt; C.__annotations__
{&#x27;x&#x27;: &lt;class &#x27;int&#x27;&gt;}
&gt;&gt;&gt; C.__dict__.get(&quot;__annotations__&quot;)
&gt;&gt;&gt; C.__dict__[&quot;__annotations__&quot;]
Traceback (most recent call last):
  File &quot;&lt;python-input-8&gt;&quot;, line 1, in &lt;module&gt;
    C.__dict__[&quot;__annotations__&quot;]
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
KeyError: &#x27;__annotations__&#x27;
</code></pre>
<p>whereas they both work on 3.13:</p>
<pre><code>&gt;&gt;&gt; class C:
...     x: int
...
&gt;&gt;&gt; C.__dict__[&quot;__annotations__&quot;]
{&#x27;x&#x27;: &lt;class &#x27;int&#x27;&gt;}
&gt;&gt;&gt; C.__dict__[&quot;__annotations__&quot;]
{&#x27;x&#x27;: &lt;class &#x27;int&#x27;&gt;}
&gt;&gt;&gt; C.__dict__.get(&quot;__annotations__&quot;)
{&#x27;x&#x27;: &lt;class &#x27;int&#x27;&gt;}
</code></pre>
<p>Hopefully it&#x27;s not too much work to check that too!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:88 on 2025-06-18 17:02</div>
            <div class="timeline-body"><p>Tiny nit: you could move <code>Use </code> to the <code>format!</code> call since it&#x27;s shared across these branches.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:141 on 2025-06-18 17:04</div>
            <div class="timeline-body"><p>I think you can unwrap this block, the braces might be left over from an earlier version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-06-18 17:06</div>
            <div class="timeline-body"><p>Thanks, this looks great! Just a couple of small nits, the merge conflicts, and possibly extending the rule to <code>__dict__[&quot;__annotations__&quot;]</code> as you said (and renaming). This is otherwise good to go!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-19 06:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:141 on 2025-06-19 06:43</div>
            <div class="timeline-body"><p>this should be resolved with the latest commits</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-19 06:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:88 on 2025-06-19 06:43</div>
            <div class="timeline-body"><p>this should be resolved with the latest commits</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-19 06:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:74 on 2025-06-19 06:57</div>
            <div class="timeline-body"><p>Thanks for confirming the behavior on different Python versions!</p>
<p>When I went to add the check for <code>foo.__dict__[&quot;__annotations__&quot;]</code>, I ended up splitting the logic into <code>access_annotations_from_class_dict_with_get</code> and <code>access_annotations_from_class_dict_by_key</code> to handle both access methods. At that point, <code>AccessAnnotationsFromClassDict</code> felt like a more fitting name, so I went with that.</p>
<p>Let me know what you think of this approach. I wasn&#x27;t aware of an existing pattern for handling two different scenarios, so I&#x27;m happy to refactor if you have a better idea!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dericcrago">@dericcrago</a> on <code>crates/ruff_linter/src/rules/ruff/rules/class_dict_annotations.rs</code>:70 on 2025-06-19 07:10</div>
            <div class="timeline-body"><p>Created #18785</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dericcrago">@dericcrago</a> reviewed on 2025-06-19 07:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/ntBre">@ntBre</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-19 14:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-06-20 13:27</div>
            <div class="timeline-body"><p>This is great, thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Added `cls.__dict__.get(&#x27;__annotations__&#x27;)` check&quot; to &quot;[`ruff`] Added `cls.__dict__.get(&#x27;__annotations__&#x27;)` check (`RUF063`)&quot; by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-20 13:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-20 13:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-20 13:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-06-20 13:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:14:48 UTC
    </footer>
</body>
</html>
