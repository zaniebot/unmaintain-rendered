<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enable callers to specify import-style preferences in `Importer` - astral-sh/ruff #4717</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Enable callers to specify import-style preferences in <code>Importer</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/4717">#4717</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-05-30 01:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>When we go through the <code>Importer</code> flow, to get or import a symbol from an external module during an autofix, if the symbol isn't present in the scope, then we try to add an import to bring it into scope. At present, we always use an <code>import</code> statement for this, but sometimes, it might be more conventional to use an <code>import from</code>.</p>
<p>For example, when importing symbols from typing, it's more conventional to <code>from typing import List</code> than <code>import typing; typing.List</code>. This will be especially relevant when importing <code>TYPE_CHECKING</code> from <code>typing</code> for <code>flake8-type-checking</code> autofixes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @charliermarsh on 2023-05-30 01:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2023-05-30 01:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-05-30 01:51</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Ecosystem</h3>
<p>✅ ecosystem check detected no changes.</p>
<h3>Benchmark</h3>
<h4>Linux</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
linter/all-rules/large/dataset.py          1.01     14.2±0.11ms     2.9 MB/sec    1.00     14.0±0.09ms     2.9 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      3.4±0.01ms     4.9 MB/sec    1.00      3.4±0.00ms     4.9 MB/sec
linter/all-rules/numpy/globals.py          1.00    427.8±0.95µs     6.9 MB/sec    1.00    426.4±1.00µs     6.9 MB/sec
linter/all-rules/pydantic/types.py         1.00      5.9±0.01ms     4.3 MB/sec    1.00      5.9±0.01ms     4.3 MB/sec
linter/default-rules/large/dataset.py      1.00      6.8±0.02ms     6.0 MB/sec    1.00      6.8±0.02ms     6.0 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00   1502.2±1.81µs    11.1 MB/sec    1.00   1503.9±9.99µs    11.1 MB/sec
linter/default-rules/numpy/globals.py      1.01    171.6±0.30µs    17.2 MB/sec    1.00    170.3±0.68µs    17.3 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.1±0.01ms     8.2 MB/sec    1.00      3.1±0.02ms     8.2 MB/sec
parser/large/dataset.py                    1.00      5.1±0.01ms     7.9 MB/sec    1.01      5.2±0.00ms     7.9 MB/sec
parser/numpy/ctypeslib.py                  1.00   1014.7±0.53µs    16.4 MB/sec    1.01   1020.3±0.84µs    16.3 MB/sec
parser/numpy/globals.py                    1.00    105.1±0.19µs    28.1 MB/sec    1.00    105.6±0.17µs    27.9 MB/sec
parser/pydantic/types.py                   1.00      2.2±0.01ms    11.5 MB/sec    1.00      2.2±0.00ms    11.4 MB/sec
</code></pre>
<h4>Windows</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
linter/all-rules/large/dataset.py          1.01     19.9±1.00ms     2.0 MB/sec    1.00     19.8±0.83ms     2.1 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.06      5.3±0.25ms     3.2 MB/sec    1.00      4.9±0.21ms     3.4 MB/sec
linter/all-rules/numpy/globals.py          1.05   624.6±27.79µs     4.7 MB/sec    1.00   595.3±43.27µs     5.0 MB/sec
linter/all-rules/pydantic/types.py         1.10      8.9±0.42ms     2.9 MB/sec    1.00      8.1±0.90ms     3.1 MB/sec
linter/default-rules/large/dataset.py      1.01      9.4±0.51ms     4.3 MB/sec    1.00      9.3±0.36ms     4.4 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1977.6±79.84µs     8.4 MB/sec    1.05      2.1±0.12ms     8.0 MB/sec
linter/default-rules/numpy/globals.py      1.01   244.2±14.82µs    12.1 MB/sec    1.00   242.8±13.55µs    12.2 MB/sec
linter/default-rules/pydantic/types.py     1.00      4.3±0.20ms     5.9 MB/sec    1.02      4.4±0.28ms     5.8 MB/sec
parser/large/dataset.py                    1.34      9.9±0.44ms     4.1 MB/sec    1.00      7.4±0.40ms     5.5 MB/sec
parser/numpy/ctypeslib.py                  1.06  1603.0±91.04µs    10.4 MB/sec    1.00  1508.6±89.19µs    11.0 MB/sec
parser/numpy/globals.py                    1.20   174.6±10.40µs    16.9 MB/sec    1.00    146.0±7.00µs    20.2 MB/sec
parser/pydantic/types.py                   1.17      3.9±0.15ms     6.5 MB/sec    1.00      3.3±0.17ms     7.6 MB/sec
</code></pre>
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff/src/importer/mod.rs</code>:154 on 2023-05-30 06:20</div>
            <div class="timeline-body"><p>Should this now return a <code>ImportableSymbol</code> instead of a <code>string</code> or some other enum denoting the used import style? Or is this not possible, because of aliases?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff/src/importer/mod.rs</code>:273 on 2023-05-30 06:25</div>
            <div class="timeline-body"><p>I like the <code>API</code> but find the name <code>ImportableSymbol</code> somewhat confusing because two symbols for the same <code>module</code> and <code>member</code> should compare equal, even if they use different import styles.</p>
<p>I guess another way to think about it. The qualifying information that defines a symbol is the <code>module</code> and the <code>member</code>. The style only denotes on how a missing import should be added.</p>
<p>Should we just call this <code>MemberImport</code> (or <code>ImportMember</code>) or even <code>Import</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2023-05-30 06:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff/src/importer/mod.rs</code>:273 on 2023-05-30 15:02</div>
            <div class="timeline-body"><p><code>ImportRequest</code> maybe? Since it's less describing a symbol and more &quot;please make an import for this symbol with this preference&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2023-05-30 15:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/importer/mod.rs</code>:154 on 2023-05-30 16:07</div>
            <div class="timeline-body"><p>(It's not possible due to aliasing.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-30 16:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-05-30 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-05-30 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-05-30 16:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:57:42 UTC
    </footer>
</body>
</html>
