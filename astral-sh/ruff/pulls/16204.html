<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New rule in flake8-tidy-imports for banning specific function calls - astral-sh/ruff #16204</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>New rule in flake8-tidy-imports for banning specific function calls</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16204">#16204</a>
        opened by <a href="https://github.com/kujenga">@kujenga</a>
        on 2025-02-17 03:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/kujenga">@kujenga</a> on 2025-02-17 03:49</div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>This commit introduces a new lint rule (TID254) that flags forbidden function calls, such as <code>os.system</code> and <code>os.popen</code>, in alignment with a project’s banned functions configuration. Highlights include:</p>
<ul>
<li>Creating the <code>BannedFunction</code> rule to detect and report banned function calls.</li>
<li>Updating error code mappings to reference TID254.</li>
<li>Adding new configuration options (<code>banned_functions</code>) within <code>flake8_tidy_imports</code>.</li>
<li>Providing a new test fixture (<code>TID254.py</code>) and snapshot to verify detection.</li>
<li>Ensuring seamless integration with expression analysis in the AST checker.</li>
</ul>
<!-- What's the purpose of the change? What does it do, and why? -->

<p>This was requested here: https://github.com/astral-sh/ruff/discussions/9236 and I have encountered some use cases for this as well.</p>
<p>While this is not technically part of the <code>flake8-tidy-imports</code> module it seemed like the closest fit from the current set of them.</p>
<p>n.b. I don't have a huge amount of rust experience, and this was implemented with significant assistance from llms so please let me know if anything looks off!</p>
<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>Tests were added modeled off of TID251 for banned APIs to cover a variety of cases as outlined in the test file.</p>
<p>I also verified this against another codebase with a release build of ruff and it seems to be working as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-02-17 06:22</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-02-17 10:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2025-02-17 10:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2025-02-17 10:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-02-17 10:21</div>
            <div class="timeline-body"><p>We'll have to look into how this rule plays with the banned API rule and what happens if there are conflicting configurations or if it woudl be better to extend the existing banned api rule instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kujenga">@kujenga</a> on 2025-02-17 16:05</div>
            <div class="timeline-body"><p>I can definitely see that being a cleaner design! Trying to do this sort of thing with that rule, and being unable to do so, is what lead me down this path. I wasn't sure how backward compatibility might factor in with changing that one, but happy to re-work this if that seems like a better end state here!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kujenga">@kujenga</a> on 2025-03-06 22:25</div>
            <div class="timeline-body"><p>@MichaReiser any thoughts on the path forward for this? Is expanding the existing rule preferred?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-07 08:11</div>
            <div class="timeline-body"><p>Sorry, I haven't had time to look into this yet. It may be a while before someone from the team has the time to make a decision here because we want to focus our attention on solving fundamental problems over adding new rules.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 19:49:30 UTC
    </footer>
</body>
</html>
