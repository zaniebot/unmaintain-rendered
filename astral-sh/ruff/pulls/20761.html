<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] `dataclass_transform`: Support `frozen_default` and `kw_only_default` - astral-sh/ruff #20761</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] <code>dataclass_transform</code>: Support <code>frozen_default</code> and <code>kw_only_default</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/20761">#20761</a>
        opened by <a href="https://github.com/fatelei">@fatelei</a>
        on 2025-10-08 10:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/fatelei">@fatelei</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<ul>
<li>Add support for eq, kw_only, and frozen parameter overrides in @dataclass_transform</li>
<li>Previously only order parameter override was supported</li>
<li>Update test documentation to reflect fixed behavior</li>
<li>Resolves issue where kw_only_default and frozen_default could not be overridden</li>
</ul>
<p>closes https://github.com/astral-sh/ty/issues/1260</p>
<h2>Test Plan</h2>
<p>New Markdown tests</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @fatelei on 2025-10-08 10:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @fatelei on 2025-10-08 10:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @fatelei on 2025-10-08 10:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @fatelei on 2025-10-08 10:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Fix dataclass_transform parameter overrides for kw_only and frozen" to "[ty] Fix dataclass_transform parameter overrides for kw_only and frozen" by @AlexWaygood on 2025-10-08 10:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @AlexWaygood on 2025-10-08 10:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-08 10:22</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2>Diagnostic diff on <a href="https://github.com/python/typing/tree/d4f39b27a4a47aac8b6d4019e1b0b5b3156fabdc/conformance">typing conformance tests</a></h2>
<details>
<summary>Changes were detected when running ty on typing conformance tests</summary>

<pre><code class="language-diff">--- old-output.txt	2025-10-09 07:21:50.600268550 +0000
+++ new-output.txt	2025-10-09 07:21:53.895289947 +0000
@@ -284,8 +284,6 @@
 dataclasses_transform_converter.py:130:31: error[invalid-argument-type] Argument to function `model_field` is incorrect: Expected `(Literal[1], /) -&gt; int`, found `def converter_simple(s: str) -&gt; int`
 dataclasses_transform_field.py:49:43: error[invalid-return-type] Function always implicitly returns `None`, which is not assignable to return type `(...) -&gt; @Todo(unsupported type[X] special form)`
 dataclasses_transform_field.py:75:16: error[too-many-positional-arguments] Too many positional arguments: expected 0, got 1
-dataclasses_transform_func.py:53:8: error[missing-argument] No arguments provided for required parameters `id`, `name`
-dataclasses_transform_func.py:53:18: error[too-many-positional-arguments] Too many positional arguments: expected 0, got 2
 dataclasses_transform_func.py:57:1: error[invalid-assignment] Object of type `Literal[3]` is not assignable to attribute `name` of type `str`
 dataclasses_transform_func.py:61:6: error[unsupported-operator] Operator `&lt;` is not supported for types `Customer1` and `Customer1`
 dataclasses_transform_func.py:65:36: error[unknown-argument] Argument `salary` does not match any known parameter
@@ -898,5 +896,5 @@
 typeddicts_usage.py:28:17: error[missing-typed-dict-key] Missing required key 'name' in TypedDict `Movie` constructor
 typeddicts_usage.py:28:18: error[invalid-key] Invalid key access on TypedDict `Movie`: Unknown key &quot;title&quot;
 typeddicts_usage.py:40:24: error[invalid-type-form] The special form `typing.TypedDict` is not allowed in type expressions. Did you mean to use a concrete TypedDict or `collections.abc.Mapping[str, object]` instead?
-Found 899 diagnostics
+Found 897 diagnostics
 WARN A fatal error occurred while checking some files. Not all project files were analyzed. See the diagnostics list above for details.
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-10-08 10:22</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">attrs (https://github.com/python-attrs/attrs)
+ tests/dataclass_transform_example.py:43:1: error[invalid-assignment] Property `a` defined in `FrozenDefine` is read-only
+ tests/test_annotations.py:448:13: error[missing-argument] No arguments provided for required parameters `x`, `y`
+ tests/test_annotations.py:448:15: error[too-many-positional-arguments] Too many positional arguments: expected 0, got 2
+ tests/test_functional.py:332:13: error[invalid-assignment] Property `x` defined in `SubFrozen` is read-only
- Found 557 diagnostics
+ Found 561 diagnostics

Expression (https://github.com/cognitedata/Expression)
- tests/test_tagged_union.py:93:38: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- Found 212 diagnostics
+ Found 211 diagnostics

</code></pre>
</details>
No memory usage changes detected âœ…

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> approved on 2025-10-09 07:18</div>
            <div class="timeline-body"><p>Thank you very much!</p>
<p>I made some minor changes myself, such as using the new <code>parameter_type_by_name</code> helper, that I just introduced yesterday.</p>
<p>The ecosystem changes are all true positives! (appear within <code>with pytest.raises(TypeError):</code> blocks)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[ty] Fix dataclass_transform parameter overrides for kw_only and frozen" to "[ty] `dataclass_transform`: Support `frozen_default` and `kw_only_default`" by @sharkdp on 2025-10-09 07:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @sharkdp on 2025-10-09 07:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sharkdp on 2025-10-09 07:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:16:17 UTC
    </footer>
</body>
</html>
