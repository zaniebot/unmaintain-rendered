<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `RUFF_OUTPUT_FILE` environment variable support - astral-sh/ruff #10992</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>RUFF_OUTPUT_FILE</code> environment variable support</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10992">#10992</a>
        opened by <a href="https://github.com/sisp">@sisp</a>
        on 2024-04-17 10:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sisp">@sisp</a></div>
            <div class="timeline-body">Summary
<p>I&#x27;ve added support for configuring the <code>ruff check</code> output file via the environment variable <code>RUFF_OUTPUT_FILE</code> akin to #1731.</p>
<p>This is super useful when, e.g., generating a <a href="https://docs.gitlab.com/ee/ci/testing/code_quality.html#implement-a-custom-tool">GitLab code quality report</a> while running Ruff as a pre-commit hook. Usually, <code>ruff check</code> should print its human-readable output to <code>stdout</code>, but when run through <code>pre-commit</code> <em>in a GitLab CI job</em> it should write its output in <code>gitlab</code> format to a file. So, to override these two settings only during CI, environment variables come handy, and <code>RUFF_OUTPUT_FORMAT</code> already exists but <code>RUFF_OUTPUT_FILE</code> has been missing.</p>
<p>A (simplified) GitLab CI job config for this scenario might look like this:</p>
<pre><code>pre-commit:
  stage: test
  image: python
  variables:
    RUFF_OUTPUT_FILE: gl-code-quality-report.json
    RUFF_OUTPUT_FORMAT: gitlab
  before_script:
    - pip install pre-commit
  script:
    - pre-commit run --all-files --show-diff-on-failure
  artifacts:
    reports:
      codequality: gl-code-quality-report.json
</code></pre>
Test Plan
<p>I tested it manually.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-04-17 10:47</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-17 15:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-04-17 15:42</div>
            <div class="timeline-body"><p>This seems reasonable to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-17 15:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-17 15:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-04-17 16:09</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:03:30 UTC
    </footer>
</body>
</html>
