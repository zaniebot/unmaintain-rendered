<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[airflow] Avoid implicit DAG schedule (AIR301) - astral-sh/ruff #14581</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[airflow] Avoid implicit DAG schedule (AIR301)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14581">#14581</a>
        opened by <a href="https://github.com/uranusjr">@uranusjr</a>
        on 2024-11-25 07:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a></div>
            <div class="timeline-body">Summary
<p>Airflow 3.0 changes the default of the &#x27;schedule&#x27; argument. This causes incompatibility if a DAG previously does not specify a schedule explicitly. This is against best practice anyway---you should always prefer to set a schedule explicitly.</p>
<p>Due to backward compatibility, Airflow 2 also possesses multiple arguments to set the schedule. These are all being combined into &#x27;schedule&#x27; in 3.0. Usages of those old arguments are also detected.</p>
Test Plan
<p>A test fixture has been included for the rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[airflow] Avoid implicit DAG schedule (AIR002)&quot; to &quot;[airflow] Avoid implicit DAG schedule (AIR301)&quot; by <a href="https://github.com/uranusjr">@uranusjr</a> on 2024-11-25 07:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-25 07:38</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+35 -0 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+35 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/airflow/models/dag.py#L296">airflow/models/dag.py:296:16:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/performance/src/performance_dags/performance_dag/performance_dag.py#L230">performance/src/performance_dags/performance_dag/performance_dag.py:230:11:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/arangodb/example_dags/example_arangodb.py#L25">providers/src/airflow/providers/arangodb/example_dags/example_arangodb.py:25:7:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/cloud/example_dags/example_cloud_task.py#L41">providers/src/airflow/providers/google/cloud/example_dags/example_cloud_task.py:41:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/cloud/example_dags/example_facebook_ads_to_gcs.py#L61">providers/src/airflow/providers/google/cloud/example_dags/example_facebook_ads_to_gcs.py:61:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/cloud/example_dags/example_looker.py#L31">providers/src/airflow/providers/google/cloud/example_dags/example_looker.py:31:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/cloud/example_dags/example_presto_to_gcs.py#L52">providers/src/airflow/providers/google/cloud/example_dags/example_presto_to_gcs.py:52:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/cloud/example_dags/example_salesforce_to_gcs.py#L47">providers/src/airflow/providers/google/cloud/example_dags/example_salesforce_to_gcs.py:47:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/marketing_platform/example_dags/example_display_video.py#L124">providers/src/airflow/providers/google/marketing_platform/example_dags/example_display_video.py:124:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/marketing_platform/example_dags/example_display_video.py#L172">providers/src/airflow/providers/google/marketing_platform/example_dags/example_display_video.py:172:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/google/marketing_platform/example_dags/example_display_video.py#L91">providers/src/airflow/providers/google/marketing_platform/example_dags/example_display_video.py:91:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/src/airflow/providers/oracle/example_dags/example_oracle.py#L25">providers/src/airflow/providers/oracle/example_dags/example_oracle.py:25:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/google/cloud/operators/test_looker.py#L47">providers/tests/google/cloud/operators/test_looker.py:47:19:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/google/cloud/utils/airflow_util.py#L54">providers/tests/google/cloud/utils/airflow_util.py:54:15:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/google/cloud/utils/test_mlengine_operator_utils.py#L64">providers/tests/google/cloud/utils/test_mlengine_operator_utils.py:64:12:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/integration/mongo/sensors/test_mongo.py#L49">providers/tests/integration/mongo/sensors/test_mongo.py:49:20:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/integration/qdrant/operators/test_qdrant_ingest.py#L38">providers/tests/integration/qdrant/operators/test_qdrant_ingest.py:38:20:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/integration/redis/sensors/test_redis_key.py#L35">providers/tests/integration/redis/sensors/test_redis_key.py:35:20:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/integration/redis/sensors/test_redis_pub_sub.py#L38">providers/tests/integration/redis/sensors/test_redis_pub_sub.py:38:20:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/integration/ydb/operators/test_ydb.py#L51">providers/tests/integration/ydb/operators/test_ydb.py:51:20:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/system/apache/kafka/example_dag_event_listener.py#L85">providers/tests/system/apache/kafka/example_dag_event_listener.py:85:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/system/asana/example_asana.py#L49">providers/tests/system/asana/example_asana.py:49:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/providers/tests/system/google/cloud/cloud_functions/example_functions.py#L81">providers/tests/system/google/cloud/cloud_functions/example_functions.py:81:6:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/dags/super_basic.py#L24">task_sdk/tests/dags/super_basic.py:24:2:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/dags/super_basic_run.py#L30">task_sdk/tests/dags/super_basic_run.py:30:2:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/defintions/test_baseoperator.py#L283">task_sdk/tests/defintions/test_baseoperator.py:283:23:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/defintions/test_baseoperator.py#L352">task_sdk/tests/defintions/test_baseoperator.py:352:10:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/defintions/test_baseoperator.py#L359">task_sdk/tests/defintions/test_baseoperator.py:359:10:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/defintions/test_dag.py#L296">task_sdk/tests/defintions/test_dag.py:296:9:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/defintions/test_dag.py#L339">task_sdk/tests/defintions/test_dag.py:339:14:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/task_sdk/tests/defintions/test_dag.py#L345">task_sdk/tests/defintions/test_dag.py:345:16:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/tests/jobs/test_scheduler_job.py#L6434">tests/jobs/test_scheduler_job.py:6434:16:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/tests/models/test_dag.py#L2855">tests/models/test_dag.py:2855:10:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/tests/serialization/test_serialized_objects.py#L218">tests/serialization/test_serialized_objects.py:218:47:</a> AIR301 DAG should have an explicit `schedule` argument
+ <a href="https://github.com/apache/airflow/blob/a832c418f351d201656d685f57d400eee65925a2/tests/utils/test_log_handlers.py#L273">tests/utils/test_log_handlers.py:273:15:</a> AIR301 DAG should have an explicit `schedule` argument
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| AIR301 | 35 | 35 | 0 | 0 | 0 |</p>
</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:11 on 2024-11-25 09:54</div>
            <div class="timeline-body"><pre><code>/// Checks that the `DAG()` class or a `@dag()` decorator without an explicit
/// `schedule` parameter.
</code></pre>
<p>It then reads better with <em>Why is this bad</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:17 on 2024-11-25 09:55</div>
            <div class="timeline-body"><p>Can we tell a bit more about <em>how</em> it breaks existing DAGS that use the implicit default. Will it fail with an exception or is it just that the default is different?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-25 09:57</div>
            <div class="timeline-body"><p>I&#x27;m a bit torn about whether this is something that belongs to this rule or it is a better fit for the <code>Airflow3Deprecation</code> rule. I can see how it fits here because it is <code>DAG</code> related but it feels a bit out of scope reading through the rule&#x27;s description (It isn&#x27;t mentioned at all in the <em>What it does</em> section)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:94 on 2024-11-25 09:59</div>
            <div class="timeline-body"><p>Nit:</p>
<pre><code>            .is_some_and(|arg| matches!(arg, &quot;timetable&quot; | &quot;schedule_interval&quot;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-25 09:59</div>
            <div class="timeline-body"><p>This overall looks good to me, but I think we have to figure out the right scoping for all the Airflow3 deprecation rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-25 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-25 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-11-25 10:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-25 10:55</div>
            <div class="timeline-body"><p>I agree with the assessment TBH. No opinions from me, I can do either.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-25 12:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-25 12:01</div>
            <div class="timeline-body"><p>I&#x27;ve a slight preference to move it into the other deprecation rule or make it its own rule.</p>
<p>For my understanding, are <code>schedule_interval</code>, and <code>timetable</code> now deprecated or have they been deprecated and were removed as part of airflow 3? Depending on the answer, I think a separate rule makes more sense</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-11-26 08:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-26 08:32</div>
            <div class="timeline-body"><p>They have been deprecated for a while, and removed as a part of 3.0.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-11-26 08:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:17 on 2024-11-26 08:51</div>
            <div class="timeline-body"><p>Just the default is different—your DAGs will simply stop doing anything silently. I’ll add a paragraph to call this out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-11-26 08:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:94 on 2024-11-26 08:56</div>
            <div class="timeline-body"><p>I needed to do a conversion since <code>arg</code> is <code>&amp;Identifier</code> and can’t be matched to <code>&amp;str</code> as-is. Hope that’s good enough.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-26 09:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-26 09:20</div>
            <div class="timeline-body"><p>I suggest moving them to a separate rule. Maybe one that catches all Airflow 3 removals?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-11-26 10:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-26 10:11</div>
            <div class="timeline-body"><p>Got it, I’ll move them to #14582 (AIR302) then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/dag_schedule_argument.rs</code>:20 on 2024-11-26 10:23</div>
            <div class="timeline-body"><p>Alright done.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-11-26 10:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-11-26 12:38</div>
            <div class="timeline-body"><p>This is great. Thank you :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-26 12:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-26 12:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:08:48 UTC
    </footer>
</body>
</html>
