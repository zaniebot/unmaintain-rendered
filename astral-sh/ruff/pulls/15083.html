<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`airflow`] Extend rule to check class attributes, methods, arguments (`AIR302`) - astral-sh/ruff #15083</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>airflow</code>] Extend rule to check class attributes, methods, arguments (<code>AIR302</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15083">#15083</a>
        opened by <a href="https://github.com/Lee-W">@Lee-W</a>
        on 2024-12-20 14:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>Airflow 3.0 removes various deprecated functions, members, modules, and other values. They have been deprecated in 2.x, but the removal causes incompatibilities that we want to detect. This PR add rules for the following.</p>
<ul>
<li>Removed class attribute<ul>
<li><code>airflow.providers_manager.ProvidersManager.dataset_factories</code> ‚Üí <code>airflow.providers_manager.ProvidersManager.asset_factories</code></li>
<li><code>airflow.providers_manager.ProvidersManager.dataset_uri_handlers</code> ‚Üí <code>airflow.providers_manager.ProvidersManager.asset_uri_handlers</code></li>
<li><code>airflow.providers_manager.ProvidersManager.dataset_to_openlineage_converters</code> ‚Üí <code>airflow.providers_manager.ProvidersManager.asset_to_openlineage_converters</code></li>
<li><code>airflow.lineage.hook.DatasetLineageInfo.dataset</code>  ‚Üí <code>airflow.lineage.hook.AssetLineageInfo.asset</code></li>
</ul>
</li>
<li>Removed class method (subclasses in airflow should also checked)<ul>
<li><code>airflow.secrets.base_secrets.BaseSecretsBackend.get_conn_uri</code> ‚Üí <code>airflow.secrets.base_secrets.BaseSecretsBackend.get_conn_value</code></li>
<li><code>airflow.secrets.base_secrets.BaseSecretsBackend.get_connections</code> ‚Üí <code>airflow.secrets.base_secrets.BaseSecretsBackend.get_connection</code></li>
<li><code>airflow.hooks.base.BaseHook.get_connections</code> ‚Üí use <code>get_connection</code></li>
<li><code>airflow.datasets.BaseDataset.iter_datasets</code> ‚Üí <code>airflow.sdk.definitions.asset.BaseAsset.iter_assets</code></li>
<li><code>airflow.datasets.BaseDataset.iter_dataset_aliases</code> ‚Üí <code>airflow.sdk.definitions.asset.BaseAsset.iter_asset_aliases</code></li>
</ul>
</li>
<li>Removed constructor args (subclasses in airflow should also checked)<ul>
<li>argument <code>filename_template</code> in<code>airflow.utils.log.file_task_handler.FileTaskHandler</code></li>
<li>in <code>BaseOperator</code><ul>
<li><code>sla</code></li>
<li><code>task_concurrency</code> ‚Üí <code>max_active_tis_per_dag</code></li>
</ul>
</li>
<li>in <code>BaseAuthManager</code><ul>
<li><code>appbuilder</code></li>
</ul>
</li>
</ul>
</li>
<li>Removed class variable (subclasses anywhere should be checked)<ul>
<li>in <code>airflow.plugins_manager.AirflowPlugin</code><ul>
<li><code>executors</code> (from #43289)</li>
<li><code>hooks</code></li>
<li><code>operators</code></li>
<li><code>sensors</code></li>
</ul>
</li>
</ul>
</li>
<li>Replaced names<ul>
<li><code>airflow.hooks.base_hook.BaseHook</code> ‚Üí <code>airflow.hooks.base.BaseHook</code></li>
<li><code>airflow.operators.dagrun_operator.TriggerDagRunLink</code> ‚Üí <code>airflow.operators.trigger_dagrun.TriggerDagRunLink</code></li>
<li><code>airflow.operators.dagrun_operator.TriggerDagRunOperator</code> ‚Üí <code>airflow.operators.trigger_dagrun.TriggerDagRunOperator</code></li>
<li><code>airflow.operators.python_operator.BranchPythonOperator</code> ‚Üí <code>airflow.operators.python.BranchPythonOperator</code></li>
<li><code>airflow.operators.python_operator.PythonOperator</code> ‚Üí <code>airflow.operators.python.PythonOperator</code></li>
<li><code>airflow.operators.python_operator.PythonVirtualenvOperator</code> ‚Üí <code>airflow.operators.python.PythonVirtualenvOperator</code></li>
<li><code>airflow.operators.python_operator.ShortCircuitOperator</code> ‚Üí <code>airflow.operators.python.ShortCircuitOperator</code></li>
<li><code>airflow.operators.latest_only_operator.LatestOnlyOperator</code> ‚Üí <code>airflow.operators.latest_only.LatestOnlyOperator</code></li>
</ul>
</li>
</ul>
<p>In additional to the changes above, this PR also add utility functions and improve docstring.</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>A test fixture is included in the PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[airflow]: extend removed method class attributes and more methods(AIR302)" to "[airflow]: extend removed method class attributes and more methods (AIR302)" by @Lee-W on 2024-12-20 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-12-20 14:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:396 on 2024-12-20 14:50</div>
            <div class="timeline-body"><p>It should be possible to simplify the regex a bit (to ensure it runs less frequently?)</p>
<pre><code class="language-suggestion">			[&quot;airflow&quot;, rest @ ..] if SECRET_BACKEND_REGEX.is_match(rest.join(&quot;.&quot;)) =&gt; match attr.as_str() {
            &quot;get_conn_uri&quot; =&gt; Some(Replacement::Name(&quot;get_conn_value&quot;)),
            &quot;get_connections&quot; =&gt; Some(Replacement::Name(&quot;get_connection&quot;)),
            &amp;_ =&gt; None,
        },
</code></pre>
<p>This requires removing the <code>airflow</code> segment from the regex. The advantage is that we can skip over the match if the first segment isn't airflow</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-12-20 14:52</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚úÖ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+7 -0 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+7 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/alibaba/cloud/log/test_oss_task_handler.py#L189'>providers/tests/alibaba/cloud/log/test_oss_task_handler.py:189:67:</a> AIR302 `filename_template` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/amazon/aws/log/test_cloudwatch_task_handler.py#L244'>providers/tests/amazon/aws/log/test_cloudwatch_task_handler.py:244:13:</a> AIR302 `filename_template` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/amazon/aws/log/test_s3_task_handler.py#L232'>providers/tests/amazon/aws/log/test_s3_task_handler.py:232:70:</a> AIR302 `filename_template` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/elasticsearch/log/test_es_task_handler.py#L673'>providers/tests/elasticsearch/log/test_es_task_handler.py:673:13:</a> AIR302 `filename_template` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/fab/auth_manager/test_fab_auth_manager.py#L87'>providers/tests/fab/auth_manager/test_fab_auth_manager.py:87:26:</a> AIR302 `appbuilder` is removed in Airflow 3.0; The constructor takes no parameter now.
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/google/cloud/log/test_gcs_task_handler.py#L295'>providers/tests/google/cloud/log/test_gcs_task_handler.py:295:13:</a> AIR302 `filename_template` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/52ed7d72e9669a7bdfaf11caeea6daa29911bc8f/providers/tests/microsoft/azure/log/test_wasb_task_handler.py#L211'>providers/tests/microsoft/azure/log/test_wasb_task_handler.py:211:13:</a> AIR302 `filename_template` is removed in Airflow 3.0
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| AIR302 | 7 | 7 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-24 06:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:16 on 2024-12-24 06:02</div>
            <div class="timeline-body"><p>Can you say more about these imports? Is it that certain methods (<code>get_conn_uri</code>, <code>get_connections</code>) in <code>Backend</code> / <code>Hook</code> classes are deprecated? Can these classes come from <em>anywhere</em>? Or, should it be limited to from either the <code>airflow.{secrets,hooks}</code> module or one of the provider module? I'm asking this mainly by referring to the test cases.</p>
<p>If it can only come from either the <code>airflow.{secrets,hooks}</code> module or one of the provider module, then we can avoid regex similar to what we've done for <code>AIR001</code>:</p>
<p>https://github.com/astral-sh/ruff/blob/f0b03857a606e16974b119b6efad3766a11b0327/crates/ruff_linter/src/rules/airflow/rules/task_variable_name.rs#L69-L94</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dhruvmanila on 2024-12-24 06:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @dhruvmanila on 2024-12-24 06:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-24 23:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:16 on 2024-12-24 23:50</div>
            <div class="timeline-body"><blockquote>
<p>Is it that certain methods (get_conn_uri, get_connections) in Backend / Hook classes are deprecated?</p>
</blockquote>
<p>Yes</p>
<blockquote>
<p>Can these classes come from anywhere? Or, should it be limited to from either the airflow.{secrets,hooks} module or one of the provider module?</p>
</blockquote>
<p>Technically, it can come from anywhere, but we only want to check the airflow core and airflow providers' usage.</p>
<blockquote>
<p>If it can only come from either the airflow.{secrets,hooks} module or one of the provider module, then we can avoid regex similar to what we've done for AIR001:</p>
</blockquote>
<p>Yep, we probably could! Thanks for your review! Let me rewrite it this way</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-25 04:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:16 on 2024-12-25 04:01</div>
            <div class="timeline-body"><p>Just updated it. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-25 04:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:396 on 2024-12-25 04:01</div>
            <div class="timeline-body"><p>Just updated it with later comment. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dhruvmanila by @Lee-W on 2024-12-25 04:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @Lee-W on 2024-12-25 04:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2024-12-29 10:58</div>
            <div class="timeline-body"><p>@MichaReiser, Pinging in case we missed this one üôÇ Would be awesome if we could get this re-reviewed when bandwidth allowed. Thanks a lot!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:401 on 2024-12-30 08:32</div>
            <div class="timeline-body"><p>nit: I think we should just combine this in the catch-all like:</p>
<pre><code class="language-rs">if is_airflow_secret_backend(qualname.segments()) {
	// ...
} else if is_airflow_hook(&amp;qualname) {
	// ...
}
</code></pre>
<p>Assuming that these are mutually exclusive which I think it is as it's in separate match arms.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 08:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 08:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:244 on 2024-12-30 08:34</div>
            <div class="timeline-body"><p>nit: same argument as mentioned above to combine the various catch-all into a single <code>if else</code> block</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 08:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:14 on 2024-12-30 08:36</div>
            <div class="timeline-body"><p>Maybe we could combine all the functions into a single function and accept the changing variables? I think those are the module names and the ends_with value. What about the following?</p>
<pre><code class="language-rust">fn is_airflow_builtin_or_provider(segments: &amp;[&amp;str], module: &amp;str, symbol_suffix: &amp;str) -&gt; bool {
    match segments {
        [&quot;airflow&quot;, &quot;secrets&quot;, rest @ ..] =&gt; {
            if let Some(last_element) = rest.last() {
                last_element.ends_with(symbol_suffix)
            } else {
                false
            }
        }

        [&quot;airflow&quot;, &quot;providers&quot;, rest @ ..] =&gt; {
            if let (Some(pos), Some(last_element)) =
                (rest.iter().position(|&amp;s| s == module), rest.last())
            {
                pos + 1 &lt; rest.len() &amp;&amp; last_element.ends_with(symbol_suffix)
            } else {
                false
            }
        }

        _ =&gt; false,
    }
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-30 14:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:401 on 2024-12-30 14:11</div>
            <div class="timeline-body"><p>Sure! Updated!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-30 14:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:244 on 2024-12-30 14:11</div>
            <div class="timeline-body"><p>Sure! Updated!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-30 14:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:14 on 2024-12-30 14:12</div>
            <div class="timeline-body"><p>I tried to refactor the utility functions a bit. Please take a look when you're available. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dhruvmanila by @Lee-W on 2024-12-30 14:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 15:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:28 on 2024-12-30 15:22</div>
            <div class="timeline-body"><p>Should the <code>starts_with</code> be instead a <code>start_element == module</code> as I think we need to match the module exactly?</p>
<p>Also, I think this should be <code>&amp;&amp;</code> and not <code>&amp;</code> (bitwise AND) ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 15:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:28 on 2024-12-30 15:23</div>
            <div class="timeline-body"><p>The <code>&amp;&amp;</code> typo makes me wonder how come the tests failed to catch this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 15:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:28 on 2024-12-30 15:53</div>
            <div class="timeline-body"><p>I'm unable to push to this PR, so here's the change that I made locally to fix this and add some documentation:</p>
<pre><code class="language-diff">diff --git a/crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs b/crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs
index 0f6831317..592329fde 100644
--- a/crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs
+++ b/crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs
@@ -11,21 +11,35 @@ use ruff_text_size::Ranged;
 
 use crate::checkers::ast::Checker;
 
+/// Check whether the segments corresponding to the fully qualified name points to a symbol that's
+/// either a builtin or coming from one of the providers in Airflow.
+///
+/// The pattern it looks for are:
+/// - `airflow.providers.**.&lt;module&gt;.**.*&lt;symbol_suffix&gt;` for providers
+/// - `airflow.&lt;module&gt;.**.*&lt;symbol_suffix&gt;` for builtins
+///
+/// where `**` is one or more segments separated by a dot, and `*` is one or more characters.
+///
+/// Examples for the above patterns:
+/// - `airflow.providers.google.cloud.secrets.secret_manager.CloudSecretManagerBackend` (provider)
+/// - `airflow.secrets.base_secrets.BaseSecretsBackend` (builtin)
 fn is_airflow_builtin_or_provider(segments: &amp;[&amp;str], module: &amp;str, symbol_suffix: &amp;str) -&gt; bool {
     match segments {
         [&quot;airflow&quot;, &quot;providers&quot;, rest @ ..] =&gt; {
             if let (Some(pos), Some(last_element)) =
                 (rest.iter().position(|&amp;s| s == module), rest.last())
             {
+                // Check that the module is not the last element i.e., there's a symbol that's
+                // being used from the `module` that ends with `symbol_suffix`.
                 pos + 1 &lt; rest.len() &amp;&amp; last_element.ends_with(symbol_suffix)
             } else {
                 false
             }
         }
 
-        [&quot;airflow&quot;, rest @ ..] =&gt; {
-            if let (Some(start_element), Some(last_element)) = (rest.first(), rest.last()) {
-                start_element.starts_with(module) &amp; last_element.ends_with(symbol_suffix)
+        [&quot;airflow&quot;, first, rest @ ..] =&gt; {
+            if let Some(last) = rest.last() {
+                first == module &amp;&amp; last.ends_with(symbol_suffix)
             } else {
                 false
             }
@@ -35,18 +49,26 @@ fn is_airflow_builtin_or_provider(segments: &amp;[&amp;str], module: &amp;str, symbol_suffix
     }
 }
 
+/// Check whether the symbol is coming from the `secrets` builtin or provider module which ends
+/// with `Backend`.
 fn is_airflow_secret_backend(segments: &amp;[&amp;str]) -&gt; bool {
     is_airflow_builtin_or_provider(segments, &quot;secrets&quot;, &quot;Backend&quot;)
 }
 
+/// Check whether the symbol is coming from the `hooks` builtin or provider module which ends
+/// with `Hook`.
 fn is_airflow_hook(segments: &amp;[&amp;str]) -&gt; bool {
     is_airflow_builtin_or_provider(segments, &quot;hooks&quot;, &quot;Hook&quot;)
 }
 
+/// Check whether the symbol is coming from the `operators` builtin or provider module which ends
+/// with `Operator`.
 fn is_airflow_operator(segments: &amp;[&amp;str]) -&gt; bool {
     is_airflow_builtin_or_provider(segments, &quot;operators&quot;, &quot;Operator&quot;)
 }
 
+/// Check whether the symbol is coming from the `log` builtin or provider module which ends
+/// with `TaskHandler`.
 fn is_airflow_task_handler(segments: &amp;[&amp;str]) -&gt; bool {
     is_airflow_builtin_or_provider(segments, &quot;log&quot;, &quot;TaskHandler&quot;)
 }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-30 15:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:28 on 2024-12-30 15:54</div>
            <div class="timeline-body"><p>Additionally, as convention these helper functions would go at the bottom after the rule logic i.e., the rule definition would be up top and then the entrypoint to the rule logic and then all the helper structs and functions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-31 00:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:28 on 2024-12-31 00:53</div>
            <div class="timeline-body"><p>@dhruvmanila  Thanks! This helps a ton! Just updated it and add more docstring to each utility functions</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dhruvmanila by @Lee-W on 2024-12-31 00:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[airflow]: extend removed method class attributes and more methods (AIR302)" to "[`airflow`] Extend rule to check class attributes, methods, arguments (`AIR302`)" by @dhruvmanila on 2024-12-31 04:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> reviewed on 2024-12-31 04:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:112 on 2024-12-31 04:18</div>
            <div class="timeline-body"><p>In Rust, documentation comments starts with triple forward slashes (<code>///</code>). I'll update this in my planned follow-up PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-12-31 04:19</div>
            <div class="timeline-body"><p>Thank you!</p>
<p>I've a few minor nits but I can't push it to this branch, I'll create a follow-up PR instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dhruvmanila on 2024-12-31 04:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-12-31 04:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-31 07:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:112 on 2024-12-31 07:34</div>
            <div class="timeline-body"><p>Got it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2024-12-31 07:35</div>
            <div class="timeline-body"><blockquote>
<p>Thank you!</p>
<p>I've a few minor nits but I can't push it to this branch, I'll create a follow-up PR instead.</p>
</blockquote>
<p>Thanks a ton! Not sure why you cannot push to this branch üò¢ I read through the refactor PR. Everything looks much better! But I noticed there one minor typo and created a PR for this fix https://github.com/astral-sh/ruff/pull/15211</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-08 07:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:08:38 UTC
    </footer>
</body>
</html>
