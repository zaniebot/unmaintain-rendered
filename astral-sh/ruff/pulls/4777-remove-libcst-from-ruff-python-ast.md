```yaml
number: 4777
title: Remove libcst from ruff_python_ast
type: pull_request
state: closed
author: konstin
labels: []
assignees: []
base: codegen_state
head: no-libcst-dep
created_at: 2023-06-01T07:00:15Z
updated_at: 2023-06-12T12:37:22Z
url: https://github.com/astral-sh/ruff/pull/4777
synced_at: 2026-01-12T15:55:16Z
```

# Remove libcst from ruff_python_ast

---

_@konstin_

Follow-up/alternative to https://github.com/charliermarsh/ruff/pull/4749 we can either merge into it or discard.


---

_Comment by @konstin on 2023-06-01 07:00_

Current dependencies on/for this PR:
* main
  * **PR #4749** <a href="https://app.graphite.dev/github/pr/charliermarsh/ruff/4749" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a> 
    * **PR #4777** <a href="https://app.graphite.dev/github/pr/charliermarsh/ruff/4777" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/charliermarsh/ruff/4777?utm_source=stack-comment).

---

_Review comment by @MichaReiser on `crates/ruff/src/autofix/edits.rs`:174 on 2023-06-01 15:57_

The pattern always seems to be the same: We create a state and then call the `codegen` method on the node. Is there an opportunity to abstract away both steps

```rust
codegen(node, stylist)
```

---

_@MichaReiser reviewed on 2023-06-01 15:57_

---

_@MichaReiser reviewed on 2023-06-01 15:58_

---

_Review comment by @MichaReiser on `crates/ruff/src/autofix/edits.rs`:174 on 2023-06-01 15:58_

Another alternative would be to implement this using an extension trait. This way it could still be `stylist.codegen`. The downside is that users need to import the trait.

---

_Review comment by @charliermarsh on `crates/ruff/src/autofix/edits.rs`:174 on 2023-06-01 21:01_

`codegen(node, stylist)` seems reasonable to me.

---

_@charliermarsh reviewed on 2023-06-01 21:01_

---

_Closed by @konstin on 2023-06-02 14:34_

---

_Branch deleted on 2023-06-12 12:37_

---
