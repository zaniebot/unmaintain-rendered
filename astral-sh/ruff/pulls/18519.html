<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pyupgrade`] Stabilize `non-pep695-generic-class` (`UP046`) - astral-sh/ruff #18519</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pyupgrade</code>] Stabilize <code>non-pep695-generic-class</code> (<code>UP046</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/18519">#18519</a>
        opened by <a href="https://github.com/ntBre">@ntBre</a>
        on 2025-06-06 23:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<ul>
<li>Stabilizes UP046 (non-pep695-generic-class) rule by changing it from Preview to Stable</li>
</ul>
<h2>Test plan</h2>
<ul>
<li>✅ Rule is already tested in main test function, no migration needed</li>
<li>✅ <code>make check</code> passes</li>
<li>✅ <code>make test</code> passes</li>
</ul>
<h2>Rule Documentation</h2>
<ul>
<li><a href="https://github.com/astral-sh/ruff/blob/main/crates/ruff_linter/src/rules/pyupgrade/mod.rs#L109-L110">Test file</a></li>
<li><a href="https://docs.astral.sh/ruff/rules/non-pep695-generic-class/">Rule documentation</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-06-06 23:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-06-06 23:13</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-06 23:17</div>
            <div class="timeline-body"><p>Docs and tests look good.</p>
<p>I did notice that the docs refer to <a href="https://docs.astral.sh/ruff/rules/generic-not-last-base-class/#generic-not-last-base-class-pyi059">generic-not-last-base-class (PYI059)</a>, which I suggested not to stabilize in the Notion page based on a comment from the 0.6 table about it being a mix between a correctness lint for .py files and a stylistic lint for .pyi files. It would be kind of nice if we stabilized this whole group together (UP046, UP047, UP049, and PYI059), but I think PYI059 is probably the best to leave out anyway, if I had to pick one.</p>
<p>cc @AlexWaygood or maybe @MichaReiser who it looks like added the rationale.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-09 16:48</div>
            <div class="timeline-body"><p>From Discord, requiring PYI059 also makes sense in stub files because of  how type checkers might handle <code>Generic</code> out of the final base class position in surprising ways. That resolves the correctness vs style issue (it now relates to correctness in both cases), and we just need to rephrase the docs to point that out to stabilize PYI059 too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dylwil3 by @ntBre on 2025-06-10 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Stabilize UP046 (non-pep695-generic-class)" to "Stabilize `non-pep695-generic-class` (`UP046`)" by @ntBre on 2025-06-10 16:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @ntBre on 2025-06-10 20:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @AlexWaygood removed by @AlexWaygood on 2025-06-10 20:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.12" by @ntBre on 2025-06-11 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-06-12 07:42</div>
            <div class="timeline-body"><p>Looks good to me. @AlexWaygood do you know if mypy and pyright support this by now or how limited the support still is?</p>
<p>That's my only hesitation for stabilizing this rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-06-12 07:43</div>
            <div class="timeline-body"><p>I'm sure they both still have a couple of bugs in edge cases, but my understanding is that they both support PEP 695 pretty well at this point!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-12 12:54</div>
            <div class="timeline-body"><p>Nice, thank you both! Is the support good enough that I should remove these statements from the docs:</p>
<blockquote>
<p>Not all type checkers fully support PEP 695 yet, so even valid fixes suggested by this rule may cause type checking to fail.</p>
</blockquote>
<p>Or is that still fair to say?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-06-12 13:03</div>
            <div class="timeline-body"><p>Hmm, https://github.com/python/mypy/issues/18507 is still unfixed (which we <a href="https://github.com/astral-sh/ruff/pull/15565#issuecomment-2606951912">uncovered</a> as a result of the PR initially adding this rule!) Maybe we should link to that directly from the docs?</p>
<p>I guess that does feel like something that users could plausibly run into: even if it's not code you'd usually write manually, it's code that could plausibly be generated by this autofix. I don't know if we should hold back from stabilisation just because of the mypy bug, though: that decision doesn't make much sense from the perspective of pyright users.</p>
<p>Whatever the case: maybe we should link to that issue directly from the docs</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-12 13:20</div>
            <div class="timeline-body"><p>Wow I forgot about that! I confirmed that it's still a problem on mypy 1.16. I'll update the docs here and in https://github.com/astral-sh/ruff/pull/18524.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dylwil3">@dylwil3</a> approved on 2025-06-12 14:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-12 14:27</div>
            <div class="timeline-body"><p>I'll go ahead and merge these, happy to drop the commits if we decide they should stay in preview.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Stabilize `non-pep695-generic-class` (`UP046`)" to "[`pyupgrade`] Stabilize `non-pep695-generic-class` (`UP046`)" by @ntBre on 2025-06-12 14:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-06-12 14:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-06-12 14:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-06-12 14:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:13:12 UTC
    </footer>
</body>
</html>
