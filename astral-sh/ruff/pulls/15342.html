<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`flake8-pyi`]: Stabilize: Provide more automated fixes for `duplicate-union-members` (`PYI016`) - astral-sh/ruff #15342</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>flake8-pyi</code>]: Stabilize: Provide more automated fixes for <code>duplicate-union-members</code> (<code>PYI016</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15342">#15342</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-01-08 09:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">Summary
<p>Stabilizes the fix extension introduced in <a href="https://github.com/astral-sh/ruff/pull/14270">astral-sh/ruff#14270</a></p>
Test Plan
<p>There are no open issues related to <code>PYI016</code> fixes. The most recent issue was fixed on Nov 25. There are also no open issues with the rule itself.</p>
<p>I reviewed the ecosystem changes and they look good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 09:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 09:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 09:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 09:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[`flake8-pyi`]: Stabilize: Provide more automated fixes for `duplicate-union-members` (PYI016)&quot; to &quot;[`flake8-pyi`]: Stabilize: Provide more automated fixes for `duplicate-union-members` (`PYI016`)&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 09:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/duplicate_union_member.rs</code>:96 on 2025-01-08 09:45</div>
            <div class="timeline-body"><p>It seems like <a href="https://github.com/astral-sh/ruff/pull/14270">astral-sh/ruff#14270</a> incorrectly removed the fix for non-preview ü§∑ So, technically, this PR makes the rule fixable again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-08 09:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-01-08 09:47</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+0 -0 violations, +10 -0 fixes in 3 projects; 52 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -0 violations, +2 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/apache/airflow/blob/c300e0e7c6b9b74b1171cce9dbc6f683f721c0cc/providers/src/airflow/providers/microsoft/azure/operators/container_instances.py#L254">providers/src/airflow/providers/microsoft/azure/operators/container_instances.py:254:43:</a> PYI016 Duplicate union member `VolumeMount`
+ <a href="https://github.com/apache/airflow/blob/c300e0e7c6b9b74b1171cce9dbc6f683f721c0cc/providers/src/airflow/providers/microsoft/azure/operators/container_instances.py#L254">providers/src/airflow/providers/microsoft/azure/operators/container_instances.py:254:43:</a> PYI016 [*] Duplicate union member `VolumeMount`
</pre>

</p>

<a href="https://github.com/apache/superset">apache/superset</a> (+0 -0 violations, +2 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/apache/superset/blob/d5a48158368a2cbb0e97d9b8de194df5d9fc9bc6/superset/models/helpers.py#L905">superset/models/helpers.py:905:39:</a> PYI016 Duplicate union member `str`
+ <a href="https://github.com/apache/superset/blob/d5a48158368a2cbb0e97d9b8de194df5d9fc9bc6/superset/models/helpers.py#L905">superset/models/helpers.py:905:39:</a> PYI016 [*] Duplicate union member `str`
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+0 -0 violations, +6 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/factors.py#L51">src/bokeh/core/property/factors.py:51:56:</a> PYI016 Duplicate union member `tuple[str, str]`
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/factors.py#L51">src/bokeh/core/property/factors.py:51:56:</a> PYI016 [*] Duplicate union member `tuple[str, str]`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/factors.py#L52">src/bokeh/core/property/factors.py:52:85:</a> PYI016 Duplicate union member `tp.Sequence[tuple[str, str]]`
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/factors.py#L52">src/bokeh/core/property/factors.py:52:85:</a> PYI016 [*] Duplicate union member `tp.Sequence[tuple[str, str]]`
- <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/contour.py#L43">src/bokeh/plotting/contour.py:43:88:</a> PYI016 Duplicate union member `ContourColor`
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/plotting/contour.py#L43">src/bokeh/plotting/contour.py:43:88:</a> PYI016 [*] Duplicate union member `ContourColor`
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PYI016 | 10 | 0 | 0 | 10 | 0 |</p>
</p>


Linter (preview)
<p>‚úÖ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.9&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 10:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-01-08 10:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/duplicate_union_member.rs</code>:96 on 2025-01-08 10:43</div>
            <div class="timeline-body"><p>hehe, onwards and upwards!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_pyi/PYI016.py</code>:116 on 2025-01-08 10:48</div>
            <div class="timeline-body"><p>I&#x27;m not sure I&#x27;d want to extend the rule to detect this, since:</p>
<ul>
<li>It seems like an unlikely edge case</li>
<li>It will fail at runtime with <code>TypeError</code> unless you have <code>from __future__ import annotations</code> at the top of the file (and if you do, there&#x27;s no need to quote any annotations anyway)</li>
<li>In a stub file it won&#x27;t fail, but you shouldn&#x27;t ever use quoted annotations in a stub file anyway, and we have PYI020 to tell you off about that if you do</li>
</ul>
<p>So I don&#x27;t think it would be worth the added complexity</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-01-08 10:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-01-08 10:54</div>
            <div class="timeline-body"><p>All LGTM other than <a href="https://github.com/astral-sh/ruff/pull/15342">astral-sh/ruff#15342</a>/files#r1906988995.</p>
<p>Thanks so much @sbrugman for this improvement. Changes like this make me really happy. It&#x27;s still so cool that Ruff can provide sophisticated autofixes like this üòÉ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 12:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-08 12:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-08 12:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:10:07 UTC
    </footer>
</body>
</html>
