<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`refurb`] Make `list-reverse-copy` an unsafe fix - astral-sh/ruff #12303</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>refurb</code>] Make <code>list-reverse-copy</code> an unsafe fix</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12303">#12303</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-07-12 13:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>I don't know that there's more to do here. We could consider not raising the violation at all for arguments, but that would have some false negatives and could also be surprising to users.</p>
<p>Closes https://github.com/astral-sh/ruff/issues/12267.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @charliermarsh on 2024-07-12 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Make `list-reverse-copy` an unsafe fix" to "[`refurb`] Make `list-reverse-copy` an unsafe fix" by @charliermarsh on 2024-07-12 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-07-12 13:26</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+0 -0 violations, +0 -2 fixes in 1 projects; 53 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -0 violations, +0 -2 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/ea1812112dac254941e7ee0fa2e9b407e703d18b/airflow/jobs/backfill_job_runner.py#L943'>airflow/jobs/backfill_job_runner.py:943:13:</a> FURB187 Use of assignment of `reversed` on list `dagrun_infos`
- <a href='https://github.com/apache/airflow/blob/ea1812112dac254941e7ee0fa2e9b407e703d18b/airflow/jobs/backfill_job_runner.py#L943'>airflow/jobs/backfill_job_runner.py:943:13:</a> FURB187 [*] Use of assignment of `reversed` on list `dagrun_infos`
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| FURB187 | 2 | 0 | 0 | 0 | 2 |</p>
</p>
</details>

<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+0 -0 violations, +0 -2 fixes in 1 projects; 53 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+0 -0 violations, +0 -2 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/ea1812112dac254941e7ee0fa2e9b407e703d18b/airflow/jobs/backfill_job_runner.py#L943'>airflow/jobs/backfill_job_runner.py:943:13:</a> FURB187 Use of assignment of `reversed` on list `dagrun_infos`
- <a href='https://github.com/apache/airflow/blob/ea1812112dac254941e7ee0fa2e9b407e703d18b/airflow/jobs/backfill_job_runner.py#L943'>airflow/jobs/backfill_job_runner.py:943:13:</a> FURB187 [*] Use of assignment of `reversed` on list `dagrun_infos`
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| FURB187 | 2 | 0 | 0 | 0 | 2 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-07-13 07:32</div>
            <div class="timeline-body"><p>Fair enough. Do we have other rules that apply fixes that mutate an object in place? These would also need to be marked as unsafe. It's not that we have to do this now. I'm mainly trying to understand the implication of marking such fixes as unsafe.</p>
<p>We might be able to get better at this long-term with Red Knot, if it has a way to reason whether a binding is local (not an argument), and has no aliases (CC: @carljm )</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-13 19:23</div>
            <div class="timeline-body"><p>Yeah, it's <em>possible</em> that we could make this safe in some cases. Maybe if... there's only one binding, and there are no reads yet, and that binding is an assignment...?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-07-13 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-13 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-13 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2024-07-14 07:27</div>
            <div class="timeline-body"><p>Yes, it should be possible to find the cases where this is safe. They might turn out to not be very common in practice. I personally just don't like this lint rule at all, because in-place mutation is just fundamentally different, and that difference will be relevant in many practical cases. But making the autofix unsafe seems like a reasonable option.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:05:17 UTC
    </footer>
</body>
</html>
