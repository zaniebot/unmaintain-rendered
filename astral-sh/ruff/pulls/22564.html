<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Propagate type context through comprehensions - astral-sh/ruff #22564</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Propagate type context through comprehensions</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22564">#22564</a>
        opened by <a href="https://github.com/ibraheemdev">@ibraheemdev</a>
        on 2026-01-14 01:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Resolves https://github.com/astral-sh/ty/issues/1602.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @ibraheemdev on 2026-01-14 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @ibraheemdev on 2026-01-14 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @ibraheemdev on 2026-01-14 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @ibraheemdev on 2026-01-14 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @ibraheemdev on 2026-01-14 01:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2026-01-14 01:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/ty_python_semantic/resources/mdtest/comprehensions/basic.md</code>:132 on 2026-01-14 01:49</div>
            <div class="timeline-body"><p>This and the other todos are https://github.com/astral-sh/ty/issues/2486 (and some will also be fixed indirectly by https://github.com/astral-sh/ty/issues/1240).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2026-01-14 01:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/ty_python_semantic/src/types/infer.rs</code>:371 on 2026-01-14 01:50</div>
            <div class="timeline-body"><p>Ideally we could have a generic <code>InferRegion</code> type, but the salsa macros don't seem to like it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-14 01:50</div>
            <div class="timeline-body"><!-- generated-comment typing_conformance_diagnostics_diff -->

<h2><a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/">Typing conformance results</a></h2>
<p>No changes detected âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-14 01:52</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<details>
<summary>Changes were detected when running on open source projects</summary>

<pre><code class="language-diff">attrs (https://github.com/python-attrs/attrs)
- src/attr/_make.py:2644:33: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Attribute | Unknown`
+ src/attr/_make.py:2644:33: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Unknown | Attribute`
- src/attr/_make.py:2646:29: warning[possibly-missing-attribute] Attribute `hash` may be missing on object of type `Attribute | Unknown`
+ src/attr/_make.py:2646:29: warning[possibly-missing-attribute] Attribute `hash` may be missing on object of type `Unknown | Attribute`
- src/attr/_make.py:2646:40: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Attribute | Unknown`
+ src/attr/_make.py:2646:40: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Unknown | Attribute`

aioredis (https://github.com/aio-libs/aioredis)
- aioredis/connection.py:441:16: error[invalid-return-type] Return type does not match returned value: expected `bytes | memoryview[int] | str | ... omitted 4 union elements`, found `(@Todo &amp; ~bytes) | int | list[bytes | memoryview[int] | str | ... omitted 5 union elements] | ... omitted 4 union elements`
+ aioredis/connection.py:441:16: error[invalid-return-type] Return type does not match returned value: expected `bytes | memoryview[int] | str | ... omitted 4 union elements`, found `(@Todo &amp; ~bytes) | int | list[Unknown | bytes | memoryview[int] | ... omitted 5 union elements] | ... omitted 4 union elements`

spack (https://github.com/spack/spack)
- lib/spack/spack/detection/path.py:399:20: error[invalid-assignment] Object of type `list[Pattern[str] | Unknown]` is not assignable to `list[str]`
+ lib/spack/spack/detection/path.py:399:20: error[invalid-assignment] Object of type `list[str | Pattern[str]]` is not assignable to `list[str]`
- lib/spack/spack/directives.py:367:15: error[invalid-assignment] Object of type `list[Unknown | ~str]` is not assignable to `((type[PackageBase] | Dependency, /) -&gt; None) | str | list[((type[PackageBase] | Dependency, /) -&gt; None) | str] | None`
+ lib/spack/spack/directives.py:367:15: error[invalid-assignment] Object of type `list[object]` is not assignable to `((type[PackageBase] | Dependency, /) -&gt; None) | str | list[((type[PackageBase] | Dependency, /) -&gt; None) | str] | None`
- lib/spack/spack/environment/environment.py:1652:16: error[invalid-return-type] Return type does not match returned value: expected `tuple[list[Spec], list[Spec], list[tuple[Spec, Spec]]]`, found `tuple[list[Unknown] &amp; ~AlwaysFalsy, list[Unknown], list[tuple[Unknown, None] | Unknown]]`
+ lib/spack/spack/environment/environment.py:1652:16: error[invalid-return-type] Return type does not match returned value: expected `tuple[list[Spec], list[Spec], list[tuple[Spec, Spec]]]`, found `tuple[list[Unknown] &amp; ~AlwaysFalsy, list[Unknown], list[Unknown | tuple[Unknown, None]]]`
- lib/spack/spack/fetch_strategy.py:1500:42: error[invalid-argument-type] Argument to function `quote` is incorrect: Expected `list[str]`, found `set[@Todo]`
+ lib/spack/spack/fetch_strategy.py:1500:42: error[invalid-argument-type] Argument to function `quote` is incorrect: Expected `list[str]`, found `set[Unknown]`
- lib/spack/spack/test/cmd/ci.py:2026:57: error[invalid-argument-type] Argument to function `validate_standard_versions` is incorrect: Expected `list[StandardVersion]`, found `list[StandardVersion | GitVersion | Unknown]`
+ lib/spack/spack/test/cmd/ci.py:2026:57: error[invalid-argument-type] Argument to function `validate_standard_versions` is incorrect: Expected `list[StandardVersion]`, found `list[Unknown | StandardVersion | GitVersion]`
- lib/spack/spack/test/cmd/ci.py:2041:57: error[invalid-argument-type] Argument to function `validate_standard_versions` is incorrect: Expected `list[StandardVersion]`, found `list[StandardVersion | GitVersion | Unknown]`
+ lib/spack/spack/test/cmd/ci.py:2041:57: error[invalid-argument-type] Argument to function `validate_standard_versions` is incorrect: Expected `list[StandardVersion]`, found `list[Unknown | StandardVersion | GitVersion]`
- lib/spack/spack/test/cmd/ci.py:2065:52: error[invalid-argument-type] Argument to function `validate_git_versions` is incorrect: Expected `list[StandardVersion]`, found `list[StandardVersion | GitVersion | Unknown]`
+ lib/spack/spack/test/cmd/ci.py:2065:52: error[invalid-argument-type] Argument to function `validate_git_versions` is incorrect: Expected `list[StandardVersion]`, found `list[Unknown | StandardVersion | GitVersion]`
- lib/spack/spack/test/cmd/ci.py:2089:52: error[invalid-argument-type] Argument to function `validate_git_versions` is incorrect: Expected `list[StandardVersion]`, found `list[StandardVersion | GitVersion | Unknown]`
+ lib/spack/spack/test/cmd/ci.py:2089:52: error[invalid-argument-type] Argument to function `validate_git_versions` is incorrect: Expected `list[StandardVersion]`, found `list[Unknown | StandardVersion | GitVersion]`
- lib/spack/spack/test/cmd/ci.py:2117:52: error[invalid-argument-type] Argument to function `validate_git_versions` is incorrect: Expected `list[StandardVersion]`, found `list[StandardVersion | GitVersion | Unknown]`
+ lib/spack/spack/test/cmd/ci.py:2117:52: error[invalid-argument-type] Argument to function `validate_git_versions` is incorrect: Expected `list[StandardVersion]`, found `list[Unknown | StandardVersion | GitVersion]`
- lib/spack/spack/test/spec_semantics.py:2106:19: error[invalid-argument-type] Argument to function `sorted` is incorrect: Argument type `Spec | Unknown` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
+ lib/spack/spack/test/spec_semantics.py:2106:19: error[invalid-argument-type] Argument to function `sorted` is incorrect: Argument type `Unknown | Spec` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
- lib/spack/spack/test/spec_semantics.py:2111:16: error[unsupported-operator] Operator `&lt;=` is not supported between two objects of type `Spec | Unknown`
+ lib/spack/spack/test/spec_semantics.py:2111:16: error[unsupported-operator] Operator `&lt;=` is not supported between two objects of type `Unknown | Spec`
- lib/spack/spack/test/spec_semantics.py:2112:17: error[unsupported-operator] Operator `&lt;` is not supported between two objects of type `Spec | Unknown`
+ lib/spack/spack/test/spec_semantics.py:2112:17: error[unsupported-operator] Operator `&lt;` is not supported between two objects of type `Unknown | Spec`
- lib/spack/spack/test/spec_semantics.py:2113:16: error[unsupported-operator] Operator `&gt;=` is not supported between two objects of type `Spec | Unknown`
+ lib/spack/spack/test/spec_semantics.py:2113:16: error[unsupported-operator] Operator `&gt;=` is not supported between two objects of type `Unknown | Spec`
- lib/spack/spack/test/spec_semantics.py:2114:17: error[unsupported-operator] Operator `&gt;` is not supported between two objects of type `Spec | Unknown`
+ lib/spack/spack/test/spec_semantics.py:2114:17: error[unsupported-operator] Operator `&gt;` is not supported between two objects of type `Unknown | Spec`
- lib/spack/spack/vendor/attr/_make.py:2653:33: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Attribute | Unknown`
+ lib/spack/spack/vendor/attr/_make.py:2653:33: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Unknown | Attribute`
- lib/spack/spack/vendor/attr/_make.py:2655:29: warning[possibly-missing-attribute] Attribute `hash` may be missing on object of type `Attribute | Unknown`
+ lib/spack/spack/vendor/attr/_make.py:2655:29: warning[possibly-missing-attribute] Attribute `hash` may be missing on object of type `Unknown | Attribute`
- lib/spack/spack/vendor/attr/_make.py:2655:40: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Attribute | Unknown`
+ lib/spack/spack/vendor/attr/_make.py:2655:40: warning[possibly-missing-attribute] Attribute `name` may be missing on object of type `Unknown | Attribute`
- lib/spack/spack/vendor/jinja2/environment.py:1494:20: error[invalid-return-type] Return type does not match returned value: expected `list[tuple[int, int]]`, found `list[tuple[int, ...] | Unknown]`
+ lib/spack/spack/vendor/jinja2/environment.py:1494:20: error[invalid-return-type] Return type does not match returned value: expected `list[tuple[int, int]]`, found `list[tuple[int, ...]]`
- lib/spack/spack/verify_libraries.py:170:69: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `list[bytes]`, found `list[bytes | Unknown | str | PathLike[str] | PathLike[bytes]]`
+ lib/spack/spack/verify_libraries.py:170:69: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `list[bytes]`, found `list[Unknown | bytes | str | PathLike[str] | PathLike[bytes]]`

pip (https://github.com/pypa/pip)
- src/pip/_internal/req/req_uninstall.py:132:42: error[invalid-argument-type] Argument to function `norm_join` is incorrect: Expected `str`, found `Sized | Unknown`
+ src/pip/_internal/req/req_uninstall.py:132:42: error[invalid-argument-type] Argument to function `norm_join` is incorrect: Expected `str`, found `Unknown | Sized`
- src/pip/_internal/req/req_uninstall.py:133:40: error[invalid-argument-type] Argument to function `norm_join` is incorrect: Expected `str`, found `Sized | Unknown`
+ src/pip/_internal/req/req_uninstall.py:133:40: error[invalid-argument-type] Argument to function `norm_join` is incorrect: Expected `str`, found `Unknown | Sized`
- src/pip/_internal/req/req_uninstall.py:139:27: error[unsupported-operator] Operator `+` is not supported between objects of type `Sized | Unknown` and `LiteralString`
+ src/pip/_internal/req/req_uninstall.py:139:27: error[unsupported-operator] Operator `+` is not supported between objects of type `Unknown | Sized` and `LiteralString`

jinja (https://github.com/pallets/jinja)
- src/jinja2/environment.py:1496:20: error[invalid-return-type] Return type does not match returned value: expected `list[tuple[int, int]]`, found `list[tuple[int, ...] | Unknown]`
+ src/jinja2/environment.py:1496:20: error[invalid-return-type] Return type does not match returned value: expected `list[tuple[int, int]]`, found `list[tuple[int, ...]]`

werkzeug (https://github.com/pallets/werkzeug)
- tests/test_routing.py:601:5: warning[possibly-missing-attribute] Attribute `add` may be missing on object of type `Unknown | None | set[str | Unknown]`
+ tests/test_routing.py:601:5: warning[possibly-missing-attribute] Attribute `add` may be missing on object of type `Unknown | None | set[str]`
- tests/test_routing.py:603:5: warning[possibly-missing-attribute] Attribute `discard` may be missing on object of type `Unknown | None | set[str | Unknown]`
+ tests/test_routing.py:603:5: warning[possibly-missing-attribute] Attribute `discard` may be missing on object of type `Unknown | None | set[str]`

graphql-core (https://github.com/graphql-python/graphql-core)
- src/graphql/utilities/find_breaking_changes.py:107:12: error[invalid-return-type] Return type does not match returned value: expected `list[BreakingChange]`, found `list[BreakingChange | DangerousChange | Unknown]`
+ src/graphql/utilities/find_breaking_changes.py:107:12: error[invalid-return-type] Return type does not match returned value: expected `list[BreakingChange]`, found `list[BreakingChange | DangerousChange]`
- src/graphql/utilities/find_breaking_changes.py:122:12: error[invalid-return-type] Return type does not match returned value: expected `list[DangerousChange]`, found `list[BreakingChange | DangerousChange | Unknown]`
+ src/graphql/utilities/find_breaking_changes.py:122:12: error[invalid-return-type] Return type does not match returned value: expected `list[DangerousChange]`, found `list[DangerousChange | BreakingChange]`

paasta (https://github.com/yelp/paasta)
- paasta_tools/instance/kubernetes.py:1146:12: error[invalid-return-type] Return type does not match returned value: expected `KubernetesVersionDict`, found `dict[Unknown | str, Unknown | str | int | list[Mapping[str, Any] | Unknown] | None]`
+ paasta_tools/instance/kubernetes.py:1146:12: error[invalid-return-type] Return type does not match returned value: expected `KubernetesVersionDict`, found `dict[Unknown | str, Unknown | str | int | list[Unknown | Mapping[str, Any]] | None]`

scrapy (https://github.com/scrapy/scrapy)
- scrapy/utils/python.py:266:16: error[invalid-return-type] Return type does not match returned value: expected `Iterable[_KT@without_none_values]`, found `dict[object, ~None | Unknown]`
+ scrapy/utils/python.py:266:16: error[invalid-return-type] Return type does not match returned value: expected `Iterable[_KT@without_none_values]`, found `dict[object, Unknown | ~None]`

kopf (https://github.com/nolar/kopf)
- kopf/_core/engines/admission.py:449:42: error[invalid-assignment] Object of type `list[dict[Unknown | str, Unknown | str] | dict[Unknown | str, Unknown | str | list[Unknown | str]] | Unknown]` is not assignable to `Collection[MatchExpression]`
- Found 268 diagnostics
+ Found 267 diagnostics

pytest (https://github.com/pytest-dev/pytest)
+ testing/test_config.py:2516:21: warning[possibly-missing-attribute] Submodule `config` may not be available as an attribute on module `_pytest`
- Found 416 diagnostics
+ Found 417 diagnostics

sockeye (https://github.com/awslabs/sockeye)
- sockeye/data_io.py:506:28: error[invalid-argument-type] Method `__getitem__` of type `Overload[(i: SupportsIndex, /) -&gt; int | Unknown, (s: slice[Any, Any, Any], /) -&gt; list[int | Unknown]]` cannot be called with key of type `None` on object of type `list[int | Unknown]`
+ sockeye/data_io.py:506:28: error[invalid-argument-type] Method `__getitem__` of type `Overload[(i: SupportsIndex, /) -&gt; Unknown | int, (s: slice[Any, Any, Any], /) -&gt; list[Unknown | int]]` cannot be called with key of type `None` on object of type `list[Unknown | int]`
- sockeye/data_io.py:522:13: error[invalid-argument-type] Method `__getitem__` of type `Overload[(i: SupportsIndex, /) -&gt; int | Unknown, (s: slice[Any, Any, Any], /) -&gt; list[int | Unknown]]` cannot be called with key of type `None` on object of type `list[int | Unknown]`
+ sockeye/data_io.py:522:13: error[invalid-argument-type] Method `__getitem__` of type `Overload[(i: SupportsIndex, /) -&gt; Unknown | int, (s: slice[Any, Any, Any], /) -&gt; list[Unknown | int]]` cannot be called with key of type `None` on object of type `list[Unknown | int]`
- sockeye/inference.py:350:50: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(Unknown &amp; ~Top[list[Unknown]]) | None | list[list[str] | Unknown]`
+ sockeye/inference.py:350:50: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(Unknown &amp; ~Top[list[Unknown]]) | None | list[Unknown | list[str]]`
- sockeye/inference.py:352:34: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(Unknown &amp; ~Top[list[Unknown]]) | None | list[list[str] | Unknown]`
+ sockeye/inference.py:352:34: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(Unknown &amp; ~Top[list[Unknown]]) | None | list[Unknown | list[str]]`
- sockeye/test_utils.py:105:101: error[not-iterable] Object of type `None | list[list[str | Unknown] | Unknown]` may not be iterable
+ sockeye/test_utils.py:105:101: error[not-iterable] Object of type `None | list[Unknown | list[Unknown | str]]` may not be iterable

dulwich (https://github.com/dulwich/dulwich)
- dulwich/refs.py:1992:12: error[invalid-return-type] Return type does not match returned value: expected `T@filter_ref_prefix`, found `dict[Ref | Unknown, ObjectID | None | Unknown]`
+ dulwich/refs.py:1992:12: error[invalid-return-type] Return type does not match returned value: expected `T@filter_ref_prefix`, found `dict[Unknown | Ref, Unknown | ObjectID | None]`

mitmproxy (https://github.com/mitmproxy/mitmproxy)
- test/mitmproxy/addons/test_proxyserver.py:119:36: error[invalid-argument-type] Argument to function `wait_for` is incorrect: Expected `Awaitable[Unknown]`, found `Task[Unknown] | None | Unknown`
+ test/mitmproxy/addons/test_proxyserver.py:119:36: error[invalid-argument-type] Argument to function `wait_for` is incorrect: Expected `Awaitable[Unknown]`, found `Unknown | Task[Unknown] | None`

optuna (https://github.com/optuna/optuna)
- optuna/storages/_rdb/storage.py:367:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Any]`
+ optuna/storages/_rdb/storage.py:367:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Unknown]`
- optuna/storages/_rdb/storage.py:376:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Any]`
+ optuna/storages/_rdb/storage.py:376:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Unknown]`
- optuna/storages/_rdb/storage.py:386:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Any]`
+ optuna/storages/_rdb/storage.py:386:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Unknown]`
- optuna/storages/_rdb/storage.py:396:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Any]`
+ optuna/storages/_rdb/storage.py:396:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | Column[Unknown], Unknown]`

pandera (https://github.com/pandera-dev/pandera)
- pandera/api/pandas/components.py:400:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[Unknown | None | str, Unknown | Index]`
+ pandera/api/pandas/components.py:400:16: error[invalid-return-type] Return type does not match returned value: expected `dict[str, Any]`, found `dict[str | Unknown | None, Any]`
- pandera/api/pandas/model.py:210:13: error[invalid-argument-type] Argument to bound method `astype` is incorrect: Expected `type | Literal[&quot;bool&quot;, &quot;boolean&quot;, &quot;?&quot;, &quot;b1&quot;, &quot;bool_&quot;, ... omitted 154 literals] | ExtensionDtype | ... omitted 3 union elements`, found `dict[str | Unknown, Any | None]`
+ pandera/api/pandas/model.py:210:13: error[invalid-argument-type] Argument to bound method `astype` is incorrect: Expected `type | Literal[&quot;bool&quot;, &quot;boolean&quot;, &quot;?&quot;, &quot;b1&quot;, &quot;bool_&quot;, ... omitted 154 literals] | ExtensionDtype | ... omitted 3 union elements`, found `dict[Unknown | str, Unknown | None]`
- tests/pandas/test_pydantic.py:308:53: error[invalid-argument-type] Argument to bound method `astype` is incorrect: Expected `type | Literal[&quot;bool&quot;, &quot;boolean&quot;, &quot;?&quot;, &quot;b1&quot;, &quot;bool_&quot;, ... omitted 154 literals] | ExtensionDtype | ... omitted 3 union elements`, found `dict[Unknown, Unknown] | dict[str | Unknown, Any | None | type[Any]]`
+ tests/pandas/test_pydantic.py:308:53: error[invalid-argument-type] Argument to bound method `astype` is incorrect: Expected `type | Literal[&quot;bool&quot;, &quot;boolean&quot;, &quot;?&quot;, &quot;b1&quot;, &quot;bool_&quot;, ... omitted 154 literals] | ExtensionDtype | ... omitted 3 union elements`, found `dict[Unknown, Unknown] | dict[Unknown | str, Unknown | None | type[Any]]`

artigraph (https://github.com/artigraph/artigraph)
- src/arti/storage/__init__.py:221:13: error[invalid-argument-type] Argument is incorrect: Expected `tuple[str, ...]`, found `str | Any`
+ src/arti/storage/__init__.py:221:13: error[invalid-argument-type] Argument is incorrect: Expected `tuple[str, ...]`, found `Unknown | str`

freqtrade (https://github.com/freqtrade/freqtrade)
- freqtrade/data/btanalysis/bt_fileutils.py:238:12: error[invalid-return-type] Return type does not match returned value: expected `list[BacktestHistoryEntryType]`, found `list[dict[Unknown | str, Unknown | str] | Unknown]`
- freqtrade/exchange/exchange_utils.py:132:48: error[invalid-assignment] Object of type `list[dict[Unknown | str, Unknown] | Unknown]` is not assignable to `list[TradeModeType]`
- freqtrade/plugins/pairlist/PercentChangePairList.py:218:56: error[invalid-assignment] Object of type `list[dict[Unknown | str, Unknown | str | None] | Unknown]` is not assignable to `list[SymbolWithPercentage]`
- Found 648 diagnostics
+ Found 645 diagnostics

schema_salad (https://github.com/common-workflow-language/schema_salad)
- schema_salad/schema.py:572:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;symbols&quot;]` and value of type `list[str | Unknown]` on object of type `MutableSequence[Any]`
+ schema_salad/schema.py:572:13: error[invalid-assignment] Invalid subscript assignment with key of type `Literal[&quot;symbols&quot;]` and value of type `list[Unknown | str]` on object of type `MutableSequence[Any]`

psycopg (https://github.com/psycopg/psycopg)
- tests/test_conninfo_attempts.py:182:5: error[invalid-argument-type] Argument to bound method `sort` is incorrect: Argument type `str | int | None | Unknown` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
+ tests/test_conninfo_attempts.py:182:5: error[invalid-argument-type] Argument to bound method `sort` is incorrect: Argument type `Unknown | str | int | None` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
- tests/test_conninfo_attempts_async.py:189:5: error[invalid-argument-type] Argument to bound method `sort` is incorrect: Argument type `str | int | None | Unknown` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`
+ tests/test_conninfo_attempts_async.py:189:5: error[invalid-argument-type] Argument to bound method `sort` is incorrect: Argument type `Unknown | str | int | None` does not satisfy upper bound `SupportsDunderLT[Any] | SupportsDunderGT[Any]` of type variable `SupportsRichComparisonT`

vision (https://github.com/pytorch/vision)
- torchvision/utils.py:763:14: error[invalid-assignment] Object of type `list[tuple[int, int, int] | tuple[int, int, int, int] | Unknown]` is not assignable to `None | str | tuple[int, int, int] | list[str | tuple[int, int, int]]`
+ torchvision/utils.py:763:14: error[invalid-assignment] Object of type `list[str | tuple[int, int, int] | tuple[int, int, int, int] | (Unknown &amp; ~str)]` is not assignable to `None | str | tuple[int, int, int] | list[str | tuple[int, int, int]]`

meson (https://github.com/mesonbuild/meson)
- docs/refman/generatorjson.py:31:16: error[invalid-return-type] Return type does not match returned value: expected `list[Type]`, found `list[dict[Unknown | str, Unknown | str | list[Type] | list[Unknown]] | Unknown]`
- mesonbuild/dependencies/dub.py:471:16: error[invalid-return-type] Return type does not match returned value: expected `list[FindTargetEntry]`, found `list[dict[Unknown | str, Unknown | str] | Unknown]`
- mesonbuild/dependencies/pkgconfig.py:215:16: error[invalid-return-type] Return type does not match returned value: expected `ImmutableListProtocol[str]`, found `list[str | Unknown]`
+ mesonbuild/dependencies/pkgconfig.py:215:16: error[invalid-return-type] Return type does not match returned value: expected `ImmutableListProtocol[str]`, found `list[Unknown | str]`
- mesonbuild/interpreter/interpreter.py:3301:13: error[invalid-assignment] Object of type `dict[str | Unknown, Compiler | Unknown]` is not assignable to attribute `compilers` of type `OrderedDict[str, Compiler]`
+ mesonbuild/interpreter/interpreter.py:3301:13: error[invalid-assignment] Object of type `dict[str, Compiler]` is not assignable to attribute `compilers` of type `OrderedDict[str, Compiler]`
- mesonbuild/interpreter/interpreter.py:3492:18: error[invalid-assignment] Object of type `dict[str | Unknown, object]` is not assignable to `Executable | StaticLibrary | SharedLibrary | SharedModule | Jar`
+ mesonbuild/interpreter/interpreter.py:3492:18: error[invalid-assignment] Object of type `dict[Unknown | str, object]` is not assignable to `Executable | StaticLibrary | SharedLibrary | SharedModule | Jar`
- mesonbuild/interpreter/type_checking.py:252:37: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `dict[str, str | list[str]] | None`, found `dict[object, list[Any] | Unknown]`
+ mesonbuild/interpreter/type_checking.py:252:37: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `dict[str, str | list[str]] | None`, found `dict[object, str | list[str]]`
- mesonbuild/interpreterbase/helpers.py:39:20: error[invalid-return-type] Return type does not match returned value: expected `str | int | Sequence[Divergent] | ... omitted 5 union elements`, found `dict[object, str | int | Sequence[Divergent] | ... omitted 6 union elements]`
+ mesonbuild/interpreterbase/helpers.py:39:20: error[invalid-return-type] Return type does not match returned value: expected `str | int | Sequence[Divergent] | ... omitted 5 union elements`, found `dict[object, Unknown | str | int | ... omitted 6 union elements]`
- mesonbuild/interpreterbase/interpreterbase.py:602:16: error[invalid-return-type] Return type does not match returned value: expected `tuple[list[InterpreterObject], dict[str, InterpreterObject]]`, found `tuple[list[InterpreterObject | None | Unknown], dict[str, InterpreterObject | None]]`
+ mesonbuild/interpreterbase/interpreterbase.py:602:16: error[invalid-return-type] Return type does not match returned value: expected `tuple[list[InterpreterObject], dict[str, InterpreterObject]]`, found `tuple[list[Unknown | InterpreterObject | None], dict[str, InterpreterObject | None]]`
- test cases/common/22 object extraction/check-obj.py:19:35: error[unsupported-operator] Operator `not in` is not supported between objects of type `str` and `None | set[Any]`
+ test cases/common/22 object extraction/check-obj.py:19:35: error[unsupported-operator] Operator `not in` is not supported between objects of type `str` and `None | set[Unknown]`
- unittests/allplatformstests.py:3199:41: error[invalid-argument-type] Argument to function `exists` is incorrect: Expected `int | str | bytes | PathLike[str] | PathLike[bytes]`, found `Unknown | str | dict[str | Unknown, Any] | ... omitted 3 union elements`
+ unittests/allplatformstests.py:3199:41: error[invalid-argument-type] Argument to function `exists` is incorrect: Expected `int | str | bytes | PathLike[str] | PathLike[bytes]`, found `Unknown | str | dict[Unknown | str, Unknown] | ... omitted 3 union elements`
- Found 2152 diagnostics
+ Found 2150 diagnostics

discord.py (https://github.com/Rapptz/discord.py)
- discord/components.py:1326:27: error[invalid-argument-type] Invalid argument to key &quot;components&quot; with declared type `list[ActionRow | TextComponent | MediaGalleryComponent | ... omitted 5 union elements]` on TypedDict `ContainerComponent`: value of type `list[ButtonComponent | SelectMenu | TextInput | ... omitted 11 union elements]`
+ discord/components.py:1326:27: error[invalid-argument-type] Invalid argument to key &quot;components&quot; with declared type `list[ActionRow | TextComponent | MediaGalleryComponent | ... omitted 5 union elements]` on TypedDict `ContainerComponent`: value of type `list[ActionRow | TextComponent | MediaGalleryComponent | ... omitted 10 union elements]`
- discord/role.py:450:45: error[invalid-assignment] Object of type `list[dict[Unknown | str, Unknown] | Unknown]` is not assignable to `list[RolePositionUpdate]`
- discord/role.py:700:45: error[invalid-assignment] Object of type `list[dict[Unknown | str, Unknown | int] | Unknown]` is not assignable to `list[RolePositionUpdate]`
- Found 552 diagnostics
+ Found 550 diagnostics

xarray (https://github.com/pydata/xarray)
- properties/test_properties.py:59:39: error[invalid-argument-type] Argument to function `find_independent_seasons` is incorrect: Expected `Sequence[str]`, found `list[list[Unknown] | Unknown]`
+ properties/test_properties.py:59:39: error[invalid-argument-type] Argument to function `find_independent_seasons` is incorrect: Expected `Sequence[str]`, found `list[Unknown | list[Unknown]]`
+ xarray/core/dataarray.py:164:21: error[invalid-assignment] Invalid subscript assignment with key of type `int` and value of type `Hashable` on object of type `list[str]`
- xarray/core/dataarray.py:473:9: error[invalid-assignment] Object of type `(Sequence[Sequence[Unknown] | Index[Any] | DataArray | Variable | ndarray[tuple[Any, ...], dtype[Any]]] &amp; Top[dict[Unknown, Unknown]]) | (Mapping[Unknown, Unknown] &amp; Top[dict[Unknown, Unknown]]) | dict[Hashable, Variable | Unknown]` is not assignable to attribute `_coords` of type `dict[Any, Variable]`
+ xarray/core/dataarray.py:473:9: error[invalid-assignment] Object of type `(Sequence[Sequence[Unknown] | Index[Any] | DataArray | Variable | ndarray[tuple[Any, ...], dtype[Any]]] &amp; Top[dict[Unknown, Unknown]]) | (Mapping[Unknown, Unknown] &amp; Top[dict[Unknown, Unknown]]) | dict[Hashable, Unknown | Variable]` is not assignable to attribute `_coords` of type `dict[Any, Variable]`
- xarray/core/dataset.py:9121:21: error[invalid-argument-type] Argument to bound method `pad` is incorrect: Expected `int | float | tuple[int | float, int | float] | Mapping[Any, int | float | tuple[int | float, int | float]] | None`, found `Any | dict[Any, Any] | int | ... omitted 4 union elements`
+ xarray/core/dataset.py:9121:21: error[invalid-argument-type] Argument to bound method `pad` is incorrect: Expected `int | float | tuple[int | float, int | float] | Mapping[Any, int | float | tuple[int | float, int | float]] | None`, found `Any | dict[Unknown, Unknown] | int | ... omitted 4 union elements`
- xarray/core/treenode.py:133:13: error[invalid-assignment] Object of type `dict[str | Unknown, Self@_detach | Unknown]` is not assignable to attribute `_children` of type `dict[str, &lt;special-form 'typing.Self'&gt;]`
+ xarray/core/treenode.py:133:13: error[invalid-assignment] Object of type `dict[str, &lt;special-form 'typing.Self'&gt; | Self@_detach]` is not assignable to attribute `_children` of type `dict[str, &lt;special-form 'typing.Self'&gt;]`
- Found 1761 diagnostics
+ Found 1762 diagnostics

openlibrary (https://github.com/internetarchive/openlibrary)
- openlibrary/book_providers.py:829:9: error[invalid-argument-type] Argument to function `multisort_best` is incorrect: Expected `list[tuple[Literal[&quot;min&quot;, &quot;max&quot;], (tuple[Edition, AbstractBookProvider[Unknown] | None] | Unknown, /) -&gt; int | float]]`, found `list[Unknown | tuple[str, (rec) -&gt; Unknown]]`
+ openlibrary/book_providers.py:829:9: error[invalid-argument-type] Argument to function `multisort_best` is incorrect: Expected `list[tuple[Literal[&quot;min&quot;, &quot;max&quot;], (Unknown | tuple[Edition, AbstractBookProvider[Unknown] | None], /) -&gt; int | float]]`, found `list[Unknown | tuple[str, (rec) -&gt; Unknown]]`
- openlibrary/plugins/books/dynlinks.py:355:17: warning[possibly-missing-attribute] Attribute `insert` may be missing on object of type `Unknown | str | list[dict[Unknown | str, Unknown | str] | Unknown] | ... omitted 3 union elements`
+ openlibrary/plugins/books/dynlinks.py:355:17: warning[possibly-missing-attribute] Attribute `insert` may be missing on object of type `Unknown | str | list[Unknown | dict[Unknown | str, Unknown | str]] | ... omitted 3 union elements`
- openlibrary/plugins/books/dynlinks.py:399:33: error[invalid-argument-type] Argument to function `trim` is incorrect: Expected `dict[Unknown, Unknown]`, found `Unknown | str | list[dict[Unknown | str, Unknown | str] | Unknown] | ... omitted 3 union elements`
+ openlibrary/plugins/books/dynlinks.py:399:33: error[invalid-argument-type] Argument to function `trim` is incorrect: Expected `dict[Unknown, Unknown]`, found `Unknown | str | list[Unknown | dict[Unknown | str, Unknown | str]] | ... omitted 3 union elements`
- openlibrary/plugins/books/dynlinks.py:400:37: error[invalid-argument-type] Argument to function `trim` is incorrect: Expected `dict[Unknown, Unknown]`, found `Unknown | str | list[dict[Unknown | str, Unknown | str] | Unknown] | ... omitted 3 union elements`
+ openlibrary/plugins/books/dynlinks.py:400:37: error[invalid-argument-type] Argument to function `trim` is incorrect: Expected `dict[Unknown, Unknown]`, found `Unknown | str | list[Unknown | dict[Unknown | str, Unknown | str]] | ... omitted 3 union elements`

setuptools (https://github.com/pypa/setuptools)
- setuptools/_distutils/command/build_ext.py:270:23: warning[possibly-missing-attribute] Attribute `split` may be missing on object of type `(Unknown &amp; ~AlwaysFalsy) | (list[tuple[Unknown, str] | Unknown] &amp; ~AlwaysFalsy)`
+ setuptools/_distutils/command/build_ext.py:270:23: warning[possibly-missing-attribute] Attribute `split` may be missing on object of type `(Unknown &amp; ~AlwaysFalsy) | (list[Unknown | tuple[Unknown, str]] &amp; ~AlwaysFalsy)`
- setuptools/_distutils/sysconfig.py:568:12: error[invalid-return-type] Return type does not match returned value: expected `list[str | int] | dict[str, str | int]`, found `list[Any | None] | dict[str, Any]`
+ setuptools/_distutils/sysconfig.py:568:12: error[invalid-return-type] Return type does not match returned value: expected `list[str | int] | dict[str, str | int]`, found `list[str | int | Any | None] | dict[str, Any]`
- setuptools/command/rotate.py:50:24: error[not-iterable] Object of type `Unknown | None | list[str | Unknown]` may not be iterable
+ setuptools/command/rotate.py:50:24: error[not-iterable] Object of type `Unknown | None | list[Unknown | str]` may not be iterable

cwltool (https://github.com/common-workflow-language/cwltool)
- cwltool/builder.py:678:24: error[invalid-return-type] Return type does not match returned value: expected `None | int | str | ... omitted 3 union elements`, found `dict[object, None | int | str | ... omitted 4 union elements]`
+ cwltool/builder.py:678:24: error[invalid-return-type] Return type does not match returned value: expected `None | int | str | ... omitted 3 union elements`, found `dict[object, Unknown | None | int | ... omitted 4 union elements]`
- tests/test_provenance.py:638:41: error[invalid-argument-type] Argument to function `_arcp2file` is incorrect: Expected `str`, found `Node | Unknown`
+ tests/test_provenance.py:638:41: error[invalid-argument-type] Argument to function `_arcp2file` is incorrect: Expected `str`, found `Unknown | Node`
- tests/test_provenance.py:639:43: error[invalid-argument-type] Argument to bound method `parse` is incorrect: Expected `str | None`, found `Node | Unknown`
+ tests/test_provenance.py:639:43: error[invalid-argument-type] Argument to bound method `parse` is incorrect: Expected `str | None`, found `Unknown | Node`

strawberry (https://github.com/strawberry-graphql/strawberry)
- strawberry/experimental/pydantic/error_type.py:106:70: error[invalid-assignment] Object of type `list[tuple[Any, @Todo | type[list[Unknown]], dataclasses.Field[None]] | Unknown]` is not assignable to `list[tuple[str, Any, Field[Unknown]]]`
+ strawberry/experimental/pydantic/error_type.py:106:70: error[invalid-assignment] Object of type `list[tuple[str, Any, Field[Unknown]] | tuple[Any, @Todo | type[list[Unknown]], dataclasses.Field[None | Field[Unknown]]]]` is not assignable to `list[tuple[str, Any, Field[Unknown]]]`
- strawberry/permission.py:163:35: error[not-iterable] Object of type `list[~AlwaysFalsy | Unknown]` is not iterable
+ strawberry/permission.py:163:35: error[not-iterable] Object of type `list[Unknown | ~AlwaysFalsy]` is not iterable

apprise (https://github.com/caronc/apprise)
- apprise/persistent_store.py:1538:35: error[invalid-argument-type] Argument to function `unlink` is incorrect: Expected `str | bytes | PathLike[str] | PathLike[bytes]`, found `int | str | bytes | ... omitted 3 union elements`
+ apprise/persistent_store.py:1538:35: error[invalid-argument-type] Argument to function `unlink` is incorrect: Expected `str | bytes | PathLike[str] | PathLike[bytes]`, found `Unknown | int | str | ... omitted 3 union elements`
- apprise/plugins/email/base.py:1048:28: error[invalid-assignment] Object of type `list[str | Unknown]` is not assignable to `set[Unknown] | None`
+ apprise/plugins/email/base.py:1048:28: error[invalid-assignment] Object of type `list[Unknown | str]` is not assignable to `set[Unknown] | None`

hydra-zen (https://github.com/mit-ll-responsible-ai/hydra-zen)
- src/hydra_zen/structured_configs/_implementations.py:1325:20: error[invalid-return-type] Return type does not match returned value: expected `_T@_sanitize_collection`, found `dict[int | None | float | ... omitted 13 union elements, int | None | float | ... omitted 13 union elements]`
+ src/hydra_zen/structured_configs/_implementations.py:1325:20: error[invalid-return-type] Return type does not match returned value: expected `_T@_sanitize_collection`, found `dict[Unknown | int | None | ... omitted 13 union elements, Unknown | int | None | ... omitted 13 union elements]`
- src/hydra_zen/structured_configs/_implementations.py:2879:60: error[invalid-argument-type] Argument to bound method `append` is incorrect: Expected `tuple[str, type, Field[Any]]`, found `tuple[str | @Todo, ...]`
+ src/hydra_zen/structured_configs/_implementations.py:2879:60: error[invalid-argument-type] Argument to bound method `append` is incorrect: Expected `tuple[str, type, Field[Any]]`, found `tuple[Unknown | str, ...]`

prefect (https://github.com/PrefectHQ/prefect)
- src/prefect/_vendor/croniter/croniter.py:1080:21: error[unsupported-operator] Operator `+=` is not supported between objects of type `list[LiteralString]` and `list[str | Unknown | int]`
+ src/prefect/_vendor/croniter/croniter.py:1080:21: error[unsupported-operator] Operator `+=` is not supported between objects of type `list[LiteralString]` and `list[Unknown | str | int]`
- src/prefect/cli/flow_run.py:264:40: error[invalid-argument-type] Argument is incorrect: Expected `FlowFilterId | None`, found `dict[Unknown | str, Unknown | list[UUID | Unknown]]`
+ src/prefect/cli/flow_run.py:264:40: error[invalid-argument-type] Argument is incorrect: Expected `FlowFilterId | None`, found `dict[Unknown | str, Unknown | list[Unknown | UUID]]`
- src/prefect/cli/work_queue.py:403:60: error[invalid-argument-type] Argument is incorrect: Expected `list[UUID] | None`, found `list[UUID | None | Unknown]`
+ src/prefect/cli/work_queue.py:403:60: error[invalid-argument-type] Argument is incorrect: Expected `list[UUID] | None`, found `list[Unknown | UUID | None]`
- src/prefect/deployments/flow_runs.py:198:13: error[invalid-argument-type] Argument to bound method `create_task_run` is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]] | None`, found `dict[str | Unknown, set[TaskRunResult | FlowRunResult] | Unknown]`
+ src/prefect/deployments/flow_runs.py:198:13: error[invalid-argument-type] Argument to bound method `create_task_run` is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]] | None`, found `dict[Unknown | str, Unknown | set[TaskRunResult | FlowRunResult]]`
- src/prefect/deployments/flow_runs.py:395:17: error[invalid-argument-type] Argument to bound method `create_task_run` is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]] | None`, found `dict[str | Unknown, set[TaskRunResult | FlowRunResult] | Unknown]`
+ src/prefect/deployments/flow_runs.py:395:17: error[invalid-argument-type] Argument to bound method `create_task_run` is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]] | None`, found `dict[Unknown | str, Unknown | set[TaskRunResult | FlowRunResult]]`
- src/prefect/server/models/block_documents.py:427:47: error[invalid-argument-type] Argument is incorrect: Expected `BlockSchemaFilterId | None`, found `dict[str, list[UUID | Unknown]]`
+ src/prefect/server/models/block_documents.py:427:47: error[invalid-argument-type] Argument is incorrect: Expected `BlockSchemaFilterId | None`, found `dict[str, list[Unknown | UUID]]`
- src/prefect/task_engine.py:167:45: error[invalid-assignment] Object of type `dict[str | Unknown, set[TaskRunResult | FlowRunResult] | Unknown]` is not assignable to `dict[str, set[RunInput]]`
+ src/prefect/task_engine.py:167:45: error[invalid-assignment] Object of type `dict[str, set[RunInput] | set[TaskRunResult | FlowRunResult]]` is not assignable to `dict[str, set[RunInput]]`
- src/prefect/tasks.py:964:17: error[invalid-argument-type] Argument to bound method `create_task_run` is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]] | None`, found `dict[str | Unknown, set[TaskRunResult | FlowRunResult] | Unknown]`
+ src/prefect/tasks.py:964:17: error[invalid-argument-type] Argument to bound method `create_task_run` is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]] | None`, found `dict[Unknown | str, Unknown | set[TaskRunResult | FlowRunResult]]`
- src/prefect/tasks.py:1083:17: error[invalid-argument-type] Argument is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]]`, found `(dict[str | Unknown, set[TaskRunResult | FlowRunResult] | Unknown] &amp; ~AlwaysFalsy) | dict[Unknown, Unknown]`
+ src/prefect/tasks.py:1083:17: error[invalid-argument-type] Argument is incorrect: Expected `dict[str, list[TaskRunResult | FlowRunResult | Parameter | Constant]]`, found `(dict[Unknown | str, Unknown | set[TaskRunResult | FlowRunResult]] &amp; ~AlwaysFalsy) | dict[Unknown, Unknown]`
- src/prefect/tasks.py:1634:20: error[invalid-return-type] Return type does not match returned value: expected `list[State[R@Task]] | PrefectFutureList[R@Task]`, found `list[PrefectDistributedFuture[R@Task] | Unknown] | @Todo`
+ src/prefect/tasks.py:1634:20: error[invalid-return-type] Return type does not match returned value: expected `list[State[R@Task]] | PrefectFutureList[R@Task]`, found `list[Unknown | PrefectDistributedFuture[R@Task]] | @Todo`
- src/prefect/utilities/templating.py:323:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_block_document_references | dict[str, Any]`, found `list[T@resolve_block_document_references | dict[str, Any] | Unknown]`
+ src/prefect/utilities/templating.py:323:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_block_document_references | dict[str, Any]`, found `list[Unknown | T@resolve_block_document_references | dict[str, Any]]`
- src/prefect/utilities/templating.py:437:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `dict[object, T@resolve_variables | Unknown]`
+ src/prefect/utilities/templating.py:437:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `dict[object, Unknown | T@resolve_variables]`
- src/prefect/utilities/templating.py:442:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `list[T@resolve_variables | Unknown]`
+ src/prefect/utilities/templating.py:442:16: error[invalid-return-type] Return type does not match returned value: expected `T@resolve_variables`, found `list[Unknown | T@resolve_variables]`

pwndbg (https://github.com/pwndbg/pwndbg)
- pwndbg/commands/killthreads.py:58:26: error[not-iterable] Object of type `list[int] | None | list[int | Unknown]` may not be iterable
+ pwndbg/commands/killthreads.py:58:26: error[not-iterable] Object of type `list[int] | None | list[Unknown | int]` may not be iterable
- pwndbg/commands/killthreads.py:71:62: error[not-iterable] Object of type `list[int] | None | list[int | Unknown]` may not be iterable
+ pwndbg/commands/killthreads.py:71:62: error[not-iterable] Object of type `list[int] | None | list[Unknown | int]` may not be iterable
- pwndbg/dbg_mod/__init__.py:905:16: error[invalid-return-type] Return type does not match returned value: expected `list[str]`, found `list[Unknown | str | None]`
+ pwndbg/dbg_mod/__init__.py:905:16: error[invalid-return-type] Return type does not match returned value: expected `list[str]`, found `list[str | Unknown | None]`
- pwndbg/gdblib/shellcode.py:105:46: error[invalid-argument-type] Argument to function `read` is incorrect: Expected `int`, found `int | None | Unknown`
+ pwndbg/gdblib/shellcode.py:105:46: error[invalid-argument-type] Argument to function `read` is incorrect: Expected `int`, found `Unknown | int | None`
- pwndbg/gdblib/shellcode.py:106:31: error[invalid-argument-type] Argument to function `write` is incorrect: Expected `int`, found `int | None | Unknown`
+ pwndbg/gdblib/shellcode.py:106:31: error[invalid-argument-type] Argument to function `write` is incorrect: Expected `int`, found `Unknown | int | None`
- pwndbg/gdblib/shellcode.py:125:22: error[unsupported-operator] Operator `+` is not supported between objects of type `int | None | Unknown` and `int`
+ pwndbg/gdblib/shellcode.py:125:22: error[unsupported-operator] Operator `+` is not supported between objects of type `Unknown | int | None` and `int`
- pwndbg/gdblib/shellcode.py:148:31: error[invalid-argument-type] Argument to function `write` is incorrect: Expected `int`, found `int | None | Unknown`
+ pwndbg/gdblib/shellcode.py:148:31: error[invalid-argument-type] Argument to function `write` is incorrect: Expected `int`, found `Unknown | int | None`
- pwndbg/gdblib/shellcode.py:149:50: error[invalid-argument-type] Argument to bound method `write_reg` is incorrect: Expected `int`, found `int | None | Unknown`
+ pwndbg/gdblib/shellcode.py:149:50: error[invalid-argument-type] Argument to bound method `write_reg` is incorrect: Expected `int`, found `Unknown | int | None`
- pwndbg/gdblib/shellcode.py:152:46: error[invalid-argument-type] Argument to bound method `write_reg` is incorrect: Expected `int`, found `int | None | Unknown`
+ pwndbg/gdblib/shellcode.py:152:46: error[invalid-argument-type] Argument to bound method `write_reg` is incorrect: Expected `int`, found `Unknown | int | None`

pycryptodome (https://github.com/Legrandin/pycryptodome)
- lib/Crypto/Cipher/_mode_kw.py:25:12: error[invalid-return-type] Return type does not match returned value: expected `bytes`, found `bytes | bytearray | Unknown`
+ lib/Crypto/Cipher/_mode_kw.py:25:12: error[invalid-return-type] Return type does not match returned value: expected `bytes`, found `Unknown | bytes | bytearray`
- lib/Crypto/Cipher/_mode_kw.py:39:36: error[invalid-argument-type] Argument to function `strxor` is incorrect: Expected `bytes`, found `bytes | bytearray | Unknown`
+ lib/Crypto/Cipher/_mode_kw.py:39:36: error[invalid-argument-type] Argument to function `strxor` is incorrect: Expected `bytes`, found `Unknown | bytes | bytearray`
- lib/Crypto/Cipher/_mode_kw.py:43:12: error[invalid-return-type] Return type does not match returned value: expected `bytes`, found `bytes | bytearray | Unknown`
+ lib/Crypto/Cipher/_mode_kw.py:43:12: error[invalid-return-type] Return type does not match returned value: expected `bytes`, found `Unknown | bytes | bytearray`
- lib/Crypto/IO/_PBES.py:531:26: error[invalid-argument-type] Argument to function `scrypt` is incorrect: Expected `int`, found `None | Unknown`
+ lib/Crypto/IO/_PBES.py:531:26: error[invalid-argument-type] Argument to function `scrypt` is incorrect: Expected `int`, found `Unknown | None`
- lib/Crypto/IO/_PBES.py:531:36: error[invalid-argument-type] Argument to function `scrypt` is incorrect: Expected `int`, found `None | Unknown`
+ lib/Crypto/IO/_PBES.py:531:36: error[invalid-argument-type] Argument to function `scrypt` is incorrect: Expected `int`, found `Unknown | None`
- lib/Crypto/SelfTest/Cipher/test_pkcs1_oaep.py:275:37: error[invalid-argument-type] Argument to function `construct` is incorrect: Expected `tuple[int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase]`, found `list[int | Unknown]`
+ lib/Crypto/SelfTest/Cipher/test_pkcs1_oaep.py:275:37: error[invalid-argument-type] Argument to function `construct` is incorrect: Expected `tuple[int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase]`, found `list[Unknown | int]`
- lib/Crypto/SelfTest/Cipher/test_pkcs1_oaep.py:306:37: error[invalid-argument-type] Argument to function `construct` is incorrect: Expected `tuple[int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase, int | IntegerBase]`, found `list[int | Unknown]`
+ lib/Crypto/SelfTest/Cipher/test_pkcs1_oaep.py:306:37: error[invalid-argument-type] Argument to function `construct` is incorrect: Expected `tuple[int | IntegerBase, int | IntegerBase] | tuple[int | IntegerBase, int | IntegerBase, int | IntegerBase]

... (truncated 526 lines) ...
</code></pre>
</details>

<details>
<summary>Memory usage changes were detected when running on open source projects</summary>

<pre><code class="language-diff">trio (https://github.com/python-trio/trio)
-     struct fields = ~12MB
+     struct fields = ~11MB


</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by @ibraheemdev on 2026-01-14 01:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-14 02:00</div>
            <div class="timeline-body"><!-- generated-comment ty ecosystem-analyzer -->

<h2><code>ecosystem-analyzer</code> results</h2>
<p>| Lint rule | Added | Removed | Changed |
|-----------|------:|--------:|--------:|
| <code>invalid-argument-type</code> | 1 | 12 | 137 |
| <code>possibly-missing-attribute</code> | 0 | 1 | 70 |
| <code>invalid-return-type</code> | 1 | 21 | 38 |
| <code>invalid-assignment</code> | 1 | 20 | 35 |
| <code>unsupported-operator</code> | 0 | 0 | 31 |
| <code>not-iterable</code> | 0 | 0 | 9 |
| <code>type-assertion-failure</code> | 0 | 0 | 8 |
| <code>not-subscriptable</code> | 0 | 0 | 6 |
| <code>unused-ignore-comment</code> | 2 | 0 | 0 |
| <strong>Total</strong> | <strong>5</strong> | <strong>54</strong> | <strong>334</strong> |</p>
<p><strong><a href="https://09fb55a6.ty-ecosystem-ext.pages.dev/diff">Full report with detailed diff</a></strong> (<a href="https://09fb55a6.ty-ecosystem-ext.pages.dev/timing">timing results</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2026-01-15 20:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:470 on 2026-01-15 20:27</div>
            <div class="timeline-body"><p>I think this can mean the LSP shows a different type than the inferred type? We may have to infer the parent scope here (if the expression is within a comprehension scope, at least).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2026-01-16 07:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:470 on 2026-01-16 07:57</div>
            <div class="timeline-body"><p>Having specific implementations for comprehension (and other expressions that require bidi) that uses the outer scope does make sense to me (I wasn't aware when I added the implementation that scope could be narrow er than a block)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:470 on 2026-01-16 20:22</div>
            <div class="timeline-body"><p>Yeah, I feel like deferring to the parent scope here if given a comprehension scope would be consistent with the general approach in this PR. Add a TODO?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ty_python_semantic/src/types.rs</code>:210 on 2026-01-16 20:24</div>
            <div class="timeline-body"><p>Similar to the SemanticModel comment, it might be useful to have a helper that doesn't take a type context and infers the parent scope instead (for comprehensions). We might also need to merge comprehension scopes into their parent scope <code>TypeInference</code> for this to work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ty_python_semantic/src/types/infer/builder.rs</code>:10233 on 2026-01-16 20:27</div>
            <div class="timeline-body"><p>In order to handle some of the other comments about &quot;external&quot; <code>infer_scope_types</code> requests for comprehension scopes, we might need to do a full extend here (incl expression and definition types, not just diagnostics)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/carljm">@carljm</a> on <code>crates/ty_python_semantic/src/types/infer/builder.rs</code>:10276 on 2026-01-16 20:28</div>
            <div class="timeline-body"><p>This is still a fair bit to duplicate for all comprehension kinds... seems like <code>KnownClass::Set</code> is the only set-distinct thing in here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> approved on 2026-01-16 20:29</div>
            <div class="timeline-body"><p>Looks good!</p>
<p>I'm guessing we may want similar treatment for generator expressions at some point, but those have enough of their own wrinkles that it makes sense to handle them separately.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-19 23:39:49 UTC
    </footer>
</body>
</html>
