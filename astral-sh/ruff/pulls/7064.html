<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add alpha instructions to the `ruff_python_formatter` README - astral-sh/ruff #7064</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add alpha instructions to the <code>ruff_python_formatter</code> README</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/7064">#7064</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-09-02 16:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Adds instructions to cover the formatter's goals, current status, and how-to for using it (in its alpha state) via the CLI and VS Code extension.</p>
<p>I haven't yet documented the known deviations from Black. I will fill those in.</p>
<p>Edit Micha: <a href="https://github.com/astral-sh/ruff/blob/charlie/formatter/crates/ruff_python_formatter/README.md">Rendered Readme</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @charliermarsh on 2023-09-02 16:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @charliermarsh on 2023-09-02 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2023-09-02 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2023-09-02 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-02 16:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/README.md</code>:133 on 2023-09-02 16:35</div>
            <div class="timeline-body"><p>What do you think is the right format here? Just copy over the deviations we started cataloging in Notion, and then use this as the source of truth? It's nice to set this up such that we can link to sections here when folks file issues with known deviations.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>.pre-commit-config.yaml</code>:27 on 2023-09-03 22:05</div>
            <div class="timeline-body"><p>This is causing problems since we now have intentional non-Black-formatted snippets in the README. It seems like we'll run into this often now that we use our own formatter. I'm partial to removing, but also happy to add a file exclusion here if there's any hesitancy.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-03 22:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Alpha" by @MichaReiser on 2023-09-04 09:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:12 on 2023-09-04 09:10</div>
            <div class="timeline-body"><p>We may need to be careful with the framing around <em>direct integration</em> with Ruff depending on the outcome of our outstanding discussion on aligning the configuration / CLI interface.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:15 on 2023-09-04 09:11</div>
            <div class="timeline-body"><p>TODO: Add explanation link for Jaccard similarity</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:22 on 2023-09-04 09:11</div>
            <div class="timeline-body"><pre><code class="language-suggestion">filed in the issue tracker. If you've identified a new deviation, please [file an issue](https://github.com/astral-sh/ruff/issues/new).
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:49 on 2023-09-04 09:13</div>
            <div class="timeline-body"><p>What's the use case for this option? What gets written to the file when using <code>ruff format --check --o file.txt</code>?</p>
<p>The default isn't correct. The default is to overwrite the input file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:51 on 2023-09-04 09:13</div>
            <div class="timeline-body"><p>The formatter only supports [Python version that supports parenthesized with items, Py311]. I think we should remove this option for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:78 on 2023-09-04 09:14</div>
            <div class="timeline-body"><p>I would not make this promise today because there's an outstanding discussion about whether we want to do this (we're leaning towards yes, but it comes back to how tightly we want to integrate the formatter into ruff)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:82 on 2023-09-04 09:15</div>
            <div class="timeline-body"><p>TODO for the future: Rename the extension to <code>astral.ruff</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:98 on 2023-09-04 09:16</div>
            <div class="timeline-body"><p>Should we add a note that we plan to add range formatting in future releases?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:114 on 2023-09-04 09:16</div>
            <div class="timeline-body"><p>The <em>on the CLI</em> is unclear to me. How can I provide the line length via the CLI?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:117 on 2023-09-04 09:17</div>
            <div class="timeline-body"><p>Depending on how complete the list should be:</p>
<ul>
<li>missing semicolons</li>
<li>line ending</li>
<li>tab width</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:172 on 2023-09-04 09:19</div>
            <div class="timeline-body"><pre><code class="language-suggestion">Pragma comments (`# type:`, `# noqa`, `pyright:`, and `pylint:`) are ignored when computing the width of a line.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:179 on 2023-09-04 09:20</div>
            <div class="timeline-body"><p>Black's behavior for <code>type: ignore</code> is different: It avoids splitting any line that has a type ignore comment, limiting formatting mainly to normalizing spaces.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:207 on 2023-09-04 09:21</div>
            <div class="timeline-body"><p>It may be worth specifying the main difference is that Ruff uses the unicode width for identifiers and comments in addition to strings (Black)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-09-04 09:26</div>
            <div class="timeline-body"><p>This is a nice write-up! I think we need to revisit the format CLI options (CC: @konstin)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-09-04 09:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:304 on 2023-09-04 09:27</div>
            <div class="timeline-body"><p>Is the goal to document all deviations or the most prominent once? There are e.g. some more string formatting deviations https://www.notion.so/astral-sh/Black-Deviations-65977bec23b64aee9d28cc1787badfdb?pvs=4#df068d4a5638465ab95e944f45daac55</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-09-04 09:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/README.md</code>:15 on 2023-09-04 09:46</div>
            <div class="timeline-body"><p>i'm fine with stating this as &quot;&gt;99.9% of lines on projects [...] are formatted identical to black&quot;, the exact metric chosen doesn't correlate strongly with the user experience.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/README.md</code>:7 on 2023-09-04 09:49</div>
            <div class="timeline-body"><p>Do we want to make a dedicated discussion/issue/form/etc. for feedback?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-04 10:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/README.md</code>:49 on 2023-09-04 10:13</div>
            <div class="timeline-body"><p>Ah yeah, we should probably remove this. It may write the formatter output (but not the changed file), or nothing at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-04 10:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/README.md</code>:51 on 2023-09-04 10:13</div>
            <div class="timeline-body"><p>Is it the case that we would add parentheses that weren’t already present here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/README.md</code>:304 on 2023-09-04 10:15</div>
            <div class="timeline-body"><p>My hope was to document all intentional deviations here so that we have something to link to when issues come in (and we don’t have to re-explain them every time). Meanwhile, unintentional deviations (which we intend to fix) would be tracked in the issue tracker. So I do think it’d be useful to track all intentional deviations here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-04 10:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/README.md</code>:51 on 2023-09-04 11:58</div>
            <div class="timeline-body"><p>I'm &quot;Currently has no effect&quot; without removing it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/README.md</code>:119 on 2023-09-04 12:00</div>
            <div class="timeline-body"><pre><code class="language-suggestion">### Excluding code from formatting
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/README.md</code>:172 on 2023-09-04 12:02</div>
            <div class="timeline-body"><p>I like <code># type: ignore</code>, you shouldn't be using other type comments anymore (they were a python 2 compatibility layer)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2023-09-04 12:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-09-04 14:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/README.md</code>:172 on 2023-09-04 14:48</div>
            <div class="timeline-body"><p>The reason I would change it is because the formatter excludes all comments starting with <code>type: </code> from the measured width, not just <code>type: ignore</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-04 16:16</div>
            <div class="timeline-body"><p>Thanks all. Since there aren’t any objections to the overall structure, I’ll probably do one pass on this based on feedback, then merge and we can follow-up in subsequent PRs.</p>
<p>I’ll also make some edits to the CLI (remove output file for the formatted, tweak the comment on version), but anyone is welcome to beat me to those.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tmke8">@tmke8</a> reviewed on 2023-09-05 10:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/tmke8">@tmke8</a> on <code>crates/ruff_python_formatter/README.md</code>:261 on 2023-09-05 10:19</div>
            <div class="timeline-body"><p>I think this docstring should be single-quoted, given the above description?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/T-256">@T-256</a> reviewed on 2023-09-05 16:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/T-256">@T-256</a> on <code>crates/ruff_python_formatter/README.md</code>:252 on 2023-09-05 16:08</div>
            <div class="timeline-body"><pre><code class="language-suggestion">### Insert newlines on all docstrings literals
</code></pre>
<p>IIUC here by <code>single-quoted</code> you mean <code>&quot;</code> and <code>'</code>.
<code>single-quoted</code> word has problem for others to understand, first time I thought it means just <code>'</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-05 17:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/README.md</code>:261 on 2023-09-05 17:05</div>
            <div class="timeline-body"><p>Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-09-05 17:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_formatter/README.md</code>:7 on 2023-09-05 17:08</div>
            <div class="timeline-body"><p>This would be a good use-case for issue templates...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-09-06 11:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-09-06 11:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-09-06 11:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-09-06 12:01</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Ecosystem</h3>
<p>✅ ecosystem check detected no changes.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:59:59 UTC
    </footer>
</body>
</html>
