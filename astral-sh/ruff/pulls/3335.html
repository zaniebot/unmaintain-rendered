<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Azure Devops as a `-format` option. - astral-sh/ruff #3335</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add Azure Devops as a <code>-format</code> option.</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/3335">#3335</a>
        opened by <a href="https://github.com/StefanBRas">@StefanBRas</a>
        on 2023-03-04 13:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/StefanBRas">@StefanBRas</a></div>
            <div class="timeline-body"><p>Adds option to print messages in an error format for azure pipelines, following https://learn.microsoft.com/en-us/azure/devops/pipelines/scripts/logging-commands?view=azure-devops&amp;tabs=bash#usage.</p>
<p>In the command line it looks like:</p>
<pre><code class="language-bash">&gt; cargo run -p ruff_cli -- check ../python_testing/example_tag.py --no-cache --format azure-devops
##vso[task.logissue type=error;sourcepath=/home/stefan/dev/python_testing/example_tag.py;linenumber=2;columnnumber=8;code=F401;]/home/stefan/dev/python_testing/example_tag.py:2:8: F401 `math` imported but unused
##vso[task.logissue type=error;sourcepath=/home/stefan/dev/python_testing/example_tag.py;linenumber=3;columnnumber=8;code=F401;]/home/stefan/dev/python_testing/example_tag.py:3:8: F401 `sys` imported but unused
</code></pre>
<p>In the pipeline logs it shows as:
<img src="https://user-images.githubusercontent.com/28559054/222903613-7322cf5a-70eb-4cfd-8cbc-ce492395e5b4.png" alt="image" />
And in the pipeline summary it shows as:
<img src="https://user-images.githubusercontent.com/28559054/222903639-b90ea063-0286-4afb-b4af-1b1bda1ca3e4.png" alt="image" /></p>
<p>Which isn't particularly pretty but apparently how Azure Devops think it should be displayed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-04 19:18</div>
            <div class="timeline-body"><p>Thanks!</p>
<blockquote>
<p>I'm not sure if it makes sense have the error information in both the message and in the logging metadata, as it's then displayed twice but I just followed the same structure as the Github formatting. I can remove it from the message if you want :)</p>
</blockquote>
<p>If the messages appear in the logs without repeating, then they can be omitted. I think we repeat them with GitHub because if you <em>only</em> output the annotations, the messages appear in the PR view but not in the raw logs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-04 19:18</div>
            <div class="timeline-body"><p>Would it be reasonable to shorthand this to <code>azure</code>, rather than <code>azure-devops</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/StefanBRas">@StefanBRas</a> on 2023-03-04 22:22</div>
            <div class="timeline-body"><p>Great, I'll remove the duplicate info then :)</p>
<p>I'm not sure about the renaming, since just &quot;azure&quot; refers to lots of different services where DevOps is one of them. But I can't come up with any other service that needs to emit logs from ruff, so it's probably fine.</p>
<p>I have no strong opinions either way, so I'll just rename it :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-03-06 02:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-03-06 02:48</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:56:31 UTC
    </footer>
</body>
</html>
