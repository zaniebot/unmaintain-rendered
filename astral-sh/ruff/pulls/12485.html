<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pydoclint`] Add `docstring-missing-returns` amd `docstring-extraneous-returns` (`DOC201`, `DOC202`) - astral-sh/ruff #12485</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pydoclint</code>] Add <code>docstring-missing-returns</code> amd <code>docstring-extraneous-returns</code> (<code>DOC201</code>, <code>DOC202</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/12485">#12485</a>
        opened by <a href="https://github.com/augustelalande">@augustelalande</a>
        on 2024-07-24 04:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Add <code>docstring-missing-returns</code> amd <code>docstring-extraneous-returns</code> (<code>DOC201</code>, <code>DOC202</code>). These rules check that the returns defined (or not) in the docstring of a function match its implementation.</p>
<p>Part of #12434.</p>
<h2>Test Plan</h2>
<p>Test cases added.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2024-07-24 04:53</div>
            <div class="timeline-body"><h2><a href="https://codspeed.io/astral-sh/ruff/branches/augustelalande:doc2xx">CodSpeed Performance Report</a></h2>
<h3>Merging #12485 will <strong>not alter performance</strong></h3>
<p><sub>Comparing <code>augustelalande:doc2xx</code> (456db23) with <code>augustelalande:doc2xx</code> (16e30f2)</sub></p>
<h3>Summary</h3>
<p><code>âœ… 33</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-07-24 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">docstring</span> added by @MichaReiser on 2024-07-24 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2024-07-24 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:18 on 2024-07-24 13:24</div>
            <div class="timeline-body"><p>I'm not entirely sure how to phrase it but should the documentation mention that it only applies to functions that have a body with a return statement?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:405 on 2024-07-24 13:26</div>
            <div class="timeline-body"><p>This is not specific to your change but won't this visitor traverse into nested functions?</p>
<pre><code class="language-python">def test():
	def nested():
		return 5

	print(&quot;I never return&quot;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:500 on 2024-07-24 13:28</div>
            <div class="timeline-body"><p>Does emitting a diagnostic for each return statement match the behavior of the upstream rule? It feels a bit verbose to me. What do you think, would it be enough to just flag the first return statement?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/pydoclint/rules/check_docstring.rs</code>:100 on 2024-07-24 13:30</div>
            <div class="timeline-body"><p>As a user, I think it wouldn't be entirely clear to me <strong>why</strong> the docstring doesn't need to contain a return statement. Could we add some explanation around <em>because the function contains no return statement</em>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-07-24 13:31</div>
            <div class="timeline-body"><p>Thanks. This overall looks good to me. I think there's a pre-existing issue around nested functions. I'm okay with merging the PR as is and doing a follow up pr to fix it or fix it in this pr.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2024-07-26 04:06</div>
            <div class="timeline-body"><p>All done</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-07-26 06:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-07-26 06:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-26 15:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:05:29 UTC
    </footer>
</body>
</html>
