<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add AIR301 rule - astral-sh/ruff #17707</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add AIR301 rule</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17707">#17707</a>
        opened by <a href="https://github.com/prabhusneha">@prabhusneha</a>
        on 2025-04-29 14:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/prabhusneha">@prabhusneha</a></div>
            <div class="timeline-body">

Summary
<p>Add &quot;airflow.secrets.cache.SecretCache&quot; â†’ &quot;airflow.sdk.cache.SecretCache&quot; rule</p>


Test Plan


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/prabhusneha">@prabhusneha</a> on 2025-04-29 14:10</div>
            <div class="timeline-body"><p>cc: @Lee-W</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-04-29 21:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/airflow/AIR301_names.py</code>:61 on 2025-04-29 21:53</div>
            <div class="timeline-body"><p>I&#x27;m not seeing this in any of the snapshots, is that expected?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-04-29 21:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/airflow/AIR301_names.py</code>:61 on 2025-04-29 21:54</div>
            <div class="timeline-body"><p>Oh sorry, didn&#x27;t realize it was still a draft!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:685 on 2025-04-30 01:03</div>
            <div class="timeline-body"><pre><code>        [&quot;airflow&quot;, &quot;secrets&quot;, &quot;cache&quot;, &quot;SecretCache&quot;] =&gt; Replacement::AutoImport {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-04-30 01:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/resources/test/fixtures/airflow/AIR301_names.py</code>:61 on 2025-04-30 01:04</div>
            <div class="timeline-body"><p>Nope, just left a comment on it.</p>
<p>We&#x27;re inviting new friends to work with the ruff airflow rules ðŸ™‚</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-04-30 01:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/prabhusneha">@prabhusneha</a> reviewed on 2025-04-30 05:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/prabhusneha">@prabhusneha</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:685 on 2025-04-30 05:44</div>
            <div class="timeline-body"><p>Ah, fixed. Thanks Wei</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/prabhusneha">@prabhusneha</a> reviewed on 2025-04-30 05:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/prabhusneha">@prabhusneha</a> on <code>crates/ruff_linter/resources/test/fixtures/airflow/AIR301_names.py</code>:61 on 2025-04-30 05:46</div>
            <div class="timeline-body"><p>Fixed it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/prabhusneha">@prabhusneha</a> on 2025-04-30 05:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-30 06:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-30 06:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/ntBre">@ntBre</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-30 06:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-04-30 06:32</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>âœ… ecosystem check detected no linter changes.</p>
Linter (preview)
<p>âœ… ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-04-30 06:41</div>
            <div class="timeline-body"><p>This is not in Airflow <code>3.0.0</code> but is expected to be released in 3.0.1. @ntBre is there any suggestion on this case? Should we create a new error? Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-04-30 20:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-30 20:04</div>
            <div class="timeline-body"><p>I think if you want people to be able to enable this separately from the other 3.0 rules, a separate rule would be required. Alternatively, we could hold off on adding this until 3.0.1 is released, if that would work for you all.</p>
<p>Which part is not in 3.0.0? If the replacement is available but the old version isn&#x27;t deleted, I think it could make sense just to enable the rule anyway, but that obviously wouldn&#x27;t make sense if the replacement is only added in 3.0.1.</p>
<p>I&#x27;ll go ahead and review but hold off merging in case you want a separate rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-04-30 21:03</div>
            <div class="timeline-body"><p>I think I&#x27;d prefer to keep it in the same rule, you could update the diagnostic message for the existing rules to make it explicit that this &quot;requires Airflow 3.0 or greater&quot;. It also seems to be something that&#x27;s part of a patch version in Airflow so I&#x27;m assuming that it&#x27;s backwards compatible and as Ruff can&#x27;t detect the dependency version it makes sense that Ruff assumes that users are on the latest version of Airflow 3. I think it&#x27;s the same for NumPy 2.0 deprecation rules if I&#x27;m not mistaken.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-05-06 10:03</div>
            <div class="timeline-body"><blockquote>
<p>we could hold off on adding this until 3.0.1 is released,</p>
</blockquote>
<p>Yep, I think we should hold off till 3.0.1</p>
<blockquote>
<p>Which part is not in 3.0.0?</p>
</blockquote>
<p>The replacement itself. It will be introduced in 3.0.1</p>
<blockquote>
<p>you could update the diagnostic message for the existing rules to make it explicit that this &quot;requires Airflow 3.0 or greater&quot;.</p>
</blockquote>
<p>Yep, I was thinking of something similar. Cool! I&#x27;ll go with this route after 3.0.1 release. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-05-06 13:11</div>
            <div class="timeline-body"><p>I&#x27;ll mark this as a draft until we&#x27;re ready to merge, which sounds like after 3.0.1 is released. Feel free to ping me whenever it&#x27;s ready!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/ntBre">@ntBre</a> on 2025-05-06 13:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-07-10 14:13</div>
            <div class="timeline-body"><p>@Lee-W what&#x27;s the status on this rule? Can we close this PR?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-07-18 14:33</div>
            <div class="timeline-body"><p>Hey, sorry for the late reply. I&#x27;ll take a look tomorrow</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-07-20 20:14</div>
            <div class="timeline-body"><p>I think this is needed and I&#x27;ll take over once I&#x27;m back from my vacaction</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-07-21 06:55</div>
            <div class="timeline-body"><p>Enjoy your vacation</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-08-01 11:12</div>
            <div class="timeline-body"><p>The PR is now ready, but I&#x27;m not allowed to change anything other than code somehow ðŸ¤”</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/prabhusneha">@prabhusneha</a> on 2025-08-01 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-08-08 19:00</div>
            <div class="timeline-body"><p>Still looks good to me, thank you! I think you&#x27;ll just need to resolve the conflicts and then we can merge.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-11 13:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-11 13:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:13:49 UTC
    </footer>
</body>
</html>
