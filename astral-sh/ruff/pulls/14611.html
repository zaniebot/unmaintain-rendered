<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Implemented `used-dummy-variable` (`RUF052`) - astral-sh/ruff #14611</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Implemented <code>used-dummy-variable</code> (<code>RUF052</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14611">#14611</a>
        opened by <a href="https://github.com/Lokejoke">@Lokejoke</a>
        on 2024-11-26 13:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>This PR implements <code>wps</code> rule <a href="https://wemake-python-styleguide.readthedocs.io/en/0.19.2/pages/usage/violations/naming.html#wemake_python_styleguide.violations.naming.UnusedVariableIsUsedViolation">unused-variable-accessed</a>; discussed <a href="https://github.com/astral-sh/ruff/discussions/14437">here</a>.</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<!-- How was it tested? -->

<p><code>cargo test</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-26 13:54</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+761 -1 violations, +0 -0 fixes in 19 projects; 36 projects unchanged)</p>
<details><summary><a href="https://github.com/DisnakeDev/disnake">DisnakeDev/disnake</a> (+21 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/errors.py#L80'>disnake/errors.py:80:17:</a> RUF052 [*] Local dummy variable `_errors` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/ext/commands/converter.py#L1189'>disnake/ext/commands/converter.py:1189:33:</a> RUF052 [*] Local dummy variable `_GenericAlias` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/ext/commands/converter.py#L1294'>disnake/ext/commands/converter.py:1294:9:</a> RUF052 [*] Local dummy variable `_NoneType` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/ext/commands/help.py#L211'>disnake/ext/commands/help.py:211:37:</a> RUF052 [*] Local dummy variable `_original` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/ext/commands/help.py#L217'>disnake/ext/commands/help.py:217:38:</a> RUF052 [*] Local dummy variable `_original` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/ext/commands/view.py#L118'>disnake/ext/commands/view.py:118:13:</a> RUF052 [*] Local dummy variable `_escaped_quotes` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/guild.py#L5159'>disnake/guild.py:5159:9:</a> RUF052 [*] Local dummy variable `_id` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/guild.py#L5309'>disnake/guild.py:5309:9:</a> RUF052 [*] Local dummy variable `_id` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/guild.py#L5357'>disnake/guild.py:5357:9:</a> RUF052 [*] Local dummy variable `_id` is accessed
+ <a href='https://github.com/DisnakeDev/disnake/blob/2dab45c84f4454ccf2c2a2efd7e819e06f1551c0/disnake/guild.py#L5405'>disnake/guild.py:5405:9:</a> RUF052 [*] Local dummy variable `_id` is accessed
... 11 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+84 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/api.py#L42'>rasa/api.py:42:5:</a> RUF052 [*] Local dummy variable `_endpoints` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/actions/action.py#L1218'>rasa/core/actions/action.py:1218:9:</a> RUF052 [*] Local dummy variable `_tracker` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/actions/action.py#L603'>rasa/core/actions/action.py:603:9:</a> RUF052 [*] Local dummy variable `_events` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/actions/forms.py#L274'>rasa/core/actions/forms.py:274:9:</a> RUF052 [*] Local dummy variable `_tracker` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/actions/forms.py#L276'>rasa/core/actions/forms.py:276:9:</a> RUF052 [*] Local dummy variable `_action` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/actions/two_stage_fallback.py#L85'>rasa/core/actions/two_stage_fallback.py:85:9:</a> RUF052 [*] Local dummy variable `_user_clarified` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/exporter.py#L235'>rasa/core/exporter.py:235:13:</a> RUF052 [*] Local dummy variable `_events` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/policies/ted_policy.py#L1786'>rasa/core/policies/ted_policy.py:1786:21:</a> RUF052 [*] Local dummy variable `_text_output` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/policies/ted_policy.py#L1787'>rasa/core/policies/ted_policy.py:1787:21:</a> RUF052 [*] Local dummy variable `_text_sequence_lengths` is accessed
+ <a href='https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/policies/ted_policy.py#L2144'>rasa/core/policies/ted_policy.py:2144:9:</a> RUF052 [*] Local dummy variable `_logits` is accessed
... 74 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+238 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/api_connexion/endpoints/pool_endpoint.py#L135'>airflow/api_connexion/endpoints/pool_endpoint.py:135:9:</a> RUF052 [*] Local dummy variable `_patch_body` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/assets/manager.py#L280'>airflow/assets/manager.py:280:5:</a> RUF052 [*] Local dummy variable `_asset_manager_class` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/assets/manager.py#L285'>airflow/assets/manager.py:285:5:</a> RUF052 [*] Local dummy variable `_asset_manager_kwargs` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/cli/commands/connection_command.py#L152'>airflow/cli/commands/connection_command.py:152:5:</a> RUF052 [*] Local dummy variable `_connection_types` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/cli/commands/info_command.py#L263'>airflow/cli/commands/info_command.py:263:9:</a> RUF052 [*] Local dummy variable `_locale` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/cli/commands/task_command.py#L456'>airflow/cli/commands/task_command.py:456:9:</a> RUF052 [*] Local dummy variable `_dag` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/configuration.py#L1300'>airflow/configuration.py:1300:13:</a> RUF052 [*] Local dummy variable `_section` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/configuration.py#L887'>airflow/configuration.py:887:9:</a> RUF052 [*] Local dummy variable `_extra_stacklevel` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/dag_processing/processor.py#L237'>airflow/dag_processing/processor.py:237:26:</a> RUF052 [*] Local dummy variable `_child_channel` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/dag_processing/processor.py#L237'>airflow/dag_processing/processor.py:237:9:</a> RUF052 [*] Local dummy variable `_parent_channel` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/decorators/base.py#L483'>airflow/decorators/base.py:483:9:</a> RUF052 [*] Local dummy variable `_MappedOperator` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/decorators/setup_teardown.py#L42'>airflow/decorators/setup_teardown.py:42:19:</a> RUF052 [*] Local dummy variable `_func` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/executors/executor_loader.py#L211'>airflow/executors/executor_loader.py:211:13:</a> RUF052 [*] Local dummy variable `_executor_name` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/io/path.py#L394'>airflow/io/path.py:394:9:</a> RUF052 [*] Local dummy variable `_kwargs` is accessed
+ <a href='https://github.com/apache/airflow/blob/ea0339ed4609b025e4e94dd13dfa6948ea3b6942/airflow/io/path.py#L408'>airflow/io/path.py:408:9:</a> RUF052 [*] Local dummy variable `_kwargs` is accessed
... 223 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/superset">apache/superset</a> (+42 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/common/query_object_factory.py#L47'>superset/common/query_object_factory.py:47:9:</a> RUF052 [*] Local dummy variable `_datasource_dao` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/connectors/sqla/models.py#L461'>superset/connectors/sqla/models.py:461:17:</a> RUF052 [*] Local dummy variable `_columns` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/db_engine_specs/presto.py#L149'>superset/db_engine_specs/presto.py:149:13:</a> RUF052 [*] Local dummy variable `_column` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/migrations/versions/2018-11-12_13-31_4ce8df208545_migrate_time_range_for_default_filters.py#L71'>superset/migrations/versions/2018-11-12_13-31_4ce8df208545_migrate_time_range_for_default_filters.py:71:29:</a> RUF052 [*] Local dummy variable `__from` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/migrations/versions/2018-11-12_13-31_4ce8df208545_migrate_time_range_for_default_filters.py#L72'>superset/migrations/versions/2018-11-12_13-31_4ce8df208545_migrate_time_range_for_default_filters.py:72:29:</a> RUF052 [*] Local dummy variable `__to` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/models/helpers.py#L1648'>superset/models/helpers.py:1648:21:</a> RUF052 [*] Local dummy variable `_sql` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/models/helpers.py#L1649'>superset/models/helpers.py:1649:21:</a> RUF052 [*] Local dummy variable `_column_label` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/models/helpers.py#L1896'>superset/models/helpers.py:1896:25:</a> RUF052 [*] Local dummy variable `_since` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/models/helpers.py#L1896'>superset/models/helpers.py:1896:33:</a> RUF052 [*] Local dummy variable `_until` is accessed
+ <a href='https://github.com/apache/superset/blob/deec63bb5bb462c8d29ce7d85e0c2628c7ce3309/superset/utils/date_parser.py#L180'>superset/utils/date_parser.py:180:5:</a> RUF052 [*] Local dummy variable `_relative_start` is accessed
... 32 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+21 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/application/handlers/code_runner.py#L219'>src/bokeh/application/handlers/code_runner.py:219:9:</a> RUF052 [*] Local dummy variable `_cwd` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/application/handlers/code_runner.py#L220'>src/bokeh/application/handlers/code_runner.py:220:9:</a> RUF052 [*] Local dummy variable `_sys_path` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/application/handlers/code_runner.py#L221'>src/bokeh/application/handlers/code_runner.py:221:9:</a> RUF052 [*] Local dummy variable `_sys_argv` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/command/subcommands/static.py#L79'>src/bokeh/command/subcommands/static.py:79:9:</a> RUF052 [*] Local dummy variable `_allowed_keys` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/has_props.py#L521'>src/bokeh/core/has_props.py:521:28:</a> RUF052 [*] Local dummy variable `_with_props` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/core/property/bases.py#L450'>src/bokeh/core/property/bases.py:450:9:</a> RUF052 [*] Local dummy variable `_type_params` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/embed/standalone.py#L302'>src/bokeh/embed/standalone.py:302:15:</a> RUF052 [*] Local dummy variable `_always_new` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/layouts.py#L117'>src/bokeh/layouts.py:117:5:</a> RUF052 [*] Local dummy variable `_children` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/layouts.py#L152'>src/bokeh/layouts.py:152:5:</a> RUF052 [*] Local dummy variable `_children` is accessed
+ <a href='https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/layouts.py#L190'>src/bokeh/layouts.py:190:5:</a> RUF052 [*] Local dummy variable `_children` is accessed
... 11 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+34 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/.github/workflows/algolia/upload-algolia-api.py#L174'>.github/workflows/algolia/upload-algolia-api.py:174:9:</a> RUF052 [*] Local dummy variable `_creator` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L699'>ibis/backends/datafusion/__init__.py:699:31:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L732'>ibis/backends/datafusion/__init__.py:732:33:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L739'>ibis/backends/datafusion/__init__.py:739:33:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L746'>ibis/backends/datafusion/__init__.py:746:33:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L753'>ibis/backends/datafusion/__init__.py:753:40:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L760'>ibis/backends/datafusion/__init__.py:760:38:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L767'>ibis/backends/datafusion/__init__.py:767:37:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L774'>ibis/backends/datafusion/__init__.py:774:37:</a> RUF052 [*] Local dummy variable `_conn` is accessed
+ <a href='https://github.com/ibis-project/ibis/blob/6cf461ffb9e997337d08c1db766b281bacb1b49b/ibis/backends/datafusion/__init__.py#L781'>ibis/backends/datafusion/__init__.py:781:47:</a> RUF052 [*] Local dummy variable `_conn` is accessed
... 24 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/latchbio/latch">latchbio/latch</a> (+6 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/latchbio/latch/blob/e3b3c0f2992d979450dcd3e012c128f413432a9d/src/latch_cli/services/get_params.py#L140'>src/latch_cli/services/get_params.py:140:17:</a> RUF052 [*] Local dummy variable `_enum_literal` is accessed
+ <a href='https://github.com/latchbio/latch/blob/e3b3c0f2992d979450dcd3e012c128f413432a9d/src/latch_cli/services/get_params.py#L146'>src/latch_cli/services/get_params.py:146:21:</a> RUF052 [*] Local dummy variable `_enum_literal` is accessed
+ <a href='https://github.com/latchbio/latch/blob/e3b3c0f2992d979450dcd3e012c128f413432a9d/src/latch_cli/services/launch.py#L143'>src/latch_cli/services/launch.py:143:5:</a> RUF052 [*] Local dummy variable `_interface_request` is accessed
+ <a href='https://github.com/latchbio/latch/blob/e3b3c0f2992d979450dcd3e012c128f413432a9d/src/latch_cli/services/launch.py#L208'>src/latch_cli/services/launch.py:208:5:</a> RUF052 [*] Local dummy variable `_interface_request` is accessed
+ <a href='https://github.com/latchbio/latch/blob/e3b3c0f2992d979450dcd3e012c128f413432a9d/src/latch_cli/services/register/utils.py#L127'>src/latch_cli/services/register/utils.py:127:5:</a> RUF052 [*] Local dummy variable `_env` is accessed
+ <a href='https://github.com/latchbio/latch/blob/e3b3c0f2992d979450dcd3e012c128f413432a9d/src/latch_cli/services/register/utils.py#L138'>src/latch_cli/services/register/utils.py:138:5:</a> RUF052 [*] Local dummy variable `_serialize_cmd` is accessed
</pre>

</p>
</details>
<details><summary><a href="https://github.com/lnbits/lnbits">lnbits/lnbits</a> (+5 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/lnbits/lnbits/blob/51c9d294cdb40c777b1048bbee267b49cdaf7a34/tests/wallets/fixtures/models.py#L35'>tests/wallets/fixtures/models.py:35:9:</a> RUF052 [*] Local dummy variable `_mock` is accessed
+ <a href='https://github.com/lnbits/lnbits/blob/51c9d294cdb40c777b1048bbee267b49cdaf7a34/tests/wallets/helpers.py#L117'>tests/wallets/helpers.py:117:13:</a> RUF052 [*] Local dummy variable `_assert` is accessed
+ <a href='https://github.com/lnbits/lnbits/blob/51c9d294cdb40c777b1048bbee267b49cdaf7a34/tests/wallets/helpers.py#L80'>tests/wallets/helpers.py:80:36:</a> RUF052 [*] Local dummy variable `_test_data` is accessed
+ <a href='https://github.com/lnbits/lnbits/blob/51c9d294cdb40c777b1048bbee267b49cdaf7a34/tests/wallets/test_rpc_wallets.py#L159'>tests/wallets/test_rpc_wallets.py:159:17:</a> RUF052 [*] Local dummy variable `_mock_class` is accessed
+ <a href='https://github.com/lnbits/lnbits/blob/51c9d294cdb40c777b1048bbee267b49cdaf7a34/tests/wallets/test_rpc_wallets.py#L66'>tests/wallets/test_rpc_wallets.py:66:9:</a> RUF052 [*] Local dummy variable `_mock_class` is accessed
</pre>

</p>
</details>
<details><summary><a href="https://github.com/milvus-io/pymilvus">milvus-io/pymilvus</a> (+16 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/bulk_writer/local_bulk_writer.py#L111'>pymilvus/bulk_writer/local_bulk_writer.py:111:9:</a> RUF052 [*] Local dummy variable `_async` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/abstract.py#L237'>pymilvus/client/abstract.py:237:9:</a> RUF052 [*] Local dummy variable `_dict` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/abstract.py#L818'>pymilvus/client/abstract.py:818:13:</a> RUF052 [*] Local dummy variable `_start` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/abstract.py#L819'>pymilvus/client/abstract.py:819:13:</a> RUF052 [*] Local dummy variable `_end` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/abstract.py#L820'>pymilvus/client/abstract.py:820:13:</a> RUF052 [*] Local dummy variable `_step` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/abstract.py#L90'>pymilvus/client/abstract.py:90:9:</a> RUF052 [*] Local dummy variable `_dict` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/grpc_handler.py#L1172'>pymilvus/client/grpc_handler.py:1172:9:</a> RUF052 [*] Local dummy variable `_async` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/client/grpc_handler.py#L962'>pymilvus/client/grpc_handler.py:962:9:</a> RUF052 [*] Local dummy variable `_async` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/decorators.py#L56'>pymilvus/decorators.py:56:13:</a> RUF052 [*] Local dummy variable `_timeout` is accessed
+ <a href='https://github.com/milvus-io/pymilvus/blob/bd0cbff639e9b87618336b4c4125a4bfecc8eb71/pymilvus/decorators.py#L57'>pymilvus/decorators.py:57:13:</a> RUF052 [*] Local dummy variable `_retry_times` is accessed
... 6 additional changes omitted for project
</pre>

</p>
</details>

<p><em>... Truncated remaining completed project reports due to GitHub comment length restrictions</em></p>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF052 | 760 | 760 | 0 | 0 | 0 |
| DOC201 | 2 | 1 | 1 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @Lokejoke on 2024-11-26 13:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dylwil3 on 2024-11-26 15:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:10 on 2024-11-27 08:27</div>
            <div class="timeline-body"><pre><code class="language-suggestion">/// Checks for usages of variables marked as unused (variable names starting with an underscore, except '_') in functions.
/// Forbid using method and function variables that are marked as unused.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:10 on 2024-11-27 08:27</div>
            <div class="timeline-body"><p>How does the rule detect functions that are marked as unused? How does it distinguish from private functions and methods?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:58 on 2024-11-27 08:33</div>
            <div class="timeline-body"><p>I don't think we want to use <code>is_private_declaration</code> here. Instead we should test if the name starts with an <code>_</code>.  While this is the same as what <code>is_private_declaration</code> does, it has the benefit that future changes to <code>is_private_declaration</code> don't impact the behavior of this rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-27 08:45</div>
            <div class="timeline-body"><p>Thanks. This rule does make sense to me but I'm a bit concerned by the number of violations. What do you think @AlexWaygood?</p>
<p>I think the rule should respect https://docs.astral.sh/ruff/settings/#lint_dummy-variable-rgx as it is the &quot;opposite&quot; of the unused variable rule</p>
<p>I think we should change the rule to report the <em>use</em> of the binding rather than the variable declaration because I noticed when reviewing the ecosystem changes, that I always had to search for the variable use to assess whether the violation is correct. Doing so would match clippy's behavior</p>
<p>We should exclude bindings that are declared as <code>global</code> or <code>nonlocal</code> because it's not in the functions control to change the name https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/jobs.py#L22</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-11-27 08:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-11-27 08:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/snapshots/ruff_linter__rules__ruff__tests__RUF052_RUF052.py.snap</code>:8 on 2024-11-27 08:58</div>
            <div class="timeline-body"><p>Can you tell me a bit more about the reasoning for excluding function parameters from checking? I would have expected that they are handled the same. Or is it to avoid breaking call sites if calls use named arguments?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a> reviewed on 2024-11-27 09:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:10 on 2024-11-27 09:15</div>
            <div class="timeline-body"><p>I believe there is no specific convention for indicating that a function or method is unused (there is only as you described private indication).</p>
<p>This rule focuses only on local variables, such as those defined within methods and functions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on <code>crates/ruff_linter/src/rules/ruff/snapshots/ruff_linter__rules__ruff__tests__RUF052_RUF052.py.snap</code>:8 on 2024-11-27 09:21</div>
            <div class="timeline-body"><p>You are right, parameters should be addressed in the same way.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a> reviewed on 2024-11-27 09:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-27 14:55</div>
            <div class="timeline-body"><p>This rule makes sense to me as well. I agree with @MichaReiser's comment here however:</p>
<blockquote>
<p>We should exclude bindings that are declared as <code>global</code> or <code>nonlocal</code> because it's not in the functions control to change the name <a href="https://github.com/RasaHQ/rasa/blob/b8de3b231126747ff74b2782cb25cb22d2d898d7/rasa/core/jobs.py#L22">RasaHQ/rasa@<code>b8de3b2</code>/rasa/core/jobs.py#L22</a></p>
</blockquote>
<p>Here's another interesting case: https://github.com/DisnakeDev/disnake/blob/2d0f91ad7042d4b331d448678fc6f88b74973947/disnake/guild.py#L5119. I'm not sure whether the rule should or shouldn't flag this -- they've used the leading underscore here specifically because otherwise the variable would shadow a Python builtin. PEP 8 recommends using a trailing underscore for situations like this rather than a leading underscore (<code>id_</code> rather than <code>_id</code>), but it still seems to me like this is a pretty common pattern, and users might be confused if we complained about it. One solution might be to use a different error message if we can see that it would otherwise shadow a builtin, suggesting for them to use a trailing underscore rather than a leading underscore? Ideally I think we'd also emit that different error message if it would otherwise shadow <em>any</em> other variable, including globals, locals and nonlocals, not just builtins.</p>
<p>If we want to go that route, you can use this function to detect whether the symbol would shadow a Python builtin without the leading underscore: https://github.com/astral-sh/ruff/blob/c40b37aa36135283db0b4f16d4582d6879e43cf5/crates/ruff_python_stdlib/src/builtins.rs#L219-L222 And I believe that there are other methods on the semantic model that you can use to detect if a variables is bound in the current scope any enclosing scopes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @MichaReiser on 2024-11-28 09:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:72 on 2024-11-28 11:19</div>
            <div class="timeline-body"><p>we should also exclude dunder variables from this check, I think. You can use this function to determine if a variable has a dunder name or not: https://github.com/astral-sh/ruff/blob/6f1cf5b686e67fb74383641fcbbe98e33481a271/crates/ruff_python_ast/src/helpers.rs#L547-L549</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:81 on 2024-11-28 11:32</div>
            <div class="timeline-body"><p>There's quite a lot packed into this one condition here. I'd do it in a slightly more verbose way: I would find it more readable, as it allows you to add comments explaining the meaning of each check:</p>
<pre><code class="language-suggestion">    // only variables marked as private
    if !name.starts_with('_') || name == &quot;_&quot; || is_dunder(name) {
        return None;
    }

    // only used variables
    if binding.is_unused() {
        return None;
    }

    // Only variables defined via function arguments or assignments.
    // This excludes `global` and `nonlocal` variables.
    if !matches!(
        binding.kind,
        BindingKind::Argument | BindingKind::Assignment
    ) {
        return None;
    }

    // Only variables defined in function scopes
    if !checker.semantic().scopes[binding.scope].kind.is_function() {
        return None;
    }

    if checker.settings.dummy_variable_rgx.is_match(name) {
        return None;
    }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:85 on 2024-11-28 11:32</div>
            <div class="timeline-body"><p>It's fine if you don't want to offer a fix for now, but we shouldn't have commented out code like this</p>
<pre><code class="language-suggestion"></code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:109 on 2024-11-28 11:33</div>
            <div class="timeline-body"><pre><code class="language-suggestion"></code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:11 on 2024-11-28 11:34</div>
            <div class="timeline-body"><p>I'm not sure this sentence in the docs adds much, as you explain the rule pretty well in the next paragraph. I'd take it out:</p>
<pre><code class="language-suggestion"></code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:43 on 2024-11-28 11:35</div>
            <div class="timeline-body"><p>I think some users might be confused about what &quot;marked as unused&quot; means. Let's just be explicit about exactly what we've spotted here (which is that it has a name with a leading underscore)</p>
<pre><code class="language-suggestion">            &quot;Local variable `{}` with leading underscore is accessed&quot;,
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:59 on 2024-11-28 11:36</div>
            <div class="timeline-body"><p>nit: I think these messages can be a bit more concise</p>
<pre><code class="language-suggestion">        Some(match self.shadowed_kind {
            ShadowedKind::BuiltIn =&gt; {
                &quot;Prefer using trailing underscores to avoid shadowing a built-in&quot;
                    .to_string()
            }
            ShadowedKind::Some =&gt; {
                &quot;Prefer using trailing underscores to avoid shadowing a variable&quot;
                    .to_string()
            }
            ShadowedKind::None =&gt; &quot;Remove leading underscores&quot;.to_string(),
        })
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-28 11:36</div>
            <div class="timeline-body"><p>Thank you! This is starting to look pretty good</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on 2024-11-28 11:37</div>
            <div class="timeline-body"><p>It's a pity that the dummy regex, by default, marks every name with a leading underscore as a dummy variable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-28 11:39</div>
            <div class="timeline-body"><blockquote>
<p>It's a pity that the dummy regex, by default, marks every name with a leading underscore as a dummy variable.</p>
</blockquote>
<p>Oh -- I think @MichaReiser possibly was suggesting for you to do the opposite of what you're doing there right now? It makes sense to me that this rule would <em>flag</em> all variables that match the dummy regex (in addition/instead of flagging all variables that have leading underscores) rather than <em>not flagging</em> all variables that match the dummy regex.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on 2024-11-28 11:43</div>
            <div class="timeline-body"><p>Ok, this does make sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:68 on 2024-11-28 12:21</div>
            <div class="timeline-body"><p>I think we actually want this rule to flag all names matching the <code>dummy_variable_rgx</code> <em>even if</em> they don't start with a a leading underscore. You take care of the dummy-variable regex later on in this function, so maybe we should just get rid of this first condition here:</p>
<pre><code class="language-suggestion">    // Ignore `_` and dunder variables
    if name == &quot;_&quot; || is_dunder(name) {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:31 on 2024-11-28 12:24</div>
            <div class="timeline-body"><pre><code class="language-suggestion">/// ```
///
/// ## Options
/// - [`lint.dummy-variable-rgx`]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:131 on 2024-11-28 12:26</div>
            <div class="timeline-body"><p>nit: could you add some doc-comments here?</p>
<pre><code class="language-suggestion">/// Enumeration of various ways in which a binding can shadow other variables
#[derive(Debug, PartialEq, Eq, Copy, Clone)]
enum ShadowedKind {
    /// The variable shadows a global, nonlocal or local symbol
    Some,
    /// The variable shadows a builtin symbol
    BuiltIn,
    /// The variable does not shadow any other symbols
    None,
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-28 12:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a> reviewed on 2024-11-28 12:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:81 on 2024-11-28 12:26</div>
            <div class="timeline-body"><blockquote>
<p>The binding is <code>global.</code> This could be a binding created by a <code>global</code> statement or a
binding that shadows such a binding.
For example, both of the bindings in the following function are <code>global</code>:</p>
</blockquote>
<pre><code class="language-python"> def f():
     global x
     x = 1
</code></pre>
<p>I believe that it checks against new binding when assigned to a variable declared as global, and thus, it must be checked for its 'globalness' - 'nonlocalness'.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-28 12:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:81 on 2024-11-28 12:28</div>
            <div class="timeline-body"><p>yep, great catch! The semantic model is pretty subtle here; sorry for my mistake :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-28 12:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/resources/test/fixtures/ruff/RUF052.py</code>:1 on 2024-11-28 12:28</div>
            <div class="timeline-body"><p>Could you possibly add a test with a local dunder variable to make sure it isn't flagged by the rule?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:68 on 2024-11-28 12:44</div>
            <div class="timeline-body"><p>Should the rule be renamed to dummy-variable-accessed?
If so, then the error messages will need a change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a> reviewed on 2024-11-28 12:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-28 13:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/unused_variable_accessed.rs</code>:68 on 2024-11-28 13:07</div>
            <div class="timeline-body"><p>I think that renaming makes sense. The docs probably also need to talk a little bit more about how the <code>dummy-variable-rgx</code> can be used to customise the behaviour, as well -- it's fine to focus on the default behaviour, but a sentence or two saying how it can be customised would probably be useful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-29 17:24</div>
            <div class="timeline-body"><p>We discussed the rule more internally and concluded that, considering the many violations, we should provide an auto fix.</p>
<p>You could reuse some logic from here</p>
<p>https://github.com/astral-sh/ruff/blob/d9cbf2fe44e3f13b28295377a41ae541cab6b54f/crates/ruff_linter/src/rules/flake8_pyi/rules/unaliased_collections_abc_set_import.rs#L80-L89</p>
<p>We must be careful only to offer a fix if the <code>dummy-variable-regex</code> allows variables starting with an underscore.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on 2024-11-29 20:14</div>
            <div class="timeline-body"><p>Do I list all options? For each dummy, we would match against:
<code>_builtin</code> =&gt; <code>builtin_</code> | <code>no fix</code> if shadows
<code>_var</code> =&gt; <code>var</code> | <code>var_</code> (if <code>var</code> is occupied) | <code>no fix</code> if shadows
<code>dummy</code> =&gt; <code>no fix</code></p>
<p>Should we go back to one diagnostic with one fix renaming the variable?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-29 21:48</div>
            <div class="timeline-body"><blockquote>
<p>Should we go back to one diagnostic with one fix renaming the variable?</p>
</blockquote>
<p>The fix infrastructure should detect that it already applied the fix (or at least, it detects that the two fixes overlap) and skips it. It then rechecks the file, which should not yield any violations after the rename.</p>
<p>What we should do is set <code>Diagnostic::set_parent</code> so that all violations can be suppressed with a single noqa comment where the variable's defined</p>
<blockquote>
<p><em>builtin =&gt; builtin</em> | no fix if shadows
<em>var =&gt; var | var</em> (if var is occupied) | no fix if shadows
dummy =&gt; no fix</p>
</blockquote>
<p>Generatign one fix each should be fine</p>
<ul>
<li>builtins: Change from <code>_builtin</code> to -&gt; <code>bulitin_</code></li>
<li>shadowed: Change from <code>_shadowed</code> to -&gt; <code>shadowed_</code></li>
<li>dummy: Change from <code>_dummy</code> to -&gt; <code>dummy</code></li>
</ul>
<p>But we can also start with adding a fix for dummy only, and then check the ecosystem results to see if it covers most variables.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:32 on 2024-11-30 17:33</div>
            <div class="timeline-body"><pre><code class="language-suggestion">/// Checks for accesses of local dummy variables, excluding `_` and dunder variables.
///
/// By default, &quot;dummy variables&quot; are any variables with names that start with leading
/// underscores. However, this is customisable using the `dummy-variable-rgx` setting).
///
/// ## Why is this bad?
/// Marking a variable with a leading underscore conveys that it is intentionally unused within the function or method.
/// When these variables are later referenced in the code, it causes confusion and potential misunderstandings about
/// the code's intention. A variable marked as &quot;unused&quot; being subsequently used suggests oversight or unintentional use.
/// This detracts from the clarity and maintainability of the codebase.
///
/// ## Example
/// ```python
/// def function():
///     _variable = 3
///     return _variable + 1
/// ```
///
/// Use instead:
/// ```python
/// def function():
///     variable = 3
///     return variable + 1
/// ```
///
/// ## Fix availability
/// An fix is only available for variables that start with leading underscores.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:207 on 2024-11-30 17:37</div>
            <div class="timeline-body"><p>You can use this existing function in our <code>ruff_python_stdlib</code> crate rather than implementing your own:</p>
<p>https://github.com/astral-sh/ruff/blob/be07424e808b667c57e366c645c8aa349257cb7d/crates/ruff_python_stdlib/src/keyword.rs#L2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-11-30 17:42</div>
            <div class="timeline-body"><p>@MichaReiser I know you earlier said:</p>
<blockquote>
<p>I think we should change the rule to report the use of the binding rather than the variable declaration because I noticed when reviewing the ecosystem changes, that I always had to search for the variable use to assess whether the violation is correct. Doing so would match clippy's behavior</p>
</blockquote>
<p>I think the disadvantages of that are:</p>
<ul>
<li>The error here is really in the naming of the variable, not the fact that the variable is used. It's the name of the variable that we're suggesting to the user that they should change, and it's the name that we change for the user as part of the autofix. As such, I find it somewhat surprising that we'd issue diagnostics that point to the uses of the name rather than the name</li>
<li>If the user uses a dummy variable 5 times, I think this implementation currently means that we'd issue 5 diagnostics regarding the dummy variable. But arguably there's only one mistake here, which is the name of the variable at the point where it's bound.</li>
</ul>
<p>Issuing a single diagnostic at the point where the variable is bound also has the advantage of being simpler and more performant in terms of our implementation</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-30 17:44</div>
            <div class="timeline-body"><p>Great work @Lokejoke!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a> reviewed on 2024-11-30 21:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:207 on 2024-11-30 21:30</div>
            <div class="timeline-body"><p>If it's ok, I need to change the visibility of <code>is_keyword</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-11-30 21:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:207 on 2024-11-30 21:47</div>
            <div class="timeline-body"><p>Thanks for checking. Here I think that's fine</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-30 22:34</div>
            <div class="timeline-body"><p>@Lokejoke I wanted to apply some very minor last touchups and then merge, but GitHub won't let me push to your branch (not sure why). The final changes I wanted to apply were these, if you'd be able to apply them. Mostly they're cosmetic, but I switched the use of <code>scope.has()</code> to <code>!semantic.is_available()</code> in two places. This makes the autofix more cautious, as it also checks for the new proposed name of the variable in enclosing scopes as well as just in the local scope:</p>
<details>

<pre><code class="language-diff">--- a/crates/ruff_linter/resources/test/fixtures/ruff/RUF052.py
+++ b/crates/ruff_linter/resources/test/fixtures/ruff/RUF052.py
@@ -88,19 +88,39 @@ x = &quot;global&quot;
 
 def fun():
     global x
-    _x = &quot;shadows global&quot; # [RUF052]
+    _x = &quot;shadows global&quot; # [RUF052] (but unfixable)
     return _x
 
 def foo():
   x = &quot;outer&quot;
   def bar():
     nonlocal x
-    _x = &quot;shadows nonlocal&quot; # [RUF052]
+    _x = &quot;shadows nonlocal&quot; # [RUF052] (but unfixable)
     return _x
   bar()
   return x
 
 def fun():
     x = &quot;local&quot;
-    _x = &quot;shadows local&quot; # [RUF052]
+    _x = &quot;shadows local&quot; # [RUF052] (but unfixable)
+    return _x
+
+def fun2():
+    x = &quot;local&quot;
+    x_ = &quot;also local&quot;
+    _x = &quot;shadows local&quot;  # [RUF052] (but unfixable)
     return _x
+
+def fun3():
+    global x_
+    x = &quot;local&quot;
+    _x = &quot;shadows local&quot;  # [RUF052] (but unfixable)
+    return _x
+
+def fun4():
+    x_ = 42
+    def fun5():
+        x = &quot;local&quot;
+        _x = &quot;shadows local&quot;  # RUF052 (but unfixable)
+        print(x_)
+        return _x
diff --git a/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs b/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs
index ca940bde3..e4a8dd28f 100644
--- a/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs
+++ b/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs
@@ -1,7 +1,7 @@
-use ruff_diagnostics::{Applicability, Diagnostic, Fix, FixAvailability, Violation};
+use ruff_diagnostics::{Diagnostic, Fix, FixAvailability, Violation};
 use ruff_macros::{derive_message_formats, ViolationMetadata};
 use ruff_python_ast::helpers::is_dunder;
-use ruff_python_semantic::{Binding, BindingKind, Scope};
+use ruff_python_semantic::{Binding, BindingKind, SemanticModel};
 use ruff_python_stdlib::{
     builtins::is_python_builtin, identifiers::is_identifier, keyword::is_keyword,
 };
@@ -21,6 +21,9 @@ use crate::{checkers::ast::Checker, renamer::Renamer};
 /// the code's intention. A variable marked as &quot;unused&quot; being subsequently used suggests oversight or unintentional use.
 /// This detracts from the clarity and maintainability of the codebase.
 ///
+/// Sometimes leading underscores are used to avoid variables shadowing other variables, Python builtins, or Python
+/// keywords. However, [PEP 8] recommends to use trailing underscores for this rather than leading underscores.
+///
 /// ## Example
 /// ```python
 /// def function():
@@ -40,6 +43,8 @@ use crate::{checkers::ast::Checker, renamer::Renamer};
 ///
 /// ## Options
 /// - [`lint.dummy-variable-rgx`]
+///
+/// [PEP 8]: https://peps.python.org/pep-0008/
 #[derive(ViolationMetadata)]
 pub(crate) struct DummyVariableAccessed {
     name: String,
@@ -96,8 +101,11 @@ pub(crate) fn dummy_variable_accessed(checker: &amp;Checker, binding: &amp;Binding) -&gt; O
     if binding.is_global() || binding.is_nonlocal() {
         return None;
     }
+
+    let semantic = checker.semantic();
+
     // Only variables defined in function scopes
-    let scope = &amp;checker.semantic().scopes[binding.scope];
+    let scope = &amp;semantic.scopes[binding.scope];
     if !scope.kind.is_function() {
         return None;
     }
@@ -105,7 +113,7 @@ pub(crate) fn dummy_variable_accessed(checker: &amp;Checker, binding: &amp;Binding) -&gt; O
         return None;
     }
 
-    let possible_fix_kind = get_possible_fix_kind(name, scope, checker);
+    let possible_fix_kind = get_possible_fix_kind(name, checker);
 
     let mut diagnostic = Diagnostic::new(
         DummyVariableAccessed {
@@ -118,12 +126,10 @@ pub(crate) fn dummy_variable_accessed(checker: &amp;Checker, binding: &amp;Binding) -&gt; O
     // If fix available
     if let Some(fix_kind) = possible_fix_kind {
         // Get the possible fix based on the scope
-        if let Some(fix) = get_possible_fix(name, fix_kind, scope) {
+        if let Some(fix) = get_possible_fix(name, fix_kind, semantic) {
             diagnostic.try_set_fix(|| {
-                let (edit, rest) =
-                    Renamer::rename(name, &amp;fix, scope, checker.semantic(), checker.stylist())?;
-                let applicability = Applicability::Safe;
-                Ok(Fix::applicable_edits(edit, rest, applicability))
+                Renamer::rename(name, &amp;fix, scope, semantic, checker.stylist())
+                    .map(|(edit, rest)| Fix::safe_edits(edit, rest))
             });
         }
     }
@@ -145,7 +151,7 @@ enum ShadowedKind {
 }
 
 /// Suggests a potential alternative name to resolve a shadowing conflict.
-fn get_possible_fix(name: &amp;str, kind: ShadowedKind, scope: &amp;Scope) -&gt; Option&lt;String&gt; {
+fn get_possible_fix(name: &amp;str, kind: ShadowedKind, semantic: &amp;SemanticModel) -&gt; Option&lt;String&gt; {
     // Remove leading underscores for processing
     let trimmed_name = name.trim_start_matches('_');
 
@@ -157,8 +163,8 @@ fn get_possible_fix(name: &amp;str, kind: ShadowedKind, scope: &amp;Scope) -&gt; Option&lt;Str
         ShadowedKind::None =&gt; trimmed_name.to_string(),
     };
 
-    // Ensure the fix name is not already taken in the scope
-    if scope.has(&amp;fix_name) {
+    // Ensure the fix name is not already taken in the scope or enclosing scopes
+    if !semantic.is_available(&amp;fix_name) {
         return None;
     }
 
@@ -167,7 +173,7 @@ fn get_possible_fix(name: &amp;str, kind: ShadowedKind, scope: &amp;Scope) -&gt; Option&lt;Str
 }
 
 /// Determines the kind of shadowing or conflict for a given variable name.
-fn get_possible_fix_kind(name: &amp;str, scope: &amp;Scope, checker: &amp;Checker) -&gt; Option&lt;ShadowedKind&gt; {
+fn get_possible_fix_kind(name: &amp;str, checker: &amp;Checker) -&gt; Option&lt;ShadowedKind&gt; {
     // If the name starts with an underscore, we don't consider it
     if !name.starts_with('_') {
         return None;
@@ -189,7 +195,7 @@ fn get_possible_fix_kind(name: &amp;str, scope: &amp;Scope, checker: &amp;Checker) -&gt; Option
         return Some(ShadowedKind::BuiltIn);
     }
 
-    if scope.has(trimmed_name) {
+    if !checker.semantic().is_available(trimmed_name) {
         return Some(ShadowedKind::Some);
     }
</code></pre>
</details>

<p>If you'd be able to make these final changes, I'm happy to merge now :-)</p>
<p>(Making these changes will also need some updates to the snapshots, since it makes the autofix more cautious -- some things in the fixtures which were previously deemed fixable are now no longer fixable.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on 2024-11-30 23:05</div>
            <div class="timeline-body"><p>Does the <code>semantic.is_available(&amp;fix_name)</code> do what we want, as we are no longer in the traversal process? Isn't the scope used - the last scope in AST?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-30 23:10</div>
            <div class="timeline-body"><blockquote>
<p>Does the <code>semantic.is_available(&amp;fix_name)</code> do what we want, as we are no longer in the traversal process? Isn't the scope used - the last scope in AST?</p>
</blockquote>
<p>Oh, great catch! I've stepped on that footgun before, as well.</p>
<p>We can fix that by making some small tweaks to the semantic model. You can add the <code>lookup_in_scope</code> function that I propose adding in #13076, if you look at the changes I'm making there in <code>crates/ruff_python_semantic/src/model.rs</code>. (The PR is unfinished, but I thikn the changes I'm making to <code>model.rs</code> are solid.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-30 23:13</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Does the <code>semantic.is_available(&amp;fix_name)</code> do what we want, as we are no longer in the traversal process? Isn't the scope used - the last scope in AST?</p>
</blockquote>
<p>Oh, great catch! I've stepped on that footgun before, as well.</p>
<p>We can fix that by making some small tweaks to the semantic model. You can add the <code>lookup_in_scope</code> function that I propose adding in #13076, if you look at the changes I'm making there in <code>crates/ruff_python_semantic/src/model.rs</code>. (The PR is unfinished, but I thikn the changes I'm making to <code>model.rs</code> are solid.)</p>
</blockquote>
<p>we'd then need to create our own version of <code>is_available()</code> in this rule that uses similar logic to <code>SemanticModel::is_available()</code>, but uses <code>SemanticModel::lookup_in_scope()</code> rather than <code>SemanticModel::lookup()</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on 2024-11-30 23:25</div>
            <div class="timeline-body"><p>Sounds fantastic! Though, I'll leave it for tomorrow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-30 23:34</div>
            <div class="timeline-body"><p>I think something like this <em>should</em> work. It compiles, but I haven't tested it:</p>
<details>

<pre><code class="language-diff">diff --git a/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs b/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs
index e4a8dd28f..d90cf4ce5 100644
--- a/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs
+++ b/crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs
@@ -1,7 +1,7 @@
 use ruff_diagnostics::{Diagnostic, Fix, FixAvailability, Violation};
 use ruff_macros::{derive_message_formats, ViolationMetadata};
 use ruff_python_ast::helpers::is_dunder;
-use ruff_python_semantic::{Binding, BindingKind, SemanticModel};
+use ruff_python_semantic::{Binding, BindingKind, ScopeId, SemanticModel};
 use ruff_python_stdlib::{
     builtins::is_python_builtin, identifiers::is_identifier, keyword::is_keyword,
 };
@@ -113,7 +113,7 @@ pub(crate) fn dummy_variable_accessed(checker: &amp;Checker, binding: &amp;Binding) -&gt; O
         return None;
     }
 
-    let possible_fix_kind = get_possible_fix_kind(name, checker);
+    let possible_fix_kind = get_possible_fix_kind(name, checker, binding.scope);
 
     let mut diagnostic = Diagnostic::new(
         DummyVariableAccessed {
@@ -126,7 +126,7 @@ pub(crate) fn dummy_variable_accessed(checker: &amp;Checker, binding: &amp;Binding) -&gt; O
     // If fix available
     if let Some(fix_kind) = possible_fix_kind {
         // Get the possible fix based on the scope
-        if let Some(fix) = get_possible_fix(name, fix_kind, semantic) {
+        if let Some(fix) = get_possible_fix(name, fix_kind, binding.scope, semantic) {
             diagnostic.try_set_fix(|| {
                 Renamer::rename(name, &amp;fix, scope, semantic, checker.stylist())
                     .map(|(edit, rest)| Fix::safe_edits(edit, rest))
@@ -151,7 +151,12 @@ enum ShadowedKind {
 }
 
 /// Suggests a potential alternative name to resolve a shadowing conflict.
-fn get_possible_fix(name: &amp;str, kind: ShadowedKind, semantic: &amp;SemanticModel) -&gt; Option&lt;String&gt; {
+fn get_possible_fix(
+    name: &amp;str,
+    kind: ShadowedKind,
+    scope_id: ScopeId,
+    semantic: &amp;SemanticModel,
+) -&gt; Option&lt;String&gt; {
     // Remove leading underscores for processing
     let trimmed_name = name.trim_start_matches('_');
 
@@ -164,7 +169,7 @@ fn get_possible_fix(name: &amp;str, kind: ShadowedKind, semantic: &amp;SemanticModel) -&gt;
     };
 
     // Ensure the fix name is not already taken in the scope or enclosing scopes
-    if !semantic.is_available(&amp;fix_name) {
+    if !semantic.is_available_in_scope(&amp;fix_name, scope_id) {
         return None;
     }
 
@@ -173,7 +178,7 @@ fn get_possible_fix(name: &amp;str, kind: ShadowedKind, semantic: &amp;SemanticModel) -&gt;
 }
 
 /// Determines the kind of shadowing or conflict for a given variable name.
-fn get_possible_fix_kind(name: &amp;str, checker: &amp;Checker) -&gt; Option&lt;ShadowedKind&gt; {
+fn get_possible_fix_kind(name: &amp;str, checker: &amp;Checker, scope_id: ScopeId) -&gt; Option&lt;ShadowedKind&gt; {
     // If the name starts with an underscore, we don't consider it
     if !name.starts_with('_') {
         return None;
@@ -195,7 +200,10 @@ fn get_possible_fix_kind(name: &amp;str, checker: &amp;Checker) -&gt; Option&lt;ShadowedKind&gt;
         return Some(ShadowedKind::BuiltIn);
     }
 
-    if !checker.semantic().is_available(trimmed_name) {
+    if !checker
+        .semantic()
+        .is_available_in_scope(trimmed_name, scope_id)
+    {
         return Some(ShadowedKind::Some);
     }
 
diff --git a/crates/ruff_python_semantic/src/model.rs b/crates/ruff_python_semantic/src/model.rs
index 9be76dc20..ff3a1a10a 100644
--- a/crates/ruff_python_semantic/src/model.rs
+++ b/crates/ruff_python_semantic/src/model.rs
@@ -325,9 +325,15 @@ impl&lt;'a&gt; SemanticModel&lt;'a&gt; {
     }
 
     /// Return `true` if `member` is an &quot;available&quot; symbol, i.e., a symbol that has not been bound
-    /// in the current scope, or in any containing scope.
+    /// in the current scope currently being visited, or in any containing scope.
     pub fn is_available(&amp;self, member: &amp;str) -&gt; bool {
-        self.lookup_symbol(member)
+        self.is_available_in_scope(member, self.scope_id)
+    }
+
+    /// Return `true` if `member` is an &quot;available&quot; symbol in a given scope, i.e.,
+    /// a symbol that has not been bound in that current scope, or in any containing scope.
+    pub fn is_available_in_scope(&amp;self, member: &amp;str, scope_id: ScopeId) -&gt; bool {
+        self.lookup_symbol_in_scope(member, scope_id, false)
             .map(|binding_id| &amp;self.bindings[binding_id])
             .map_or(true, |binding| binding.kind.is_builtin())
     }
@@ -620,10 +626,22 @@ impl&lt;'a&gt; SemanticModel&lt;'a&gt; {
         }
     }
 
-    /// Lookup a symbol in the current scope. This is a carbon copy of [`Self::resolve_load`], but
-    /// doesn't add any read references to the resolved symbol.
+    /// Lookup a symbol in the current scope.
     pub fn lookup_symbol(&amp;self, symbol: &amp;str) -&gt; Option&lt;BindingId&gt; {
-        if self.in_forward_reference() {
+        self.lookup_symbol_in_scope(symbol, self.scope_id, self.in_forward_reference())
+    }
+
+    /// Lookup a symbol in a certain scope
+    ///
+    /// This is a carbon copy of [`Self::resolve_load`], but
+    /// doesn't add any read references to the resolved symbol.
+    pub fn lookup_symbol_in_scope(
+        &amp;self,
+        symbol: &amp;str,
+        scope_id: ScopeId,
+        in_forward_reference: bool,
+    ) -&gt; Option&lt;BindingId&gt; {
+        if in_forward_reference {
             if let Some(binding_id) = self.scopes.global().get(symbol) {
                 if !self.bindings[binding_id].is_unbound() {
                     return Some(binding_id);
@@ -633,7 +651,7 @@ impl&lt;'a&gt; SemanticModel&lt;'a&gt; {
 
         let mut seen_function = false;
         let mut class_variables_visible = true;
-        for (index, scope_id) in self.scopes.ancestor_ids(self.scope_id).enumerate() {
+        for (index, scope_id) in self.scopes.ancestor_ids(scope_id).enumerate() {
             let scope = &amp;self.scopes[scope_id];
             if scope.kind.is_class() {
                 if seen_function &amp;&amp; matches!(symbol, &quot;__class__&quot;) {
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on 2024-12-01 10:14</div>
            <div class="timeline-body"><p>Thank you very much @AlexWaygood! I have applied all of your proposed changes, which seemed very intuitive.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2024-12-02 08:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:182 on 2024-12-02 08:43</div>
            <div class="timeline-body"><p>I got a big confused by the terminology <code>fix_kind</code> because I assumed it's related to the fix applicability.</p>
<p>Maybe consider renaming it to <code>shadowed_kind</code>? I'd also use <code>try_</code> instead of <code>possible</code>. <code>try</code> is often used for operations that may return <code>None</code> or an <code>Err</code>.</p>
<pre><code class="language-suggestion">fn try_shadowed_kind(name: &amp;str, checker: &amp;Checker, scope_id: ScopeId) -&gt; Option&lt;ShadowedKind&gt; {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:175 on 2024-12-02 08:48</div>
            <div class="timeline-body"><p>We should add a test for when a user customized the <code>dummy_regexp</code> and, e.g., removed <code>_</code> as a valid dummy regex and instead uses <code>dummy_variable</code> as prefix.</p>
<p>In that case, I suspect that the rule never converges because the rule keeps trying to remove the <code>_</code> prefix which wasn't there.</p>
<p>To prevent this, the rule should test if the new name matches the <code>dummy_variable_regexp</code> and, if so, not return a fix</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-12-02 08:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-02 08:48</div>
            <div class="timeline-body"><p>This is great :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-02 13:17</div>
            <div class="timeline-body"><p>Considering that the rule is named <code>unused-variable-accessed</code>, should the rule instead use the range of the first <strong>access</strong> instead of the declaration of the symbol?</p>
<p>I think I'd prefer that because the violation isn't the assignment to the variable, but that I'm using a variable that's marked as intentionally unused. That would also make reviewing the ecosystem changes much easier, because I wouldn't have to scan for the use :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-02 13:19</div>
            <div class="timeline-body"><blockquote>
<p>Considering that the rule is named <code>unused-variable-accessed</code>, should the rule instead use the range of the first <strong>access</strong> instead of the declaration of the symbol?</p>
<p>I think I'd prefer that because the violation isn't the assignment to the variable, but that I'm using a variable that's marked as intentionally unused. That would also make reviewing the ecosystem changes much easier, because I wouldn't have to scan for the use :)</p>
</blockquote>
<p>See my earlier comment at https://github.com/astral-sh/ruff/pull/14611#discussion_r1864375141 @MichaReiser. I think the thing we're recommending to the user that they should <em>change</em> (and the thing that we <em>do</em> change in the autofix) is the naming of the variable: we don't try to remove uses of the variable! So I much prefer it as it is currently, with the diagnostic pointing to the binding rather than the use of the binding.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-12-02 13:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 13:27</div>
            <div class="timeline-body"><blockquote>
<p>The error here is really in the naming of the variable, not the fact that the variable is used.</p>
</blockquote>
<p>Not entirely. The error is the combination of the two. There are two possible errors:</p>
<ol>
<li>You used the wrong variable</li>
<li>The variable is no longer unused</li>
</ol>
<p>In the long term, I think what I'd want is a diagnostic like clippy where the primary diagnostic range is the use:</p>
<pre><code>warning: used underscore-prefixed binding                                                                                                                                                                                                                                                                                                                                          
  --&gt; crates\ruff_python_semantic\src\analyze\visibility.rs:38:5
   |
38 |     _decorator_list
   |     ^^^^^^^^^^^^^^^
   |
note: binding is defined here
  --&gt; crates\ruff_python_semantic\src\analyze\visibility.rs:37:20
   |
37 | pub fn is_override(_decorator_list: &amp;[Decorator], semantic: &amp;SemanticModel) -&gt; bool {
   |                    ^^^^^^^^^^^^^^^
   = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#used_underscore_binding
   = note: `-W clippy::used-underscore-binding` implied by `-W clippy::pedantic`
   = help: to override `-W clippy::pedantic` add `#[allow(clippy::used_underscore_binding)]`

warning: `ruff_python_semantic` (lib) generated 1 warning        
</code></pre>
<p>and the secondary diagnostic range is where the variable is declared.</p>
<p>The fact that the primary range is the use makes it much easier to <em>review</em> the violation because you can start with the use and editors provide the necessary tools to rename the variable from the use. You can also jump to the declaration if you want. The opposite is also true but finding all references tends to be slower and requires a few more clicks (or the use of a keyboard shortcut).</p>
<blockquote>
<p>If the user uses a dummy variable 5 times, I think this implementation currently means that we'd issue 5 diagnostics regarding the dummy variable. But arguably there's only one mistake here, which is the name of the variable at the point where it's bound.</p>
</blockquote>
<p>This can be avoided by only emitting a diagnostic for the first use of the binding.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 13:34</div>
            <div class="timeline-body"><blockquote>
<p>The fact that the primary range is the use makes it much easier to <em>review</em> the violation because you can start with the use and editors provide the necessary tools to rename the variable from the use. You can also jump to the declaration if you want. The opposite is also true but finding all references tends to be slower and requires a few more clicks (or the use of a keyboard shortcut).</p>
</blockquote>
<p>hmm, maybe this difference in perspective comes from the fact that I don't usually use a heavyweight IDE for writing Python: I usually use a lightweight text editor and run Ruff from the command line.</p>
<p>However, I still disagree... the vast majority of the hits we see in the ecosystem aren't due to people using the wrong variable accidentally, or due to a variable no longer being unused. Most hits are due to people naming the variable incorrectly because they're either not aware of this convention, don't care about it, or don't care about it enough to enforce it in their codebase without an automated tool. I think it'll be very odd for those people to have Ruff pointing to the first uses of the problematic variables when they upgrade to the latest version of Ruff, run Ruff (probably from the command line, I would guess, since they'll want to review all the modifications Ruff is making to their code in one go), and see many errors relating to this rule when the real problem is the way the variable is named. I also think it's usually pretty trivial if you <em>are</em> using a heavyweight editor to be able to right click on the variable and scroll through all references to it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-12-02 13:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-12-02 13:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 13:39</div>
            <div class="timeline-body"><p>I don't feel too strongly. So happy to go with your version if you do feel strongly. But two additional considerations:</p>
<ul>
<li>The rule is named <code>unused-variable-accessed</code>. We should rename it if we report it at the declaration side because it doesn't report the <em>use</em> (either way, we should rename it to <em>use</em>)</li>
<li>In the long term, showing the first use and the declaration seems easier than showing the declaration and <strong>all</strong> usages.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-12-02 13:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 13:47</div>
            <div class="timeline-body"><blockquote>
<p>But two additional considerations:</p>
<pre><code>* The rule is named `unused-variable-accessed`. We should rename it if we report it at the declaration side because it doesn't report the _use_ (either way, we should rename it to _use_)

* In the long term, showing the first use and the declaration seems easier than showing the declaration and **all** usages.</code></pre>
</blockquote>
<p>I agree with both of these. So I think the immediate action point here is to rename the rule (and the file the rule is in). Maybe <code>variable-name-implies-unused</code>? @Lokejoke, could you do that renaming?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-12-02 13:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 13:55</div>
            <div class="timeline-body"><p>how about allow <code>used-dummy-variable</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-12-02 13:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 13:56</div>
            <div class="timeline-body"><p>Sure</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lokejoke">@Lokejoke</a> reviewed on 2024-12-02 16:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lokejoke">@Lokejoke</a> on <code>crates/ruff_linter/src/rules/ruff/rules/dummy_variable_accessed.rs</code>:119 on 2024-12-02 16:34</div>
            <div class="timeline-body"><p>Yes, I'll do that</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`ruff`] Implemented `unused-variable-accessed` (`RUF052`)" to "[`ruff`] Implemented `used-dummy-variable` (`RUF052`)" by @Lokejoke on 2024-12-02 21:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 07:36</div>
            <div class="timeline-body"><p>Thanks for seeing this through!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-12-03 07:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-12-03 07:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 07:37</div>
            <div class="timeline-body"><p>@AlexWaygood I know that you considered making some documentation changes to the rule but I thought I'd merge it and we can make those changes as separate PRs (this also solves the problem that you can't push to this branch 😆)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-03 07:51</div>
            <div class="timeline-body"><p>Congrats @Lokejoke — there were a lot of unexpected complications to this one! This is great</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:08:01 UTC
    </footer>
</body>
</html>
