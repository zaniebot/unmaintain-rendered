<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `flake8-future-annotations` FA100 - astral-sh/ruff #3979</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>flake8-future-annotations</code> FA100</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/3979">#3979</a>
        opened by <a href="https://github.com/TylerYep">@TylerYep</a>
        on 2023-04-15 18:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a></div>
            <div class="timeline-body"><p>This PR tackles the first part of #3072, which is to raise a lint error when a rewrite-able type is used without <code>from __future__ import annotations</code> present.</p>
<p>Test cases taken from: https://github.com/TylerYep/flake8-future-annotations</p>
<p>Some of the test cases I added (prefixed by <code>no_future</code>) do not raise lint warnings now (as expected), but will raise lint warnings once FA102 is implemented. I am adding them to ensure they do not raise extraneous errors to begin with.</p>
<p>This lint rule also found some available fixes in <code>scripts/check_ecosystem.py</code>, which tells me there&#x27;s some value to having this around :)</p>
<p>The next two PRs will add the autofix functionality for FA100 and FA101 and/or FA102. Thanks for the review!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-04-15 19:13</div>
            <div class="timeline-body">PR Check Results
Ecosystem
<p>✅ ecosystem check detected no changes.</p>
Benchmark
Linux
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
linter/all-rules/large/dataset.py          1.01     16.2±0.29ms     2.5 MB/sec    1.00     16.1±0.24ms     2.5 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      4.0±0.07ms     4.2 MB/sec    1.00      4.0±0.06ms     4.2 MB/sec
linter/all-rules/numpy/globals.py          1.00    488.4±9.48µs     6.0 MB/sec    1.00    487.9±9.25µs     6.0 MB/sec
linter/all-rules/pydantic/types.py         1.01      6.8±0.09ms     3.8 MB/sec    1.00      6.7±0.13ms     3.8 MB/sec
linter/default-rules/large/dataset.py      1.00      7.8±0.12ms     5.2 MB/sec    1.01      7.9±0.08ms     5.1 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.01  1723.3±13.22µs     9.7 MB/sec    1.00  1708.6±19.59µs     9.7 MB/sec
linter/default-rules/numpy/globals.py      1.00    187.7±3.36µs    15.7 MB/sec    1.00    187.9±3.59µs    15.7 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.6±0.05ms     7.1 MB/sec    1.00      3.6±0.05ms     7.1 MB/sec
parser/large/dataset.py                    1.00      6.3±0.11ms     6.5 MB/sec    1.01      6.3±0.09ms     6.4 MB/sec
parser/numpy/ctypeslib.py                  1.00  1225.3±17.85µs    13.6 MB/sec    1.00  1225.1±24.36µs    13.6 MB/sec
parser/numpy/globals.py                    1.00    124.7±2.50µs    23.7 MB/sec    1.00    124.2±2.27µs    23.8 MB/sec
parser/pydantic/types.py                   1.00      2.7±0.05ms     9.5 MB/sec    1.01      2.7±0.05ms     9.4 MB/sec
</code></pre>
Windows
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
linter/all-rules/large/dataset.py          1.02     21.0±0.63ms  1985.7 KB/sec    1.00     20.6±0.66ms  2025.1 KB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      5.3±0.20ms     3.1 MB/sec    1.03      5.5±0.25ms     3.0 MB/sec
linter/all-rules/numpy/globals.py          1.00   630.1±26.83µs     4.7 MB/sec    1.02  644.2±108.66µs     4.6 MB/sec
linter/all-rules/pydantic/types.py         1.00      8.8±0.30ms     2.9 MB/sec    1.03      9.0±0.35ms     2.8 MB/sec
linter/default-rules/large/dataset.py      1.01     10.5±0.38ms     3.9 MB/sec    1.00     10.3±0.36ms     3.9 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00      2.2±0.07ms     7.7 MB/sec    1.01      2.2±0.10ms     7.6 MB/sec
linter/default-rules/numpy/globals.py      1.00   256.8±13.91µs    11.5 MB/sec    1.08   278.2±19.02µs    10.6 MB/sec
linter/default-rules/pydantic/types.py     1.00      4.6±0.13ms     5.6 MB/sec    1.07      4.9±0.26ms     5.2 MB/sec
parser/large/dataset.py                    1.00      8.5±0.16ms     4.8 MB/sec    1.04      8.8±0.24ms     4.6 MB/sec
parser/numpy/ctypeslib.py                  1.00  1659.1±49.63µs    10.0 MB/sec    1.02  1698.0±70.38µs     9.8 MB/sec
parser/numpy/globals.py                    1.00    169.7±9.08µs    17.4 MB/sec    1.02    172.8±8.51µs    17.1 MB/sec
parser/pydantic/types.py                   1.00      3.7±0.17ms     6.8 MB/sec    1.01      3.8±0.12ms     6.7 MB/sec
</code></pre>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Implement flake8-future-annotations&quot; to &quot;Implement flake8-future-annotations FA100&quot; by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-04-15 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-04-15 20:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-15 20:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Implement flake8-future-annotations FA100&quot; to &quot;Implement `flake8-future-annotations` FA100&quot; by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-04-30 20:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-02 20:54</div>
            <div class="timeline-body"><p>(Really sorry for the delay here, I will try to get to this soon, I just got distracted between launch and PyCon and some travel.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2023-05-03 06:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_stdlib/src/typing.rs</code>:204 on 2023-05-04 16:46</div>
            <div class="timeline-body"><p>@TylerYep - Could you speak a bit towards how this list was determined? I initially thought it&#x27;d only include builtin collections (like <code>List</code> and <code>Dict</code>), but including <code>DefaultDict</code> and <code>Deque</code> means we&#x27;re asking users to import those from <code>collections</code>. So should it also include <code>AsyncIterator</code>, <code>Mapping</code>, etc. -- all the things that were moved from <code>typing</code> to <code>collections.abc</code> in Python 3.9? (I think <code>crates/ruff/src/rules/pyupgrade/rules/deprecated_import.rs</code> is our most comprehensive accounting of those moves, for reference.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-04 16:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-04 17:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>crates/ruff_python_stdlib/src/typing.rs</code>:204 on 2023-05-04 17:11</div>
            <div class="timeline-body"><p>These are all of the data structures that can be rewritten by pyupgrade into lowercase form e.g.</p>
<p>List[int] becomes list[int]</p>
<p>DefaultDict[str, bool] becomes defaultdict[str, bool]</p>
<p>Union[int, str] becomes int | str</p>
<p>Changing the import path from typing to collections.abc is not important for this plugin because the resulting code looks the same.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_stdlib/src/typing.rs</code>:204 on 2023-05-04 17:31</div>
            <div class="timeline-body"><p>By that logic, should <code>typing.AsyncIterator</code> and friends also be included?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-04 17:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_python_stdlib/src/typing.rs</code>:204 on 2023-05-04 17:41</div>
            <div class="timeline-body"><p>To my knowledge, <code>pyupgrade</code> only rewrites the builtins: https://github.com/asottile/pyupgrade/blob/7c551d39dfa69851607d85392ffa296568e92436/pyupgrade/_plugins/typing_pep585.py#L15</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-04 17:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-04 18:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>crates/ruff_python_stdlib/src/typing.rs</code>:204 on 2023-05-04 18:08</div>
            <div class="timeline-body"><p>Ah, in that case I guess we don&#x27;t need to include Deque or DefaultDict.</p>
<p>(Technically, DefaultDict can be replaced by defaultdict and Deque can be replaced by deque and keep the same functionality, but Pyupgrade doesn&#x27;t autofix them so I&#x27;ll remove them until they are supported)</p>
<p>Fixing...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-05-04 22:57</div>
            <div class="timeline-body"><p>I&#x27;m not sure why tests are failing - running <code>cargo test</code> locally passes cleanly for me.</p>
<p>Any idea @charliermarsh ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-05 01:25</div>
            <div class="timeline-body"><p>@TylerYep - Just needed to merge, we recently hit a limit on a fixed-size vector that stores all the rules and it had to be increased.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2023-05-05 06:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-05-07 09:14</div>
            <div class="timeline-body"><p>I went back to my original plugin and remembered why DefaultDict and Deque were originally included in FA100:</p>
<p>The main goal of this plugin is to signal to users when a type annotation could be rewritten in a more concise way when <code>from __future__ import annotations</code> is added.</p>
<ol>
<li>This code could be simplified (and is currently autofixed by Pyupgrade):</li>
</ol>
<pre><code>from typing import List, Optional, Union

a: List[int] = []
b: Optional[Union[int, str]] = None
</code></pre>
<pre><code>from __future__ import annotations

a: list[int] = []
b: int | str | None = None
</code></pre>
<ol>
<li>This code could be simplified (but is not currently autofixed by Pyupgrade):</li>
</ol>
<pre><code>from collections import defaultdict, deque
from typing import DefaultDict, Deque

a: DefaultDict[int] = defaultdict(int)
b: Deque[int] = deque()
</code></pre>
<pre><code>from __future__ import annotations

from collections import defaultdict, deque

a: defaultdict[int] = defaultdict(int)
b: deque[int] = deque()
</code></pre>
<p>https://github.com/asottile/pyupgrade/issues/799 provides context on why collection types are not rewritten using Pyupgrade (import aliasing is hard). It might be possible to extend the autofix functionality to rewrite all of them correctly, but that is out of scope for now.</p>
<p>Afaik, DefaultDict and Deque are the only two code changes included in PEP585, improved using <code>from __future__ import annotations</code> to use the common lowercase name, but not autofixed by Pyupgrade.</p>
<ol>
<li>This code cannot be simplified, but can use a different import. These cases are not intended to be raised by this flake8 rule because the type annotation doesn&#x27;t need to be changed by adding <code>from __future__ import annotations</code>:</li>
</ol>
<pre><code>from typing import AsyncIterator, Mapping

a: Mapping[int, str] = {}
b: AsyncIterator = ...
</code></pre>
<pre><code>from collections.abc import AsyncIterator, Mapping

a: Mapping[int, str] = {}
b: AsyncIterator = ...

</code></pre>
<p>My view is that both 1 and 2 should be raised by this plugin, but not 3, because the code itself is not improved by adding <code>from __future__ import annotations</code>.</p>
<p>I reverted 4373751 to reflect the above explanation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/calumy">@calumy</a> on <code>crates/ruff/src/rules/flake8_future_annotations/rules.rs</code>:18 on 2023-05-09 16:22</div>
            <div class="timeline-body"><p>This section should not have been removed when updating the docs. I&#x27;ll update the error message to say something along the lines of &quot;Rule <code>missing-future-annotations-with-imports</code> docs are not formatted. The example section should be rewritten to:&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/calumy">@calumy</a> reviewed on 2023-05-09 16:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/calumy">@calumy</a> reviewed on 2023-05-09 16:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/calumy">@calumy</a> on <code>crates/ruff/src/rules/flake8_future_annotations/rules.rs</code>:18 on 2023-05-09 16:28</div>
            <div class="timeline-body"><p>Ref #4312</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-09 17:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>crates/ruff/src/rules/flake8_future_annotations/rules.rs</code>:18 on 2023-05-09 17:19</div>
            <div class="timeline-body"><p>Thanks, fixed! The error message looked copy+pastable but did not contain the full output. Hopefully that can be an autofix via pre-commit</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/rules/flake8_future_annotations/rules.rs</code>:94 on 2023-05-12 01:46</div>
            <div class="timeline-body"><p>Sorry, last question: what&#x27;s the benefit in flagging both the usages and the imports? Would flagging the import alone be insufficient?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-12 01:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-12 03:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>crates/ruff/src/rules/flake8_future_annotations/rules.rs</code>:94 on 2023-05-12 03:36</div>
            <div class="timeline-body"><p>If the user uses <code>import typing</code>, we can only flag <code>typing.List</code> at the usage. If they use <code>from typing import List</code>, then flagging the import alone is sufficient.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-12 16:55</div>
            <div class="timeline-body"><p>Will merge this after cutting the release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-12 18:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/checkers/ast/mod.rs</code>:2451 on 2023-05-12 18:15</div>
            <div class="timeline-body"><p>These should only be activated for minimum-version &lt; Python 3.9, right? Since PEP 585 was part of Python 3.9 (so future annotations aren&#x27;t required to use the standard-library variants in 3.9 and later).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>crates/ruff/src/checkers/ast/mod.rs</code>:2451 on 2023-05-12 18:30</div>
            <div class="timeline-body"><p>In practice, this works on Python 3.7+.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-12 18:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-12 18:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/checkers/ast/mod.rs</code>:2451 on 2023-05-12 18:32</div>
            <div class="timeline-body"><p>But if your minimum-supported Python version is Python 3.9, you don&#x27;t need <code>__future__</code> annotations to use the standard-library generics. So these errors would already be detected and fixed by the existing <code>pyupgrade</code> rules, right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-12 18:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>crates/ruff/src/checkers/ast/mod.rs</code>:2451 on 2023-05-12 18:56</div>
            <div class="timeline-body"><p>Ah, you&#x27;re asking about the upper version.</p>
<p>Unions like <code>str | None</code> didn&#x27;t start working until Python 3.10, which are also covered by this plugin.</p>
<p>After 3.10, the future annotations import is not as useful anymore.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/calumy">@calumy</a> on 2023-05-13 06:59</div>
            <div class="timeline-body"><blockquote>
<p>Will merge this after cutting the release.</p>
</blockquote>
<p>I thought it might be worth flagging that the changes to the ecosystem check seem to be causing it to error. I don&#x27;t have time to investigate now but thought it would be worth saying something before this is merged.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-05-13 16:11</div>
            <div class="timeline-body"><p>What is the error? I see check_ecosystem imports Self, which must mean it&#x27;s running on Python 3.11+, so none of my changes should impact it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/calumy">@calumy</a> on 2023-05-13 19:09</div>
            <div class="timeline-body"><blockquote>
<p>What is the error? I see check_ecosystem imports Self, which must mean it&#x27;s running on Python 3.11+, so none of my changes should impact it.</p>
</blockquote>
<p>Error in the ecosystem check above:</p>
<pre><code>&#x27;async_generator&#x27; object does not support the asynchronous context manager protocol

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TylerYep">@TylerYep</a> on 2023-05-13 19:21</div>
            <div class="timeline-body"><p>Was that caused by removing the asynccontextmanager import? It was an unused import that pre-commit told me to remove.</p>
<p>If that import is required due to side effects, then we probably need to add a <code># noqa</code> to that line.</p>
<p><strong>Update: fixed the issue.</strong></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>scripts/check_ecosystem.py</code>:39 on 2023-05-13 19:26</div>
            <div class="timeline-body"><p>It looks like the usage was removed here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-13 19:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/TylerYep">@TylerYep</a> on <code>scripts/check_ecosystem.py</code>:39 on 2023-05-13 22:35</div>
            <div class="timeline-body"><p>Thanks, fixed the bad rebase.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TylerYep">@TylerYep</a> reviewed on 2023-05-13 22:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-14 02:57</div>
            <div class="timeline-body"><p>I made a few changes here that I <em>think</em> are improvements based on some of the capabilities we have in Ruff, but if you disagree, just let me know and we can of course discuss further -- want to merge to keep momentum.</p>
<ol>
<li>I removed the diagnostics that trigger on-import, and instead, I&#x27;m more closely following our pyupgrade rules. We flag all usages, regardless of whether the user does <code>import typing</code> or <code>from typing import List</code> -- when the user writes <code>typing.List</code> or <code>List</code>, we resolve it to <code>typing.List</code>. So it&#x27;s always sufficient to just flag usages, given that we have enough binding tracking and semantic analysis to resolve those usages, regardless of how they&#x27;re imported.</li>
<li>These rules now only flag if your minimum version is below Python 3.9 (or Python 3.10, for <code>Optional</code> and <code>Union</code>), since adding <code>__future__</code> on those versions has no effect with regards to simplifying the imports. (You can already use the standard library generics on those versions.)</li>
<li>We weren&#x27;t flagging <code>Optional</code> or <code>Union</code>, so I added that too.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-14 03:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-14 03:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff/src/checkers/ast/mod.rs</code>:2344 on 2023-05-14 03:10</div>
            <div class="timeline-body"><p>This condition is a lot to read, I&#x27;d like to clean this up... But the idea is: mirror the logic below for <code>Rule::NonPEP585Annotation</code>, but flip the <code>!self.ctx.future_annotations()</code>. So we&#x27;re asking: would we trigger here if <code>__future__</code> annotations were enabled?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-05-14 03:10</div>
            <div class="timeline-body"></div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:53:16 UTC
    </footer>
</body>
</html>
