<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `pandas-vet` - astral-sh/ruff #1235</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>pandas-vet</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/1235">#1235</a>
        opened by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a>
        on 2022-12-14 06:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/edgarrmondragon">@edgarrmondragon</a></div>
            <div class="timeline-body"><ul>
<li>[ ] PD001: pandas should always be imported as 'import pandas as pd'</li>
<li>[x] PD002: 'inplace = True' should be avoided; it has inconsistent behavior</li>
<li>[x] PD003: '.isna' is preferred to '.isnull'; functionality is equivalent</li>
<li>[x] PD004: '.notna' is preferred to '.notnull'; functionality is equivalent</li>
<li>[ ] PD005: Use arithmetic operator instead of method</li>
<li>[ ] PD006: Use comparison operator instead of method</li>
<li>[x] PD007: '.ix' is deprecated; use more explicit '.loc' or '.iloc'</li>
<li>[x] PD008: Use '.loc' instead of '.at'. If speed is important, use numpy.</li>
<li>[x] PD009: Use '.iloc' instead of '.iat'. If speed is important, use numpy.</li>
<li>[x] PD010 '.pivot_table' is preferred to '.pivot' or '.unstack'; provides same functionality</li>
<li>[x] PD011 Use '.array' or '.to_array()' instead of '.values'; 'values' is ambiguous</li>
<li>[x] PDO12 '.read_csv' is preferred to '.read_table'; provides same functionality</li>
<li>[x] PD013 '.melt' is preferred to '.stack'; provides same functionality</li>
<li>[x] PD015 Use '.merge' method instead of 'pd.merge' function. They have equivalent functionality.</li>
<li>[x] PD901 'df' is a bad variable name. Be kinder to your future self.</li>
</ul>
<p>Closes https://github.com/charliermarsh/ruff/issues/1141</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2022-12-14 06:12</div>
            <div class="timeline-body"><p>I'll try to implement <code>PDV005</code> and <code>PDV006</code> in the coming days.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/delulu52">@delulu52</a> on 2022-12-14 08:49</div>
            <div class="timeline-body"><p>@edgarrmondragon Just fyi I had opened following ticket with pandas vet bit ago, that don't know if worth considering (again would double check if true, but wanted to bring up just in case) https://github.com/deppen8/pandas-vet/issues/113</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/delulu52">@delulu52</a> on 2022-12-14 08:57</div>
            <div class="timeline-body"><p>@edgarrmondragon Additionally do remember then having some what unresolved issue with https://github.com/deppen8/pandas-vet/issues/74 where some checks could give false negatives, don't know if concern or if still run into here but wanted to bring up just in case</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2022-12-15 00:27</div>
            <div class="timeline-body"><blockquote>
<p>@edgarrmondragon Additionally do remember then having some what unresolved issue with <a href="https://github.com/deppen8/pandas-vet/issues/74">deppen8/pandas-vet#74</a> where some checks could give false negatives, don't know if concern or if still run into here but wanted to bring up just in case</p>
</blockquote>
<p>@ksdaftari I have not implemented <code>PD005</code> but we can leave it out for now. TLDR it's hard to solve with static linting such as Ruff's or flake8's <a href="https://github.com/deppen8/pandas-vet/issues/74#issuecomment-545930912">as pointed out by the maintainer</a>.</p>
<p>The workaround</p>
<blockquote>
<p>A quick hack (that could be optional for example) would be to check if pandas is imported in the file. Sure, it won't work for a lot of cases, but for a lot of cases it also will work.</p>
</blockquote>
<p>could lead to false negatives instead.</p>
<p>Wdyt?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2022-12-15 00:28</div>
            <div class="timeline-body"><blockquote>
<p>@edgarrmondragon Just fyi I had opened following ticket with pandas vet bit ago, that don't know if worth considering (again would double check if true, but wanted to bring up just in case) <a href="https://github.com/deppen8/pandas-vet/issues/113">deppen8/pandas-vet#113</a></p>
</blockquote>
<p>Yeah, makes sense to recommend <code>to_numpy()</code> here :+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @edgarrmondragon on 2022-12-15 01:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-15 01:23</div>
            <div class="timeline-body"><p>@edgarrmondragon - Just double-confirming, all set for review here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2022-12-15 05:59</div>
            <div class="timeline-body"><blockquote>
<p>@edgarrmondragon - Just double-confirming, all set for review here?</p>
</blockquote>
<p>Yup, all set üôÇ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-15 17:10</div>
            <div class="timeline-body"><p>Great, will review and hopefully merge today :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2022-12-15 19:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-12-15 19:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2022-12-15 19:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/andersk">@andersk</a> on 2022-12-18 04:48</div>
            <div class="timeline-body"><p>Any reason we renamed these codes from the upstream <code>PDnnn</code> to <code>PDVnnn</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-18 05:35</div>
            <div class="timeline-body"><p>I‚Äôve been advocating the use of more specific prefixes for plugins, to avoid collisions in the present and future. For example, flake8-tidy-imports uses the ‚ÄúI‚Äù prefix, which is maybe fine if you have to explicitly instead the plugin to activate it, but causes collisions in the Ruff model. So I‚Äôd generally been biasing towards three-letter prefixes for all plugins.</p>
<p>It‚Äôs a questionable choice and maybe one that merits case-by-case consideration, would love your opinion. In this case, PD might be confusing if we implemented another Pandas-related plugin.</p>
<p>We could also consider adding redirects from PD to PDV like we do for some other codes (e.g., U to UP).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/andersk">@andersk</a> on 2022-12-18 06:10</div>
            <div class="timeline-body"><p>Hmm. It seems to me that the main benefit of the <code>ABC123</code> system is compatibility with the upstream codes. Yeah, we‚Äôll need to deviate occasionally when there are collisions. But if we‚Äôre also going to deviate on account of <em>hypothetical</em> collisions (even for plugins following the <a href="https://flake8.pycqa.org/en/latest/plugin-development/registering-plugins.html">upstream recommendation</a> of 2 or 3 characters), then maybe we‚Äôd be better off with a different naming system designed for humans instead of <a href="https://youtu.be/tyOLJ99ysdU?t=440">military radio dials</a>?</p>
<p>This has sort of been in the back of my mind‚Äîsomething more like ESLint‚Äôs system where e.g. <code>eslint-plugin-unicorn</code> provides errors like <code>unicorn/no-array-for-each</code> would reduce the need to constantly refer back to the documentation or keep <a href="https://github.com/zulip/zulip/blob/d4d285fc43b9ede7556f30878e28d8f851289bf2/pyproject.toml#L102-L136">comments next to every error code</a> to help remember what they mean.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-18 16:55</div>
            <div class="timeline-body"><p>Yeah that's a very reasonable argument. Perhaps the right approach for now is to only deviate if it will cause a conflict with an existing plugin <em>or</em> knowingly cause a conflict with another known plugin that we might reasonably implement. I can revert to PD for this specific plugin.</p>
<p>And yes -- I do want to redo the error code system (ideally in a way that's compatible with the existing system and thus with Flake8), and I think ESLint is probably the right model to follow (though I also want to retain unique IDs for each code like Pylint, which is necessary for compatibility anyway). I wrote a bit about it here: https://github.com/charliermarsh/ruff/issues/967.</p>
<p>This will probably come with some more flexibility around <code>noqa</code> directives... like ESLint's ignore-next-line behavior.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:55:09 UTC
    </footer>
</body>
</html>
