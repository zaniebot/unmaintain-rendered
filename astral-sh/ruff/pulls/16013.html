<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`airflow`] Fix `ImportPathMoved` / `ProviderName` misuse (`AIR303`) - astral-sh/ruff #16013</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>airflow</code>] Fix <code>ImportPathMoved</code> / <code>ProviderName</code> misuse (<code>AIR303</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16013">#16013</a>
        opened by <a href="https://github.com/Lee-W">@Lee-W</a>
        on 2025-02-07 07:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<!-- What's the purpose of the change? What does it do, and why? -->

<ul>
<li>fix ImportPathMoved / ProviderName misuse<ul>
<li>oncrete names, such as <code>[&quot;airflow&quot;, &quot;config_templates&quot;, &quot;default_celery&quot;, &quot;DEFAULT_CELERY_CONFIG&quot;]</code>, should use <code>ProviderName</code>. In contrast, module paths like <code>&quot;airflow&quot;, &quot;operators&quot;, &quot;weekday&quot;, ...</code> should use <code>ImportPathMoved</code>. Misuse may lead to incorrect detection.</li>
</ul>
</li>
</ul>
<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>update test fixture</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-02-07 07:36</div>
            <div class="timeline-body"><p>I'm thinking of splitting related test cases into separate files in the following PRs. Otherwise, it's a bit difficult to check the test cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-02-07 07:37</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚úÖ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+5 -5 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+5 -5 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/dev/perf/dags/perf_dag_1.py#L41'>dev/perf/dags/perf_dag_1.py:41:10:</a> AIR302 `airflow.operators.bash_operator.BashOperator` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/dev/perf/dags/perf_dag_1.py#L41'>dev/perf/dags/perf_dag_1.py:41:10:</a> AIR303 Import path `airflow.operators.bash_operator` is moved into `standard` provider in Airflow 3.0;
- <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/dev/perf/dags/perf_dag_1.py#L48'>dev/perf/dags/perf_dag_1.py:48:12:</a> AIR302 `airflow.operators.bash_operator.BashOperator` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/dev/perf/dags/perf_dag_1.py#L48'>dev/perf/dags/perf_dag_1.py:48:12:</a> AIR303 Import path `airflow.operators.bash_operator` is moved into `standard` provider in Airflow 3.0;
- <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/performance/src/performance_dags/performance_dag/performance_dag.py#L95'>performance/src/performance_dags/performance_dag/performance_dag.py:95:13:</a> AIR302 `airflow.operators.bash.BashOperator` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/performance/src/performance_dags/performance_dag/performance_dag.py#L95'>performance/src/performance_dags/performance_dag/performance_dag.py:95:13:</a> AIR303 Import path `airflow.operators.bash` is moved into `standard` provider in Airflow 3.0;
- <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/providers/edge/src/airflow/providers/edge/example_dags/integration_test.py#L115'>providers/edge/src/airflow/providers/edge/example_dags/integration_test.py:115:24:</a> AIR302 `airflow.operators.bash.BashOperator` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/providers/edge/src/airflow/providers/edge/example_dags/integration_test.py#L115'>providers/edge/src/airflow/providers/edge/example_dags/integration_test.py:115:24:</a> AIR303 Import path `airflow.operators.bash` is moved into `standard` provider in Airflow 3.0;
- <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/tests/decorators/test_bash.py#L521'>tests/decorators/test_bash.py:521:13:</a> AIR302 `airflow.operators.bash.BashOperator` is removed in Airflow 3.0
+ <a href='https://github.com/apache/airflow/blob/dea2cc9afc61caf49621c3b1923bcf90e96e17e9/tests/decorators/test_bash.py#L521'>tests/decorators/test_bash.py:521:13:</a> AIR303 Import path `airflow.operators.bash` is moved into `standard` provider in Airflow 3.0;
</pre>

</p>
</details>
<details><summary>Changes by rule (2 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| AIR303 | 5 | 5 | 0 | 0 | 0 |
| AIR302 | 5 | 0 | 5 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dhruvmanila on 2025-02-07 08:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @dhruvmanila on 2025-02-07 08:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-02-07 08:50</div>
            <div class="timeline-body"><blockquote>
<p>I'm thinking of splitting related test cases into separate files in the following PRs. Otherwise, it's a bit difficult to check the test cases.</p>
</blockquote>
<p>I think that'd be useful. We usually prefer self-contained PRs as it's much easier to review. As per the PR description, it seems like this might be doing multiple things (Fix <code>AIR303</code>, refactor <code>AIR302</code> and improve error message in <code>AIR302</code>). If it's not too much to ask, is it possible to split them in their own separate PRs? It'll also be useful for the CHANGELOG as the entries are generated using PR title. Let me know what you prefer, otherwise I can review the PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-02-07 09:02</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I'm thinking of splitting related test cases into separate files in the following PRs. Otherwise, it's a bit difficult to check the test cases.</p>
</blockquote>
<p>I think that'd be useful. We usually prefer self-contained PRs as it's much easier to review. As per the PR description, it seems like this might be doing multiple things (Fix <code>AIR303</code>, refactor <code>AIR302</code> and improve error message in <code>AIR302</code>). If it's not too much to ask, is it possible to split them in their own separate PRs? It'll also be useful for the CHANGELOG as the entries are generated using PR title. Let me know what you prefer, otherwise I can review the PR.</p>
</blockquote>
<p>I love this idea! I was worried about creating too many small PRs. Thanks for letting me know!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @Lee-W on 2025-02-07 09:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @Lee-W on 2025-02-07 10:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-02-07 10:51</div>
            <div class="timeline-body"><p>I just splited this into 3 pull requests (including this one). üôå I may need to rebase a bit after one is merged, but I should be fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-02-11 09:34</div>
            <div class="timeline-body"><p>@Lee-W Is this ready to be reviewed? Is it rebased after the split PRs have been merged?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lee-W">@Lee-W</a> on 2025-02-11 10:31</div>
            <div class="timeline-body"><blockquote>
<p>@Lee-W Is this ready to be reviewed? Is it rebased after the split PRs have been merged?</p>
</blockquote>
<p>Hi, yes, this is already based on those PRs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/moved_to_provider_in_3.rs</code>:911 on 2025-02-12 05:57</div>
            <div class="timeline-body"><p>Should the <code>new_path</code> here be <code>bash_operator</code> (similar to the change above in <code>bash</code>) ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on <code>crates/ruff_linter/src/rules/airflow/rules/moved_to_provider_in_3.rs</code>:592 on 2025-02-12 05:58</div>
            <div class="timeline-body"><p>nit: Is this how <code>rustfmt</code> is formatting this with <code>name</code> field being indented more than the other fields? Seems like a bug if that's the case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2025-02-12 05:59</div>
            <div class="timeline-body"><p>Looks good, minor one small question.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-02-12 06:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/moved_to_provider_in_3.rs</code>:911 on 2025-02-12 06:57</div>
            <div class="timeline-body"><p>No, it should be <code>bash</code>. we move all these things to <code>airflow.providers.standard.operators.bash</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-02-12 06:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/moved_to_provider_in_3.rs</code>:592 on 2025-02-12 06:57</div>
            <div class="timeline-body"><p>hmmm... didn't notice this one. let me check again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2025-02-12 06:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/moved_to_provider_in_3.rs</code>:592 on 2025-02-12 06:59</div>
            <div class="timeline-body"><p>I guess this was just my mistake. just fixed it. thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[airflow] fix ImportPathMoved / ProviderName misuse (AIR303)" to "[`airflow`] Fix `ImportPathMoved` / `ProviderName` misuse (`AIR303`)" by @dhruvmanila on 2025-02-12 07:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @dhruvmanila on 2025-02-12 07:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2025-02-12 07:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:09:49 UTC
    </footer>
</body>
</html>
