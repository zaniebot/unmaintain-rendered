<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`flake8-pytest-style`] Test function parameters with default arguments (`PT028`) - astral-sh/ruff #15449</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>flake8-pytest-style</code>] Test function parameters with default arguments (<code>PT028</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/15449">#15449</a>
        opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a>
        on 2025-01-13 02:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-01-13 02:14</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Resolves #15412.</p>
<h2>Test Plan</h2>
<p><code>cargo nextest run</code> and <code>cargo insta test</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-01-13 02:21</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+95 -0 violations, +0 -0 fixes in 6 projects; 49 projects unchanged)</p>
<details><summary><a href="https://github.com/PlasmaPy/PlasmaPy">PlasmaPy/PlasmaPy</a> (+1 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/PlasmaPy/PlasmaPy/blob/fcb706cca4ff224daf70a92a6ea11fc7cb1736bd/tests/formulary/test_thermal_speed.py#L400'>tests/formulary/test_thermal_speed.py:400:43:</a> PT028 Test function parameter `kwargs` has default argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/airflow">apache/airflow</a> (+49 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L102'>helm_tests/airflow_aux/test_container_lifecycle.py:102:54:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L123'>helm_tests/airflow_aux/test_container_lifecycle.py:123:59:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L168'>helm_tests/airflow_aux/test_container_lifecycle.py:168:65:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L187'>helm_tests/airflow_aux/test_container_lifecycle.py:187:64:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L208'>helm_tests/airflow_aux/test_container_lifecycle.py:208:68:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L41'>helm_tests/airflow_aux/test_container_lifecycle.py:41:52:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_container_lifecycle.py#L78'>helm_tests/airflow_aux/test_container_lifecycle.py:78:45:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/helm_tests/airflow_aux/test_pod_template_file.py#L927'>helm_tests/airflow_aux/test_pod_template_file.py:927:84:</a> PT028 Test function parameter `hook_type` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L1029'>providers/tests/amazon/aws/hooks/test_eks.py:1029:66:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L243'>providers/tests/amazon/aws/hooks/test_eks.py:243:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L253'>providers/tests/amazon/aws/hooks/test_eks.py:253:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L263'>providers/tests/amazon/aws/hooks/test_eks.py:263:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L332'>providers/tests/amazon/aws/hooks/test_eks.py:332:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L350'>providers/tests/amazon/aws/hooks/test_eks.py:350:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L362'>providers/tests/amazon/aws/hooks/test_eks.py:362:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L373'>providers/tests/amazon/aws/hooks/test_eks.py:373:58:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L402'>providers/tests/amazon/aws/hooks/test_eks.py:402:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L412'>providers/tests/amazon/aws/hooks/test_eks.py:412:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L445'>providers/tests/amazon/aws/hooks/test_eks.py:445:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L473'>providers/tests/amazon/aws/hooks/test_eks.py:473:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L640'>providers/tests/amazon/aws/hooks/test_eks.py:640:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L654'>providers/tests/amazon/aws/hooks/test_eks.py:654:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L686'>providers/tests/amazon/aws/hooks/test_eks.py:686:60:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L809'>providers/tests/amazon/aws/hooks/test_eks.py:809:66:</a> PT028 Test function parameter `initial_batch_size` has default argument
+ <a href='https://github.com/apache/airflow/blob/ead9386a68bb104e5afafca3c5d768afa27dc89d/providers/tests/amazon/aws/hooks/test_eks.py#L819'>providers/tests/amazon/aws/hooks/test_eks.py:819:66:</a> PT028 Test function parameter `initial_batch_size` has default argument
... 24 additional changes omitted for project
</pre>

</p>
</details>
<details><summary><a href="https://github.com/apache/superset">apache/superset</a> (+2 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/apache/superset/blob/aae8fda11dafdd96298884962e790d10bd0104d0/superset/cli/test_db.py#L141'>superset/cli/test_db.py:141:66:</a> PT028 Test function parameter `raw_engine_kwargs` has default argument
+ <a href='https://github.com/apache/superset/blob/aae8fda11dafdd96298884962e790d10bd0104d0/tests/integration_tests/db_engine_specs/base_engine_spec_tests.py#L50'>tests/integration_tests/db_engine_specs/base_engine_spec_tests.py:50:63:</a> PT028 Test function parameter `engine_spec_class` has default argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/pandas-dev/pandas/blob/7415aca37159a99f8f99d93a1908070ddf36178c/asv_bench/benchmarks/gil.py#L39'>asv_bench/benchmarks/gil.py:39:31:</a> PT028 Test function parameter `num_threads` has default argument
+ <a href='https://github.com/pandas-dev/pandas/blob/7415aca37159a99f8f99d93a1908070ddf36178c/asv_bench/benchmarks/gil.py#L39'>asv_bench/benchmarks/gil.py:39:46:</a> PT028 Test function parameter `kwargs_list` has default argument
+ <a href='https://github.com/pandas-dev/pandas/blob/7415aca37159a99f8f99d93a1908070ddf36178c/pandas/util/_tester.py#L15'>pandas/util/_tester.py:15:41:</a> PT028 Test function parameter `extra_args` has default argument
+ <a href='https://github.com/pandas-dev/pandas/blob/7415aca37159a99f8f99d93a1908070ddf36178c/pandas/util/_tester.py#L15'>pandas/util/_tester.py:15:68:</a> PT028 Test function parameter `run_doctests` has default argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+4 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/zulip/zulip/blob/658e34248035b7e914ea25c90b4344a4ad72f104/tools/lib/test_server.py#L56'>tools/lib/test_server.py:56:34:</a> PT028 Test function parameter `skip_provision_check` has default argument
+ <a href='https://github.com/zulip/zulip/blob/658e34248035b7e914ea25c90b4344a4ad72f104/tools/lib/test_server.py#L57'>tools/lib/test_server.py:57:26:</a> PT028 Test function parameter `external_host` has default argument
+ <a href='https://github.com/zulip/zulip/blob/658e34248035b7e914ea25c90b4344a4ad72f104/tools/lib/test_server.py#L58'>tools/lib/test_server.py:58:28:</a> PT028 Test function parameter `log_file` has default argument
+ <a href='https://github.com/zulip/zulip/blob/658e34248035b7e914ea25c90b4344a4ad72f104/tools/lib/test_server.py#L59'>tools/lib/test_server.py:59:18:</a> PT028 Test function parameter `dots` has default argument
</pre>

</p>
</details>
<details><summary><a href="https://github.com/astropy/astropy">astropy/astropy</a> (+35 -0 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/io/votable/tests/test_vo.py#L950'>astropy/io/votable/tests/test_vo.py:950:36:</a> PT028 Test function parameter `test_path_object` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/modeling/tests/test_models.py#L47'>astropy/modeling/tests/test_models.py:47:41:</a> PT028 Test function parameter `amplitude` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/modeling/tests/test_models.py#L47'>astropy/modeling/tests/test_models.py:47:54:</a> PT028 Test function parameter `frequency` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_bayesian_blocks.py#L10'>astropy/stats/tests/test_bayesian_blocks.py:10:36:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_bayesian_blocks.py#L167'>astropy/stats/tests/test_bayesian_blocks.py:167:35:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_bayesian_blocks.py#L20'>astropy/stats/tests/test_bayesian_blocks.py:20:33:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_bayesian_blocks.py#L35'>astropy/stats/tests/test_bayesian_blocks.py:35:47:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L101'>astropy/stats/tests/test_histogram.py:101:38:</a> PT028 Test function parameter `N` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L101'>astropy/stats/tests/test_histogram.py:101:50:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L112'>astropy/stats/tests/test_histogram.py:112:43:</a> PT028 Test function parameter `N` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L112'>astropy/stats/tests/test_histogram.py:112:55:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L172'>astropy/stats/tests/test_histogram.py:172:30:</a> PT028 Test function parameter `N` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L172'>astropy/stats/tests/test_histogram.py:172:42:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L17'>astropy/stats/tests/test_histogram.py:17:28:</a> PT028 Test function parameter `N` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L17'>astropy/stats/tests/test_histogram.py:17:41:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L31'>astropy/stats/tests/test_histogram.py:31:31:</a> PT028 Test function parameter `N` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L31'>astropy/stats/tests/test_histogram.py:31:44:</a> PT028 Test function parameter `rseed` has default argument
+ <a href='https://github.com/astropy/astropy/blob/81e9ac2a6e661ee2a67fe49612430ef0f933e9dd/astropy/stats/tests/test_histogram.py#L60'>astropy/stats/tests/test_histogram.py:60:28:</a> PT028 Test function parameter `N` has default argument
... 17 additional changes omitted for project
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PT028 | 95 | 95 | 0 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-01-13 02:48</div>
            <div class="timeline-body"><p><code>is_likely_pytest_test()</code> and <code>is_likely_pytest_test_file()</code> were taken almost verbatim from #15158. The only change is that the former now no longer calls the latter. This is because <code>flake8-pytest-style</code> says a function is a test function <a href="https://github.com/m-burst/flake8-pytest-style/blob/2c53993e5c5cfc1f4d5e16f30a8e700532cd6f5b/flake8_pytest_style/utils.py#L275-L277">when its name starts with <code>test_</code></a>.</p>
<p>Aside from that change, I think <code>is_likely_pytest_test()</code>'s divergence is for the better. I can't say the same about <code>is_likely_pytest_test_file()</code>, however, so it is currently dead code. What should be done with these two?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 08:07</div>
            <div class="timeline-body"><pre><code class="language-suggestion">    if !func.name.starts_with(&quot;test_&quot;) {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:64 on 2025-01-13 08:09</div>
            <div class="timeline-body"><p>We should delete this function if it isn't used anywhere other than in a docstring.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:78 on 2025-01-13 08:13</div>
            <div class="timeline-body"><p>I'm not sure if we should provide a fix here because it is likely to break the test:</p>
<ul>
<li>I'd have to test this but isn't the pytest call going to fail without the default value?</li>
<li>Assuming the call succeeds, <code>a</code> now no longer has the value <code>1</code> and instead some other default value (<code>None</code>?) This can lead to all sort of failures when running the test.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:67 on 2025-01-13 08:15</div>
            <div class="timeline-body"><p>This differs from the upstream rule that intentionally ignores <code>posonly</code> arguments</p>
<p>https://github.com/m-burst/flake8-pytest-style/blob/92c080312e36c13d2d7725d7bbd89d75d7eaae65/flake8_pytest_style/visitors/t_functions.py#L16-L23</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/snapshots/ruff_linter__rules__flake8_pytest_style__tests__PT028.snap</code>:4 on 2025-01-13 08:16</div>
            <div class="timeline-body"><p>Let's add some tests similar to the ones in the upstream implementation that verify the correct behavior for different parameter kinds.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:63 on 2025-01-13 08:20</div>
            <div class="timeline-body"><p>Are there cases where this method returns <code>false</code> for a proper <code>pytest</code>? If not, I suggest renaming it ti <code>is_pytest_test</code>.</p>
<p>We should document whether the function has false negatives or false positives and, if so, when they occur.</p>
<p>Let's also include this a link to https://docs.pytest.org/en/stable/explanation/goodpractices.html#conventions-for-python-test-discovery . I found it a very useful reference to have</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> requested changes on 2025-01-13 08:21</div>
            <div class="timeline-body"><p>Thank you. I've a few comments regarding the implementation and I think we should remove the fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-01-13 08:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2025-01-13 08:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-13 08:23</div>
            <div class="timeline-body"><p>Did you review the ecosystem changes?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 08:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:67 on 2025-01-13 08:49</div>
            <div class="timeline-body"><p>That block is for <code>PT019</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 08:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:78 on 2025-01-13 08:52</div>
            <div class="timeline-body"><p>I think the fix goes well with the help message (&quot;Remove default argument&quot;); should it be marked display-only instead?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 08:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 08:59</div>
            <div class="timeline-body"><p>This would be incorrect. <a href="https://docs.pytest.org/en/stable/explanation/goodpractices.html#conventions-for-python-test-discovery">The conventions guide</a> says test functions start with <code>test</code> (i.e. including <code>testFoo</code>), not <code>test_</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-01-13 09:18</div>
            <div class="timeline-body"><p>@MichaReiser Yes. There are a couple of false positives. For example:</p>
<p><a href="https://github.com/pandas-dev/pandas/blob/57d248978a4168aa73871a62ab79c47dc2977bb0/asv_bench/benchmarks/gil.py#L39">@pandas-dev/pandas</a>:</p>
<pre><code class="language-python">def test_parallel(num_threads=2, kwargs_list=None):
    &quot;&quot;&quot;
    Decorator to run the same function multiple times in parallel.
    ...
    &quot;&quot;&quot;
    ...
</code></pre>
<p><a href="https://github.com/zulip/zulip/blob/658e34248035b7e914ea25c90b4344a4ad72f104/tools/lib/test_server.py#L55">@zulip/zulip</a>:</p>
<pre><code class="language-python">def test_server_running(
    skip_provision_check: bool = False,
    external_host: str = &quot;testserver&quot;,
    log_file: str | None = None,
    dots: bool = False,
) -&gt; Iterator[None]:
    ...
</code></pre>
<p>These kinds of false positives can be reduced (the former would no longer be reported) by making <code>is_likely_pytest_test()</code> call <code>is_likely_pytest_test_file()</code>. That would be quite a divergence from upstream, however, as discussed above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 09:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:63 on 2025-01-13 09:21</div>
            <div class="timeline-body"><p>This function can never be perfectly correct due to user configurations (namely, <code>testpaths</code> and <code>norecursedirs</code>). Therefore, I think <code>is_pytest_test</code> is misleading as a name.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-13 09:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:63 on 2025-01-13 09:28</div>
            <div class="timeline-body"><p>I understand that those configuration options only applying to <code>is_pytest_file</code>. So for long as we aren't checking <code>is_pytest_file</code> in <code>is_pytest_test</code>, the function should be fine?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-13 09:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 09:29</div>
            <div class="timeline-body"><p>The upstream implementation uses <code>test_</code>: https://github.com/m-burst/flake8-pytest-style/blob/92c080312e36c13d2d7725d7bbd89d75d7eaae65/flake8_pytest_style/visitors/t_functions.py#L19</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-13 09:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:67 on 2025-01-13 09:29</div>
            <div class="timeline-body"><p>And PT028?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 09:44</div>
            <div class="timeline-body"><p>I still prefer checking for <code>test</code>, since that encompasses a superset of those encompassed by <code>test_</code>. I believe this is a useful divergence.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 09:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 09:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:63 on 2025-01-13 09:47</div>
            <div class="timeline-body"><p>Yes, but whether <code>is_likely_pytest_test_file()</code> should be called is what we are discussing. It does help with some false positives, as explained below.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-13 10:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 10:18</div>
            <div class="timeline-body"><p>We should try to find the relevant code in pytest and then use whatever pytest uses.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-13 10:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:78 on 2025-01-13 10:19</div>
            <div class="timeline-body"><p>We could make it <code>display-only</code> but I don't think we're displaying <code>display-only</code> fixes today, so we could as well just remove it. But I'm fine with either (display only or removing it)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 11:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 11:39</div>
            <div class="timeline-body"><p>Pytest <a href="https://docs.pytest.org/en/stable/example/pythoncollection.html#changing-naming-conventions">allows configuring naming conventions</a>. I suppose that means <code>test</code> should be used.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> reviewed on 2025-01-13 11:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/test_functions.rs</code>:67 on 2025-01-13 11:51</div>
            <div class="timeline-body"><p>The first <code>for</code> loop is for <code>PT019</code>. <a href="https://github.com/m-burst/flake8-pytest-style/blob/92c080312e36c13d2d7725d7bbd89d75d7eaae65/tests/test_PT028_test_function_argument_with_default.py">Test cases</a> show that positional-only parameters are not ignored.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-01-13 12:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/src/rules/flake8_pytest_style/rules/helpers.rs</code>:66 on 2025-01-13 12:26</div>
            <div class="timeline-body"><p>We can keep <code>test</code> because of the default here https://github.com/pytest-dev/pytest/blob/477e9283aabc93f8d3ad34ff0b98f68b5a432aa8/src/_pytest/python.py#L96</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-01-13 12:40</div>
            <div class="timeline-body"><p>Thanks for addressing the feedback.</p>
<p>I'm leaning towards not adding the <em>is this a pytest file</em> just yet because it would introduce the need for a new option for those not using the default file name patterns. We can decide to restrict the rule in the future if this comes up often. The other reason why I'm for deferring is that there are still some false negatives because many of the non-test test functions are defined in files prefixed with <code>test_</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-01-13 12:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-01-13 12:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-13 14:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 20:34:30 UTC
    </footer>
</body>
</html>
