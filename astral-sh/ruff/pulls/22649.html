<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>conformance.py: Only use the &quot;No changes detected ✅&quot; summary if no diagnostics were added or removed - astral-sh/ruff #22649</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>conformance.py: Only use the &quot;No changes detected ✅&quot; summary if no diagnostics were added or removed</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22649">#22649</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2026-01-17 13:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>Currently if there are no top-line changes to the statistics, we display a &quot;No changes detected ✅&quot; top-line summary. But that&#x27;s a bit weird in situations like <a href="https://github.com/astral-sh/ruff/pull/22644">astral-sh/ruff#22644</a>#issuecomment-3762939568, where there clearly <em>were</em> changes detected, they just didn&#x27;t impact the top-line statistics at all (because exactly the same number of false positives were added as there were false positives removed):</p>
<p><img alt="image" src="https://github.com/user-attachments/assets/ec147aca-e0e5-43f5-9ce5-2e71a6780312"></p>
<p>This PR changes the logic in <code>conformance.py</code> so that we only use the &quot;No changes detected ✅&quot; summary if there really were no changes detected!</p>
Test Plan
<p>I:</p>
<ul>
<li>Checked out the <code>main</code> branch and ran <code>cargo build -p ty &amp;&amp; mv ./target/debug/ty ./target/debug/ty-old</code></li>
<li>Checked out the branch for #22644 and ran <code>cargo build -p ty &amp;&amp; mv ./target/debug/ty ./target/debug/ty-new</code></li>
<li>Checked out this branch again and ran <code>uv run --no-project scripts/conformance.py --old-ty=./target/debug/ty-old --new-ty=./target/debug/ty-new --tests-path=../typing/conformance/tests --output=results.md</code></li>
<li>Observed that the following MarkDown was generated:</li>
</ul>
<hr>
<a href="https://github.com/python/typing/blob/main/conformance/">Typing conformance results</a>
<p>The percentage of diagnostics emitted that were expected errors held steady at 75.50%. The percentage of expected errors that received a diagnostic held steady at 59.30%.</p>
Summary
<p>| Metric | Old | New | Diff | Outcome |
|--------|-----|-----|------|---------|
| True Positives  | 641 | 641 | +0 |  |
| False Positives | 208 | 208 | +0 |  |
| False Negatives | 440 | 440 | +0 |  |
| Total Diagnostics | 849 | 849 | +0 |  |
| Precision | 75.50% | 75.50% | +0.00% |  |
| Recall | 59.30% | 59.30% | +0.00% |  |</p>
False positives removed


<p>| Location | Name | Message |
|----------|------|---------|
| <a href="https://github.com/python/typing/blob/main/conformance/tests/aliases_type_statement.py#L10">aliases_type_statement.py:10:52</a> | invalid-type-arguments | Too many type arguments: expected 2, got 3 |
| <a href="https://github.com/python/typing/blob/main/conformance/tests/aliases_typealiastype.py#L23">aliases_typealiastype.py:23:5</a> | invalid-argument-type | Argument to class <code>TypeAliasType</code> is incorrect: Expected <code>tuple[TypeVar \| ParamSpec \| typing_extensions.TypeVarTuple, ...]</code>, found <code>tuple[TypeVar, TypeVar, ParamSpec, typing.TypeVarTuple]</code> |</p>


False positives added


<p>| Location | Name | Message |
|----------|------|---------|
| <a href="https://github.com/python/typing/blob/main/conformance/tests/generics_defaults.py#L88">generics_defaults.py:88:39</a> | invalid-legacy-type-variable | The <code>default</code> parameter of <code>typing.TypeVarTuple</code> was added in Python 3.13 |
| <a href="https://github.com/python/typing/blob/main/conformance/tests/generics_defaults.py#L99">generics_defaults.py:99:53</a> | invalid-legacy-type-variable | The <code>default</code> parameter of <code>typing.TypeVarTuple</code> was added in Python 3.13 |</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ci</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-17 13:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-17 13:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-17 13:04</div>
            <div class="timeline-body"><p>@WillDuke, I don&#x27;t think I can request your review here, but I&#x27;d love your feedback if you have time!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-17 13:05</div>
            <div class="timeline-body">

<a href="https://github.com/python/typing/blob/9f6d8ced7cd1c8d92687a4e9c96d7716452e471e/conformance/">Typing conformance results</a>
<p>No changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-17 13:12</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
Formatter (stable)
<p>✅ ecosystem check detected no format changes.</p>
Formatter (preview)
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WillDuke">@WillDuke</a> on 2026-01-17 13:26</div>
            <div class="timeline-body"><blockquote>
<p>@WillDuke, I don&#x27;t think I can request your review here, but I&#x27;d love your feedback if you have time!</p>
</blockquote>
<p>This looks good to me!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-17 13:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-17 13:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2026-01-17 13:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:23:09 UTC
    </footer>
</body>
</html>
