<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Add completions for `from module import &lt;CURSOR&gt;` - astral-sh/ruff #18830</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Add completions for <code>from module import &lt;CURSOR&gt;</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/18830">#18830</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2025-06-20 18:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a></div>
            <div class="timeline-body"><p>There were two main challenges in this PR.</p>
<p>The first was mostly just figuring out how to get the symbols
corresponding to <code>module</code>. It turns out that we do this in a couple
of places in ty already, but through different means. In one approach,
we use <a href="https://github.com/astral-sh/ruff/blob/23a3b6ef2337c8a2c1496ebf68d12582f0b0706d/crates/ty_python_semantic/src/semantic_index/re_exports.rs#L47"><code>exported_names</code></a>. In another approach, we get a <code>Type</code>
corresponding to the module. We take the latter approach here, which is
consistent with how we do completions elsewhere. (I looked into
factoring this logic out into its own function, but it ended up being
pretty constrained. e.g., There's only one other place where we want to
go from <code>ast::StmtImportFrom</code> to a module <code>Type</code>, and that code also
wants the module name.)</p>
<p>The second challenge was recognizing the <code>from module import &lt;CURSOR&gt;</code>
pattern in the code. I initially started with some fixed token patterns
to get a proof of concept working. But I ended up switching to mini
state machine over tokens. I looked at the parser for <code>StmtImportFrom</code>
to determine what kinds of tokens we can expect.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @BurntSushi on 2025-06-20 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @BurntSushi on 2025-06-20 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @BurntSushi on 2025-06-20 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @BurntSushi on 2025-06-20 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @BurntSushi on 2025-06-20 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @dcreager removed by @BurntSushi on 2025-06-20 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @carljm removed by @BurntSushi on 2025-06-20 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @sharkdp removed by @BurntSushi on 2025-06-20 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dhruvmanila by @BurntSushi on 2025-06-20 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-06-20 18:49</div>
            <div class="timeline-body"><p>Demo video (featuring VS Code):</p>
<p>https://github.com/user-attachments/assets/6a377d49-ec5b-40e1-a3da-5fb7ecd4f8d5</p>
<p>(Doing this made me realize that VS Code seems to be sorting completions lexicographically, despite the fact that ty is returning completions in a different order. I still have to investigate that.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-06-20 18:53</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<p>No ecosystem changes detected âœ…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by @ntBre on 2025-06-20 19:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @AlexWaygood on 2025-06-20 21:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/completion.rs</code>:1 on 2025-06-20 21:11</div>
            <div class="timeline-body"><p>For completeness's sake, I feel like it would be ideal if we could also have a couple of tests for relative imports (where <code>level</code> is not 0). But I know that that's kind of a pain to setup given how the tests currently work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:67 on 2025-06-20 21:28</div>
            <div class="timeline-body"><p>this looks great to me! I think the one thing it misses is that as well as <em>members</em> of the module, we should <em>also</em> suggest submodules. It wouldn't be correct to e.g. include <code>resources</code> in the result of <code>all_members(&lt;module 'importlib'&gt;)</code>, because it's <em>not</em> a member of <code>importlib</code>:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; import importlib
&gt;&gt;&gt; importlib.resources
Traceback (most recent call last):
  File &quot;&lt;python-input-1&gt;&quot;, line 1, in &lt;module&gt;
    importlib.resources
AttributeError: module 'importlib' has no attribute 'resources'
</code></pre>
<p>But you <em>can</em> do this!</p>
<pre><code class="language-pycon">&gt;&gt;&gt; from importlib import resources
&gt;&gt;&gt; 
</code></pre>
<p>(Note that due to some ugly side effects of Python's import system, <em>some</em> submodules <em>are</em> available as attributes on their parent modules at import time, such as e.g. <code>collections.abc</code>. But that isn't generally true.)</p>
<p>I haven't thought too hard about how we could get the list of submodules of a parent module, but I could put some thought into that over the weekend or next week if it would be helpful!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/completion.rs</code>:293 on 2025-06-20 21:33</div>
            <div class="timeline-body"><p>I suppose an ellipsis token would be &quot;part of a module&quot; for something like <code>from ...foo import bar</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-06-20 21:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_ide/src/completion.rs</code>:93 on 2025-06-23 06:56</div>
            <div class="timeline-body"><p>Remove?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-06-23 06:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_ide/src/completion.rs</code>:34 on 2025-06-23 06:57</div>
            <div class="timeline-body"><p>Remove? Or add some more information (what is printed)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-06-23 06:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a> reviewed on 2025-06-23 07:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/sharkdp">@sharkdp</a> on <code>crates/ty_ide/src/completion.rs</code>:255 on 2025-06-23 07:06</div>
            <div class="timeline-body"><p>Is it possible for this function to be called for more or less arbitrary positions in the source file? Could it be triggered from a completion request at the end of a very long file? Because it looks like it might walk back arbitrarily long distances (if no <code>from</code> token is ever encountered), potentially making completions slow?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-06-23 11:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/completion.rs</code>:302 on 2025-06-23 11:17</div>
            <div class="timeline-body"><p>Allowing <code>Unknown</code> makes sense. E.g. the lexer emits <code>Unknown</code> for any token it doesn't recognize or if there's something &quot;wrong&quot; with the token (e.g. an. unterminated string):</p>
<p>This creates two unknown tokens:</p>
<pre><code class="language-py">from test import (
    ??
)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ty_ide/src/completion.rs</code>:293 on 2025-06-23 11:18</div>
            <div class="timeline-body"><p>Do we also need to allow <code>Unknown</code> here?</p>
<pre><code class="language-py">from ? import (
    
)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-06-23 11:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2025-06-23 11:20</div>
            <div class="timeline-body"><p>Nice!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 13:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:67 on 2025-06-23 13:17</div>
            <div class="timeline-body"><p>Yeah I do think that would be helpful! Thank you. I'll also add this to my notes.</p>
<p>I think <code>os.path</code> is another one.</p>
<p>Interestingly, if I do this in <code>bpython</code>, it lets me do <code>importlib.resources</code>:</p>
<pre><code>bpython version 0.25 on top of Python 3.13.3 /usr/bin/python
&gt;&gt;&gt; import importlib
&gt;&gt;&gt; importlib.resources
&lt;module 'importlib.resources' from '/usr/lib/python3.13/importlib/resour
ces/__init__.py'&gt;
</code></pre>
<p>But in a standard Python interpreter, no dice:</p>
<pre><code>Python 3.13.3 (main, Apr  9 2025, 07:44:25) [GCC 14.2.1 20250207] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import importlib
&gt;&gt;&gt; importlib.resources
Traceback (most recent call last):
  File &quot;&lt;python-input-1&gt;&quot;, line 1, in &lt;module&gt;
    importlib.resources
AttributeError: module 'importlib' has no attribute 'resources'
&gt;&gt;&gt;
</code></pre>
<p>I wonder if <code>bpython</code> is auto-importing sub-modules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 13:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:67 on 2025-06-23 13:20</div>
            <div class="timeline-body"><p>The other side to this is that</p>
<pre><code>import importlib.resources
importlib.&lt;CURSOR&gt;
</code></pre>
<p>should include <code>resources</code> in the completions offered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:67 on 2025-06-23 13:23</div>
            <div class="timeline-body"><blockquote>
<p>Interestingly, if I do this in <code>bpython</code>, it lets me do <code>importlib.resources</code>:</p>
</blockquote>
<p>This is almost certainly because <code>bpython</code> is written in Python, and somewhere deep in the guts of <code>bpython</code> (or some dependency of <code>bpython</code>) there's either an <code>import importlib.resources</code> statement, or a <code>from importlib.resources import &lt;whatever&gt;</code> statement. Either would result in the <code>importlib.resources</code> submodule being cached as a <code>.resources</code> attribute on the <code>importlib</code> module.</p>
<p>This is exactly what I meant above when I mentioned &quot;ugly side effects&quot; of Python's import system ðŸ˜„</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-23 13:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-23 13:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:67 on 2025-06-23 13:25</div>
            <div class="timeline-body"><blockquote>
<p>The other side to this is that</p>
<pre><code>import importlib.resources
importlib.&lt;CURSOR&gt;
</code></pre>
<p>should include <code>resources</code> in the completions offered.</p>
</blockquote>
<p>In this case, I would <em>hope</em> that we would recognize that <code>resources</code> is available as an attribute on the <code>importlib</code> module, and we would therefore include <code>&quot;resources&quot;</code> in the set returned by <code>all_members</code>...? (That's the behaviour I'd <em>expect</em>, but IDK if it's what we actually <em>do</em>, to be clear ðŸ˜†)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 13:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/completion.rs</code>:255 on 2025-06-23 13:33</div>
            <div class="timeline-body"><p>Yes it is possible. But the loop will bail in lots of cases, not just when no <code>from</code> token is encountered.</p>
<p>It could walk back arbitrarily long distances for what I suspect are pathological inputs though. But, for example, if any <code>Newline</code> token is seen, that alone will immediately stop the loop.</p>
<p>But maybe I'm wrong about this being limited to pathological inputs. For example, I if there's just a long list of name tokens before the cursor that isn't an import, then that would cause this state machine to loop over all of them I think.</p>
<p>On the other hand, by the time we get to this point, ty has to have already done at least <em>some</em> work proportional to the length of <code>tokens</code>? Unless we know how to update a list of tokens based on a diff with a previous revision of the file I guess.</p>
<p>I suppose it wouldn't hurt to put an upper limit on this though. OK, I've done that, with 1,000 as the limit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/completion.rs</code>:293 on 2025-06-23 13:37</div>
            <div class="timeline-body"><p>@AlexWaygood Right. I learned that fact from reading the parser. :-)</p>
<p>@MichaReiser It's not clear to me that we do. I did add <code>Unknown</code> to the tokens making up the imported names because I actually ran into that case when testing. But, e.g., in your example, I don't think we'd be able to offer completions anyway since <code>?</code> doesn't resolve to a module. On the other hand, maybe that is indeed exactly what we want. If we don't match your example, then we'd fall through to other forms of completions, e.g., potentially scope based completions. Which seems wrong here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 13:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/completion.rs</code>:293 on 2025-06-23 13:58</div>
            <div class="timeline-body"><p>OK, this is done. Indeed, <code>from ? import &lt;CURSOR&gt;</code> was giving scope based completions, which is definitely not right. But recognizing the unknown token in module names makes this work as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 13:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 14:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_python_semantic/src/semantic_model.rs</code>:67 on 2025-06-23 14:01</div>
            <div class="timeline-body"><p>Aye yeah, I've added some tests to cover this:</p>
<pre><code class="language-rust">    #[test]
    fn import_submodule_not_attribute1() {
        let test = cursor_test(
            &quot;\
import importlib
importlib.&lt;CURSOR&gt;
&quot;,
        );
        test.assert_completions_do_not_include(&quot;resources&quot;);
    }

    #[test]
    fn import_submodule_not_attribute2() {
        let test = cursor_test(
            &quot;\
import importlib.resources
importlib.&lt;CURSOR&gt;
&quot;,
        );
        test.assert_completions_include(&quot;resources&quot;);
    }

    #[test]
    fn import_submodule_not_attribute3() {
        let test = cursor_test(
            &quot;\
import importlib
import importlib.resources
importlib.&lt;CURSOR&gt;
&quot;,
        );
        test.assert_completions_include(&quot;resources&quot;);
    }
</code></pre>
<p>The first test passes, but the latter two fail.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 14:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/completion.rs</code>:1 on 2025-06-23 14:11</div>
            <div class="timeline-body"><p>Yeah I agree that would be nice. Is it okay with you if I do this in a follow-up PR? I think I'd like to do a little refactoring of the cursor test stuff to make this work nicely.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2025-06-23 14:23</div>
            <div class="timeline-body"><p>Looks good, I haven't done a thorough review as there are already 3 reviewers :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-23 14:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/completion.rs</code>:2168 on 2025-06-23 14:26</div>
            <div class="timeline-body"><p>Here's a patch that gets these tests passing:</p>
<pre><code class="language-diff">diff --git a/crates/ty_ide/src/completion.rs b/crates/ty_ide/src/completion.rs
index eeef8324d0..30d5fd6616 100644
--- a/crates/ty_ide/src/completion.rs
+++ b/crates/ty_ide/src/completion.rs
@@ -2148,9 +2148,7 @@ import importlib.resources
 importlib.&lt;CURSOR&gt;
 &quot;,
         );
-        // TODO: This is wrong. Completions should include
-        // `resources` here.
-        test.assert_completions_do_not_include(&quot;resources&quot;);
+        test.assert_completions_include(&quot;resources&quot;);
     }
 
     #[test]
@@ -2162,9 +2160,7 @@ import importlib.resources
 importlib.&lt;CURSOR&gt;
 &quot;,
         );
-        // TODO: This is wrong. Completions should include
-        // `resources` here.
-        test.assert_completions_do_not_include(&quot;resources&quot;);
+        test.assert_completions_include(&quot;resources&quot;);
     }
 
     #[test]
diff --git a/crates/ty_python_semantic/src/module_name.rs b/crates/ty_python_semantic/src/module_name.rs
index 2111a64b83..39b14e9751 100644
--- a/crates/ty_python_semantic/src/module_name.rs
+++ b/crates/ty_python_semantic/src/module_name.rs
@@ -127,6 +127,16 @@ impl ModuleName {
         true
     }
 
+    pub fn relative_to(&amp;self, other: &amp;ModuleName) -&gt; Option&lt;ModuleName&gt; {
+        if self.starts_with(other) {
+            let relative_name = self.0.strip_prefix(&amp;*other.0)?.strip_prefix('.')?;
+            assert!(!relative_name.is_empty());
+            Some(ModuleName(CompactString::from(relative_name)))
+        } else {
+            None
+        }
+    }
+
     #[must_use]
     #[inline]
     pub fn as_str(&amp;self) -&gt; &amp;str {
diff --git a/crates/ty_python_semantic/src/types/ide_support.rs b/crates/ty_python_semantic/src/types/ide_support.rs
index 0dac4db19b..135e22abf0 100644
--- a/crates/ty_python_semantic/src/types/ide_support.rs
+++ b/crates/ty_python_semantic/src/types/ide_support.rs
@@ -2,7 +2,7 @@ use crate::Db;
 use crate::place::{imported_symbol, place_from_bindings, place_from_declarations};
 use crate::semantic_index::place::ScopeId;
 use crate::semantic_index::{
-    attribute_scopes, global_scope, place_table, semantic_index, use_def_map,
+    attribute_scopes, global_scope, imported_modules, place_table, semantic_index, use_def_map,
 };
 use crate::types::{ClassBase, ClassLiteral, KnownClass, Type};
 use ruff_python_ast::name::Name;
@@ -130,8 +130,9 @@ impl AllMembers {
 
             Type::ModuleLiteral(literal) =&gt; {
                 self.extend_with_type(db, KnownClass::ModuleType.to_instance(db));
+                let module = literal.module(db);
 
-                let Some(file) = literal.module(db).file() else {
+                let Some(file) = module.file() else {
                     return;
                 };
 
@@ -151,6 +152,16 @@ impl AllMembers {
                             .insert(place_table.place_expr(symbol_id).expect_name().clone());
                     }
                 }
+
+                let module_name = module.name();
+                self.members.extend(
+                    imported_modules(db, literal.importing_file(db))
+                        .iter()
+                        .filter_map(|submodule_name| dbg!(dbg!(submodule_name).relative_to(module_name)))
+                        .filter_map(|relative_submodule_name| {
+                            Some(Name::from(relative_submodule_name.components().next()?))
+                        }),
+                );
             }
         }
     }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-23 14:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/completion.rs</code>:2168 on 2025-06-23 14:28</div>
            <div class="timeline-body"><p>probably needs e.g. a couple of doctests for the new <code>ModuleName::relative_to</code> function, though (<code>ModuleName(&quot;importlib.resources&quot;).relative_to(ModuleName(&quot;importlib&quot;))</code> results in <code>ModuleName(&quot;resources&quot;)</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/completion.rs</code>:1 on 2025-06-23 14:28</div>
            <div class="timeline-body"><p>absolutely!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-23 14:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-23 14:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ty_ide/src/completion.rs</code>:2168 on 2025-06-23 14:29</div>
            <div class="timeline-body"><p>(feel free to tackle this in a followup too, if you prefer!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-06-23 14:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/ty_ide/src/completion.rs</code>:2168 on 2025-06-23 14:43</div>
            <div class="timeline-body"><p>Thanks! Yeah I'll tackle this in a follow-up too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @BurntSushi on 2025-06-23 14:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2025-06-23 14:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-06-23 14:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:13:33 UTC
    </footer>
</body>
</html>
