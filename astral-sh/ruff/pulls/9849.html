<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ignore builtins when detecting missing f-strings - astral-sh/ruff #9849</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ignore builtins when detecting missing f-strings</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/9849">#9849</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-02-06 00:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-06 00:23</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Reported on Discord: if the name maps to a builtin, it's not bound locally, so is very unlikely to be intended as an f-string expression.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @snowsignal by @charliermarsh on 2024-02-06 00:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-02-06 00:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2024-02-06 00:26</div>
            <div class="timeline-body"><p>Some real code to test against (I think in all 3 cases it was triggered because of builtins):</p>
<ul>
<li>https://github.com/indico/indico/blob/c4e45df45639efd6744307780189c4a3d9b134a5/indico/web/forms/validators.py#L346-L357</li>
<li>https://github.com/indico/indico/blob/c4e45df45639efd6744307780189c4a3d9b134a5/indico/modules/events/management/program_codes.py#L50</li>
<li>https://github.com/indico/indico/blob/c4e45df45639efd6744307780189c4a3d9b134a5/indico/util/mdx_latex.py#L394</li>
</ul>
<p>Errors with the current stable release:</p>
<pre><code>[adrian@eluvian:~/dev/indico/py3/src:master $]&gt; ruff check --select RUF027
indico/modules/events/management/program_codes.py:50:21: RUF027 Possible f-string without an `f` prefix
indico/util/mdx_latex.py:393:23: RUF027 Possible f-string without an `f` prefix
indico/web/forms/validators.py:350:36: RUF027 Possible f-string without an `f` prefix
indico/web/forms/validators.py:351:36: RUF027 Possible f-string without an `f` prefix
indico/web/forms/validators.py:353:36: RUF027 Possible f-string without an `f` prefix
indico/web/forms/validators.py:354:36: RUF027 Possible f-string without an `f` prefix
indico/web/forms/validators.py:356:29: RUF027 Possible f-string without an `f` prefix
Found 7 errors.
No fixes available (7 hidden fixes can be enabled with the `--unsafe-fixes` option).
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-06 00:31</div>
            <div class="timeline-body"><p>I think we should also ignore <code>ngettext</code> calls as you mention, but this would've prevented those false positives üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-02-06 00:36</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>encountered linter errors</strong>. (no lint changes; 1 project error)</p>
<details><summary><a href="https://github.com/sphinx-doc/sphinx">sphinx-doc/sphinx</a> (error)</summary>
<p>

<pre><code>ruff failed
  Cause: Selection of unstable rules without the `--preview` flag is not allowed. Enable preview or remove selection of:
	- FURB113
	- FURB131
	- FURB132
</code></pre>
</p>
</details>

<h3>Linter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+0 -36 violations, +0 -0 fixes in 2 projects; 41 projects unchanged)</p>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+0 -2 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview</pre>
</p>
<p>

<pre>
- <a href='https://github.com/pandas-dev/pandas/blob/8baee5def5ab9a592c68f5f9b3ad0688ef329493/pandas/tests/indexes/base_class/test_formats.py#L138'>pandas/tests/indexes/base_class/test_formats.py:138:35:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/pandas-dev/pandas/blob/8baee5def5ab9a592c68f5f9b3ad0688ef329493/pandas/tests/indexes/base_class/test_formats.py#L141'>pandas/tests/indexes/base_class/test_formats.py:141:16:</a> RUF027 Possible f-string without an `f` prefix
</pre>

</p>
</details>
<details><summary><a href="https://github.com/zulip/zulip">zulip/zulip</a> (+0 -34 violations, +0 -0 fixes)</summary>
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/management/commands/edit_linkifiers.py#L14'>zerver/management/commands/edit_linkifiers.py:14:12:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/migrations/0423_fix_email_gateway_attachment_owner.py#L93'>zerver/migrations/0423_fix_email_gateway_attachment_owner.py:93:21:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/openapi/curl_param_value_generators.py#L281'>zerver/openapi/curl_param_value_generators.py:281:9:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/openapi/python_examples.py#L454'>zerver/openapi/python_examples.py:454:25:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/openapi/python_examples.py#L469'>zerver/openapi/python_examples.py:469:25:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_audit_log.py#L914'>zerver/tests/test_audit_log.py:914:26:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_audit_log.py#L974'>zerver/tests/test_audit_log.py:974:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_event_system.py#L762'>zerver/tests/test_event_system.py:762:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_events.py#L2747'>zerver/tests/test_events.py:2747:15:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_markdown.py#L2506'>zerver/tests/test_markdown.py:2506:24:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_markdown.py#L2604'>zerver/tests/test_markdown.py:2604:24:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_markdown.py#L2892'>zerver/tests/test_markdown.py:2892:24:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_markdown.py#L2962'>zerver/tests/test_markdown.py:2962:24:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_message_dict.py#L246'>zerver/tests/test_message_dict.py:246:24:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L101'>zerver/tests/test_realm_linkifiers.py:101:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L134'>zerver/tests/test_realm_linkifiers.py:134:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L164'>zerver/tests/test_realm_linkifiers.py:164:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L180'>zerver/tests/test_realm_linkifiers.py:180:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L186'>zerver/tests/test_realm_linkifiers.py:186:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L203'>zerver/tests/test_realm_linkifiers.py:203:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L216'>zerver/tests/test_realm_linkifiers.py:216:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L24'>zerver/tests/test_realm_linkifiers.py:24:29:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L319'>zerver/tests/test_realm_linkifiers.py:319:33:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L323'>zerver/tests/test_realm_linkifiers.py:323:33:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L327'>zerver/tests/test_realm_linkifiers.py:327:33:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L37'>zerver/tests/test_realm_linkifiers.py:37:48:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L63'>zerver/tests/test_realm_linkifiers.py:63:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L69'>zerver/tests/test_realm_linkifiers.py:69:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L75'>zerver/tests/test_realm_linkifiers.py:75:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L82'>zerver/tests/test_realm_linkifiers.py:82:13:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L89'>zerver/tests/test_realm_linkifiers.py:89:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zerver/tests/test_realm_linkifiers.py#L95'>zerver/tests/test_realm_linkifiers.py:95:32:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zilencer/management/commands/populate_db.py#L832'>zilencer/management/commands/populate_db.py:832:17:</a> RUF027 Possible f-string without an `f` prefix
- <a href='https://github.com/zulip/zulip/blob/49e3e6da062c6d9d9f336935493d3c3131066893/zilencer/management/commands/populate_db.py#L838'>zilencer/management/commands/populate_db.py:838:17:</a> RUF027 Possible f-string without an `f` prefix
</pre>

</p>
</details>
<details><summary>Changes by rule (1 rules affected)</summary>
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| RUF027 | 36 | 0 | 36 | 0 | 0 |</p>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-06 00:38</div>
            <div class="timeline-body"><p>Ecosystem checks look like improvements to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowsignal">@snowsignal</a> approved on 2024-02-06 04:23</div>
            <div class="timeline-body"><p>Looks good to me! I'm really happy to see fewer false positives in the ecosystem check.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-02-06 04:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-06 04:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-02-06 04:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:58:15 UTC
    </footer>
</body>
</html>
