<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Switch from dependabot to renovate - astral-sh/ruff #10567</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Switch from dependabot to renovate</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10567">#10567</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-03-25 12:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>This PR sets up a renovate config for updating our dependencies, and removes our dependabot config. Advantages of renovate over dependabot are:</p>
<ul>
<li>It will also update pre-commit dependencies for us</li>
<li>It&#x27;s highly configurable</li>
</ul>
<p>Disadvantages are:</p>
<ul>
<li>It&#x27;s highly configurable (so it&#x27;s more difficult to wade through the docs to figure out exactly what configuration you want)</li>
</ul>
<p>Note that this PR is necessary but not sufficient for enabling renovate on this repository, if we decide that this is the way we want to go. <a href="https://docs.renovatebot.com/getting-started/installing-onboarding/#hosted-githubcom-app">Renovate&#x27;s Github.com app</a> would also need to be enabled for this repository.</p>
Configuration details
<p>I&#x27;ve used renovate before in https://github.com/AlexWaygood/typeshed-stats and https://github.com/python/typeshed, so I&#x27;m pretty confident that this configuration file is basically correct. I&#x27;ve used a <code>.json5</code> file rather than a <code>.json</code> file so that we can have comments in the file. (<code>json5</code> is a <a href="https://docs.renovatebot.com/configuration-options/">supported file format</a> for renovate configuration.) Some notes on the specific configuration options I&#x27;ve chosen:</p>
<ul>
<li>Currently dependabot does not update our Python dependencies in <code>python/</code> and <code>scripts/</code>, nor our npm dependencies in <code>playground/</code>. I&#x27;ve added those in this PR (renovate will look for PEP-621 dependencies only in the <code>python/</code> and <code>scripts/</code> dependencies, and will look for npm dependencies only in the <code>playground/</code> directory), but I&#x27;m happy to take them out again if that&#x27;s something we&#x27;re not interested in.</li>
<li>All update PRs will come on Monday mornings, same as with our current dependabot setup</li>
<li>GitHub Actions updates will all be grouped into a single PR, same as our current dependabot setup. I&#x27;ve also grouped all our pre-commit dependencies into a single weekly PR, but haven&#x27;t grouped any other dependencies together. I could do others as well, if we want them bunched up a bit more.</li>
<li>The pre-commit manager dependency manager needs to be explicitly opted into because the pre-commit maintainers prefer you to use the pre-commit.ci bot to autoupdate your dependencies: <a href="https://github.com/renovatebot/renovate/issues/11166">renovatebot/renovate#11166</a>#issuecomment-896236031. I don&#x27;t think that&#x27;s something we particularly need to worry about, however.</li>
</ul>
Test Plan
<p>If the Renovate bot is enabled, it will validate this configuration file and open an issue for us if there are any errors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 12:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 12:35</div>
            <div class="timeline-body"><p>(This PR is a competing PR to <a href="https://github.com/astral-sh/ruff/pull/8411">astral-sh/ruff#8411</a> -- we should either do that PR or this one, but not both.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ci</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-25 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-03-25 14:00</div>
            <div class="timeline-body"><p>Looks good to me. Is there a way to test this or do we have to wait for next Monday?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 14:03</div>
            <div class="timeline-body"><blockquote>
<p>Is there a way to test this or do we have to wait for next Monday?</p>
</blockquote>
<p>If we merge this PR and enable the renovate bot, the bot will immediately do one of two things:</p>
<ul>
<li>Open an issue telling us there&#x27;s an error in our configuration. The issue would look like this: <a href="https://github.com/python/typeshed/issues/11586">python/typeshed#11586</a></li>
<li>Or, if there are no errors in our configuration, it will open a &quot;dependency dashboard&quot; issue that we will be able to use for tracking our scheduled dependency updates. (We can opt out of this, but I personally find it quite useful.) We can use the dependency-dashboard issue to manually trigger an update PR before Monday to try things out. The issue would look like this: <a href="https://github.com/python/typeshed/issues/11588">python/typeshed#11588</a></li>
</ul>
<p>So we should get pretty quick feedback on any issues here if this is merged!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-25 14:11</div>
            <div class="timeline-body"><p>Sounds good. Thanks. Let&#x27;s give @zanieb some time to take a look at this PR. They set up the dependantbot configuration initially.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-03-25 14:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>.github/renovate.json5</code>:33 on 2024-03-25 14:13</div>
            <div class="timeline-body"><p>Can we still doing things like <code>@&lt;bot&gt; ignore this version</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-03-25 14:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 14:13</div>
            <div class="timeline-body"><p>Can we only match the upload/download artifact group? e.g.</p>
<p>https://github.com/astral-sh/uv/blob/main/.github/dependabot.yml#L9-L12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 14:14</div>
            <div class="timeline-body"><p>Yes! Sorry, I missed that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-03-25 14:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-03-25 14:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>.github/renovate.json5</code>:1 on 2024-03-25 14:15</div>
            <div class="timeline-body"><p>Do they not support YAML?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-03-25 14:16</div>
            <div class="timeline-body"><p>Thanks for doing this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-03-25 14:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:1 on 2024-03-25 14:27</div>
            <div class="timeline-body"><p>No -- we have the choice of JSON, JSON5, or <code>.renovaterc</code>: https://docs.renovatebot.com/configuration-options/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-03-25 14:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>.github/renovate.json5</code>:1 on 2024-03-25 14:30</div>
            <div class="timeline-body"><p>Bleh okay :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-03-25 14:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 14:30</div>
            <div class="timeline-body"><p>It&#x27;s different over here — good opportunity to fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-03-25 14:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:33 on 2024-03-25 14:54</div>
            <div class="timeline-body"><p>I don&#x27;t think you can <code>@</code> renovate in the same way you can with dependabot. It&#x27;s possible to add config to this file specifying that it should permanently ignore certain versions (or version ranges), however. Additionally, if you close a renovate PR, it will generally assume that you don&#x27;t want to see any future PRs updating the dependency to that version. Docs here: https://docs.renovatebot.com/key-concepts/pull-requests/#normal-prs</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 14:56</div>
            <div class="timeline-body"><p>I installed the <code>renovate</code> CLI tool (via npm) to validate this config, and it passed:</p>
<pre><code>(setup-renovate)⚡ % npx --yes --package renovate -- renovate-config-validator               ~/dev/ruff
(node:98623) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
 INFO: Validating .github/renovate.json5
 INFO: Config validated successfully
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-03-25 16:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 16:23</div>
            <div class="timeline-body"><p>Oh, so right now:</p>
<ul>
<li>Ruff:<ul>
<li>doesn&#x27;t do any updates for <code>actions/upload-artifact</code> and <code>actions/download-artifact</code>: https://github.com/astral-sh/ruff/blob/f7aab5ac69f9505a1776a4bcf20ea2415aa5e442/.github/dependabot.yml#L12-L15</li>
<li>all other GitHub Actions updates are bundled into a single weekly PR: https://github.com/astral-sh/ruff/blob/f7aab5ac69f9505a1776a4bcf20ea2415aa5e442/.github/dependabot.yml#L8-L11</li>
</ul>
</li>
<li>uv:<ul>
<li>bundles <code>actions/upload-artifact</code> and <code>actions/artifact</code> updates into a single weekly PR: https://github.com/astral-sh/uv/blob/7a5571fa5c4fa72a26b0754f3273f1d75f3fa7d2/.github/dependabot.yml#L9-L12</li>
<li>all other GitHub Actions updates are done in individual PRs on a weekly basis</li>
</ul>
</li>
</ul>
<p>What do we want the new behaviour for Ruff to be?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-03-25 16:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 16:33</div>
            <div class="timeline-body"><p>I forgot to remove the actions from the dependabot configuration after doing the major version upgrade. I think upgrading them together (when both versions are bumped) does make sense, which is what UV does</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-03-25 16:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 16:44</div>
            <div class="timeline-body"><p>Do we want:</p>
<ol>
<li>All actions updates bundled together in one weekly PR?</li>
<li>The upload/download actions bundled into one weekly PR, but an individual weekly PR each for all other actions updates?</li>
<li>The upload/download actions bundled into one weekly PR, and all other actions updates bundled into a second weekly PR?</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-03-25 16:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>.github/renovate.json5</code>:38 on 2024-03-25 16:47</div>
            <div class="timeline-body"><ol>
<li></li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 17:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 17:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-03-25 17:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:02:31 UTC
    </footer>
</body>
</html>
