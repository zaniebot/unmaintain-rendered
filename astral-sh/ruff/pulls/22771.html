<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Support `Unpack[TypedDict]` for precise **kwargs typing (PEP 692) - astral-sh/ruff #22771</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Support <code>Unpack[TypedDict]</code> for precise **kwargs typing (PEP 692)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/pull/22771">#22771</a>
        opened by <a href="https://github.com/bxff">@bxff</a>
        on 2026-01-20 17:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bxff">@bxff</a></div>
            <div class="timeline-body">Summary
<p>Closes <a href="https://github.com/astral-sh/ty/issues/1746">astral-sh/ty#1746</a> Partially addresses <a href="https://github.com/astral-sh/ty/issues/154">astral-sh/ty#154</a> (&quot;Support for <code>Unpack</code>&quot; checkbox)</p>
<p>This PR implements PEP 692 support for using <code>Unpack[TypedDict]</code> to provide more precise type annotations for <code>**kwargs</code> parameters. Previously, <code>**kwargs: str</code> meant all keyword arguments are strings. With this change, you can specify exactly which keyword arguments are expected:</p>
<pre><code>class Movie(TypedDict):
    name: str
    year: int

def foo(**kwargs: Unpack[Movie]) -&gt; None:
    reveal_type(kwargs)  # revealed: Movie
</code></pre>
<p>Implementation details:</p>
<ul>
<li>Add <code>KnownInstanceType::UnpackedTypedDict(TypedDictType)</code> variant</li>
<li>Parse <code>Unpack[TypedDict]</code> in type expressions, emit errors for invalid usage</li>
<li>Type <code>kwargs</code> as the TypedDict itself inside function bodies</li>
<li>Validate keyword arguments against TypedDict fields at call sites</li>
<li>Report <code>unknown-argument</code> for kwargs not in the TypedDict</li>
<li>Report <code>missing-argument</code> for required TypedDict fields not provided</li>
<li>Check argument types against specific TypedDict field types</li>
<li>Handle <code>**typed_dict_var</code> passthrough with field-by-field type checking</li>
</ul>
<p>Not yet implemented (out of scope, separate PEP 646 features):</p>
<ul>
<li><code>Unpack[TypeVarTuple]</code> - returns <code>todo_type!</code></li>
<li><code>Unpack[tuple[...]]</code> - returns <code>todo_type!</code></li>
</ul>
Test Plan
<p>New mdtest file <code>annotations/unpack_kwargs.md</code> with comprehensive coverage:</p>
<ul>
<li>Basic usage and <code>reveal_type</code> verification</li>
<li>Required/NotRequired field handling</li>
<li>Invalid Unpack usage errors (int, regular TypeVar)</li>
<li>Call binding: valid calls, unknown kwargs, missing required fields</li>
<li>Type checking for individual field types</li>
<li>Passing compatible/incompatible TypedDict via <code>**</code></li>
<li>Passing TypedDict with extra fields via <code>**</code></li>
</ul>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/carljm">@carljm</a> by <a href="https://github.com/bxff">@bxff</a> on 2026-01-20 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/bxff">@bxff</a> on 2026-01-20 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/sharkdp">@sharkdp</a> by <a href="https://github.com/bxff">@bxff</a> on 2026-01-20 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/bxff">@bxff</a> on 2026-01-20 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-20 18:00</div>
            <div class="timeline-body">

<a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/">Typing conformance results</a> improved üéâ
<p>The percentage of diagnostics emitted that were expected errors increased from 77.42% to 77.63%. The percentage of expected errors that received a diagnostic increased from 60.49% to 61.21%.</p>
Summary
<p>| Metric | Old | New | Diff | Outcome |
|--------|-----|-----|------|---------|
| True Positives  | 672 | 680 | +8 | ‚è´ (‚úÖ) |
| False Positives | 196 | 196 | +0 |  |
| False Negatives | 439 | 431 | -8 | ‚è¨ (‚úÖ) |
| Total Diagnostics | 868 | 876 | +8 | ‚è´ |
| Precision | 77.42% | 77.63% | +0.21% | ‚è´ (‚úÖ) |
| Recall | 60.49% | 61.21% | +0.72% | ‚è´ (‚úÖ) |</p>
True positives added


<p>| Location | Name | Message |
|----------|------|---------|
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L101">callables_kwargs.py:101:19</a> | invalid-assignment | Object of type <code>def func1(**kwargs: Unpack[TD2]) -&gt; None</code> is not assignable to <code>TDProtocol3</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L102">callables_kwargs.py:102:19</a> | invalid-assignment | Object of type <code>def func1(**kwargs: Unpack[TD2]) -&gt; None</code> is not assignable to <code>TDProtocol4</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L122">callables_kwargs.py:122:21</a> | invalid-type-form | <code>Unpack</code> must be used with a TypedDict, TypeVarTuple, or tuple type, got <code>T@func6</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L46">callables_kwargs.py:46:5</a> | missing-argument | Missing required keyword arguments <code>v1</code>, <code>v3</code> for function <code>func1</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L51">callables_kwargs.py:51:32</a> | unknown-argument | Argument <code>v4</code> does not match any known parameter of function <code>func1</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L58">callables_kwargs.py:58:5</a> | missing-argument | Missing required keyword arguments <code>v1</code>, <code>v3</code> for function <code>func1</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/typeddicts_extra_items.py#L143">typeddicts_extra_items.py:143:48</a> | unknown-argument | Argument <code>year</code> does not match any known parameter of function <code>unpack_no_extra</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/typeddicts_readonly_kwargs.py#L33">typeddicts_readonly_kwargs.py:33:12</a> | invalid-assignment | Cannot assign to key &quot;key1&quot; on TypedDict <code>ReadOnlyArgs</code>: key is marked read-only |</p>


False positives removed


<p>| Location | Name | Message |
|----------|------|---------|
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L24">callables_kwargs.py:24:5</a> | type-assertion-failure | Type <code>int</code> does not match asserted type <code>@Todo(</code>Unpack[]<code> special form)</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L32">callables_kwargs.py:32:9</a> | type-assertion-failure | Type <code>str</code> does not match asserted type <code>@Todo(</code>Unpack[]<code> special form)</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L35">callables_kwargs.py:35:5</a> | type-assertion-failure | Type <code>str</code> does not match asserted type <code>@Todo(</code>Unpack[]<code> special form)</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L41">callables_kwargs.py:41:5</a> | type-assertion-failure | Type <code>TD1</code> does not match asserted type <code>dict[str, @Todo(</code>Unpack[]<code> special form)]</code> |</p>


False positives added


<p>| Location | Name | Message |
|----------|------|---------|
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L100">callables_kwargs.py:100:19</a> | invalid-assignment | Object of type <code>def func1(**kwargs: Unpack[TD2]) -&gt; None</code> is not assignable to <code>TDProtocol2</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L99">callables_kwargs.py:99:19</a> | invalid-assignment | Object of type <code>def func1(**kwargs: Unpack[TD2]) -&gt; None</code> is not assignable to <code>TDProtocol1</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/typeddicts_extra_items.py#L144">typeddicts_extra_items.py:144:45</a> | unknown-argument | Argument <code>year</code> does not match any known parameter of function <code>unpack_extra</code> |
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/typeddicts_readonly_kwargs.py#L36">typeddicts_readonly_kwargs.py:36:16</a> | invalid-assignment | Object of type <code>def impl(**kwargs: Unpack[ReadOnlyArgs]) -&gt; None</code> is not assignable to <code>Function</code> |</p>


Optional Diagnostics Added


<p>| Location | Name | Message |
|----------|------|---------|
| <a href="https://github.com/python/typing/blob/dece44f2922ca390fe314145d09939514a21e76e/conformance/tests/callables_kwargs.py#L61">callables_kwargs.py:61:5</a> | missing-argument | Missing required keyword arguments <code>v1</code>, <code>v3</code> for function <code>func1</code> |</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-20 18:13</div>
            <div class="timeline-body"><p>Hey @bxff -- really appreciate the PRs you&#x27;ve been sending recently! I love how quickly you&#x27;re knocking down issues, but we still have a bit of a PR backlog from the beta release and the Christmas break. Would you mind holding off on opening any more until we&#x27;ve had a chance to finish reviewing the ones you&#x27;ve already opened? It&#x27;ll probably make it a better experience for you, because your PRs are less likely to sit unreviewed for extended periods of time (which can lead to annoying merge conflicts for you) :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ty</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-20 18:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-20 18:19</div>
            <div class="timeline-body">

<code>mypy_primer</code> results

Changes were detected when running on open source projects

<pre><code>pyinstrument (https://github.com/joerick/pyinstrument)
- pyinstrument/context_manager.py:40:34: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `int | float`, found `Unknown | None`
+ pyinstrument/context_manager.py:40:34: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `int | float`, found `Unknown | int | float | str | None`
- pyinstrument/context_manager.py:40:34: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Literal[&quot;enabled&quot;, &quot;disabled&quot;, &quot;strict&quot;]`, found `Unknown | None`
+ pyinstrument/context_manager.py:40:34: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Literal[&quot;enabled&quot;, &quot;disabled&quot;, &quot;strict&quot;]`, found `Unknown | int | float | str | None`
- pyinstrument/context_manager.py:41:9: error[invalid-assignment] Object of type `dict[str, @Todo]` is not assignable to attribute `options` of type `ProfileContextOptions`
+ pyinstrument/context_manager.py:40:34: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `bool | None`, found `Unknown | int | float | str | None`

aiohttp-devtools (https://github.com/aio-libs/aiohttp-devtools)
+ aiohttp_devtools/runserver/watch.py:120:55: error[invalid-argument-type] Argument to bound method `get` is incorrect: Expected `SSLContext | bool | Fingerprint`, found `None | SSLContext`
+ aiohttp_devtools/runserver/watch.py:155:57: error[invalid-argument-type] Argument to bound method `get` is incorrect: Expected `SSLContext | bool | Fingerprint`, found `None | SSLContext`
- Found 35 diagnostics
+ Found 37 diagnostics

pydantic (https://github.com/pydantic/pydantic)
- pydantic/fields.py:238:95: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:277:57: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ pydantic/fields.py:668:16: error[no-matching-overload] No overload of function `Field` matches arguments
- pydantic/fields.py:949:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:949:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:989:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:989:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:1032:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:1032:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:1072:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:1072:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:1115:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:1115:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:1154:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:1154:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:1194:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`
+ pydantic/fields.py:1194:5: error[invalid-parameter-default] Default value of type `PydanticUndefinedType` is not assignable to annotated parameter type `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`
- pydantic/fields.py:1286:39: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1290:47: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1300:47: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ pydantic/fields.py:1573:13: error[invalid-argument-type] Argument is incorrect: Expected `dict[str, Divergent] | ((dict[str, Divergent], /) -&gt; None) | None`, found `Top[dict[Unknown, Unknown]] | (((dict[str, Divergent], /) -&gt; None) &amp; ~Top[dict[Unknown, Unknown]]) | None`
- pydantic/fields.py:1310:53: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1320:57: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1330:39: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1343:40: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1358:43: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- pydantic/fields.py:1573:13: error[invalid-argument-type] Argument is incorrect: Expected `dict[str, int | float | str | ... omitted 3 union elements] | ((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) | None`, found `Top[dict[Unknown, Unknown]] | (((dict[str, int | float | str | ... omitted 3 union elements], /) -&gt; None) &amp; ~Top[dict[Unknown, Unknown]]) | None`
- Found 3155 diagnostics
+ Found 3146 diagnostics

discord.py (https://github.com/Rapptz/discord.py)
- discord/ext/commands/bot.py:307:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- discord/ext/commands/bot.py:331:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ discord/ext/commands/core.py:602:38: error[invalid-argument-type] Argument to bound method `__init__` is incorrect: Expected `Unpack[_CommandKwargs]`, found `list[str] | tuple[str, ...] | str | ... omitted 6 union elements`
- discord/ext/commands/core.py:1551:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- discord/ext/commands/core.py:1608:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ discord/ext/commands/core.py:1859:12: error[no-matching-overload] No overload of function `command` matches arguments
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `arguments_heading` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `commands_heading` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `default_argument_description` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `dm_help` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `dm_help_threshold` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `indent` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `no_category` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `paginator` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `show_parameter_descriptions` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `sort_commands` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1087:26: error[unknown-argument] Argument `width` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `aliases_heading` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `commands_heading` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `dm_help` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `dm_help_threshold` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `no_category` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `paginator` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/help.py:1378:26: error[unknown-argument] Argument `sort_commands` does not match any known parameter of bound method `__init__`
+ discord/ext/commands/hybrid.py:836:9: error[invalid-method-override] Invalid override of method `command`: Definition is incompatible with `GroupMixin.command`
- discord/ext/commands/hybrid.py:853:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ discord/ext/commands/hybrid.py:860:9: error[invalid-method-override] Invalid override of method `group`: Definition is incompatible with `GroupMixin.group`
- discord/ext/commands/hybrid.py:877:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- discord/ext/commands/hybrid.py:932:92: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- discord/ext/commands/hybrid.py:965:90: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- discord/permissions.py:215:48: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- discord/permissions.py:483:46: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ discord/shard.py:379:50: error[unknown-argument] Argument `shard_connect_timeout` does not match any known parameter of bound method `__init__`
+ discord/shard.py:379:50: error[unknown-argument] Argument `shard_ids` does not match any known parameter of bound method `__init__`
- Found 542 diagnostics
+ Found 556 diagnostics

trio (https://github.com/python-trio/trio)
- src/trio/_tests/test_subprocess.py:496:55: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- src/trio/_tests/type_tests/subprocesses.py:15:70: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- src/trio/_tests/type_tests/subprocesses.py:22:60: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- src/trio/_tests/type_tests/subprocesses.py:23:70: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
- Found 487 diagnostics
+ Found 483 diagnostics

scikit-build-core (https://github.com/scikit-build/scikit-build-core)
- src/scikit_build_core/build/wheel.py:99:20: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 47 diagnostics
+ Found 46 diagnostics

pycryptodome (https://github.com/Legrandin/pycryptodome)
+ lib/Crypto/Protocol/HPKE.py:181:39: error[invalid-argument-type] Argument to function `key_agreement` is incorrect: Expected `Unpack[RequestParams[Unknown]]`, found `Unknown | (EccKey &amp; ~AlwaysFalsy)`
+ lib/Crypto/Protocol/HPKE.py:221:39: error[invalid-argument-type] Argument to function `key_agreement` is incorrect: Expected `Unpack[RequestParams[Unknown]]`, found `Unknown | (EccKey &amp; ~AlwaysFalsy)`
- Found 1326 diagnostics
+ Found 1328 diagnostics

prefect (https://github.com/PrefectHQ/prefect)
- src/integrations/prefect-dbt/tests/cli/configs/test_snowflake.py:100:9: error[unknown-argument] Argument `schema` does not match any known parameter
+ src/integrations/prefect-gitlab/prefect_gitlab/repositories.py:89:32: error[no-matching-overload] No overload of function `Field` matches arguments
- src/prefect/deployments/runner.py:795:70: warning[possibly-missing-attribute] Attribute `__name__` may be missing on object of type `Unknown | (((...) -&gt; Any) &amp; ((*args: object, **kwargs: object) -&gt; object))`
+ src/prefect/deployments/runner.py:795:70: warning[possibly-missing-attribute] Attribute `__name__` may be missing on object of type `Unknown | ((...) -&gt; Any)`
+ src/prefect/flow_engine.py:812:32: error[invalid-await] `Unknown | R@FlowRunEngine | Coroutine[Any, Any, R@FlowRunEngine]` is not awaitable
+ src/prefect/flow_engine.py:1401:24: error[invalid-await] `Unknown | R@AsyncFlowRunEngine | Coroutine[Any, Any, R@AsyncFlowRunEngine]` is not awaitable
+ src/prefect/flow_engine.py:1482:43: error[invalid-argument-type] Argument to function `next` is incorrect: Expected `SupportsNext[Unknown]`, found `Unknown | R@run_generator_flow_sync`
+ src/prefect/flow_engine.py:1490:21: warning[possibly-missing-attribute] Attribute `throw` may be missing on object of type `Unknown | R@run_generator_flow_sync`
+ src/prefect/flow_engine.py:1524:44: warning[possibly-missing-attribute] Attribute `__anext__` may be missing on object of type `Unknown | R@run_generator_flow_async`
+ src/prefect/flow_engine.py:1531:25: warning[possibly-missing-attribute] Attribute `throw` may be missing on object of type `Unknown | R@run_generator_flow_async`
- src/prefect/flows.py:286:34: error[unresolved-attribute] Object of type `((**P@Flow) -&gt; R@Flow) &amp; ((*args: object, **kwargs: object) -&gt; object)` has no attribute `__name__`
+ src/prefect/flows.py:286:34: error[unresolved-attribute] Object of type `(**P@Flow) -&gt; R@Flow` has no attribute `__name__`
- src/prefect/flows.py:404:68: error[unresolved-attribute] Object of type `((**P@Flow) -&gt; R@Flow) &amp; ((*args: object, **kwargs: object) -&gt; object)` has no attribute `__name__`
+ src/prefect/flows.py:404:68: error[unresolved-attribute] Object of type `(**P@Flow) -&gt; R@Flow` has no attribute `__name__`
- src/prefect/flows.py:1750:53: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ src/prefect/tasks.py:2188:9: error[invalid-method-override] Invalid override of method `with_options`: Definition is incompatible with `Task.with_options`
- Found 5406 diagnostics
+ Found 5412 diagnostics

altair (https://github.com/vega/altair)
- altair/datasets/_constraints.py:57:24: error[invalid-return-type] Return type does not match returned value: expected `Metadata`, found `dict[str, @Todo]`
- altair/datasets/_constraints.py:111:33: error[invalid-argument-type] Argument to bound method `from_metadata` is incorrect: Expected `Metadata`, found `dict[str, @Todo]`
- altair/utils/core.py:676:18: warning[possibly-missing-attribute] Attribute `schema` may be missing on object of type `NativeDataFrame | DataFrameLike | Unknown | None`
- altair/utils/core.py:678:22: error[not-subscriptable] Cannot subscript object of type `NativeDataFrame` with no `__getitem__` method
- altair/utils/core.py:678:22: error[not-subscriptable] Cannot subscript object of type `DataFrameLike` with no `__getitem__` method
- altair/utils/core.py:678:22: error[not-subscriptable] Cannot subscript object of type `None` with no `__getitem__` method
- altair/utils/core.py:682:39: warning[possibly-missing-attribute] Attribute `to_native` may be missing on object of type `NativeDataFrame | DataFrameLike | Unknown | None`
- altair/utils/data.py:208:28: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(NativeDataFrame &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (narwhals.stable.v1.typing.DataFrameLike &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (Unknown &amp; ~None &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (SupportsGeoInterface &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (altair.utils.core.DataFrameLike &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]])`
- altair/utils/data.py:209:39: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(NativeDataFrame &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (narwhals.stable.v1.typing.DataFrameLike &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (Unknown &amp; ~None &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (SupportsGeoInterface &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (altair.utils.core.DataFrameLike &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]])`
- altair/utils/data.py:415:12: warning[possibly-missing-attribute] Attribute `write_csv` may be missing on object of type `(NativeDataFrame &amp; ~SupportsGeoInterface &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (narwhals.stable.v1.typing.DataFrameLike &amp; ~SupportsGeoInterface &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (Unknown &amp; ~SupportsGeoInterface &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]]) | (altair.utils.core.DataFrameLike &amp; ~SupportsGeoInterface &amp; ~DataFrame &amp; ~Top[dict[Unknown, Unknown]])`
- altair/utils/schemapi.py:509:12: error[invalid-return-type] Return type does not match returned value: expected `list[Any]`, found `object`
- tests/test_transformed_data.py:97:16: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(Any &amp; ~None) | DataFrameLike`
- tests/test_transformed_data.py:98:35: warning[possibly-missing-attribute] Attribute `columns` may be missing on object of type `(Any &amp; ~None) | DataFrameLike`
- Found 1055 diagnostics
+ Found 1042 diagnostics

hydpy (https://github.com/hydpy-dev/hydpy)
+ hydpy/models/rconc/rconc_control.py:250:23: error[no-matching-overload] No overload of bound method `__init__` matches arguments
- Found 669 diagnostics
+ Found 670 diagnostics

static-frame (https://github.com/static-frame/static-frame)
- static_frame/core/index.py:580:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[TVContainer_co@loc, TVDtype@Index]`, found `InterGetItemLocReduces[Any | Bottom[Series[Any, Any]], TVDtype@Index]`
+ static_frame/core/index.py:580:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[TVContainer_co@loc, TVDtype@Index]`, found `InterGetItemLocReduces[Bottom[Series[Any, Any]] | Any, TVDtype@Index]`
- static_frame/core/node_selector.py:526:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[TVContainer_co@InterfaceSelectQuartet, Any]`, found `InterGetItemLocReduces[Unknown | Bottom[Series[Any, Any]], Any]`
+ static_frame/core/node_selector.py:526:16: error[invalid-return-type] Return type does not match returned value: expected `InterGetItemLocReduces[TVContainer_co@InterfaceSelectQuartet, Any]`, found `InterGetItemLocReduces[Bottom[Series[Any, Any]] | Unknown, Any]`

pywin32 (https://github.com/mhammond/pywin32)
+ com/win32comext/shell/demos/servers/folder_view.py:863:9: error[invalid-argument-type] Argument to function `UseCommandLine` is incorrect: Expected `bool`, found `Literal[0]`
+ com/win32comext/shell/demos/servers/shell_view.py:968:9: error[invalid-argument-type] Argument to function `UseCommandLine` is incorrect: Expected `bool`, found `Literal[0]`
- Found 2694 diagnostics
+ Found 2696 diagnostics

pandas (https://github.com/pandas-dev/pandas)
- pandas/io/parsers/readers.py:1574:41: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `(@Todo &amp; ~Literal[False] &amp; ~_NoDefault) | None`
+ pandas/io/parsers/readers.py:1574:41: error[invalid-argument-type] Argument to function `len` is incorrect: Expected `Sized`, found `Hashable &amp; ~Literal[False] &amp; ~_NoDefault`

pandas-stubs (https://github.com/pandas-dev/pandas-stubs)
+ tests/frame/test_groupby.py:229:15: error[type-assertion-failure] Type `Series[Any]` does not match asserted type `Series[str | bytes | int | ... omitted 12 union elements]`
+ tests/frame/test_groupby.py:625:15: error[type-assertion-failure] Type `Series[Any]` does not match asserted type `Series[str | bytes | int | ... omitted 12 union elements]`
- Found 4454 diagnostics
+ Found 4456 diagnostics

rotki (https://github.com/rotki/rotki)
+ rotkehlchen/db/dbhandler.py:884:65: error[no-matching-overload] No overload of bound method `get_db_key` matches arguments
+ rotkehlchen/db/dbhandler.py:897:59: error[no-matching-overload] No overload of bound method `get_db_key` matches arguments
+ rotkehlchen/db/dbhandler.py:1052:14: error[no-matching-overload] No overload of bound method `get_db_key` matches arguments
+ rotkehlchen/tasks/events.py:507:42: warning[unused-ignore-comment] Unused blanket `type: ignore` directive
+ rotkehlchen/tasks/events.py:510:13: error[invalid-argument-type] Argument to bound method `set_dynamic_cache` is incorrect: Expected `int`, found `Unknown | int | None`
+ rotkehlchen/tasks/events.py:511:13: error[invalid-argument-type] Argument to bound method `set_dynamic_cache` is incorrect: Expected `int`, found `Unknown | int | None`
+ rotkehlchen/tests/db/test_db.py:396:20: error[no-matching-overload] No overload of bound method `get_dynamic_cache` matches arguments
+ rotkehlchen/tests/db/test_db.py:436:20: error[no-matching-overload] No overload of bound method `get_dynamic_cache` matches arguments
- Found 2057 diagnostics
+ Found 2065 diagnostics

core (https://github.com/home-assistant/core)
+ homeassistant/util/variance.py:47:12: error[invalid-return-type] Return type does not match returned value: expected `(**_P@ignore_variance) -&gt; _R@ignore_variance`, found `_Wrapped[_P@ignore_variance, _R@ignore_variance | int | float | datetime, _P@ignore_variance, _R@ignore_variance | int | float | datetime]`
- Found 14491 diagnostics
+ Found 14492 diagnostics


</code></pre>



Memory usage changes were detected when running on open source projects

<pre><code>flake8 (https://github.com/pycqa/flake8)
-     struct fields = ~3MB
+     struct fields = ~4MB
-     memo fields = ~49MB
+     memo fields = ~52MB

trio (https://github.com/python-trio/trio)
-     memo fields = ~108MB
+     memo fields = ~113MB

sphinx (https://github.com/sphinx-doc/sphinx)
-     struct fields = ~20MB
+     struct fields = ~22MB
-     memo fields = ~176MB
+     memo fields = ~185MB

prefect (https://github.com/PrefectHQ/prefect)
- TOTAL MEMORY USAGE: ~690MB
+ TOTAL MEMORY USAGE: ~725MB
-     struct fields = ~54MB
+     struct fields = ~60MB
-     memo fields = ~424MB
+     memo fields = ~445MB


</code></pre>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ecosystem-analyzer</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-20 18:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astral-sh-bot[bot]">@astral-sh-bot[bot]</a> on 2026-01-20 18:51</div>
            <div class="timeline-body">

<code>ecosystem-analyzer</code> results
<p>| Lint rule | Added | Removed | Changed |
|-----------|------:|--------:|--------:|
| <code>unused-ignore-comment</code> | 1 | 24 | 0 |
| <code>unknown-argument</code> | 20 | 1 | 0 |
| <code>invalid-argument-type</code> | 10 | 4 | 6 |
| <code>invalid-return-type</code> | 0 | 6 | 7 |
| <code>no-matching-overload</code> | 8 | 0 | 0 |
| <code>invalid-assignment</code> | 0 | 1 | 5 |
| <code>possibly-missing-attribute</code> | 0 | 4 | 0 |
| <code>invalid-method-override</code> | 3 | 0 | 0 |
| <code>not-subscriptable</code> | 0 | 3 | 0 |
| <strong>Total</strong> | <strong>42</strong> | <strong>43</strong> | <strong>18</strong> |</p>
<p><strong><a href="https://9731fb71.ty-ecosystem-ext.pages.dev/diff">Full report with detailed diff</a></strong> (<a href="https://9731fb71.ty-ecosystem-ext.pages.dev/timing">timing results</a>)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 20:46:10 UTC
    </footer>
</body>
</html>
