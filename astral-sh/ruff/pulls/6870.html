<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use ruff line-length in format_dev - astral-sh/ruff #6870</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use ruff line-length in format_dev</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/6870">#6870</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2023-08-25 11:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p><strong>Summary</strong> Use the <code>[ruff]</code> config line length setting in format_dev. This aligns it with <code>ruff format</code> (originally, this was the prototype for <code>ruff format</code>, but now <code>ruff format</code> works and we instead need to keep <code>format_dev</code> consistent).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-25 11:59</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #6870</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6870"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite"></a>  ðŸ‘ˆ</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6870?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-08-25 12:40</div>
            <div class="timeline-body">PR Check Results
Benchmark
Linux
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      4.1Â±0.02ms    10.0 MB/sec    1.00      4.1Â±0.01ms    10.0 MB/sec
formatter/numpy/ctypeslib.py               1.00    854.0Â±2.40Âµs    19.5 MB/sec    1.00    854.3Â±2.49Âµs    19.5 MB/sec
formatter/numpy/globals.py                 1.00     84.1Â±0.34Âµs    35.1 MB/sec    1.01     84.5Â±0.37Âµs    34.9 MB/sec
formatter/pydantic/types.py                1.01   1684.9Â±8.49Âµs    15.1 MB/sec    1.00   1671.8Â±7.57Âµs    15.3 MB/sec
linter/all-rules/large/dataset.py          1.00     10.0Â±0.04ms     4.1 MB/sec    1.01     10.1Â±0.06ms     4.0 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      2.7Â±0.00ms     6.2 MB/sec    1.00      2.7Â±0.01ms     6.2 MB/sec
linter/all-rules/numpy/globals.py          1.00    377.7Â±0.54Âµs     7.8 MB/sec    1.00    376.5Â±0.52Âµs     7.8 MB/sec
linter/all-rules/pydantic/types.py         1.00      5.2Â±0.03ms     4.9 MB/sec    1.00      5.2Â±0.04ms     4.9 MB/sec
linter/default-rules/large/dataset.py      1.01      5.3Â±0.01ms     7.6 MB/sec    1.00      5.3Â±0.01ms     7.7 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1178.6Â±17.92Âµs    14.1 MB/sec    1.00   1175.7Â±8.25Âµs    14.2 MB/sec
linter/default-rules/numpy/globals.py      1.01    139.5Â±4.90Âµs    21.1 MB/sec    1.00    137.7Â±1.86Âµs    21.4 MB/sec
linter/default-rules/pydantic/types.py     1.00      2.4Â±0.01ms    10.6 MB/sec    1.00      2.4Â±0.03ms    10.6 MB/sec
</code></pre>
Windows
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.00      5.5Â±0.17ms     7.4 MB/sec    1.04      5.7Â±0.20ms     7.1 MB/sec
formatter/numpy/ctypeslib.py               1.00  1120.0Â±47.17Âµs    14.9 MB/sec    1.04  1169.5Â±30.49Âµs    14.2 MB/sec
formatter/numpy/globals.py                 1.00   112.2Â±10.25Âµs    26.3 MB/sec    1.02    114.7Â±5.31Âµs    25.7 MB/sec
formatter/pydantic/types.py                1.00      2.3Â±0.12ms    11.2 MB/sec    1.03      2.4Â±0.07ms    10.8 MB/sec
linter/all-rules/large/dataset.py          1.03     15.3Â±0.48ms     2.7 MB/sec    1.00     14.9Â±0.39ms     2.7 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.01      4.1Â±0.11ms     4.0 MB/sec    1.00      4.1Â±0.09ms     4.1 MB/sec
linter/all-rules/numpy/globals.py          1.02   525.4Â±25.44Âµs     5.6 MB/sec    1.00   512.9Â±12.32Âµs     5.8 MB/sec
linter/all-rules/pydantic/types.py         1.01      7.8Â±0.22ms     3.3 MB/sec    1.00      7.7Â±0.16ms     3.3 MB/sec
linter/default-rules/large/dataset.py      1.04      8.5Â±0.52ms     4.8 MB/sec    1.00      8.2Â±0.11ms     5.0 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.00  1775.3Â±50.53Âµs     9.4 MB/sec    1.00  1783.1Â±45.47Âµs     9.3 MB/sec
linter/default-rules/numpy/globals.py      1.00   205.5Â±10.57Âµs    14.4 MB/sec    1.02    210.0Â±5.39Âµs    14.1 MB/sec
linter/default-rules/pydantic/types.py     1.00      3.7Â±0.10ms     6.9 MB/sec    1.01      3.7Â±0.07ms     6.9 MB/sec
</code></pre>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-08-25 13:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_dev/src/format_dev.rs</code>:545 on 2023-08-25 13:28</div>
            <div class="timeline-body"><p>#6873 fixes this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-08-25 13:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_python_formatter/src/lib.rs</code>:355 on 2023-08-25 13:31</div>
            <div class="timeline-body"><p>adapted the test for the new defaults</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-08-25 13:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_formatter/src/lib.rs</code>:131 on 2023-08-25 13:32</div>
            <div class="timeline-body"><p>i think it makes sense to use the correct default here already</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/konstin">@konstin</a> on 2023-08-25 13:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/konstin">@konstin</a> on 2023-08-25 13:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/ruff_dev/src/format_dev.rs</code>:553 on 2023-08-25 13:46</div>
            <div class="timeline-body"><p>Is this because you&#x27;re trying to see if it&#x27;s not the default? Why can&#x27;t we just use <code>settings.line_length</code>? Because it will be wrong for projects in the formatter CI that use Black but not Ruff?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-08-25 13:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-08-25 15:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_dev/src/format_dev.rs</code>:553 on 2023-08-25 15:02</div>
            <div class="timeline-body"><p>yes, this only exists to have a (dummy) usage for the line length without breaking the formatter ecosystem checks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/konstin">@konstin</a> on 2023-08-25 15:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-08-25 16:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_formatter/src/lib.rs</code>:131 on 2023-08-25 16:26</div>
            <div class="timeline-body"><p>I would prefer keeping 80, although it&#x27;s hard reasoning for it if it complicates the implementation.
The reason I prefer 80 is because <code>ruff_formatter</code> is language agnostic and 88 is a very python specific line width.</p>
<p>Most other languages prefer to default to 80.</p>
<p>What makes this change necessary? What I understand is that you use <code>LineLength</code> above (and not <code>LineWiddth</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-08-25 16:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_dev/src/format_dev.rs</code>:553 on 2023-08-25 16:28</div>
            <div class="timeline-body"><p>Should <code>Settings.line_length</code> be an <code>Option&lt;LineLength&gt;</code> if that&#x27;s something we want to distinguish?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for <a href="https://github.com/MichaReiser">@MichaReiser</a> removed by <a href="https://github.com/konstin">@konstin</a> on 2023-09-05 12:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/konstin">@konstin</a> on 2023-09-05 12:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-09-05 12:27</div>
            <div class="timeline-body"><p>Please give this another look, this now only changes what&#x27;s really needed for <code>format_dev</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2023-09-05 12:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/ruff_dev/src/format_dev.rs</code>:555 on 2023-09-05 12:28</div>
            <div class="timeline-body"><p>i still don&#x27;t like this divergence</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_dev/src/format_dev.rs</code>:555 on 2023-09-05 13:52</div>
            <div class="timeline-body"><p>You can do <code>LineWidth::from(NonZeroU16::from(line_length)))</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2023-09-05 13:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/konstin">@konstin</a> on 2023-09-05 14:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2023-09-05 14:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-09-05 14:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:56:40 UTC
    </footer>
</body>
</html>
