<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`flake8-executable`] Allow `uvx` in shebang line (`EXE003`) - astral-sh/ruff #18967</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>flake8-executable</code>] Allow <code>uvx</code> in shebang line (<code>EXE003</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/18967">#18967</a>
        opened by <a href="https://github.com/CodeMan62">@CodeMan62</a>
        on 2025-06-26 17:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/CodeMan62">@CodeMan62</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>closes #18902</p>
<h2>Test Plan</h2>
<p>I have added a test case</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-06-26 18:07</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>âœ… ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>âœ… ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jretz">@jretz</a> reviewed on 2025-06-26 18:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jretz">@jretz</a> on <code>crates/ruff_linter/src/rules/flake8_executable/rules/shebang_missing_python.rs</code>:53 on 2025-06-26 18:13</div>
            <div class="timeline-body"><p><code>run</code> is not a command available in <code>uvx</code>. This should be</p>
<pre><code class="language-rust">        || shebang.contains(&quot;uvx&quot;)
</code></pre>
<p>and/or</p>
<pre><code class="language-rust">        || shebang.contains(&quot;uv tool run&quot;)
</code></pre>
<p>I'd vote for allowing both.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`flake0-executables`] Allow `uvx run` in shebang line for EXE003" to "[`flake0-executables`] Allow `uvx` in shebang line for EXE003" by @CodeMan62 on 2025-06-26 18:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-06-26 18:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/src/rules/flake8_executable/rules/shebang_missing_python.rs</code>:53 on 2025-06-26 18:39</div>
            <div class="timeline-body"><p>I agree, let's include both while we're here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> reviewed on 2025-06-26 18:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_executable/EXE003_uvx.py</code>:1 on 2025-06-26 18:41</div>
            <div class="timeline-body"><p>Can you make this file executable to resolve the EXE001 error in the snapshot? On a Unix-like system, a command like</p>
<pre><code class="language-shell">chmod +x crates/ruff_linter/resources/test/fixtures/flake8_executable/EXE003_uvx.py
</code></pre>
<p>should work.</p>
<p>If we add support for <code>uv tool run</code> (and I think we should) we'll also need another test file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-06-27 07:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-06-27 07:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_executable/EXE003_uvx.py</code>:1 on 2025-06-27 07:03</div>
            <div class="timeline-body"><p>Can we use a more realistic example. I don't think running that script as is would work. Instead, uvx needs to be called with a tool name (see the issue)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jretz">@jretz</a> reviewed on 2025-06-27 07:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jretz">@jretz</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_executable/EXE003_uvx.py</code>:1 on 2025-06-27 07:55</div>
            <div class="timeline-body"><p>One idea for the <code>uvx</code> test case would be:</p>
<pre><code class="language-python">#!/usr/bin/env -S uvx ruff check --isolated --select EXE003
print(&quot;hello world&quot;)
</code></pre>
<p>And for the <code>uv tool run</code> test case suggested above:</p>
<pre><code class="language-python">#!/usr/bin/env -S uv tool run ruff check --isolated --select EXE003
print(&quot;hello world&quot;)
</code></pre>
<p>While these are not examples you would commonly see in the real world, they demonstrate the functionality involved and would run without error (after the resolution of this issue is released). They also have a good chance of being easily understood by people working on Astral projects.</p>
<p>Plus, who can resist the fun of a little self-referential code. ðŸ˜‰</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @ntBre by @CodeMan62 on 2025-06-29 12:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @CodeMan62 on 2025-06-29 12:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CodeMan62">@CodeMan62</a> on 2025-06-29 12:26</div>
            <div class="timeline-body"><p>everything is done :+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-06-30 13:37</div>
            <div class="timeline-body"><p>Looks good, thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[`flake0-executables`] Allow `uvx` in shebang line for EXE003" to "[`flake8-executable`] Allow `uvx` in shebang line (`EXE003`)" by @ntBre on 2025-06-30 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ntBre on 2025-06-30 13:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-06-30 13:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:13:44 UTC
    </footer>
</body>
</html>
