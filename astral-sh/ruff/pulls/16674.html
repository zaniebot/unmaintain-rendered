<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`pylint`] Detect invalid default value type for `os.environ.get` (`PLW1508`) - astral-sh/ruff #16674</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>pylint</code>] Detect invalid default value type for <code>os.environ.get</code> (<code>PLW1508</code>)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16674">#16674</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-03-12 12:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">Summary
<p>This PR stabilizes the new behavior introduced in <a href="https://github.com/astral-sh/ruff/pull/14512">astral-sh/ruff#14512</a> to also detect defalut value arguemnts to <code>os.environ.get</code> that have an invalid type (not <code>str</code>).
There&#x27;s an upstream issue for this behavior change <a href="https://github.com/pylint-dev/pylint/issues/10092">pylint-dev/pylint#10092</a> that was accepted and a PR, but it hasn&#x27;t been merged yet.</p>
<p>This behavior change was first shipped with Ruff 0.8.1 (Nov 22).</p>
<p>There has only be one PR since the new behavior was introduced but it was unrelated to the scope increase (<a href="https://github.com/astral-sh/ruff/pull/14841">astral-sh/ruff#14841</a>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-12 12:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2025-03-12 13:03</div>
            <div class="timeline-body">



<a href="https://codspeed.io/astral-sh/ruff/branches/micha%2Fpylint-envvar-default-os-environ-get">CodSpeed Performance Report</a>
Merging #16674 will <strong>degrade performances by 10.5%</strong>
<p>Comparing <code>micha/pylint-envvar-default-os-environ-get</code> (d561912) with <code>micha/ruff-0.10</code> (e9bfdfd)</p>
Summary
<p><code>❌ 1</code> regressions<br>
<code>✅ 31</code> untouched benchmarks</p>
<blockquote>
<p>:warning: <em>Please fix the performance issues or <a href="https://codspeed.io/astral-sh/ruff/branches/micha%2Fpylint-envvar-default-os-environ-get">acknowledge them on CodSpeed</a>.</em></p>
</blockquote>
Benchmarks breakdown
<p>|     | Benchmark | <code>BASE</code> | <code>HEAD</code> | Change |
| --- | --------- | ----------------------- | ------------------- | ------ |
| ❌ | <code>red_knot_check_file[incremental]</code> | 4.9 ms | 5.5 ms | -10.5% |</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-03-12 13:05</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+46 -0 violations, +0 -0 fixes in 9 projects; 46 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+9 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/airflow/api_fastapi/auth/managers/simple/simple_auth_manager.py#L245">airflow/api_fastapi/auth/managers/simple/simple_auth_manager.py:245:47:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/airflow/api_fastapi/core_api/app.py#L59">airflow/api_fastapi/core_api/app.py:59:43:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/providers/amazon/tests/system/amazon/aws/example_bedrock.py#L57">providers/amazon/tests/system/amazon/aws/example_bedrock.py:57:70:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/providers/amazon/tests/system/amazon/aws/example_bedrock.py#L62">providers/amazon/tests/system/amazon/aws/example_bedrock.py:62:86:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/providers/google/tests/system/google/cloud/storage_transfer/example_cloud_storage_transfer_service_aws.py#L76">providers/google/tests/system/google/cloud/storage_transfer/example_cloud_storage_transfer_service_aws.py:76:91:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/providers/google/tests/system/google/marketing_platform/example_display_video.py#L53">providers/google/tests/system/google/marketing_platform/example_display_video.py:53:53:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/providers/google/tests/system/google/marketing_platform/example_display_video.py#L60">providers/google/tests/system/google/marketing_platform/example_display_video.py:60:51:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/scripts/in_container/update_quarantined_test_status.py#L216">scripts/in_container/update_quarantined_test_status.py:216:47:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/airflow/blob/4acf93a4a6b9a79a4fecbeb11a9b2f3bead6febd/scripts/in_container/update_quarantined_test_status.py#L217">scripts/in_container/update_quarantined_test_status.py:217:47:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/apache/superset">apache/superset</a> (+4 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/superset/blob/a0ea905a7a01fbe31c3c270c99450818eaac792a/superset/config.py#L1612">superset/config.py:1612:77:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/superset/blob/a0ea905a7a01fbe31c3c270c99450818eaac792a/superset/migrations/shared/utils.py#L44">superset/migrations/shared/utils.py:44:55:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/superset/blob/a0ea905a7a01fbe31c3c270c99450818eaac792a/superset/migrations/versions/2020-09-28_17-57_b56500de1855_add_uuid_column_to_import_mixin.py#L76">superset/migrations/versions/2020-09-28_17-57_b56500de1855_add_uuid_column_to_import_mixin.py:76:55:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/apache/superset/blob/a0ea905a7a01fbe31c3c270c99450818eaac792a/superset/migrations/versions/2020-10-21_21-09_96e99fb176a0_add_import_mixing_to_saved_query.py#L54">superset/migrations/versions/2020-10-21_21-09_96e99fb176a0_add_import_mixing_to_saved_query.py:54:55:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/aws/aws-sam-cli">aws/aws-sam-cli</a> (+12 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/samcli/local/docker/container.py#L42">samcli/local/docker/container.py:42:93:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/samcli/local/lambdafn/remote_files.py#L33">samcli/local/lambdafn/remote_files.py:33:93:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/integration/buildcmd/test_build_terraform_applications.py#L177">tests/integration/buildcmd/test_build_terraform_applications.py:177:69:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/integration/package/package_integ_base.py#L51">tests/integration/package/package_integ_base.py:51:77:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/integration/package/package_integ_base.py#L55">tests/integration/package/package_integ_base.py:55:78:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/integration/publish/publish_app_integ_base.py#L22">tests/integration/publish/publish_app_integ_base.py:22:75:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/regression/package/regression_package_base.py#L24">tests/regression/package/regression_package_base.py:24:75:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/testing_utils.py#L24">tests/testing_utils.py:24:50:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/testing_utils.py#L26">tests/testing_utils.py:26:50:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/testing_utils.py#L31">tests/testing_utils.py:31:54:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/testing_utils.py#L31">tests/testing_utils.py:31:94:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/aws/aws-sam-cli/blob/f59ddab9ff665559337500af15de60876dc380f7/tests/testing_utils.py#L32">tests/testing_utils.py:32:45:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/bokeh/bokeh">bokeh/bokeh</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/bokeh/bokeh/blob/829b2a75c402d0d0abd7e37ff201fbdfd949d857/src/bokeh/settings.py#L338">src/bokeh/settings.py:338:53:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/fronzbot/blinkpy">fronzbot/blinkpy</a> (+1 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/fronzbot/blinkpy/blob/e2c747b5ad295424b08ff4fb03204129155666fc/blinkapp/blinkapp.py#L12">blinkapp/blinkapp.py:12:48:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+11 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/clickhouse/tests/conftest.py#L22">ibis/backends/clickhouse/tests/conftest.py:22:67:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/clickhouse/tests/test_client.py#L221">ibis/backends/clickhouse/tests/test_client.py:221:62:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/clickhouse/tests/test_client.py#L376">ibis/backends/clickhouse/tests/test_client.py:376:60:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/exasol/tests/conftest.py#L22">ibis/backends/exasol/tests/conftest.py:22:59:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/mssql/tests/conftest.py#L18">ibis/backends/mssql/tests/conftest.py:18:57:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/mysql/tests/conftest.py#L19">ibis/backends/mysql/tests/conftest.py:19:57:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/oracle/tests/conftest.py#L23">ibis/backends/oracle/tests/conftest.py:23:59:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/postgres/tests/conftest.py#L37">ibis/backends/postgres/tests/conftest.py:37:78:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/risingwave/tests/conftest.py#L22">ibis/backends/risingwave/tests/conftest.py:22:80:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/backends/trino/tests/conftest.py#L31">ibis/backends/trino/tests/conftest.py:31:73:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/ibis-project/ibis/blob/44151f00071c4d68a4355dab9789827be290b926/ibis/expr/tests/test_visualize.py#L19">ibis/expr/tests/test_visualize.py:19:39:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/latchbio/latch">latchbio/latch</a> (+1 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/latchbio/latch/blob/66920c3cd06ceb02109db8525c62b5569f5c459b/src/latch_cli/snakemake/single_task_snakemake.py#L38">src/latch_cli/snakemake/single_task_snakemake.py:38:63:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+1 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/pandas-dev/pandas/blob/3c93d06d641621ff62453c9c7748eeec3d6d8a97/setup.py#L367">setup.py:367:54:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

<a href="https://github.com/astropy/astropy">astropy/astropy</a> (+6 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/astropy/astropy/blob/f3e1013293a9a51d935a570b42ab33741d2611ab/astropy/utils/xml/setup_package.py#L19">astropy/utils/xml/setup_package.py:19:55:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/astropy/astropy/blob/f3e1013293a9a51d935a570b42ab33741d2611ab/astropy/utils/xml/setup_package.py#L20">astropy/utils/xml/setup_package.py:20:50:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/astropy/astropy/blob/f3e1013293a9a51d935a570b42ab33741d2611ab/astropy/wcs/setup_package.py#L198">astropy/wcs/setup_package.py:198:57:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/astropy/astropy/blob/f3e1013293a9a51d935a570b42ab33741d2611ab/astropy/wcs/setup_package.py#L199">astropy/wcs/setup_package.py:199:57:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/astropy/astropy/blob/f3e1013293a9a51d935a570b42ab33741d2611ab/astropy/wcs/setup_package.py#L341">astropy/wcs/setup_package.py:341:57:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
+ <a href="https://github.com/astropy/astropy/blob/f3e1013293a9a51d935a570b42ab33741d2611ab/astropy/wcs/setup_package.py#L342">astropy/wcs/setup_package.py:342:57:</a> PLW1508 Invalid type for environment variable default; expected `str` or `None`
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PLW1508 | 46 | 46 | 0 | 0 | 0 |</p>
</p>


Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-12 13:17</div>
            <div class="timeline-body"><p>The ecosystem changes all look correct to me</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/ntBre">@ntBre</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-12 16:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> approved on 2025-03-12 18:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-13 07:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-13 07:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-03-13 07:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:12:16 UTC
    </footer>
</body>
</html>
