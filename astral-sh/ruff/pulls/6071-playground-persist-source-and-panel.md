```yaml
number: 6071
title: "playground: Persist source and panel"
type: pull_request
state: merged
author: MichaReiser
labels:
  - playground
assignees: []
merged: true
base: main
head: playground-persist-source-and-panel
created_at: 2023-07-25T12:59:05Z
updated_at: 2023-07-26T05:56:00Z
url: https://github.com/astral-sh/ruff/pull/6071
synced_at: 2026-01-12T15:55:20Z
```

# playground: Persist source and panel

---

_@MichaReiser_

<!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

## Summary

This PR extends the playground to remember the open panel and last entered source code by:

* Storing the open secondary panel in the URL. This has the advantage that someone opening the playground sees the same as the user who shared the play. 
* Storing the source and settings in the local storage and load it when opening an *empty* playground (not a shared playground). There's one caveat to this. Reloading a playground that you opened from an URL will always restore the source from the URL, regardless if you made local changes. 


I decided not to store the open panel in the local storage for now because it complicates things and I mainly want to keep the same panel open when hitting refresh (or when vite decides to reload the page because of a new wasm file). 

## Test Plan

My screen recording is broken :cry: ... 

* I tested loading the playground with an empty local storage -> Shows default code
* Reloading with an open panel preserves the panel
* Reloading preserves the code
* Loading a link loads the code from the link


---

_Comment by @MichaReiser on 2023-07-25 12:59_

Current dependencies on/for this PR:
* main
  * **PR #6071** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6071" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/6071?utm_source=stack-comment).

---

_Marked ready for review by @MichaReiser on 2023-07-25 13:59_

---

_Label `playground` added by @MichaReiser on 2023-07-25 13:59_

---

_Review requested from @charliermarsh by @MichaReiser on 2023-07-25 13:59_

---

_Review comment by @MichaReiser on `playground/src/index.css`:32 on 2023-07-25 14:00_

Vite told me to do it 

---

_@MichaReiser reviewed on 2023-07-25 14:00_

---

_@charliermarsh approved on 2023-07-26 01:06_

---

_Merged by @MichaReiser on 2023-07-26 05:55_

---

_Closed by @MichaReiser on 2023-07-26 05:55_

---

_Branch deleted on 2023-07-26 05:56_

---
