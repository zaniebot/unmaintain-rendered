```yaml
number: 8057
title: "Change `line-ending` default to `auto`"
type: pull_request
state: merged
author: MichaReiser
labels:
  - breaking
  - formatter
assignees: []
merged: true
base: main
head: line-ending-default-to-auto
created_at: 2023-10-19T02:06:17Z
updated_at: 2023-10-21T10:52:04Z
url: https://github.com/astral-sh/ruff/pull/8057
synced_at: 2026-01-12T15:55:25Z
```

# Change `line-ending` default to `auto`

---

_@MichaReiser_

## Summary

This PR changes the `format.line-ending` default from `lf` to `auto`. 

The motivation for defaulting to `lf` is to ensure all files in a project use the same line ending, regardless of the file author's platform. However, it has the downside that it results in unexpected line-ending changes for existing projects that use a mixture of `\n` and `\r\n` and projects that use windows only.
We haven't received much feedback on the `lf` default, but there has been at least one occurrence where a user was confused about why Ruff changed all lines. 
They struggled to understand the changes because many diff viewers hide whitespace changes by default. 
We also put them in an uncomfortable position because they were unfamiliar with line endings (the difference between `\n` and `\r\n`) and didn't know what option to choose. So they defaulted to `auto` because it seems like the most clever option that hopefully does the right thing for them. 

## Breaking Change

While this is a breaking change because it changes the configuration, it doesn't require a new minor version because the formatter is still in alpha (excluded from versioning).

## Test Plan
I added a new integration test that ensures the formatter preserves the line ending choice when run without any options.


---

_Comment by @MichaReiser on 2023-10-19 02:06_

Current dependencies on/for this PR:
* main
  * **PR #8057** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8057" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a>  üëà

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/8057?utm_source=stack-comment).

---

_Label `breaking` added by @MichaReiser on 2023-10-19 02:15_

---

_Label `formatter` added by @MichaReiser on 2023-10-19 02:15_

---

_Review requested from @charliermarsh by @MichaReiser on 2023-10-19 02:15_

---

_Review requested from @zanieb by @MichaReiser on 2023-10-19 02:15_

---

_Comment by @github-actions[bot] on 2023-10-19 02:21_

## PR Check Results
### Ecosystem
‚úÖ ecosystem check detected no changes.



---

_@charliermarsh approved on 2023-10-19 03:12_

üëç üëç 

---

_Merged by @MichaReiser on 2023-10-19 23:13_

---

_Closed by @MichaReiser on 2023-10-19 23:13_

---

_Branch deleted on 2023-10-19 23:13_

---

_Comment by @Cjkjvfnby on 2023-10-21 10:45_

Thank you! 

I got the problem with this default on my regular project on Windows. Git manages line endings for me: https://docs.github.com/en/get-started/getting-started-with-git/configuring-git-to-handle-line-endings.  So changes are committed in UNIX style and code on my machine is in Windows style.



---

_Comment by @Cjkjvfnby on 2023-10-21 10:52_

Although `auto` is a great option.  For my projects, I'd prefer to use `native`.  It ensures that all my files are done the same way.  All projects I have seen with mixed line endings we more resulted in the absence of the tools for fixing it, it was not something that was required.



---
