<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix automatic configuration reloading for text and notebook documents - astral-sh/ruff #11492</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Fix automatic configuration reloading for text and notebook documents</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/11492">#11492</a>
        opened by <a href="https://github.com/snowsignal">@snowsignal</a>
        on 2024-05-22 09:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/snowsignal">@snowsignal</a> on 2024-05-22 09:08</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Recent changes made in the <a href="https://github.com/astral-sh/ruff/pull/11206">Jupyter Notebook feature PR</a> caused automatic configuration reloading to stop working. This was because we would check for paths to reload using the changed path, when we should have been using the parent path of the changed path (to get the directory it was changed in).</p>
<p>Additionally, this PR fixes an issue where <code>ruff.toml</code> and <code>.ruff.toml</code> files were not being automatically reloaded.</p>
<p>Finally, this PR improves configuration reloading by actively publishing diagnostics for notebook documents (which won't be affected by the workspace refresh since they don't use pull diagnostics). It will also publish diagnostics for text documents if pull diagnostics aren't supported.</p>
<h2>Test Plan</h2>
<p>To test this, open an existing configuration file in a codebase, and make modifications that will affect one or more open Python / Jupyter Notebook files. You should observe that the diagnostics for both kinds of files update automatically when the file changes are saved.</p>
<p>Here's a test video showing what a successful test should look like:</p>
<p>https://github.com/astral-sh/ruff/assets/19577865/7172b598-d6de-4965-b33c-6cb8b911ef6c</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @snowsignal on 2024-05-22 09:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @snowsignal on 2024-05-22 09:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-05-22 09:24</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> requested changes on 2024-05-22 11:09</div>
            <div class="timeline-body"><p>Can you update the test plan to include a video showcasing this fix? I think that would helpful to quickly review this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-05-22 18:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @snowsignal on 2024-05-22 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @snowsignal on 2024-05-22 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-05-22 18:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:05:57 UTC
    </footer>
</body>
</html>
