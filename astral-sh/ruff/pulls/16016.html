<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`ruff`] Fix invalid annotation in docs example - astral-sh/ruff #16016</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>ruff</code>] Fix invalid annotation in docs example</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/16016">#16016</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-02-07 10:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body">Summary
<p>Unfortunately the edits made by <a href="https://github.com/astral-sh/ruff/pull/15982">astral-sh/ruff#15982</a> mean that the annotations in the second &quot;Use instead&quot; example are now incorrect, and would be rejected by a type checker. This is because <code>instance_dict</code> is declared as a <code>ClassVar</code> variable in the class body, which declares to the type checker that it is illegal to set the attribute on instances of the class (it can only be set on the class object itself). The attribute is then assigned to <code>self</code> in the <code>__init__</code> instance method, violating the annotation in the class body.</p>
<p>This PR fixes the incorrect annotation and adds a couple more examples.</p>
Test Plan
<p>N/A</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-02-07 10:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-02-07 10:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-02-07 10:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-02-07 10:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-02-07 10:48</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>✅ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:11:13 UTC
    </footer>
</body>
</html>
