<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mdtest: include test name in printed rerun command - astral-sh/ruff #14684</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>mdtest: include test name in printed rerun command</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14684">#14684</a>
        opened by <a href="https://github.com/connorskees">@connorskees</a>
        on 2024-11-29 18:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/connorskees">@connorskees</a> on 2024-11-29 18:45</div>
            <div class="timeline-body"><p>This change follows up to https://github.com/astral-sh/ruff/pull/14670 by adding a test name argument to the printed <code>cargo test</code> command that can be copied to rerun a specific failing test.</p>
<p>This avoids reruns appearing as though they're running and passing all other tests.</p>
<p>This unfortunately has to work by borrowing some code from <a href="https://github.com/fe-lang/dir-test">dir-test</a>, as it's not possible to reconstruct the full test name using hacks like <a href="https://doc.rust-lang.org/std/macro.module_path.html"><code>module_path!</code></a> or (at least in my testing) <a href="https://doc.rust-lang.org/beta/std/any/fn.type_name.html"><code>std::any::type_name</code></a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @carljm by @connorskees on 2024-11-29 18:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @connorskees on 2024-11-29 18:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @connorskees on 2024-11-29 18:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @connorskees on 2024-11-29 18:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-11-29 18:51</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by @AlexWaygood on 2024-11-29 18:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @AlexWaygood on 2024-11-29 18:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-29 18:58</div>
            <div class="timeline-body"><p>I looked at <code>dir_test,</code> and the reason why <code>type_name</code> doesn't work is that <code>dir_test</code> keeps the function as is and instead generates new functions that hold the test corpus.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:22 on 2024-11-29 19:00</div>
            <div class="timeline-body"><pre><code class="language-suggestion">    for component in rel_path.parent().unwrap().components() {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:59 on 2024-11-29 19:01</div>
            <div class="timeline-body"><p>It could be worth using <code>SystemPath</code> for <code>fixture_path</code>. It avoids the need to deal with non-utf8 paths through the test code</p>
<pre><code>let fixture_path = SystemPath::new(fixture.path()).unwrap();
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> approved on 2024-11-29 19:02</div>
            <div class="timeline-body"><p>Nice</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/connorskees">@connorskees</a> reviewed on 2024-11-29 22:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/connorskees">@connorskees</a> on <code>crates/red_knot_python_semantic/tests/mdtest.rs</code>:59 on 2024-11-29 22:48</div>
            <div class="timeline-body"><p>hm this ends up requiring changes in a lot of places, unless we just say <code>.as_std_path()</code> at some point down the line. probably worth doing as a separate change</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-11-30 11:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-11-30 11:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 20:42:55 UTC
    </footer>
</body>
</html>
