<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Override fmt_dangling_comments for frequent nodes - astral-sh/ruff #6551</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Override fmt_dangling_comments for frequent nodes</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/6551">#6551</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2023-08-14 07:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-14 07:46</div>
            <div class="timeline-body"><!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>I noticed that <code>fmt_dangling_comments</code> for <code>ExprName</code> and <code>ExprCompare</code> shows up in flamegraphs.</p>
<p>This PR overrides <code>fmt_dangling_comments</code> for these expressions as we know that they can't have dangling comments. This comes at the risk
that we may drop such comment if this ever happens to change, but we have the <code>assert_formatted_all_comments</code> in debug builds that helps us catch unformatted comments.</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<p><code>cargo test</code></p>
<!-- How was it tested? -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-14 07:47</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li>main<ul>
<li><strong>PR #6547</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6547" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6548</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6548" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6549</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6549" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6550</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6550" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a><ul>
<li><strong>PR #6552</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6552" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a></li>
<li><strong>PR #6551</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6551" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.png" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>This comment was auto-generated by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6551?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2023-08-14 08:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-08-14 08:21</div>
            <div class="timeline-body"><h2>PR Check Results</h2>
<h3>Benchmark</h3>
<h4>Linux</h4>
<pre><code>group                                      main                                   pr
-----                                      ----                                   --
formatter/large/dataset.py                 1.02      4.6Â±0.12ms     8.9 MB/sec    1.00      4.5Â±0.12ms     9.1 MB/sec
formatter/numpy/ctypeslib.py               1.05   933.7Â±13.51Âµs    17.8 MB/sec    1.00   892.7Â±27.18Âµs    18.7 MB/sec
formatter/numpy/globals.py                 1.01     95.4Â±2.22Âµs    30.9 MB/sec    1.00     94.1Â±3.13Âµs    31.4 MB/sec
formatter/pydantic/types.py                1.03  1880.0Â±38.98Âµs    13.6 MB/sec    1.00  1831.0Â±50.22Âµs    13.9 MB/sec
linter/all-rules/large/dataset.py          1.00     11.9Â±0.23ms     3.4 MB/sec    1.01     12.1Â±0.24ms     3.4 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.02      3.2Â±0.07ms     5.2 MB/sec    1.00      3.2Â±0.06ms     5.3 MB/sec
linter/all-rules/numpy/globals.py          1.02    465.1Â±5.99Âµs     6.3 MB/sec    1.00   455.1Â±10.59Âµs     6.5 MB/sec
linter/all-rules/pydantic/types.py         1.00      6.2Â±0.11ms     4.1 MB/sec    1.00      6.2Â±0.12ms     4.1 MB/sec
linter/default-rules/large/dataset.py      1.01      6.3Â±0.08ms     6.4 MB/sec    1.00      6.3Â±0.13ms     6.5 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.02  1415.2Â±23.67Âµs    11.8 MB/sec    1.00  1392.6Â±35.36Âµs    12.0 MB/sec
linter/default-rules/numpy/globals.py      1.01    161.8Â±3.42Âµs    18.2 MB/sec    1.00    160.6Â±5.17Âµs    18.4 MB/sec
linter/default-rules/pydantic/types.py     1.04      2.9Â±0.03ms     8.8 MB/sec    1.00      2.8Â±0.06ms     9.1 MB/sec
</code></pre>
<h4>Windows</h4>
<pre><code>group                                      main                                    pr
-----                                      ----                                    --
formatter/large/dataset.py                 1.05      5.2Â±0.30ms     7.9 MB/sec     1.00      4.9Â±0.33ms     8.3 MB/sec
formatter/numpy/ctypeslib.py               1.06  1026.5Â±90.81Âµs    16.2 MB/sec     1.00   970.8Â±65.60Âµs    17.2 MB/sec
formatter/numpy/globals.py                 1.02     99.5Â±9.27Âµs    29.6 MB/sec     1.00     98.0Â±6.66Âµs    30.1 MB/sec
formatter/pydantic/types.py                1.07      2.1Â±0.16ms    12.3 MB/sec     1.00  1943.7Â±119.46Âµs    13.1 MB/sec
linter/all-rules/large/dataset.py          1.00     15.2Â±0.71ms     2.7 MB/sec     1.05     15.9Â±0.70ms     2.6 MB/sec
linter/all-rules/numpy/ctypeslib.py        1.00      4.2Â±0.23ms     3.9 MB/sec     1.01      4.3Â±0.20ms     3.9 MB/sec
linter/all-rules/numpy/globals.py          1.00   541.1Â±30.80Âµs     5.5 MB/sec     1.02   549.8Â±21.89Âµs     5.4 MB/sec
linter/all-rules/pydantic/types.py         1.00      8.3Â±0.43ms     3.1 MB/sec     1.01      8.4Â±0.38ms     3.0 MB/sec
linter/default-rules/large/dataset.py      1.02      8.5Â±0.34ms     4.8 MB/sec     1.00      8.4Â±0.29ms     4.9 MB/sec
linter/default-rules/numpy/ctypeslib.py    1.03  1866.1Â±112.47Âµs     8.9 MB/sec    1.00  1806.6Â±119.80Âµs     9.2 MB/sec
linter/default-rules/numpy/globals.py      1.02   231.7Â±13.10Âµs    12.7 MB/sec     1.00   227.2Â±17.01Âµs    13.0 MB/sec
linter/default-rules/pydantic/types.py     1.07      4.0Â±0.18ms     6.4 MB/sec     1.00      3.7Â±0.17ms     6.9 MB/sec
</code></pre>
<!-- thollander/actions-comment-pull-request "PR Check Results" -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2023-08-14 08:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2023-08-14 13:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-08-14 13:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-08-14 13:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 02:52:42 UTC
    </footer>
</body>
</html>
