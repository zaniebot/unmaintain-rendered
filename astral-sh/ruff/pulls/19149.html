<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fix(flake8_bandit): make S601 account for calls through clients - astral-sh/ruff #19149</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fix(flake8_bandit): make S601 account for calls through clients</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/19149">#19149</a>
        opened by <a href="https://github.com/CodeMan62">@CodeMan62</a>
        on 2025-07-04 17:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/CodeMan62">@CodeMan62</a></div>
            <div class="timeline-body">Summary
<p>closes #19006</p>
Test Plan
<p>I have wrote tests for it but let me know from the team that i have to push them or not</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-07-04 18:00</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+4 -0 violations, +0 -0 fixes in 2 projects; 53 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/5d5a6d6d0a6e38e90876b04a94c3a1d624d45e27/providers/google/src/airflow/providers/google/cloud/hooks/compute_ssh.py#L49">providers/google/src/airflow/providers/google/cloud/hooks/compute_ssh.py:49:27:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
+ <a href="https://github.com/apache/airflow/blob/5d5a6d6d0a6e38e90876b04a94c3a1d624d45e27/providers/ssh/src/airflow/providers/ssh/hooks/ssh.py#L273">providers/ssh/src/airflow/providers/ssh/hooks/ssh.py:273:18:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
</pre>

</p>

<a href="https://github.com/latchbio/latch">latchbio/latch</a> (+2 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/latchbio/latch/blob/62da644302a7cfae4cb73098c1969a54c16578a9/src/latch_cli/centromere/utils.py#L181">src/latch_cli/centromere/utils.py:181:19:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
+ <a href="https://github.com/latchbio/latch/blob/62da644302a7cfae4cb73098c1969a54c16578a9/src/latch_cli/centromere/utils.py#L207">src/latch_cli/centromere/utils.py:207:11:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| S601 | 4 | 4 | 0 | 0 | 0 |</p>
</p>


Linter (preview)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+4 -0 violations, +0 -0 fixes in 2 projects; 53 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/5d5a6d6d0a6e38e90876b04a94c3a1d624d45e27/providers/google/src/airflow/providers/google/cloud/hooks/compute_ssh.py#L49">providers/google/src/airflow/providers/google/cloud/hooks/compute_ssh.py:49:27:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
+ <a href="https://github.com/apache/airflow/blob/5d5a6d6d0a6e38e90876b04a94c3a1d624d45e27/providers/ssh/src/airflow/providers/ssh/hooks/ssh.py#L273">providers/ssh/src/airflow/providers/ssh/hooks/ssh.py:273:18:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
</pre>

</p>

<a href="https://github.com/latchbio/latch">latchbio/latch</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --preview</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/latchbio/latch/blob/62da644302a7cfae4cb73098c1969a54c16578a9/src/latch_cli/centromere/utils.py#L181">src/latch_cli/centromere/utils.py:181:19:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
+ <a href="https://github.com/latchbio/latch/blob/62da644302a7cfae4cb73098c1969a54c16578a9/src/latch_cli/centromere/utils.py#L207">src/latch_cli/centromere/utils.py:207:11:</a> S601 Possible shell injection via Paramiko call; check inputs are properly sanitized
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| S601 | 4 | 4 | 0 | 0 | 0 |</p>
</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-07-04 19:12</div>
            <div class="timeline-body"><p>Yes, we&#x27;ll definitely want to add tests!</p>
<p>I don&#x27;t think this is quite the right approach. I&#x27;d prefer trying to resolve the type of the client. You can see an example of what I had in mind with the <code>is_fastapi_route</code> function (and other <code>is_*</code> functions in the same file):</p>
<p>https://github.com/astral-sh/ruff/blob/c3e307739b61b5881a9970b6071e935e786fbdc9/crates/ruff_python_semantic/src/analyze/typing.rs#L1095-L1097</p>
<p>That might actually miss some of the cases you&#x27;re currently catching in the ecosystem check, but I think it would be the right trade-off. And it will automatically get better with improved type inference in the future.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2025-07-04 19:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CodeMan62">@CodeMan62</a> on 2025-07-05 12:19</div>
            <div class="timeline-body"><p>I have added test case and i am trying to follow the review</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CodeMan62">@CodeMan62</a> on 2025-07-05 16:07</div>
            <div class="timeline-body"><p>Tests added
implemented as per the implementation of <code>FastApiRouteChecker</code> in <code>is_fastapi_route</code> function
Note:- sorry for putting 2 extra commits for warning and fmt i forget to enable fmt in nvim config</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CodeMan62">@CodeMan62</a> on 2025-07-09 17:09</div>
            <div class="timeline-body"><p>This needs a review</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ntBre">@ntBre</a> on <code>crates/ruff_linter/resources/test/fixtures/flake8_bandit/S613.py</code>:1 on 2025-07-09 17:33</div>
            <div class="timeline-body"><p>I&#x27;d recommend naming this file something like <code>S601_1.py</code> instead of the unrelated S613. We actually don&#x27;t have a rule S613.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a> requested changes on 2025-07-09 17:34</div>
            <div class="timeline-body"><p>This is still not what I had in mind. I was suggesting implementing an inference method like <code>is_fastapi_route</code> and applying that to the receiver of the <code>exec_command</code> call. This doesn&#x27;t really resemble that at all, and it still has the same issue reported initially in that it checks for <code>paramiko.exec_command</code>, which doesn&#x27;t exist.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-18 07:35</div>
            <div class="timeline-body"><p>Thanks for your contribution. I&#x27;ll close this due to inactivity.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-18 07:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:16:16 UTC
    </footer>
</body>
</html>
