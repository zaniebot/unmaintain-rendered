<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Indent lambda parameters if parameters wrap - astral-sh/ruff #8465</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Indent lambda parameters if parameters wrap</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/8465">#8465</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2023-11-03 05:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-11-03 05:20</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>A non-black compatible approach to https://github.com/astral-sh/ruff/issues/8179</p>
<p>The black-compatible formatting would enforce spaces when formatting parameters with the <code>ParameterParentheses::Never</code>. However, this doesn't work when using comments (which black doesn't support <a href="https://black.vercel.app/?version=stable&amp;state=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4ACOAGBdAD2IimZxl1N_WhQ8R5sgERcjE4CA79XBQnYhkNIGX378uPpzJVCf3opcwNZ5N4_s5GR-d6S0M12O66BmJ9d2BIpKmRsn-5XXsdd5l9RAxvUQiFV4AOsopTANF-mxwYxCAADlTL2qgfqd_wABfI8BAAAAQVm_NLHEZ_sCAAAAAARZWg==">playground</a>?)</p>
<p>This PR implements two changes (we may want to split it in two):</p>
<p>a) It indents the lambda parameters if they don't fit on a single line:</p>
<pre><code class="language-python">def a():
    return b(
        c,
        d,
        e,
        f=lambda 
            self,
            *args,
            **kwargs
        : aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa(*args, **kwargs),
        b=d,
        e=f,
    )

</code></pre>
<p>b) Preview style that parenthesizes the lambda body if it expands.</p>
<pre><code class="language-diff">         return {
             **super().get_event_triggers(),
             EventTriggers.ON_CHANGE: (
-                lambda e0: [
-                    Var.create_safe(f&quot;{e0}.map(e =&gt; e.value)&quot;, _var_is_local=True)
-                ]
-                if self.is_multi.equals(Var.create_safe(True))
-                else lambda e0: [e0]
+                lambda e0: (
+                    [Var.create_safe(f&quot;{e0}.map(e =&gt; e.value)&quot;, _var_is_local=True)]
+                    if self.is_multi.equals(Var.create_safe(True))
+                    else lambda e0: [e0]
+                )
             ),
         }
</code></pre>
<h2>Alternatives</h2>
<p>Favor black compatibility and enforce using <code>space</code> in the parameters formatting when the <code>ParameterParentheses::Never</code> is used. Requires finding a comment placement that produces stable results.</p>
<p>Unclear how we want to support</p>
<pre><code class="language-python">(
    lambda
    x,
    # comment
    y:
    z
)
</code></pre>
<h2>Notes</h2>
<p>It's probably worth to split out the body changes. They seem to generally improve readability</p>
<h2>Test Plan</h2>
<p>The non-preview changes don't seem to change the similarity index (at least after only indenting if there are 2 or more parameters).</p>
<p>The preview changes regress the similarity index across the board</p>
<p>Main
| project        | similarity index  | total files       | changed files     |
|----------------|------------------:|------------------:|------------------:|
| cpython        |           0.75804 |              1799 |              1648 |
| django         |           0.99984 |              2772 |                34 |
| home-assistant |           0.99963 |             10596 |               143 |
| poetry         |           0.99925 |               317 |                12 |
| transformers   |           0.99967 |              2657 |               322 |
| twine          |           1.00000 |                33 |                 0 |
| typeshed       |           0.99980 |              3669 |                18 |
| warehouse      |           0.99977 |               654 |                13 |
| zulip          |           0.99970 |              1459 |                21 |</p>
<p>Preview</p>
<p>| project        | similarity index  | total files       | changed files     |
|----------------|------------------:|------------------:|------------------:|
| cpython        |           0.75804 |              1799 |              1648 |
| django         |           0.99978 |              2772 |                40 |
| home-assistant |           0.99957 |             10596 |               174 |
| poetry         |           0.99925 |               317 |                12 |
| transformers   |           0.99965 |              2657 |               328 |
| twine          |           1.00000 |                33 |                 0 |
| typeshed       |           0.99980 |              3669 |                18 |
| warehouse      |           0.99968 |               654 |                16 |
| zulip          |           0.99970 |              1459 |                21 |</p>
<p>Here a few examples</p>
<pre><code class="language-diff">index 9aa78a281f..499bc0dfb9 100644
--- a/django/db/models/expressions.py
+++ b/django/db/models/expressions.py
@@ -366,21 +366,21 @@ class BaseExpression:
         internal_type = field.get_internal_type()
         if internal_type == &quot;FloatField&quot;:
             return (
-                lambda value, expression, connection: None
-                if value is None
-                else float(value)
+                lambda value, expression, connection: (
+                    None if value is None else float(value)
+                )
             )
         elif internal_type.endswith(&quot;IntegerField&quot;):
             return (
-                lambda value, expression, connection: None
-                if value is None
-                else int(value)
+                lambda value, expression, connection: (
+                    None if value is None else int(value)
+                )
             )
         elif internal_type == &quot;DecimalField&quot;:
             return (
-                lambda value, expression, connection: None
-                if value is None
-                else Decimal(value)
+                lambda value, expression, connection: (
+                    None if value is None else Decimal(value)
+                )
             )
         return self._convert_value_noop
 
index 889c1cfe84..8555f08cb3 100644
--- a/django/contrib/gis/db/models/fields.py
+++ b/django/contrib/gis/db/models/fields.py
@@ -48,9 +48,9 @@ def get_srid_info(srid, connection):
     alias, get_srs = (
         (
             connection.alias,
-            lambda srid: SpatialRefSys.objects.using(connection.alias)
-            .get(srid=srid)
-            .srs,
+            lambda srid: (
+                SpatialRefSys.objects.using(connection.alias).get(srid=srid).srs
+            ),
         )
         if SpatialRefSys
         else (None, SpatialReference)


index dc857055b1..b45a8bb10e 100644
--- a/django/contrib/admin/tests.py
+++ b/django/contrib/admin/tests.py
@@ -110,8 +110,9 @@ class AdminSeleniumTestCase(SeleniumTestCase, StaticLiveServerTestCase):
         Block until the  page is ready.
         &quot;&quot;&quot;
         self.wait_until(
-            lambda driver: driver.execute_script(&quot;return document.readyState;&quot;)
-            == &quot;complete&quot;,
+            lambda driver: (
+                driver.execute_script(&quot;return document.readyState;&quot;) == &quot;complete&quot;
+            ),
             timeout,
         )
 
@@ -196,8 +197,8 @@ class AdminSeleniumTestCase(SeleniumTestCase, StaticLiveServerTestCase):
             # to be the case.
             with self.disable_implicit_wait():
                 self.wait_until(
-                    lambda driver: not driver.find_elements(
-                        By.CSS_SELECTOR, options_selector
+                    lambda driver: (
+                        not driver.find_elements(By.CSS_SELECTOR, options_selector)
                     )
                 )

index 9855c318be..fd7770eb2e 100644
--- a/django/test/testcases.py
+++ b/django/test/testcases.py
@@ -1470,8 +1470,10 @@ def skipIfDBFeature(*features):
 def skipUnlessDBFeature(*features):
     &quot;&quot;&quot;Skip a test unless a database has all the named features.&quot;&quot;&quot;
     return _deferredSkip(
-        lambda: not all(
-            getattr(connection.features, feature, False) for feature in features
+        lambda: (
+            not all(
+                getattr(connection.features, feature, False) for feature in features
+            )
         ),
         &quot;Database doesn't support feature(s): %s&quot; % &quot;, &quot;.join(features),
         &quot;skipUnlessDBFeature&quot;,
@@ -1481,8 +1483,10 @@ def skipUnlessDBFeature(*features):
 def skipUnlessAnyDBFeature(*features):
     &quot;&quot;&quot;Skip a test unless a database has any of the named features.&quot;&quot;&quot;
     return _deferredSkip(
-        lambda: not any(
-            getattr(connection.features, feature, False) for feature in features
+        lambda: (
+            not any(
+                getattr(connection.features, feature, False) for feature in features
+            )
         ),
         &quot;Database doesn't support any of the feature(s): %s&quot; % &quot;, &quot;.join(features),
         &quot;skipUnlessAnyDBFeature&quot;,

index b9a7e4cd64..a69ebd31cb 100644
--- a/tests/absolute_url_overrides/tests.py
+++ b/tests/absolute_url_overrides/tests.py
@@ -29,8 +29,9 @@ class AbsoluteUrlOverrideTests(SimpleTestCase):
 
         with self.settings(
             ABSOLUTE_URL_OVERRIDES={
-                &quot;absolute_url_overrides.testb&quot;: lambda o: &quot;/overridden-test-b/%s/&quot;
-                % o.pk,
+                &quot;absolute_url_overrides.testb&quot;: lambda o: (
+                    &quot;/overridden-test-b/%s/&quot; % o.pk
+                ),
             },
         ):

index 4d85d15065..9aec0a68e8 100644
--- a/tests/contenttypes_tests/test_views.py
+++ b/tests/contenttypes_tests/test_views.py
@@ -151,9 +151,9 @@ class ContentTypesViewsSiteRelTests(TestCase):
         The shortcut view works if a model's ForeignKey to site is None.
         &quot;&quot;&quot;
         get_model.side_effect = (
-            lambda *args, **kwargs: MockSite
-            if args[0] == &quot;sites.Site&quot;
-            else ModelWithNullFKToSite
+            lambda *args, **kwargs: (
+                MockSite if args[0] == &quot;sites.Site&quot; else ModelWithNullFKToSite
+            )
         )
 
         obj = ModelWithNullFKToSite.objects.create(title=&quot;title&quot;)
@@ -173,9 +173,9 @@ class ContentTypesViewsSiteRelTests(TestCase):
         found in the m2m relationship.
         &quot;&quot;&quot;
         get_model.side_effect = (
-            lambda *args, **kwargs: MockSite
-            if args[0] == &quot;sites.Site&quot;
-            else ModelWithM2MToSite
+            lambda *args, **kwargs: (
+                MockSite if args[0] == &quot;sites.Site&quot; else ModelWithM2MToSite
+            )
         )
</code></pre>
<p>Most of these seem clear improvements to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-11-03 05:20</div>
            <div class="timeline-body"><p>Current dependencies on/for this PR:</p>
<ul>
<li><strong>#8465</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8465?utm_source=stack-comment-icon" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a> üëà</li>
<li><strong>#8466</strong> <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8466?utm_source=stack-comment-icon" target="_blank"><img src="https://static.graphite.dev/graphite-32x32-black.png" alt="Graphite" width="10px" height="10px"/></a></li>
<li><code>main</code></li>
</ul>
<p>This <a href="https://stacking.dev/?utm_source=stack-comment">stack of pull requests</a> is managed by <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/8465?utm_source=stack-comment">Graphite</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-11-03 07:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/tests/snapshots/format@expression__lambda.py.snap</code>:359 on 2023-11-03 07:42</div>
            <div class="timeline-body"><p>This was better before</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2023-11-03 07:55</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>‚úÖ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>‚úÖ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected format changes</strong>. (+4 -4 lines in 1 file in 41 projects)</p>
<details><summary><a href="https://github.com/rotki/rotki">rotki/rotki</a> (+4 -4 lines across 1 file)</summary>
<p>

<p><a href='https://github.com/rotki/rotki/blob/b7e3655e090b1d31d99078618e1a864430fe672c/rotkehlchen/data_import/importers/binance.py#L272'>rotkehlchen/data_import/importers/binance.py~L272</a></p>
<pre><code class="language-diff"> 
         for rows_group in rows_grouped_by_fee.values():
             rows_group.sort(
-                key=lambda x: x[&quot;Change&quot;]
-                if same_assets
-                else x[&quot;Change&quot;] * price_at_timestamp[x[&quot;Coin&quot;]],
+                key=lambda x: (
+                    x[&quot;Change&quot;] if same_assets else x[&quot;Change&quot;] * price_at_timestamp[x[&quot;Coin&quot;]]
+                ),
                 reverse=True,
             )  # noqa: E501
 
</code></pre>
</p>
</details>

<h3>Formatter (preview)</h3>
<p>‚ÑπÔ∏è ecosystem check <strong>detected format changes</strong>. (+91 -71 lines in 15 files in 41 projects)</p>
<details><summary><a href="https://github.com/RasaHQ/rasa">RasaHQ/rasa</a> (+4 -4 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/RasaHQ/rasa/blob/0dd893a1b343b069cbd237c74ded10ffa984afb4/rasa/nlu/featurizers/sparse_featurizer/lexical_syntactic_featurizer.py#L86'>rasa/nlu/featurizers/sparse_featurizer/lexical_syntactic_featurizer.py~L86</a></p>
<pre><code class="language-diff">         &quot;suffix2&quot;: lambda token: token.text[-2:],
         &quot;suffix1&quot;: lambda token: token.text[-1:],
         &quot;pos&quot;: lambda token: token.data.get(POS_TAG_KEY, None),
-        &quot;pos2&quot;: lambda token: token.data.get(POS_TAG_KEY, [])[:2]
-        if POS_TAG_KEY in token.data
-        else None,
+        &quot;pos2&quot;: lambda token: (
+            token.data.get(POS_TAG_KEY, [])[:2] if POS_TAG_KEY in token.data else None
+        ),
         &quot;upper&quot;: lambda token: token.text.isupper(),
         &quot;digit&quot;: lambda token: token.text.isdigit(),
     }
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/aws/aws-sam-cli">aws/aws-sam-cli</a> (+16 -13 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/aws/aws-sam-cli/blob/e4c61da9d873bbad7c17056efdd41601511ea86f/samcli/lib/cli_validation/image_repository_validation.py#L72'>samcli/lib/cli_validation/image_repository_validation.py~L72</a></p>
<pre><code class="language-diff"> 
             validators = [
                 Validator(
-                    validation_function=lambda: bool(image_repository)
-                    + bool(image_repositories)
-                    + bool(resolve_image_repos)
-                    &gt; 1,
+                    validation_function=lambda: (
+                        bool(image_repository) + bool(image_repositories) + bool(resolve_image_repos) &gt; 1
+                    ),
                     exception=click.BadOptionUsage(
                         option_name=&quot;--image-repositories&quot;,
                         ctx=ctx,
</code></pre>
<p><a href='https://github.com/aws/aws-sam-cli/blob/e4c61da9d873bbad7c17056efdd41601511ea86f/samcli/lib/cli_validation/image_repository_validation.py#L84'>samcli/lib/cli_validation/image_repository_validation.py~L84</a></p>
<pre><code class="language-diff">                     ),
                 ),
                 Validator(
-                    validation_function=lambda: not guided
-                    and not (image_repository or image_repositories or resolve_image_repos)
-                    and required,
+                    validation_function=lambda: (
+                        not guided and not (image_repository or image_repositories or resolve_image_repos) and required
+                    ),
                     exception=click.BadOptionUsage(
                         option_name=&quot;--image-repositories&quot;,
                         ctx=ctx,
</code></pre>
<p><a href='https://github.com/aws/aws-sam-cli/blob/e4c61da9d873bbad7c17056efdd41601511ea86f/samcli/lib/cli_validation/image_repository_validation.py#L94'>samcli/lib/cli_validation/image_repository_validation.py~L94</a></p>
<pre><code class="language-diff">                     ),
                 ),
                 Validator(
-                    validation_function=lambda: not guided
-                    and (
-                        image_repositories
-                        and not resolve_image_repos
-                        and not _is_all_image_funcs_provided(template_file, image_repositories, parameters_overrides)
+                    validation_function=lambda: (
+                        not guided
+                        and (
+                            image_repositories
+                            and not resolve_image_repos
+                            and not _is_all_image_funcs_provided(
+                                template_file, image_repositories, parameters_overrides
+                            )
+                        )
                     ),
                     exception=click.BadOptionUsage(
                         option_name=&quot;--image-repositories&quot;, ctx=ctx, message=image_repos_error_msg
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/demisto/content">demisto/content</a> (+37 -27 lines across 6 files)</summary>
<p>
<pre>ruff format --exclude Packs/ThreatQ/Integrations/ThreatQ/ThreatQ.py --preview</pre>
</p>
<p>

<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/FiltersAndTransformers/Scripts/IfElif/IfElif.py#L74'>Packs/FiltersAndTransformers/Scripts/IfElif/IfElif.py~L74</a></p>
<pre><code class="language-diff">         if &quot;list_compare&quot; in flags:
 
             def to_deep_search(func):
-                return lambda x, y: (func(x, y) or (any(func(x, i) for i in y) if isinstance(y, list) else False))
+                return lambda x, y: func(x, y) or (any(func(x, i) for i in y) if isinstance(y, list) else False)
 
             self.comparison_operators = {k: to_deep_search(v) for k, v in self.comparison_operators.items()}
 
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/FireEyeETP/Integrations/FireEyeETPEventCollector/FireEyeETPEventCollector.py#L315'>Packs/FireEyeETP/Integrations/FireEyeETPEventCollector/FireEyeETPEventCollector.py~L315</a></p>
<pre><code class="language-diff">                 last_run_ids: set[str] = {
                     item.get(&quot;id&quot;, &quot;&quot;)
                     for item in filter(
-                        lambda item: datetime.fromisoformat(demisto.get(item, &quot;attributes.meta.last_modified_on&quot;))
-                        == last_run_time,
+                        lambda item: (
+                            datetime.fromisoformat(demisto.get(item, &quot;attributes.meta.last_modified_on&quot;)) == last_run_time
+                        ),
                         events,
                     )
                 }
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/FireEyeETP/Integrations/FireEyeETPEventCollector/FireEyeETPEventCollector.py#L329'>Packs/FireEyeETP/Integrations/FireEyeETPEventCollector/FireEyeETPEventCollector.py~L329</a></p>
<pre><code class="language-diff">                 last_run_ids = {
                     item.get(&quot;id&quot;, &quot;&quot;)
                     for item in filter(
-                        lambda item: datetime.fromisoformat(demisto.get(item, &quot;attributes.lastModifiedDateTime&quot;))
-                        == last_run_time,
+                        lambda item: (
+                            datetime.fromisoformat(demisto.get(item, &quot;attributes.lastModifiedDateTime&quot;)) == last_run_time
+                        ),
                         events,
                     )
                 }
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/GigamonThreatINSIGHT/Integrations/GigamonThreatINSIGHT/GigamonThreatINSIGHT.py#L756'>Packs/GigamonThreatINSIGHT/Integrations/GigamonThreatINSIGHT/GigamonThreatINSIGHT.py~L756</a></p>
<pre><code class="language-diff">             result = getDetectionsInc(detectionClient, result, args)
 
     # filter out training detections
-    result[&quot;detections&quot;] = list(filter(lambda detection: (detection[&quot;account_uuid&quot;] != TRAINING_ACC), result[&quot;detections&quot;]))
+    result[&quot;detections&quot;] = list(filter(lambda detection: detection[&quot;account_uuid&quot;] != TRAINING_ACC, result[&quot;detections&quot;]))
 
     # Include the rules if they need to be included
     if &quot;include&quot; in args and &quot;rules&quot; in args[&quot;include&quot;].split(&quot;,&quot;):
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/MailListener/Integrations/MailListenerV2/MailListenerV2.py#L524'>Packs/MailListener/Integrations/MailListenerV2/MailListenerV2.py~L524</a></p>
<pre><code class="language-diff"> 
     return re.sub(
         r&quot;(?P&lt;lseps&gt;\s*)(?P&lt;begin&gt;-----BEGIN(.*?)-----)(?P&lt;body&gt;.*?)(?P&lt;end&gt;-----END(.*?)-----)(?P&lt;tseps&gt;\s*)&quot;,
-        lambda m: m.group(&quot;lseps&quot;).replace(&quot; &quot;, &quot;\n&quot;)
-        + m.group(&quot;begin&quot;)
-        + m.group(&quot;body&quot;).replace(&quot; &quot;, &quot;\n&quot;)
-        + m.group(&quot;end&quot;)
-        + m.group(&quot;tseps&quot;).replace(&quot; &quot;, &quot;\n&quot;),
+        lambda m: (
+            m.group(&quot;lseps&quot;).replace(&quot; &quot;, &quot;\n&quot;)
+            + m.group(&quot;begin&quot;)
+            + m.group(&quot;body&quot;).replace(&quot; &quot;, &quot;\n&quot;)
+            + m.group(&quot;end&quot;)
+            + m.group(&quot;tseps&quot;).replace(&quot; &quot;, &quot;\n&quot;)
+        ),
         credentials,
         flags=re.DOTALL,
     )
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/Slack/Integrations/Slack/Slack.py#L125'>Packs/Slack/Integrations/Slack/Slack.py~L125</a></p>
<pre><code class="language-diff">         users = json.loads(integration_context[&quot;users&quot;])
         users_filter = list(
             filter(
-                lambda u: u.get(&quot;name&quot;, &quot;&quot;).lower() == user_to_search
-                or u.get(&quot;profile&quot;, {}).get(&quot;email&quot;, &quot;&quot;).lower() == user_to_search
-                or u.get(&quot;real_name&quot;, &quot;&quot;).lower() == user_to_search,
+                lambda u: (
+                    u.get(&quot;name&quot;, &quot;&quot;).lower() == user_to_search
+                    or u.get(&quot;profile&quot;, {}).get(&quot;email&quot;, &quot;&quot;).lower() == user_to_search
+                    or u.get(&quot;real_name&quot;, &quot;&quot;).lower() == user_to_search
+                ),
                 users,
             )
         )
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/Slack/Integrations/Slack/Slack.py#L141'>Packs/Slack/Integrations/Slack/Slack.py~L141</a></p>
<pre><code class="language-diff">             cursor = response.get(&quot;response_metadata&quot;, {}).get(&quot;next_cursor&quot;)
             users_filter = list(
                 filter(
-                    lambda u: u.get(&quot;name&quot;, &quot;&quot;).lower() == user_to_search
-                    or u.get(&quot;profile&quot;, {}).get(&quot;email&quot;, &quot;&quot;).lower() == user_to_search
-                    or u.get(&quot;real_name&quot;, &quot;&quot;).lower() == user_to_search,
+                    lambda u: (
+                        u.get(&quot;name&quot;, &quot;&quot;).lower() == user_to_search
+                        or u.get(&quot;profile&quot;, {}).get(&quot;email&quot;, &quot;&quot;).lower() == user_to_search
+                        or u.get(&quot;real_name&quot;, &quot;&quot;).lower() == user_to_search
+                    ),
                     workspace_users,
                 )
             )
</code></pre>
<p><a href='https://github.com/demisto/content/blob/8ba55546fd9af9dec4d217788682349544fd5418/Packs/Slack/Integrations/SlackV3/SlackV3.py#L173'>Packs/Slack/Integrations/SlackV3/SlackV3.py~L173</a></p>
<pre><code class="language-diff">     &quot;&quot;&quot;
     users_filter = list(
         filter(
-            lambda u: u.get(&quot;name&quot;, &quot;&quot;).lower() == user_to_search
-            or u.get(&quot;profile&quot;, {}).get(&quot;display_name&quot;, &quot;&quot;).lower() == user_to_search
-            or u.get(&quot;profile&quot;, {}).get(&quot;email&quot;, &quot;&quot;).lower() == user_to_search
-            or u.get(&quot;profile&quot;, {}).get(&quot;real_name&quot;, &quot;&quot;).lower() == user_to_search,
+            lambda u: (
+                u.get(&quot;name&quot;, &quot;&quot;).lower() == user_to_search
+                or u.get(&quot;profile&quot;, {}).get(&quot;display_name&quot;, &quot;&quot;).lower() == user_to_search
+                or u.get(&quot;profile&quot;, {}).get(&quot;email&quot;, &quot;&quot;).lower() == user_to_search
+                or u.get(&quot;profile&quot;, {}).get(&quot;real_name&quot;, &quot;&quot;).lower() == user_to_search
+            ),
             users_list,
         )
     )
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/ibis-project/ibis">ibis-project/ibis</a> (+6 -4 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/ibis-project/ibis/blob/6538b70c5fd0c53df79b9454275b0d1aaa79bf84/ibis/backends/base/sql/alchemy/__init__.py#L979'>ibis/backends/base/sql/alchemy/<strong>init</strong>.py~L979</a></p>
<pre><code class="language-diff">     return (
         sg.parse_one(element.fullname, into=sg.exp.Table, read=dialect)
         .transform(
-            lambda node: node.__class__(this=node.this, quoted=True)
-            if isinstance(node, sg.exp.Identifier)
-            else node
+            lambda node: (
+                node.__class__(this=node.this, quoted=True)
+                if isinstance(node, sg.exp.Identifier)
+                else node
+            )
         )
         .sql(dialect)
     )
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/pandas-dev/pandas">pandas-dev/pandas</a> (+18 -13 lines across 4 files)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/pandas-dev/pandas/blob/0cdb37c445fc0a0a2144f981fd1acbf4f07d88ee/asv_bench/benchmarks/io/style.py#L66'>asv_bench/benchmarks/io/style.py~L66</a></p>
<pre><code class="language-diff">         self.st = self.df.style.apply(_apply_func, axis=1)
 
     def _style_classes(self):
-        classes = self.df.map(lambda v: (&quot;cls-1&quot; if v &gt; 0 else &quot;&quot;))
+        classes = self.df.map(lambda v: &quot;cls-1&quot; if v &gt; 0 else &quot;&quot;)
         classes.index, classes.columns = self.df.index, self.df.columns
         self.st = self.df.style.set_td_classes(classes)
 
</code></pre>
<p><a href='https://github.com/pandas-dev/pandas/blob/0cdb37c445fc0a0a2144f981fd1acbf4f07d88ee/pandas/core/array_algos/replace.py#L87'>pandas/core/array_algos/replace.py~L87</a></p>
<pre><code class="language-diff">         op = lambda x: operator.eq(x, b)
     else:
         op = np.vectorize(
-            lambda x: bool(re.search(b, x))
-            if isinstance(x, str) and isinstance(b, (str, Pattern))
-            else False
+            lambda x: (
+                bool(re.search(b, x))
+                if isinstance(x, str) and isinstance(b, (str, Pattern))
+                else False
+            )
         )
 
     # GH#32621 use mask to avoid comparing to NAs
</code></pre>
<p><a href='https://github.com/pandas-dev/pandas/blob/0cdb37c445fc0a0a2144f981fd1acbf4f07d88ee/pandas/core/dtypes/common.py#L129'>pandas/core/dtypes/common.py~L129</a></p>
<pre><code class="language-diff">     Evaluate if the tipo is a subclass of the klasses
     and not a datetimelike.
     &quot;&quot;&quot;
-    return lambda tipo: (
-        issubclass(tipo, klasses)
-        and not issubclass(tipo, (np.datetime64, np.timedelta64))
+    return (
+        lambda tipo: (
+            issubclass(tipo, klasses)
+            and not issubclass(tipo, (np.datetime64, np.timedelta64))
+        )
     )
 
 
</code></pre>
<p><a href='https://github.com/pandas-dev/pandas/blob/0cdb37c445fc0a0a2144f981fd1acbf4f07d88ee/pandas/core/internals/array_manager.py#L403'>pandas/core/internals/array_manager.py~L403</a></p>
<pre><code class="language-diff">             Whether to copy the blocks
         &quot;&quot;&quot;
         return self._get_data_subset(
-            lambda arr: is_numeric_dtype(arr.dtype)
-            or getattr(arr.dtype, &quot;_is_numeric&quot;, False)
+            lambda arr: (
+                is_numeric_dtype(arr.dtype) or getattr(arr.dtype, &quot;_is_numeric&quot;, False)
+            )
         )
 
     def copy(self, deep: bool | Literal[&quot;all&quot;] | None = True) -&gt; Self:
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/reflex-dev/reflex">reflex-dev/reflex</a> (+6 -6 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/reflex-dev/reflex/blob/b313aaf3ef322e54c76bdf9ef6175ca583e36762/reflex/components/forms/multiselect.py#L310'>reflex/components/forms/multiselect.py~L310</a></p>
<pre><code class="language-diff">         return {
             **super().get_event_triggers(),
             EventTriggers.ON_CHANGE: (
-                lambda e0: [
-                    Var.create_safe(f&quot;{e0}.map(e =&gt; e.value)&quot;, _var_is_local=True)
-                ]
-                if self.is_multi.equals(Var.create_safe(True))
-                else lambda e0: [e0]
+                lambda e0: (
+                    [Var.create_safe(f&quot;{e0}.map(e =&gt; e.value)&quot;, _var_is_local=True)]
+                    if self.is_multi.equals(Var.create_safe(True))
+                    else lambda e0: [e0]
+                )
             ),
         }
 
</code></pre>
</p>
</details>
<details><summary><a href="https://github.com/rotki/rotki">rotki/rotki</a> (+4 -4 lines across 1 file)</summary>
<p>
<pre>ruff format --preview</pre>
</p>
<p>

<p><a href='https://github.com/rotki/rotki/blob/b7e3655e090b1d31d99078618e1a864430fe672c/rotkehlchen/data_import/importers/binance.py#L272'>rotkehlchen/data_import/importers/binance.py~L272</a></p>
<pre><code class="language-diff"> 
         for rows_group in rows_grouped_by_fee.values():
             rows_group.sort(
-                key=lambda x: x[&quot;Change&quot;]
-                if same_assets
-                else x[&quot;Change&quot;] * price_at_timestamp[x[&quot;Coin&quot;]],
+                key=lambda x: (
+                    x[&quot;Change&quot;] if same_assets else x[&quot;Change&quot;] * price_at_timestamp[x[&quot;Coin&quot;]]
+                ),
                 reverse=True,
             )  # noqa: E501
 
</code></pre>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/tests/snapshots/format@expression__lambda.py.snap</code>:395 on 2023-11-03 08:20</div>
            <div class="timeline-body"><p>Undecided if this looked better before.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/tests/snapshots/format@expression__lambda.py.snap</code>:953 on 2023-11-03 08:21</div>
            <div class="timeline-body"><p>This seems better to me</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/tests/snapshots/format@expression__lambda.py.snap</code>:983 on 2023-11-03 08:21</div>
            <div class="timeline-body"><p>This adds parentheses, but I don't mind them</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2023-11-03 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @MichaReiser on 2023-11-03 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/ruff_python_formatter/tests/snapshots/format@expression__lambda.py.snap</code>:691 on 2023-11-03 08:27</div>
            <div class="timeline-body"><p>It looks okay.... Parentheses would make it look so much better</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2023-11-03 08:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-11-03 09:24</div>
            <div class="timeline-body"><p>The main case that is not necessarily better in my view is</p>
<pre><code class="language-diff">index 9855c318be..fd7770eb2e 100644
--- a/django/test/testcases.py
+++ b/django/test/testcases.py
@@ -1470,8 +1470,10 @@ def skipIfDBFeature(*features):
 def skipUnlessDBFeature(*features):
     &quot;&quot;&quot;Skip a test unless a database has all the named features.&quot;&quot;&quot;
     return _deferredSkip(
-        lambda: not all(
-            getattr(connection.features, feature, False) for feature in features
+        lambda: (
+            not all(
+                getattr(connection.features, feature, False) for feature in features
+            )
         ),
</code></pre>
<p>ü§∑</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @MichaReiser on 2023-11-03 09:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @MichaReiser on 2023-11-03 09:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-12-07 04:38</div>
            <div class="timeline-body"><p>Parenthesizing the body is probably less controversial. It might be worth avoiding to parenthesize the body if it has parentheses itself. But parenthesizing the body otherwise fits with the formatting that copilot would choose.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @MichaReiser on 2024-02-29 14:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-04-08 07:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:37:32 UTC
    </footer>
</body>
</html>
