```yaml
number: 6947
title: Remove Comprehension priority
type: pull_request
state: merged
author: MichaReiser
labels:
  - formatter
assignees: []
merged: true
base: main
head: remove-comprehension-priority
created_at: 2023-08-28T17:06:16Z
updated_at: 2023-08-29T06:30:16Z
url: https://github.com/astral-sh/ruff/pull/6947
synced_at: 2026-01-12T02:45:38Z
```

# Remove Comprehension priority

---

_Pull request opened by @MichaReiser on 2023-08-28 17:06_

<!--
Thank you for contributing to Ruff! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

## Summary

This PR removes the `Comprehension` Priority from `can_omit_parentheses` because Black seems to omit parentheses even if there are multiple parentheses. 

I'm not entirely sure why. Or better, I'm not entirely sure what the following checks in Black are for

https://github.com/psf/black/blob/b4dca26c7d93f930bbd5a7b552807370b60d4298/src/black/brackets.py#L266-L283

But I suggest to remove the priority for now and re-introduce the priority when we come across some code that gets formatted incorrectly

<!-- What's the purpose of the change? What does it do, and why? -->

## Test Plan

* I added a new test
* I double checked that it doesn't introduce new regressions in the django project
* It improves the similarity overall

**This PR**

| project      | similarity index |
|--------------|------------------|
| cpython      | 0.76082          |
| **django**       | 0.99902          | 
| **transformers** | 0.99850          |
| **twine**        | 0.99982          |
| typeshed     | 0.99953          |
| **warehouse**    | 0.99648          |
| **zulip**        | 0.99924          |

**Main**

| project      | similarity index |
|--------------|------------------|
| cpython      | 0.76081          |
| django       | 0.99899          |
| transformers | 0.99842          |
| twine        | 0.99929          |
| typeshed     | 0.99953          |
| warehouse    | 0.99646          |
| zulip        | 0.99922          |


<!-- How was it tested? -->


---

_Comment by @MichaReiser on 2023-08-28 17:06_

Current dependencies on/for this PR:
* main
  * **PR #6947** <a href="https://app.graphite.dev/github/pr/astral-sh/ruff/6947" target="_blank"><img src="https://static.graphite.dev/graphite-32x32.svg" alt="Graphite" width="10px" height="10px"/></a>  ðŸ‘ˆ

This comment was auto-generated by [Graphite](https://app.graphite.dev/github/pr/astral-sh/ruff/6947?utm_source=stack-comment).

---

_Label `formatter` added by @MichaReiser on 2023-08-28 17:07_

---

_Review requested from @charliermarsh by @MichaReiser on 2023-08-28 17:07_

---

_@charliermarsh approved on 2023-08-28 17:21_

---

_Merged by @MichaReiser on 2023-08-29 06:30_

---

_Closed by @MichaReiser on 2023-08-29 06:30_

---

_Branch deleted on 2023-08-29 06:30_

---
