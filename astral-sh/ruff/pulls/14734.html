<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[airflow]: extend removed names (AIR302) - astral-sh/ruff #14734</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[airflow]: extend removed names (AIR302)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/14734">#14734</a>
        opened by <a href="https://github.com/Lee-W">@Lee-W</a>
        on 2024-12-02 15:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a></div>
            <div class="timeline-body">

Summary


<p>Airflow 3.0 removes various deprecated functions, members, modules, and other values. They have been deprecated in 2.x, but the removal causes incompatibilities that we want to detect. This PR deprecates the following names.</p>
<ul>
<li>airflow.metrics.validators.AllowListValidator</li>
<li>airflow.metrics.validators.BlockListValidator</li>
<li>airflow.utils.dates.parse_execution_date</li>
<li>airflow.utils.dates.round_time</li>
<li>airflow.utils.dates.scale_time_units</li>
<li>airflow.utils.dates.infer_time_unit</li>
<li>airflow.utils.file.TemporaryDirectory</li>
<li>airflow.utils.file.mkdirs</li>
<li>airflow.www.auth.has_access</li>
<li>airflow.api_connexion.security.requires_access</li>
<li>airflow.utils.dag_cycle_tester.test_cycle</li>
<li>airflow.utils.state.SHUTDOWN</li>
<li>airflow.utils.state.terminating_states</li>
</ul>
<p>The full list of names we will extend <a href="https://github.com/apache/airflow/issues/44556">apache/airflow#44556</a></p>
Test Plan


<p>A test fixture is included in the PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-12-02 15:34</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>‚úÖ ecosystem check detected no linter changes.</p>
Linter (preview)
<p>‚ÑπÔ∏è ecosystem check <strong>detected linter changes</strong>. (+1 -1 violations, +0 -0 fixes in 1 projects; 54 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+1 -1 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --output-format concise --preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/edf3e3376811129a9fad278ae396b3b5644c69d8/performance/src/performance_dags/performance_dag/performance_dag.py#L244">performance/src/performance_dags/performance_dag/performance_dag.py:244:9:</a> AIR302 `schedule_interval` is removed in Airflow 3.0; use `schedule` instead
- <a href="https://github.com/apache/airflow/blob/edf3e3376811129a9fad278ae396b3b5644c69d8/performance/src/performance_dags/performance_dag/performance_dag.py#L244">performance/src/performance_dags/performance_dag/performance_dag.py:244:9:</a> AIR302 `schedule_interval` is removed in Airflow 3.0; use schedule instead
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| AIR302 | 2 | 1 | 1 | 0 | 0 |</p>
</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-12-03 06:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:117 on 2024-12-03 06:37</div>
            <div class="timeline-body"><p>These have replacements (the stdlib <code>tempfile</code>), they should be mentioned.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/uranusjr">@uranusjr</a> reviewed on 2024-12-03 06:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/uranusjr">@uranusjr</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:120 on 2024-12-03 06:39</div>
            <div class="timeline-body"><p>We should mention this can be safely removed (<code>apply_defaults</code> is now unconditionally done). It‚Äôs probably easier if we add a variant to Replacement (called Message maybe) and do</p>
<pre><code>Replacement::Message(message) =&gt; {
    format!(&quot;`{deprecated}` is removed in Airflow 3.0; {message}&quot;)
}
</code></pre>
<p>in <code>impl Violation</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-03 06:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:120 on 2024-12-03 06:47</div>
            <div class="timeline-body"><p>Yep, we&#x27;ll need something similar for AIR303 and AIR304 as well. or we could probably use this for those 2 ü§î</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-03 06:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:117 on 2024-12-03 06:48</div>
            <div class="timeline-body"><p>sure! will do</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-03 14:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:117 on 2024-12-03 14:18</div>
            <div class="timeline-body"><p>this is addressed</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lee-W">@Lee-W</a> reviewed on 2024-12-03 14:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Lee-W">@Lee-W</a> on <code>crates/ruff_linter/src/rules/airflow/rules/removal_in_3.rs</code>:120 on 2024-12-03 14:19</div>
            <div class="timeline-body"><p>This is temporarily removed, but will be added back (probably in the next PR I think?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feat(air302): extend removed names&quot; to &quot;[airflow]: extend removed names (AIR302)&quot; by <a href="https://github.com/Lee-W">@Lee-W</a> on 2024-12-03 14:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/Lee-W">@Lee-W</a> on 2024-12-03 14:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 21:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 21:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 21:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-03 21:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:09:07 UTC
    </footer>
</body>
</html>
