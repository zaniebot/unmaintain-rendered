<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add visitor method for `FStringFormatSpec` - astral-sh/ruff #10006</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add visitor method for <code>FStringFormatSpec</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/10006">#10006</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-02-16 10:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-02-16 10:05</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR adds visitor methods for the <code>FStringFormatSpec</code> node.</p>
<p>Take the following code snippet as an example:</p>
<pre><code class="language-python">f&quot;foo {
    foo
    :.3f
    # comment
}&quot;
</code></pre>
<p>The <code># comment</code> is in a valid position. Now, the formatter attaches it to the last <code>FStringElement</code> in the format spec which could either be literal or expression (it's literal in the above example). Adding an explicit visitor method removes this ambiguity so that the formatter always attaches the comment to the outer <code>FStringFormatSpec</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @dhruvmanila on 2024-02-16 10:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @MichaReiser by @dhruvmanila on 2024-02-16 10:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-02-16 10:07</div>
            <div class="timeline-body"><p>@MichaReiser Oh, I just saw your comment in the f-string PR. I'll put this on hold.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2024-02-16 10:23</div>
            <div class="timeline-body"><!-- generated-comment ecosystem -->

<h2><code>ruff-ecosystem</code> results</h2>
<h3>Linter (stable)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Linter (preview)</h3>
<p>✅ ecosystem check detected no linter changes.</p>
<h3>Formatter (stable)</h3>
<p>✅ ecosystem check detected no format changes.</p>
<h3>Formatter (preview)</h3>
<p>✅ ecosystem check detected no format changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-02-16 11:12</div>
            <div class="timeline-body"><p>I'll put this on hold for now. I'll revisit when sorting out the string nodes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-02-16 11:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @MichaReiser removed by @dhruvmanila on 2024-02-16 11:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 22:58:18 UTC
    </footer>
</body>
</html>
