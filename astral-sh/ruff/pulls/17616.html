<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] change TypeVarInstance to be interned, not tracked - astral-sh/ruff #17616</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] change TypeVarInstance to be interned, not tracked</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ruff/pull/17616">#17616</a>
        opened by <a href="https://github.com/carljm">@carljm</a>
        on 2025-04-24 21:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Tracked structs have some issues with fixpoint iteration in Salsa, and there's not actually any need for this to be tracked, it should be interned like most of our type structs.</p>
<p>The removed comment was probably never correct (in that we could have disambiguated sufficiently), and is definitely not relevant now that <code>TypeVarInstance</code> also holds its <code>Definition</code>.</p>
<h2>Test Plan</h2>
<p>Existing tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @carljm on 2025-04-24 21:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @AlexWaygood by @carljm on 2025-04-24 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @sharkdp by @carljm on 2025-04-24 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @dcreager by @carljm on 2025-04-24 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dcreager">@dcreager</a> approved on 2025-04-24 21:37</div>
            <div class="timeline-body"><p>Hallelujah</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dcreager">@dcreager</a> on 2025-04-24 21:38</div>
            <div class="timeline-body"><p>Failed test looks like it just timed out — is that spurious?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-04-24 21:40</div>
            <div class="timeline-body"><blockquote>
<p>Failed test looks like it just timed out — is that spurious?</p>
</blockquote>
<p>Yeah, we've seen this before -- need to track it down. I don't think it's related to this PR, but I'll trigger a CI re-run to check.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2025-04-24 21:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @carljm on 2025-04-24 21:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-04-24 21:44</div>
            <div class="timeline-body"><!-- generated-comment mypy_primer -->

<h2><code>mypy_primer</code> results</h2>
<p>No ecosystem changes detected ✅</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @carljm on 2025-04-24 21:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2025-04-24 21:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-04-24 21:52</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:11:53 UTC
    </footer>
</body>
</html>
