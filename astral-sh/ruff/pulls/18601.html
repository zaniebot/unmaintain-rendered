<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stabilize `generic-not-last-base-class` (`PYI059`) - astral-sh/ruff #18601</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Stabilize <code>generic-not-last-base-class</code> (<code>PYI059</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/pull/18601">#18601</a>
        opened by <a href="https://github.com/ntBre">@ntBre</a>
        on 2025-06-09 22:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ntBre">@ntBre</a></div>
            <div class="timeline-body">Summary
<p>The tests were already in the right place, I just updated the documentation slightly to reflect the discussion <a href="https://github.com/astral-sh/ruff/pull/18519#issuecomment-2956344254">here</a> and on Discord.</p>
<p>Documentation: https://docs.astral.sh/ruff/rules/generic-not-last-base-class</p>
<p>Tests: https://github.com/astral-sh/ruff/blob/brent/release-0.12.0/crates/ruff_linter/src/rules/flake8_pyi/mod.rs#L51-L52</p>
<p>I considered mentioning the MRO explicitly and linking to <a href="https://docs.python.org/3/howto/mro.html">this</a> but decided that might be a bit too technical for the rule docs.</p>
<p>Now I see that ty links to the <a href="https://docs.python.org/3/glossary.html#term-method-resolution-order">glossary</a>, which would be another option.</p>
Test Plan
<p>Existing tests</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/AlexWaygood">@AlexWaygood</a> by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-09 22:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-09 22:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/github-actions[bot]">@github-actions[bot]</a> on 2025-06-09 22:48</div>
            <div class="timeline-body">

<code>ruff-ecosystem</code> results
Linter (stable)
<p>ℹ️ ecosystem check <strong>detected linter changes</strong>. (+13 -0 violations, +0 -0 fixes in 5 projects; 50 projects unchanged)</p>
<a href="https://github.com/apache/airflow">apache/airflow</a> (+4 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/apache/airflow/blob/2862555044052dc5a10e175f8b96acc1f5ccf057/airflow-core/src/airflow/api_fastapi/auth/managers/base_auth_manager.py#L78">airflow-core/src/airflow/api_fastapi/auth/managers/base_auth_manager.py:78:22:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/apache/airflow/blob/2862555044052dc5a10e175f8b96acc1f5ccf057/airflow-core/src/airflow/api_fastapi/common/exceptions.py#L37">airflow-core/src/airflow/api_fastapi/common/exceptions.py:37:23:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/apache/airflow/blob/2862555044052dc5a10e175f8b96acc1f5ccf057/airflow-core/src/airflow/api_fastapi/core_api/base.py#L52">airflow-core/src/airflow/api_fastapi/core_api/base.py:52:16:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/apache/airflow/blob/2862555044052dc5a10e175f8b96acc1f5ccf057/airflow-core/src/airflow/api_fastapi/core_api/services/public/common.py#L37">airflow-core/src/airflow/api_fastapi/core_api/services/public/common.py:37:18:</a> PYI059 [*] `Generic[]` should always be the last base class
</pre>

</p>

<a href="https://github.com/langchain-ai/langchain">langchain-ai/langchain</a> (+4 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/langchain-ai/langchain/blob/e455fab5d3ca2820db2f49c5511a23b168a441ab/libs/core/langchain_core/output_parsers/base.py#L31">libs/core/langchain_core/output_parsers/base.py:31:26:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/langchain-ai/langchain/blob/e455fab5d3ca2820db2f49c5511a23b168a441ab/libs/core/langchain_core/prompts/base.py#L45">libs/core/langchain_core/prompts/base.py:45:25:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/langchain-ai/langchain/blob/e455fab5d3ca2820db2f49c5511a23b168a441ab/libs/core/langchain_core/runnables/base.py#L111">libs/core/langchain_core/runnables/base.py:111:15:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/langchain-ai/langchain/blob/e455fab5d3ca2820db2f49c5511a23b168a441ab/libs/core/langchain_core/stores.py#L26">libs/core/langchain_core/stores.py:26:16:</a> PYI059 [*] `Generic[]` should always be the last base class
</pre>

</p>

<a href="https://github.com/latchbio/latch">latchbio/latch</a> (+2 -0 violations, +0 -0 fixes)
<p>

<pre>
+ <a href="https://github.com/latchbio/latch/blob/fe0d3801e44c64448f01372f01c9dc6574f805a6/src/latch/types/metadata.py#L440">src/latch/types/metadata.py:440:25:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/latchbio/latch/blob/fe0d3801e44c64448f01372f01c9dc6574f805a6/src/latch/types/metadata.py#L489">src/latch/types/metadata.py:489:24:</a> PYI059 [*] `Generic[]` should always be the last base class
</pre>

</p>

<a href="https://github.com/python/typeshed">python/typeshed</a> (+1 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select E,F,FA,I,PYI,RUF,UP,W</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/python/typeshed/blob/0db0486fe6a0eb6b4ebf1256fe0afe0b95e2dc36/stdlib/asyncio/queues.pyi#L28">stdlib/asyncio/queues.pyi:28:12:</a> PYI059 [*] `Generic[]` should always be the last base class
</pre>

</p>

<a href="https://github.com/zulip/zulip">zulip/zulip</a> (+2 -0 violations, +0 -0 fixes)
<p>
<pre>ruff check --no-cache --exit-zero --ignore RUF9 --no-fix --output-format concise --no-preview --select ALL</pre>
</p>
<p>

<pre>
+ <a href="https://github.com/zulip/zulip/blob/3dc54a10d7cbfb6f6f66a868a31d17ee9e215f53/zerver/lib/notes.py#L12">zerver/lib/notes.py:12:16:</a> PYI059 [*] `Generic[]` should always be the last base class
+ <a href="https://github.com/zulip/zulip/blob/3dc54a10d7cbfb6f6f66a868a31d17ee9e215f53/zerver/lib/queue.py#L35">zerver/lib/queue.py:35:18:</a> PYI059 [*] `Generic[]` should always be the last base class
</pre>

</p>

Changes by rule (1 rules affected)
<p>

<p>| code | total | + violation | - violation | + fix | - fix |
| ---- | ------- | --------- | -------- | ----- | ---- |
| PYI059 | 13 | 13 | 0 | 0 | 0 |</p>
</p>


Linter (preview)
<p>✅ ecosystem check detected no linter changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-10 02:23</div>
            <div class="timeline-body"><p>related: <a href="https://github.com/astral-sh/ruff/issues/18602">astral-sh/ruff#18602</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-06-10 12:21</div>
            <div class="timeline-body"><blockquote>
<p>related: #18602</p>
</blockquote>
<p>IMO I think that probably <em>does</em> block stabilisation, but I agree with you that for now we could just not offer a fix if there are any keyword or variadic arguments, stabilise it after making that change, and open a followup issue to add a fix for classes that have keyword arguments.</p>
<p>Variadic arguments (things like <code>class Foo(*args): ...</code> and <code>class Bar(**args): ...</code>) are rare enough in class definitions that I think it&#x27;s fine for us never to offer a fix for those. But it <em>would</em> be nice to offer a fix for <code>class Foo(Generic[T], Bar, metaclass=ABCMeta): ...</code> at some point.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2025-06-10 12:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/generic_not_last_base_class.rs</code>:17 on 2025-06-10 12:24</div>
            <div class="timeline-body"><p>I think I&#x27;d probably say something like &quot;type checkers may not be able to infer an accurate MRO for for the class, which could lead to unexpected or inaccurate results when they analyze your code&quot;. Linking to the glossary sounds like a great idea!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/ruff_linter/src/rules/flake8_pyi/rules/generic_not_last_base_class.rs</code>:20 on 2025-06-10 14:45</div>
            <div class="timeline-body"><pre><code>///
/// The rule is also applied to stub files, where it won&#x27;t cause issues at
/// runtime. This is because type checkers may not be able to infer an
/// accurate [MRO] for the class, which could lead to unexpected or
/// inaccurate results when they analyze your code.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> approved on 2025-06-10 14:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-10 15:47</div>
            <div class="timeline-body"><p>Closing this in light of the discussion on <a href="https://github.com/astral-sh/ruff/pull/18611">astral-sh/ruff#18611</a> (need to move the fix to unsafe, updating the kwarg handling), but I&#x27;ll copy the docs improvements over there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-10 15:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:15:26 UTC
    </footer>
</body>
</html>
