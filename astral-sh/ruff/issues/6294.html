<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`useless-import-alias` (`PLC0414`) rule contradicts PEP484 - astral-sh/ruff #6294</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>useless-import-alias</code> (<code>PLC0414</code>) rule contradicts PEP484</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6294">#6294</a>
        opened by <a href="https://github.com/DetachHead">@DetachHead</a>
        on 2023-08-03 01:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/DetachHead">@DetachHead</a></div>
            <div class="timeline-body"><pre><code class="language-py">import numpy as numpy
</code></pre>
<p>this means explicit re-export, as mentioned in <a href="https://peps.python.org/pep-0484/">PEP484</a>:</p>
<blockquote>
<p>Modules and variables imported into the stub are not considered exported from the stub unless the import uses the import ... as ... form or the equivalent from ... import ... as ... form. (UPDATE: To clarify, the intention here is that only names imported using the form X as X will be exported, i.e. the name before and after as must be the same.)</p>
</blockquote>
<p>perhaps this rule should be removed, since it contradicts type checking rules</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-08-03 11:01</div>
            <div class="timeline-body"><p>This is only the case for stub files. Ruff takes this into account by only running the rule for non-stub files</p>
<p>See https://github.com/astral-sh/ruff/blob/9f3567dea6f04e9163ab66ad2fc1fafbadb3e790/crates/ruff/src/checkers/ast/analyze/statement.rs#L568-L572 and https://github.com/astral-sh/ruff/blob/9f3567dea6f04e9163ab66ad2fc1fafbadb3e790/crates/ruff/src/checkers/ast/analyze/statement.rs#L888-L892</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-08-03 15:01</div>
            <div class="timeline-body"><p>Hm per https://github.com/microsoft/pyright/blob/ada1ea63e8360fe3bd203bff3b0069c34d142817/docs/typed-libraries.md#library-interface this also applies to non-stub files. I think we've considered turning this rule off in <code>__init__.py</code> files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-03 15:03</div>
            <div class="timeline-body"><p>I feel like this rule shouldnâ€™t exist, those explicit aliases do have semantic meaning now, but itâ€™s a bit strange to remove entirely since it does exist in pylint.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-03 23:51</div>
            <div class="timeline-body"><p>Some projects do have this explicitly enabled (home-assistant, for example).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-08-03 23:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KotlinIsland">@KotlinIsland</a> on 2023-08-04 02:52</div>
            <div class="timeline-body"><blockquote>
<p>I feel like this rule shouldnâ€™t exist</p>
</blockquote>
<p>I agree</p>
<blockquote>
<p>Some projects do have this explicitly enabled (home-assistant, for example).</p>
</blockquote>
<p>They use mypy, but they don't export their types. From the looks of it, they don't use any explicit reexports, perhaps they will at some point. If they do, then they would certainly remove this rule.</p>
<blockquote>
<p>but itâ€™s a bit strange to remove entirely since it does exist in pylint.</p>
</blockquote>
<p>So the rule was invented before this new semantic meaning was introduced, now it seems invalid.</p>
<p>Perhaps if a project were to forgo typing (or just doesn't like the concept of explicit reexport) then this rule would be applicable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-03-25 19:44</div>
            <div class="timeline-body"><p>Ignoring this rule from <code>__init__.py</code> definitely makes sense to me.
Could still be considered a code smell (ie: did you really mean to re-export?) elsewhere. For instance in pywin32 I found a handful of old actual aliases that are no longer relevant after the Python 3 transition, but were accidentally left in.
Maybe such a distinction would make more sense after #1774 / #1256</p>
<p>In the meantime it can be configured as such:</p>
<pre><code class="language-toml">[lint.per-file-ignores]
# Explicit re-exports is fine in __init__.py, still a code smell elsewhere.
&quot;__init__.py&quot; = [&quot;PLC0414&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Hawk777">@Hawk777</a> on 2024-06-07 02:46</div>
            <div class="timeline-body"><p>I agree it would be good to ignore this in <code>__init__.py</code>. It contradicts F401; as far as I know thereâ€™s no non-<code>noqa</code> way to have both F401 and PLC0414 enabled and re-export things from an <code>__init__.py</code> right now, which is quite unfortunate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alicederyn">@alicederyn</a> on 2025-05-07 16:35</div>
            <div class="timeline-body"><p>@Hawk777 Can you not use <code>__all__</code>? e.g.</p>
<pre><code class="language-python">from ._inner_module import thing_to_reexport
__all__ = [&quot;thing_to_reexport&quot;]
</code></pre>
<p>(Though I fully agree with the proposed fix to PLC0414.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Hawk777">@Hawk777</a> on 2025-05-09 16:04</div>
            <div class="timeline-body"><p>@alicederyn Good point; I didnâ€™t try that and unfortunately now, almost a year later, I donâ€™t remember which of my projects I ran into this problem in ðŸ˜†  It may well have worked though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dylwil3 on 2025-06-20 18:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:52 UTC
    </footer>
</body>
</html>
