<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[feature request] Support ignore block of code with noqa - astral-sh/ruff #3711</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[feature request] Support ignore block of code with noqa</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3711">#3711</a>
        opened by <a href="https://github.com/woile">@woile</a>
        on 2023-03-24 07:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/woile">@woile</a> on 2023-03-24 07:25</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>First of all, thank you so much for this tool, it's fantastic ðŸš€ !</p>
<p>I would like to request the possibility to support ignoring a block of code. To my surprise, this is a feature some people have needed as well from flake8, <a href="https://stackoverflow.com/questions/64428794/flake8-disable-linter-only-for-a-block-of-code">see SO question</a>, though it is not supported.</p>
<p>In my current use case, I have a bunch of templates, that are too long, and it becomes cumbersome to add <code>noqa</code> to all of them.</p>
<p>I was wondering if adding something like this would be possible (maybe with a different syntax):</p>
<pre><code class="language-python"># ruff: noqa: on: E501
TEMPLATE = &quot;&quot;&quot;
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque sit amet ligula magna. Nulla ${var1} vehicula leo, eget tincidunt leo pharetra in. Ut egestas felis et vehicula commodo. Aliquam ${var2} placerat tortor sed magna faucibus facilisis ut et mauris. Maecenas vitae sem augue. Cras egestas felis nulla, id porta nisl ${var3} vel
&quot;&quot;&quot;
# ruff: noqa: off: E501
</code></pre>
<h2>Suggested changes</h2>
<ul>
<li>[ ] Add section-level suppression/ignoring of rules (ruff: noqa: on and ruff: noqa: off)</li>
<li>[ ] Add scope-level suppression/ignoring of rules (matches <a href="https://pylint.pycqa.org/en/latest/user_guide/messages/message_control.html#block-disables">pylint block disables</a>)</li>
</ul>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">noqa</span> added by @charliermarsh on 2023-03-24 14:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-24 23:51</div>
            <div class="timeline-body"><p>I'd really like to support something like this. But we may want to couple it with a more holistic redesign of suppression comments. \cc @MichaReiser</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-24 23:51</div>
            <div class="timeline-body"><p>And thank you for the kind words :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/whinee">@whinee</a> on 2023-03-29 01:00</div>
            <div class="timeline-body"><p>Hello, just to add to the already wonderful suggestion, I think also adding a simple and and off switch with just <code># ruff: noqa: on</code> and <code># ruff: noqa: off</code> to completely ignore a block of code would be fantastic!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-03-29 06:00</div>
            <div class="timeline-body"><p>What's your expectation if a file only contains an <code>off</code> comment without a corresponding <code>on</code> comment later in the file?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/whinee">@whinee</a> on 2023-03-29 06:21</div>
            <div class="timeline-body"><p>That the program ignores the lines under that comment.</p>
<p>A markdown linter named <a href="https://github.com/DavidAnson/markdownlint">markdownlint</a> has <a href="https://github.com/DavidAnson/markdownlint#configuration">that option</a> and if I am not mistaken, if there is no <code>enable</code> comment down the line, then the program just ignores all of it.</p>
<p>This program could also have an option to warn the user when an off flag/comment is unterminated (has no corresponding on switch) cuz disabling linting for the rest of the file is not recommended???? I dont knowwwwwwww</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2023-04-18 02:25</div>
            <div class="timeline-body"><p>I'm pretty interested in this one. Obviously pretty new to the project, but I think that the design proposed above makes sense.</p>
<p>@MichaReiser saw you were mentioned above, are we good to move forward on this design? Do we want to support ignoring multiple rules at once?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-04-18 08:55</div>
            <div class="timeline-body"><blockquote>
<p>@MichaReiser saw you were mentioned above, are we good to move forward on this design? Do we want to support ignoring multiple rules at once?</p>
</blockquote>
<p>Technically: I recommend waiting till after #3931 lands because it significantly changes how we handle noqa comments internally.</p>
<p>Regarding the design. I haven't had much time to look into suppression comments, I got sidetracked by figuring out how a setting format could look like in a world where ruff does formatting and linting (and more?).</p>
<p>My personal objective for suppression comments is that we should try to keep it simple. I really like Rust's approach where there's a single way to enable or disable lints: Using <code>allow</code> and <code>deny</code>. The scope is defined by where the attributes are put: In a module -&gt; applies for the whole module, at the top of a function -&gt; applies for the function, at the top of an expression -&gt; applies to the expression. Having a single format keeps things simple and easy to remember. I've had to google ESLint's suppression comment format so many time in the past, got it wrong because I forgot the <code>on</code> comment after disabling a rule for a section, or accidentally deleted the <code>on</code> comment in a refactor :hand_over_mouth: .</p>
<p>I'm not proposing that we need to implement the same semantics but I think its worthwhile to list the use cases with examples on how the new suppression comments should work. Do we support whole file suppression? Do we want to warn about missing <code>on</code> comments after an <code>off</code>. etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2023-04-18 12:59</div>
            <div class="timeline-body"><p>That makes sense. I'll start working on a design/use-cases - since #1054 asks for block/file-scoped <code>noqa</code> directives, closing this issue should also close that one (file-scoped <code>noqa</code>s are already implemented)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2023-04-19 02:58</div>
            <div class="timeline-body"><p>Editing out the design approach I had here to link to the discussion instead: https://github.com/charliermarsh/ruff/discussions/4051</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tekumara">@tekumara</a> on 2023-05-13 11:48</div>
            <div class="timeline-body"><p>FYI - duplicate of #1289</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1289.html">astral-sh/ruff#1289</a> on 2023-05-13 13:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3868.html">astral-sh/ruff#3868</a> on 2023-08-30 18:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/6782.html">astral-sh/ruff#6782</a> on 2023-08-31 06:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adam-grant-hendry">@adam-grant-hendry</a> on 2023-08-31 14:28</div>
            <div class="timeline-body"><p>@woile Thanks for opening this issue!</p>
<p>Per discussion in #3868 , would you please add the following checklist to the beginning of this issue for PR tracking:</p>
<ul>
<li>[ ] Add section-level suppression/ignoring of rules (<code>ruff: noqa: on</code> and <code>ruff: noqa: off</code>)</li>
<li>[ ] Add scope-level suppression/ignoring of rules (matches <a href="https://pylint.pycqa.org/en/latest/user_guide/messages/message_control.html#block-disables"><code>pylint</code> block disables</a>)</li>
</ul>
<p>There are several feature requests to add lint ignoring/suppression capabilities, each with slight variations, and some of the project maintainers have asked to keep track of them here. They may need to be implemented at different times or in several stages, so a checklist would be helpful for tracking to PRs.</p>
<p>Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adam-grant-hendry">@adam-grant-hendry</a> on 2023-08-31 14:45</div>
            <div class="timeline-body"><p>FWIW, I believe suppression for any scope as in <a href="https://pylint.pycqa.org/en/latest/user_guide/messages/message_control.html#block-disables"><code>pylint</code> block disables</a> in addition to section-level suppression (i.e. turning on/off linting) would be wise.</p>
<p>Without knowing the internals, I imagine the former would require reparsing the AST, and thus a significant rewrite. However,</p>
<ul>
<li>it would match existing <code>pylint</code> behavior</li>
<li>Iâ€™m slowly seeing several different feature requests for suppression in different scopes (global level, function level, etc.).</li>
</ul>
<p>Rather than rewrite the source for every kind of scope feature request, this would be done in one change and would likely cover 99% of use cases for most users.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9646.html">astral-sh/ruff#9646</a> on 2024-01-26 16:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flbraun">@flbraun</a> on 2024-02-13 10:14</div>
            <div class="timeline-body"><p>I'd like to emphasize the importance of this feature for ruff's usability. There are some situations where you <em>need</em> more sophisticated rule control, for example this:</p>
<pre><code class="language-python">def get_all(cursor, table_name):
    return cursor.execute(
        '''
        SELECT *
        FROM {table_name};
        '''.format(table_name=table_name)
    )
</code></pre>
<p>ruff rightfully complains that this code contains a possible sql injection (S608). We know that the value of <code>table_name</code> is safe, so we want to disable S608 for that statement.
We can't disable the rule with <code># noqa</code> because the affected line opens a multi-line string, so the only other option we have is to disable it for the entire file. Which is bad, because that would also disable it for any other sql statement in that file.
The only correct solution would be to wrap the entire sql string in an off-on-block or utilizing a <code>disable-next</code> pragma.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2024-02-13 10:16</div>
            <div class="timeline-body"><p>Why don't you pass it as a param like you should? Sorry, but this is a perfectly true positive, even if in THIS particular case it's safe - until someone decides to make <code>cond</code> come from let's say user-provided input. Boom, SQL injection!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smurfix">@smurfix</a> on 2024-02-13 10:28</div>
            <div class="timeline-body"><p>Passing it as a param works in this simple case, but when you build a whole query programmatically â€¦?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flbraun">@flbraun</a> on 2024-02-13 10:34</div>
            <div class="timeline-body"><blockquote>
<p>Why don't you pass it as a param like you should? Sorry, but this is a perfectly true positive, even if in THIS particular case it's safe - until someone decides to make <code>cond</code> come from let's say user-provided input. Boom, SQL injection!</p>
</blockquote>
<p>Sorry, my example was chosen very poorly, I've replaced it with a less frivolous one where you can't get away with parameter-passing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-13 11:03</div>
            <div class="timeline-body"><p>@flbraun I believe your example might be worth raising a separate issue. I would have expected that one of those work, but none of them do.</p>
<pre><code class="language-python">def get_all(cursor, table_name):
    return cursor.execute(
        f'''
        SELECT *
        FROM {table_name};
        '''  # noqa: S608
    ) 

def get_all(cursor, table_name):
    return cursor.execute(
        (
            &quot;&quot;&quot;
        SELECT *
        FROM {table_name};
        &quot;&quot;&quot;  # noqa: S608
        ).format(table_name=table_name)
    )
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kaddkaka">@kaddkaka</a> on 2024-03-20 20:33</div>
            <div class="timeline-body"><p>Is there any ongoing work on this issue?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Xavier-Do">@Xavier-Do</a> on 2024-03-26 15:23</div>
            <div class="timeline-body"><p>We are also waiting for this feature</p>
<p>Our use case is mainly in tests, we like to disable whitespaces rules the time of an assertions, to present a list/tuple/dict as a table, with aligned rows.</p>
<pre><code class="language-python">        self.assertEquals(
            # pylint: disable=bad-whitespace
            report,
            [
                ['Header',              400.00,      1600.00,          100.00],
                ['Other header',         00.00,       600.00,        10000.00],
                ['Some Header',         140.00,         0.00,         1000.00],
                ['',                   1400.00,       600.00,          100.00],
                ['Finally',           10400.00,       600.00,          100.00],
            ]
        )
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Suor">@Suor</a> on 2024-04-27 05:30</div>
            <div class="timeline-body"><p>Maybe instead of <code># ruff: noqa: on</code> and <code>... off</code> simply:</p>
<pre><code class="language-python"># ruff: off
...
# ruff: on

# ruff: off: T201
print()
if ...:
    print(&quot;...&quot;, a, b, c)
...
# ruff: on
</code></pre>
<p>And since we have already <code># ruff: noqa ...</code> to do it file level I would warn about non-paired <code>off</code> with a suggestion of either close it or replace with <code>ruff: noqa: whatever</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pylint-dev/pylint/pulls/9593.html">pylint-dev/pylint#9593</a> on 2024-05-06 09:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Pierre-Sassoulas">@Pierre-Sassoulas</a> on 2024-05-08 13:13</div>
            <div class="timeline-body"><p>I think there's a performance aspect to consider. In pylint the fine grained message control sometime prevented us from bypassing costly processing because checking if a message is disabled or not (on a directory, file, scope, line, node, or token) is costly in itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pymc-labs/pymc-marketing/pulls/431.html">pymc-labs/pymc-marketing#431</a> on 2024-05-27 00:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yyyxam">@yyyxam</a> on 2024-05-28 15:35</div>
            <div class="timeline-body"><p>I stumbled upon another use case where this would be useful:</p>
<p>A line of code causes one error for mypy and one for bandit. Both support inline-comments for ignoring it, but they don't support ignoring code blocks. I can only ignore the error for one of them and have to ignore the whole file for another (not nice). If I used Ruff (with this feature) as a replacement for Bandit, I could ignore the block of code (1 line) and also add the inline ignore comment for mypy.
So it would improve compatibility with mypy (they also have an <a href="https://github.com/python/mypy/issues/6948">ongoing thread</a> about implementing this) and other linters without this feature.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kaddkaka">@kaddkaka</a> on 2024-05-28 16:59</div>
            <div class="timeline-body"><blockquote>
<p>I stumbled upon another use case where this would be useful:</p>
<p>A line of code causes one error for mypy and one for bandit. Both support inline-comments for ignoring it, but they don't support ignoring code blocks. I can only ignore the error for one of them and have to ignore the whole file for another (not nice). If I used Ruff (with this feature) as a replacement for Bandit, I could ignore the block of code (1 line) and also add the inline ignore comment for mypy. So it would improve compatibility with mypy (they also have an <a href="https://github.com/python/mypy/issues/6948">ongoing thread</a> about implementing this) and other linters without this feature.</p>
</blockquote>
<p>Why not just put two inline comments on the same line?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pylint-dev/pylint/issues/9738.html">pylint-dev/pylint#9738</a> on 2024-06-20 07:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12377.html">astral-sh/ruff#12377</a> on 2024-07-18 12:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AntiSol">@AntiSol</a> on 2024-07-26 01:41</div>
            <div class="timeline-body"><p>Just to chime in with my $0.02, I also think a good linter should have the ability to ignore a block</p>
<blockquote>
<p>What's your expectation if a file only contains an <code>off</code> comment without a corresponding <code>on</code> comment later in the file?</p>
</blockquote>
<p>It should ignore the rest of the file (but turn itself back on at the end of the file)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BobVitorBob">@BobVitorBob</a> on 2024-08-23 18:05</div>
            <div class="timeline-body"><p>Another use case for this.</p>
<p>I wanted to leave a comment explaining why I'm turning another rule off, which includes a snippet of a minimal example for a pandas warning. Since it's commented python code, it lights up with <code>ERA001</code>. In order to suppress this, I have to do <code># noqa: ERA001</code> for each line, which is unnecessary imo.</p>
<pre><code># import numpy as np                                                                # noqa: ERA001
# import pandas as pd                                                               # noqa: ERA001
# df = pd.DataFrame({&quot;col1&quot;: [1, 2, 3, &quot;&quot;, 5]}, dtype=object)                       # noqa: ERA001
# print(df)                                                                         # noqa: ERA001
# print(df.dtypes)                                                                  # noqa: ERA001
# df2 = df.replace(&quot;&quot;, 0)                                                           # noqa: ERA001
# print(df2[&quot;col1&quot;])                                                                # noqa: ERA001
# df2.iloc[0, 0] = &quot;a&quot;                                                              # noqa: ERA001
# print(df2[&quot;col1&quot;])                                                                # noqa: ERA001
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AntiSol">@AntiSol</a> on 2024-08-30 05:11</div>
            <div class="timeline-body"><p>Use case:</p>
<pre><code class="language-python">
from a_module import (          # noqa: I001
   # functions                                               
   do_something,                # noqa: I001
   do_something_else,           # noqa: I001

   # variables
   some_module_config_var,      # noqa: I001
   some_other_module_config_var,# noqa: I001
   fifty_more_of_these,         # fifty more noqa: I001

)

</code></pre>
<p>because I wasn't doing that awfulness, and there's no way to disable this rule for a block of code, now my code has no import sorting.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-30 08:06</div>
            <div class="timeline-body"><p>@AntiSol You shouldn't require to specify <code>noqa</code> comment for each line, just one should suffice: https://play.ruff.rs/4c44cfef-9821-4cd6-98fd-6e3187228e68</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AntiSol">@AntiSol</a> on 2024-08-30 08:16</div>
            <div class="timeline-body"><p>@dhruvmanila I actually tried that before posting.</p>
<p>I don't think you're running the checker there? just the formatter? Isort rules are applied by the checker, not the formatter. I don't see any way to run the checker / isort rules there?</p>
<p>You'll note that removing the noqa comment from your example <a href="https://play.ruff.rs/4c44cfef-9821-4cd6-98fd-6e3187228e68?secondary=Format">has no effect on the formatter output</a>
<img src="https://github.com/user-attachments/assets/e924e051-f8d6-4726-9993-ea732cc99498" alt="image" />
Maybe I'm missing something?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-30 08:21</div>
            <div class="timeline-body"><p>Correct me if I'm wrong but I'm assuming that you're trying to ignore the names in that import statement from being sorted, right?</p>
<p>https://github.com/user-attachments/assets/74627bdd-f4a6-4843-9e81-d7709b525ee7</p>
<p>The video shows how to use code actions to apply a fix from the rules in the playground.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AntiSol">@AntiSol</a> on 2024-08-30 10:00</div>
            <div class="timeline-body"><p>that is what I'm trying to do, and that is what I tried before posting. Maybe I got it wrong somehow. I'll try again when I have time.</p>
<p>Aha, thanks... but I assume you're right-clicking in that video? I don't see that context menu, just the regular one
<img src="https://github.com/user-attachments/assets/26c3859d-ff76-4fcd-83ed-44fa35092314" alt="image" />
Which means that there appears to be no way to run the checker in the playground? Might be worth a separate bug report I guess</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-09-02 07:12</div>
            <div class="timeline-body"><blockquote>
<p>Aha, thanks... but I assume you're right-clicking in that video? I don't see that context menu, just the regular one</p>
</blockquote>
<p>No, I'm not right-clicking in the video. I'm just hovering over the squiggly lines and the pop-up will appear and then I'm clicking on the &quot;Quick Fix&quot; action which displays the code actions and then you can select any that's available.</p>
<blockquote>
<p>Which means that there appears to be no way to run the checker in the playground? Might be worth a separate bug report I guess</p>
</blockquote>
<p>The checker runs automatically in the playground every time the content changes, so there's no need to run it manually. It's not a bug, it's a feature :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AntiSol">@AntiSol</a> on 2024-09-02 10:59</div>
            <div class="timeline-body"><p>@dhruvmanila right you are on all counts! And I was also able to confirm that this does indeed solve my issue, so you can just ignore all my comments on this thread. Thank you muchly! :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MilkClouds">@MilkClouds</a> on 2024-11-26 04:07</div>
            <div class="timeline-body"><p>looking forward to this feature..
<img src="https://github.com/user-attachments/assets/27df3f29-9b26-4b2a-b1f9-a318a0b1c208" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daraan">@Daraan</a> on 2025-01-14 09:27</div>
            <div class="timeline-body"><p>Any updates on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/j-adamczyk">@j-adamczyk</a> on 2025-01-20 14:33</div>
            <div class="timeline-body"><p>Any news on this? It would be super useful in chemoinformatics, where I have lists of very long strings (something like regular expressions), and they cannot be made shorter, causing E501 (line length) error. I would like to wrap the entire multiline list in a block to ignore this specific error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tigerhawkvok">@tigerhawkvok</a> on 2025-01-30 21:55</div>
            <div class="timeline-body"><p>I think the scope-level implementation is best as I have essentially the exact same reasoning as https://github.com/astral-sh/ruff/issues/3711#issuecomment-1512712449</p>
<p>IMO, I'd:</p>
<ol>
<li>Change the top-of-the-file style (<code>#ruff: noqa: FOO01</code>) to internally be a scope-level disable, and just add the understanding of other scoping;</li>
<li>add the special command <code>#ruff: noqa: [code] off</code> to disable a scope-level <code>noqa</code> (eg, re-enable the rule) from that point forward;</li>
<li>add a special <code>RUF</code> error message for a top-scope <code>noqa</code> begun after the first code line that was never disabled</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/16766.html">astral-sh/ruff#16766</a> on 2025-03-17 08:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/17198.html">astral-sh/ruff#17198</a> on 2025-04-04 11:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../frappe/frappe/pulls/31933.html">frappe/frappe#31933</a> on 2025-04-14 11:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/17423.html">astral-sh/ruff#17423</a> on 2025-04-16 13:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../hypothesis/h/pulls/9539.html">hypothesis/h#9539</a> on 2025-05-05 17:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alexchandel">@alexchandel</a> on 2025-05-19 15:11</div>
            <div class="timeline-body"><p>Is there a workaround for this?  I sometimes have to disable a lint for a region of code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/18364.html">astral-sh/ruff#18364</a> on 2025-05-29 09:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Baksalyar">@Baksalyar</a> on 2025-06-16 14:56</div>
            <div class="timeline-body"><p>Hi! Just wondering â€” is this still unimplemented, or is it an intentional design decision?
It gets pretty annoying when you need to use something Ruff complains about in some isolated block of code, and the only option is to slap #noqa on every single line. :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Hoernchen">@Hoernchen</a> on 2025-08-14 14:53</div>
            <div class="timeline-body"><p>Yeah this is turning into a problem everwhere because all kinds of packages need special handling/patching and the only sane way is to just skip E402 completely..</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-14 15:00</div>
            <div class="timeline-body"><p>This is on my mind and something I want us to fix in the coming months. I just can't promise you a date yet but we didn't forget about it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @amyreese by @amyreese on 2025-10-07 00:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/21423.html">astral-sh/ruff#21423</a> on 2025-11-16 11:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../opendp/tumult-core/pulls/51.html">opendp/tumult-core#51</a> on 2025-11-16 20:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maltevesper">@maltevesper</a> on 2025-11-19 12:38</div>
            <div class="timeline-body"><p>I have not read the entire discussion, but have not found it in the checklist in the issue.
if you do implement it, it might be nice to think about scopes as well: see i.e. https://gcc.gnu.org/onlinedocs/gcc/Diagnostic-Pragmas.html</p>
<p>https://github.com/astral-sh/ruff/issues/3711#issuecomment-1487991823</p>
<blockquote>
<p>What's your expectation if a file only contains an <code>off</code> comment without a corresponding <code>on</code> comment later in the file?</p>
</blockquote>
<p>If you have implemented scopes, the answer to your previous comment about how to handle an <code>off</code> without a following <code>on</code>, on the implementation side might be simply create implicit per-file scopes. Moreover, if you disable multiple lints for a block of code, you do not have to repeat yourself. Rather than typing out the lint numbers in an off comment and a subsequent on comment you simply pop the scope.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../etiennebacher/jarl/issues/218.html">etiennebacher/jarl#218</a> on 2025-11-29 11:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21623.html">astral-sh/ruff#21623</a> on 2025-12-02 23:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21441.html">astral-sh/ruff#21441</a> on 2025-12-02 23:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21783.html">astral-sh/ruff#21783</a> on 2025-12-04 02:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21884.html">astral-sh/ruff#21884</a> on 2025-12-10 02:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21908.html">astral-sh/ruff#21908</a> on 2025-12-10 23:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-12 01:37</div>
            <div class="timeline-body"><p>For folks interested in testing a new feature in Ruff's preview mode, the 0.14.9 release now supports <a href="https://docs.astral.sh/ruff/linter/#block-level">block level range suppressions</a> when running with <code>--preview</code>:</p>
<pre><code class="language-py"># ruff: disable[E501]
VALUE_1 = &quot;Lorem ipsum dolor sit amet ...&quot;
VALUE_2 = &quot;Lorem ipsum dolor sit amet ...&quot;
VALUE_3 = &quot;Lorem ipsum dolor sit amet ...&quot;
# ruff: enable[E501]
</code></pre>
<p>An upcoming release should include new diagnostics for tracking unused or invalid range suppressions, similar to what is currently available for <code>#noqa</code>.</p>
<p>Let us know if you have any feedback on the new system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smurfix">@smurfix</a> on 2025-12-12 05:35</div>
            <div class="timeline-body"><p>Question:</p>
<blockquote>
<p>An &quot;enable&quot; comment can only be used to terminate a preceding &quot;disable&quot; comment with identical codes.</p>
</blockquote>
<p>Does that mean that</p>
<pre><code># ruff: disable[A,B]
...
# ruff: enable[A]
...
# ruff: enable[B]</code></pre>
<p>(or vice versa) won't work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Xavier-Do">@Xavier-Do</a> on 2025-12-12 07:44</div>
            <div class="timeline-body"><p>This is an amazing feature! ðŸ¥³</p>
<p>It looks like it works fine in most cases but there is a specific one supported by pylint that doesn't work here regarding &quot;implicit range&quot;</p>
<pre><code class="language-python">[
    # ruff: disable[E241]
    {'line_id': 1,              'balance': 1000.0,  'amount': 2000.0},
    {'line_id': 2,              'balance': -1000.0, 'amount': -2000.0},
]
</code></pre>
<p>In this case the disable is ignored. I would expect to only apply on the content of the list</p>
<p>Another small suggestion would be to support rules names instead of code to improve readability</p>
<pre><code class="language-python">def check():
    # ruff: disable[multiple-spaces-after-comma] 
    [
        {'line_id': 1,              'balance': 1000.0,  'amount': 2000.0},
        {'line_id': 2,              'balance': -1000.0, 'amount': -2000.0},
    ]
</code></pre>
<p>In any case the current version is already a game changer and enough for most needs so thanks a lot for adding this to ruff.</p>
<p>EDIT: I wasn't able to make it work by adding preview in the config, looks like it works only using the command line</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-16 18:08</div>
            <div class="timeline-body"><blockquote>
<p>Question:</p>
<blockquote>
<p>An &quot;enable&quot; comment can only be used to terminate a preceding &quot;disable&quot; comment with identical codes.</p>
</blockquote>
<p>Does that mean that</p>
<pre><code># ruff: disable[A,B]
...
# ruff: enable[A]
...
# ruff: enable[B]
</code></pre>
<p>(or vice versa) won't work?</p>
</blockquote>
<p>Correct. We wanted to keep the implementation simpler, and make it easier to reason about which suppression comments were matched or unmatched and what ranges of code they cover.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kaddkaka">@kaddkaka</a> on 2025-12-16 18:12</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Question:</p>
<blockquote>
<p>An &quot;enable&quot; comment can only be used to terminate a preceding &quot;disable&quot; comment with identical codes.</p>
</blockquote>
<p>Does that mean that</p>
<pre><code># ruff: disable[A,B]
...
# ruff: enable[A]
...
# ruff: enable[B]
</code></pre>
<p>(or vice versa) won't work?</p>
</blockquote>
<p>Correct. We wanted to keep the implementation simpler, and make it easier to reason about which suppression comments were matched or unmatched and what ranges of code they cover.</p>
</blockquote>
<p>So one would ha to write something like:</p>
<pre><code class="language-py"># ruff: disable[A]
# ruff: disable[B]
...
# ruff: enable[A]
...
# ruff: enable[B]
</code></pre>
<p>Is this supported?</p>
<pre><code class="language-py"># ruff: disable[E200]
... 
# ruff: disable[E]
...
# ruff: enable[E]
...
# ruff: enable[E200]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-16 18:14</div>
            <div class="timeline-body"><blockquote>
<p>This is an amazing feature! ðŸ¥³</p>
<p>It looks like it works fine in most cases but there is a specific one supported by pylint that doesn't work here regarding &quot;implicit range&quot;</p>
<p>[
# ruff: disable[E241]
{'line_id': 1,              'balance': 1000.0,  'amount': 2000.0},
{'line_id': 2,              'balance': -1000.0, 'amount': -2000.0},
]</p>
<p>In this case the disable is ignored. I would expect to only apply on the content of the list</p>
</blockquote>
<p>I'll try to add a test case for that and see if that's feasible to support. The logic currently depends on Indent/Dedent tokens for tracking blocks/scopes rather than arbitrary indentation on the comments themselves.</p>
<blockquote>
<p>Another small suggestion would be to support rules names instead of code to improve readability</p>
<p>def check():
# ruff: disable[multiple-spaces-after-comma]
[
{'line_id': 1,              'balance': 1000.0,  'amount': 2000.0},
{'line_id': 2,              'balance': -1000.0, 'amount': -2000.0},
]</p>
</blockquote>
<p>I believe this is on our roadmap in general, including for <code>#noqa</code> comments. We want to make sure we have consistency across all suppression comment styles.</p>
<blockquote>
<p>EDIT: I wasn't able to make it work by adding preview in the config, looks like it works only using the command line</p>
</blockquote>
<p>Can you please open an issue for that with a repro?</p>
<blockquote>
<p>In any case the current version is already a game changer and enough for most needs so thanks a lot for adding this to ruff.</p>
</blockquote>
<p>ðŸ’œ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-16 18:17</div>
            <div class="timeline-body"><blockquote>
<p>So one would ha to write something like:</p>
<p>ruff: disable[A]
ruff: disable[B]
...
ruff: enable[A]
...
ruff: enable[B]</p>
</blockquote>
<p>Yes.</p>
<blockquote>
<p>Is this supported?</p>
<p>ruff: disable[E200]
...
ruff: disable[E]
...
ruff: enable[E]
...
ruff: enable[E200]</p>
</blockquote>
<p>No, we only support exact code matches, similar to <code>#noqa</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-17 09:02</div>
            <div class="timeline-body"><p>I think not supporting within expression suppressions is okay. Just suppress the entire statement.</p>
<pre><code class="language-py">[
    # ruff: disable[E241]
    {'line_id': 1,              'balance': 1000.0,  'amount': 2000.0},
    {'line_id': 2,              'balance': -1000.0, 'amount': -2000.0},
]
</code></pre>
<p>It otherwise raises questions whether the following is valid or not</p>
<pre><code class="language-py">[
    {
	    # ruff: disable[E241]
		'line_id': 1,              'balance': 1000.0,  'amount': 2000.0},
	# ruff: enable[E241]
    {'line_id': 2,              'balance': -1000.0, 'amount': -2000.0},
]
</code></pre>
<p>or even without the enable, how far does the suppression go? Is it also supposed to work in f-strings, what about if I put it in front of a binary expression?</p>
<p>I think this is something where a <code>ruff: ignore</code> might be more useful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maltevesper">@maltevesper</a> on 2025-12-17 09:58</div>
            <div class="timeline-body"><p>I get false positives for ERA001: The comment is indistinguishable from defining a variable called <code>ruff</code> with generic typeannotation <code>disable[D102]</code></p>
<pre><code>class Test:
    # ruff: disable[D102]
    def test_method(self):
        pass
</code></pre>
<pre><code>ERA001 Found commented-out code
 --&gt; teste.py:2:5
  |
1 | class Test:
2 |     # ruff: disable[D102]
  |     ^^^^^^^^^^^^^^^^^^^^^
3 |     def test_method(self):
4 |         pass
  |
help: Remove commented-out code
</code></pre>
<p>Also it would be nice, if an enable is missmatched generated an error. I.e.:</p>
<pre><code>class Test:
    # ruff: disable[D102]
    def test_method(self):
        pass

    # ruff: enable[D103]                    &lt;- I would expect to get an error message for this line, since it was not disabled before
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maltevesper">@maltevesper</a> on 2025-12-17 11:54</div>
            <div class="timeline-body"><p>I am excited for the new feature and gave it a bit more thought.
I am wondering if it is better to adjust the ERA001 lint or the syntax. However, I find the current syntax compelling, adding a space after the disable does not help (I am not sure why <code>x : list [int]</code> parses, but it does) and I did not come up with an alternative syntax I like</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-17 11:56</div>
            <div class="timeline-body"><p>I think we should change <code>ERA001</code> to ignore this known false positives</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ulgens">@ulgens</a> on 2025-12-17 12:03</div>
            <div class="timeline-body"><p>+1 for excluding this from ERA001 but I missed why we are expecting ERA001 to handle an unimplemented (yet) feature, isn't it a bit early for that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-17 18:34</div>
            <div class="timeline-body"><blockquote>
<p>+1 for excluding this from ERA001 but I missed why we are expecting ERA001 to handle an unimplemented (yet) feature, isn't it a bit early for that?</p>
</blockquote>
<p>The new suppression system is already implemented and available when running Ruff with <code>--preview</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/22038.html">astral-sh/ruff#22038</a> on 2025-12-17 20:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-17 21:59</div>
            <div class="timeline-body"><blockquote>
<p>Also it would be nice, if an enable is missmatched generated an error. I.e.:</p>
<pre><code>class Test:
    # ruff: disable[D102]
    def test_method(self):
        pass

    # ruff: enable[D103]                    &lt;- I would expect to get an error message for this line, since it was not disabled before
</code></pre>
</blockquote>
<p>That is currently being added in #21908</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/22099.html">astral-sh/ruff#22099</a> on 2025-12-19 21:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:06 UTC
    </footer>
</body>
</html>
