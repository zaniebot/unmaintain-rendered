<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fuzzer support - astral-sh/ruff #3507</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Fuzzer support</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/3507">#3507</a>
        opened by <a href="https://github.com/qarmin">@qarmin</a>
        on 2023-03-14 10:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/qarmin">@qarmin</a> on 2023-03-14 10:48</div>
            <div class="timeline-body"><p>Recently I tried to create simple automatic fuzzer to test project to find crashes/leaks but I got few problems.</p>
<p>Current patch (feel free to take it, fix/modify and create PR) - <a href="https://github.com/charliermarsh/ruff/files/10967369/0002-Ruff-fuzzer.patch.txt">0002-Ruff-fuzzer.patch.txt</a></p>
<ul>
<li><code>lint_stdin</code> is not available from outside of module (<code>pub mod diagnostics;</code> fixes it)</li>
<li>Cannot easy create settings with all available rules enabled - for testing purposes I enabled <code>for_rules</code> constructor for non test builds and I set there random one rule</li>
<li>Looks that <code>lint_stdin</code> finds different problems that default ruff command(probably <code>lint_path</code>).
When testing, after a while(fuzzer need to start to test longer inputs) I see in terminal messages</li>
</ul>
<pre><code>error: Failed to converge after 100 iterations.

This indicates a bug in `ruff`. If you could open an issue at:

    https://github.com/charliermarsh/ruff/issues/new?title=%5BInfinite%20loop%5D

...quoting the contents of `-`, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!
</code></pre>
<p>but when I check file with <code>ruff 256274.py --fix</code>(<a href="https://github.com/charliermarsh/ruff/files/10967634/256274.py.zip">256274.py.zip</a>) command, then I got parse error message</p>
<pre><code>error: Failed to parse pp/256274.py: invalid syntax. Got unexpected token ';' at line 1 column 7
</code></pre>
<p>I already used fuzzer to minimize test case from https://github.com/charliermarsh/ruff/issues/3425, so I can confirm that it works(at least partially)</p>
<p>After applying patch, to run fuzzer you need to run this commands</p>
<pre><code>cargo install cargo-fuzz
cd ruff
cargo +nightly fuzz run fuzz_target_1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3524.html">astral-sh/ruff#3524</a> on 2023-03-14 21:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @charliermarsh on 2023-03-15 02:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3721.html">astral-sh/ruff#3721</a> on 2023-03-26 14:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-08 16:03</div>
            <div class="timeline-body"><p>We added fuzzer support recently (#4822).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-06-08 16:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:08 UTC
    </footer>
</body>
</html>
