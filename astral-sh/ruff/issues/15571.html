<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff is not fixing F401 - astral-sh/ruff #15571</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff is not fixing F401</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/15571">#15571</a>
        opened by <a href="https://github.com/s0undt3ch">@s0undt3ch</a>
        on 2025-01-18 15:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/s0undt3ch">@s0undt3ch</a></div>
            <div class="timeline-body"><p>I remember that ruff used to fix <code>F401</code>, however, it's not in the latest version:</p>
<pre><code>ruff -v check --fix --target-version py311 --select F401 web/pw/aws/__init__.py
[2025-01-18][15:45:53][ruff::resolve][DEBUG] Using configuration file (via parent) at: ~/projects/my-project/.ruff.toml
[2025-01-18][15:45:53][ruff::commands::check][DEBUG] Identified files to lint in: 1.916916ms
[2025-01-18][15:45:53][ruff::diagnostics][DEBUG] Checking: ~/projects/my-project/web/pw/aws/__init__.py
[2025-01-18][15:45:53][ruff_linter::rules::isort::categorize][DEBUG] Categorized 'typing.Set' as Known(StandardLibrary) (KnownStandardLibrary)
[2025-01-18][15:45:53][ruff::commands::check][DEBUG] Checked 1 files in: 374.625µs
web/pw/aws/__init__.py:8:35: F401 `typing.Set` imported but unused
  |
6 | from datetime import datetime, timedelta
7 | from io import BytesIO, StringIO
8 | from typing import TYPE_CHECKING, Set
  |                                   ^^^ F401
9 | from collections.abc import Iterable
  |
  = help: Remove unused import: `typing.Set`

Found 1 error.
</code></pre>
<p>Even if I pass <code>--unsafe-fixes</code>, it still does not fix it.</p>
<pre><code>ruff --version
ruff 0.9.2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @dylwil3 on 2025-01-18 16:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-18 16:07</div>
            <div class="timeline-body"><p>Could you try once more with <code>--preview</code> enabled and let me know what happens? This rule treats <code>__init__.py</code> files a little differently. See <a href="https://docs.astral.sh/ruff/rules/unused-import/#fix-safety">the documentation for the rule</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @dylwil3 on 2025-01-18 16:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/s0undt3ch">@s0undt3ch</a> on 2025-01-19 09:23</div>
            <div class="timeline-body"><pre><code>ruff -v check --fix --target-version py311 --select F401 web/pw/aws/__init__.py --preview
[2025-01-19][09:20:13][ruff::resolve][DEBUG] Using configuration file (via parent) at: ~/projects/my-project/.ruff.toml
[2025-01-19][09:20:13][ruff::commands::check][DEBUG] Identified files to lint in: 6.537958ms
[2025-01-19][09:20:13][ruff::diagnostics][DEBUG] Checking: ~/projects/my-project/web/pw/aws/__init__.py
[2025-01-19][09:20:13][ruff_linter::rules::isort::categorize][DEBUG] Categorized 'typing.Set' as Known(StandardLibrary) (KnownStandardLibrary)
[2025-01-19][09:20:13][ruff::commands::check][DEBUG] Checked 1 files in: 2.462209ms

Fixed 1 error:
- web/pw/aws/__init__.py:
    1 × F401 (unused-import)

Found 1 error (1 fixed, 0 remaining).
</code></pre>
<p><code>--preview</code> did address the problem. Thank You!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @s0undt3ch on 2025-01-19 09:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:01 UTC
    </footer>
</body>
</html>
