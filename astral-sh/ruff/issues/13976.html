<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>add if TYPE_CHECKING section to isort section order - astral-sh/ruff #13976</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>add if TYPE_CHECKING section to isort section order</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13976">#13976</a>
        opened by <a href="https://github.com/fraser-langton">@fraser-langton</a>
        on 2024-10-29 04:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/fraser-langton">@fraser-langton</a> on 2024-10-29 04:42</div>
            <div class="timeline-body"><p>I am not sure if I just can't find the docs, because I expected this to be included in either I (isort) or TCH (flake8-type-checking).</p>
<p>Although no PEP recommends where <code>if TYPE_CHECKING</code> import blocks should go I think it's pretty standard to put after all other imports</p>
<p>eg</p>
<pre><code class="language-python">import os
from typing import TYPE_CHECKING

import pydantic

import my_package

if TYPE_CHECKING:
    from requests import Request
</code></pre>
<p>ie I would expect the default value for <a href="https://docs.astral.sh/ruff/settings/#lint_isort_section-order">[tool.ruff.lint.isort.section-order]</a> to be <code>[&quot;future&quot;, &quot;standard-library&quot;, &quot;first-party&quot;, &quot;local-folder&quot;, &quot;third-party&quot;, &quot;type-checking&quot;]</code></p>
<p>(sorry if this is already included, I cannot find it anywhere)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-29 06:53</div>
            <div class="timeline-body"><p>Hi @fraser-langton</p>
<blockquote>
<p>I think it's pretty standard to put after all other imports</p>
</blockquote>
<p>Could you share some reference suggesting that putting <code>TYPE_CHECKING</code> last is the standard? I did a quick <a href="https://github.com/search?q=from+typing+import+TYPE_CHECKING&amp;type=code">github code search</a> and the samples I found all have the <code>typing</code> imports together with the other standard library imports.</p>
<p>What sorting do you suggest when there are other typing imports besides <code>TYPE_CHECKING</code>, e.g. <code>typing</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2024-10-29 06:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @MichaReiser on 2024-10-29 06:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fraser-langton">@fraser-langton</a> on 2024-10-29 22:52</div>
            <div class="timeline-body"><p>I think maybe I wasn't as clear as I should have been, is mean the <code>if TYPE_CHECKING:</code> block.</p>
<p>For example TCH --fix --unsafe-fixes put them last.</p>
<p>Maybe the isort rules don't have a default, but it would be good to at least configure <a href="https://docs.astral.sh/ruff/settings/#lint_isort_section-order">[tool.ruff.lint.isort.section-order]</a> = <code>[&quot;future&quot;, &quot;standard-library&quot;, &quot;first-party&quot;, &quot;local-folder&quot;, &quot;third-party&quot;, &quot;type-checking&quot;]</code> - maybe <code>if-type-checking</code> is a clearer section name</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-10-30 03:19</div>
            <div class="timeline-body"><blockquote>
<p>For example TCH --fix --unsafe-fixes put them last.</p>
</blockquote>
<p>I think this only happens when the rules autofix would introduce a <code>TYPE_CHECKING</code> block like <code>TCH001-003</code>.</p>
<p>Is the feature request to allow configuring the position of this insertion of <code>TYPE_CHECKING</code> block?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fraser-langton">@fraser-langton</a> on 2024-10-30 03:23</div>
            <div class="timeline-body"><p>@dhruvmanila not inserting it, configure how it should be sorted in <a href="https://docs.astral.sh/ruff/settings/#lint_isort_section-order">[tool.ruff.lint.isort.section-order]</a> - ie so it must always be after all imports if you want</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "add type checking to isort section order" to "add if TYPE_CHECKING section to isort section order" by @fraser-langton on 2024-10-30 03:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-30 06:18</div>
            <div class="timeline-body"><p>I don't think this should be part of <code>isort</code>. <code>isort</code> is only concerned with sorting imports and what I understand is that you want to configure the position of the <code>if TYPE_CHECKING</code> block.</p>
<p>I'm open to iterating on the <code>TCH</code> fix to placing the <code>TYPE_CHECKING</code> block directly after all imports, if it is safe to do so.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> removed by @MichaReiser on 2024-10-30 06:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2024-10-30 06:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-10-30 06:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">typing</span> added by @MichaReiser on 2024-10-30 06:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daverball">@Daverball</a> on 2024-10-30 07:15</div>
            <div class="timeline-body"><p>There is a particular style I use for typing imports I would like to enforce that has always stopped me from enabling isort and it's somewhat related to this request. I generally use the following style:</p>
<pre><code class="language-python">from decimal import Decimal

from third_party import Foo

from my_module import Bar


from typing import Any
from typing import TYPE_CHECKING
if TYPE_CHECKING:
    from collections.abc import Sequence
    from typing_extensions import Self

    from typing_only_third_party import FooType

    from my_typing_only import BarType
</code></pre>
<p>i.e. the typing imports are all grouped together with the first <code>if TYPE_CHECKING</code> block and separated by two spaces from the other sections to clearly show which part of the import block is relevant for runtime and which part is only used for type hints.</p>
<p>So adding the ability to define some more complex layouts like this one would be appreciated, but it would likely involve having to switch to a template string for defining the layout of the sections and some smart logic for collapsing white space between missing sections and allowing the sections within an <code>if TYPE_CHECKING:</code> block to be different. Note how in my example <code>typing</code> and <code>typing_extensions</code> are in their own section in runtime scope but are folded into <code>standard-library</code> within typing only scope.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kdebrab">@kdebrab</a> on 2024-10-31 07:20</div>
            <div class="timeline-body"><p>It was unexpected to me, that, e.g., the following order is not flagged by isort (or any other rule like TCH or E402):</p>
<pre><code class="language-python">import os
from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from my_package import my_function

import pydantic

import my_package
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-11-03 17:27</div>
            <div class="timeline-body"><p>Looking at this from a different angle: Could this be related to <code>E402</code> instead ? &quot;Module level import not at top of file&quot; could trigger for imports found after top-level <code>if TYPE_CHECKING</code> blocks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fraser-langton">@fraser-langton</a> on 2024-11-06 22:26</div>
            <div class="timeline-body"><p>@MichaReiser</p>
<blockquote>
<p>I don't think this should be part of <code>isort</code>. <code>isort</code> is only concerned with sorting imports and what I understand is that you want to configure the position of the <code>if TYPE_CHECKING</code> block.</p>
</blockquote>
<p>I agree with this, probably not in isort as you really only want it to be last (ie you wouldn't configure something like <code>[&quot;future&quot;, &quot;standard-library&quot;, &quot;first-party&quot;, &quot;type-checking&quot;, &quot;local-folder&quot;, &quot;third-party&quot;]</code></p>
<blockquote>
<p>I'm open to iterating on the <code>TCH</code> fix to placing the <code>TYPE_CHECKING</code> block directly after all imports, if it is safe to do so.</p>
</blockquote>
<p><code>TCH</code> does make a lot of sense to me, as it already inserts a <code>TYPE_CHECKING</code> block after all imports.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fraser-langton">@fraser-langton</a> on 2024-12-12 03:19</div>
            <div class="timeline-body"><p>@MichaReiser have you had any other thoughts regarding this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Sxderp">@Sxderp</a> on 2025-01-27 15:31</div>
            <div class="timeline-body"><p>Yeah, I would also like TYPE_CHECKING to be at the end.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/21132.html">astral-sh/ruff#21132</a> on 2025-10-30 04:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:15 UTC
    </footer>
</body>
</html>
