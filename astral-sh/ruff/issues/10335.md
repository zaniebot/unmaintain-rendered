```yaml
number: 10335
title: C413 fix for reversed(sorted(..., reverse=...)) needs parentheses when key is a boolop to avoid changing semantics
type: issue
state: closed
author: jakkdl
labels:
  - bug
  - fixes
  - help wanted
assignees: []
created_at: 2024-03-11T11:17:53Z
updated_at: 2024-03-11T22:20:56Z
url: https://github.com/astral-sh/ruff/issues/10335
synced_at: 2026-01-10T01:56:51Z
```

# C413 fix for reversed(sorted(..., reverse=...)) needs parentheses when key is a boolop to avoid changing semantics

---

_Issue opened by @jakkdl on 2024-03-11 11:17_

```python
reversed(sorted([1, 2, 3], reverse=False or True)) # reverses twice -> 1, 2, 3
# ruff C413 autofixes the above line to the below
sorted([1, 2, 3], reverse=not False or True) # reverses once -> 3, 2, 1
# if a paren were to be added, the problem is resolved
sorted([1, 2, 3], reverse=not (False or True)) # doesn't reverse -> 1, 2, 3
```
Due to https://docs.python.org/3/reference/expressions.html#operator-precedence
This affects boolean operators and if-expr's. Higher-precedented operators won't need parens added, walruses need to be wrapped in parens in the original statement, and lambda's are invalid in this context.

command invocation & version
```bash
$ ruff check --select=C413 --fix --unsafe-fixes --isolated - <<< 'reversed(sorted([1, 2, 3], reverse=True if True else False))' 
sorted([1, 2, 3], reverse=not True if True else False)
Found 1 error (1 fixed, 0 remaining).
$ ruff --version
ruff 0.3.2
```

---

_Referenced in [Zac-HD/shed#105](../../Zac-HD/shed/pulls/105.md) on 2024-03-11 11:19_

---

_Label `fixes` added by @AlexWaygood on 2024-03-11 11:19_

---

_Label `bug` added by @AlexWaygood on 2024-03-11 11:20_

---

_Label `help wanted` added by @zanieb on 2024-03-11 16:49_

---

_Comment by @zanieb on 2024-03-11 16:50_

Thanks for the report! Your assessment looks right to me and this is notably not the reason this fix is marked as unsafe.

---

_Assigned to @charliermarsh by @charliermarsh on 2024-03-11 20:08_

---

_Referenced in [astral-sh/ruff#10346](../../astral-sh/ruff/pulls/10346.md) on 2024-03-11 21:52_

---

_Closed by @charliermarsh on 2024-03-11 22:20_

---
