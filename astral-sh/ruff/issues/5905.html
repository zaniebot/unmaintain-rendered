<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emit error PTH118 for `os.sep.join()` - astral-sh/ruff #5905</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Emit error PTH118 for <code>os.sep.join()</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5905">#5905</a>
        opened by <a href="https://github.com/dosisod">@dosisod</a>
        on 2023-07-20 06:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dosisod">@dosisod</a></div>
            <div class="timeline-body"><p>The following shows 2 similar snippets of code, but only one is picked up by Ruff currently:</p>
<pre><code class="language-python">import os

os.path.join(&quot;hello&quot;, &quot;world&quot;)   # PTH118
os.sep.join((&quot;hello&quot;, &quot;world&quot;))  # no error
</code></pre>
<p><code>os.sep.join()</code> acts the same as <code>os.path.join()</code>, just written differently. Searching on <a href="https://grep.app/search?q=os.sep.join&amp;filter%5Blang%5D%5B0%5D=Python">grep.app</a> shows that this is a somewhat common idiom.</p>
<p>Running:</p>
<pre><code>$ ruff --version
ruff 0.0.278

$ ruff file.py
file.py:3:1: PTH118 `os.path.join()` should be replaced by `Path` with `/` operator
Found 1 error.
</code></pre>
<p>Expected:</p>
<p>An error for both <code>os.sep.join</code> and <code>os.path.join</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-07-20 08:45</div>
            <div class="timeline-body"><p>I can take this one (also working on some other pathlib ports from refurb)</p>
<p>Nice catch, and also interesting to learn about grep.app. I've been using the GitHub search functionality so far</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-07-20 14:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dosisod">@dosisod</a> on 2023-07-20 18:10</div>
            <div class="timeline-body"><p>I've found that GitHub search doesn't find <em>exactly</em> for what I'm looking for while grep.app does, in addition to providing case-insensitive and regex searching. It's also great for gauging how impactful a new rule might be, and finding potential edge-cases.</p>
<p>And thank you for taking the time to port parts of Refurb into Ruff! I've added a lot of checks since #1348 was opened, and I've been meaning to leave a comment with an updated list but haven't had the time. I'll find some time this weekend to update the list!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-21 00:23</div>
            <div class="timeline-body"><p>Any idea why folks are using <code>os.sep.join</code> in lieu of <code>os.path.join</code>? I just want to make sure there's not a subtle distinction that we're overlooking.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-07-21 00:29</div>
            <div class="timeline-body"><p><code>os.sep.join</code> is a string join on the <code>os.sep</code> character. <code>os.path.join</code> also handles some path logic. <code>os.sep.join</code> may be faster (<a href="https://stackoverflow.com/questions/48701235/why-os-sep-is-faster-than-os-path-join">so</a>)</p>
<p>For the Pathlib rules this shouldn't matter. The overhead of path objects in is neglectable unless it's in a loop (and this is mentioned in our docs in https://github.com/astral-sh/ruff/pull/5815)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-07-21 00:32</div>
            <div class="timeline-body"><p>Just realised that we should also detect the opposite: <code>.split(os.sep)</code> is also <a href="https://grep.app/search?q=.split%28os.sep%29&amp;filter%5Blang%5D%5B0%5D=Python">frequently used</a></p>
<p>This should be a new rule, the requires a combination of <code>Path.name</code> and <code>Path.parent</code>, or <code>Path.parts</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dosisod">@dosisod</a> on 2023-07-21 00:51</div>
            <div class="timeline-body"><p>One thing to note is that <code>os.path.join()</code> will drop falsey arguments, but <code>os.sep.join()</code> won't:</p>
<pre><code class="language-python">&gt;&gt;&gt; import os
&gt;&gt;&gt; os.path.join(&quot;hello&quot;, &quot;world&quot;)
'hello/world'
&gt;&gt;&gt; os.sep.join((&quot;hello&quot;, &quot;&quot;, &quot;world&quot;))
'hello//world'
</code></pre>
<p>This isn't an issue when using it for the <code>Path()</code> constructor, but might be an issue if generalized to all uses of <code>os.path.join()</code>:</p>
<pre><code class="language-python">&gt;&gt;&gt; from pathlib import Path
&gt;&gt;&gt; Path(&quot;hello&quot;, &quot;&quot;, &quot;world&quot;) == Path(&quot;hello&quot;, &quot;world&quot;)
True
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-07-21 01:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:43 UTC
    </footer>
</body>
</html>
