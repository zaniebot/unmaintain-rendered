```yaml
number: 9745
title: Allow newlines after block open (or not)
type: issue
state: closed
author: vaughnkoch
labels:
  - formatter
  - style
assignees: []
created_at: 2024-01-31T17:07:59Z
updated_at: 2025-11-11T13:36:32Z
url: https://github.com/astral-sh/ruff/issues/9745
synced_at: 2026-01-10T01:56:51Z
```

# Allow newlines after block open (or not)

---

_Issue opened by @vaughnkoch on 2024-01-31 17:07_

Hi, I'm opening this issue per a suggestion from @MichaReiser, based on this closed issue: https://github.com/astral-sh/ruff/issues/8893.

The formatting question is whether Ruff should automatically remove a blank line after a block definition:

```
def some_func():

    some_more_code()
```

to 

```
def some_func():
    some_more_code()
```

The alternative is "allow zero or one" newlines, i.e. not to remove the newline if it exists, but also not to automatically add one. This is the approach that Black chose in their 2024 preview style. Full Black discussion here: https://github.com/psf/black/issues/4043.

---

_Label `formatter` added by @MichaReiser on 2024-01-31 17:14_

---

_Label `style` added by @MichaReiser on 2024-01-31 17:14_

---

_Comment by @cbandera on 2024-02-23 12:16_

Yes I can second this request as well. While investigating the transition to ruff, this inconsistency to black is causing many changes across our code base.

---

_Comment by @MichaReiser on 2024-02-23 12:28_

> Yes I can second this request as well. While investigating the transition to ruff, this inconsistency to black is causing many changes across our code base.

Thanks for reporting. Do you mainly mind that there are many differences or did you prefer black's formatting? Would you be able to share some examples where you preferred black's formatting over ruff's?

---

_Comment by @cbandera on 2024-02-23 12:52_

> > Yes I can second this request as well. While investigating the transition to ruff, this inconsistency to black is causing many changes across our code base.
> 
> Thanks for reporting. Do you mainly mind that there are many differences or did you prefer black's formatting? Would you be able to share some examples where you preferred black's formatting over ruff's?

For me it's mainly about the diff that is created. Working in a big monorepo, it's always easier for us toolies to roll out changes if we don't need to touch the other devs code. Having read that `ruff` would be a "drop-in" replacement for `black`, my expectation was that I would see no diff at all.

Having said that and after looking at the [known deviations](https://docs.astral.sh/ruff/formatter/black/) I can't say that I don't agree with ruff's design decisions though...

---

_Referenced in [astral-sh/ruff#8566](../../astral-sh/ruff/issues/8566.md) on 2024-03-18 08:29_

---

_Comment by @chicheng on 2024-03-27 15:27_

Hi, yes please add an option to preserve up to 1 empty line.

As empty lines used for separating/grouping lines, the first line(s) stay closer to block head but not the remaining parts feel like it's part of the block head (since empty line inside block content is inevitable), e.g.

```
block head
   part of block head

   block content
   block content
   block content

   block content
   block content
```

so I prefer to read as

```
block head

   block content
   block content
   block content

   block content
   block content
```

Personally I always insert an empty line at the beginning of the block, except 2 scenarios:

```python
class B(A):

    def single_line(self):    # an empty line after `class B`, because single_line() is not closer to B than other methods
        return something    # Two exceptions that no empty line after `def instance_methods():`: 1. one liner, otherwises a few one lines consecutively will feel strange as there are equal space between block head and content and next block head and content

    def override_super(self):
        super().override_super()    # 2. `super()...` call (easier to tell whether non-one-liner class method called super or not? just personal preference probably)

        remaining_codes = ...

    def function(
        self, data: torch.Tensor | tuple[torch.Tensor, ...], other_argument: int
    ) -> torch.Tensor | tuple[torch.Tensor, ...]:
        something = do_something(data)    # An empty line above please, this line is part of method body, not head. borrowed from black issue comment

        return something
```

---

_Referenced in [astral-sh/ruff#11133](../../astral-sh/ruff/issues/11133.md) on 2024-04-24 17:07_

---

_Comment by @alechouse97 on 2024-05-30 19:13_

Any updates on this? This is one the last remaining issues for ruff to finally replace black in my workflow.

---

_Referenced in [mozilla/pontoon#3248](../../mozilla/pontoon/pulls/3248.md) on 2024-05-31 16:29_

---

_Comment by @michaelhball on 2024-07-11 09:03_

Also checking in to say the same as above, I think this is our last remaining "issue" with ruff.

---

_Comment by @dcnadler on 2024-08-01 20:29_

> Yes I can second this request as well. While investigating the transition to ruff, this inconsistency to black is causing many changes across our code base.

Agreed, this is what's blocking us from adopting Ruff. Too many diffs - not a "drop-in".

Looking forward to updates, thanks!

---

_Referenced in [MESMER-group/mesmer#490](../../MESMER-group/mesmer/pulls/490.md) on 2024-08-08 08:05_

---

_Comment by @thclark on 2024-09-13 14:17_

From the perspective of someone with dyslexia; this really makes code harder to read - I need whitespace around the block to help parse what's in it.

---

_Comment by @plynch-chwy on 2024-10-18 14:23_

I was looking to make the switch to ruff and use the handful of ignored linting rules we use with pre-commit. After a couple of hours I only just found that this is an option I can't ignore or set as `unfixable`? It's kinda unfortunate that this issue is still open for almost a year as I was excited to switch.

---

_Referenced in [astral-sh/ruff#13371](../../astral-sh/ruff/issues/13371.md) on 2024-11-25 16:47_

---

_Comment by @hankertrix on 2024-11-27 05:57_

Second this change. I only adopted black as a formatter after they implemented this change as I find it very difficult to read code without the extra newline. This is especially so when the start of the block is very long, and there's a comment right underneath the block.

For example:
```python
if long_boolean_variable_name and another_long_conditional:
    # A pretty long comment documenting what the block does
    print("Do stuff")
```

I find this to be much easier to read:
```python
if long_boolean_variable_name and another_long_conditional:

    # A pretty long comment documenting what the block does
    print("Do stuff")
```

For formatters in other languages that don't support this extra new line, I use a hack to force a new line:
```javascript
if (long_boolean_variable_name && another_long_conditional) {
    //

    // A pretty long comment documenting what the block does
    console.log("Do stuff")
}
```

Since the Pylsp formatter and black already allow an extra new line, I don't bother doing this hack for my Python code. It would be great to have Ruff support this.

---

_Comment by @laymonage on 2025-02-17 11:17_

Hi, what's the status on this? If I'm not mistaken, Black already made this stable in 2024.

I see that this was discussed for https://github.com/astral-sh/ruff/issues/8678 in #8893. Then it was briefly mentioned in the plans for the 2025 style guide in https://github.com/astral-sh/ruff/issues/13371#issuecomment-2498529767, but it wasn't planned.

We've switched from black to ruff and loving it, but this issue prevents us from formatting Django migrations without the unnecessary noise of removing empty newlines after the `class` header that Black leaves as-is.

---

_Referenced in [wagtail/wagtail#12886](../../wagtail/wagtail/pulls/12886.md) on 2025-02-17 11:45_

---

_Comment by @dduarteo on 2025-02-23 17:23_

Was excited to start moving all of our codebases to ruff but discovered this issue with the blank line after func definitions.  I second that it makes code much easier to read.

Hopefully this gets implemented in the near future!  For now back to black.

---

_Comment by @vitaliyf on 2025-03-03 18:03_

One more datapoint: Django generates migrations/*.py files that look like:

```
class Migration(migrations.Migration):

    dependencies = [
        ...
```

Current black-25.1.0 has no opinion on this (does not add nor remove the line break), but ruff-0.9.9 removes it.

---

_Comment by @hauntsaninja on 2025-03-03 19:12_

We recently switched from black to ruff format at work and this issue caused many thousands of lines of diff, very little of which was an improvement and a lot of which imo hurt readability. This is currently a top 3 upvoted ruff formatter issue, so fingers crossed

---

_Comment by @MichaReiser on 2025-03-04 07:53_

@hauntsaninja could you share some of those examples with me? I'm interested in better understanding the cases that hurt readability. Mainly, if they have something in common (e.g. type annotations, split over multiple lines etc).


---

_Comment by @hauntsaninja on 2025-03-04 08:23_

I think the ones where it most often feels bad to me involve functions with type annotations and no docstring. There are some other cases involving dense if statements, especially nested ones or ones with comments. And a longer tail of more debatable cases, e.g. where it improves symmetry. A few not particularly cherry picked examples here: https://play.ruff.rs/bd268928-cf4e-458a-b41d-a1f163cb6347?secondary=Format

---

_Comment by @MichaReiser on 2025-03-04 09:11_

Thanks. That's helpful. I agree that some of those function definitions are a big wall of text. I do have mixed feelings about the empty blank line because it *cuts* the function definition in half. It makes it less clear to me what belongs together. 

I have to play a bit with those examples to understand why this feels so heavy in Python where the same in other languages seems fine (maybe it's simply because Python doesn't use `{}` as block delimiters). Or it could be that it's just unfortunate that the return type annotation `) -> ` results in a 4 width indent, the same as the function's body. 

---

_Comment by @hauntsaninja on 2025-03-04 22:39_

I'm not sure! In TypeScript and Rust, if your first statement is an assignment, the `let` distinguishes it from function parameters (it's effectively additional indent and syntax highlighting). Whereas in Python with a return type annotation it's a largely undifferentiated mass. I guess return type inference in TypeScript helps too. And I guess kwargs may mean it's more common to have functions with long signatures in Python.

I'm not sure I quite get the thing you mention about cutting, many functions have empty lines in them that aren't at code block open that we don't remove. Function signatures are read more often than function implementations, so visual distinction does at least align with a difference in use. I do agree that removing the blank line feels like a cut for one liners though.

---

_Comment by @shivan2418 on 2025-03-05 20:44_

i have the same problem. 
I was really surprised that you could not change the config the formatter more. I also want my blank lines.

---

_Comment by @grizzlydevil on 2025-04-08 08:02_

I was testing Ruff for our project. It's super quick but the change from black to this is a bit of a deal breaker as people in the project are used to these blank lines they improve readability. Also probably we're used to it. We'll see what others decide. But this change would be very appreciated.

Thank you.

---

_Referenced in [robotframework/robotframework#5387](../../robotframework/robotframework/issues/5387.md) on 2025-04-08 15:19_

---

_Comment by @polsanlorenzo on 2025-04-23 13:49_

Like others here, we were really excited to implement Ruff in our project due to its impressive performance, but this issue is kind of stopping us from making the move. Hopefully, this change gets implemented soon.

---

_Comment by @rynskyi on 2025-05-10 23:29_

Same here - this is the only thing keeping us from switching from back to ruff




---

_Comment by @MichaReiser on 2025-05-13 11:47_

I'm sympathetic to allowing a blank line after function headers. I don't love it because it trades consistency with readability but I think it's a net positive until we can come up with something better.

I'd prefer to keep this specific to functions for now, which seems to be the main concern for most. Or is this incorrect?

I'd be open to reviewing a PR that allows one extra blank line below a function header (in preview)

---

_Comment by @guyboltonking on 2025-05-13 12:26_

> I'd prefer to keep this specific to functions for now, which seems to be the main concern for most. Or is this incorrect?

I think (and know in my case) that it applies to all blocks; I have a lot of code that has blank lines after conditionals, loops, and other constructs.

---

_Comment by @laymonage on 2025-05-13 13:03_

Also, as mentioned in https://github.com/astral-sh/ruff/issues/9745#issuecomment-2662810468 and https://github.com/astral-sh/ruff/issues/9745#issuecomment-2695173158, Django migrations generate classes with a newline after the `class` header. Applying it for classes would allow for switching from black to ruff with less noisy diffs.

---

_Comment by @chrisbune on 2025-05-13 13:20_

> I'd prefer to keep this specific to functions for now, which seems to be the main concern for most. Or is this incorrect?

We mainly would like to have blank lines after class headers. Often after function and method headers. Only very rarely for conditional or loop blocks (neglectable).

---

_Comment by @alechouse97 on 2025-05-13 13:47_

Really excited to see some traction on this! We primarily have blank lines after conditional or loop statements. Classes and functions, etc. usually have docstrings which ruff allows a new line after. 

---

_Comment by @dduarteo on 2025-05-13 14:32_

We are also in the blank line after all blocks of code camp (at least the option as does black).
Excited to see this happen and move all of our stuff to ruff!

---

_Comment by @nonoash on 2025-07-14 16:33_

Bumping this. Same situation as others concerning the improved readability and allowing Blank lines at the start of a block. 

That is the only diff I have with Black and unfortunately prevent me from switching, much to my regret.
I hope Astral will work on their improved heuristic and adopts Black's formatting soon.

Do not forget to upvote OP

---

_Comment by @gagaga67 on 2025-07-17 13:14_

Personally, I don't want a blank line after the block like black does. This behavior is what made me choose ruff.

Why argue about what is best? It is enough to make a setting for this. Then some people will be able to add an empty line, and some will not. But forcing someone to accept one side is not a very good solution.

These are tools that should help in writing code, and not dictate what and how to do.

---

_Referenced in [astral-sh/ruff#15927](../../astral-sh/ruff/issues/15927.md) on 2025-09-17 09:27_

---

_Referenced in [astral-sh/ruff#20482](../../astral-sh/ruff/issues/20482.md) on 2025-09-20 11:12_

---

_Referenced in [Future-House/paper-qa#1141](../../Future-House/paper-qa/pulls/1141.md) on 2025-10-16 19:03_

---

_Referenced in [astral-sh/ruff#21110](../../astral-sh/ruff/pulls/21110.md) on 2025-10-28 16:51_

---

_Comment by @MichaReiser on 2025-11-11 12:36_

@ntBre should we close this now that #21110 has merged. (I'm leaning towards yes to get a better sense in which cases where we should allow empty lines and why)

---

_Closed by @ntBre on 2025-11-11 12:59_

---

_Comment by @laymonage on 2025-11-11 13:24_

@MichaReiser @ntBre What about newlines after class headers? If I'm not mistaken, #21110 only covers functions. This issue covers blocks in general â€“ should a new issue be opened for class headers (and maybe for each header), or should this be reopened?

There's a clear demand for it, at least for classes: #8566, https://github.com/astral-sh/ruff/issues/9745#issuecomment-2023056948, https://github.com/astral-sh/ruff/issues/9745#issuecomment-2662810468, https://github.com/astral-sh/ruff/issues/9745#issuecomment-2695173158, https://github.com/astral-sh/ruff/issues/9745#issuecomment-2876498730.

Just to reiterate, our main use case is for Django migration files. It might be anecdotal but Django has a big user base, so I think it's likely there are other people wanting the same.

---

_Comment by @MichaReiser on 2025-11-11 13:36_

I suggest opening a new issue specifically for class headers so that we get clear feedback on what's most important)

---

_Referenced in [astral-sh/ruff#21380](../../astral-sh/ruff/issues/21380.md) on 2025-11-11 14:44_

---
