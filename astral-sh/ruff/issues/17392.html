<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`ruff check src/` does not respect .gitignore for ignored files - astral-sh/ruff #17392</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>ruff check src/</code> does not respect .gitignore for ignored files</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/17392">#17392</a>
        opened by <a href="https://github.com/klim-neumann">@klim-neumann</a>
        on 2025-04-14 12:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/klim-neumann">@klim-neumann</a></div>
            <div class="timeline-body">Summary
<p>When running <code>ruff check src/foo</code>, Ruff correctly respects .gitignore and skips the <code>_version.py</code> file, which is generated by <a href="https://github.com/ofek/hatch-vcs">hatch-vcs</a> and listed in <code>.gitignore</code>.</p>
<p>However, when running <code>ruff check src/</code>, Ruff stops respecting <code>.gitignore</code> and reports lint issues for the same <code>_version.py</code> file, even though it is still ignored in Git.</p>
<p>This behavior seems inconsistent and may lead to false-positive reports on ignored/generated files.</p>
<p><strong>Reproduction Steps:</strong></p>
<ol>
<li>Create a package <code>foo</code> inside <code>src/</code> with a file <code>src/foo/_version.py</code> (contents below).</li>
<li>Add <code>src/foo/_version.py</code> to <code>.gitignore</code>.</li>
<li>Run:</li>
</ol>
<pre><code>ruff check src/foo --respect-gitignore  # ✅ _version.py is ignored
ruff check src/ --respect-gitignore     # ❌ _version.py is linted
</code></pre>
<p><strong>_version.py</strong></p>
<pre><code># file generated by setuptools-scm
# don&#x27;t change, don&#x27;t track in version control

__all__ = [&quot;__version__&quot;, &quot;__version_tuple__&quot;, &quot;version&quot;, &quot;version_tuple&quot;]

TYPE_CHECKING = False
if TYPE_CHECKING:
    from typing import Tuple
    from typing import Union

    VERSION_TUPLE = Tuple[Union[int, str], ...]
else:
    VERSION_TUPLE = object

version: str
__version__: str
__version_tuple__: VERSION_TUPLE
version_tuple: VERSION_TUPLE

__version__ = version = &#x27;0.0.post1.dev8&#x27;
__version_tuple__ = version_tuple = (0, 0, &#x27;dev8&#x27;)
</code></pre>
<p><strong>pyproject.toml:</strong></p>
<pre><code>[tool.ruff]
respect-gitignore = true

[tool.ruff.lint]
extend-select = [&quot;I&quot;, &quot;INP&quot;, &quot;RUF022&quot;]
</code></pre>
<p><strong>.gitignore:</strong></p>
<pre><code>src/foo/_version.py
</code></pre>
Version
<p>ruff 0.11.5 (7186d5e9a 2025-04-10)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-14 13:08</div>
            <div class="timeline-body"><p>Thank you for the nice writeup! I think this is a duplicate of, or at least closely related to, #13692. However, the point about checking <code>src/foo</code> might be a new piece of evidence. The comments I saw in the other issue tested commands like <code>ruff check .</code> and <code>ruff check src</code> only, so it may work properly when selecting a full path to a directory <em>or</em> no directory/running at the project root, making the problem with partial paths.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-14 13:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-14 13:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-31 17:55</div>
            <div class="timeline-body"><p>I think this was a duplicate of #13692 after all and has now also been resolved! I tested out the example and reproduced the issue on 0.14.2:</p>
<pre><code>$ tree
.
├── pyproject.toml
└── src
    └── foo
        └── _version.py

3 directories, 2 files
$ uvx ruff@0.14.2 check src/foo --respect-gitignore
warning: No Python files found under the given path(s)
All checks passed!
$ uvx ruff@0.14.2 check src/ --respect-gitignore
INP001 File `src/foo/_version.py` is part of an implicit namespace package. Add an `__init__.py`.
# ...

Found 2 errors.
[*] 1 fixable with the `--fix` option.
</code></pre>
<p>and confirmed that it was fixed in 0.14.3 after upgrading our <code>ignore</code> dependency:</p>
<pre><code>$ uvx ruff@0.14.3 check src/foo --respect-gitignore
warning: No Python files found under the given path(s)
All checks passed!
$ uvx ruff@0.14.3 check src/ --respect-gitignore
warning: No Python files found under the given path(s)
All checks passed!
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-31 17:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:49:49 UTC
    </footer>
</body>
</html>
