<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] Support `@typing.overload` and overloaded callable types - astral-sh/ruff #15383</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] Support `@typing.overload` and overloaded callable types</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/15383">#15383</a>
        opened by <a href="https://github.com/carljm">@carljm</a>
        on 2025-01-09 18:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/carljm">@carljm</a> on 2025-01-09 18:55</div>
            <div class="timeline-body"><p>This is a tracking issue to add support for <code>@typing.overload</code> callables.</p>
<p>Reference spec: https://typing.python.org/en/latest/spec/overload.html</p>
<h3>Work items</h3>
<ul>
<li>[x] Represent overloaded callables (functions, methods, etc.) in the type system (https://github.com/astral-sh/ruff/pull/17366)</li>
<li>[x] Check assignability / consistent subtyping between overloaded callable and other (possibly overloaded) callable types (https://github.com/astral-sh/ruff/pull/17366)</li>
<li>[ ] Implement other relation methods for overloaded definitions<ul>
<li>[x] Equivalence (https://github.com/astral-sh/ruff/pull/17698)</li>
<li>[x] https://github.com/astral-sh/ty/issues/105</li>
</ul>
</li>
<li>[x] astral-sh/ty#104<ul>
<li>[x] Try: handle call semantics to overloaded functions as intersection of callables (https://github.com/astral-sh/ruff/pull/17618)</li>
</ul>
</li>
<li>[x] astral-sh/ruff#17779</li>
<li>[ ] ~Update property tests to generate overloaded callables, if possible~ (refer to https://github.com/astral-sh/ruff/issues/15383#issuecomment-2845705716)</li>
<li>[ ] Raise diagnostic for invalid overloaded definitions<ul>
<li>[x] If there are &lt; 2 overloaded definitions (https://github.com/astral-sh/ruff/pull/17609)</li>
<li>[x] If there is no implementation except in in stub files, protocols, and abstract methods within abstract base classes (https://github.com/astral-sh/ruff/pull/17681)</li>
<li>[ ] https://github.com/astral-sh/ty/issues/103</li>
<li>[ ] https://github.com/astral-sh/ty/issues/109</li>
<li>[x] (<em>Low priority</em>) Decorator consistency between overloads and implementation (https://github.com/astral-sh/ruff/pull/17684)</li>
</ul>
</li>
<li>[ ] ~Check if any of the <a href="https://github.com/astral-sh/ruff/blob/44ad2012622d73373eb7922978f391eb6c1e54fa/crates/red_knot_python_semantic/src/types.rs#L3144-L3144">special cased overloaded signatures</a> can be removed~ (refer to https://github.com/astral-sh/ruff/issues/15383#issuecomment-2845705716)</li>
<li>[x] https://github.com/astral-sh/ty/issues/73<ul>
<li>[ ] How to display overloaded signatures in <code>reveal_type</code>, hover, etc.? (See: https://github.com/astral-sh/ty/issues/102)</li>
</ul>
</li>
<li>[ ] ~Update goto definition for overloads to go to either the matched signature or the implementation~</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @carljm on 2025-01-09 18:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Red Knot Q1 2025" by @carljm on 2025-01-09 18:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @dhruvmanila by @dhruvmanila on 2025-03-07 15:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Red Knot Q1 2025" by @carljm on 2025-03-27 18:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Red Knot Alpha" by @carljm on 2025-03-27 18:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[red-knot] support @typing.overload and overloaded callable types" to "[red-knot] Support `@typing.overload` and overloaded callable types" by @dhruvmanila on 2025-04-04 14:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/17366.html">astral-sh/ruff#17366</a> on 2025-04-17 14:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/17681.html">astral-sh/ruff#17681</a> on 2025-04-28 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/17609.html">astral-sh/ruff#17609</a> on 2025-04-28 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/17684.html">astral-sh/ruff#17684</a> on 2025-04-29 03:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/17698.html">astral-sh/ruff#17698</a> on 2025-04-29 03:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-05-01 20:29</div>
            <div class="timeline-body"><p>I've opened individual issues for the remaining tasks for overloads, marking this as complete. The main task which is alpha-worthy is the implementation of the overload call evaluation algorithm but others can be done later on.</p>
<p>I also had a couple of tasks here which I don't think requires a separate issue for the reasons mentioned below.</p>
<blockquote>
<p>Update property tests to generate overloaded callables, if possible</p>
</blockquote>
<p>A simple way to do this would just to be to generate a random number of callables between 2-5 and mark them as overload but not provide an implementation because otherwise the implementation would be required to be consistent with the overloads. My main worry here is the soundness of the overloaded definition. It can very well generate an overlapping overload which might create unsoundness which would then create failures in property tests.</p>
<blockquote>
<p>Check if any of the <a href="https://github.com/astral-sh/ruff/blob/44ad2012622d73373eb7922978f391eb6c1e54fa/crates/red_knot_python_semantic/src/types.rs#L3144-L3144">special cased overloaded signatures</a> can be removed</p>
</blockquote>
<p>I looked at a couple of them and the signatures are different than what's present in the typeshed. I think this is for a reason so I'm dropping this for now and something that could be done on a case-by-case basis in the future when we're at a place where these special cases aren't required.</p>
<p>Happy to hear if others have any comments here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2025-05-01 20:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:14 UTC
    </footer>
</body>
</html>
