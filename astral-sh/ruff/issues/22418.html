<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ENH] Unique blank line after `__all__`? - astral-sh/ruff #22418</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>[ENH] Unique blank line after `__all__`?</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/22418">#22418</a>
        opened by <a href="https://github.com/eliegoudout">@eliegoudout</a>
        on 2026-01-06 16:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/eliegoudout">@eliegoudout</a> on 2026-01-06 16:01</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hello,</p>
<p>I noticed that <code>ruff format</code> does not enforce a number of blank lines after <code>_all_</code> declaration. Indeed, both the following are okay according to <code>ruff</code>:</p>
<pre><code class="language-python">&quot;&quot;&quot;Sample module header with unique blank line.&quot;&quot;&quot;

import __main__

__all__ = [&quot;foo&quot;]

import inspect
from types import MappingProxyType

import numpy as np
</code></pre>
<p>and</p>
<pre><code class="language-python">&quot;&quot;&quot;Sample module header with double blank line.&quot;&quot;&quot;

import __main__

__all__ = [&quot;foo&quot;]


import inspect
from types import MappingProxyType

import numpy as np
</code></pre>
<p>I personally suggest that we enforce only one blank line for header consistency (first example).</p>
<p>Any feedback would be appreciated.</p>
<p>All the best!
Ã‰lie</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @amyreese on 2026-01-06 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2026-01-06 17:41</div>
            <div class="timeline-body"><p>I believe this is expected behavior given the way ruff formatting works with imports.</p>
<p>You can see similar behavior of allowing 1 or 2 blank lines between imports, without an <code>__all__</code> assignment between them:</p>
<pre><code>$ cat foo.py
import thing


import sys

import x as y

$ uvx ruff format --diff foo.py
1 file already formatted
</code></pre>
<p>However, adding a third blank line will cause ruff to normalize that back to two blank lines:</p>
<pre><code>$ cat foo.py
import thing



import sys

import x as y

$ uvx ruff format --diff foo.py
--- foo.py
+++ foo.py
@@ -1,7 +1,6 @@
 import thing


-
 import sys

 import x as y

1 file would be reformatted
&gt; [1]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-07 08:45</div>
            <div class="timeline-body"><p>While this is related to import formatting because the example uses <code>__all__</code> between imports,  it's more about that Ruff doesn't apply any specific blank-line rules for <code>__all__</code>. For example, Ruff leaves the following code unchanged (without adding any blank lines around <code>__all__</code>)</p>
<pre><code class="language-py">&quot;&quot;&quot;Sample module header with unique blank line.&quot;&quot;&quot;

a = 1
__all__ = [&quot;foo&quot;]

b = 2
</code></pre>
<p>There's a tough balance that a formatter has to strike: It must be opinionated enough so that the code style looks consistent but it shouldn't be too opinionated, or many users dislike the style and the tool becomes useless (or less useful) to them. There are multiple open issues requesting less strict blank-line rules in Ruff, and I'm highly empathetic toward them.</p>
<p>I find the blank line rules too strict in general, and we should not introduce any new ones unless they have very strong community support. I don't think this is the case here.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
