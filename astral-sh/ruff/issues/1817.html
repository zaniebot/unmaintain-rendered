<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Namespace packages confuse isort's first party detection - astral-sh/ruff #1817</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Namespace packages confuse isort&#x27;s first party detection</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1817">#1817</a>
        opened by <a href="https://github.com/ashb">@ashb</a>
        on 2023-01-12 13:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ashb">@ashb</a></div>
            <div class="timeline-body"><p>In Airflow we have a namespace package <code>airflow.providers</code> (so we don&#x27;t have <code>airflow/providers/__init__.py</code>) as each of the modules underneath it is released as a separate distribution on pypi. https://github.com/apache/airflow/tree/f1eb2f1af42c537f7c49a891f238083fd5d9e762/airflow/providers</p>
<p>However this causes problems for isort when it comes to processing, for example, <code>airflow/providers/google/cloud/operators/dataproc.py</code> which has these imports in it (slimmed down to illustrate the point):</p>
<pre><code>from google.api_core.exceptions import AlreadyExists, NotFound

from airflow.exceptions import AirflowException
from airflow.models import BaseOperator
</code></pre>
<p>Running with <code>ruff --extend-select=I --verbose airflow/providers/google/cloud/operators/dataproc.py</code> we see that <code>google</code> is being detected as FirstParty (SamePackage). Ooops.</p>
<p>Possible ways of fixing this that I can think of:</p>
<ul>
<li><p>A list known namespace packages:</p>
<pre><code> namespace-packages = [ &quot;airflow.providers&quot; ]
</code></pre>
</li>
<li><p>Have something so that <code>src</code> config setting only looks one level deep, so that we don&#x27;t detect the sub-namepsace packages as top level packages. (I don&#x27;t know quite what this would look like)</p>
</li>
</ul>
<p>Of the two I have a slight preference towards the first as it feels like that is more generic and less Airflow specific.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 14:09</div>
            <div class="timeline-body"><p>Will take a look at this today!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 14:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 14:12</div>
            <div class="timeline-body"><p>As an extremely superficial suggestion, which I’m making from my phone without thinking deeply: as a temporary workaround, could you mark (eg) “google” as known-third-party?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 15:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashb">@ashb</a> on 2023-01-12 15:50</div>
            <div class="timeline-body"><p>Oh I somehow missed that <code>known-third-party</code> was an option. Yes that is a workaround for us for now!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 16:00</div>
            <div class="timeline-body"><p>Okay great. In that case I&#x27;m gonna knock out some other fixes first, but I will return to this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashb">@ashb</a> on 2023-01-13 10:10</div>
            <div class="timeline-body"><p>I&#x27;ve just noticed that mypy has an option that might be useful prior art
https://mypy.readthedocs.io/en/stable/command_line.html#cmdoption-mypy-explicit-package-bases</p>
<blockquote>
<p><code>--explicit-package-bases</code></p>
<p>This flag tells mypy that top-level packages will be based in either the current directory, or a member of the MYPYPATH environment variable or <a href="https://mypy.readthedocs.io/en/stable/config_file.html#confval-mypy_path">mypy_path</a> config option. This option is only useful in in the absence of <strong>init</strong>.py. See <a href="https://mypy.readthedocs.io/en/stable/running_mypy.html#mapping-paths-to-modules">Mapping file paths to modules</a> for details.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-14 02:40</div>
            <div class="timeline-body"><p>(Looking into this now :))</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-14 02:49</div>
            <div class="timeline-body"><p>I don&#x27;t know if this generalizes, but in Airflow&#x27;s case, I could use <code>namespace-packages = [ &quot;airflow.providers&quot; ]</code> to infer that <code>airflow/providers</code> is a package. That way, when we try to find the package root for <code>airflow/providers/google/cloud/operators/dataproc.py</code>, we&#x27;d resolve to <code>airflow</code>, rather than <code>airflow/providers/google</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-14 02:58</div>
            <div class="timeline-body"><p>Looking at the <a href="https://mypy.readthedocs.io/en/stable/running_mypy.html#mapping-paths-to-modules">Mypy docs</a>, we currently do (1):</p>
<p><img src="https://user-images.githubusercontent.com/1309177/212447780-6a85e39e-f433-4b65-a029-187c58ca519b.png" alt="Screen Shot 2023-01-13 at 9 57 57 PM"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-14 03:18</div>
            <div class="timeline-body"><p>I&#x27;ve implemented that logic in tested it in Airflow by running <code>cargo run ../airflow --extend-ignore ALL --extend-select I</code> with these <code>pyproject.toml</code> changes:</p>
<pre><code>diff --git a/pyproject.toml b/pyproject.toml
index aa112f7722..a3d54fdb0d 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -27,6 +27,7 @@ requires = [&#x27;setuptools==63.4.3&#x27;]
 build-backend = &quot;setuptools.build_meta&quot;
 
 [tool.ruff]
+namespace-packages = [&quot;airflow/providers&quot;]
 typing-modules = [&quot;airflow.typing_compat&quot;]
 line-length = 110
 extend-exclude = [
@@ -72,29 +73,29 @@ known-first-party = [&quot;airflow&quot;, &quot;airflow_breeze&quot;, &quot;docker_tests&quot;, &quot;docs&quot;, &quot;kuber
 required-imports = [&quot;from __future__ import annotations&quot;]
 combine-as-imports = true
 
-# TODO: for now, <a href="https://github.com/charliermarsh/ruff/issues/1817">charliermarsh/ruff#1817</a>
-known-third-party = [
-    &quot;asana&quot;,
-    &quot;atlassian&quot;,
-    &quot;celery&quot;,
-    &quot;cloudant&quot;,
-    &quot;databricks&quot;,
-    &quot;datadog&quot;,
-    &quot;docker&quot;,
-    &quot;elasticsearch&quot;,
-    &quot;github&quot;,
-    &quot;google&quot;,
-    &quot;grpc&quot;,
-    &quot;jenkins&quot;,
-    &quot;mysql&quot;,
-    &quot;neo4j&quot;,
-    &quot;papermill&quot;,
-    &quot;redis&quot;,
-    &quot;sendgrid&quot;,
-    &quot;snowflake&quot;,
-    &quot;telegram&quot;,
-    &quot;trino&quot;,
-]
+## TODO: for now, <a href="https://github.com/charliermarsh/ruff/issues/1817">charliermarsh/ruff#1817</a>
+#known-third-party = [
+#    &quot;asana&quot;,
+#    &quot;atlassian&quot;,
+#    &quot;celery&quot;,
+#    &quot;cloudant&quot;,
+#    &quot;databricks&quot;,
+#    &quot;datadog&quot;,
+#    &quot;docker&quot;,
+#    &quot;elasticsearch&quot;,
+#    &quot;github&quot;,
+#    &quot;google&quot;,
+#    &quot;grpc&quot;,
+#    &quot;jenkins&quot;,
+#    &quot;mysql&quot;,
+#    &quot;neo4j&quot;,
+#    &quot;papermill&quot;,
+#    &quot;redis&quot;,
+#    &quot;sendgrid&quot;,
+#    &quot;snowflake&quot;,
+#    &quot;telegram&quot;,
+#    &quot;trino&quot;,
+#]
 
 [tool.ruff.per-file-ignores]
 &quot;airflow/models/__init__.py&quot; = [&quot;F401&quot;]
</code></pre>
<p>But I&#x27;m gonna look to you @ashb for feedback before merging.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashb">@ashb</a> on 2023-01-14 09:21</div>
            <div class="timeline-body"><p>Yeah given the various different layouts you have to support being explicit about which packages are namespace ones seems sensible and is good for us</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-14 12:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-21 19:32</div>
            <div class="timeline-body"><p>I have a local branch that would allow you to remove all of your overrides:</p>
<pre><code>--- a/pyproject.toml
+++ b/pyproject.toml
@@ -106,39 +106,13 @@ testpaths = [
 ]

 [tool.ruff.isort]
-known-first-party = [&quot;airflow&quot;, &quot;airflow_breeze&quot;, &quot;docker_tests&quot;, &quot;docs&quot;, &quot;kubernetes_tests&quot;, &quot;tests&quot;]
 required-imports = [&quot;from __future__ import annotations&quot;]
 combine-as-imports = true

-# TODO: for now, <a href="https://github.com/charliermarsh/ruff/issues/1817">charliermarsh/ruff#1817</a>
-known-third-party = [
-    &quot;asana&quot;,
-    &quot;atlassian&quot;,
-    &quot;celery&quot;,
-    &quot;cloudant&quot;,
-    &quot;databricks&quot;,
-    &quot;datadog&quot;,
-    &quot;docker&quot;,
-    &quot;elasticsearch&quot;,
-    &quot;github&quot;,
-    &quot;google&quot;,
-    &quot;grpc&quot;,
-    &quot;jenkins&quot;,
-    &quot;mysql&quot;,
-    &quot;neo4j&quot;,
-    &quot;papermill&quot;,
-    &quot;redis&quot;,
-    &quot;sendgrid&quot;,
-    &quot;snowflake&quot;,
-    &quot;telegram&quot;,
-    &quot;trino&quot;,
-]
-
 [tool.ruff.per-file-ignores]
 &quot;airflow/models/__init__.py&quot; = [&quot;F401&quot;]
 &quot;airflow/models/sqla_models.py&quot; = [&quot;F401&quot;]
</code></pre>
<p>I&#x27;m testing it out on Airflow locally, and it produced the following changes (I think these are all valid):</p>
<pre><code>diff --git a/airflow/__init__.py b/airflow/__init__.py
index d330b9332a..a640ccb2b7 100644
--- a/airflow/__init__.py
+++ b/airflow/__init__.py
@@ -49,8 +49,7 @@ if os.environ.get(&quot;_AIRFLOW_PATCH_GEVENT&quot;):
 # very easily cause import cycles in the conf init/validate code (since downstream code from
 # those functions likely import settings).
 # configuration is therefore initted early here, simply by importing it.
-from airflow import configuration
-from airflow import settings
+from airflow import configuration, settings
 
 __all__ = [&quot;__version__&quot;, &quot;login&quot;, &quot;DAG&quot;, &quot;PY36&quot;, &quot;PY37&quot;, &quot;PY38&quot;, &quot;PY39&quot;, &quot;PY310&quot;, &quot;XComArg&quot;]
 
@@ -126,7 +125,7 @@ if not settings.LAZY_LOAD_PROVIDERS:
 STATICA_HACK = True
 globals()[&quot;kcah_acitats&quot;[::-1].upper()] = False
 if STATICA_HACK:  # pragma: no cover
-    from airflow.models.dag import DAG
-    from airflow.models.xcom_arg import XComArg
     from airflow.exceptions import AirflowException
+    from airflow.models.dag import DAG
     from airflow.models.dataset import Dataset
+    from airflow.models.xcom_arg import XComArg
diff --git a/airflow/providers/apprise/hooks/apprise.py b/airflow/providers/apprise/hooks/apprise.py
index 61548be76a..5ab9e16da9 100644
--- a/airflow/providers/apprise/hooks/apprise.py
+++ b/airflow/providers/apprise/hooks/apprise.py
@@ -21,9 +21,10 @@ import json
 from typing import Any, Iterable
 
 import apprise
-from airflow.hooks.base import BaseHook
 from apprise import AppriseConfig, NotifyFormat, NotifyType
 
+from airflow.hooks.base import BaseHook
+
 
 class AppriseHook(BaseHook):
     &quot;&quot;&quot;
diff --git a/airflow/providers/apprise/notifications/apprise.py b/airflow/providers/apprise/notifications/apprise.py
index cabae9bdca..cf78d68f37 100644
--- a/airflow/providers/apprise/notifications/apprise.py
+++ b/airflow/providers/apprise/notifications/apprise.py
@@ -29,9 +29,10 @@ except ImportError:
         &quot;Failed to import BaseNotifier. This feature is only available in Airflow versions &gt;= 2.6.0&quot;
     )
 
-from airflow.providers.apprise.hooks.apprise import AppriseHook
 from apprise import AppriseConfig, NotifyFormat, NotifyType
 
+from airflow.providers.apprise.hooks.apprise import AppriseHook
+
 
 class AppriseNotifier(BaseNotifier):
     &quot;&quot;&quot;
diff --git a/airflow/providers/openlineage/extractors/base.py b/airflow/providers/openlineage/extractors/base.py
index de84f0f63f..51c9281e56 100644
--- a/airflow/providers/openlineage/extractors/base.py
+++ b/airflow/providers/openlineage/extractors/base.py
@@ -20,11 +20,11 @@ from __future__ import annotations
 from abc import ABC, abstractmethod
 
 from attrs import Factory, define
+from openlineage.client.facet import BaseFacet
+from openlineage.client.run import Dataset
 
 from airflow.utils.log.logging_mixin import LoggingMixin
 from airflow.utils.state import TaskInstanceState
-from openlineage.client.facet import BaseFacet
-from openlineage.client.run import Dataset
 
 
 @define
diff --git a/airflow/providers/openlineage/extractors/bash.py b/airflow/providers/openlineage/extractors/bash.py
index 9d7c40b114..cfb022032e 100644
--- a/airflow/providers/openlineage/extractors/bash.py
+++ b/airflow/providers/openlineage/extractors/bash.py
@@ -17,13 +17,14 @@
 
 from __future__ import annotations
 
+from openlineage.client.facet import SourceCodeJobFacet
+
 from airflow.providers.openlineage.extractors.base import BaseExtractor, OperatorLineage
 from airflow.providers.openlineage.plugins.facets import (
     UnknownOperatorAttributeRunFacet,
     UnknownOperatorInstance,
 )
 from airflow.providers.openlineage.utils.utils import get_filtered_unknown_operator_keys, is_source_enabled
-from openlineage.client.facet import SourceCodeJobFacet
 
 &quot;&quot;&quot;
 :meta private:
diff --git a/airflow/providers/openlineage/extractors/manager.py b/airflow/providers/openlineage/extractors/manager.py
index b22afb5fdc..02a4124840 100644
--- a/airflow/providers/openlineage/extractors/manager.py
+++ b/airflow/providers/openlineage/extractors/manager.py
@@ -173,9 +173,10 @@ class ExtractorManager(LoggingMixin):
 
     @staticmethod
     def convert_to_ol_dataset(obj):
-        from airflow.lineage.entities import Table
         from openlineage.client.run import Dataset
 
+        from airflow.lineage.entities import Table
+
         if isinstance(obj, Dataset):
             return obj
         elif isinstance(obj, Table):
diff --git a/airflow/providers/openlineage/extractors/python.py b/airflow/providers/openlineage/extractors/python.py
index 50d84014fd..017e6488cc 100644
--- a/airflow/providers/openlineage/extractors/python.py
+++ b/airflow/providers/openlineage/extractors/python.py
@@ -20,13 +20,14 @@ from __future__ import annotations
 import inspect
 from typing import Callable
 
+from openlineage.client.facet import SourceCodeJobFacet
+
 from airflow.providers.openlineage.extractors.base import BaseExtractor, OperatorLineage
 from airflow.providers.openlineage.plugins.facets import (
     UnknownOperatorAttributeRunFacet,
     UnknownOperatorInstance,
 )
 from airflow.providers.openlineage.utils.utils import get_filtered_unknown_operator_keys, is_source_enabled
-from openlineage.client.facet import SourceCodeJobFacet
 
 &quot;&quot;&quot;
 :meta private:
diff --git a/airflow/providers/openlineage/plugins/adapter.py b/airflow/providers/openlineage/plugins/adapter.py
index 0e530e5c53..0f19aa0f14 100644
--- a/airflow/providers/openlineage/plugins/adapter.py
+++ b/airflow/providers/openlineage/plugins/adapter.py
@@ -22,12 +22,6 @@ from typing import TYPE_CHECKING
 
 import requests.exceptions
 import yaml
-
-from airflow.configuration import conf
-from airflow.providers.openlineage import __version__ as OPENLINEAGE_PROVIDER_VERSION
-from airflow.providers.openlineage.extractors import OperatorLineage
-from airflow.providers.openlineage.utils.utils import OpenLineageRedactor
-from airflow.utils.log.logging_mixin import LoggingMixin
 from openlineage.client import OpenLineageClient, set_producer
 from openlineage.client.facet import (
     BaseFacet,
@@ -42,6 +36,12 @@ from openlineage.client.facet import (
 )
 from openlineage.client.run import Job, Run, RunEvent, RunState
 
+from airflow.configuration import conf
+from airflow.providers.openlineage import __version__ as OPENLINEAGE_PROVIDER_VERSION
+from airflow.providers.openlineage.extractors import OperatorLineage
+from airflow.providers.openlineage.utils.utils import OpenLineageRedactor
+from airflow.utils.log.logging_mixin import LoggingMixin
+
 if TYPE_CHECKING:
     from airflow.models.dagrun import DagRun
     from airflow.utils.log.secrets_masker import SecretsMasker
diff --git a/airflow/providers/openlineage/plugins/facets.py b/airflow/providers/openlineage/plugins/facets.py
index f73ff1a98b..2c301856f7 100644
--- a/airflow/providers/openlineage/plugins/facets.py
+++ b/airflow/providers/openlineage/plugins/facets.py
@@ -17,7 +17,6 @@
 from __future__ import annotations
 
 from attrs import define
-
 from openlineage.client.facet import BaseFacet
 from openlineage.client.utils import RedactMixin
 
diff --git a/airflow/providers/openlineage/sqlparser.py b/airflow/providers/openlineage/sqlparser.py
index fdf36c94d3..2b18e28d7d 100644
--- a/airflow/providers/openlineage/sqlparser.py
+++ b/airflow/providers/openlineage/sqlparser.py
@@ -20,6 +20,9 @@ from typing import TYPE_CHECKING, Callable
 
 import sqlparse
 from attrs import define
+from openlineage.client.facet import BaseFacet, ExtractionError, ExtractionErrorRunFacet, SqlJobFacet
+from openlineage.client.run import Dataset
+from openlineage.common.sql import DbTableMeta, SqlMeta, parse
 
 from airflow.providers.openlineage.extractors.base import OperatorLineage
 from airflow.providers.openlineage.utils.sql import (
@@ -28,9 +31,6 @@ from airflow.providers.openlineage.utils.sql import (
     get_table_schemas,
 )
 from airflow.typing_compat import TypedDict
-from openlineage.client.facet import BaseFacet, ExtractionError, ExtractionErrorRunFacet, SqlJobFacet
-from openlineage.client.run import Dataset
-from openlineage.common.sql import DbTableMeta, SqlMeta, parse
 
 if TYPE_CHECKING:
     from sqlalchemy.engine import Engine
diff --git a/airflow/providers/openlineage/utils/sql.py b/airflow/providers/openlineage/utils/sql.py
index fe43a25bae..5d2fa80cd6 100644
--- a/airflow/providers/openlineage/utils/sql.py
+++ b/airflow/providers/openlineage/utils/sql.py
@@ -23,10 +23,9 @@ from enum import IntEnum
 from typing import TYPE_CHECKING, Dict, List, Optional
 
 from attrs import define
-from sqlalchemy import Column, MetaData, Table, and_, union_all
-
 from openlineage.client.facet import SchemaDatasetFacet, SchemaField
 from openlineage.client.run import Dataset
+from sqlalchemy import Column, MetaData, Table, and_, union_all
 
 if TYPE_CHECKING:
     from sqlalchemy.engine import Engine
diff --git a/airflow/providers/openlineage/utils/utils.py b/airflow/providers/openlineage/utils/utils.py
index 9d1cab8eca..ca8b559e3a 100644
--- a/airflow/providers/openlineage/utils/utils.py
+++ b/airflow/providers/openlineage/utils/utils.py
@@ -29,6 +29,9 @@ from urllib.parse import parse_qsl, urlencode, urlparse, urlunparse
 import attrs
 from attrs import asdict
 
+# TODO: move this maybe to Airflow&#x27;s logic?
+from openlineage.client.utils import RedactMixin
+
 from airflow.compat.functools import cache
 from airflow.configuration import conf
 from airflow.providers.openlineage.plugins.facets import (
@@ -37,9 +40,6 @@ from airflow.providers.openlineage.plugins.facets import (
 )
 from airflow.utils.log.secrets_masker import Redactable, Redacted, SecretsMasker, should_hide_value_for_key
 
-# TODO: move this maybe to Airflow&#x27;s logic?
-from openlineage.client.utils import RedactMixin
-
 if TYPE_CHECKING:
     from airflow.models import DAG, BaseOperator, Connection, DagRun, TaskInstance
 
diff --git a/dev/breeze/pyproject.toml b/dev/breeze/pyproject.toml
index ca71f72a71..ab30852279 100644
--- a/dev/breeze/pyproject.toml
+++ b/dev/breeze/pyproject.toml
@@ -33,3 +33,7 @@ python_files = [
 testpaths = [
     &quot;tests&quot;,
 ]
+
+[tool.ruff]
+src = [&quot;src&quot;]
+extend = &quot;../../pyproject.toml&quot;
diff --git a/dev/perf/dags/perf_dag_1.py b/dev/perf/dags/perf_dag_1.py
index 5194a33d53..fdf0ba7342 100644
--- a/dev/perf/dags/perf_dag_1.py
+++ b/dev/perf/dags/perf_dag_1.py
@@ -23,7 +23,7 @@ from __future__ import annotations
 import datetime
 
 from airflow.models import DAG
-from airflow.operators.bash_operator import BashOperator
+from airflow.operators.bash import BashOperator
 
 args = {
     &quot;owner&quot;: &quot;airflow&quot;,
diff --git a/pyproject.toml b/pyproject.toml
index bad61144d7..e009667ce8 100644
--- a/pyproject.toml
+++ b/pyproject.toml
@@ -106,39 +106,13 @@ testpaths = [
 ]
 
 [tool.ruff.isort]
-known-first-party = [&quot;airflow&quot;, &quot;airflow_breeze&quot;, &quot;docker_tests&quot;, &quot;docs&quot;, &quot;kubernetes_tests&quot;, &quot;tests&quot;]
 required-imports = [&quot;from __future__ import annotations&quot;]
 combine-as-imports = true
 
-# TODO: for now, <a href="https://github.com/charliermarsh/ruff/issues/1817">charliermarsh/ruff#1817</a>
-known-third-party = [
-    &quot;asana&quot;,
-    &quot;atlassian&quot;,
-    &quot;celery&quot;,
-    &quot;cloudant&quot;,
-    &quot;databricks&quot;,
-    &quot;datadog&quot;,
-    &quot;docker&quot;,
-    &quot;elasticsearch&quot;,
-    &quot;github&quot;,
-    &quot;google&quot;,
-    &quot;grpc&quot;,
-    &quot;jenkins&quot;,
-    &quot;mysql&quot;,
-    &quot;neo4j&quot;,
-    &quot;papermill&quot;,
-    &quot;redis&quot;,
-    &quot;sendgrid&quot;,
-    &quot;snowflake&quot;,
-    &quot;telegram&quot;,
-    &quot;trino&quot;,
-]
-
 [tool.ruff.per-file-ignores]
 &quot;airflow/models/__init__.py&quot; = [&quot;F401&quot;]
 &quot;airflow/models/sqla_models.py&quot; = [&quot;F401&quot;]
 
-
 # The test_python.py is needed because adding __future__.annotations breaks runtime checks that are
 # needed for the test to work
 &quot;tests/decorators/test_python.py&quot; = [&quot;I002&quot;]
diff --git a/tests/core/test_logging_config.py b/tests/core/test_logging_config.py
index 0d8fbbed21..cdd48b19d0 100644
--- a/tests/core/test_logging_config.py
+++ b/tests/core/test_logging_config.py
@@ -264,7 +264,7 @@ class TestLoggingSettings:
         &quot;&quot;&quot;Test if logging can be configured successfully for Azure Blob Storage&quot;&quot;&quot;
         from airflow.config_templates import airflow_local_settings
         from airflow.logging_config import configure_logging
-        from airflow.utils.log.wasb_task_handler import WasbTaskHandler
+        from airflow.providers.microsoft.azure.log.wasb_task_handler import WasbTaskHandler
 
         with conf_vars(
             {
@@ -321,7 +321,7 @@ class TestLoggingSettings:
         &quot;&quot;&quot;Test if logging can be configured successfully with kwargs&quot;&quot;&quot;
         from airflow.config_templates import airflow_local_settings
         from airflow.logging_config import configure_logging
-        from airflow.utils.log.s3_task_handler import S3TaskHandler
+        from airflow.providers.amazon.aws.log.s3_task_handler import S3TaskHandler
 
         with conf_vars(
             {
diff --git a/tests/dags/test_imports.py b/tests/dags/test_imports.py
index 43be6fc08e..706aa3a018 100644
--- a/tests/dags/test_imports.py
+++ b/tests/dags/test_imports.py
@@ -23,17 +23,19 @@
 from __future__ import annotations
 
 # multiline import
-import  \
-        datetime,   \
-enum,time
+import datetime
+import enum
+import time
+
 &quot;&quot;&quot;
 import airflow.in_comment
 &quot;&quot;&quot;
 # from import
-from airflow.utils import file
 # multiline airflow import
-import airflow.decorators, airflow.models\
-, airflow.sensors
+import airflow.decorators
+import airflow.models
+import airflow.sensors
+from airflow.utils import file
 
 if prod:
     import airflow.if_branch
diff --git a/tests/system/providers/core/example_external_task_parent_deferrable.py b/tests/system/providers/core/example_external_task_parent_deferrable.py
index 7cec2ce138..010286dfdb 100644
--- a/tests/system/providers/core/example_external_task_parent_deferrable.py
+++ b/tests/system/providers/core/example_external_task_parent_deferrable.py
@@ -17,7 +17,7 @@
 from __future__ import annotations
 
 from airflow import DAG
-from airflow.operators.dummy import DummyOperator
+from airflow.operators.empty import EmptyOperator
 from airflow.operators.trigger_dagrun import TriggerDagRunOperator
 from airflow.sensors.external_task import ExternalTaskSensor
 from airflow.utils.timezone import datetime
@@ -29,7 +29,7 @@ with DAG(
     catchup=False,
     tags=[&quot;example&quot;, &quot;async&quot;, &quot;core&quot;],
 ) as dag:
-    start = DummyOperator(task_id=&quot;start&quot;)
+    start = EmptyOperator(task_id=&quot;start&quot;)
 
     # [START howto_external_task_async_sensor]
     external_task_sensor = ExternalTaskSensor(
@@ -53,7 +53,7 @@ with DAG(
         wait_for_completion=True,
     )
 
-    end = DummyOperator(task_id=&quot;end&quot;)
+    end = EmptyOperator(task_id=&quot;end&quot;)
 
     start &gt;&gt; [trigger_child_task, external_task_sensor] &gt;&gt; end
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:29 UTC
    </footer>
</body>
</html>
