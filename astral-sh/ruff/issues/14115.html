<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] Panics on (some) starred expressions in annotations - astral-sh/ruff #14115</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] Panics on (some) starred expressions in annotations</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14115">#14115</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2024-11-05 18:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a></div>
            <div class="timeline-body"><p>Red knot currently panics on some instances of starred expressions (at the outermost layer) of type annotations. An actual example where something like this would occur is in variadic generics (the <code>*Ts</code>):</p>
<pre><code>Ts = TypeVarTuple(&quot;Ts&quot;)

def append_int(*args: *Ts) -&gt; tuple[*Ts, int]: â€¦
</code></pre>
<p>In this particular case, we currently <em>do not</em> panic since we never run deferred inference on that parameter type. But <em>we would</em> panic if we were to implement function parameter inference.</p>
<p>A case which <em>does</em> lead to a panic is the following (invalid syntax) example:</p>
<pre><code>def f() -&gt; *int: ...
f()
</code></pre>
<p>(it&#x27;s important that this occurs as a return type and that the function is actually called; it doesn&#x27;t work otherwise)</p>
<p>A fix for this is already ready at #14106</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2024-11-05 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2024-11-05 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/sharkdp">@sharkdp</a> by <a href="https://github.com/sharkdp">@sharkdp</a> on 2024-11-05 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2024-11-05 19:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:59 UTC
    </footer>
</body>
</html>
