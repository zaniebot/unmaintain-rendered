<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERA001 for decorators - astral-sh/ruff #17374</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ERA001 for decorators</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/17374">#17374</a>
        opened by <a href="https://github.com/amotl">@amotl</a>
        on 2025-04-13 12:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/amotl">@amotl</a> on 2025-04-13 12:39</div>
            <div class="timeline-body"><h3>Question</h3>
<p>Hi there,</p>
<p>CodeRabbit <a href="https://github.com/crate/cratedb-toolkit/pull/399#pullrequestreview-2762750642">just discovered</a> commented-out code which apparently has not been discovered by Ruff? It looks like comment strings starting with <code>@</code> (Python decorators) are not considered &quot;code&quot; by the <code>ERA001</code> rule. Is that intended?</p>
<p>This is a little repro:</p>
<pre><code class="language-python"># @cli.command()
def foo():
    return 42
</code></pre>
<p><img src="https://github.com/user-attachments/assets/e7f7c3f6-cc7f-4ca6-aa62-e955d45ef809" alt="Image" /></p>
<p>With kind regards,
Andreas.</p>
<h3>Version</h3>
<p>ruff 0.11.5 (7186d5e9a 2025-04-10)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @amotl on 2025-04-13 12:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-14 01:36</div>
            <div class="timeline-body"><p>Oh interesting. It looks like the decorator makes it through all of the heuristics for identifying source code and then fails to parse as a python module, which is the very last check in <a href="https://github.com/astral-sh/ruff/blob/67b5cf470eff84272255ca8b6baa64855ba733c0/crates/ruff_linter/src/rules/eradicate/detection.rs#L75"><code>comment_contains_code</code></a>.</p>
<p>This seems consistent with the upstream linter, which also fails to <a href="https://github.com/PyCQA/eradicate/blob/5e9eb212c99afd8734b6f33d9d5b5107d10ed9cd/eradicate.py#L116C13-L116C20"><code>compile</code></a> this line, but we could possibly consider a different approach.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2025-04-22 08:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-04-22 08:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
