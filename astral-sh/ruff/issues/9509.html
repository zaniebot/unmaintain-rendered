<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add a rule for `defaultdict(default_factory=list)` - astral-sh/ruff #9509</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add a rule for `defaultdict(default_factory=list)`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/9509">#9509</a>
        opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a>
        on 2024-01-14 04:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-01-14 04:11</div>
            <div class="timeline-body"><p>Kwargs in the defaultdict constructor are forwarded to the dict constructor, so this creates a defaultdict with <code>{&quot;default_factory&quot;: list}</code>. Since this is a valid call, type checkers may or may not catch this (and even when they catch it, the error might be a little confusing). ruff could lint this specific situation and mention use of <code>collections.defaultdict(list)</code> instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add a rule for `collections.defaultdict(default_factory=list)`" to "Add a rule for `defaultdict(default_factory=list)`" by @hauntsaninja on 2024-01-14 04:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2024-01-14 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @charliermarsh on 2024-01-14 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-14 15:14</div>
            <div class="timeline-body"><p>Seems like a good rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2024-01-14 15:48</div>
            <div class="timeline-body"><p>@hauntsaninja You should also open the issue in the flake8-bugbear repo, they may be interested in it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikeleppane">@mikeleppane</a> on 2024-01-24 18:45</div>
            <div class="timeline-body"><p>I can take this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @mikeleppane by @charliermarsh on 2024-01-24 19:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikeleppane">@mikeleppane</a> on 2024-01-25 21:01</div>
            <div class="timeline-body"><p>@hauntsaninja did you use 'list' as an example or I assume this applies to any callable? I tried default_factory with mypy 1.7.1 and it truly seems to be confused with different input types (list, int, dict, lambda, ...).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-01-25 21:05</div>
            <div class="timeline-body"><p>As an example! :-) Like I said, type checkers can't catch the call itself since it's valid. They may be able to surface an issue later because they'll infer a different type for the defaultdict.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/9651.html">astral-sh/ruff#9651</a> on 2024-01-26 15:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-29 03:58</div>
            <div class="timeline-body"><p>Added in https://github.com/astral-sh/ruff/pull/9651, thanks @mikeleppane!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-29 03:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:52 UTC
    </footer>
</body>
</html>
