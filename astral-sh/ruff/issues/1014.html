<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relative import management - astral-sh/ruff #1014</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Relative import management</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1014">#1014</a>
        opened by <a href="https://github.com/noirbizarre">@noirbizarre</a>
        on 2022-12-03 19:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/noirbizarre">@noirbizarre</a></div>
            <div class="timeline-body"><p>This topic has always been a bit painful to manage with <code>isort</code> or <code>absolufy-imports</code> and given I am migrating all my project to <code>ruff</code> I would love to be able to tune the relative imports ahndling:</p>
<ul>
<li>basic case (the one I use everyday): force relative imports for siblings and children only (with auto-fix support) (ie. <code>..</code> starting imports)</li>
<li>allow parent imports on a package basis: mark a package to be allowed as a relative-root reference by children packages/modules</li>
<li>default: prevent relative</li>
</ul>
<p>Is it something acceptable ?</p>
<p><strong>Note:</strong> I am motivated enough to contribute but not yet skilled enough in Rust to make this happen soon</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-03 21:44</div>
            <div class="timeline-body"><p>Yeah, I think so... Right now, we support the &quot;forbid relative imports of parent modules&quot; rule from <code>flake8-tidy-imports</code>. But adding autofix to that rule would probably mean converting relative to absolute imports (basically points 2 and 3 on your list: prevent relative imports, rewrite them as absolute). So in addition, we'd need a new rule that's basically the inverse: prevent absolute imports in certain cases (with autofix).</p>
<p>Does that sound right?</p>
<p>Is there any tool or combination of tools you use today to enforce this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2022-12-03 22:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/noirbizarre">@noirbizarre</a> on 2022-12-05 20:55</div>
            <div class="timeline-body"><p>I think the autofix should be both ways for case 1:</p>
<ul>
<li>rewrite relative to absolute imports for the forbidden cases</li>
<li>rewrite absolute to relative imports for siblings and children packages</li>
</ul>
<p>For this case I am using <code>absolufy-import</code> with <code>--never</code> option but it is far from perfect and I have a lot of manual fixes to handle.</p>
<p>For case 3: This one should be the default: forbid relative imports and rewrite them as absolute as autofix. This is basically the deault behavior of <code>absolufy-imports</code></p>
<p>Case 2 is bonus to me but I have some cases of child-to-parent dependencies I want to keep relative. The idea it to flag a package as relative-root for its children using <code>by-package</code>  Ruff config syntax and then autofix should:</p>
<ul>
<li>Apply the same autofix as case 1 for siblings</li>
<li>rewrite absolute imports to relative for children referencing this flagged parent (this is the point differing from case 1)</li>
<li>keep/rewrite imports as absolute for those not matching this case</li>
</ul>
<p>I took a look at <code>flake8-tidy-imports</code>: it is very close to the expected behavior but:</p>
<ul>
<li>cannot enforce relative/sibling imports</li>
<li>does not autofix</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2022-12-31 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2022-12-31 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-02-16 08:09</div>
            <div class="timeline-body"><p>Note that <code>flake8-tidy-imports</code> now has partial autofix</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lsorber">@lsorber</a> on 2023-02-24 09:49</div>
            <div class="timeline-body"><p>Which cases are not covered by the <code>flake8-tidy-imports</code> autofix @sbrugman?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/noirbizarre">@noirbizarre</a> on 2023-04-20 10:28</div>
            <div class="timeline-body"><p>I submitted a PR for my missing case as well as a matching one on <code>flake8-tidy-import</code>. I will adapt the PR depending on the review and feedback on the <code>flake8-tidy-import</code> repository.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pawamoy">@pawamoy</a> on 2024-02-05 14:12</div>
            <div class="timeline-body"><p>Sorry if this is not the right place to ask: the docs (https://docs.astral.sh/ruff/rules/relative-imports/) say that</p>
<blockquote>
<p>Fix is sometimes available.</p>
</blockquote>
<p>When is that autofix available exactly? I'm looking at automatically converting relative imports to absolute ones. I have the relevant rule enabled:</p>
<pre><code class="language-toml">[flake8-tidy-imports]
ban-relative-imports = &quot;all&quot;
</code></pre>
<p>Is such an autofix planned/accepted in Ruff?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hynek">@hynek</a> on 2025-03-13 09:40</div>
            <div class="timeline-body"><p>Since this has been quiet here lately ðŸ˜‡: I, too, would love for an option to TID252 that would rewrite sibling imports to relative.</p>
<p>I.e. within a module <code>foo.bar.baz</code>:</p>
<pre><code>from foo.bar.qux import xyz
</code></pre>
<p>becomes</p>
<pre><code>from .qux import xyz
</code></pre>
<p>Given grouping rules, this has a great effect on readability since it's clear what's coming from the current subpackage (very useful with VSA).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/noirbizarre">@noirbizarre</a> on 2025-03-14 22:19</div>
            <div class="timeline-body"><p>I am still willing to contribute this, when I opened this issue I was initially intending to add a TID/I253 on both project, and I did submit a working pull request on both:</p>
<ul>
<li>https://github.com/adamchainz/flake8-tidy-imports/pull/441 for the <code>flake8-tidy-import</code> part, but the maintainer didn't seem OK with it and never answered me on what I should do to have this accepted, or even if it was a possibility</li>
<li>#3986 which was its working ruff counterpart, but was closed because I was waiting for feedback on the <code>flake-tidy-import</code> counterpart, and the <a href="https://github.com/astral-sh/ruff/pull/3986#issuecomment-1771178725">closure comment</a> seems to imply it would be merged only if the upstream is</li>
</ul>
<p>It seems this approach is now out of the scope (I am not willing to insist on <code>flake8-tidy-import</code>) but given a TID253 rule has already been added there without an upstream counterpart, maybe having a TID254 for relative siblings is now acceptable.</p>
<p>I would gladly resubmit an updated version of the PR if this is OK for <code>ruff</code> maintainers, but I need a confirmation before that to avoid submitting a new PR that wouldn't be accepted, and perhaps some guidance on the form it should take:</p>
<ul>
<li>a new <code>ban-relative-imports</code> value <code>relative-siblings</code> acting like <code>parents</code> but force siblings as relative</li>
<li>a new boolean setting <code>force-relative-siblings</code> which requires <code>ban-relative-imports=parents</code></li>
</ul>
<p>In the process, I would gladly add any missing autofixes if any</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/noirbizarre">@noirbizarre</a> on 2025-03-15 23:35</div>
            <div class="timeline-body"><p>I submitted a new pull request https://github.com/astral-sh/ruff/pull/16772 based on the second approach (a new <code>TID254</code> opt-in rule to be enabled with a new <code>relative-sibling-imports</code> setting)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:45:39 UTC
    </footer>
</body>
</html>
