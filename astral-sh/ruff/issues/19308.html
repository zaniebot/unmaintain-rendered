<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add formatter-compatible rule to enforce one-arg-per-line + trailing comma when line-length exceeded - astral-sh/ruff #19308</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add formatter-compatible rule to enforce one-arg-per-line + trailing comma when line-length exceeded</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/19308">#19308</a>
        opened by <a href="https://github.com/zerlok">@zerlok</a>
        on 2025-07-13 12:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zerlok">@zerlok</a> on 2025-07-13 12:51</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><strong>Current limitation</strong>:</p>
<ul>
<li>Ruff formatter reflows function signatures when line-length is exceeded</li>
<li>However, it preserves grouped arguments even when broken across lines</li>
<li>It does <strong>not</strong> insert trailing commas</li>
<li><code>COM812</code> adds trailing commas only if the layout is already multiline</li>
<li>One-arg-per-line layout only occurs <strong>after</strong> trailing comma is inserted</li>
</ul>
<p>This results in a 3-pass cycle to achieve desired layout:</p>
<ol>
<li>Format → break long line</li>
<li>Fix → add comma</li>
<li>Format → apply one-arg-per-line</li>
</ol>
<p><strong>Request</strong>:</p>
<p>Add a rule or formatter enhancement to enforce:</p>
<ul>
<li><p>If function signature exceeds <code>line-length</code></p>
<ul>
<li>Break into multiline</li>
<li>Place one argument per line</li>
<li>Add trailing comma</li>
</ul>
</li>
<li><p>If it does <strong>not</strong> exceed line-length, keep as-is</p>
</li>
</ul>
<p><strong>Goal</strong>:</p>
<p>Allow this transformation to occur in <strong>one pass</strong>, avoiding chained invocations and repeated file watcher triggers.</p>
<p><strong>Benefit</strong>:</p>
<p>Cleaner formatting, aligned with Black-like behavior but under Ruff’s control, and better editor automation compatibility.</p>
<p><strong>Example</strong>:</p>
<pre><code class="language-python"># Input
def f(a: int, b: int, c: int, d: int, e: int) -&gt; int:
    return a + b + c + d + e

# Desired output
def f(
    a: int,
    b: int,
    c: int,
    d: int,
    e: int,
) -&gt; int:
    return a + b + c + d + e
</code></pre>
<p><strong>Related</strong>:</p>
<ul>
<li><a href="https://github.com/astral-sh/ruff/issues/6357">https://github.com/astral-sh/ruff/issues/6357</a></li>
<li><a href="https://github.com/astral-sh/ruff/issues/10966">https://github.com/astral-sh/ruff/issues/10966</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-07-14 09:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:18 UTC
    </footer>
</body>
</html>
