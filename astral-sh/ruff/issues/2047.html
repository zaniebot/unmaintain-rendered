<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: ICN001 import-alias-is-not-conventional checking `from package import module as alias` imports - astral-sh/ruff #2047</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: ICN001 import-alias-is-not-conventional checking <code>from package import module as alias</code> imports</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2047">#2047</a>
        opened by <a href="https://github.com/Zeddicus414">@Zeddicus414</a>
        on 2023-01-21 03:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Zeddicus414">@Zeddicus414</a></div>
            <div class="timeline-body"><p>It appears that ICN001 can be configured via this</p>
<pre><code class="language-toml">[tool.ruff.flake8-import-conventions.extend-aliases]
&quot;xml.dom.minidom&quot; = &quot;md&quot;
</code></pre>
<p>To catch this import problem:</p>
<pre><code class="language-python">import xml.dom.minidom as wrong
</code></pre>
<p>But it doesn't appear to be possible to configure the tool to catch this import as unconventional:</p>
<pre><code class="language-python">from xml.dom import minidom as wrong
</code></pre>
<p>I'd like to try adding this feature.</p>
<p>Based on my exploration, it appears that the <code>check_conventional_import</code> function just isn't called when the import is a <code>StmtKind::ImportFrom</code>.
https://github.com/charliermarsh/ruff/blob/4e4643aa5d1587c024ce98f0c51363a4830b491d/src/checkers/ast.rs#L1012</p>
<p>My first thought would be to call the <code>check_conventional_import</code> function on the <code>ImportFrom</code>s and have something like <code>minidom = &quot;md&quot;</code> as enough to work in the config file... although, I'm not sure if the config needs some more syntax to ensure that these two imports are not treated the same:</p>
<pre><code class="language-python">import minidom as md
from xml.dom import minidom as md
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-21 03:38</div>
            <div class="timeline-body"><p>Sounds good -- I agree that we should support this.</p>
<p>I don't <em>think</em> we need new syntax, since those two cases can be disambiguated as follows:</p>
<pre><code class="language-py">import minidom as md  # &quot;minidom&quot; = &quot;md&quot;
from xml.dom import minidom as md  # &quot;xml.dom.mindom&quot; = &quot;md&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-21 03:40</div>
            <div class="timeline-body"><p>(And yes -- you're looking in the right place! You'll need to construct the full module path (like <code>xml.dom.minidom</code>) and pass it to <code>check_conventional_import</code>, with one invocation per imported &quot;member&quot;.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zeddicus414">@Zeddicus414</a> on 2023-01-21 03:53</div>
            <div class="timeline-body"><p>I'm not sure if there is an easier way to do it, but I've got lots of <code>dbg!</code> statements all over the place in my local code.</p>
<p>This is what I have so far:
https://github.com/Zeddicus414/ruff/tree/ICN001-check-from-imports</p>
<p>But it does currently need <code>&quot;minidom&quot; = &quot;md&quot;</code> in the config to catch <code>from xml.dom import minidom as md</code>. I'll try to modify the function to account for both imports with just this line in the config: <code>&quot;xml.dom.minidom&quot; = &quot;md&quot;</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-21 04:07</div>
            <div class="timeline-body"><p>Take a look at the code on line 1175:</p>
<pre><code class="language-rs">let full_name = helpers::format_import_from_member(
    level.as_ref(),
    module.as_deref(),
    &amp;alias.node.name,
);
</code></pre>
<p>I <em>think</em> that might help.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zeddicus414">@Zeddicus414</a> on 2023-01-21 04:15</div>
            <div class="timeline-body"><p>haha, that looks very useful!</p>
<p>I saw <code>level.as_ref()</code> and said to myself, &quot;Isn't that what a borrow is supposed to be doing?&quot; then my mind turned to mush reading the docs about the <code>AsRef</code> trait.</p>
<p>I think I'll try to get further on this tomorrow when I can think clearly again.</p>
<p>You've been crazy responsive today and very helpful. Thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-21 05:03</div>
            <div class="timeline-body"><p>For sure! I'm not <em>always</em> at my computer :joy: but when I am, I try to be as helpful as I can for new contributors. Appreciate your work here!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-21 05:04</div>
            <div class="timeline-body"><p>(BTW -- in that context, <code>level.as_ref()</code> is just a way to convert <code>&amp;Option&lt;usize&gt;</code> to <code>Option&lt;&amp;usize&gt;</code>. We prefer the latter on public APIs, but sometimes callers have the former and need to cast it.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zeddicus414">@Zeddicus414</a> on 2023-01-21 18:59</div>
            <div class="timeline-body"><p>Alright, to the best of my knowledge, my branch is working. I'm hoping that how I achieved the result is okay. Please let me know if you are concerned about me duplicating code too much. I'm not sure if I did this the most DRY way possible.</p>
<p>Feel free to take a look if you'd like. Otherwise, I'm going to try to get my little test cases actually running under the test runner and work through the steps in the contribution guide to get this mergable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zeddicus414">@Zeddicus414</a> on 2023-01-21 19:10</div>
            <div class="timeline-body"><p>Something noteworthy is that if you configure this:</p>
<pre><code class="language-toml">&quot;..src.LongClassNamedThing&quot; = &quot;Thing&quot;
</code></pre>
<p>It will throw an ICN001 for this python code:</p>
<pre><code class="language-python">from ..src import LongClassNamedThing as wrong
</code></pre>
<p>At the moment, I consider this kind of a useless behavior that is neither a feature or a bug... I didn't write a test case for this since I consider it sort of undocumented/undefined behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-21 20:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:08 UTC
    </footer>
</body>
</html>
