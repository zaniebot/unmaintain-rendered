<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bug report : rule &quot;I001&quot; removing one extra empty line after imports - astral-sh/ruff #9645</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Bug report : rule &quot;I001&quot; removing one extra empty line after imports</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9645">#9645</a>
        opened by <a href="https://github.com/Lenormju">@Lenormju</a>
        on 2024-01-26 09:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lenormju">@Lenormju</a></div>
            <div class="timeline-body">

Actual
<p>Code to reproduce :</p>
<pre><code>import math


PI = math.pi
</code></pre>
<p>Ruff output :</p>
<pre><code>minimal_reproducible_example.py:1:1: I001 [*] Import block is un-sorted or un-formatted
Found 1 error.
[*] 1 fixable with the `--fix` option.
</code></pre>
<p>Applying the fix removes one empty line between imports and variable declaration :</p>
<pre><code> import math

-                    
 PI = math.pi
</code></pre>
Expected
<p>The Ruff error message is <code>I001 [*] Import block is un-sorted or un-formatted</code>.
Per <a href="https://peps.python.org/pep-0008/">PEP 8</a> regarding <a href="https://peps.python.org/pep-0008/#blank-lines">blank lines</a> :</p>
<blockquote>
<p>Surround top-level function and class definitions with two blank lines.</p>
</blockquote>
<p>I don&#x27;t think that the import block is un-formatted, there is just maybe an extraneous line after it.</p>
<p>I quickly surveyed <a href="https://github.com/python/cpython/tree/main/Lib">code from CPython&#x27;s stdlib</a> and there is both 1 or 2 spaces between the last line of imports and the first declaration after.</p>
<p>I ran Black (version <code>24.1.0</code>) on the same file and it did not remove a blank line.</p>
Context
<p>Ruff version : <code>ruff 0.1.14</code></p>
<p>Ruff settings :</p>
<ul>
<li><code>pyproject.toml</code><pre><code>[tool.ruff]
select = [&quot;I&quot;,]
</code></pre>
</li>
</ul>
<p>Ruff command : <code>ruff check minimal_reproducible_example.py</code> (if <code>--isolated</code> the bug is not reproduced)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-26 10:04</div>
            <div class="timeline-body"><p>Thanks for the detailed error report. To consistently enforce two lines after imports, you can use `isort.lines-after-imports = 2&#x27;.</p>
<p>I&#x27;m unfamiliar with the logic used by <code>isort</code> when using <code>lines-after-imports = -1</code>. @charliermarsh should know the details.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-26 10:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Lenormju">@Lenormju</a> on 2024-01-26 10:42</div>
            <div class="timeline-body"><p>Indeed !</p>
<ul>
<li><code>isort --check file.py</code> prints an error (<code>Imports are incorrectly sorted and/or formatted.</code>)</li>
<li><code>isort file.py</code> removes the line, like Ruff currently does</li>
<li><code>isort --lines-after-import 2 --check file.py</code> reports no error</li>
<li><code>isort --lines-after-import 1 --check file.py</code> removes the line</li>
</ul>
<p>So the default behavior of Ruff matches the default behavior of isort.</p>
<p>If I specify <a href="https://docs.astral.sh/ruff/settings/#isort-lines-after-imports">the value in the <code>[tool.ruff.lint.isort]</code> section</a> of the <code>pyproject.toml</code> :</p>
<ul>
<li><code>lines-after-imports = -1</code> removes the line</li>
<li><code>lines-after-imports = 1</code> removes the line</li>
<li><code>lines-after-imports = 2</code> does <em>not</em> remove the line</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-27 16:47</div>
            <div class="timeline-body"><p> @Lenormju I close this issue because what I understand from your response is that your problem is resolved. Let me know if that&#x27;s not the case or if there&#x27;s something we could improve.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-27 16:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Tedpac">@Tedpac</a> on 2024-05-08 16:08</div>
            <div class="timeline-body"><p>In my case, I&#x27;m using the Visual Studio Code extensions for <a href="https://marketplace.visualstudio.com/items?itemName=charliermarsh.ruff">Ruff</a> and <a href="https://marketplace.visualstudio.com/items?itemName=ms-python.isort">isort</a>, and I solved this issue by adding <code>&quot;isort.args&quot;: [&quot;--lines-after-import&quot;, &quot;2&quot;]</code> to <code>settings.json</code>. It should be noted that my decision to use both extensions was not to solve this issue but a personal choice. ✌️</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:49 UTC
    </footer>
</body>
</html>
