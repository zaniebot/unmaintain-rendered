<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLI: Toggle default output format based on the number of violations - astral-sh/ruff #7353</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>CLI: Toggle default output format based on the number of violations</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/7353">#7353</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2023-09-13 16:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2023-09-13 16:25</div>
            <div class="timeline-body"><p>In #7349 and #7352 the default output of <code>ruff check</code> includes much more content. However, this comes with a performance degradation for large numbers of violations as computing the display of source and fixes is expensive. A possible solution is to toggle the default output format between &quot;full&quot; and &quot;concise&quot; (#7350) depending on the number of detected violations. If we see more than 30 violations (for example), we should switch to the concise output. If <code>--format full</code> or <code>--format concise</code> is provided explicitly (or in the configuration file) we should <em>always</em> respect the given format regardless of the number of violations.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @zanieb on 2023-09-13 16:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-30 08:01</div>
            <div class="timeline-body"><blockquote>
<p>If --format full or --format concise is provided explicitly (or in the configuration file) we should always respect the given format regardless of the number of violations.</p>
</blockquote>
<p>I'm undecided on this. I think the use case here is that sometimes it's desired to get the full output, even if computing the output takes a long or prints a lot of text (e.g., when piping in CI). However, I'm concerned that the <em>default</em> <code>full</code> (no configuration) behavior is different from the explicit `output-format: full.</p>
<p>The main motivation for truncating fixes (we could, for example, print the first <code>n</code> violations in full, then print a message that Ruff has switched to concise) is to protect users from being overwhelmed and having a &quot;slow&quot;  experience. I think I would want that protection even when I explicitly say that I want the <code>full</code> output format.</p>
<p>One less implicit solution would be to define a new <code>full-always</code> or similar output format.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-30 14:33</div>
            <div class="timeline-body"><blockquote>
<p>I think I would want that protection even when I explicitly say that I want the full output format.</p>
</blockquote>
<p>I don't really follow this, why? If you explicitly request the full format it seems weird that we would not respect that.</p>
<blockquote>
<p>However, I'm concerned that the default full (no configuration) behavior is different from the explicit <code>output-format: full.</code></p>
</blockquote>
<p>We would encode the default behavior with a separate key like &quot;auto&quot; or &quot;default&quot; instead of overloading &quot;full&quot; to have two separate behaviors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-02 07:47</div>
            <div class="timeline-body"><blockquote>
<p>I don't really follow this, why? If you explicitly request the full format it seems weird that we would not respect that.</p>
</blockquote>
<p>Because I understood that having the &quot;automatic&quot; output format (that switches between full and concise) and the &quot;full&quot; output format use the same configuration name. But that's not the case according to:</p>
<blockquote>
<p>We would encode the default behavior with a separate key like &quot;auto&quot; or &quot;default&quot; instead of overloading &quot;full&quot; to have two separate behaviors.</p>
</blockquote>
<p>So I'm okay with printing all diagnostics when explicitly requesting <code>full</code> (and not <code>auto</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/ty/issues/134.html">astral-sh/ty#134</a> on 2025-05-07 15:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:10 UTC
    </footer>
</body>
</html>
