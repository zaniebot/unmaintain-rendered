<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Empty Lines Left After Stripping All Imports - astral-sh/ruff #6024</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Empty Lines Left After Stripping All Imports</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/6024">#6024</a>
        opened by <a href="https://github.com/kmcentush">@kmcentush</a>
        on 2023-07-24 05:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kmcentush">@kmcentush</a> on 2023-07-24 05:48</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>I ran into this when using the <code>UP</code> rules to enforce the Python 3.10 typing syntax (<a href="https://github.com/astral-sh/ruff/discussions/6020">discussion</a>), but I believe it applies for all cases when no explicit imports remain.</p>
<p><code>ruff</code> config, using version <code>0.0.280</code></p>
<pre><code>[tool.ruff]
include = [&quot;*.py&quot;, &quot;*.pyi&quot;, &quot;**/pyproject.toml&quot;, &quot;*.ipynb&quot;]
line-length = 120
select = [
    # pyflakes
    &quot;F&quot;,
    # pycodestyle
    &quot;E&quot;, &quot;W&quot;,
    # flake8-2020
    &quot;YTT&quot;,
    # flake8-bugbear
    &quot;B&quot;,
    # flake8-commas
    &quot;COM&quot;,
    # flake8-datetimez
    &quot;DTZ&quot;,
    # flake8-debugger
    &quot;T10&quot;,
    # flake8-gettext
    &quot;INT&quot;,
    # flake8-quotes
    &quot;Q&quot;,
    # pylint
    &quot;PL&quot;,
    # misc lints
    &quot;PIE&quot;,
    # flake8-pyi
    &quot;PYI&quot;,
    # tidy imports
    &quot;TID&quot;,
    # implicit string concatenation
    &quot;ISC&quot;,
    # type-checking imports
    &quot;TCH&quot;,
    # isort
    &quot;I&quot;,
    # comprehensions
    &quot;C4&quot;,
    # pygrep-hooks
    &quot;PGH&quot;,
    # Ruff-specific rules
    &quot;RUF&quot;,
    # Upgrade syntax
    &quot;UP&quot;,
]
ignore = [
    # module level import not at top of file
    &quot;E402&quot;,
    # too many arguments to function call
    &quot;PLR0913&quot;,
    # too many statements in function
    &quot;PLR0915&quot;,
    # magic value used in comparison,
    &quot;PLR2004&quot;,
    # do not use mutable data structures for argument defaults
    &quot;B006&quot;,
]
per-file-ignores = {&quot;__init__.py&quot; = [&quot;F401&quot;]}
target-version = &quot;py310&quot;
</code></pre>
<p>Starting file, <code>dummy.py</code>:</p>
<pre><code>from typing import Union


def dummy(a: Union[int, None]) -&gt; str:
    return str(a)

</code></pre>
<p>After running <code>ruff dummy.py --fix</code>:</p>
<pre><code>

def dummy(a: int | None) -&gt; str:
    return str(a)

</code></pre>
<p>This whitespace at the top of the file persists for any future <code>ruff</code> runs.</p>
<p>Perhaps this isn't truly a bug since there isn't a rule for whitespace at the top of a file, but given that prior to stripping the import I had my file start at line 1, it feels unnatural for the remaining code to start after the two-line whitespace.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-07-24 14:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-24 15:54</div>
            <div class="timeline-body"><p>Definitely appreciate that this isn't <em>ideal</em>, but right now it's considered &quot;working as intended&quot;. We make a best effort to produce clean changes on-fix (e.g., we avoid leaving trailing whitespace after removing the imports), but the intention is that you run a formatter over your code post-fix to clean up any stylistic / formatting changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-07-24 15:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
