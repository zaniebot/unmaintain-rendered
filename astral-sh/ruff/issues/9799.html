<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`PLR6301` (`no-self-use`) gives false positive for overriding method that does not call super() - astral-sh/ruff #9799</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`PLR6301` (`no-self-use`) gives false positive for overriding method that does not call super()</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/9799">#9799</a>
        opened by <a href="https://github.com/jakob-keller">@jakob-keller</a>
        on 2024-02-02 20:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jakob-keller">@jakob-keller</a> on 2024-02-02 20:31</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>I ❤️  ruff!</p>
<p>While playing with the current set of preview rules, I stumbled upon this edge case:</p>
<pre><code class="language-python"># test.py


class Foo:
    def __init__(self) -&gt; None:
        self.value: int = 1

    def get_value(self) -&gt; int:
        return self.value


class Bar(Foo):
    def get_value(self) -&gt; int:
        return 2
</code></pre>
<pre><code>$ ruff --version
ruff 0.2.0

$ ruff check --isolated --preview --select PLR test.py
test.py:13:9: PLR6301 Method `get_value` could be a function, class method, or static method
   |
12 | class Bar(Foo):
13 |     def get_value(self) -&gt; int:
   |         ^^^^^^^^^ PLR6301
14 |         return 2
   |

Found 1 error.
</code></pre>
<p>Admittedly, the example is a bit construed. Yet I believe this is valid code and should not trigger an error.</p>
<p>A related issue was addressed in #6961.</p>
<p>By the way: PyCharm correctly handles this case. On the other hand, ruff is (currently) not a type checker and might be unable to do anything about it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-02-02 21:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-08 02:57</div>
            <div class="timeline-body"><p>Thank you so much for the kind words!</p>
<p>I'm torn on what to do here (in the short-term, while we don't support multi-file analysis). We could...</p>
<ol>
<li>Detect this when the parent class is defined in the same file (as in the example above).</li>
<li>Limit this rule to only flag for classes without any parent classes.</li>
<li>Nothing?</li>
</ol>
<p>By the way, one workaround here: if you decorate the method with <code>@typing_extensions.override</code>, we'll avoid flagging it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jakob-keller">@jakob-keller</a> on 2024-02-08 08:26</div>
            <div class="timeline-body"><blockquote>
<p>if you decorate the method with <code>@typing_extensions.override</code>, we'll avoid flagging it.</p>
</blockquote>
<p>Great suggestion! Our codebase is still on Python 3.11 and doesn't use the override decorator yet. But I will probably use the backport available from <code>typing_extensions</code>. That's the most elegant solution I can think of.</p>
<p>I am closing this issue in favor of option 3 (won't fix) since:</p>
<blockquote>
<ol>
<li>Detect this when the parent class is defined in the same file (as in the example above).</li>
</ol>
</blockquote>
<p>Is rarely the case in substantial codebases.</p>
<blockquote>
<ol start="2">
<li>Limit this rule to only flag for classes without any parent classes.</li>
</ol>
</blockquote>
<p>Introduces too many false negatives IMHO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @jakob-keller on 2024-02-08 08:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
