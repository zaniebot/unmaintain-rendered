<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`PLR6301` (`no-self-use`) gives false positive for overriding method that does not call super() - astral-sh/ruff #9799</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>PLR6301</code> (<code>no-self-use</code>) gives false positive for overriding method that does not call super()</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9799">#9799</a>
        opened by <a href="https://github.com/jakob-keller">@jakob-keller</a>
        on 2024-02-02 20:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jakob-keller">@jakob-keller</a></div>
            <div class="timeline-body">

<p>I ❤️  ruff!</p>
<p>While playing with the current set of preview rules, I stumbled upon this edge case:</p>
<pre><code># test.py


class Foo:
    def __init__(self) -&gt; None:
        self.value: int = 1

    def get_value(self) -&gt; int:
        return self.value


class Bar(Foo):
    def get_value(self) -&gt; int:
        return 2
</code></pre>
<pre><code>$ ruff --version
ruff 0.2.0

$ ruff check --isolated --preview --select PLR test.py
test.py:13:9: PLR6301 Method `get_value` could be a function, class method, or static method
   |
12 | class Bar(Foo):
13 |     def get_value(self) -&gt; int:
   |         ^^^^^^^^^ PLR6301
14 |         return 2
   |

Found 1 error.
</code></pre>
<p>Admittedly, the example is a bit construed. Yet I believe this is valid code and should not trigger an error.</p>
<p>A related issue was addressed in #6961.</p>
<p>By the way: PyCharm correctly handles this case. On the other hand, ruff is (currently) not a type checker and might be unable to do anything about it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-02 21:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-08 02:57</div>
            <div class="timeline-body"><p>Thank you so much for the kind words!</p>
<p>I&#x27;m torn on what to do here (in the short-term, while we don&#x27;t support multi-file analysis). We could...</p>
<ol>
<li>Detect this when the parent class is defined in the same file (as in the example above).</li>
<li>Limit this rule to only flag for classes without any parent classes.</li>
<li>Nothing?</li>
</ol>
<p>By the way, one workaround here: if you decorate the method with <code>@typing_extensions.override</code>, we&#x27;ll avoid flagging it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jakob-keller">@jakob-keller</a> on 2024-02-08 08:26</div>
            <div class="timeline-body"><blockquote>
<p>if you decorate the method with <code>@typing_extensions.override</code>, we&#x27;ll avoid flagging it.</p>
</blockquote>
<p>Great suggestion! Our codebase is still on Python 3.11 and doesn&#x27;t use the override decorator yet. But I will probably use the backport available from <code>typing_extensions</code>. That&#x27;s the most elegant solution I can think of.</p>
<p>I am closing this issue in favor of option 3 (won&#x27;t fix) since:</p>
<blockquote>
<ol>
<li>Detect this when the parent class is defined in the same file (as in the example above).</li>
</ol>
</blockquote>
<p>Is rarely the case in substantial codebases.</p>
<blockquote>
<ol>
<li>Limit this rule to only flag for classes without any parent classes.</li>
</ol>
</blockquote>
<p>Introduces too many false negatives IMHO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/jakob-keller">@jakob-keller</a> on 2024-02-08 08:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:49 UTC
    </footer>
</body>
</html>
