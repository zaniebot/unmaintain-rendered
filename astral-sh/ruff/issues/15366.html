<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix introduced a syntax error with PIE800 - astral-sh/ruff #15366</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Fix introduced a syntax error with PIE800</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/15366">#15366</a>
        opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a>
        on 2025-01-09 04:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2025-01-09 04:45</div>
            <div class="timeline-body"><pre><code>λ cat test.py
class L:
    def execute(self):
        return {
            &quot;data&quot;: [],
            **({&quot;count&quot;: 1 if include_count else {}}),
        }

λ uvx ruff@0.8.6 check test.py --select PIE --no-cache --fix 

error: Fix introduced a syntax error. Reverting all changes.

This indicates a bug in Ruff. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BFix%20error%5D

...quoting the contents of `test.py`, the rule codes PIE800, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

test.py:5:16: PIE800 Unnecessary spread `**`
  |
3 |         return {
4 |             &quot;data&quot;: [],
5 |             **({&quot;count&quot;: 1 if include_count else {}}),
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ PIE800
6 |         }
  |
  = help: Remove unnecessary dict

Found 1 error.
[*] 1 fixable with the `--fix` option.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-01-09 04:58</div>
            <div class="timeline-body"><p>Thanks, the fixed version that contains a syntax error is:</p>
<pre><code class="language-py">class L:
    def execute(self):
        return {
            &quot;data&quot;: [],
            &quot;count&quot;: 1 if include_count else {}),
#                                              ^
#                                              This wasn't removed
        }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @dhruvmanila on 2025-01-09 04:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @dhruvmanila on 2025-01-09 04:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/15394.html">astral-sh/ruff#15394</a> on 2025-01-10 09:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-01-10 14:52</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:14 UTC
    </footer>
</body>
</html>
