<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`FA100` and `FA102` do not trigger with function annotations - astral-sh/ruff #5574</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>FA100</code> and <code>FA102</code> do not trigger with function annotations</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5574">#5574</a>
        opened by <a href="https://github.com/aazuspan">@aazuspan</a>
        on 2023-07-07 00:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/aazuspan">@aazuspan</a></div>
            <div class="timeline-body"><p>I'm migrating a project to <code>ruff</code> (huge fan so far, thanks maintainers!), and getting inconsistent behavior from the <code>flake8-future-annotations</code> rules, <a href="https://beta.ruff.rs/docs/rules/future-rewritable-type-annotation/#future-rewritable-type-annotation-fa100">FA100</a> and <a href="https://beta.ruff.rs/docs/rules/future-required-type-annotation/#future-required-type-annotation-fa102">FA102</a>. They trigger as expected for variable type annotations but do not trigger for function parameter or return type annotations.</p>
<h2>Reproducing</h2>
<p><code>pyproject.toml</code> config.</p>
<pre><code class="language-toml">[tool.ruff]
target-version = &quot;py38&quot;
select = [&quot;FA&quot;]
</code></pre>
<p><code>main.py</code> using the example code from the <code>ruff</code> docs.</p>
<pre><code class="language-python">from typing import List


# Doesn't trigger FA100
def foo(a: List[str]):
    ...

# Doesn't trigger FA102
def bar(a: int | None):
    ...
</code></pre>
<p>And the commands I'm running:</p>
<pre><code class="language-bash">$ ruff --version
0.0.277

$ ruff check ./main.py -v
[2023-07-06][17:10:49][ruff_cli::commands::run][DEBUG] Identified files to lint in: 2.948576ms
[2023-07-06][17:10:49][ruff_cli::diagnostics][DEBUG] Checking: /home/az/ruff_test/main.py
[2023-07-06][17:10:49][ruff_cli::commands::run][DEBUG] Checked 1 files in: 299.315µs
</code></pre>
<p>No rules triggered.</p>
<h2>Exceptions</h2>
<p>Both rules <em>will</em> trigger with variable type annotations. For example:</p>
<p><code>main.py</code></p>
<pre><code class="language-python">from typing import List


# Does trigger FA100
def foo():
    a: List[str]

# Does trigger FA102
def bar():
    a: int | None
</code></pre>
<pre><code class="language-bash">$ ruff check ./main.py -v
[2023-07-06][17:10:02][ruff_cli::commands::run][DEBUG] Identified files to lint in: 1.427045ms
[2023-07-06][17:10:02][ruff_cli::diagnostics][DEBUG] Checking: /home/az/ruff_test/main.py
[2023-07-06][17:10:02][ruff_cli::commands::run][DEBUG] Checked 1 files in: 416.495µs
main.py:19:8: FA100 Missing `from __future__ import annotations`, but uses `typing.List`
main.py:23:8: FA102 Missing `from __future__ import annotations`, but uses PEP 604 union
Found 2 errors.
</code></pre>
<p>This seems to be inconsistent with <code>flake8-future-annotations</code>, the example code in the <code>ruff</code> docs, and I believe the intended behavior. Let me know if you need any more details, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-07 00:32</div>
            <div class="timeline-body"><p>Thanks for the clear issue. I need to look back to refresh myself on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-07-07 01:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-07-07 01:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-07 01:42</div>
            <div class="timeline-body"><p>Yeah this is a bug. Thanks! I'll make sure it's fixed for the next release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aazuspan">@aazuspan</a> on 2023-07-07 01:56</div>
            <div class="timeline-body"><p>Awesome, thanks for such a quick response!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-07-07 04:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:37 UTC
    </footer>
</body>
</html>
