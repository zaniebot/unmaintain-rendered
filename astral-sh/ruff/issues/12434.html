<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `pydoclint` - astral-sh/ruff #12434</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>pydoclint</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12434">#12434</a>
        opened by <a href="https://github.com/augustelalande">@augustelalande</a>
        on 2024-07-21 16:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/augustelalande">@augustelalande</a></div>
            <div class="timeline-body"><p>This issue tracks the implementation of <a href="https://jsh9.github.io/pydoclint/violation_codes.html">pydoclint</a>. Following discussion in #11471 it was decided to prefer <code>pydoclint</code> over <code>darglint</code> for implementation in ruff, since they cover mostly the same ruleset, and <code>pydoclint</code> is still actively developed (unlike <code>darglint</code>). This issue should then supersede #458.</p>
Rules
<ul>
<li>[ ] <code>DOC101</code> Docstring contains fewer arguments than in function signature</li>
<li>[x] <code>DOC102</code> Docstring contains more arguments than in function signature</li>
<li>[ ] ~<code>DOC103</code> Docstring arguments are different from function arguments~</li>
<li>[ ] <code>DOC104</code> Arguments are the same in the docstring and the function signature, but are in a different order</li>
<li>[ ] <code>DOC105</code> Argument names match, but type hints do not match</li>
<li>[ ] ~<code>DOC106</code> The option <code>--arg-type-hints-in-signature</code> is <code>True</code> but there are no argument type hints in the signature~ (covered by <code>ANN</code>)</li>
<li>[ ] ~<code>DOC107</code> The option <code>--arg-type-hints-in-signature</code> is <code>True</code> but not all args in the signature have type hints~ (covered by <code>ANN</code>)</li>
<li>[ ] ~<code>DOC108</code> The option <code>--arg-type-hints-in-signature</code> is <code>False</code> but there are argument type hints in the signature~ (covered by <code>ANN</code>)</li>
<li>[ ] <code>DOC109</code> The option <code>--arg-type-hints-in-docstring</code> is <code>True</code> but there are no type hints in the docstring arg list</li>
<li>[ ] <code>DOC110</code> The option <code>--arg-type-hints-in-docstring</code> is <code>True</code> but not all args in the docstring arg list have type hints</li>
<li>[ ] <code>DOC111</code> The option <code>--arg-type-hints-in-docstring</code> is <code>False</code> but there are type hints in the docstring arg list</li>
<li>[x] <code>DOC201</code> Function/method does not have a return section in docstring</li>
<li>[x] <code>DOC202</code> Function/method has a return section in docstring, but there are no return statements or annotations</li>
<li>[ ] <code>DOC203</code> Return type(s) in the docstring not consistent with the return annotation</li>
<li>[ ] <code>DOC301</code> <code>__init__()</code> should not have a docstring; please combine it with the docstring of the class</li>
<li>[ ] <code>DOC302</code> The class docstring does not need a &quot;Returns&quot; section, because <code>__init__()</code> cannot return anything</li>
<li>[ ] ~<code>DOC303</code> The <code>__init__()</code> docstring does not need a &quot;Returns&quot; section, because it cannot return anything~</li>
<li>[ ] <code>DOC304</code> Class docstring has an argument/parameter section; please put it in the <code>__init__()</code> docstring</li>
<li>[ ] <code>DOC305</code> Class docstring has a &quot;Raises&quot; section; please put it in the <code>__init__()</code> docstring</li>
<li>[ ] <code>DOC306</code> The class docstring does not need a &quot;Yields&quot; section, because <code>__init__()</code> cannot yield anything</li>
<li>[ ] ~<code>DOC307</code> The <code>__init__()</code> docstring does not need a &quot;Yields&quot; section, because <code>__init__()</code> cannot yield anything~</li>
<li>[ ] ~<code>DOC401</code> (Deprecated; this violation code no longer appears)~</li>
<li>[x] <code>DOC402</code> Function/method has &quot;yield&quot; statements, but the docstring does not have a &quot;Yields&quot; section</li>
<li>[x] <code>DOC403</code> Function/method has a &quot;Yields&quot; section in the docstring, but there are no &quot;yield&quot; statements, or the return annotation is not a Generator/Iterator/Iterable</li>
<li>[ ] <code>DOC404</code> The types in the docstring&#x27;s Yields section and the return annotation in the signature are not consistent</li>
<li>[x] <code>DOC501</code> Function/method has &quot;raise&quot; statements, but the docstring does not have a &quot;Raises&quot; section</li>
<li>[x] <code>DOC502</code> Function/method has a &quot;Raises&quot; section in the docstring, but there are not &quot;raise&quot; statements in the body</li>
<li>[ ] ~<code>DOC503</code> Exceptions in the “Raises” section in the docstring do not match those in the function body~</li>
<li>[ ] <code>DOC504</code> Function/method has assert statements, but the docstring does  not have a “Raises” section. (Assert statements could raise  “AssertError”.)</li>
<li>[ ] <code>DOC601</code> Class docstring contains fewer class attributes than actual class attributes</li>
<li>[ ] <code>DOC602</code> Class docstring contains more class attributes than in actual class attributes</li>
<li>[ ] <code>DOC603</code> Class docstring attributes are different from actual class attributes</li>
<li>[ ] <code>DOC604</code> Attributes are the same in docstring and class def, but are in a different order</li>
<li>[ ] <code>DOC605</code> Attribute names match, but type hints in these attributes do not match</li>
</ul>
Style support
<ul>
<li>[x] Support <a href="https://www.sphinx-doc.org/en/master/usage/extensions/example_google.html">google</a> style docstrings.</li>
<li>[x] Support <a href="https://numpydoc.readthedocs.io/en/latest/format.html">numpy</a> style docstrings.</li>
<li>[ ] Support <a href="https://www.sphinx-doc.org/en/master/usage/extensions/example_google.html">sphinx</a> style docstrings.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-22 05:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">docstring</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-22 05:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2024-07-31 12:38</div>
            <div class="timeline-body"><p>I would like to enforce a certain style docstrings. I do not think it is contained in the existing rules here or in <code>darglint</code>. Suggesting it to be <code>DOC901</code>.</p>
<p>In theory this case could be covered by the full set of rules if you enable all:
it requires docstrings to be present, and then if we use another style these parameters will not be picked up.
However, I would like to make docstrings optional, and only enforce correctness and completeness then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RubenVanEldik">@RubenVanEldik</a> on 2024-08-14 14:36</div>
            <div class="timeline-body"><p>I really like these new rules, they provide a lot of extra guardrails for docstrings!</p>
<p>When trying to start using rule <code>DOC202</code> I ran into a bug. When defining an abstract method, the rule raises an error, because nothing is returned (which makes sense, since it&#x27;s an empty method, the real code is in the subclasses).</p>
<p>As a small example, an error is raised for this method:</p>
<pre><code>    @property
    @abc.abstractmethod
    def realised_prices(self) -&gt; pd.DataFrame:
        &quot;&quot;&quot;
        The realised prices of the market.

        Returns:
            The realised prices as a DataFrame
        &quot;&quot;&quot;
</code></pre>
<p><strong>UPDATE: This issue has already been solved (see: <a href="https://github.com/astral-sh/ruff/issues/12893">astral-sh/ruff#12893</a>)</strong></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-08-17 11:20</div>
            <div class="timeline-body"><p>Does the Astral team have an opinion on the implementation of DOC109, DOC110, and DOC111? Separating DOC109 and DOC110 seems inconsistent with how D417 works. Seeing as DOC111 is just the inverse behaviour, my intuition is that it would make the most sense for these to be consolidated into one configurable rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ddelange">@ddelange</a> on 2024-08-17 17:00</div>
            <div class="timeline-body"><p>That config also overlaps with the strikethrough rules covered by ANN. We currently ignore ANN because we run mypy. When the function is fully typehinted, the docstring doesn&#x27;t need any types, sphinx will still render the docstring including arg and return types <a href="https://mapply.readthedocs.io/en/stable/_code_reference/mapply.html#mapply.mapply.mapply">for example</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ben-Epstein">@Ben-Epstein</a> on 2024-08-20 14:05</div>
            <div class="timeline-body"><p>Does anyone know if other linting tools already implemented by ruff support the <code>DOC6xx</code> set of rules? I&#x27;m a bit surprised but I couldn&#x27;t find them in pydocstyle, pylint, or flake8.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KyleKing">@KyleKing</a> on 2024-08-22 10:32</div>
            <div class="timeline-body"><p>I really like these rules as well!</p>
<p>However, it would be great if the rules only applied to public functions and methods as indicated by a <code>_</code> prefix for private.</p>
<p>For example, I wouldn&#x27;t want to waste time adding a complete and correct docstring when the function is private and ignored by most documentation generators.</p>
<pre><code>def _escape(text: str) -&gt; str:
    &quot;&quot;&quot;Hypothetical function that does some internal business logic.&quot;&quot;&quot;
    if &quot;&amp;&amp;&quot; in text:
        raise CustomError()
    return text.replace(&quot;;&quot;, &quot;\;&quot;)
</code></pre>
<p>I believe a workaround today would be to move any private functions into a file prefixed by <code>_</code> and use a file pattern ignore (e.g. <code>_*</code>), but it would be nice to avoid extra refactoring and file-splitting. (For completeness, other workarounds are to remove the docstring and convert to a comment for private functions or to add a bunch of <code>noqa</code> ignores)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2024-08-22 14:25</div>
            <div class="timeline-body"><p>@KyleKing</p>
<blockquote>
<p>However, it would be great if the rules only applied to public functions and methods as indicated by a _ prefix for private.</p>
</blockquote>
<p>This makes sense to me. We should add a configuration option, to optionally allow/disallow the DOC rules on private functions.</p>
<p>Unfortunatelly, I won&#x27;t be able to get to this any time soon. If you&#x27;re up to it, feel free to open a PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-08-22 17:07</div>
            <div class="timeline-body"><blockquote>
<p>@KyleKing</p>
<blockquote>
<p>However, it would be great if the rules only applied to public functions and methods as indicated by a _ prefix for private.</p>
</blockquote>
<p>This makes sense to me. We should add a configuration option, to optionally allow/disallow the DOC rules on private functions.</p>
<p>Unfortunatelly, I won&#x27;t be able to get to this any time soon. If you&#x27;re up to it, feel free to open a PR.</p>
</blockquote>
<p>I can work on that (and ignore nested functions as well).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ddelange">@ddelange</a> on 2024-08-22 18:52</div>
            <div class="timeline-body"><p>regarding nested functions, private functions etc, here&#x27;s a nice source of configs (from interrogate, a docstring coverage tool):</p>
<pre><code>ignore-init-method = false
ignore-init-module = false
ignore-magic = false
ignore-semiprivate = false
ignore-private = false
ignore-property-decorators = false
ignore-module = false
ignore-nested-functions = false
ignore-nested-classes = false
ignore-setters = false
ignore-overloaded-functions = false
</code></pre>
<p><a href="https://github.com/econchick/interrogate?tab=readme-ov-file#configuration">source</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ddelange">@ddelange</a> on 2024-08-23 08:09</div>
            <div class="timeline-body"><p>And personally I&#x27;d love an <code>ignore-oneline-docstrings</code> option (darglint&#x27;s <code>strictness=short</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-08-23 17:52</div>
            <div class="timeline-body"><blockquote>
<p>And personally I&#x27;d love an <code>ignore-oneline-docstrings</code> option (darglint&#x27;s <code>strictness=short</code>).</p>
</blockquote>
<p>That particular configuration is likely blocked by #5860 – we&#x27;d need a member of the Astral team to decide what level of docstring configuration they&#x27;d like and how (e.g., if the configuration would apply to a subset of docstring diagnostics, or all of them).</p>
<p>EDIT: I should probably elaborate. The proposal to restrict docstring diagnostics based on docstring complexity (what you describe) is distinct to what I linked (which is a proposal to limited based on function complexity). However, they face overlapping design challenges, so it might make sense to link them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-09-01 09:37</div>
            <div class="timeline-body"><p><code>DOC303</code> is covered by <code>DOC202</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Apakottur">@Apakottur</a> on 2024-09-24 10:43</div>
            <div class="timeline-body"><p>Pydoclint introduced <a href="https://github.com/jsh9/pydoclint/pull/161">DOC503</a> for checking exceptions a few weeks ago. It&#x27;s covered by DOC501/DOC502 in Ruff (which are still in preview), but perhaps worth adding to the list in this issue as completed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssbarnea">@ssbarnea</a> on 2024-09-27 10:28</div>
            <div class="timeline-body"><p>@Apakottur Yeah, and I already raised <a href="https://github.com/jsh9/pydoclint/issues/171">jsh9/pydoclint#171</a> about it. Apparently ruff is not affected by it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsh9">@jsh9</a> on 2025-01-13 01:44</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p><a href="https://github.com/KyleKing">@KyleKing</a></p>
<blockquote>
<p>However, it would be great if the rules only applied to public functions and methods as indicated by a _ prefix for private.</p>
</blockquote>
<p>This makes sense to me. We should add a configuration option, to optionally allow/disallow the DOC rules on private functions.
Unfortunatelly, I won&#x27;t be able to get to this any time soon. If you&#x27;re up to it, feel free to open a PR.</p>
</blockquote>
<p>I can work on that (and ignore nested functions as well).</p>
</blockquote>
<p>Hi @KyleKing @augustelalande @tjkuson and @ddelange :</p>
<p>I&#x27;m the author of <em>pydoclint</em>.  Maybe I can share some thoughts behind why pydoclint does not support omitting private functions/methods.</p>
<p>Suppose a linter only checks certain functions in a repo and omits other functions, we may end up with a repo with mixed docstring styles as well as some other implications.  For example:</p>
<ul>
<li>Public functions have nicely written docstrings, and private functions have incorrect docstrings</li>
<li>Public functions have Google style docstrings (as enforced by a linter), while private functions&#x27; docstrings are in all sorts of styles</li>
<li>If we change some functions from public to private, their docstrings suddenly become unchecked</li>
<li>If we change some functions from private to public, we could have a surge of violations due to months of being omitted</li>
</ul>
<p>That&#x27;s why I didn&#x27;t design such an exception in <em>pydoclint</em>.  That said, there are indeed ways to &quot;be lazy&quot; in <em>pydoclint</em>:</p>
<ul>
<li>Don&#x27;t write any docstring, then <em>pydoclint</em> has nothing to check.  (<em>pydoclint</em> defers to other linters such as <em>pydocstyle</em> to enforce the existence of docstrings.)</li>
<li>Write &quot;one line&quot; docstrings (without Args, Returns, Yields, etc. sections)<ul>
<li>This is controlled by <em>pydoclint</em>&#x27;s <code>--skip-checking-short-docstrings</code> option (which is <code>True</code> by default)</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsh9">@jsh9</a> on 2025-01-13 08:42</div>
            <div class="timeline-body"><blockquote>
<p>I would like to enforce a certain style docstrings. I do not think it is contained in the existing rules here or in <code>darglint</code>. Suggesting it to be <code>DOC901</code>.</p>
<p>In theory this case could be covered by the full set of rules if you enable all: it requires docstrings to be present, and then if we use another style these parameters will not be picked up. However, I would like to make docstrings optional, and only enforce correctness and completeness then.</p>
</blockquote>
<p>Hi @sbrugman ,</p>
<p>I&#x27;m the author of <em>pydoclint</em>.  In the latest version of <em>pydoclint</em> (0.6.0), I added a new violation code (<code>DOC003</code>) to perform a docstring style mismatch check: for example, if you specify <code>--style=google</code>, but your functions&#x27; docstring are written in another style, you&#x27;ll see <code>DOC003</code>.</p>
<p>More details (including caveats) are here: https://jsh9.github.io/pydoclint/style_mismatch.html</p>
<p>The authors of Ruff are welcome to add this new code in Ruff&#x27;s roadmap.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2025-02-27 23:30</div>
            <div class="timeline-body"><p>I&#x27;ll have a PR up for DOC104 this weekend</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/HenriBlacksmith">@HenriBlacksmith</a> on 2025-04-24 06:35</div>
            <div class="timeline-body"><p>Is there any plan to stabilize the pydoclint rules which have already been implemented?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-24 13:07</div>
            <div class="timeline-body"><p>We&#x27;ve looked into stabilizing them in the previous two minor releases (0.9 and 0.10/11),  but many, or possibly all, of them had recent PRs adjusting their behavior, or open, unresolved issues. There&#x27;s also an open <a href="https://github.com/astral-sh/ruff/pull/13286">PR</a> adding support for Sphinx-style docstrings, which are not supported currently.</p>
<p>In short, I think we&#x27;re a bit hesitant to stabilize them while there&#x27;s still a lot of development and discussion ongoing.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:55 UTC
    </footer>
</body>
</html>
