<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ENH] Formatter: consider removing spaced around `=` for `TypeVar` defaults (PEP 696) - astral-sh/ruff #18746</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ENH] Formatter: consider removing spaced around <code>=</code> for <code>TypeVar</code> defaults (PEP 696)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18746">#18746</a>
        opened by <a href="https://github.com/randolf-scholz">@randolf-scholz</a>
        on 2025-06-18 10:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/randolf-scholz">@randolf-scholz</a></div>
            <div class="timeline-body"><p>PEP 696 introduced default values for type variables. When using in combination with PEP 695 syntax, the formatter currently always inserts spaces around the equal sign: <a href="https://play.ruff.rs/7e0f829e-94db-47f9-9490-39e1a37b65ca">ruff-playground</a></p>
<pre><code class="language-python">def foo[
    X = Any,  # &lt;-- spaces inserted around `=`
    Y: int = Any,  # &lt;-- spaces inserted around `=`
](
    y=2,  # &lt;-- spaces removed around `=`
    z: int = 2,  # &lt;-- spaces inserted around `=`
): ...
</code></pre>
<p>My proposal is to format <code>TypeVar</code>-defaults the same way that defaults are formatted for regular function parameters, i.e. to remove the space if no <code>&quot;: hint&quot;</code> is present[^1]. This, in my opinion, has 2 advantages:</p>
<ol>
<li>It improves readability (subjective)</li>
<li>Saves 2n spaces, which can make or break whether the signature fits on a single line.</li>
</ol>
<p>The latter is especially important when dealing with <code>@overload</code>, which are often much easier to grasp at a glance if they do not fill half a page due to spanning multiple lines per <code>@overload</code>.</p>
<p>Compare for instance the visuals of</p>
<pre><code class="language-python">@overload
def combine[X = Any, Y = Any, Z = Any](
    foo: FooA[Y, Z], bar: BarA[X, Y]
) -&gt; BazA[X, Z]: ...
@overload
def combine[X = Any, Y = Any, Z = Any](
    foo: FooB[Y, Z], bar: BarB[X, Y]
) -&gt; BazB[X, Z]: ...
@overload
def combine[X = Any, Y = Any, Z = Any](
    foo: FooB[Y, Z], bar: BarC[X, Y]
) -&gt; BazC[X, Z]: ...
</code></pre>
<p>and</p>
<pre><code class="language-python">@overload
def combine[X=Any, Y=Any, Z=Any](foo: FooA[Y, Z], bar: BarA[X, Y]) -&gt; BazA[X, Z]: ...
@overload
def combine[X=Any, Y=Any, Z=Any](foo: FooB[Y, Z], bar: BarB[X, Y]) -&gt; BazB[X, Z]: ...
@overload
def combine[X=Any, Y=Any, Z=Any](foo: FooB[Y, Z], bar: BarC[X, Y]) -&gt; BazC[X, Z]: ...
</code></pre>
<p>[^1]: At least when the <code>[...]</code> block only spans a single line. When it is formatted like an expanded list with 1 line per item, the spaces probably do not matter much one way or the other.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2025-06-18 11:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @MichaReiser on 2025-06-18 11:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[format] consider removing spaced around `=` for `TypeVar` defaults (PEP 696)" to "[ENH] Formatter: consider removing spaced around `=` for `TypeVar` defaults (PEP 696)" by @randolf-scholz on 2025-06-19 20:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:53 UTC
    </footer>
</body>
</html>
