<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inconsistent formatting around power and brackets - astral-sh/ruff #15130</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Inconsistent formatting around power and brackets</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/15130">#15130</a>
        opened by <a href="https://github.com/tobiasdiez">@tobiasdiez</a>
        on 2024-12-24 10:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/tobiasdiez">@tobiasdiez</a> on 2024-12-24 10:58</div>
            <div class="timeline-body"><p>The expression</p>
<pre><code class="language-python">rho = sqrt(r**2 + a**2 * cos(th)**2)
</code></pre>
<p>is reformatted (<code>ruff format</code>) as</p>
<pre><code class="language-python">rho = sqrt(r**2 + a**2 * cos(th) ** 2)
</code></pre>
<p>Note the additional space around <code>**</code> after the cosine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @AlexWaygood on 2024-12-24 12:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-12-24 13:26</div>
            <div class="timeline-body"><p>Thanks for the report! In general, Ruff's formatter tries to apply the same style to Python code as Black. I checked and Black <a href="https://black.vercel.app/?version=stable&amp;state=_Td6WFoAAATm1rRGAgAhARYAAAB0L-Wj4ACkAGhdAD2IimZxl1N_WmXYl8r1kM704aQABuAUFiA8L-5XUGJot2ttnwW-VBT_bJbFg6wHTF1oxNX2-KOKqLy58kABrAUxeXa3Oy41I9mMrVPbsQHP87qK_6mQQ2SDpmw47fjuyhHnQckPzCgAABlmBMa0z9C_AAGEAaUBAACjKGMAscRn-wIAAAAABFla">applies the same style here that we do</a>. The motivation for this formatting is described in Black's documentation here: https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html#line-breaks-binary-operators. We've previously made chnages in the opposite direction to what you're asking for here, e.g. https://github.com/astral-sh/ruff/issues/7318, in order to ensure a compatible coding style with Black.</p>
<p>This doesn't mean that we <em>definitely won't</em> change the style of how we format power expressions -- we do deviate from Black in <em>some</em> areas. But deviations generally require very strong motivations and high levels of user demand, as we weigh compatibility with Black quite highly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @MichaReiser on 2024-12-24 13:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:54 UTC
    </footer>
</body>
</html>
