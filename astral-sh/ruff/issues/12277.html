<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider adding a rule that enforces using TypeIs instead of TypeGuard - astral-sh/ruff #12277</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider adding a rule that enforces using TypeIs instead of TypeGuard</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12277">#12277</a>
        opened by <a href="https://github.com/ItsDrike">@ItsDrike</a>
        on 2024-07-10 14:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ItsDrike">@ItsDrike</a></div>
            <div class="timeline-body"><p>In <a href="https://peps.python.org/pep-0742/">PEP 742</a>, a new <code>TypeIs</code> annotation has been added. This provides an alternative to <code>TypeGuard</code> , which supports proper type narrowing. In vast majority of cases, people should use <code>TypeIs</code> as opposed to <code>TypeGuard</code> and the use of <code>TypeGuard</code> in code is likely a mistake.</p>
<p>It would therefore be nice to have a rule that bans the use of <code>TypeGuard</code> completely, just like the <code>ANN401</code> rule, that bans <code>typing.Any</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-12 12:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on 2024-07-30 16:13</div>
            <div class="timeline-body"><p>I don&#x27;t think TypeGuard is problematic enough that linters should warn against it. In fact a major part of the reason why I wrote PEP 742 as an alternative to PEP 724 (which proposed changing TypeGuard to behave similarly to how TypeIs now works) was that I looked at a number of real-world usages of TypeGuard and many worked with the existing semantics of TypeGuard, but not with TypeIs.</p>
<p>Writing a correct TypeIs function is tricky (https://typing.readthedocs.io/en/latest/guides/type_narrowing.html#writing-a-correct-typeis-function), and a lint rule that steers people to blindly replace TypeGuard with TypeIs is likely to cause incorrect TypeIs functions that lead to bad type narrowing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ItsDrike">@ItsDrike</a> on 2024-08-10 13:18</div>
            <div class="timeline-body"><p>Closing this, as JellieZiljstra pointed out, there are still a lot of valid use cases for TypeGuard that can&#x27;t be changed to TypeIs, which makes a rule like this potentially pretty annoying for developers, as they&#x27;d need noqas for valid code there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ItsDrike">@ItsDrike</a> on 2024-08-10 13:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:55 UTC
    </footer>
</body>
</html>
