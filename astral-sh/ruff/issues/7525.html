<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter: Add --skip-string-normalization option (parity with Black)? - astral-sh/ruff #7525</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Formatter: Add --skip-string-normalization option (parity with Black)?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7525">#7525</a>
        opened by <a href="https://github.com/mikeckennedy">@mikeckennedy</a>
        on 2023-09-19 17:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mikeckennedy">@mikeckennedy</a></div>
            <div class="timeline-body"><p>Hey folks. I see that Black added --skip-string-normalization ( <a href="https://github.com/psf/black/issues/118">psf/black#118</a>#issuecomment-393298377 ) but <code>ruff format --skip-string-normalization</code> leads to <code>error: unexpected argument &#x27;--skip-string-normalization&#x27; found</code>. Any chance of adding this feature to ruff format?</p>
<p>Alternatively, preferably, have ruff potentially prefer <code>&#x27;&#x27;</code> rather than <code>&quot;&quot;</code> for strings as an option. That is, still normalize strings, but to <code>&#x27;&#x27;</code> if specified.</p>
<p>I saw two other issues include this text, but neither seemed to be related to this actual functionality. Sorry if it&#x27;s already addressed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-19 17:31</div>
            <div class="timeline-body"><p>Hey Michael! We haven&#x27;t implemented it yet but we&#x27;re considering it -- there&#x27;s some discussion here (https://github.com/astral-sh/ruff/discussions/7305). The formatter <em>does</em> support parameterizing on preferred quote style (single vs. double) -- it&#x27;s not exposed on the CLI or configuration yet (just internally), but will be soon. So the main thing we&#x27;re trying to figure out is whether the ability to select a preferred quote style obviates the need for <code>--skip-string-normalization</code>, or whether there are still important use-cases where <code>--skip-string-normalization</code> is required. Any thoughts? What do you tend to use it for?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-19 17:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikeckennedy">@mikeckennedy</a> on 2023-09-19 17:39</div>
            <div class="timeline-body"><p>Thanks for the quick thoughts @charliermarsh! On the Black conversation/issue there are lots of times that people mentioned <code>&#x27;string&#x27;</code> has less visual noise than <code>&quot;string&quot;</code> and I totally agree and prefer <code>&#x27;&#x27;</code> for that reason.</p>
<p>Another, albeit less common one, that applies to me is RSI issues. I&#x27;ve long had to deal with RSI issues so I&#x27;m very careful about how and how much I type (not a huge deal these days but do have to be careful).</p>
<p>When typing <code>&quot;k&quot;</code>, you press 5 keys and use two hands. When typing <code>&#x27;k&#x27;</code> you press three and only have to use one hand. Minor but when typing code all day, it adds up.</p>
<p>Those are my two reasons.</p>
<p>If you gave us a way to prefer &#x27; over &quot; for normalization, I would not use <code>--skip-string-normalization</code> personally. I do want them normalized but want less visual noise and fewer incentives to type more (striving for parity visually).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-19 17:45</div>
            <div class="timeline-body"><p>Thanks, that&#x27;s super helpful. We <em>are</em> planning to expose an option to prefer <code>&#x27;</code> over <code>&quot;</code> (it&#x27;s already implemented internally, but not yet exposed -- coming in one of the next few releases). We&#x27;ll probably start there and then see if folks still have a need for <code>--skip-string-normalization</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikeckennedy">@mikeckennedy</a> on 2023-09-19 17:48</div>
            <div class="timeline-body"><p>Awesome, I&#x27;ll keep my eye out for it. :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2023-09-19 21:14</div>
            <div class="timeline-body"><p>@charliermarsh Should optional features different between Ruff and Black documented? What Ruff has, Black has not, and vice versa.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/coady">@coady</a> on 2023-09-19 22:52</div>
            <div class="timeline-body"><p>I would still be interested in the neutral <code>--skip-string-normalization</code>. Before black, there was a common (but seemingly forgotten) convention to use <code>&#x27;</code> for short identifiers and <code>&quot;</code> for text. Which was also convenient for text with apostrophes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-20 06:15</div>
            <div class="timeline-body"><blockquote>
<p>I would still be interested in the neutral <code>--skip-string-normalization</code>. Before black, there was a common (but seemingly forgotten) convention to use <code>&#x27;</code> for short identifiers and <code>&quot;</code> for text.</p>
</blockquote>
<p>Can you give an example for a short identifier where you prefer using <code>&#x27;</code>?</p>
<blockquote>
<p>Which was also convenient for text with apostrophes.</p>
</blockquote>
<p>Ruff doesn&#x27;t change the quote if it would lead to more escapes. Ruff preserves the double quotes for <code>&quot;Ruff doesn&#x27;t change the quotes of this string&quot;</code> because rewriting it to use single quotes would require escaping <code>&#x27;</code> which reduces readability.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/coady">@coady</a> on 2023-09-21 01:32</div>
            <div class="timeline-body"><blockquote>
<p>Can you give an example for a short identifier where you prefer using <code>&#x27;</code>?</p>
</blockquote>
<pre><code>if &#x27;id&#x27; not in data:
    warnings.warn(&quot;Data is missing id field.&quot;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Formatter: Beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 09:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 09:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-25 14:10</div>
            <div class="timeline-body"><p>@mikeckennedy - Just trying to gather data: do you use single quotes for docstrings and multi-line strings? E.g.:</p>
<pre><code>def function(x):
    &#x27;&#x27;&#x27;Some docstring.&#x27;&#x27;&#x27;
</code></pre>
<p>Or only for &quot;inline&quot; strings, like <code>function(&#x27;argument&#x27;)</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/153957">@153957</a> on 2023-09-25 14:21</div>
            <div class="timeline-body"><p>Personally I use triple double quotes for docstrings, and single quotes (including triple single quotes) for most other strings except if the string contains single quotes (and no double quotes) then I use double quotes.</p>
<p>But I might be fine with a preference for single quotes everywhere (so also for docstrings).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;Formatter: Beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-27 16:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-27 16:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-27 16:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-27 16:26</div>
            <div class="timeline-body"><p>Our current plan is <em>not</em> to implement this setting as it exists in Black, and first see how far folks can get with our quote-style configuration (see: <a href="https://github.com/astral-sh/ruff/issues/7615">astral-sh/ruff#7615</a>). If there&#x27;s still strong demand, we&#x27;ll of course revisit this flag (and so we&#x27;ll leave this issue open).</p>
<p>Another potential outcome here is that we add something like <code>quote-style = &quot;preserve&quot;</code>, to avoid changing quotes on strings but still reformat unnecessary escape sequences and similar.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikeckennedy">@mikeckennedy</a> on 2023-09-28 16:56</div>
            <div class="timeline-body"><p>@charliermarsh Exciting to hear, thanks. For me, I think it&#x27;s always <code>&quot;</code> for multi-line strings for me. I recall some sort of recommendation (at least via PyCharm but where did they get it?) for <code>&quot;</code> to be used for doc strings (and kinda all the <code>&quot;&quot;&quot; this style &quot;&quot;&quot;</code>). But I don&#x27;t have strong feelings here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbd">@kbd</a> on 2023-10-19 13:28</div>
            <div class="timeline-body"><p>+1 for <code>quote-style = &quot;preserve&quot;</code>. A habit I picked up a long time ago is to use single quotes for identifiers, like dictionary keys, and use double quotes for strings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MartinCura">@MartinCura</a> on 2023-10-25 20:01</div>
            <div class="timeline-body"><p>Chiming in as i test the new formatter (awesome work you&#x27;re doing, btw!):</p>
<p>I&#x27;m testing <code>ruff fmt</code> in an existing codebase that has <code>skip-string-normalization = true</code> and the result is over 150 files changed just because of normalizing strings ðŸ˜…</p>
<p>If you ask <em>me</em>, i prefer to just normalize strings in all my projects and move on... but on the other hand we have cases like this project i&#x27;m working on with a team that doesn&#x27;t want to bother with this. I <em>am</em> a fan of opinionated tools so i&#x27;m not really asking that you implement this, <em>but</em> i can see why it&#x27;s useful for migrating between tools (<code>black</code> -&gt; <code>ruff fmt</code>) as painlessly as possible. my 2 Â¢!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-25 20:04</div>
            <div class="timeline-body"><p>Thanks @MartinCura -- totally understand, this kind of feedback is really valuable for us as we try to make a decision here :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AndydeCleyre">@AndydeCleyre</a> on 2023-10-26 04:52</div>
            <div class="timeline-body"><p>I usually use <code>&quot;</code> for strings I expect to be printed or seen during the program&#x27;s use, and <code>&#x27;</code> for all internal strings, making exceptions to avoid escaping. This will keep some of my projects using black for now.</p>
<p>For triple quoted docstrings, whatever makes the docstring linter happy.</p>
<p>For other triple quoted docstrings, I prefer single quotes because it&#x27;s less noisy and more obvious what I&#x27;m looking at, but it&#x27;s not important to me.</p>
<hr>
<p>EDIT: Oh yeah, and I use <code>&quot;</code> for f-strings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-26 04:58</div>
            <div class="timeline-body"><p>One consideration with supporting the option is (we could look at black) what the expected behavior is when using the preview formatting that automatically joins and splits strings to make them fit. We then face the situation that we need to join multiple strings, where each string might use different quotes. In which case at least some sort of normalization becomes necessary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AndydeCleyre">@AndydeCleyre</a> on 2023-10-26 05:19</div>
            <div class="timeline-body"><p>FWIW those long strings usually fall under the user-facing-English-content category for me, which I associate with double quotes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-26 23:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MartinCura">@MartinCura</a> on 2023-10-27 15:19</div>
            <div class="timeline-body"><blockquote>
<p>but on the other hand we have cases like this project i&#x27;m working on with a team that doesn&#x27;t want to bother with this</p>
</blockquote>
<p>small unnecessary update: normalized strings in my repo when no one was looking ðŸ‘€ ðŸ˜…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmerickel">@mmerickel</a> on 2023-10-27 23:02</div>
            <div class="timeline-body"><p>As someone converting some codebases to ruff, I ran into this immediately as we are using skip-string-normalization with black. I personally do not see the need to normalize what quote-style is used by folks and would like the option for a <code>quote-style = &quot;preserve&quot;</code> to keep us operating as we were with black. Thanks for this amazing tool regardless!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Formatter: Stable&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-30 00:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pmhahn">@pmhahn</a> on 2023-11-06 09:05</div>
            <div class="timeline-body"><p>I inherited some 20y old code, where <code>&quot;</code> and <code>&#x27;</code> are both used. Sadly I&#x27;m not the only code owner so I cannot enforce one style. Therefore a <code>quote-style = &quot;preserve&quot;</code> would help until the powers above me withdraw their blockage to just move to just one consistent style :disappointed:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chockseswaramurthy">@chockseswaramurthy</a> on 2023-11-17 14:56</div>
            <div class="timeline-body"><p>Adding comment for more data points :) . We also ran into this issue when trying to replace Black with ruff formatter in our 10yr old bigâ€™ish Django code base with <code>skip-string-normalization=true</code> configured currently. We use both single and double quotes and have preferred single quotes historically but also allow double quotes for some things. Internal consensus is leaning towards preserving existing quote styles to co-exist. From reading above, I think <code>quote-style = &quot;preserve&quot;</code> should help us adopt ruff formatter with minimal moving changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sciyoshi">@sciyoshi</a> on 2023-11-22 20:36</div>
            <div class="timeline-body"><p>Re-reading the comments in this thread, it doesn&#x27;t seem like there&#x27;s been a final decision on what the best approach is. I&#x27;ve opened a PR which adds &quot;preserve&quot; as a quote-style option, which is what we would want in order to adopt ruff format for a codebase which uses <code>skip-string-normalization</code>. We don&#x27;t particularly care about having consistent quotes across the codebase which is why that option is useful for us. Also, maybe &quot;ignore&quot; would be more descriptive than &quot;preserve&quot;?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-24 15:28</div>
            <div class="timeline-body"><p>FWIW I support adding a <code>&quot;preserve&quot;</code> option. @MichaReiser is back next week so will wait to get his reaction before moving forward though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-11-29 03:53</div>
            <div class="timeline-body"><p>Could people who want the <code>--skip-string-normalization</code> feature please take a look at <a href="https://github.com/astral-sh/ruff/pull/8822">astral-sh/ruff#8822</a> to verify if it satisfies their needs and, if not, leave a comment. Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-12-07 23:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmerickel">@mmerickel</a> on 2024-01-03 18:30</div>
            <div class="timeline-body"><p>I ran this against our large codebase at $work and the two differences from black that I see are:</p>
<ul>
<li>This always converts docstrings to use double quotes. Either <code>&quot;</code> or <code>&quot;&quot;&quot;</code> based on what version of single quotes was used before.</li>
<li>This seems to prefer to change <code>&#x27;&#x27;&#x27;</code> or <code>r&#x27;&#x27;&#x27;</code> to double quotes, at least in the examples I saw. Even when not in a docstring.</li>
</ul>
<p>This isn&#x27;t what I want (would prefer for it to just not touch the string quoting ever), but not the end of the world. Hopefully the observations are helpful since the feature is still in preview.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-03 18:34</div>
            <div class="timeline-body"><p>@mmerickel - Thank you, it&#x27;s super helpful to get feedback like this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stephenfin">@stephenfin</a> on 2025-07-02 12:49</div>
            <div class="timeline-body"><p>Another difference between ruff and black, to add to @mmerickel&#x27;s comments, is that <code>u</code> prefixes are stripped with ruff. This doesn&#x27;t generally matter since the <code>u</code> prefix is a no-op in Python 3, but it does matter if you&#x27;re in the unfortunate position of having to maintaining code that still has Python 2.7 support. It&#x27;s not worth fixing IMO and I&#x27;m just noting it here in case anyone else stumbles upon this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceone">@spaceone</a> on 2025-10-23 13:23</div>
            <div class="timeline-body"><p>FYI: <code>--skip-string-normalization</code> can be achieved with:</p>
<p><code>ruff format --config &#x27;format.quote-style = &quot;preserve&quot;&#x27; .</code></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:42 UTC
    </footer>
</body>
</html>
