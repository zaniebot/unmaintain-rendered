<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for optional trailing comma - astral-sh/ruff #9389</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for optional trailing comma</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9389">#9389</a>
        opened by <a href="https://github.com/17Reset">@17Reset</a>
        on 2024-01-04 05:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/17Reset">@17Reset</a></div>
            <div class="timeline-body"><p>When I format my code using ruff format, after the format, there is always a comma after the code, can this be avoided by a parameter?
For example, my source code:</p>
<pre><code>FILE_SUFFIX_ICON = {
    MATLAB_SUFFIX: MATLAB_ICON,
    CPP_SUFFIX: CPP_ICON,
    SV_SUFFIX: RTL_ICON,
    &#x27;Default&#x27;: FILE_ICON
}
</code></pre>
<p>After using format:</p>
<pre><code>FILE_SUFFIX_ICON = {
    MATLAB_SUFFIX: MATLAB_ICON,
    CPP_SUFFIX: CPP_ICON,
    SV_SUFFIX: RTL_ICON,
    &#x27;Default&#x27;: FILE_ICON,
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-01-04 09:18</div>
            <div class="timeline-body"><p>The Ruff formatter tries to follow the <a href="https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html">Black code style</a>, which adds a trailing comma. A configuration option has not been added to Ruff to change that behaviour (it would have to be a new feature).</p>
<p>Related discussion: #9350</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/17Reset">@17Reset</a> on 2024-01-04 14:27</div>
            <div class="timeline-body"><p>Thanks, hope to add this feature option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-04 19:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-04 19:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Is the comma at the end of the list required?&quot; to &quot;Add support for optional trailing comma&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-04 19:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-04 19:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-04 19:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-08 08:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-08 08:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-08 08:17</div>
            <div class="timeline-body"><p>There&#x27;s no such option today. Would you mind explaining your motivation for omitting the trailing comma?</p>
<p>Ruff supports the <code>--skip-magic-trailing-comma</code> option. It doesn&#x27;t configure whether the trailing comma should be added, but it removes the trailing comma (and flattens the entries in the above example), if they all fit on a single line, e.g. after deleting or changing an entry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heiner">@heiner</a> on 2024-07-01 21:36</div>
            <div class="timeline-body"><p>Here&#x27;s a reason this might be useful: It turns <code>ruff format</code> into a quite decent <code>json</code> formatting engine. E.g.,</p>
<pre><code>cat file.json | ruff format - --isolated --config indent-width=2
</code></pre>
<p>However, sadly trailing commas aren&#x27;t legal JSON.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-02 05:49</div>
            <div class="timeline-body"><p>You may want to give <a href="https://biomejs.dev/">Biome</a> a try if you are looking for a Rust based JSON formatter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-02 05:51</div>
            <div class="timeline-body"><p>I&#x27;m closing this as not planned. Feel free to open a new issue to discuss the style with an outline for the use case and benefit of omitting trailing commas.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-02 05:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/17Reset">@17Reset</a> on 2024-07-02 08:11</div>
            <div class="timeline-body"><p>It&#x27;s not a popular style for trailing commas to appear after line breaks in Python lists, is it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/heiner">@heiner</a> on 2024-07-02 13:37</div>
            <div class="timeline-body"><blockquote>
<p>You may want to give <a href="https://biomejs.dev/">Biome</a> a try if you are looking for a Rust based JSON formatter.</p>
</blockquote>
<p>That&#x27;s less useful as a quick-and-dirty way to format JSON <em>within Python code</em>, where the existence of <code>ruff</code> is more or less guaranteed.</p>
<p>Still, ack&#x27;d on this being a bit fringe.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mshahbazi">@mshahbazi</a> on 2024-08-28 06:31</div>
            <div class="timeline-body"><p>The issue arises when the formatter adds a trailing comma, which prevents the code from being one-liner, when shortened, due to the presence of the comma, unless the trailing comma is removed manually.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyssance">@nyssance</a> on 2024-10-14 14:12</div>
            <div class="timeline-body"><p>Black style for trailing comma is stupid.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dberardo-com">@dberardo-com</a> on 2025-02-06 11:45</div>
            <div class="timeline-body"><p>i believe trailing commas dont work in python2.7, so it makes sense to make them optional</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/webknjaz">@webknjaz</a> on 2025-04-23 14:32</div>
            <div class="timeline-body"><p>I&#x27;ve found that a workaround is a double-pass of <code>ruff format</code> with an <code>add-trailing-comma</code> in-between: https://github.com/ansible/awx-plugins/blob/002bdc8/.pre-commit-config.yaml#L43-L58.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:48 UTC
    </footer>
</body>
</html>
