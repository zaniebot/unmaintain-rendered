<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FBT001: Allow booleans used as values rather than flags - astral-sh/ruff #9497</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>FBT001: Allow booleans used as values rather than flags</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9497">#9497</a>
        opened by <a href="https://github.com/arvidfm">@arvidfm</a>
        on 2024-01-12 21:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/arvidfm">@arvidfm</a></div>
            <div class="timeline-body"><p>The post that originally inspired the FBT rules is concerned specifically with boolean flags that modify the behaviour of a function, and in that context they make a lot of sense in terms of readability, and I like to have the rules enabled for that reason. However, there are cases where the boolean <em>is the value</em> as opposed to a flag. You might encounter this for instance when dealing with functions for enabling options, where the meaning of the option is given by the function or object name itself, not the parameter: <code>config.enable_fallback(False)</code>, <code>self.is_running.set_value(True)</code>.</p>
<p>I think the linter already recognises this to some extent, as it already has exceptions for some functions that fall into this exact category (<code>set_blocking</code>, <code>set_enabled</code>, <code>__setitem__</code> - albeit the first two for calls rather than definitions), but rather than adding individual exceptions, I think the rule could be relaxed in some clear-cut cases.</p>
<p>The most obvious case that I can think of where a bool is a value rather than a behaviour-modifying flag is when a function only takes a single positional-only parameter:</p>
<pre><code class="language-py">def enable_secret_mode(value: bool, /) -&gt; None: # allow
    ...

class A:
    def set_running(self, value: bool, /) -&gt; None: # allow - don't count self
        ...
</code></pre>
<p>One could also consider allowing defining functions that have multiple arguments, as long as the only positional(-only?) bool is the first argument. Or perhaps functions that only take positional-only arguments, and at most one of them is a boolean (think <code>os.set_blocking</code>).</p>
<p>This would also help when defining callbacks, where you can't use keyword-only parameters:</p>
<pre><code class="language-py"># can't use keyword-only parameter for callbacks
# no way to make the linter happy here
def my_callback(ok: bool, /) -&gt; None:
    ....

# function takes a Callable[[bool], None]
do_thing(&quot;value&quot;, callback=my_callback)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-01-13 00:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2024-01-13 00:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-01-13 00:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2024-01-13 00:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Rizhiy">@Rizhiy</a> on 2024-03-02 22:29</div>
            <div class="timeline-body"><p>I think <code>FBT001</code> &amp; <code>FBT003</code> should not trigger in general if it is the only positional argument, or perhaps if it is the first.
In most cases, the intent should be obvious from the function name, similar to cases above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-03-09 18:06</div>
            <div class="timeline-body"><p>In my case I got a false-positive for a method that takes more than 1 parameter, but there's only a single boolean param and it's called &quot;value&quot; in a method that starts with <code>set_</code>. Some heuristic with standard names in those cases might help. (but it's also my only false-positive, and it's obvious I'm not abusing <code>noqa</code> in that case).
<img src="https://github.com/astral-sh/ruff/assets/1350584/502a8282-f3a8-4f48-bd15-f00cad0edfc2" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/johnslavik">@johnslavik</a> on 2024-04-16 22:57</div>
            <div class="timeline-body"><p>+1 on this.
I often use flag-holding context vars.</p>
<pre><code class="language-py">from contextvars import ContextVar

cv = ContextVar(&quot;cv&quot;, default=False)
cv.set(True)  # triggers FBT003
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-06 14:59</div>
            <div class="timeline-body"><p><code>cv.set(True)</code> is now ignored.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:25 UTC
    </footer>
</body>
</html>
