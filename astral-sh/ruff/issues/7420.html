<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter incompatibility: extra parentheses around `await` assignment - astral-sh/ruff #7420</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Formatter incompatibility: extra parentheses around `await` assignment</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/7420">#7420</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-09-15 20:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-15 20:53</div>
            <div class="timeline-body"><p>Given:</p>
<pre><code class="language-python">result = await self.request(
    f&quot;/applications/{int(application_id)}/guilds/{int(scope)}/commands/{int(command_id)}/permissions&quot;
)
</code></pre>
<p>Ruff formats as:</p>
<pre><code class="language-python">result = (
    await self.request(
        f&quot;/applications/{int(application_id)}/guilds/{int(scope)}/commands/{int(command_id)}/permissions&quot;
    )
)
</code></pre>
<p>While Black formats as:</p>
<pre><code class="language-python">result = await self.request(
    f&quot;/applications/{int(application_id)}/guilds/{int(scope)}/commands/{int(command_id)}/permissions&quot;
)
</code></pre>
<p>Sourced from: https://github.com/astral-sh/ruff/issues/7394.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @charliermarsh on 2023-09-15 20:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-15 21:01</div>
            <div class="timeline-body"><p>This could be because the awaited expression exceeds the line width. We would need to use best fitting if we want to avoid this for unbreakable expressions. But that's just an initial guess. It could also be that we incorrectly do not apply the can omit optional parentheses layout</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Beta" by @MichaReiser on 2023-09-15 21:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/7423.html">astral-sh/ruff#7423</a> on 2023-09-15 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-09-15 21:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @charliermarsh on 2023-09-15 21:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/7424.html">astral-sh/ruff#7424</a> on 2023-09-15 21:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-16 14:37</div>
            <div class="timeline-body"><p>Closing as duplicate of #7431 (They have the same root cause)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-09-16 14:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/7431.html">astral-sh/ruff#7431</a> on 2023-09-16 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @MichaReiser on 2023-09-16 14:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-09-16 17:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:10 UTC
    </footer>
</body>
</html>
