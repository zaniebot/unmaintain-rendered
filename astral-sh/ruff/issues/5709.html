<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPY001: Make diagnostic fixable (flake8_copyright) - astral-sh/ruff #5709</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>CPY001: Make diagnostic fixable (flake8_copyright)</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/5709">#5709</a>
        opened by <a href="https://github.com/jvcop">@jvcop</a>
        on 2023-07-12 13:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jvcop">@jvcop</a> on 2023-07-12 13:11</div>
            <div class="timeline-body"><p>I would like to propose making <code>CPY001</code> (<code>flake8_copyright</code>) fixable. This would be a new feature, as the functionality is not available in the original. The main motivating factors are that as far as I can see, fixing the diagnostic is relatively straightforward, and it would increase the utility of the rule. For example, in the company I am working for, we have our own pre-commit hook that automatically adds the copyright notice if necessary.</p>
<p>In my proposal, a new setting would be added alongside <code>author</code>, <code>notice_rgx</code> and <code>min_file_size</code>: <code>notice_tpl</code> (notice template). It would default to <code>Copyright (C) {year}</code>, where <code>{year}</code> is a special placeholder that will be replaced by the current year.</p>
<p>There are two relevant cases for fixing the diagnostic:</p>
<ol>
<li>The notice is missing altogether. In this case, it would simply be generated and inserted based on <code>notice_tpl</code>. If the generated notice does not match <code>notice_rgx</code>, an error would be logged via <code>error!</code> and the fix would be skipped.</li>
<li>There is a notice, but <code>author</code> was specified and is missing at the end of the notice. In this case, the author would be inserted in the appropriate position.</li>
</ol>
<p>Is there interest in fixing <code>CPY001</code>? If so, does this proposal make sense?</p>
<p>I have a working proof of concept. If there is interest, I could work on a pull request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-07-12 13:56</div>
            <div class="timeline-body"><p>Related issue https://github.com/astral-sh/ruff/issues/5306</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autofix</span> added by @charliermarsh on 2023-07-12 18:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-12 18:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jvcop">@jvcop</a> on 2023-09-26 15:29</div>
            <div class="timeline-body"><p>Is there anything I can do to help with the decision?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aaronsteers">@aaronsteers</a> on 2024-05-07 22:30</div>
            <div class="timeline-body"><p>I'd love to see an auto-fix in place for this, as it would save us tons of time in making sure we are compliant with CPY1 - especially for codebases we are migrating, and for accepting contributions from community members who aren't going to know our spec for license requirements and what text to input.</p>
<p>X-posted from #5306:</p>
<blockquote>
<p>+1 to this request. And to raise an alternative more generic implementation - which would be &quot;file_starts_with&quot; customization.</p>
<p>This variant would allow auto-fixing of CPY1 indirectly, but with an approach more generic. The generic implementation would allow Ruff to check for (and auto-fix) a mandatory pre-amble for each python file.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astropy/astropy/issues/13786.html">astropy/astropy#13786</a> on 2024-07-30 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceone">@spaceone</a> on 2025-10-23 10:50</div>
            <div class="timeline-body"><p>I would also love to see this.
It should be able to insert the following license string anywhere in the top comment of the file (after the hashbang line):</p>
<pre><code># SPDX-FileCopyrightText: 2025 XXX GmbH
# SPDX-License-Identifier: AGPL-3.0-only
</code></pre>
<p>maybe with a placeholder <code>{year}</code> which inserts the current year.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/keriksson-rosenqvist-oqc">@keriksson-rosenqvist-oqc</a> on 2025-12-18 09:31</div>
            <div class="timeline-body"><p>I'd really like to see this feature added. It would also be useful if the <code>notice_tpl</code> and <code>notice_rgx</code> could be connected, e.g. &quot;using&quot; the template as the regex.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
