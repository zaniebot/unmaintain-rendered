<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff server and CLI format brackets differently on long lines - astral-sh/ruff #13520</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff server and CLI format brackets differently on long lines</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13520">#13520</a>
        opened by <a href="https://github.com/pdecat">@pdecat</a>
        on 2024-09-26 07:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/pdecat">@pdecat</a> on 2024-09-26 07:50</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>The following code formatted with <code>ruff server</code> from VSCodium:</p>
<pre><code class="language-py">testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest = &quot;,&quot;.join([
    testtesttesttest for testtesttesttest in [&quot;a&quot;, &quot;b&quot;]
])
</code></pre>
<p>is changed to the following with <code>ruff format</code>:</p>
<pre><code class="language-py">testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest = &quot;,&quot;.join(
    [testtesttesttest for testtesttesttest in [&quot;a&quot;, &quot;b&quot;]]
)
</code></pre>
<p>A few notes:</p>
<ul>
<li><code>ruff --version</code>: 0.6.7 both from VSCodium and CLI.</li>
<li><code>ruff check</code> is ok with both (<code>All checks passed!</code>).</li>
<li>tried with <code>line-length</code> set to 88 or 130 (our preferred setting), same behavior.</li>
</ul>
<p>Verbose logging from VSCodium when reformatting what the CLI produced:</p>
<pre><code>2024-09-26 09:45:23.206 [info] [Trace - 9:45:23 AM] Sending request 'textDocument/formatting - (8)'.
2024-09-26 09:45:23.206 [info] Params: {
    &quot;textDocument&quot;: {
        &quot;uri&quot;: &quot;file:///home/patrick/workspaces/tests/ruff/test.py&quot;
    },
    &quot;options&quot;: {
        &quot;tabSize&quot;: 4,
        &quot;insertSpaces&quot;: true,
        &quot;insertFinalNewline&quot;: true
    }
}


2024-09-26 09:45:23.207 [info] [Trace - 9:45:23 AM] Received response 'textDocument/formatting - (8)' in 1ms.
2024-09-26 09:45:23.208 [info] Result: [
    {
        &quot;newText&quot;: &quot;testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest = \&quot;,\&quot;.join([\n    testtesttesttest for testtesttesttest in [\&quot;a\&quot;, \&quot;b\&quot;]\n])\n&quot;,
        &quot;range&quot;: {
            &quot;end&quot;: {
                &quot;character&quot;: 0,
                &quot;line&quot;: 3
            },
            &quot;start&quot;: {
                &quot;character&quot;: 0,
                &quot;line&quot;: 0
            }
        }
    }
]
</code></pre>
<p>Verbose logging from CLI:</p>
<pre><code># ruff format --verbose test.py
[2024-09-26][09:47:28][ruff::resolve][DEBUG] Using Ruff default settings
[2024-09-26][09:47:28][ruff::commands::format][DEBUG] format_path; path=/home/patrick/workspaces/tests/ruff/test.py
[2024-09-26][09:47:28][tracing::span][DEBUG] Printer::print;
[2024-09-26][09:47:28][ruff::commands::format][DEBUG] Formatted 1 files in 463.54Âµs
1 file reformatted
</code></pre>
<p>Verbose logging from ruff_python_formatter:</p>
<pre><code># cargo run --bin ruff_python_formatter -- --emit stdout --print-comments --print-ir ~/workspaces/tests/ruff/test.py
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.21s
     Running `target/debug/ruff_python_formatter --emit stdout --print-comments --print-ir /home/patrick/workspaces/tests/ruff/test.py`
[
  &quot;testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest = &quot;,
  best_fit_parenthesize(&quot;#optional_parentheses-1&quot;, [
    &quot;\&quot;,\&quot;.join(&quot;,
    fits_expanded(propagate_expand: false, condition: if_group_fits_on_line(&quot;#optional_parentheses-1&quot;), [
      group([
        indent([
          soft_line_break,
          group([
            &quot;[&quot;,
            group([
              indent([
                soft_line_break,
                group([
                  group([&quot;testtesttesttest&quot;]),
                  soft_line_break_or_space,
                  &quot;for testtesttesttest in [&quot;,
                  group([
                    indent([
                      soft_line_break,
                      &quot;\&quot;a\&quot;,&quot;,
                      soft_line_break_or_space,
                      &quot;\&quot;b\&quot;&quot;,
                      if_group_breaks([&quot;,&quot;])
                    ]),
                    soft_line_break
                  ]),
                  &quot;]&quot;
                ])
              ]),
              soft_line_break
            ]),
            &quot;]&quot;
          ])
        ]),
        soft_line_break
      ])
    ]),
    &quot;)&quot;
  ]),
  hard_line_break
]
{}
testtesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttesttest = &quot;,&quot;.join(
    [testtesttesttest for testtesttesttest in [&quot;a&quot;, &quot;b&quot;]]
)
</code></pre>
<details>
<summary>VSCodium ruff initialization logs</summary>

<pre><code>2024-09-26 09:53:03.693 [info] Name: Ruff
2024-09-26 09:53:03.693 [info] Module: ruff
2024-09-26 09:53:03.693 [info] Python extension loading
2024-09-26 09:53:03.693 [info] Waiting for interpreter from python extension.
2024-09-26 09:53:03.693 [info] Python extension loaded
2024-09-26 09:53:03.693 [info] Using interpreter: /home/patrick/.local/share/mise/installs/python/3.12/bin/python
2024-09-26 09:53:03.693 [info] Using environment executable: /home/patrick/.local/share/mise/shims/ruff
2024-09-26 09:53:03.693 [info] Found Ruff 0.6.7 at /home/patrick/.local/share/mise/shims/ruff
2024-09-26 09:53:03.693 [info] Server run command: /home/patrick/.local/share/mise/shims/ruff server
2024-09-26 09:53:03.693 [info] Server: Start requested.
2024-09-26 09:53:03.693 [info] [Trace - 9:53:03 AM] Sending request 'initialize - (0)'.
2024-09-26 09:53:03.694 [info] Params: {
    &quot;processId&quot;: 2893542,
    &quot;clientInfo&quot;: {
        &quot;name&quot;: &quot;VSCodium&quot;,
        &quot;version&quot;: &quot;1.93.1&quot;
    },
    &quot;locale&quot;: &quot;en&quot;,
    &quot;rootPath&quot;: &quot;/home/patrick/workspaces/tests/ruff&quot;,
    &quot;rootUri&quot;: &quot;file:///home/patrick/workspaces/tests/ruff&quot;,
    &quot;capabilities&quot;: {
        &quot;workspace&quot;: {
            &quot;applyEdit&quot;: true,
            &quot;workspaceEdit&quot;: {
                &quot;documentChanges&quot;: true,
                &quot;resourceOperations&quot;: [
                    &quot;create&quot;,
                    &quot;rename&quot;,
                    &quot;delete&quot;
                ],
                &quot;failureHandling&quot;: &quot;textOnlyTransactional&quot;,
                &quot;normalizesLineEndings&quot;: true,
                &quot;changeAnnotationSupport&quot;: {
                    &quot;groupsOnLabel&quot;: true
                }
            },
            &quot;configuration&quot;: true,
            &quot;didChangeWatchedFiles&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;relativePatternSupport&quot;: true
            },
            &quot;symbol&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;symbolKind&quot;: {
                    &quot;valueSet&quot;: [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16,
                        17,
                        18,
                        19,
                        20,
                        21,
                        22,
                        23,
                        24,
                        25,
                        26
                    ]
                },
                &quot;tagSupport&quot;: {
                    &quot;valueSet&quot;: [
                        1
                    ]
                },
                &quot;resolveSupport&quot;: {
                    &quot;properties&quot;: [
                        &quot;location.range&quot;
                    ]
                }
            },
            &quot;codeLens&quot;: {
                &quot;refreshSupport&quot;: true
            },
            &quot;executeCommand&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;didChangeConfiguration&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;workspaceFolders&quot;: true,
            &quot;semanticTokens&quot;: {
                &quot;refreshSupport&quot;: true
            },
            &quot;fileOperations&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;didCreate&quot;: true,
                &quot;didRename&quot;: true,
                &quot;didDelete&quot;: true,
                &quot;willCreate&quot;: true,
                &quot;willRename&quot;: true,
                &quot;willDelete&quot;: true
            },
            &quot;inlineValue&quot;: {
                &quot;refreshSupport&quot;: true
            },
            &quot;inlayHint&quot;: {
                &quot;refreshSupport&quot;: true
            },
            &quot;diagnostics&quot;: {
                &quot;refreshSupport&quot;: true
            }
        },
        &quot;textDocument&quot;: {
            &quot;publishDiagnostics&quot;: {
                &quot;relatedInformation&quot;: true,
                &quot;versionSupport&quot;: false,
                &quot;tagSupport&quot;: {
                    &quot;valueSet&quot;: [
                        1,
                        2
                    ]
                },
                &quot;codeDescriptionSupport&quot;: true,
                &quot;dataSupport&quot;: true
            },
            &quot;synchronization&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;willSave&quot;: true,
                &quot;willSaveWaitUntil&quot;: true,
                &quot;didSave&quot;: true
            },
            &quot;completion&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;contextSupport&quot;: true,
                &quot;completionItem&quot;: {
                    &quot;snippetSupport&quot;: true,
                    &quot;commitCharactersSupport&quot;: true,
                    &quot;documentationFormat&quot;: [
                        &quot;markdown&quot;,
                        &quot;plaintext&quot;
                    ],
                    &quot;deprecatedSupport&quot;: true,
                    &quot;preselectSupport&quot;: true,
                    &quot;tagSupport&quot;: {
                        &quot;valueSet&quot;: [
                            1
                        ]
                    },
                    &quot;insertReplaceSupport&quot;: true,
                    &quot;resolveSupport&quot;: {
                        &quot;properties&quot;: [
                            &quot;documentation&quot;,
                            &quot;detail&quot;,
                            &quot;additionalTextEdits&quot;
                        ]
                    },
                    &quot;insertTextModeSupport&quot;: {
                        &quot;valueSet&quot;: [
                            1,
                            2
                        ]
                    },
                    &quot;labelDetailsSupport&quot;: true
                },
                &quot;insertTextMode&quot;: 2,
                &quot;completionItemKind&quot;: {
                    &quot;valueSet&quot;: [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16,
                        17,
                        18,
                        19,
                        20,
                        21,
                        22,
                        23,
                        24,
                        25
                    ]
                },
                &quot;completionList&quot;: {
                    &quot;itemDefaults&quot;: [
                        &quot;commitCharacters&quot;,
                        &quot;editRange&quot;,
                        &quot;insertTextFormat&quot;,
                        &quot;insertTextMode&quot;
                    ]
                }
            },
            &quot;hover&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;contentFormat&quot;: [
                    &quot;markdown&quot;,
                    &quot;plaintext&quot;
                ]
            },
            &quot;signatureHelp&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;signatureInformation&quot;: {
                    &quot;documentationFormat&quot;: [
                        &quot;markdown&quot;,
                        &quot;plaintext&quot;
                    ],
                    &quot;parameterInformation&quot;: {
                        &quot;labelOffsetSupport&quot;: true
                    },
                    &quot;activeParameterSupport&quot;: true
                },
                &quot;contextSupport&quot;: true
            },
            &quot;definition&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;linkSupport&quot;: true
            },
            &quot;references&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;documentHighlight&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;documentSymbol&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;symbolKind&quot;: {
                    &quot;valueSet&quot;: [
                        1,
                        2,
                        3,
                        4,
                        5,
                        6,
                        7,
                        8,
                        9,
                        10,
                        11,
                        12,
                        13,
                        14,
                        15,
                        16,
                        17,
                        18,
                        19,
                        20,
                        21,
                        22,
                        23,
                        24,
                        25,
                        26
                    ]
                },
                &quot;hierarchicalDocumentSymbolSupport&quot;: true,
                &quot;tagSupport&quot;: {
                    &quot;valueSet&quot;: [
                        1
                    ]
                },
                &quot;labelSupport&quot;: true
            },
            &quot;codeAction&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;isPreferredSupport&quot;: true,
                &quot;disabledSupport&quot;: true,
                &quot;dataSupport&quot;: true,
                &quot;resolveSupport&quot;: {
                    &quot;properties&quot;: [
                        &quot;edit&quot;
                    ]
                },
                &quot;codeActionLiteralSupport&quot;: {
                    &quot;codeActionKind&quot;: {
                        &quot;valueSet&quot;: [
                            &quot;&quot;,
                            &quot;quickfix&quot;,
                            &quot;refactor&quot;,
                            &quot;refactor.extract&quot;,
                            &quot;refactor.inline&quot;,
                            &quot;refactor.rewrite&quot;,
                            &quot;source&quot;,
                            &quot;source.organizeImports&quot;
                        ]
                    }
                },
                &quot;honorsChangeAnnotations&quot;: false
            },
            &quot;codeLens&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;formatting&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;rangeFormatting&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;onTypeFormatting&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;rename&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;prepareSupport&quot;: true,
                &quot;prepareSupportDefaultBehavior&quot;: 1,
                &quot;honorsChangeAnnotations&quot;: true
            },
            &quot;documentLink&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;tooltipSupport&quot;: true
            },
            &quot;typeDefinition&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;linkSupport&quot;: true
            },
            &quot;implementation&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;linkSupport&quot;: true
            },
            &quot;colorProvider&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;foldingRange&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;rangeLimit&quot;: 5000,
                &quot;lineFoldingOnly&quot;: true,
                &quot;foldingRangeKind&quot;: {
                    &quot;valueSet&quot;: [
                        &quot;comment&quot;,
                        &quot;imports&quot;,
                        &quot;region&quot;
                    ]
                },
                &quot;foldingRange&quot;: {
                    &quot;collapsedText&quot;: false
                }
            },
            &quot;declaration&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;linkSupport&quot;: true
            },
            &quot;selectionRange&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;callHierarchy&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;semanticTokens&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;tokenTypes&quot;: [
                    &quot;namespace&quot;,
                    &quot;type&quot;,
                    &quot;class&quot;,
                    &quot;enum&quot;,
                    &quot;interface&quot;,
                    &quot;struct&quot;,
                    &quot;typeParameter&quot;,
                    &quot;parameter&quot;,
                    &quot;variable&quot;,
                    &quot;property&quot;,
                    &quot;enumMember&quot;,
                    &quot;event&quot;,
                    &quot;function&quot;,
                    &quot;method&quot;,
                    &quot;macro&quot;,
                    &quot;keyword&quot;,
                    &quot;modifier&quot;,
                    &quot;comment&quot;,
                    &quot;string&quot;,
                    &quot;number&quot;,
                    &quot;regexp&quot;,
                    &quot;operator&quot;,
                    &quot;decorator&quot;
                ],
                &quot;tokenModifiers&quot;: [
                    &quot;declaration&quot;,
                    &quot;definition&quot;,
                    &quot;readonly&quot;,
                    &quot;static&quot;,
                    &quot;deprecated&quot;,
                    &quot;abstract&quot;,
                    &quot;async&quot;,
                    &quot;modification&quot;,
                    &quot;documentation&quot;,
                    &quot;defaultLibrary&quot;
                ],
                &quot;formats&quot;: [
                    &quot;relative&quot;
                ],
                &quot;requests&quot;: {
                    &quot;range&quot;: true,
                    &quot;full&quot;: {
                        &quot;delta&quot;: true
                    }
                },
                &quot;multilineTokenSupport&quot;: false,
                &quot;overlappingTokenSupport&quot;: false,
                &quot;serverCancelSupport&quot;: true,
                &quot;augmentsSyntaxTokens&quot;: true
            },
            &quot;linkedEditingRange&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;typeHierarchy&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;inlineValue&quot;: {
                &quot;dynamicRegistration&quot;: true
            },
            &quot;inlayHint&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;resolveSupport&quot;: {
                    &quot;properties&quot;: [
                        &quot;tooltip&quot;,
                        &quot;textEdits&quot;,
                        &quot;label.tooltip&quot;,
                        &quot;label.location&quot;,
                        &quot;label.command&quot;
                    ]
                }
            },
            &quot;diagnostic&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;relatedDocumentSupport&quot;: false
            }
        },
        &quot;window&quot;: {
            &quot;showMessage&quot;: {
                &quot;messageActionItem&quot;: {
                    &quot;additionalPropertiesSupport&quot;: true
                }
            },
            &quot;showDocument&quot;: {
                &quot;support&quot;: true
            },
            &quot;workDoneProgress&quot;: true
        },
        &quot;general&quot;: {
            &quot;staleRequestSupport&quot;: {
                &quot;cancel&quot;: true,
                &quot;retryOnContentModified&quot;: [
                    &quot;textDocument/semanticTokens/full&quot;,
                    &quot;textDocument/semanticTokens/range&quot;,
                    &quot;textDocument/semanticTokens/full/delta&quot;
                ]
            },
            &quot;regularExpressions&quot;: {
                &quot;engine&quot;: &quot;ECMAScript&quot;,
                &quot;version&quot;: &quot;ES2020&quot;
            },
            &quot;markdown&quot;: {
                &quot;parser&quot;: &quot;marked&quot;,
                &quot;version&quot;: &quot;1.1.0&quot;
            },
            &quot;positionEncodings&quot;: [
                &quot;utf-16&quot;
            ]
        },
        &quot;notebookDocument&quot;: {
            &quot;synchronization&quot;: {
                &quot;dynamicRegistration&quot;: true,
                &quot;executionSummarySupport&quot;: true
            }
        }
    },
    &quot;initializationOptions&quot;: {
        &quot;settings&quot;: [
            {
                &quot;nativeServer&quot;: &quot;on&quot;,
                &quot;cwd&quot;: &quot;/home/patrick/workspaces/tests/ruff&quot;,
                &quot;workspace&quot;: &quot;file:///home/patrick/workspaces/tests/ruff&quot;,
                &quot;path&quot;: [],
                &quot;ignoreStandardLibrary&quot;: true,
                &quot;interpreter&quot;: [
                    &quot;/home/patrick/.local/share/mise/installs/python/3.12/bin/python&quot;
                ],
                &quot;configuration&quot;: null,
                &quot;importStrategy&quot;: &quot;fromEnvironment&quot;,
                &quot;codeAction&quot;: {
                    &quot;fixViolation&quot;: {
                        &quot;enable&quot;: true
                    },
                    &quot;disableRuleComment&quot;: {
                        &quot;enable&quot;: true
                    }
                },
                &quot;lint&quot;: {
                    &quot;enable&quot;: true,
                    &quot;run&quot;: &quot;onType&quot;,
                    &quot;args&quot;: [],
                    &quot;preview&quot;: null,
                    &quot;select&quot;: null,
                    &quot;extendSelect&quot;: null,
                    &quot;ignore&quot;: null
                },
                &quot;format&quot;: {
                    &quot;args&quot;: [],
                    &quot;preview&quot;: true
                },
                &quot;enable&quot;: true,
                &quot;organizeImports&quot;: true,
                &quot;fixAll&quot;: true,
                &quot;showNotifications&quot;: &quot;off&quot;,
                &quot;exclude&quot;: null,
                &quot;lineLength&quot;: 130,
                &quot;configurationPreference&quot;: &quot;filesystemFirst&quot;,
                &quot;showSyntaxErrors&quot;: true,
                &quot;logLevel&quot;: &quot;trace&quot;,
                &quot;logFile&quot;: &quot;~/.ruff-server.log&quot;
            }
        ],
        &quot;globalSettings&quot;: {
            &quot;nativeServer&quot;: &quot;on&quot;,
            &quot;cwd&quot;: &quot;/home/patrick&quot;,
            &quot;workspace&quot;: &quot;/home/patrick&quot;,
            &quot;path&quot;: [],
            &quot;ignoreStandardLibrary&quot;: true,
            &quot;interpreter&quot;: [],
            &quot;configuration&quot;: null,
            &quot;importStrategy&quot;: &quot;fromEnvironment&quot;,
            &quot;codeAction&quot;: {
                &quot;fixViolation&quot;: {
                    &quot;enable&quot;: true
                },
                &quot;disableRuleComment&quot;: {
                    &quot;enable&quot;: true
                }
            },
            &quot;lint&quot;: {
                &quot;enable&quot;: true,
                &quot;run&quot;: &quot;onType&quot;,
                &quot;args&quot;: []
            },
            &quot;format&quot;: {
                &quot;args&quot;: [],
                &quot;preview&quot;: true
            },
            &quot;enable&quot;: true,
            &quot;organizeImports&quot;: true,
            &quot;fixAll&quot;: true,
            &quot;showNotifications&quot;: &quot;off&quot;,
            &quot;lineLength&quot;: 130,
            &quot;configurationPreference&quot;: &quot;filesystemFirst&quot;,
            &quot;showSyntaxErrors&quot;: true,
            &quot;logLevel&quot;: &quot;trace&quot;,
            &quot;logFile&quot;: &quot;~/.ruff-server.log&quot;
        }
    },
    &quot;trace&quot;: &quot;verbose&quot;,
    &quot;workspaceFolders&quot;: [
        {
            &quot;uri&quot;: &quot;file:///home/patrick/workspaces/tests/ruff&quot;,
            &quot;name&quot;: &quot;ruff&quot;
        }
    ]
}


2024-09-26 09:53:03.696 [info] [Trace - 9:53:03 AM] Received response 'initialize - (0)' in 4ms.
2024-09-26 09:53:03.696 [info] Result: {
    &quot;capabilities&quot;: {
        &quot;codeActionProvider&quot;: {
            &quot;codeActionKinds&quot;: [
                &quot;quickfix&quot;,
                &quot;source.fixAll.ruff&quot;,
                &quot;source.organizeImports.ruff&quot;,
                &quot;notebook.source.fixAll.ruff&quot;,
                &quot;notebook.source.organizeImports.ruff&quot;
            ],
            &quot;resolveProvider&quot;: true,
            &quot;workDoneProgress&quot;: true
        },
        &quot;diagnosticProvider&quot;: {
            &quot;identifier&quot;: &quot;Ruff&quot;,
            &quot;interFileDependencies&quot;: false,
            &quot;workDoneProgress&quot;: true,
            &quot;workspaceDiagnostics&quot;: false
        },
        &quot;documentFormattingProvider&quot;: true,
        &quot;documentRangeFormattingProvider&quot;: true,
        &quot;executeCommandProvider&quot;: {
            &quot;commands&quot;: [
                &quot;ruff.applyFormat&quot;,
                &quot;ruff.applyAutofix&quot;,
                &quot;ruff.applyOrganizeImports&quot;,
                &quot;ruff.printDebugInformation&quot;
            ],
            &quot;workDoneProgress&quot;: false
        },
        &quot;hoverProvider&quot;: true,
        &quot;notebookDocumentSync&quot;: {
            &quot;notebookSelector&quot;: [
                {
                    &quot;cells&quot;: [
                        {
                            &quot;language&quot;: &quot;python&quot;
                        }
                    ]
                }
            ],
            &quot;save&quot;: false
        },
        &quot;positionEncoding&quot;: &quot;utf-16&quot;,
        &quot;textDocumentSync&quot;: {
            &quot;change&quot;: 2,
            &quot;openClose&quot;: true,
            &quot;willSave&quot;: false,
            &quot;willSaveWaitUntil&quot;: false
        },
        &quot;workspace&quot;: {
            &quot;workspaceFolders&quot;: {
                &quot;changeNotifications&quot;: true,
                &quot;supported&quot;: true
            }
        }
    },
    &quot;serverInfo&quot;: {
        &quot;name&quot;: &quot;ruff&quot;,
        &quot;version&quot;: &quot;0.6.7&quot;
    }
}


2024-09-26 09:53:03.696 [info] [Trace - 9:53:03 AM] Sending notification 'initialized'.
2024-09-26 09:53:03.696 [info] Params: {}


2024-09-26 09:53:03.719 [info] [Trace - 9:53:03 AM] Received request 'client/registerCapability - (1)'.
2024-09-26 09:53:03.719 [info] Params: {
    &quot;registrations&quot;: [
        {
            &quot;id&quot;: &quot;ruff-server-watch&quot;,
            &quot;method&quot;: &quot;workspace/didChangeWatchedFiles&quot;,
            &quot;registerOptions&quot;: {
                &quot;watchers&quot;: [
                    {
                        &quot;globPattern&quot;: &quot;**/.ruff.toml&quot;
                    },
                    {
                        &quot;globPattern&quot;: &quot;**/ruff.toml&quot;
                    },
                    {
                        &quot;globPattern&quot;: &quot;**/pyproject.toml&quot;
                    }
                ]
            }
        }
    ]
}


2024-09-26 09:53:03.719 [info] [Trace - 9:53:03 AM] Sending response 'client/registerCapability - (1)'. Processing request took 0ms
2024-09-26 09:53:03.719 [info] No result returned.


2024-09-26 09:53:03.942 [info] [Trace - 9:53:03 AM] Sending notification '$/setTrace'.
2024-09-26 09:53:03.942 [info] Params: {
    &quot;value&quot;: &quot;verbose&quot;
}
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2024-09-26 08:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-26 08:22</div>
            <div class="timeline-body"><p>Hi @pdecat</p>
<p>The first formatting uses ruff's preview style formatting (enabled with <code>ruff.preview = true</code> or <code>ruff.format.preview = true</code>) here the second uses the stable formatting.</p>
<p>That's why I suspect that you either have overridden the ruff configuration in VS code or the extension doesn't pick up the same configuration (for some reason). Could you share your Ruff vs code extension settings with us and double check if you set the preview option in the settings or the CLI?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pdecat">@pdecat</a> on 2024-09-26 11:50</div>
            <div class="timeline-body"><p>Hi @MichaReiser, <code>preview</code> was indeed the culprit in my VSCodium user settings :facepalm: I don't remember when I enabled it, and it was the only code fragment in my projects to trigger this behavior.</p>
<p>Thank you so much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pdecat on 2024-09-26 11:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @dhruvmanila on 2025-01-07 05:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:14 UTC
    </footer>
</body>
</html>
