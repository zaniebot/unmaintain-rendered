<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COM819 false positive in t-string interpolation - astral-sh/ruff #19878</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>COM819 false positive in t-string interpolation</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/19878">#19878</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-08-12 13:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-08-12 13:06</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><a href="https://docs.astral.sh/ruff/rules/prohibited-trailing-comma/"><code>prohibited-trailing-comma</code> (COM819)</a> incorrectly detects the trailing comma in an unparenthesized tuple in a t-string interpolation. <a href="https://play.ruff.rs/b9fa193e-122e-42a3-9f1b-b1073f95f339">Example</a>:</p>
<pre><code class="language-console">$ cat &gt;com819.py &lt;&lt;'# EOF'
print(t&quot;{0,}&quot;.interpolations[0].value)
# EOF

$ python3.14 com819.py
(0,)

$ ruff --isolated check com819.py --select COM819 --target-version py314 --preview --fix
All checks passed!

$ cat com819.py
print(t&quot;{0}&quot;.interpolations[0].value)

$ python3.14 com819.py
0
</code></pre>
<h3>Version</h3>
<p>ruff 0.12.8 (f51a228f0 2025-08-07)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2025-08-12 13:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vladNed">@vladNed</a> on 2025-08-12 17:55</div>
            <div class="timeline-body"><p>I can have a look at it. Can I work on this issue ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @vladNed by @ntBre on 2025-08-12 17:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vladNed">@vladNed</a> on 2025-08-13 05:16</div>
            <div class="timeline-body"><p>checked <a href="https://github.com/astral-sh/ruff/blob/79c949f0f75f6582782f3d5fddc65089789801d5/crates/ruff_linter/src/rules/flake8_commas/rules/trailing_commas.rs#L249">trailing_commas.py</a> and saw that the t-strings are not treated. more than this, in f-strings, trailing commas are not treated either in tuples</p>
<pre><code class="language-python">print(f&quot;{(0, 1, )}&quot;)
</code></pre>
<p>I left an <a href="https://play.ruff.rs/5651bd7e-9446-46d3-b2c3-2271a26bd541">example here</a></p>
<p>I'll try to add the t-string and f-string cases in the linter</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-10-03 17:44</div>
            <div class="timeline-body"><p>I think #20357 fixed this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-10-03 18:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
