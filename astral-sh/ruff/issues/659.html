<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expose Ruff's public API as a Python library - astral-sh/ruff #659</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Expose Ruff's public API as a Python library</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/659">#659</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2022-11-08 14:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-08 14:36</div>
            <div class="timeline-body"><p>See: #593</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2022-11-08 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/593.html">astral-sh/ruff#593</a> on 2022-11-09 05:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/facundobatista">@facundobatista</a> on 2022-11-25 11:56</div>
            <div class="timeline-body"><p>This would mean that we could do something like the following, right?</p>
<pre><code>import ruff
errors = ruff.check_files(list_of_paths)
...
</code></pre>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-25 14:49</div>
            <div class="timeline-body"><p>Yup, that's right!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-25 14:50</div>
            <div class="timeline-body"><p>@messense - I wasn't certain on this last time -- if we bundle a Python API with Ruff, will we need to build separate wheels for every Python version?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/messense">@messense</a> on 2022-11-25 14:54</div>
            <div class="timeline-body"><p>If you can use <a href="https://pyo3.rs/v0.17.3/building_and_distribution.html#py_limited_apiabi3"><code>abi3</code> features</a>, one wheel per platform, otherwise you need to build separate wheels for every Python version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-25 14:55</div>
            <div class="timeline-body"><p>Awesome thank you. I think we should be able to do that, so maybe this will be really straightforward.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/provinzkraut">@provinzkraut</a> on 2022-12-08 17:52</div>
            <div class="timeline-body"><p>Hello there, do you happen to have a rough timeline for when (if?) this is going to happen? I'm looking to integrate ruff into a tool I'm developing, which would require an API of some sort. It would be very helpful to know if this is something I can wait on, or look for another solution / workaround!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Release 0.1.0" by @charliermarsh on 2022-12-08 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-08 18:40</div>
            <div class="timeline-body"><p>@provinzkraut - It's definitely going to happen! I could probably ship it within the next week or so. I'd just been punting on it until I had more people asking for it.</p>
<p>Could I hear a bit more about your use-case, if you don't mind sharing?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/provinzkraut">@provinzkraut</a> on 2022-12-08 19:43</div>
            <div class="timeline-body"><p>@charliermarsh That's good to hear!</p>
<blockquote>
<p>Could I hear a bit more about your use-case, if you don't mind sharing?</p>
</blockquote>
<p>Sure. I'm working on a markdown extension to automatically generate <a href="https://facelessuser.github.io/pymdown-extensions/extensions/tabbed/">pymdown tabs</a> for different Python versions from a source version, i.e. generate 3.7, 3.8, 3.10 tabs from a 3.7 source (<a href="https://github.com/provinzkraut/AutoPyTabs">repo</a>).</p>
<p>Currently I'm using <code>pyupgrade</code> to generate the versions and <code>autoflake</code> to clean imports that have become superfluous. Especially <code>autoflake</code> is quite slow, making up a majority of the extensions runtime. Since ruff is way faster at this, I'd like to use it (also one less dependency). I fiddled around with using the CLI version, but that's messy and a performance degradation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-09 04:12</div>
            <div class="timeline-body"><p>@provinzkraut - Ok, cool. Let me see what I can do. I don't know if you're comfortable reading Rust, but would the current <a href="https://github.com/charliermarsh/ruff/blob/a0a6327faecdb9f0fed8c69f4c84947677a8577d/src/lib.rs#L85">Rust public API</a> suit your use-case, were it callable from Python with Python objects etc.?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-09 04:13</div>
            <div class="timeline-body"><p>In short: it takes a file path (to find the <code>pyproject.toml</code>), the raw Python source code, and an autofix setting, and returns a list of checks (which themselves include the raw fixes / patches).</p>
<p>I'm guessing that for your use-case, what you actually want is a function that takes source code (plus settings, to enable a list of checks) and returns fixed source code?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../python-lsp/python-lsp-ruff/pulls/1.html">python-lsp/python-lsp-ruff#1</a> on 2022-12-09 08:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/provinzkraut">@provinzkraut</a> on 2022-12-09 09:52</div>
            <div class="timeline-body"><blockquote>
<p>but would the current <a href="https://github.com/charliermarsh/ruff/blob/a0a6327faecdb9f0fed8c69f4c84947677a8577d/src/lib.rs#L85">Rust public API</a> suit your use-case, were it callable from Python with Python objects etc.?</p>
</blockquote>
<p>I looked at this yesterday because I though that maybe it could be as simple as adding a tiny wrapper around the rust lib myself, but it seems to be a bit more involved. The current API doesn't really lend itself that well to my usecase.</p>
<blockquote>
<p>I'm guessing that for your use-case, what you actually want is a function that takes source code (plus settings, to enable a list of checks) and returns fixed source code?</p>
</blockquote>
<p>That would be ideal, yes. Dealing with a list of checks and extracting what I need from it also wouldn't be that big of an issue, but passing in configuration directly and omitting the config file is crucial, both for the needed configurability (I need to run the fixers with varying configuration for every invocation) and performance (I'm running the fixers many times on small snippets, which means the overhead of looking for and parsing a <code>pyproject.toml</code> every time adds up).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/squiddy">@squiddy</a> on 2022-12-27 14:16</div>
            <div class="timeline-body"><p>I'm working on this now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1407.html">astral-sh/ruff#1407</a> on 2022-12-27 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @charliermarsh on 2022-12-31 18:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">core</span> added by @charliermarsh on 2022-12-31 18:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/phillipuniverse">@phillipuniverse</a> on 2023-01-17 20:18</div>
            <div class="timeline-body"><p>I had a need to execute Ruff as an <a href="https://alembic.sqlalchemy.org/en/latest/autogenerate.html#writing-custom-hooks-as-python-functions">Alembic post write hook</a>. I came up with a very hamfisted approach that I found from the distributed <code>__main__.py</code></p>
<img width="940" alt="image" src="https://user-images.githubusercontent.com/684275/213002331-06311cab-dd24-471a-83ea-6cdc91aeb6d2.png">

<p><code>alembic.ini</code>:</p>
<pre><code class="language-ini">[post_write_hooks]
# post_write_hooks defines scripts or Python functions that are run
# on newly generated revision scripts.  See the documentation for further
# detail and examples

# format using &quot;black&quot; - use the console_scripts runner, against the &quot;black&quot; entrypoint
hooks = ruff, black

ruff.type = ruff

black.type = console_scripts
black.entrypoint = black
</code></pre>
<p>and then Alembic's <code>env.py</code>:</p>
<pre><code class="language-python">import os
import sysconfig
from alembic.script import write_hooks

@write_hooks.register(&quot;ruff&quot;)
def run_ruff(filename, options):
    ruff = os.path.join(sysconfig.get_path(&quot;scripts&quot;), &quot;ruff&quot;)
    os.spawnv(os.P_WAIT, ruff, [ruff, filename, &quot;--fix&quot;, &quot;--exit-zero&quot;])
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-17 20:30</div>
            <div class="timeline-body"><p>üëç Yup that should be safe to do! (The downside being that you have to go through the CLI rather than calling a function directly. Hoping to enable that soon but not working on it right now.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Release 0.1.0" by @charliermarsh on 2023-02-03 18:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2969.html">astral-sh/ruff#2969</a> on 2023-02-16 20:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/asmeurer">@asmeurer</a> on 2023-03-16 22:38</div>
            <div class="timeline-body"><p>Is the plan here to make a Python library that links to ruff directly? I want something that I can use in an interactive Python REPL to check for errors as the user types stuff, and shelling out to a subprocess on each character typed doesn't sound like a good idea (especially if I also have to write out the code to a tempfile or heredoc).</p>
<p>If you're curious, here's what I'm currently using with pyflakes https://github.com/asmeurer/mypython/blob/a836d0956a6443f7a85a032dc625ff3da1479a91/mypython/processors.py#L196. The code is complicated in part because pyflakes doesn't handle syntax errors very well, so I have to parse them separately. I haven't checked if ruff handles them better. There's lot of opportunities to improve over pyflakes' barebones Python API.</p>
<p>The main thing I would want from a Ruff Python API is a function that takes a string of Python code and returns a list of errors with line number, start and stop column numbers (where relevant), and the error message. Being able to get corresponding fixes would be nice too, I guess. The best API I can think of for a &quot;fix&quot; would be to return the whole block of code with the specific warning fixed, along with a new line and column number corresponding to the line and column of the original warning (so that I can interactively keep the cursor in the &quot;same&quot; location).</p>
<p>I'm happy to discuss API ideas more in depth or test out any prototypes if you're interested.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-03-17 07:35</div>
            <div class="timeline-body"><p>That sounds cool!</p>
<blockquote>
<p>If you're curious, here's what I'm currently using with pyflakes <a href="https://github.com/asmeurer/mypython/blob/a836d0956a6443f7a85a032dc625ff3da1479a91/mypython/processors.py#L196">asmeurer/mypython@a836d09/mypython/processors.py#L196</a>. The code is complicated in part because pyflakes doesn't handle syntax errors very well, so I have to parse them separately. I haven't checked if ruff handles them better. There's lot of opportunities to improve over pyflakes' barebones Python API.</p>
</blockquote>
<p>Ruff creates a diagnostic for files with syntax errors. Adopting a more error-resilient parser is something that we consider doing.</p>
<blockquote>
<p>The main thing I would want from a Ruff Python API is a function that takes a string of Python code and returns a list of errors with line number, start and stop column numbers (where relevant), and the error message.</p>
</blockquote>
<p>That sounds reasonable, but we aren't there yet (your best shot is to call into the CLI). One of the biggest problems of exposing a linter API right now is that Ruff writes one-off warnings to stdout and relies on the global state to track whether to write the warning. Cleaning this up probably requires a larger refactoring around the diagnostic system... so that may take a while.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-17 22:04</div>
            <div class="timeline-body"><p>For what it's worth, we power <code>ruff-lsp</code> and the VS Code extension over subprocess, and the CLI actually supports enough behavior to power the operations needed there. For example, you can use <code>--format json</code> to get a structured list of violations and their fixes. Similarly, if you pass input via <code>stdin</code>, and run with <code>--fix</code>, we print the &quot;fixed&quot; output to <code>stdout</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pytorch/pytorch/pulls/99280.html">pytorch/pytorch#99280</a> on 2023-04-18 00:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/provinzkraut">@provinzkraut</a> on 2023-06-11 08:57</div>
            <div class="timeline-body"><blockquote>
<p>For what it's worth, we power ruff-lsp and the VS Code extension over subprocess, and the CLI actually supports enough behavior to power the operations needed there</p>
</blockquote>
<p>How do you feel about adding a Python module that wraps this up in a convenient API?</p>
<p>I've been using the solution you suggested in a few of my tools now, and not having to implement that boilerplate every time would certainly be nice.</p>
<p>If that sounds good to you, I'd be happy to contribute.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../asmeurer/removestar/issues/51.html">asmeurer/removestar#51</a> on 2023-09-22 02:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zac-HD">@Zac-HD</a> on 2023-10-15 20:40</div>
            <div class="timeline-body"><p>I'm keen to replace <code>autoflake</code>+<code>isort</code> with <code>ruff</code> in my <code>shed</code> all-in-one autoformatter - the subprocess trick works pretty well, <em>except</em> that if there's any way to change the isort settings in ruff without a config file I can't see it - and running isolated from any config is pretty important in this use-case.  Any suggestions, or do I just need to wait for the library interface in this issue?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8401.html">astral-sh/ruff#8401</a> on 2023-11-01 09:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8673.html">astral-sh/ruff#8673</a> on 2023-11-14 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../deephaven/deephaven-core/issues/3453.html">deephaven/deephaven-core#3453</a> on 2023-12-15 21:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../NixOS/nixpkgs/pulls/280298.html">NixOS/nixpkgs#280298</a> on 2024-01-11 21:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pawamoy">@pawamoy</a> on 2024-02-22 13:27</div>
            <div class="timeline-body"><p>Adding a data point: in mkdocstrings-python we format function signatures with Black if it is installed. We would like to support Ruff to, but spawning a subprocess for each signature is very costly, so we would greatly appreciate a Python binding that doesn't use subprocesses :slightly_smiling_face: A wrapper that hides the subprocess calls sounds nice, but won't be enough for our use-case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-22 13:46</div>
            <div class="timeline-body"><p>@pawamoy that sounds neat. We plan to integrate our LSP into ruff (implemented in Rust). I know, it's not as convenient as a Python API but it would allow you to format files without spawning a process for every signature (although it might still be very costly because it requires multiple LSP calls to format a single code snipped)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pawamoy">@pawamoy</a> on 2024-02-22 14:13</div>
            <div class="timeline-body"><p>By calls do you mean network calls? Or could we somehow spawn the LSP server locally (like a daemon)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-22 14:27</div>
            <div class="timeline-body"><p>You would spawn the LSP like a daemon and communicate over stdin/stdout.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pawamoy">@pawamoy</a> on 2024-02-22 14:39</div>
            <div class="timeline-body"><p>Ah, interesting. Then yeah, that's already much better than subprocesses :slightly_smiling_face: Thanks for the info!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2024-02-22 17:10</div>
            <div class="timeline-body"><blockquote>
<p>Adding a data point: in mkdocstrings-python we format function signatures with Black if it is installed. We would like to support Ruff to, but spawning a subprocess for each signature is very costly, so we would greatly appreciate a Python binding that doesn't use subprocesses :slightly_smiling_face: A wrapper that hides the subprocess calls sounds nice, but won't be enough for our use-case.</p>
</blockquote>
<p>I put together an experimental package that uses PyO3 to wrap the  Ruff formatter in a Python API that doesn't require any subprocesses. I'd still consider it alpha at best (there's only one callable function), but maybe it could be helpful to others as well?</p>
<p>https://github.com/amyreese/ruff-api</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pawamoy">@pawamoy</a> on 2024-02-22 19:45</div>
            <div class="timeline-body"><p>Amazing, thanks for sharing! I'll check it out :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zac-HD">@Zac-HD</a> on 2024-02-22 20:43</div>
            <div class="timeline-body"><p>@charliermarsh just checking in - is there any way to configure the <code>isort</code> settings in <code>--isolated</code> mode, or do I just have to wait?  No worries if so, I'm just looking forward to replacing <code>black</code> too...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-22 21:03</div>
            <div class="timeline-body"><blockquote>
<p>@charliermarsh just checking in - is there any way to configure the <code>isort</code> settings in <code>--isolated</code> mode, or do I just have to wait? No worries if so, I'm just looking forward to replacing <code>black</code> too...</p>
</blockquote>
<p>@Zac-HD, yes, there is! We recently extended the <code>--config</code> flag so that arbitrary configuration options can be overridden via the command line using &quot;inline TOML&quot;: https://docs.astral.sh/ruff/configuration/#the-config-cli-flag. So to override the isort <code>extra-standard-library</code> setting in <code>--isolated</code> mode (for example), you'd do something like <code>ruff check path/to/file.py --config &quot;lint.isort.extra-standard-library = ['path']&quot;</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9720.html">astral-sh/ruff#9720</a> on 2024-02-23 21:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mbelak-dtml">@mbelak-dtml</a> on 2024-03-06 15:38</div>
            <div class="timeline-body"><p>Adding another data point:
In <a href="https://github.com/datamole-ai/edvart/blob/8f63194d48bd707c3c2f43d42a87773c116b0181/edvart/report.py#L158">edvart</a>, we are currently using <code>isort</code> to sort imports in Python code which is being dynamically.
With a Python API, we could fully switch to ruff. For now, we are using ruff to format the source code, but keeping <code>isort</code> to format the generated code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jankatins">@jankatins</a> on 2024-06-04 11:12</div>
            <div class="timeline-body"><p>Another data point: it would make it easier to replace programmatic calls to black, like in mdsformat-black: https://github.com/hukkin/mdformat-black/blob/master/mdformat_black/<strong>init</strong>.py</p>
<pre><code class="language-py">
def format_python(unformatted: str, _info_str: str) -&gt; str:
    return black.format_str(unformatted, mode=black.Mode())
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../adamchainz/blacken-docs/issues/352.html">adamchainz/blacken-docs#352</a> on 2024-07-01 21:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adamchainz">@adamchainz</a> on 2024-07-01 21:36</div>
            <div class="timeline-body"><p>I‚Äôd want to use an API like <code>black.format_str</code> over in <code>blacken-docs</code>, where Ruff support is tracked in this issue: https://github.com/adamchainz/blacken-docs/issues/352</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-17 06:37</div>
            <div class="timeline-body"><p>Not the most elegant solution and I haven't tried it myself, but it should soon be possible to call the ruff WASM API from Python:</p>
<ul>
<li>https://github.com/astral-sh/ruff/pull/12317</li>
<li>https://github.com/wasmerio/wasmer-python</li>
</ul>
<p>Considering that we have a WASM API now, I'm open to reconsidering a PyO3 API. Let me discuss this internally.</p>
<blockquote>
<p>Note: The API would not fall under any semver guarantees. We expect a major breaking change once we introduce multifile analysis. Practically, the API hasn't changed in months.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-18 14:13</div>
            <div class="timeline-body"><p>I would be open to expose a Ruff Pyo3 API:</p>
<ul>
<li>Shipped as a separate python package (ruff-api?)</li>
<li>Has the same or a very similar API as <code>ruff_wasm</code></li>
<li>The API itself isn't under semver. Breaking API changes are possible, even in patch releases (we don't feel comfortable committing to that yet). Otherwise, the same versioning policy as for Ruff applies</li>
<li>The package should be released automatically as part of our release workflow.</li>
</ul>
<p>I'm happy to support if anyone's interested in contributing the API to ruff.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @MichaReiser on 2024-07-18 14:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../ament/ament_lint/issues/497.html">ament/ament_lint#497</a> on 2024-07-25 14:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../fern-api/fern/pulls/4199.html">fern-api/fern#4199</a> on 2024-08-05 04:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12687.html">astral-sh/ruff#12687</a> on 2024-08-05 12:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12793.html">astral-sh/ruff#12793</a> on 2024-08-12 08:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maxschulz-COL">@maxschulz-COL</a> on 2024-08-12 12:00</div>
            <div class="timeline-body"><p>Hey, just to add another data-point: we at <a href="https://github.com/mckinsey/vizro">Vizro</a> would also love to be able to invoke <code>ruff</code> from within python without subprocess. Something like <code>black.format_str</code> indeed :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/n8henrie">@n8henrie</a> on 2024-08-30 19:28</div>
            <div class="timeline-body"><p>Same here -- would love to replace <code>black.format_str</code> in automatically formatting jupyter cells with https://github.com/n8henrie/jupyter-black/ !</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2024-08-30 22:31</div>
            <div class="timeline-body"><p>@maxschulz-COL @n8henrie @adamchainz I would like to remind folks that https://github.com/amyreese/ruff-api has a working, simple API wrapping both the formatter and import sorter from Ruff, just a <code>pip install ruff-api</code> away. We have been using it to successfully migrate from Black in our monorepo while still maintaining our existing integrations/tooling written in Python. :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/analog-cbarber">@analog-cbarber</a> on 2024-08-31 17:31</div>
            <div class="timeline-body"><p>That looks great, but it is also documented as &quot;highly experimental&quot;, so people maybe reluctant to add that to their tool chains. Why don't you contribute that to the ruff project?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/n8henrie">@n8henrie</a> on 2024-08-31 18:51</div>
            <div class="timeline-body"><p>Agreed -- it would be great to have this under ruff's umbrella!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../DemocracyClub/UK-Polling-Stations/pulls/8082.html">DemocracyClub/UK-Polling-Stations#8082</a> on 2024-09-26 08:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13975.html">astral-sh/ruff#13975</a> on 2024-10-29 04:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/14836.html">astral-sh/ruff#14836</a> on 2024-12-08 13:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mkdocstrings/python/pulls/216.html">mkdocstrings/python#216</a> on 2024-12-13 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/scnerd">@scnerd</a> on 2025-01-16 00:35</div>
            <div class="timeline-body"><p>Note that <code>ruff-api</code> above is also a great demonstration of how to use <code>ruff</code> API's from <em>rust</em> code, in case you happen to be <a href="https://github.com/rearc/spl_transpiler/">managing Python strings in Rust</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/18153.html">astral-sh/ruff#18153</a> on 2025-05-18 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jorenham">@jorenham</a> on 2025-05-20 16:38</div>
            <div class="timeline-body"><p>For what it's worth; here's an example of how you could <code>ruff format</code> a Python string using <code>subprocess</code>: https://gist.github.com/jorenham/63942278b01515ffdeb0c7d4d1895684</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../Josverl/micropython-stubber/issues/668.html">Josverl/micropython-stubber#668</a> on 2025-05-20 18:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/18655.html">astral-sh/ruff#18655</a> on 2025-06-13 06:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../Josverl/micropython-stubber/pulls/678.html">Josverl/micropython-stubber#678</a> on 2025-08-29 20:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/GDYendell">@GDYendell</a> on 2025-09-06 17:11</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/1407 was closed because the public API was not considered stable enough. Is that still the case or would it be reasonable to try this again now?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-09-08 19:49</div>
            <div class="timeline-body"><p>I think the API not being considered stable enough is still accurate. Thanks for checking in.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-15 12:02</div>
            <div class="timeline-body"><p>@GDYendell feel free to open a discussion with a proposed API. I think a good start would be something like:</p>
<pre><code class="language-python">def format(contents: &amp;str, options: FormatOptions) -&gt; str: ...

def lint(contents: &amp;str, options: LintOptions) -&gt; str: ...
</code></pre>
<p>The parts that are unclear to me:</p>
<ul>
<li>We should allow an optional file name for <code>lint</code></li>
<li>Should <code>format</code> throw if there's a syntax error or should the method return a <code>Result</code> like type</li>
<li>How to expose diagnostics? Just use the JSON output or offer some basic formatting</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kabouzeid">@kabouzeid</a> on 2025-09-15 13:18</div>
            <div class="timeline-body"><p>I would expect format to throw.</p>
<p>Not sure about how to expose the lint API in general, as I don't know what use cases people have for this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Freed-Wu">@Freed-Wu</a> on 2025-09-20 13:02</div>
            <div class="timeline-body"><p>Expect that ruff can provide a python binding for other python projects like <a href="https://github.com/Freed-Wu/mdformat-ruff">mdformat-ruff</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-09-22 18:42</div>
            <div class="timeline-body"><blockquote>
<p>The parts that are unclear to me:</p>
<pre><code>* We should allow an optional file name for `lint`</code></pre>
</blockquote>
<p>FWIW, the API that I built in <code>ruff-api</code> looks similar to your example, but requires a filename for both <code>format</code> and <code>isort</code> for consistency. Without a filename, things like first-party import detection doesn't work, and I think it makes sense to design an API that has matching usage between variants, even if something like filename isn't necessarily &quot;used&quot; by the underlying  implementation.</p>
<blockquote>
<pre><code>* Should `format` throw if there's a syntax error or should the method return a `Result` like type</code></pre>
</blockquote>
<p>I think a <code>Result</code> object would be better, and let that contain an <code>error</code> property with any exceptions like syntax error. That result object could contain diagnostics and resulting code after applying fixes/formatting, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-09-22 18:45</div>
            <div class="timeline-body"><blockquote>
<p>For what it's worth; here's an example of how you could <code>ruff format</code> a Python string using <code>subprocess</code>: https://gist.github.com/jorenham/63942278b01515ffdeb0c7d4d1895684</p>
</blockquote>
<p>I also built <a href="https://pypi.org/project/rufffmt/"><code>rufffmt</code></a> which will combine format+isort as a single CLI/API, and uses a similar approach for running via <code>subprocess</code>, but sometimes subprocess is not an option for various reasons, like running on in-memory strings.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:48 UTC
    </footer>
</body>
</html>
