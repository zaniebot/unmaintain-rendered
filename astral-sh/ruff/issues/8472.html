<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INP001 appears/disappears depending on the current directory - astral-sh/ruff #8472</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>INP001 appears/disappears depending on the current directory</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/8472">#8472</a>
        opened by <a href="https://github.com/DimitriPapadopoulos">@DimitriPapadopoulos</a>
        on 2023-11-03 13:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/DimitriPapadopoulos">@DimitriPapadopoulos</a> on 2023-11-03 13:42</div>
            <div class="timeline-body"><p>When checking a single file, the <a href="https://docs.astral.sh/ruff/rules/implicit-namespace-package/">INP001</a> error message appears/disappears depending on whether we run ruff from the directory containing the Python file or not:</p>
<ul>
<li><pre><code> &quot;&quot;&quot;Documentation.&quot;&quot;&quot;
</code></pre>
</li>
<li><pre><code>$ cd /
$ 
$ ruff --no-cache --isolated --select INP001 /path/to/file.py 
path/to/file.py:1:1: INP001 File `path/to/file.py` is part of an implicit namespace package. Add an `__init__.py`.
Found 1 error.
$ 
$ 
$ cd /path
$ 
$ ruff --no-cache --isolated --select INP001 /path/to/file.py 
to/file.py:1:1: INP001 File `to/file.py` is part of an implicit namespace package. Add an `__init__.py`.
Found 1 error.
$ 
$ cd /path/to
$ 
$ ruff --no-cache --isolated --select INP001 /path/to/file.py 
$ ruff --no-cache --isolated --select INP001 file.py 
$ 
</code></pre>
</li>
<li><pre><code>$ ruff --version
ruff 0.1.3
$ 
</code></pre>
I find this behaviour a little bit disturbing. Is it expected?</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-03 16:38</div>
            <div class="timeline-body"><p>Yeah, we avoid flagging files that are <em>direct</em> children of the source directory, since these tend to be top-level scripts, like <code>manage.py</code>.</p>
<p>But I think you shouldn't see this behavior if you use a <code>pyproject.toml</code>, since we'll then detect the source directory correctly no matter where you run Ruff from. Ruff only becomes &quot;non-portable&quot; in this way when you don't have a <code>pyproject.toml</code> or <code>ruff.toml</code> to detect the project root -- without those, we have to fall back to the current working directory as a best guess.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-11-03 16:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DimitriPapadopoulos">@DimitriPapadopoulos</a> on 2023-11-03 16:49</div>
            <div class="timeline-body"><p>I was running ruff on a standalone Python script, so you're correct I don't have a <code>pyproject.toml</code> or <code>ruff.toml</code> file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DimitriPapadopoulos">@DimitriPapadopoulos</a> on 2023-11-03 16:59</div>
            <div class="timeline-body"><p>The error message is disturbing because INP001 is irrelevant for standalone scripts, and even more disturbing as it appears/disappears based on the above algorithm. However, I understand identifying a &quot;standalone&quot; script might not be possible.</p>
<p>Selecting INP001 for a standalone script is a bad idea in the first place, of course, but I was initially using  <code>--select ALL</code>, not  <code>--select INP001</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-09 04:13</div>
            <div class="timeline-body"><p>I think I'm gonna close as &quot;working as intended&quot;. It's just hard for us to do much better here, and the inverse would also cause confusion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-11-09 04:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
