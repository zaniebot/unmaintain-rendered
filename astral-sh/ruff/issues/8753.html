<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff incorrectly ignores Python files included by negated pattern in .gitignore - astral-sh/ruff #8753</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Ruff incorrectly ignores Python files included by negated pattern in .gitignore</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/8753">#8753</a>
        opened by <a href="https://github.com/henribru">@henribru</a>
        on 2023-11-18 08:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/henribru">@henribru</a> on 2023-11-18 08:46</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Given the following .gitignore:</p>
<pre><code>*
!/src/
!/src/**
</code></pre>
<p>and a file <code>src/foo.py</code>, <code>ruff src/</code> outputs <code>warning: No Python files found under the given path(s)</code>. Given that Git includes this file due to the negated pattern overriding the <code>*</code>, this seems like a bug.</p>
<p>This is with 0.1.6 and no Ruff configuration in <code>pyproject.toml</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-18 22:54</div>
            <div class="timeline-body"><p>@BurntSushi -- We use the <code>ignore</code> crate for <code>.gitignore</code> behavior. Would you expect <code>src/foo.py</code> to be included based on the above? (It could definitely be an error on our side and not in the <code>ignore</code> crate, but wanted to check with you first.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-11-18 22:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henribru">@henribru</a> on 2023-11-19 07:06</div>
            <div class="timeline-body"><p>Seems like this might be https://github.com/BurntSushi/ripgrep/issues/1050</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-20 13:34</div>
            <div class="timeline-body"><p>It might also be this: https://github.com/BurntSushi/ripgrep/issues/1757 (A fix was merged recently but I believe it has not been released yet.)</p>
<p>But yes, this looks like a bug in the <code>ignore</code> crate to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eli-schwartz">@eli-schwartz</a> on 2023-11-22 23:24</div>
            <div class="timeline-body"><blockquote>
<p>@BurntSushi -- We use the <code>ignore</code> crate for <code>.gitignore</code> behavior. Would you expect <code>src/foo.py</code> to be included based on the above? (It could definitely be an error on our side and not in the <code>ignore</code> crate, but wanted to check with you first.)</p>
</blockquote>
<p>I would expect files that are checked into git with <code>git add --force</code> to be checked, but maybe that is just me? :thinking:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2023-11-27 03:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2023-11-27 03:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2023-11-27 03:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-27 13:18</div>
            <div class="timeline-body"><p>The <code>ignore</code> crate only reads <code>.gitignore</code> files. It doesn't actually read the git repository state to determine what's tracked and what isn't. One possible work-around to this is to ensure that <code>.gitignore</code> files are in sync with your repository state.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2023-11-29 14:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-29 14:58</div>
            <div class="timeline-body"><p>@BurntSushi - Did that fix go out in the latest version of ignore?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-29 15:03</div>
            <div class="timeline-body"><p>Yeah if the issue here is https://github.com/BurntSushi/ripgrep/issues/1757 then that's in the latest <code>ignore</code> release.</p>
<p>But https://github.com/BurntSushi/ripgrep/issues/1050 remains unfixed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-29 15:07</div>
            <div class="timeline-body"><p>I actually can't reproduce this on v0.1.6. @henribru - is that the exact pattern and directory structure you were using?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henribru">@henribru</a> on 2023-11-30 16:31</div>
            <div class="timeline-body"><blockquote>
<p>I actually can't reproduce this on v0.1.6. @henribru - is that the exact pattern and directory structure you were using?</p>
</blockquote>
<p>Yes. But I discovered something curious: It only seems to reproduce on Windows.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
