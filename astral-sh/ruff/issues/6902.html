<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New rule request: Local variable might be referenced before assignment - astral-sh/ruff #6902</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>New rule request: Local variable might be referenced before assignment</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6902">#6902</a>
        opened by <a href="https://github.com/Garrett-R">@Garrett-R</a>
        on 2023-08-26 19:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Garrett-R">@Garrett-R</a> on 2023-08-26 19:11</div>
            <div class="timeline-body"><p>It would be awesome if Ruff could catch an error (like PyCharm does) for code like this:</p>
<pre><code class="language-python">def func(x: bool) -&gt; int:
    if x:
        y = 1
    return y
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-08-26 21:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-26 21:19</div>
            <div class="timeline-body"><p>Makes sense. It's not trivial to fix because it requires supporting full branch analysis, but it would be good to catch of course.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Garrett-R">@Garrett-R</a> on 2023-08-26 22:29</div>
            <div class="timeline-body"><p>Yeah, seems really complicated, as does all this linter magic haha</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a> on 2023-10-23 21:21</div>
            <div class="timeline-body"><p>At least pycharm and possibly other IDEs static code analysis can catch this bug. I was also hoping to also find this rule in Ruff.
I thought F823 would catch this, but it doesn't.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/clemente0731">@clemente0731</a> on 2024-10-09 08:20</div>
            <div class="timeline-body"><p>SAME ISSUE FOR &quot;Local variable might be referenced before assignment&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/clemente0731">@clemente0731</a> on 2024-10-10 05:58</div>
            <div class="timeline-body"><p>https://github.com/google/pytype  can work well for this @charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Garrett-R">@Garrett-R</a> on 2025-09-07 05:31</div>
            <div class="timeline-body"><p>Closing the issue â€” this seems to be covered by <a href="https://github.com/astral-sh/ty">Ty</a>'s <code>possibly-unresolved-reference</code>!  ðŸŽŠ</p>
<p>With this config:</p>
<pre><code class="language-py">[tool.ty.rules]
possibly-unresolved-reference = &quot;error&quot;
</code></pre>
<p>and running on the above example, you get:</p>
<pre><code class="language-py">error[possibly-unresolved-reference]: Name `y` used when possibly not defined
 --&gt; del.py:4:12
  |
2 |     if x:
3 |         y = 1
4 |     return y
  |            ^
  |

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Garrett-R on 2025-09-07 05:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a> on 2025-09-07 14:22</div>
            <div class="timeline-body"><p>This seems like way more suitable for a linter than a type checker (I know I know, there's a lot of overlap).</p>
<p>IIUC, since both projects share most of the code base, why not add this to a ruff rule, especially since ty isn't production ready.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Garrett-R">@Garrett-R</a> on 2025-09-08 23:28</div>
            <div class="timeline-body"><p>I guess I could see it in both.  Linter could certainly catch that, or a typing system since the symbol at that point has an ill-defined type, so it's at least the type checker's problem too.</p>
<blockquote>
<p>why not add this to a ruff rule, especially since Ty isn't production ready</p>
</blockquote>
<p>Probably best to decide where it belongs long-term and roll with that, rather than letting the temporary Alpha state of Ty be a deciding factor on where it should live.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:31:08 UTC
    </footer>
</body>
</html>
