<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Panic] ruff crashes when executed from a deleted folder on mac - astral-sh/ruff #16903</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>[Panic] ruff crashes when executed from a deleted folder on mac</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/16903">#16903</a>
        opened by <a href="https://github.com/cbeauchesne">@cbeauchesne</a>
        on 2025-03-21 18:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cbeauchesne">@cbeauchesne</a> on 2025-03-21 18:04</div>
            <div class="timeline-body"><p>How to reproduce :</p>
<p>in terminal 1 :</p>
<pre><code class="language-bash">mkdir tmp
cd tmp
</code></pre>
<p>in terminal 2</p>
<pre><code class="language-bash">rm -rf tmp
</code></pre>
<p>back in terminal 1 :</p>
<pre><code>RUST_BACKTRACE=full ruff check

error: Ruff crashed. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BPanic%5D

...quoting the executed command, along with the relevant file contents and `pyproject.toml` settings, we'd be very appreciative!

thread 'main' panicked at /Users/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/path-dedot-3.1.1/src/lib.rs:330:70:
called `Result::unwrap()` on an `Err` value: Os { code: 2, kind: NotFound, message: &quot;No such file or directory&quot; }
stack backtrace:
   0:        0x10f6a86e8 - &lt;std::sys::backtrace::BacktraceLock::print::DisplayBacktrace as core::fmt::Display&gt;::fmt::hcaf66bc4c0c453df
   1:        0x10e7e360b - core::fmt::write::hc9c5f1836b413410
   2:        0x10f6a3f12 - std::io::Write::write_fmt::h49df280499063c09
   3:        0x10f6a99da - std::panicking::default_hook::{{closure}}::h52c0b2f44f6107c5
   4:        0x10f6a9642 - std::panicking::default_hook::h5a6cf31501c161b2
   5:        0x10ecd794a - ruff::run::{{closure}}::hd41b263f42227ea1
   6:        0x10f6aab9e - std::panicking::rust_panic_with_hook::hda4640ee332466e9
   7:        0x10f6a9ff5 - std::panicking::begin_panic_handler::{{closure}}::haa3060694b34ea3d
   8:        0x10f6a8bc9 - std::sys::backtrace::__rust_end_short_backtrace::h8eb44913cfe71457
   9:        0x10f6a9c3c - _rust_begin_unwind
  10:        0x10f750d4a - core::panicking::panic_fmt::h31edc3d6ff0aadca
  11:        0x10f7511c5 - core::result::unwrap_failed::h2169d1cb8033298b
  12:        0x10e9b57c9 - core::ops::function::FnOnce::call_once::h4a1f9b6c37c4efb9
  13:        0x10ec9e540 - once_cell::imp::OnceCell&lt;T&gt;::initialize::{{closure}}::hd57f3dc11ebdb7bf
  14:        0x10e9b392a - once_cell::imp::initialize_or_wait::h1b6a1b2a2c5ea054
  15:        0x10f776c3c - once_cell::imp::OnceCell&lt;T&gt;::initialize::h6c5acec7735a0040
  16:        0x10ebcd23b - ruff::resolve::resolve::h3abf4f7e3ef26cd9
  17:        0x10ecd7ad1 - ruff::check::h93bfe06211e45642
  18:        0x10ecd6d01 - ruff::run::h4a796964f3396cea
  19:        0x10ecdc441 - ruff::main::h12661c1f2feb882f
  20:        0x10ece1936 - std::sys::backtrace::__rust_begin_short_backtrace::h61cdb7c3f5f8eba8
  21:        0x10ecdfb0c - std::rt::lang_start::{{closure}}::hf5a90ee77f97c307
  22:        0x10f69b27f - std::rt::lang_start_internal::hb1473645dbe40065
  23:        0x10ecdc97c - _main
  24:     0x7ff80d741345 - &lt;unknown&gt;
</code></pre>
<h2>Context</h2>
<ul>
<li>Python 3.12.4</li>
<li>MacOS Sonoma 14.6</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[Panic] ruff crash when executed from a deleted folder on mac" to "[Panic] ruff crashes when executed from a deleted folder on mac" by @cbeauchesne on 2025-03-21 18:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-03-21 18:40</div>
            <div class="timeline-body"><p>Thanks for the report! I think this is pretty much the expected behavior and was reported before in https://github.com/astral-sh/ruff/issues/16017.</p>
<p>It would be a pretty defensive check to ensure that the current working directory exists, but I guess we <em>could</em> do it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @ntBre on 2025-03-21 18:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cbeauchesne">@cbeauchesne</a> on 2025-03-21 20:17</div>
            <div class="timeline-body"><p>I see two ~good~ not so bad reasons for handling this :</p>
<ul>
<li>saving 3s of user's brain when it happen, users loves nice and polished CLIs</li>
<li>saving yourself to respond to the same issue that may come later (I loved your output with the link to create an issue üëç  -&gt; as a side effect, we're strongly encouraged to create them)</li>
</ul>
<p>BTW, I take the opportunity to congrats, I replaced black+pylint by ruff months ago, and it working amazingly well !!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-03-21 20:51</div>
            <div class="timeline-body"><p>I think those are good points. And thank you for the kind words!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @ntBre on 2025-03-21 20:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2025-03-21 20:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/17054.html">astral-sh/ruff#17054</a> on 2025-03-28 23:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-04-01 12:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-04-01 12:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:15 UTC
    </footer>
</body>
</html>
