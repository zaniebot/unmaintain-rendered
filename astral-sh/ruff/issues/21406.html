<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIM108 is blocked by annotations - astral-sh/ruff #21406</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>SIM108 is blocked by annotations</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/21406">#21406</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-11-12 14:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-11-12 14:33</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><a href="https://docs.astral.sh/ruff/rules/if-else-block-instead-of-if-exp/"><code>if-else-block-instead-of-if-exp</code> (SIM108)</a> should apply when the assignment in the <code>if</code> block (though not the one in the <code>else</code> block) is annotated. <a href="https://play.ruff.rs/851d6427-dcb3-4325-b173-3028c0a500a1">Example</a>:</p>
<pre><code class="language-console">$ cat &gt;sim108.py &lt;&lt;'# EOF'
def f(x: object) -&gt; int:
    if x:
        y: int = 1
    else:
        y = 2
    return y
# EOF

$ ruff --isolated check sim108.py --select SIM108 --unsafe-fixes --fix
All checks passed!
</code></pre>
<p>The ideal fixed version is:</p>
<pre><code class="language-python">def f(x: object) -&gt; int:
    y: int = 1 if x else 2
    return y
</code></pre>
<h3>Version</h3>
<p>ruff 0.14.4 (c7ff9826d 2025-11-06)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-11-12 14:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21418.html">astral-sh/ruff#21418</a> on 2025-11-13 04:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-30 16:47</div>
            <div class="timeline-body"><p>I didn't realize this at the time, but this is actually a duplicate of an older issue: #15554. But thanks for the report, as always!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-12-30 16:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
