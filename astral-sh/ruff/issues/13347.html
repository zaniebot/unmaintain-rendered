<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detecting possible NameError: name 'var' is not defined - astral-sh/ruff #13347</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Detecting possible NameError: name 'var' is not defined</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13347">#13347</a>
        opened by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a>
        on 2024-09-13 14:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ashrub-holvi">@ashrub-holvi</a></div>
            <div class="timeline-body"><p>Hi,</p>
<p>Idea for a rule, PyCharm highlighting it, but don't see anything in ruff</p>
<p>file <code>test.py</code>:</p>
<pre><code># Copyright (c) 2021-2023 Mr XXX &lt;e@ma.il&gt;
&quot;&quot;&quot;The docs.&quot;&quot;&quot;


class MyError(Exception):
    &quot;&quot;&quot;The exception.&quot;&quot;&quot;


def func() -&gt; str:
    &quot;&quot;&quot;Something.

    Raises:
        MyError: desc.

    &quot;&quot;&quot;
    raise MyError


try:
    some_var = func()
except MyError as exception:
    if hasattr(exception, &quot;message&quot;):
        some_var = &quot;something&quot;
    # some_var is not defined in else case

print(some_var)  # noqa: T201
</code></pre>
<p>execution and ruff check:</p>
<pre><code>$ python3 test.py 
Traceback (most recent call last):
  File &quot;/.../test.py&quot;, line 26, in &lt;module&gt;
    print(some_var)  # noqa: T201
          ^^^^^^^^
NameError: name 'some_var' is not defined

$ ruff check --preview --isolated --select ALL test.py
...
All checks passed!
</code></pre>
<p>version: ruff 0.6.4</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-13 22:20</div>
            <div class="timeline-body"><p>Hi @ashrub-holvi</p>
<p>Correctly modelling try-except is surprisingly hard. @AlexWaygood is currently implementing just that (see https://github.com/astral-sh/ruff/pull/13338) for red knot, our new static analysis backend that eventually will power ruff. However, it will take us a while until we get there.</p>
<p>If you're open to using typed Python, consider using pyright or mypy (until we release red knot ;)). They both should be able to catch this kind of error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @MichaReiser on 2024-09-13 22:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-13 22:21</div>
            <div class="timeline-body"><p>I'll close this issue for now because there's no  &quot;easy&quot; fix to add this behavior to Ruff other than re-implementing what we're building for red knot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-09-13 22:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:05 UTC
    </footer>
</body>
</html>
