<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`--fix-only` returns exit code 1 upon fixes - astral-sh/ruff #4092</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>--fix-only</code> returns exit code 1 upon fixes</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4092">#4092</a>
        opened by <a href="https://github.com/spapanik">@spapanik</a>
        on 2023-04-25 09:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/spapanik">@spapanik</a></div>
            <div class="timeline-body"><p>Thank you for the great work! Ruff is fantastic, and I have replaced all my linters with it. I just have a small feature request on the fixers of it.</p>
<p>Now, the cli options to fix the ruff issues are: <code>ruff --fix .</code> and <code> ruff --fix-only .</code> They are a bit problematic to work with in scripts, as even if they fix all the issues that are fixable, the exit code can be zero, if there are no fixable issues. There is the obvious workaround of adding <code>|| true</code>, but this will mask all errors, for example ruff itself panicking instead of fixing the fixable issues. A new option that would allow just run it in fix mode.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-04-25 11:52</div>
            <div class="timeline-body"><p>Would <a href="https://beta.ruff.rs/docs/configuration/#exit-codes"><code>--exit-non-zero-on-fix</code></a> work for you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spapanik">@spapanik</a> on 2023-04-25 15:05</div>
            <div class="timeline-body"><p>@JonathanPlasse it does exactly the opposite. I was looking for a <code>--exit-zero-on-fix</code>. Let me explain the scenario: I have two errors in my code: <code>I001</code> which is fixable, and <code>N801</code> that&#x27;s not fixable. What I would like to do is run it, fix <code>I001</code> and return 0, because it successfully fixed all the fixable errors. Now, the closest is to do <code>ruff --fix-only . || true</code> but this means that if ruff breaks, I will still get an exit code 0, which is wrong.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-25 15:09</div>
            <div class="timeline-body"><p>I assumed that if you run Ruff in that scenario with <code>ruff --fix-only .</code>, and it fixed <code>I001</code> but left <code>N801</code>, it would exit with code 0. Does it not?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-25 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spapanik">@spapanik</a> on 2023-04-25 18:10</div>
            <div class="timeline-body"><p>No, it doesn&#x27;t:</p>
<pre><code>venv:(***)$ ~/programming/*** git:(main) ✗
stephanos@marco $ ruff --fix-only foo.py
Fixed 1 error.
venv:(***)$ ~/programming/*** git:(main) ✗
stephanos@marco $ echo $?
1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-26 03:55</div>
            <div class="timeline-body"><p>Ahh ok, that strikes me as a bug, but will look into it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-26 03:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Fix mode&quot; to &quot;`--fix-only` returns exit code 1 upon fixes&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-26 03:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-29 03:59</div>
            <div class="timeline-body"><p>I guess, in this framing, <code>ruff --fix-only</code> would <em>always</em> return 0 (unless the program hit an internal error), whereas <code>ruff --fix-only --exit-non-zero-on-fix</code> would return 1 when at least one error was fixed. Is that right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-04 19:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:35 UTC
    </footer>
</body>
</html>
