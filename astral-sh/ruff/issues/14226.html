<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Allow re-including directories that were excluded in parent config - astral-sh/ruff #14226</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Allow re-including directories that were excluded in parent config</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14226">#14226</a>
        opened by <a href="https://github.com/nuncaeslupus">@nuncaeslupus</a>
        on 2024-11-09 15:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/nuncaeslupus">@nuncaeslupus</a> on 2024-11-09 15:21</div>
            <div class="timeline-body"><p>Searched keywords: &quot;include&quot;, &quot;exclude&quot;, &quot;extend-include&quot;, &quot;extend-exclude&quot;
Ruff version: 0.3.0</p>
<h2>Use Case</h2>
<p>When using <code>extend</code> to inherit from a parent <code>pyproject.toml</code>, there's currently no way to selectively re-include directories that were excluded using <code>extend-exclude</code> in the parent config. This is particularly problematic when:</p>
<ol>
<li>Working with team configurations where the root <code>pyproject.toml</code> is tracked in version control and excludes certain directories</li>
<li>Developers want to apply Ruff to those excluded directories in their local development environment without modifying the team's config</li>
</ol>
<h2>Current Workarounds</h2>
<p>Currently, the only workarounds are:</p>
<ul>
<li>Create a completely separate config without extending the parent (requires manual syncing of settings)</li>
<li>Write a script to sync configurations while removing exclusions</li>
<li>Modify team's config to use more specific exclusion patterns</li>
</ul>
<p>Neither solution is ideal as they either require extra maintenance or modify team-wide settings.</p>
<h2>Proposed Solution</h2>
<p>Add the ability to re-include previously excluded directories, either through:</p>
<ol>
<li>A new <code>include-dirs</code> option that would take precedence over <code>extend-exclude</code>:</li>
</ol>
<pre><code class="language-toml">[tool.ruff]
extend = &quot;../pyproject.toml&quot;  # Parent has extend-exclude = [&quot;tmp&quot;]
include-dirs = [&quot;tmp&quot;]  # Override the exclusion for this directory
</code></pre>
<ol start="2">
<li>Or allow <code>extend-exclude = []</code> to clear inherited exclusions, then redefine them as needed:</li>
</ol>
<pre><code class="language-toml">[tool.ruff]
extend = &quot;../pyproject.toml&quot;
extend-exclude = []  # Clear inherited exclusions
</code></pre>
<p>This would provide more flexibility for local development workflows while maintaining team-wide configurations.</p>
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-09 23:07</div>
            <div class="timeline-body"><p>What happens if you put your local settings in a <code>ruff.toml</code> file that is gitignored? That should take precedence over the pyproject config: https://docs.astral.sh/ruff/configuration/#config-file-discovery</p>
<p>(Sorry - I can't quite tell if this coincides with one of your workaround bullets).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @dylwil3 on 2024-11-10 00:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nuncaeslupus">@nuncaeslupus</a> on 2024-11-10 09:04</div>
            <div class="timeline-body"><blockquote>
<p>What happens if you put your local settings in a <code>ruff.toml</code> file that is gitignored? That should take precedence over the pyproject config: https://docs.astral.sh/ruff/configuration/#config-file-discovery</p>
</blockquote>
<p>But do you mean a <code>ruff.toml</code> full settings file or one that includes <code>extend = &quot;pyproject.toml&quot;</code>?</p>
<p>What I need is to use the general settings but overwrite some of them. Concretely, I want the folder &quot;tmp&quot; inside the main folder to be taken into account by ruff, even if the main <code>pyproject.toml</code> file states it shouldn't. If I create a modified copy of the main <code>pyproject.toml</code>, I must be aware of any changes made to it to update my local settings file, which I would prefer not to do.</p>
<p>BTW, I'm using it with VSCode extension, so I tell the extension explicitly where to find the config file via the <code>--config</code> command-line arg.</p>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-10 09:22</div>
            <div class="timeline-body"><p>Have you tried using exclude instead of extend-exclude in the inherited configuration? Exclude should clear out the inherited rules</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2024-11-10 09:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nuncaeslupus">@nuncaeslupus</a> on 2024-11-10 11:11</div>
            <div class="timeline-body"><blockquote>
<p>Have you tried using exclude instead of extend-exclude in the inherited configuration? Exclude should clear out the inherited rules</p>
</blockquote>
<p>I used <code>exclude = [&quot;tmp&quot;]</code> in the main settings file and <code>exclude = []</code> in my local file and it worked!</p>
<p>Actually, the main file had no <code>exclude</code> setting. What is the difference between both?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-10 15:28</div>
            <div class="timeline-body"><p>I'm glad to hear that. extend-exclude adds additional entries and exclude replaces them</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-11-10 15:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nuncaeslupus">@nuncaeslupus</a> on 2024-11-10 15:30</div>
            <div class="timeline-body"><p>Thank you both, @dylwil3 and @MichaReiser!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:35:41 UTC
    </footer>
</body>
</html>
