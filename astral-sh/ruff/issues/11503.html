<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docs: Microsoft Visual C++ 2015 Redistributable is required on Windows - astral-sh/ruff #11503</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Docs: Microsoft Visual C++ 2015 Redistributable is required on Windows</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/11503">#11503</a>
        opened by <a href="https://github.com/jborbely">@jborbely</a>
        on 2024-05-23 00:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jborbely">@jborbely</a> on 2024-05-23 00:54</div>
            <div class="timeline-body"><p><strong>OS</strong>: Windows 10
<strong>ruff</strong>: version 0.4.4 (installed via <code>pipx</code>)</p>
<h2>Issue</h2>
<p><code>ruff.exe</code> silently fails to run from the terminal if Microsoft Visual C++ 2015 Redistributable is not installed.</p>
<p>Running</p>
<pre><code class="language-console">&gt; ruff --version
</code></pre>
<p>does not show the version in the terminal nor is an error shown. Complete silence.</p>
<p>Double-clicking the executable, located at <code>..\pipx\venvs\ruff\Scripts\ruff.exe</code>, pops-up the following window</p>
<p><img src="https://github.com/astral-sh/ruff/assets/4319367/7f97100e-2827-4afc-8d9e-5577dbbdb57d" alt="vcruntime140-error" /></p>
<h2>Fix</h2>
<p>Install Microsoft Visual C++ 2015 Redistributable, then</p>
<pre><code class="language-console">&gt; ruff --version
ruff 0.4.4
</code></pre>
<h2>Suggestion</h2>
<p>Perhaps adding something to the docs (https://docs.astral.sh/ruff/installation/) for Windows users that Microsoft Visual C++ 2015 Redistributable must be installed. Either provide the download link (https://www.microsoft.com/en-us/download/details.aspx?id=52685) and/or specify the command to run to install it <code>winget install --exact --id Microsoft.VCRedist.2015+.x64</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @charliermarsh on 2024-05-23 02:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2024-05-23 09:24</div>
            <div class="timeline-body"><p>Currently Windows builds uses <code>msvc</code> runtime. we can eaither use different runtime (using mingw), or statically link it into binary <a href="https://devblogs.microsoft.com/cppblog/msvc-address-sanitizer-one-dll-for-all-runtime-configurations/">at link time</a> which causes larger binary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jborbely">@jborbely</a> on 2024-05-23 20:05</div>
            <div class="timeline-body"><p>Certainly, those additional options would resolve the external VCRUNTIME###.dll dependency issue. I do not have a preference for which option (update docs, use mingw, statically link, ...) the maintainers of <code>ruff</code> decide to go with.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11451.html">astral-sh/ruff#11451</a> on 2024-05-23 20:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-27 15:57</div>
            <div class="timeline-body"><p>@BurntSushi what's your experience with statically linking the CRT on windows? Any drawbacks that you've become aware after shipping the change in ripgrep?</p>
<p>https://github.com/BurntSushi/ripgrep/blob/35160a1cdb4c7e2c370e8a7fad6508ff922a33c2/.cargo/config.toml#L4C8-L8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-05-28 12:05</div>
            <div class="timeline-body"><blockquote>
<p>@BurntSushi what's your experience with statically linking the CRT on windows? Any drawbacks that you've become aware after shipping the change in ripgrep?</p>
<p>https://github.com/BurntSushi/ripgrep/blob/35160a1cdb4c7e2c370e8a7fad6508ff922a33c2/.cargo/config.toml#L4C8-L8</p>
</blockquote>
<p>Not that I'm aware of! It's been without incident to the point that I totally forgot that this change even happened. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-05-28 12:06</div>
            <div class="timeline-body"><p>Also, ripgrep's msvc zip archive size went from ~1.6MB in ripgrep 13 to ~1.9MB in ripgrep 14. So at least in compressed form, the size difference seems tolerable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-28 16:07</div>
            <div class="timeline-body"><p>Would someone be interested in contributing the change to Ruff? It requires porting the configuration from ripgrep to ruff and doing a quick analysis of the file size change between the two versions (release mode).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @MichaReiser on 2024-05-28 16:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2024-05-28 20:39</div>
            <div class="timeline-body"><p>Can I take this one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jborbely">@jborbely</a> on 2024-05-28 20:45</div>
            <div class="timeline-body"><blockquote>
<p>Can I take this one?</p>
</blockquote>
<p>@T-256 definitely okay with me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-28 20:46</div>
            <div class="timeline-body"><p>Go for it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11589.html">astral-sh/ruff#11589</a> on 2024-05-28 23:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @T-256 by @charliermarsh on 2024-05-29 00:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-05-29 12:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/uv/pulls/10375.html">astral-sh/uv#10375</a> on 2025-01-07 18:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:53 UTC
    </footer>
</body>
</html>
