<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider analyze-graph for packages and producing graph? - astral-sh/ruff #13431</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider analyze-graph for packages and producing graph?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13431">#13431</a>
        opened by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a>
        on 2024-09-20 21:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/NeilGirdhar">@NeilGirdhar</a></div>
            <div class="timeline-body"><p>My <a href="https://github.com/NeilGirdhar/graph_imports/tree/main">Graph-Imports</a> package has been a useful tool in my development.  Now that Ruff has <code>ruff analyze graph</code>, it could be extended to supplant my tool if there's a desire.  Suggestions:</p>
<ul>
<li>Add a <code>--package</code> flag to switch from producing a graph of module imports to package imports (take the union over every module within a package?)</li>
<li>Add a <code>--output_image</code> flag to produce an actual image of the graph rather than text?</li>
</ul>
<p>I realize this may be out of scope, but I thought I'd suggest it since it might be easy to do.  (The source for graph-imports is quite short: https://github.com/NeilGirdhar/graph_imports/blob/main/graph_imports/<strong>init</strong>.py)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 21:24</div>
            <div class="timeline-body"><p>The first idea looks great. The second I have to think on a little more... It'd be nice to output in a format that visualization tools can support, like <a href="https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/creating-diagrams">Mermaid</a>? But that's just my immediate reaction :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @charliermarsh on 2024-09-20 21:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">analyze</span> added by @charliermarsh on 2024-09-20 21:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a> on 2024-09-20 21:46</div>
            <div class="timeline-body"><p>One last suggestion:  The main reason I even have this tool is to detect cycles.  I think that even cycles between package imports reveals a possible design error.  So, reporting cycles here may also be something to consider.</p>
<p>PS Love all the new tools you guys are making by the way.  UV has totally revolutionized my workflow with how fast it is compared with poetry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 21:59</div>
            <div class="timeline-body"><p>Oh yeah cycles is very cool. The infrastructure we built here also supports tracing third-party dependencies so we can add that eventually too which is fun.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/purajit">@purajit</a> on 2024-12-30 05:42</div>
            <div class="timeline-body"><p>Big +1! I've implemented cycle detection as well (which I assume will eventually be part of ruff's port of R0401 once the design for file traversal is decided; I was impatient and also wanted to include a list of the most problematic edges - edges that if removed would break the most cycles), and also a drop-in replacement for import-linter, and it requires some faffing to get the module paths. So a +1 to third-party deps inclusion as well!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nickdrozd">@nickdrozd</a> on 2025-01-06 19:51</div>
            <div class="timeline-body"><p>Pyreverse produces import graphs in various formats (Graphviz, Mermaid, etc). It would be useful to have something like that.</p>
<p>https://pylint.readthedocs.io/en/latest/additional_tools/pyreverse/index.html</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmr232">@tmr232</a> on 2025-08-29 19:48</div>
            <div class="timeline-body"><p>If producing a graphviz output, clustering by package hierarchy would also be nice, and improve readability.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rgon">@rgon</a> on 2025-09-03 10:07</div>
            <div class="timeline-body"><p>I have implemented graph generation in python here, it's similar to the <code>packages</code> output of <code>pyreverse</code>:
https://gist.github.com/rgon/115595265b1d5566f5734eb04bf97736</p>
<p>It has to be run with a pipe, to fetch the data from <code>ruff analyze</code>, although since ruff is super fast, it's feasible to run it on CI without much manual labor:</p>
<pre><code class="language-sh">ruff analyze graph | python3 ./depgraph.py -c -fd
</code></pre>
<p>It also adds @tmr232 's suggestion to cluster by package and also by submodule, since it's quite more legible that way for larger projects!</p>
<p>It does not have:</p>
<ul>
<li>class reports like <code>pyreverse</code></li>
<li>cycle detection/highlighting</li>
</ul>
<p>Example output:
<img src="https://github.com/user-attachments/assets/9965cb70-1e90-40e8-b5ce-4124046d2a8e" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seddonym">@seddonym</a> on 2025-10-06 10:48</div>
            <div class="timeline-body"><p>Hi! Just came across this thread. I'm the maintainer of <a href="https://import-linter.readthedocs.io/">Import Linter</a>, <a href="https://grimp.readthedocs.io/">Grimp</a> (the Rust-based tool, used by Import Linter, that builds the graph of Python imports in the first place), and <a href="https://impulse-cli.readthedocs.io/">Impulse</a> (visualizes dependencies within Python projects).</p>
<p>We're currently working on <a href="https://github.com/seddonym/import-linter/pull/279">a new contract type for Import Linter that detects cycles</a>, may be of interest.</p>
<p>I'm not sure what plans Astral has in this space, but do reach out if you see any opportunities for collaboration!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:07 UTC
    </footer>
</body>
</html>
