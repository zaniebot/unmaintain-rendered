```yaml
number: 3630
title: "isort: bad interaction between `force-sort-within-sections` and `force-to-top`"
type: issue
state: closed
author: bluetech
labels:
  - bug
  - isort
assignees: []
created_at: 2023-03-20T16:47:25Z
updated_at: 2023-03-22T18:00:02Z
url: https://github.com/astral-sh/ruff/issues/3630
synced_at: 2026-01-10T01:56:46Z
```

# isort: bad interaction between `force-sort-within-sections` and `force-to-top`

---

_Issue opened by @bluetech on 2023-03-20 16:47_

Given this config:

```toml
[tool.isort]
force_to_top = ["typing"]
force_sort_within_sections = true

[tool.ruff]
select = ["I001"]
[tool.ruff.isort]
force-to-top = ["typing"]
force-sort-within-sections = true
```

and this isort-clean file:

```py
from typing import Any
import abc
from abc import ABCMeta
import os
```

ruff fix gives:

```py
import abc
import os
from typing import Any
from abc import ABCMeta
```

It looks like `force-sort-within-sections` (which says to not sort the `import`s and `from`s separately) is ignored. But if I comment out the `force-to-top = ["typing"]` setting, ruff gives:

```py
import abc
from abc import ABCMeta
import os
from typing import Any
```

which is correct. So I'm guessing the two settings together cause the issue.

(I'll try to fix this issue when I get a chance, unless someone beats me to it)

Version: ruff 0.0.257

---

_Label `bug` added by @charliermarsh on 2023-03-20 19:02_

---

_Label `isort` added by @charliermarsh on 2023-03-20 19:02_

---

_Referenced in [astral-sh/ruff#3645](../../astral-sh/ruff/pulls/3645.md) on 2023-03-21 11:00_

---

_Closed by @charliermarsh on 2023-03-22 18:00_

---
