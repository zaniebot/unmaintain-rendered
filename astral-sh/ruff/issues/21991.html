<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&quot;ruff: noqa&quot; does not suppress invalid-syntax - astral-sh/ruff #21991</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>&quot;ruff: noqa&quot; does not suppress invalid-syntax</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/21991">#21991</a>
        opened by <a href="https://github.com/brandonchinn178">@brandonchinn178</a>
        on 2025-12-15 19:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/brandonchinn178">@brandonchinn178</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have a file with invalid syntax, but adding <code># ruff: noqa</code> to the top doesn't suppress <code>invalid-syntax</code> failures.</p>
<p>I could exclude it from the ruff CLI command in the first place, but this is a monorepo, and I'd prefer to exclude it directly in the file instead of a monorepo global file.</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-15 22:16</div>
            <div class="timeline-body"><p>Thanks for the report!</p>
<p>It sounds like this is working as intended. Ruff doesn't let you suppress invalid syntax errors because they should be guaranteed to cause an error if you run the code. Are you seeing a false positive on a syntax error, or do you want to suppress it for another reason?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @ntBre on 2025-12-15 22:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brandonchinn178">@brandonchinn178</a> on 2025-12-16 00:06</div>
            <div class="timeline-body"><p>In our case, we have a Python file like</p>
<pre><code>foo = %s
</code></pre>
<p>The file will be templated by C++ code at runtime. We could probably work around it, but it would be nice if <code>noqa</code> Just Worked. I understand if the ruff team considers this Not A Bug, though</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-12-16 04:48</div>
            <div class="timeline-body"><p>You could put a <code>ruff.toml</code> in the directory/directories that house your C++-modified code. In there you could <a href="https://docs.astral.sh/ruff/settings/#extend-exclude">extend-exclude</a> the relevant glob of files. Does that seem like an okay workaround?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brandonchinn178">@brandonchinn178</a> on 2025-12-16 05:08</div>
            <div class="timeline-body"><p>Not for us, I don't believe, since exclude/extend-exclude only applies when running ruff on a directory, but pre-commit hooks only run on modified files, so we explicitly pass a list of files to ruff. The only way to exclude a file is in the top-level exclusion file.</p>
<p>But it's fine. We can make do. Just wanted to clarify if this is intentional behavior</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-12-16 06:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:53:42 UTC
    </footer>
</body>
</html>
