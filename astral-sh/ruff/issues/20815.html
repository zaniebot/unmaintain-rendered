<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature to subset `--select` with configuration ignores - astral-sh/ruff #20815</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Feature to subset `--select` with configuration ignores</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/20815">#20815</a>
        opened by <a href="https://github.com/fmigneault">@fmigneault</a>
        on 2025-10-12 03:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/fmigneault">@fmigneault</a> on 2025-10-12 03:41</div>
            <div class="timeline-body"><h3>Summary</h3>
<h2>Description</h2>
<p>When a project defines a <code>pyproject.toml</code> with a large list of <code>select</code>, <code>ignore</code> and <code>per-file-ignores</code> linting conditions, essentially documenting how this project is expected to be validated, running <code>ruff</code> on it with a lot of changes can potentially create a very large amount of errors.</p>
<p>A developer that would have to address the errors would likely prefer to address them &quot;contextually&quot;.
For example, focusing on documentation issues by themselves (codes: D, DOC, etc.), before moving to other kind of issues, like recommendations (codes: SIM, UP, etc.).</p>
<p>However, the current options to &quot;filter&quot; a set of rules (ie: <code>--select</code> or <code>--extend-select</code>) do not seem to consider the configuration (<code>--config</code>). In other words, doing the following will re-enable all <code>D</code> rules, regardless of any <code>ignore = [&quot;D...&quot;]</code> values defined in the <code>pyproject.toml</code> file.</p>
<pre><code class="language-shell">ruff check --config pyproject.toml --select D
</code></pre>
<p>It would be useful to have an option, such as a <code>--select-filter D</code> or similar, that would essentially perform the same checks as if running <code>ruff check</code> with the detected or provided configuration, while limiting the rules only to the given subset (but not overriding ignores). If using a specific code (eg: <code>--select D100</code>), the current behavior would work. This &quot;filter&quot; feature is relevant along the behavior of partial rule codes that activates a large amount of codes.</p>
<h2>Example</h2>
<p>I run <code>ruff check --config pyproject.toml</code> on this project branch (https://github.com/fmigneault/aiu/tree/modernize), I receive 0 errors, since all <code>select</code>/<code>ignore</code> are applied as intended.</p>
<p>If I run <code>ruff check --config pyproject.toml --select D</code>, the multiple D ignores (https://github.com/fmigneault/aiu/blob/e5ae36ce17b9102f3a838398e2423f6cfd133d6d/pyproject.toml#L141-L153) are re-enabled (rightly so since &quot;D&quot; selected), but causing many unintended detection of &quot;D&quot;-codes expected to be ignored.</p>
<p>Current workaround involves listing all D... codes in <code>--select</code>, which does not scale and is a burden.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fmigneault">@fmigneault</a> on 2025-10-12 03:45</div>
            <div class="timeline-body"><p>Similar to #20625</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @MichaReiser on 2025-10-12 06:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @MichaReiser on 2025-10-12 06:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-12 06:41</div>
            <div class="timeline-body"><p>Thanks for the detailed write-up! It made it easy to understand your use case.</p>
<p>I'm a bit hesitant of adding more <code>--select</code> options as they already tend to confuse users.</p>
<p>I could see a few possibilities:</p>
<ul>
<li>Support negated <code>ignore</code>. That would allow you to write <code>--ignore ALL --ignore !D</code> to ignore all rules except <code>D</code>, while respecting the rules selected with <code>--select</code> and <code>--extend-select</code>. I think this should also be compatible with the rule selection that we introduced in ty (which we might port over to ruff at some point)</li>
<li>Support this as part of an interactive CLI review mode.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fmigneault">@fmigneault</a> on 2025-10-12 18:51</div>
            <div class="timeline-body"><p>If using <code>--ignore ALL --ignore !D</code>, I think I would end up with the inverse problem, that is, that I have to list all <code>!D...</code> I want to consider (the ones not ignored in the config), which is also a long list.</p>
<p>Another possibility would be for <code>--select ...</code> not to override other field indicated by <code>--config ...</code> (or auto-detected), but I think that could break expectations for users relying on the current behavior, which is why I think another option would be required. That being said, there is also an <code>--isolated</code> option, so users that would want the current behavior could use <code>--select ... --isolated</code> explicitly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-13 07:15</div>
            <div class="timeline-body"><blockquote>
<p>If using --ignore ALL --ignore !D, I think I would end up with the inverse problem, that is, that I have to list all !D... I want to consider (the ones not ignored in the config), which is also a long list.</p>
</blockquote>
<p>Yeah, I think you're right</p>
<p>I thought more about this and I don't think we should make rule selection even more complicated, as it already is one of the most complicated parts. This approach might also no longer be supported after #1774 where rules are no longer categorized by linter.</p>
<p>What I'd do is to update the <code>select</code> in the configuration and comment out all rules that aren't <code>D</code>. I can then check all <code>D</code> rules. Once done, revert the configuration change and comment out another batch of rules.</p>
<p>While not ideal, I don't think it's too bad.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-10-13 07:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-10-13 07:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fmigneault">@fmigneault</a> on 2025-10-14 04:37</div>
            <div class="timeline-body"><p>Is there any chance the categorization logic could be reused to define &quot;per-linter&quot; categories as well?
While I think #1774 is also a great addition for broader categories, when errors happen, they are associated with certain error codes. If the codes are associated to certain kind of errors, they are natively a good way to regroup them.</p>
<p>There are some linters like flake8 (and its many plugins) that are definitely multi-purpose, and might not be that great for categories, but others like flynt, mypy, isort, pydocstyle for example have very specific purpose that fit nicely into categories (i.e.: fix strings, typings, imports, docstrings respectively).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
