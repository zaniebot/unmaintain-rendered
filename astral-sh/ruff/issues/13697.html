<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature request: `black` compatibility mode - astral-sh/ruff #13697</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature request: <code>black</code> compatibility mode</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13697">#13697</a>
        opened by <a href="https://github.com/cramertj">@cramertj</a>
        on 2024-10-09 23:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/cramertj">@cramertj</a></div>
            <div class="timeline-body"><p><a href="https://docs.astral.sh/ruff/formatter/#black-compatibility">Ruff's website says</a>:</p>
<blockquote>
<p>The formatter is designed to be a drop-in replacement for <a href="https://github.com/psf/black">Black</a>.</p>
<p>Specifically, the formatter is intended to emit near-identical output when run over Black-formatted code.</p>
</blockquote>
<p>However, there is <a href="https://docs.astral.sh/ruff/formatter/black/">an extensive list of differences</a> between the output of the two formatters. On my project, I was not able to configure <code>ruff</code> and <code>black</code> in such a way that the two would result in the same output, or even allow the output of the other to go unchanged. <a href="http://pwrev.dev/c/241197/1">The diffs I saw can be seen here</a>.</p>
<p>If <code>black</code>-compatibility or gradual migration from <code>black</code> is a goal, it would be very helpful to offer a mode which allows the output of <code>black</code> to go unchanged. Without this, transitioning between the two formatters requires synchronized changes to both the formatter and the code being formatted.</p>
<p>I understand this may be a non-goal, but I figured it was worth raising here since the website explicitly lists Black compatibility as a goal/feature.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-10 01:36</div>
            <div class="timeline-body"><p>Is the right side of the diff there Ruff's output? If so, I think most of those are pretty clear improvements to the format. I understand it's tough to use both formatters at once though.</p>
<p>We are targeting Black compatibility, but it's very hard to reach 100% compatibility due to architectural differences. During the initial implementation, we spent time trying to close the gap from 99% -&gt; 100% (e.g., https://github.com/astral-sh/ruff/pull/6343). I'm not sure how feasible it is to get closer. In the long term, we will probably diverge further from Black as we want to improve the produced format. Unfortunately, it's very hard to maintain multiple &quot;modes&quot; of the formatter, which is part of why we support a limited number of settings. I think this is a significant burden to a compatible mode as well.</p>
<p>cc @MichaReiser</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @zanieb on 2024-10-10 01:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2024-10-10 14:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-10 14:17</div>
            <div class="timeline-body"><p>We have goal to match Black closely so that migrating from black to ruff results in none or only very few code changes.</p>
<p>Achieving 100% compatibility is a non goal. It would require us to re-implement bugs in black or make our formatting worse just for compatibility.</p>
<blockquote>
<p>transitioning between the two formatters requires synchronized changes to both the formatter and the code being formatted.</p>
</blockquote>
<p>I recommend you against switching between formatters and instead advise you to commit to one (Black or Ruff).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-10-10 14:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:14 UTC
    </footer>
</body>
</html>
