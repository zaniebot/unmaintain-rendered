<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recognize charsets in different orders (`FURB156`) - astral-sh/ruff #21144</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Recognize charsets in different orders (`FURB156`)</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/21144">#21144</a>
        opened by <a href="https://github.com/njourdane">@njourdane</a>
        on 2025-10-30 15:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/njourdane">@njourdane</a> on 2025-10-30 15:23</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Instead of:</p>
<pre><code class="language-py">if c in &quot;abcdefghijklmnopqrstuvwxyz&quot;:
    print(c)
</code></pre>
<p>Use:</p>
<pre><code class="language-py">from string import ascii_lowercase
if c in ascii_lowercase:
    print(c)
</code></pre>
<p>And more generally:</p>
<ul>
<li><code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ</code> -&gt; <code>string.ascii_letters</code></li>
<li><code>abcdefghijklmnopqrstuvwxyz</code> -&gt; <code>string.ascii_lowercase</code></li>
<li><code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code> -&gt; <code>string.ascii_uppercase</code></li>
<li><code>0123456789</code> -&gt; <code>string.digits</code></li>
<li><code>0123456789abcdefABCDEF</code> -&gt; <code>string.hexdigits</code></li>
<li><code>01234567</code> -&gt; <code>string.octdigits</code></li>
</ul>
<p>The main reason is, when using a string literal like <code>abcdefghijklmopqrstuvwxyz</code> it's not abvious when a letter is missing (oops, just did it, did you see it?), so it's a potential source of errors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-30 16:09</div>
            <div class="timeline-body"><p>This makes sense to me. Clippy has a similar <a href="https://rust-lang.github.io/rust-clippy/master/index.html#manual_is_ascii_check"><code>manual_is_ascii_check</code></a> too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-10-30 16:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-30 16:10</div>
            <div class="timeline-body"><p>Oh, actually we have an existing rule for this in preview: <a href="https://docs.astral.sh/ruff/rules/hardcoded-string-charset/#hardcoded-string-charset-furb156">hardcoded-string-charset (FURB156)</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> removed by @ntBre on 2025-10-30 16:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @ntBre on 2025-10-30 16:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njourdane">@njourdane</a> on 2025-10-31 08:26</div>
            <div class="timeline-body"><p>Great!</p>
<p>A suggestion: when using the <code>in</code> keyword, the rule could work whatever the letters order.</p>
<p>Ie. these lines are similar*, but only the first one is detected by the linter:</p>
<p><img width="235" height="64" alt="Image" src="https://github.com/user-attachments/assets/918002ce-6c6e-41c0-94de-90655e8688e4" /></p>
<p>https://play.ruff.rs/36ad710a-cafd-42ba-8dce-6778299bdbe5</p>
<p>*It's not exactly the same because the iteration order differs, but I guess it's a very specific use-case to check in a specific order.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-31 13:04</div>
            <div class="timeline-body"><p>Ah that's a good point. There's code in the rule for constructing bitsets of characters, but then we don't convert the input to a set for the comparison. The set field is actually completely unused from what I can tell.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @ntBre on 2025-10-31 13:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-10-31 13:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Rule request: avoid boilerplate string litterals." to "Recognize charsets in different orders (`FURB156`)" by @ntBre on 2025-10-31 13:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-11-01 02:08</div>
            <div class="timeline-body"><p>I looked into this a bit more and was going to make the set change, but I found https://github.com/astral-sh/ruff/issues/13802 and #14233. It's actually intentional that we only perform the check for that exact order because otherwise the diagnostic and fix is likely to be incorrect if <code>x</code> in your example isn't a single character:</p>
<pre><code class="language-pycon">&gt;&gt;&gt; import string
&gt;&gt;&gt; '1' in '1234567890'
True
&gt;&gt;&gt; '012' in '1234567890'
False
&gt;&gt;&gt; '012' in string.digits
True
</code></pre>
<p>So I'll close this for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-11-01 02:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21181.html">astral-sh/ruff#21181</a> on 2025-11-01 02:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
