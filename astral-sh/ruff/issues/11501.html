<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Bandit suspicious import rules into a single configurable rule - astral-sh/ruff #11501</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Make Bandit suspicious import rules into a single configurable rule</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/11501">#11501</a>
        opened by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a>
        on 2024-05-23 00:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a> on 2024-05-23 00:01</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Remove all rules from S401 to S415 (suspicious imports) and create a single S400 rule that says</p>
<p><code>&quot;Possibly insecure import {import_name}: {reason}&quot;</code></p>
<p>Allow the imports being configured via command line</p>
<pre><code>[tool.ruff.lint.flake8_bandit]
suspicious_import = {&quot;marshal&quot; = &quot;Deserialization is possibly dangerous&quot;}

suspicious_import_include = {foobar = &quot;I dont like this one&quot;}

suspicious_import_exclude = [
  subprocess
]
</code></pre>
<p>To be honest, I just dont think these rules should exist since we have the TID253 configurable via <code>banned-module-level-imports</code>.</p>
<p>My issue is with these rules existing and not being in a good range that they can be ignored in bulk. I don't know if on next version we will get S416 or S420 (another range -- maybe I need to ignore the whole S4?) with more of these &quot;unsafe&quot; modules. In theory there could be thousands of unsafe modules and having multiple rules is just bad IMO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Make Bandit import rules into a single configurable rule" to "Make Bandit suspicious import rules into a single configurable rule" by @inoa-jboliveira on 2024-05-23 00:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/augustelalande">@augustelalande</a> on 2024-05-23 00:15</div>
            <div class="timeline-body"><p>If your goal is just to ignore them, you should be good to just ignore S4</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-23 02:05</div>
            <div class="timeline-body"><p>Yeah, <code>S4</code> is exactly the &quot;suspicious&quot; import rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-05-23 02:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
