<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S113 only considers `timeout=` probable, unpacking is not recognised. - astral-sh/ruff #9749</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>S113 only considers <code>timeout=</code> probable, unpacking is not recognised.</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9749">#9749</a>
        opened by <a href="https://github.com/rogier-stegeman">@rogier-stegeman</a>
        on 2024-02-01 07:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rogier-stegeman">@rogier-stegeman</a></div>
            <div class="timeline-body">

<p>Rule <a href="https://docs.astral.sh/ruff/rules/request-without-timeout/#request-without-timeout-s113">S113</a> does not consider anything except a hard-coded <code>request=</code> to be &quot;probable&quot;. This can be frustrating when one has a lot of configuration which is shared between many <code>requests</code> calls.</p>
<pre><code>from typing import TypedDict
import requests

requests.post(&#x27;test&#x27;, **{&quot;timeout&quot;: 1000})

class Options(TypedDict):
    timeout: int

options: Options = {&quot;timeout&quot;: 1000}

requests.post(&#x27;test&#x27;, **options)
</code></pre>
<p><code>ruff --select S113 --isolated test.py</code></p>
<blockquote>
<p>test.py:4:1: S113 Probable use of requests call without timeout
test.py:11:1: S113 Probable use of requests call without timeout
Found 2 errors.</p>
</blockquote>
<p>Version: ruff 0.1.15</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-01 14:13</div>
            <div class="timeline-body"><p>We could probably get this right in limited cases (e.g., defined in the same file, variable is <em>not</em> overloaded or assigned to multiple times). What&#x27;s the &quot;real&quot; setup that you have in your project? Mostly want to check if those &quot;limited cases&quot; would be useful to you or not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-01 14:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rogier-stegeman">@rogier-stegeman</a> on 2024-02-01 14:38</div>
            <div class="timeline-body"><p>I can&#x27;t share the actual code, but basically something like this.</p>
<pre><code>class RequestOptions(TypedDict):
    headers: dict[str, str]
    timeout: int

class MyClass:
    def __init__(self) -&gt; None:
        &quot;&quot;&quot;Initialises settings.&quot;&quot;&quot;
        self.options: RequestOptions = { 
          &#x27;headers&#x27;: {&#x27;Authorization&#x27;: f&#x27;Bearer {env.TIMECHIMP_TOKEN}&#x27;},
          &#x27;timeout&#x27;: 20000
        }

    def get(self, endpoint: str) -&gt; requests.Response:
        # More function parameters and request customisation here, irrelevant.
        return requests.get(endpoint, **self.options)
    
    # A lot more similar functions here, that all use self.options.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/camerondavison">@camerondavison</a> on 2024-07-24 20:25</div>
            <div class="timeline-body"><p>This may not be what you need/want but I would say that what I am seen most people do is create a _internal_request or such method in the MyClass and then call that instead. this way you have all the requests going through 1 method with just different params. basically mimicing what requests does internally with get just proxying to requests(&#x27;get&#x27;, ...)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:49 UTC
    </footer>
</body>
</html>
