<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Rule to avoid module coupling - astral-sh/ruff #10300</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Rule to avoid module coupling</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10300">#10300</a>
        opened by <a href="https://github.com/ndrluis">@ndrluis</a>
        on 2024-03-08 15:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ndrluis">@ndrluis</a></div>
            <div class="timeline-body"><p>Hello, I&#x27;m not a Pythonist, but I&#x27;m working on some Python projects and having a problem with how to avoid some import coupling.</p>
<p>For example:</p>
<pre><code># module_a.py

def func_a():
    pass

# module_b.py

from module_a import func_a

def func_b():
    func_a()

# module_c.py

from module_b import func_a  # This line should import func_a directly from module_a instead

def func_c():
    func_a()
</code></pre>
<p>We want to avoid having <code>func_a</code> imported from <code>module_b</code>; instead, we aim to import it directly from the original module where <code>func_a</code> is defined. Is it possible to create a rule that warns us?</p>
<p>Any thoughts on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mkniewallner">@mkniewallner</a> on 2024-03-09 19:59</div>
            <div class="timeline-body"><p>I believe that the feature would be similar to what https://github.com/seddonym/import-linter provides, right? Although less powerful than the library, in Ruff you should be able to achieve something similar with https://docs.astral.sh/ruff/rules/banned-api/.</p>
<p>https://github.com/astral-sh/ruff/issues/1912 exists to implement <code>import-linter</code> in Ruff as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eli-schwartz">@eli-schwartz</a> on 2024-03-10 04:25</div>
            <div class="timeline-body"><p>I recall searching for this feature and coming across import-linter, then disregarding it since import-linter seems to do something else entirely -- and require significant configuration to do so.</p>
<p>The problem is not actually about allowing or banning specific APIs from being used. The problem is that if you have a file that includes <code>import os</code>, &quot;os&quot; is a validly existing symbol reference inside your module and &quot;import mymodule.os&quot; works at runtime...</p>
<p>... but no one would actually consider this a reasonable usage of the &quot;os&quot; module. Because it&#x27;s an import.</p>
<p>This can be trivially detected in a heuristic manner, you don&#x27;t need to define rulesets for specific examples you don&#x27;t want to use. All you need to do is check whether your module&#x27;s public interface is being obeyed. It&#x27;s intrinsically tied to <code>__all__</code>.</p>
<p>It turns out that this works well together with static typing -- in particular, stub files will tend to never define an API you don&#x27;t publicly provide, even if the implementation itself happens to import stdlib modules ;) ;) ;) -- so mypy includes an option for it: https://mypy.readthedocs.io/en/stable/config_file.html#confval-implicit_reexport</p>
<p>I enabled the mypy option and caught a looooooot of cases where we were doing it in our codebase. :D</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eli-schwartz">@eli-schwartz</a> on 2024-03-10 04:27</div>
            <div class="timeline-body"><p>It sounds potentially interesting for ruff to implement that either in addition to or instead of import-linter. Unlike import-linter it has the advantage of by design not requiring any sort of configuration.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-11 16:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-design</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-11 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2024-08-09 07:28</div>
            <div class="timeline-body"><p>Looks like there is an alternative to import-linter written in Rust - https://github.com/gauge-sh/tach/</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:51 UTC
    </footer>
</body>
</html>
