<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sphinx and D409 - astral-sh/ruff #4555</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Sphinx and D409</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/4555">#4555</a>
        opened by <a href="https://github.com/Nodd">@Nodd</a>
        on 2023-05-21 01:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Nodd">@Nodd</a> on 2023-05-21 01:55</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>I have this nice code, which passes fine with ruff:</p>
<pre><code class="language-python">def foo(a):
    &quot;&quot;&quot;Summary

    Args:
    ----
    a: list
        parameter a
    &quot;&quot;&quot;
</code></pre>
<p>The problem is that Sphinx will throw a warning when building the documentation:</p>
<pre><code>***/lib/python3.11/site-packages/numpydoc/docscrape.py:460: UserWarning: potentially wrong underline length... 
Args: 
---- in 
***
... in the docstring of foo in ***.
  warn(msg)
</code></pre>
<p>Sphinx condiders that the comma is part of the title, so wants this:</p>
<pre><code class="language-python">def foo(a):
    &quot;&quot;&quot;Summary

    Args:
    -----
    a: list
        parameter a
    &quot;&quot;&quot;
</code></pre>
<p>but ruff is now unhappy with D409. I think that in this case ruff is wrong and Sphinx is right, the whole title should be underlined, including the colon.</p>
<p>Note that if I remove the colon, ruff triggers D416, so it's not a workaround.</p>
<p>This is with ruff 0.0.265.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-21 15:51</div>
            <div class="timeline-body"><p>Interesting... We have the same behavior as pydocstyle -- do you know if this has ever been reported or discussed in pydocstyle?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-05-21 15:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">docstring</span> added by @charliermarsh on 2023-05-21 15:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Nodd">@Nodd</a> on 2023-05-22 08:57</div>
            <div class="timeline-body"><p>I couldn't find it. I'll double-check the different docstring styles, it seems that when using <code>Args:</code> the title shouldn't be underlined at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-22 13:23</div>
            <div class="timeline-body"><p>What I'm seeing is that the NumPy standard actually wants you to omit the <code>:</code>, not increase the length of the underline. That's what I see in all the official examples.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Nodd">@Nodd</a> on 2023-05-22 13:37</div>
            <div class="timeline-body"><p>D409 and D416 correspond to different docstring styles : https://github.com/PyCQA/pydocstyle/blob/master/docs/error_codes.rst. From this link: D416 is incompatible with <code>numpy</code> style, while D409 is incompatible with <code>google</code> style. I'll have to choose one or the other.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Nodd on 2023-05-22 13:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
