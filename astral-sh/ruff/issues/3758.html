<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement more flake8-bugbear opinionated rules - astral-sh/ruff #3758</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement more flake8-bugbear opinionated rules</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3758">#3758</a>
        opened by <a href="https://github.com/sjdemartini">@sjdemartini</a>
        on 2023-03-27 16:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sjdemartini">@sjdemartini</a></div>
            <div class="timeline-body"><p>Picking up where https://github.com/charliermarsh/ruff/issues/2954 left off, there were a few opinionated (B9xx flake8-bugbear rules) checks left to be implemented in Ruff:</p>
<ul>
<li>[x]  B901: Using <code>return x</code> in a generator function. <em>(Somewhat bad reasoning in flake8-bugbear description, talks about Python 2, see comment here https://github.com/charliermarsh/ruff/issues/2954#issuecomment-1441162976 around its utility.)</em></li>
</ul>
<ul>
<li>[x] B902: <em>Implemented as N804 and N805.</em></li>
</ul>
<ul>
<li>[ ]  B903: Use <code>collections.namedtuple</code> (or <code>typing.NamedTuple</code>) for data classes that only set attributes in an <code>__init__</code> method, and do nothing else. <em>(Probably should include dataclasses recommendation? NamedTuple injects extra tuple methods and is meant for backward compat, not a data class replacement. That's <code>dataclasses</code> nowadays.)</em></li>
<li>[ ]  ~B906: <code>visit_</code> function with no further call to a <code>visit</code> function.~</li>
</ul>
<ul>
<li>[ ] B907: Consider replacing f&quot;'{foo}'&quot; with f&quot;{foo!r}&quot; which is both easier to read and will escape quotes inside foo if that would appear.</li>
<li>[x] B908: <em>Partly implemented as PT012</em>.</li>
</ul>
<p>There's an open question on how these should be included, since it would deviate from flake8-bugbear to have these on by default just by turning on the rest of the bugbear rules (see comment https://github.com/charliermarsh/ruff/issues/2954#issuecomment-1483594606).</p>
<p>There's also one outstanding non-opinionated rule:</p>
<ul>
<li>[x] B036: Found except BaseException: without re-raising (no raise in the top-level of the except block). This catches all kinds of things (Exception, SystemExit, KeyboardInterrupt...) and may prevent a program from exiting as expected. <em>Implemented as BLE001.</em></li>
<li>[x] B038: <em>Renamed to B909 in bugbear; implemented as B909 is Ruff.</em></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-03-27 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Pierre-Sassoulas">@Pierre-Sassoulas</a> on 2023-03-29 11:03</div>
            <div class="timeline-body"><p><code>B906</code> is flake8 plugins specific and has a false positive when the visit function is visiting an astroid node in a pylint plugin. It would be nice to not have this FP in ruff :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @charliermarsh on 2023-07-10 01:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikaelarguedas">@mikaelarguedas</a> on 2024-01-06 17:47</div>
            <div class="timeline-body"><p>Since then some new rule apppeared</p>
<ul>
<li>[ ] B907:  (previous B028)  Consider replacing <code>f&quot;'{foo}'&quot;</code> with <code>f&quot;{foo!r}&quot;</code> which is both easier to read and will escape quotes inside foo if that would appear. The check tries to filter out any format specs that are invalid together with !r. If you're using other conversion flags then e.g. <code>f&quot;'{foo!a}'&quot;</code> can be replaced with <code>f&quot;{ascii(foo)!r}&quot;</code>. Not currently implemented for python&lt;3.8 or str.format() calls.</li>
<li>[ ] B908: (looks like PT012 to me): Contexts with exceptions assertions like with <code>self.assertRaises</code> or with <code>pytest.raises</code> should not have multiple top-level statements. Each statement should be in its own context. That way, the test ensures that the exception is raised only in the exact statement where you expect it.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @charliermarsh on 2024-01-06 19:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @charliermarsh on 2024-01-06 19:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> removed by @charliermarsh on 2024-01-06 19:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-06 19:42</div>
            <div class="timeline-body"><p>Good first issues for anyone interested :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikaelarguedas">@mikaelarguedas</a> on 2024-01-14 10:10</div>
            <div class="timeline-body"><p>Another 2 rules appeared in flake8-bugbear:</p>
<ul>
<li><p>[x] B037: Found <code>return &lt;value&gt;</code>, <code>yield</code>, <code>yield &lt;value&gt;</code>, or <code>yield from &lt;value&gt;</code> in class <code>__init__()</code> method. No values should be returned or yielded, only bare returns are ok. (PLE0100)</p>
</li>
<li><p>[ ] B038: Found a mutation of a mutable loop iterable inside the loop body. Changes to the iterable of a loop such as calls to list.remove() or via del can cause unintended bugs. https://github.com/astral-sh/ruff/issues/9511</p>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2024-01-14 16:51</div>
            <div class="timeline-body"><p>B037 is already implemented as PLE0100, @charliermarsh maybe we should consider migrating PLE0100 to B037 though?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-14 17:07</div>
            <div class="timeline-body"><p>@Skylion007 - Yes good call -- I prefer indexing under bugbear over Pylint since it's more popular for Ruff users. I'll add a note to the 0.2.0 release list.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.2.0" by @MichaReiser on 2024-01-19 14:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-02-01 19:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikaelarguedas">@mikaelarguedas</a> on 2024-02-02 05:11</div>
            <div class="timeline-body"><p>@zanieb Was this closed on purpose ?</p>
<p>I'm under the impression that some rules listed here are not part of ruff yet:
B036, B038, B901, B902, B903, B907, B908</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-02 05:19</div>
            <div class="timeline-body"><p>@mikaelarguedas - I think it was an oversight, but I'll leave it to @zanieb to confirm in the AM.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mscheifer">@mscheifer</a> on 2024-05-07 22:04</div>
            <div class="timeline-body"><p>I think B036 is covered/aliased by BLE001.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mikaelarguedas">@mikaelarguedas</a> on 2024-05-08 14:06</div>
            <div class="timeline-body"><p>@charliermarsh @zanieb friendly :bellhop_bell: if it was closed by mistake, is it possible to reopen and update according to current state ?</p>
<p>Current state:
B036 -&gt; covered by BLE001
B038 -&gt; no implemented
B901 -&gt; no implemented
B902 -&gt;no implemented
B903 -&gt;no implemented
B907 -&gt;no implemented
B908 -&gt;no implemented</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @charliermarsh on 2024-05-08 14:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-08 14:19</div>
            <div class="timeline-body"><p>Will update the list, thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-08 14:52</div>
            <div class="timeline-body"><p>Updated. We do actually have B038 (which bugbear moved to B909).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "v0.2.0" by @dhruvmanila on 2024-06-29 05:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jnrbsn">@jnrbsn</a> on 2024-08-23 16:56</div>
            <div class="timeline-body"><p>This issue says that <code>B902</code> is &quot;Implemented as <code>N804</code> and <code>N805</code>&quot;, but that is not accurate because <code>N804</code> incorrectly says you should use <code>cls</code> for &quot;metaclass class methods&quot; (e.g. <code>__new__</code>, <code>__prepare__</code>). These methods are the metaclass-equivalent of class methods and get passed the <em><strong>metaclass itself</strong></em> as the first argument. flake8-bugbear recommends <code>metacls</code>, and pylint recommends <code>mcs</code> (which flake8-bugbear will also accept).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gagandeepp">@gagandeepp</a> on 2024-10-07 12:06</div>
            <div class="timeline-body"><p>Interesting task,can I help?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> removed by @charliermarsh on 2024-12-02 17:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> removed by @charliermarsh on 2024-12-02 17:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:54 UTC
    </footer>
</body>
</html>
