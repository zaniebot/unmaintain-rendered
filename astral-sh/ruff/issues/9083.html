<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scientific notation formatter misses f-strings - astral-sh/ruff #9083</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Scientific notation formatter misses f-strings</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/9083">#9083</a>
        opened by <a href="https://github.com/claydugo">@claydugo</a>
        on 2023-12-11 03:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/claydugo">@claydugo</a> on 2023-12-11 03:21</div>
            <div class="timeline-body"><p>Sorry for not listing the actual rule.
I tried all the flags in <code>ruff format --help</code> but never got an output that explains which rule is making the change.</p>
<p>I can update the title if pointed to which is doing it. Also is there a command I missed that outputs this? <code>--show-fixes</code> seems to be only a linter flag.</p>
<p>Reproduce:</p>
<pre><code class="language-python">int_variable = 3

fstring1 = f&quot;This string contains scientific notation. {int_variable * 1E-3}&quot;
fstring2 = f&quot;string containing scientific notation. {int_variable * 1E3:.2f}&quot;

variable_notation1 = 1E3
variable_notation2 = (int_variable * 1E-3)
</code></pre>
<p>Output of <code>ruff format --diff</code></p>
<pre><code class="language-patch">--- example.py
+++ example.py
@@ -3,5 +3,5 @@
 fstring1 = f&quot;This string contains scientific notation. {int_variable * 1E-3}&quot;
 fstring2 = f&quot;string containing scientific notation. {int_variable * 1E3:.2f}&quot;

-variable_notation1 = 1E3
-variable_notation2 = (int_variable * 1E-3)
+variable_notation1 = 1e3
+variable_notation2 = int_variable * 1e-3

1 file would be reformatted
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-12-11 03:36</div>
            <div class="timeline-body"><p>Hy @claydugo</p>
<p>There's no specific rule that performs this change. Instead, the formatter normalizes the scientific notation to consistently use the lowercase `e.  So, there's no rule that you need to enable or disable.</p>
<p>However, your observation is correct. The formatter doesn't format expressions inside f-strings yet (similar to black). @dhruvmanila started working on formatting expressions inside of f-strings, which should give you the desired behavior (including splitting expressions to make the f-string fit if possible).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Scientific Notation formatter misses f-strings" to "Scientific notation formatter misses f-strings" by @claydugo on 2023-12-11 04:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-12-11 15:25</div>
            <div class="timeline-body"><p>Hey, thanks for the issue and thanks Micha for providing the context. I'll close this in favor of #7594 which tracks f-string formatting.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2023-12-11 15:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
