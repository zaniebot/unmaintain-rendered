<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Check for exact copyright header - astral-sh/ruff #5306</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Check for exact copyright header</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5306">#5306</a>
        opened by <a href="https://github.com/rbebb">@rbebb</a>
        on 2023-06-22 16:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rbebb">@rbebb</a></div>
            <div class="timeline-body"><p>Building off of the request for <a href="https://github.com/astral-sh/ruff/issues/3579"><code>flake8-copyright</code></a>, it would be great to have the ability to check for an exact copyright header in any file!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2023-06-22 16:44</div>
            <div class="timeline-body"><p>There's regex support via <a href="https://beta.ruff.rs/docs/settings/#flake8-copyright-notice-rgx"><code>flake8-copyright.notice-rgx</code></a> so maybe you could use that to specify the exact header you want.</p>
<p>(Though an exact header setting would make it trivial to implement autofix :D)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-22 20:35</div>
            <div class="timeline-body"><p>Do you mind providing an example of the header you might want to enforce? Is it, like, the copyright notice content that you want to validate?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-06-22 20:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-06-22 20:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rbebb">@rbebb</a> on 2023-06-23 16:06</div>
            <div class="timeline-body"><p>Hey @charliermarsh, it is the copyright notice content that I'd want to validate. Here's an example!</p>
<p>https://github.com/cs3org/reva/blob/master/cmd/reva/app-tokens-remove.go#L1-L17</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-06-26 18:30</div>
            <div class="timeline-body"><p>This feature would also be useful for <a href="https://github.com/ing-bank/popmon">popmon</a>. We currently use Google's <a href="https://github.com/google/addlicense">addlicense</a> (it supports popular licenses out-of-the-box, e.g. apache, bsd, mit, mpl).</p>
<p>Since that project already uses <code>ruff</code>, I'd love to switch.</p>
<p>Example file: https://github.com/ing-bank/popmon/blob/master/popmon/analysis/functions.py#L1C1-L1C1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/airwoodix">@airwoodix</a> on 2023-06-27 08:02</div>
            <div class="timeline-body"><p><code>flake8-copyright</code> is a good starting point for this, although converting the header to validate into a regular expression is a bit tedious (lots of escapes).</p>
<p>However, the hardcoded <a href="https://github.com/astral-sh/ruff/blob/50a7769d698c93cb23c7b2854bb47d716d87aa0d/crates/ruff/src/rules/flake8_copyright/rules/missing_copyright_notice.rs#L35-L40">1024 bytes limit</a> gets quickly in the way. Would it be an option to make it configurable?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-06-27 15:01</div>
            <div class="timeline-body"><p>Would it be useful to use the contents of the <code>LICENSE</code> file as the expected header?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/airwoodix">@airwoodix</a> on 2023-06-27 16:24</div>
            <div class="timeline-body"><p>@zanieb looking at the <a href="https://www.gnu.org/licenses/gpl-howto.html">GPL guidelines</a>, I understand that the <code>LICENSE</code> file would contain a complete copy of the license, while each file only starts with the much shorter license notice. The <a href="https://spdx.org/licenses/Apache-2.0.html">Apache-2.0 license</a> seems to have a similar distinction.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-06-28 15:19</div>
            <div class="timeline-body"><p>Suggestion: provide a different message than &quot;Missing copyright notice at top of file&quot; when the contents does not match the regex/exact match. As a user, currently it's hard to debug the regex (especially multiline).</p>
<p>Would it be an option to split missing/present and match/no match into two codes?</p>
<p>Minor detail: The <a href="https://beta.ruff.rs/docs/rules/#copyright-related-rules-cpy">rules</a> are not listing the CPY001 atm.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2023-07-10 01:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-10 01:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jeaboswell">@jeaboswell</a> on 2023-09-22 07:02</div>
            <div class="timeline-body"><blockquote>
<p><code>flake8-copyright</code> is a good starting point for this, although converting the header to validate into a regular expression is a bit tedious (lots of escapes).</p>
<p>However, the hardcoded <a href="https://github.com/astral-sh/ruff/blob/50a7769d698c93cb23c7b2854bb47d716d87aa0d/crates/ruff/src/rules/flake8_copyright/rules/missing_copyright_notice.rs#L35-L40">1024 bytes limit</a> gets quickly in the way. Would it be an option to make it configurable?</p>
</blockquote>
<p>I agree completely that the hardcoded limit of 1024 bytes is an issue.  If you are adhering to the <a href="https://docs.astral.sh/ruff/rules/undocumented-public-module/">D100</a> rule, your copyright attribute gets pushed out of that limit quickly.</p>
<p>In my project, the only modules that don't need an exception to the rule are those that contain two to three functions.</p>
<p>I think ideally, if we just check if it's in the file at all, that would be a good start.  If we want to get really crazy, we could try to ensure it comes after the imports, and before any code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2023-11-17 16:54</div>
            <div class="timeline-body"><p>Shameless self-promotion but I wrote a script once that another colleague then converted into a standalone project: <a href="https://github.com/unconventionaldotdev/unbeheader">unbeheader</a> - it basically manages your copyright (or whatever else) header comments in your codebase, has CI checks, and can automatically add/update them (locally, not in CI).</p>
<p>I'd love to see support for its functionality in ruff, but unless a codebase contains <em>only</em> Python maybe using ruff to enforce exact copyright headers is not ideal to begin with, since it would not handle any non-Python file types...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/oliverfunk">@oliverfunk</a> on 2023-11-29 13:28</div>
            <div class="timeline-body"><p>There should be support for SPDX file descriptors, given that they are being recommended more (Hatch for example uses them by default when creating a new project)</p>
<p>They generally follow the format of:</p>
<pre><code class="language-python"># SPDX-FileCopyrightText: &lt;year&gt; &lt;name&gt; &lt;contact&gt;
# ^ can be multiple of these lines
#
# SPDX-License-Identifier: &lt;licence&gt;
</code></pre>
<p>The year and contact are optional, but the full spec is available.</p>
<p>References:
https://reuse.software/spec/
https://github.com/fsfe/reuse-tool
https://hatch.pypa.io/latest/config/project-templates/#licenses</p>
<p>I'm using the very ruff (pun not intended) regex for my config:</p>
<pre><code class="language-toml">[tool.ruff.lint.flake8-copyright]
notice-rgx = &quot;(?i)# SPDX-FileCopyrightText:\\s\\d{4}(-(\\d{4}|present))*&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aaronsteers">@aaronsteers</a> on 2024-05-07 22:28</div>
            <div class="timeline-body"><p>+1 to this request. And to raise an alternative more generic implementation - which would be &quot;file_starts_with&quot; customization.</p>
<p>This variant would allow auto-fixing of CPY1 <em>indirectly</em>, but with an approach more generic. The generic implementation would allow Ruff to check for (and auto-fix) a mandatory pre-amble for each python file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adrinjalali">@adrinjalali</a> on 2024-06-18 15:23</div>
            <div class="timeline-body"><p>I just ended up here cause we wanted to enable this rule in https://github.com/scikit-learn/scikit-learn/, and encountered issues which took us quite a while to figure out.</p>
<p>For now I've put #11927 here which should fix at least a lot more people's issues.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:32 UTC
    </footer>
</body>
</html>
