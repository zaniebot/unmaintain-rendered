<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `torch.nn.functional as F` to flake8-import-conventions aliases - astral-sh/ruff #18310</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Add `torch.nn.functional as F` to flake8-import-conventions aliases</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/18310">#18310</a>
        opened by <a href="https://github.com/IlanCosman">@IlanCosman</a>
        on 2025-05-26 04:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/IlanCosman">@IlanCosman</a> on 2025-05-26 04:56</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>| Import style                                     | Search regex                                | Number of files (links are slightly borked)                                                     |
| ------------------------------------------------ | ------------------------------------------- | ----------------------------------------------------------------------------------------------- |
| <code>from torch.nn import functional</code>                | <code>/from torch\.nn import functional$/</code>       | <a href="https://github.com/search?q=%2Ffrom+torch%5C.nn+import+functional%24%2F&amp;type=code">1.6k</a>       |
| <code>from torch.nn import functional as &lt;SOMETHING&gt;</code> | <code>/from torch\.nn import functional as .*$/</code> | <a href="https://github.com/search?q=%2Ffrom+torch%5C.nn+import+functional+as+.*%24%2F&amp;type=code">162k</a> |
| <code>from torch.nn import functional as F</code>           | <code>/from torch\.nn import functional as F$/</code>  | <a href="https://github.com/search?q=%2Ffrom+torch%5C.nn+import+functional+as+F%24%2F&amp;type=code">129k</a>  |
| <code>import torch.nn.functional as &lt;SOMETHING&gt;</code>      | <code>/import torch\.nn\.functional as .*$/</code>     | <a href="https://github.com/search?q=%2Fimport+torch%5C.nn%5C.functional+as+.*%24%2F&amp;type=code">1.4M</a>   |
| <code>import torch.nn.functional as F</code>                | <code>/import torch\.nn\.functional as F$/</code>      | <a href="https://github.com/search?q=%2Fimport+torch%5C.nn%5C.functional+as+F%24%2F&amp;type=code">1.2M</a>    |</p>
<p>In total <code>1.329 / 1.562</code> ~= 85% of the <code>torch.nn.functional</code> imports are <code>as F</code>.</p>
<h3>Considerations</h3>
<ul>
<li>Afaict <code>F</code> is nowhere explicitly recommended/mentioned by the PyTorch documentation, though it appears in every code example on https://docs.pytorch.org/docs/stable/nn.functional.html</li>
</ul>
<h4>The <code>F</code> alias violates rule N812, lowercase-imported-as-non-lowercase.</h4>
<ul>
<li>This is unfortunate, but I think it's case where practicality beats purity, since the <code>F</code> alias is so ubiquitous in the PyTorch ecosystem.</li>
<li>I think it's worth making some sort of special case for this in rule N812<ul>
<li>Quick and dirty option: add <code>functional</code> to the default <code>ignore-names</code> in <code>[tool.ruff.lint.pep8-naming]</code><ul>
<li>This has the slight disadvantage of allowing all import of <code>functional</code>, regardless of whether they are from PyTorch or not, to be importable with uppercase names.</li>
</ul>
</li>
<li>Cleaner option: some sort of particular exception for <code>torch.nn.functional</code>? Not sure tbh</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add `torch.nn.function as F` to flake8-import-conventions aliases" to "Add `torch.nn.functional as F` to flake8-import-conventions aliases" by @IlanCosman on 2025-05-26 04:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-05-29 20:20</div>
            <div class="timeline-body"><p>Just to make sure I understand, is the suggestion here to add this to the default value for <a href="https://docs.astral.sh/ruff/settings/#lint_flake8-import-conventions_aliases">lint.flake8-import-conventions.aliases</a>? I think pytorch users could already configure this with either the <code>aliases</code> or <code>extend-aliases</code> options. Similarly, I think you could get around the N812 violation by configuring <a href="https://docs.astral.sh/ruff/settings/#lint_pep8-naming_ignore-names"><code>lint.pep8-naming.ignore_names</code></a>, as you said.</p>
<p>As an aside, it looks like you have to add <code>F</code> to <code>extend-ignore-names</code>, not <code>functional</code>: https://play.ruff.rs/80ffcd74-1b08-4c19-bea4-f973fcff9850</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @ntBre on 2025-05-29 20:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> added by @MichaReiser on 2025-05-29 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IlanCosman">@IlanCosman</a> on 2025-05-30 18:12</div>
            <div class="timeline-body"><blockquote>
<p>Just to make sure I understand, is the suggestion here to add this to the default value for <a href="https://docs.astral.sh/ruff/settings/#lint_flake8-import-conventions_aliases">lint.flake8-import-conventions.aliases</a>? I think pytorch users could already configure this with either the aliases or extend-aliases options. Similarly, I think you could get around the N812 violation by configuring <a href="https://docs.astral.sh/ruff/settings/#lint_pep8-naming_ignore-names">lint.pep8-naming.ignore_names</a>, as you said.</p>
</blockquote>
<p>Yah, everything you mentioned is correct. I think it would be good for the standard name to be enforced by default, and for it to not be a violation of N812.</p>
<blockquote>
<p>As an aside, it looks like you have to add F to extend-ignore-names, not functional: https://play.ruff.rs/80ffcd74-1b08-4c19-bea4-f973fcff9850</p>
</blockquote>
<p>Apparently both work, thanks for showing me that :)</p>
<hr />
<p>Maybe the most reasonable way to do this is to just say that anything defined in import-conventions.aliases automatically passes N812. If a name is the standard, as defined by import-conventions.aliases, then rules should just accept that that's an allowed name.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> removed by @ntBre on 2025-06-02 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @ntBre on 2025-06-02 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/19394.html">astral-sh/ruff#19394</a> on 2025-07-17 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guillaume-alliander">@guillaume-alliander</a> on 2025-07-18 07:43</div>
            <div class="timeline-body"><blockquote>
<p>Maybe the most reasonable way to do this is to just say that anything defined in import-conventions.aliases automatically passes N812.</p>
</blockquote>
<p>I would even go one step further: anything explicitly defined in in import-conventions.aliases / import-convention.extend-aliases should pass <em>all</em> N rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/andrea-gasparini">@andrea-gasparini</a> on 2025-09-04 10:04</div>
            <div class="timeline-body"><blockquote>
<p>Just to make sure I understand, is the suggestion here to add this to the default value for <a href="https://docs.astral.sh/ruff/settings/#lint_flake8-import-conventions_aliases">lint.flake8-import-conventions.aliases</a>? I think pytorch users could already configure this with either the <code>aliases</code> or <code>extend-aliases</code> options.</p>
</blockquote>
<p>Not sure I understood if the suggested change to <code>flake8-import-conventions.extend-aliases</code> is actually supposed to get around the N812 rule (doesn't look like it: https://play.ruff.rs/3cd93b53-1ab0-4aa8-a916-af3c64afcad3) or if the only workaround for now is to edit the <a href="https://docs.astral.sh/ruff/settings/#lint_pep8-naming_ignore-names">pep8-naming.ignore_names</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-09-05 15:49</div>
            <div class="timeline-body"><p>Yeah, I think <code>ignore-names</code> is the key for now. The <code>aliases</code> came up in a couple of related suggestions to also add this as a default, known alias and to respect <code>aliases</code> in <code>N812</code> automatically, but neither of those are implemented today.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
