```yaml
number: 14822
title: "[tool.ruff.lint.flake8-tidy-imports] rules in pyproject.toml parent are ignore pyproject.toml child file"
type: issue
state: open
author: FrancoisMasson1990
labels:
  - configuration
assignees: []
created_at: 2024-12-06T16:14:20Z
updated_at: 2024-12-09T11:09:51Z
url: https://github.com/astral-sh/ruff/issues/14822
synced_at: 2026-01-10T01:56:55Z
```

# [tool.ruff.lint.flake8-tidy-imports] rules in pyproject.toml parent are ignore pyproject.toml child file

---

_Issue opened by @FrancoisMasson1990 on 2024-12-06 16:14_

Rules present in pyproject.toml parent file are ignored in the child file one.

Example given

./pyproject.toml
````
[tool.ruff.lint.flake8-tidy-imports.banned-api]
"typing.List".msg = "Use list instead of typing.List"
"typing.Dict".msg = "Use dict instead of typing.Dict"
````

./folder_a/pyproject.toml
````
[tool.ruff]
# Extend the `pyproject.toml` file in the parent directory.
extend = "../pyproject.toml"

[tool.ruff.lint.flake8-tidy-imports.banned-api]
"B".msg = "Don't import B in A"
````

Typing check are not considered when running `poetry ruff check .`  in the folder_a


---

_Comment by @MichaReiser on 2024-12-06 16:29_

> Typing check are not considered when running poetry ruff check . in the folder_a

Can you expand on what you mean and maybe share an example python file? That would help me reproduce the issue and, in turn, help you.

---

_Label `question` added by @MichaReiser on 2024-12-06 16:29_

---

_Label `needs-mre` added by @MichaReiser on 2024-12-06 16:29_

---

_Comment by @FrancoisMasson1990 on 2024-12-08 07:40_

> > Typing check are not considered when running poetry ruff check . in the folder_a
> 
> Can you expand on what you mean and maybe share an example python file? That would help me reproduce the issue and, in turn, help you.

Sure.

in the following folder structure
```
|
|
pyproject.toml
folder-a
    |-folder_a
        |--- __init__.py
        |--- test.py
   |-pyproject.toml
```
test.py
```python
from typing import List
````

Using the following configuration

./pyproject.toml
```
[tool.ruff.lint.flake8-tidy-imports.banned-api]
"typing.List".msg = "Use list instead of typing.List"
"typing.Dict".msg = "Use dict instead of typing.Dict"
``` 

And 

./folder_a/pyproject.toml
```
[tool.ruff]
# Extend the `pyproject.toml` file in the parent directory.
extend = "../pyproject.toml"

[tool.ruff.lint.flake8-tidy-imports.banned-api]
"B".msg = "Don't import B in A"
```

The error on importing `List` is ignored.

Note that if `[tool.ruff.lint.flake8-tidy-imports.banned-api]` rules are missing in ./folder_a/pyproject.toml. (No "B".msg = "Don't import B in A" for example) The error is flagged.

Let me know if it's clearer with the following explanation.

---

_Comment by @dhruvmanila on 2024-12-09 06:39_

I think this is an expected behavior because the `banned-api` value in the nested `pyproject.toml` will _override_ the one in the parent `pyproject.toml`. The `extend` option is to merge the properties from different configuration files.

---

_Comment by @FrancoisMasson1990 on 2024-12-09 10:24_

> I think this is an expected behavior because the `banned-api` value in the nested `pyproject.toml` will _override_ the one in the parent `pyproject.toml`. The `extend` option is to merge the properties from different configuration files.

Ok but is there a way in that case to merge the `banned-api` from different configuration file ?

We want to avoid duplicated rules accross different configuration files.
Example given:
`"typing.List".msg = "Use list instead of typing.List"` 

Should be present in only config file and spread accross various sub_folder

---

_Label `configuration` added by @MichaReiser on 2024-12-09 11:06_

---

_Label `question` removed by @MichaReiser on 2024-12-09 11:06_

---

_Label `needs-mre` removed by @MichaReiser on 2024-12-09 11:06_

---

_Comment by @MichaReiser on 2024-12-09 11:08_

> Ok but is there a way in that case to merge the banned-api from different configuration file ?

I don't think that's currently possible, and we're aware of this limitation in Ruff's current configuration schema. The problem is that merging the options now makes it impossible to override the `banned-api`s if there's a need for it. 

The solution to this is that we introduce a new sentinel value: "unset" or add a "level" setting to it that can be "ignore", "warn" or "error" so that a sub-configuration can remove (disable) a previous banned api override

This is related to https://github.com/astral-sh/ruff/issues/9872

---

_Referenced in [astral-sh/ruff#18723](../../astral-sh/ruff/issues/18723.md) on 2025-06-17 13:56_

---

_Referenced in [apache/airflow#53700](../../apache/airflow/pulls/53700.md) on 2025-07-24 08:58_

---
