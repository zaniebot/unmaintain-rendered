<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff formatter removes numpydoc style trailing blank line - astral-sh/ruff #11539</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff formatter removes numpydoc style trailing blank line</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/11539">#11539</a>
        opened by <a href="https://github.com/manoelpqueiroz">@manoelpqueiroz</a>
        on 2024-05-24 23:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/manoelpqueiroz">@manoelpqueiroz</a> on 2024-05-24 23:24</div>
            <div class="timeline-body"><p>Hi guys, I've searched for the following terms before opening this issue:</p>
<ul>
<li>numpydoc</li>
<li>D200</li>
</ul>
<h2>What is happening</h2>
<p>Numpydoc style <a href="https://numpydoc.readthedocs.io/en/latest/format.html#short-summary">implements</a> a blank line for docstrings without parameters, but when I run <code>ruff format</code>, it will always reduce the docstring to a single line.</p>
<p>Is there a way to suppress this behaviour for the formatter without having to set <code># format: off</code> and <code># format: on</code> for every single docstring?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Ruff formatter " to "Ruff formatter removes numpydoc style trailing blank line" by @zanieb on 2024-05-24 23:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-26 17:19</div>
            <div class="timeline-body"><p>Can you provide a minimal reproduction? I can't reproduce here:</p>
<p>https://play.ruff.rs/c80020bb-3d36-4ec2-ad30-b7e26540f1ce</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> added by @charliermarsh on 2024-05-26 17:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-27 11:16</div>
            <div class="timeline-body"><p>Is https://play.ruff.rs/8087f802-9528-4a2b-bf34-c39f60d2372f an example of what you're seeing?</p>
<p>The formatter collapses your docstring (removes empty lines) if the only non-whitespace text comes right after the opening <code>&quot;&quot;&quot;</code>. The formatter preserves the empty line if you add a line break between the opening <code>&quot;&quot;&quot;</code> and the documentation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/manoelpqueiroz">@manoelpqueiroz</a> on 2024-05-27 22:14</div>
            <div class="timeline-body"><p>Hi @MichaReiser, I can confirm the issue is with the second example you have in the playground.</p>
<p>However, as <a href="https://numpydoc.readthedocs.io/en/latest/format.html#short-summary">linked to</a> in my earlier comment, Numpydoc style allows for the second kind of docstring, with only a single line and no function signature. Of course, I could just move the single-line docstring one line below as in this <a href="https://play.ruff.rs/265a0634-b127-49a7-bc3c-bbdbac5fa3c8">example</a>, but in this case it would not be in accordance to Numpydoc as seen <a href="https://numpydoc.readthedocs.io/en/latest/example.html#id4">here</a>.</p>
<p>Does the Ruff formatter take into account the <code>ruff.tool.lint.pydocstyle.convention</code> variable somehow? Or are they two completely separate things?</p>
<p>Does the project intend to adequate the formatter's behaviour to this Numpydoc peculiarity? If not so, what would you recommend to be done so the &quot;blank line&quot; is preserved when I run the formatter (i.e., ignore this &quot;rule&quot;, but keep formatting others)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-28 07:36</div>
            <div class="timeline-body"><blockquote>
<p>However, as <a href="https://numpydoc.readthedocs.io/en/latest/format.html#short-summary">linked to</a> in my earlier comment, Numpydoc style allows for the second kind of docstring, with only a single line and no function signature.</p>
</blockquote>
<p>I think it's okay for a formatter to be more strict than what tools allow. Ultimately, the goal of a formatter is to apply consistent formatting and that means to only use a subset of all valid formatting.</p>
<blockquote>
<p>Every module should have a docstring at the very top of the file. The moduleâ€™s docstring may extend over multiple lines. If your docstring does extend over multiple lines, the closing three quotation marks must be on a line by itself, preferably preceded by a blank line.</p>
</blockquote>
<p>The way I read this is that the blank line isn't mandatory, and the blank line is only preferred if it extends over multiple lines. But I'm not sure if this is the section you're referring to.</p>
<blockquote>
<p>Does the Ruff formatter take into account the ruff.tool.lint.pydocstyle.convention variable somehow? Or are they two completely separate things?</p>
</blockquote>
<p>It doesn't. The formatter only applies basic docstring formatting today. We want to add docstring formatting support in the future but don't know when we get around to work on it.</p>
<blockquote>
<p>Does the project intend to adequate the formatter's behaviour to this Numpydoc peculiarity? If not so, what would you recommend to be done so the &quot;blank line&quot; is preserved when I run the formatter (i.e., ignore this &quot;rule&quot;, but keep formatting others)?</p>
</blockquote>
<p>Ignoring individual &quot;formatter rules&quot; isn't possible because it works as a unit. So it's an all or nothing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/manoelpqueiroz">@manoelpqueiroz</a> on 2024-05-28 14:53</div>
            <div class="timeline-body"><p>Thank you for your clarification on both the context of styling and how the formatter works! Sometimes I get lost on the myriad of options Ruff enables, so I wanted to get this topic clear.</p>
<p>Thanks once again and congratulations on the project, it's awesome to have a single tool to manage a plethora of linting rules already well-established. Keep up the good work!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @manoelpqueiroz on 2024-05-28 14:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:13 UTC
    </footer>
</body>
</html>
