```yaml
number: 5355
title: "Add cpython & other repos as formatting stability check to CI"
type: issue
state: closed
author: konstin
labels:
  - formatter
assignees: []
created_at: 2023-06-25T11:27:58Z
updated_at: 2023-07-25T09:50:14Z
url: https://github.com/astral-sh/ruff/issues/5355
synced_at: 2026-01-10T01:56:48Z
```

# Add cpython & other repos as formatting stability check to CI

---

_Issue opened by @konstin on 2023-06-25 11:27_

We have a script that formats cpython twice and checks that the formatting stays the same, that we only output valid syntax and that we don't panic due to some input. I want to integrate this script into CI to avoid regressions. This also needs documentation on how to run the check locally.

---

_Assigned to @konstin by @konstin on 2023-06-25 11:27_

---

_Label `formatter` added by @konstin on 2023-06-25 11:28_

---

_Renamed from "Add cpython formatting stability check to CI" to "Add cpython & other repos as formatting stability check to CI" by @konstin on 2023-07-10 19:25_

---

_Referenced in [astral-sh/ruff#5656](../../astral-sh/ruff/pulls/5656.md) on 2023-07-10 19:25_

---

_Comment by @cnpryer on 2023-07-16 14:32_

> This also needs documentation on how to run the check locally

Is this already solved or is there more that could be helpful to document?

---

_Comment by @konstin on 2023-07-16 18:12_

The general way is documented at https://github.com/astral-sh/ruff/blob/main/crates/ruff_python_formatter/README.md#checking-entire-projects. I'm currently working a small but diverse set of projects that we continuously check and will add more instructions once that's done.

I also ran the stability checks with the 3k repo from [ruff-usage-aggregate](https://github.com/akx/ruff-usage-aggregate/blob/master/data/known-github-tomls-clean.jsonl) and have to go through all of them and either fix them directly or open issues for each distinct one.

---

_Comment by @konstin on 2023-07-18 17:32_

i've posted the initial script in https://github.com/astral-sh/ruff/issues/5828, this ticket is effectively about automating most of the scores from that ticket.

---

_Comment by @konstin on 2023-07-25 09:50_

Fixed by #5919

---

_Closed by @konstin on 2023-07-25 09:50_

---
