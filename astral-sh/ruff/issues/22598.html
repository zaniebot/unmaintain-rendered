<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff server applies exclude rules from parent directory configuration - astral-sh/ruff #22598</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff server applies exclude rules from parent directory configuration</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/22598">#22598</a>
        opened by <a href="https://github.com/iggyfisk">@iggyfisk</a>
        on 2026-01-15 13:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/iggyfisk">@iggyfisk</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Minimal reproduction is available at https://github.com/iggyfisk/ruff-native-server-ignore-issue-reproduction</p>
<p>I have a monorepo with several Python packages that share code and ruff configuration, and an isolated package that doesn't share any code with the rest of the repo, and has its own ruff configuration. This is set up as a VSCode workspace where the repo root is one folder, and the isolated package is another folder.</p>
<p>Because the ruff configuration is different for the isolated package than the rest of the repo, I want to exclude that package from ruff when running from the root, using <code>extend-exclude</code>. And then to run ruff for the isolated package I can run it from within that directory, and it uses the Python virtual environment and ruff config that's specific for the isolated package.</p>
<p>All of this works perfectly from the command line, and in VSCode it works perfectly for everything except the isolated package. When editing the isolated package in VSCode, ruff is completely disabled. I can fix this and enable ruff in my isolated package by either:</p>
<ul>
<li>Turn off the native language server by setting <code>&quot;ruff.nativeServer&quot;: &quot;off&quot;</code> in my <code>.code-workspace</code> file. Which I'd rather not since ruff-lsp is deprecated.</li>
<li>Remove the isolated package from <code>extend-exclude</code> in the root <code>pyproject.toml</code>. Which I'd rather not since then ruff would try to lint/format the isolated package with the wrong rules when running from the command line, unless I specify specific exclude rules as arguments (and remember to do that everywhere in CI, git hooks etc)</li>
<li>Manually specify <code>include</code> in the root <code>pyproject.toml</code>. Which I'd rather not since I might forget to add new packages as they appear.</li>
</ul>
<h3>Version</h3>
<p>ruff 0.14.11, charliermarsh.ruff  2026.34.0, VSCode 1.108.1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZedThree">@ZedThree</a> on 2026-01-15 14:51</div>
            <div class="timeline-body"><p>Pretty sure this is a duplicate of #20847</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2026-01-15 14:56</div>
            <div class="timeline-body"><p>Thanks @ZedThree! I thought this sounded familiar, but was still looking for the other issue.</p>
<p>And thank you @iggyfisk for the report and the nice write-up! But I'll close this as a duplicate of #20847 to consolidate discussion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2026-01-15 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2026-01-15 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @ntBre on 2026-01-15 14:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-15 15:51:57 UTC
    </footer>
</body>
</html>
