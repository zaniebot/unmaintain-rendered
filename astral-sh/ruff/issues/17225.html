<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>add rule to disallow right-hand side values in `TypedDict` - astral-sh/ruff #17225</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>add rule to disallow right-hand side values in <code>TypedDict</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/17225">#17225</a>
        opened by <a href="https://github.com/vpoverennov">@vpoverennov</a>
        on 2025-04-05 20:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/vpoverennov">@vpoverennov</a></div>
            <div class="timeline-body">Summary
<pre><code>from typing import TypedDict


class A(TypedDict):
    x: int = 42
           ^^^^
</code></pre>
<p>This is not allowed according to <a href="https://peps.python.org/pep-0589/">PEP 589</a></p>
<blockquote>
<p>TypedDict doesnâ€™t support providing a default value type for keys that are not explicitly defined. This would allow arbitrary keys to be used with a TypedDict object, and only explicitly enumerated keys would receive special treatment compared to a normal, uniform dictionary type.</p>
</blockquote>
<p>And is indeed ignored at runtime if you instantiate the class</p>
<pre><code>&gt;&gt;&gt; A()
{}
</code></pre>
<p>mypy:</p>
<pre><code>y.py:5: error: Right hand side values are not supported in TypedDict  [misc]
</code></pre>
<p>pyright:</p>
<pre><code>y.py:5:5 - error: TypedDict classes can contain only type annotations (reportGeneralTypeIssues)
</code></pre>
<p>Would be curious to get your thoughts for such a rule, thank you for making the awesome tool</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;disallow right-hand side values TypedDict&quot; to &quot;disallow right-hand side values in `TypedDict`&quot; by <a href="https://github.com/vpoverennov">@vpoverennov</a> on 2025-04-05 20:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;disallow right-hand side values in `TypedDict`&quot; to &quot;add rule to disallow right-hand side values in `TypedDict`&quot; by <a href="https://github.com/vpoverennov">@vpoverennov</a> on 2025-04-05 20:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-06 00:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/karthikeya9999">@karthikeya9999</a> on 2025-04-06 06:06</div>
            <div class="timeline-body"><p>from typing import TypedDict</p>
<p>class A(TypedDict, total=False):
x: int</p>
<p>a: A = {}  # x is optional
b: A = {&#x27;x&#x27;: 42}  # okay too</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-07 08:13</div>
            <div class="timeline-body"><p>@karthikeya9999</p>
<p>I&#x27;m not sure I understand your comment. Is it in favor of the rule or an argument against it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Sriketk">@Sriketk</a> on 2025-07-07 21:37</div>
            <div class="timeline-body"><p>I second this.</p>
<pre><code>class State(MessagesState):
    &quot;&quot;&quot;Extended MessagesState with medical case information.&quot;&quot;&quot;

    context: str
    question: str
    answer: str
    userAnswer: str = &quot;&quot;
    questionAnswered: bool = False

    # Optional medical information
    medications: list[str] = []
    allergies: list[str] = []
    familyHistory: list[str] = []
    labResults: list[str] = []
    options: list[str] = []
    bloodPresure: str = &quot;&quot;
    respirations: str = &quot;&quot;
    pulse: str = &quot;&quot;
    physicalExamination: str = &quot;&quot;
    temperature: str = &quot;&quot;
    history: str = &quot;&quot;
    demographics: str = &quot;&quot;


graph_builder = StateGraph(State)
</code></pre>
<p>linter is giving me error here</p>
<pre><code>src/agent/graph.py:117: error: Right hand side values are not supported in TypedDict  [misc]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-07-08 07:16</div>
            <div class="timeline-body"><p>Given that mypy and pyright already support this. I feel like it&#x27;s less urgent for ruff to add this rule now (as it also depends on multifile analysis to resolve if the class extends a typed dict)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:49:47 UTC
    </footer>
</body>
</html>
