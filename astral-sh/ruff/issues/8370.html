<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notebook JSON inconsistency for Google Colab - astral-sh/ruff #8370</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Notebook JSON inconsistency for Google Colab</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8370">#8370</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2023-10-31 02:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body"><p>I&#x27;m not sure if this deserves its own issue, but: Would it be possible to use <code>extend-include = [&quot;*.ipynb&quot;]</code> and <code>ruff format</code> to <strong>only</strong> re-format the Python code in cells, and <strong>not</strong> the ipynb file itself?</p>
<p>My users typically edit notebooks in Google Colab. Google Colab uses two-space indentation in the ipynb file, instead of the typical one-space indentation. <code>ruff format</code> currently re-indents with one space. As such, edit history becomes difficult/impossible to track, because effectively every line gets rewritten between the user saving from Google Colab (changing to 2 spaces) and CI running <code>ruff format</code> (changing to 1 space).</p>
<p>Google Colab also puts keys like metadata, nbformat, nbformat_minor at the top of the file, but <code>ruff format</code> moves these to the bottom. <code>ruff format</code> also changes the order of <code>execution_count</code>, <code>outputs</code>, etc.</p>
<p>I would love to be able to opt out of ipynb formatting, so that only the Python code inside cells is reformatted.</p>
<p><em>Originally posted by @jpmckinney in <a href="https://github.com/astral-sh/ruff/issues/5188">astral-sh/ruff#5188</a>#issuecomment-1785922267</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-31 02:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-12-22 06:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> removed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-02-06 12:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">notebook</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-02-06 12:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:45 UTC
    </footer>
</body>
</html>
