<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>potential false positive with  `S107 Possible hardcoded password` - astral-sh/ruff #3511</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>potential false positive with  <code>S107 Possible hardcoded password</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3511">#3511</a>
        opened by <a href="https://github.com/Borda">@Borda</a>
        on 2023-03-14 14:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Borda">@Borda</a></div>
            <div class="timeline-body"><p>Hello, we were interested in enabling <code>S</code> (https://beta.ruff.rs/docs/rules/#flake8-bandit-s)
check (https://beta.ruff.rs/docs/rules/#flake8-bandit-s) for our codebase https://github.com/Lightning-AI/metrics/pull/1616, but it seems it raises concerns about some simple hashes of <code>S107 Possible hardcoded password</code>, but <code>flake8-bandit</code> does not see them as issue so yeqa reoves them...</p>
<p>see output:</p>
<pre><code>src/torchmetrics/functional/text/sacre_bleu.py:281:62: S107 Possible hardcoded password: &quot;13a&quot;
src/torchmetrics/functional/text/sacre_bleu.py:333:20: S105 Possible hardcoded password: &quot;intl&quot;
src/torchmetrics/text/sacre_bleu.py:89:66: S107 Possible hardcoded password: &quot;13a&quot;
src/torchmetrics/text/sacre_bleu.py:98:24: S105 Possible hardcoded password: &quot;intl&quot;
tests/unittests/text/test_bertscore.py:19:40: S105 Possible hardcoded password: &quot;1&quot;
</code></pre>
<p>ref: https://results.pre-commit.ci/run/github/323721661/1678802655.3OMtGaTPQ-a9cRvxN16V_A</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Borda">@Borda</a> on 2023-03-14 14:18</div>
            <div class="timeline-body"><p>ok, issue was in <code>v0.0.252</code> and it seems it has been fixed with <code>v0.0.255</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Borda on 2023-03-14 14:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Borda">@Borda</a> on 2023-04-14 18:00</div>
            <div class="timeline-body"><p>using the latest 0.0.261 and have a few more cases:</p>
<ul>
<li>https://github.com/Lightning-AI/lightning/blob/cfab52af1c873b23564de8f150ce602e532d0d4f/tests/tests_app/cli/test_cmd_apps.py#L65</li>
<li>https://github.com/Lightning-AI/lightning/blob/cfab52af1c873b23564de8f150ce602e532d0d4f/tests/tests_app/storage/test_path.py#L703</li>
<li>https://github.com/Lightning-AI/lightning/blob/accd2b9e61063ba3c683764043030545ed87c71f/src/lightning/pytorch/profilers/profiler.py#L77</li>
<li>https://github.com/Lightning-AI/lightning/blob/da883e73b941112aac7a538d71def6af2e83113b/tests/tests_app/runners/test_cloud.py#L525</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @Borda on 2023-04-14 18:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-14 18:36</div>
            <div class="timeline-body"><p>Ok cool, so those linked lines are raising <code>S107</code> with Ruff but not with Bandit?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Borda">@Borda</a> on 2023-04-14 21:21</div>
            <div class="timeline-body"><blockquote>
<p>Ok cool, so those linked lines are raising <code>S107</code> with Ruff but not with Bandit?</p>
</blockquote>
<p>correct, in fact, they are raising three 105, 106 and 107</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-04-15 05:48</div>
            <div class="timeline-body"><p>I've copied the relevant code and tried running <code>bandit</code>. It gave me errors for all the listed code except for the second one. I used the default settings for running <code>bandit</code>:</p>
<details>
<summary>Code used:</summary>

<pre><code class="language-python">ListLightningappInstancesResponse(
    next_page_token=&quot;page-2&quot;,
)

assert fs._mock_new_parent._mock_mock_calls[0].kwargs[&quot;secret&quot;] == &quot;d&quot;


def _prepare_filename(
    self,
    action_name: Optional[str] = None,
    extension: str = &quot;.txt&quot;,
    split_token: str = &quot;-&quot;,
) -&gt; str:
    pass


V1LightningBasicAuth(username=&quot;username&quot;, password=&quot;password&quot;)

</code></pre>
</details>

<details>
<summary><code>bandit</code> output:</summary>

<pre><code>$ bandit ruff_test.py
[main]  INFO    profile include tests: None
[main]  INFO    profile exclude tests: None
[main]  INFO    cli include tests: None
[main]  INFO    cli exclude tests: None
[main]  INFO    running on Python 3.10.5
[node_visitor]  WARNING Unable to find qualified name for module: ruff_test.py
Run started:2023-04-15 05:45:59.374464

Test results:
&gt;&gt; Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'page-2'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b106_hardcoded_password_funcarg.html
   Location: ruff_test.py:1:0
1       ListLightningappInstancesResponse(
2           next_page_token=&quot;page-2&quot;,
3       )
4
5       assert fs._mock_new_parent._mock_mock_calls[0].kwargs[&quot;secret&quot;] == &quot;d&quot;

--------------------------------------------------
&gt;&gt; Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b101_assert_used.html
   Location: ruff_test.py:5:0
4
5       assert fs._mock_new_parent._mock_mock_calls[0].kwargs[&quot;secret&quot;] == &quot;d&quot;
6

--------------------------------------------------
&gt;&gt; Issue: [B107:hardcoded_password_default] Possible hardcoded password: '-'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b107_hardcoded_password_default.html
   Location: ruff_test.py:8:0
7
8       def _prepare_filename(
9           self,
10          action_name: Optional[str] = None,
11          extension: str = &quot;.txt&quot;,
12          split_token: str = &quot;-&quot;,
13      ) -&gt; str:
14          pass
15

--------------------------------------------------
&gt;&gt; Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b106_hardcoded_password_funcarg.html
   Location: ruff_test.py:17:0
16
17      V1LightningBasicAuth(username=&quot;username&quot;, password=&quot;password&quot;)

--------------------------------------------------

Code scanned:
        Total lines of code: 12
        Total lines skipped (#nosec): 0

Run metrics:
        Total issues (by severity):
                Undefined: 0
                Low: 4
                Medium: 0
                High: 0
        Total issues (by confidence):
                Undefined: 0
                Low: 0
                Medium: 3
                High: 1
Files skipped (0):
</code></pre>
</details>

<p>So, I guess the bug is in the way detection happens for the second item. Please correct me if I'm wrong in any place :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Borda">@Borda</a> on 2023-04-17 17:27</div>
            <div class="timeline-body"><p>I was running only ruff, and in my eyes, these are far from being password or any secret, so likely I would need to change the bandit setting, correct?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-05-11 02:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:47 UTC
    </footer>
</body>
</html>
