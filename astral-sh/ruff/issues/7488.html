<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`DTZ007` false-positive when using time format from const - astral-sh/ruff #7488</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`DTZ007` false-positive when using time format from const</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/7488">#7488</a>
        opened by <a href="https://github.com/aw1cks">@aw1cks</a>
        on 2023-09-18 10:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/aw1cks">@aw1cks</a> on 2023-09-18 10:00</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Hi there, first of all just wanted to say thanks for this awesome project.</p>
<p>I noticed a bug with the <code>DTZ007</code> rule - it seems like it's not reading my const value and falsely telling me that I'm not using <code>%z</code>.</p>
<h3>Configuration</h3>
<pre><code class="language-shell">$ ruff --version
ruff 0.0.290
$ cat pyproject.toml 
[tool.ruff]
select = [
  &quot;DTZ&quot;,
]
$ 
</code></pre>
<h3>Code example</h3>
<p>This works fine:</p>
<pre><code class="language-python">import datetime

my_date = &quot;Thu, 14 Sep 2023 07:45:07 +0000&quot;
mydt = datetime.datetime.strptime(my_date, &quot;%a, %d %b %Y %H:%M:%S %z&quot;)
</code></pre>
<pre><code class="language-shell">$ ruff .
$
</code></pre>
<p>However, when using a const:</p>
<pre><code class="language-python">import datetime

MY_DATE_FORMAT = &quot;%a, %d %b %Y %H:%M:%S %z&quot;

my_date = &quot;Thu, 14 Sep 2023 07:45:07 +0000&quot;
mydt = datetime.datetime.strptime(my_date, MY_DATE_FORMAT)
</code></pre>
<pre><code class="language-shell">$ ruff .
test.py:6:8: DTZ007 The use of `datetime.datetime.strptime()` without %z must be followed by `.replace(tzinfo=)` or `.astimezone()`
Found 1 error.
$
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "DTZ007 false-positive when using time format from const" to "`DTZ007` false-positive when using time format from const" by @aw1cks on 2023-09-18 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aw1cks">@aw1cks</a> on 2023-09-18 10:14</div>
            <div class="timeline-body"><p>Whoops - I missed https://github.com/astral-sh/ruff/issues/1306 - closing</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @aw1cks on 2023-09-18 10:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-18 13:10</div>
            <div class="timeline-body"><p>Thanks for the kind words, the thorough issue, and the follow-up!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:10 UTC
    </footer>
</body>
</html>
