<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow to define comments (or arbitrary code) that act as barriers for code changes - astral-sh/ruff #17423</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow to define comments (or arbitrary code) that act as barriers for code changes</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/17423">#17423</a>
        opened by <a href="https://github.com/vnmabus">@vnmabus</a>
        on 2025-04-16 10:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/vnmabus">@vnmabus</a> on 2025-04-16 10:30</div>
            <div class="timeline-body"><p>Some comments, like <code>sphinx_gallery_start_ignore</code> and <code>sphinx_gallery_end_ignore</code> design separate code &quot;areas&quot;. It is in general incorrect to move code across these areas, as the semantics will change (in particular, code in between will not appear in the generated documentation).</p>
<p>In my case I have imports above and below the comments, but Ruff is suggesting to me that I should &quot;organize imports&quot;, moving them across that boundary.</p>
<p>Would it be possible to add a new setting that allows to configure comments, or maybe arbitrary lines of code, that prevent Ruff from trying to move code across them?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">suppression</span> added by @ntBre on 2025-04-16 13:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @ntBre on 2025-04-16 13:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-16 13:54</div>
            <div class="timeline-body"><p>This sounds at least somewhat related to #3711, with the addition of custom start and end comments, at least in the block formulation. A single-line barrier would be a little different.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vnmabus">@vnmabus</a> on 2025-04-16 13:58</div>
            <div class="timeline-body"><p>It is not really the same, as I want Ruff to check all code, including the one inside the <code>sphinx_gallery_*_ignore</code> block. I just do not want that Ruff suggest a change that affects lines at both sides of the &quot;barrier&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-16 13:59</div>
            <div class="timeline-body"><p>Ah I see, thanks for the clarification!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-23 06:23</div>
            <div class="timeline-body"><p>I think we'd have to implement this rule by rule. Most rules shouldn't be impacted by this but it's hard to tell. E.g. even something as simple as a &quot;rename&quot; refactor could make changes across those boundaries. That's why I'm not sure this is feasible.</p>
<p>For isort specifically, would using <code>isort: split</code> action comments to mark the boundary be an option for you? https://pycqa.github.io/isort/docs/configuration/action_comments.html</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vnmabus">@vnmabus</a> on 2025-04-23 06:31</div>
            <div class="timeline-body"><p>Actually, I think so. I didn't know about that option. Does Ruff support all isort directives?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-23 06:35</div>
            <div class="timeline-body"><p>Ruff supports most isort comments, see https://docs.astral.sh/ruff/linter/#action-comments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vnmabus">@vnmabus</a> on 2025-04-26 21:20</div>
            <div class="timeline-body"><p>So, for my part you can close, as I think <code>isort: split</code> covers my current needs. If I notice other case in which it is not enough I can reopen this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-04-27 07:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:17 UTC
    </footer>
</body>
</html>
