<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add the possibility to add import and respect the import sorting. - astral-sh/ruff #835</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add the possibility to add import and respect the import sorting.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/835">#835</a>
        opened by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a>
        on 2022-11-20 20:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a></div>
            <div class="timeline-body"><ul>
<li>In #816, we need to add the <code>sys</code> module if missing and keep the imports sorted.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2022-11-20 21:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2022-11-22 22:24</div>
            <div class="timeline-body"><p>@charliermarsh, does #875 facilitate the implementation of this issue?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @charliermarsh on 2022-12-31 18:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @charliermarsh on 2022-12-31 18:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> removed by @charliermarsh on 2023-01-05 04:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @charliermarsh on 2023-01-05 04:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">core</span> added by @charliermarsh on 2023-01-05 04:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-05 05:01</div>
            <div class="timeline-body"><p>This would be good to tackle. It has now come up a few times now.</p>
<p>I think the idea would be to track the imports that need to be present for a given code modification, and then do a pass at the end to &quot;add&quot; those imports. It would somehow have to be connected to the autofix API too, to ensure that we only add the import if we end up applying the fix.</p>
<p>You can see how LibCST handles the problem <a href="https://libcst.readthedocs.io/en/latest/_modules/libcst/codemod/visitors/_add_imports.html">here</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-05 05:02</div>
            <div class="timeline-body"><p>There are a few sub-problems:</p>
<ul>
<li>How do we determine where the imports should go? It's probably not necessary to put the imports in the &quot;right&quot; spot, since we can rely on the next autofix iteration fixing up the order. But they should go in the first &quot;block&quot;.</li>
<li>How do we only add imports we don't already have?</li>
<li>...</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-02-02 03:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> removed by @charliermarsh on 2023-02-17 23:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-22 23:36</div>
            <div class="timeline-body"><p>I am returning to this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-28 17:58</div>
            <div class="timeline-body"><p>Getting close...</p>
<pre><code class="language-diff">diff --git a/foo.py b/foo.py
index 0647ee33b..696a9e873 100644
--- a/foo.py
+++ b/foo.py
@@ -1,3 +1,4 @@
+import sys
 exit = 1

-quit(1)
+sys.exit(1)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-03-30 15:33</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:45:32 UTC
    </footer>
</body>
</html>
