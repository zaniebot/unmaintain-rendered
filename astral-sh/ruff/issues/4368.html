<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add config to disable S101 (assert detected) and a few others in test folders - astral-sh/ruff #4368</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Add config to disable S101 (assert detected) and a few others in test folders</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/4368">#4368</a>
        opened by <a href="https://github.com/jankatins">@jankatins</a>
        on 2023-05-11 09:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jankatins">@jankatins</a> on 2023-05-11 09:51</div>
            <div class="timeline-body"><p>Per convention, testfolders usually reside in <code>&lt;reporoot&gt;/test/</code> or <code>&lt;reporoot&gt;/tests/</code>. Right now, every time I add certain rules, specifically S101, ARG, FBT, and a few others (e.g. via &quot;ALL&quot;), I have to add a folder exclude for these rules for the <code>tests/</code> folder:</p>
<pre><code class="language-toml">
[tool.ruff.per-file-ignores]
&quot;tests/**/*.py&quot; = [
    # at least this three should be fine in tests:
    &quot;S101&quot;, # asserts allowed in tests...
    &quot;ARG&quot;, # Unused function args -&gt; fixtures nevertheless are functionally relevant...
    &quot;FBT&quot;, # Don't care about booleans as positional arguments in tests, e.g. via @pytest.mark.parametrize()
    # The below are debateable
    &quot;PLR2004&quot;, # Magic value used in comparison, ...
    &quot;S311&quot;, # Standard pseudo-random generators are not suitable for cryptographic purposes
]
</code></pre>
<p>It would be really nice if ruff would do that automatically, E.g. by disabling the above rules via a central <code>test-files</code> list which is on a commonly used default:</p>
<pre><code class="language-toml">[tool.ruff]
# To disable tests which are ok in tests -&gt; would not need to be set as it would be a nice default
test-files =  [&quot;tests/**/*.py&quot;, &quot;test/**/*.py&quot;]
</code></pre>
<p>This was already discussed in https://github.com/charliermarsh/ruff/issues/714 where the original reporter (@harupy) closed the issue after confirming the per folder overwrites.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-05-11 23:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2023-07-10 01:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @charliermarsh on 2023-07-10 01:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-10 01:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jpmckinney">@jpmckinney</a> on 2023-07-12 23:10</div>
            <div class="timeline-body"><p>FWIW, I ignore the same rules (including the debatable ones), plus &quot;D&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../tensorchord/pgvecto.rs/pulls/138.html">tensorchord/pgvecto.rs#138</a> on 2023-11-17 03:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../wagtail/cookiecutter-wagtail-package/pulls/76.html">wagtail/cookiecutter-wagtail-package#76</a> on 2024-04-23 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paduszyk">@paduszyk</a> on 2024-07-19 20:54</div>
            <div class="timeline-body"><p>@jankatins I totally agree with your idea üëçüèª I would also propose to add S105, S106, and S107 to your list.</p>
<p>Hardcoded passwords usually appear in tests of authentication stuff. However, I am not entirely sure. For instance, this would require assuming that testers use naive &quot;placeholder&quot; passwords, not real passwords (maybe this could be set up via an extra <code>flake8-bandit</code> setting)...</p>
<p>@jankatins @jpmckinney What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jpmckinney">@jpmckinney</a> on 2024-07-20 04:06</div>
            <div class="timeline-body"><p>Sounds good to me. I haven't had those rules trigger, even though I do have hardcoded passwords in tests, but I would exclude them if they were triggering.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-20 15:46</div>
            <div class="timeline-body"><p>Are there some opportunities to improve our rules here? E.g., avoid flagging unused arguments in pytest fixtures, if we can detect them?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tomsquest">@tomsquest</a> on 2024-07-23 15:30</div>
            <div class="timeline-body"><p>For the one finding that issue, as of Ruff 0.5.4, I adapted @jankatins snippet to:</p>
<pre><code>[tool.ruff.lint.extend-per-file-ignores]
&quot;tests/**/*.py&quot; = [
    # at least this three should be fine in tests:
    &quot;S101&quot;, # asserts allowed in tests...
    &quot;ARG&quot;, # Unused function args -&gt; fixtures nevertheless are functionally relevant...
    &quot;FBT&quot;, # Don't care about booleans as positional arguments in tests, e.g. via @pytest.mark.parametrize()
    # The below are debateable
    &quot;PLR2004&quot;, # Magic value used in comparison, ...
    &quot;S311&quot;, # Standard pseudo-random generators are not suitable for cryptographic purposes
]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paduszyk">@paduszyk</a> on 2025-05-07 10:11</div>
            <div class="timeline-body"><p>What do you think about including <code>E501</code>? Test function names are usually quite long, particularly if they serve as documentation (e.g., when the names follow a pattern that clearly indicates the purpose, scenario, and expected outcome of the test).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../jkwlsn/apis-api/issues/22.html">jkwlsn/apis-api#22</a> on 2025-06-03 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/starhel">@starhel</a> on 2025-06-25 15:06</div>
            <div class="timeline-body"><blockquote>
<p>&quot;ARG&quot;, # Unused function args -&gt; fixtures nevertheless are functionally relevant...</p>
</blockquote>
<p>You should probably use <code>@pytest.mark.usefixtures</code>. There‚Äôs probably only one scenario where this won‚Äôt work ‚Äì when one fixture depends on another, but only uses its state rather than the fixture directly.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:09 UTC
    </footer>
</body>
</html>
