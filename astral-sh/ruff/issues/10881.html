<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Format suppression is ignored for imports - astral-sh/ruff #10881</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Format suppression is ignored for imports</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10881">#10881</a>
        opened by <a href="https://github.com/b-phi">@b-phi</a>
        on 2024-04-11 14:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/b-phi">@b-phi</a></div>
            <div class="timeline-body"><p>I have a long import line that I'd like to custom format to avoid exceeding the configured line length. Neither <code># fmt: skip</code> or <code># fmt: off</code> seem to prevent ruff from reformatting the line. I confirmed that format suppression does work for other statements in the file.</p>
<p>Input</p>
<pre><code class="language-python">x =           2  # fmt: skip
from my.very_very_very_very_very_very_very_long_package\
    import my_very_very_very_very_very_very_long_name  # fmt: skip

# or

# fmt: off
x =           2
from my.very_very_very_very_very_very_very_long_package\
    import my_very_very_very_very_very_very_long_name
# fmt: on
</code></pre>
<p>Output</p>
<pre><code class="language-python">x =           2  # fmt: skip
from my.very_very_very_very_very_very_very_long_package import (
    my_very_very_very_very_very_very_long_name
)

# or

# fmt: off
x =           2
from my.very_very_very_very_very_very_very_long_package import (
    my_very_very_very_very_very_very_long_name
)
# fmt: on
</code></pre>
<p>Version: 0.3.5</p>
<p>Config</p>
<pre><code class="language-yaml">- repo: https://github.com/astral-sh/ruff-pre-commit
  rev: v0.3.5
  hooks:
    - id: ruff-format
    - id: ruff
</code></pre>
<pre><code class="language-toml">[tool.ruff]
line-length = 79
fix = true

[tool.ruff.format]
quote-style = 'single'

[tool.ruff.lint]
extend-select = ['E501', 'I']
</code></pre>
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-11 14:58</div>
            <div class="timeline-body"><p>Thanks for the detailed write up. I pasted your example in the playground and the formatting looks correct (the formatter doesn't reformat the file).</p>
<p>What I suspect is that isort reformats the file which then makes the formatter format the file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/b-phi">@b-phi</a> on 2024-04-11 15:15</div>
            <div class="timeline-body"><p>Hey Micha, thanks for the quick reply. You are right, if I remove the <code>I</code> from extend-select, the import is no longer formatted. Is there a way to disable the import formatting for a specific line?</p>
<p>Edit: The isort action comments don't work</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-11 16:22</div>
            <div class="timeline-body"><p>I think this works, but it doesn't just disable the formatting of isort, it also means that <code>isort</code> won't sort that line anymore</p>
<pre><code class="language-python">from my.very_very_very_very_very_very_very_long_package\ # isort:skip
    import my_very_very_very_very_very_very_long_name  # fmt: skip
</code></pre>
<p>and it looks super silly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/b-phi">@b-phi</a> on 2024-04-11 16:28</div>
            <div class="timeline-body"><blockquote>
<p>I think this works, but it doesn't just disable the formatting of isort, it also means that <code>isort</code> won't sort that line anymore</p>
<pre><code class="language-python">from my.very_very_very_very_very_very_very_long_package\ # isort:skip
    import my_very_very_very_very_very_very_long_name  # fmt: skip
</code></pre>
<p>and it looks super silly.</p>
</blockquote>
<p>Comment after a backslash seems to be a syntax error, but this does work. Probably even sillier though.</p>
<pre><code class="language-python"># isort: off
# fmt: off
from my.very_very_very_very_very_very_very_long_package\
    import my_very_very_very_very_very_very_long_name
# isort: on
# fmt: on
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-11 16:37</div>
            <div class="timeline-body"><p>Oh right. lol. So it worked because it had a syntax error. Silly me. But yes, that's similar. You could probably keep the <code>fmt: skip</code> at the end of the line but I don't think it makes a real difference.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/b-phi">@b-phi</a> on 2024-04-11 16:40</div>
            <div class="timeline-body"><p>Thanks for the help. Maybe <code># fmt: off</code> / <code># fmt: skip</code> should imply the isort variants, just a thought.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @b-phi on 2024-04-11 16:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:50:03 UTC
    </footer>
</body>
</html>
