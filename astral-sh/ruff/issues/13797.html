<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Identifier's id field points to a Name - astral-sh/ruff #13797</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Identifier&#x27;s id field points to a Name</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13797">#13797</a>
        opened by <a href="https://github.com/samwgoldman">@samwgoldman</a>
        on 2024-10-17 17:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/samwgoldman">@samwgoldman</a></div>
            <div class="timeline-body">

<p>This issue is just feedback for the AST&#x27;s API, not a bug.</p>
<p>I&#x27;ve been working with the Ruff parser, which has been really great so far. Thanks a ton for providing this code! While working with the AST, I have found the naming around <code>Identifier</code> and <code>Name</code> nodes a bit awkward. Specifically, <code>Identifier</code>&#x27;s <a href="https://github.com/astral-sh/ruff/blob/5e6de4e0c69660e8ca8608d1ac965216197756ce/crates/ruff_python_ast/src/nodes.rs#L3897"><code>id</code> field</a> is a <code>Name</code>, so I often end up with code that looks like <code>id.id</code>, because I use <code>id</code> to refer to the <code>Identifier</code>.</p>
<p>This is just a minor thing, but I thought I&#x27;d raise it. Would you consider changing the field to <code>name</code> eventually?</p>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-18 06:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-18 06:13</div>
            <div class="timeline-body"><p>Yeah, <code>id.id</code> reads a bit awkward. However, most of the time, it shouldn&#x27;t be necessary to access the name directly. Instead, you can write <code>&amp;*id</code> or <code>id.as_str</code> to get to the underlying string. You can also compare <code>Identifier</code> with a str etc.</p>
<p>Using <code>name</code>, unfortunately, can also be somewhat awkward:</p>
<ul>
<li><code>func_def.name.name and the same for </code>class_def`.</li>
<li><code>global_stmt.name[0].name</code>  and the same for <code>local_stmt.name[0]</code></li>
<li><code>except_handler.name.unwrap().name</code></li>
</ul>
<p>We could consider renaming the field to <code>text</code> (TypeScript calls it escaped text), go for <code>name</code> regardless (same as <a href="https://astexplorer.net/#/gist/807331e9c71c50fe6133a4f2e6dbe587/21f20dfa54237927e18f8709c25f27512cf3a0ca">jsshift</a>) or <code>value</code> (swc).</p>
<p>Or we leave it as is and treat it as an internal name that you rarely need to access.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ndmitchell">@ndmitchell</a> on 2024-10-19 12:10</div>
            <div class="timeline-body"><p>In the code I&#x27;m writing (along with Sam), we often need to go from an <code>Identifier</code> to a <code>Name</code>, since we are deliberately keeping the <code>Name</code> intact as a name when passing it around, rather than reducing it to a <code>&amp;str</code> to keep more type safety, and benefit from the underlying <code>CompactStr</code> representation. As a result, <code>Name</code> is being used directly quite a bit.</p>
<p>If you look at the types, <code>Identifier</code> is a pair of <code>Name</code> and <code>Range</code>, but <code>Name</code> is just the name. As a result, naming an <code>Identifier</code> with <code>.name</code> (as you do in <code>StmtFunctionDef</code>) is reasonable (semantically, it&#x27;s the <code>Name</code>, just wrapped up with a bit more stuff), but naming the <code>Name</code> within an <code>Identifier</code> as <code>id</code> feels wrong (it lacks the <code>Range</code> information that would make it an <code>Identifier</code>). As a result of that, I don&#x27;t find <code>func_def.name.name</code> to be that awkward - it&#x27;s not the fact it&#x27;s <code>id.id</code> that is awkward, but that you don&#x27;t end up with the pieces of an <code>id</code> at the end.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-19 14:05</div>
            <div class="timeline-body"><p>I don&#x27;t fully agree with the reasoning about <code>FunctionDef</code>. IMO, <code>func.name</code> should be renamed to <code>func.id</code> to be consistent with renaming <code>Identifier.id</code> to name because the field&#x27;s type is <code>Name</code>. For historical context, it used to be a <code>str</code>.</p>
<p>Either way. I don&#x27;t think the name matters that much that it justifies the churn it creates for downstream tools. There are multiple projects using Ruff&#x27;s parser today and while the rename isn&#x27;t hard, it still imposes work on them for little gain, especially considering that it&#x27;s arguable whether the new name is considerably better.</p>
<p>Having said that. I also don&#x27;t care enough about the name. Feel free to go ahead with the rename if you feel strongly but consider the impact it has on other parser users.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-09 12:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:59 UTC
    </footer>
</body>
</html>
