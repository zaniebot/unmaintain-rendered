<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Isort split doesn't work when imports behind if statement - astral-sh/ruff #4579</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Isort split doesn't work when imports behind if statement</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4579">#4579</a>
        opened by <a href="https://github.com/bendoerry">@bendoerry</a>
        on 2023-05-22 14:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bendoerry">@bendoerry</a> on 2023-05-22 14:14</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<h2>Summary</h2>
<p>When I use <code># isort: split</code> inside of an <code>if</code> statement (e.g. behind <code>if TYPE_CHECKING</code>) it has no effect. Similarly if using</p>
<pre><code class="language-python"># isort: off
# isort: on
</code></pre>
<p>to try and replicate it's effect. However <code># isort: off</code> and <code># isort: on</code> work fine if used to actually ignore sorting a block.</p>
<h3>Ruff Version</h3>
<p><a href="https://github.com/charliermarsh/ruff/releases/tag/v0.0.269">v0.0.269</a></p>
<h3>Ruff Config</h3>
<pre><code class="language-toml">[isort]
section-order = [
  &quot;one&quot;,
  &quot;two&quot;,
]

[isort.sections]
one = [
    &quot;a&quot;, &quot;b&quot;,
    &quot;A&quot;, &quot;B&quot;,
]

two = [
    &quot;c&quot;, &quot;d&quot;,
    &quot;C&quot;, &quot;D&quot;,
]
</code></pre>
<h3>Ruff Command</h3>
<pre><code class="language-shell">ruff check --fix --select I split.py
</code></pre>
<h3>Python File <code>split.py</code></h3>
<pre><code class="language-python">import c
import a

# isort: split

import d
import b


if True:
    import C
    import A

    # isort: split

    import D
    import B

</code></pre>
<h3>Ruff Output</h3>
<pre><code class="language-shell">warning: `section-order` is missing built-in section: `Known(Future)`
Found 3 errors (3 fixed, 0 remaining).
</code></pre>
<p>The warning and including the built in sections in the config have no effect.
I just removed them from the config to keep it short.</p>
<h3>Modified Python File</h3>
<pre><code class="language-python">import a

import c

# isort: split

import b

import d

if True:
    import A
    import B

    import C

    # isort: split
    import D

</code></pre>
<p>The arrangements of the imports in the <code>if</code> statement should be the same as the imports outside of the statement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-05-22 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @charliermarsh on 2023-05-22 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-05-22 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-05-22 16:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:30:10 UTC
    </footer>
</body>
</html>
