<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement flake8-walrus - astral-sh/ruff #3464</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement flake8-walrus</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3464">#3464</a>
        opened by <a href="https://github.com/Cielquan">@Cielquan</a>
        on 2023-03-12 17:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Cielquan">@Cielquan</a></div>
            <div class="timeline-body"><h1><a href="https://pypi.org/project/flake8-walrus/">flake8-walrus</a></h1>
<p>Forbids usage of the <code>:=</code> walrus operator.</p>
<h3>Error Codes</h3>
<ul>
<li>[ ] <code>ASN001</code> do not use assignment expressions</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2023-03-12 17:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kyoto7250">@kyoto7250</a> on 2023-04-06 15:41</div>
            <div class="timeline-body"><p>Personally, I would like to work on implementing this plugin, but is this an appropriate rule to incorporate into <code>ruff</code>?</p>
<p>I know there were objections to the introduction of this operator, but I feel this rule is a matter of user preference.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-04-06 16:10</div>
            <div class="timeline-body"><p>What's the rational of forbidding the operator (other than <code>lol</code> :D). Is it useful to a broad audience of the Python community?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Cielquan">@Cielquan</a> on 2023-04-06 18:26</div>
            <div class="timeline-body"><p>The objection is readability. It may not be the only one, but it is mine.
I totally see that it is somewhat of a nice QoL feature, but I and others too do not want to exchange readability for 1 line of code saved.</p>
<p>And I do not want others to be able to use it in code I maintain, so I forbid its usage via the flake8 plugin by running flake8 in CI.</p>
<p>It is totally subjective preference but so is any style rule somehow, is it not?
But in comparison to PEP8 it is rather niche I guess. So I can see why one would not want to implement it. But nontheless I and probably others too would like to have it being implemented. ðŸ˜‰</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-06 21:24</div>
            <div class="timeline-body"><p>Yeah, I think this is a hard one for us to merge until we have a clearer policy on opinionated rules / plugins (similar to #3463).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-04-11 07:11</div>
            <div class="timeline-body"><blockquote>
<p>It is totally subjective preference but so is any style rule somehow, is it not?
But in comparison to PEP8 it is rather niche I guess. So I can see why one would not want to implement it. But nontheless I and probably others too would like to have it being implemented.</p>
</blockquote>
<p>Thanks for explaining your motivation.</p>
<p>We're considering reorganizing the ruff rules and one category that we intend to introduce is <code>restriction</code>. Rules in the <code>restriction</code> category are opinionated, not recommended for most users, and restrict the allowed language feature. I could see this rule fit into that category if it satisfies the criteria that it is useful to some community users (we don't want to have &quot;I don't like&quot; rules, where <em>I</em> is a single person).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Cielquan">@Cielquan</a> on 2023-04-11 08:58</div>
            <div class="timeline-body"><p>The <code>restriction</code> category sounds very nice. I think this will be a very good way to separate those special rules.</p>
<p>Sure, when e.g. I am the only one using it, I would have to wait for plugin support and write my own plugin for this. This makes sense to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-10 01:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-14 12:34</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/issues/13741 is related where the author asked for restricting most, but not all walrus operators.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alexprengere">@alexprengere</a> on 2025-05-30 17:42</div>
            <div class="timeline-body"><p>I have been using <a href="https://github.com/MarcoGorelli/auto-walrus/">auto-walrus</a> to automatically add walrus operators to a private codebase (lots of XML parsing with lxml), and I found the results really good.</p>
<p>A typical change by that tool looks like this:</p>
<pre><code class="language-python"># Before
version = get_version(xml)
if version is not None:
    m.version = version

# After
if (version := get_version(xml)) is not None:
    m.version = version
</code></pre>
<p>Auto-walrus does not &quot;catch&quot; everything, for example this one was manually added by me, not detected by the tool as-is:</p>
<pre><code class="language-python"># Before
if xml.find(&quot;TotalPrice/Total&quot;) is not None:
    total = xml.find(&quot;TotalPrice/Total&quot;)
    flight.price = float(total.text)

# After
if (total := xml.find(&quot;TotalPrice/Total&quot;)) is not None:
    flight.price = float(total.text)
</code></pre>
<p>I was about to suggest new rewriting rules to ruff based on auto-walrus.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Cielquan">@Cielquan</a> on 2025-06-01 11:51</div>
            <div class="timeline-body"><p>Well the walrus operator is very dividing. There are people who like it and people who don't. It's a matter of taste after all I think.</p>
<p>I see value in have an optional restriction rule to forbid it's usage, but I also see value in an optional rule like auto-walrus.</p>
<p>I personally used it once in a list comprehension where it made the code simpler in my opinion. But in a general use like in your example I personally don't like it, because I think the code without is easier to read. But that is just my taste and I respect your taste if you like to use it in your code base.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-06-03 17:35</div>
            <div class="timeline-body"><blockquote>
<p>https://github.com/astral-sh/ruff/issues/13741 is related where the author asked for restricting most, but not all walrus operators.</p>
</blockquote>
<p>I do feel like that was a different ask. Removing redundant walrus leads to the same come but with 1 less character and autofixable.</p>
<p>Not the same as forbidding/forcing walrus usage where the code would need to be changed by adding or removing a separate assignement.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:46 UTC
    </footer>
</body>
</html>
