<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLR6201 should only apply to hashable types - astral-sh/ruff #20510</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>PLR6201 should only apply to hashable types</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/20510">#20510</a>
        opened by <a href="https://github.com/JoElfner">@JoElfner</a>
        on 2025-09-22 08:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JoElfner">@JoElfner</a> on 2025-09-22 08:45</div>
            <div class="timeline-body"><h3>Summary</h3>
<h1>Ruff version</h1>
<p>ruff 0.12.12</p>
<h1>Ruff settings</h1>
<p>PLR6201 enabled</p>
<h1>Problem</h1>
<p>Fix safety description of PLR6201 is misleading:</p>
<blockquote>
<p><a href="https://docs.astral.sh/ruff/rules/literal-membership/#fix-safety">Fix safety</a>
This rule's fix is marked as unsafe, as the use of a set literal will error at runtime if the sequence contains unhashable elements (like lists or dictionaries). While Ruff will attempt to infer the hashability of the elements, it may not always be able to do so.</p>
</blockquote>
<p>This reads as if <strong>only</strong> the hashability of the rhs-sequence was the problem. But in my opinion, the hashability of the lhs is more problematic in most use cases. F.i.</p>
<pre><code>def foo(val: str | list[str] | dict[str, str]) -&gt; bool:
    return val in {&quot;a&quot;, &quot;b&quot;, &quot;c&quot;}
</code></pre>
<h3>Version</h3>
<p>ruff 0.12.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-09-22 16:14</div>
            <div class="timeline-body"><p>Thanks for the report! It looks like this is already the case in the rule's implementation, so we should definitely update the docs to reflect that.</p>
<p>https://github.com/astral-sh/ruff/blob/00a9e65d001082972f9c83ce8f405046985a26c6/crates/ruff_linter/src/rules/pylint/rules/literal_membership.rs#L73-L75</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @ntBre on 2025-09-22 16:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/20518.html">astral-sh/ruff#20518</a> on 2025-09-22 19:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JoElfner">@JoElfner</a> on 2025-09-23 10:51</div>
            <div class="timeline-body"><p>thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-10-01 17:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
