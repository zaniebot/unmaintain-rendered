<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EM could support percent formatting - astral-sh/ruff #18766</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>EM could support percent formatting</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18766">#18766</a>
        opened by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a>
        on 2025-06-18 18:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2025-06-18 18:48</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Currently <code>EM</code> only has rules checking for f-strings and <code>.format</code>. It could also support percent formatting, as in</p>
<pre><code class="language-py">raise RuntimeError(&quot;timed out waiting for file: %s&quot; % path)
</code></pre>
<p>But this is currently missed <a href="https://play.ruff.rs/35bb2b34-3974-4562-83db-96772e94820e">playground</a></p>
<pre><code>PS ~\Desktop\New_folder&gt;Get-Content issue.py
</code></pre>
<pre><code class="language-py">raise RuntimeError(&quot;timed out waiting for file: %s&quot; % path)
</code></pre>
<pre><code>PS ~\Desktop\New_folder&gt;uvx ruff check issue.py --select EM
</code></pre>
<pre><code>All checks passed!
</code></pre>
<p>Currently this can be fixed if <code>UP031</code> is also enabled, since it converts the percent formatting to a fixable <code>.format</code> <a href="https://play.ruff.rs/fb46314a-2ca8-4497-822c-918d27770cd1">playground</a></p>
<pre><code>PS ~\Desktop\New_folder&gt;uvx ruff check issue.py --select EM --select UP031 --unsafe-fixes --diff
</code></pre>
<pre><code class="language-diff">--- issue.py
+++ issue.py
@@ -1 +1,2 @@
-raise RuntimeError(&quot;timed out waiting for file: %s&quot; % path)
+msg = &quot;timed out waiting for file: {}&quot;.format(path)
+raise RuntimeError(msg)

Would fix 2 errors.
</code></pre>
<p>However, this does not work if the string is a byte string, since <code>UP031</code> does not/cannot support byte strings <a href="https://play.ruff.rs/2952b1df-2101-495a-84de-d375c66204d4">playground</a></p>
<pre><code>PS ~\Desktop\New_folder&gt;Get-Content issue.py
</code></pre>
<pre><code class="language-py">raise RuntimeError(b&quot;timed out waiting for file: %s&quot; % path)
</code></pre>
<pre><code>PS ~\Desktop\New_folder&gt;uvx ruff check issue.py --select EM --select UP031 --unsafe-fixes
</code></pre>
<pre><code>All checks passed!
</code></pre>
<p>Which is where <code>EM</code> supporting percent formatting would be useful. This is also not unheard of, as several of the results from a <a href="https://github.com/search?q=language%3APython+raise+RuntimeError%28b%22&amp;type=code">github search</a> for <code>raise RuntimeError(b&quot;</code> use byte string percent formatting.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-18 20:37</div>
            <div class="timeline-body"><p>I think this was raised before (on my phone where searching issues is a bit painful). The reasoning why we don't support it is because percent formatting comes with a lot of edge cases and those rules are fairly complex. We don't want to repeat the complexity and it shouldn't matter for most users if they have both fixes enabled.</p>
<p>I believe you raised another issue to add support for Byte strings, so that it would be covered too</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2025-06-18 20:43</div>
            <div class="timeline-body"><p>#18765 is for <code>EM101</code> specifically, while this would be for a new rule. This issue is mostly targeting the edge case where the message is a byte string that uses percent formatting, since that can't be turned into a <code>.format</code> by <code>UP031</code>, so it currently can't be handled by <code>EM</code> despite being a duplicate message. I also can't find an issue where someone requested this before, I may be missing it though.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:37:44 UTC
    </footer>
</body>
</html>
