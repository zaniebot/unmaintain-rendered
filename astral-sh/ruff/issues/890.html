<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F841 is triggered by unused variables in tuple unpacking from with statements - astral-sh/ruff #890</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>F841 is triggered by unused variables in tuple unpacking from with statements</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/890">#890</a>
        opened by <a href="https://github.com/fnep">@fnep</a>
        on 2022-11-23 08:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/fnep">@fnep</a> on 2022-11-23 08:44</div>
            <div class="timeline-body"><p>When tuple unpacking is used within <code>as</code> of a with statement, F841 is raised for unused variables. This is fine if really all variables are unused, but if I need only one, I have not other choice then getting all. This happens only within functions.</p>
<pre><code class="language-python3">def connect():
    return (None, None)


def test():
    with connect() as (connection, cursor):
        cursor.execute(&quot;SELECT * FROM users&quot;)

</code></pre>
<p>using ruff 0.0.135 gives me</p>
<pre><code>test.py:7:24: F841 Local variable `connection` is assigned to but never used
</code></pre>
<p>In flake8, this is case works.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2022-11-23 11:37</div>
            <div class="timeline-body"><p>You can use an underscore to ignore unused values.</p>
<pre><code class="language-python">def connect():
    return (None, None)


def test():
    with connect() as (_, cursor):
        cursor.execute(&quot;SELECT * FROM users&quot;)
</code></pre>
<p>Flakes should have detected it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fnep">@fnep</a> on 2022-11-23 13:21</div>
            <div class="timeline-body"><p>As a workaround for a few places <code>_</code> would work, I'm testing a huge codebase. Thank you anyway for the idea.</p>
<p>Neither pyflakes nor flake8 find this an issue in my tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2022-11-23 14:36</div>
            <div class="timeline-body"><blockquote>
<p>Flakes should have detected it.</p>
</blockquote>
<p>I meant that it might be a bug from <code>flake8</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2022-11-23 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-23 14:46</div>
            <div class="timeline-body"><p>Hmm, yeah, I think we may want to allow this.</p>
<p>Some related stuff here: https://github.com/charliermarsh/ruff/issues/161.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2022-11-23 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-23 16:40</div>
            <div class="timeline-body"><p>(Will be fixed today.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/897.html">astral-sh/ruff#897</a> on 2022-11-24 01:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-11-24 01:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fnep">@fnep</a> on 2022-11-25 08:30</div>
            <div class="timeline-body"><p>Works perfect in ruff==0.0.137, thank you :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-25 14:49</div>
            <div class="timeline-body"><p>Awesome :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11797.html">astral-sh/ruff#11797</a> on 2024-06-07 15:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/merlynmarc">@merlynmarc</a> on 2024-09-13 12:38</div>
            <div class="timeline-body"><p>I would prefer that ruff flags the unused variable (or at least gives me the option to).  I would write the original code as the underscore version (actually as _connection).  The fact that ruff doesn't flag this is a blocker for me adopting ruff over pylint.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:03 UTC
    </footer>
</body>
</html>
