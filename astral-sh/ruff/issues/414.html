<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using ruff as a drop-in replacement for flake8 - astral-sh/ruff #414</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Using ruff as a drop-in replacement for flake8</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/414">#414</a>
        opened by <a href="https://github.com/fsouza">@fsouza</a>
        on 2022-10-13 02:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/fsouza">@fsouza</a> on 2022-10-13 02:30</div>
            <div class="timeline-body"><p>I'd love to be able to replace flake8 with ruff, and while most things are compatible, one current limitation is the configuration: flake8 can be configured via setup.cfg and .flake8, and at work it's a pretty common setup. Migrating everyone to pyproject.toml will likely not happen anytime soon. So I was wondering what could be done here. I thought of two options:</p>
<ol>
<li>make ruff support all flake8 flags and configuration files
This is probably not something you'd like to have, as it becomes a layer of configuration that you don't have support for.</li>
<li>build a &quot;bridge&quot; package: something that reads flake8 configuration and invokes ruff with the proper parameters (at least the supported ones)
This can be done by a third party (I'm happy to do it), but in order to make it happen, ruff would need to support taking the configuration in some alternative mechanism (I can think of either (1) allow all settings to be defined via command line flags or (2) add a command line flag to allow the user to override the location of <code>pyproject.toml</code> - that way the &quot;bridge&quot; tool would generate the config file and invoke ruff with that flag)</li>
</ol>
<p>Let me know if you have any thoughts!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-10-13 02:39</div>
            <div class="timeline-body"><p>Making adoption + migration easier is very important to me! I'm happy to both work directly on and support efforts in this vein. (And definitely interested to learn from your experience on what would be helpful here.)</p>
<p>I think you're right that supporting all Flake8 flags + configuration files is less desirable. We <em>could</em> do it, we already mimic Flake8 configuration for certain settings... Honestly, I'm somewhat tempted to do it... But it might be a mistake.</p>
<p>I like the idea of making the <code>pyproject.toml</code> path configurable, since it's very easy and makes Ruff feel a bit more &quot;pluggable&quot;. (Flake8, coincidentally, supports this too, as do most tools, so Ruff should allow it.) From there, we could even provide scripts to convert setup.cfg and .flake8 to pyproject.toml.</p>
<p>I'll start by making the pyproject.toml configurable (or you're welcome to! I won't get to it tonight).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2022-10-13 13:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/418.html">astral-sh/ruff#418</a> on 2022-10-13 13:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sobolevn">@sobolevn</a> on 2022-10-13 17:35</div>
            <div class="timeline-body"><p>I think we can provide a config converter: <code>ruff config-convert setup.cfg</code> or <code>.flake8</code> and it will return <code>pyproject.toml</code> with valid configuration.</p>
<p>It would be a good path forward. New tools should use new <code>pyproject.toml</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-10-13 18:05</div>
            <div class="timeline-body"><p>Agreed!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/423.html">astral-sh/ruff#423</a> on 2022-10-13 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-10-14 03:03</div>
            <div class="timeline-body"><p>My thought was more about being able to do that on-the-fly. I want to be able to use ruff locally on projects that use flake8 and cannot be migrated x)</p>
<p>I'll work on something like that that leverages the new <code>--config</code> flag! üòÅ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-10-15 02:28</div>
            <div class="timeline-body"><p>@charliermarsh I'm thinking I'll take a very lazy approach with a python package that depends on flake8 and ruff. I wonder if you plan on eventually providing a Python interface to invoke ruff? Or is Rust the only language that will have access to ruff's API?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-10-15 04:55</div>
            <div class="timeline-body"><p>Wrote a rudimentary hack here: https://github.com/fsouza/flake8-ruff-wrapper</p>
<p>I feel like having something like this living in ruff may be easier to keep supported settings and rule in sync.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-10-15 15:32</div>
            <div class="timeline-body"><p>Nice! We may want two things here:</p>
<ol>
<li>A command built-in to Ruff to convert Flake8 settings to a <code>pyproject.toml</code>.</li>
<li>An external tool (like above) that could leverage that command to act as an automatic wrapper (like you've done above).</li>
</ol>
<p>Does that distinction make sense? If we had a command within Ruff that automatically generated a <code>pyproject.toml</code> from a Flake8 settings file, would that be sufficient to power <code>flake8-ruff-wrapper</code>? (My assumption is that you'd call that new Ruff command, write the <code>pyproject.toml</code> to a temporary location, then invoke Ruff pointed to that temporary location, which would let you configure to use Flake8 settings files without migrating to <code>pyproject.toml</code> as in your setup.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-10-15 17:19</div>
            <div class="timeline-body"><p>Yeah, that would definitely work!</p>
<p>edit: it would be even more convenient if that command operated over stdin/stdout, this way the wrapper wouldn't have to manage too many files/make sure that the file generated by ruff gets deleted and what not</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-10-15 21:17</div>
            <div class="timeline-body"><p>Ok cool, that work is being tracked under #423.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/283.html">astral-sh/ruff#283</a> on 2022-10-25 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/527.html">astral-sh/ruff#527</a> on 2022-10-31 14:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-11-01 21:23</div>
            <div class="timeline-body"><p>@charliermarsh hey, one difference that I noticed between ruff and flake8 is that ruff uses 0-indexed column numbers and flake8 uses 1-indexed column numbers. Somewhat redacted example from a real piece of code:</p>
<pre><code>ÔºÖ cat sample.py | flake8 -
stdin:312:9: F841 local variable 'mock_stable_percent' is assigned to but never used
ÔºÖ cat sample.py | ruff -
Found 1 error(s).
-:312:8: F841 Local variable `mock_stable_percent` is assigned to but never used
</code></pre>
<p>Since I have this integrated in my editor, I end-up jumping to the wrong position. I can try to figure out this on my side, but I'm curious if you intended to have columns reported on a 0-index base (I know that this is somewhat controversial, so I'll adapt either way hah)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-01 21:31</div>
            <div class="timeline-body"><p>@fsouza - Good question. RustPython used to use 1-indexing for both row and column numbers, but they recently switched to zero-indexed columns, so I reflected that change in Ruff. (This actually matches the CPython <code>ast</code> module, which provides a 1-indexed <code>lineno</code> and a 0-indexed <code>col_offset</code>.)</p>
<p>I guess editors tend to use 1-indexing, so maybe I should switch back to a 1-index for error reports, even if we're using a zero-index internally. What do you think? What's more intuitive?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-11-01 21:45</div>
            <div class="timeline-body"><p>@charliermarsh yeah I noticed that many tools do that, track columns as 0-indexed and then report it as 1-indexed. For example, mypy uses 0-based indices for the column number (https://github.com/python/mypy/blob/9227bceb629a1b566a60cbdd09fef6731f7bfcb1/mypy/errors.py#L52-L53), but then when reporting the error they make it 1-based (https://github.com/python/mypy/blob/8b825472a02f0a30419c02e285ba931107a42959/mypy/errors.py#L778)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-01 21:46</div>
            <div class="timeline-body"><p>Ah ok, cool. I'll just do that. Will make an issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/537.html">astral-sh/ruff#537</a> on 2022-11-01 21:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fsouza">@fsouza</a> on 2022-11-01 21:47</div>
            <div class="timeline-body"><blockquote>
<p>Ah ok, cool. I'll just do that. Will make an issue.</p>
</blockquote>
<p>Thank you! I can send a PR later today if you want!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-01 21:47</div>
            <div class="timeline-body"><p>@fsouza - Awesome! PRs always welcome!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-02 19:43</div>
            <div class="timeline-body"><p>Closing as we now have <a href="https://pypi.org/project/flake8-to-ruff/"><code>flake8-to-ruff</code></a>!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-11-02 19:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/asmeurer">@asmeurer</a> on 2023-01-31 19:18</div>
            <div class="timeline-body"><p>Is there any reason that https://github.com/fsouza/flake8-ruff-wrapper isn't just the built-in behavior for ruff? I would love to be able to just use a single configuration but let users use whichever tool that like.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../sympy/sympy/issues/24508.html">sympy/sympy#24508</a> on 2023-03-16 22:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/j0m0k0">@j0m0k0</a> on 2024-11-25 03:25</div>
            <div class="timeline-body"><p>As mentioned in the flake8-ruff-wrapper description: &quot;flake8-to-ruff is no longer supported. You may experience warnings or breakages when using it with versions of Ruff released after v0.0.233.&quot;.
My question is, do we have ANY automated way for using flake8 configs in ruff?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:06 UTC
    </footer>
</body>
</html>
