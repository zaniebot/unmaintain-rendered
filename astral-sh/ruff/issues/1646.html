<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `flake8-bandit` - astral-sh/ruff #1646</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>flake8-bandit</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1646">#1646</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-01-05 00:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><ul>
<li>[x] <code>S101</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b101_assert_used.html"><code>assert_used</code></a></li>
<li>[x] <code>S102</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b102_exec_used.html"><code>exec_used</code></a></li>
<li>[x] <code>S103</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b103_set_bad_file_permissions.html"><code>set_bad_file_permissions</code></a></li>
<li>[x] <code>S104</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b104_hardcoded_bind_all_interfaces.html"><code>hardcoded_bind_all_interfaces</code></a></li>
<li>[x] <code>S105</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b105_hardcoded_password_string.html"><code>hardcoded_password_string</code></a></li>
<li>[x] <code>S106</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b106_hardcoded_password_funcarg.html"><code>hardcoded_password_funcarg</code></a></li>
<li>[x] <code>S107</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b107_hardcoded_password_default.html"><code>hardcoded_password_default</code></a></li>
<li>[x] <code>S108</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b108_hardcoded_tmp_directory.html"><code>hardcoded_tmp_directory</code></a></li>
<li>[x] ~<code>S109</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b109_password_config_option_not_marked_secret.html"><code>password_config_option_not_marked_secret</code></a>~</li>
<li>[x] <code>S110</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b110_try_except_pass.html"><code>try_except_pass</code></a></li>
<li>[x] ~<code>S111</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b111_execute_with_run_as_root_equals_true.html"><code>execute_with_run_as_root_equals_true</code></a>~</li>
<li>[x] <code>S112</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b112_try_except_continue.html"><code>try_except_continue</code></a></li>
<li>[x] <code>S113</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b113_request_without_timeout.html"><code>request_without_timeout</code></a></li>
<li>[x] <code>S201</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b201_flask_debug_true.html"><code>flask_debug_true</code></a></li>
<li>[x] <code>S202</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b202_tarfile_unsafe_members.html"><code>tarfile_unsafe_members</code></a></li>
<li>[x] <code>S301</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>pickle</code></a></li>
<li>[x] <code>S302</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>marshal</code></a></li>
<li>[x] <code>S303</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>md5</code></a></li>
<li>[x] <code>S304</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>ciphers</code></a></li>
<li>[x] <code>S305</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>cipher_modes</code></a></li>
<li>[x] <code>S306</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>mktemp_q</code></a></li>
<li>[x] <code>S307</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>eval</code></a></li>
<li>[x] <code>S308</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>mark_safe</code></a></li>
<li>[x] <code>S311</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>random</code></a></li>
<li>[x] <code>S312</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>telnetlib</code></a></li>
<li>[x] <code>S313</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_cElementTree</code></a></li>
<li>[x] <code>S314</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_ElementTree</code></a></li>
<li>[x] <code>S315</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_expatreader</code></a></li>
<li>[x] <code>S316</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_expatbuilder</code></a></li>
<li>[x] <code>S317</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_sax</code></a></li>
<li>[x] <code>S318</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_minidom</code></a></li>
<li>[x] <code>S319</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_pulldom</code></a></li>
<li>[x] <code>S320</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>xml_bad_etree</code></a></li>
<li>[x] <code>S321</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>ftplib</code></a></li>
<li>[x] <code>S323</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>unverified_context</code></a></li>
<li>[x] <code>S324</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b324_hashlib.html"><code>hashlib</code></a></li>
<li>[x] <code>S310</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b310-urllib-urlopen"><code>urllib_urlopen</code></a></li>
<li>[x] <code>S401</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b401-import-telnetlib"><code>import_telnetlib</code></a></li>
<li>[x] <code>S402</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib"><code>import_ftplib</code></a></li>
<li>[x] <code>S403</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b403-import-pickle"><code>import_pickle</code></a></li>
<li>[x] <code>S404</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b404-import-subprocess"><code>import_subprocess</code></a></li>
<li>[x] <code>S405</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b405-import-xml-etree"><code>import_xml_etree</code></a></li>
<li>[x] <code>S406</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b406-import-xml-sax"><code>import_xml_sax</code></a></li>
<li>[x] <code>S407</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b407-import-xml-expat"><code>import_xml_expat</code></a></li>
<li>[x] <code>S408</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b408-import-xml-minidom"><code>import_xml_minidom</code></a></li>
<li>[x] <code>S409</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b409-import-xml-pulldom"><code>import_xml_pulldom</code></a></li>
<li>[x] <code>S410</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b410-import-lxml"><code>import_lxml</code></a></li>
<li>[x] <code>S411</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b411-import-xmlrpclib"><code>import_xmlrpclib</code></a></li>
<li>[x] <code>S412</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b412-import-httpoxy"><code>import_httpoxy</code></a></li>
<li>[x] <code>S413</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto"><code>import_pycrypto</code></a></li>
<li>[x] <code>S415</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b415-import-pyghmi"><code>import_pyghmi</code></a></li>
<li>[x] <code>S501</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b501_request_with_no_cert_validation.html"><code>request_with_no_cert_validation</code></a></li>
<li>[x] <code>S502</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b502_ssl_with_bad_version.html"><code>ssl_with_bad_version</code></a></li>
<li>[x] <code>S503</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b503_ssl_with_bad_defaults.html"><code>ssl_with_bad_defaults</code></a></li>
<li>[x] <code>S504</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b504_ssl_with_no_version.html"><code>ssl_with_no_version</code></a></li>
<li>[x] <code>S505</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b505_weak_cryptographic_key.html"><code>weak_cryptographic_key</code></a></li>
<li>[x] <code>S506</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b506_yaml_load.html"><code>yaml_load</code></a></li>
<li>[x] <code>S507</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b507_ssh_no_host_key_verification.html"><code>ssh_no_host_key_verification</code></a></li>
<li>[x] <code>S508</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b508_snmp_insecure_version.html"><code>snmp_insecure_version</code></a></li>
<li>[x] <code>S509</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b509_snmp_weak_cryptography.html"><code>snmp_weak_cryptography</code></a></li>
<li>[x] <code>S601</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b601_paramiko_calls.html"><code>paramiko_calls</code></a></li>
<li>[x] <code>S602</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b602_subprocess_popen_with_shell_equals_true.html"><code>subprocess_popen_with_shell_equals_true</code></a></li>
<li>[x] <code>S603</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b603_subprocess_without_shell_equals_true.html"><code>subprocess_without_shell_equals_true</code></a></li>
<li>[x] <code>S604</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b604_any_other_function_with_shell_equals_true.html"><code>any_other_function_with_shell_equals_true</code></a></li>
<li>[x] <code>S605</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html"><code>start_process_with_a_shell</code></a></li>
<li>[x] <code>S606</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b606_start_process_with_no_shell.html"><code>start_process_with_no_shell</code></a></li>
<li>[x] <code>S607</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b607_start_process_with_partial_path.html"><code>start_process_with_partial_path</code></a></li>
<li>[x] <code>S608</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b608_hardcoded_sql_expressions.html"><code>hardcoded_sql_expressions</code></a></li>
<li>[x] <code>S609</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b609_linux_commands_wildcard_injection.html"><code>linux_commands_wildcard_injection</code></a></li>
<li>[x] <code>S610</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b610_django_extra_used.html"><code>django_extra_used</code></a></li>
<li>[x] <code>S611</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b611_django_rawsql_used.html"><code>django_rawsql_used</code></a></li>
<li>[x] <code>S612</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b612_logging_config_insecure_listen.html"><code>logging_config_insecure_listen</code></a></li>
<li>[x] <code>S701</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b701_jinja2_autoescape_false.html"><code>jinja2_autoescape_false</code></a></li>
<li>[x] <code>S702</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b702_use_of_mako_templates.html"><code>use_of_mako_templates</code></a></li>
<li>[ ] <code>S703</code>: <a href="https://bandit.readthedocs.io/en/latest/plugins/b703_django_mark_safe.html"><code>django_mark_safe</code></a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-05 00:12</div>
            <div class="timeline-body"><p>\cc @edgarrmondragon - easier to track here than to keep incrementing the count in the README. I'll populate the checklist.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2023-01-05 00:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2023-01-05 00:34</div>
            <div class="timeline-body"><p>thanks @charliermarsh!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-05 00:36</div>
            <div class="timeline-body"><p>By the way: the scripts are pretty bad right now, but it might save you some time (and would love help improving):</p>
<pre><code>python scripts/add_check.py --name ConvertLoopToAll --code SIM111 --plugin flake8-simplify
</code></pre>
<p>The main limitations right now are:</p>
<ol>
<li>Doesn't keep the members sorted in <code>registry.rs</code>, so has to be manually resorted (else checks appear out-of-order in the docs and elsewhere).</li>
<li>Assumes you're using a single <code>plugins.rs</code> file, instead of individual files for each check or a <code>checks.rs</code> file or whatever else, so that also requires manual tweaks.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2023-01-05 00:40</div>
            <div class="timeline-body"><blockquote>
<p>By the way: the scripts are pretty bad right now, but it might save you some time (and would love help improving):</p>
<pre><code>python scripts/add_check.py --name ConvertLoopToAll --code SIM111 --plugin flake8-simplify
</code></pre>
<p>The main limitations right now are:</p>
<ol>
<li>Doesn't keep the members sorted in <code>registry.rs</code>, so has to be manually resorted (else checks appear out-of-order in the docs and elsewhere).</li>
<li>Assumes you're using a single <code>plugins.rs</code> file, instead of individual files for each check or a <code>checks.rs</code> file or whatever else, so that also requires manual tweaks.</li>
</ol>
</blockquote>
<p>Thanks, I'll take a look at those. They might be really helpful for bandit's blacklist tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ahmedbilal">@ahmedbilal</a> on 2023-01-10 08:58</div>
            <div class="timeline-body"><p>Please implement the configurations for it as well e.g <code>exclude_dirs</code>.</p>
<p>https://bandit.readthedocs.io/en/latest/config.html#bandit-settings</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-10 13:02</div>
            <div class="timeline-body"><p>@ahmedbilal - I think <code>exclude_dirs</code> can be accomplished with the <code>per-file-ignores</code> settings, like:</p>
<pre><code class="language-toml">[tool.ruff.per-file-ignores]
&quot;excluded_dir&quot; = [&quot;S&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-01-12 18:29</div>
            <div class="timeline-body"><p>Not sure if this is the best place to ask, but do flake8-bandit and bandit have the same linters?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-01-12 18:30</div>
            <div class="timeline-body"><p>Also @charliermarsh do you think it would be helpful to pin all of the issues that are trackers for implementing a package to the top? It would make it easier for people to understand our progress, and to contribute to one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 19:54</div>
            <div class="timeline-body"><blockquote>
<p>Not sure if this is the best place to ask, but do flake8-bandit and bandit have the same linters?</p>
</blockquote>
<p>Yeah, I believe <code>flake8-bandit</code> is just a wrapper around <code>bandit</code> to make it compatible with Flake8: https://github.com/tylerwince/flake8-bandit/blob/3200f00bf34a8ff131139add500db3e62ee1e7fd/flake8_bandit.py#L9</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-01 20:03</div>
            <div class="timeline-body"><p>@charliermarsh It looks like you've only added the rules from <a href="https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing">here</a> to the list above, but missed those from <a href="https://bandit.readthedocs.io/en/latest/blacklists/index.html#complete-plugin-listing">here</a>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2023-02-01 20:06</div>
            <div class="timeline-body"><blockquote>
<p>@charliermarsh It looks like you've only added the rules from <a href="https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing">here</a> to the list above, but missed those from <a href="https://bandit.readthedocs.io/en/latest/blacklists/index.html#complete-plugin-listing">here</a>?</p>
</blockquote>
<p>@ngnpope I mentioned the blacklist plugins above, and yeah they wouldn't make the list much larger üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-01 20:13</div>
            <div class="timeline-body"><p>Thanks. I just came across this as a <code># noqa: S301</code> was flagged as unknown by <code>RUF100</code>. Added to <code>external</code> for now.
Have checked existing issues and opened new ones as I've found gaps in coverage, bugs, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-08 17:43</div>
            <div class="timeline-body"><p>It looks like B109 and B111 have been deprecated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-26 16:02</div>
            <div class="timeline-body"><p>I will tackle the blacklist_calls and blacklist_imports that @ngnpope mentioned.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-26 16:05</div>
            <div class="timeline-body"><p>Does that behavior not overlap with our existing banned-api rule?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-26 16:30</div>
            <div class="timeline-body"><p>Yes it does look like they perform the same operations, should I just add these to the default ones called?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-26 16:47</div>
            <div class="timeline-body"><p>My instinct is that we should just leave folks to adjust that configuration themselves rather than encode defaults (i.e. do nothing).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-26 16:53</div>
            <div class="timeline-body"><p>It seems like we should have some way of letting people know or giving them an easy way to add it. As someone who had been using the bandit package for years, I had no idea it checked this stuff specifically, and would have never thought to configure ruff to add it. Maybe I just need to know more about the packages I use, but this seems like a big loss in the value of bandit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-26 17:04</div>
            <div class="timeline-body"><p>I think I misunderstood -- I thought this was something that was user-configured, but it's a list of built-in items to flag. I'm open to including those as regular rules similar to Bandit. I didn't want to have something that was yet-again user configurable for the same purpose.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colin99d">@colin99d</a> on 2023-02-26 17:05</div>
            <div class="timeline-body"><p>I see, yeah I was not planning on making the user configurable either. I will make it a separate rule!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/martinlehoux">@martinlehoux</a> on 2023-03-13 17:36</div>
            <div class="timeline-body"><p>I'd like to try S703: <a href="https://bandit.readthedocs.io/en/latest/plugins/b703_django_mark_safe.html">django_mark_safe</a> , but is there the infrastructure to go check the risk of a variable across modules like bandit does?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThunderKey">@ThunderKey</a> on 2023-04-21 07:58</div>
            <div class="timeline-body"><p>I've compared the list of tests reported by <code>bandit --help</code> (version: 1.7.5) with the ones listed in this issue. The following seem to be missing:</p>
<ul>
<li>[x] <code>S310</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b310-urllib-urlopen"><code>urllib_urlopen</code></a> (already added by #3239)</li>
<li>[ ] <code>S401</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b401-import-telnetlib"><code>import_telnetlib</code></a></li>
<li>[ ] <code>S402</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib"><code>import_ftplib</code></a></li>
<li>[ ] <code>S403</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b403-import-pickle"><code>import_pickle</code></a></li>
<li>[ ] <code>S404</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b404-import-subprocess"><code>import_subprocess</code></a></li>
<li>[ ] <code>S405</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b405-import-xml-etree"><code>import_xml_etree</code></a></li>
<li>[ ] <code>S406</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b406-import-xml-sax"><code>import_xml_sax</code></a></li>
<li>[ ] <code>S407</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b407-import-xml-expat"><code>import_xml_expat</code></a></li>
<li>[ ] <code>S408</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b408-import-xml-minidom"><code>import_xml_minidom</code></a></li>
<li>[ ] <code>S409</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b409-import-xml-pulldom"><code>import_xml_pulldom</code></a></li>
<li>[ ] <code>S410</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b410-import-lxml"><code>import_lxml</code></a></li>
<li>[ ] <code>S411</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b411-import-xmlrpclib"><code>import_xmlrpclib</code></a></li>
<li>[ ] <code>S412</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b412-import-httpoxy"><code>import_httpoxy</code></a></li>
<li>[ ] <code>S413</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto"><code>import_pycrypto</code></a></li>
<li>[ ] <code>S415</code>: <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b415-import-pyghmi"><code>import_pyghmi</code></a></li>
</ul>
<p>Are these omitted intentionally?</p>
<details><summary>If you want a list to copy:</summary>
<p>

<pre><code>* [x] `S310`: [`urllib_urlopen`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b310-urllib-urlopen)
* [ ] `S401`: [`import_telnetlib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b401-import-telnetlib)
* [ ] `S402`: [`import_ftplib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib)
* [ ] `S403`: [`import_pickle`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b403-import-pickle)
* [ ] `S404`: [`import_subprocess`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b404-import-subprocess)
* [ ] `S405`: [`import_xml_etree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b405-import-xml-etree)
* [ ] `S406`: [`import_xml_sax`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b406-import-xml-sax)
* [ ] `S407`: [`import_xml_expat`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b407-import-xml-expat)
* [ ] `S408`: [`import_xml_minidom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b408-import-xml-minidom)
* [ ] `S409`: [`import_xml_pulldom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b409-import-xml-pulldom)
* [ ] `S410`: [`import_lxml`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b410-import-lxml)
* [ ] `S411`: [`import_xmlrpclib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b411-import-xmlrpclib)
* [ ] `S412`: [`import_httpoxy`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b412-import-httpoxy)
* [ ] `S413`: [`import_pycrypto`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto)
* [ ] `S415`: [`import_pyghmi`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b415-import-pyghmi)
</code></pre>
</p>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-02 06:18</div>
            <div class="timeline-body"><p>@ThunderKey - No, I think we just missed them since they're listed under a <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html">separate page</a> in the docs -- adding now, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daverball">@Daverball</a> on 2023-05-02 08:47</div>
            <div class="timeline-body"><p>For interoperability between the reference implementation through direct use of bandit and ruff it would be nice to support <code>nosec</code> comments in addition to <code>noqa</code>. There is also an open issue for this on <code>flake8-bandit</code>: https://github.com/tylerwince/flake8-bandit/issues/20</p>
<p>Otherwise you need redundant comments to ignore the error both in ruff and bandit. (This would allow one to use ruff locally for speed but bandit on CI for correctness/completeness)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-02 15:56</div>
            <div class="timeline-body"><p>I think you're right that we should support <code>nosec</code> comments. It's similar to our support for isort's comment directives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-05-03 06:50</div>
            <div class="timeline-body"><blockquote>
<p>I think you're right that we should support <code>nosec</code> comments. It's similar to our support for isort's comment directives.</p>
</blockquote>
<p>I do see value in supporting <code>nosec</code> suppression comments to ease adoption but it has the disadvantage that Ruff suddenly supports multiple ways for suppressing a violation rather than just one. Having multiple ways to achieve the same can be confusing to users and it may not be clear to them when they should use which suppression comment format, resulting in them likely using all formats in their code base.</p>
<p>Supporting multiple suppression comments also raises the question of what format ruff should use when running with <code>--add-noqa</code> or when adding suppression comments using the code actions in the IDE.</p>
<p>I don't have good answers to this and we'll face the very same problem if we ever decide to introduce a ruff-specific suppression format. Would ruff continue to support other suppression comment formats or would we provide an automated migration tool?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-05-03 07:56</div>
            <div class="timeline-body"><p>I have the same concerns. A migration tool would make a lot of sense. I can however see the value of supporting existing suppression comments from other tools to ease migration. Maybe this support should be behind a configuration flag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daverball">@Daverball</a> on 2023-05-03 08:31</div>
            <div class="timeline-body"><p>While I do agree this is a commendable goal in most cases, in this specific case I would have to disagree, since bandit is a security linter, a lot of users would probably prefer to keep using the reference implementation on their CI, to rule out any issues in transposing the rules from Python to Rust. (I would definitely count myself among those)</p>
<p>The speed benefit is far more significant in local development, so you are willing to take the risk of some false negatives there, but on the CI the concerns flip and you want it to catch everything.</p>
<p>So if you force people to migrate to a different style of rules they either have to use them both redundantly or not use them at all locally and only use them on the CI or setup a separate flake8 config just so it can be ignored using the flake8-bandit rule names. None of which seem very appealing to me. I think it is folly to take flake8-bandit as the reference here, rather than bandit itself. I would treat bandit the same way as isort is treated.</p>
<p>I don't think the risk of confusion is as high if you treat the noqa comments as temporary and the nosec as solid. nosec is also honestly just better documentation than a code starting with S, that you will just skip over because you are only looking at the noqa part of it. I think it's fair to be more demanding of users in the case of potential security concerns.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/scop">@scop</a> on 2023-05-19 08:31</div>
            <div class="timeline-body"><p>Some updates:</p>
<ul>
<li>S310 is not in its sorted place in the list :)</li>
<li>Could add <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b325-tempnam">S325</a> for completeness, even though it has been removed in bandit, so probably not worth implementing in ruff either</li>
<li>S601 is done per #4500</li>
<li>S609 WIP per #4504</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mkniewallner">@mkniewallner</a> on 2023-09-23 14:32</div>
            <div class="timeline-body"><p>I'm open to work on all the <code>import_*</code> rules from <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html"><code>blacklist_imports</code></a>, but I wonder if they all are that useful, given that some kind of overlap with <a href="https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html"><code>blacklist_calls</code></a> from <code>bandit</code>. Since the <code>blacklist_calls</code> rules check specific usages of modules attributes (or for <code>ftplib</code> and <code>telnetlib</code>, any attribute) known to be prone to security issues, I'm not sure that it is that useful to also report issues for the imports, which alone are not problematic, until we use specific attributes from those imports (which are checked by <code>blacklist_calls</code>). Note that some modules reported in <code>blacklist_imports</code> (like <code>pyghmi</code>) are not in <code>blacklist_calls</code>, so for those it might still make sense to implement the rules, but for the other ones, I'm not really sure.</p>
<p>Since Ruff does not handle the severity on reported issues, it probably makes even less sense right now, as in <code>bandit</code>, one could deactivate some specifics severity levels (for instance, <code>low</code> ones, ending up with only <code>blacklist_calls</code> and not <code>blacklist_imports</code>).</p>
<p>For reference, for the given file:</p>
<pre><code class="language-python"># foo.py
from xml.etree import ElementTree

ElementTree.parse(&quot;&quot;)
</code></pre>
<p>In <code>bandit</code>, you would get:</p>
<pre><code class="language-console">$ pipx run bandit==1.7.5 foo.py
[...]
Test results:
&gt;&gt; Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: foo.py:1:0
1	from xml.etree import ElementTree
2
3	ElementTree.parse(&quot;&quot;)

--------------------------------------------------
&gt;&gt; Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: foo.py:3:0
2
3	ElementTree.parse(&quot;&quot;)
</code></pre>
<p>By ignoring <code>low</code> severity issues, <code>bandit</code> users would only get reports for <code>blacklist_calls</code>. In Ruff, users would have to deactivate all <code>B3</code> rules.</p>
<p>What is the general stance on rules implementation? Do we prefer to implement rules from plugins as-is, and let users decide if the rules are useful (and disable them if they don't), or are some rules open to discussion depending on how useful or how close to existing rules they are?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-11-06 14:44</div>
            <div class="timeline-body"><p>I am also interested in picking up some of the leftover rules. Has any decision been made on the <code>S4XX</code> import rules yet? Also how does Ruff deal with Bandit's severities? E.g. if I wanted to implement <code>S202</code> (<a href="https://github.com/PyCQA/bandit/blob/9a2884efe130cad0897586e58dcb33bdbb6fbd81/bandit/plugins/tarfile_unsafe_members.py#L6">source docs</a>) is there a default severity level that Ruff ports? Or do we split it into 3 separate smaller rules?</p>
<p>Clicked through some ported rules and it looks like <code>S103</code> has a med and high version and Ruff just ports both in the same rule but for something like <code>S202</code> that might be a bit aggressive.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ischaojie">@ischaojie</a> on 2023-11-26 08:10</div>
            <div class="timeline-body"><p>These rules have already been implemented:
S201: <a href="https://bandit.readthedocs.io/en/latest/plugins/b201_flask_debug_true.html">flask_debug_true</a>
S601: <a href="https://bandit.readthedocs.io/en/latest/plugins/b601_paramiko_calls.html">paramiko_calls</a>
S609: <a href="https://bandit.readthedocs.io/en/latest/plugins/b609_linux_commands_wildcard_injection.html">linux_commands_wildcard_injection</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/moise-dev">@moise-dev</a> on 2023-12-14 23:18</div>
            <div class="timeline-body"><p>@charliermarsh I think is more a generic question rather than specific to this rule set, but are you implementing them with the exact same behaviour of the originals?</p>
<p>I am getting the same (odd) behaviour in ruff and flake8</p>
<pre><code>‚ùØ ruff ruff_test.py
ruff_test.py:4:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
</code></pre>
<p>With this sample code:</p>
<pre><code class="language-python">import random
import time

time.sleep(random.choice(range(1, 5)))
</code></pre>
<p>I was wondering if this behaviour is going to be reviewed or fixed in Ruff? Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daverball">@Daverball</a> on 2023-12-15 07:24</div>
            <div class="timeline-body"><p>@pygaiwan This is the intended behavior of that rule and not odd at all. The <code>random</code> module is not safe, if you care about security, since the random sequences are predictable. Whether or not you use <code>random</code> in a place where security matters is not the linters' job to figure out and also quite impossible to do reliably in a dynamic language like Python. There's a <code>secrets</code> module which contains some of the same functions as <code>random</code> but implemented in a more secure way.</p>
<p>Bandit is a security linter so its goal is to have essentially zero false negatives, at the cost of some false positives, so it's quite common that you will have to review bandit errors and decide whether or not it's an actual issue and put a <code>noqa</code>/<code>nosec</code> comment, when you decide it isn't a problem.</p>
<p>You can also globally disable rules you don't care about.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-03 18:19</div>
            <div class="timeline-body"><p>Five rules left :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2024-01-13 00:20</div>
            <div class="timeline-body"><p>S503 was addressed by https://github.com/astral-sh/ruff/pull/9391 so there's only S610 and S703  left!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/glennmatthews">@glennmatthews</a> on 2024-01-16 15:15</div>
            <div class="timeline-body"><p>How is S703 different from S308, by the way? They seem redundant to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/itdependsnetworks">@itdependsnetworks</a> on 2024-01-23 21:30</div>
            <div class="timeline-body"><blockquote>
<p>How is S703 different from S308, by the way? They seem redundant to me.</p>
</blockquote>
<p>Per https://github.com/PyCQA/bandit/issues/294#issue-320993934, it would seem so. Would seem like S308 was first and then S703 covered S308 but did not want to have a breaking change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-01 00:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:45:57 UTC
    </footer>
</body>
</html>
