<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linter: Add warning when attempting to set module attributes - astral-sh/ruff #7540</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Linter: Add warning when attempting to set module attributes</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7540">#7540</a>
        opened by <a href="https://github.com/tomasalagoa">@tomasalagoa</a>
        on 2023-09-20 11:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tomasalagoa">@tomasalagoa</a></div>
            <div class="timeline-body"><p>As mentioned in https://lwn.net/Articles/943619/ some developers had an issue distinguishing between a module object and a context object from the module</p>
<pre><code>import numpy as np
import mpmath as mp  # should be from mpmath import mp
mp.dps = 50
</code></pre>
<p>This led to an attempt to change the behavior of how Python handled <code>__setattr__</code> for module objects but was rejected due to poor performance, though I believe it could be a linter rule in ruff.</p>
<p>I&#x27;ve tried to do this but cannot figure out how to get a list of imported modules at runtime, though maybe the rule could be directed only towards the <code>mp</code> module alias.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 13:24</div>
            <div class="timeline-body"><p>Am I correct that looking at the import statement itself is insufficient, and instead, we&#x27;d need to be able to determine whether <code>mp</code> in <code>from mpmath import mp</code> refers to a module or an object? (Since <code>mp</code> could be a module <em>within</em> <code>mpmath</code>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 13:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">waiting-on-author</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 13:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tomasalagoa">@tomasalagoa</a> on 2023-09-20 14:27</div>
            <div class="timeline-body"><blockquote>
<p>Am I correct that looking at the import statement itself is insufficient, and instead, we&#x27;d need to be able to determine whether <code>mp</code> in <code>from mpmath import mp</code> refers to a module or an object? (Since <code>mp</code> could be a module <em>within</em> <code>mpmath</code>.)</p>
</blockquote>
<p>I believe so, as the issue here is the developer intended to set the <code>dps</code> attribute of the <code>mp</code> object in <code>mpmath</code>, not create a <code>dps</code> object inside the <code>mpmath</code> module.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">waiting-on-author</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-20 20:58</div>
            <div class="timeline-body"><p>We&#x27;re probably blocked on being able to implement this for now, since we need to be able to resolve <code>mp</code> to either a module or an object.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-24 14:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-24 14:33</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:42 UTC
    </footer>
</body>
</html>
