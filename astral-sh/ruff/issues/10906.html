<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`RUF100` error despite listed in `per-file-ignores`  - astral-sh/ruff #10906</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`RUF100` error despite listed in `per-file-ignores` </h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/10906">#10906</a>
        opened by <a href="https://github.com/pjonsson">@pjonsson</a>
        on 2024-04-12 12:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/pjonsson">@pjonsson</a> on 2024-04-12 12:44</div>
            <div class="timeline-body"><p>Using Ruff 0.3.7, I tried to select the &quot;RUF&quot; category, and got a <code>RUF100</code> error. Adding the file to <code>per-file-ignores</code> in pyproject.toml seems to have no effect. The section works for other files/rules in the project, I'm even using it for <code>RUF005</code>.</p>
<p>I have not had the RUF category enabled with previous versions, so I do not know if it this is a regression in Ruff. I searched a bit in the issues, not sure if #6385 or #9300 are related to my problem.</p>
<p>Minimizing the file to this:</p>
<pre><code class="language-python">class Ruf100:
    def to_dict(self):
        return {
            &quot;really_really_long_key&quot;: self.really_really_long_designator(),  # noqa
        }
</code></pre>
<p>and putting it in ruf100.py preserves the error:</p>
<pre><code>ruf100.py:4:78: RUF100 [*] Unused blanket `noqa` directive
</code></pre>
<p>I would be happy to remove the noqa directive, but Flake8 fails on the real code if I remove it.</p>
<p>Here are what I believe the relevant parts of pyproject.toml are, please let me know if you need more:</p>
<pre><code class="language-toml">[tool.ruff]
src = [&quot;src&quot;, &quot;tests&quot;]
target-version = &quot;py310&quot;

[tool.ruff.lint]
select = [&quot;RUF&quot;]
ignore = [&quot;E501&quot;]

[tool.ruff.lint.per-file-ignores]
&quot;src/project/cli.py&quot; = [&quot;UP007&quot;, &quot;B008&quot;]

# TO BE FIXED
&quot;src/project/subdir/file.py&quot; = [&quot;RUF015&quot;]
&quot;src/project/otherdir/file2.py&quot; = [&quot;RUF100&quot;]
&quot;ruf100.py&quot; = [&quot;RUF100&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-04-12 13:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-12 13:29</div>
            <div class="timeline-body"><p>I think this is just a bug in Ruff.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-04-12 13:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-12 13:29</div>
            <div class="timeline-body"><p>By the way, can you add the code to the <code># noqa</code>? Ruff would then work as expected, I think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/10908.html">astral-sh/ruff#10908</a> on 2024-04-12 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-04-12 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pjonsson">@pjonsson</a> on 2024-04-12 14:56</div>
            <div class="timeline-body"><blockquote>
<p>By the way, can you add the code to the <code># noqa</code>? Ruff would then work as expected, I think.</p>
</blockquote>
<p>Changing the noqa to <code># noqa: E501</code> makes Flake8 happy.  Ruff is still unhappy, but about something else:</p>
<pre><code>RUF100 [*] Unused `noqa` directive (non-enabled: `E501`)
</code></pre>
<p>which is correct since I've put E501 in Ruff's ignore category.</p>
<p>I guess that's a policy decision, should Ruff complain about noqa statements that are only used by other linters. Personally, I'm phasing out flake8 and I'm perfectly fine not using the RUF category until the next Ruff release (and then use a blanket noqa which is what is being used currently).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pjonsson">@pjonsson</a> on 2024-04-20 14:52</div>
            <div class="timeline-body"><p>@charliermarsh I just updated to 0.4.1 and still have the same issue, even with <code>ruf100.py</code> that I pasted in this ticket.</p>
<pre><code>$ poetry run ruff check
ruf100.py:4:78: RUF100 [*] Unused blanket `noqa` directive
$ poetry run ruff --version
ruff 0.4.1
</code></pre>
<p>I haven't managed to get rid of flake8 yet, so the directive is still in use by flake8.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-20 15:15</div>
            <div class="timeline-body"><p>Are you sure that your per-file-ignore patterns are defined correctly? Can you confirm that youâ€™re able to ignore other errors in that file?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-20 15:20</div>
            <div class="timeline-body"><p>Nevermind, I think I understand the case you're hitting. I assume you have no other diagnostics in that file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @charliermarsh on 2024-04-20 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11058.html">astral-sh/ruff#11058</a> on 2024-04-20 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-04-20 15:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-04-26 17:19</div>
            <div class="timeline-body"><blockquote>
<p>Changing the noqa to <code># noqa: E501</code> makes Flake8 happy.  Ruff is still unhappy, but about something else:</p>
<pre><code>RUF100 [*] Unused `noqa` directive (non-enabled: `E501`)
</code></pre>
<p>which is correct since I've put E501 in Ruff's ignore category.</p>
</blockquote>
<p>You can set <code>E501</code> as &quot;external&quot; since for you it's a Flake8 rule, not a Ruff one.
https://docs.astral.sh/ruff/settings/#lint_external</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
