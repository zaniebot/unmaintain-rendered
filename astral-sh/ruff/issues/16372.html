<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUF010 Maybe the other way round? - astral-sh/ruff #16372</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>RUF010 Maybe the other way round?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/16372">#16372</a>
        opened by <a href="https://github.com/BLKSerene">@BLKSerene</a>
        on 2025-02-25 14:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/BLKSerene">@BLKSerene</a> on 2025-02-25 14:54</div>
            <div class="timeline-body"><h3>Question</h3>
<p>Hi, the doc of <a href="https://docs.astral.sh/ruff/rules/explicit-f-string-type-conversion/"><code>RUF010</code></a> states that the dedicated conversion flags (<code>!s</code>, <code>!r</code>, <code>!a</code>) are more succinct and idiomatic.</p>
<p>While I could agree that these conversion flags are more succinct than their function call equivalents (<code>str()</code>, <code>repr()</code>, <code>ascii()</code>), I don't think they are idiomatic.</p>
<p><a href="https://peps.python.org/pep-0498/#s-r-and-a-are-redundant">PEP 498</a> which introduced f-strings explicitly says that they are redundant. And strictly speaking, these are not dedicated conversion flags introduced by f-strings. Rather, as stated in the PEP, they are introduced mainly for compatibility issues and maybe to smooth the transition from <code>str.format()</code> to f-strings.</p>
<blockquote>
<p>However, !s, !r, and !a are supported by this PEP in order to minimize the differences with str.format(). !s, !r, and !a are required in str.format() because it does not allow the execution of arbitrary expressions.</p>
</blockquote>
<p>Should str.format() allow the execution of arbitrary expressions, <code>!s</code>, <code>!r</code>, <code>!a</code> would not have been introduced as they would have violated the Zen of Python that</p>
<blockquote>
<p>There should be one-- and preferably only one --obvious way to do it.</p>
</blockquote>
<p>IMHO, <code>RUF010</code> should convert <code>!s</code>, <code>!r</code>, <code>!a</code> into <code>str()</code>, <code>repr()</code>, <code>ascii()</code> respectively instead of the other way around.</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BLKSerene on 2025-02-25 14:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[RUF010] Maybe the other way round?" to "RUF010 Maybe the other way round?" by @BLKSerene on 2025-02-25 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-02-25 17:19</div>
            <div class="timeline-body"><p>I did a quick search to see if one is more common than the other and it seems both are used a lot:</p>
<ul>
<li><a href="https://sourcegraph.com/search?q=context:global+lang:Python+f%5C%22.*%5C%7B%28str%7Crepr%7Cascii%29%5C%28.%2B%5C%29%5C%7D&amp;patternType=regexp&amp;sm=0"><code>ascii</code>, <code>str</code>, <code>repr</code></a></li>
<li><a href="https://sourcegraph.com/search?q=context:global+lang:Python+f%5C%22.*%5C%7B.%2B%5C%21%5Br%7Cs%7Ca%5D%5C%7D&amp;patternType=regexp&amp;sm=0">f-string conversion flags</a></li>
</ul>
<p>@zanieb you asked me to ping you more often. Any thoughts on how idiomatic one or the other is?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-25 23:02</div>
            <div class="timeline-body"><p>Personally, I've always used the <code>!r</code> flag in f-strings and definitely find it more idiomatic.</p>
<p>As a simple example, I ran some GitHub code searches</p>
<ul>
<li><code>{...!r}</code> <a href="https://github.com/search?q=%2F%5C%7B%5Ba-z%5D%2B%5C%21r%5C%7D%2F&amp;type=code">214k hits</a></li>
<li><code>{repr(...)}</code> <a href="https://github.com/search?q=%2F%5C%7Brepr%5C%28%5Ba-z%5D%2B%5C%29%5C%7D%2F&amp;type=code">50k hits</a></li>
</ul>
<p>It is an interesting point that the PEP notes they're redundant, but that doesn't mean they're not more idiomatic.</p>
<p>Given that they're direct corollaries of the <code>str.format</code> and <code>%</code> style formatting options, it also seems <em>more</em> consistent to use them.</p>
<p>Unless there's clear evidence this is explicitly <em>not</em> idiomatic, I think it should remain as-is.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-26 00:35</div>
            <div class="timeline-body"><p>I think a great reference for idiomatic usage is the CPython source code itself, which, from Micha's searches above, has 5 uses of the functional versions (and most look justified by more complex invocations) vs 500+ uses of the conversion flags.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BLKSerene on 2025-02-27 14:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../emfcamp/Website/pulls/1824.html">emfcamp/Website#1824</a> on 2025-08-20 13:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:15 UTC
    </footer>
</body>
</html>
