<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idea for TCH: for imports in `TYPE_CHECK` block - astral-sh/ruff #3193</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Idea for TCH: for imports in <code>TYPE_CHECK</code> block</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3193">#3193</a>
        opened by <a href="https://github.com/hofrob">@hofrob</a>
        on 2023-02-23 23:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/hofrob">@hofrob</a></div>
            <div class="timeline-body"><p>Those two ideas are not part of <code>flake8-type-checking</code>, so I'm fully aware that this issue might not get a high priority. That's fine! I'm very thankful for this tool as it is already :slightly_smiling_face:.</p>
<p>It would be nice if ruff could highlight missing quotes for types that are in a <code>TYPE_CHECK</code> block. I missed a few while refactoring code using TCH001, and thought that this would be a great addition.</p>
<p>And regarding quotes, I have another suggestion that might be too opinionated. Let's see:</p>
<pre><code class="language-py">import typing

if typing.TYPE_CHECKING:
    import datetime


def three_previous_years(present: &quot;datetime.datetime&quot;) -&gt; list[&quot;datetime.datetime&quot;]:
    return [
        present.replace(year=present.year - 1),
        present.replace(year=present.year - 2),
        present.replace(year=present.year - 3),
    ]
</code></pre>
<p>The return type can be written as <code>list[&quot;datetime.datetime&quot;]</code> and as <code>&quot;list[datetime.datetime]&quot;</code>. In this case it won't make a difference (afaik). When making the return type optional though, you'd have to wrap <em>everything</em> in quotes. This <code>list[&quot;datetime.datetime&quot;] | None</code> does not work:</p>
<pre><code>TypeError: unsupported operand type(s) for |: 'str' and 'NoneType'
</code></pre>
<p>This is correct: <code>&quot;list[datetime.datetime] | None&quot;</code></p>
<p>So for me personally, I'd prefer consistency and would force quotes for all types <em>if</em> a type from the <code>TYPE_CHECK</code> block is involved. This might even be autofixable. I don't know of any linters/formatters that have this option.</p>
<p>Refactoring code using ruff is great. Thanks a lot!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hofrob">@hofrob</a> on 2023-02-27 10:01</div>
            <div class="timeline-body"><p>I need to think about this a bit more.</p>
<p>For example: <code>list[&quot;datetime.datetime&quot;] | None</code> is valid, but <code>&quot;list[datetime.datetime]&quot; | None</code> isn't.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @hofrob on 2023-02-27 10:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:38 UTC
    </footer>
</body>
</html>
