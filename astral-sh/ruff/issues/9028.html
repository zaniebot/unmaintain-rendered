<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark wildcard imports as unused if there are no possible references - astral-sh/ruff #9028</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Mark wildcard imports as unused if there are no possible references</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9028">#9028</a>
        opened by <a href="https://github.com/jschippergoauto">@jschippergoauto</a>
        on 2023-12-06 17:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jschippergoauto">@jschippergoauto</a> on 2023-12-06 17:05</div>
            <div class="timeline-body"><p>Ruff and Flake8 disagree over F401.</p>
<p>Using Ruff 0.1.7, config:</p>
<pre><code class="language-toml">select = [
  &quot;ALL&quot;,
]

ignore = [
  &quot;I&quot;,
  &quot;TD&quot;,
  &quot;FIX&quot;,
  &quot;ANN002&quot;,
  &quot;ANN003&quot;,
  &quot;ANN101&quot;,
  &quot;D100&quot;,
  &quot;E501&quot;,
  &quot;N818&quot;,
  &quot;S101&quot;,
  &quot;TRY003&quot;,
  &quot;FBT001&quot;,
  &quot;FBT002&quot;,
  &quot;EM101&quot;,
]

target-version = &quot;py311&quot;


[pydocstyle]
convention = &quot;google&quot;
</code></pre>
<p>Code snippet:</p>
<pre><code class="language-python">from redacted.models import *  # noqa: F401, F403
</code></pre>
<p>Flake8 is happy but Ruff complains:</p>
<pre><code>redacted/shelltools.py:2:32: RUF100 [*] Unused `noqa` directive (unused: `F401`)
Found 1 error.
[*] 1 fixable with the `--fix` option.
</code></pre>
<p>If I change the code to this:</p>
<pre><code class="language-python">from redacted.models import *  # noqa: F403
</code></pre>
<p>Now Ruff is happy but Flake8 complains:</p>
<pre><code>./redacted/shelltools.py:2:1: F401 'redacted.models.*' imported but not used
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-06 17:07</div>
            <div class="timeline-body"><p>Ah interesting, if there are no undefined references in the file, Flake8 will flag the star import as unused.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-12-06 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Ruff and Flake8 disagree over F401" to "Mark wildcard imports as unused if there are no possible references" by @charliermarsh on 2023-12-06 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-06 17:07</div>
            <div class="timeline-body"><p>Thanks for filing. Makes sense!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-12-07 01:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-08 14:40</div>
            <div class="timeline-body"><p>We implemented this and ultimately decided not to ship it. Flake8's analysis here is too limited. For example, it will mark the import here as unused, when in theory, <code>redacted.models</code> could export <code>bar</code>, and thus would lead to a bug:</p>
<pre><code class="language-python">from foo import bar
from redacted.models import *

print(bar)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-12-08 14:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jschippergoauto">@jschippergoauto</a> on 2023-12-08 15:45</div>
            <div class="timeline-body"><p>@charliermarsh Not 100% sure but maybe I didn't explain the problem properly. Basically to make Flake8 be happy I have to add <code>noqa: F401, F403</code> but since I have RUF100 enabled in Ruff, it complains about F401 not being used. Maybe RUF100 would need some tweaking for when a line does <code>from x import *</code> with F401? Not sure.</p>
<p>I can see how this is a bit of a gray area since whatever <code>from x import *</code> imports may or may not be used. If I change the comment to <code>noqa: F401, F403, RUF100</code> is does not complain of course :slightly_smiling_face:.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-08 15:47</div>
            <div class="timeline-body"><p>@jschippergoauto -- Thanks, that makes sense. My suggestion though would be remove from <code>F401</code> from the <code># noqa</code>. Ruff isn't guaranteed to <em>always</em> be exactly consistent with Flake8, so trying to use Ruff and Flake8 simultaneously on the codebase can lead to other cases like this where you see small differences.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jschippergoauto">@jschippergoauto</a> on 2023-12-08 15:48</div>
            <div class="timeline-body"><p>@charliermarsh Fair enough. Thanks for looking into this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-08 16:00</div>
            <div class="timeline-body"><p>No worries, thanks for reporting and sorry that we didn't get to the ideal resolution for your project here.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:32:10 UTC
    </footer>
</body>
</html>
