```yaml
number: 4168
title: Testing docs examples
type: issue
state: open
author: calumy
labels:
  - internal
assignees: []
created_at: 2023-05-01T11:31:53Z
updated_at: 2023-05-02T01:03:11Z
url: https://github.com/astral-sh/ruff/issues/4168
synced_at: 2026-01-10T01:56:47Z
```

# Testing docs examples

---

_Issue opened by @calumy on 2023-05-01 11:31_

As far as I am aware, the examples in docs are not currently tested to check that the proposed fix actually fixes an issue. This would be useful to check the initial example returns the expected error code and that the "Use instead:" section removes the error.

I think this could be added as a stage in the `docs` section of the `CI` workflow. I would propose adding this as an independent stage after the [Generate docs](https://github.com/charliermarsh/ruff/blob/main/.github/workflows/ci.yaml#L238-L239) section rather than being added to the generate docs step as this is also used when [releasing the docs](https://github.com/charliermarsh/ruff/blob/main/.github/workflows/docs.yaml) and should not block the docs from being released.

If this would be deemed useful, I am happy to give it a go.

---

_Comment by @MichaReiser on 2023-05-01 11:59_

It could be worth taking inspiration from Rome. It automatically generates tests from the rule documentation (you only provide the example, it generates the expected diagnostic and fix automatically). The tests run as part of the regular rust tests, and the documentation is also used on the website. [example](https://github.com/rome/tools/blob/ff9801344c16c03794908f1dcb62e16b95be7c61/crates/rome_js_analyze/src/analyzers/correctness/no_new_symbol.rs#L9-L34), [documentation](https://docs.rome.tools/lint/rules/nonewsymbol/)

---

_Comment by @JonathanPlasse on 2023-05-01 15:53_

Some rules need to have a certain setting enable so we need to add a mechanic for this.
Also, we could run black to check if the code is well formatted.

---

_Comment by @JonathanPlasse on 2023-05-01 15:56_

- I presented some idea in this PR #3191.

---

_Comment by @calumy on 2023-05-01 16:39_

I'm happy to give the formatting bit a go but the testing part might be a bit beyond my minimal Rust skills. I was originally thinking it could be done with another Python script but integrating into the current testing process makes more sense. 

---

_Label `internal` added by @charliermarsh on 2023-05-02 01:03_

---

_Referenced in [astral-sh/ruff#4240](../../astral-sh/ruff/issues/4240.md) on 2023-05-05 10:15_

---

_Referenced in [astral-sh/ruff#4270](../../astral-sh/ruff/pulls/4270.md) on 2023-05-07 16:07_

---
