<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>autofix for flake8-use-pathlib (PTH) rules - astral-sh/ruff #2331</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>autofix for flake8-use-pathlib (PTH) rules</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/2331">#2331</a>
        opened by <a href="https://github.com/LefterisJP">@LefterisJP</a>
        on 2023-01-29 23:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/LefterisJP">@LefterisJP</a> on 2023-01-29 23:44</div>
            <div class="timeline-body"><p>I enabled PTH rules and there was a few hits in rotki's codebase.</p>
<p>This is a rule I woud like to enforce but there is quite many places it hit and I suppose at least some of the rules should be autofixable. So if possible it would be cool to have ruff do it for us.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autofix</span> added by @charliermarsh on 2023-01-30 00:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-01-30 11:38</div>
            <div class="timeline-body"><p>See https://github.com/charliermarsh/ruff/pull/2348</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2348.html">astral-sh/ruff#2348</a> on 2023-01-30 11:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sigma67">@sigma67</a> on 2024-05-21 08:07</div>
            <div class="timeline-body"><p>Since the issue is still open, is this still on the table? I think most <code>PTH</code> rules have no autofixes yet</p>
<p>It seems there are no more open PRs on this topic</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-21 11:48</div>
            <div class="timeline-body"><p>Certainly on the table, just needs someone to work on it. It may also be limited by our ability to do program-wide analysis beyond simple fixes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2024-05-21 12:37</div>
            <div class="timeline-body"><p>Should the tag <code>type-inference</code> be added?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sigma67">@sigma67</a> on 2024-05-21 12:57</div>
            <div class="timeline-body"><blockquote>
<p>It may also be limited by our ability to do program-wide analysis beyond simple fixes.</p>
</blockquote>
<p>Most of the fixes seem simple enough to me, i.e.</p>
<blockquote>
<p>PTH102 &quot;os.mkdir() should be replaced by Path.mkdir()&quot;</p>
</blockquote>
<p><code>os.mkdir(var, kwargs)</code></p>
<p>becomes</p>
<p><code>Path(var).mkdir(kwargs)</code></p>
<p>I may be missing something - not sure how it could affect a broader scope of code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-21 13:54</div>
            <div class="timeline-body"><p>Yeah we can do simple stuff like tha, although I think the spirit of the rule is that you'd changed <code>var</code> to be of type <code>Path</code> more holistically in the code, then do <code>var.mkdir(kwargs)</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/18763.html">astral-sh/ruff#18763</a> on 2025-06-18 17:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-06-24 17:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/18922.html">astral-sh/ruff#18922</a> on 2025-06-24 19:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-26 17:48</div>
            <div class="timeline-body"><p>Oops, shouldn't have closed this. #18763 added a fix for PTH202, but most of the rules still don't have fixes. I'll keep track of the status here:</p>
<p>| Rule                               | Code   | Status |
|------------------------------------|--------|--------|
| <a href="https://docs.astral.sh/ruff/rules/os-path-abspath/">os-path-abspath</a>                    | PTH100 |   https://github.com/astral-sh/ruff/pull/19213     |
| <a href="https://docs.astral.sh/ruff/rules/os-chmod/">os-chmod</a>                           | PTH101 |     https://github.com/astral-sh/ruff/pull/19404   |
| <a href="https://docs.astral.sh/ruff/rules/os-mkdir/">os-mkdir</a>                           | PTH102 |   https://github.com/astral-sh/ruff/pull/19514     |
| <a href="https://docs.astral.sh/ruff/rules/os-makedirs/">os-makedirs</a>                        | PTH103 |    https://github.com/astral-sh/ruff/pull/19514    |
| <a href="https://docs.astral.sh/ruff/rules/os-rename/">os-rename</a>                          | PTH104 |    https://github.com/astral-sh/ruff/pull/19404    |
| <a href="https://docs.astral.sh/ruff/rules/os-replace/">os-replace</a>                         | PTH105 |     https://github.com/astral-sh/ruff/pull/19404   |
| <a href="https://docs.astral.sh/ruff/rules/os-rmdir/">os-rmdir</a>                           | PTH106 |   https://github.com/astral-sh/ruff/pull/19213     |
| <a href="https://docs.astral.sh/ruff/rules/os-remove/">os-remove</a>                          | PTH107 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-unlink/">os-unlink</a>                          | PTH108 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-getcwd/">os-getcwd</a>                          | PTH109 |        |
| <a href="https://docs.astral.sh/ruff/rules/os-path-exists/">os-path-exists</a>                     | PTH110 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-expanduser/">os-path-expanduser</a>                 | PTH111 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-isdir/">os-path-isdir</a>                      | PTH112 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-isfile/">os-path-isfile</a>                     | PTH113 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-islink/">os-path-islink</a>                     | PTH114 |   https://github.com/astral-sh/ruff/pull/19213     |
| <a href="https://docs.astral.sh/ruff/rules/os-readlink/">os-readlink</a>                        | PTH115 |    https://github.com/astral-sh/ruff/pull/19213    |
| <a href="https://docs.astral.sh/ruff/rules/os-stat/">os-stat</a>                            | PTH116 |        |
| <a href="https://docs.astral.sh/ruff/rules/os-path-isabs/">os-path-isabs</a>                      | PTH117 |   https://github.com/astral-sh/ruff/pull/19213     |
| <a href="https://docs.astral.sh/ruff/rules/os-path-join/">os-path-join</a>                       | PTH118 |   https://github.com/astral-sh/ruff/pull/19213     |
| <a href="https://docs.astral.sh/ruff/rules/os-path-basename/">os-path-basename</a>                   | PTH119 |   https://github.com/astral-sh/ruff/pull/19213     |
| <a href="https://docs.astral.sh/ruff/rules/os-path-dirname/">os-path-dirname</a>                    | PTH120 |        |
| <a href="https://docs.astral.sh/ruff/rules/os-path-samefile/">os-path-samefile</a>                   | PTH121 |    https://github.com/astral-sh/ruff/pull/19404    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-splitext/">os-path-splitext</a>                   | PTH122 |        |
| <a href="https://docs.astral.sh/ruff/rules/builtin-open/">builtin-open</a>                       | PTH123 |        |
| <a href="https://docs.astral.sh/ruff/rules/py-path/">py-path</a>                            | PTH124 |        |
| <a href="https://docs.astral.sh/ruff/rules/path-constructor-current-directory/">path-constructor-current-directory</a> | PTH201 | x      |
| <a href="https://docs.astral.sh/ruff/rules/os-path-getsize/">os-path-getsize</a>                    | PTH202 |    https://github.com/astral-sh/ruff/pull/18763    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-getatime/">os-path-getatime</a>                   | PTH203 |   https://github.com/astral-sh/ruff/pull/18922     |
| <a href="https://docs.astral.sh/ruff/rules/os-path-getmtime/">os-path-getmtime</a>                   | PTH204 |    https://github.com/astral-sh/ruff/pull/18922    |
| <a href="https://docs.astral.sh/ruff/rules/os-path-getctime/">os-path-getctime</a>                   | PTH205 |  https://github.com/astral-sh/ruff/pull/18922      |
| <a href="https://docs.astral.sh/ruff/rules/os-sep-split/">os-sep-split</a>                       | PTH206 |        |
| <a href="https://docs.astral.sh/ruff/rules/glob/">glob</a>                               | PTH207 |        |
| <a href="https://docs.astral.sh/ruff/rules/os-listdir/">os-listdir</a>                         | PTH208 |        |
| <a href="https://docs.astral.sh/ruff/rules/invalid-pathlib-with-suffix/">invalid-pathlib-with-suffix</a>        | PTH210 | x      |
| <a href="https://docs.astral.sh/ruff/rules/os-symlink/">os-symlink</a>                         | PTH211 |        |</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @ntBre on 2025-06-26 17:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-01 14:10</div>
            <div class="timeline-body"><p>i want to implement most of autofixes for these rules</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-01 14:14</div>
            <div class="timeline-body"><p>@ntBre what if i group multiple rules in one PR, as long as their autofixes are semantically equivalent, for example: <a href="https://docs.astral.sh/ruff/rules/os-path-basename/#os-path-basename-pth119">PTH119</a> and <a href="https://docs.astral.sh/ruff/rules/os-path-dirname/#os-path-dirname-pth120">PTH120</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-01 14:15</div>
            <div class="timeline-body"><p>the overall logic can be put in <code>helpers.rs</code>, as in this PR: https://github.com/astral-sh/ruff/pull/18922</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-07-01 14:18</div>
            <div class="timeline-body"><p>Yeah I think that makes sense, especially if they're using the new helper method! If they all use the same helper, we won't need to test each one as carefully either, which will also help keep the diff size down, even with multiple rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-02 11:38</div>
            <div class="timeline-body"><p>i think first group includes PTH{102, 103, 106, 108, 110, 111, 112, 113, 114, 115, 116, 117, 119, 120}</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-07-02 14:11</div>
            <div class="timeline-body"><p>That sounds like it could be quite a large PR, but I'll reserve judgment until I actually see the diff!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-04 12:50</div>
            <div class="timeline-body"><p>i think we should be merged because they all have the same autofix template <code>os.something(“file.txt”)</code> =&gt; <code>pathlib.Path(“file.txt”).{something_in_pathlib}</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-07 17:28</div>
            <div class="timeline-body"><p>I think I made a mistake, many functions have more than 1 argument, and the first thing to do is to create a generic function for functions that take only 1 argument, it seems <code>check_os_path_get_calls</code> from my PR will have to change a bit in the next one, since these get_{a, c, m}time rules also have only one argument (filename)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/19213.html">astral-sh/ruff#19213</a> on 2025-07-08 17:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-07-09 17:19</div>
            <div class="timeline-body"><p>Now we can consider the group <code>os.anything(a1, a2) =&gt; pathlib.Path(a1).pathlib_anything(a2)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/19245.html">astral-sh/ruff#19245</a> on 2025-07-09 19:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/19298.html">astral-sh/ruff#19298</a> on 2025-07-12 06:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/19404.html">astral-sh/ruff#19404</a> on 2025-07-17 16:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/19514.html">astral-sh/ruff#19514</a> on 2025-07-23 17:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/20009.html">astral-sh/ruff#20009</a> on 2025-08-20 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/20169.html">astral-sh/ruff#20169</a> on 2025-09-03 12:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:49 UTC
    </footer>
</body>
</html>
