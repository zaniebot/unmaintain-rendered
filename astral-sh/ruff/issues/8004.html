<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff in VS Code doesn't follow ruff.toml and rules I put in args (v0.1.0) - astral-sh/ruff #8004</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff in VS Code doesn't follow ruff.toml and rules I put in args (v0.1.0)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8004">#8004</a>
        opened by <a href="https://github.com/snowlue">@snowlue</a>
        on 2023-10-17 09:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/snowlue">@snowlue</a></div>
            <div class="timeline-body"><p>Hello. I got some problem — Ruff doesn't follow the rules I put in args. It worked a few times, but I had added <code>organizeImports</code> setting and then he stopped following. I deleted this setting, but it still doesn't work. There are settings from logs of extension. (Workspace and global are the same)</p>
<details>
<summary>Workspace settings</summary>

<pre><code class="language-json">[
    {
        &quot;cwd&quot;: &quot;d:\\Users\\pasha\\Desktop\\******&quot;,
        &quot;workspace&quot;: &quot;file:///d%3A/Users/pasha/Desktop/******&quot;,
        &quot;path&quot;: [],
        &quot;interpreter&quot;: [
            &quot;d:\\Python310\\python.exe&quot;
        ],
        &quot;importStrategy&quot;: &quot;fromEnvironment&quot;,
        &quot;codeAction&quot;: {
            &quot;fixViolation&quot;: {
                &quot;enable&quot;: true
            },
            &quot;disableRuleComment&quot;: {
                &quot;enable&quot;: true
            }
        },
        &quot;lint&quot;: {
            &quot;run&quot;: &quot;onType&quot;,
            &quot;args&quot;: [
                &quot;--ignore&quot;,
                &quot;E731&quot;,
                &quot;--line-length&quot;,
                &quot;120&quot;,
                &quot;--config&quot;,
                &quot;d:/ruff.toml&quot;
            ]
        },
        &quot;format&quot;: {
            &quot;args&quot;: [
                &quot;--line-length&quot;,
                &quot;120&quot;,
                &quot;--config&quot;,
                &quot;d:/ruff.toml&quot;
            ]
        },
        &quot;enable&quot;: true,
        &quot;organizeImports&quot;: true,
        &quot;fixAll&quot;: true,
        &quot;showNotifications&quot;: &quot;off&quot;,
        &quot;enableExperimentalFormatter&quot;: false
    }
]
</code></pre>
</details>

<details>
<summary>Global settings</summary>

<pre><code class="language-json">{
    &quot;cwd&quot;: &quot;D:\\portapps\\VSCode&quot;,
    &quot;workspace&quot;: &quot;D:\\portapps\\VSCode&quot;,
    &quot;path&quot;: [],
    &quot;interpreter&quot;: [],
    &quot;importStrategy&quot;: &quot;fromEnvironment&quot;,
    &quot;codeAction&quot;: {
        &quot;fixViolation&quot;: {
            &quot;enable&quot;: true
        },
        &quot;disableRuleComment&quot;: {
            &quot;enable&quot;: true
        }
    },
    &quot;lint&quot;: {
        &quot;run&quot;: &quot;onType&quot;,
        &quot;args&quot;: [
            &quot;--ignore&quot;,
            &quot;E731&quot;,
            &quot;--line-length&quot;,
            &quot;120&quot;,
            &quot;--config&quot;,
            &quot;d:/ruff.toml&quot;
        ]
    },
    &quot;format&quot;: {
        &quot;args&quot;: [
            &quot;--line-length&quot;,
            &quot;120&quot;,
            &quot;--config&quot;,
            &quot;d:/ruff.toml&quot;
        ]
    },
    &quot;enable&quot;: true,
    &quot;organizeImports&quot;: true,
    &quot;fixAll&quot;: true,
    &quot;showNotifications&quot;: &quot;off&quot;,
    &quot;enableExperimentalFormatter&quot;: false
}
</code></pre>
</details>

<p>I also have a file by the path — <code>d:/ruff.toml</code>. That's what it contains:</p>
<pre><code class="language-toml">[flake8-quotes]
docstring-quotes = &quot;single&quot;
inline-quotes = &quot;single&quot;
multiline-quotes = &quot;single&quot;
</code></pre>
<p>I tried to install ruff as a package using pip and VS Code extension uses it then. But it didn't help. Then I tried to reorder settings parameters, but there are still no effects. I also tried to add <code>config</code> argument both lint-args and format-args.</p>
<p>Look at logs there:</p>
<details>
<summary>Logs of last formatting</summary>

<pre><code>2023-10-17 12:09:41.460 [info] [Trace - 12:09:41] Sending request 'workspace/executeCommand - (4)'.
2023-10-17 12:09:41.469 [info] [Trace - 12:09:41] Received notification 'window/logMessage'.
2023-10-17 12:09:41.470 [info] Using interpreter executable: d:\Python310\Scripts\ruff.exe
2023-10-17 12:09:41.477 [info] [Trace - 12:09:41] Received notification 'window/logMessage'.
2023-10-17 12:09:41.478 [info] Found ruff 0.1.0 at d:\Python310\Scripts\ruff.exe
2023-10-17 12:09:41.479 [info] [Trace - 12:09:41] Received notification 'window/logMessage'.
2023-10-17 12:09:41.479 [info] Running Ruff with: d:\Python310\Scripts\ruff.exe ['format', '--force-exclude', '--quiet', '--stdin-filename', 'd:\\Users\\pasha\\Desktop\\pattern_bot\\tools.py', '--line-length', '120', '--config', 'd:\\ruff.toml']
2023-10-17 12:09:41.543 [info] [Trace - 12:09:41] Received request 'workspace/applyEdit - (6fa2bd73-3d1a-4a30-93b7-a9c7bed40245)'.
2023-10-17 12:09:41.545 [info] [Trace - 12:09:41] Received response 'workspace/executeCommand - (4)' in 86ms.
2023-10-17 12:09:41.598 [info] [Trace - 12:09:41] Sending notification 'textDocument/didChange'.
2023-10-17 12:09:41.599 [info] [Trace - 12:09:41] Sending response 'workspace/applyEdit - (6fa2bd73-3d1a-4a30-93b7-a9c7bed40245)'. Processing request took 57ms
</code></pre>
</details>
And I got that I unexpected. He changed quotation marks, he formatted as a line length is 80...

<p><img src="https://github.com/astral-sh/ruff/assets/22418658/d4d9bcb1-a996-4810-8fe6-6ffff67f9056" alt="image" /></p>
<p>Are there any ways how to fix it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-17 09:31</div>
            <div class="timeline-body"><p>Hy @PaveTranquil</p>
<p>What I understand is that you want to change the default line length to 120 and use single quotes for all strings for Ruff's formatter.</p>
<blockquote>
<pre><code>[flake8-quotes]
docstring-quotes = &quot;single&quot;
inline-quotes = &quot;single&quot;
multiline-quotes = &quot;single&quot;
</code></pre>
</blockquote>
<p>Configures the <a href="https://docs.astral.sh/ruff/rules/#flake8-quotes-q">flake8-quotes</a> rule which is independent of the formatter. The rule is for people who don't want to use the formatter, but still want to enforce a consistent quote style. We don't recommend using it together with the formatter.</p>
<p>You can configure the formatter <a href="https://docs.astral.sh/ruff/settings/#format-quote-style">quote-style</a> and line length by using</p>
<pre><code class="language-toml">line-length = 120

[format]
quote-style = &quot;single&quot;
</code></pre>
<p>However, this doesn't change the quotes for docstrings or multiline strings. Changing the quote style for docstring and multiline strings isn't possible.</p>
<p>You'll need to remove the <code>--line-length 120</code> argument from the <code>format.args</code> in your VS Code settings because this option isn't supported by the formatter .</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snowlue">@snowlue</a> on 2023-10-17 09:47</div>
            <div class="timeline-body"><p>@MichaReiser Yes-yes, you correctly understood me. I did as you said there. It helped!</p>
<p>Thank you a lot!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @snowlue on 2023-10-17 09:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-17 09:55</div>
            <div class="timeline-body"><p>You're welcome and I'm glad to hear that it worked.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:48:38 UTC
    </footer>
</body>
</html>
