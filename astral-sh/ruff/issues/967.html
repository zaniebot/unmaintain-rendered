<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discussion: check code representations - astral-sh/ruff #967</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Discussion: check code representations</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/967">#967</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2022-11-30 03:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>Ruff was designed with Flake8-compatibility in mind: it uses the same check code representation (e.g., <code>F841</code> and friends), it supports many of the same command-line arguments, it supports the same <code># noqa</code> syntax, etc. I consider this a strength, as it makes it much easier for existing projects to migrate to Ruff, and for users to familiarize themselves with Ruff&#x27;s conventions.</p>
<p>That said, there&#x27;s one area where I&#x27;d like to at least <em>consider</em> diverging: the check code representations.</p>
<p>Flake8 uses a check code system in which checks have a one-to-three character alphabetical prefix, like <code>F</code> or <code>B</code> or <code>ANN</code>, which is then followed by exactly three digits. You can enable and disable individual codes, or classes of codes, with (e.g.) <code>--select F</code> or <code>--select F5</code>, and so on.</p>
<p>In general, I see the benefits of this system as:</p>
<ul>
<li>Hierarchical encoding enables straightforward and compact configuration (e.g., you can enable and disable entire classes of checks based on a prefix).</li>
<li>Hierarchical encoding conveys some semantic information from the check code (e.g., if a check starts with <code>ANN</code>, you know it&#x27;s annotation-related).</li>
<li>Syntax is very compact (e.g., <code># noqa: F841</code>).</li>
<li>(For <em>Ruff</em> specifically: makes it much easier for users to migrate from Flake8.)</li>
</ul>
<p>Meanwhile, the weaknesses:</p>
<ul>
<li>Lack of human readability: <code>F841</code> on its own doesn&#x27;t tell you anything about the check itself, only its (broad) categorization. This is in contrast to Clippy (and ESLint), which uses names like <code>approx_constant</code>. Pylint uses a hybrid scheme, with names and codes like <a href="https://pylint.pycqa.org/en/latest/user_guide/messages/warning/bad-builtin.html"><code>bad-builtin</code> / <code>W0141</code></a>.</li>
<li>Collisions across plugins: prefixes aren&#x27;t guaranteed to be globally unique. The McCabe complexity check uses C901, while <code>flake8-comprehensions</code> uses the <code>C</code> prefix too. So <code>--select C</code> enables checks from multiple plugins.</li>
</ul>
<p>I&#x27;d like to get some feedback from the community on how they feel about the current representation, and what they&#x27;d like to see if the representation were to change. Note that, alongside any <em>breaking</em> changes, I&#x27;d like to ship tooling to automatically upgrade across versions of Ruff (e.g., rewrite check codes, or whatever else is needed).</p>
<p>To give us a jumping-off point, here&#x27;s one rough proposal:</p>
<ol>
<li>Introduce a short-name representation for every check (like <code>bad-builtin</code>), and allow users to provide short-names and codes interchangeably.</li>
<li>Require that all plugins use a unique prefix code, even if that requires deviating from the prefix code used in Flake8 (e.g., change the comprehensions prefix to <code>COM</code>). Err on the side of three-letter codes, with a few exceptions.</li>
</ol>
<p>It&#x27;d also be entirely reasonable for us to say that the current system is fine, and we don&#x27;t really care about changing it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ljodal">@ljodal</a> on 2022-12-03 19:20</div>
            <div class="timeline-body"><p>I think short codes would be useful, even though that&#x27;ll quickly lead to very long lines. I think I&#x27;d prefer that though. Eg with mypy I tend to write <code># type:ignore[error-code]</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smackesey">@smackesey</a> on 2022-12-05 02:34</div>
            <div class="timeline-body"><p>Pylint/ESlint&#x27;s error codes are vastly more user-friendly than the arbitrary numerical codes of flake8/ruff. IMO this is a no-brainer, I don&#x27;t understand how flake8 has gone on so long without it:</p>
<blockquote>
<p>Introduce a short-name representation for every check (like bad-builtin), and allow users to provide short-names and codes interchangeably.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 02:36</div>
            <div class="timeline-body"><p>We actually already have a short-name internally for every check (<code>UnusedLoopControlVariable</code>, <code>StripWithMultiCharacters</code>, etc.) so it&#x27;s something we&#x27;re already &quot;maintaining&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-16 05:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:27 UTC
    </footer>
</body>
</html>
