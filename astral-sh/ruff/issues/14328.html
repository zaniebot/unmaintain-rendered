<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`subclass-builtin` (`FURB189`) - document exactly why `UserDict`, `UserList` etc are preferred over `dict` and `list` - astral-sh/ruff #14328</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>subclass-builtin</code> (<code>FURB189</code>) - document exactly why <code>UserDict</code>, <code>UserList</code> etc are preferred over <code>dict</code> and <code>list</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14328">#14328</a>
        opened by <a href="https://github.com/DetachHead">@DetachHead</a>
        on 2024-11-14 00:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/DetachHead">@DetachHead</a></div>
            <div class="timeline-body"><p><a href="https://docs.astral.sh/ruff/rules/subclass-builtin">the documentation for this rule</a> says that subclassing the builtins is &quot;error prone&quot; but doesn&#x27;t provide an example of such an error.</p>
<p>attempting to find information about these &quot;User&quot; classes and why they exist is difficult. <a href="https://docs.python.org/3/library/collections.html#collections.UserDict">the official docs</a> don&#x27;t explain why it exists, and as usual, stackoverflow is full of <a href="https://stackoverflow.com/questions/1392396/advantages-of-userdict-class">outdated information from python 2 that says <em>not</em> to use it</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-14 00:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-14 00:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-14 05:55</div>
            <div class="timeline-body"><p>Maybe this is still up to date? (I didn&#x27;t look closely): https://realpython.com/inherit-python-dict/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-11-14 06:29</div>
            <div class="timeline-body"><p>thanks. there&#x27;s a lot of filler in that article so i&#x27;ll summarize. it&#x27;s because <code>dict</code> does not use its own dunders which makes it more difficult to correctly change its functionality. for example if you want to create a dict where all keys are converted to uppercase, overriding <code>__setitem__</code> is not sufficient because <code>dict.update</code> does not use it:</p>
<pre><code>from collections import UserDict
from typing import override


class UppercaseDict[T](dict[str, T]):
    def __init__(self, value: dict[str, T]):
        super().__init__({key.upper(): value for key, value in value.items()})

    @override
    def __setitem__(self, key: str, value: T, /):
        return super().__setitem__(key.upper(), value)


builtin_dict = UppercaseDict({&quot;a&quot;: 1})
builtin_dict.update({&quot;b&quot;: 2})
# wrong
print(builtin_dict)  # {&#x27;A&#x27;: 1, &#x27;b&#x27;: 2}


class UppercaseUserDict[T](UserDict[str, T]):
    def __init__(self, value: dict[str, T]):
        super().__init__({key.upper(): value for key, value in value.items()})

    @override
    def __setitem__(self, key: str, value: T, /):
        return super().__setitem__(key.upper(), value)


user_dict = UppercaseUserDict({&quot;a&quot;: 1})
user_dict.update({&quot;b&quot;: 2})
# correct
print(user_dict)  # {&#x27;A&#x27;: 1, &#x27;B&#x27;: 2}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dan-wilton">@dan-wilton</a> on 2025-03-23 14:47</div>
            <div class="timeline-body"><p>Looking for a good place to get started in contributing to <code>ruff</code>, this looks like it! Will update the docs now ‚ù§</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ntBre">@ntBre</a> on 2025-03-23 17:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:49:00 UTC
    </footer>
</body>
</html>
