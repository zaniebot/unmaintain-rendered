<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Feature request]: support `flake8-no-implicit-concat` (NIC) - astral-sh/ruff #8549</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Feature request]: support `flake8-no-implicit-concat` (NIC)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8549">#8549</a>
        opened by <a href="https://github.com/wtfzambo">@wtfzambo</a>
        on 2023-11-07 21:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/wtfzambo">@wtfzambo</a> on 2023-11-07 21:43</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>This is a feature request to introduce the aforementioned <a href="https://pypi.org/project/flake8-no-implicit-concat/">flake8 plugin</a> as an optional rule in Ruff (mutually exclusive with ISC).</p>
<p>The reasoning behind this is that in certain occasions, separate strings must not be concatenated, but separated by a comma, which may be missing by accident; and in a sufficiently long module, is not easily spotted.</p>
<p>One practical (and personal) example is when writing IAM policies via SDKs such as Pulumi. Each &quot;permission&quot; is likely written on a separate line. Without a comma separator, 2 lines would be implicitly concatenated, resulting in a wrong (but programmatically valid) policy, which obviously breaks something downstream, leaving the developer wondering which permission they missed, and instead it was just a comma.</p>
<p>Also,</p>
<pre><code>Explicit is better than implicit.
</code></pre>
<details>

<summary>Go ahead, try to spot the missing comma quickly</summary>

<pre><code class="language-python">
def build(
    *, oidc_arn: Output[str], bucket: s3.Bucket, workgroup: athena.Workgroup
) -&gt; None:
    bucket_arn: Output[str] = bucket.arn

    policy_document = iam.get_policy_document(
        statements=[
            Statement(
                sid=&quot;GlueAccessForDltPipelines&quot;,
                effect=&quot;Allow&quot;,
                actions=[
                    &quot;glue:CreateDatabase&quot;,
                    &quot;glue:DeleteDatabase&quot;,
                    &quot;glue:GetDatabase&quot;,
                    &quot;glue:GetDatabases&quot;,
                    &quot;glue:UpdateDatabase&quot;,
                    &quot;glue:CreateTable&quot;,
                    &quot;glue:DeleteTable&quot;,
                    &quot;glue:BatchDeleteTable&quot;,
                    &quot;glue:UpdateTable&quot;,
                    &quot;glue:GetTable&quot;,
                    &quot;glue:GetTables&quot;,
                    &quot;glue:BatchCreatePartition&quot;,
                    &quot;glue:CreatePartition&quot;
                    &quot;glue:DeletePartition&quot;,
                    &quot;glue:BatchDeletePartition&quot;,
                    &quot;glue:UpdatePartition&quot;,
                    &quot;glue:GetPartition&quot;,
                    &quot;glue:GetPartitions&quot;,
                    &quot;glue:BatchGetPartition&quot;,
                ],
                resources=[
                    f&quot;arn:aws:glue:{AWS_REGION}:{AWS_ACCOUNT_ID}:catalog&quot;,
                    f&quot;arn:aws:glue:{AWS_REGION}:{AWS_ACCOUNT_ID}:database/{TA_RAW}_*_{CI_ENVIRONMENT}&quot;,
                    f&quot;arn:aws:glue:{AWS_REGION}:{AWS_ACCOUNT_ID}:database/{VH_RAW}_*_{CI_ENVIRONMENT}&quot;,
                    f&quot;arn:aws:glue:{AWS_REGION}:{AWS_ACCOUNT_ID}:table/{TA_RAW}_*_{CI_ENVIRONMENT}/*&quot;,
                    f&quot;arn:aws:glue:{AWS_REGION}:{AWS_ACCOUNT_ID}:table/{VH_RAW}_*_{CI_ENVIRONMENT}/*&quot;,
                ],
            ),
            Statement(
                sid=&quot;S3AccessForDataExportAndQueries&quot;,
                effect=&quot;Allow&quot;,
                actions=[
                    &quot;s3:ListBucket&quot;,
                    &quot;s3:ListBucketMultipartUploads&quot;,
                    &quot;s3:ListMultipartUploadParts&quot;,
                    &quot;s3:PutObject&quot;,
                    &quot;s3:GetObject&quot;,
                    &quot;s3:GetObjectAttributes&quot;,
                    &quot;s3:DeleteObject&quot;,
                    &quot;s3:GetBucketLocation&quot;,
                    &quot;s3:AbortMultipartUpload&quot;,
                ],
                resources=[
                    f&quot;arn:aws:s3:::{ATHENA_QUERY_RESULT_BUCKET}&quot;,
                    f&quot;arn:aws:s3:::{ATHENA_QUERY_RESULT_BUCKET}/*&quot;,
                    bucket_arn,  # type: ignore
                    bucket_arn.apply(lambda arn: f&quot;{arn}/*&quot;),  # type: ignore
                ],
            ),
            Statement(
                sid=&quot;AthenaResourcesAccessForDltPipelines&quot;,
                effect=&quot;Allow&quot;,
                actions=[
                    &quot;athena:ListQueryExecutions&quot;,
                    &quot;athena:ListDatabases&quot;,
                    &quot;athena:ListTableMetadata&quot;,
                    &quot;athena:GetTableMetadata&quot;,
                    &quot;athena:GetQueryResultsStream&quot;,
                    &quot;athena:GetQueryResults&quot;,
                    &quot;athena:GetDatabase&quot;,
                    &quot;athena:GetDataCatalog&quot;,
                    &quot;athena:GetWorkGroup&quot;,
                    &quot;athena:BatchGetQueryExecution&quot;,
                    &quot;athena:GetQueryExecution&quot;,
                    &quot;athena:StartQueryExecution&quot;,
                    &quot;athena:StopQueryExecution&quot;,
                ],
                resources=[
                    workgroup.arn,
                    f&quot;arn:aws:athena:{AWS_REGION}:{AWS_ACCOUNT_ID}:datacatalog/awsdatacatalog&quot;,
                ],
            ),
        ]
    )
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-07 22:41</div>
            <div class="timeline-body"><p>I think we may actually support what you're describing... Check out the playground here: https://play.ruff.rs/32b744cd-c7ba-4e3b-b876-284ad6473fa4. Is that right? Disallow all implicit concatenations?</p>
<p>(Locally, you'd need to set <code>allow-multiline</code> to <code>false</code> (https://docs.astral.sh/ruff/settings/#flake8-implicit-str-concat-allow-multiline.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-11-07 22:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wtfzambo">@wtfzambo</a> on 2023-11-07 23:08</div>
            <div class="timeline-body"><p>@charliermarsh oh, it is! YES! Fantastic! Thanks, I searched for this in the docs but somehow had missed this setting. Neat!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @wtfzambo on 2023-11-07 23:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9093.html">astral-sh/ruff#9093</a> on 2023-12-11 14:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mikedh/trimesh/pulls/2163.html">mikedh/trimesh#2163</a> on 2024-02-26 19:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:10 UTC
    </footer>
</body>
</html>
