<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encourage use of `importlib.metadata.version` - astral-sh/ruff #15671</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Encourage use of <code>importlib.metadata.version</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/15671">#15671</a>
        opened by <a href="https://github.com/jakkdl">@jakkdl</a>
        on 2025-01-22 12:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jakkdl">@jakkdl</a></div>
            <div class="timeline-body"><h3>Description</h3>
<p>I only recently found out about <a href="https://docs.python.org/3/library/importlib.metadata.html#importlib.metadata.version">importlib.metadata.version</a> as a way of getting the installed version of a package; as opposed to reading some global <code>__version__</code> variable that may or <a href="https://github.com/python-trio/trio/pull/3186">may not be</a> properly exported.
I would love a rule that encouraged the use of the more portable &amp; reliable importlib variant, although I have a feeling that a simple rule that detected any <code>from ... import __version__</code> would raise a bunch of false alarms on packages that export it as ways of versioning ... other things than the package itself. (maybe only trigger if importing from the top namespace of a module?) Or idk other weird stuff.</p>
<p>Anyway, thought I'd throw out the idea anyway and see if it sticks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-01-22 13:10</div>
            <div class="timeline-body"><p>This might be controversial for authors of CLIs, since <code>importlib.metadata</code> has historically had quite a high import time. Importing <code>importlib.metadata</code> and using <code>importlib.metadata.version()</code> could mean that running <code>&lt;your_cli_app&gt; --version</code> takes longer if it uses <code>importlib.metadata</code> than it would if it just checked <code>__version__</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @AlexWaygood on 2025-01-22 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @AlexWaygood on 2025-01-22 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jakkdl">@jakkdl</a> on 2025-01-22 15:53</div>
            <div class="timeline-body"><blockquote>
<p>This might be controversial for authors of CLIs, since <code>importlib.metadata</code> has historically had quite a high import time. Importing <code>importlib.metadata</code> and using <code>importlib.metadata.version()</code> could mean that running <code>&lt;your_cli_app&gt; --version</code> takes longer if it uses <code>importlib.metadata</code> than it would if it just checked <code>__version__</code></p>
</blockquote>
<p>I was thinking of it more when interfacing with 3rd-party packages rather than within-package use; so you you'd probably want to exclude those imports.</p>
<p>But it definitely is slower, I did some quick benchmarks with</p>
<pre><code class="language-python">import six
import importlib.metadata
print(importlib.metadata.version('six')
</code></pre>
<p>vs</p>
<pre><code class="language-python">import six
print(six.__version__)
</code></pre>
<p>and the former averaged .0642s and the latter .0174 for a ~4x difference (py3.13; on py3.9 I got .049 and .022)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:02 UTC
    </footer>
</body>
</html>
