<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP024 error message is confusing when `except` clause has multiple exceptions - astral-sh/ruff #19696</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UP024 error message is confusing when `except` clause has multiple exceptions</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/19696">#19696</a>
        opened by <a href="https://github.com/burrscurr">@burrscurr</a>
        on 2025-08-01 20:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/burrscurr">@burrscurr</a> on 2025-08-01 20:10</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><a href="https://docs.astral.sh/ruff/rules/os-error-alias/">UP024</a> highlights specific aliased exceptions which might be removed in the future. When the <code>except</code> clause contains multiple exceptions, the error message can be a bit misleading. Simple Example:</p>
<pre><code class="language-py">try:
    pass
except (IOError, ValueError):
    pass
</code></pre>
<p>In this example, <code>IOError</code> is an alias of <code>OSError</code>, that should be replaced, while <code>ValueError</code> is just a regular exception. Ruff correctly understands this (see <code>uv tool run ruff@0.12.7 check --select UP024 --fix --diff</code>), but its output does not distinguish between exceptions targeted by this rule and ones that aren't:</p>
<pre><code>example.py:3:8: UP024 [*] Replace aliased errors with `OSError`
  |
1 | try:
2 |     pass
3 | except (ValueError, IOError):
  |        ^^^^^^^^^^^^^^^^^^^^^ UP024
4 |     pass
  |
  = help: Replace with builtin `OSError`
</code></pre>
<p>The error message &quot;Replace aliased errors with <code>OSError</code>&quot; in connection with the highlighted section makes it seem as if <em>both</em> exceptions were aliases of <code>OSError</code> and should be replaced.</p>
<p>If this is possible, specifically highlighting the aliased exceptions would probably be sufficient to avoid this misinterpretation:</p>
<pre><code>example.py:3:8: UP024 [*] Replace aliased errors with `OSError`
  |
1 | try:
2 |     pass
3 | except (ValueError, IOError):
  |                     ^^^^^^^ UP024
4 |     pass
  |
  = help: Replace with builtin `OSError`
</code></pre>
<h3>Version</h3>
<p>ruff 0.12.7 (c5ac99889 2025-07-29)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "UP024 error message is confusing when `except` clause has multiple errors" to "UP024 error message is confusing when `except` clause has multiple exceptions" by @burrscurr on 2025-08-01 20:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-05 13:26</div>
            <div class="timeline-body"><p>Good catch! Looks like we're flagging the whole tuple instead of the specific exception, which would be a good improvement, I think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-08-05 13:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @MichaReiser on 2025-08-05 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-08-05 15:03</div>
            <div class="timeline-body"><p>I think this is because multiple exception types can be aliases for <code>OSError</code> in the tuple but we don't want to raise separate diagnostics for them. The fix replaces all the different aliases with <code>OSError</code>.</p>
<p>So actually this might be a good case for multi-range diagnostics once they go live - which I think is soon!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-05 15:58</div>
            <div class="timeline-body"><p>Ah okay, that makes sense. In some other rules I think we do raise multiple diagnostics and then clone the same fix into each of them, but a multi-span diagnostic could work too!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-06 06:21</div>
            <div class="timeline-body"><p>Yeah, I don't think we have an established principle for rules that may raise multiple diagnostics at the same line. Some rules only create one diagnostic, other rules create multiple diagnostics with the same fix attached.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
