<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document that extend-select wins over more specific ignore - astral-sh/ruff #1838</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Document that extend-select wins over more specific ignore</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1838">#1838</a>
        opened by <a href="https://github.com/jankatins">@jankatins</a>
        on 2023-01-12 22:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jankatins">@jankatins</a></div>
            <div class="timeline-body"><p>I've the following <code>example.py</code> file:</p>
<pre><code>print(&quot;AA&quot;
      + &quot;BB&quot;)
</code></pre>
<p>My pyproject.toml specifies in the ruff section:</p>
<pre><code>[tool.ruff]
extend-select = [&quot;B0&quot;, &quot;C4&quot;, &quot;ICN&quot;, &quot;ISC&quot;, &quot;N&quot;, &quot;RUF&quot;, &quot;SIM&quot;]
ignore = [
    # Explicitly concatenated string should be implicitly concatenated
    &quot;ISC003&quot;,
]

</code></pre>
<p>Running ruff on it, results in this:</p>
<pre><code>λ  ruff example.py
example.py:1:7: ISC003 Explicitly concatenated string should be implicitly concatenated
Found 1 error(s).
</code></pre>
<p>Using</p>
<pre><code>[tool.ruff]
extend-select = [&quot;B0&quot;, &quot;C4&quot;, &quot;ICN&quot;, &quot;ISC&quot;, &quot;N&quot;, &quot;RUF&quot;, &quot;SIM&quot;]
extend-ignore = [
    # Explicitly concatenated string should be implicitly concatenated
    &quot;ISC003&quot;,
]
</code></pre>
<p>works as I wanted it to (no error), but I found that surprising, that the computation rules seems to be</p>
<ol>
<li>Figure out what should be selected by looking at ignore and select settings, letting the more specific rules win</li>
<li>Add the extend-* rules and compute again</li>
</ol>
<p>I would have expected:</p>
<ol>
<li>Use ignore/select and add the rules from extend-*</li>
<li>Compute the selected items by letting the more specific rules win</li>
</ol>
<p>Is this intended?</p>
<pre><code>λ ruff --version
ruff 0.0.215
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 22:59</div>
            <div class="timeline-body"><p>It is intended and it's a little different than the way these work in Flake8. The main reason being that we support extending <code>pyproject.toml</code> files, and without these semantics, it can be impossible for child configurations to override their parents, if the parent ignores and selects a specific prefix code.</p>
<p>I typically recommend using <code>select</code> over <code>extend-select</code> (and same for <code>ignore</code>) unless you're using that <code>pyproject.toml</code> extension. So in this case, I'd recommend:</p>
<pre><code class="language-toml">[tool.ruff]
select = [&quot;E&quot;, &quot;F&quot;, &quot;B0&quot;, &quot;C4&quot;, &quot;ICN&quot;, &quot;ISC&quot;, &quot;N&quot;, &quot;RUF&quot;, &quot;SIM&quot;]
ignore = [
    # Explicitly concatenated string should be implicitly concatenated
    &quot;ISC003&quot;,
]
</code></pre>
<p>(I agree we could improve the docs here.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jankatins">@jankatins</a> on 2023-01-13 00:10</div>
            <div class="timeline-body"><p>My reasoning was that I wanted to get any new defaults enabled and therefore liked the extend-select version. This feels a bit like there needs an overwrite-extend-ignore and so on :-)</p>
<p>In any case: a proposal for a doc extension for the current state is in PR https://github.com/charliermarsh/ruff/pull/1839</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-13 00:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IliasAarab">@IliasAarab</a> on 2024-11-21 14:07</div>
            <div class="timeline-body"><p>Trying to run the same initial example as @jankatins but I do not get the initial error anymore:</p>
<p><code>example.py</code>:</p>
<pre><code class="language-python">print(&quot;AA&quot;
      + &quot;BB&quot;)
</code></pre>
<pre><code class="language-bash">[tool.ruff.lint]
extend-select = [&quot;B0&quot;, &quot;C4&quot;, &quot;ICN&quot;, &quot;ISC&quot;, &quot;N&quot;, &quot;RUF&quot;, &quot;SIM&quot;]
ignore = [
    # Explicitly concatenated string should be implicitly concatenated
    &quot;ISC003&quot;,
]
</code></pre>
<pre><code class="language-bash">ruff check example.py
All checks passed!
</code></pre>
<p>Has the behaviour been modified?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jankatins">@jankatins</a> on 2024-11-22 01:03</div>
            <div class="timeline-body"><p>I think yes: https://github.com/astral-sh/ruff/pull/2312</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:02 UTC
    </footer>
</body>
</html>
