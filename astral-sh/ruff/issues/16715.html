<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rule request: G: Require {} in log format - astral-sh/ruff #16715</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Rule request: G: Require {} in log format</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/16715">#16715</a>
        opened by <a href="https://github.com/colindean">@colindean</a>
        on 2025-03-13 19:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/colindean">@colindean</a> on 2025-03-13 19:13</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>My team is migrating to <a href="https://github.com/delgan/loguru">loguru</a> and trying to catch our well-trained reflexes to use curly brackets for placeholders:</p>
<pre><code class="language-python">logger.info(&quot;Thing was {}&quot;, thing.category)
</code></pre>
<p>instead of the preferred <code>%</code> placeholder for stdlib logging</p>
<pre><code class="language-python">logger.info(&quot;Thing was %s&quot;, thing.category)
</code></pre>
<p>I'd love a rule for log messages that either (or both):</p>
<ol>
<li>could enforce use of <code>{}</code> (and allow <code>{\w*}</code> so <code>{thing}</code> is allowed)</li>
<li>prohibit use of <code>%</code> (e.g. <code>%s</code>, <code>%d</code>, <code>%f</code>, and all sub-subspecifiers thereof, e.g. <code>%0.3f</code>.)</li>
</ol>
<p>In https://github.com/astral-sh/ruff/issues/13673, it's established that Loguru is not explicitly supported, as it has not met the popularity threshold for a community standard yet. That's understandable. However, I'm not necessarily asking for &quot;Loguru support&quot; here. The <a href="https://docs.python.org/3/howto/logging-cookbook.html#use-of-alternative-formatting-styles">Python Logging Cookbook section on alterative formatting styles</a> suggests using <code>{}</code> if you want to use <code>str.format(values)</code> under the hood instead of <code>template % values</code> formatting.</p>
<p>In https://github.com/astral-sh/ruff/issues/13390, <a href="https://docs.astral.sh/ruff/rules/logging-too-many-args/">PLE1205</a> is triggered when using <code>{}</code> in logging messages, but the advice is to disable that check. Perhaps the check that I'm suggesting here can conflict with that and require only one of them to be enabled.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-13 19:34</div>
            <div class="timeline-body"><p>Would the https://docs.astral.sh/ruff/rules/#flake8-logging-log rules work for you in combination with adding <code>loguru</code> to https://docs.astral.sh/ruff/settings/#lint_logger-objects</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-03-13 19:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colindean">@colindean</a> on 2025-03-13 20:25</div>
            <div class="timeline-body"><p>I don't think so, because neither flake8-logging-log (LOG) nor flake8-logging-format (G) have rules that enforce <code>{}</code> or prohibit <code>%</code> inside of the log message. Also, it seems like the logger from loguruâ€” <code>from loguru import logger</code>â€” is recognized as a logger and all the rules I've expected trigger [^g004].</p>
<p>Something else that might workâ€” and I'm not sure if this is possibleâ€” is a configurable placeholder for <a href="https://docs.astral.sh/ruff/rules/logging-too-many-args/">PLE1205 logging-too-many-args</a> and <a href="https://docs.astral.sh/ruff/rules/logging-too-few-args/">PLE1206 logging-too-few-args</a>. Warning that the number of <code>{}</code> doesn't match the expected positional arguments would get us a lot of the way there, probably about 90% of our migrated log lines are simple <code>{}</code>. This wouldn't support the <code>{thing}</code> use case, though.</p>
<p>[^g004]: <a href="https://docs.astral.sh/ruff/rules/logging-f-string/">G004 logging-f-string</a> in particular has been a lifesaver and that works great. A few codebases we've inherited are loaded with f-strings in log messages. Most are the best case scenario for misuse but others, well, not so much ðŸ« </p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-14 08:34</div>
            <div class="timeline-body"><p>I'm sorry. I should have read your initial issue more carefully. I now understand what you're asking for. To summarize what I understand:</p>
<ul>
<li>For the std logging: respect the <code>style</code> argument</li>
<li>For third-party loggers: Allow specifying the &quot;fallback&quot; style if <code>style</code> isn't explicitly provided. In the future, derive the default automatically based on known loggers.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2025-03-14 08:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-03-14 08:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/colindean">@colindean</a> on 2025-03-17 23:31</div>
            <div class="timeline-body"><p>Yes! Those sound good to me. Thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/19075.html">astral-sh/ruff#19075</a> on 2025-07-01 20:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceone">@spaceone</a> on 2025-09-16 15:54</div>
            <div class="timeline-body"><blockquote>
<p>The <a href="https://docs.python.org/3/howto/logging-cookbook.html#use-of-alternative-formatting-styles">Python Logging Cookbook section on alterative formatting styles</a> suggests using <code>{}</code> if you want to use <code>str.format(values)</code> under the hood instead of <code>template % values</code> formatting.</p>
</blockquote>
<p>You are misinterpreting the docs.
Python-logging supports giving <code>style=&quot;{&quot;</code> to a <code>logging.Formatter</code>, which allows one to set the log format (not the log messages) e.g. via <code>logging.basicConfig(fmt='{asctime} {message}', style='{')</code>.</p>
<p>but the logger still only supports <code>log.error('percent %s', 'encoded values')</code>!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:15 UTC
    </footer>
</body>
</html>
