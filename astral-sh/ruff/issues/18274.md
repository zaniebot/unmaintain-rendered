```yaml
number: 18274
title: "[Infinite loop] I001 Import block is un-sorted or un-formatted"
type: issue
state: closed
author: moszajca-sonatus
labels:
  - needs-info
assignees: []
created_at: 2025-05-23T11:51:50Z
updated_at: 2025-05-23T13:42:13Z
url: https://github.com/astral-sh/ruff/issues/18274
synced_at: 2026-01-10T01:56:56Z
```

# [Infinite loop] I001 Import block is un-sorted or un-formatted

---

_Issue opened by @moszajca-sonatus on 2025-05-23 11:51_

Comments are causing infinite loop.

```
error: Failed to converge after 100 iterations.

This indicates a bug in Ruff. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BInfinite%20loop%5D

...quoting the contents of `zzza.py`, the rule codes I001, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

zzza.py:1:1: I001 Import block is un-sorted or un-formatted
  |
1 | / from test_framework.test import executor
2 | | from test_framework.test.api import port, test
  | |______________________________________________^ I001
  |
  = help: Organize imports



```

Test code:
```
from test_framework.test import executor
from test_framework.test.api import port, test


# Comment

# Comment
@test.Case(1)
class C1(port.Port):
    def __init__(self):
        super().__init__(
            case_id=1
        )


if __name__ == "__main__":
    executor.run([C1])
```

ruff.toml:
```
# Configure isort settings within Ruff
[lint.isort]
force-single-line = false
known-first-party = ["test_framework"]
```

Ruff 0.11.11

---

_Comment by @MichaReiser on 2025-05-23 13:08_

Thanks for reporting.

I'm unable to reproduce this on its own when using:

```shell
uvx ruff check lib.py --select I001 --no-cache --fix --unsafe-fixes --preview --output-format concise --isolated --config "lint.isort.force-single-line = false" --config 'lint.isort.known-first-party = ["test_framework"]'
```

Any chance you have `E302` enabled as well? I can then reproduce the error, which is the same as https://github.com/astral-sh/ruff/issues/12611

---

_Label `needs-info` added by @MichaReiser on 2025-05-23 13:09_

---

_Comment by @moszajca-sonatus on 2025-05-23 13:26_

```
# ruff.toml

line-length = 132
indent-width = 4

# Specify the file patterns to include in the analysis
include = ["*.py"]

# Allow fix for all enabled rules (when `--fix`) is provided.
lint.fixable = ["ALL"]

# Optionally, you can disable automatic fixing for these specific rules or in general
# fix = false

# Assume Python 3.10
target-version = "py310"

# Specify which error/warning codes should be checked
lint.select = [
    "E",  # All errors
    "W",  # All warnings
    "PIE",  # All flake8-pie
    "RET",  # All flake8-return
    "PLE",  # All Errors from Pylint
    "F401",  # unused-import
    "F541",  # f-string-missing-placeholders
    "F841",  # unused-variable
    "I001",  # isort: unsorted-imports
    "I002",  # isort: missing-required-import
    ]
lint.ignore = [  # Ruff cannot automatically fix these. Should be fixed manually before remove from below list.
    "E266",  # multiple-leading-hashes-for-block-comment. We use this for headers.
    "E402",  # module-import-not-at-top-of-file
    "E501",  # line-too-long
    "E712",  # true-false-comparison
    "E701",  # multiple-statements-on-one-line-colon
    "E711",  # none-comparison
    "E721",  # type-comparison
    "E722",  # bare-except
    "E731",  # lambda-assignment
    "E741",  # ambiguous-variable-name
    ]

[format]
# Like Black, indent with spaces, rather than tabs.
indent-style = "space"

# Configure isort settings within Ruff
[lint.isort]
force-single-line = false
known-first-party = ["test_framework"]

```

---

_Comment by @MichaReiser on 2025-05-23 13:42_

Thanks. Yes, you have `E302` enabled. So this is a duplicate of

---

_Closed by @MichaReiser on 2025-05-23 13:42_

---
