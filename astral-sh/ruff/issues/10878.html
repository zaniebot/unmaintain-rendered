<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`exclude` under `[tool.ruff.lint]` does not exclude directory - astral-sh/ruff #10878</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>exclude</code> under <code>[tool.ruff.lint]</code> does not exclude directory</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10878">#10878</a>
        opened by <a href="https://github.com/ajhynes7">@ajhynes7</a>
        on 2024-04-11 12:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ajhynes7">@ajhynes7</a></div>
            <div class="timeline-body">

Description
<p>I&#x27;ve found that <code>ruff check</code> doesn&#x27;t exclude a directory, although the name is included in the <code>exclude</code> list under <code>[tool.ruff.lint]</code> in <code>pyproject.toml</code>.</p>
<p>From the ruff docs, in <a href="https://docs.astral.sh/ruff/settings/#lint_exclude">Settings/lint/exclude</a>:</p>
<blockquote>
<p>Exclusions are based on globs, and can be either:</p>
<ul>
<li>Single-path patterns, like <code>.mypy_cache</code> (to exclude any directory named <code>.mypy_cache</code> in the tree), <code>foo.py</code> (to exclude any file named <code>foo.py</code>), or <code>foo_*.py</code> (to exclude any file matching <code>foo_*.py</code>).</li>
</ul>
</blockquote>
<p>However, I&#x27;ve found that specifying the directory name doesn&#x27;t work.</p>
Environment
<pre><code>$  ruff --version
ruff 0.3.5
</code></pre>
Reproduction
<p>I reproduced this with a minimal project.</p>
<p>Project contents:</p>
<pre><code>$ tree
.
├── dir1
│   └── foo.py
├── poetry.lock
└── pyproject.toml
</code></pre>
<p><code>foo.py</code>:</p>
<pre><code># foo.py

def foo():
    x = 1
</code></pre>
<p><code>pyproject.toml</code>:</p>
<pre><code>
[tool.poetry]
name = &quot;foo&quot;
authors = []
description = &quot;&quot;
version = &quot;0.1.0&quot;

[tool.poetry.dependencies]
python = &quot;^3.11&quot;

[tool.poetry.group.dev.dependencies]
ruff = &quot;^0.3.5&quot;

[tool.ruff.lint]
exclude = [&quot;dir1&quot;]

[build-system]
requires = [&quot;poetry-core&quot;]
build-backend = &quot;poetry.core.masonry.api&quot;
</code></pre>
<p>Command:</p>
<pre><code>$  ruff check .
dir1/foo.py:2:5: F841 Local variable `x` is assigned to but never used
Found 1 error.
No fixes available (1 hidden fix can be enabled with the `--unsafe-fixes` option).
</code></pre>
Notes
<p>If I use <code>exclude</code> in the top-level <code>[tool.ruff]</code> section instead, the directory is excluded as expected.</p>
<pre><code>[tool.ruff]
exclude = [&quot;dir1&quot;]
</code></pre>
<pre><code>$  ruff check .
All checks passed!
</code></pre>
<p>I can also get the directory excluded if I put a wildcard at the end. But according to the docs, the directory name alone should suffice.</p>
<pre><code>[tool.ruff.lint]
exclude = [&quot;dir1/*&quot;]
</code></pre>
<pre><code>$  ruff check .
All checks passed!
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-11 14:56</div>
            <div class="timeline-body"><p>Yeah, this is a known bug that we haven&#x27;t found time to fix yet. I&#x27;m sorry you run into this.</p>
<p>We&#x27;re tracking this bug in <a href="https://github.com/astral-sh/ruff/issues/8267">astral-sh/ruff#8267</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-11 14:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:52 UTC
    </footer>
</body>
</html>
