<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VS Code duplicate code format on save - astral-sh/ruff #10240</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>VS Code duplicate code format on save</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10240">#10240</a>
        opened by <a href="https://github.com/james-berkheimer">@james-berkheimer</a>
        on 2024-03-05 18:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/james-berkheimer">@james-berkheimer</a></div>
            <div class="timeline-body"><p>When I save a file certain lines of code are duplicated.  It&#x27;s usually only one line that gets duplicated and it is usually only if new code has been pasted into the file.  If I disable the Ruff extension this issue goes away.  This seems to be happening only when I paste in code into a file.</p>
<p>VS Code version: 1.87.0
Ruff extension version: v202414.0
Pyproject.toml settings:</p>
<pre><code>[tool.ruff]
ignore = [&quot;F401&quot;, &quot;F403&quot;]
line-length = 100
</code></pre>
<p><img src="https://github.com/astral-sh/ruff/assets/5049386/c1e42a45-fc96-4bc0-9e8f-30dd08483497" alt="vscode_ruff_issue"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 18:50</div>
            <div class="timeline-body"><p>Do you have the isort extension installed? It could be <a href="https://github.com/astral-sh/ruff-vscode/issues/128">astral-sh/ruff-vscode#128</a> which is actually an unfixed bug in VS Code itself: <a href="https://github.com/microsoft/vscode/issues/174295">microsoft/vscode#174295</a>. The recommended fix is to either disable the isort extension <em>or</em> disable Ruff&#x27;s import organization.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 18:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/james-berkheimer">@james-berkheimer</a> on 2024-03-05 18:54</div>
            <div class="timeline-body"><p>Some more weirdness when saving.</p>
<p><img src="https://github.com/astral-sh/ruff/assets/5049386/3ea5287b-5580-4884-a8de-8e779cbd187e" alt="Code_MXXJHNJSSy"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/james-berkheimer">@james-berkheimer</a> on 2024-03-05 18:55</div>
            <div class="timeline-body"><blockquote>
<p>Do you have the isort extension installed? It could be <a href="https://github.com/astral-sh/ruff-vscode/issues/128">astral-sh/ruff-vscode#128</a> which is actually an unfixed bug in VS Code itself: <a href="https://github.com/microsoft/vscode/issues/174295">microsoft/vscode#174295</a>. The recommended fix is to either disable the isort extension <em>or</em> disable Ruff&#x27;s import organization.</p>
</blockquote>
<p>I do have that extension installed it seems.  Let me disable it and see if that fixes things.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/james-berkheimer">@james-berkheimer</a> on 2024-03-05 18:58</div>
            <div class="timeline-body"><p>Yup, that seems to have fixed the issue.  Thanks Charlie!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/james-berkheimer">@james-berkheimer</a> on 2024-03-05 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 18:59</div>
            <div class="timeline-body"><p>Sorry about that, unfortunately we have no control over it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/james-berkheimer">@james-berkheimer</a> on 2024-03-05 19:03</div>
            <div class="timeline-body"><blockquote>
<p>Sorry about that, unfortunately we have no control over it!</p>
</blockquote>
<p>No worries.  Having both isort and Ruff was redundant anyways.  I have no issue turning off isort in this case. :)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:50 UTC
    </footer>
</body>
</html>
