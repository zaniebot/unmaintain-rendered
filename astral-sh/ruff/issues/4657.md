```yaml
number: 4657
title: "RUF009 hints for float('-inf')"
type: issue
state: closed
author: alkatar21
labels:
  - bug
assignees: []
created_at: 2023-05-25T13:48:44Z
updated_at: 2023-05-26T19:18:53Z
url: https://github.com/astral-sh/ruff/issues/4657
synced_at: 2026-01-10T01:56:47Z
```

# RUF009 hints for float('-inf')

---

_Issue opened by @alkatar21 on 2023-05-25 13:48_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->
`RUF009` is hinting in a dataclass where floats are initialized with `float('-inf')`.
As suggested in [Discord](https://discord.com/channels/1039017663004942429/1039017663512449056/1111040962039386122) `float` should probably be added to the list of allowed functions.

```py
from dataclasses import dataclass

@dataclass
class Test:
    example: float = float('-inf') # Do not perform function call `float` in dataclass defaultsRuff(RUF009)
```

---

_Comment by @charliermarsh on 2023-05-25 14:10_

Thanks :)

---

_Comment by @JonathanPlasse on 2023-05-25 14:43_

@alkatar21, Would you like to make a PR for it?

---

_Comment by @alkatar21 on 2023-05-25 14:52_

If you could give me a hint of where to look, I would try.

---

_Comment by @qdegraaf on 2023-05-25 15:07_

@alkatar21 Quick scan of the rule suggests this is approximately where the check is done: https://github.com/charliermarsh/ruff/blob/741e180e2d30078c59e03a8761d90757964c5cf7/crates/ruff/src/rules/ruff/rules/mutable_defaults_in_dataclass_fields.rs#L202 

I can also open a PR if you prefer. 


---

_Comment by @qdegraaf on 2023-05-25 15:20_

Should the check for float be added to the `IMMUTABLE_FUNCS` const and therefore `is_immutable_func`, which is also used in flake8-bugbear rule `FunctionCallInDefaultArgument`? Or should it be a separate check for `RUF009` only?

[This line]( https://github.com/PyCQA/flake8-bugbear/blob/a309029eed5070938a376af88b0d046e8acda5c9/bugbear.py#LL1575C25-L1575C25) in `flake8-bugbear` seems to suggest it should just be a `RUF009` thing but just wanna make sure before I (or someone else equally unfamiliar) opens a PR.

---

_Comment by @charliermarsh on 2023-05-25 15:44_

Yeah, I think float and int and perhaps some other builtins (`complex`?) should be added there.

---

_Comment by @qdegraaf on 2023-05-25 16:26_

I'll open a PR with those in as well. Looking at:
```rust
const IMMUTABLE_FUNCS: &[&[&str]] = &[
    &["", "tuple"],
    &["", "frozenset"],
    &["datetime", "date"],
    &["datetime", "datetime"],
    &["datetime", "timedelta"],
    &["decimal", "Decimal"],
    &["operator", "attrgetter"],
    &["operator", "itemgetter"],
    &["operator", "methodcaller"],
    &["pathlib", "Path"],
    &["types", "MappingProxyType"],
    &["re", "compile"],
];
```
I'll add `int`, `float`, `complex`.

 If it should be: "all functions that return an immutable object" should `str` and `bool` also be added? 
 
 There's also the `fractions.Fraction` which states it in its [docs](https://docs.python.org/3/library/fractions.html)

> The [Fraction](https://docs.python.org/3/library/fractions.html#fractions.Fraction) class inherits from the abstract base class [numbers.Rational](https://docs.python.org/3/library/numbers.html#numbers.Rational), and implements all of the methods and operations from that class. [Fraction](https://docs.python.org/3/library/fractions.html#fractions.Fraction) instances are [hashable](https://docs.python.org/3/glossary.html#term-hashable), and should be treated as immutable.

Unsure if that counts for this purpose as well.


---

_Referenced in [astral-sh/ruff#4660](../../astral-sh/ruff/pulls/4660.md) on 2023-05-25 16:46_

---

_Label `bug` added by @charliermarsh on 2023-05-25 19:59_

---

_Closed by @charliermarsh on 2023-05-26 19:18_

---
