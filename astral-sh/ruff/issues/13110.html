<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannot find ruff on Windows in venv using --system-site-packages - astral-sh/ruff #13110</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cannot find ruff on Windows in venv using --system-site-packages</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13110">#13110</a>
        opened by <a href="https://github.com/markuspi">@markuspi</a>
        on 2024-08-26 14:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/markuspi">@markuspi</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p><code>python -m ruff</code> can't find ruff.exe on Windows when using a virtual environment generated using <code>--system-site-packages</code>:</p>
<ol>
<li><p>Prerequisite: have ruff installed system-wide on Windows. The bug does not trigger if it is installed in the per-user packages in AppData.
<em>Example</em>: I have a Python311 installed in <code>C:\Python311</code>, with ruff at <code>C:\Python311\Lib\site-packages\ruff\__main__.py</code> and <code>C:\Python311\Scripts\ruff.exe</code>.</p>
</li>
<li><p>Create virtual environment using <code>--system-site-packages</code> flag</p>
<pre><code class="language-powershell">C:\Python311\python -m venv --system-site-packages myvenv
</code></pre>
</li>
<li><p>Using virtual environment to run <code>python -m ruff</code> results in FileNotFoundError.</p>
<pre><code class="language-powershell">.\myvenv\Scripts\python -m ruff
</code></pre>
<pre><code class="language-text">Traceback (most recent call last):
  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;C:\Python311\Lib\site-packages\ruff\__main__.py&quot;, line 40, in &lt;module&gt;
    ruff = os.fsdecode(find_ruff_bin())
                       ^^^^^^^^^^^^^^^
  File &quot;C:\Python311\Lib\site-packages\ruff\__main__.py&quot;, line 36, in find_ruff_bin
    raise FileNotFoundError(scripts_path)
FileNotFoundError: C:\[...]\myvenv\Scripts\ruff.exe
</code></pre>
</li>
</ol>
<p>Ruff version: 0.6.2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @dhruvmanila on 2024-08-26 16:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:50:59 UTC
    </footer>
</body>
</html>
