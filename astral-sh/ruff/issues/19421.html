<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Failure to create cache key on invalid symlink - astral-sh/ruff #19421</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Failure to create cache key on invalid symlink</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/19421">#19421</a>
        opened by <a href="https://github.com/kdeldycke">@kdeldycke</a>
        on 2025-07-18 11:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kdeldycke">@kdeldycke</a> on 2025-07-18 11:47</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Tl;Dr: an invalid symlink makes <code>ruff</code> exits with code 1 due to cache key creation failure.</p>
<h3>How to reproduce</h3>
<pre><code class="language-shell-session">$ ln -s /blah.py

$ ls -lah
Permissions Size User Date Modified    Name
drwxr-xr-x@    - kde  2025-07-18 15:30 .
drwxr-xr-x     - kde  2025-07-18 15:30 ..
drwxr-xr-x@    - kde  2025-07-18 15:30 .ruff_cache
lrwxr-xr-x     - kde  2025-07-18 15:30 blah.py -&gt; /blah.py

$ cat /blah.py                                                                
cat: /blah.py: No such file or directory (os error 2)

$ ruff check       
blah.py:1:1: E902 Failed to create cache key
  Cause: Failed to create cache key
  Cause: No such file or directory (os error 2)
Found 1 error.

$ echo $?        
1

$ rm ./blah.py

$ ruff check       
warning: No Python files found under the given path(s)
All checks passed!

$ echo $?      
0
</code></pre>
<h3>Expected behavior</h3>
<p>I expect the <code>ruff</code> CLI to emit a warning and skip the invalid symlink altogether, and continue on checking other files.</p>
<p>An alternative would be to allow tweaking this behavior, i.e. either silently ignoring the broken symlink or erroring on purpose, behind an option.</p>
<h3>Version</h3>
<p>ruff 0.12.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kdeldycke">@kdeldycke</a> on 2025-07-18 11:49</div>
            <div class="timeline-body"><p>Might be related to https://github.com/astral-sh/ruff/issues/19395</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2025-07-18 12:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @MichaReiser on 2025-07-18 12:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
