<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[feature-request] Support dry run for --fix via --diff flag - astral-sh/ruff #1430</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[feature-request] Support dry run for --fix via --diff flag</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/1430">#1430</a>
        opened by <a href="https://github.com/salmiakki">@salmiakki</a>
        on 2022-12-28 21:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/salmiakki">@salmiakki</a> on 2022-12-28 21:18</div>
            <div class="timeline-body"><p>It's scary to apply automatic fixes before taking a look at them.</p>
<p>It would be nice to have a dry run option (<code>--dry-run</code>?) that outputs the patch to stdout.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-28 22:23</div>
            <div class="timeline-body"><p>Yeah that could be useful. I'm not sure what the right output format would be. Write the changed files to disk as <code>.bak</code> or <code>.tmp</code> variants? Just dump the patches to stdout?</p>
<p>As an aside: ESLint has <a href="https://eslint.org/docs/latest/user-guide/command-line-interface#--fix-dry-run"><code>--fix-dry-run</code></a>, but it just disables writing the fixes to disk. If you want to get the fixes without writing them, you have to specify <code>--format json</code>, to get the fixes in JSON format. I find this a bit clearer than what we do today (always write to disk if <code>--fix</code> is set, but generate fixes if <code>--fix</code> is not set and <code>--format json</code> is set).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-28 22:27</div>
            <div class="timeline-body"><p>Can you think of other tools that implement this kind of thing, and how they handle it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @charliermarsh on 2022-12-28 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/salmiakki">@salmiakki</a> on 2022-12-28 22:47</div>
            <div class="timeline-body"><p>Definitely diff to stdout.</p>
<p>Maybe printing the whole file in addition to the diff could be useful as well. Other than that I can't really see myself using anything else.</p>
<hr />
<p>For prior art:</p>
<p><code>black</code> has</p>
<pre><code>  --diff                          Don't write the files back, just output a
                                  diff for each file on stdout.
</code></pre>
<p><code>goftm</code> has</p>
<pre><code>-d
	Do not print reformatted sources to standard output.
	If a file's formatting is different than gofmt's, print diffs
	to standard output.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rhkleijn">@rhkleijn</a> on 2022-12-28 23:02</div>
            <div class="timeline-body"><p><code>isort</code> also has <code>--diff</code>
See https://pycqa.github.io/isort/docs/configuration/options.html#show-diff</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-28 23:10</div>
            <div class="timeline-body"><p>Ok cool, weâ€™ll call it diff and print to stdout (one diff per changed file).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[feature-request] Support dry run for --fix" to "[feature-request] Support dry run for --fix via --diff flag" by @charliermarsh on 2022-12-28 23:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2022-12-28 23:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1431.html">astral-sh/ruff#1431</a> on 2022-12-29 00:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-12-29 00:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/salmiakki">@salmiakki</a> on 2022-12-29 00:29</div>
            <div class="timeline-body"><p>@charliermarsh Are you for real? This is insane. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-29 00:46</div>
            <div class="timeline-body"><p>Haha :) It's a good idea! You're welcome!</p>
<p>This'll go out in the next release, later tonight. Would love to hear if it works for you (or doesn't!).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1439.html">astral-sh/ruff#1439</a> on 2022-12-29 16:07</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:49 UTC
    </footer>
</body>
</html>
