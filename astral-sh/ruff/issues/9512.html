<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>False negative with SIM108 - astral-sh/ruff #9512</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>False negative with SIM108</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/9512">#9512</a>
        opened by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a>
        on 2024-01-14 07:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a> on 2024-01-14 07:25</div>
            <div class="timeline-body"><pre><code class="language-python">def main() -&gt; None:
    with open('a'):
        for i in range(10):
            yrange = None
            integer_yrange: None | range
            if yrange is not None:
                integer_yrange = range(int(yrange[0]), int(yrange[1]) + 1)
            else:
                integer_yrange = None
            print(integer_yrange)
</code></pre>
<p>Does not produce use-ternary-operator.  Removing the function, context manager and loop does.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-14 15:13</div>
            <div class="timeline-body"><p>I believe this is https://github.com/astral-sh/ruff/issues/8106 -- it does flag it if you increase the line length: https://play.ruff.rs/c11cd4e9-a96c-40e6-ae60-6c735ab5bfb0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-14 15:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a> on 2025-01-01 04:07</div>
            <div class="timeline-body"><p>Sorry, but why does line length matter here?  I think the ternary expression is still an improvement even if it doesn't fit on one line.  Can we format it like so:</p>
<pre><code class="language-python">if not isinstance(inference_result, RivalConfiguration):
    code = None
else:
    code = np.asarray(inference_result.pooling_output, dtype=np.float64)
</code></pre>
<p>becomes</p>
<pre><code class="language-python">code = (np.asarray(inference_result.pooling_output, dtype=np.float64)
        if isinstance(inference_result, RivalConfiguration)
        else None)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-01 04:21</div>
            <div class="timeline-body"><p>(You should contribute to the discussion in the linked issue, which is open.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a> on 2025-01-01 06:18</div>
            <div class="timeline-body"><p>Sorry, my mistake :)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
