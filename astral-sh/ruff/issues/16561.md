```yaml
number: 16561
title: "`useless-try-except (TRY203)` false negative?"
type: issue
state: open
author: harupy
labels:
  - rule
assignees: []
created_at: 2025-03-08T04:41:14Z
updated_at: 2025-03-10T08:31:43Z
url: https://github.com/astral-sh/ruff/issues/16561
synced_at: 2026-01-10T01:56:55Z
```

# `useless-try-except (TRY203)` false negative?

---

_Issue opened by @harupy on 2025-03-08 04:41_

### Summary

X-post from https://github.com/guilatrova/tryceratops/issues/76. In the following code, should [`useless-try-except`](https://docs.astral.sh/ruff/rules/useless-try-except/) flag the last except handler be flagged as a violation? It currently doesn't.

```python
try:
    foo()
except ValueError:  # not useless
    print("Do not throw")  
except TypeError:   # is this useless? (**trailing** immediate-raise handler)
    raise
```

`useless-try-except` requires all except handlers to be useless.

https://github.com/astral-sh/ruff/blob/036102186392f1263774bfd42d78acc65c0641b8/crates/ruff_linter/src/rules/tryceratops/rules/useless_try_except.rs#L69-L70

### Playground reproduction

https://play.ruff.rs/44084483-f2df-424a-87ca-dc5d6884aebe

### Version

v0.9.10

---

_Comment by @InSyncWithFoo on 2025-03-08 05:22_

The second handler is, in fact, not useless:

```python
class CustomError(ValueError, TypeError): ...

try:
    raise CustomError
except ValueError:
    print('ValueError')               # This is reached
except TypeError:
    print('TypeError & ~ValueError')  # This is not
```



---

_Comment by @harupy on 2025-03-08 05:52_

@InSyncWithFoo by the second handler, you mean `except TypeError:`?

---

_Comment by @InSyncWithFoo on 2025-03-08 07:03_

> by the second handler, you mean `except TypeError:`?

Yes, that's the one. It only catches `TypeError`s that are not `ValueError`s, and so is not useless.

---

_Comment by @harupy on 2025-03-08 07:11_

I see, so

```python
class CustomError(ValueError, TypeError): ...

try:
    raise CustomError
except ValueError:
    print('ValueError')
except TypeError:
    raise
```

isn't equivalent to:

```python
class CustomError(ValueError, TypeError): ...

try:
    raise CustomError
except ValueError:
    print('ValueError')
```

---

_Comment by @InSyncWithFoo on 2025-03-08 07:26_

Actually... ignore my previous comments. It <em>is</em> useless.



---

_Comment by @harupy on 2025-03-08 07:33_

Thanks for the confirmation :ï¼‰ 

---

_Comment by @harupy on 2025-03-08 07:46_

Can I file a PR to fix this?

---

_Referenced in [astral-sh/ruff#16564](../../astral-sh/ruff/pulls/16564.md) on 2025-03-08 08:56_

---

_Label `rule` added by @MichaReiser on 2025-03-08 18:07_

---

_Comment by @MichaReiser on 2025-03-08 18:10_

It seems this is intentional, see https://github.com/astral-sh/ruff/pull/4461#discussion_r1195753624

```py
Class BothError(ValueError, TypeError): ...
try:
    raise BothError
except TypeError:   # this is not useless because it suppress the error in `ValueError`
    raise
except ValueError:  # not useless
    print("Do not throw")  
```

I think there's an argument whether *unnecessary raise* that are the last handlers should be disallowed. Is this what you are suggesting in this issue?

---

_Comment by @harupy on 2025-03-08 23:10_

@MichaReiser Yes, that's what I'm suggesting in this issue. Here's another example:

```python
try:
    ...
except Exception:
    pass # swallow the error
except ValueError:
    # ValueError should not be swallowed
    raise
    # This is likely a mistake,
    # should be moved above the first handler
```

---
