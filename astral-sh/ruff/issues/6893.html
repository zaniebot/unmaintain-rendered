<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Rule] Extra level of indentation - astral-sh/ruff #6893</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Rule] Extra level of indentation</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6893">#6893</a>
        opened by <a href="https://github.com/serjflint">@serjflint</a>
        on 2023-08-26 10:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/serjflint">@serjflint</a> on 2023-08-26 10:33</div>
            <div class="timeline-body"><p>Hello!</p>
<p>Black is great and uncompromising but has changed over the years.
I am migrating a large codebase and the diff's size is insane. I hope to make the process more gradual.</p>
<p>I use ruff with autofixes to decrease the diff. Having a monorepo-compatible configuration helps a lot.
After the migration I will change configs in each sub-project separately.</p>
<p>The only problem left for me is an indentation. Our very old version of black puts extra level of space (8 in total) before the args, according to <a href="https://peps.python.org/pep-0008/#indentation">PEP 8</a>. The modern black only uses one level of space (just 4).</p>
<p>Is it possible to add the number of spaces as a custom rule in ruff with autofix?</p>
<pre><code class="language-python"># In:
def func(
    arg1, arg2, arg3, ..., argN
):

# Out:
def func(
        arg1, arg2, arg3, ..., argN
):
</code></pre>
<p>P.S.: I can't migrate in smaller chunks because the whole codebase uses common tooling and CI.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[Rule] Extra level of indentation for function definitions" to "[Rule] Extra level of indentation" by @serjflint on 2023-08-26 11:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-30 16:13</div>
            <div class="timeline-body"><p>Why is the indentation a problem here? Is the thinking here that would want to upgrade Black to latest, and use Ruff to modify the code to add the 8-space indentation? Or is Ruff flagging the 8-space indentation, and you want to avoid Ruff raising errors there?</p>
<p>I think I understand the use-case but I don't know that we can justify adding a rule for this -- it's a fairly specific need, but something we'll need to implement and maintain in perpetuity.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">waiting-on-author</span> added by @charliermarsh on 2023-08-30 16:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/serjflint">@serjflint</a> on 2023-09-01 05:24</div>
            <div class="timeline-body"><p>@charliermarsh Hi! Thank you for a detailed answer.</p>
<blockquote>
<p>Why is the indentation a problem here?</p>
</blockquote>
<p>The indentation is not a problem by itself. The problem is that Black switched the indentation without giving a way to configure it. Both 4 and 8 spaces are ok by PEP 8 if I understand it correctly.</p>
<blockquote>
<p>Is the thinking here that would want to upgrade Black to latest, and use Ruff to modify the code to add the 8-space indentation?</p>
</blockquote>
<p>Yes, exactly. I want to use Ruff to temporarily force it back to 8 spaces. After that I will use Ruff's .toml to configure sub-projects finely.</p>
<blockquote>
<p>Or is Ruff flagging the 8-space indentation, and you want to avoid Ruff raising errors there?</p>
</blockquote>
<p>Actually it isn't flagging neither 4 nor 8 spaces. And I haven't met a rule in Ruff which isn't configurable via .toml.</p>
<blockquote>
<p>I think I understand the use-case but I don't know that we can justify adding a rule for this -- it's a fairly specific need, but something we'll need to implement and maintain in perpetuity.</p>
</blockquote>
<p>I understand that it is a bit niche use-case. Not many people are skipping so many updates to catch up =) But for me this rule is a bit like a setting of single and double quotes (a problem with no way to use single quotes in Black). And I actually use Q000 and COM812 to decrease the diff, too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">waiting-on-author</span> removed by @zanieb on 2023-09-07 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @zanieb on 2023-09-07 14:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @zanieb on 2023-09-07 14:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-29 01:55</div>
            <div class="timeline-body"><p>I'm going to close this in favor of the discussion happening in our own formatter here: https://github.com/astral-sh/ruff/discussions/7310#discussioncomment-7128822. Feel free to chime in there. I think we're unlikely to support this as a standalone lint rule, but perhaps it will end up being supported in our formatter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-09-29 01:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/serjflint">@serjflint</a> on 2024-02-22 18:10</div>
            <div class="timeline-body"><p>Similar to https://github.com/astral-sh/ruff/issues/8360</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:31:08 UTC
    </footer>
</body>
</html>
