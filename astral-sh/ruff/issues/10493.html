<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Searching for .config/ruff.toml - astral-sh/ruff #10493</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Searching for .config/ruff.toml</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10493">#10493</a>
        opened by <a href="https://github.com/bersace">@bersace</a>
        on 2024-03-20 17:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bersace">@bersace</a></div>
            <div class="timeline-body"><p>Hi,</p>
<p>Ruff reads its configuration from <code>ruff.toml</code> at root directory of a project. To unclutter root directory, ruff reads its configuration from pyproject.toml. Some projects has several pyproject.toml and having a single ruff toml file is great.</p>
<p>JS world use <code>.config</code>: https://github.com/pi0/config-dir. Ruff project has a <code>.config</code> directory for nextest.</p>
<p>I suggest that ruff also search for <code>.config/ruff.toml</code>. What do you think of this ?</p>
<p>Regareds,
Ã‰tienne</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-21 07:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-21 07:55</div>
            <div class="timeline-body"><p>Hy @bersace</p>
<p>I understand that it&#x27;s undesired to clutter your project root folder with configuration files. Have you considered using <code>ruff --config .config/ruff.toml</code> to tell ruff where to search for the configuration? It&#x27;s not as luxurious as when Ruff automatically discovers the configuration for you but we try to keep the number of places where Ruff searches for configurations minimal because</p>
<ul>
<li>Ruff needs to check for the existence of a configuration file for every directory. The more configuration files it supports (or locations), the more IO operations are necessary and IO is slow. Ruff has to check this for every directory, even if it doesn&#x27;t contain configuration files.</li>
<li>Supporting more locations isn&#x27;t just overhead for Ruff but also for users because you now need to search for the configuration in multiple places rather than in one standardized path.</li>
<li>It&#x27;s less obvious what Ruff should do if a project has both a <code>ruff.toml</code> and a <code>./config/ruff.toml</code>. Which configuration takes precedence? Should the configurations be merged and if so, in which order?</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersace">@bersace</a> on 2024-03-21 07:59</div>
            <div class="timeline-body"><p>since <code>ruff.toml</code> is more evident than <code>.config/ruff.toml</code>, that&#x27;s fair for ruff to prefer the first.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersace">@bersace</a> on 2024-03-21 16:20</div>
            <div class="timeline-body"><p>I don&#x27;t know how to configure each IDE to use the proper <code>--config</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-22 16:39</div>
            <div class="timeline-body"><blockquote>
<p>I don&#x27;t know how to configure each IDE to use the proper <code>--config</code>.</p>
</blockquote>
<p>What IDEs are you using?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersace">@bersace</a> on 2024-03-27 19:28</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I don&#x27;t know how to configure each IDE to use the proper <code>--config</code>.</p>
</blockquote>
<p>What IDEs are you using?</p>
</blockquote>
<p>I mean, configure IDE of all collaborators and contributors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 10:15</div>
            <div class="timeline-body"><p>You could use <a href="https://code.visualstudio.com/docs/getstarted/settings#_workspace-settings">Workspace settings</a> in VS code but I don&#x27;t think you&#x27;ll like it because they&#x27;re saved into a <code>.vscode</code> directory. So you exchange a top-level <code>.ruff.toml</code> with a <code>.vscode</code> folder :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersace">@bersace</a> on 2024-03-28 10:26</div>
            <div class="timeline-body"><p>I&#x27;m using Doom Emacs. Other use neovim, VSCode, and you-name-it. Trying to setup every IDE in every project is nogo.</p>
<p>About performances, I understand the point.</p>
<p>It looks like searching <strong>inside</strong> pyproject.toml is the heaviest, isn&#x27;t it ? Would it be possible to limit search of <code>.config</code>  directory ? e.g. only .config sibling .git ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 12:04</div>
            <div class="timeline-body"><p>The cost is more about testing if the configuration files exists because IO is slow in comparison to other computations.</p>
<blockquote>
<p>It looks like searching inside pyproject.toml is the heaviest, isn&#x27;t it ? Would it be possible to limit search of .config directory ? e.g. only .config sibling .git ?</p>
</blockquote>
<p>I don&#x27;t think that simplifies the problem. It would still require an additional test (it even makes it worse) to see if the <code>.git</code> directory exists.</p>
<p>There&#x27;s also the concern that I raised above, where it&#x27;s unclear what the expected behavior is when you have the following project structure:</p>
<pre><code>.config/
  - ruff.toml
- pyproject.toml
- ruff.toml
</code></pre>
<p>I agree that this is an edge case, but one that Ruff must handle correctly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersace">@bersace</a> on 2024-03-28 13:08</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>It looks like searching inside pyproject.toml is the heaviest, isn&#x27;t it ? Would it be possible to limit search of .config directory ? e.g. only .config sibling .git ?</p>
</blockquote>
<p>I don&#x27;t think that simplifies the problem. It would still require an additional test (it even makes it worse) to see if the <code>.git</code> directory exists.</p>
</blockquote>
<p>ruff already reads <code>.git/info/exclude</code>, isn&#x27;t it ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 13:29</div>
            <div class="timeline-body"><blockquote>
<p>ruff already reads .git/info/exclude, isn&#x27;t it ?</p>
</blockquote>
<p>It does, by using the <code>ignore</code> crate but I don&#x27;t think we get that kind of information in the configuration discovery, so we would need to duplicate the logic or perform the check twice.</p>
<p>Anyway. I don&#x27;t think we&#x27;ll add support for this until there&#x27;s wider community support for a centralized configuration folder. We don&#x27;t want to support 10 or so different locations because supporting multiple locations has a performance and complexity (not just code, also for users) cost. I want to avoid a situation similar to prettier or eslint where Ruff has to test 10or so different locations (which not only hurts the performance of projects using <code>.config</code> but every project, see <a href="https://prettier.io/blog/2023/11/30/cli-deep-dive.html#resolving-configurations-fast">this blog post</a>)</p>
<p>I understand that this must be frustrating for you because having a <code>.config</code> folder only pays off once every tool you use supports it.</p>
<p>How do you handle the <code>pyproject.toml</code> today or the configurations of other python tooling? Are they stored top-level or in the <code>.config</code> directory?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-02 08:40</div>
            <div class="timeline-body"><p>I&#x27;m going to close this for now because I don&#x27;t see a way to implement it that is net positive for all users. I know that this must be unsatisfying for you because there&#x27;s no good workaround to have all configurations in a centralized place, and am sorry for that</p>
<p>There have been similar requests in the past, e.g. adding <a href="https://github.com/astral-sh/ruff/issues/4970">astral-sh/ruff#4970</a> that we&#x27;ve closed for similar reasons. We&#x27;ll reconsider this when there&#x27;s more alignment on a standardized configuration location.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-02 08:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersace">@bersace</a> on 2024-04-02 09:10</div>
            <div class="timeline-body"><p>thanks for your attention on this issue. At least, the subject is discussed.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:51 UTC
    </footer>
</body>
</html>
