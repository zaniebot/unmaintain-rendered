<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imports split using a backlash are reverted by `ruff format` - astral-sh/ruff #14294</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Imports split using a backlash are reverted by <code>ruff format</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14294">#14294</a>
        opened by <a href="https://github.com/PatrickJordanNutanix">@PatrickJordanNutanix</a>
        on 2024-11-12 10:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/PatrickJordanNutanix">@PatrickJordanNutanix</a> on 2024-11-12 10:27</div>
            <div class="timeline-body"><p>We have an import statement that exceeds our line length limit of 79 characters. The path to the class being imported fits within the line length limit but the <code>import</code> exceeds it. For example:</p>
<pre><code class="language-python">from our_internal_sdk_package.namespace_1.overly_verbose_long_module_name import ClassName
                                                                                ^ # line length limit here
</code></pre>
<p>We unfortunately do not have the ability to shorten the path as it's from an internal SDK that is autogenerated from an OpenAPI specification and have already released it, so cannot make breaking changes without upsetting a lot of people.</p>
<p>Naturally, we would format this like:</p>
<pre><code class="language-python">from our_internal_sdk_package.namespace_1.overly verbose_long_module_name \
  import ClassName
</code></pre>
<p>However, when we run the following, <code>ruff</code> isn't happy:</p>
<pre><code>&gt; ruff format --diff --quiet

-from our_internal_sdk_package.namespace_1.overly_verbose_long_module_name \
-  import ClassName
+from our_internal_sdk_package.namespace_1.overly_verbose_long_module_name import (
+  ClassName,
+)
</code></pre>
<p>Running the formatter causes it to reformat this import statement, then throw an <code>E501</code> linting error.</p>
<p>Is there a setting we need to change to have it respect the backslash splitting (without using <code># fmt: off|on</code> or <code># noqa: E501</code> pragma comments)?</p>
<h3>Supporting Information</h3>
<p>Version:</p>
<pre><code class="language-shell">&gt; ruff --version                                                                        
ruff 0.6.8
</code></pre>
<p>Contents of <code>ruff.toml</code>:</p>
<pre><code class="language-toml">indent-width = 2
line-length = 79
exclude = [{internal_packages}]

[format]
quote-style = &quot;double&quot;
indent-style = &quot;space&quot;

[lint]
select = [&quot;I&quot;]

[lint.isort]
known-first-party = [{internal_packages}]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-12 10:50</div>
            <div class="timeline-body"><blockquote>
<p>Is there a setting we need to change to have it respect the backslash splitting (without using # fmt: off|on or # noqa: E501 pragma comments)?</p>
</blockquote>
<p>No, there's no such option. Ruff follows Black's style guide in that regard</p>
<blockquote>
<p>Backslashes and multiline strings are one of the two places in the Python grammar that break significant indentation. You never need backslashes, they are used to force the grammar to accept breaks that would otherwise be parse errors. That makes them confusing to look at and brittle to modify. This is why Black always gets rid of them.
If you’re reaching for backslashes, that’s a clear signal that you can do better if you slightly refactor your code. I hope some of the examples above show you that there are many ways in which you can do it. (<a href="https://black.readthedocs.io/en/stable/the_black_code_style/current_style.html">source</a>)</p>
</blockquote>
<p>I don't think there's an alternative way of writing this import without backslashes that doesn't exceed the configured line length. My personal suggestion is to disable <code>E501</code> when using a formatter because it already takes care of breaking long lines. I don't think I have any other good suggestion for this specific example and improving the formatting isn't really possible because Python disalows parenthesizing the module name</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-18 02:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:35:43 UTC
    </footer>
</body>
</html>
