<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FBT001 preview behavior may lead to false positives - astral-sh/ruff #14444</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>FBT001 preview behavior may lead to false positives</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/14444">#14444</a>
        opened by <a href="https://github.com/dylwil3">@dylwil3</a>
        on 2024-11-18 22:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-18 22:55</div>
            <div class="timeline-body"><p>The rule <a href="https://docs.astral.sh/ruff/rules/boolean-type-hint-positional-argument/#boolean-type-hint-positional-argument-fbt001">boolean-type-hint-positional-argument (FBT001)</a> was extended in #7501 , under preview, to also flag positional arguments that have a type hint with any union of types that includes <code>bool</code>.</p>
<p>The intent of the rules is specifically to find places where a boolean is used as a (binary) flag, in a positional argument. If an argument has a type hint of <code>bool</code> or even <code>bool | None</code>, it makes sense to predict that the argument is being used as a flag. But the preview behavior allows any union, even, say <code>bool | str | MyClass</code>. This seems like a situation where it's a bit of a stretch to assume that the user is using the boolean as a flag.</p>
<p>Maybe the concern is unfounded and this doesn't actually happen in the real world, but I figured the community could weigh in a bit on the point before stabilizing this preview behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @dylwil3 on 2024-11-18 22:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.9" by @dylwil3 on 2024-11-18 22:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dhruvmanila on 2024-11-19 03:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-19 07:09</div>
            <div class="timeline-body"><p>I'm just curious. Do you have any examples from the ecosystem checks or from real world projects that raised this concern?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-23 08:29</div>
            <div class="timeline-body"><p>It's rare but it does happen - but maybe rare enough that noqa is the answer. Here is an example from pandas:</p>
<p>https://github.com/pandas-dev/pandas/blob/ee0902a832b7fa3e5821ada176566301791e09ec/pandas/io/formats/info.py#L350-L356</p>
<p>and a strange one from Pytorch:</p>
<p>https://github.com/pytorch/pytorch/blob/3473dfa69859f4049abe46075a91014922af198c/torch/onnx/_internal/exporter/_torchlib/ops/hop.py#L13-L19</p>
<p>It's relatively common for there to be a type alias for scalars that includes <code>bool</code> along with <code>float</code> etc., but the rule wouldn't flag that...</p>
<p>All that to say, it's probably rare enough that I'm being overly cautious here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-01-06 12:41</div>
            <div class="timeline-body"><p>I'm gonna close this since my hesitation does not seem to be justified here - I think it's okay to stabilize this rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dylwil3 on 2025-01-06 12:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:14 UTC
    </footer>
</body>
</html>
