<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff code actions in VS Code producing unexpected output - astral-sh/ruff #2625</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff code actions in VS Code producing unexpected output</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/2625">#2625</a>
        opened by <a href="https://github.com/JRyanHall94">@JRyanHall94</a>
        on 2023-02-07 15:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JRyanHall94">@JRyanHall94</a> on 2023-02-07 15:25</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>My issue is that when I save this file with these settings, I get unexpected behavior. Perhaps it's just the way that I have everything ordered in settings, but I tried adjusting things and couldn't figure out how to resolve this issue. Thanks in advance!</p>
<p>I am using black and ruff installed locally and I am formatting a file within an active venv in VS Code. My settings and the code are posted below, along with the unexpected output:</p>
<pre><code>from django.contrib.auth.models import AbstractUser
from django.db import models

class CustomUser(AbstractUser):
    pass

</code></pre>
<p>becomes</p>
<pre><code>from django.contrib.auth.models import AbstractUser


class CustomUser(AbstractUser):
    pass
    pass

</code></pre>
<hr />
<p>Settings in VS Code:</p>
<pre><code>{
    &quot;ruff.path&quot;: [
        &quot;/Library/Frameworks/Python.framework/Versions/3.11/bin/ruff&quot;
    ],
    &quot;[python]&quot;: {
        &quot;editor.codeActionsOnSave&quot;: {
            &quot;source.fixAll&quot;: true,
            &quot;source.organizeImports&quot;: true
        }
    },
    &quot;editor.formatOnSave&quot;: true,
    &quot;python.formatting.provider&quot;: &quot;black&quot;,
    &quot;python.formatting.blackPath&quot;: &quot;/Library/Frameworks/Python.framework/Versions/3.11/bin/black&quot;
}
</code></pre>
<p>current ruff version: ruff 0.0.243
current black version: black, 23.1.0 (compiled: yes)
current Python version: Python 3.11.1</p>
<p>note that if I remove the ruff portion of the settings, black formats the file as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-02-07 15:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-07 15:40</div>
            <div class="timeline-body"><p>Thanks for filing! The problem is the double <code>pass</code> statement, right? The removal of <code>from django.db import models</code> is expected. Am I interpreting correctly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JRyanHall94">@JRyanHall94</a> on 2023-02-07 15:49</div>
            <div class="timeline-body"><p>Yes, absolutely üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/ruff-vscode/issues/128.html">astral-sh/ruff-vscode#128</a> on 2023-02-08 15:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-09 16:57</div>
            <div class="timeline-body"><p>I'm just gonna close in favor of the corresponding issue in the <code>ruff-vscode</code> repo (linked above). Thank you for filing!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-02-09 16:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:49 UTC
    </footer>
</body>
</html>
