<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&quot;errors-only&quot; mode - astral-sh/ruff #19885</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>&quot;errors-only&quot; mode</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/19885">#19885</a>
        opened by <a href="https://github.com/ctcjab">@ctcjab</a>
        on 2025-08-12 20:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ctcjab">@ctcjab</a> on 2025-08-12 20:16</div>
            <div class="timeline-body"><h1>Use case</h1>
<p>Our company has a large monorepo of Python notebooks* with varying levels of code quality (a lot of it was written by quantitative researchers and other folks who aren't professional software engineers), where type hints and automated tests are practically nonexistent, and this code is nonetheless used in production.</p>
<p>We need a tool we can run in CI, ideally without having to maintain our own complex configuration, that is designed to catch only issues that will result in crashes at runtime, and obvious logic bugs, rather than code style issues (especially not flagging any issues that make no difference to the result that the code produces, which would only frustrate this type of user), without requiring users to first start adding type hints or any other major changes to the type of code they write.</p>
<p>(*) We use Jupytext to store notebooks as .py files, so we don't care if the tool doesn't support .ipynb files. Given you're already tracking #8800, I'm only mentioning &quot;notebooks&quot; here to paint a better picture of the user persona and the environment they work in.</p>
<h1>Prior Art</h1>
<p><code>pylint</code> supports an <code>--errors-only</code> option, which seems designed for exactly this use case. Initial testing on a small subset of the monorepo yielded few false positives as well as some true positives, which is exactly what we are aiming for.</p>
<p>But unfortunately pylint is slow, works best when installed in the same Python environment as the code it's linting (so it can follow imports), and (since it's implemented in Python and has its own Python dependencies) pulls in a lot of transitive dependency constraints, which is very undesired.</p>
<h1>Proposal</h1>
<p>What if <code>ruff check</code> supported a single, simple <code>--errors-only</code> option or something like this, which changed its default behavior to only look for issues that will almost definitely cause crashes or other serious issues at runtime?</p>
<p>Thanks for your consideration and for the great work on ruff ❤️</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-12 21:07</div>
            <div class="timeline-body"><p>Thanks for the kind words and the clear write-up!</p>
<p>I believe this overlaps heavily with #1774, which is our issue tracking rule recategorization. This sounds like an <code>error</code> or <code>correctness</code> category, which is how I think we'll handle this eventually.</p>
<p>There's also https://github.com/astral-sh/ruff/issues/11415, another related issue about default categories. This is definitely on our radar, but it's a big project and we want to be careful to get it right.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @ntBre on 2025-08-12 21:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-08-13 06:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-13 06:43</div>
            <div class="timeline-body"><p>As @ntBre said, this is on our mind, but there's no easy way to select error-only rules right now. However, Ruff's default rules is intentionally unopinionated. That's probably a good start for the notebook case.</p>
<p>But you'll still need different configuratinos to enable the stricter checking for the non notebook cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ctcjab">@ctcjab</a> on 2025-08-13 14:51</div>
            <div class="timeline-body"><p>Thanks for the info and great to hear you're thinking about this already!</p>
<blockquote>
<p>Ruff's default rules is intentionally unopinionated. That's probably a good start for the notebook case.</p>
</blockquote>
<p>So far my anecdata suggests otherwise (for whatever it's worth). If anything, ruff's default rules seem too strict for the notebook use case:</p>
<p>I ran <code>ruff check</code> with no custom configuration on a small subset of our monorepo, and all the issues it caught would be considered annoyingly opinionated and too unimportant to prioritize by these users:</p>
<p>| Issue                                                                              | Occurrence Count |
|------------------------------------------------------------------------------------|------------------|
| F401 imported but unused                                                           | 38               |
| E402 Module level import not at top of file                                        | 28               |
| I001 Import block is un-sorted or un-formatted                                     | 27               |
| F811 Redefinition of unused ... from line ...                                      | 11               |
| E722 Do not use bare <code>except</code>                                                      | 6                |
| F841 Local variable ... is assigned to but never used                              | 5                |
| E711 Comparison to <code>None</code> should be <code>cond is None</code>                                 | 1                |
| E712 Avoid equality comparisons to <code>True</code>; use <code>x:</code> for truth checks               | 1                |
| E721 Use <code>is</code> and <code>is not</code> for type comparisons, or <code>isinstance()</code> for checks      | 1                |
| F403 <code>from ... import *</code> used; unable to detect undefined names                    | 1                |</p>
<p>By contrast, running <code>pylint --errors-only</code> with no custom config on the same code is much closer to something these users would put up with (only one false positive that I'd have to account for in custom config, and only one issue that might annoy these users):</p>
<ul>
<li>E0611: No name 'display' in module 'IPython.core.display' (no-name-in-module) -- false positive, if this had been caught by ruff would it eventually be addressed by #8800?</li>
<li>E1111: Assigning result of a function call, where the function has no return (assignment-from-no-return) -- user assigned the result to a variable out of habit, but then never referred to it again anyway, would consider this &quot;harmless&quot;</li>
</ul>
<p>Hope this provides some additional helpful context!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-13 15:18</div>
            <div class="timeline-body"><p>Ah thank you! I think some of these rules would be suppressed in a regular notebook, so the Jupytext issue is very relevant. In particular, E402 is modified to check &quot;import not at top of cell,&quot; and I'm not seeing any F841 errors in a notebook. F401 still seems to be enforced, though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ctcjab">@ctcjab</a> on 2025-08-13 19:03</div>
            <div class="timeline-body"><blockquote>
<p>E402 is modified to check &quot;import not at top of cell,&quot; and I'm not seeing any F841 errors in a notebook. F401 still seems to be enforced, though.</p>
</blockquote>
<p>Thanks for checking this, very interesting! So ruff implicitly changes rule selection and behavior based on the .ipynb vs. .py file extension? And #8800 would bring the behavior for jupytext .py notebooks in line with with the behavior for .ipynb files?</p>
<p>FWIW, most of these users would probably find even the weaker variants of the style-related rules undesired (e.g. the modified E402 to check &quot;import not at top of cell&quot; rather than &quot;top of file&quot;). But happily ruff already supports hierarchical configuration, so even if we had a <code>ruff.toml</code> at the monorepo root that set some new <code>errors-only = true</code> setting, any more linter-positive teams could override that with their own <code>ruff.toml</code>s in their subdirectories.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-13 21:35</div>
            <div class="timeline-body"><p>Sorry, I confused myself slightly with F841. I always forget that it only applies to function-scoped variables, but I was testing in a top-level notebook cell. But yes, the E402 behavior in notebooks is <a href="https://docs.astral.sh/ruff/rules/module-import-not-at-top-of-file/#notebook-behavior">documented</a> at least, so some rules (at least one!) do differ for notebooks.</p>
<p>I understand what you mean, though. I suspected that top-of-cell wouldn't fully help anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-11-06 13:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ctcjab">@ctcjab</a> on 2025-11-06 17:05</div>
            <div class="timeline-body"><p>Was this marked completed by accident? I checked recent release notes and linked tickets and didn't see any associated progress.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-11-10 14:26</div>
            <div class="timeline-body"><p>It might have been closed because we don't have immediate plans to work on this besides by introducing new rule categories and improving our default rule selection, but @MichaReiser may be able to confirm.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-10 15:19</div>
            <div class="timeline-body"><p>I closed it because I considere the question to be answered and the &quot;solution&quot; is rule categorization, which we track separately</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
