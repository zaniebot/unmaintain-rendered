<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F401 false positive when import is used in stringified generic subscript - astral-sh/ruff #10676</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>F401 false positive when import is used in stringified generic subscript</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10676">#10676</a>
        opened by <a href="https://github.com/sterliakov">@sterliakov</a>
        on 2024-03-30 22:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sterliakov">@sterliakov</a></div>
            <div class="timeline-body">

<p>Keywords: <code>F401</code>, &quot;unused import&quot;, &quot;generics&quot;
This closely resembles #9121</p>
Reproducer:
<pre><code>from typing import TYPE_CHECKING, Generic, TypeVar
    
if TYPE_CHECKING:
    from uuid import UUID

_T = TypeVar(&#x27;_T&#x27;)

class Base(Generic[_T]): ...
class Derived(Base[&quot;UUID&quot;]): ...
</code></pre>
<p>Output:</p>
<pre><code>$ ruff check --isolated a.py
a.py:4:22: F401 [*] `uuid.UUID` imported but unused
Found 1 error.
[*] 1 fixable with the `--fix` option.
</code></pre>
Configiration
<p>Ruff settings: reproduces without <code>pyproject.toml</code> on default settings.
Ruff version: <code>0.3.4</code> installed from PyPI</p>
Notes
<p>Autofixer removes this import, obviously causing <code>mypy</code> error (<code>name &quot;UUID&quot; is not defined [name-defined]</code>) later.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-30 22:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">linter</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-30 22:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-30 23:12</div>
            <div class="timeline-body"><p>We don&#x27;t currently have any logic to infer whether an arbitrary subscript operations is a generics, but we expose an <code>extend-generics</code> setting that you can use to tell Ruff to treat <code>Base</code> as such.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sterliakov">@sterliakov</a> on 2024-03-30 23:38</div>
            <div class="timeline-body"><p>Ough, sorry, this ticket is anyway a duplicate of #9298, I&#x27;ll post my further suggestion there instead and close this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sterliakov">@sterliakov</a> on 2024-03-30 23:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:52 UTC
    </footer>
</body>
</html>
