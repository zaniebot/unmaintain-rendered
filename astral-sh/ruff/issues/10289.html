<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>error: Chinese characters in .ipynb cause an error - astral-sh/ruff #10289</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>error: Chinese characters in .ipynb cause an error</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/10289">#10289</a>
        opened by <a href="https://github.com/zhuxining">@zhuxining</a>
        on 2024-03-08 03:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zhuxining">@zhuxining</a> on 2024-03-08 03:04</div>
            <div class="timeline-body"><ul>
<li>A minimal code snippet that reproduces the bug.</li>
</ul>
<pre><code>df_dict_org = pd.read_excel(
    &quot;字典/dict-机构编码.xlsx&quot;, 
    index_col=None,
    na_values=[&quot;NA&quot;],
    dtype=str,
).dropna(how=&quot;all&quot;)

</code></pre>
<ul>
<li>The command you invoked (e.g., <code>ruff /path/to/file.py --fix</code>), ideally including the <code>--isolated</code> flag.</li>
</ul>
<pre><code>panicked at /rustc/a28077b28a02b92985b3a3faecf92813155f1ea1/library/core/src/str/mod.rs:660:13:
byte index 2 is not a char boundary; it is inside '字' (bytes 1..4) of `&quot;字典/dict-机构编码.xlsx&quot;,`
Backtrace:    0: _rust_eh_personality
   1: _main
   2: _rust_eh_personality
   3: _rust_eh_personality
   4: _rust_eh_personality
   5: _rust_eh_personality
   6: __rjem_je_witnesses_cleanup
   7: _main
   8: __rjem_je_witnesses_cleanup
   9: _main
  10: _main
  11: _main
  12: _main
  13: _main
  14: _main
  15: _main
  16: _main
  17: __mh_execute_header
  18: __mh_execute_header
  19: _main

</code></pre>
<ul>
<li>The current Ruff settings (any relevant sections from your <code>pyproject.toml</code>).</li>
</ul>
<pre><code>[project]
name = &quot;playground&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
dependencies = [
    &quot;pandas&gt;=2.2.1&quot;,
    &quot;openpyxl&gt;=3.1.2&quot;,
    &quot;charset_normalizer&gt;=3.3.2&quot;,
    &quot;polars&gt;=0.20.11&quot;,
]
readme = &quot;README.md&quot;
requires-python = &quot;&gt;= 3.12&quot;

[project.scripts]
hello = &quot;playground:hello&quot;

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;

[tool.rye]
managed = true
dev-dependencies = [&quot;ipykernel&gt;=6.29.3&quot;, &quot;pyarrow&gt;=15.0.1&quot;]

[tool.hatch.metadata]
allow-direct-references = true

[tool.hatch.build.targets.wheel]
packages = [&quot;src/playground&quot;]

</code></pre>
<ul>
<li>The current Ruff version (<code>ruff --version</code>).</li>
</ul>
<pre><code>ruff 0.1.8
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-03-08 03:14</div>
            <div class="timeline-body"><p>Hey, thanks for providing all the details for the issue you're facing. This was fixed in <code>v0.1.9</code> with https://github.com/astral-sh/ruff/pull/9146.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-03-08 03:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-03-08 03:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:52 UTC
    </footer>
</body>
</html>
