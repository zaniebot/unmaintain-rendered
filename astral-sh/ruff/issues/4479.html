<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request: adding dlint - astral-sh/ruff #4479</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Request: adding dlint</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4479">#4479</a>
        opened by <a href="https://github.com/AbdealiLoKo">@AbdealiLoKo</a>
        on 2023-05-17 20:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AbdealiLoKo">@AbdealiLoKo</a> on 2023-05-17 20:45</div>
            <div class="timeline-body"><p>I use dlint in my project.
Supporting the rules from dlint - https://github.com/dlint-py/dlint would be great</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Support for dlint" to "Request: adding dlint" by @AbdealiLoKo on 2023-05-17 20:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4482.html">astral-sh/ruff#4482</a> on 2023-05-17 22:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-05-17 22:15</div>
            <div class="timeline-body"><p>Started on this and listed the rules to port. Will give it a go as I find time. Most of the rules seem easy enough, some are no longer relevant in Python 3 and can't be ported. Will see how far I get</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2023-05-18 00:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-05-20 16:43</div>
            <div class="timeline-body"><p>The following rules are covered in https://github.com/charliermarsh/ruff/pull/4482 which is ready for final review:</p>
<ul>
<li>[x] DUO119: BadShelveUse (Renamed to ShelveUse in Ruff)</li>
<li>[x] DUO120: BadMarshalUse (Renamed to MarshalUse in Ruff)</li>
<li>[x] DUO104: BadEvalUse (Renamed to EvalUse in Ruff)</li>
<li>[x] DUO105: BadExecUse (Renamed to ExecUse in Ruff)</li>
<li>[x] DUO110: BadCompileUse (Renamed to CompileUse in Ruff)</li>
</ul>
<p>Left TODO are:</p>
<ul>
<li>[ ] DUO102: BadRandomGeneratorUse</li>
<li>[ ] DUO103: BadPickleUse</li>
<li>[ ] DUO106: BadOsUse</li>
<li>[ ] DUO107: BadXmlUse</li>
<li>[ ] DUO108: BadInputUse</li>
<li>[ ] DUO109: BadYamlUse</li>
<li>[ ] DUO111: BadSysUse</li>
<li>[ ] DUO112: BadZipfileUse</li>
<li>[ ] DUO115: BadTarfileUse</li>
<li>[ ] DUO116: BadSubprocessUse</li>
<li>[ ] DUO121: BadTempfileUse</li>
<li>[ ] DUO122: BadSslModuleAttributeUse</li>
<li>[ ] DUO123: BadRequestsUse</li>
<li>[ ] DUO124: BadXmlrpcUse</li>
<li>[ ] DUO127: BadDuoClientUse</li>
<li>[ ] DUO128: BadOneLoginKwargUse</li>
<li>[ ] DUO129: BadOneLoginModuleAttributeUse</li>
<li>[ ] DUO130: BadHashLibUse</li>
<li>[ ] DUO131: BadUrllib3ModuleAttributeUse</li>
<li>[ ] DUO132: BadCryptographyModel</li>
<li>[ ] DUO132: BadUrllibKwargUse</li>
<li>[ ] DUO133: BadPycryptoUse</li>
<li>[ ] DUO135: BadDefusedXmlUse</li>
<li>[ ] DUO136: BadXmlsecModuleAttributeUse</li>
<li>[ ] DUO137: BadItsDangerousKwargUse</li>
<li>[ ] DUO138: BadReCatastrophicUse</li>
</ul>
<p>I will continue in small batches right after the first PR is merged, but these TODOs can then easily be split among multiple interested contributors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-22 14:33</div>
            <div class="timeline-body"><p>Hmm, it looks like many of these are implemented in Bandit (and in Ruff's Bandit reimplementation). I think it's worth auditing the list to understand which of these should be considered aliases of existing rules before implementing any further diagnostics.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-05-22 14:58</div>
            <div class="timeline-body"><p>Good call, will cease further work until then. @AbdealiLoKo do you maybe have a list of rules that you use in DLint that aren't covered by other plugins already in Ruff?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AbdealiLoKo">@AbdealiLoKo</a> on 2023-05-24 08:47</div>
            <div class="timeline-body"><p>I haven't compared them myself.
We do use both bandit and dlint in our application and we seem to just run both (even if there are similar rules)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bastimeyer">@bastimeyer</a> on 2023-07-04 19:04</div>
            <div class="timeline-body"><blockquote>
<ul>
<li>DUO138: BadReCatastrophicUse</li>
</ul>
</blockquote>
<p>https://github.com/dlint-py/dlint/blob/master/docs/linters/DUO138.md</p>
<p>This one is particularly interesting. Does ruff implement similar rules for checking regular expressions which are vulnerable to ReDoS attacks? <a href="https://github.com/search?q=repo%3Aastral-sh%2Fruff%20ReDoS">I couldn't find anything</a>, unless I'm blind. Having such rules is pretty important considering that it's not just about code quality but actually about critical bugs.</p>
<p>DUO138 implementation:</p>
<ul>
<li>https://github.com/dlint-py/dlint/blob/307b301cd9e280dcd7a7f9d5edfda3d58e4855f5/dlint/linters/bad_re_catastrophic_use.py#L69</li>
<li>https://github.com/dlint-py/dlint/tree/307b301cd9e280dcd7a7f9d5edfda3d58e4855f5/dlint/redos</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-07-06 16:57</div>
            <div class="timeline-body"><p>Yeah I can't find anything like that yet either. I'll see if I can find some time to make that the first DLint rule and can audit the rest of the list after.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5614.html">astral-sh/ruff#5614</a> on 2023-07-08 14:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-07-08 21:40</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<ul>
<li>DUO138: BadReCatastrophicUse</li>
</ul>
</blockquote>
<p>https://github.com/dlint-py/dlint/blob/master/docs/linters/DUO138.md</p>
<p>This one is particularly interesting. Does ruff implement similar rules for checking regular expressions which are vulnerable to ReDoS attacks? <a href="https://github.com/search?q=repo%3Aastral-sh%2Fruff%20ReDoS">I couldn't find anything</a>, unless I'm blind. Having such rules is pretty important considering that it's not just about code quality but actually about critical bugs.</p>
<p>DUO138 implementation:</p>
<pre><code>* https://github.com/dlint-py/dlint/blob/307b301cd9e280dcd7a7f9d5edfda3d58e4855f5/dlint/linters/bad_re_catastrophic_use.py#L69

* https://github.com/dlint-py/dlint/tree/307b301cd9e280dcd7a7f9d5edfda3d58e4855f5/dlint/redos</code></pre>
</blockquote>
<p>I've opened a <a href="https://github.com/astral-sh/ruff/pull/5614">draft PR</a> which adds the <code>regex_syntax</code> crate and all the boilerplate. Actually adding the logic/check will be a bit more difficult. <code>dlint</code> relies on <code>sre_parser</code> and builds an OP tree around that. In Rust, if we don't want to build a regex parser from the ground up, we have to rely on <code>regex_syntax</code> as far as I can tell which uses a different representation for parsed regex strings. In order to cover the same ground as <code>dlint</code> I will have to more thoroughly understand when catastrophic backtracking can happen and then build similar checks using the representation provided by the crate. Unsure how far I'll get, PR is open so any feedback/input/help is welcomed.</p>
<p>EDIT: Closed the PR for now. I think we need an overall plan for how to handle Python regex in Ruff before I can make sensible choices on what to do with the particulars of this specific rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-10 01:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/khanfarhan10">@khanfarhan10</a> on 2024-04-09 21:28</div>
            <div class="timeline-body"><p>The ReDoS attack is a notorious bug and I've faced this attack myself rather unexplicably.</p>
<p>Can we not add this plugin as an additional and optional dependency to ruff and call <code>dlint</code> via a subprocess equivalent to Ruff.</p>
<p>I understand that this may slow down ruff altogether again, but it shall be a user opted dependency and won't be installed for everyone.</p>
<p>I wonder if we could implement something like this for now and move ahead with migrating the python code to RUST gradually in phases?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/khanfarhan10">@khanfarhan10</a> on 2024-04-09 21:31</div>
            <div class="timeline-body"><p>@charliermarsh @qdegraaf please convey your thoughts if we are going to add this to Ruff.</p>
<p>P. S. - would contribute myself, but my rust knowledgebase is NIL.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-04-09 22:18</div>
            <div class="timeline-body"><p>It's not feasible for us to add Python tools as dependencies and call into them â€” we are very unlikely to do so. Not only is it slow, but each has an entirely different diagnostic system than us. I don't think doing so would meet our bar for user experience.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:07 UTC
    </footer>
</body>
</html>
