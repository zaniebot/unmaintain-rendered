<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lack of a --force-include setting to gradually introduce ruff into matured codebase - astral-sh/ruff #11878</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Lack of a --force-include setting to gradually introduce ruff into matured codebase</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/11878">#11878</a>
        opened by <a href="https://github.com/cam-laf">@cam-laf</a>
        on 2024-06-14 16:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/cam-laf">@cam-laf</a></div>
            <div class="timeline-body"><p>I want to gradually introduce files under checking for ruff check. I'm using pre-commit with ruff. I work on a large repository (in the thousdands of python files) and I cannot reasonably include <code> # noqa</code> at the top of each of those files. What I want is to have the <code>include</code> setting be the single source of truth of which files would be run under ruff. Since ruff's pre-commit passes all files changed in a commit to ruff, it means that the include setting is ignored. Although ruff's pre-commit uses <code>--force-exclude</code>, I'd have to <code>exclude</code> <em>every</em> single path that I'm not currently wanting to check. I want to be able to &quot;opt-in&quot; by file to using ruff. Honestly I think that the lack of this feature probably prevents many matured python codebases from using ruff. The only option that I've come up with is creating my own pre-commit script which would pass my own include list to <code>ruff</code>. Is there any better way to do what I want here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-15 08:14</div>
            <div class="timeline-body"><p>I'm not a pre-commit user myself but could pre-commit's <a href="https://pre-commit.com/#hooks-files"><code>files</code></a> option be what you're looking for? I think it should allow you to only run Ruff on a specific set of files instead of all files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2024-06-15 08:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cam-laf">@cam-laf</a> on 2024-06-21 15:05</div>
            <div class="timeline-body"><blockquote>
<p>I'm not a pre-commit user myself but could pre-commit's <a href="https://pre-commit.com/#hooks-files"><code>files</code></a> option be what you're looking for? I think it should allow you to only run Ruff on a specific set of files instead of all files.</p>
</blockquote>
<p>@MichaReiser It's possible but not sane for what I want to do as I would have to insert a hefty regex for every single file/directory that I want to include. I.e. I cannot just do the simple</p>
<pre><code class="language-yaml">files: |
[ 
   &quot;path/to/file.py&quot;,
   &quot;path/to/dir/&quot;,
   &quot;file.py&quot;
]
</code></pre>
<p>nor can I do</p>
<pre><code class="language-yaml">files: |
&quot; path/to/file.py,
  path/to/dir/,
  file.py,
&quot;
</code></pre>
<p>I'd have to do something like</p>
<pre><code class="language-yaml">files: | 
&quot;
(^path/to/file\.py$)|
(^my/dir/)
&quot;
</code></pre>
<p>Given the size of my repository, roughly ~3000 python files, I'm expecting to need this --include behavior until I get to a very sizable percentage of ~3000, especially uniformly across certain file directories. Now that's not so bad for 2 paths, but look what it's like with nearly two dozen:</p>
<pre><code class="language-yaml">         files: |
          (^path/to/file\.py$)|
          (^my/dir/)|
          (^random/path1/file1\.py$)|
          (^random/path2/file2\.py$)|
          (^random/path3/subdir1/file3\.py$)|
          (^random/path4/file4\.py$)|
          (^random/path5/subdir2/file5\.py$)|
          (^random/path6/file6\.py$)|
          (^random/path7/subdir3/subsubdir1/file7\.py$)|
          (^random/path8/file8\.py$)|
          (^random/path9/subdir4/file9\.py$)|
          (^random/path10/file10\.py$)|
          (^random/path11/subdir5/file11\.py$)|
          (^random/path12/file12\.py$)|
          (^random/path13/subdir6/file13\.py$)|
          (^random/path14/file14\.py$)|
          (^random/path15/subdir7/subsubdir2/file15\.py$)|
          (^random/path16/file16\.py$)|
          (^random/path17/subdir8/file17\.py$)|
          (^random/path18/file18\.py$)|
          (^random/path19/subdir9/file19\.py$)|
          (^random/path20/file20\.py$)|
          (^random/path21/subdir10/file21\.py$)|
          (^random/path22/file22\.py$)
</code></pre>
<p>This is not nearly as manageable IMO as having</p>
<pre><code class="language-toml">include = [
    &quot;path/to/file.py&quot;,
    &quot;my/dir/&quot;,
    &quot;random/path1/file1.py&quot;,
    &quot;random/path2/file2.py&quot;,
    &quot;random/path3/subdir1/file3.py&quot;,
    &quot;random/path4/file4.py&quot;,
    &quot;random/path5/subdir2/file5.py&quot;,
    &quot;random/path6/file6.py&quot;,
    &quot;random/path7/subdir3/subsubdir1/file7.py&quot;,
    &quot;random/path8/file8.py&quot;,
    &quot;random/path9/subdir4/file9.py&quot;,
    &quot;random/path10/file10.py&quot;,
    &quot;random/path11/subdir5/file11.py&quot;,
    &quot;random/path12/file12.py&quot;,
    &quot;random/path13/subdir6/file13.py&quot;,
    &quot;random/path14/file14.py&quot;,
    &quot;random/path15/subdir7/subsubdir2/file15.py&quot;,
    &quot;random/path16/file16.py&quot;,
    &quot;random/path17/subdir8/file17.py&quot;,
    &quot;random/path18/file18.py&quot;,
    &quot;random/path19/subdir9/file19.py&quot;,
    &quot;random/path20/file20.py&quot;,
    &quot;random/path21/subdir10/file21.py&quot;,
    &quot;random/path22/file22.py&quot;
]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-21 15:48</div>
            <div class="timeline-body"><p>I agree that the regex syntax is less readable, maybe something worth bringing up in the pre-commit repository? Otherwise, the configuration looks very similar to me.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:50:27 UTC
    </footer>
</body>
</html>
