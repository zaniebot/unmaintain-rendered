<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autofix for `I001` unexpectedly altering characters from Unicode Block ‚ÄúLetterlike Symbols‚Äù - astral-sh/ruff #10528</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Autofix for <code>I001</code> unexpectedly altering characters from Unicode Block ‚ÄúLetterlike Symbols‚Äù</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10528">#10528</a>
        opened by <a href="https://github.com/namurphy">@namurphy</a>
        on 2024-03-22 18:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/namurphy">@namurphy</a></div>
            <div class="timeline-body"><p>With ruff 0.3.4, I ran into unexpected behavior where the autofix for ruff rule <a href="https://docs.astral.sh/ruff/rules/unsorted-imports/"><code>I001</code></a> is now altering some characters from <a href="https://www.compart.com/en/unicode/block/U+2100">Unicode Block ‚ÄúLetterlike Symbols‚Äù (U+2100)</a>. I suspect that this is related to #10412. ü§î This might not be the only Unicode block that is affected by this.</p>
<p>For example, <a href="https://www.compart.com/en/unicode/U+210F"><code>‚Ñè</code></a> (U+210F; which represents Planck's constant over $2œÄ$) is changed to <a href="https://www.compart.com/en/unicode/U+0127"><code>ƒß</code></a> (U+0127; Latin Small Letter H with Stroke). To reproduce this, I created a file called <code>hbar.py</code> that contains:</p>
<pre><code class="language-python">from astropy.constants import hbar as ‚Ñè
from numpy import pi as œÄ

h = 2 * œÄ * ‚Ñè
</code></pre>
<p>After I ran:</p>
<pre><code class="language-console">ruff check hbar.py  --select=I001 --fix
</code></pre>
<p>I did a <code>git diff</code> and got this:</p>
<pre><code>@@ -1,4 +1,4 @@
-from astropy.constants import hbar as ‚Ñè
+from astropy.constants import hbar as ƒß
 from numpy import pi as œÄ
</code></pre>
<p>Similarly, if I apply <code>I001</code> to a file containing a bunch of characters from that block:</p>
<pre><code class="language-python">import numpy as ‚ÑÇ‚Ñá‚Ñä‚Ñã‚Ñå‚Ñç‚Ñé‚Ñê‚Ñë‚Ñí‚Ñì‚Ñï‚Ñ§‚Ñ¶‚Ñ®‚Ñ™‚Ñ´‚Ñ¨‚Ñ≠‚ÑØ‚Ñ∞‚Ñ±‚Ñπ‚Ñ¥
</code></pre>
<p>then the diff is</p>
<pre><code>@@ -1 +1 @@
-import numpy as ‚ÑÇ‚Ñá‚Ñä‚Ñã‚Ñå‚Ñç‚Ñé‚Ñê‚Ñë‚Ñí‚Ñì‚Ñï‚Ñ§‚Ñ¶‚Ñ®‚Ñ™‚Ñ´‚Ñ¨‚Ñ≠‚ÑØ‚Ñ∞‚Ñ±‚Ñπ‚Ñ¥
+import numpy as C∆êgHHHhIILlNZŒ©ZK√ÖBCeEFio
</code></pre>
<p>My expectation was for ruff to not change variable names that are valid Python names, except for rules that are designed specifically to make these changes (e.g., <code>RUF001</code>, <code>RUF002</code>, <code>RUF003</code>).</p>
<p>Thank you again for creating a wonderful tool!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-03-22 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-22 18:39</div>
            <div class="timeline-body"><p>Thanks for the clear write-up!</p>
<p>cc @AlexWaygood</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-22 18:39</div>
            <div class="timeline-body"><p>I can take if you're off for the day, Alex, up to you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-22 18:42</div>
            <div class="timeline-body"><blockquote>
<p>I can take if you're off for the day, Alex, up to you.</p>
</blockquote>
<p>Yes please, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-03-22 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/namurphy">@namurphy</a> on 2024-03-22 18:47</div>
            <div class="timeline-body"><p>Thank you for the quick response, and for respecting work-life balance!  Admittedly the affected users may be limited to physicists who spend too much of their time looking up Unicode tables, so it's not too urgent.</p>
<p>Also I should clarify that <code>‚ÑÇ‚Ñá‚Ñä‚Ñã‚Ñå‚Ñç‚Ñé‚Ñê‚Ñë‚Ñí‚Ñì‚Ñï‚Ñ§‚Ñ¶‚Ñ®‚Ñ™‚Ñ´‚Ñ¨‚Ñ≠‚ÑØ‚Ñ∞‚Ñ±‚Ñπ‚Ñ¥</code> runs ever-so-slightly counter to my usual advice for naming things.  üôÉ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-22 18:50</div>
            <div class="timeline-body"><p>No prob, I like fixing stuff like this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-22 19:15</div>
            <div class="timeline-body"><p>Is there a scientific repository we can add to the ecosystem checks that would catch this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-22 19:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/namurphy">@namurphy</a> on 2024-03-22 19:52</div>
            <div class="timeline-body"><p>Thank you for the amazingly quick bugfix!  I'm starting to understand better the difficulties of dealing with Unicode edge cases...</p>
<blockquote>
<p>Is there a scientific repository we can add to the ecosystem checks that would catch this?</p>
</blockquote>
<p>I found it in <a href="https://github.com/PlasmaPy/PlasmaPy">PlasmaPy</a> in our <a href="https://github.com/PlasmaPy/PlasmaPy/blob/main/docs/notebooks/formulary/coulomb.ipynb">notebook on Coulomb logarithms</a>, using nbqa-ruff.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:55 UTC
    </footer>
</body>
</html>
