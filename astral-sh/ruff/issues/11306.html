<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff removes valid noqa blocks - astral-sh/ruff #11306</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff removes valid noqa blocks</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/11306">#11306</a>
        opened by <a href="https://github.com/sandeshhardikar">@sandeshhardikar</a>
        on 2024-05-06 10:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sandeshhardikar">@sandeshhardikar</a></div>
            <div class="timeline-body"><p>Hello ,</p>
<p>I am working my way to replace <code>yesqa</code> with <code>ruff</code> . When i run <code>ruff</code> on a sample python code , I have a feeling it removes all the <code># noqa</code> blocks , even the valid ones .</p>
<ul>
<li>ruff version used : 0.4.3</li>
<li>code block</li>
<li><code>print(&quot;uuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuuu&quot;)  # noqa: E501</code></li>
<li>command used : <code>ruff check --select RUF100 test.py --fix</code></li>
<li>Output :  <code>Found 1 error (1 fixed, 0 remaining).</code></li>
</ul>
<p>Ideally there should be nothing to fix , as the line length exceeds , but <code>ruff</code> removes the <code># noqa</code> block . Please let me know if i am not using this functionality in a intended manner</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-06 10:42</div>
            <div class="timeline-body"><p>The noqa suppression here is not necessary because Ruff doesn't flag any lines that contain no whitespace, because it often indicates that there are no good split points for that line.</p>
<blockquote>
<p>Ignores lines that consist of a single &quot;word&quot; (i.e., without any whitespace between its characters). <a href="https://docs.astral.sh/ruff/rules/line-too-long/#why-is-this-bad">source</a></p>
</blockquote>
<p>I see the argument here that the line could be split after the <code>(</code>. I think that's something we can start doing once we have a way to cheaply get access to the parsed tokens (CC: @dhruvmanila)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-05-06 10:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sandeshhardikar">@sandeshhardikar</a> on 2024-05-06 12:14</div>
            <div class="timeline-body"><p>Thanks for the quick reply @MichaReiser</p>
<p>I have a use case where <code>ruff</code> flags line too ling and it <code>suppresses</code> the <code>noqa</code> as well</p>
<h3>code snippet test.py</h3>
<pre><code>def my_function(parameter1, parameter2, parameter3, parameter4, parameter5, parameter6):
    result = parameter1 * (parameter2 + parameter3) - parameter4 / parameter5 + parameter6  # noqa: E501
    return result
</code></pre>
<p>Run <code>ruff check test.py --select RUF100 --fix</code> and get the new code snippet without <code># noqa: E501</code></p>
<p>now run <code>ruff check test.py --select E</code>
test.py:2:89: E501 Line too long (90 &gt; 88)
Found 1 error.
It complains of line too long at the place where <code># noqa: E501</code> was removed by <code>--fix</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-06 13:16</div>
            <div class="timeline-body"><p>Ruff removes the <code>E501</code> violation when running it with <code>ruff check test.pyâ€”-select RUF100 --fix</code> because the rule <code>E501</code> isn't enabled. However, the suppression of the <code>E501</code> isn't needed when the rule isn't enabled.</p>
<p>I recommend you to run <code>--fix</code> with all enabled rules rather than selecting individual rules. You can use <a href="https://docs.astral.sh/ruff/settings/#lint_external"><code>external</code></a> if you want to prevent Ruff from removing noqa comments for rules it doesn't support.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @dhruvmanila on 2024-05-07 09:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:50:13 UTC
    </footer>
</body>
</html>
