<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warn about `dict.fromkeys(keys, mutable)` - astral-sh/ruff #4613</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Warn about <code>dict.fromkeys(keys, mutable)</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4613">#4613</a>
        opened by <a href="https://github.com/janosh">@janosh</a>
        on 2023-05-23 21:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/janosh">@janosh</a></div>
            <div class="timeline-body"><p><code>ruff</code> should error and suggest the following fix when passing a mutable 2nd arg to <code>dict.fromkeys()</code> since modifications will affect all keys which is a common pitfall.</p>
<pre><code class="language-py"># bad
dict.fromkeys((1, 2), {})
dict.fromkeys((1, 2), [])
dict.fromkeys((1, 2), set())
# ...

# good
{key: {} for key in (1, 2)}
{key: [] for key in (1, 2)}
{key: set() for key in (1, 2)}
</code></pre>
<p>Examples:</p>
<ul>
<li><a href="https://stackoverflow.com/q/11509721">StackoverFlow</a></li>
<li><a href="https://stackoverflow.com/q/8174723">SO 2</a></li>
<li><a href="https://github.com/CederGroupHub/chgnet/commit/c8ba05443280c280f904a7076f4635d3326bac66#diff-a7bc3c3838885a61fa9d82f50027518237bf263cbbcd33781f1176b7031f1275R184-R186">commit</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-05-24 02:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-24 02:07</div>
            <div class="timeline-body"><p>Oh interesting, I've never seen that!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Error on `dict.fromkeys(keys, mutable)`" to "Warn about `dict.fromkeys(keys, mutable)`" by @janosh on 2023-05-24 19:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2023-05-28 14:58</div>
            <div class="timeline-body"><p>Flake8-bugbear might be interested in adding this rule too, you should open an issue there as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-10 01:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @charliermarsh on 2024-01-20 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @charliermarsh on 2024-01-20 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-20 15:35</div>
            <div class="timeline-body"><p>Marking as accepted, makes sense to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-01-20 20:30</div>
            <div class="timeline-body"><p>I'll implement this tomorrow (as a precursor to #9592)!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-22 00:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:16 UTC
    </footer>
</body>
</html>
