<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using global config is impacting the behaviour of the tests - astral-sh/ruff #2304</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using global config is impacting the behaviour of the tests</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2304">#2304</a>
        opened by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a>
        on 2023-01-28 17:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JonathanPlasse">@JonathanPlasse</a></div>
            <div class="timeline-body"><p>When running the tests with this as global config.</p>
<pre><code class="language-toml"># /home/jonathan/.config/ruff/ruff.toml
# https://github.com/charliermarsh/ruff#reference
target-version = &quot;py37&quot;
select = [&quot;ALL&quot;]
ignore = [
    &quot;ANN101&quot;, # missing-type-self
    &quot;ANN102&quot;, # missing-type-cls
    &quot;ANN401&quot;, # dynamically-typed-expression
    &quot;D10&quot;,    # missing-docstring
    &quot;DTZ003&quot;, # call-datetime-utcnow
    &quot;E501&quot;,   # line-too-long
]
unfixable = [
    &quot;ERA001&quot;, # commented-out-code
    &quot;F401&quot;,   # unused-import
    &quot;F841&quot;,   # unused-variable
    &quot;T20&quot;,    # print-found
]

[flake8-bugbear] # https://github.com/charliermarsh/ruff#flake8-bugbear
extend-immutable-calls = [&quot;fastapi.Body&quot;, &quot;fastapi.Depends&quot;]

[flake8-builtins] # https://github.com/charliermarsh/ruff#flake8-builtins
builtins-ignorelist = []

[flake8-pytest-style] # https://github.com/charliermarsh/ruff#flake8-pytest-style-pt
fixture-parentheses = false
mark-parentheses = false
parametrize-names-type = &quot;csv&quot;

[isort]
known-third-party = []

[pep8-naming] # https://github.com/charliermarsh/ruff#pep8-naming
classmethod-decorators = [
    &quot;classmethod&quot;,
    &quot;pydantic.validator&quot;,
    &quot;sqlalchemy.orm.declared_attr&quot;,
]

[pydocstyle] # https://github.com/charliermarsh/ruff#pydocstyle
convention = &quot;pep257&quot;
</code></pre>
<p>Running <code>cargo test --all</code> fails with this error messages</p>
<pre><code class="language-console">---- test_stdin_filename stdout ----
thread 'test_stdin_filename' panicked at 'assertion failed: `(left == right)`
  left: `&quot;F401.py:1:1: INP001 File `F401.py` is part of an implicit namespace package. Add an `__init__.py`.\nF401.py:1:8: F401 `os` imported but unused\nFound 2 errors.\n1 potentially fixable with the --fix option.\n&quot;`,
 right: `&quot;F401.py:1:8: F401 `os` imported but unused\nFound 1 error.\n1 potentially fixable with the --fix option.\n&quot;`', ruff_cli/tests/integration_test.rs:48:5
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

---- test_stdin_json stdout ----
thread 'test_stdin_json' panicked at 'assertion failed: `(left == right)`
  left: `&quot;[\n  {\n    \&quot;code\&quot;: \&quot;INP001\&quot;,\n    \&quot;message\&quot;: \&quot;File `F401.py` is part of an implicit namespace package. Add an `__init__.py`.\&quot;,\n    \&quot;fix\&quot;: null,\n    \&quot;location\&quot;: {\n      \&quot;row\&quot;: 1,\n      \&quot;column\&quot;: 1\n    },\n    \&quot;end_location\&quot;: {\n      \&quot;row\&quot;: 1,\n      \&quot;column\&quot;: 1\n    },\n    \&quot;filename\&quot;: \&quot;/home/jonathan/Documents/github/ruff/ruff_cli/F401.py\&quot;\n  },\n  {\n    \&quot;code\&quot;: \&quot;F401\&quot;,\n    \&quot;message\&quot;: \&quot;`os` imported but unused\&quot;,\n    \&quot;fix\&quot;: null,\n    \&quot;location\&quot;: {\n      \&quot;row\&quot;: 1,\n      \&quot;column\&quot;: 8\n    },\n    \&quot;end_location\&quot;: {\n      \&quot;row\&quot;: 1,\n      \&quot;column\&quot;: 10\n    },\n    \&quot;filename\&quot;: \&quot;/home/jonathan/Documents/github/ruff/ruff_cli/F401.py\&quot;\n  }\n]\n&quot;`,
 right: `&quot;[\n  {\n    \&quot;code\&quot;: \&quot;F401\&quot;,\n    \&quot;message\&quot;: \&quot;`os` imported but unused\&quot;,\n    \&quot;fix\&quot;: {\n      \&quot;content\&quot;: \&quot;\&quot;,\n      \&quot;message\&quot;: \&quot;Remove unused import: `os`\&quot;,\n      \&quot;location\&quot;: {\n        \&quot;row\&quot;: 1,\n        \&quot;column\&quot;: 0\n      },\n      \&quot;end_location\&quot;: {\n        \&quot;row\&quot;: 2,\n        \&quot;column\&quot;: 0\n      }\n    },\n    \&quot;location\&quot;: {\n      \&quot;row\&quot;: 1,\n      \&quot;column\&quot;: 8\n    },\n    \&quot;end_location\&quot;: {\n      \&quot;row\&quot;: 1,\n      \&quot;column\&quot;: 10\n    },\n    \&quot;filename\&quot;: \&quot;/home/jonathan/Documents/github/ruff/ruff_cli/F401.py\&quot;\n  }\n]\n&quot;`', ruff_cli/tests/integration_test.rs:70:5


failures:
    test_stdin_filename
    test_stdin_json

test result: FAILED. 7 passed; 2 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.08s

error: test failed, to rerun pass `-p ruff_cli --test integration_test`
</code></pre>
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

- A minimal code snippet that reproduces the bug.
- The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
- The current Ruff settings (any relevant sections from your `pyproject.toml`).
- The current Ruff version (`ruff --version`).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-28 17:29</div>
            <div class="timeline-body"><p>We should run the tests under <code>--isolated</code> mode, I think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-01-28 17:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @charliermarsh on 2023-01-28 17:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-28 18:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:15 UTC
    </footer>
</body>
</html>
