<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff will Ignore target version when  work on pyi file - astral-sh/ruff #12256</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff will Ignore target version when  work on pyi file</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12256">#12256</a>
        opened by <a href="https://github.com/rainzee">@rainzee</a>
        on 2024-07-09 09:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rainzee">@rainzee</a></div>
            <div class="timeline-body"><p>The target version is specified as 3.8, and on the py file, everything works fine, but on the pyi file, it looks like the versioning rules are ignored, giving a not-yet-supported operation symbol</p>
<p><img src="https://github.com/astral-sh/ruff/assets/4585440/d531084a-8f7e-4a65-94cb-4f8ebef16573" alt="image"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rainzee">@rainzee</a> on 2024-07-09 09:05</div>
            <div class="timeline-body"><p>Or does pyi files have nothing to do with python version, only pyright?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-09 10:27</div>
            <div class="timeline-body"><p>Ruff&#x27;s behavior that it ignores the target version for stub files is intentional and was previously discussed in <a href="https://github.com/astral-sh/ruff/issues/9285">astral-sh/ruff#9285</a>. @AlexWaygood&#x27;s <a href="https://github.com/astral-sh/ruff/issues/9285#issuecomment-1872932728">comment</a> explains the motivation well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-09 10:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-07-09 10:47</div>
            <div class="timeline-body"><p>Possibly we should document this better, since it seems to have come up several times :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-09 11:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rainzee">@rainzee</a> on 2024-07-09 16:36</div>
            <div class="timeline-body"><blockquote>
<p>Possibly we should document this better, since it seems to have come up several times :)</p>
</blockquote>
<p>yes, pls. i can&#x27;t find anything on doc</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-10 05:48</div>
            <div class="timeline-body"><p>The <a href="https://docs.astral.sh/ruff/settings/#target-version"><code>target-version</code> section</a> might be a good place to put this information, what do you think @AlexWaygood ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-07-10 10:20</div>
            <div class="timeline-body"><blockquote>
<p>The <a href="https://docs.astral.sh/ruff/settings/#target-version"><code>target-version</code> section</a> might be a good place to put this information, what do you think @AlexWaygood ?</p>
</blockquote>
<p>Yeah, that looks like a good place to me too!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-07-18 17:18</div>
            <div class="timeline-body"><p>This is something I ended up having to explain a handful of times as well when contributing to stubs of projects where they&#x27;re not as familiar with the typing system.</p>
<p>Would happily direct to Ruff&#x27;s doc for explanation !</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-07-25 15:03</div>
            <div class="timeline-body"><p>I was just made aware of https://typing.readthedocs.io/en/latest/guides/writing_stubs.html
I would&#x27;ve recommended linking to https://typing.readthedocs.io/en/latest/reference/stubs.html#syntax, ~~but it looks like it&#x27;s still recommending to not use any new syntax past 3.8.~~ (it does mention special annotation syntax lower down, the initial wording is just a bit confusing about matching 3.8 features and syntax).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FichteFoll">@FichteFoll</a> on 2024-08-19 11:22</div>
            <div class="timeline-body"><p>I also fell into the wording trap of https://typing.readthedocs.io/en/latest/reference/stubs.html#syntax and only later (after re-reading it a couple times and studying various issues on this tracker) that the &quot;syntax&quot; section only refers to the &quot;syntax&quot; and not â€¦ language features.</p>
<p>My concerns about type aliases with forward references, pipe unions and getattr support for builtin types were not really addressed by the section or at least not in a fashion that gave me confidence in using them without trying them out first.
I believe the primary problem I had was that type aliases, i.e. situations where these type features were used in an evaluated expression (not covered by <code>from __future__ import annotations</code>), were not mentioned at all. Thus, I assumed they weren&#x27;t covered by the section and consequently not allowed.</p>
<p>https://typing.readthedocs.io/en/latest/guides/writing_stubs.html#language-features does not cover this either.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-27 17:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:55 UTC
    </footer>
</body>
</html>
