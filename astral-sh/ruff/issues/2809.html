<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New rule: warning accidental garbage collection of `asyncio.create_task` - astral-sh/ruff #2809</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>New rule: warning accidental garbage collection of <code>asyncio.create_task</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2809">#2809</a>
        opened by <a href="https://github.com/Glyphack">@Glyphack</a>
        on 2023-02-12 12:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Glyphack">@Glyphack</a></div>
            <div class="timeline-body"><p>I wanted to purpose a new lint rule. The <code>asyncio.create_task</code> function has a caveat, which is when you create a task in order to make sure it finishes you need to take a reference to it.
<img src="https://textual.textualize.io/blog/images/async-create-task.jpeg" alt="image"></p>
<p>I first read about this in <a href="https://textual.textualize.io/blog/2023/02/11/the-heisenbug-lurking-in-your-async-code/">this post</a>. Which also sites a lot of projects that are doing this wrong.</p>
<p>Is this something that ruff wants to support? I could give it a try to implement it in that case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2023-02-12 15:51</div>
            <div class="timeline-body"><p>This was requested in <code>flake8-async</code>: <a href="https://github.com/cooperlees/flake8-async/issues/5">cooperlees/flake8-async#5</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-12 15:53</div>
            <div class="timeline-body"><p>We could implement it as part of <code>RUF</code> for now. I&#x27;d support it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-12 16:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samuelcolvin">@samuelcolvin</a> on 2023-02-15 17:11</div>
            <div class="timeline-body"><p>amazing!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-15 17:15</div>
            <div class="timeline-body"><p>Lol, I can do this today, I didn&#x27;t realize there were so many upvotes on it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zunda-arrow">@zunda-arrow</a> on 2023-02-15 18:01</div>
            <div class="timeline-body"><p>I didn&#x27;t know I needed this lol</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-15 20:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:32 UTC
    </footer>
</body>
</html>
