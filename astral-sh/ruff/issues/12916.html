<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICN001 and N817 don't play with each other - astral-sh/ruff #12916</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ICN001 and N817 don&#x27;t play with each other</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12916">#12916</a>
        opened by <a href="https://github.com/ember91">@ember91</a>
        on 2024-08-16 05:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ember91">@ember91</a></div>
            <div class="timeline-body">

List of keywords searched
<ul>
<li>ICN001</li>
<li>N817</li>
</ul>
Minimal code snippets
<p><code>test1.py</code></p>
<pre><code>import xml.etree.ElementTree as Et
</code></pre>
<p><code>test2.py</code></p>
<pre><code>import xml.etree.ElementTree as ET
</code></pre>
Invoked commands
<pre><code>ruff check test1.py test2.py
</code></pre>
Current ruff settings
<pre><code>select = [&quot;ICN001&quot;, &quot;N817&quot;]
</code></pre>
Current ruff version
<p><code>ruff 0.6.0</code></p>
Description
<p>It seems like <code>N817</code> wants me to import it as <code>Et</code> while <code>ICN001</code> wants me to import it as <code>ET</code>. Perhaps it is ok that rules conflict in ruff. If so I guess this is not a bug.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-16 06:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-16 06:12</div>
            <div class="timeline-body"><p>Thanks. No, that&#x27;s a bug. Rules should be compatible out of the box.</p>
<p>I see two options here:</p>
<ol>
<li><code>N817</code> to ignore any names configured in <code>checker.settings.flake8_import_conventions.aliases</code> when <code>ICN001</code> is enabled</li>
<li><code>ICN001</code> to ignore all camel case names configured in <code>checker.settings.flake8_import_conventions.aliases</code> if <code>N817</code> is enabled.</li>
</ol>
<p>I prefer 1. because it involves less conditional logic (it ignores all the names rather than <em>some</em>).</p>
<p>@charliermarsh what do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cclauss">@cclauss</a> on 2024-08-16 07:52</div>
            <div class="timeline-body"><p>I also prefer 1.</p>
<p>% <code>echo &quot;from xml.etree import ElementTree&quot; | ruff check --select=ALL --ignore=D100,F401 -</code></p>
<pre><code>-:1:23: ICN001 `xml.etree.ElementTree` should be imported as `ET`
  |
1 | from xml.etree import ElementTree
  |                       ^^^^^^^^^^^ ICN001
</code></pre>
<p>% <code>echo &quot;import xml.etree.ElementTree as ET&quot; | ruff check --select=ALL --ignore=D100,F401 -</code></p>
<pre><code>-:1:8: N817 CamelCase `ElementTree` imported as acronym `ET`
  |
1 | import xml.etree.ElementTree as ET
  |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^ N817
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NMertsch">@NMertsch</a> on 2024-08-16 09:18</div>
            <div class="timeline-body"><p>I also prefer 1. Not because of the implementation logic, but because it favors the specific rule <code>ICN001</code> over the generic rule <code>N817</code>:</p>
<ul>
<li><a href="https://docs.astral.sh/ruff/rules/camelcase-imported-as-acronym/">N817</a>: Generally, don&#x27;t use acronyms for camel-case imports, like <code>MCN</code> for <code>MyClassName</code>.</li>
<li><a href="https://docs.astral.sh/ruff/rules/unconventional-import-alias/">ICN001</a>: For <code>ElementTree</code> specifically, use the alias <code>ET</code> because that&#x27;s the convention for this module.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-16 09:23</div>
            <div class="timeline-body"><p>(1) sounds good to me too</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-16 09:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">incompatibility</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-16 09:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ember91">@ember91</a> on 2024-08-16 15:17</div>
            <div class="timeline-body"><p>Wow! You are so responsive in this repo. Hats off!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-16 15:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hofbi">@hofbi</a> on 2024-08-19 17:05</div>
            <div class="timeline-body"><p>@MichaReiser I still see <code>N817 CamelCase ElementTree imported as acronym ET</code> on <code>v0.6.1</code>. If I understand <a href="https://github.com/astral-sh/ruff/pull/12922">astral-sh/ruff#12922</a> correctly, it should now be <code>import ElementTree as XET</code>? However, the autofix of <code>ICN001</code> still autofixes to <code>import ElementTree as ET</code>. Do I miss anything?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cclauss">@cclauss</a> on 2024-08-19 17:40</div>
            <div class="timeline-body"><p>I have never seen <code>XET</code> in the wild and the docs/tutorial recommends <code>ET</code>.</p>
<p>https://docs.python.org/3/library/xml.etree.elementtree.html#tutorial</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-19 17:45</div>
            <div class="timeline-body"><p>@hofbi / @cclauss: We are definitely not recommending <code>XET</code> as an alias for <code>xml.etree.ElementTree</code> in this rule! ðŸ˜„</p>
<p>The tests added in #12922 are specifically testing that the &quot;conventional aliases&quot; setting can be used to configure this rule. One fixture is being run with the &quot;conventional aliases&quot; setting being set to <code>&quot;xml.etree.ElementTree&quot;: &quot;XET&quot;</code>, and the snapshot you see as a result shows you what would happen if you ran Ruff with that (strange) configuration</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hofbi">@hofbi</a> on 2024-08-19 18:45</div>
            <div class="timeline-body"><p>Ok makes sense for XET. Then do I have to configure anything so that both check play nicely together. Right now I still see the N817 error after the autofix adding ET.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-19 18:48</div>
            <div class="timeline-body"><blockquote>
<p>Ok makes sense for XET. Then do I have to configure anything so that both check play nicely together. Right now I still see the N817 error after the autofix adding ET.</p>
</blockquote>
<p>There&#x27;s a separate fix for <code>from ... import</code> that has not been released yet <a href="https://github.com/astral-sh/ruff/pull/12946">astral-sh/ruff#12946</a></p>
<p>If the incompatibility that you&#x27;re seeing isn&#x27;t related to <code>from ... import</code>, please open a new issue and share a code example with us. Happy to take a look.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hofbi">@hofbi</a> on 2024-08-19 18:51</div>
            <div class="timeline-body"><p>Oh I missed that one. My issue is definitely <a href="https://github.com/astral-sh/ruff/issues/12940">astral-sh/ruff#12940</a>. So just waiting for the next release to get this fixed, thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-19 19:37</div>
            <div class="timeline-body"><p>No worries. I missed that one too when implanting the fix ðŸ¥²</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:56 UTC
    </footer>
</body>
</html>
