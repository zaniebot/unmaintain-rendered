<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conda installation of Ruff not running on aarch64 - astral-sh/ruff #13506</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Conda installation of Ruff not running on aarch64</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13506">#13506</a>
        opened by <a href="https://github.com/bcaddy">@bcaddy</a>
        on 2024-09-24 15:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bcaddy">@bcaddy</a> on 2024-09-24 15:36</div>
            <div class="timeline-body"><p>I'm trying to run Ruff on an NVIDIA Grace (i.e. ARM Neoverse v2) CPU and getting the following error:</p>
<pre><code>&lt;jemalloc&gt;: Unsupported system page size
&lt;jemalloc&gt;: Unsupported system page size
memory allocation of 5 bytes failed
Aborted
</code></pre>
<p>This appears to be a reappearance of the page size issue noted in #3791 and I'm not sure how to fix it. I've installed Ruff with Conda from the Conda-forge channel and I'm on the latest version. Any suggestions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-24 16:12</div>
            <div class="timeline-body"><p>Do you know if Ruff installs a pre-built wheel or is it installed from source?</p>
<p>Do you know what page size your system uses?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Ruff not running on aarch64" to "Conda installation of Ruff not running on aarch64" by @bcaddy on 2024-09-24 16:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bcaddy">@bcaddy</a> on 2024-09-24 16:15</div>
            <div class="timeline-body"><p>The page size is 64k and I'm just installing it with <code>conda install -c conda-forge ruff</code>.</p>
<p>I tried with the exact same version of Ruff installed via <code>pip</code> and it works just fine, so the issue is not actually with Ruff but with the version built/installed with Conda; I've updated the title accordingly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-24 16:22</div>
            <div class="timeline-body"><p>Related:</p>
<ul>
<li>https://github.com/astral-sh/ruff/issues/3791</li>
<li>https://github.com/astral-sh/ruff/issues/10073</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-24 16:23</div>
            <div class="timeline-body"><p>Presumably we need to set this variable over in the conda-forge builds?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-25 07:10</div>
            <div class="timeline-body"><p>Yes, I can take a look. @zanieb do you know who has access to our conda forge recipe and how it can be changed?</p>
<p>For reference:</p>
<p>https://github.com/astral-sh/ruff/blob/be1d5e33680c3e2e71b452ad1ed651dcc6f37f55/.github/workflows/build-binaries.yml#L271-L287</p>
<p>https://github.com/astral-sh/ruff/blob/be1d5e33680c3e2e71b452ad1ed651dcc6f37f55/.github/workflows/build-binaries.yml#L412-L416</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by @MichaReiser on 2024-09-25 07:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-25 13:32</div>
            <div class="timeline-body"><p>Anyone can open a pull request https://github.com/conda-forge/ruff-feedstock</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-26 08:29</div>
            <div class="timeline-body"><p>@bcaddy would you be interested in PRing a fix? It's on my todo list but it probably takes me a while before I get to and I have no prior conda forge knowledge</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2024-09-26 08:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bcaddy">@bcaddy</a> on 2024-09-26 14:14</div>
            <div class="timeline-body"><p>I also have no experience with conda forge and don't see an obvious place to change the jemalloc setting so I opened an issue on the ruff feedstock, hopefully they can help out.</p>
<p>https://github.com/conda-forge/ruff-feedstock/issues/222</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-10-04 17:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:35:14 UTC
    </footer>
</body>
</html>
