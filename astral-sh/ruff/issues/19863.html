<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP047 Fails to indentify functions that have `Callable` in their signature - astral-sh/ruff #19863</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UP047 Fails to indentify functions that have `Callable` in their signature</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/19863">#19863</a>
        opened by <a href="https://github.com/Kroppeb">@Kroppeb</a>
        on 2025-08-11 13:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Kroppeb">@Kroppeb</a> on 2025-08-11 13:12</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I noticed something weird with UP047, <code>foo</code> triggers a warning while <code>foo2</code> does not.</p>
<pre><code class="language-python">from collections.abc import Callable
from typing import TypeVar

T = TypeVar(&quot;T&quot;)


def foo(t: list[T]) -&gt; T:
    return t[0]


def foo2(t: list[T], c: Callable[[T], None]) -&gt; T:
    c(t[0])
    return t[1]
</code></pre>
<p>Playground: https://play.ruff.rs/cd7af9a8-0532-40fe-83c7-4282a658808c</p>
<h3>Version</h3>
<p>v0.12.7</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2025-08-11 13:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-08-11 13:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-11 14:05</div>
            <div class="timeline-body"><p>Thanks for opening an issue. This was also discussed in our Discord (<a href="https://discord.com/channels/1039017663004942429/1070132471699607623/1402996211404902531">conversation</a>).</p>
<p>Specifically, @AlexWaygood replied</p>
<blockquote>
<p>There was a bug in collections.abc.Callable on Python 3.9 IIRC, which means it isn't safe to replace typing.Callable with collections.abc.Callable on all Python versions (it works most of the time on py39, but not in some edge cases, I think?)
Should be safe on the newest Python versions, though. Can't remember exactly when the bug was fixed</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-08-11 14:20</div>
            <div class="timeline-body"><p>I talked to Alex, and I don't think that Python bug should affect this rule, which is only replacing the type of generics, not importing <code>Callable</code> from a different module. I believe he was thinking of <a href="https://docs.astral.sh/ruff/rules/deprecated-import/#deprecated-import-up035">deprecated-import (UP035)</a>, which will replace <code>typing.Callable</code> with <code>collections.abc.Callable</code> after Python 3.10.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-08-11 14:22</div>
            <div class="timeline-body"><p>Yup, @ntBre is correct â€” my bad! sorry about that ðŸ« </p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
