<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S105: Exclude variable names containing `token` but also `suffix` or `prefix` - astral-sh/ruff #8789</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>S105: Exclude variable names containing <code>token</code> but also <code>suffix</code> or <code>prefix</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8789">#8789</a>
        opened by <a href="https://github.com/ThiefMaster">@ThiefMaster</a>
        on 2023-11-20 16:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2023-11-20 16:02</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/blob/main/crates/ruff_linter/src/rules/flake8_bandit/helpers.rs</p>
<p>For example, it currently triggers on these 3 definitions:</p>
<pre><code class="language-py"># The prefix for OAuth tokens
TOKEN_PREFIX_OAUTH = 'indo_'
# The prefix for personal tokens
TOKEN_PREFIX_PERSONAL = 'indp_'
# The prefix for service tokens (not handled by this module)
TOKEN_PREFIX_SERVICE = 'inds_'
</code></pre>
<p>However, clearly those are not hardcoded tokens and having suffixes/prefixes for tokens (especially since github's secret scanning becamea thing) is quite common, so maybe it'd be nice to resemble this in the regex that checks for token/password-like variable names instead of just noqa'ing it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-20 16:05</div>
            <div class="timeline-body"><p>For security-oriented checks, I would personally accept some false positives over risking false negatives. It seems reasonable to me to require users to explicitly <code># noqa: S105</code> these, but I'd like to hear others' opinions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-11-20 16:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-11-20 16:10</div>
            <div class="timeline-body"><p>I agree I prefer false positives over negatives in security related rules. I wouldn't be <em>opposed</em> to an exception for<code>PREFIX</code> and <code>SUFFIX</code> unless there's a case someone has where it'd cause a false negative.</p>
<p>Overall, the complexity of adding exceptions to the rule is a little contrived though and probably too specific.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2023-11-23 13:31</div>
            <div class="timeline-body"><p>Perhaps it's possible to make it more configurable, for example, we would be adding variable names like <code>public_token</code>, <code>token_service_path</code> to the list of non-secret variables in config file if such would be exists.
That much easier and clear than tons of noqa.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2023-11-23 13:38</div>
            <div class="timeline-body"><p>A regex setting to whitelist variable names (and dict keys!) for &quot;possible plaintext token/password&quot; would be excellent :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2023-11-23 13:45</div>
            <div class="timeline-body"><p>Also, not sure it make sense to try to find real passwords in unit tests, so, perhaps some exclude path can be also configured.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2023-11-23 14:06</div>
            <div class="timeline-body"><p>Hm, perhaps my last comment can be solved by <code>per-file-ignores</code>.
UPD. yes:</p>
<pre><code>[tool.ruff.per-file-ignores]
&quot;**/tests/**.py&quot; = [
    &quot;S105&quot;,  # don't search hardcoded passwords in tests
    &quot;S106&quot;,  # don't search hardcoded passwords in tests
    &quot;S107&quot;,  # don't search hardcoded passwords in tests
]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-11-27 03:07</div>
            <div class="timeline-body"><p>How frequent are these false positives? I'm asking because requiring additional configuration may be as much work as suppressing the few occurrences in your code (assuming there are only a few), and have the benefit that they are never outdated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2023-11-27 07:57</div>
            <div class="timeline-body"><blockquote>
<p>How frequent are these false positives?</p>
</blockquote>
<p>I have no any statistics, but I would expect for such check, false positives rate are expected to be high, because price of false negative is also high.
In repo I am playing now I got couple of places where variables were really about passwords and about 50 cases when variables are not related to any secrets, just have mentions of some words like &quot;password&quot;, &quot;secret&quot; or &quot;token&quot; in the name or value.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2023-11-27 09:41</div>
            <div class="timeline-body"><p>Sorry, I forgot to count cases which are excluded by <code>per-file-ignores</code> - there are some files where a lot of false positives, so will be at least twice more false positives.
But it might be that this repo it not an average case - it has an integration with third-party API where word <code>payment_token</code> is actively used in field names.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IdoPort">@IdoPort</a> on 2024-11-07 09:53</div>
            <div class="timeline-body"><p>We are also experiencing some issues like that but from another angle.
We are  writing parsing code for several kind of files and we have functions that are looking or handling some behavior of specific tokens in the file.
In those functions we get FP alerts for each such constant so if we could suppress those by having some prefix to the <code>token</code> it would save us many <code>#noqa</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-07 10:19</div>
            <div class="timeline-body"><p>@IdoPort have you considered disabling the rule for those files? It seems very unlikely that they'll ever contain any real authentication token.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IdoPort">@IdoPort</a> on 2024-11-07 14:23</div>
            <div class="timeline-body"><p>@MichaReiser I didn't know I can disable lints per file, that awesome! Thank!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:32:03 UTC
    </footer>
</body>
</html>
