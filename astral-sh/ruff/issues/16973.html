<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request: Autofix for `stub-body-multiple-statements (PYI048)` with elipsis / pass - astral-sh/ruff #16973</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Request: Autofix for <code>stub-body-multiple-statements (PYI048)</code> with elipsis / pass</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/16973">#16973</a>
        opened by <a href="https://github.com/Avasam">@Avasam</a>
        on 2025-03-26 01:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Avasam">@Avasam</a></div>
            <div class="timeline-body">Summary
<p>My specific use-case is for docstrings + elipsis.</p>
<p>Example taken from https://github.com/microsoft/python-type-stubs/blob/main/stubs/sklearn/utils/sparsefuncs_fast.pyi
<img src="https://github.com/user-attachments/assets/5bb54d41-7210-4db3-860d-30b2d07adf2e" alt="Image"></p>
<p>Simplified example:</p>
<pre><code># From
def foo() -&gt; None:
    &quot;&quot;&quot;docstring&quot;&quot;&quot;
    ...

# To
def foo() -&gt; None:
    &quot;&quot;&quot;docstring&quot;&quot;&quot;
</code></pre>
<p>But I think this may be generalized to any case where the extra statements are all <code>...</code> or <code>pass</code>.</p>
<p>More simplified example:</p>
<pre><code># From
def foo() -&gt; None:
    &quot;&quot;&quot;docstring&quot;&quot;&quot;
    pass

def foo() -&gt; None:
    &quot;&quot;&quot;docstring&quot;&quot;&quot;
    ...
    pass

# To
def foo() -&gt; None:
    &quot;&quot;&quot;docstring&quot;&quot;&quot;
</code></pre>
<pre><code># From
def foo() -&gt; None:
    print(&quot;bar&quot;)
    pass

# To
def foo() -&gt; None:
    print(&quot;bar&quot;)  # Note: This rule isn&#x27;t about whether a call is valid in stub
</code></pre>
<pre><code># From
def foo() -&gt; None:
    ...
    ...

def foo() -&gt; None:
    pass
    ...

# To
def foo() -&gt; None: ...
</code></pre>
<p>And unfixable (more than 1 non no-op statement)</p>
<pre><code># From
def foo() -&gt; None:
    print(&quot;bar&quot;)
    print(&quot;bar2&quot;)
    pass
</code></pre>
<hr>
<p>Ruff: 0.11.2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-03-26 07:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-27 20:00</div>
            <div class="timeline-body"><p>This sounds reasonable. Do you know how common some of those cases are? I&#x27;d expect that the docstring + dummy statement is the most common and I&#x27;d prioritize adding a fix for this. I&#x27;m not sure if we need to support the other cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-03-27 20:11</div>
            <div class="timeline-body"><p>The docstring + dummy statement is the only case I remember coming across. And it&#x27;s valid in stubs, just extraneous. I think pyright generates stubs like that.</p>
<p>The rest are hypothetical generalisation.
There may be a valid use-case in automatically removing functions&#x27; content if trying to generate a stub file from the source one using Ruff. But that&#x27;s already mostly handled by <a href="https://docs.astral.sh/ruff/rules/non-empty-stub-body/#non-empty-stub-body-pyi010">non-empty-stub-body (PYI010)</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-03-31 19:12</div>
            <div class="timeline-body"><p>I just realized, this heavily overlaps with <a href="https://docs.astral.sh/ruff/rules/unnecessary-placeholder/#unnecessary-placeholder-pie790">unnecessary-placeholder (PIE790)</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-05-03 01:17</div>
            <div class="timeline-body"><p>In <a href="https://github.com/astral-sh/ruff/issues/16973">astral-sh/ruff#16973</a> I enabled <code>PIE790</code> and got all but 1 instances fixed (which is out of scope of this request anyway). I think the same autofix can simply be applied.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:49:44 UTC
    </footer>
</body>
</html>
