<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff flags (and tries to fix) UP007 for python&lt;3.10 in some cases - astral-sh/ruff #6313</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff flags (and tries to fix) UP007 for python&lt;3.10 in some cases</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6313">#6313</a>
        opened by <a href="https://github.com/FranzForstmayr">@FranzForstmayr</a>
        on 2023-08-03 16:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/FranzForstmayr">@FranzForstmayr</a></div>
            <div class="timeline-body"><p>Following code works without error when checked with
<code>ruff .\test.py --isolated --select UP --target-version py39</code></p>
<pre><code class="language-python"># from __future__ import annotations

from typing import Union

class MyModel():
    value: Union[bool, str]
</code></pre>
<p>When I uncomment the first line, <code>ruff</code> reports (and wants to fix) the <code>Union[bool, str]</code> to <code>bool | str</code> which is not compatible with python 3.9.</p>
<pre><code class="language-python">from __future__ import annotations

from typing import Union

class MyModel():
    value: Union[bool, str]
</code></pre>
<p>Same command
<code>ruff .\test.py --isolated --select UP --target-version py39</code></p>
<pre><code>test.py:6:12: UP007 [*] Use `X | Y` for type annotations
Found 1 error.
[*] 1 potentially fixable with the --fix option.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-03 16:20</div>
            <div class="timeline-body"><p>I believe that code <em>is</em> Python 3.9-compatible -- it will run without error (I just tried on 3.8), and all type checkers will support and understand it. <code>__future__</code> annotations effectively treats all annotations as strings, so analysis tools can support language features that don't exist at runtime.</p>
<p>If you're relying on the annotations being <em>evaluated</em> at runtime, for use with Pydantic or some other library, you may be looking for the <a href="https://beta.ruff.rs/docs/settings/#pyupgrade-keep-runtime-typing"><code>keep-runtime-typing</code></a> setting.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FranzForstmayr">@FranzForstmayr</a> on 2023-08-03 18:37</div>
            <div class="timeline-body"><p>Yes, this is a snippet of a bigger <code>pydantic</code> based model where I got the error.
You are right, python3.9 can run this snippet without error, but based on the error message I thought this is not supported yet.</p>
<p><a href="https://peps.python.org/pep-0604/">PEP604</a> mentions also only 3.10+.</p>
<p>Thanks anyway, <code>keep-runtime-typing</code> will solve my issue :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @FranzForstmayr on 2023-08-03 18:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:53 UTC
    </footer>
</body>
</html>
