```yaml
number: 7246
title: "Formatter: code containing long string literal is parenthesized and generates worse output"
type: issue
state: closed
author: rossmacarthur
labels:
  - formatter
assignees: []
created_at: 2023-09-08T16:45:42Z
updated_at: 2023-09-25T10:02:29Z
url: https://github.com/astral-sh/ruff/issues/7246
synced_at: 2026-01-10T01:56:49Z
```

# Formatter: code containing long string literal is parenthesized and generates worse output

---

_Issue opened by @rossmacarthur on 2023-09-08 16:45_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

Thanks for this great project. I'm looking forward to a future where I will only need a single tool, I tried testing `ruff format` on a private project with about ~30 000 lines of Python code where we already use black. There were hardly any differences to black's output. The following is the only objectively worse formatting.

## Code

**Input**
```python
assert items == [
    "a very very very very very very very very very very very very very very very long string",
]
```

**`ruff format` Output**

```python
assert (
    items
    == [
        "a very very very very very very very very very very very very very very very long string",
    ]
)
```

**`black` Output**

```python
assert items == [
    "a very very very very very very very very very very very very very very very long string",
]

```

## Details

```
❯ ruff --version
ruff 0.0.287
```

```
❯ black --version
black, 23.7.0 (compiled: yes)
Python (CPython) 3.11.2
```


---

_Renamed from "Formatter: code containing long string literal is parenthesized and to worse output containing long string literal" to "Formatter: code containing long string literal is parenthesized and generates worse output" by @rossmacarthur on 2023-09-08 16:45_

---

_Comment by @MichaReiser on 2023-09-08 17:17_


>  I tried testing ruff format on a private project with about ~30 000 lines of Python code where we already use black. There were hardly any differences to black's output. 

:partying_face: glad to hear that

Thanks for reporting. Let me double check if this is related to https://github.com/astral-sh/ruff/pull/6857


Another consideration is that Black format's this differently in preview style. We may decide to directly implement the new style. 

Preview style

```python
assert items == [
    (
        "a very very very very very very very very very very very very very very very"
        " long string"
    ),
]
```

---

_Label `formatter` added by @MichaReiser on 2023-09-08 17:17_

---

_Label `needs-decision` added by @MichaReiser on 2023-09-08 17:17_

---

_Added to milestone `Formatter: Beta` by @MichaReiser on 2023-09-08 17:19_

---

_Referenced in [astral-sh/ruff#7355](../../astral-sh/ruff/issues/7355.md) on 2023-09-13 17:11_

---

_Referenced in [astral-sh/ruff#7490](../../astral-sh/ruff/pulls/7490.md) on 2023-09-18 13:29_

---

_Comment by @MichaReiser on 2023-09-25 10:01_

This is fixed on main https://play.ruff.rs/3ce97226-6ede-4e28-8851-8cd026bfaff6

---

_Closed by @MichaReiser on 2023-09-25 10:01_

---

_Label `needs-decision` removed by @MichaReiser on 2023-09-25 10:02_

---

_Referenced in [astral-sh/ruff#8546](../../astral-sh/ruff/issues/8546.md) on 2023-11-07 18:37_

---
