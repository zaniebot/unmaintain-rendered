<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No __prepare__ at is_known_dunder_method - astral-sh/ruff #9508</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>No __prepare__ at is_known_dunder_method</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/9508">#9508</a>
        opened by <a href="https://github.com/arnaud-ma">@arnaud-ma</a>
        on 2024-01-14 03:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/arnaud-ma">@arnaud-ma</a> on 2024-01-14 03:33</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>For exemple</p>
<pre><code class="language-python3">class A(type):
    @classmethod
    def __prepare__(cls, name, bases): ...
</code></pre>
<p>returns the error &quot;PLW3201 Bad or misspelled dunder method name <code>__prepare__</code>&quot;. It appears that this is missing in https://github.com/astral-sh/ruff/blob/e8d7a6dfce3251a76afc754899034fad48376d99/crates/ruff_linter/src/rules/pylint/helpers.rs#L202-L210</p>
<p>We can verify that this is the last dunder method missing by doing a regex <code>\b__\w+__\b</code> on https://docs.python.org/3/reference/datamodel.html and looking at what is missing in the file. We obtain</p>
<ul>
<li><code>__annotations__</code></li>
<li><code>__bases__</code></li>
<li><code>__classcell__</code></li>
<li><code>__closure__</code></li>
<li><code>__code__</code></li>
<li><code>__defaults__</code></li>
<li><code>__file__</code></li>
<li><code>__func__</code></li>
<li><code>__future__</code></li>
<li><code>__globals__</code></li>
<li><code>__import__</code></li>
<li><code>__kwdefaults__</code></li>
<li><code>__match_args__</code></li>
<li><code>__mro__</code></li>
<li><code>__mro_entries__</code></li>
<li><code>__name__</code></li>
<li><code>__objclass__</code></li>
<li><code>__prepare__</code></li>
<li><code>__qualname__</code></li>
<li><code>__self__</code></li>
<li><code>__slots__</code></li>
<li><code>__traceback__</code></li>
<li><code>__type_params__</code></li>
</ul>
<p>It appears <code>__prepare__</code> is the only method here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-01-14 04:00</div>
            <div class="timeline-body"><p>Thanks! Not sure if this was excluded intentionally but I'm not sure why it would be.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-01-14 04:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @zanieb on 2024-01-14 04:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/arnaud-ma">@arnaud-ma</a> on 2024-01-14 04:59</div>
            <div class="timeline-body"><p>Well <code>__prepare__</code> is a bit of a special case that very few people use, this is the only method that only makes sense if it's in a metaclass so I can understand.
Furthermore for the <code>PLW3201</code> as we can add it in the bad-dunder-method-name setting it's not really a big problem in itself. But I find it a bit strange that by default the linter acts as if the method does not exist at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/takaya0">@takaya0</a> on 2024-01-14 15:05</div>
            <div class="timeline-body"><p>I'd like to work on this, please assign me :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @takaya0 by @charliermarsh on 2024-01-14 15:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/9529.html">astral-sh/ruff#9529</a> on 2024-01-15 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-15 14:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:52 UTC
    </footer>
</body>
</html>
