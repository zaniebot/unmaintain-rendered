<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rule idea: dict get for ranking dict - astral-sh/ruff #14592</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Rule idea: dict get for ranking dict</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14592">#14592</a>
        opened by <a href="https://github.com/entorb">@entorb</a>
        on 2024-11-25 19:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/entorb">@entorb</a></div>
            <div class="timeline-body"><p>Do you think a rule for improving code of ranking-dict increment would be worth implementing?</p>
<p>this</p>
<pre><code class="language-python">if &quot;key&quot; not in d:
    d[&quot;key&quot;] = 1
else:
    d[&quot;key&quot;] += 1
</code></pre>
<p>should be simplified by</p>
<pre><code class="language-python">d[&quot;key&quot;] = d.get(&quot;key&quot;, 1)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-25 21:13</div>
            <div class="timeline-body"><p>Thanks for suggesting a new lint rule! It's always nice to have simplification ideas.</p>
<p>In this case I'm having a little trouble understanding the suggestion. Are the two code blocks really equivalent? It seems like the latter does not actually add 1 to the existing entry. I guess this would work:</p>
<pre><code class="language-python">d[&quot;key&quot;] = d.get(&quot;key&quot;,0) + 1
</code></pre>
<p>But, at least to me, that takes a little more time to understand than the if/else statement. I would think that the latter is also slightly slower (but I could be wrong, and that's not that big of a deal anyway).</p>
<p>Apologies if I've misunderstood the suggestion!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/entorb">@entorb</a> on 2024-11-25 21:41</div>
            <div class="timeline-body"><p>Ups, yes of cause you are right, as I messed the second part up. Sorry for the confusion. Here corrected:</p>
<p>this</p>
<pre><code class="language-python">if &quot;key&quot; not in d:
    d[&quot;key&quot;] = 1
else:
    d[&quot;key&quot;] += 1
</code></pre>
<p>should be simplified by</p>
<pre><code class="language-python">d[&quot;key&quot;] = d.get(&quot;key&quot;, 0) + 1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dylwil3 on 2024-11-25 22:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @dylwil3 on 2024-11-25 22:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-25 22:30</div>
            <div class="timeline-body"><p>Great, thank you! I think, as I said above, that I would personally find this lint confusing. But of course I'm happy to be overruled by the community ðŸ˜„</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-26 08:17</div>
            <div class="timeline-body"><p>Thanks for the suggestion</p>
<p>One acceptance criteria for our rules is that the rule should be useful for most Python programmers and that there's enough support in the community to consider it good practice:</p>
<blockquote>
<p>Generally, if a lint is triggered, this should be useful to most Python (3+) programmers seeing it most of the time.</p>
</blockquote>
<p>I don't think there's enough evidence for avoiding the <code>if</code>...<code>else</code> branching in the above example to be considered &quot;simpler&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-11-26 08:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:38 UTC
    </footer>
</body>
</html>
