<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Config file discovery incorrectly includes parent config - astral-sh/ruff #8858</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Config file discovery incorrectly includes parent config</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8858">#8858</a>
        opened by <a href="https://github.com/bersbersbers">@bersbersbers</a>
        on 2023-11-27 16:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2023-11-27 16:33</div>
            <div class="timeline-body"><p><a href="https://docs.astral.sh/ruff/configuration/#config-file-discovery">The docs</a> read:</p>
<blockquote>
<p>&quot;any parent configuration files are ignored&quot;</p>
</blockquote>
<p>with a few exceptions, all of which do not apply in the following example (both files have a <code>[tool.ruff]</code> section, <code>--config</code> is not used, a config file <em>is</em> found in the filesystem hierarchy, and nothing is provided on the command line at all).</p>
<p>Still,</p>
<pre><code class="language-shell">mkdir -p bug1/bug2
echo '[tool.ruff]' &gt; bug1/pyproject.toml
echo 'select = [&quot;ALL&quot;]' &gt;&gt; bug1/pyproject.toml
echo '[tool.ruff]' &gt; bug1/bug2/pyproject.toml
echo 'ignore = [&quot;D203&quot;, &quot;D212&quot;]' &gt;&gt; bug1/bug2/pyproject.toml
cd bug1/bug2
ruff .
</code></pre>
<p>gives</p>
<pre><code>warning: `one-blank-line-before-class` (D203) and `no-blank-line-before-class` (D211) are incompatible. Ignoring `one-blank-line-before-class`.
warning: `multi-line-summary-first-line` (D212) and `multi-line-summary-second-line` (D213) are incompatible. Ignoring `multi-line-summary-second-line`.
</code></pre>
<p>although one of each pair of rules is clearly disabled in <code>bug1/bug2/pyproject.toml</code>.</p>
<pre><code class="language-shell">rm ../pyproject.toml 
ruff .
</code></pre>
<p>works fine, suggesting that the presence of the parent config does play a role although it should not.</p>
<p>ruff 0.1.5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-11-27 16:47</div>
            <div class="timeline-body"><p>Thanks for the clear reproduction. This is surprising...</p>
<p>Here's the verbose output:</p>
<pre><code>‚ùØ ruff check . --no-cache --verbose
[ruff_cli::resolve][DEBUG] Using configuration file (via parent) at: /repro/bug1/bug2/pyproject.toml
warning: `one-blank-line-before-class` (D203) and `no-blank-line-before-class` (D211) are incompatible. Ignoring `one-blank-line-before-class`.
warning: `multi-line-summary-first-line` (D212) and `multi-line-summary-second-line` (D213) are incompatible. Ignoring `multi-line-summary-second-line`.
[ruff_workspace::resolver][DEBUG] Included path via `include`: &quot;/repro/bug1/bug2/pyproject.toml&quot;
[ruff_workspace::resolver][DEBUG] Ignored path via `exclude`: &quot;/repro/bug1/bug2/.ruff_cache&quot;
[ruff_cli::commands::check][DEBUG] Identified files to lint in: 13.826167ms
[ruff_cli::diagnostics][DEBUG] Checking: /repro/bug1/bug2/pyproject.toml
[ruff_cli::commands::check][DEBUG] Checked 1 files in: 3.359583ms
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2023-11-27 16:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @MichaReiser by @charliermarsh on 2023-11-28 06:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-11-29 04:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:32:06 UTC
    </footer>
</body>
</html>
