<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANN401: Add option to only enforce on the standard spelling - astral-sh/ruff #13516</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ANN401: Add option to only enforce on the standard spelling</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13516">#13516</a>
        opened by <a href="https://github.com/ofek">@ofek</a>
        on 2024-09-25 21:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ofek">@ofek</a></div>
            <div class="timeline-body"><p>Although it's possible to annotate using the <a href="https://peps.python.org/pep-0484/#arbitrary-argument-lists-and-default-argument-values">inner type</a>, and more recently the ability to <a href="https://peps.python.org/pep-0692/"><code>Unpack</code></a> a <code>TypedDict</code>, there are many common situations where one would desire <code>Any</code>:</p>
<ul>
<li>When the arguments are coming from deserialized data across the wire or user input.</li>
<li>When overriding a method like <code>__init__</code> with new arguments. This saves significant boilerplate and potentially bugs that would be caused by redefining the base class method's signature.</li>
<li>When adding annotations to large existing code bases.</li>
</ul>
<p>It's a convention to signal that the arguments should be typed when they are not named exactly <code>*args</code>/<code>**kwargs</code>. Here's an example from the standard library:</p>
<p>https://github.com/python/cpython/blob/ea5c6507044db0a92f12b5022f91885034fb9a09/Lib/pathlib.py#L711-L717</p>
<pre><code class="language-python">    def joinpath(self, *pathsegments):
        &quot;&quot;&quot;Combine this path with one or several arguments, and return a
        new path representing either a subpath (if all arguments are relative
        paths) or a totally different path (if one of the arguments is
        anchored).
        &quot;&quot;&quot;
        return self.with_segments(self, *pathsegments)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-25 22:55</div>
            <div class="timeline-body"><p>I think this is somewhat covered by https://docs.astral.sh/ruff/rules/any-type/ -- can you take a look at that rule?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-09-25 22:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2024-09-25 22:59</div>
            <div class="timeline-body"><p>Ah I didn't see that one, thanks! As I mentioned though if it existed (which it does) I wouldn't use it without the option I'm asking for. Are you saying that it automatically allows <code>Any</code> if the arguments are spelled <code>*args</code>/<code>**kwargs</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add configurable lint for the `Any` type on arbitrary arguments and keyword arguments" to "ANN401: Add option to only enforce on the standard spelling" by @ofek on 2024-09-25 23:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-25 23:15</div>
            <div class="timeline-body"><p>I think there's an option for that: https://docs.astral.sh/ruff/settings/#lintflake8-annotations</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2024-09-25 23:29</div>
            <div class="timeline-body"><p>Not quite as that disables ubiquitously for star arguments. Using the example from the standard library, I want this to fail:</p>
<pre><code class="language-python">def joinpath(self, *pathsegments: Any): ...
</code></pre>
<p>but this to pass for allowing the situations I enumerated in the OP:</p>
<pre><code class="language-python">def joinpath(self, *args: Any): ...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-25 23:37</div>
            <div class="timeline-body"><p>Can you show this convention used in typed code? My understanding is that the standard library doesn't use type annotations so it doesn't seem like a good example.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2024-09-25 23:52</div>
            <div class="timeline-body"><ul>
<li>https://github.com/psf/black/blob/8d9d18c0338d9fbfc27b38f6f69bb630d90512fa/src/black/output.py#L16 (would be named kwargs but they're trying to match https://click.palletsprojects.com/en/8.1.x/api/#click.style)</li>
<li>https://github.com/psf/black/blob/8d9d18c0338d9fbfc27b38f6f69bb630d90512fa/src/black/output.py#L113</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2024-09-26 02:33</div>
            <div class="timeline-body"><p>Another example:</p>
<ul>
<li>https://github.com/litestar-org/litestar/blob/b18774922fedc86089d143d9a5484f393826557d/litestar/exceptions/base_exceptions.py#L13</li>
<li>https://github.com/litestar-org/litestar/blob/b18774922fedc86089d143d9a5484f393826557d/litestar/events/listener.py#L24</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2024-09-26 02:35</div>
            <div class="timeline-body"><p>Another example from the Microsoft cloud SDK: https://github.com/Azure/azure-sdk-for-python/blob/f0c6e8b007699a8c83d7b21d85b1b54621dfd001/sdk/core/corehttp/corehttp/credentials.py#L27</p>
<p>They do that everywhere and it's actually a pattern I forgot to list in the OP. To avoid eventual breaking changes you allow functions to have arbitrary keyword arguments, in which case you don't know the future so you have to use <code>Any</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-26 06:21</div>
            <div class="timeline-body"><p>CC: @AlexWaygood</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2025-09-19 02:36</div>
            <div class="timeline-body"><p>Has there been any progress on this?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:09 UTC
    </footer>
</body>
</html>
