<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>problem with cache in combination with EXE001 - astral-sh/ruff #3163</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>problem with cache in combination with EXE001</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/3163">#3163</a>
        opened by <a href="https://github.com/xmatthias">@xmatthias</a>
        on 2023-02-23 05:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/xmatthias">@xmatthias</a> on 2023-02-23 05:47</div>
            <div class="timeline-body"><p>ruff version <code>ruff 0.0.251</code></p>
<p>The premise  is that a file is present in a project with the EXE ruleset enabled (the file violates this ruleset by not being executable).</p>
<pre><code class="language-bash">touch random_file.py

echo &quot;#!/usr/bin/env python&quot; &gt; random_file.py
# The file is now violating the EXE rule - as it's not executable.
</code></pre>
<p>Running ruff on this correctly identifies the problem. but after fixing it, ruff is not checking the file again properly, still reporting it as violation.
Running without cache (<code>-n</code>) shows correct results - but the error &quot;returns from cache&quot; after the run.</p>
<pre><code>$ ruff . 
random_file.py:1:3: EXE001 Shebang is present but file is not executable
Found 1 error.
$ chmod +x random_file.py
$ ruff . 
random_file.py:1:3: EXE001 Shebang is present but file is not executable
Found 1 error.
$ ruff . -n
$ ruff . 
random_file.py:1:3: EXE001 Shebang is present but file is not executable
</code></pre>
<p>the only way i found to permanently fix this after fixing the violation is by removing cache (<code>rm -rf .ruff_cache</code>) - which i'm sure is not the indended way.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-23 08:47</div>
            <div class="timeline-body"><p>Duplicate of #3086, fixed in <a href="https://github.com/charliermarsh/ruff/releases/tag/v0.0.252">v0.0.252</a> by #3104.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/xmatthias">@xmatthias</a> on 2023-02-23 10:39</div>
            <div class="timeline-body"><p>Thanks - didn't see that.
as i updated yesterday evening, i was assuming i was using the latest version ...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @xmatthias on 2023-02-23 10:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:08 UTC
    </footer>
</body>
</html>
