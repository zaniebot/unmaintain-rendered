<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No way to autofix F401 errors in __init__.py - astral-sh/ruff #16609</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>No way to autofix F401 errors in <strong>init</strong>.py</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/16609">#16609</a>
        opened by <a href="https://github.com/ezyang">@ezyang</a>
        on 2025-03-10 18:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ezyang">@ezyang</a> on 2025-03-10 18:56</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Repro:</p>
<p><strong>init</strong>.py</p>
<pre><code>from a import foo

def baz() -&gt; None:
  pass
</code></pre>
<p>a.py</p>
<pre><code>def foo():
  pass
</code></pre>
<pre><code>ruff check --fix --unsafe-fixes --select ALL
</code></pre>
<p>The unused import is not removed. Now, I assume this is special cased because <code>__init__.py</code> is special. It would be nice if there a way to bypass the special case anyway though. For now, though, I think I'll get my code out of <code>__init__.py</code>...</p>
<p>As a stopgap, it would be nice if it said something about why the import was not fixed here, this was very difficult to Google for why it was not fixing it since everyone claimed unused imports would be removed by this.</p>
<h3>Version</h3>
<p>ruff 0.9.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-03-10 22:44</div>
            <div class="timeline-body"><p>This fix is only available with <a href="https://docs.astral.sh/ruff/preview/">preview mode</a> enabled:</p>
<pre><code class="language-shell">&gt; cat __init__.py
from a import foo


def baz() -&gt; None:
  pass
</code></pre>
<pre><code class="language-shell">&gt; ruff check __init__.py --diff --select F401 --unsafe-fixes --preview
--- __init__.py
+++ __init__.py
@@ -1,4 +1,3 @@
-from a import foo


 def baz() -&gt; None:

Would fix 1 error.
</code></pre>
<p>This seems to work for me, even for <code>__init__.py</code>, which was a pleasant surprise since there are several existing issues around F401 for <code>__init__.py</code> files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-03-11 06:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vikyd">@vikyd</a> on 2025-03-12 11:16</div>
            <div class="timeline-body"><p>https://docs.astral.sh/ruff/tutorial/</p>
<p><code>--preview</code> <code>--unsafe-fixes</code>  are not mentioned in the tutorial page.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-12 11:55</div>
            <div class="timeline-body"><blockquote>
<p><a href="https://docs.astral.sh/ruff/tutorial/">docs.astral.sh/ruff/tutorial</a></p>
<p><code>--preview</code> <code>--unsafe-fixes</code> are not mentioned in the tutorial page.</p>
</blockquote>
<p>This is intentional. The tutorial should cover the bascis. Both <code>--preview</code> and <code>--unsafe-fixes</code> are more advanced concepts.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-03-13 00:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vikyd">@vikyd</a> on 2025-03-21 06:28</div>
            <div class="timeline-body"><p>But it will fail when copying and running command exactly in pag https://docs.astral.sh/ruff/tutorial/ .</p>
<p>It is not about intentional or not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-03-21 09:54</div>
            <div class="timeline-body"><blockquote>
<p>But it will fail when copying and running command exactly in pag <a href="https://docs.astral.sh/ruff/tutorial/">docs.astral.sh/ruff/tutorial</a> .</p>
</blockquote>
<p>Can you specify which command will fail from the tutorial docs?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ezyang">@ezyang</a> on 2025-03-21 12:48</div>
            <div class="timeline-body"><p>Now that I know about preview, I guess I will try it the next time I have this sort of problem. Difficult to know how I could have figured it out without filing this issue though lol</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-03-21 13:12</div>
            <div class="timeline-body"><p>The tutorial was updated in #16818 to avoid fixing <code>__init__.py</code>. The new version should now allow you to follow along directly!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-03-21 13:16</div>
            <div class="timeline-body"><p>@ezyang I see now that your report doesn't mention the tutorial explicitly. In your case, do the docs for the rule itself (<a href="https://docs.astral.sh/ruff/rules/unused-import/#unused-import-f401">unused-import (F401)</a>) clarify things? There's some discussion of <code>__init__.py</code> and the preview behavior in the <code>Fix safety</code> section.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ezyang">@ezyang</a> on 2025-03-21 23:01</div>
            <div class="timeline-body"><p>If I had thought to look at the docs, this indeed would have answered it (although &quot;currently in preview&quot; would not be meaningful to someone who didn't know about the preview flag). But it would have been better if the lint message itself mentioned that &quot;although you had fixes on, this lint wasn't fixed because of&quot; and then link to URL.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:36:52 UTC
    </footer>
</body>
</html>
