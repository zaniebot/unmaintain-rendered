<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIM103 changes behavior - astral-sh/ruff #2218</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>SIM103 changes behavior</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/2218">#2218</a>
        opened by <a href="https://github.com/spaceone">@spaceone</a>
        on 2023-01-26 20:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/spaceone">@spaceone</a> on 2023-01-26 20:09</div>
            <div class="timeline-body"><pre><code>$ cat foo.py
def foo(bar: int) -&gt; bool:
        if bar:
                return True
        else:
                return False

assert foo(1) is True
$ python3 foo.py
$ ruff --isolated --select SIM103 --fix foo.py                                                                                                                              
Found 1 error (1 fixed, 0 remaining).
$ cat foo.py                                                                                                                                                                
def foo(bar: int) -&gt; bool:
        return bar

assert foo(1) is True
$ python3 foo.py
Traceback (most recent call last):
  File &quot;foo.py&quot;, line 4, in &lt;module&gt;
    assert foo(1) is True
AssertionError
</code></pre>
<p>maybe <code>SIM103</code> could try to detect if the input is a boolean and otherwise wrap it in a <code>bool()</code> call?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceone">@spaceone</a> on 2023-01-26 20:47</div>
            <div class="timeline-body"><p>SIM210 is similar and adds <code>bool()</code> wrapping.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autofix</span> added by @charliermarsh on 2023-01-26 20:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-26 21:11</div>
            <div class="timeline-body"><p>This is probably difficult to avoid right now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-26 21:12</div>
            <div class="timeline-body"><p>I guess we could <em>always</em> wrap in <code>bool()</code>? It'd be extra strange to write this code if <code>bar</code> were a bool.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-01-26 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/andersk">@andersk</a> on 2023-01-26 22:43</div>
            <div class="timeline-body"><p>Seems better to be timid than wrong; it’s easier for the user to observe that an extra <code>bool()</code> can be removed than that a missing <code>bool()</code> should be added.</p>
<p>We could have a heuristic that checks if the test expression is a comparator that’s known to probably return boolean? (There are exceptions like <code>numpy</code> arrays and <code>z3</code> constraints, but such exceptions probably aren’t being used as an <code>if</code> test.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-01-26 23:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2240.html">astral-sh/ruff#2240</a> on 2023-01-26 23:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-26 23:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2397.html">astral-sh/ruff#2397</a> on 2023-01-31 14:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceone">@spaceone</a> on 2023-01-31 21:31</div>
            <div class="timeline-body"><p>this has been improved in 1dd9ccf7f61487781844d8efb38a1b869ec263f9:</p>
<p><code>bool()</code> wrapping is not done for comparisions anymore.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:07 UTC
    </footer>
</body>
</html>
