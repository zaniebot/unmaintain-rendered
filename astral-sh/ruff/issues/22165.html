<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can we add a rule to turn the `Invalid # ruff: noqa directive` warnings into an error? - astral-sh/ruff #22165</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Can we add a rule to turn the `Invalid # ruff: noqa directive` warnings into an error?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/22165">#22165</a>
        opened by <a href="https://github.com/yilei">@yilei</a>
        on 2025-12-23 19:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/yilei">@yilei</a> on 2025-12-23 19:04</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>When ruff sees noqa comments with the wrong format, it emits warnings like:</p>
<pre><code>warning: Invalid `# ruff: noqa` directive at path/to/file:1: expected a comma-separated list of codes (e.g., `# noqa: F401, F841`).
</code></pre>
<p>We use ruff with pre-commit. The issue we often run into is when <code>pre-commit</code> fails with real errors / autofixes, users are confused with these unrelated warnings and thinking these are the issues they need to fix but they are unrelated to their change. So we want to either have a way to silence these warnings in the output (that's https://github.com/astral-sh/ruff/issues/9792), or enable a rule to not ever allow code with invalid noqa comments merged. This FR is for the latter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-23 20:56</div>
            <div class="timeline-body"><p>Thanks for the report! I believe this is a duplicate of #8157. I agree with you and the comments there that this would be great to have, it's just a bit tricky to implement currently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-12-23 20:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
