<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>duplicate symbol definition: _malloc_printf - astral-sh/ruff #12482</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>duplicate symbol definition: _malloc_printf</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12482">#12482</a>
        opened by <a href="https://github.com/serjflint">@serjflint</a>
        on 2024-07-24 00:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/serjflint">@serjflint</a></div>
            <div class="timeline-body">

<p>Hello! Thank you for the great tool.</p>
<p>I am cross-compiling ruff 0.5.3 on Ubuntu 20.04 against <code>x86_64-apple-darwin</code> target using cargo-zigbuild. Other targets are fine, but for this one I got an error like this:</p>
<pre><code>  = note: error: duplicate symbol definition: _malloc_printf
              note: defined by /opt/zig/lib/libc/darwin/libSystem.tbd
              note: defined by /tmp/rustcmNzciC/libtikv_jemalloc_sys-d0b27344258bf71e.rlib(malloc_io.pic.o)
          

error: could not compile `ruff` (bin &quot;ruff&quot;) due to 1 previous error
</code></pre>
<p>Full trace here https://gist.github.com/serjflint/2e67f06207383c3fbddf97798dd103f8</p>
<p>Last time I was building ruff 0.3.4 (with <code>tikv-jemallocator = { version = &quot;0.5.0&quot; }</code>) about 4 months ago and it was working.My Mac OS SDK is about 1 year old.
The issue is probably related to the recent bump of tikv-jemallocator to &quot;0.6.0&quot;</p>
<p>It is not issue with ruff per se, just heads up.
I&#x27;ve filed issues <a href="https://github.com/tikv/jemallocator/issues/97">tikv/jemallocator#97</a> and <a href="https://github.com/ziglang/zig/issues/20694">ziglang/zig#20694</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-24 06:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-09-09 12:04</div>
            <div class="timeline-body"><p>Hi @serjflint. Have you been able to resolve this in the meantime?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/serjflint">@serjflint</a> on 2024-09-09 13:47</div>
            <div class="timeline-body"><blockquote>
<p>Hi @serjflint. Have you been able to resolve this in the meantime?</p>
</blockquote>
<p>Hi! I didn&#x27;t have time yet. I pinned the version for Intel + Mac OS</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-20 12:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 07:43</div>
            <div class="timeline-body"><p>I&#x27;ll close this issue for now as it isn&#x27;t actionable for us. Feel free to open a new issue or comment here if you&#x27;re able to reproduce.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 07:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 07:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-19 08:58</div>
            <div class="timeline-body"><p>Closing as I&#x27;m unable to reproduce this. Please feel free to open a new issue if you run into this again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-19 08:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:55 UTC
    </footer>
</body>
</html>
