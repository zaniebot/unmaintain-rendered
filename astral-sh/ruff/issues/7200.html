<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rule SIM118 cause autofix error - astral-sh/ruff #7200</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Rule SIM118 cause autofix error</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7200">#7200</a>
        opened by <a href="https://github.com/qarmin">@qarmin</a>
        on 2023-09-06 15:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/qarmin">@qarmin</a></div>
            <div class="timeline-body"><p>Ruff 0.0.287 (latest changes from main branch)</p>
<pre><code>ruff  *.py --select SIM118 --no-cache --fix
</code></pre>
<p>file content(at least simple cpython script shows that this is valid python file):</p>
<pre><code>class TestMTH5(unittest.TestCase):
        channel_group = self.mth5_obj.get_channel(
        )
        for key in self.experiment.surveys[0].to_dict(single=True).keys():
                self.assertEqual(
                )
        for key in (
        ):
                    self.assertEqual(
                    )
        for key in (
            self.experiment.surveys[0]
            .stations[0]
            .keys()
        ):
                continue
</code></pre>
<p>error</p>
<pre><code>/home/rafal/test/tmp_folder/35_IDX_0_RAND_169295356978468205385328.py:4:13: SIM118 Use `key in self.experiment.surveys[0].to_dict(single=True)` instead of `key in self.experiment.surveys[0].to_dict(single=True).keys()`
/home/rafal/test/tmp_folder/35_IDX_0_RAND_169295356978468205385328.py:11:13: SIM118 Use `key in self.experiment.surveys[0]
            .stations[0]` instead of `key in self.experiment.surveys[0]
            .stations[0].keys()`
Found 2 errors.

error: Autofix introduced a syntax error. Reverting all changes.

This indicates a bug in `ruff`. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BAutofix%20error%5D

...quoting the contents of `/home/rafal/test/tmp_folder/35_IDX_0_RAND_169295356978468205385328.py`, the rule codes SIM118, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

</code></pre>
<p><a href="https://github.com/astral-sh/ruff/files/12539686/python_compressed.zip">python_compressed.zip</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2023-09-06 15:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fuzzer</span> added by @MichaReiser on 2023-09-06 15:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-06 16:06</div>
            <div class="timeline-body"><p>@qarmin -- Thanks for reporting these, it's much appreciated. Do you mind holding off on filing additional fuzzer issues for autofixes while we figure out the right way to track these? E.g., we may want to create a single issue to make it easier to manage the issue tracker.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qarmin">@qarmin</a> on 2023-09-06 18:17</div>
            <div class="timeline-body"><p>No problem, especially since I have currently run out of bugs to report.</p>
<p>If I notice panic errors, I'll still report them because they occur quite rarely and won't litter the issue tracker too much.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-09-07 15:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:48:16 UTC
    </footer>
</body>
</html>
