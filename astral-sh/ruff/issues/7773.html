<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>C415 doc and/or implementation is broken - astral-sh/ruff #7773</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>C415 doc and/or implementation is broken</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/7773">#7773</a>
        opened by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a>
        on 2023-10-03 03:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on 2023-10-03 03:58</div>
            <div class="timeline-body"><p>The documentation for C415 (https://docs.astral.sh/ruff/rules/unnecessary-subscript-reversal/) states that it makes the following changes:</p>
<pre><code>Examples:
reversed(iterable[::-1])
set(iterable[::-1])
sorted(iterable)[::-1]

Use instead:
reversed(iterable)
set(iterable)
sorted(iterable, reverse=True)
</code></pre>
<p>But unless I'm doing something wrong, it doesn't:</p>
<pre><code>$ cat rev.py 
def f(iterable):
    x = reversed(iterable[::-1])
    y = set(iterable[::-1])
    z = sorted(iterable)[::-1]
    return x, y, z
$ python -m ruff check --select=C415 --fix --diff rev.py 
$ python -m ruff --version
ruff 0.0.292
</code></pre>
<p>Notice no warnings.</p>
<p>The reason I was checking this in the first place was that the first example (changing <code>reversed(iterable[::-1])</code> to <code>reversed(iterable)</code>) is obviously wrong: if Ruff did that, it would result in the eventual order of the output being the wrong way. Possibly Ruff should output just <code>iterable</code> in this case, though it doesn't feel like a common issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-03 04:03</div>
            <div class="timeline-body"><p>Yeah, that's definitely wrong.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @charliermarsh on 2023-10-03 04:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-03 04:03</div>
            <div class="timeline-body"><p>Need to figure out whether it's the docs, implementation, or both. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on 2023-10-03 04:04</div>
            <div class="timeline-body"><p>And I'm indeed doing something wrong: if <code>--fix</code> is passed, Ruff doesn't print warnings.</p>
<pre><code>$ python -m ruff check rev.py --select=C4
rev.py:2:9: C415 Unnecessary subscript reversal of iterable within `reversed()`
rev.py:3:9: C415 Unnecessary subscript reversal of iterable within `set()`
</code></pre>
<p>But that still leaves two issues:</p>
<ul>
<li>The doc example about reversed() is wrong</li>
<li>The implementation doesn't complain about the sorted() pattern the doc mentions</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-03 04:05</div>
            <div class="timeline-body"><p>(Ruff does print warnings with <code>--fix</code>; I think it's <code>--diff</code> that suppresses the warnings, since the purpose of that flag is to show fix changes.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/7774.html">astral-sh/ruff#7774</a> on 2023-10-03 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-10-03 04:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:10 UTC
    </footer>
</body>
</html>
