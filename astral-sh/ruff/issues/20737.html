<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[feature request] Add line numbers in output of `ruff analyze graph` - astral-sh/ruff #20737</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[feature request] Add line numbers in output of <code>ruff analyze graph</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/20737">#20737</a>
        opened by <a href="https://github.com/gwdekker">@gwdekker</a>
        on 2025-10-07 06:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gwdekker">@gwdekker</a></div>
            <div class="timeline-body"><p>Would it be useful to add line numbers to the output of <code>ruff analyze graph</code>? This would make it possible to fully replace the functionality of <code>tach check</code> (tach is deprecated) by having all information needed to create error messages like <a href="https://docs.gauge.sh/usage/commands/#dependency-errors">this</a>:</p>
<pre><code>&gt; tach check
‚ùå tach/check.py[L8]: Cannot import 'tach.filesystem'. Module 'tach' cannot depend on 'tach.filesystem'. 
</code></pre>
<p>For reference: this issue came up in https://github.com/astral-sh/ruff/issues/20701</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @MichaReiser on 2025-10-07 07:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">analyze</span> added by @MichaReiser on 2025-10-07 07:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-07 07:48</div>
            <div class="timeline-body"><p>I think that should be possible, unless it breaks some &quot;import-grouping&quot; that we're doing.</p>
<p>Is <code>analyze graph</code> reporting failed imports?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-07 10:26</div>
            <div class="timeline-body"><p>I think the main challenge here is that it breaks the current output format where the imports per module are just a set of paths. We would need to make this an object instead:</p>
<pre><code>{
	path: &quot;.../module.py&quot;,
	lines: [8, 10]
}
</code></pre>
<p>or similar.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2025-10-07 10:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gwdekker">@gwdekker</a> on 2025-10-07 10:50</div>
            <div class="timeline-body"><blockquote>
<p>Is <code>analyze graph</code> reporting failed imports?</p>
</blockquote>
<p>I don't know - if your question is related to the example I gave: what <code>tach</code> does is it will let you check in a <code>tach.toml</code> that records the dependencies in the repo, and then with <code>tach check</code> you would get the referenced error message if there is a mismatch between <code>tach.toml</code> and what was found in the code. I can in a few tens of lines of code recreate this core functionality of <code>tach</code> it seems, the only thing I am missing to do so is the line number showcased in that message. Hence my request.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:53:25 UTC
    </footer>
</body>
</html>
