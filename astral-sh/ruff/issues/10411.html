<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Feature Request][Pytest Rule] Enforce a strict argument being passed into pytest.mark.xfail - astral-sh/ruff #10411</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Feature Request][Pytest Rule] Enforce a strict argument being passed into pytest.mark.xfail</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10411">#10411</a>
        opened by <a href="https://github.com/rshanker779">@rshanker779</a>
        on 2024-03-14 11:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rshanker779">@rshanker779</a></div>
            <div class="timeline-body">

<p>Hi,
<a href="https://docs.pytest.org/en/latest/reference/reference.html#pytest-mark-xfail-ref">pytest.mark.xfail</a> has an optional strict argument that defaults to False. When strict is False, if an xfailed test unexpectedly passes, the test suite as a whole will not fail, but when strict is True, an unexpectedly passing test will be marked as a failure.</p>
<p>It would be nice to have a ruff rule that require the strict argument to be passed (with either value), so when writing tests with xfail it is explicit if passing cases are allowed or not.</p>
<p>Thanks
Rohan</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-14 15:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-14 15:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluetech">@bluetech</a> on 2024-03-14 18:21</div>
            <div class="timeline-body"><p>I think a better way is to set <code>xfail_strict = true</code> in the pytest config.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Kilo59">@Kilo59</a> on 2024-03-16 02:50</div>
            <div class="timeline-body"><p>I agree with @bluetech; this is the native way of globally enforcing strict xfails.
https://docs.pytest.org/en/stable/reference/reference.html#confval-xfail_strict</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/rshanker779">@rshanker779</a> on 2024-03-20 15:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jack-mcivor">@jack-mcivor</a> on 2024-03-20 16:42</div>
            <div class="timeline-body"><blockquote>
<p>I think a better way is to set <code>xfail_strict = true</code> in the pytest config.</p>
</blockquote>
<p>FWIW I discovered that there is a tool that can check this kind of configuration - see https://learn.scientific-python.org/development/guides/repo-review/. Each check has a specific code associated with it - xfail_strict is PP305, mentioned here https://learn.scientific-python.org/development/guides/pytest/#configuring-pytest</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:51 UTC
    </footer>
</body>
</html>
