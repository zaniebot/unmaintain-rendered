<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F841 is raised when `case other:` - astral-sh/ruff #4204</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>F841 is raised when <code>case other:</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4204">#4204</a>
        opened by <a href="https://github.com/mmahmoudian">@mmahmoudian</a>
        on 2023-05-03 13:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mmahmoudian">@mmahmoudian</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Ruff seems to be sensitive to <code>other</code> in match-case situation and throws <code>F841 [*] Local variable </code>other<code> is assigned to but never used</code>. For example consider this example</p>
<pre><code class="language-py">def my_func(var):
    match var:
        case 'foo':
            print('blah1')
        case 'bar':
            print('blah2')
        case other:
            print('invalid blah')


my_func('boo')
</code></pre>
<p>The <code>case other:</code> is equivalent of <code>case _:</code> but more readable, and should be treated in the same way imho.</p>
<pre><code class="language-console">‚ùØ  ruff test.py
test.py:8:14: F841 [*] Local variable `other` is assigned to but never used
Found 1 error.
[*] 1 potentially fixable with the --fix option.
</code></pre>
<p>I just installed Ruff version 0.0.261 and I have not done any Ruff specific settings</p>
<hr />
<p>P.s: I searched smong open and closed issues, but considering that the <code>match</code>, <code>case</code>, and <code>other</code> are very common words and Github returns several pages of &quot;matched issues&quot;, I might have missed seeing the correct issue and created a duplicate. I apologize if that is the case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-05-03 17:35</div>
            <div class="timeline-body"><p>Here are <a href="https://github.com/search?q=%22case+other%3A%22+language%3APython&amp;type=code">codes</a> that use the pattern <code>case other:</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmahmoudian">@mmahmoudian</a> on 2023-05-03 17:56</div>
            <div class="timeline-body"><p>Github search engine is nauseatingly bad, so even with your well-crafted query it still bring lots of false-positive. Nonetheless, in the first page of the same search there are python codes that have indeed used <code>case other:</code>.</p>
<p>Thanks for the PR. I'm n00b in Rust and also not familiar with Ruff codebase, but to me it seems in your PR, only the change in <code>crates/ruff/src/rules/pyflakes/rules/unused_variable.rs</code> is related to this issue (along with the test stuff. For instance I don't quite understand how <a href="https://github.com/charliermarsh/ruff/pull/4212/files#diff-c2c8422959405016e1fb54ca23edee9716bd06ad64e610ceea9612a8291122fcL4137-R4137">this</a> or <a href="https://github.com/charliermarsh/ruff/pull/4212/files#diff-7c1ff8e582049ed4a051f3895b903c6032838c2e427b7044296cc53c83db10f4R257">this</a> are related. üòÖ</p>
<p>Anyways, I'm glad that it was a quick fix, and thanks again for working on this  üëçüèº</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "F841 is raise when `case other:`" to "F841 is raised when `case other:`" by @mmahmoudian on 2023-05-03 17:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-05-03 18:19</div>
            <div class="timeline-body"><p>This is needed otherwise an normal assignment to a variable named <code>other</code> would be a false negative.</p>
<pre><code class="language-python">other = 1
</code></pre>
<p>The code above would not raise an error.
Only pattern assignments should ignore <code>other</code> not other assignment kinds.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CobaltCause">@CobaltCause</a> on 2023-05-03 18:40</div>
            <div class="timeline-body"><p>I'm not sure this is a good idea because other tools do not support silencing unused variable hints for <code>other</code>. Take <code>pyright</code> for example:</p>
<pre><code class="language-python">import random


def main() -&gt; None:
    match random.choice([&quot;foo&quot;, &quot;bar&quot;]):
        case &quot;foo&quot;:
            print(&quot;happy path :)&quot;)
        case other:
            print(&quot;sad path :(&quot;)

if __name__ == &quot;__main__&quot;:
    main()

</code></pre>
<pre><code>.../playground/src/playground/__main__.py
  .../playground/src/playground/__main__.py:8:14 - error: Variable &quot;other&quot; is not accessed (reportUnusedVariable)
1 error, 0 warnings, 0 informations
</code></pre>
<p>But if you change <code>other</code> to <code>_</code>, <code>pyright</code> understands that the binding is not intended to be used and will not produce an error.</p>
<p>Edit: Also, while the <code>case other:</code> search finds 346 files, a similar search for <code>case _:</code> finds ~11,600 files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmahmoudian">@mmahmoudian</a> on 2023-05-03 18:47</div>
            <div class="timeline-body"><p>The <code>other</code> is not a variable, it is a key word. I think you are looking at it the wrong way. Instead of checking what other tools do, you should see if python can correctly parse it.</p>
<p>About the popularity, I'm not surprised, people are so lazy that the first thing they do it to rename numpy to np ! As if tab completion does not exist.</p>
<p>I think the reference should be the python parser rather. If it works and python does not complaint, it is correct and Ruff or other tools should not complain.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CobaltCause">@CobaltCause</a> on 2023-05-03 18:50</div>
            <div class="timeline-body"><blockquote>
<p>The <code>other</code> is not a variable, it is a key word.</p>
</blockquote>
<p>I'm not sure what you mean by this. See below.</p>
<pre><code>$ python -c 'import keyword; print(keyword.iskeyword(&quot;other&quot;))'
False
</code></pre>
<blockquote>
<p>If it works and python does not complaint, it is correct</p>
</blockquote>
<p>Why are you using a linter at all then?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmahmoudian">@mmahmoudian</a> on 2023-05-03 18:53</div>
            <div class="timeline-body"><blockquote>
<p>Why are you using a linter at all then?</p>
</blockquote>
<p>Simple:</p>
<ol>
<li>To help me avoid mistakes before running the code</li>
<li>To help me structure my code better</li>
</ol>
<p>And I don't expect to get false alarm about a non-existing mistake üòä</p>
<p>How about you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Xiretza">@Xiretza</a> on 2023-05-03 18:56</div>
            <div class="timeline-body"><blockquote>
<p>The other is not a variable, it is a key word.</p>
</blockquote>
<p>Is it? I'm pretty sure it's just an arbitrary name, there's nothing special about <code>other</code> compared to <code>foo</code>. Why should the linter not warn when the name happens to be <code>other</code>, but should warn when it's <code>foo</code>?</p>
<p>Meanwhile <code>_</code> <em>is</em> special, it matches anything and does not bind any variables (not even <code>_</code>, which would otherwise be a valid variable name): https://peps.python.org/pep-0636/#adding-a-wildcard</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmahmoudian">@mmahmoudian</a> on 2023-05-03 19:09</div>
            <div class="timeline-body"><blockquote>
<p>it's just an arbitrary name, there's nothing special about <code>other</code> compared to <code>foo</code></p>
</blockquote>
<p>You are right. Thanks for pointing it out. I always thought it is a keyword, but literally anything there would do!!</p>
<p>I still think the linter should not complain, or at least it should complaint with a special dedicated code that can be suppressed by the user. That said, I think this feature request is mostly pointless and should be closed.</p>
<p>@Xiretza Thanks again for correcting my mistake.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Xiretza">@Xiretza</a> on 2023-05-03 19:12</div>
            <div class="timeline-body"><blockquote>
<p>it should complaint with a special dedicated code that can be suppressed by the user.</p>
</blockquote>
<p>Not sure why that would be necessary, but a good addition might be a note that <code>_</code> should be used if the result of the match is not intended to be used.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmahmoudian">@mmahmoudian</a> on 2023-05-03 19:15</div>
            <div class="timeline-body"><blockquote>
<p>Not sure why that would be necessary</p>
</blockquote>
<p>Simply because the <a href="https://www.flake8rules.com/rules/F841.html">F841</a> is &quot;Local variable name is assigned to but never used&quot; which is literally not the case here. Actually here (assuming that <code>other</code> or <code>foo</code> are variables) a variable is <strong>not</strong> defined but <strong>is</strong> used.</p>
<blockquote>
<p>a good addition might be a note that _ should be used if the result of the match is not intended to be used.</p>
</blockquote>
<p>This is a very good suggestion. But imho should not be printed along with F841 as F841 can happen else where, but <code>_</code> can not be replaced in every condition (e.g the example in the flake8rules)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Xiretza">@Xiretza</a> on 2023-05-03 19:16</div>
            <div class="timeline-body"><blockquote>
<p>Actually here (assuming that <code>other</code> or <code>foo</code> are variables) a variable is <strong>not</strong> defined but <strong>is</strong> used.</p>
</blockquote>
<p>That's not how <code>match</code> works. In this case, it assigns the content of <code>var</code> to <code>other</code> unless it's <code>&quot;foo&quot;</code> of <code>&quot;bar&quot;</code>. You then never use that variable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-04 02:41</div>
            <div class="timeline-body"><p>My feeling is that the rule is correct as-implemented. The <code>match</code> statement is defining the <code>other</code> variable, and it takes on whatever value is being matched against (it's a &quot;wildcard&quot; match, IIRC). In this case, the <code>other</code> variable is being defined, but not used. If you <em>do</em> have a fall-through case like that, I think <code>_</code> better matches the intent and Python idioms of an &quot;intentionally unused value&quot;.</p>
<p>Note that, if you feel strongly about allowing <code>other</code> specifically, you can change the <a href="https://beta.ruff.rs/docs/settings/#dummy-variable-rgx"><code>dummy-variable-rgx</code></a> in your configuration file to treat <code>other</code> as a permitted-unused value.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @mmahmoudian on 2023-05-04 02:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:06 UTC
    </footer>
</body>
</html>
