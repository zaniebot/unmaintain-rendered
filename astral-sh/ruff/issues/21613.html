<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Show diff for applied fixes - astral-sh/ruff #21613</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Show diff for applied fixes</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/21613">#21613</a>
        opened by <a href="https://github.com/travisdowns">@travisdowns</a>
        on 2025-11-24 13:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/travisdowns">@travisdowns</a> on 2025-11-24 13:11</div>
            <div class="timeline-body"><h3>Question</h3>
<p>There are a lot of questions around --fix and --diff and so on but I didn't find one that matched this condition.</p>
<p>We are trying to run <code>ruff check</code> in CI, and also in a git pre-commit hook which checks each commit when you do <code>git commit</code>.</p>
<p>The best behavior for the pre-commit hook, I think, is:</p>
<ol>
<li>Fixes are applied if possible</li>
<li>Diffs are shown for <em>all applied fixes</em> and <em>any remaining unfixable issues</em></li>
<li>Return non-zero if there any remaining issues, and the value in the case everything was fixed isn't too important for our use-case (as the pre-commit hook knows to fail if there are modified files regardless of the exit code)</li>
</ol>
<p>As far as I can tell, we can't get this behavior curently? <code>--fix</code> doens't show diffs for fixed issues. <code>--fix --diff</code> doesn't apply any fixes at all.</p>
<p>In the local git hook you want the behavior above since <code>--fix</code> lets you immediately <code>add -u</code> to stage the fixes, but you also want to see the diff so you know what happened and what the diagnostic was.</p>
<p>When running the same code in CI, you really want the console output off the diff &amp; reason since --fix does not provide a benefit there.</p>
<h3>Version</h3>
<p>ruff 0.12.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @travisdowns on 2025-11-24 13:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-24 14:20</div>
            <div class="timeline-body"><p>Is it necessary that the shown fixes are diffs?</p>
<p>If not, we changed the <code>--output-format=full</code> (the default) to show fixes when using <code>--preview</code>. I think running <code>ruff check --fix --preview</code> should then be what you're looking for (be mindful, <code>--preview</code> also enables the preview rule behavior. There's currently no way of opting in to the changed CLI behavior only)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/travisdowns">@travisdowns</a> on 2025-11-24 14:59</div>
            <div class="timeline-body"><blockquote>
<p>Is it necessary that the shown fixes are diffs?</p>
</blockquote>
<p>Not really, just some format that shows the error. I should not have said diff really: I guess the ideal format is actually the usual &quot;error is here&quot; format you get when you don't use <code>--diff</code>.</p>
<blockquote>
<p>If not, we changed the --output-format=full (the default) to show fixes when using --preview.</p>
</blockquote>
<p>Oh, that's great. So if it's <code>--preview</code> today, I can anticipate that it may show up as the default in the future (if there isn't a bunch of backlash in the meantime)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-24 15:20</div>
            <div class="timeline-body"><blockquote>
<p>Oh, that's great. So if it's --preview today, I can anticipate that it may show up as the default in the future (if there isn't a bunch of backlash in the meantime)?</p>
</blockquote>
<p>Yes, we plan on stabilizing this feature as part of our next minor, which we aim to release early January</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/travisdowns">@travisdowns</a> on 2025-11-24 15:50</div>
            <div class="timeline-body"><p>Thanks! Closing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @travisdowns on 2025-11-24 15:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:19 UTC
    </footer>
</body>
</html>
