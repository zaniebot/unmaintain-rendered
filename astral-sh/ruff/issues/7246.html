<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter: code containing long string literal is parenthesized and generates worse output - astral-sh/ruff #7246</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Formatter: code containing long string literal is parenthesized and generates worse output</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7246">#7246</a>
        opened by <a href="https://github.com/rossmacarthur">@rossmacarthur</a>
        on 2023-09-08 16:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rossmacarthur">@rossmacarthur</a></div>
            <div class="timeline-body">

<p>Thanks for this great project. I&#x27;m looking forward to a future where I will only need a single tool, I tried testing <code>ruff format</code> on a private project with about ~30 000 lines of Python code where we already use black. There were hardly any differences to black&#x27;s output. The following is the only objectively worse formatting.</p>
Code
<p><strong>Input</strong></p>
<pre><code>assert items == [
    &quot;a very very very very very very very very very very very very very very very long string&quot;,
]
</code></pre>
<p><strong><code>ruff format</code> Output</strong></p>
<pre><code>assert (
    items
    == [
        &quot;a very very very very very very very very very very very very very very very long string&quot;,
    ]
)
</code></pre>
<p><strong><code>black</code> Output</strong></p>
<pre><code>assert items == [
    &quot;a very very very very very very very very very very very very very very very long string&quot;,
]

</code></pre>
Details
<pre><code>❯ ruff --version
ruff 0.0.287
</code></pre>
<pre><code>❯ black --version
black, 23.7.0 (compiled: yes)
Python (CPython) 3.11.2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Formatter: code containing long string literal is parenthesized and to worse output containing long string literal&quot; to &quot;Formatter: code containing long string literal is parenthesized and generates worse output&quot; by <a href="https://github.com/rossmacarthur">@rossmacarthur</a> on 2023-09-08 16:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-08 17:17</div>
            <div class="timeline-body"><blockquote>
<p>I tried testing ruff format on a private project with about ~30 000 lines of Python code where we already use black. There were hardly any differences to black&#x27;s output.</p>
</blockquote>
<p>:partying_face: glad to hear that</p>
<p>Thanks for reporting. Let me double check if this is related to <a href="https://github.com/astral-sh/ruff/pull/6857">astral-sh/ruff#6857</a></p>
<p>Another consideration is that Black format&#x27;s this differently in preview style. We may decide to directly implement the new style.</p>
<p>Preview style</p>
<pre><code>assert items == [
    (
        &quot;a very very very very very very very very very very very very very very very&quot;
        &quot; long string&quot;
    ),
]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-08 17:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-08 17:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Formatter: Beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-08 17:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 10:01</div>
            <div class="timeline-body"><p>This is fixed on main https://play.ruff.rs/3ce97226-6ede-4e28-8851-8cd026bfaff6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 10:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:42 UTC
    </footer>
</body>
</html>
