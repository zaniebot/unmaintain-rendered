<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter: code containing long string literal is parenthesized and generates worse output - astral-sh/ruff #7246</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Formatter: code containing long string literal is parenthesized and generates worse output</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7246">#7246</a>
        opened by <a href="https://github.com/rossmacarthur">@rossmacarthur</a>
        on 2023-09-08 16:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/rossmacarthur">@rossmacarthur</a> on 2023-09-08 16:45</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Thanks for this great project. I'm looking forward to a future where I will only need a single tool, I tried testing <code>ruff format</code> on a private project with about ~30 000 lines of Python code where we already use black. There were hardly any differences to black's output. The following is the only objectively worse formatting.</p>
<h2>Code</h2>
<p><strong>Input</strong></p>
<pre><code class="language-python">assert items == [
    &quot;a very very very very very very very very very very very very very very very long string&quot;,
]
</code></pre>
<p><strong><code>ruff format</code> Output</strong></p>
<pre><code class="language-python">assert (
    items
    == [
        &quot;a very very very very very very very very very very very very very very very long string&quot;,
    ]
)
</code></pre>
<p><strong><code>black</code> Output</strong></p>
<pre><code class="language-python">assert items == [
    &quot;a very very very very very very very very very very very very very very very long string&quot;,
]

</code></pre>
<h2>Details</h2>
<pre><code>❯ ruff --version
ruff 0.0.287
</code></pre>
<pre><code>❯ black --version
black, 23.7.0 (compiled: yes)
Python (CPython) 3.11.2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Formatter: code containing long string literal is parenthesized and to worse output containing long string literal" to "Formatter: code containing long string literal is parenthesized and generates worse output" by @rossmacarthur on 2023-09-08 16:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-08 17:17</div>
            <div class="timeline-body"><blockquote>
<p>I tried testing ruff format on a private project with about ~30 000 lines of Python code where we already use black. There were hardly any differences to black's output.</p>
</blockquote>
<p>:partying_face: glad to hear that</p>
<p>Thanks for reporting. Let me double check if this is related to https://github.com/astral-sh/ruff/pull/6857</p>
<p>Another consideration is that Black format's this differently in preview style. We may decide to directly implement the new style.</p>
<p>Preview style</p>
<pre><code class="language-python">assert items == [
    (
        &quot;a very very very very very very very very very very very very very very very&quot;
        &quot; long string&quot;
    ),
]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2023-09-08 17:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2023-09-08 17:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Beta" by @MichaReiser on 2023-09-08 17:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 10:01</div>
            <div class="timeline-body"><p>This is fixed on main https://play.ruff.rs/3ce97226-6ede-4e28-8851-8cd026bfaff6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-09-25 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @MichaReiser on 2023-09-25 10:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:31:16 UTC
    </footer>
</body>
</html>
