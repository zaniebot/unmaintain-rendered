<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>line length wraps types + comments in brackets - astral-sh/ruff #17096</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>line length wraps types + comments in brackets</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/17096">#17096</a>
        opened by <a href="https://github.com/hyperknot">@hyperknot</a>
        on 2025-03-31 16:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hyperknot">@hyperknot</a> on 2025-03-31 16:10</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>A very interesting thing is going on with types + comments.</p>
<p>If I put line length to 88, it keeps it on a single line.
If I put it to 100, it wraps it within brackets and makes it 3 lines.</p>
<p>My editor is giving a warning that &quot;value must be a type&quot;.</p>
<p>Playground:
https://play.ruff.rs/dc35fb3f-3836-41c0-a1fb-3c85e4323926</p>
<h3>Version</h3>
<p>ruff 0.11.2 (4773878ee 2025-03-21)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> added by @MichaReiser on 2025-03-31 16:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-31 16:12</div>
            <div class="timeline-body"><p>Hi @hyperknot</p>
<p>I'm sorry but I don't understand what isn't working. Is it the formatted output that wraps after 88 characters? What output would you expect?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hyperknot">@hyperknot</a> on 2025-03-31 16:15</div>
            <div class="timeline-body"><p>On the default 88, it does NOT wrap.
On 100 it does wrap.</p>
<p>One of them is wrong.</p>
<p>Is this correct?</p>
<pre><code>class ThreadDetailsDict(TypedDict):
    last_message_sent_by_me: (
        bool  # True if last msg sender domain is in my_domains or sender email is in my_emails
    )
</code></pre>
<p>Based on my editor this is wrong, but my editor might be wrong here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hyperknot">@hyperknot</a> on 2025-03-31 16:18</div>
            <div class="timeline-body"><p>So the question is:</p>
<ol>
<li>Can a type + comment be wrapped in a bracket? My editor thinks not.</li>
<li>Fix either 88's or 100's behaviour. The line is 117 charaters.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-31 16:23</div>
            <div class="timeline-body"><blockquote>
<p>On the default 88, it does NOT wrap.
On 100 it does wrap.</p>
</blockquote>
<p>This is expected, and I agree it can be somewhat confusing. The formatter only wraps the line if it fits into the configured line length when put in parentheses. It avoids wrapping if the line, even if wrapped, still exceeds the configured line length.</p>
<p>Yes, Python allows wrapping type annotations. This runs fine:</p>
<pre><code class="language-py">&gt;&gt;&gt; from typing import TypedDict
&gt;&gt;&gt; class ThreadDetailsDict(TypedDict):
...     last_message_sent_by_me: (
...         bool  # True if last msg sender domain is in my_domains or sender email is in my_emails
...     )
...
&gt;&gt;&gt;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hyperknot">@hyperknot</a> on 2025-03-31 16:35</div>
            <div class="timeline-body"><p>OK, so both are correct and PyCharms is wrong.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @hyperknot on 2025-03-31 16:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hyperknot">@hyperknot</a> on 2025-03-31 16:35</div>
            <div class="timeline-body"><p>Thanks for the quick help!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-31 16:42</div>
            <div class="timeline-body"><p>You're welcome. I'm surprised that Pycharm flags this. I'm not sure why. Even mypy thinks this is fine https://mypy-play.net/?mypy=1.8.0&amp;python=3.13&amp;gist=aee4eca148a276577c2567b8fac9f691</p>
<p>It seems to be specific to <code>TypedDict</code>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:17 UTC
    </footer>
</body>
</html>
