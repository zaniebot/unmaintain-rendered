```yaml
number: 20225
title: Add a way to tell N805 that a class definition is a metaclass
type: issue
state: closed
author: flying-sheep
labels:
  - type-inference
assignees: []
created_at: 2025-09-04T09:26:41Z
updated_at: 2025-09-08T17:09:15Z
url: https://github.com/astral-sh/ruff/issues/20225
synced_at: 2026-01-10T01:56:57Z
```

# Add a way to tell N805 that a class definition is a metaclass

---

_Issue opened by @flying-sheep on 2025-09-04 09:26_

### Summary

consider the following:

```py
class BaseMeta(type): pass
class MyMeta(BaseMeta):
    def thing(cls):  # <- N805
        assert isinstance(cls, type)


# runtime tests
import pytest
class MyCls(metaclass=MyMeta): pass

MyCls.thing()
with pytest.raises(AttributeError):
    MyCls().thing()
```

Ruff will flag `thing` as a [`N805`](https://docs.astral.sh/ruff/rules/invalid-first-argument-name-for-method/) violation, thinking that `MyMeta` is a regular class and should have `self` as first arg name.

The only way around it is adding `type` to `MyMeta`’s base classes, which is probably fine, but it is a code change just to make Ruff understand something.

Would be great if there could be way to make Ruff understand which doesn’t require code changes, like a `lint.pep8-naming.metaclasses` option (or something smarter / more general if you can come up with something)

---

_Renamed from "Mark classes as metaclasses for N805" to "Add a way to tell N805 that a class definition is a metaclass" by @flying-sheep on 2025-09-04 09:37_

---

_Comment by @ntBre on 2025-09-05 15:58_

I'm not seeing N805 on this example in the [playground](https://play.ruff.rs/1b521c60-98ec-4318-b367-8511c47bc205) or in a local CLI test. I can reproduce this if `BaseMeta` is defined in a different file, though, in which case this would be a multi-file analysis limitation.

---

_Label `type-inference` added by @ntBre on 2025-09-05 15:58_

---

_Comment by @flying-sheep on 2025-09-07 13:02_

You’re right! What’s the plan with multi-file analysis?

And what about morecomplex siutations, like if the meta base class is imported from a 3rd party package? `ty` has to do it like that, might Ruff in the future be able to be run in an environment-enabled mode where it leverages `ty`’s global analysis?

---

_Comment by @ntBre on 2025-09-08 13:50_

Yeah, we've grouped the multi-file analysis with type-inference in our GitHub labels since ty handles them both. The hope is that we can reuse some of that infrastructure in the future!

---

_Comment by @flying-sheep on 2025-09-08 17:09_

OK! Then I’ll just `noqa` it and close this, I assume it’ll come at some point automatically (no reason not to make things like this automatically multi-file once the infrastructure exists)

---

_Closed by @flying-sheep on 2025-09-08 17:09_

---
