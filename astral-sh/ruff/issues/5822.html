<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter: Ellipses in stub files get formatted on a single line - astral-sh/ruff #5822</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Formatter: Ellipses in stub files get formatted on a single line</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5822">#5822</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2023-07-17 06:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>If a class, method or function is stub out with an ellipsis (<code>...</code>), black gives them their own line in python files and appends them end-of-line after the colon in stub files:</p>
<p><strong>scratch.py</strong></p>
<pre><code class="language-python">class Animal:
    ...


class Cat(Animal):
    def meow(self):
        ...


def f():
    ...
</code></pre>
<p><strong>scratch.pyi</strong></p>
<pre><code class="language-python">class Animal: ...

class Cat(Animal):
    def meow(self): ...

def f(): ...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @konstin on 2023-07-17 06:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-17 07:34</div>
            <div class="timeline-body"><p>Note: This requires tracking the source type and passing it to the formatter context.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Stable" by @MichaReiser on 2023-07-31 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/andersk">@andersk</a> on 2023-08-02 19:03</div>
            <div class="timeline-body"><p>With any luck, Black will soon be changing here to allow the concise form in both <code>.py</code> and <code>.pyi</code> files.</p>
<ul>
<li>psf/black#1797</li>
<li>psf/black#3796</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-03 09:59</div>
            <div class="timeline-body"><p>Applying the same formatting for source and stub files would be nice, and it would also reduce formatter complexity because it gives us one variable that changes formatting less.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2023-08-04 01:58</div>
            <div class="timeline-body"><p>Black still handles other things (like whitespace) differently between py and pyi, so you'll still need to put source type in formatter context if you wish to format stub files like Black does.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-04 05:48</div>
            <div class="timeline-body"><p>We should probably implement this anyway for now, because the change will be part of Black's new preview style.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-04 07:38</div>
            <div class="timeline-body"><p>Added the file type information to the context #6331</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @konstin on 2023-08-10 08:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @konstin on 2023-08-10 08:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-10 08:45</div>
            <div class="timeline-body"><p><code>PyFormatOptions</code> now has a <code>source_type</code> field</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-08-21 07:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Formatter: Stable" by @MichaReiser on 2023-08-22 14:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Alpha" by @MichaReiser on 2023-08-22 14:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/saulshanabrook">@saulshanabrook</a> on 2024-02-16 21:16</div>
            <div class="timeline-body"><p>Hey! I would love to try to adopt this formatting in my normal Python files as well. I saw that black I believe supports this under the next flag and was curious if that might be possible to support in ruff too.</p>
<hr />
<p>For what it's worth, my use case is for <a href="https://egglog-python.readthedocs.io/latest/">a library</a> that allows other libraries to create DSLs based off uninterpreted functions, so none of them will have bodies. I have <a href="https://egraphs.zulipchat.com/#narrow/stream/375765-egg.2Fegglog/topic/egglog.20python.20midlevel.20api/near/421923656">gotten some feedback</a> that it's annoying that it takes an extra line for every definition.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-16 21:20</div>
            <div class="timeline-body"><p>@saulshanabrook You can give it a try by running the formatter with <code>--preview</code>. We plan to release the new preview styles soon. See https://github.com/astral-sh/ruff/issues/8678</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/saulshanabrook">@saulshanabrook</a> on 2024-02-16 21:33</div>
            <div class="timeline-body"><p>Oh wow, thank you @MichaReiser! That's great!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:41 UTC
    </footer>
</body>
</html>
