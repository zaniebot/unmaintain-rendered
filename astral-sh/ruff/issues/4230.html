<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cascading per-file-ignores - astral-sh/ruff #4230</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cascading per-file-ignores</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4230">#4230</a>
        opened by <a href="https://github.com/nstarman">@nstarman</a>
        on 2023-05-04 19:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/nstarman">@nstarman</a> on 2023-05-04 19:43</div>
            <div class="timeline-body"><p>In Astropy, for various reasons we want to separate our ruff config into <code>pyproject.toml</code>, where the &quot;official&quot; ruff config lives, and <code>.ruff.toml</code>, where we have our <code>ignore</code> list of things we intend to fix.
In the <code>.ruff.toml</code> we want to use <code>extend = &quot;pyproject.toml&quot;</code> to make this all work.
However, we've found that <code>per-file-ignores</code> don't seem to cascade, so only the config in <code>.ruff.toml</code> gets picked up.
I believe this is a bug, or I just haven't implemented <code>extend</code> correctly ðŸ˜†.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-04 19:45</div>
            <div class="timeline-body"><p>Two quick questions: Do you have different <code>per-file-ignores</code> defined in both, or only in the &quot;parent&quot; configuration? And are the configuration files in the same directory?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-05-04 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nstarman">@nstarman</a> on 2023-05-04 19:52</div>
            <div class="timeline-body"><p>We have it defined in both. In <code>pyproject.toml</code> are the permanent settings and in <code>.ruff.toml</code> we have the temporary settings related to the incremental nature of fixing an <code>ignore</code>. And yes, both config files are at the same directory level.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-05-04 20:07</div>
            <div class="timeline-body"><p>Ah okay, yeah we don't currently &quot;merge&quot; properties across configuration files, with the exception of the <code>extend-*</code> properties, like <code>extend-ignore</code>. So this is working as intended, though it'd be reasonable to suggest that it should be changed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nstarman">@nstarman</a> on 2023-05-04 20:12</div>
            <div class="timeline-body"><p>Ah, thanks for the clarification! Yes, some type of per-file-ignore merge would be excellent and very helpful to us!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aacunningham">@aacunningham</a> on 2023-05-04 22:21</div>
            <div class="timeline-body"><p>So would the idea be to create a new <code>extend-per-file-ignores</code> so that <code>per-file-ignore</code> still behaves as expected (like the rest of the non-merging settings)? Or maybe <code>per-file-ignores</code> makes sense to merge?</p>
<p>Out of curiosity, what's the benefit of the separate files as opposed to leaving it all in the <code>pyproject.toml</code> with a comment to differentiate the two sections of the <code>per-file-ignores</code> table (like <code>#Temporary ignores</code>)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nstarman">@nstarman</a> on 2023-05-04 22:46</div>
            <div class="timeline-body"><p>Either means is fine with us! Given that <code>extend-ignore</code> is deprecated, perhaps <code>per-file-ignores</code> should be allowed to cascade.</p>
<p>Separate files is useful for us ATM because of GH Codeowner auto PR review request settings while we work through the TODOs. Basically, we are working to move project configuration from setup.cfg to pyproject.toml and are looking to distinguish those PRs from ruff ones.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aacunningham">@aacunningham</a> on 2023-05-06 22:42</div>
            <div class="timeline-body"><p>Aight ya gotcha. Well I think implementing this seems pretty straightforward, I'd be down to give it a whirl. Making it cascade in the same way some of the other rules do makes sense, unless someone more knowledgeable of the project's has other ideas on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-05-19 16:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:30:00 UTC
    </footer>
</body>
</html>
