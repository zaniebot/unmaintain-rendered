<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autofix B006 (mutable-argument-default) - astral-sh/ruff #4693</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Autofix B006 (mutable-argument-default)</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/4693">#4693</a>
        opened by <a href="https://github.com/auscompgeek">@auscompgeek</a>
        on 2023-05-28 12:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/auscompgeek">@auscompgeek</a> on 2023-05-28 12:58</div>
            <div class="timeline-body"><p>B006 could have an autofixer to instead make the default <code>None</code> and check if it is <code>None</code> within the function.</p>
<p><a href="https://github.com/lensvol/pybetter#readme">pybetter</a> includes a fixer for this:</p>
<blockquote>

<p><strong>Default values for <code>kwargs</code> are mutable.</strong></p>
<p>As described in <a href="https://docs.python-guide.org/writing/gotchas/#mutable-default-arguments">Common Gotchas</a> section of &quot;The Hitchhiker's Guide to Python&quot;, mutable arguments can be a tricky thing. This fixer replaces any default values that happen to be lists or dicts with None value, moving initialization from function definition into function body.</p>
<pre><code class="language-python"># BEFORE
def p(a=[]):
    print(a)

# AFTER
def p(a=None):
    if a is None:
        a = []
    
    print(a)
</code></pre>
<p>Be warned, that this fix may break code which <em>intentionally</em> uses mutable default arguments (e.g. caching).</p>
</blockquote>

<p>This <em>may</em> want to also autofix the type hint to be <code>Optional</code> if there is one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autofix</span> added by @charliermarsh on 2023-05-29 03:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-06-04 12:43</div>
            <div class="timeline-body"><p>I'll give this one a go</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @qdegraaf by @MichaReiser on 2023-06-05 06:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4880.html">astral-sh/ruff#4880</a> on 2023-06-05 21:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/6131.html">astral-sh/ruff#6131</a> on 2023-07-27 16:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2023-08-10 11:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:09 UTC
    </footer>
</body>
</html>
