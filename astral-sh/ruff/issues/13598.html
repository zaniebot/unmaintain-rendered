<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New rule: warn on use of `timedelta.seconds`, users typically wanted `timedelta.total_seconds()` - astral-sh/ruff #13598</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>New rule: warn on use of <code>timedelta.seconds</code>, users typically wanted <code>timedelta.total_seconds()</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13598">#13598</a>
        opened by <a href="https://github.com/Zac-HD">@Zac-HD</a>
        on 2024-10-01 23:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Zac-HD">@Zac-HD</a> on 2024-10-01 23:01</div>
            <div class="timeline-body"><p>c.f. https://github.com/python/cpython/pull/124811</p>
<p>I've opened this directly on <code>ruff</code> because it seems like a great candidate for type-inference-enhanced linting; we could also put a similar rule in <code>flake8-bugbear</code> with with a noticeable false-alarm rate; that'd be acceptable if we had to but I'm hoping <code>ruff</code> gives us a better option ðŸ™‚</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @zanieb on 2024-10-01 23:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @zanieb on 2024-10-01 23:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pganssle">@pganssle</a> on 2024-10-02 21:42</div>
            <div class="timeline-body"><p>Not sure I'm a big fan of a default-on lint warning for <em>any</em> access of what is, after all, a valid attribute on <code>timedelta</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-02 21:49</div>
            <div class="timeline-body"><p>I don't think this needs to be &quot;default-on&quot;, though it is a correctness rule and I think we'd typically want those on by default. I agree a false positive seems annoying though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Zac-HD">@Zac-HD</a> on 2024-10-02 21:59</div>
            <div class="timeline-body"><p>Warn only if you access <code>.seconds</code> <em>and not also</em> any other attribute?</p>
<pre><code class="language-python">d1 = timedelta(...)
print(f&quot;{dt.days=} and {d1.seconds}&quot;)  # OK because .days (or `.microseconds`) accessed in same scope

d2 = timedelta(...)
print(f&quot;duration={d2.seconds} seconds&quot;)  # lint error because only .seconds accessed, likely a bug
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pganssle">@pganssle</a> on 2024-10-31 18:28</div>
            <div class="timeline-body"><blockquote>
<p>Warn only if you access <code>.seconds</code> <em>and not also</em> any other attribute?</p>
<pre><code class="language-python">d1 = timedelta(...)
print(f&quot;{dt.days=} and {d1.seconds}&quot;)  # OK because .days (or `.microseconds`) accessed in same scope

d2 = timedelta(...)
print(f&quot;duration={d1.seconds} seconds&quot;)  # lint error because only .seconds accessed, likely a bug
</code></pre>
</blockquote>
<p>I did a quick look through my work's internal code base and found a huge number of instances of these. Out of a random sample of 30 instances of <code>.seconds</code> access on a <code>timedelta</code>, 26 were definitely doing the wrong thing, 2 were &quot;borderline&quot; cases and 2 were doing the right thing. All of the &quot;borderline&quot; and &quot;good&quot; cases were situations where another attribute was accessed on the <code>timedelta</code>, and there were no bad cases that also involved accessing other attributes. It might be good to do a more thorough survey (one company's internal code base is hardly representative of all code out there), but to me the &quot;lint error if only <code>.seconds</code> is accessed&quot; rule seems reasonably solid.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:35:17 UTC
    </footer>
</body>
</html>
