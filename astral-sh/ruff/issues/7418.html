<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>False positive for PERF401 when using assignment expression - astral-sh/ruff #7418</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>False positive for PERF401 when using assignment expression</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/7418">#7418</a>
        opened by <a href="https://github.com/mounirmesselmeni">@mounirmesselmeni</a>
        on 2023-09-15 20:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mounirmesselmeni">@mounirmesselmeni</a> on 2023-09-15 20:11</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Hello,</p>
<p>the PERF401 is giving false positive when using <a href="https://peps.python.org/pep-0572/">Python's assignment expression</a></p>
<p>Python version: 3.11.5
ruff: 0.0.287</p>
<p>Example code:</p>
<pre><code class="language-python">results = []
for x in [0, 1, 2, 3, 4]:
    if result := my_func(x):
        results.append(result)
</code></pre>
<p>Screenshot from VSCode
<img width="708" alt="image" src="https://github.com/astral-sh/ruff/assets/1055731/ed6acf0f-a384-4a95-9f73-3c6391cb2bb4"></p>
<p>PS: Thanks for this great library and amazing work you're doing!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-15 20:19</div>
            <div class="timeline-body"><p>Thanks for the kind words :)</p>
<p>I think this snippet <em>can</em> be rewritten as:</p>
<pre><code class="language-python">results = [
    result for x in [0, 1, 2, 3, 4] if (result := my_func(x))
]
</code></pre>
<p>Though it's a bit less clear than the originating code, so I'm unsure whether to recommend it or not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mounirmesselmeni">@mounirmesselmeni</a> on 2023-09-15 20:27</div>
            <div class="timeline-body"><p>Nice one!</p>
<p>Yeah, you can see with the community tbh if Ruff should ignore those use case or not.</p>
<p>For myself now, I can live with this ðŸ˜„  Thanks again @charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @mounirmesselmeni on 2023-09-15 20:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jamesbraza">@jamesbraza</a> on 2024-10-03 23:06</div>
            <div class="timeline-body"><p>For posterity/linking, this is a dupe of https://github.com/astral-sh/ruff/issues/6056</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:10 UTC
    </footer>
</body>
</html>
