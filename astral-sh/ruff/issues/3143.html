<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For pre-commits, should ruff run before or after black? - astral-sh/ruff #3143</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>For pre-commits, should ruff run before or after black?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3143">#3143</a>
        opened by <a href="https://github.com/bellini666">@bellini666</a>
        on 2023-02-22 20:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bellini666">@bellini666</a> on 2023-02-22 20:43</div>
            <div class="timeline-body"><p>The documentation doesn't specify if ruff should run before or after black for best results.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "For pre-commits, should ruff run before or after black" to "For pre-commits, should ruff run before or after black?" by @bellini666 on 2023-02-22 20:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-22 20:51</div>
            <div class="timeline-body"><p>Before! I can add a note.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-22 21:53</div>
            <div class="timeline-body"><p>(We test in CI that running Ruff, then Black, then Ruff again is a stable operation.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-02-22 22:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/onerandomusername">@onerandomusername</a> on 2023-02-23 01:36</div>
            <div class="timeline-body"><p>Out of curiosity, why does the order matter? I run black before I run ruff because black might fix some things that a linter would otherwise complain about, so it keeps actual errors to a minimum.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-23 01:48</div>
            <div class="timeline-body"><p>Ruff's autofixes aren't guaranteed to output Black-compatible code. They often do, but it's not guaranteed. So running Black, then Ruff, then Black could result in changes on each invocation (whereas running Ruff, then Black should always be stable). (By &quot;Black-compatible&quot;, I mean code that Black would <em>not</em> reformat.)</p>
<p>As a silly example, imagine we're converting a lambda to a function definition. When we do that, we don't take line lengths into account, and we certainly don't take all of Black's possible line length wrapping behaviors into account. So if you had a lambda with a ton of arguments, we might yield a function definition on one very long line, which Black would then wrap.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/onerandomusername">@onerandomusername</a> on 2023-02-23 18:33</div>
            <div class="timeline-body"><p>Ah, so it only needs to run first <em>when autofix is enabled</em>. That makes more sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-23 18:34</div>
            <div class="timeline-body"><p>Correct!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:29:28 UTC
    </footer>
</body>
</html>
