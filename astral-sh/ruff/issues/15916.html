<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Detect Unbound Local Variables in Conditional Branches - astral-sh/ruff #15916</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Detect Unbound Local Variables in Conditional Branches</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/15916">#15916</a>
        opened by <a href="https://github.com/rodolfo-nobrega">@rodolfo-nobrega</a>
        on 2025-02-03 18:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/rodolfo-nobrega">@rodolfo-nobrega</a> on 2025-02-03 18:35</div>
            <div class="timeline-body"><h3>Description</h3>
<h4><strong>Description</strong></h4>
<p>Currently, Ruff does not detect cases where a variable might be referenced before being assigned due to a missing branch in a conditional statement. This can lead to runtime errors such as <code>UnboundLocalError</code>.</p>
<h4><strong>Example of the Issue</strong></h4>
<p>Consider the following function:</p>
<pre><code class="language-python">def test(x):
    if x == 1:
        a = 3
    return a  # Potential UnboundLocalError
</code></pre>
<p>If <code>x != 1</code>, then <code>a</code> is never assigned, causing an error when the function tries to return <code>a</code>:</p>
<pre><code>UnboundLocalError: cannot access local variable 'a' where it is not associated with a value
</code></pre>
<p>This kind of error can be subtle and hard to debug in larger codebases, making it a good candidate for static analysis.</p>
<h4><strong>Proposed Solution</strong></h4>
<p>Ruff should provide a warning when a variable is used before being assigned in all possible execution paths. This check could function similarly to how other linters (e.g., PyLintâ€™s <code>used-before-assignment</code> warning) identify potential uninitialized variables.</p>
<h4><strong>Example of Expected Behavior</strong></h4>
<p>Ruff should warn about the unbound variable in the following function:</p>
<pre><code class="language-python">def test(x):
    if x == 1:
        a = 3
    return a  # Warning: Variable 'a' might be used before assignment
</code></pre>
<h4><strong>Why This Would Be Useful</strong></h4>
<ul>
<li>Prevents runtime errors due to uninitialized variables.</li>
<li>Helps catch logical issues in conditionally assigned variables.</li>
<li>Improves code safety and maintainability.</li>
</ul>
<p>Would this be feasible to implement in Ruff? Thanks for considering this request! ðŸš€</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-02-03 19:26</div>
            <div class="timeline-body"><p>Thanks for the well written issue.</p>
<p>We're working on an improve semantic model (red knot) and a type checker. Both support the above but it will take a while before the improvements make it back into ruff.</p>
<p>This is related to https://github.com/astral-sh/ruff/issues/13296</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-02-03 19:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @MichaReiser on 2025-02-03 19:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rodolfo-nobrega">@rodolfo-nobrega</a> on 2025-02-03 22:47</div>
            <div class="timeline-body"><p>Thanks for the update! I think Ruff is incredible, and itâ€™s amazing to see the power of Rust in action for this kind of application. I really appreciate all the work youâ€™re putting into it and look forward to seeing these improvements in the future!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @rodolfo-nobrega on 2025-02-03 22:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:15 UTC
    </footer>
</body>
</html>
