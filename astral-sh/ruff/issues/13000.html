<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Importing and Referencing a Sub Module will eliminate necessary import code - astral-sh/ruff #13000</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Importing and Referencing a Sub Module will eliminate necessary import code</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13000">#13000</a>
        opened by <a href="https://github.com/csotto">@csotto</a>
        on 2024-08-20 01:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/csotto">@csotto</a> on 2024-08-20 01:50</div>
            <div class="timeline-body"><h3>ruff 0.6.1</h3>
<p>ruff check ruff_PR.py --isolated</p>
<h2>PROBLEM</h2>
<p>If requested to fix F401 ruff will eliminate line 2  (from pyannotate_runtime import collect_types) causing the error below:</p>
<p>Traceback (most recent call last):
File &quot;D:_GIT_sources\cryptoinvestccxt\lixo\ruff_PR.py&quot;, line 6, in <module>
par.collect_types.init_types_collection()
^^^^^^^^^^^^^^^^^
AttributeError: module 'pyannotate_runtime' has no attribute 'collect_types'</p>
<h2>SAMPLE CODE TO REPRODUCE:</h2>
<pre><code>import pyannotate_runtime as par
from pyannotate_runtime import collect_types
# from par import collect_types

if __name__ == &quot;__main__&quot;:
    par.collect_types.init_types_collection()
    par.collect_types.collect()
    a = 1
    print(&quot;Dumping pyannotate...&quot;)
    par.collect_types.dump_stats('ruff_PR_type_info.json')
</code></pre>
<h3>Run Result</h3>
<pre><code>$  ruff check ruff_PR.py --isolated
ruff_PR.py:2:32: F401 [*] `pyannotate_runtime.collect_types` imported but unused
  |
1 | import pyannotate_runtime as par
2 | from pyannotate_runtime import collect_types
  |                                ^^^^^^^^^^^^^ F401
3 | # from par import collect_types
  |
  = help: Remove unused import: `pyannotate_runtime.collect_types`

Found 1 error.
[*] 1 fixable with the `--fix` option.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @dhruvmanila on 2024-08-20 03:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-20 03:11</div>
            <div class="timeline-body"><p>This seems tricky without multi-file analysis. It seems that the <code>collect_types</code> module isn't re-exported in the <code>__init__.py</code> file, so using these two imports one can access the <code>collect_types</code> module either directly or via the <code>par</code> import but not without importing the <code>collect_types</code> module.</p>
<p>@csotto For the time being, I think you can safely remove the <code>import pyannotate_runtime as par</code> import and use <code>collect_types</code> directly.</p>
<p>Related issues: #11448, #4656, #60</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Importing and Referencing a Sub Module will eliminate necessary code" to "Importing and Referencing a Sub Module will eliminate necessary import code" by @csotto on 2024-08-20 15:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/csotto">@csotto</a> on 2024-08-20 16:06</div>
            <div class="timeline-body"><p>@dhruvmanila Thanks for your comment. I agree.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:14 UTC
    </footer>
</body>
</html>
