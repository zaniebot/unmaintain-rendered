<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff and black get into a fight over imports? - astral-sh/ruff #1307</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff and black get into a fight over imports?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1307">#1307</a>
        opened by <a href="https://github.com/alex">@alex</a>
        on 2022-12-21 00:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/alex">@alex</a></div>
            <div class="timeline-body"><p>Hi, I&#x27;m trying out using ruff on https://github.com/pyca/cryptography</p>
<p>If I use <code>flake8-to-rust setup.cfg</code> and then copy that into <code>pyproject.toml</code> and then I run <code>ruff .</code> it complains about many things. So I run <code>ruff --fix .</code> and it is happy, but then running <code>black src/ tests/</code> reformats things back.</p>
<p>It&#x27;s my understanding that ruff is supposed to play nicely with black, but I&#x27;m not positive which side is at fault here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-21 01:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-21 01:05</div>
            <div class="timeline-body"><p>Oh, hi, thanks for trying Ruff!</p>
<p>I believe that the source of disagreement comes from a difference in <code>line-length</code> settings. So Ruff is formatting imports based on a line length of 88 (its default, the same as Black&#x27;s default), but Black is formatting based on <code>line-length = 79</code> from the <code>pyproject.toml</code>, and the difference is causing them to repeatedly correct each others&#x27; line breaks.</p>
<p>If you add this to the <code>pyproject.toml</code>, it should stabilize them:</p>
<pre><code>[tool.ruff]
line-length = 79
</code></pre>
<p>(Note that it&#x27;s normal for a <code>black</code> invocation after a <code>ruff --fix .</code> to result in changes, but that running <code>ruff --fix .</code> over the changed files should <em>not</em> cause any further changes.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-21 01:06</div>
            <div class="timeline-body"><p>(I should upgrade <code>flake8-to-ruff</code> to respect <code>tool.black.line-length</code>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-21 01:10</div>
            <div class="timeline-body"><p>(I ran this over <code>cryptography</code> and it seemed to work correctly, but let me know if you continue to see issues.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alex">@alex</a> on 2022-12-21 01:14</div>
            <div class="timeline-body"><p>ahhhhhh. indeed, that was the magic piece. thank you! I&#x27;m mortified I missed that and therefore totally misdiagnosed this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/alex">@alex</a> on 2022-12-21 01:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-21 01:16</div>
            <div class="timeline-body"><p>No, all good! (It looks like we do preserve Flake8&#x27;s <code>max-line-length</code> setting, but not the Black variant from <code>pyproject.toml</code>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alex">@alex</a> on 2022-12-21 01:21</div>
            <div class="timeline-body"><p>with that squared away, adoption was trivial: <a href="https://github.com/pyca/cryptography/pull/7920">pyca/cryptography#7920</a></p>
<p>Great job!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-21 01:27</div>
            <div class="timeline-body"><p>Woah, that&#x27;s awesome! Thanks tons for trying it out. (I&#x27;m glad <code>flake8-to-ruff</code> worked for you too, I&#x27;ve been wondering whether that was worth maintaining :))</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alex">@alex</a> on 2022-12-21 01:34</div>
            <div class="timeline-body"><p>It was a big time saver. The two bits i had to manually translate were the line-lengths, and <code>application-import-names</code> (which is from <code>flake8-import-order</code>).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:28 UTC
    </footer>
</body>
</html>
