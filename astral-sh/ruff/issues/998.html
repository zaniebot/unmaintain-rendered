<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement flake8-simplify - astral-sh/ruff #998</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement flake8-simplify</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/998">#998</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2022-12-02 15:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>Python-specific rules:</p>
<ul>
<li>[x] <code>SIM101</code> (&quot;Multiple isinstance-calls which can be merged into a single call by using a tuple as a second argument&quot;)</li>
<li>[x] <code>SIM105</code> (&quot;Use 'contextlib.suppress(...)' instead of try-except-pass&quot;)</li>
<li>[x] <code>SIM107</code> (&quot;Don't use <code>return</code> in try/except and finally &quot;)</li>
<li>[x] <code>SIM108</code> (&quot;Use the ternary operator if it's reasonable &quot;)</li>
<li>[x] <code>SIM109</code> (&quot;Use a tuple to compare a value against multiple values&quot;)</li>
<li>[x] <code>SIM110</code> (&quot;Use <a href="https://docs.python.org/3/library/functions.html#any">any(...)</a> &quot;)</li>
<li>[x] <code>SIM111</code> (&quot;Use <a href="https://docs.python.org/3/library/functions.html#all">all(...)</a>&quot;)</li>
<li>[x] <code>SIM113</code> (&quot;Use enumerate instead of manually incrementing a counter&quot;)</li>
<li>[x] <code>SIM114</code> (&quot;Combine conditions via a logical or to prevent duplicating code&quot;)</li>
<li>[x] <code>SIM115</code> (&quot;Use context handler for opening files&quot;)</li>
<li>[x] <code>SIM116</code> (&quot;Use a dictionary instead of many if/else equality checks&quot;)</li>
<li>[x] <code>SIM117</code> (&quot;Merge with-statements that use the same scope&quot;)</li>
</ul>
<p>Simplifying Comparisons:</p>
<ul>
<li>[x] <code>SIM201</code> (&quot;Use 'a != b' instead of 'not a == b'&quot;)</li>
<li>[x] <code>SIM202</code> (&quot;Use 'a == b' instead of 'not a != b'&quot;)</li>
<li>[x] <code>SIM203</code> (&quot;Use 'a not in b' instead of 'not (a in b)'&quot;)</li>
<li>[x] <code>SIM208</code> (&quot;Use 'a' instead of 'not (not a)'&quot;)</li>
<li>[x] <code>SIM210</code> (&quot;Use 'bool(a)' instead of 'True if a else False'&quot;)</li>
<li>[x] <code>SIM211</code> (&quot;Use 'not a' instead of 'False if a else True'&quot;)</li>
<li>[x] <code>SIM212</code> (&quot;Use 'a if a else b' instead of 'b if not a else a'&quot;)</li>
<li>[x] <code>SIM220</code> (&quot;Use 'False' instead of 'a and not a'&quot;)</li>
<li>[x] <code>SIM221</code> (&quot;Use 'True' instead of 'a or not a'&quot;)</li>
<li>[x] <code>SIM222</code> (&quot;Use 'True' instead of '... or True'&quot;)</li>
<li>[x] <code>SIM223</code> (&quot;Use 'False' instead of '... and False'&quot;)</li>
<li>[x] <code>SIM300</code> (&quot;Use 'age == 42' instead of '42 == age'&quot;)</li>
</ul>
<p>Simplifying usage of dictionaries:</p>
<ul>
<li>[x] <code>SIM401</code> (&quot;Use 'a_dict.get(key, &quot;default_value&quot;)' instead of an if-block&quot;)</li>
<li>[x] <code>SIM118</code> (&quot;Use 'key in dict' instead of 'key in dict.keys()'&quot;)</li>
</ul>
<p>General Code Style:</p>
<ul>
<li>[x] <code>SIM102</code> (&quot;Use a single if-statement instead of nested if-statements&quot;)</li>
<li>[x] <code>SIM103</code> (&quot;Return the boolean condition directly&quot;)</li>
<li>[x] <code>SIM112</code> (&quot;Use CAPITAL environment variables&quot;)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2022-12-02 15:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-02 16:50</div>
            <div class="timeline-body"><p>This plugin is particularly useful because we should be able to autofix most of these.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> removed by @charliermarsh on 2022-12-31 18:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2022-12-31 18:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @charliermarsh on 2023-01-04 01:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-04 20:44</div>
            <div class="timeline-body"><p>I'm working on <code>SIM110</code> and <code>SIM111</code>.</p>
<p>(These actually require some weird logic whereby we need to be able to peek at the next sibling, so TBD.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danieleades">@danieleades</a> on 2023-01-05 11:01</div>
            <div class="timeline-body"><p>looking good! I'll keep an eye on this issue and hopefully be able to remove the <code>flake8-simplify</code> plugin from Sphinx soon!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-06 00:32</div>
            <div class="timeline-body"><p>I'm working on <code>SIM101</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/messense">@messense</a> on 2023-01-08 01:51</div>
            <div class="timeline-body"><blockquote>
<p>SIM106 (&quot;Handle error-cases first&quot;)</p>
</blockquote>
<p><code>SIM106</code> was removed in <code>flake8-simplify</code> due to too many false-positives: https://github.com/MartinThoma/flake8-simplify/pull/108</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-08 03:17</div>
            <div class="timeline-body"><p>Removed, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jackklika">@jackklika</a> on 2023-01-20 16:35</div>
            <div class="timeline-body"><p>FYI <code>SIM103</code> autofix refactored my code to be incorrect:</p>
<pre><code>(apps-z6RSF3Uo-py3.10) jack@macbook api % cat /tmp/a.py 
def verify_user(kind):
    if kind != &quot;USER&quot;:
        return False
    else:
        return True
(apps-z6RSF3Uo-py3.10) jack@macbook api % ruff /tmp/a.py
/tmp/a.py:2:5: SIM103 Return the condition `kind != &quot;USER&quot;` directly
Found 1 error(s).
1 potentially fixable with the --fix option.
(apps-z6RSF3Uo-py3.10) jack@macbook api % ruff /tmp/a.py --fix
Found 1 error(s) (1 fixed, 0 remaining).
(apps-z6RSF3Uo-py3.10) jack@macbook api % cat /tmp/a.py      
def verify_user(kind):
    return kind != &quot;USER&quot;
(apps-z6RSF3Uo-py3.10) jack@macbook api % 

</code></pre>
<p>In the first case, the function returns <code>False</code> if the kind is not <code>&quot;USER&quot;</code>, and True otherwise. In the fixed function, it returns the opposite. In the REPL:</p>
<pre><code>&gt;&gt;&gt; def verify_user(kind):
...     if kind != &quot;USER&quot;:
...         return False
...     else:
...         return True
&gt;&gt;&gt; verify_user(&quot;USER&quot;)
True
&gt;&gt;&gt; def verify_user(kind):
...     return kind != &quot;USER&quot;
&gt;&gt;&gt; verify_user(&quot;USER&quot;)
False
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 16:57</div>
            <div class="timeline-body"><p>@jackklika - D'oh, thank you. I'll fix that this afternoon. Must be a flipped condition somewhere.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-01-22 05:52</div>
            <div class="timeline-body"><p>Can I implement SIM124?</p>
<p>https://github.com/MartinThoma/flake8-simplify#sim909 says:</p>
<blockquote>
<p>The trial period starts on 28th of March and will end on 28th of September 2022.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-22 05:54</div>
            <div class="timeline-body"><p>Go for it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-01-22 06:03</div>
            <div class="timeline-body"><p>@charliermarsh Is there a way to compare two expressions while ignoring their contexts?</p>
<pre><code class="language-python">foo = foo
^^^   ^^^
 |     |
 |      ---- Name { id: &quot;foo&quot;, ctx: Load }
  ---------- Name { id: &quot;foo&quot;, ctx: Store }
</code></pre>
<p>I tried <code>ComparableExpr</code> but it didn't work because the assignment target and value don't have the same context.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-22 18:26</div>
            <div class="timeline-body"><p>Hmm, no, we don't have anything to support that right now. Although arguably <code>ComparableExpr</code> should ignore <code>ctx</code>. Trying to think of where that would be incorrect.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-02-20 20:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:45:39 UTC
    </footer>
</body>
</html>
