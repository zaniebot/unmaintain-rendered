<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Warn when instance attribute shadows class attribute - astral-sh/ruff #15169</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Warn when instance attribute shadows class attribute</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/15169">#15169</a>
        opened by <a href="https://github.com/alippai">@alippai</a>
        on 2024-12-28 20:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/alippai">@alippai</a></div>
            <div class="timeline-body"><p>I suggest adding a linting rule to warn when an instance attribute shadows a class attribute of the same name. This can help prevent bugs from unintended overriding of class-level variables.</p>
<pre><code>class A:
    x = 1
    def get_x(self):
        return self.x

a = A()
a.x = 2  # Shadows class attribute &#x27;x&#x27;
print(a.get_x())  # Outputs 2, but class attribute &#x27;x&#x27; is 1
</code></pre>
<p>In this example, assigning to a.x creates an instance attribute that overshadows the class attribute x. Accessing self.x in get_x now refers to the instance attribute, which might not be the intended behavior.</p>
<p>Similarly, the subclassing is error prone:</p>
<pre><code>class Parent:
    def __init__(self):
        self.value = &#x27;instance&#x27;

    def get_value(self):
        return self.value

class Child(Parent):
    value = &#x27;class&#x27;  # Class attribute shadows instance attribute

c = Child()
print(c.get_value())  # Outputs &#x27;instance&#x27;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alippai">@alippai</a> on 2024-12-28 21:05</div>
            <div class="timeline-body"><p>@MichaReiser this might be relevant here: <a href="https://github.com/astral-sh/ruff/pull/10891">astral-sh/ruff#10891</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-30 09:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-30 09:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-30 09:46</div>
            <div class="timeline-body"><p>Thanks for opening this rule idea.</p>
<p>The main challenge with this rule is that it probably requires type inference, or at least more advanced analysis than what Ruff does today to be useful:</p>
<ul>
<li>Ruff needs to understand that <code>a</code> is an instance of <code>A</code></li>
<li>Ideally, Ruff understands that <code>a</code> is an instance of <code>A</code> even if <code>A</code> is defined in another file or if <code>A</code> is the result of a function call</li>
<li>Ruff needs to understand whether <code>a.x</code> is an instance attribute or not (I think that&#x27;s doable because detecting class attributes is &quot;easy enough).</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alippai">@alippai</a> on 2025-05-17 23:17</div>
            <div class="timeline-body"><p>Can we use <code>ty</code> in ruff to implement this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-18 16:10</div>
            <div class="timeline-body"><blockquote>
<p>Can we use <code>ty</code> in ruff to implement this?</p>
</blockquote>
<p>Not today, no. Using ty in ruff requires fundamental changes to how ruff works internally. But it&#x27;s on our long-term roadmap to bring the power of ty to ruff lint rules but we don&#x27;t know yet how exactly we&#x27;ll do that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alippai">@alippai</a> on 2025-05-18 17:21</div>
            <div class="timeline-body"><p>@MichaReiser thanks! It’s exciting and everything seems to go in the best direction.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alippai">@alippai</a> on 2025-12-18 04:10</div>
            <div class="timeline-body"><p>@MichaReiser did ruff or ty change in this question? If there is an example for linting based on type inference, I’d give it a try</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-18 06:58</div>
            <div class="timeline-body"><p>No, Ruff isn&#x27;t yet using ty&#x27;s analysis engine</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:49:13 UTC
    </footer>
</body>
</html>
