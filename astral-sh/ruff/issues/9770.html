<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deprecation of ANN 001 and 002 Discussion - astral-sh/ruff #9770</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Deprecation of ANN 001 and 002 Discussion</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/9770">#9770</a>
        opened by <a href="https://github.com/max-muoto">@max-muoto</a>
        on 2024-02-02 02:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/max-muoto">@max-muoto</a> on 2024-02-02 02:15</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Wanted to start a discussion about the deprecation of <code>ANN001</code>, and <code>ANN002</code>. I have personally found these rules very helpful in gradually rolling out type-checking. The reasons why you would use them over a type-checker for enforcing these rules:</p>
<ol>
<li>Ruff can give much quicker feedback than any type-checker that currently exists for Python. Having this instantaneous feedback that you're missing annotations can then help resolve issues quicker than simplify running your type-checker.</li>
<li>If you're using Pyright for enforcing type-safety. To my understanding, here's no effective way to use Pyright with Pycharm, meaning engineers using Pycharm don't have a great way to get quick feedback there right as they're writing code.</li>
</ol>
<p>Personally, I think these rules are really helpful to help transition a codebase towards type-safety, or working with libraries that benefit from type hints. For example, in FastAPI, where query parameter types are enforced at runtime through argument annotations: https://fastapi.tiangolo.com/tutorial/query-params/. You might want part of your codebase under strict type-checking, and another part just with these rules (in addition to other ANN) rules, as you move towards enabling your type-checker there.</p>
<p>It also strikes me as odd, that these two rules would get removed, but the rest of the rule-set wouldn't also get gradually deprecated? I say this, because I feel if Ruff is going to keep rules like ANN 201-206, which help with enforcing return-types, why not also remove those? I get usage is likely more prevalent, and they offer return-type generation, but nonetheless.</p>
<p>There are also other rules remaining like ANN101 and ANN102, which in my opinion would be better candidates for deprecation. As with the <code>Self</code> return type, I'd argue there are very few instances where you want to manually annotate <code>self</code> or <code>cls</code>. I suppose in older versions these could be helpful, but still, 001 and 002 seem a lot more helpful than these.</p>
<p>Mostly curious if there might be the possibility of some reconsideration here, as I personally find these rules helpful. Or maybe others feel differently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-02 02:19</div>
            <div class="timeline-body"><p>Hey sorry -- I think that's just a typo in the blog post. We deprecated <a href="https://docs.astral.sh/ruff/rules/missing-type-self/"><code>ANN101</code></a> and <a href="https://docs.astral.sh/ruff/rules/missing-type-cls/"><code>ANN102</code></a>, the rules for annotating <code>self</code> and <code>cls</code> (which you mentioned at the end).</p>
<p><code>ANN001</code> and <code>ANN002</code> are <em>not</em> deprecated. I'll correct this in the blog post. If you saw references to these rules elsewhere, please let me know.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-02 02:19</div>
            <div class="timeline-body"><p>Ah, it's in the release notes too. Will fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/max-muoto">@max-muoto</a> on 2024-02-02 02:20</div>
            <div class="timeline-body"><blockquote>
<p>Hey sorry -- I think that's just a typo in the blog post. We deprecated <a href="https://docs.astral.sh/ruff/rules/missing-type-self/"><code>ANN101</code></a> and <a href="https://docs.astral.sh/ruff/rules/missing-type-cls/"><code>ANN102</code></a>, the rules for annotating <code>self</code> and <code>cls</code> (which you mentioned at the end).</p>
<p><code>ANN001</code> and <code>ANN002</code> are <em>not</em> deprecated. I'll correct this in the blog post. If you saw references to these rules elsewhere, please let me know.</p>
</blockquote>
<p>Great to know! That makes a lot of sense! Didn't see this anywhere else, but I'll leave a comment if I do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-02 02:24</div>
            <div class="timeline-body"><p>üòÆ‚Äçüí® Sorry I goofed it! Not the only rule I typo'd while working on this release ‚Äî looking forward to using names instead of codes everywhere someday :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-02-02 02:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joellidin">@joellidin</a> on 2024-02-04 17:15</div>
            <div class="timeline-body"><p>Sorry if I am misunderstanding the blog post. But when reading this:</p>
<blockquote>
<p>They will not warn if selected by prefix (e.g., ANN).</p>
</blockquote>
<p>I am reading that this should not warn without preview. However when I have this in my <code>pyproject.toml</code>:</p>
<pre><code class="language-toml">[tool.ruff]
line-length = 88
target-version = &quot;py310&quot;

[tool.ruff.lint]
select = [&quot;ANN&quot;]
</code></pre>
<p>and running <code>ruff check</code> on this simple file:</p>
<pre><code class="language-python">class A:
    @classmethod
    def b(cls) -&gt; None:
        ...
</code></pre>
<p>I get this:</p>
<pre><code class="language-console">src/test_ruff/test.py:3:11: ANN102 Missing type annotation for `cls` in classmethod
Found 1 error.
</code></pre>
<p>With the <code>--preview</code> flag I get no errors. Is this the expected behavior?</p>
<p>I am running on version 0.2.0 btw</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-04 18:13</div>
            <div class="timeline-body"><p>@joellidin -- Ah, by &quot;warn&quot;, we mean, show a warning in the console indicating that the rule is deprecated. This is <em>different</em> than the rule raising or not raising violations. For example, try using <code>select = [&quot;ANN102&quot;]</code> instead of <code>select = [&quot;ANN&quot;]</code>. In that case, you'll see:</p>
<pre><code>warning: Rule `ANN102` is deprecated and will be removed in a future release.
bar.py:3:11: ANN102 Missing type annotation for `cls` in classmethod
Found 1 error.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joellidin">@joellidin</a> on 2024-02-04 18:30</div>
            <div class="timeline-body"><p>Ah, understood! Thanks @charliermarsh</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
