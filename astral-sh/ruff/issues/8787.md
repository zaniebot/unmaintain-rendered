```yaml
number: 8787
title: False positive redefined-while-unused (F811) for function in __all__
type: issue
state: closed
author: Tinche
labels:
  - bug
assignees: []
created_at: 2023-11-20T13:53:51Z
updated_at: 2023-11-21T20:06:19Z
url: https://github.com/astral-sh/ruff/issues/8787
synced_at: 2026-01-10T01:56:50Z
```

# False positive redefined-while-unused (F811) for function in __all__

---

_Issue opened by @Tinche on 2023-11-20 13:53_

Howdy again.

I'm seeing F811 for a function that I'm exporting via `__all__`.

```python
import sys

__all__ = ["test"]


def test() -> None:
    pass


if sys.version_info() >= (3, 12):

    def test() -> None:
        pass
```

This is a simpified example from cattrs. I think this is a legit use case and shouldn't be flagged.

---

_Label `bug` added by @charliermarsh on 2023-11-20 13:54_

---

_Comment by @charliermarsh on 2023-11-20 13:54_

Yeah I agree, thanks for filing.

---

_Assigned to @charliermarsh by @charliermarsh on 2023-11-20 14:11_

---

_Comment by @charliermarsh on 2023-11-21 19:22_

Hmm, on second thought... the easiest solution here might be to instead recommend

```python
import sys

__all__ = ["test"]


if sys.version_info() >= (3, 12):
    def test() -> None:
        pass
else:
    def test() -> None:
        pass
```

If the functions are in different branches, we can correctly identify that they're mutually exclusive. As-is, this will be hard to fix in general.

---

_Comment by @Tinche on 2023-11-21 19:24_

If it's hard to fix I'm OK with just a `# noqa`. I support Pythons 3.8 - 3.12 and having a branch for each version is just difficult.

---

_Comment by @charliermarsh on 2023-11-21 20:06_

Yeah I think it's hard to fix in a general way since it requires more comprehensive branch analysis. I'm going to close for now since there are reasonable workarounds.

---

_Closed by @charliermarsh on 2023-11-21 20:06_

---
