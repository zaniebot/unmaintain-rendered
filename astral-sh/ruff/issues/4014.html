<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>N815 (mixed-case-variable-in-class-scope) probably should not check TypedDict - astral-sh/ruff #4014</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>N815 (mixed-case-variable-in-class-scope) probably should not check TypedDict</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/4014">#4014</a>
        opened by <a href="https://github.com/sirrus233">@sirrus233</a>
        on 2023-04-19 02:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sirrus233">@sirrus233</a> on 2023-04-19 02:47</div>
            <div class="timeline-body"><p>Hey, thanks for writing ruff!! The following example illustrates two violations of N815, on the mixed-case variable <code>myOtherVar</code>. The first violation is of course appropriate. <strong>However, I think the second is misleading, and this rule should not apply to <code>TypedDict</code>.</strong></p>
<pre><code>from typing import TypedDict

class Foo:
    my_var: int
    myOtherVar: str  # Violation! Makes sense.

class Bar(TypedDict):
    my_var: int
    myOtherVar: str  # Violation! But shouldn't be.
</code></pre>
<p>A <code>TypedDict</code> is less of a real class, and more syntactic sugar to add typing to the keys of a dictionary. The argument here would be that if <code>{&quot;my_var&quot;: 0, &quot;myOtherVar&quot;: &quot;xyz&quot;}</code> would be appropriate, then the TypedDict form should be too. It may also be worth noting that the equivalent example:</p>
<pre><code>Bar = TypedDict(&quot;Bar&quot;, {&quot;my_var&quot;: int, &quot;myOtherVar&quot;: str})
</code></pre>
<p>does not flag this check (although it does flag UP013, as it should).</p>
<p>There is a practical reason to relax the rule here: a <code>TypedDict</code> is a useful and lightweight way to deal with adding static typing to an untyped blob of JSON with known structure sent over the wire (say, the body of an HTTP request). The writer of the TypedDict may not have control over the structure of the untyped dict, so it becomes awkward to comply with N815 without:</p>
<ul>
<li>Writing an awkward camel_to_snake parser</li>
<li>Using a functional <code>TypedDict</code> definition (and falling afoul of UP013)</li>
<li>Dropping a <code>noqa</code> on every camelCased field</li>
<li>Disabling N815</li>
<li>Using a heavier ser/de library</li>
</ul>
<p>All of which are undesirable.</p>
<p>I want to point out that the current behavior of N815 <em>does</em> conform to the behavior of the rule upstream in pep8-naming. I'm not sure about Ruff's overall stance on modifying how rules behave, so if enforcing exact parity is important, then there probably isn't anything to be done here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-04-19 19:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-19 19:16</div>
            <div class="timeline-body"><p>Torn on this one although I tend to agree.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4066.html">astral-sh/ruff#4066</a> on 2023-04-22 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-04-22 16:32</div>
            <div class="timeline-body"><p>Here is a non-exhaustive list of projects that would benefit from this rule.
https://grep.app/search?q=TypedDict.%2A%5C%29%3A%5Cn%20%20%20%20%5Ba-zA-Z%5D%2B%28%5Cd%5Cw%29%2A%5BA-Z%5D&amp;regexp=true&amp;case=true</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-04-22 22:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../py-mine/mcstatus/pulls/578.html">py-mine/mcstatus#578</a> on 2023-10-01 09:42</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
