<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cached-instance-method (B019) for async_lru and aiocache - astral-sh/ruff #16436</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>cached-instance-method (B019) for async_lru and aiocache</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/16436">#16436</a>
        opened by <a href="https://github.com/LuckySting">@LuckySting</a>
        on 2025-02-28 10:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/LuckySting">@LuckySting</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hello! Firstly, I want to share my appreciations for the Ruff linter; it is amazing and incredibly fast.</p>
<p>There is a rule (B019) that helps to avoid mistakes when using <code>functools.lru_cache</code> in the synchronous world. Meanwhile, in asynchronous Python, there are two widely used libraries: <code>async_lru</code> and <code>aiocache</code>, which provide decorators that work with async functions. And there are the same problems with caching of <code>self</code>.</p>
<p>It would be great if Ruff could check for possible problems in these two libraries.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-02-28 19:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @ntBre on 2025-02-28 19:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @ntBre on 2025-02-28 19:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-02-28 19:25</div>
            <div class="timeline-body"><p>Thanks for the kind words!</p>
<p>I think that's a reasonable rule extension, and should be quite easy to add here if anyone is interested in taking this on.</p>
<p>https://github.com/astral-sh/ruff/blob/fdf091528346d7b7b4cffe587a989e1d11d41e4c/crates/ruff_linter/src/rules/flake8_bugbear/rules/cached_instance_method.rs#L110-L120</p>
<p>In addition to extending the <code>matches!</code> call, we'd just want some new tests and probably to update the docs too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @ntBre on 2025-02-28 19:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LuckySting">@LuckySting</a> on 2025-03-01 16:11</div>
            <div class="timeline-body"><p>Although I'm not an expert in Rust, I have opened a pull request.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:18 UTC
    </footer>
</body>
</html>
