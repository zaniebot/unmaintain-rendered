<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edge case for `FBT001` is not handled. - astral-sh/ruff #20211</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Edge case for <code>FBT001</code> is not handled.</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/20211">#20211</a>
        opened by <a href="https://github.com/NiKuma0">@NiKuma0</a>
        on 2025-09-03 12:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/NiKuma0">@NiKuma0</a> on 2025-09-03 12:59</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I found this while reviewing some dude's code:</p>
<pre><code class="language-python">from typing import Literal


def test(arg: bool):  # Error: Boolean-typed positional argument in function definition (Ruff FBT001)
    pass

def foo(arg: Literal[True, False]):  # No error.
    pass
</code></pre>
<p>I expect that both funcs will throw <code>FBT001</code></p>
<h3>Version</h3>
<p>ruff 0.12.8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Eadge case for `FBT001` is not handled." to "Edge case for `FBT001` is not handled." by @NiKuma0 on 2025-09-03 13:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-09-03 13:07</div>
            <div class="timeline-body"><p>there is a rule <a href="https://docs.astral.sh/ruff/rules/redundant-bool-literal/#redundant-bool-literal-ruf038">RUF038</a> <code>Literal[True, False]</code> -&gt; <code>bool</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-09-03 13:20</div>
            <div class="timeline-body"><p>To FBT001 catch these, we can do something like this:</p>
<pre><code class="language-diff">--- a/crates/ruff_linter/src/rules/flake8_boolean_trap/rules/boolean_type_hint_positional_argument.rs
+++ b/crates/ruff_linter/src/rules/flake8_boolean_trap/rules/boolean_type_hint_positional_argument.rs
@@ -190,6 +190,18 @@ fn match_annotation_to_complex_bool(annotation: &amp;Expr, semantic: &amp;SemanticModel)
                 semantic.match_typing_qualified_name(qualified_name, &quot;Optional&quot;)
             }) {
                 match_annotation_to_complex_bool(slice, semantic)
+            } else if qualified_name.as_ref().is_some_and(|qualified_name| {
+                semantic.match_typing_qualified_name(qualified_name, &quot;Literal&quot;)
+            }) {
+                // Literal[True, False]
+                match slice.as_ref() {
+                    Expr::Tuple(ast::ExprTuple { elts, .. }) =&gt; elts.iter().all(|elt| matches!(
+                        elt,
+                        Expr::BooleanLiteral(_)
+                    )),
+                    Expr::BooleanLiteral(_) =&gt; true,
+                    _ =&gt; false,
+                }
             } else {
                 false
             }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-09-03 15:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-09-03 15:43</div>
            <div class="timeline-body"><p>Thanks for the issue and @chirizxc for the patch! I happened to look at https://github.com/astral-sh/ruff/issues/16129#issuecomment-2657268827 for an unrelated issue today, and one of the comments definitely supports handling this <code>Literal</code> case here:</p>
<blockquote>
<p>In general (even not considering overloads specifically) anywhere a type checker fails to treat bool and Literal[True, False] the same, it's a type checker bug IMO -- those types are equivalent</p>
</blockquote>
<p>So that patch looks good to me if you want to open a PR. I think we should preview gate it just to be safe, though.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:38:19 UTC
    </footer>
</body>
</html>
