<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP036 multiple conditions false negative - astral-sh/ruff #12093</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UP036 multiple conditions false negative</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12093">#12093</a>
        opened by <a href="https://github.com/gamer191">@gamer191</a>
        on 2024-06-28 14:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gamer191">@gamer191</a></div>
            <div class="timeline-body"><p>UP036 doesn't work if there are multiple conditions. For a file Test2.txt with the text:</p>
<pre><code>import sys
if True and sys.version_info &lt; (3, 5):
    print(&quot;35&quot;)
</code></pre>
<p>running <code>ruff check Test2.txt --extend-select UP --config &quot;target-version = 'py38'&quot; --isolated</code> will result in <code>All checks passed!</code></p>
<pre><code>&gt;ruff --version
ruff 0.5.0

&gt;cat Test2.txt
import sys
if True and sys.version_info &lt; (3, 5):
    print(&quot;35&quot;)


&gt;ruff check Test2.txt --extend-select UP --config &quot;target-version = 'py38'&quot; --isolated
All checks passed!

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-07-01 04:43</div>
            <div class="timeline-body"><p>It seems reasonable to check for conditions although that means that we'd need to get a range of version if there are multiple <code>sys.version_info</code> checks like:</p>
<pre><code class="language-py">if sys.version_info &gt; (3, 5) and sys.version_info &lt; (3, 10): ...
</code></pre>
<p>Here, we might want to raise <code>UP036</code> for <code>(3, 5)</code> and could restrict it to the <code>target-version</code>. I'm curious to hear others thoughts on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dhruvmanila on 2024-07-01 04:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gamer191">@gamer191</a> on 2024-07-06 12:01</div>
            <div class="timeline-body"><blockquote>
<p>if sys.version_info &gt; (3, 5) and sys.version_info &lt; (3, 10): ...</p>
</blockquote>
<p>I think both should be considered individually. <code>sys.version_info &gt; (3, 5)</code> is not allowed unless the target version is set to 3.5 (even then, it's not currently allowed due to #8832), so that should raise an error. <code>sys.version_info &lt; (3, 10)</code> should raise another error if the target version is 3.10 or above (I don't know if raising multiple identical errors for one line is possible)</p>
<p>The same should obviously apply for:</p>
<pre><code>if sys.version_info &lt; (3, 5) or sys.version_info &gt; (3, 10):
</code></pre>
<p>Real world example (which I've reported to the yt-dlp devs): https://github.com/yt-dlp/yt-dlp/blob/4862a29854d4044120e3f97b52199711ad04bee1/yt_dlp/compat/<strong>init</strong>.py#L39</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-03-04 00:16</div>
            <div class="timeline-body"><p>I agree with @gamer191 here. Each condition should be considered individually. It's fine if you stop attempting to provide an autofix as soon as there's multiple conditions. But I would expect Ruff to flag <code>UP036</code> here.</p>
<p>https://github.com/astral-sh/ruff/issues/16487 is a very similar request (except that I extend it to any version comparison, instead of only in conditional)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:50:32 UTC
    </footer>
</body>
</html>
