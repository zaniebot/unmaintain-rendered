<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TCH001 false positive in Ruff 0.0.281 - astral-sh/ruff #6233</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>TCH001 false positive in Ruff 0.0.281</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6233">#6233</a>
        opened by <a href="https://github.com/flying-sheep">@flying-sheep</a>
        on 2023-08-01 08:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/flying-sheep">@flying-sheep</a></div>
            <div class="timeline-body">

<p>When updating to Ruff 0.0.281, the following started falsely throwing TCH001:</p>
<p><a href="https://play.ruff.rs/#N4KABGBEDOCmA2sDGAXSAuMBtSBBAMvpALoA04UKAhgE4DmsKAtAG6w3QCWA9gHYZQADgE8AzAEZxkEAF8AJAshKUsaCgB0S6SABmNbgFswAfWM6ArinM1YpsJwODuNFGCq9e3aih69oIXX0jFGFBTl46e0dnVwAVAE0ABQBRYwBhAAlktIBpAEkAOQBxAL1DMHVjaHNBJxcoutdq2pjYABNjGmMDKhQaTgAPYyR4Kmg4fxBOHTAElPSs3MKi9AoIMqNoJE4RBpiwaEFaOACQUyp4eDsAXmw1ym4kaBpIcggIGBrG9s7u3v6hiMxhNXiBiKc2rAZihHs8ABTcABGACtMIdjrB1Icen1BgBKMBMAB8ByOHExTy6OIBq3eUGUqg0WnuNisNF4YCRyPUMOG8LxICAA">playground 1</a> | <a href="https://play.ruff.rs/#N4KABGBEDOCmA2sDGAXSAuMBtSBBAMvpALoA04UKAhgE4DmsKAtAG6w3QCWA9gHYZQADgE8AzAEZxkEAF8AJAshKUsaCgB0S6SABmNbgFswAfWM6ArinM1YpsJwODuNFGCq9e3aih69oIXX0jQSoUAAt4TgAje0dnVwAFULDAwzAUYUFOXjpYpxcwABUATQSAUWMAYQAJMsqAaQBJADkAcQDOHSLSipq6prb0Cgg9NPdeABNQqjz4sFwPABFp4bBR4Pcp6FmC5eoAMRoqA1gA0yp4eDsAXmxIUzYOX1NIUigADxIA2oAlMrBbklwgAKUw6TiIUwASnUIRsvBQARQNGEQwgIyCYDgVkEKG43Hg0GM0CQRgc+VcDBQxkeXD4AXRJhp7DpvBuYCpzKefGBahowN+ZVhtFgCOF8JQUKhIFg7yQsFxYGBjTiLjKNH0NDe+HxAGtzIJ1ZqoWj0cjUatGeswOouaydq4HiznsZVrL5YqVRSjc43NtYKbGRADNBcrdIJVxl57LwdOwwLTfOpNJb0UdOHAwF74j7+SG6FC1pjTgEJrAuu9gVQJpgFrw9lRC0wAHxgBuHY4B1ZaFRqTRKVY2Kw0XhuCbqPFmI4nYHSoA">playground 2</a></p>
<pre><code>&quot;&quot;&quot;test.&quot;&quot;&quot;

from __future__ import annotations

from typing import TYPE_CHECKING

from ._support import supported_r_matrix_classes

if TYPE_CHECKING:
    from scipy import sparse


__all__ = [
    &quot;tocsr&quot;,
    &quot;supported_r_matrix_classes&quot;,
]


def tocsr(obj: sparse.spmatrix) -&gt; sparse.csr_matrix:
    &quot;&quot;&quot;test.&quot;&quot;&quot;
    return obj.to_csr()
</code></pre>
<pre><code>    from ._support import supported_r_matrix_classes
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^
TCH001: Move application import `._support.supported_r_matrix_classes` into a type-checking block
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mkniewallner">@mkniewallner</a> on 2023-08-01 10:54</div>
            <div class="timeline-body"><p>Probably the same underlying issue as <a href="https://github.com/astral-sh/ruff/issues/6207">astral-sh/ruff#6207</a>, which should be fixed by <a href="https://github.com/astral-sh/ruff/pull/6208">astral-sh/ruff#6208</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flying-sheep">@flying-sheep</a> on 2023-08-01 11:10</div>
            <div class="timeline-body"><p>indeed, duplicate of #6207</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/flying-sheep">@flying-sheep</a> on 2023-08-01 11:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-01 15:04</div>
            <div class="timeline-body"><p>This should be fixed in v0.0.282, which is out now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-01 15:05</div>
            <div class="timeline-body"><p>I&#x27;m also going to add Poetry to our ecosystem CI checks, to prevent future regressions.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:40 UTC
    </footer>
</body>
</html>
