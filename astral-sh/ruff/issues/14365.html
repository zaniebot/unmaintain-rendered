<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add lint.flake8-bandit setting to ignore specific argument names for S106 and S107 - astral-sh/ruff #14365</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add lint.flake8-bandit setting to ignore specific argument names for S106 and S107</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/14365">#14365</a>
        opened by <a href="https://github.com/jamesdow21">@jamesdow21</a>
        on 2024-11-15 17:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jamesdow21">@jamesdow21</a> on 2024-11-15 17:36</div>
            <div class="timeline-body"><p>It'd be nice if there was a setting for <code>lint.flake8-bandit</code> to be able to ignore specific argument names from getting flagged as hard-coded passwords.</p>
<p>My use-case is that I have a <code>SecretsManager</code> class with a method signature like</p>
<pre><code class="language-python">class SecretsManager:
    def get_secret_value(self, secret_id: str) -&gt; Secret: ...
</code></pre>
<p>I created it to abstract out which secret management &quot;backend&quot; I was using when removing a ton of AWS-specific implementations and mostly stuck with the naming convention for <code>boto3.SecretsManager.Client</code> (which uses the argument name <code>SecretId</code>).</p>
<p>ruff will then end up flagging a S106 violation every time I retrieve any secret using <code>secret_id</code> as a keyword argument</p>
<p>Ideally, I could add a setting to my pyproject.toml like</p>
<pre><code class="language-toml">[tool.ruff.lint.flake8-bandit]
hardcoded-password-ignore = [&quot;secret_id&quot;]
</code></pre>
<p>I'm not sure how common an issue this is since I only see 2 potentially related issues (<a href="https://github.com/astral-sh/ruff/issues/8789">here</a> and <a href="https://github.com/astral-sh/ruff/issues/2384">here</a>) (and none in the original flake8-bandit repo), but it would at least be nice for me personally.</p>
<p>I know anything touching the security related rules is pretty sensitive though since a false positive is far less costly than a false negative</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @MichaReiser on 2024-11-18 08:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-11-18 08:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Neil-Schneider">@Neil-Schneider</a> on 2024-12-09 06:03</div>
            <div class="timeline-body"><p>I agree it would be nice to ignore all of my 'mock_token' or 'mock_secret' values assigned which trigger S105, S106 and S107.</p>
<p>If a token_var is assigned 'mock_token' (or similar configured value) then test would pass otherwise it would still trigger, prompting someone to review results.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-09 08:20</div>
            <div class="timeline-body"><p>Somewhat related: https://github.com/astral-sh/ruff/issues/8789</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bstrdsmkr">@bstrdsmkr</a> on 2025-08-16 15:03</div>
            <div class="timeline-body"><p>Adding my voice to the pile, we want to catch cases where developers are testing using &quot;real&quot; credentials (to the test envs, but still...) and accidentally leave the credential in the test. Unfortunately, the test suites are the most likely place for developers to be iterating with secret material and forget to sanitize when it finally works</p>
<p>We also want to maintain the absolute highest signal-to-noise ratio possible, so we don't want to pop warnings for known-safe values.</p>
<p>For example, in a test, we might have:</p>
<pre><code class="language-python">import os

def test_a_secret():
    os.environ[&quot;WEBHOOK_SECRET&quot;] = &quot;test-secret&quot;
</code></pre>
<p>which pops a warning, but is pretty clearly safe so we want to suppress that warning, but want to catch something like this:</p>
<pre><code class="language-python">import os

def test_a_secret():
    os.environ[&quot;WEBHOOK_SECRET&quot;] = &quot;tok_8675309&quot;
</code></pre>
<p>The ideal solution for us would mirror the existing <a href="https://docs.astral.sh/ruff/settings/#lint_dummy-variable-rgx">dummy-variable-regex</a> something like:</p>
<pre><code class="language-toml">[tool.ruff.lint]
# Only ignore potential S105 secret violations prefixed with &quot;test_&quot;.
safe-secret-rgx = &quot;^test_.*$&quot;
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:54 UTC
    </footer>
</body>
</html>
