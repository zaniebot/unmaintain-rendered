<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`E203` conflicts with formatter (and black) - astral-sh/ruff #8752</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>E203</code> conflicts with formatter (and black)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8752">#8752</a>
        opened by <a href="https://github.com/bersbersbers">@bersbersbers</a>
        on 2023-11-18 06:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bersbersbers">@bersbersbers</a></div>
            <div class="timeline-body"><p>Rule <code>E203</code> still conflicts with ruff's own formatter:</p>
<p><code>bug.py</code></p>
<pre><code class="language-python">x = [1, 2, 3]
x[len(x) :]
</code></pre>
<p><code>bug.bat</code></p>
<pre><code class="language-batch">@echo off
pip install black==23.11.0 ruff==0.1.6
black bug.py
ruff format --isolated bug.py
ruff check --isolated --preview --select E203 --fix bug.py
ruff format --isolated bug.py
ruff check --isolated --preview --select E203 --fix bug.py
ruff format --isolated bug.py
</code></pre>
<p>Output:</p>
<pre><code>All done! ‚ú® üç∞ ‚ú®
1 file left unchanged.
1 file left unchanged
Found 1 error (1 fixed, 0 remaining).
1 file reformatted
Found 1 error (1 fixed, 0 remaining).
1 file reformatted
</code></pre>
<p>Somewhat related to https://github.com/astral-sh/ruff/issues/7259 (but 0.1.5 behaves the same way, so likely https://github.com/astral-sh/ruff/pull/8654 did not break this, but instead should be extended to one-sided slices)</p>
<p>Potentially relevant for https://github.com/astral-sh/ruff/issues/7993</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-11-18 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-18 23:47</div>
            <div class="timeline-body"><p>Is this consistent with PEP 8, though? I feel like it's in conflict with the PEP 8 guidelines (which is fine for the formatter, but the intent of the pycodestyle rules is to enforce PEP 8). Now I'm wondering if we should instead just mark the rule as incompatible, rather than trying to make it compatible with the formatter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2023-11-19 05:44</div>
            <div class="timeline-body"><p>PEP8 doesn't say anything about this.</p>
<blockquote>
<p>Exception: when a slice parameter is omitted, the space is omitted</p>
</blockquote>
<p>This does not apply in our case: it concerns the space after the colon (where the parameter is omitted), not before the colon.</p>
<p>How exactly you solve this, I don't really care. Using black right now, I'm preparing the switch to ruffs formatter and ideally, you would make that as painless as possible :) Disabling rules for this is fine. (Is there a selector to ignore all formatter-incompatible rules?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-11-25 18:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-11-25 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Blumenkind111">@Blumenkind111</a> on 2024-02-16 13:55</div>
            <div class="timeline-body"><p>Hi, I think there is another case, where it is not working and that is when we have multiple indices, like in pandas:</p>
<p>My example looks like this:</p>
<p><code>dataframe.loc[index + 1 :, &quot;columnname&quot;] </code></p>
<p><code>Ruff format</code> always adds the space and <code>ruff . --fix</code> always removes it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:03 UTC
    </footer>
</body>
</html>
