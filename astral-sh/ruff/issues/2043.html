<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Optionally include human-friendly error messages in inline comments added by `--add-noqa` - astral-sh/ruff #2043</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Optionally include human-friendly error messages in inline comments added by `--add-noqa`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2043">#2043</a>
        opened by <a href="https://github.com/cosmojg">@cosmojg</a>
        on 2023-01-20 22:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cosmojg">@cosmojg</a> on 2023-01-20 22:47</div>
            <div class="timeline-body"><p>I would like to be able to add human-readable error messages as well as error codes when running <code>ruff</code> with <code>--add-noqa</code>.</p>
<p>For example, instead of appending <code># noqa: E722</code> to the end of offending lines, append <code># noqa: E722 Do not use bare `except`</code> (or <code># noqa - E722 Do not use bare `except`</code> to ensure compatibility with <a href="https://github.com/plinss/flake8-noqa">flake8-noqa</a> and #850).</p>
<p>Perhaps this could be a separate flag? (e.g., <code>--add-noqa-verbose</code>) This would have the added benefit of making it easy to remove error messages by simply running <code>--add-noqa</code> again.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 22:51</div>
            <div class="timeline-body"><p>We're going to support this eventually! We've been laying the groundwork for it (every rule will have a kebab-cased name that can be used in lieu of the codes).</p>
<p>I'm gonna close this in favor of #1773 since that's kind of the consolidated issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-20 22:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cosmojg">@cosmojg</a> on 2023-01-20 23:09</div>
            <div class="timeline-body"><blockquote>
<p>I'm gonna close this in favor of #1773 since that's kind of the consolidated issue.</p>
</blockquote>
<p>Thanks for responding so quickly! I saw that issue, and I guess I should've addressed it explicitly. I'm not sure the kebab-cased naming scheme is sufficient for what I had in mind. I'd really appreciate something more in line with the descriptive error messages that are normally printed to the terminal, particularly so that other contributors unfamiliar with even the kebab-cased names immediately know what they need to do to fix the issue without running to Google.</p>
<p>I have some free time tonight so I'd be happy to take a swing at implementing this feature myself if you agree that it's worth including.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 23:23</div>
            <div class="timeline-body"><p>Ah sorry, I didn't read the issue nearly closely enough, that's my fault.</p>
<p>I see what you're saying. How would it work in cases like <code># noqa: E501, F841, ...</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @charliermarsh on 2023-01-20 23:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cosmojg">@cosmojg</a> on 2023-01-20 23:58</div>
            <div class="timeline-body"><blockquote>
<p>How would it work in cases like <code># noqa: E501, F841, ...</code>?</p>
</blockquote>
<p>Good question! Off the top of my head, I suppose such cases could be handled by providing explanations on separate lines:</p>
<pre><code>unused_string = &quot;This line is waaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaay too long!&quot; # noqa: E501, F841, ...
# E501 - Line too long (81 &gt; 79 characters)
# F841 - Local variable `unused_string` is assigned to but never used
# ... - ...
</code></pre>
<p>In fact, as far as default behavior goes, this might even make more sense given that it ensures compatibility with <a href="https://github.com/plinss/flake8-noqa">flake8-noqa</a> and https://github.com/charliermarsh/ruff/issues/850.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/not-my-profile">@not-my-profile</a> on 2023-01-22 07:36</div>
            <div class="timeline-body"><blockquote>
<p>I'd really appreciate something more in line with the descriptive error messages that are normally printed to the terminal</p>
</blockquote>
<p>I honestly think that this is not a good idea:</p>
<ul>
<li>improvements to the messages of ruff will not make it into your comments</li>
<li>the comments will get out of date when the code changes e.g. <code>Local variable `unused_string`</code> is no longer accurate when the name of the variable changes</li>
</ul>
<blockquote>
<p>particularly so that other contributors unfamiliar with even the kebab-cased names immediately know what they need to do to fix the issue without running to Google</p>
</blockquote>
<p>I think you should rather instruct your contributors to use <a href="https://github.com/charliermarsh/ruff-lsp">ruff-lsp</a>, which since https://github.com/charliermarsh/ruff-lsp/pull/7 shows the error message when hovering over a rule code in a noqa comment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-22 16:50</div>
            <div class="timeline-body"><p>I do appreciate the intent here, and I understand why this would be useful. But I think this is probably difficult to implement and maintain. Not impossible, but my gut is that the complexity wouldn't outweigh the benefit.</p>
<p>For example: we'd need to have the ability to recognize those explanations, parse them, and replace them when running with <code>--add-noqa</code>, otherwise they'd risk getting out of sync (and/or being added multiple times -- the command has to be idempotent). We may also need a way to flag that they're out-of-sync outside of <code>--add-noqa</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-23 19:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:04 UTC
    </footer>
</body>
</html>
