<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[UP006/7] The `target-version` configuration is not applied to `*.pyi` - astral-sh/ruff #11064</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>[UP006/7] The `target-version` configuration is not applied to `*.pyi`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/11064">#11064</a>
        opened by <a href="https://github.com/lumina37">@lumina37</a>
        on 2024-04-21 04:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/lumina37">@lumina37</a> on 2024-04-21 04:07</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<h2>Introduction</h2>
<p>For <code>UP006/7</code>, The <code>target-version</code> configuration is not applied to <code>*.pyi</code>. I create a <a href="https://github.com/Starry-OvO/ruff-UP4pyi-demo">repo</a> to reproduce this issue.</p>
<h2>Version</h2>
<p>Run <code>ruff -V</code></p>
<p>Get</p>
<pre><code class="language-log">ruff 0.4.1
</code></pre>
<h2>Configuration</h2>
<pre><code class="language-toml">[tool.ruff]
target-version = &quot;py38&quot;

[tool.ruff.lint]
select = [&quot;UP&quot;]
</code></pre>
<h2>To Reproduce</h2>
<p>Follow the <a href="https://github.com/Starry-OvO/ruff-UP4pyi-demo">demo</a> or the steps below.</p>
<p>Add <code>foo.pyi</code> to the cwd.</p>
<pre><code class="language-python">from typing import List, Union

def UP006() -&gt; List[int]: ...
def UP007(a: bool) -&gt; Union[str, int]: ...
</code></pre>
<p>Add <code>foo.py</code> to the cwd.</p>
<pre><code class="language-python">from typing import List, Union


def UP006() -&gt; List[int]:
    return [1, 2, 3]


def UP007(a: bool) -&gt; Union[str, int]:
    if a:
        return &quot;hello ruff&quot;
    else:
        return 42
</code></pre>
<p>Add <code>pyproject.toml</code> to the cwd.</p>
<pre><code class="language-toml">[project]
name = &quot;ruff-UP4pyi-demo&quot;
version = &quot;0.1.0&quot;
description = &quot;Demo for the bug within ruff UP006/7 rules&quot;
authors = [{ name = &quot;Starry-OvO&quot;, email = &quot;starry.qvq@gmail.com&quot; }]
dependencies = []
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.8,&lt;3.13&quot;

[tool.rye]
managed = true
virtual = true

[tool.ruff]
target-version = &quot;py38&quot;

[tool.ruff.lint]
select = [&quot;UP&quot;]
</code></pre>
<h2>Behaviour</h2>
<p>Run <code>ruff check .</code></p>
<p>Get</p>
<pre><code class="language-log">foo.pyi:3:16: UP006 Use `list` instead of `List` for type annotation
foo.pyi:4:23: UP007 Use `X | Y` for type annotations
Found 2 errors.
No fixes available (2 hidden fixes can be enabled with the `--unsafe-fixes` option).
</code></pre>
<h2>Expect Behaviour</h2>
<p>Run <code>ruff check .</code></p>
<p>Get</p>
<pre><code class="language-log">All checks passed!
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2024-04-21 09:54</div>
            <div class="timeline-body"><p>It's expected</p>
<p>https://github.com/astral-sh/ruff/issues/5641</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @lumina37 on 2024-04-21 10:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lumina37">@lumina37</a> on 2024-04-21 10:04</div>
            <div class="timeline-body"><blockquote>
<p>It's expected</p>
<p>#5641</p>
</blockquote>
<p>thx a lot!
this issue is closed as duplication.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
