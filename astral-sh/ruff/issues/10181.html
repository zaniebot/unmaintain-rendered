<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUF028 claims `fmt: off` invalid in `else:` block - astral-sh/ruff #10181</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>RUF028 claims <code>fmt: off</code> invalid in <code>else:</code> block</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10181">#10181</a>
        opened by <a href="https://github.com/mrcljx">@mrcljx</a>
        on 2024-03-01 09:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mrcljx">@mrcljx</a> on 2024-03-01 09:59</div>
            <div class="timeline-body"><p>RUF028 claims that the second <code>fmt: off</code> is illegal (the first one is fine). Both are actually respected by the formatter though.</p>
<p>Expecation: RUF028 should not trigger.</p>
<pre><code>def f(a, b):
    if not a:
        # fmt: off
        a = b or bytes(
            [
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            ]
        )
    else:
        # fmt: off
        a = b or bytes(
            [
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 
            ]
        )
</code></pre>
<p><img src="https://github.com/astral-sh/ruff/assets/56807/19eefcaa-08f5-4b90-80e2-8a20c30c2551" alt="CleanShot 2024-03-01 at 11 00 00" /></p>
<p>https://play.ruff.rs/719df52a-6744-4230-8cf8-ed64a512143c</p>
<p>Ruff: 0.3.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-01 10:01</div>
            <div class="timeline-body"><p>Thanks for reporting. That's a bug. I think https://github.com/astral-sh/ruff/pull/10178 fixed it but I let @snowsignal confirm</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2024-03-01 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-03-01 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @snowsignal by @MichaReiser on 2024-03-01 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mrcljx">@mrcljx</a> on 2024-03-01 10:03</div>
            <div class="timeline-body"><p>Ah, nice. I only saw the title of the issue and not the PR summary that suggests this was fixed indeed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snowsignal">@snowsignal</a> on 2024-03-05 03:12</div>
            <div class="timeline-body"><p>This should be fixed by https://github.com/astral-sh/ruff/pull/10178 in the next release. I confirmed that your code passes without issue on the latest version of the Ruff playground.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @snowsignal on 2024-03-05 03:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:32:58 UTC
    </footer>
</body>
</html>
