<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal: C422 Unnecessary filter() usage - astral-sh/ruff #18492</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Proposal: C422 Unnecessary filter() usage</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18492">#18492</a>
        opened by <a href="https://github.com/grihabor">@grihabor</a>
        on 2025-06-06 09:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/grihabor">@grihabor</a> on 2025-06-06 09:36</div>
            <div class="timeline-body"><h3>Summary</h3>
<h2>What it does</h2>
<p>Checks for unnecessary <code>filter()</code> calls with lambda functions.</p>
<p>Why is this bad?</p>
<p>Using <code>filter(func, iterable)</code> when func is a lambda is slower than using a generator expression or a comprehension, as the latter approach avoids the function call overhead, in addition to being more readable.</p>
<p>This rule also applies to <code>filter()</code> calls within <code>list()</code>, <code>set()</code>, and <code>dict()</code> calls. For example:</p>
<ul>
<li>Instead of <code>list(filter(lambda num: num &lt; 10, nums))</code>, use <code>[num for num in nums if num &lt; 10]</code>.</li>
<li>Instead of <code>set(filter(lambda num: num % 2 == 0, nums))</code>, use <code>{num for num in nums if num % 2 == 0}</code>.</li>
<li>Instead of <code>dict(filter(lambda pair: pair[1] is not None, items))</code>, use <code>{k: v for k, v in values if v is not None}</code>.</li>
</ul>
<h2>Example</h2>
<pre><code class="language-python">filter(lambda x: x % 2 == 0, iterable)
</code></pre>
<p>Use instead:</p>
<pre><code class="language-python">(x for x in iterable if x % 2 == 0)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-06 16:32</div>
            <div class="timeline-body"><p>Is this rule present in the upstream flake8-comprehensions? I checked the <a href="https://pypi.org/project/flake8-comprehensions/">PyPI page</a>, and it looked like it stopped at C420. We could still consider the rule, but we'd want to be careful adding it as a <code>C</code> rule without an upstream feature request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-06-06 16:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @ntBre on 2025-06-06 16:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/grihabor">@grihabor</a> on 2025-06-07 00:08</div>
            <div class="timeline-body"><p>No, it's not in upstream, but it fits the overall theme of C4 checks. Should I open an proposal in upstream? Or should we choose a different rule tag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-07 00:19</div>
            <div class="timeline-body"><p>I think it may be okay in light of <a href="https://github.com/astral-sh/ruff/issues/18331#issuecomment-2922513633">this comment</a> from the flake8-comprehensions maintainer last week. I forgot that was for the same linter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Proposal: C421 Unnecessary filter() usage" to "Proposal: C422 Unnecessary filter() usage" by @grihabor on 2025-06-07 08:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/grihabor">@grihabor</a> on 2025-06-07 08:49</div>
            <div class="timeline-body"><p>Ok, so C421 is taken, let's reserve C422 then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/grihabor">@grihabor</a> on 2025-06-07 08:55</div>
            <div class="timeline-body"><p>Hey @adamchainz, do you have any thoughts on this rule?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SpecLad">@SpecLad</a> on 2025-11-27 15:12</div>
            <div class="timeline-body"><p>FWIW, I had filed an upstream feature request for this: adamchainz/flake8-comprehensions#622.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:37:36 UTC
    </footer>
</body>
</html>
