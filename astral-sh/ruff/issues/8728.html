<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place graphlib imports in the top group? - astral-sh/ruff #8728</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Place graphlib imports in the top group?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8728">#8728</a>
        opened by <a href="https://github.com/gerhard4">@gerhard4</a>
        on 2023-11-16 22:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gerhard4">@gerhard4</a> on 2023-11-16 22:13</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>A minimal code snippet that reproduces the bug:</p>
<pre><code class="language-python">&quot;&quot;&quot;Demonstrate ruff's problem with graphlib.&quot;&quot;&quot;
import graphlib
import sys

sys.exit(graphlib.CycleError is None)
</code></pre>
<p>With <code>ruff check</code>, this produces &quot;I001 [*] Import block is un-sorted or un-formatted&quot;.</p>
<p>With <code>ruff check --fix</code>, it reformats this to</p>
<pre><code class="language-python">&quot;&quot;&quot;Demonstrate ruff's problem with graphlib.&quot;&quot;&quot;
import sys

import graphlib

sys.exit(graphlib.CycleError is None)
</code></pre>
<p>However, <code>graphlib</code> is a Python standard library: https://docs.python.org/3/library/graphlib.html</p>
<p>AIUI, it should stay where it originally was.</p>
<p>Ruff version: 0.1.5</p>
<p>Ruff settings:</p>
<pre><code># Common Ruff configuration.

line-length = 88

# Rule sets from https://beta.ruff.rs/docs/rules/
# We list all the rule sets here, even the ones we do not enable. This way, when
# comparing this list to the page the next time, we know which ones on the page are new
# and which ones are pre-existing but not used by us. To make comparisons with the
# documentation easier, the order here is the same as on the page (instead of the
# standard lexical order).
select = [
    &quot;F&quot;,        # pyflakes
    &quot;E&quot;, &quot;W&quot;,   # pycodestyle
    # &quot;C90&quot;,      # mccabe: Unclear value.
    &quot;I&quot;,        # isort
    &quot;N&quot;,        # pep8-naming
    &quot;D&quot;,        # pydocstyle
    &quot;UP&quot;,       # pyupgrade
    &quot;YTT&quot;,      # flake8-2020
    &quot;ANN&quot;,      # flake8-annotations
    &quot;S&quot;,        # flake8-bandit
    &quot;BLE&quot;,      # flake8-blind-except
    # &quot;FBT&quot;,      # flake8-boolean-trap: Unclear value.
    &quot;B&quot;,        # flake8-bugbear
    &quot;A&quot;,        # flake8-builtins
    # &quot;COM&quot;,      # flake8-commas: Handled by Black.
    &quot;C40&quot;,      # flake8-comprehensions
    &quot;DTZ&quot;,      # flake8-datetimez
    &quot;T10&quot;,      # flake8-debugger
    &quot;DJ&quot;,       # flake8-django
    # &quot;EM&quot;,       # flake8-errmsg: Unclear value.
    &quot;EXE&quot;,      # flake8-executable
    &quot;ISC&quot;,      # flake8-implicit-str-concat
    &quot;ICN&quot;,      # flake8-import-conventions
    &quot;G&quot;,        # flake8-logging-format
    # &quot;INP&quot;,      # flake8-no-pep420: Unclear whether we want this.
    &quot;PIE&quot;,      # flake8-pie
    &quot;T20&quot;,      # flake8-print
    &quot;PYI&quot;,      # flake8-pyi
    # &quot;PT&quot;,       # flake8-pytest-style: We don't use pytest.
    &quot;Q&quot;,        # flake8-quotes: We
    &quot;RSE&quot;,      # flake8-raise
    &quot;RET&quot;,      # flake8-return
    &quot;SLF&quot;,      # flake8-self
    &quot;SIM&quot;,      # flake8-simplify
    # &quot;TID&quot;,      # flake8-tidy-imports: Unclear application.
    # &quot;TCH&quot;,      # flake8-type-checking: Unclear value.
    &quot;ARG&quot;,      # flake8-unused-arguments
    &quot;PTH&quot;,      # flake8-use-pathlib
    &quot;ERA&quot;,      # eradicate
    &quot;PD&quot;,       # pandas-vet
    &quot;PGH&quot;,      # pygrep-hooks
    &quot;PL&quot;,       # pylint (small subset)
    &quot;TRY&quot;,      # tryceratops
    &quot;NPY&quot;,      # numpy
    &quot;RUF&quot;,      # ruff
]
# To make it easier to find codes here, they are ordered lexically.
ignore = [
    # We don't normally annotate `self`.
    &quot;ANN101&quot;,   # missing-type-self
    # Allow the use of `Any`.
    &quot;ANN401&quot;,   # any-type
    # 1 blank line required before class docstring. Incompatible with D211 &quot;No blank
    # lines allowed before class docstring&quot;.
    &quot;D203&quot;,     # one-blank-line-before-class
    # Multi-line docstring summary should start at the second line. Incompatible with
    # D212 &quot;Multi-line docstring summary should start at the first line&quot;.
    &quot;D213&quot;,     # multi-line-summary-second-line
    # This is reST formatting that we don't normally use.
    &quot;D407&quot;,     # dashed-underline-after-section
    # Allow f-strings with logs. Use only with `INFO` and up.
    &quot;G004&quot;,     # logging-f-string
    # Allow variable assignments followed by `return &lt;var&gt;`.
    &quot;RET504&quot;,   # unnecessary-assign
    # Allow the use of `assert`.
    &quot;S101&quot;,     # assert
    # Allow composed messages (e.g. f-strings) as exception arguments.
    &quot;TRY003&quot;,   # raise-vanilla-args
]

[flake8-quotes]
inline-quotes = &quot;single&quot;

[isort]
known-first-party = [&quot;etl&quot;, &quot;etl_shared&quot;]

[pylint]
max-args = 8
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-16 22:19</div>
            <div class="timeline-body"><p>Can you try setting a <code>target-version</code> in your <code>ruff.toml</code> (https://docs.astral.sh/ruff/settings/#target-version)? <code>graphib</code> was added in Python 3.9, so it's only treated as a standard-library import of your Python version is 3.9 or later.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-11-16 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gerhard4">@gerhard4</a> on 2023-11-16 23:00</div>
            <div class="timeline-body"><blockquote>
<p>Can you try setting a target-version in your ruff.toml ... ?</p>
</blockquote>
<p>Thanks for the tip. Adding <code>--target-version=py311</code> to the command line made it behave correctly.</p>
<p>But why is this necessary? Ruff is installed in a venv based on Python 3.11.1:</p>
<pre><code>‚ùØ python --version
Python 3.11.1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-16 23:04</div>
            <div class="timeline-body"><p>We don't use the virtualenv to determine the minimum version for a few reasons though it's been discussed in the past. I guess the most succinct explanation would be: just because <em>you're</em> using Python 3.11 doesn't mean your project doesn't need to support <em>lower</em> versions than that. So our default is the lowest supported Python version, which is Python 3.8.</p>
<p>If you set <code>requires-python</code> in your <code>pyproject.toml</code> (which is a Python standard, not a custom Ruff setting), we'll also respect that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gerhard4">@gerhard4</a> on 2023-11-16 23:06</div>
            <div class="timeline-body"><p>Thanks, that makes sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @gerhard4 on 2023-11-16 23:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../lablup/backend.ai/pulls/1813.html">lablup/backend.ai#1813</a> on 2023-12-29 02:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:10 UTC
    </footer>
</body>
</html>
