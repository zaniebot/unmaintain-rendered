<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Feature Request] Guard against `==` for (sequence of) float comparison - astral-sh/ruff #14220</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Feature Request] Guard against <code>==</code> for (sequence of) float comparison</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14220">#14220</a>
        opened by <a href="https://github.com/DanielYang59">@DanielYang59</a>
        on 2024-11-09 05:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/DanielYang59">@DanielYang59</a> on 2024-11-09 05:23</div>
            <div class="timeline-body"><h2>Feature request: Guard against <code>==</code> for float comparison</h2>
<p>I'm not sure if this is doable from <code>ruff</code>'s side as this might need optional static typing (<code>mypy</code> for example).</p>
<p>I could think of the following cases where <code>==</code> should be discouraged (or avoided altogether as it's pretty unreliable, I cannot think of much use cases we need such comparison):</p>
<pre><code class="language-python"># directly compare floats
1.0 == 1.0 + 1E-8

# floats generated by evaluation
x = 1 / 3
if x == 0.333:
    do something

# sequence of floats
[1.0, ] == [1.0 + 1E-8, ]

# use `in` to check membership
0.0 in [0, 1, 2]

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dylwil3 on 2024-11-09 15:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @dylwil3 on 2024-11-09 15:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @dylwil3 on 2024-11-09 15:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @dylwil3 on 2024-11-09 15:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-09 15:04</div>
            <div class="timeline-body"><p>I think that's a great idea! I think without type inference we wouldn't be able to stray far from float literals (and perhaps basic expressions built from them), so it may make sense to wait until type inference is available to implement this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DanielYang59">@DanielYang59</a> on 2024-11-10 08:40</div>
            <div class="timeline-body"><p>Thanks for the input, that would be hugely helpful.</p>
<p>Some similar scenarios came to my mind (i might merge them to the original ), perhaps might consider them if possible?</p>
<h3>Use <code>==</code> to check <code>None</code></h3>
<pre><code class="language-python">if a == None:

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-10 15:29</div>
            <div class="timeline-body"><p>Nice! The latter does not require type checking and exists already as E711: https://docs.astral.sh/ruff/rules/none-comparison/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DanielYang59">@DanielYang59</a> on 2024-11-10 15:36</div>
            <div class="timeline-body"><p>Okay thanks I forgot about this. Appreciate that!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Anselmoo">@Anselmoo</a> on 2025-05-18 19:08</div>
            <div class="timeline-body"><blockquote>
<p>I could think of the following cases where <code>==</code> should be discouraged (or avoided altogether as it's pretty unreliable, I cannot think of much use cases we need such comparison):</p>
</blockquote>
<p>As well as inequality <code>!=</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DanielYang59">@DanielYang59</a> on 2025-05-20 08:18</div>
            <div class="timeline-body"><blockquote>
<p>As well as inequality !=?</p>
</blockquote>
<p>Yes, I assume <code>a != b</code> is equivalent to <code>not (a == b)</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Anselmoo">@Anselmoo</a> on 2025-05-20 14:54</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>As well as inequality !=?</p>
</blockquote>
<p>Yes, I assume<code>a != b</code> is equivalent to <code>not (a == b)</code></p>
</blockquote>
<p><strong>Further Reading &amp; Reference:</strong>
â€¢	SonarSource RSPEC-1244: <a href="https://rules.sonarsource.com/python/RSPEC-1244/">Floating point numbers should not be tested for equality</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[Feature Request] Guard against `==` for float comparison" to "[Feature Request] Guard against `==` for (sequence of) float comparison" by @DanielYang59 on 2025-07-04 18:52</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:35:40 UTC
    </footer>
</body>
</html>
