<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] support * imports - astral-sh/ruff #14169</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] support * imports</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14169">#14169</a>
        opened by <a href="https://github.com/carljm">@carljm</a>
        on 2024-11-07 16:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a></div>
            <div class="timeline-body"><p>PRs:</p>
<ul>
<li>https://github.com/astral-sh/ruff/pull/16873</li>
<li>https://github.com/astral-sh/ruff/pull/16899</li>
<li>https://github.com/astral-sh/ruff/pull/16955</li>
<li>https://github.com/astral-sh/ruff/pull/16923</li>
<li>https://github.com/astral-sh/ruff/pull/16958</li>
<li>https://github.com/astral-sh/ruff/pull/16959</li>
<li>https://github.com/astral-sh/ruff/pull/17270</li>
<li>astral-sh/ruff#17315</li>
<li>astral-sh/ruff#17286</li>
<li>astral-sh/ruff#17317</li>
<li>https://github.com/astral-sh/ruff/pull/17373</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @carljm on 2024-11-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Red Knot 2024" by @carljm on 2024-11-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @AlexWaygood by @carljm on 2024-11-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Red Knot 2024" by @carljm on 2025-01-09 17:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Red Knot Q1 2025" by @carljm on 2025-01-09 17:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Red Knot Q1 2025" by @carljm on 2025-03-27 18:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Red Knot Alpha" by @carljm on 2025-03-27 18:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-04-04 20:51</div>
            <div class="timeline-body"><p>@AlexWaygood I think whenever you move on from this, it would be good to close this issue and open a new specific issue for <code>__all__</code> support (or maybe just repurpose https://github.com/astral-sh/ty/issues/199 to cover all forms of <code>__all__</code> support?). Probably you were planning to do that anyway and this comment is redundant :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-04-04 20:52</div>
            <div class="timeline-body"><blockquote>
<p>Probably you were planning to do that anyway and this comment is redundant :)</p>
</blockquote>
<p>Indeed ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-04-06 15:43</div>
            <div class="timeline-body"><p>One thing that's potentially worth mentioning here is that we do not understand relatively basic imports from <code>numpy</code>:</p>
<pre><code class="language-bash">▶ cat pyproject.toml   
[project]
name = &quot;test-numpy&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.13&quot;
dependencies = [
    &quot;numpy&gt;=2.2.4&quot;,
]

▶ cat main.py 
from numpy import array

▶ uv run red_knot check
error: lint:unresolved-import
 --&gt; /tmp/test_numpy/main.py:1:19
  |
1 | from numpy import array
  |                   ^^^^^ Module `numpy` has no member `array`
  |

Found 1 diagnostic

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-04-06 15:53</div>
            <div class="timeline-body"><blockquote>
<p>▶ uv run red_knot check
error: lint:unresolved-import
--&gt; /tmp/test_numpy/main.py:1:19
|
1 | from numpy import array
|                   ^^^^^ Module <code>numpy</code> has no member <code>array</code>
|</p>
</blockquote>
<p>Hmm, I don't think that's an issue related to <code>*</code> imports? <code>numpy/__init__.py</code> has a stub file at <a href="https://github.com/numpy/numpy/blob/main/numpy/__init__.pyi"><code>numpy/__init__.pyi</code></a>, and I believe we are (and should be!) using that for resolving the <code>numpy.array</code> symbol rather than looking at <a href="https://github.com/numpy/numpy/blob/main/numpy/__init__.py"><code>numpy/__init__.py</code></a>. <code>numpy/__init__.pyi</code> imports <code>array</code> here, which isn't a <code>*</code> import: https://github.com/numpy/numpy/blob/a6ebba8941fb26efbdcb6d59a9f2e06ee64be858/numpy/<strong>init</strong>.pyi#L355. I think the only reason why we are emitting this diagnostic is because we do not understand it as being re-exported from the <code>numpy/__init__.pyi</code> stub: it is included in <code>__all__</code> <a href="https://github.com/numpy/numpy/blob/a6ebba8941fb26efbdcb6d59a9f2e06ee64be858/numpy/__init__.pyi#L662">here</a> but we do not yet understand how <code>__all__</code> impacts the re-export convention. So it looks like this issue is just https://github.com/astral-sh/ty/issues/199?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-04-06 16:26</div>
            <div class="timeline-body"><p>Oh, yes. I didn't know if it was better to put it here or in astral-sh/ty#199, since it wasn't clear to me if there were other <code>__all__</code> related things that need to be implemented. I mainly mentioned it because it sounded to me like <code>__all__</code> support was something that you thought about postponing. And unresolved-import errors are one of those Python developer-experience nightmares that I hope we can avoid wherever possible :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-04-15 11:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:28 UTC
    </footer>
</body>
</html>
