<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[red-knot] make Definition Copy - astral-sh/ruff #11660</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[red-knot] make Definition Copy</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/11660">#11660</a>
        opened by <a href="https://github.com/carljm">@carljm</a>
        on 2024-05-31 22:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/carljm">@carljm</a> on 2024-05-31 22:06</div>
            <div class="timeline-body"><p>Definition is lightweight: basically it's just a wrapper around an AST node reference (except for import definitions, which we currently abstract a bit more from the AST.) And we already clone them pretty freely. But they aren't Copy, because the import variants include names, which might be heap-allocated strings if they are long.</p>
<p>Definition should either be Copy, or it should be interned. Preferably it should be Copy. The simplest approach might be to just change how we represent import definitions so we point to the AST instead of storing names.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">red-knot</span> added by @carljm on 2024-05-31 22:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-17 06:55</div>
            <div class="timeline-body"><p>I did this as part of the salsa refactor</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-07-17 06:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:53 UTC
    </footer>
</body>
</html>
