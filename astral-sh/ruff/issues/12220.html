<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conflict between check and format with D203 - astral-sh/ruff #12220</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Conflict between check and format with D203</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12220">#12220</a>
        opened by <a href="https://github.com/arylix">@arylix</a>
        on 2024-07-06 19:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/arylix">@arylix</a> on 2024-07-06 19:20</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<pre><code class="language-py">
class Test:
    &quot;&quot;&quot;
    Test class docstring.
    &quot;&quot;&quot;
</code></pre>
<pre><code class="language-toml">lint.select = [&quot;D&quot;]
lint.ignore = [&quot;D100&quot;, &quot;D200&quot;, &quot;D212&quot;, &quot;D211&quot;]
</code></pre>
<p>When I run <code>ruff check test.py --config ruff.toml</code> I get:</p>
<pre><code>test.py:2:5: D203 [*] 1 blank line required before class docstring
  |
1 |   class Test:
2 |       &quot;&quot;&quot;
  |  _____^
3 | |     Test class docstring.
4 | |     &quot;&quot;&quot;
  | |_______^ D203
  |
  = help: Insert 1 blank line before class docstring

Found 1 error.
</code></pre>
<p>With <code>--fix</code> Ruff changes the file to:</p>
<pre><code class="language-py">class Test:

    &quot;&quot;&quot;
    Test class docstring.
    &quot;&quot;&quot;
</code></pre>
<p>When I now run <code>ruff format test.py --config ruff.toml</code> it redoes the changes and removes the blank line:</p>
<pre><code class="language-py">class Test:
    &quot;&quot;&quot;
    Test class docstring.
    &quot;&quot;&quot;
</code></pre>
<p>Ruff version: 0.5.1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-08 08:07</div>
            <div class="timeline-body"><p>Thanks for reporting this. It's interesting that this only comes up now :)</p>
<p>I don't think there's a way to make this rule formatter compatible. But we should warn when running <code>ruff format</code> and the rule is enabled.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">incompatibility</span> added by @MichaReiser on 2024-07-08 08:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/arylix">@arylix</a> on 2024-07-08 10:23</div>
            <div class="timeline-body"><p>So it will definitely not be possible to use D203 with the formatter?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-07-08 13:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-07-08 13:13</div>
            <div class="timeline-body"><p>No, I'm sorry. The formatter is designed to be compatible with black and follows its guidelines. We may want to deviate from their style guide in the future or allow more customizability, but that's something we yet have to decide on.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:34:19 UTC
    </footer>
</body>
</html>
