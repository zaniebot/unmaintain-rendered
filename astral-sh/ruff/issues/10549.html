<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Why is __main__ is considered first-party rather than stdlib ? - astral-sh/ruff #10549</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Why is <strong>main</strong> is considered first-party rather than stdlib ?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10549">#10549</a>
        opened by <a href="https://github.com/Avasam">@Avasam</a>
        on 2024-03-24 18:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Avasam">@Avasam</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Edit: I got confused with #8750 and #8805 , for some reasons I though it was the other way around. Although neither the issue nor PR offers a reasoning as to why <code>__main__</code> is considered first-party rather than stdlib by default.</p>
<p>Here's a handful of example usage from pywin32: https://github.com/search?q=repo%3Amhammond%2Fpywin32+&quot;import+<strong>main</strong>&quot;&amp;type=code</p>
<hr />
<p><code>import __main__</code> gets moved all the way down with first-party imports
<img src="https://github.com/astral-sh/ruff/assets/1350584/4460564d-68c2-456a-bfd2-a37f3bc59d7b" alt="image" /></p>
<p>The config:</p>
<pre><code class="language-toml">target-version = &quot;py37&quot;

[lint]
select = [&quot;I&quot;]

[lint.isort]
combine-as-imports = true
detect-same-package = false
# This forces distutils imports to always be after setuptools
extra-standard-library = [&quot;setuptools&quot;]
known-third-party = [&quot;distutils&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "__main__ is considered third party by isort" to "__main__ is considered third party by lint.isort" by @Avasam on 2024-03-24 18:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "__main__ is considered third party by lint.isort" to "__main__ is considered third party rather than stdlib" by @Avasam on 2024-03-24 18:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "__main__ is considered third party rather than stdlib" to "Why is __main__ is considered third party rather than stdlib ?" by @Avasam on 2024-03-24 18:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-24 19:31</div>
            <div class="timeline-body"><p>I don't know the context from those, but <code>import __main__</code> can an import an arbitrary third-party module â€” the <a href="https://docs.python.org/3/library/__main__.html#import-main">Python <code>__main__</code> documentation</a> covers this. It seems like it may be sensible to treat it as a third-party import. In the <a href="https://docs.python.org/3/reference/import.html#import-dunder-main">Python import documentation</a> they describe it as a non-builtin module which might be a good reason to exclude it from the standard imports.</p>
<p>Including it as a first-party import seems like a misunderstanding, but maybe it's with the idea that you should only be doing this for your <em>own</em> application?</p>
<p>cc @charliermarsh @AlexWaygood</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Why is __main__ is considered third party rather than stdlib ?" to "Why is __main__ is considered first-party rather than stdlib ?" by @AlexWaygood on 2024-03-24 19:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-24 20:02</div>
            <div class="timeline-body"><p>It seems like it could make sense to treat it as <code>stdlib</code>, since <code>__main__</code> itself is part of the standard library. Even though it can resolve to an arbitrary file, that file can actually be different across runs, right? So there's no way to know statically what file it refers to.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @charliermarsh on 2024-03-24 20:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-03-24 20:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-24 20:06</div>
            <div class="timeline-body"><p>Yeah standard library might make sense... I actually don't understand the use-case for importing <code>__main__</code>, I'd be curious to hear about that as it might help with a decision.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-03-24 20:56</div>
            <div class="timeline-body"><blockquote>
<p>[...] I actually don't understand the use-case for importing <code>__main__</code>, I'd be curious to hear about that as it might help with a decision.</p>
</blockquote>
<p>I haven't looked into it in details, and whether there's a better way to achieve what it's trying to do, but I added a reference to Pythonwin IDE (in pywin32) examples in my original description.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-24 20:59</div>
            <div class="timeline-body"><p>Hmmm https://github.com/mhammond/pywin32/blob/7cac4eb311db157a72edff1968706d92740937ff/Pythonwin/pywin/idle/CallTips.py#L94</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-03 01:37</div>
            <div class="timeline-body"><p>It looks like isort treats it as third-party, so lets just do that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-03 01:40</div>
            <div class="timeline-body"><p>Oh, we originally <em>did</em> mark it as third-party, huh. Just seeing https://github.com/astral-sh/ruff/issues/8750 which is linked up-top.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-03 01:40</div>
            <div class="timeline-body"><p>I would propose that we change it back to third-party.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2024-05-03 03:42</div>
            <div class="timeline-body"><p>Either way I can configure it to appear where I'd like in the import groups. This is more of a question since I misunderstood past issue. I don't mind too much whatever the resolution is here, as long as there's a rationale with it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-22 03:10</div>
            <div class="timeline-body"><p>I'm gonna close this for now -- I think it's fine to leave as-is unless we hear more reports, just to avoid churn in the absence of a clear right answer. The rationale I'd give is something like: <code>__main__</code> refers to the executed module, and so that likely (but not always) refers to first-party code. But, again, I don't think there's a right answer.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-05-22 03:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @charliermarsh on 2024-05-22 03:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:55 UTC
    </footer>
</body>
</html>
