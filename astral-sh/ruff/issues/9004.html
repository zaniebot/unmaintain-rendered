<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disable ANN201 None-autofix for abstractmethods? - astral-sh/ruff #9004</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Disable ANN201 None-autofix for abstractmethods?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9004">#9004</a>
        opened by <a href="https://github.com/twoertwein">@twoertwein</a>
        on 2023-12-05 04:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/twoertwein">@twoertwein</a> on 2023-12-05 04:10</div>
            <div class="timeline-body"><p>Abstract methods often have an almost empty body (doc-string, pass, or raise) but it seems unlikely that they should return <code>None</code>. https://github.com/JelleZijlstra/autotyping does not add <code>None</code> for <code>abstractmethod</code>s.</p>
<pre><code class="language-py">import abc

class Test(abc.ABC):
    @abc.abstractmethod
    def test(self):  #ruff adds  -&gt; None
        &quot;&quot;&quot;sub-classes have to implement this&quot;&quot;&quot;
</code></pre>
<pre><code class="language-sh">$ ruff --version
ruff 0.1.7
$ ruff --select ANN2 --exit-non-zero-on-fix --unsafe-fixes test.py 
Found 1 error (1 fixed, 0 remaining).
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-12-05 04:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-05 04:12</div>
            <div class="timeline-body"><p>Seems reasonable to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/twoertwein">@twoertwein</a> on 2023-12-05 04:15</div>
            <div class="timeline-body"><p>(and also not add None return types to pyi files)</p>
<p>edit: other return types can make sense (<code>def __str__</code> should also return str in a pyi files).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-05 20:09</div>
            <div class="timeline-body"><p>I guess I'm not sure if we should flag these at all for abstract methods with empty bodies. Probably not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-05 20:10</div>
            <div class="timeline-body"><p>Sorry, actually, we should flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/twoertwein">@twoertwein</a> on 2023-12-05 22:13</div>
            <div class="timeline-body"><blockquote>
<p>Sorry, actually, we should flag.</p>
</blockquote>
<p>ANN201 should definitely report missing return annotations for abstract methods and in pyi files, but autofixing those two error cases based on the &quot;non-existing&quot; function body with <code>-&gt; None</code> seems not helpful to me. As in the case of autotyping https://github.com/JelleZijlstra/autotyping/issues/33  it is still helpful to add <code>-&gt; None</code> based on the name of the method, such as for <code>__init__</code> (even when it is abstract or in a pyi file).</p>
<p>I stumbled into these cases when trying to run ruff with the preview fixes on pandas.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/9034.html">astral-sh/ruff#9034</a> on 2023-12-07 02:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2023-12-07 02:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9270.html">astral-sh/ruff#9270</a> on 2023-12-25 03:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:11 UTC
    </footer>
</body>
</html>
