<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using ruff check diff suppresses errors - astral-sh/ruff #4093</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using ruff check diff suppresses errors</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4093">#4093</a>
        opened by <a href="https://github.com/aminalaee">@aminalaee</a>
        on 2023-04-25 11:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/aminalaee">@aminalaee</a></div>
            <div class="timeline-body"><p>Hey, thanks for the great work.
I don't know if this is a bug or maybe unclear flag, but doing <code>ruff check --diff .</code> does not fail:</p>
<pre><code class="language-py">try:
    pass
except:
    pass
</code></pre>
<p>But running <code>ruff check .</code> shows proper errors:</p>
<pre><code>E722 Do not use bare `except`
</code></pre>
<p>Is this expected? I didn't expect <code>--diff</code> to have this side-effect, maybe the help is not clear?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-04-25 11:58</div>
            <div class="timeline-body"><p>If the <a href="https://beta.ruff.rs/docs/configuration/#command-line-interface">help of the CLI</a> you can find</p>
<blockquote>
<p><code>--diff</code> Avoid writing any fixed files back; instead, output a diff for each changed file to stdout</p>
</blockquote>
<p><code>--diff</code> is to be used in conjunction with <code>--fix</code>.
Without <code>--fix</code>, it will always return nothing with exit code 0.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aminalaee">@aminalaee</a> on 2023-04-25 12:02</div>
            <div class="timeline-body"><p>Thanks for the clarification, that makes more sense now.
Maybe it might be a good idea to force this combination since without one it's not really doing much.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @aminalaee on 2023-04-25 12:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-04-25 13:11</div>
            <div class="timeline-body"><p>I think updating the <code>--help</code> text to include this would help. Better option would be to exit with an appropriate message stating the usage of the flag (<code>--diff</code> is to be used in conjunction with <code>--fix</code> flag).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @aminalaee on 2023-04-25 13:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aminalaee">@aminalaee</a> on 2023-04-25 13:14</div>
            <div class="timeline-body"><p>I just opened this so the maintainers can decide if it needs any action.
Thanks for the info.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-25 15:13</div>
            <div class="timeline-body"><p>@dhruvmanila - Agreed, would be nice if we could exit with a meaningful error there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @charliermarsh on 2023-04-25 15:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-04-26 03:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/odie5533">@odie5533</a> on 2024-02-01 06:23</div>
            <div class="timeline-body"><p>Is there an option to output both diffs it could make as well as errors that don't have fixes? It would be useful for me to output all errors + all fixes and return code 1 if there are any.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-01 06:49</div>
            <div class="timeline-body"><p>Hey @odie5533 that should become the default <code>ruff check</code> behavior after #7352 â€” it's on our roadmap!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:03 UTC
    </footer>
</body>
</html>
