<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question: Best way to handle S608 triggers on GAQL - astral-sh/ruff #16156</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Question: Best way to handle S608 triggers on GAQL</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/16156">#16156</a>
        opened by <a href="https://github.com/lociii">@lociii</a>
        on 2025-02-14 08:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/lociii">@lociii</a></div>
            <div class="timeline-body"><h3>Description</h3>
<p>Hey there,</p>
<p>we're using the fantastic ruff tool to keep our Python projects in shape. Thanks for all the hard work that went into it. \</p>
<p>ruff version in use: <code>0.9.6</code></p>
<p>As we're communicating with Google Ads APIs, we run into the problem that <a href="https://developers.google.com/google-ads/api/docs/query/overview">GAQL</a> queries are detected as SQL queries and therefore raise <code>S608</code> violations.</p>
<p>Example:</p>
<pre><code class="language-python">query = f&quot;&quot;&quot;
    SELECT
    customer.status
    FROM customer
    WHERE customer.id = {customer_id}
&quot;&quot;&quot;
</code></pre>
<p>What would be the best way to handle this without turning off S608 for this specific piece of code?</p>
<p>Further information about GAQL and escaping: https://github.com/googleads/google-ads-python/issues/732</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "S608 triggers on GAQL" to "Question: Best way to handle S608 triggers on GAQL" by @lociii on 2025-02-14 08:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-02-14 09:51</div>
            <div class="timeline-body"><p>I don't know GAQL, so here are some stupid questions.</p>
<p>What happens if the query is changed so that it contains a syntax error? What if it is changed to use more resources than necessary? What if it is changed so that extra data is returned?</p>
<p>The comment in the linked issue just says &quot;[GAQL is] not susceptible to the same types of injection attacks as SQL&quot;. I don't think that is the same as &quot;GAQL is completely fool-proof&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-02-14 15:24</div>
            <div class="timeline-body"><p>You can use <code>per-file-ignores</code> to disable <code>S608</code> on a selected set of files if you know those fails don't contain any &quot;real&quot; SQL statements.</p>
<p>The only other remedy is to use inline <code>noqa: S608</code> suppression comments.</p>
<p>However, I do agree with @InSyncWithFoo that there's still the risk that some can alter the query. E.G. you get all customer status if <code>customer_id</code> is <code>1 OR true</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @dylwil3 on 2025-02-16 13:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lociii">@lociii</a> on 2025-02-17 12:52</div>
            <div class="timeline-body"><blockquote>
<p>What happens if the query is changed so that it contains a syntax error? What if it is changed to use more resources than necessary? What if it is changed so that extra data is returned?
The comment in the linked issue just says &quot;[GAQL is] not susceptible to the same types of injection attacks as SQL&quot;. I don't think that is the same as &quot;GAQL is completely fool-proof&quot;.</p>
</blockquote>
<p>I guess Google doesn't care as it's limited on their side by the scope of the API token. When managing multiple customers, it's the responsibility of the managing account to make sure no data is leaked. <br />
So yes, some kind of protection is needed.</p>
<blockquote>
<p>You can use <code>per-file-ignores</code> to disable <code>S608</code> on a selected set of files if you know those fails don't contain any &quot;real&quot; SQL statements.</p>
</blockquote>
<p>That's what we're currently doing.</p>
<p>Alright. Thanks!
Just wanted to make sure that we're not missing anything.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @lociii on 2025-02-17 12:52</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:12 UTC
    </footer>
</body>
</html>
