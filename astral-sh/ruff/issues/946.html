<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F401 column number is imprecise - astral-sh/ruff #946</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>F401 column number is imprecise</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/946">#946</a>
        opened by <a href="https://github.com/relsunkaev">@relsunkaev</a>
        on 2022-11-28 20:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/relsunkaev">@relsunkaev</a></div>
            <div class="timeline-body"><p>When some of the <code>from</code> statement's imports are unused, ruff highlights the entire statement. For large, multi-line imports this creates a lot of noise when using an extension to highlight errors in the editor and it may be better for the error to point to the exact imports that are unused instead.</p>
<p>Example:</p>
<pre><code class="language-python">from typing import (
    Any,
    Awaitable,
    Hashable,
    Iterable,
    Mapping,
    Sequence,
    TypeAlias,
    TypedDict,
)

SomeAlias = Mapping[str, str] | Sequence[str] | Iterable[str] | Awaitable[str]
</code></pre>
<p>Will generate</p>
<pre><code>example.py:1:1: F401 `typing.Any`, `typing.TypedDict` imported but unused
</code></pre>
<p>This would probably require reporting each unused import separately though. I'm willing to take a stab at a PR but was wondering if this change is unwelcome/unwanted by the maintainers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-28 20:34</div>
            <div class="timeline-body"><p>Yeah this could definitely be improved. IIRC, I implemented it this way to make autofixing easier and more reliable. But now that we support iterative autofix, it might be fine to revert back to &quot;one error per unused import&quot;.</p>
<p>It may not be trivial, though, since we'll have to do some bookkeeping as we autofix, since we want to avoid leaving around empty statements like:</p>
<pre><code class="language-py">from typing import (
)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2022-11-28 20:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-28 20:40</div>
            <div class="timeline-body"><p>The downside is that if we mark each member as its own error, then if you were to trigger an &quot;autofix&quot; for that error (e.g., in the VS Code UI), you'd have to repeat that action for each member.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/relsunkaev">@relsunkaev</a> on 2022-11-28 21:17</div>
            <div class="timeline-body"><p>It seems <code>autofix::fixer::apply_fixes</code> keeps track of applied <code>Patch</code> objects (using <code>BTreeSet</code>) and skips them. I'm thinking I can just use the same patch for every error and only the first one will get applied.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-28 21:19</div>
            <div class="timeline-body"><p>Oh yeah, that seems reasonable!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-11-28 23:34</div>
            <div class="timeline-body"><p>PR welcome for that change if you’re up for it — otherwise I’ll get to it at some point :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-11-30 00:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:45:35 UTC
    </footer>
</body>
</html>
