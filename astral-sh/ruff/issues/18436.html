<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add ability to disable multi-line string concatenation with ruff format - astral-sh/ruff #18436</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add ability to disable multi-line string concatenation with ruff format</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18436">#18436</a>
        opened by <a href="https://github.com/seanbudd">@seanbudd</a>
        on 2025-06-03 05:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/seanbudd">@seanbudd</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Please change ruff format's behaviour for concatenating multi-line strings.</p>
<p>For example:</p>
<pre><code class="language-py">outputFile.write(
	&quot;&lt;/notes&gt;\n&quot;
	f&quot;&lt;segment&gt;\n&quot;
	f&quot;&lt;source&gt;{xmlEscape(source)}&lt;/source&gt;\n&quot;
	&quot;&lt;/segment&gt;\n&quot;
	&quot;&lt;/unit&gt;\n&quot;,
)
</code></pre>
<p>Should not concatenate to</p>
<pre><code class="language-py">outputFile.write(
	f&quot;&lt;/notes&gt;\n&lt;segment&gt;\n&lt;source&gt;{xmlEscape(source)}&lt;/source&gt;\n&lt;/segment&gt;\n&lt;/unit&gt;\n&quot;,
)
</code></pre>
<p>I cannot find a way to disable this behaviour - or disabling string concatenation in general when using ruff format.
Any suggestions on how to use ruff format without multiline string concatenation would be helpful.</p>
<h3>Reasoning</h3>
<p>Multi-line strings split over new lines is usually a very intended form of syntax.
Splitting strings over multiple lines at fixed positions helps with readability.
I think there is more value in disabling this feature for ruff format than having it enabled.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2025-06-03 06:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @MichaReiser on 2025-06-03 06:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-03 07:00</div>
            <div class="timeline-body"><p>There's currently no option to disable implicit string concatenation and you're right, it doesn't respect the trailing comma. I don't think it should respect the magic trailing comma, because this would make this transformation useless in most cases (e.g., you have an array that already has a trailing comma but you added an implicit string concatenation).</p>
<p>What's the reason you want to keep the lines separate? Is it because they all end with a <code>\n</code>? We could explore a heuristic that prevents joining implicit concatenated strings if they all end with a newline and were already formatted over mutliple lines (in which case the formatter would preserve the formatting as is)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seanbudd">@seanbudd</a> on 2025-06-03 08:39</div>
            <div class="timeline-body"><p>It's more that it's quite useful to split strings over new lines for readability. Just like how nested python calls crammed into one line is not as ideal as splitting logic over multiple lines. Using <code>fmt: skip</code> each time is an option, but the trailing comma pattern is cleaner. I'd probably prefer to turn the whole thing concatenation off than have it on by default and using <code>fmt: skip</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seanbudd">@seanbudd</a> on 2025-06-03 08:48</div>
            <div class="timeline-body"><p>Also I understand the case you mention as to why trailing commas might not work. I guess an alternative marker or just a way to toggle it off in general would be nice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-03 08:50</div>
            <div class="timeline-body"><p>Do you have other examples where you would want to turn it off? I'm open to adding a heuristic; it's less likely that we'll add an option unless there's big demand for it (please upvote the issue)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seanbudd">@seanbudd</a> on 2025-06-03 08:56</div>
            <div class="timeline-body"><p>There's no real special use case, it's more the general desire to keep multiline strings as such. Generally splitting strings like this is quite intentional. I really don't see how compacting intentional newlines improves code readability. The fixes for implicit same line strings is still useful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Respect magic trailing comma when considering multi-line string concatenation with ruff format" to "Add ability to disable multi-line string concatenation with ruff format" by @seanbudd on 2025-06-04 02:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KerberosMorphy">@KerberosMorphy</a> on 2025-11-19 18:14</div>
            <div class="timeline-body"><blockquote>
<p>There's no real special use case, it's more the general desire to keep multiline strings as such. Generally splitting strings like this is quite intentional. I really don't see how compacting intentional newlines improves code readability. The fixes for implicit same line strings is still useful.</p>
</blockquote>
<p>I confirm, in my team, multi-line strings are written intentionally for clearer readability and therefore maintainability.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:48 UTC
    </footer>
</body>
</html>
