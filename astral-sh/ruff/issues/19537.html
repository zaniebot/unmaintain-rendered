<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature request: Allow opting into selected format preview styles - astral-sh/ruff #19537</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Feature request: Allow opting into selected format preview styles</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/19537">#19537</a>
        opened by <a href="https://github.com/codethief">@codethief</a>
        on 2025-07-24 19:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/codethief">@codethief</a> on 2025-07-24 19:01</div>
            <div class="timeline-body"><p>Right now, <code>tool.ruff.format.preview = true</code> <a href="https://github.com/astral-sh/ruff/discussions/13013#discussioncomment-10403574">opts into all preview styles and preview styles can change even in patch releases</a>.</p>
<p>In my case, though, I am only interested in the <a href="https://github.com/astral-sh/ruff/issues/8279"><code>hug_parens_with_braces_and_square_brackets</code> preview style</a>, though, which seems relatively stable, <a href="https://github.com/psf/black/pull/3964">has also been implemented</a> by <a href="https://github.com/psf/black">black</a>, and hasn't seen a lot of controversy since <a href="https://github.com/psf/black/issues/1811">the first discussions back in 2020</a>.</p>
<p>In other words: That preview style on its own seems relatively safe to use in production code while as an average user I don't know much about the whole set of styles enabled by <code>tool.ruff.format.preview = true</code>, so enabling all of them seems much more risky.</p>
<p>As far as I can tell from looking at <a href="https://github.com/astral-sh/ruff/blob/f9091ea8bb5aea454c3c6e8291470d453755c85f/crates/ruff_python_formatter/src/preview.rs"><code>preview.rs</code></a>, implementing the feature should be relatively straight-forward and only involve changing a few lines(?) (+ config parsing + documentation, of course).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-07-25 06:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2025-07-25 06:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-07-25 06:48</div>
            <div class="timeline-body"><p>We intentionally don't expose preview specific feature flags because:</p>
<ul>
<li>We want to get feedback on fall preview features</li>
<li>We want preview to be a lightweight process on our end (there should be little to no reason for us not to use it). This is less of a problem for the formatter but I want to avoid having settings for each preview feature in the linter.</li>
<li>But most importantly, adding a dedicated setting makes the feature appear more stable than they are and it leaves us in an awkward position when stabilizing the feature because users will then start asking for the opposite: Just leave the setting so that I can disable this formatter behavior.</li>
</ul>
<p>I do understand that opting in to all preview features can feel uncomfortable and not being able to use it can be frustrating (we have the same with some rust format features). But preview features are intentionally under preview and we don't want users opting into them lightly because they don't have the same stability guarantees as other features (and might be removed any day)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-07-25 06:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codethief">@codethief</a> on 2025-07-25 09:52</div>
            <div class="timeline-body"><p>Fair enough, thank you for considering it anyway!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
