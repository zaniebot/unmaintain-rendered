<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`quoted-annotation` (`UP037`), `undefined-name` (`F821`) &amp; `quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s - astral-sh/ruff #10812</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>quoted-annotation</code> (<code>UP037</code>), <code>undefined-name</code> (<code>F821</code>) &amp; <code>quoted-type-alias</code> (<code>TC008</code>) - false positives on pyright inlined <code>TypedDict</code>s</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10812">#10812</a>
        opened by <a href="https://github.com/DetachHead">@DetachHead</a>
        on 2024-04-07 12:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/DetachHead">@DetachHead</a></div>
            <div class="timeline-body"><p>pyright supports defining a <code>TypedDict</code> inline like so:</p>
<pre><code>from __future__ import annotations
from typing import TypedDict

foo: TypedDict[{&quot;bar&quot;: str}] = {&quot;bar&quot;: &quot;bar&quot;} # errors: F821, UP037
</code></pre>
<p>removing the quotes causes the following pyright error:</p>
<pre><code>foo: TypedDict[{bar: str}] = {&quot;bar&quot;: &quot;bar&quot;} # error: Expected string literal for dictionary entry name
</code></pre>
<p><a href="https://play.ruff.rs/ad657c55-d2c6-4be5-ade7-63212003dba0">playground</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-04-07 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">linter</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-04-07 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`quoted-annotation` (`UP037`) - false positive on pyright inlined `TypedDict`s&quot; to &quot;`quoted-annotation` (`UP037`) &amp; `undefined-name` (`F821`) - false positives on pyright inlined `TypedDict`s&quot; by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-04-07 12:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-04-07 12:22</div>
            <div class="timeline-body"><p>Thanks, I agree that ruff&#x27;s behaviour is incorrect here.</p>
<p>For other readers who may not be familiar â€” this is an experimental syntax for &quot;inline TypedDicts&quot; that has been floated on the (now-defunct) typing-sig mailing list. Pyright has added support for this experimental syntax so that people can experiment with it. Some more details here: https://github.com/python/typing/discussions/1391.</p>
<p>I don&#x27;t believe a PEP has yet been written to formally propose this new way of writing TypedDicts. But without this new syntax, it wouldn&#x27;t be a valid PEP-484 type annotation anyway, so regardless I think ruff probably shouldn&#x27;t be telling people to remove the quotes in that type annotation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-12-03 06:30</div>
            <div class="timeline-body"><p>fyi there&#x27;s now a draft PEP for this: <a href="https://github.com/python/peps/pull/4082">python/peps#4082</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-12-04 22:51</div>
            <div class="timeline-body"><p>also happens with the new <code>quoted-type-alias</code> (<code>TC008</code>) rule in 0.8.1:</p>
<pre><code>from typing import TypedDict

type Foo = TypedDict[{&quot;Bar&quot;: str}] # error: Remove quotes from type alias
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`quoted-annotation` (`UP037`) &amp; `undefined-name` (`F821`) - false positives on pyright inlined `TypedDict`s&quot; to &quot;`quoted-annotation` (`UP037`), `undefined-name` (`F821`) &amp; quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s&quot; by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-12-04 22:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`quoted-annotation` (`UP037`), `undefined-name` (`F821`) &amp; quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s&quot; to &quot;`quoted-annotation` (`UP037`), `undefined-name` (`F821`) &amp; `quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s&quot; by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-12-04 22:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-12-30 09:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-12-30 09:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:52 UTC
    </footer>
</body>
</html>
