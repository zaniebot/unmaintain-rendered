<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`quoted-annotation` (`UP037`), `undefined-name` (`F821`) &amp; `quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s - astral-sh/ruff #10812</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`quoted-annotation` (`UP037`), `undefined-name` (`F821`) &amp; `quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/10812">#10812</a>
        opened by <a href="https://github.com/DetachHead">@DetachHead</a>
        on 2024-04-07 12:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-04-07 12:14</div>
            <div class="timeline-body"><p>pyright supports defining a <code>TypedDict</code> inline like so:</p>
<pre><code class="language-py">from __future__ import annotations
from typing import TypedDict

foo: TypedDict[{&quot;bar&quot;: str}] = {&quot;bar&quot;: &quot;bar&quot;} # errors: F821, UP037
</code></pre>
<p>removing the quotes causes the following pyright error:</p>
<pre><code class="language-py">foo: TypedDict[{bar: str}] = {&quot;bar&quot;: &quot;bar&quot;} # error: Expected string literal for dictionary entry name
</code></pre>
<p><a href="https://play.ruff.rs/ad657c55-d2c6-4be5-ade7-63212003dba0">playground</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @AlexWaygood on 2024-04-07 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">linter</span> added by @AlexWaygood on 2024-04-07 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`quoted-annotation` (`UP037`) - false positive on pyright inlined `TypedDict`s" to "`quoted-annotation` (`UP037`) & `undefined-name` (`F821`) - false positives on pyright inlined `TypedDict`s" by @DetachHead on 2024-04-07 12:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-04-07 12:22</div>
            <div class="timeline-body"><p>Thanks, I agree that ruff's behaviour is incorrect here.</p>
<p>For other readers who may not be familiar â€” this is an experimental syntax for &quot;inline TypedDicts&quot; that has been floated on the (now-defunct) typing-sig mailing list. Pyright has added support for this experimental syntax so that people can experiment with it. Some more details here: https://github.com/python/typing/discussions/1391.</p>
<p>I don't believe a PEP has yet been written to formally propose this new way of writing TypedDicts. But without this new syntax, it wouldn't be a valid PEP-484 type annotation anyway, so regardless I think ruff probably shouldn't be telling people to remove the quotes in that type annotation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12082.html">astral-sh/ruff#12082</a> on 2024-06-28 04:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-12-03 06:30</div>
            <div class="timeline-body"><p>fyi there's now a draft PEP for this: https://github.com/python/peps/pull/4082</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DetachHead">@DetachHead</a> on 2024-12-04 22:51</div>
            <div class="timeline-body"><p>also happens with the new <code>quoted-type-alias</code> (<code>TC008</code>) rule in 0.8.1:</p>
<pre><code class="language-py">from typing import TypedDict

type Foo = TypedDict[{&quot;Bar&quot;: str}] # error: Remove quotes from type alias
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`quoted-annotation` (`UP037`) & `undefined-name` (`F821`) - false positives on pyright inlined `TypedDict`s" to "`quoted-annotation` (`UP037`), `undefined-name` (`F821`) & quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s" by @DetachHead on 2024-12-04 22:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`quoted-annotation` (`UP037`), `undefined-name` (`F821`) & quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s" to "`quoted-annotation` (`UP037`), `undefined-name` (`F821`) & `quoted-type-alias` (`TC008`) - false positives on pyright inlined `TypedDict`s" by @DetachHead on 2024-12-04 22:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/15073.html">astral-sh/ruff#15073</a> on 2024-12-20 00:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-12-30 09:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-12-30 09:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
