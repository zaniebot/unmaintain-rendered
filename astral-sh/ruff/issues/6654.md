```yaml
number: 6654
title: Potential false positive on PLW2901
type: issue
state: closed
author: petermattia
labels:
  - rule
assignees: []
created_at: 2023-08-17T16:36:58Z
updated_at: 2023-08-17T19:18:11Z
url: https://github.com/astral-sh/ruff/issues/6654
synced_at: 2026-01-10T01:56:48Z
```

# Potential false positive on PLW2901

---

_Issue opened by @petermattia on 2023-08-17 16:36_

I _think_ this should be considered a false positive, but not sure. Technically, yes, I am re-defining the variable and violating the rule, but I think this is a fair use case.

* A minimal code snippet that reproduces the bug.

This is a JSON deserializer for an object that includes `numpy` arrays that were saved as lists:
````python
load_dict = json.load(load_path.open(mode="r"))
for key, value in load_dict.items():
    if isinstance(value, np.ndarray):
        value = np.asarray(value)  # noqa: PLW2901
    setattr(self, key, value)
````

* The current Ruff version (`ruff --version`).
`0.0.284`


---

_Comment by @zanieb on 2023-08-17 16:58_

@petermattia what kind of heuristic are you suggestion we use to allow this?

This looks like a violation the the rule to me.

I'd suggest:

```python
load_dict = json.load(load_path.open(mode="r"))
for key, value in load_dict.items():
    setattr(self, key, np.asarray(value) if isinstance(value, np.ndarray) else value)
```

Or use a different name for your "validated" value.

---

_Label `rule` added by @zanieb on 2023-08-17 16:58_

---

_Comment by @petermattia on 2023-08-17 19:18_

Yea, that works. I'll close this. Thanks!

---

_Closed by @petermattia on 2023-08-17 19:18_

---
