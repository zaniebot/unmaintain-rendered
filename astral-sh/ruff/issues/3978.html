<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Possible inconsistency with &quot;D&quot; rule parsing docstrings - astral-sh/ruff #3978</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Possible inconsistency with &quot;D&quot; rule parsing docstrings</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/3978">#3978</a>
        opened by <a href="https://github.com/syntaxaire">@syntaxaire</a>
        on 2023-04-14 20:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/syntaxaire">@syntaxaire</a> on 2023-04-14 20:36</div>
            <div class="timeline-body"><p>With ruff 0.0.261, using the &quot;D&quot; rule with  <code>--fix</code>, the following code:</p>
<pre><code class="language-python">&quot;&quot;&quot;
Do a fix.
Workaround for:
BUG: https://github.com/someproject/somerepo/issues/1337
&quot;&quot;&quot;
</code></pre>
<p>is autocorrected to:</p>
<pre><code class="language-python">&quot;&quot;&quot;Do a fix.
Workaround for:
BUG: https://github.com/someproject/somerepo/issues/1337.
&quot;&quot;&quot;
</code></pre>
<p>Note the addition of a period in line 3. But inserting a newline into the original code causes that period not to be added:</p>
<pre><code class="language-python">&quot;&quot;&quot;
Do a fix.

Workaround for:
BUG: https://github.com/someproject/somerepo/issues/1337
&quot;&quot;&quot;
</code></pre>
<p>is autocorrected to</p>
<pre><code class="language-python">&quot;&quot;&quot;Do a fix.

Workaround for:
BUG: https://github.com/someproject/somerepo/issues/1337
&quot;&quot;&quot;
</code></pre>
<p>Note the lack of a period after the link.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/syntaxaire">@syntaxaire</a> on 2023-04-14 20:44</div>
            <div class="timeline-body"><p>configuration in <code>pyproject.toml</code> is:</p>
<pre><code>[tool.ruff]
select = [
  &quot;A&quot;, &quot;ARG&quot;, &quot;B&quot;, &quot;BLE&quot;, &quot;C4&quot;, &quot;C90&quot;, &quot;D&quot;, &quot;DTZ&quot;, &quot;E&quot;, &quot;ERA&quot;, &quot;F&quot;, &quot;FBT&quot;, &quot;G&quot;, &quot;I&quot;, &quot;ISC&quot;, &quot;PGH&quot;, &quot;PIE&quot;, &quot;PL&quot;, &quot;PT&quot;, &quot;PTH&quot;, &quot;PYI&quot;, &quot;Q&quot;, &quot;RET&quot;, &quot;RSE&quot;, &quot;RUF&quot;, &quot;S&quot;, &quot;SIM&quot;, &quot;T10&quot;, &quot;T20&quot;, &quot;TRY&quot;, &quot;UP&quot;, &quot;W&quot;, &quot;YTT&quot;
]

unfixable =  [
  &quot;ERA001&quot;,
  &quot;RUF002&quot;,
]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-14 21:09</div>
            <div class="timeline-body"><p>Yeah it's a little challenging to get this right in all cases. Broadly, when checking if the docstring ends in a period, I believe we look for the &quot;summary line&quot;, which is considered to be all content up to the first paragraph break.</p>
<p>This is to support docstrings like:</p>
<pre><code>&quot;&quot;&quot;Here's content and
here's more flowing content onto
the next lines
&quot;&quot;&quot;
</code></pre>
<p>Here, we put the period after <code>lines</code>, rather than after <code>and</code>. But that clearly leads to strange output in the case above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">docstring</span> added by @charliermarsh on 2023-04-14 21:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-14 21:11</div>
            <div class="timeline-body"><p>(Not certain what if anything should change -- previous comment is purely informational for now.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-06 01:36</div>
            <div class="timeline-body"><p>Closing this as &quot;expected&quot; for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-06-06 01:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
