<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invalid python files, that ruff parse - astral-sh/ruff #7633</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Invalid python files, that ruff parse</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7633">#7633</a>
        opened by <a href="https://github.com/qarmin">@qarmin</a>
        on 2023-09-24 18:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/qarmin">@qarmin</a></div>
            <div class="timeline-body"><p>Ruff 0.0.291
Cpython 3.11.4</p>
<p>Tested with</p>
<pre><code>ruff format . --check
</code></pre>
<p>and cpython part</p>
<pre><code>python -m compileall .
</code></pre>
<p>https://github.com/qarmin/Automated-Fuzzer/releases/download/test/Cpython.no.parsable.parsable.by.ruff.zip</p>
<p>This makes difficult to report fuzzer problems, because I cannot with only ruff recognize if this is valid python file or not</p>
<p>Example of files</p>
<pre><code>*f
</code></pre>
<pre><code>break
</code></pre>
<pre><code>yield #
</code></pre>
<pre><code>#coding:ut
</code></pre>
<pre><code>from pydanic import BaseModel


class HostedResult(BaseModel):
    id: str
  url: str
</code></pre>
<p>Example of cpython errors</p>
<pre><code>    *Ï
    ^^^
SyntaxError: can&#x27;t use starred expression here
</code></pre>
<pre><code>*** Sorry: IndentationError: unindent does not match any outer indentation level (98_IDX_0_RAND_10049945704112701812.py, line 45)
</code></pre>
<pre><code>    grouping() = &quot;Right&quot;
    ^^^^^^^^^^
SyntaxError: cannot assign to function call here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
</code></pre>
<pre><code>***   File &quot;./990_IDX_0_RAND_14720601008565103604.py&quot;, line 107
    self.u&lt;= a.rSDP = None
    ^^^^^^^^^^^^^^^
SyntaxError: cannot assign to comparison
</code></pre>
<pre><code>SyntaxError: unknown encoding: u
</code></pre>
<pre><code>    &#x27;id&#x27;: (str,await  none_type,),  # noqa: E501
               ^^^^^^^^^^^^^^^^
SyntaxError: &#x27;await&#x27; outside async function
</code></pre>
<pre><code>    from __future__ import absolute_im
    ^
SyntaxError: future feature absolute_im is not defined
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-09-25 04:41</div>
            <div class="timeline-body"><p>Related <a href="https://github.com/astral-sh/ruff/issues/6895">astral-sh/ruff#6895</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-25 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qarmin">@qarmin</a> on 2023-09-29 07:22</div>
            <div class="timeline-body"><p>List of all cpython errors visible in files in first post</p>
<pre><code>SyntaxError: &#x27;ascii&#x27; codec can&#x27;t decode byte 0xc2 in position 16: ordinal not in range(128)
SyntaxError: &#x27;async for&#x27; outside async function
SyntaxError: &#x27;async with&#x27; outside async function
SyntaxError: &#x27;await expression&#x27; can not be used within an annotation
SyntaxError: &#x27;await&#x27; outside async function
SyntaxError: &#x27;await&#x27; outside function
SyntaxError: &#x27;break&#x27; outside loop
SyntaxError: &#x27;comparison&#x27; is an illegal expression for augmented assignment
SyntaxError: &#x27;continue&#x27; not properly in loop
SyntaxError: &#x27;expression&#x27; is an illegal expression for augmented assignment
SyntaxError: &#x27;list&#x27; is an illegal expression for augmented assignment
SyntaxError: &#x27;literal&#x27; is an illegal expression for augmented assignment
SyntaxError: &#x27;return&#x27; outside function
SyntaxError: &#x27;rot13&#x27; is not a text encoding; use codecs.decode() to handle arbitrary codecs
SyntaxError: &#x27;tuple&#x27; is an illegal expression for augmented assignment
SyntaxError: &#x27;utf7&#x27; codec can&#x27;t decode byte 0xc2 in position 22: unexpected special character
SyntaxError: &#x27;yield from&#x27; inside async function
SyntaxError: &#x27;yield&#x27; inside generator expression
SyntaxError: &#x27;yield&#x27; outside function
SyntaxError: Generator expression must be parenthesized
SyntaxError: asynchronous comprehension outside of an asynchronous function
SyntaxError: can&#x27;t use starred expression here
SyntaxError: cannot assign to False
SyntaxError: cannot assign to None
SyntaxError: cannot assign to True
SyntaxError: cannot assign to attribute here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot assign to await expression
SyntaxError: cannot assign to await expression here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot assign to comparison
SyntaxError: cannot assign to expression
SyntaxError: cannot assign to expression here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot assign to function call
SyntaxError: cannot assign to function call here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot assign to lambda
SyntaxError: cannot assign to literal
SyntaxError: cannot assign to literal here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot assign to set display here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot assign to subscript here. Maybe you meant &#x27;==&#x27; instead of &#x27;=&#x27;?
SyntaxError: cannot delete function call
SyntaxError: cannot delete literal
SyntaxError: default &#x27;except:&#x27; must be last
SyntaxError: encoding problem: utI-8 with BOM
SyntaxError: encoding problem: utf-int with BOM
SyntaxError: expected &#x27;else&#x27; after &#x27;if&#x27; expression
SyntaxError: f-string: cannot use starred expression here
SyntaxError: from __future__ imports must occur at the beginning of the file
SyntaxError: future feature Faimportlseannotations is not defined
SyntaxError: illegal target for annotation
SyntaxError: import * only allowed at module level
SyntaxError: invalid character &#x27;¦&#x27; (U+00A6)
SyntaxError: invalid non-printable character U+0084
SyntaxError: invalid syntax
SyntaxError: invalid syntax. Maybe you meant &#x27;==&#x27; or &#x27;:=&#x27; instead of &#x27;=&#x27;?
SyntaxError: iterable unpacking cannot be used in comprehension
SyntaxError: multiple starred expressions in assignment
SyntaxError: name &#x27;LOG&#x27; is used prior to global declaration
SyntaxError: no binding for nonlocal &#x27;card_st&#x27; found
SyntaxError: nonlocal declaration not allowed at module level
SyntaxError: not a chance
SyntaxError: starred assignment target must be in a list or tuple
SyntaxError: too many statically nested blocks
SyntaxError: unexpected EOF while parsing
SyntaxError: unknown encoding: -t1-8
SyntaxError: unterminated string literal (detected at line 13)
SyntaxError: wildcard makes remaining patterns unreachable
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-04 09:09</div>
            <div class="timeline-body"><p>@dhruvmanila this could be an interesting source for obscure parser tests ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-04 09:36</div>
            <div class="timeline-body"><p>Interesting! I think a lot of <a href="https://github.com/astral-sh/ruff/issues/7633#issuecomment-1740424031">this messages</a> shouldn&#x27;t really be handled by the parser. Basically, a lot of them are soft syntax error which means they&#x27;re not raised at the parsing step. For example, <code>&#x27;async with&#x27; outside async function</code>, <code>nonlocal declaration not allowed at module level</code>, <code>&#x27;break&#x27; outside loop</code>, etc. But, this would be useful in the next phase to emit these errors as diagnostics.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fuzzer</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-11 11:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-04-22 13:43</div>
            <div class="timeline-body"><p>This is superseded by #17412 which captures all the remaining syntax errors from the ones mentioned here. Thank you for running the fuzzer and collecting these errors!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-04-22 13:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:43 UTC
    </footer>
</body>
</html>
