<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Autofix error] UP032 Use f-string instead of `format` call - astral-sh/ruff #6093</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Autofix error] UP032 Use f-string instead of <code>format</code> call</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6093">#6093</a>
        opened by <a href="https://github.com/Azd325">@Azd325</a>
        on 2023-07-26 12:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Azd325">@Azd325</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Code Example</p>
<p>testing.py</p>
<pre><code class="language-python">from django.contrib import messages

from apps.user.models import User


def unblock_many(employees):
    return employees


def block_many_in_14_days(user, employees):
    return user, employees


def test_view(request, employees, is_company, action):
    if request.method == &quot;POST&quot;:
        if action == &quot;unblock&quot;:
            messages.info(
                request,
                (&quot;{} unblock many&quot;.format(unblock_many(employees))),
            )
        elif is_company and action == &quot;block-in-14-days&quot;:
            messages.info(
                request,
                (
                    &quot;{} block many in 14 days.&quot;.format(
                        block_many_in_14_days(
                            request.user, User.objects.filter(employee__in=employees)
                        )
                    )
                ),
            )
</code></pre>
<p>pyproject.toml</p>
<pre><code class="language-toml">[tool.ruff]
line-length = 100
exclude = [
    &quot;.git&quot;,
    &quot;migrations&quot;,
    &quot;frontend&quot;,
    &quot;public&quot;,
    &quot;lib&quot;,
    &quot;lib64&quot;,
    &quot;bin&quot;,
    &quot;.venv&quot;,
]
ignore = [
    &quot;E501&quot;,
    &quot;E731&quot;,
]
select = [
    &quot;C9&quot;,
    &quot;E&quot;,
    &quot;F&quot;,
    &quot;W&quot;,
    &quot;UP&quot;,       # pyupgrade
    &quot;I&quot;,        # isort
    &quot;RUF100&quot;,   # Unused noqa directive
]
</code></pre>
<p>CLI</p>
<pre><code class="language-bash">ruff testing.py
testing.py:19:18: UP032 [*] Use f-string instead of `format` call
testing.py:25:21: UP032 [*] Use f-string instead of `format` call
Found 2 errors.
[*] 2 potentially fixable with the --fix option.
</code></pre>
<pre><code class="language-bash">ruff testing.py --fix

error: Autofix introduced a syntax error. Reverting all changes.

This indicates a bug in `ruff`. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BAutofix%20error%5D

...quoting the contents of `testing.py`, the rule codes UP032, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

testing.py:19:18: UP032 Use f-string instead of `format` call
testing.py:25:21: UP032 Use f-string instead of `format` call
Found 2 errors.

</code></pre>
<p>Version</p>
<pre><code>ruff --version
ruff 0.0.280
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[Autofix error]" to "[Autofix error] UP032 Use f-string instead of `format` call" by @Azd325 on 2023-07-26 12:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-26 12:39</div>
            <div class="timeline-body"><p>@harupy - any thoughts on this one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-07-26 12:44</div>
            <div class="timeline-body"><p>Isn't this the issue fixed by #5971?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-07-26 12:46</div>
            <div class="timeline-body"><pre><code>&gt; git log -1
commit 77396c6f92f1515b0cb9ac1f8ba1cdbf39b1d287 (HEAD -&gt; main, upstream/main)
Author: Harutaka Kawamura &lt;hkawamura0130@gmail.com&gt;
Date:   Wed Jul 26 21:37:32 2023 +0900

    Fix `SIM102` to handle indented `elif` (#6072)

&gt; cat a.py
from django.contrib import messages

from apps.user.models import User


def unblock_many(employees):
    return employees


def block_many_in_14_days(user, employees):
    return user, employees


def test_view(request, employees, is_company, action):
    if request.method == &quot;POST&quot;:
        if action == &quot;unblock&quot;:
            messages.info(
                request,
                (&quot;{} unblock many&quot;.format(unblock_many(employees))),
            )
        elif is_company and action == &quot;block-in-14-days&quot;:
            messages.info(
                request,
                (
                    &quot;{} block many in 14 days.&quot;.format(
                        block_many_in_14_days(
                            request.user, User.objects.filter(employee__in=employees)
                        )
                    )
                ),
            )

&gt; cargo run -p ruff_cli -- check a.py --no-cache --select UP032 --fix
    Finished dev [unoptimized + debuginfo] target(s) in 0.08s
     Running `target/debug/ruff check a.py --no-cache --select UP032 --fix`
Found 1 error (1 fixed, 0 remaining).
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-07-26 12:52</div>
            <div class="timeline-body"><pre><code class="language-python">                        block_many_in_14_days(
                            request.user, User.objects.filter(employee__in=employees)
                        )
</code></pre>
<p>is a multiline expression. Inserting this in an f-string causes a syntax error. #5971 fixed it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-26 13:00</div>
            <div class="timeline-body"><p>Thank you :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-07-26 13:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-07-26 13:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Azd325">@Azd325</a> on 2023-07-26 13:28</div>
            <div class="timeline-body"><p>Cool Thanks.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:48 UTC
    </footer>
</body>
</html>
