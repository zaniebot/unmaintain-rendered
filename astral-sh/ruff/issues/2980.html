<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trying to suppress a specific error across entire file suppresses all errors - astral-sh/ruff #2980</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Trying to suppress a specific error across entire file suppresses all errors</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/2980">#2980</a>
        opened by <a href="https://github.com/michaelhball">@michaelhball</a>
        on 2023-02-17 09:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/michaelhball">@michaelhball</a> on 2023-02-17 09:12</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Ruff version: 0.0.247</p>
<p>Ruff settings, <code>pyproject.toml</code></p>
<pre><code class="language-toml">[tool.ruff]
select = [&quot;E&quot;, &quot;W&quot;, &quot;F&quot;, &quot;I&quot;]
</code></pre>
<p>Attempting to suppress a specific error across an entire file results in <em>all</em> errors being suppressed for that file (when using <code>noqa</code> syntax). The <code>per-file-ignores</code> configuration works perfectly, but we'd prefer to keep this rule suppressions local to the files they concern. Tested using <code>ruff: noqa</code> and <code>flake8: noqa</code>.</p>
<p>To be specific, running the command <code>ruff check doot.py</code> on</p>
<pre><code class="language-python">import matplotlib as mpl
mpl.use(&quot;Agg&quot;)

import io


x_func = lambda x: x * 2
</code></pre>
<p>correctly indicates four errors</p>
<pre><code class="language-bash">doot.py:5:1: E402 Module level import not at top of file
doot.py:5:1: I001 [*] Import block is un-sorted or un-formatted
doot.py:5:8: F401 [*] `io` imported but unused
doot.py:8:1: E731 [*] Do not assign a `lambda` expression, use a `def`
Found 4 errors.
[*] 3 potentially fixable with the --fix option.
</code></pre>
<p>but if I add <code>&quot;ruff: noqa: E402&quot;</code> to the top of <code>doot.py</code> (or <code>flake8</code>)</p>
<pre><code class="language-python"># ruff: noqa: E402
import matplotlib as mpl
mpl.use(&quot;Agg&quot;)

import io


x_func = lambda x: x * 2
</code></pre>
<p>all errors are suppressed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-17 12:48</div>
            <div class="timeline-body"><p>Funnily enough I just added support for this! https://github.com/charliermarsh/ruff/pull/2978</p>
<p>(Note as a word of caution that Flake8 doesn't support this, so if you're using <code># noqa: flake8: F481</code> or similar in existing code, Flake8 treats that as a whole-file ignore.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-02-17 12:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-17 12:49</div>
            <div class="timeline-body"><p>(It'll go out in the next release, before the end of the weekend.)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:49 UTC
    </footer>
</body>
</html>
