<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D400 auto-fix is incorrect - astral-sh/ruff #3538</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>D400 auto-fix is incorrect</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/3538">#3538</a>
        opened by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a>
        on 2023-03-15 10:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-03-15 10:48</div>
            <div class="timeline-body"><p>I use PEP 257 convention and <code>select=ALL</code>.</p>
<pre><code class="language-python">def check_clockwise(polygon: List[LatLong]) -&gt; bool:
    &quot;&quot;&quot;Checks if a polygon is declared (mostly) clockwise,
    or if it's in the correct orientation&quot;&quot;&quot;
</code></pre>
<p>becomes</p>
<pre><code class="language-python">def check_clockwise(polygon: List[LatLong]) -&gt; bool:
    &quot;&quot;&quot;Checks if a polygon is declared (mostly) clockwise,
    or if it's in the correct orientation
    .
    &quot;&quot;&quot;
</code></pre>
<p>D400 is declared as always auto-fixable.
I would not add a period if there is no empty line between the first line and the rest of the docstring like in the case above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-15 19:53</div>
            <div class="timeline-body"><p>It puts the period on its own line?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-03-15 20:08</div>
            <div class="timeline-body"><p>Yes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-15 23:35</div>
            <div class="timeline-body"><p>Very sad!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-03-15 23:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">autofix</span> added by @charliermarsh on 2023-03-15 23:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-15 23:39</div>
            <div class="timeline-body"><p>Ah I think this is <code>D209</code> and <code>D400</code> competing, the fixes conflict, we end up adding the newline <em>after</em> the period. If I <em>just</em> fix <code>D400</code>, it works as expected:</p>
<pre><code class="language-py">def check_clockwise(polygon: List[LatLong]) -&gt; bool:
    &quot;&quot;&quot;Checks if a polygon is declared (mostly) clockwise,
    or if it's in the correct orientation.&quot;&quot;&quot;
</code></pre>
<p>I think the expected outcome, as long as you have  here is:</p>
<pre><code class="language-py">def check_clockwise(polygon: List[LatLong]) -&gt; bool:
    &quot;&quot;&quot;Checks if a polygon is declared (mostly) clockwise,
    or if it's in the correct orientation.
    &quot;&quot;&quot;
</code></pre>
<p>Or even:</p>
<pre><code class="language-py">```py
def check_clockwise(polygon: List[LatLong]) -&gt; bool:
    &quot;&quot;&quot;Checks if a polygon is declared (mostly) clockwise,
    or if it's in the correct orientation.&quot;&quot;&quot;
</code></pre>
<p>If we're considering the &quot;summary line&quot; to be the first logical line, rather than the first physical line.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3564.html">astral-sh/ruff#3564</a> on 2023-03-16 22:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-03-17 02:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
