<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLE001 (blind-except): false positive when logging via `warning` - astral-sh/ruff #21889</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>BLE001 (blind-except): false positive when logging via <code>warning</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/21889">#21889</a>
        opened by <a href="https://github.com/bentheiii">@bentheiii</a>
        on 2025-12-10 08:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bentheiii">@bentheiii</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>As per the documentation for BLE001, the following will not trigger the rule:</p>
<pre><code class="language-py">try:
    foo()
except BaseException:
    logging.error(&quot;Something went wrong&quot;, exc_info=True)
</code></pre>
<p>But this will</p>
<pre><code class="language-py">try:
    foo()
except BaseException:
    logging.warning(&quot;Something went wrong&quot;, exc_info=True)
</code></pre>
<p>I'd argue that, from a user perspective, the two are equivalent in terms of error handling. The user decided to log the error, including its entire stack trace. The level of the log then, is more or less irrelevant. For the purpose of the argument, the following will also be flagged:</p>
<pre><code class="language-py">try:
    foo()
except BaseException:
    logging.log(logging.ERROR, &quot;Something went wrong&quot;, exc_info=True)
</code></pre>
<p>I propose that instead of <a href="https://github.com/astral-sh/ruff/blob/8293afe2ae7af79fe7d646c39dc2636d38b29fa0/crates/ruff_linter/src/rules/flake8_blind_except/rules/blind_except.rs#L226">only validating logger method calls</a> to <code>error</code>/<code>critical</code> with <code>exc_info</code>,  the lint will validate calls to all log levels (<code>critical</code>, <code>error</code>, <code>warning</code>, <code>info</code>, <code>debug</code>, and the level-agnostic <code>log</code>) with <code>exc_info</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-10 17:07</div>
            <div class="timeline-body"><p>Hmm, yeah this makes sense to me! I looked through the history a bit and didn't see any reason why these were restricted to <code>error</code> and <code>critical</code> (<code>critical</code> itself is relatively new in https://github.com/astral-sh/ruff/pull/19520). All of the other methods seem to take <code>exc_info</code> too: https://docs.python.org/3/library/logging.html#logging.Logger.info, so I think they should all suppress the diagnostic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-12-10 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lubaskinc0de">@lubaskinc0de</a> on 2025-12-14 22:22</div>
            <div class="timeline-body"><p>Hello can i work on it? Or this is already taken?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-15 14:22</div>
            <div class="timeline-body"><p>Go for it! I don't see any open PRs for this issue or this rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @lubaskinc0de by @ntBre on 2025-12-15 14:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lubaskinc0de">@lubaskinc0de</a> on 2025-12-16 08:45</div>
            <div class="timeline-body"><blockquote>
<p>Go for it! I don't see any open PRs for this issue or this rule.
https://github.com/astral-sh/ruff/blob/main/crates/ruff_linter/src/rules/flake8_blind_except/rules/blind_except.rs#L228</p>
</blockquote>
<p>Right now I can see that only the <code>exc_info</code> set to the <code>True</code> constant is checked, even though the documentation says that <code>exc_info</code> can also be set to more than just <code>True</code></p>
<blockquote>
<p>If exc_info does not evaluate as false, it causes exception information to be added to the logging message. If an exception tuple (in the format returned by <a href="https://docs.python.org/3/library/sys.html#sys.exc_info">sys.exc_info()</a>) or an exception instance is provided, it is used; otherwise, <a href="https://docs.python.org/3/library/sys.html#sys.exc_info">sys.exc_info()</a> is called to get the exception information.</p>
</blockquote>
<pre><code class="language-py">import logging

try:
    2 + &quot;a&quot;
except BaseException as e:
    logging.error(&quot;aaa&quot;, exc_info=e)
</code></pre>
<p>In the current version of ruff, this code also throws error BLE001 if <code>exc_info</code> is set to <code>e</code> and not <code>True</code>, although it shouldn't.</p>
<p>The question is, should I correct this as well?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-12-16 14:26</div>
            <div class="timeline-body"><p>I think it would be okay to try that change too and take a look at the ecosystem impact. I took a brief look through the git history and didn't see any reason we only consider literal <code>True</code>. We could at least try using <a href="https://github.com/astral-sh/ruff/blob/0f373603ebd007196af4f211e14d421024a6b947/crates/ruff_python_ast/src/helpers.rs#L1201"><code>Truthiness</code></a>, which would only be a little more relaxed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2026-01-14 21:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-14 21:44:45 UTC
    </footer>
</body>
</html>
