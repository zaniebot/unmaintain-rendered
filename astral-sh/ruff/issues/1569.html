<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pydocstyle `convention = &quot;google&quot;` does not work as expected - astral-sh/ruff #1569</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Pydocstyle <code>convention = &quot;google&quot;</code> does not work as expected</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1569">#1569</a>
        opened by <a href="https://github.com/stinodego">@stinodego</a>
        on 2023-01-02 22:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/stinodego">@stinodego</a> on 2023-01-02 22:48</div>
            <div class="timeline-body"><p>Minimal reproduction:</p>
<h4>pyproject.toml</h4>
<pre><code class="language-toml">[tool.ruff]
select = [&quot;D&quot;]

[tool.ruff.pydocstyle]
convention = &quot;google&quot;
</code></pre>
<h4>testruff.py</h4>
<pre><code class="language-python">def some_function(n):
    &quot;&quot;&quot;Return some result.

    Args:
        n: Number.
    &quot;&quot;&quot;
</code></pre>
<p>Running <code>ruff testruff.py</code> gives:</p>
<pre><code class="language-bash">testruff.py:1:1: D100 Missing docstring in public module
testruff.py:2:5: D213 Multi-line docstring summary should start at the second line
testruff.py:2:5: D407 Missing dashed underline after section (&quot;Args&quot;)
Found 3 error(s).
1 potentially fixable with the --fix option.
</code></pre>
<p>However, as specified in <a href="http://www.pydocstyle.org/en/stable/error_codes.html#default-conventions">pydocstyle docs</a>, D213 and D407 should not be checked for the Google docstring convention.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-02 22:52</div>
            <div class="timeline-body"><p>Yeah, this is known but not good. It's documented <a href="https://github.com/charliermarsh/ruff#does-ruff-support-numpy--or-google-style-docstrings">here</a>. In short, we only use <code>convention</code> to help with some of the checks themselves, and not to configure which checks are enabled. For that, you <em>have</em> to go through <code>select</code> and <code>ignore</code>. (There are example, proper configurations present in the linked FAQ.)</p>
<p>I'll consider making <code>convention</code> automatically add the relevant checks to <code>select</code>. I wanted to keep <code>select</code> &quot;pure&quot; in this way but it might be too confusing as-is.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-02 22:53</div>
            <div class="timeline-body"><p>I'll play around with this now, maybe it'll turn out clean.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @charliermarsh on 2023-01-02 22:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">docstring</span> added by @charliermarsh on 2023-01-02 22:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> removed by @charliermarsh on 2023-01-02 22:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-01-02 22:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stinodego">@stinodego</a> on 2023-01-02 23:02</div>
            <div class="timeline-body"><p>Apologies, I missed that section of the README. Thanks for pointing me to it. Maybe just adding a disclaimer <a href="https://github.com/charliermarsh/ruff#pydocstyle">here</a> would already help.</p>
<p>Feel free to close this if you prefer to keep the current behaviour.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-02 23:04</div>
            <div class="timeline-body"><p>The current setup is confusing enough that I'm slightly embarrassed by it, which is a sign that I should probably fix it ðŸ˜…</p>
<p>I'll use this issue to track the work, if that's okay.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-03 00:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stinodego">@stinodego</a> on 2023-01-03 07:32</div>
            <div class="timeline-body"><p>@charliermarsh Thanks for the quick solution here! I have one comment on the approach you implemented:</p>
<p>Could it be more intuitive if the <code>convention = &quot;google&quot;</code> actually populates the <code>ignore</code> list rather than the <code>select</code> list? Before your change, my settings looked like this (leaving out unrelated lints):</p>
<pre><code class="language-toml">[tool.ruff]
select = [
    &quot;D&quot;,  # pydocstyle
]
ignore = [
    # Google docstring convention
    &quot;D203&quot;, &quot;D204&quot;, &quot;D213&quot;, &quot;D215&quot;,
    &quot;D400&quot;, &quot;D404&quot;, &quot;D406&quot;, &quot;D407&quot;, &quot;D408&quot;, &quot;D409&quot;, &quot;D413&quot;,
    # Docstrings not required
    &quot;D1&quot;
]

[tool.ruff.pydocstyle]
convention = &quot;google&quot;
</code></pre>
<p>My thinking was that by adding <code>select = [&quot;D&quot;]</code>, I 'enable' pydocstyle. And then by specifying the convention, I configure it to behave the way I want.</p>
<p>Now my settings look like this:</p>
<pre><code class="language-toml">[tool.ruff]
select = []
ignore = [
    # Docstrings not required
    &quot;D1&quot;
]

[tool.ruff.pydocstyle]
convention = &quot;google&quot;
</code></pre>
<p>This feels weird, because it is not clear that I ever 'enabled' pydocstyle, but I am ignoring error codes for it and configuring it. By making the configuration populate the ignore list, I could have a settings file that makes sense to my way of thinking:</p>
<pre><code class="language-toml">[tool.ruff]
select = [
    &quot;D&quot;,  # pydocstyle
]
ignore = [
    # Docstrings not required
    &quot;D1&quot;
]

[tool.ruff.pydocstyle]
convention = &quot;google&quot;
</code></pre>
<p>This approach would also make sense with the way the conventions are <a href="http://www.pydocstyle.org/en/stable/error_codes.html#default-conventions">formulated</a>: &quot;All lints except ...&quot;. And it is in line with how people are used to working with flake8 extensions: you add an extension (<code>pip install flake8-docstrings</code>), then you configure it (<code>convention = &quot;google&quot;</code>).</p>
<p>Curious to hear your thoughts about this! Either way, very happy with the existing solution and <code>ruff</code> as a new tool in my toolbelt!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stinodego">@stinodego</a> on 2023-01-03 07:50</div>
            <div class="timeline-body"><p>And another note: the VSCode extension now no longer underlines docstrings, even if they would raise an error code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-03 12:24</div>
            <div class="timeline-body"><p>Yeah I think what you're describing makes sense. I can make that change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-03 12:25</div>
            <div class="timeline-body"><blockquote>
<p>And another note: the VSCode extension now no longer underlines docstrings, even if they would raise an error code.</p>
</blockquote>
<p>Is it possible that you're using the bundled version of the extension, which hasn't yet been updated?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stinodego">@stinodego</a> on 2023-01-03 12:25</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>And another note: the VSCode extension now no longer underlines docstrings, even if they would raise an error code.</p>
</blockquote>
<p>Is it possible that you're using the bundled version of the extension, which hasn't yet been updated?</p>
</blockquote>
<p>Oh yeah that's probably it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-03 12:31</div>
            <div class="timeline-body"><p>I'll cut a new pre-release in a bit :)</p>
<p>You can also point the extension to an interpreter or hard-code the path to the Ruff binary in the extension settings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-03 22:09</div>
            <div class="timeline-body"><p>I think what you're describing above makes sense, RE adding to the <code>ignore</code> list instead. It's kind of like saying that <code>convention = &quot;google&quot;</code> makes Ruff operate as if none of the non-Google-related checks exist? And it's a little more explicit which I prefer.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zundertj">@zundertj</a> on 2023-07-15 09:04</div>
            <div class="timeline-body"><p>Hello, I understand that this change may be seen as an improvement over the previous behavior, but the current behavior is still lacking imo. Starting with this</p>
<pre><code class="language-toml">[tool.ruff]
select = [
    &quot;D&quot;,  # pydocstyle
]
ignore = [
    # Docstrings not required
    &quot;D1&quot;
]

[tool.ruff.pydocstyle]
convention = &quot;google&quot;
</code></pre>
<p>It will turn off all rules not part of the Google convention, <em>including</em> rules that are still compatible. How could one get all rules except the ones in conflict with the convention, i.e. to maximize the number of checks whilst being in line with the convention? It forces us to abandon the convention config altogether, as it leaves no way for us to turn on compatible-but-not-included rules. I like the explicitness of setting &quot;convention = X&quot; rather than a bunch of <code>D</code> codes, but it seems that can only be had if you are not interested in rules in addition to the convention at the moment.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:28:45 UTC
    </footer>
</body>
</html>
