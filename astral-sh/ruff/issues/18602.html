<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PYI059 fix moves `Generic` after keyword arguments - astral-sh/ruff #18602</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>PYI059 fix moves <code>Generic</code> after keyword arguments</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18602">#18602</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-06-10 00:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-06-10 00:37</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>The fix for <a href="https://docs.astral.sh/ruff/rules/generic-not-last-base-class/"><code>generic-not-last-base-class</code> (PYI059)</a> moves <code>Generic</code> after keyword arguments, which is a syntax error. It should be moved after the other positional arguments but before any keyword arguments.</p>
<pre><code class="language-console">$ cat &gt;pyi059_1.py &lt;&lt;'# EOF'
from typing import Generic, TypeVar
T = TypeVar(&quot;T&quot;)
class C1(Generic[T], str, **{&quot;metaclass&quot;: type}): ...
class C2(Generic[T], str, metaclass=type): ...
# EOF

$ ruff --isolated check pyi059_1.py --select PYI059 --preview --diff 2&gt;&amp;1 | grep error:
error: Fix introduced a syntax error. Reverting all changes.
</code></pre>
<p>A starred argument may follow a keyword argument in an inheritance list (cf. <a href="https://docs.astral.sh/ruff/rules/star-arg-unpacking-after-keyword-arg/"><code>star-arg-unpacking-after-keyword-arg</code> (B026)</a>).</p>
<pre><code class="language-console">$ cat &gt;pyi059_2.py &lt;&lt;'# EOF'
from typing import Generic, TypeVar
T = TypeVar(&quot;T&quot;)
class C3(Generic[T], metaclass=type, *[str]): ...
# EOF

$ ruff --isolated check pyi059_2.py --select PYI059 --preview --diff 2&gt;&amp;1 | grep error:
error: Fix introduced a syntax error. Reverting all changes.
</code></pre>
<p>In that case, one way to make <code>Generic</code> be the last base class is to move it after the starred arguments, and then to move the keyword arguments after <code>Generic</code>.</p>
<pre><code class="language-python">class C3(*[str], Generic[T], metaclass=type): ...
</code></pre>
<p>Alternatively, <code>Generic</code> could be moved into its own starred argument after the other starred arguments, leaving the keyword arguments unmoved.</p>
<pre><code class="language-python">class C3(metaclass=type, *[str], *[Generic[T]]): ...
</code></pre>
<h3>Version</h3>
<p>ruff 0.11.13 (5faf72a4d 2025-06-05)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2025-06-10 02:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @ntBre on 2025-06-10 02:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-10 02:35</div>
            <div class="timeline-body"><p>Thanks for all of these reports, they're very helpful in our stabilization decisions for the release.</p>
<p>The fix is already only sometimes available, so another viable option here could be avoiding a fix when keyword arguments are present.</p>
<p>I think the <code>**{&quot;metaclass&quot;: type}</code> case will be an important test to add too, either way. I remember running into something surprising with this kind of unpacking in another rule recently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-06-10 12:37</div>
            <div class="timeline-body"><p>I’m glad you’re finding them helpful. I generally limit myself to one a day but I don’t want to delay any reports that could affect the release.</p>
<p>The <code>C2</code> pattern has <a href="https://github.com/search?q=language%3APython+%2Fclass+%5Cw%2B%5C%28.*%5CbGeneric%5C%5B%5B%5E%5D%5D%2B%5C%5D%2C.*%2C.*%3D%2F&amp;type=code">some hits on GitHub</a>, so a fix for it could be useful. The others are not common.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @ntBre by @ntBre on 2025-06-10 13:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-06-10 16:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:37:38 UTC
    </footer>
</body>
</html>
