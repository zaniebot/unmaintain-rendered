<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F722 and F821 errors reported using typing annotations. - astral-sh/ruff #2342</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>F722 and F821 errors reported using typing annotations.</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/2342">#2342</a>
        opened by <a href="https://github.com/KelSolaar">@KelSolaar</a>
        on 2023-01-30 08:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/KelSolaar">@KelSolaar</a> on 2023-01-30 08:43</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

- A minimal code snippet that reproduces the bug.
- The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
- The current Ruff settings (any relevant sections from your `pyproject.toml`).
- The current Ruff version (`ruff --version`).
-->

<p>Hello,</p>
<p>Using <code>ruff 0.0.237</code>, I get similar <code>F722</code> and <code>F821</code> errors as those reported in #548. I'm opening a new ticket as the previous one is old and closed.</p>
<p>Given the following:</p>
<pre><code class="language-python">from __future__ import annotations

import numpy as np

from colour.adaptation import CHROMATIC_ADAPTATION_TRANSFORMS
from colour.algebra import matrix_dot, vector_dot, sdiv, sdiv_mode
from colour.hints import ArrayLike, Literal, NDArrayFloat, Union
from colour.utilities import (
    from_range_1,
    row_as_diagonal,
    to_domain_1,
    validate_method,
)

def matrix_chromatic_adaptation_VonKries(
    XYZ_w: ArrayLike,
    XYZ_wr: ArrayLike,
    transform: Union[
        Literal[
            &quot;Bianco 2010&quot;,
            &quot;Bianco PC 2010&quot;,
            &quot;Bradford&quot;,
            &quot;CAT02 Brill 2008&quot;,
            &quot;CAT02&quot;,
            &quot;CAT16&quot;,
            &quot;CMCCAT2000&quot;,
            &quot;CMCCAT97&quot;,
            &quot;Fairchild&quot;,
            &quot;Sharp&quot;,
            &quot;Von Kries&quot;,
            &quot;XYZ Scaling&quot;,
        ],
        str,
    ] = &quot;CAT02&quot;,
) -&gt; NDArrayFloat:
    ...
</code></pre>
<pre><code>colour/adaptation/vonkries.py:49:13: F722 Syntax error in forward annotation: `Bianco 2010`
colour/adaptation/vonkries.py:50:13: F722 Syntax error in forward annotation: `Bianco PC 2010`
colour/adaptation/vonkries.py:51:13: F821 Undefined name `Bradford`
colour/adaptation/vonkries.py:52:13: F722 Syntax error in forward annotation: `CAT02 Brill 2008`
colour/adaptation/vonkries.py:53:13: F821 Undefined name `CAT02`
colour/adaptation/vonkries.py:54:13: F821 Undefined name `CAT16`
colour/adaptation/vonkries.py:55:13: F821 Undefined name `CMCCAT2000`
colour/adaptation/vonkries.py:56:13: F821 Undefined name `CMCCAT97`
colour/adaptation/vonkries.py:57:13: F821 Undefined name `Fairchild`
colour/adaptation/vonkries.py:58:13: F821 Undefined name `Sharp`
colour/adaptation/vonkries.py:59:13: F722 Syntax error in forward annotation: `Von Kries`
colour/adaptation/vonkries.py:60:13: F722 Syntax error in forward annotation: `XYZ Scaling`
</code></pre>
<p>I only have 1413 of them! ;)</p>
<p>Cheers,</p>
<p>Thomas</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-30 12:17</div>
            <div class="timeline-body"><p>So, I think what you need to do here is tell Ruff that the imports from <code>colour.hints</code> should be treated as aliases for the <code>typing</code> module, like so:</p>
<pre><code class="language-toml">[tool.ruff]
typing-modules = [&quot;colour.hints&quot;]
</code></pre>
<p>Can you give that a try? Will reopen if you're still seeing this of course!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-30 12:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KelSolaar">@KelSolaar</a> on 2023-01-30 18:23</div>
            <div class="timeline-body"><p>That was it, thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/crypdick">@crypdick</a> on 2024-02-15 16:02</div>
            <div class="timeline-body"><p>For future visitors, the solution above will throw a warning <code>warning: The top-level linter settings are deprecated in favour of their counterparts in the lint section. Please update the following options in pyproject.toml: - 'typing-modules' -&gt; 'lint.typing-modules'</code> . The updated code is:</p>
<pre><code>[tool.ruff.lint]
typing-modules = [&quot;colour.hints&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../beartype/beartype/issues/326.html">beartype/beartype#326</a> on 2024-02-15 16:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:08 UTC
    </footer>
</body>
</html>
