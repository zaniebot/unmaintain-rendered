<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>False positible ANN001 Missing type annotation for function argument `self` - astral-sh/ruff #14295</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>False positible ANN001 Missing type annotation for function argument `self`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/14295">#14295</a>
        opened by <a href="https://github.com/ssbarnea">@ssbarnea</a>
        on 2024-11-12 10:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ssbarnea">@ssbarnea</a> on 2024-11-12 10:46</div>
            <div class="timeline-body"><p>Current version of ruff (0.7.3) does provide a false-positive message about types for <code>self</code>.</p>
<p>Config reproduce</p>
<pre><code class="language-toml">[tool.ruff.lint]
select = [&quot;ALL&quot;]
</code></pre>
<p>While <a href="https://github.com/astral-sh/ruff/issues/4396">ANN101 was removed more than a year ago</a> and its issue closed as done, we missed to spot that <code>ANN001</code> will trigger the same problem.</p>
<p>That is forcing us to disable entire <code>ANN001</code> rule until this is sorted as adding type to self does create a huge amount of boilerplate that is only making function signatures harder to read.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4396.html">astral-sh/ruff#4396</a> on 2024-11-12 10:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-11-12 11:10</div>
            <div class="timeline-body"><p>@AlexWaygood I'm a bit at a loss here. Would you mind taking a look?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-11-12 11:38</div>
            <div class="timeline-body"><p>Can you provide a code to reproduce this? I believe it shouldn't flag the <code>self</code> argument: https://play.ruff.rs/df6e79ac-202b-454e-b85e-120619b96645</p>
<p>Looking at the implementation, it does skip <code>self</code> or <code>cls</code> for non-static methods:</p>
<p>https://github.com/astral-sh/ruff/blob/be69f61b3ec42f5cda2490ff64c1efb9814f98f0/crates/ruff_linter/src/rules/flake8_annotations/rules/definition.rs#L605-L612</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssbarnea">@ssbarnea</a> on 2024-11-12 11:54</div>
            <div class="timeline-body"><p>Oops, sorry my mistake. It proved to be a nested function with the very unfortunate (incorrect) use of self.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ssbarnea on 2024-11-12 11:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:54 UTC
    </footer>
</body>
</html>
