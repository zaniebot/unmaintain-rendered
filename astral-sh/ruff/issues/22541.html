<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Misleading documentation for B904: raise-without-from-inside-except - astral-sh/ruff #22541</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Misleading documentation for B904: raise-without-from-inside-except</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/22541">#22541</a>
        opened by <a href="https://github.com/shawnz">@shawnz</a>
        on 2026-01-12 22:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shawnz">@shawnz</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Rule B904 has docs which I find to be misleading. In the docs, <a href="https://github.com/astral-sh/ruff/blob/3ae4db3ccd227ec58870c4309ab46e24a4c5cdf2/crates/ruff_linter/src/rules/flake8_bugbear/rules/raise_without_from_inside_except.rs#L21">they claim</a>:</p>
<blockquote>
<p>When raising an exception from within an except clause, always include a from clause to facilitate exception chaining. If the exception is not chained, it will be difficult to trace the exception back to its root cause.</p>
</blockquote>
<p>But actually, exceptions get implicitly chained by default if there's no <code>from</code> clause. So this rule never helps facilitate chaining: it can only either A) reduce chaining, by encouraging people to specify <code>from None</code>, or B) just make the default chaining which was already happening more explicit.</p>
<p>I prefer to chain exceptions wherever possible for the reason indicated: I want to have the most possible context to be able to trace errors to their root cause. And having this rule active just creates needless boilerplate to capture what the default behaviour already would have done. If the docs were more accurate about this, I think it would be clearer that this is a rule which should be deselected for most people (IMO).</p>
<p>There's an argument that explicit chaining produces a slightly nicer message in the traceback than implicit chaining (<code>The above exception was the direct cause of the following exception</code> vs <code>During handling of the above exception, another exception occurred</code>). But if that small difference is the whole reason for this rule's existence, I think that is a lot harder to justify all the boilerplate created as a result of applying this rule and I think the docs could be more clear about the limited benefit.</p>
<p>Thanks, Shawn</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2026-01-12 23:36</div>
            <div class="timeline-body"><p>There are a couple of dunder attributes that are also set differently in implicit vs explicit chaining: https://docs.python.org/3/library/exceptions.html#exception-context, so it's not <em>just</em> about the error message. But @amyreese may know better than me how common inspecting those would be. I think we could make the documentation more precise in any case and possibly include the link above and/or <a href="https://peps.python.org/pep-3134/">PEP 3134</a>, which has some additional context.</p>
<p>There was some previous discussion of this in https://github.com/astral-sh/ruff/issues/8736, which was closed in https://github.com/astral-sh/ruff/pull/9680, but it doesn't look like the docs were updated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @ntBre on 2026-01-12 23:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shawnz">@shawnz</a> on 2026-01-13 01:15</div>
            <div class="timeline-body"><p>I see, sorry for the dupe!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2026-01-13 15:30</div>
            <div class="timeline-body"><p>No need to apologize! The other issue was closed, so thank you for reopening the discussion. I think <a href="https://github.com/astral-sh/ruff/issues/8736#issuecomment-1816525873">this comment</a> about updating the docs is still relevant.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-13 16:29:08 UTC
    </footer>
</body>
</html>
