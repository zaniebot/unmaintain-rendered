<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0.6.7: `ruff --diff` does not generate quoted file name when file or directory contains spaces - astral-sh/ruff #13489</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>0.6.7: `ruff --diff` does not generate quoted file name when file or directory contains spaces</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/13489">#13489</a>
        opened by <a href="https://github.com/kloczek">@kloczek</a>
        on 2024-09-23 21:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kloczek">@kloczek</a> on 2024-09-23 21:50</div>
            <div class="timeline-body"><p>In such cases instead generate</p>
<pre><code class="language-parch">--- foo bar/bar.py
+++ foo bar/bar.py
</code></pre>
<p>Should be generated</p>
<pre><code class="language-parch">--- &quot;foo bar/bar.py&quot;
+++ &quot;foo bar/bar.py&quot;
</code></pre>
<p>Issue can be tested on <code>meson</code>  (https://github.com/mesonbuild/meson/) or <code>ipyparallel</code> (https://github.com/ipython/ipyparallel/) code</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-23 22:01</div>
            <div class="timeline-body"><p>Is this per a specification or something? Or just what you would prefer? e.g. <code>diff</code> does not do this</p>
<pre><code>❯ echo &quot;test&quot; &gt; &quot;foo bar&quot;
❯ echo &quot;test2&quot; &gt; &quot;foobar&quot;
❯ diff foo\ bar foobar --unified=0
--- foo bar	2024-09-23 16:59:54
+++ foobar	2024-09-23 16:59:59
@@ -1 +1 @@
-test
+test2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-23 22:02</div>
            <div class="timeline-body"><p>Nor does <code>git</code></p>
<pre><code>❯ ga foo\ bar
❯ echo &quot;test2&quot; &gt; &quot;foo bar&quot;
❯ gd
diff --git a/foo bar b/foo bar
index 9daeafb98..180cf8328 100644
--- a/foo bar   
+++ b/foo bar   
@@ -1 +1 @@
-test
+test2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-09-23 22:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-11-20 12:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kloczek">@kloczek</a> on 2025-04-14 02:58</div>
            <div class="timeline-body"><blockquote>
<p>Is this per a specification or something? Or just what you would prefer? e.g. <code>diff</code> does not do this</p>
</blockquote>
<p>You did not use ruff to generate that patch.
<strong>This issue is about patch generated by ruff.</strong></p>
<p>Please reopen this ticket.
I've proficed example githunb repo https://github.com/mesonbuild/meson/  on which i poossible to test this issue.
Please::</p>
<ul>
<li>clone https://github.com/mesonbuild/meson/</li>
<li>generate &quot;ruff --diff&quot; and check what is in the <strong>generated</strong> output.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kloczek">@kloczek</a> on 2025-04-14 03:00</div>
            <div class="timeline-body"><blockquote>
<p>Nor does <code>git</code></p>
</blockquote>
<p>Reported issue has nothing to do with git.
It is about what generates  &quot;ruff --diff&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-14 12:58</div>
            <div class="timeline-body"><p>I think Zanie understood that the question was about ruff's behavior and was pointing out that this is how other tools that generate diffs (<code>git</code>, <code>diff</code>) also work. As such, it's not really a bug in ruff, it's a common diffing behavior across multiple tools.</p>
<p>Do you have a concrete use case that is being impacted by this, or is this a stylistic preference for what the output looks like?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kloczek">@kloczek</a> on 2025-04-16 17:42</div>
            <div class="timeline-body"><blockquote>
<p>I think Zanie understood that the question was about ruff's behavior and was pointing out that this is how other tools that generate diffs (git, diff) also work. As such, it's not really a bug in ruff, it's a common diffing behavior across multiple tools.</p>
</blockquote>
<p>Yes those tools are buggy as well.
Space o tab after path is skipped as that part usually contains time stamp so to mark that space is not part of the time stamp path needs to quoted or spaces in that path needs to quoted using &quot;\&quot;. Tools like patch and git understands already those quotations.
<strong>There is no any oper way to distinguish those two cases</strong>.
Patch generated without quoted paths or spaces cannot be used by patch and git -&gt; Ergo: it is the bug.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:53 UTC
    </footer>
</body>
</html>
