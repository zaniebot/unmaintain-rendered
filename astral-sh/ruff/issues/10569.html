<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make E741 not apply to stub files - astral-sh/ruff #10569</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Make E741 not apply to stub files</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10569">#10569</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-03-25 12:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><p>I think it would make sense to have E741 (<a href="https://docs.astral.sh/ruff/rules/ambiguous-variable-name/"><code>ambiguous-variable-name</code></a>) not apply to stub files.</p>
<p>Unlike with runtime <code>.py</code> files, stub authors generally have no control over the names of variables that appear in a stub. A well-written stub should aim to faithfully represent the interface of the equivalent <code>.py</code> file as it exists at runtime, and that includes any ambiguously named variables in the runtime module. Even if the source code for the stubs is located in the same repository as the runtime module being stubbed, you likely won&#x27;t be able to change an ambiguously named variable in the stub without also changing the corresponding runtime module, and tools like <a href="https://mypy.readthedocs.io/en/stable/stubtest.html">stubtest</a> will generally help stub authors ensure consistency between the runtime module and the stub.</p>
<p>Typeshed has <a href="https://github.com/python/typeshed/blob/db8e620e3db6eee13f70fbb6cfc90a851e4260c1/pyproject.toml#L92">always ignored this rule for <code>.pyi</code> files in our ruff config</a> (and before that, in our <code>.flake8</code> config), and I can&#x27;t think of a situation in which it would be useful when applied to stubs.</p>
<p>Would we need some kind of deprecation period for this change? Or could we just make it?</p>
<p>(F403 and F405 (regarding <code>*</code> imports) similarly flag things that are out of the control of stub authors. But these rules highlight places where ruff&#x27;s inference capabilities will be severely limited due to the specific idioms being used, so I think we should probably keep these enabled by default, even for <code>.pyi</code> files.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 12:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">linter</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-03-25 12:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-03 00:58</div>
            <div class="timeline-body"><p>I think this makes sense! We could ship it as part of v0.5.0 if you want?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.5.0&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-01 23:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;v0.5.0&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-27 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.6&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-27 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;v0.6&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-12 10:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.7&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-12 10:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-27 14:02</div>
            <div class="timeline-body"><p>We&#x27;ve now made this change in preview mode; we&#x27;ll be stabilising it in Ruff 0.7. Thanks @calumy!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;v0.7&quot; by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-10-17 15:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.8&quot; by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-10-17 15:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-11-17 02:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:51 UTC
    </footer>
</body>
</html>
