<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sorting imports with aliases expands to multiple lines (using ruff --select I) - astral-sh/ruff #16399</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Sorting imports with aliases expands to multiple lines (using ruff --select I)</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/16399">#16399</a>
        opened by <a href="https://github.com/timotk">@timotk</a>
        on 2025-02-26 15:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/timotk">@timotk</a> on 2025-02-26 15:08</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have an issue with sorting imports. I have a bunch of aliased imports from a single module (aws_cdk):</p>
<pre><code class="language-python">from aws_cdk import (
    NestedStack,
    aws_ecr as ecr,
    aws_ecs as ecs,
    aws_events as events,
    aws_events_targets as targets,
    aws_iam as iam,
    aws_logs as logs,
)
</code></pre>
<p>To fix/sort them, I run:</p>
<pre><code>ruff check --fix --select I my_file.py
</code></pre>
<p>This results in the following code:</p>
<pre><code class="language-python">from aws_cdk import (
    NestedStack,
)
from aws_cdk import (
    aws_ecr as ecr,
)
from aws_cdk import (
    aws_ecs as ecs,
)
from aws_cdk import (
    aws_events as events,
)
from aws_cdk import (
    aws_events_targets as targets,
)
from aws_cdk import (
    aws_iam as iam,
)
from aws_cdk import (
    aws_logs as logs,
)
</code></pre>
<p>This is not what I would expect! I now have a lot more lines, many parentheses and I think my imports look worse now than before.</p>
<p>The behavior I expect would be:</p>
<ol>
<li>Imports are fine as is, they are sorted and grouped (no changes)</li>
<li>Imports are split into multiple lines, but without parentheses (see isort output below)</li>
</ol>
<p>Example output of <code>isort my_file.py</code> (isort version 6.0.0):</p>
<pre><code class="language-python">from aws_cdk import NestedStack
from aws_cdk import aws_ecr as ecr
from aws_cdk import aws_ecs as ecs
from aws_cdk import aws_events as events
from aws_cdk import aws_events_targets as targets
from aws_cdk import aws_iam as iam
from aws_cdk import aws_logs as logs
</code></pre>
<p>Or with <code>isort --profile=black</code>:</p>
<pre><code class="language-python">from aws_cdk import (
    NestedStack,
)
from aws_cdk import aws_ecr as ecr
from aws_cdk import aws_ecs as ecs
from aws_cdk import aws_events as events
from aws_cdk import aws_events_targets as targets
from aws_cdk import aws_iam as iam
from aws_cdk import aws_logs as logs
</code></pre>
<p>I hope this makes sense!</p>
<h3>Version</h3>
<p>ruff 0.9.7</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-02-26 16:23</div>
            <div class="timeline-body"><p>This could be a bug.</p>
<p>It is due to the last item ending with a trailing comma (see https://docs.astral.sh/ruff/settings/#lint_isort_split-on-trailing-comma). You get the isort formatting if you remove the trailing comma.</p>
<p>Respecting the trailing comma is important for formatter compatibility (to avoid collapsing an import that the formatter expanded) but we should probably ignore it when splitting a single import into multiple statements.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2025-02-26 16:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @MichaReiser on 2025-02-26 16:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">priority:medium</span> added by @MichaReiser on 2025-02-26 16:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/17397.html">astral-sh/ruff#17397</a> on 2025-04-14 20:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-04-15 13:23</div>
            <div class="timeline-body"><p>In talking through the related #17397, we realized that the <a href="https://docs.astral.sh/ruff/settings/#lint_isort_combine-as-imports">combine-as-imports</a> option should accomplish your first expected behavior: https://play.ruff.rs/8fb07319-8044-40ba-90b7-17f7370cc7c7. Note that there are no diagnostics on the input code with <code>combine-as-imports</code> set to <code>true</code>.</p>
<p>We also discussed the possibility of changing this default value at some point. There was discussion of <a href="https://github.com/PyCQA/isort/issues/1305#issuecomment-926369825">isort</a> doing this in the next major release in 2021, but I don't see anything in its release notes, and their default for <code>combine-as-imports</code> is still <code>false</code> too.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:54 UTC
    </footer>
</body>
</html>
