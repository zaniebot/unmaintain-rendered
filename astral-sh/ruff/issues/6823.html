<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comments around attribute dot are moved around incorrectly - astral-sh/ruff #6823</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Comments around attribute dot are moved around incorrectly</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/6823">#6823</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-08-23 18:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>Given:</p>
<pre><code>aaa = (
    aaa
    # foo
    .  # bar
    # baz
    bbb
)
</code></pre>
<p>We format like:</p>
<pre><code>aaa = (
    aaa.  # bar
    # foo
    # baz
    bbb
)
</code></pre>
<p>Whereas Black retains the original formatting.</p>
<p>I believe <code># bar</code> is being marked as a trailing end-of-line comment on <code>aaa</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-23 18:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-23 19:00</div>
            <div class="timeline-body"><p>That treatment of <code># bar</code> seems intentional (see: <code>handle_attribute_comment</code>), but it seems incorrect that it&#x27;s reordered vis-a-vis <code># foo</code> (which is marked as a leading comment of <code>bbb</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-23 20:01</div>
            <div class="timeline-body"><p>Prettier&#x27;s handling seems <a href="https://prettier.io/playground/#N4Igxg9gdgLgprEAuEBDdACAvBgFAHSg2I3VUJIwHoqMAzCCCkgOmJowCNUAnZ92twBe-Lp07VaMVCKgBKEABoQEAA4wAltADOyULx4QA7gAVeCXSlQAbI6gCeu5Zx6owAazgwAyqgC2cAAyGlBwyHQ22nDOrh5e3qpuIQDmyDA8AK7RIFF+GmmZ2dop1nAAihkQ8OGR2QBW2gAe3iXlldVIEdZRygCO7XAmhqqWaNoAtKFwACYzSiDpqBrWKQDCEH5+qMho1tbzxVDJpQCCMOkanBnwJnA8waE13dkAFjB+1gDqLxrw2olgODeCy-DQAN1+9h2YG0ThAYKyAEkoLNYN4wDwNOoTijvDB7KUnj0QKpDFFPq5VDtSXAojwwWFlCE6TAhqhklsidlEjw6TtuJw4PtlKSQjBPhppjAXsgABwABmUPDg-Q0yrZHO2nVqymknAlUplSAATMoMlEACqoTiWLrEuB+QXTWbTQKoI4ZdlwABiEB4W3OKR2qGuEBAAF9w0A">reasonable</a>. Although I&#x27;m not too much of a fan of converting the own line comment to an end of line comment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-23 20:31</div>
            <div class="timeline-body"><p>Prettier&#x27;s handling also reorders the comments though, that strikes me as odd.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-23 20:32</div>
            <div class="timeline-body"><p>You might be mistaking <code>bar</code> and <code>baz</code> in that example -- I don&#x27;t think they convert between own-line and end-of-line, unless I&#x27;m misreading.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-23 21:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-08-23 21:16</div>
            <div class="timeline-body"><blockquote>
<p>You might be mistaking <code>bar</code> and <code>baz</code> in that example -- I don&#x27;t think they convert between own-line and end-of-line, unless I&#x27;m misreading.</p>
</blockquote>
<p>Ahh you&#x27;re right.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-23 21:18</div>
            <div class="timeline-body"><p>We&#x27;re too deep on comments. It&#x27;s not healthy.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-25 03:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Formatter: Alpha&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-02 08:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:41 UTC
    </footer>
</body>
</html>
