<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add logging level to see which rule(s) changed particular source line(s) - astral-sh/ruff #10286</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add logging level to see which rule(s) changed particular source line(s)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10286">#10286</a>
        opened by <a href="https://github.com/ssteinerx">@ssteinerx</a>
        on 2024-03-08 02:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ssteinerx">@ssteinerx</a></div>
            <div class="timeline-body"><p><strong>The current Ruff version (<code>ruff --version</code>).</strong></p>
<pre><code>$ ruff --version
ruff 0.3.1
</code></pre>
<p><strong>The command you invoked (e.g., <code>ruff /path/to/file.py --fix</code>), ideally including the <code>--isolated</code> flag.</strong></p>
<pre><code>$ ruff format --isolated --verbose module/__init__.py
</code></pre>
<p>When integrating code into a project, sometimes there are meaningless differences in formatting that trigger a huge number of file changes by our pre-commit ruff hook.</p>
<p>Right now, it&#x27;s hard to know exactly which rules need to be modified to keep this from happening.  We don&#x27;t want to just wholesale skip the pre-commit rules or try to figure out how to make an exception for certain code; just a temporary tweak to get the code integrated without having to deal with a zillion trivial, semantically meaningless changes.</p>
<p>Unfortunately, there doesn&#x27;t seem to be a way to get ruff to explicitly log which rule prompted which formatting change.</p>
<p>The proposition is to add a logging option to show which formatting rules triggered which changes.</p>
<p>Here&#x27;s the specific scenario.</p>
<p>This:</p>
<pre><code>class OMG_SomethingBadHasHappened(Exception):
    ...
</code></pre>
<p>becomes:</p>
<pre><code>class class OMG_SomethingBadHasHappened(Exception): ...
</code></pre>
<p>We don&#x27;t want it to do that particular piece of formatting any more.</p>
<p>So I&#x27;ll just go configure <em>The Rule</em> that made it do that.</p>
<p>Uh, which one?  I <em><strong>Haven&#x27;t The Slightest Clue.</strong></em></p>
<p>Just for laughs, I asked an AI (which shall remain nameless) about how to track the specific rule causing specific changes and its suggestion was to:</p>
<blockquote>
<p>Start by disabling rules one at a time in the Ruff configuration file...to see if the unwanted formatting change persists. This process can be somewhat tedious but effective for pinpointing the exact rule.</p>
</blockquote>
<p>And if that doesn&#x27;t demonstrate a human-like &quot;gift for understatement,&quot; I guess I don&#x27;t know what does...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-08 07:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-08 07:49</div>
            <div class="timeline-body"><p>Hi @ssteinerx, Thank you for the detailed write-up. This is very helpful!</p>
<p>The <code>format</code> command is separate from the <code>linter</code> and enabling or disabling lint rules does not change the formatter&#x27;s behavior. The formatter has <a href="https://docs.astral.sh/ruff/settings/#format">a few settings</a> that you can set to change how it formats your code but they&#x27;re <a href="https://docs.astral.sh/ruff/formatter/#philosophy">intentionally limited</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssteinerx">@ssteinerx</a> on 2024-03-09 00:33</div>
            <div class="timeline-body"><p>The document you linked does indicate that <em>options</em> are limited, but as far as I could see, didn&#x27;t address the issue of logging the reasons for code changes it does make.</p>
<p>Configuration options are great -- it&#x27;s one of the reasons I won&#x27;t use Black; I disagree with some of the choices it makes and those choices make my work harder.  It&#x27;s hard enough, thanks.</p>
<p>That said, configuration isn&#x27;t really configurable if you can&#x27;t figure out which configuration option would configure the thing you want configured.  (say that <em>one</em> time fast...)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-09 00:58</div>
            <div class="timeline-body"><p>The formatter can&#x27;t feasibly share <em>why</em> lines would change — it&#x27;s just not how it&#x27;s designed. I don&#x27;t know of any code formatters that do this.</p>
<p>I would recommend just reading our configuration options for the formatter: https://docs.astral.sh/ruff/settings/#format</p>
<p>There are not many settings and each one has a concrete example of what it changes. There are likely not settings for the changes you want.</p>
<p>You may want to just use some of the format-related lint rules instead of the formatter itself — it sounds like it does not match your use-case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-11 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-11 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssteinerx">@ssteinerx</a> on 2024-03-14 03:50</div>
            <div class="timeline-body"><blockquote>
<p>I don&#x27;t know of any code formatters that do this.</p>
</blockquote>
<p>I don&#x27;t either, which I didn&#x27;t even realize until you said it.  Sure would be handy for when one formatting choice is creating a giant diff and you&#x27;d just like to disable that one rule to get everything started.</p>
<p>I realize the formatter has way fewer options, I guess I&#x27;ll just hunt it down.</p>
<p>Thanks!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:51 UTC
    </footer>
</body>
</html>
