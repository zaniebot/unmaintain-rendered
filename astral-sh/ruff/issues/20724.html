<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FURB188 fix should be marked unsafe except with known `str`s - astral-sh/ruff #20724</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>FURB188 fix should be marked unsafe except with known <code>str</code>s</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/20724">#20724</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-10-06 16:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dscorbett">@dscorbett</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>The fix for <a href="https://docs.astral.sh/ruff/rules/slice-to-remove-prefix-or-suffix/"><code>slice-to-remove-prefix-or-suffix</code> (FURB188)</a> should be marked unsafe unless it is statically known that the full string and its affix are both <code>str</code>s. If it is statically known that they are instances of unrelated classes, the rule should be suppressed. Otherwise, the fix can change the programâ€™s behavior. They have to be exactly <code>str</code> for the fix to be safe, not subclasses of <code>str</code>. <a href="https://play.ruff.rs/e827d415-18c2-424a-86e4-a49c3c731b10">Example</a>:</p>
<pre><code class="language-console">$ cat &gt;furb188.py &lt;&lt;'# EOF'
class Seq:
    def __init__(self, inner):
        self.inner = inner
    def startswith(self, prefix):
        return tuple(self.inner[:len(prefix)]) == tuple(prefix)
    def __getitem__(self, item):
        return type(self)(self.inner[item])
seq = Seq((&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;))
try:
    if seq.startswith(&quot;123&quot;):
        seq = seq[3:]
    print(seq.inner)
except AttributeError as e:
    print(e)

text = &quot;12345&quot;
prefix = (&quot;123&quot;,)
try:
    if text.startswith(prefix):
        text = text[len(prefix):]
    print(text)
except TypeError as e:
    print(e)
# EOF

$ python furb188.py
('4', '5')
2345

$ ruff --isolated check furb188.py --select FURB188 --fix
Found 2 errors (2 fixed, 0 remaining).

$ python furb188.py
'Seq' object has no attribute 'removeprefix'
removeprefix() argument must be str, not tuple
</code></pre>
<h3>Version</h3>
<p>ruff 0.13.3 (188c0dce2 2025-10-02)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @ntBre on 2025-10-06 18:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:53:25 UTC
    </footer>
</body>
</html>
