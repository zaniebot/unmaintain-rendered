<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature request: Expand nested unpacking and unpacking of single inline element - astral-sh/ruff #10592</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature request: Expand nested unpacking and unpacking of single inline element</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10592">#10592</a>
        opened by <a href="https://github.com/Avasam">@Avasam</a>
        on 2024-03-26 03:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Avasam">@Avasam</a> on 2024-03-26 03:00</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>After running RUF005 in https://github.com/mhammond/pywin32/pull/2230 , I was left with some nested unpacking
<img src="https://github.com/astral-sh/ruff/assets/1350584/b8d98537-e759-4105-aaa5-ed0f7a72eb31" alt="image" /></p>
<p>I feel like the following case should be detectable and flagged:</p>
<pre><code class="language-python"># from
foo(*{bar})
foo(*[bar])
foo(*(bar,))
foo(*[bar, *bar2])
foo(*(bar, *bar2))
foo(*[*bar2, bar])
foo(*(*bar2, bar))

# to
foo(bar)  # Not a safe fix from *{bar}
foo(bar)
foo(bar)
foo(bar, *bar2)
foo(bar, *bar2)
foo(*bar2, bar)
foo(*bar2, bar)
</code></pre>
<p>(same with assignments and possibly more cases I haven't thought of)</p>
<p>Edit: Removed sets since https://github.com/astral-sh/ruff/issues/10592#issuecomment-2785004944</p>
<blockquote>
<p>Elements may be deduplicated and sets are unordered</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-03-26 07:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-04-08 01:19</div>
            <div class="timeline-body"><p>Kinda looks like https://docs.astral.sh/ruff/rules/unnecessary-spread/, but for single-star unpacking <code>*</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-04-08 01:31</div>
            <div class="timeline-body"><p>The cases with sets should not be flagged, for two reasons: Elements may be deduplicated and sets are unordered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-04-08 01:33</div>
            <div class="timeline-body"><blockquote>
<p>The cases with sets should not be flagged, for two reasons: Elements may be deduplicated and sets are unordered.</p>
</blockquote>
<p>Good point.
A single-item literal set still works.</p>
<p>A multi-item set couldn't be autofixed (but still flagged! It's probably a code-smell anyway).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-04-08 01:49</div>
            <div class="timeline-body"><p>Even single-item sets cannot be fixed, as the element might be unhashable (in which case the error would be masked).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:33:18 UTC
    </footer>
</body>
</html>
