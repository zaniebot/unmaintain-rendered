<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>It would be nice if using `--respect-gitignore` outside of a git repo spat out an error - astral-sh/ruff #12644</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>It would be nice if using `--respect-gitignore` outside of a git repo spat out an error</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12644">#12644</a>
        opened by <a href="https://github.com/jfly">@jfly</a>
        on 2024-08-02 19:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jfly">@jfly</a> on 2024-08-02 19:49</div>
            <div class="timeline-body"><p>keywords: respect-gitignore</p>
<p>In https://github.com/astral-sh/ruff/issues/5930, ruff tried to start respecting <code>.gitignore</code> files even when outside of a git repo. Unfortunately, we <a href="https://github.com/astral-sh/ruff/issues/5930#issuecomment-1666588790">had to revert that</a>.</p>
<p>I'm not asking to reconsider that revert: I understand that it had to happen. However, I do think it would be useful if <code>--respect-gitignore</code> would error out when run outside of a git repo. I personally find the current behavior quite confusing, and lost some time today trying to understand why ruff was disrespecting my <code>.gitignore</code> even though I asked it to respect it!</p>
<p>I'd be happy to send in a PR implementing this if you're open to it.</p>
<p>Thanks for the great tool!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @charliermarsh on 2024-08-02 21:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> removed by @charliermarsh on 2024-08-02 21:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @charliermarsh on 2024-08-02 21:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-02 21:50</div>
            <div class="timeline-body"><p>Seems reasonable... Might be hard to know when we should raise this exactly. E.g., is it only when it's provided on the command-line? What if it comes from a configuration file? (I think <code>true</code> is also the default so need to differentiate between &quot;provided&quot; and &quot;not provided&quot;.)</p>
<p>A warning could also be reasonable here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-08-03 07:11</div>
            <div class="timeline-body"><p>I think there's some more complication because <code>respect_gitignore</code> should rather be named <code>respect_ignore</code> because it doesn't just toggle <code>.gitignore</code>, it also toggles whether ruff respects <code>.ignore</code>, git ignore in parent directories, git global, git exclude, and ignores hidden files.</p>
<p>https://github.com/astral-sh/ruff/blob/ebe5b06c95cc958d460d7cfc520e540017d9492f/crates/ruff_server/src/session/index/ruff_settings.rs#L135-L137</p>
<p><a href="https://docs.rs/ignore/latest/ignore/struct.WalkBuilder.html#method.standard_filters">standard_filters</a></p>
<p>To me it's also unclear when such a warning would be shown? Is it when ruff doesn't find <strong>any</strong> gitignore or only if there is no gitignore in the root directory? Limiting it to the former seems overly restrictive but the latter has the downside that ruff always has to walk the tree eagerly even when only linting a subset of the files.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:13 UTC
    </footer>
</body>
</html>
