<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sometimes --fix doesn't work (unused imports) - astral-sh/ruff #475</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Sometimes --fix doesn't work (unused imports)</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/475">#475</a>
        opened by <a href="https://github.com/fsouza">@fsouza</a>
        on 2022-10-26 16:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/fsouza">@fsouza</a> on 2022-10-26 16:49</div>
            <div class="timeline-body"><p>I haven't been able to dig into this yet, but sometimes <code>--fix</code> doesn't remove unused imports (but it does claim to have fixed the issue). Reproducing with the autoflake repo:</p>
<pre><code>$ git clone https://github.com/pycqa/autoflake.git /tmp/autoflake
$ cd /tmp/autoflake
$ patch -p1 &lt;&lt;EOF
\ diff --git a/autoflake.py b/autoflake.py
index 2b7b917..12a9f4f 100755
--- a/autoflake.py
+++ b/autoflake.py
@@ -38,6 +38,7 @@ import tokenize
 import pyflakes.api
 import pyflakes.messages
 import pyflakes.reporter
+from pyflakes.checker import Annotation


 __version__ = &quot;1.7.7&quot;
EOF
$ ruff autoflake.py
Found 1 error(s).
autoflake.py:41:1: F401 `pyflakes.checker.Annotation` imported but unused
1 potentially fixable with the --fix option.
％ ruff --fix autoflake.py
Found 0 error(s) (1 fixed).
％ ruff autoflake.py
Found 1 error(s).
autoflake.py:41:1: F401 `pyflakes.checker.Annotation` imported but unused
1 potentially fixable with the --fix option.
</code></pre>
<p>Note how it claims to have fixed the error (&quot;Found 0 error(s) (1 fixed).&quot;), but it didn't.</p>
<p>I can dig into it before the end of the week, but reporting just in case someone beats me to it :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-10-26 16:54</div>
            <div class="timeline-body"><p>Awesome, thanks for reporting!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2022-10-26 20:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-10-26 20:09</div>
            <div class="timeline-body"><p>Reproduced, I see the issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/479.html">astral-sh/ruff#479</a> on 2022-10-26 20:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-10-26 20:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:06 UTC
    </footer>
</body>
</html>
