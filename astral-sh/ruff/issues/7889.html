<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider respecting `avoid-escape` when enforcing other `flake8-quotes` rules - astral-sh/ruff #7889</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider respecting <code>avoid-escape</code> when enforcing other <code>flake8-quotes</code> rules</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7889">#7889</a>
        opened by <a href="https://github.com/BT-rmartin">@BT-rmartin</a>
        on 2023-10-10 09:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BT-rmartin">@BT-rmartin</a></div>
            <div class="timeline-body"><p>My Ruff version is 0.0.292
My configuration of Ruff is</p>
<pre><code>[tool.ruff]
select = [&quot;E&quot;, &quot;F&quot;, &quot;I&quot;, &quot;PL&quot;, &quot;B&quot;, &quot;Q&quot;, &quot;D&quot;, &quot;N&quot;, &quot;S&quot;, &quot;G&quot;, &quot;RUF&quot;, &quot;W&quot;]
ignore = [&quot;D100&quot;, &quot;D101&quot;, &quot;D104&quot;, &quot;D213&quot;, &quot;D203&quot;, &quot;RUF012&quot;]
exclude = [&quot;**/ext/&quot;]

line-length = 115

[tool.ruff.per-file-ignores]
&quot;__init__.py&quot; = [&quot;F401&quot;]
&quot;__manifest__.py&quot; = [&quot;B018&quot;]
&quot;**/tests/*.py&quot; = [&quot;S101&quot;]

[tool.ruff.flake8-quotes]
docstring-quotes = &quot;double&quot;
inline-quotes = &quot;single&quot;
multiline-quotes = &quot;double&quot;
avoid-escape = false
</code></pre>
<p>I had a file like this</p>
<pre><code>{
    &quot;name&quot;: &quot;My module&quot;,
    &quot;version&quot;: &quot;16.0.1.0.0&quot;,
    &quot;summary&quot;: &quot;Strips newline from text&#x27;s fields&quot;,
    &quot;category&quot;: &quot;Accounting&quot;,
    &quot;installable&quot;: True,
}
</code></pre>
<p>When running <em>ruff . --fix</em>, it produces a file like this, which is mixing up single quote and double quote in the summary key due to the apostrophe it had there</p>
<pre><code>{
    &#x27;name&#x27;: &#x27;My module&#x27;,
    &#x27;version&#x27;: &#x27;16.0.1.0.0&#x27;,
    &#x27;summary&#x27;: &quot;Strips newline from text&#x27;s fields&quot;,
    &#x27;category&#x27;: &#x27;Accounting&#x27;,
    &#x27;installable&#x27;: True,
}
</code></pre>
<p>I would expect that it&#x27;s able to escape the apostrophe as I have avoid-escape = false.
Could you please tell me what is wrong here?</p>
<p>Anothe working option for me would be to ignore the flake8-quotes for specific files. Is that possible?</p>
<p>Thanks in advance</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-10 15:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-10 15:54</div>
            <div class="timeline-body"><p>I think this is a bug because we aren&#x27;t respecting <code>avoid-escape = false</code> in all of the Q rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BT-rmartin">@BT-rmartin</a> on 2023-10-11 10:50</div>
            <div class="timeline-body"><p>@charliermarsh Thanks for the quick answer.
When do you estimate this might be fixed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-11 13:45</div>
            <div class="timeline-body"><p>I would guess in the next week or two?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-10-12 04:57</div>
            <div class="timeline-body"><blockquote>
<p>I think this is a bug because we aren&#x27;t respecting <code>avoid-escape = false</code> in all of the Q rules.</p>
</blockquote>
<p>That&#x27;s true although <code>flake8-quotes</code> has the same behavior:</p>
<pre><code>flake8 t.py --no-avoid-escape  
</code></pre>
<p>Maybe related <a href="https://github.com/astral-sh/ruff/issues/2400">astral-sh/ruff#2400</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Bug with tool.ruff.flake8-quotes configuration&quot; to &quot;Consider respecting `avoid-escape` when enforcing other `flake8-quotes` rules&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-14 18:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BT-rmartin">@BT-rmartin</a> on 2023-10-26 23:20</div>
            <div class="timeline-body"><p>@charliermarsh Any progress on this topic?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-11-01 06:21</div>
            <div class="timeline-body"><p>I&#x27;m sorry there hasn&#x27;t been any progress here but we might want to hold off until <a href="https://github.com/astral-sh/ruff/pull/7927">astral-sh/ruff#7927</a> is finalized and merged as that could simplify the implementation of <code>flake8-quotes</code> rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BT-rmartin">@BT-rmartin</a> on 2023-11-02 22:59</div>
            <div class="timeline-body"><p>Ok thanks @dhruvmanila. When do you estimate this could be done?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BT-rmartin">@BT-rmartin</a> on 2023-11-19 17:54</div>
            <div class="timeline-body"><p>hi @dhruvmanila, @charliermarsh When do you estimate this might be fixed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-11-19 18:24</div>
            <div class="timeline-body"><p>@BT-rmartin please do not bump issues repeatedly. #7927 is still in-progress. Updates will be posted here when progress is made on this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BT-rmartin">@BT-rmartin</a> on 2024-10-23 20:14</div>
            <div class="timeline-body"><p>hi @dhruvmanila, @charliermarsh @zanieb Any news on this 1 year later?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:43 UTC
    </footer>
</body>
</html>
