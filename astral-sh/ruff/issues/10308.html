<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider implicitly concatenated f-string for rules - astral-sh/ruff #10308</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider implicitly concatenated f-string for rules</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/10308">#10308</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-03-09 10:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body"><p>Certain rules which look at f-strings, especially implicitly concatenated ones, performs the check for an individual string element and not the concatenated one. Taking https://docs.astral.sh/ruff/rules/hardcoded-bind-all-interfaces/ as an example,</p>
<pre><code class="language-python"># We don't highlight this but we used to before the implicit string concatenation refactor
'0.0.' f'0.0{expr}'

# We highlight the ones marked by `^`
'0.0.0.0' f'0.0.0.0{expr}0.0.0.0'
#           ^^^^^^^      ^^^^^^^
</code></pre>
<p>This is different for strings which are implicitly concatenated. For example,</p>
<pre><code>src/S.py:2:1: S104 Possible binding to all interfaces
  |
1 | '0.0.0.0' f'0.0.0.0{expr}0.0.0.0'
2 | '0.0.' '0.0'
  | ^^^^^^^^^^^^ S104
  |
</code></pre>
<p>The reason we used to highlight the first example before the string refactor is that we would normalize the implicitly concatenated f-strings. So, the above example would become <code>f&quot;0.0.0.0{expr}&quot;</code>.</p>
<p>We should add some logic to get the concatenated strings for an implicitly concatenated f-string.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @dhruvmanila on 2024-03-09 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">linter</span> added by @zanieb on 2024-03-11 16:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:49 UTC
    </footer>
</body>
</html>
