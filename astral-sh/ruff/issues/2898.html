<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RET507: Same false positive as flake8-return in case of `elif` + `continue` + `else` - astral-sh/ruff #2898</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>RET507: Same false positive as flake8-return in case of <code>elif</code> + <code>continue</code> + <code>else</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2898">#2898</a>
        opened by <a href="https://github.com/aberres">@aberres</a>
        on 2023-02-14 18:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/aberres">@aberres</a></div>
            <div class="timeline-body"><p>The original issue can be found here: <a href="https://github.com/afonasev/flake8-return/issues/127">afonasev/flake8-return#127</a></p>
<p>This one is a shameless copy.</p>
Description
<p>Invalid error reported for <strong>R507</strong> if an <code>elif</code> with <code>continue</code> is followed by an <code>else</code>. The <code>else</code> must not be removed in this case.</p>
What I Did
<p>We have some <code>if...elif...</code> clause like this:</p>
<pre><code>def main():
    for a in range(10):                     # | 0 div 4
        if a % 4 == 0:                      # | 1 div nothing
            print(a, &#x27;div&#x27;, 4)              # | 2 div 2
        elif a % 3 == 0:                    # | 3 div 3
            print(a, &#x27;div&#x27;, 3)              # | 4 div 4
            continue                        # | 5 div nothing
        elif a % 2 == 0:                    # | 6 div 3
            print(a, &#x27;div&#x27;, 2)              # | 7 div nothing
        else:                               # | 8 div 4
            print(a, &#x27;div&#x27;, &#x27;nothing&#x27;)      # | 9 div 3
    return 0



if __name__ == &#x27;__main__&#x27;:
    main()
</code></pre>
<p>For this case we are getting this error:</p>
<pre><code>myfile.py:5:9:  RET507 Unnecessary `elif` after `continue` statement
</code></pre>
<p>If we follow the suggestion and fix the issue, then we have different output:</p>
<pre><code>def main():                                 # | 0 div 4
    for a in range(10):                     # | 0 div 2
        if a % 4 == 0:                      # | 1 div nothing
            print(a, &#x27;div&#x27;, 4)              # | 2 div 2
        elif a % 3 == 0:                    # | 3 div 3
            print(a, &#x27;div&#x27;, 3)              # | 4 div 4
            continue                        # | 4 div 2
        if a % 2 == 0:                      # | 5 div nothing
            print(a, &#x27;div&#x27;, 2)              # | 6 div 3
        else:                               # | 7 div nothing
            print(a, &#x27;div&#x27;, &#x27;nothing&#x27;)      # | 8 div 4
    return 0                                # | 8 div 2
                                            # | 9 div 3

if __name__ == &#x27;__main__&#x27;:
    main()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-14 18:41</div>
            <div class="timeline-body"><p>I actually think I may have just fixed this yesterday via #2881. I&#x27;ll test to confirm.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-14 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aberres">@aberres</a> on 2023-02-14 19:20</div>
            <div class="timeline-body"><p>You are too fast for me :) I did not check closed issues as I did not expect much to be changed since yesterday&#x27;s release.</p>
<p>Keep on rocking!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-14 20:36</div>
            <div class="timeline-body"><p>Thanks :)</p>
<p>Confirmed that this doesn&#x27;t trigger on <code>main</code>! New release will go out today or tomorrow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-02-14 20:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:32 UTC
    </footer>
</body>
</html>
