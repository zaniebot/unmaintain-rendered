<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Group unused range suppression codes into single diagnostic - astral-sh/ruff #21873</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Group unused range suppression codes into single diagnostic</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/21873">#21873</a>
        opened by <a href="https://github.com/amyreese">@amyreese</a>
        on 2025-12-09 20:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-09 20:22</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>If a range suppression has more than one unused code, ruff will produce a separate diagnostic for each unused code, rather than grouping them into a single diagnostic like will happen for unused noqa:</p>
<pre><code>$ cat ~/scratch/ruff/foo.py
# ruff: disable[F401, F501]
print(&quot;hello&quot;)  # noqa: F401 F501
</code></pre>
<pre><code>$ cargo run -p ruff -- check --no-cache --isolated --preview --select F,RUF100 ~/scratch/ruff/foo.py
RUF100 [*] Unused suppression (unused: `F401`)
 --&gt; /Users/amethyst/scratch/ruff/foo.py:1:17
  |
1 | # ruff: disable[F401, F501]
  |                 ^^^^
2 | print(&quot;hello&quot;)  # noqa: F401 F501
  |
help: Remove unused suppression
  - # ruff: disable[F401, F501]
1 + # ruff: disable[F501]
2 | print(&quot;hello&quot;)  # noqa: F401 F501
3 |

RUF100 [*] Unused suppression (unused: `F501`)
 --&gt; /Users/amethyst/scratch/ruff/foo.py:1:23
  |
1 | # ruff: disable[F401, F501]
  |                       ^^^^
2 | print(&quot;hello&quot;)  # noqa: F401 F501
  |
help: Remove unused suppression
  - # ruff: disable[F401, F501]
1 + # ruff: disable[F401]
2 | print(&quot;hello&quot;)  # noqa: F401 F501
3 |

RUF100 [*] Unused `noqa` directive (unused: `F401`, `F501`)
 --&gt; /Users/amethyst/scratch/ruff/foo.py:2:17
  |
1 | # ruff: disable[F401, F501]
2 | print(&quot;hello&quot;)  # noqa: F401 F501
  |                 ^^^^^^^^^^^^^^^^^
  |
help: Remove unused `noqa` directive
1 | # ruff: disable[F401, F501]
  - print(&quot;hello&quot;)  # noqa: F401 F501
2 + print(&quot;hello&quot;)
3 |

Found 3 errors.
[*] 3 fixable with the `--fix` option.
&gt; [1]
</code></pre>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @amyreese by @amyreese on 2025-12-09 20:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @amyreese on 2025-12-09 20:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @amyreese on 2025-12-09 20:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">suppression</span> added by @amyreese on 2025-12-09 20:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-12-09 20:34</div>
            <div class="timeline-body"><p>Consider how ty does this: https://github.com/astral-sh/ruff/blob/adf468beb53bfc0a06698d4e4f265a02545f37a1/crates/ty_python_semantic/src/suppression.rs#L260-L289</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:56 UTC
    </footer>
</body>
</html>
