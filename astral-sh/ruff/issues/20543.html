<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&quot;Expected indented block&quot; is propagated to the next cell - astral-sh/ruff #20543</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>&quot;Expected indented block&quot; is propagated to the next cell</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/20543">#20543</a>
        opened by <a href="https://github.com/turbotimon">@turbotimon</a>
        on 2025-09-23 17:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/turbotimon">@turbotimon</a> on 2025-09-23 17:50</div>
            <div class="timeline-body"><p>The &quot;Expected indented block&quot; error is propagated to the next cell. Since cells contain completed parts of code, this error should not propagate:</p>
<p><img width="924" height="500" alt="Image" src="https://github.com/user-attachments/assets/927eeaec-2285-46f0-b23f-6d03fac8082f" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">notebook</span> added by @MichaReiser on 2025-09-24 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-24 08:10</div>
            <div class="timeline-body"><p>Hmm. This might be tricky to fix because we parse the entire notebook as one concatenated string.</p>
<p>It might parse each cell separately and patch up the offsets (or add a parsing mode that starts with a relative offset).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2025-09-24 08:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/turbotimon">@turbotimon</a> on 2025-10-22 07:06</div>
            <div class="timeline-body"><p>@MichaReiser That would be a nice fix though and helpful for the user, as the error message is shown at the cell where the error happened.</p>
<p>Maybe there could be a marker (e.g. newline) in the string and certain checks stop at that marker?  But perhaps that is a naive idea, as I don't know any details about the current implementation.</p>
<p>If scope spans over cells, it leads to other wrong error message like this where the next cell is considered still part of the function:</p>
<p><img width="841" height="358" alt="Image" src="https://github.com/user-attachments/assets/19ed7a18-b9b5-475a-b6c4-a7854a9d16bd" /></p>
<p>Just for reference, <strong>Pylance</strong> does it correct and reports two separate issues:</p>
<p><img width="743" height="246" alt="Image" src="https://github.com/user-attachments/assets/256a2d1c-317a-41f3-b283-cca37d80ea94" /></p>
<p><img width="571" height="205" alt="Image" src="https://github.com/user-attachments/assets/2922cdc0-a9aa-418a-aa9c-6e573f7fef33" /></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:38:25 UTC
    </footer>
</body>
</html>
