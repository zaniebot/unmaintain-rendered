<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simplify `key in dct and dct[key]` to `dct.get(key)` - astral-sh/ruff #5933</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Simplify <code>key in dct and dct[key]</code> to <code>dct.get(key)</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5933">#5933</a>
        opened by <a href="https://github.com/janosh">@janosh</a>
        on 2023-07-20 22:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/janosh">@janosh</a> on 2023-07-20 22:24</div>
            <div class="timeline-body"><pre><code class="language-py"># bad
if &quot;key&quot; in dct and dct[&quot;key&quot;]:
    ...

# good
if dct.get(&quot;key&quot;):
    ...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/agnes-sharan">@agnes-sharan</a> on 2023-07-21 00:45</div>
            <div class="timeline-body"><p>Hi could I work on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2023-07-21 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-21 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-21 04:13</div>
            <div class="timeline-body"><p>Hi @agnes-sharan -- thanks for asking! We need to make a decision as maintainers on whether to include this (and how it should be categorized) before opening it up for contributors. We'll label it as such and comment here when there's consensus.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-07-21 08:17</div>
            <div class="timeline-body"><p>Examples in the wild: https://grep.app/search?q=%20%22%28.%2B%29%22%20in%20%5Ba-z0-9%5D%2B%20and%20%5Ba-z0-9%5D%2B%5C%5B%22%28.%2B%29%22%5C%5D%3A&amp;regexp=true</p>
<p>It would make sense to propose this rule in <a href="https://github.com/MartinThoma/flake8-simplify"><code>flake8-simplify</code></a>. They already have a couple of dict-related rules, and then port it to <code>ruff</code> (if they are responsive).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Simplify `key in dict` check before access to `dict.get`" to "Simplify `key in dct and dct[key]` to `dct.get(key)`" by @janosh on 2023-07-21 14:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/janosh">@janosh</a> on 2023-07-21 14:35</div>
            <div class="timeline-body"><p><a href="https://grep.app/search?q=%22%28.%2B%29%22%20in%20.%2B%20and%20.%2B%5C%5B%22%28.%2B%29%22%5C%5D&amp;regexp=true">The regex can be made more generic to increase the number of hits</a>. The site doesn't seem to support backreferences <code>(.+) in .+ and .+\[\1\]</code> so might be some false positives in there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-07-23 07:49</div>
            <div class="timeline-body"><p>Refurb might be a candidate to include this rule into: https://github.com/dosisod/refurb</p>
<p>In the cases that <code>dct</code> is a common dict, this syntax is clearly more readable (just one ref to <code>dct</code> and <code>key</code>)</p>
<p>Alternatively, this could be a RUF category rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @charliermarsh on 2023-09-21 00:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @charliermarsh on 2023-09-21 00:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-21 00:56</div>
            <div class="timeline-body"><p>We can add this as a <code>ruff</code> rule if there's interest.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-10-10 12:01</div>
            <div class="timeline-body"><p>@charliermarsh can I work on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-10 12:03</div>
            <div class="timeline-body"><p>Go for it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/harupy">@harupy</a> on 2023-10-10 12:03</div>
            <div class="timeline-body"><p>How would you name this rule?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-10 12:03</div>
            <div class="timeline-body"><p>We may need to limit this to boolean tests, since it returns <code>None</code> rather than <code>False</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-10 12:12</div>
            <div class="timeline-body"><p>I'm not sure, maybe like <code>UnnecessaryDictIn</code>? Easy to rename during review though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-10-13 01:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:30:45 UTC
    </footer>
</body>
</html>
