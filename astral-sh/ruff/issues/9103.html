<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Import detection and resolution via Python resolver for pylint - astral-sh/ruff #9103</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Import detection and resolution via Python resolver for pylint</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9103">#9103</a>
        opened by <a href="https://github.com/pwithams">@pwithams</a>
        on 2023-12-12 06:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/pwithams">@pwithams</a></div>
            <div class="timeline-body"><p>I'm interested in implementing <code>no-name-in-module</code> (E0611) and <code>import-error</code> (E0401) for pylint (https://github.com/astral-sh/ruff/issues/970).</p>
<p>I think this would handle this issue https://github.com/astral-sh/ruff/issues/6327 but as mentioned in that issue thread it might get a little complex with things like virtual environments.</p>
<p>I've taken a brief look at the resolver but wondering if there has been any other work into this issue before continuing. A couple of my thoughts:</p>
<ul>
<li>I believe pylint essentially runs the code and catches the exceptions <code>ImportError</code> and <code>ModuleNotFoundError</code>, although it will return all errors, not just the first, with a line like <code>import os.foobar</code> triggering both errors</li>
<li>ruff appears to be so fast currently due to avoiding (or at least minimizing) invoking any python</li>
<li>is there any way to achieve this functionality without actually calling python, such as somehow determining a list of available modules (for <code>import-error</code> at least)? Could this ever be fully trustworthy? I'm guessing not.</li>
<li>if python does have to be called (can't really see a way to avoid it for <code>no-name-in-module</code>, especially when it comes to things like c libraries), are there ways to optimize/minimize python usage/runtime?</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-10 20:02</div>
            <div class="timeline-body"><p>Have you taken a look at the resolver we aded in <a href="https://github.com/astral-sh/ruff/tree/main/crates/ruff_python_resolver"><code>ruff_python_resolver</code></a>? It's based off Pyright's implementation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-01-10 20:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/walsha2">@walsha2</a> on 2024-04-03 00:15</div>
            <div class="timeline-body"><p>@charliermarsh is the <a href="https://github.com/astral-sh/ruff/tree/main/crates/ruff_python_resolver"><code>ruff_python_resolver</code></a> intended to be a solution to <code>E0611</code>? I cant seem to find any documentation on what it is currently being used for.</p>
<p>Sure would be nice to get <code>E0611</code> and <code>E0401</code> implemented. I just ran into an edge case where these would have caught a file with some bad imports (as <code>pylint</code> would have), but it was not invoked in any tests so it never got caught - until a user runtime error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> added by @MichaReiser on 2024-09-09 12:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2024-09-09 12:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vinitkumar">@vinitkumar</a> on 2024-09-09 17:40</div>
            <div class="timeline-body"><p>@charliermarsh In my opinion it should be implemented as well. We just missed a bug due to faulty import and ruff didn't catch the issue. Would be great to have a compatible implementation in our setup as ruff is our primary linter here.</p>
<p>https://github.com/django-cms/django-cms/issues/7992
We have this new issue because we added this faulty imported while backporting a feature, and this module is not in the 3.11 version of the project. Ruff passed the lint with flying colours where it should have pointed it out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vinitkumar">@vinitkumar</a> on 2024-09-23 10:07</div>
            <div class="timeline-body"><p>@MichaReiser Can this be prioritised, please?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @MichaReiser on 2024-10-24 14:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> removed by @MichaReiser on 2024-10-24 14:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pespinel">@pespinel</a> on 2025-03-11 11:14</div>
            <div class="timeline-body"><blockquote>
<p><a href="https://github.com/charliermarsh">@charliermarsh</a> In my opinion it should be implemented as well. We just missed a bug due to faulty import and ruff didn't catch the issue. Would be great to have a compatible implementation in our setup as ruff is our primary linter here.</p>
<p><a href="https://github.com/django-cms/django-cms/issues/7992">django-cms/django-cms#7992</a> We have this new issue because we added this faulty imported while backporting a feature, and this module is not in the 3.11 version of the project. Ruff passed the lint with flying colours where it should have pointed it out.</p>
</blockquote>
<p>We've just had the same issue: a faulty import that wasn't caught by Ruff. Any news on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/boringplay">@boringplay</a> on 2025-04-30 03:54</div>
            <div class="timeline-body"><p>Any news on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vinitkumar">@vinitkumar</a> on 2025-06-06 12:41</div>
            <div class="timeline-body"><p>@charliermarsh It would be great if this one gets picked up.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-06 13:21</div>
            <div class="timeline-body"><p>ty, our in-progress type checker can detect invalid imports for you. We may decide to bring this to Ruff but it isn't on our immediate roadmap</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vinitkumar">@vinitkumar</a> on 2025-06-06 13:24</div>
            <div class="timeline-body"><blockquote>
<p>ty, our in-progress type checker can detect invalid imports for you. We may decide to bring this to Ruff but it isn't on our immediate roadmap</p>
</blockquote>
<p>@MichaReiser Thanks for your reply. Is <code>ty</code> any close to being used in production codebases? If it's good enough, we can use that in combination with ruff.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pwithams">@pwithams</a> on 2025-06-25 01:38</div>
            <div class="timeline-body"><blockquote>
<p>ty, our in-progress type checker can detect invalid imports for you. We may decide to bring this to Ruff but it isn't on our immediate roadmap</p>
</blockquote>
<p>I just started looking at this again. I see two main approaches:</p>
<ol>
<li>use <code>ruff_python_resolver</code> - I have a working proof of concept for this, but it has limitations. For example, I don't see a clear way to check against stdlib modules beyond their root name, and <code>resolver::resolve_import</code> doesn't seem to work with attributes imported via <code>from</code>. However, it does support basic checks like <code>import doesnotexist</code> but would not catch things like <code>import os.bad.sub.path</code> or <code>from valid_module import undefined_attribute</code>. Virtualenv path discovery would need to be added, similar to <code>ty</code>.</li>
<li>use logic from <code>ty</code> - as you mentioned it already implemented and solves the problems above. However, I'm not sure how easy it would be to integrate this logic into the linting checker, or even if that is something desirable in terms of design. I see there is some usage of <code>ty_python_semantic</code> in <code>ruff_graph</code>.</li>
</ol>
<p>Any thoughts on these approaches?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-25 06:27</div>
            <div class="timeline-body"><p>Hi @pwithams</p>
<p>Thanks for looking into this. I don't think it makes sense for us to invest into this right now, given that we have a working solution for this in ty and integrating any multi-file aspect into Ruff requires changes in our caching system and LSP server too (a file's diagnostics can now change when other files change too).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pwithams">@pwithams</a> on 2025-06-25 13:58</div>
            <div class="timeline-body"><p>That makes sense, thanks!</p>
<p>The main driver was continuing to replicate <code>pylint -E</code> behavior, which I find useful as a simple unified tool/CLI command for checking fatal errors.</p>
<p>For more formal applications chaining in something like <code>ty check --error</code> shouldn't be an issue - I'm excited to try it out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pwithams on 2025-06-25 13:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:14 UTC
    </footer>
</body>
</html>
