<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `flake8-assertive` - astral-sh/ruff #2417</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Implement `flake8-assertive`</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/2417">#2417</a>
        opened by <a href="https://github.com/ngnpope">@ngnpope</a>
        on 2023-01-31 21:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-01-31 21:16</div>
            <div class="timeline-body"><p><a href="https://github.com/jparise/flake8-assertive">GitHub</a>, <a href="https://pypi.org/project/flake8-assertive/">PyPI</a>.</p>
<ul>
<li>[ ] <code>A500</code>: prefer {func} for â€˜{op}â€™ comparisons</li>
<li>[ ] <code>A501</code>: prefer {func} for â€˜{op}â€™ expressions</li>
<li>[ ] <code>A502</code>: prefer {func} instead of comparing to {obj}</li>
<li>[ ] <code>A503</code>: use {func} instead of the deprecated {name}</li>
<li>[ ] <code>A504</code>: prefer the â€˜msg=â€™ kwarg for {func} diagnostics</li>
</ul>
<p>See the <a href="https://github.com/jparise/flake8-assertive#flake8-unittest-assertion-checker">table</a> containing all of the rewrites.</p>
<p>Most, if not all, of these would be perfect for autofixing.</p>
<p>Configuration options:</p>
<ul>
<li>[ ] <a href=""><code>assertive-snakecase</code></a>: suggest snake_case assert method names (e.g. <code>assert_true()</code>) instead of the standard names (e.g. <code>assertTrue()</code>)</li>
<li>[ ] <a href=""><code>assertive-test-pattern</code></a>: fnmatch pattern for identifying unittest test files (and all other files will be skipped)</li>
</ul>
<p>The plugin allows for converting between snake and camel case, but I wonder if it could be extended to support conversion to plain assert statements for pytest? Although that is probably handled by <code>PT009</code> / <code>unittest-assertion</code> already?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2023-01-31 23:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leiserfg">@leiserfg</a> on 2023-04-01 21:58</div>
            <div class="timeline-body"><p>@charliermarsh  is it fine if I implement the fixes for <code>PT009</code>? They are not part of the original plugin but I don't think we should add another rule for showing the same error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-02 02:15</div>
            <div class="timeline-body"><p>@leiserfg - Just trying to understand, how would these map to PT009? Aren't the above rules focused on remapping <em>within</em> unittest-style assertions, e.g., <code>assertLessEqual</code> in favor of <code>assertTrue(a &lt;= b)</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leiserfg">@leiserfg</a> on 2023-04-02 06:16</div>
            <div class="timeline-body"><p>PT009 complains about using unitest assert functions like 'assertLessEqual' as one should use plain asserts like 'assert a &lt;= b'. This goes about changing usages of  assertTrue where a better assert* can be used or optionally changing to plain asserts. That las one maps to pt009 and I'm interested on implementing that (as I'm in the middle of a tests migration to pytest).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leiserfg">@leiserfg</a> on 2023-04-02 07:21</div>
            <div class="timeline-body"><p>:facepalm:  I didn't notice that PT009 already implements most of them and just the ones that are &quot;Django only&quot; are missing so, forget my comment :face_exhaling:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-03 03:11</div>
            <div class="timeline-body"><p>@leiserfg - oh no worries! By the way: would love to help you find something to work on if youâ€™re interested in a new project, your contributions have been great :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../wagtail/wagtail/pulls/10324.html">wagtail/wagtail#10324</a> on 2023-04-12 11:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2023-07-25 06:48</div>
            <div class="timeline-body"><p>@leiserfg, if you're still looking for similar improvements to make, I would love it if <code>assertAlmostEquals</code> and <code>assertDictEqual</code> could be auto-fixed ðŸ˜ƒ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2023-07-25 07:32</div>
            <div class="timeline-body"><p>I just discovered https://pypi.org/project/pytestify/, which could be helpful for managing the conversions. (It's also helpful for me to know how to manually convert <code>assertAlmostEquals</code>!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leiserfg">@leiserfg</a> on 2023-07-25 07:43</div>
            <div class="timeline-body"><p>For what I see in their code <code>assertDictEqual</code> is not correctly implemented.
Adding them in ruff will require creating two local variables to store the values because we have to do something like:</p>
<pre><code class="language-python">#current code
self.assertDictEqual(A, B)   #A and B are expressions

#generated code

#we need to store the values in variables to avoid re-computations
a = A
b = B
assert isinstance(a, dict)
assert isinstance(b, dict)
assert a == b
</code></pre>
<p>For the assertAlmostEqual we need similar transformations because besides comparing the values we need to compare the difference between them.</p>
<p>@charliermarsh  is there any tool in ruff internals to get an unused identifier, ideally one that one can pass a list of potential names like  (pseudocode) <code>fn gimme_identifier(candidates: vec&lt;&amp;str&gt;) -&gt; String</code> ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12851.html">astral-sh/ruff#12851</a> on 2024-08-13 08:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jaap3">@jaap3</a> on 2024-10-21 14:57</div>
            <div class="timeline-body"><p>Just today I found myself asking for changes covered by flake8-assertive on a pull request (specifically <code>A504</code>, adding a <code>msg</code> to <code>assertTrue</code>/<code>assertFalse</code>). We used to have that plugin enabled, and didn't realise ruff doesn't implement it. In the mean time a bunch of violations have crept in. Would love to see at least <code>A504</code> implemented.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2024-10-22 17:21</div>
            <div class="timeline-body"><p>Thanks @jaap3, I didn't know about that plugin. Are there any others you still use in Flake8 that aren't in Ruff yet? I currently only have <code>flake8-cognitive-complexity</code> and <code>flake8-cohesion</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2024-10-22 17:27</div>
            <div class="timeline-body"><p>Also, @jaap3, <a href="https://docs.astral.sh/ruff/rules/pytest-unittest-assertion/"><code>PT009</code></a> seems to do what you're looking for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jaap3">@jaap3</a> on 2024-10-23 07:15</div>
            <div class="timeline-body"><p>@tylerlaprade We use the stdlib unittest library and runner (well, Django's wrappers) so I've not enabled these pytest rules. I don't think they are fully equivalent since we do want to use the <code>assert*</code> methods provided by <code>unittest</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../Azure/azure-cli/pulls/30406.html">Azure/azure-cli#30406</a> on 2024-12-14 09:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../leukeleu/django-hidp/pulls/279.html">leukeleu/django-hidp#279</a> on 2025-01-30 09:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:08 UTC
    </footer>
</body>
</html>
