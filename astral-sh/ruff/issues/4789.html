<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `perflint` - astral-sh/ruff #4789</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>perflint</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/4789">#4789</a>
        opened by <a href="https://github.com/93578237">@93578237</a>
        on 2023-06-01 16:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/93578237">@93578237</a></div>
            <div class="timeline-body"><p>https://github.com/tonybaloney/perflint - Python Linter for performance anti patterns.</p>
<ul>
<li>[x] PERF101: Unnecessary list() on already iterable type (unnecessary-list-cast)</li>
<li>[x] PERF102: Incorrect iterator method for dictionary (incorrect-dictionary-iterator)</li>
<li>[ ] PERF201: Loop invariant statement (loop-invariant-statement)</li>
<li>[ ] PERF202: Global name usage in a loop (loop-global-usage)</li>
<li>[x] PERF203: Try..except blocks have a significant overhead. Avoid using them inside a loop (loop-try-except-usage)</li>
<li>[ ] PERF204: Looped slicing of bytes objects is inefficient. Use a memoryview() instead (memoryview-over-bytes)</li>
<li>[ ] PERF205:  Importing the &quot;%s&quot; name directly is more efficient in this loop. (dotted-import-in-loop)</li>
<li>[ ] PERF301: Use tuple instead of list for a non-mutated sequence. (use-tuple-over-list)</li>
<li>[x] PERF401: Use a list comprehension instead of a for-loop (use-list-comprehension)</li>
<li>[x] PERF402: Use a list copy instead of a for-loop (use-list-copy)</li>
<li>[x] PERF403: Use a dictionary comprehension instead of a for-loop (use-dict-comprehension)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2023-06-01 19:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/93578237">@93578237</a> on 2023-06-07 13:12</div>
            <div class="timeline-body"><p>Also rules from https://github.com/tonybaloney/anti-patterns
like https://github.com/tonybaloney/anti-patterns/pull/4 and https://github.com/tonybaloney/anti-patterns/pull/5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-06-07 21:22</div>
            <div class="timeline-body"><p>If that's a separate plugin it's best to make a different issue for that. As for perflint, I will wait until the first PR is merged before looking at further rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-06-15 11:26</div>
            <div class="timeline-body"><p>Rules checklist:</p>
<p>EDIT: Added to Issue body</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2023-06-15 12:49</div>
            <div class="timeline-body"><p>@qdegraaf I can pick up some of these - are there any that you're particularly interested in? Don't want to overstep</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-15 13:27</div>
            <div class="timeline-body"><p>Thanks @qdegraaf - I went ahead and added that to the issue body :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-06-15 14:09</div>
            <div class="timeline-body"><blockquote>
<p>@qdegraaf I can pick up some of these - are there any that you're particularly interested in? Don't want to overstep</p>
</blockquote>
<p>Awesome! I've got an almost complete PERF101. Otherwise haven't picked up anything yet. I'll open a draft PR for PERF101 and otherwise take your pick! Feel free to ping me on the Discord if you want to collaborate or check availability.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2023-06-17 15:59</div>
            <div class="timeline-body"><p>I can grab PERF203 and PERF301 to start.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-06-22 11:34</div>
            <div class="timeline-body"><p>I'll start looking at 401 and 402</p>
<p>EDIT: Picked up 403 in a separate PR as well. I can leave the 2X and 3X to you if you like @evanrittenhouse</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2023-06-23 14:40</div>
            <div class="timeline-body"><p>@qdegraaf You can grab 3X as well! I'll do 2X, if that works for you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/93578237">@93578237</a> on 2023-06-23 14:50</div>
            <div class="timeline-body"><blockquote>
<p>If that's a separate plugin it's best to make a different issue for that.</p>
</blockquote>
<p>Rules from perflint are derived from <a href="https://github.com/tonybaloney/anti-patterns">tonybaloney/anti-patterns</a>.
These rules ( https://github.com/tonybaloney/anti-patterns/pull/4 and https://github.com/tonybaloney/anti-patterns/pull/5) are not yet implemented in perflint (https://github.com/tonybaloney/perflint/issues/31)</p>
<p>So these 2 rules (join with generator and regex with IGNORECASE) should be part of perflint or RUF rules?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/qdegraaf">@qdegraaf</a> on 2023-06-23 14:57</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>If that's a separate plugin it's best to make a different issue for that.</p>
</blockquote>
<p>Rules from perflint are derived from <a href="https://github.com/tonybaloney/anti-patterns">tonybaloney/anti-patterns</a>. These rules ( <a href="https://github.com/tonybaloney/anti-patterns/pull/4">tonybaloney/anti-patterns#4</a> and <a href="https://github.com/tonybaloney/anti-patterns/pull/5">tonybaloney/anti-patterns#5</a>) are not yet implemented in perflint (<a href="https://github.com/tonybaloney/perflint/issues/31">tonybaloney/perflint#31</a>)</p>
<p>So these 2 rules (join with generator and regex with IGNORECASE) should be part of perflint or RUF rules?</p>
</blockquote>
<p>@charliermarsh what's the protocol for this. I think it makes functional sense to add it to <code>perflint</code> but not sure if Ruff is ok with expanding upon upstream plugin scope for direct ports.</p>
<blockquote>
<p>@qdegraaf You can grab 3X as well! I'll do 2X, if that works for you?</p>
</blockquote>
<p>Cool, works for me! If I get round to them at some point in the near future I'll make sure to announce it here. Feel free to change your mind in the meantime if you find time before me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @charliermarsh on 2023-07-10 01:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flying-sheep">@flying-sheep</a> on 2023-07-14 10:01</div>
            <div class="timeline-body"><p>PERF203 should only trigger when there’s no loop flow control (<code>break</code>, <code>continue</code>) in the try-catch statement. E.g. I don’t think there’s a better way to write the following:</p>
<pre><code class="language-py">for repo in ['R-patched', 'cran', 'bioc']:
    try:
        pkg_cache = self._fetch_cache(repo, pkg)
        break
    except HTTPError:
        pass
else:
    return None
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:19 UTC
    </footer>
</body>
</html>
