<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUF055: false negative for `re.search(...)` - astral-sh/ruff #14782</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>RUF055: false negative for <code>re.search(...)</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/14782">#14782</a>
        opened by <a href="https://github.com/trim21">@trim21</a>
        on 2024-12-05 07:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/trim21">@trim21</a></div>
            <div class="timeline-body"><pre><code class="language-python">import re


def test_cost_repeated_merge(errors):
    assert any(re.search(&quot;Duplicate merge&quot;, error.message) for error in errors)

</code></pre>
<pre><code class="language-text">$ ruff check d.py --select RUF055 --preview
All checks passed!

$ ruff --version
ruff 0.8.1
</code></pre>
<p>plarground: https://play.ruff.rs/9db437a8-cdfd-457c-a964-09fd788b9970</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-05 08:02</div>
            <div class="timeline-body"><p>The issue here is that Ruff doesn't detect that <code>re.search</code> is used in a boolean position. I don't think it's worth special casing <code>any</code> (and many other functions that take boolean arguments)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @MichaReiser on 2024-12-05 08:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2024-12-06 17:21</div>
            <div class="timeline-body"><blockquote>
<p>The issue here is that Ruff doesn't detect that <code>re.search</code> is used in a boolean position. I don't think it's worth special casing <code>any</code> (and many other functions that take boolean arguments)</p>
</blockquote>
<p>Wouldn't it make more sence to rewrite <code>re.search(&quot;Duplicate merge&quot;, error.message)</code> to <code>&quot;Duplicate merge&quot; in error.message</code> to fit in boolean type?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-12-06 17:29</div>
            <div class="timeline-body"><p>It's not about the rewrite. It's that Ruff doesn't think it's safe the change the <code>search</code> call because it doesn't know that the <code>re.search</code> result is used in a boolean position - the code only tests if the result is true or false.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2024-12-06 17:32</div>
            <div class="timeline-body"><p>OKï¼Œ I misunderstand. I thought that ruff know it's used as bool and decide not to report RUF055 on it</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:44 UTC
    </footer>
</body>
</html>
