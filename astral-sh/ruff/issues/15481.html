<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`itertools.starmap(func, zip(...))` - astral-sh/ruff #15481</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>itertools.starmap(func, zip(...))</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/15481">#15481</a>
        opened by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a>
        on 2025-01-14 21:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a></div>
            <div class="timeline-body"><p>#14835 asked that <a href="https://docs.astral.sh/ruff/rules/reimplemented-starmap/"><code>FURB140</code></a> be changed to accommodate the pattern <code>itertools.starmap(func, zip(...))</code>, suggesting <code>map(func, ...)</code> as the replacement.</p>
<p><a href="https://github.com/astral-sh/ruff/issues/14835#issuecomment-2544883959">This comment</a> lists four steps of improvements, of which the second doesn't seem to be actionable/applicable (<code>FURB140</code> does not check for <code>map</code>). This issue discusses the third:</p>
<blockquote>
<p>A new rule that recommends using <code>map</code> over <code>starmap(func, zip)</code></p>
</blockquote>
<p><code>starmap(func, zip(a, b, c))</code> can be transformed losslessly to <code>map(func, a, b, c)</code>, so violations are both easy to detect and safely fixable, even with comments.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-01-14 21:58</div>
            <div class="timeline-body"><p>Alternatively, the fix of <code>FURB140</code> could be modified to create a special case when <code>zip()</code> is used as the <code>iter</code> of a comprehension. I think this is much less preferable as it has <a href="https://github.com/astral-sh/ruff/issues/14793">the same pitfalls</a> as the original <code>RUF046</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @dylwil3 on 2025-01-15 00:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @dylwil3 on 2025-01-15 00:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 09:07</div>
            <div class="timeline-body"><p>Copied over from the PR:</p>
<hr>

<p>I don't think we can implement this right now without changing <code>FURB140</code>. You can see in this <a href="https://play.ruff.rs/a9af7dfb-6dc5-4eee-b8c9-f41437eb24bf">playground</a> that <code>FURB140</code> recommends using <code>starmap</code> for <code>map(..., zip)</code>. I think this is what I meant that we have to change <code>FURB140</code> first but I incorrectly wrote <code>map</code> instead of saying that it shouldn't apply to <code>zip</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 09:14</div>
            <div class="timeline-body"><p>We should also decide if we want to add this rule (leaning towards yes).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/InSyncWithFoo">@InSyncWithFoo</a> on 2025-01-15 10:49</div>
            <div class="timeline-body"><p>I think the situation is similar to that of <a href="https://docs.astral.sh/ruff/rules/printf-string-formatting/"><code>UP031</code></a> and <a href="https://docs.astral.sh/ruff/rules/f-string/"><code>UP032</code></a> in that one reports (and fixes) the other's output. Given that this rule is almost always safely fixable, it should be just as painless.</p>
<p>Changing <code>FURB140</code> is trivial enough but that would be a perhaps undesired special case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 13:54</div>
            <div class="timeline-body"><p>I guess that's fair and we can change FURB140 later if necessary. Thanks for explaining.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-01-16 14:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:59 UTC
    </footer>
</body>
</html>
