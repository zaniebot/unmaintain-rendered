<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISC001 fix covers not all cases - astral-sh/ruff #13063</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ISC001 fix covers not all cases</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13063">#13063</a>
        opened by <a href="https://github.com/serjflint">@serjflint</a>
        on 2024-08-22 19:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/serjflint">@serjflint</a></div>
            <div class="timeline-body">

<p>ruff 0.5.3
ruff check --fix</p>
<p>Hi! I am trying to fix all ISC errors after switching from 80 line-length to 120.
I still have many cases which are flagged by ISC001 but aren&#x27;t auto-fixed.</p>
<p>One such case is where only one side is an f-string:
<code>&#x27;Argument &quot;num&quot; has incorrect type. &#x27; f&#x27;Expected {num}.&#x27;</code>
<code>f&#x27;Request to {TVM_SERVICE_NAME} failed. &#x27; &#x27;Unexpected error: &#x27; + error_msg</code>
<code>f&#x27;oneOf schema variants {nullable_variants} are nullable &#x27; &#x27;at the same time, this create ambiguities&#x27;</code></p>
<p>Another one was with different quote-styles (because some string are double-quoted even with <code>quote-style = &quot;single&quot;</code>), but I worked around it by formatting everything to double-quotes and back.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-22 19:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2024-08-22 19:58</div>
            <div class="timeline-body"><p>The current implementation of this rule requires that both the leading and trailing quotes of each string agree before concatenating. That&#x27;s actually causing both issues, because the leading quote for <code>f&quot;{num}&quot;</code> comes out as <code>f&quot;</code> not <code>&quot;</code>.</p>
<p>https://github.com/astral-sh/ruff/blob/2edd32aa31446c81c245beb1230de26220a7d7e8/crates/ruff_linter/src/rules/flake8_implicit_str_concat/rules/implicit.rs#L159-L173</p>
<p>From my point of view, the f-string miss is a bug but the disagreement in quote-styles is maybe not (and fixable, as you say, by running a formatter first). Maybe these can be concatenated with correct quotes depending on a user-defined setting? Or, if the linter is allowed to look at formatter settings, the rule could default to concatenating <code>&quot;a&quot; &#x27;b&#x27;</code> to <code>&quot;ab&quot;</code> if the formatter settings prefer double-quotes, for example.</p>
<p>But in any event, I defer to the maintainers.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:57 UTC
    </footer>
</body>
</html>
