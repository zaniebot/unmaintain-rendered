<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `exclude` option to `format` and `lint` sections - astral-sh/ruff #7645</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>exclude</code> option to <code>format</code> and <code>lint</code> sections</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7645">#7645</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2023-09-25 09:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><p>Add the new <code>exclude</code> option to the <code>format</code> and <code>lint</code> section to exclude a set of files for a specific tool only. Respect the new option in the <code>check</code>, <code>fix</code>, and <code>format</code> commands.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 09:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Formatter: Beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-25 09:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-28 13:44</div>
            <div class="timeline-body"><p>@charliermarsh any advice on how to implement this? It seems that <code>python_files_in_path</code> is doing all the exclusions now. Should we just add an early check in one of the <code>lint</code> commands that returns immediately if the file is excluded?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-28 14:52</div>
            <div class="timeline-body"><p>@MichaReiser - Yeah, that would be my suggestion: <code>python_files_in_path</code> applies the top-level filters, then we apply any further filters in <code>lint</code>. It&#x27;s kind of similar to <code>per-file-ignores</code>: we filter down the global rule set based on the <code>ignore</code> setting, but we then apply any <code>per-file-ignores</code> after collecting diagnostics, on a per-file basis.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-29 08:38</div>
            <div class="timeline-body"><p>We may also want to make sure that these files don&#x27;t get formatted on save in the IDE. @charliermarsh does ruff lint files in the IDE that are not part of <code>include</code> or <code>exclude</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-29 11:11</div>
            <div class="timeline-body"><p>Adding <code>exclude</code> to lint will be somewhat challenging because we use serde&#x27;s <code>flatten</code> to expose the same options top-level and under the <code>lint</code> keyword. This works perfectly but imposes a challenge now because <code>exclude</code> (and, in the future, the <code>preview</code> flag) conflicts with the top-level <code>exclude</code> setting.</p>
<p>I think what we can try is to have a few more structs ðŸ˜†</p>
<ul>
<li><code>CommonLintOptions</code>: The lint options without <code>exclude</code> (and eventually <code>preview</code>).</li>
<li><code>LintOptions</code>: Defines the <code>preview</code> option and flattens the <code>CommonLintOptions</code></li>
<li><code>Options</code> flattens the <code>CommonLintOptions</code> (instead of <code>LintOptions</code> as of today)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-16 09:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-10-18 01:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:43 UTC
    </footer>
</body>
</html>
