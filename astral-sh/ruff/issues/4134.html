<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff fails to exclude a file, tries to parse it, and bails - astral-sh/ruff #4134</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Ruff fails to exclude a file, tries to parse it, and bails</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/4134">#4134</a>
        opened by <a href="https://github.com/flying-sheep">@flying-sheep</a>
        on 2023-04-27 15:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/flying-sheep">@flying-sheep</a> on 2023-04-27 15:22</div>
            <div class="timeline-body"><p>I have a git repository. Since it’s a cookiecutter template, it contains a directory called <code>{{cookiecutter.project_name}}</code>[sic]. I try to run Ruff on the other files in the repo like this:</p>
<pre><code class="language-console">$ ruff &quot;--extend-exclude=\\{\\{cookiecutter.project_name\\}\\}/**&quot; --force-exclude -v .
[2023-04-27][17:17:32][ruff::resolver][DEBUG] Ignored path via `exclude`: &quot;/Users/phil/Dev/cookiecutter-scverse/.git&quot;
error: TOML parse error at line 50, column 1
   |
50 | {% if cookiecutter.project_name.lower().replace('-', '_') != cookiecutter.package_name -%}
   | ^
invalid key
</code></pre>
<p>Ruff shouldn’t try to parse that TOML file, I’m excluding it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../scverse/cookiecutter-scverse/pulls/168.html">scverse/cookiecutter-scverse#168</a> on 2023-04-27 15:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flying-sheep">@flying-sheep</a> on 2023-04-27 15:59</div>
            <div class="timeline-body"><p>I circumvented it by using pre-commit’s <code>files</code> key, but I guess for others this would still be an issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-27 17:55</div>
            <div class="timeline-body"><p>Hmm yeah, that does look like a bug. I thought I'd fixed this in #3588, just confirming that you're on a recent release?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-04-27 17:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-27 18:57</div>
            <div class="timeline-body"><p>The linked PR suggests v0.0.250 -- mind checking if something like v0.0.260 or newer resolves this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flying-sheep">@flying-sheep</a> on 2023-04-28 10:01</div>
            <div class="timeline-body"><p>Huh, did use a freshly installed command line Ruff to verify (without actually checking if it was the newest version), but now I can’t reproduce it.</p>
<p>Apologies!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @flying-sheep on 2023-04-28 10:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:08 UTC
    </footer>
</body>
</html>
