<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rule request: __format__ without __str__ - astral-sh/ruff #16810</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Rule request: __format__ without __str__</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/16810">#16810</a>
        opened by <a href="https://github.com/ilius">@ilius</a>
        on 2025-03-17 15:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ilius">@ilius</a> on 2025-03-17 15:09</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Let's say we have a code like this:</p>
<pre><code class="language-py">
class A:
	def __format__(self, fmt=&quot;&quot;):
		return &quot;Dummy format&quot;

print(f&quot;{A()}&quot;)

</code></pre>
<p>Which prints <code>Dummy format</code>.</p>
<p>Now if you run <code>refurb</code>, it suggests:</p>
<pre><code>[FURB183]: Replace `f&quot;{A()}&quot;` with `str(A())`
</code></pre>
<p>But that would break the code, and produce an output like <code>&lt;__main__.A object at 0x79f88dfc1dc0&gt;</code>, because the class does not override <code>__str__</code> method.</p>
<p>Even without refurb, someone might not know or remember that f-string calls <code>__format__</code>, and change it to <code>str()</code>.</p>
<p>So to prevent these kinds of problems, I would suggest adding a rule to ensure if <code>__format__</code> method exists (overridden) in a class, method <code>__str__</code> should also exists, and probably just return <code>self.__format__()</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Rule suggestion: __format__ without __str__" to "Rule request: __format__ without __str__" by @ilius on 2025-03-17 15:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-03-17 16:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2025-03-17 16:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:54 UTC
    </footer>
</body>
</html>
