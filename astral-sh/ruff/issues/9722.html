<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Feature request] Indentation for ternary statements - astral-sh/ruff #9722</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Feature request] Indentation for ternary statements</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9722">#9722</a>
        opened by <a href="https://github.com/tylerlaprade">@tylerlaprade</a>
        on 2024-01-30 21:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tylerlaprade">@tylerlaprade</a></div>
            <div class="timeline-body"><p>Ternary statements that are broken across multiple lines are indented at the same level as the parent line, making them very hard to read, especially if surrounded by additional logic. Prettier handles the equivalent case in JS/TS by adding an indentation level to the ternaries. This would likely need to be behind a flag for ease of migration from Black, but ideally this would be the only behavior if that constraint didn&#x27;t exist.</p>
Ruff
<img alt="image" src="https://github.com/astral-sh/ruff/assets/5475199/8528b9b8-06c7-4cf4-b735-819ae6e37331">

Prettier
<img alt="image" src="https://github.com/astral-sh/ruff/assets/5475199/a0da3eda-8f69-4f18-a3cb-585a6be894b3">

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-01-30 22:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on 2024-01-30 23:57</div>
            <div class="timeline-body"><p>How would you expect the Python code to be formatted? Since Python ternaries are written out in a different order than JS ternaries, it&#x27;s difficult to apply the Prettier format directly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2024-01-31 03:24</div>
            <div class="timeline-body"><p>That&#x27;s a good point, I hadn&#x27;t considered that difference. I think a single additional indent in front of <code>if</code> and <code>else</code> would make the most sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-31 07:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-01-31 07:34</div>
            <div class="timeline-body"><p>I like the idea and I want to improve the conditional formatting because the current formatting can be hard to read. That&#x27;s why Black&#x27;s now parenthesizes long conditionals but I would prefer to find a more readable style without adding extra parentheses (see <a href="https://github.com/psf/black/issues/4123">psf/black#4123</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vanakema">@vanakema</a> on 2024-11-05 18:38</div>
            <div class="timeline-body"><p>I&#x27;m with @tylerlaprade on indenting the <code>if</code> and <code>else</code>. It&#x27;s simple and it makes it way more readable.</p>
<p>Here&#x27;s an example
Current Ruff formatting</p>
<pre><code>        foo = Foo(
            bar_id=bar.id,
            baz_id=f&#x27;{baz.name}_{bar_numer}_{idx}&#x27;
            if bar_number
            else f&#x27;{baz.name}_{idx}&#x27;,
            zap=zap,
        )
</code></pre>
<p>Desired ruff formatting (which ruff format does not allow)</p>
<pre><code>        foo = Foo(
            bar_id=bar.id,
            baz_id=f&#x27;{baz.name}_{bar_numer}_{idx}&#x27;
                if bar_number
                else f&#x27;{baz.name}_{idx}&#x27;,
            zap=zap,
        )
</code></pre>
<p>This makes it easier to glean while skimming code that it is a ternary and not part of the arg list</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mathmul">@mathmul</a> on 2025-04-29 04:09</div>
            <div class="timeline-body"><p>And here I am wishing</p>
<pre><code>def get_payment_method_client(payment_method: PaymentMethodEnum, credentials: dict) -&gt; BaseClient:
    def raise_payment_method_not_found():
        raise PaymentMethodNotFoundException()
    return (
        AlmaPayClient(credentials)    if PaymentMethodEnum.ALMA_PAY == payment_method else
        SmartGiftyClient(credentials) if PaymentMethodEnum.SMART_GIFTY == payment_method else # Note: Excluding this comment the line has less characters than line-length in pyproject.toml
        # TODO: add other payment methods here
        raise_payment_method_not_found()
    )
</code></pre>
<p>wouldn&#x27;t turn into a mess that is</p>
<pre><code>def get_payment_method_client(payment_method: PaymentMethodEnum, credentials: dict) -&gt; BaseClient:
    def raise_payment_method_not_found():
        raise PaymentMethodNotFoundException()

    return (
        AlmaPayClient(credentials)
        if PaymentMethodEnum.ALMA_PAY == payment_method
        else SmartGiftyClient(credentials)
        if PaymentMethodEnum.SMART_GIFTY == payment_method
        # TODO: add other payment methods here
        else raise_payment_method_not_found()
    )
</code></pre>
<p>forcing me to keep</p>
<pre><code>def get_payment_method_client(payment_method: PaymentMethodEnum, credentials: dict) -&gt; BaseClient:
    match payment_method:
        case PaymentMethodEnum.ALMA_PAY:
            return AlmaPayClient(credentials)
        case PaymentMethodEnum.SMART_GIFTY:
            return SmartGiftyClient(credentials)
        # TODO: add other payment methods here
        case _:
            raise PaymentMethodNotFoundException()
</code></pre>
<p>which will be almost double the lines, once I finish implementing the remaining 11 payment methods... and less readable IMO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2025-04-29 23:55</div>
            <div class="timeline-body"><p>@mathmul, that will be WAY easier to read as a switch with 13 cases as opposed to 13 if/else ternaries. That&#x27;s the exact usecase that switches are designed for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2025-11-11 20:21</div>
            <div class="timeline-body"><p>I definitely agree that vanakema&#x27;s example is formatted badly (as also evidenced by upvotes). Black since 2024 has <code>parenthesize_conditional_expressions</code>, so Black would format it like so:</p>
<pre><code>        foo = Foo(
            bar_id=bar.id,
            baz_id=(
                f&quot;{baz.name}_{bar_number_asdf}_{idx}&quot;
                if bar_number_asdf
                else f&quot;{baz.name}_{idx}&quot;
            ),
            zap=zap,
        )
</code></pre>
<p>However, <em>once already parenthesised</em> I don&#x27;t see an advantage in adding additional indentation to the condition clause and the else clause. That is, for me it makes things worse to reformat this:</p>
<pre><code>class A:
    def meth(self):
        return (
            [&quot;version_number&quot;, &quot;created_at&quot;, &quot;updated_at&quot;]
            if obj
            else self.readonly_fields
        )
</code></pre>
<p>to this:</p>
<pre><code>class A:
    def meth(self):
        return (
            [&quot;version_number&quot;, &quot;created_at&quot;, &quot;updated_at&quot;]
                if obj
                else self.readonly_fields
        )
</code></pre>
<p>It feels overindented for no clear reason and reduces symmetry between the two branches (in a way that the JS/TS case does not). And the version of that without parentheses and just indents is not valid Python syntax</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jackdent">@jackdent</a> on 2026-01-01 04:13</div>
            <div class="timeline-body"><p>I&#x27;d love a way to enforce that a ternary operator needs to be surrounded by parens if it&#x27;s going to span multiple lines.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:49 UTC
    </footer>
</body>
</html>
