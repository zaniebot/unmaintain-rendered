<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP007: Does not respect target version and suggests incompatible syntax - astral-sh/ruff #8484</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UP007: Does not respect target version and suggests incompatible syntax</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8484">#8484</a>
        opened by <a href="https://github.com/chbndrhnns">@chbndrhnns</a>
        on 2023-11-04 09:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chbndrhnns">@chbndrhnns</a></div>
            <div class="timeline-body"><p>To me it seems that ruff should only suggest fixes that are compatible with the configured target version. That&#x27;s not the case for this example using ruff 0.1.4.</p>
<p>Command:</p>
<pre><code>ruff check .
</code></pre>
<p>Config:</p>
<pre><code>target-version = &quot;py39&quot;

[lint]
select = [&quot;UP&quot;]

</code></pre>
<p>Code:</p>
<pre><code>
from __future__ import annotations

from typing import Optional


class C:
    int: Optional[int]

</code></pre>
<p>Output:</p>
<pre><code>main.py:7:10: UP007 Use `X | Y` for type annotations
</code></pre>
<p>This is even auto-fixable but will result in a syntax error on Python 3.9</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;UP007: Suggests incompatible syntax&quot; to &quot;UP007: Does not respect target version and suggests incompatible syntax&quot; by <a href="https://github.com/chbndrhnns">@chbndrhnns</a> on 2023-11-04 09:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2023-11-04 10:04</div>
            <div class="timeline-body"><p>Using <code>|</code> isn&#x27;t a syntax error in Python 3.9 if you import <code>annotations</code> from <code>__future__</code>. More information can be found on the <a href="https://docs.astral.sh/ruff/rules/non-pep604-annotation/">docs</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chbndrhnns">@chbndrhnns</a> on 2023-11-04 11:55</div>
            <div class="timeline-body"><p>Thanks, I read the docs now and it turned out it&#x27;s coming from pydantic. Thanks much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/chbndrhnns">@chbndrhnns</a> on 2023-11-04 11:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-04 13:30</div>
            <div class="timeline-body"><p>üëç You can also disable this behavior (of using newer syntax when <code>__future__</code> is present via <a href="https://docs.astral.sh/ruff/settings/#pyupgrade-keep-runtime-typing"><code>keep-runtime-typing</code></a>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:45 UTC
    </footer>
</body>
</html>
