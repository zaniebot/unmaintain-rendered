<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RUF039 fix should be available for octal escapes and `u` string prefixes - astral-sh/ruff #19707</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>RUF039 fix should be available for octal escapes and <code>u</code> string prefixes</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/19707">#19707</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-08-02 22:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dscorbett">@dscorbett</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>The fix for <a href="https://docs.astral.sh/ruff/rules/unraw-re-pattern/"><code>unraw-re-pattern</code> (RUF039)</a> should be available in two more cases.</p>
<p>If a backslash is followed by a zero, that is an octal escape sequence, not a backreference, so the fix should not be suppressed. <a href="https://play.ruff.rs/44a89d5a-8eb3-4c4d-add9-2c0de9e5f08a">Example</a>:</p>
<pre><code class="language-console">$ cat &gt;ruf039_1.py &lt;&lt;'# EOF'
import re
print(re.findall(&quot;\0|\07|\014&quot;, &quot;\0\a\f&quot;))
print(re.findall(b&quot;\0|\07|\014&quot;, b&quot;\0\a\f&quot;))
# EOF

$ python ruf039_1.py
['\x00', '\x07', '\x0c']
[b'\x00', b'\x07', b'\x0c']

$ ruff --isolated check ruf039_1.py --select RUF039 --preview --output-format concise --unsafe-fixes --fix
ruf039_1.py:2:18: RUF039 First argument to `re.findall()` is not raw string
ruf039_1.py:3:18: RUF039 First argument to `re.findall()` is not raw bytes literal
Found 2 errors.
</code></pre>
<p>The ideal fixed output would be:</p>
<pre><code class="language-python">import re
print(re.findall(r&quot;\0|\07|\014&quot;, &quot;\0\a\f&quot;))
print(re.findall(rb&quot;\0|\07|\014&quot;, b&quot;\0\a\f&quot;))
</code></pre>
<p>A <code>u</code> prefix on a pattern string has no effect so it should not block the fix. <a href="https://play.ruff.rs/14ce1c75-2640-49ee-bbd8-5c2a8f4b77fa">Example</a>:</p>
<pre><code class="language-console">$ cat &gt;ruf039_2.py &lt;&lt;'# EOF'
import re
print(re.match(u&quot;.&quot;, &quot;!&quot;))
# EOF

$ python ruf039_2.py
&lt;re.Match object; span=(0, 1), match='!'&gt;

$ ruff --isolated check ruf039_2.py --select RUF039 --preview --output-format concise --fix
ruf039_2.py:2:16: RUF039 First argument to `re.match()` is not raw string
Found 1 error.
</code></pre>
<p>The ideal fixed output would be:</p>
<pre><code class="language-python">import re
print(re.match(r&quot;.&quot;, &quot;!&quot;))
</code></pre>
<h3>Version</h3>
<p>ruff 0.12.7 (c5ac99889 2025-07-29)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @ntBre on 2025-08-05 13:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @ntBre on 2025-08-05 13:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:53:09 UTC
    </footer>
</body>
</html>
