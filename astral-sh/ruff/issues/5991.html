<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff should consider adding rules first as a warning instead of a block - astral-sh/ruff #5991</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff should consider adding rules first as a warning instead of a block</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5991">#5991</a>
        opened by <a href="https://github.com/leandrodamascena">@leandrodamascena</a>
        on 2023-07-22 22:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/leandrodamascena">@leandrodamascena</a></div>
            <div class="timeline-body"><p>First of all, thank you so much for working so hard to create and maintain Ruff, this is an amazing project and it has made our CI so much faster than using flak8 and other tools. This issue is not a bug, but a behavior that Ruff should consider before adding new rules/checks.</p>
<p>In this latest version, Ruff added the <code>PLR1714</code> rule and broke our CI because the project I work on has code that this rule complains about - https://github.com/aws-powertools/powertools-lambda-python/pull/2822. In my opinion, this can be considered a breaking change as it has changed the behavior of how Ruff checks our code and evaluates rules.</p>
<p>That said, I would suggest that Ruff initially add a new rule/check as a warning for at least 2 or 3 releases before considering it a block, so we have time to fix the problems before breaking the CI.</p>
<p>Please let me know if I'm missing anything, but you should take this into account to improve the developer experience for Ruff customers.</p>
<p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-07-23 03:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-24 07:27</div>
            <div class="timeline-body"><p>Thanks for raising this problem, and I'm sorry that we broke your CI.</p>
<p>Here are some thoughts of mine on this:</p>
<ul>
<li>We never defined our versioning policy explicitly listing what ruff considers a breaking change. An explicit versioning policy would set expectations and help users understand the risk of laxer version ranges.</li>
<li>Releasing new rules with warning severity helps users by giving them a grace period for upgrading. However, it doesn't solve the breaking change problem by itself except if we decide only to introduce new rules when bumping the major version.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-07-24 10:14</div>
            <div class="timeline-body"><blockquote>
<p>Thanks for raising this problem, and I'm sorry that we broke your CI.</p>
</blockquote>
<p>No apologies needed here! You are doing an amazing job and was easy to fix my CI. My main point here is about having an explicit policy on what Ruff considers being a breaking change or not.</p>
<blockquote>
<p>Here are some thoughts of mine on this:</p>
<ul>
<li>We never defined our versioning policy explicitly listing what ruff considers a breaking change. An explicit versioning policy would set expectations and help users understand the risk of laxer version ranges.</li>
</ul>
</blockquote>
<p>I completely agree with this and, if the discussion becomes public (issue/rfc/others), I would love to contribute.</p>
<blockquote>
<ul>
<li>Releasing new rules with warning severity helps users by giving them a grace period for upgrading. However, it doesn't solve the breaking change problem by itself except if we decide only to introduce new rules when bumping the major version.</li>
</ul>
</blockquote>
<p>So we're back to setting the version control policy. With a well-defined versioning policy, customers can be aware of new rules/checks and be prepared to upgrade their Ruff versions.
This is an excellent point. I think this will make the Ruff user experience much more linear and give teams time to be prepared for Ruff updates. I vote to invest time to define this policy.</p>
<p>Thanks a lot for considering this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Mr-Pepe">@Mr-Pepe</a> on 2023-07-25 06:17</div>
            <div class="timeline-body"><p>I think this is an inherent &quot;problem&quot; of linters. What if a rule has bugs and does not identify problematic code? The bug gets fixed and suddenly your pipeline breaks because previously unidentified code smells are found. In my opinion, it's on the user to at least explicitly control the applied rules or (even better) to pin a version and explicitly update it. This also means that you have control over when your pipeline breaks and not your linter's release schedule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2023-07-25 08:33</div>
            <div class="timeline-body"><blockquote>
<p>In my opinion, it's on the user to at least explicitly control the applied rules or (even better) to pin a version and explicitly update it.</p>
</blockquote>
<p>For what it is worth, Rome recommends doing this on their <a href="https://docs.rome.tools/guides/getting-started/#installation">Getting Started</a> and <a href="https://docs.rome.tools/internals/versioning/">Versioning</a> pages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-07-25 09:00</div>
            <div class="timeline-body"><blockquote>
<p>In my opinion, it's on the user to at least explicitly control the applied rules or (even better) to pin a version and explicitly update it.</p>
</blockquote>
<p>In my specific case I pin the version for all my dependencies/actions and only updated when dependabot opens a PR. In this case the CI broke on that particular PR and it was easy to fix. But, in my opinion, a clear policy on versioning release is needed here.</p>
<p>Imagine I pin v0.0.280 and see that Ruff has released a new v0.0.281. What's in this version? A new rule? Is this update dropping a supported version of Python? Have any configuration files changed and some existing configuration is not supported anymore? This is a patch version update, so I would expect minor changes and bugix, but today it could happen both: bug fix and new rules (besides other cases). Today we need to read the entire release notes to identify what could be a breaking change or not even in patch release. We see lot of breaking changes in patch releases - https://github.com/astral-sh/ruff/blob/main/BREAKING_CHANGES.md.</p>
<p>I'm not complaining about the Ruff project, it's really amazing and we trust that we are maintaining the best standards and practices using Ruff as our linter, but we need to be clear on how Ruff versioning is done so that it's simple to identify changes that we need to modify anything before using it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Mr-Pepe">@Mr-Pepe</a> on 2023-07-25 10:00</div>
            <div class="timeline-body"><p>I agree that ruff's versioning scheme does not convey a lot of information. Even with ZeroVer one could distinguish between feature (potentially breaking) and bugfix releases. Is there a reason for only bumping patch versions?</p>
<p>However, I think it's important to be precise and in my opinion adding a rule is not a breaking change. A breaking change would mean dropping or changing the meaning of CLI or configuration options. A new rule might prevent a pipeline from passing, but that's due to a changed return code of the ruff invocation and not due to a break in ruff's API. That's also how Pylint is versioned.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-07-26 10:11</div>
            <div class="timeline-body"><blockquote>
<p>I agree that ruff's versioning scheme does not convey a lot of information. Even with ZeroVer one could distinguish between feature (potentially breaking) and bugfix releases. Is there a reason for only bumping patch versions?</p>
</blockquote>
<p>Yeah, I agree with this.</p>
<p>I think that would be nice to hear from the Ruff's maintainers what they think.</p>
<p>Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-08-08 22:22</div>
            <div class="timeline-body"><p>Hello Ruff team! Is it possible to have a conversation about this in the coming weeks?</p>
<p>This latest patch release of Ruff has brought a lot of breaking changes and I have to update my code before bumping the version. It would be really important if we had a versioning document to avoid this kind of thing.</p>
<p><img src="https://github.com/astral-sh/ruff/assets/4295173/d219250f-044d-4d1b-bb7f-7529106976e9" alt="image" /></p>
<p>Thank you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-08 22:26</div>
            <div class="timeline-body"><p>Yes, Iâ€™ll add it to my queue to post some thoughts here before the end of the week.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-08-08 22:30</div>
            <div class="timeline-body"><blockquote>
<p>Yes, Iâ€™ll add it to my queue to post some thoughts here before the end of the week.</p>
</blockquote>
<p>This is super @charliermarsh! Thank you so much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-08 22:32</div>
            <div class="timeline-body"><p>Thank you for bringing it up, itâ€™s an important thing that we keep meaning to spend time on ðŸ˜…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-08-11 16:04</div>
            <div class="timeline-body"><p>We've had a few discussions around this internally and have some initial ideas on what a more useful versioning scheme could look like. Our tentative plan is to queue this up as a project for next month -- so we'll draft a proposal internally, circulate it for public feedback and discussion, then put a transition plan in place.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-08-14 07:34</div>
            <div class="timeline-body"><blockquote>
<p>We've had a few discussions around this internally and have some initial ideas on what a more useful versioning scheme could look like. Our tentative plan is to queue this up as a project for next month -- so we'll draft a proposal internally, circulate it for public feedback and discussion, then put a transition plan in place.</p>
</blockquote>
<p>Hi @charliermarsh! This is really amazing to hear. If I can help in anything, please let me know.</p>
<p>Thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-01 14:10</div>
            <div class="timeline-body"><p>@leandrodamascena - Heads up: we now have a proposal up for our versioning scheme available in https://github.com/astral-sh/ruff/discussions/6998</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leandrodamascena">@leandrodamascena</a> on 2023-09-01 16:01</div>
            <div class="timeline-body"><p>Hi @charliermarsh! Thank you very much for tagging me here. I've already sent my impressions about this RFC and I think it's heading in the right direction. Congrats! ðŸš€</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-21 00:55</div>
            <div class="timeline-body"><p>We're now doing this in practice (new rules are being added under the preview flag), so gonna close out. Thanks again for the push @leandrodamascena!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-09-21 00:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:47:46 UTC
    </footer>
</body>
</html>
