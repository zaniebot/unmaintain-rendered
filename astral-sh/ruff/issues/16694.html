<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ignoring `import-private-name` (`PLC2701`) for first party module imports - astral-sh/ruff #16694</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Ignoring `import-private-name` (`PLC2701`) for first party module imports</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/16694">#16694</a>
        opened by <a href="https://github.com/Avasam">@Avasam</a>
        on 2025-03-13 02:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Avasam">@Avasam</a> on 2025-03-13 02:47</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I recently reran Ruff in preview mode on the typeshed codebase. And noticed that <a href="https://docs.astral.sh/ruff/rules/import-private-name/#import-private-name-plc2701">import-private-name (PLC2701)</a> whines about importing private first-party modules.</p>
<p>That rule can still make sense as a best-practice to avoid importing private <em>symbols</em> from first-party modules, but the point of private modules is that they should be imported in the same project/package that defines them right?</p>
<p>In typeshed's case, we have:</p>
<pre><code class="language-toml">[tool.ruff.lint.isort]
known-first-party = [&quot;_utils&quot;, &quot;ts_utils&quot;]
</code></pre>
<p>Yet PLC2701 triggers on lines like <code>from _utils import MYPY_PROTOBUF_VERSION, download_file, extract_archive, run_protoc</code>. Where <code>_utils</code> is a local module, which I think would always be undesirable to flag.
I understand that <a href="https://docs.astral.sh/ruff/settings/#lint_isort_known-first-party">known-first-party</a> is an isort rule, but:</p>
<ol>
<li>Can <a href="https://docs.astral.sh/ruff/rules/import-private-name/#import-private-name-plc2701">import-private-name (PLC2701)</a> ignore first-party private module imports</li>
<li>Can the logic of &quot;what's a first-party module import&quot;, including manual additions to <code>known-first-party</code>, be shared across isort and Pylint rules?</li>
</ol>
<hr />
<p>Ruff: 0.9.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/16691.html">astral-sh/ruff#16691</a> on 2025-03-13 03:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2025-03-13 14:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Ignoring `import-private-name (PLC2701)` for first party module imports" to "Ignoring `import-private-name` (`PLC2701`) for first party module imports" by @MichaReiser on 2025-03-13 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-13 14:52</div>
            <div class="timeline-body"><p>Could you share an example that is raised only in preview mode? I did a quick search and couldn't find any mention of preview behavior specific to PLC2701</p>
<blockquote>
<p>but the point of private modules is that they should be imported in the same project/package that defines them right?</p>
</blockquote>
<p>I think that depends on how strict you want to be. I understand from https://github.com/astral-sh/ruff/issues/16691 that they want to allow private imports from the direct parent module but not across packages in the same project or across multiple ancestors.</p>
<p>Eitherway. I do think that it makes sense to have a more intelligent rule to enforce visibility restrictions. However, I think this requires some design about what are common project structures and how we want to enforce them with the limited information that Ruff has available or if we have to wait for Red Knot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-design</span> added by @MichaReiser on 2025-03-13 14:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-03-13 20:25</div>
            <div class="timeline-body"><blockquote>
<p>Could you share an example that is raised only in preview mode? I did a quick search and couldn't find any mention of preview behavior specific to PLC2701</p>
</blockquote>
<p>I think the entire rule might be in preview?
Typeshed selects the <code>PLC</code> group. So running with the <code>--preview</code> flag just adds the rule to the selection.</p>
<hr />
<p>Btw this issue isn't directly related to #16691 . As in I opened this issue first, then found #16691 . And found some overlap whilst reading it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:15 UTC
    </footer>
</body>
</html>
