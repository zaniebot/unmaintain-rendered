<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`fmt: line-length-off` (or equivalent) - astral-sh/ruff #10631</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`fmt: line-length-off` (or equivalent)</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/10631">#10631</a>
        opened by <a href="https://github.com/thejcannon">@thejcannon</a>
        on 2024-03-27 17:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/thejcannon">@thejcannon</a> on 2024-03-27 17:02</div>
            <div class="timeline-body"><p>ðŸ‘‹ Howdy folks!</p>
<p>(I combed through the issues and didn't find one that looked like this)</p>
<p>This is a feature request for a <code># fmt: line-length-off</code> (or equivalent) pair of pragmas that just disables line-length formatting, but continues to enable other formatting.</p>
<p>As an example:</p>
<pre><code class="language-python"># fmt: line-length-off
NONREAD_MODES = [
    # update text modes
    &quot;r+&quot;, &quot;+r&quot;, &quot;rt+&quot;, &quot;r+t&quot;, &quot;+rt&quot;, &quot;tr+&quot;, &quot;t+r&quot;, &quot;+tr&quot;, &quot;w+&quot;, &quot;+w&quot;, &quot;wt+&quot;, &quot;w+t&quot;,
    &quot;+wt&quot;, &quot;tw+&quot;, &quot;t+w&quot;, &quot;+tw&quot;, &quot;a+&quot;, &quot;+a&quot;, &quot;at+&quot;, &quot;a+t&quot;, &quot;+at&quot;, &quot;ta+&quot;, &quot;t+a&quot;, &quot;+ta&quot;,
    &quot;x+&quot;, &quot;+x&quot;, &quot;xt+&quot;, &quot;x+t&quot;, &quot;+xt&quot;, &quot;tx+&quot;, &quot;t+x&quot;, &quot;+tx&quot;,
    # write text modes
    &quot;w&quot;, &quot;wt&quot;, &quot;tw&quot;, &quot;a&quot;, &quot;at&quot;, &quot;ta&quot;, &quot;x&quot;, &quot;xt&quot;, &quot;tx&quot;
    # update binary modes
    &quot;rb+&quot;, &quot;r+b&quot;, &quot;+rb&quot;, &quot;br+&quot;, &quot;b+r&quot;, &quot;+br&quot;, &quot;wb+&quot;, &quot;w+b&quot;, &quot;+wb&quot;, &quot;bw+&quot;, &quot;b+w&quot;, &quot;+bw&quot;,
    &quot;ab+&quot;, &quot;a+b&quot;, &quot;+ab&quot;, &quot;ba+&quot;, &quot;b+a&quot;, &quot;+ba&quot;, &quot;xb+&quot;, &quot;x+b&quot;, &quot;+xb&quot;, &quot;bx+&quot;, &quot;b+x&quot;, &quot;+bx&quot;,
    # write binary modes
    &quot;wb&quot;, &quot;bw&quot;, &quot;ab&quot;, &quot;ba&quot;, &quot;xb&quot;, &quot;bx&quot;
]
# fmt: line-length-on
</code></pre>
<p>I want ruff to continue to format/lint/etc... the string quotes, the general &quot;spacing&quot;, even the trailing comma... but keep my elements as they are.</p>
<p>That's it. Cheers y'all!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 10:26</div>
            <div class="timeline-body"><p>This is an interesting idea but I don't think this can be easily implemented in the formatter, because I assume what you want is that the formatter preserves the lines as is, but otherwise formats the code.</p>
<p>One challenge with this is that the formatter might decide to break a line for reasons other than the line length, e.g., because it's an array with a trailing comma. It's then impossible to preserve the lines as is.</p>
<p>There's also the technical challenge that the formatting is interdependent. The statement formatting makes assumptions about how expressions get formatted to ensure the emitted source code remains syntactically correct (e.g., correctly indented).  Preserving the lines as they are means that the enclosing formatting can make fewer assumptions, e.g., it can no longer make assumptions about where comments are placed (or it makes wrong assumption and the formatter produces invalid syntax).</p>
<p>I think this feature request is mainly a symptom from the fact that Ruff and Black aren't good at formatting large arrays (just flattening them is a possibility but doesn't necessarily improve readability). I think we should focus our time on improving array formatting over improving suppression comment handling to fix up weaknesses in the formatter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-03-28 10:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryan-williams">@ryan-williams</a> on 2024-04-04 18:49</div>
            <div class="timeline-body"><p><code>black</code> supports <code># fmt: off</code> / <code># fmt: on</code> to ignore blocks of code (<a href="https://stackoverflow.com/questions/58584413/black-formatter-ignore-specific-multi-line-code">SO</a>, <a href="https://black.readthedocs.io/en/stable/usage_and_configuration/the_basics.html#ignoring-sections">docs</a>).</p>
<p>Is there no way to disable <code>ruff</code> for specific lines or blocks of code?</p>
<p>(Update: I specifically want to skip sorting imports; I need some imports to be in a certain order.)</p>
<p>(Update^2: found <a href="https://docs.astral.sh/ruff/settings/#lintisort">relevant <code>isort</code> configs used by <code>ruff</code></a>; example use: https://github.com/single-cell-data/TileDB-SOMA/pull/2381)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-05 06:21</div>
            <div class="timeline-body"><p>@ryan-williams Ruff supports <code>fmt: off</code> and <code>fmt: on</code>, see <a href="https://docs.astral.sh/ruff/formatter/#format-suppression">docs</a>.</p>
<p>Yes, isort is not part of the formatter and uses different suppression comments but you already found the relevant documentation :)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
