<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ignore trailing commas not working for function arguments - astral-sh/ruff #16475</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ignore trailing commas not working for function arguments</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/16475">#16475</a>
        opened by <a href="https://github.com/sparxastronomy">@sparxastronomy</a>
        on 2025-03-03 14:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sparxastronomy">@sparxastronomy</a> on 2025-03-03 14:47</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have the following function block:</p>
<pre><code>def compute_profiles(
        x: np.ndarray, 
        y: np.ndarray, 
        window_size: int, 
        type: str = &quot;median&quot;, 
        return_xbins: bool = False
) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:
</code></pre>
<p>However ruff ignores the trailing commas, and formats it to  even though  <code>skip-magic-trailing-comma = false</code></p>
<pre><code>def compute_profiles(
    x: np.ndarray, y: np.ndarray, window_size: int, type: str = &quot;median&quot;, return_xbins: bool = False
) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:
</code></pre>
<p>The problem only appears for functions, for regular arrays the problem does not appear.</p>
<p>My configuration is:</p>
<pre><code>[tool.ruff]
extend-include = [&quot;*.ipynb&quot;]
preview = true
line-length = 120
indent-width = 4

[tool.ruff.format]
preview = true
quote-style = &quot;double&quot;
indent-style = &quot;space&quot;
line-ending = &quot;auto&quot;
skip-magic-trailing-comma = false
docstring-code-format = true
docstring-code-line-length = &quot;dynamic&quot;

[tool.ruff.lint]
select = [
    &quot;E&quot;, # pycodestyle (error)
    &quot;F&quot;, # pyflakes
    &quot;B&quot;, # bugbear
    &quot;B9&quot;,
    &quot;C4&quot;, # flake8-comprehensions
    &quot;SIM&quot;, # flake8-simplify
    &quot;I&quot;, # isort
    &quot;UP&quot;, # pyupgrade
    &quot;PIE&quot;, # flake8-pie
    &quot;PGH&quot;, # pygrep-hooks
    &quot;PYI&quot;, # flake8-pyi
    &quot;RUF&quot;,
]
ignore = [
    # only relevant if you run a script with `python -0`,
    # which seems unlikely for any of the scripts in this repo
    &quot;B011&quot;,
    # Leave it to the formatter to split long lines and
    # the judgement of all of us.
    &quot;E501&quot;,
    &quot;RUF052&quot;,
    &quot;E201&quot;,
    &quot;E241&quot;
]

fixable = [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;]
unfixable = []

[tool.ruff.lint.pydocstyle]
convention = &quot;google&quot;
</code></pre>
<p>I am using the latest version of Ruff extension on VSCode.</p>
<h3>Version</h3>
<p>v2025.14.0 (VScode)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-03-03 14:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-03 14:54</div>
            <div class="timeline-body"><p>Hi @sparxastronomy</p>
<p>I don't see a trailing comma in your example code. The trailing comma must come after the last argument's default value:</p>
<pre><code class="language-py">def compute_profiles(
        x: np.ndarray, 
        y: np.ndarray, 
        window_size: int, 
        type: str = &quot;median&quot;, 
        return_xbins: bool = False,
) -&gt; tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]: ...
</code></pre>
<p>Ruff should then split the arguments across multiple lines when using <code>skip-magic-trailing-comma=false</code> (default)</p>
<p>https://play.ruff.rs/10014487-0683-40d5-9eed-968075bce9b5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sparxastronomy">@sparxastronomy</a> on 2025-03-03 15:11</div>
            <div class="timeline-body"><p>Thanks @MichaReiser for point out the missing commas. I thought the last comma was not needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sparxastronomy on 2025-03-03 15:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:54 UTC
    </footer>
</body>
</html>
