<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cache-dir in configfiile should be relative to that configfile - astral-sh/ruff #7958</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>cache-dir in configfiile should be relative to that configfile</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7958">#7958</a>
        opened by <a href="https://github.com/woutervh">@woutervh</a>
        on 2023-10-14 10:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/woutervh">@woutervh</a></div>
            <div class="timeline-body"><p>using ruff 0.0.292</p>
<p>in my projects&#x27;s pyproject.toml, I configure the <em>cache-dir</em></p>
<pre><code>[tool.ruff]
# ruff searches for settings in the target-dir and up
# https://beta.ruff.rs/docs/configuration/
cache-dir = &quot;var/cache/ruff&quot;  # relative to $PWD
</code></pre>
<p>when setting a relative path in pyproject.toml,
the setting should be relative to that pyproject.toml-file.</p>
<p>however, ruff takes it relative to the $PWD,  which does not make sense in a configfile.</p>
<p>when I run ruff from my project-directory,  it creates cache-dirs in every location I run ruff from:</p>
<pre><code>pyproject.toml

docs/
    conf.py
    var/cache/ruff/
src/
    foo/
         var/cache/ruff
        __init__

tests/
    conftest.py
    var/cache/ruff/

var/cache/ruff/
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-14 18:34</div>
            <div class="timeline-body"><p>I don&#x27;t think it should be relative to the configuration file in all cases (though it&#x27;s probably not worth going into why), but it should be relative to the &quot;project root&quot; which is <em>typically</em> the directory containing the configuration file.</p>
<p>In the above case, we <em>should</em> be choosing the top-level directory as the project root in all cases, and so using that same top-level <code>var/cache/ruff/</code>, so seems like a bug.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-14 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-14 18:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-14 19:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:43 UTC
    </footer>
</body>
</html>
