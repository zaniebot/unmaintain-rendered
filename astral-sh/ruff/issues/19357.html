<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP008 should only apply when the `__class__` cell exists - astral-sh/ruff #19357</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>UP008 should only apply when the `__class__` cell exists</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/19357">#19357</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-07-15 13:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-07-15 13:36</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><a href="https://docs.astral.sh/ruff/rules/super-call-with-parameters/"><code>super-call-with-parameters</code> (UP008)</a> should only apply when <code>super</code> is a global variable or <code>__class__</code> is a nonlocal variable. Expressions that are merely equal to <code>super</code> aren’t good enough. Otherwise, the zero-argument <code>super</code> call doesn’t work. One solution is for the autofix to rewrite the <code>super</code>-equivalent expression to <code>super</code>, although that won’t work in all contexts. <a href="https://play.ruff.rs/852c338a-1d97-4fa4-bbbd-6f768ef373b8">Example</a>:</p>
<pre><code class="language-console">$ cat &gt;up008.py &lt;&lt;'# EOF'
import builtins
class A:
    def f(self):
        print(&quot;!&quot;)
class B(A):
    def f(self):
        builtins.super(B, self).f()
B().f()
# EOF

$ python up008.py
!

$ ruff --isolated check up008.py --select UP008 --unsafe-fixes --fix
Found 1 error (1 fixed, 0 remaining).

$ cat up008.py
import builtins
class A:
    def f(self):
        print(&quot;!&quot;)
class B(A):
    def f(self):
        builtins.super().f()
B().f()

$ python up008.py 2&gt;&amp;1 | tail -n 1
RuntimeError: super(): __class__ cell not found
</code></pre>
<p>Note that the expression that UP008 rewrites can still use <code>builtins.super</code> (or other expressions that equal <code>super</code> but are not literally <code>super</code>) but <code>super</code> or <code>__class__</code> just needs to be mentioned somewhere in the method in order for the <code>__class__</code> cell, which the zero-argument <code>super</code> uses, to be created. <a href="https://play.ruff.rs/4a54ab21-24a0-448a-9331-4b416e84ab75">True positive example</a> with <code>super</code>:</p>
<pre><code class="language-console">$ cat &gt;up008_super.py &lt;&lt;'# EOF'
import builtins
super = None  # It still works even if `super` is shadowed!
class A:
    def f(self):
        print(&quot;!&quot;)
class B(A):
    def f(self):
        if False: super
        builtins.super(B, self).f()
B().f()
# EOF

$ ruff --isolated check up008_super.py --select UP008 --unsafe-fixes --fix
Found 1 error (1 fixed, 0 remaining).

$ python up008_super.py
!
</code></pre>
<p><a href="https://play.ruff.rs/fd2bbb26-b678-46aa-9e2f-0d2e76862eb9">True positive example</a> with <code>__class__</code>:</p>
<pre><code class="language-console">$ cat &gt;up008_class.py &lt;&lt;'# EOF'
import builtins
class A:
    def f(self):
        print(&quot;!&quot;)
class B(A):
    def f(self):
        if False: __class__
        builtins.super(B, self).f()
B().f()
# EOF

$ ruff --isolated check up008_class.py --select UP008 --unsafe-fixes --fix
Found 1 error (1 fixed, 0 remaining).

$ python up008_class.py
!
</code></pre>
<h3>Version</h3>
<p>ruff 0.12.3 (5bc81f26c 2025-07-11)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2025-07-15 16:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @ntBre on 2025-07-15 16:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @ntBre on 2025-07-15 16:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IDrokin117">@IDrokin117</a> on 2025-07-17 10:20</div>
            <div class="timeline-body"><p>I am going to work on this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @IDrokin117 by @ntBre on 2025-07-17 13:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/19424.html">astral-sh/ruff#19424</a> on 2025-07-18 15:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/20048.html">astral-sh/ruff#20048</a> on 2025-08-22 17:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-09-09 18:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
