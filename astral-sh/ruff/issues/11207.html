<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff server not closing with neovim instances - astral-sh/ruff #11207</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff server not closing with neovim instances</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/11207">#11207</a>
        opened by <a href="https://github.com/akthe-at">@akthe-at</a>
        on 2024-04-29 19:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/akthe-at">@akthe-at</a></div>
            <div class="timeline-body"><p>Ruff: 0.4.2
OS: Windows 10
Terminal: Wezterm - Latest Nightly
Shell: Powershell Core 7.4.2
Neovim Build - Latest nightly  (and each nightly over the past 3-4 days I&#x27;ve noticed this)</p>
<p>Hello All...I feel like this is going to be kind of a barebones bug report and I am sorry about that.</p>
<p>I have been using the new ruff server in lieu of ruff_lsp with neovim and noticed that there might be an issue with ruff.exe not always being terminated when you close a neovim instance. I have tried to consistently reproduce the bug and I have failed but I noticed that every once in a while I can check my processes and there will be a plethora of ruff.exe running even though I might only have 1 or 2 neovim instances or buffers open.</p>
<p><img src="https://github.com/astral-sh/ruff/assets/105152139/26938a06-3ed6-4f89-bd02-2809088466a9" alt="image"></p>
<p>I don&#x27;t think I ever noticed this during my time using ruff_lsp.</p>
<p>Love what you all do, just wanted to try and keep you aware since ruff server is in alpha.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/snowsignal">@snowsignal</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-29 19:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-04-29 19:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-30 08:13</div>
            <div class="timeline-body"><p>Good catch! Thanks for opening this issue. It&#x27;s happening on macOS as well. And it isn&#x27;t specific to Neovim, I&#x27;m seeing it in VS Code as well.</p>
<p>https://github.com/astral-sh/ruff/assets/67177269/aff1c493-9b22-4168-a332-4a03724ed945</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-04-30 08:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/snowsignal">@snowsignal</a> on 2024-05-03 01:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ShIRannx">@ShIRannx</a> on 2024-05-05 14:08</div>
            <div class="timeline-body"><p>The problem persists in neovim after ruff 0.4.3.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snowsignal">@snowsignal</a> on 2024-05-05 17:09</div>
            <div class="timeline-body"><p>@ShIRannx I&#x27;ve found the cause for that and opened a follow-up fix: <a href="https://github.com/astral-sh/ruff/pull/11291">astral-sh/ruff#11291</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danielhollas">@danielhollas</a> on 2024-05-24 02:16</div>
            <div class="timeline-body"><p>Hi @snowsignal I am still seeing this problem with ruff 0.4.5 and neovim 0.9.5 on Linux Fedora 39.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-05-24 06:39</div>
            <div class="timeline-body"><p>@danielhollas Hi, can you open a new issue with the logs? I tried it on macOS with Ruff 0.4.5 and Nvim 0.10.0 and it works as expected. Can you also try it with Nvim 0.10.0?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danielhollas">@danielhollas</a> on 2024-05-24 11:35</div>
            <div class="timeline-body"><p>Hi @dhruvmanila ðŸ‘‹</p>
<p>happy to do more investigation, but would you mind explaining how to get the logs? (Sorry, I am new to neovim, and LSP in general).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-05-24 14:57</div>
            <div class="timeline-body"><p>No worries. You can find the file path using <code>vim.lsp.get_log_path()</code> function. You can then copy paste the relevant lines (usually would be at the end of the file) related to <code>ruff</code>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:52 UTC
    </footer>
</body>
</html>
