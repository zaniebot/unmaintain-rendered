```yaml
number: 15789
title: "C413 fix is wrong when a newline appears between `sorted` and the opening parenthesis"
type: issue
state: closed
author: dscorbett
labels:
  - bug
  - fixes
assignees: []
created_at: 2025-01-28T16:57:41Z
updated_at: 2025-01-30T13:11:59Z
url: https://github.com/astral-sh/ruff/issues/15789
synced_at: 2026-01-10T01:56:55Z
```

# C413 fix is wrong when a newline appears between `sorted` and the opening parenthesis

---

_Issue opened by @dscorbett on 2025-01-28 16:57_

### Description

The fix for [`unnecessary-call-around-sorted` (C413)](https://docs.astral.sh/ruff/rules/unnecessary-call-around-sorted/) in Ruff 0.9.3 can introduce a syntax error or change behavior when a newline appears between `sorted` and the opening parenthesis.

Syntax error:
```console
$ cat >c413_1.py <<'# EOF'
reversed(sorted
(""))
# EOF

$ ruff --isolated check  --select C413 c413_1.py --unsafe-fixes --fix

error: Fix introduced a syntax error. Reverting all changes.

This indicates a bug in Ruff. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BFix%20error%5D

...quoting the contents of `c413_1.py`, the rule codes C413, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

c413_1.py:1:1: C413 Unnecessary `reversed()` call around `sorted()`
  |
1 | / reversed(sorted
2 | | (""))
  | |_____^ C413
  |
  = help: Remove unnecessary `reversed()` call

Found 1 error.
[*] 1 fixable with the --fix option.
```

Changed behavior:
```console
$ cat >c413_2.py <<'# EOF'
x = list(sorted
("xy"))
print(x)
# EOF

$ python c413_2.py
['x', 'y']

$ ruff --isolated check  --select C413 c413_2.py --unsafe-fixes --fix
Found 1 error (1 fixed, 0 remaining).

$ cat c413_2.py
x = sorted
("xy")
print(x)

$ python c413_2.py
<built-in function sorted>
```

---

_Renamed from "C413 fix is wrong when a newline appears between `sorted` opening parenthesis" to "C413 fix is wrong when a newline appears between `sorted` and the opening parenthesis" by @dscorbett on 2025-01-28 18:22_

---

_Label `bug` added by @dylwil3 on 2025-01-28 19:45_

---

_Label `fixes` added by @dylwil3 on 2025-01-28 19:45_

---

_Assigned to @dylwil3 by @dylwil3 on 2025-01-29 17:28_

---

_Comment by @dylwil3 on 2025-01-29 17:29_

Thanks for this! This seems to keep cropping up... maybe worth adding a general edit for removing a function call so we don't have to rediscover this logic each time.

---

_Referenced in [astral-sh/ruff#15825](../../astral-sh/ruff/pulls/15825.md) on 2025-01-30 05:09_

---

_Closed by @dylwil3 on 2025-01-30 13:10_

---

_Closed by @dylwil3 on 2025-01-30 13:10_

---

_Comment by @dylwil3 on 2025-01-30 13:11_

> This seems to keep cropping up... maybe worth adding a general edit for removing a function call so we don't have to rediscover this logic each time.

Didn't end up doing this since the fix for this rule used codegen while the fix for the other rule I was thinking of used a text-based edit, so the logic was different.

---
