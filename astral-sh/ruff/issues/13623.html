<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add diff aware filtering to `analyze graph` - astral-sh/ruff #13623</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add diff aware filtering to <code>analyze graph</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13623">#13623</a>
        opened by <a href="https://github.com/mjclarke94">@mjclarke94</a>
        on 2024-10-04 10:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mjclarke94">@mjclarke94</a></div>
            <div class="timeline-body"><p>This may be a post-<code>red-knot</code> issue (or even a <code>uv</code> issue), so happy to relocate this as needed.</p>
<p>One of the really powerful features which <code>pants</code> offers is the ability to <a href="https://www.pantsbuild.org/dev/docs/using-pants/advanced-target-selection#running-over-changed-files-with---changed-since">leverage its dependency</a> graph to only run tests/linting on files which are directly or indirectly impacted by changes. The multi-file (and presumably multi-package) analysis of red-knot plus the projects api of <code>uv</code> means that a lot of the components required to support this behaviour are being developed or are in place already.</p>
<p>Copying pants&#x27; api for an example syntax:</p>
<pre><code>ruff analyze graph --changed-since=origin/main --changed-dependents=transitive  .
ruff check --changed-since=HEAD
</code></pre>
<p>Given how fast <code>ruff</code> is, this might seem unnecessary, but the real value here comes from being able to then leverage this using other tools like <code>pytest</code> to only run tests which are impacted by your changes.</p>
<p>Another point I&#x27;d note here is that <code>pants</code> does the dependency graph at the file level, but <code>red-knot</code> could enable this down to the function level to allow even more granular test selection.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-07 08:16</div>
            <div class="timeline-body"><p>This make sense to me but in a wider context. It would be great if any ruff command could only run over changed files. Related to <a href="https://github.com/astral-sh/ruff/issues/1149">astral-sh/ruff#1149</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-07 08:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-07 08:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:58 UTC
    </footer>
</body>
</html>
