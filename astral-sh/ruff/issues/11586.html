<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build error for release profile on `x86_64-pc-windows-gnu` - astral-sh/ruff #11586</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Build error for release profile on `x86_64-pc-windows-gnu`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/11586">#11586</a>
        opened by <a href="https://github.com/T-256">@T-256</a>
        on 2024-05-28 21:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/T-256">@T-256</a> on 2024-05-28 21:23</div>
            <div class="timeline-body"><p>Debug profile, built successfully, but release profile produces errors. here is log file:
<a href="https://github.com/astral-sh/ruff/files/15476110/err.log">err.log</a></p>
<p>abstract:</p>
<pre><code class="language-log">PS E:\crates\ruff&gt; cargo b --release
   Compiling ruff_workspace v0.0.0 (E:\crates\ruff\crates\ruff_workspace)
   Compiling ruff_python_formatter v0.0.0 (E:\crates\ruff\crates\ruff_python_formatter)
   Compiling ruff_server v0.2.2 (E:\crates\ruff\crates\ruff_server)
error: linking with `x86_64-w64-mingw32-gcc` failed: exit code: 1
  |
  = note: &quot;x86_64-w64-mingw32-gcc&quot; &quot;-fno-use-linker-plugin&quot; &quot;-Wl,--dynamicbase&quot; &quot;-Wl,  ...[75 KB more]
  = note: C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.aho_corasick-4fc2a255abd66f6d.aho_corasick.61358d8f59a0b45d-cgu.07.rcgu.o.rcgu.o:aho_corasick.61358:(.text+0x20c3): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.aho_corasick-4fc2a255abd66f6d.aho_corasick.61358d8f59a0b45d-cgu.07.rcgu.o.rcgu.o:aho_corasick.61358:(.text+0x2193): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.aho_corasick-4fc2a255abd66f6d.aho_corasick.61358d8f59a0b45d-cgu.07.rcgu.o.rcgu.o:aho_corasick.61358:(.text+0x228d): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.aho_corasick-4fc2a255abd66f6d.aho_corasick.61358d8f59a0b45d-cgu.07.rcgu.o.rcgu.o:aho_corasick.61358:(.text+0x234e): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.aho_corasick-4fc2a255abd66f6d.aho_corasick.61358d8f59a0b45d-cgu.07.rcgu.o.rcgu.o:aho_corasick.61358:(.text+0x23e2): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.aho_corasick-4fc2a255abd66f6d.aho_corasick.61358d8f59a0b45d-cgu.07.rcgu.o.rcgu.o:aho_corasick.61358:(.text+0x2477): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x7399): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x74a2): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x7593): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x79df): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x7ad3): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x7bd9): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x7f42): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x801f): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x8478): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x889c): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x89ae): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x8ab2): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x90fd): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x9237): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.02.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x9362): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.05.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x32de): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.05.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x33e2): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.regex_automata-8087316b5b78a293.regex_automata.e1978bb43e0f5db-cgu.05.rcgu.o.rcgu.o:regex_automata.e19:(.text+0x3517): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_formatter-d04e736c2481ef8a.ruff_python_formatter.9dee42ec154ec7d4-cgu.08.rcgu.o.rcgu.o:ruff_python_format:(.text+0x3966): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_formatter-d04e736c2481ef8a.ruff_python_formatter.9dee42ec154ec7d4-cgu.12.rcgu.o.rcgu.o:ruff_python_format:(.text+0x4d37): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_formatter-d04e736c2481ef8a.ruff_python_formatter.9dee42ec154ec7d4-cgu.14.rcgu.o.rcgu.o:ruff_python_format:(.text+0x343f): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0xfb72): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x1086a): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x108a3): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x1d2c3): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x1d3dc): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x1dd81): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr10memchr_raw2FN17h618d063ddc5353c7E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x1fabc): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_python_parser-fda4f126870e947c.ruff_python_parser.b89a1574932f071c-cgu.0.rcgu.o.rcgu.o:ruff_python_parser:(.text+0x20b01): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr3_raw2FN17h7a7ed12eca0fefc9E'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_source_file-9e3527bffbe461b0.ruff_source_file.d34ff7af2c172c7c-cgu.01.rcgu.o.rcgu.o:ruff_source_file.d:(.text+0x132): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr12memrchr2_raw2FN17h77df0598d0fcb37bE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.ruff_source_file-9e3527bffbe461b0.ruff_source_file.d34ff7af2c172c7c-cgu.01.rcgu.o.rcgu.o:ruff_source_file.d:(.text+0x242): undefined reference to `__imp__ZN6memchr4arch6x86_646memchr11memchr2_raw2FN17hda836e9b9f82e15cE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.tracing-a3877614066def19.tracing.5441c59aa9d48259-cgu.01.rcgu.o.rcgu.o:tracing.5441c59aa9:(.text+0x85): undefined reference to `__imp__ZN12tracing_core10dispatcher15GLOBAL_DISPATCH17h1c5a9e6d56948a0dE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.tracing-a3877614066def19.tracing.5441c59aa9d48259-cgu.01.rcgu.o.rcgu.o:tracing.5441c59aa9:(.text+0xa1): undefined reference to `__imp__ZN12tracing_core10dispatcher15GLOBAL_DISPATCH17h1c5a9e6d56948a0dE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.tracing-a3877614066def19.tracing.5441c59aa9d48259-cgu.01.rcgu.o.rcgu.o:tracing.5441c59aa9:(.text+0x279): undefined reference to `__imp__ZN12tracing_core10dispatcher15GLOBAL_DISPATCH17h1c5a9e6d56948a0dE'
          C:/msys2/ucrt64/bin/../lib/gcc/x86_64-w64-mingw32/13.2.0/../../../../x86_64-w64-mingw32/bin/ld.exe: E:\crates\ruff\target\release\deps\ruff_python_formatter-a6d455985f2903e7.tracing-a3877614066def19.tracing.5441c59aa9d48259-cgu.01.rcgu.o.rcgu.o:tracing.5441c59aa9:(.text+0x2a7): undefined reference to `__imp__ZN12tracing_core10dispatcher15GLOBAL_DISPATCH17h1c5a9e6d56948a0dE'
          collect2.exe: error: ld returned 1 exit status

  = note: some `extern` functions couldn't be found; some native libraries may need to be installed or have their path specified
  = note: use the `-l` flag to specify native libraries to link
  = note: use the `cargo:rustc-link-lib` directive to specify the native libraries to link with Cargo (see https://doc.rust-lang.org/cargo/reference/build-scripts.html#rustc-link-lib)

error: could not compile `ruff_python_formatter` (bin &quot;ruff_python_formatter&quot;) due to 1 previous error
warning: build failed, waiting for other jobs to finish...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @MichaReiser on 2024-05-29 08:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-29 09:19</div>
            <div class="timeline-body"><p>Hmm, I spend some time looking into this but I'm unsure what's happening.</p>
<p>I'm successfully able to build ripgrep and romejs with the <code>x86_64-pc-windows-gnu</code> target but not ruff...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-29 10:39</div>
            <div class="timeline-body"><p>Okay, I'm able to build ruff after I disabled link time optimizations (setting <code>lto=false</code> in <code>Cargo.toml</code>). The build even succeeds when I set <code>lto=&quot;fat&quot;</code>.</p>
<p>I'm still unable to reproduce this with ripgrep. Setting <code>lto</code> to <code>flat</code> doesn't trigger the issue.</p>
<p>This makes me wonder if, by chance, this is a linker issue. @BurntSushi any guesses?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2024-05-29 10:39</div>
            <div class="timeline-body"><p>Reproduced same on GHA:
https://github.com/T-256/ruff/actions/runs/9284396370/job/25546692607</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2024-05-29 11:47</div>
            <div class="timeline-body"><p>Regressed by https://github.com/astral-sh/ruff/pull/9031 and related to https://github.com/astral-sh/ruff/issues/9245.</p>
<p>Workaround:</p>
<blockquote>
<p>Since <a href="https://github.com/rust-lang/cargo/issues/4897">per-target profiles</a> aren't really a thing, I was able to get around this issue by setting the environment variable <code>CARGO_PROFILE_RELEASE_LTO</code> to <code>false</code>. This'll work for me for now until https://github.com/rust-lang/rust/issues/109797 is fixed.</p>
</blockquote>
<p><em>Originally posted by @cr1901 in https://github.com/astral-sh/ruff/issues/9245#issuecomment-1950273225</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @T-256 on 2024-05-29 11:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-05-29 11:51</div>
            <div class="timeline-body"><p>@T-256 nice for finding these details. I guess a work around on our side could be to set LTO to &quot;fat&quot; or disable it for this specific target (I think that's possible?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @MichaReiser on 2024-05-29 11:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-05-29 11:55</div>
            <div class="timeline-body"><p>Yeah the specific bug is related to something about inlining functions with statics: https://github.com/rust-lang/rust/issues/109797</p>
<p>And see also: https://github.com/BurntSushi/memchr/issues/145</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mati865">@mati865</a> on 2024-06-05 17:35</div>
            <div class="timeline-body"><p>Another workaround is to link with LLD instead of default ld.bfd, that way you can still use ThinLTO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2024-06-05 21:39</div>
            <div class="timeline-body"><p>@mati865 I tested with</p>
<pre><code class="language-toml">[target.x86_64-pc-windows-gnu]
linker = &quot;rust-lld&quot;
</code></pre>
<p>but I got errors even on <code>lto=off</code>:</p>
<pre><code>                                                                         
error: linking with `rust-lld` failed: exit code: 1                                                                                  
  |
  = note: &quot;rust-lld&quot; &quot;-flavor&quot; &quot;gnu&quot; &quot;C:\\WINDOWS\\TEMP\\rustcxO6dBX\\list.def&quot; &quot;--dynamicbase&quot; &quot;--disable-auto-image-base&quot; &quot;-m&quot; &quot;i386pep&quot; &quot;--high-entropy-va&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\self-contained\\dllcrt2.o&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\rsbegin.o&quot; &quot;C:\\WINDOWS\\TEMP\\rustcxO6dBX\\symbols.o&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\vte_generate_state_changes-c8349d2f6a9946a9.vte_generate_state_changes.57057eadc13a9b41-cgu.0.rcgu.o&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\vte_generate_state_changes-c8349d2f6a9946a9.2543lwsoi1zanot8.rcgu.rmeta&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\vte_generate_state_changes-c8349d2f6a9946a9.1019vx92ivbei8xv.rcgu.o&quot; &quot;-L&quot; &quot;E:\\crates\\ruff\\target\\release\\deps&quot; &quot;-L&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib&quot; &quot;-Bstatic&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\libquote-8bf022faaf31a1a6.rlib&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\libproc_macro2-41e5a393ded84c34.rlib&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\libunicode_ident-84d1a3a2a096a72b.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libproc_macro-77e81e580912ada4.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libstd-a1f74822451877d1.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libpanic_unwind-17d59fcffbb1858c.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libobject-bbbe10091d0fd58d.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libmemchr-ff20eb48d2567174.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libaddr2line-030e3ef637a6c0e1.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libgimli-53e82cde34eb1119.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\librustc_demangle-8a1d947ff4a075c3.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libstd_detect-a6a7bc9844ea0859.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libhashbrown-a963c0ad0363ef1a.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\librustc_std_workspace_alloc-1bc86c6d4a47ec27.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libminiz_oxide-57b7601d31d3fe19.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libadler-5ea4baaad4eac651.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libunwind-504a546f931d1b95.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libcfg_if-c18dc5b831cc4c35.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\liblibc-3a48b664c1fa889c.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\liballoc-2552a9f38657c70e.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\librustc_std_workspace_core-dab1b9a2489b7d16.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libcore-d7fd3f351d39ae46.rlib&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\libcompiler_builtins-b44a9797859024b2.rlib&quot; &quot;-Bdynamic&quot; &quot;-lkernel32&quot; &quot;-ladvapi32&quot; &quot;-lkernel32&quot; &quot;-lntdll&quot; &quot;-luserenv&quot; &quot;-lws2_32&quot; &quot;-lkernel32&quot; &quot;-lws2_32&quot; &quot;-lkernel32&quot; &quot;-lgcc_eh&quot; &quot;-l:libpthread.a&quot; &quot;-lmsvcrt&quot; &quot;-lmingwex&quot; &quot;-lmingw32&quot; &quot;-lgcc&quot; &quot;-lmsvcrt&quot; &quot;-luser32&quot; &quot;-lkernel32&quot; &quot;--nxcompat&quot; &quot;-L&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib&quot; &quot;-L&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\self-contained&quot; &quot;-o&quot; &quot;E:\\crates\\ruff\\target\\release\\deps\\vte_generate_state_changes-c8349d2f6a9946a9.dll&quot; &quot;--gc-sections&quot; &quot;-shared&quot; &quot;--out-implib=E:\\crates\\ruff\\target\\release\\deps\\libvte_generate_state_changes-c8349d2f6a9946a9.dll.a&quot; &quot;--strip-debug&quot; &quot;C:\\Users\\Tester\\.rustup\\toolchains\\1.78-x86_64-pc-windows-gnu\\lib\\rustlib\\x86_64-pc-windows-gnu\\lib\\rsend.o&quot;     
  = note: rust-lld: error: &lt;root&gt;: undefined symbol: _DllMainCRTStartup
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mati865">@mati865</a> on 2024-06-05 22:08</div>
            <div class="timeline-body"><p>@T-256 you cannot use LLD like that for Unix and windows-gnu targets, it has to be called through the compiler to add the libraries.
With stable Rust you can use LLD from your PATH with <code>-Clink-arg=-fuse-ld=lld</code> or <code>rust-lld</code> provided by Rust using nightly <code>-Zlinker-features=+lld</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2025-02-21 11:50</div>
            <div class="timeline-body"><p>Upstream issue has been closed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @T-256 on 2025-02-21 11:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
