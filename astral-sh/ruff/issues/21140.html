<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Process larger files first - astral-sh/ruff #21140</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Process larger files first</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/21140">#21140</a>
        opened by <a href="https://github.com/adamchainz">@adamchainz</a>
        on 2025-10-30 14:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/adamchainz">@adamchainz</a> on 2025-10-30 14:35</div>
            <div class="timeline-body"><p>https://github.com/psf/black/issues/4771 describes ~20% speedup ofr Black by processing larger files first, so parallel workers pack the work better. After a quick look at Ruff, it seems that the same could work here, for example by sorting by size, descending, before <code>par_iter()</code> in <code>commands/check.rs</code>:</p>
<p>https://github.com/astral-sh/ruff/blob/1b0ee4677e216562033f8a2f9b006738734cb2b9/crates/ruff/src/commands/check.rs#L69</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-30 15:08</div>
            <div class="timeline-body"><p>Ha, I was watching Anthony's video on this last night! We haven't actually read the files yet at this point in the code, so it could be slightly involved to implement this, but it could still be worth looking into.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">performance</span> added by @ntBre on 2025-10-30 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-30 15:12</div>
            <div class="timeline-body"><p>This seems tricky because the file might also be cached, in which case checking it is literally free.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
