<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E501 error with strings that contains unicode - astral-sh/ruff #1123</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>E501 error with strings that contains unicode</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/1123">#1123</a>
        opened by <a href="https://github.com/keul">@keul</a>
        on 2022-12-07 15:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/keul">@keul</a> on 2022-12-07 15:14</div>
            <div class="timeline-body"><p>Non sure if this an issue or a &quot;by design&quot; behaviour: I get a</p>
<pre><code>226:1: E501 Line too long (105 &gt; 100 characters)
</code></pre>
<p>The line itself is less than 100 chars long (my custom <code>line-length</code> in .toml), but I have a string with emoji chars there:</p>
<pre><code class="language-python">                f&quot;⚠️ ⚠️ ⚠️ - There are…&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-07 15:15</div>
            <div class="timeline-body"><p>Would you mind posting the full line?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2022-12-07 15:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/keul">@keul</a> on 2022-12-07 15:37</div>
            <div class="timeline-body"><p>This is another example, but I post these just for reference. Looking at this gain: it seems is not a ruff issue. I didn't noticed that also VsCode count these chars a 2.</p>
<p>For reference:</p>
<pre><code class="language-python">        click.echo(
            Back.YELLOW
            + Fore.BLACK
            + (
                f&quot;⚠️ ⚠️ ⚠️ - There are {len(warn_lines)} lines with warnings. Please check them. ⚠️ ⚠️ ⚠️ &quot;
            )
            + Style.RESET_ALL
        )
</code></pre>
<p>I get:</p>
<pre><code>E501 Line too long (107 &gt; 100 characters)
</code></pre>
<p>Sorry for the noise!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @keul on 2022-12-07 15:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-07 15:39</div>
            <div class="timeline-body"><p>No prob! Yeah Unicode characters are tricky. We do count &quot;characters&quot; and not bytes explicitly (via the Rust standard library), but it's not always intuitive, I think...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lengau">@lengau</a> on 2022-12-16 00:29</div>
            <div class="timeline-body"><p>Sorry to necro a week-old thread but I'm a big unicode nerd who happened upon this thread during an unrelated search about E501. I'm adding this purely for the sake of nerdy interest.</p>
<p><code>⚠️</code> is actually two unicode codepoints. Specifically, it's code point <a href="https://util.unicode.org/UnicodeJsps/character.jsp?a=26A0">26A0</a> for the warning sign and code point <a href="https://util.unicode.org/UnicodeJsps/character.jsp?a=FE0F">FE0F</a>, variation selector.</p>
<p>Codepoint 26A0 on its own is <code>⚠</code>, which looks the same but without the pretty colours of an emoji that the variation selector provides. Or, from a Python terminal:</p>
<pre><code>&gt;&gt;&gt; len('⚠️')
2
&gt;&gt;&gt; len('⚠')
1
</code></pre>
<p>Just to add to the confusion, in UTF-8, ⚠️ is actually 6 bytes long. (Each codepoint is 3 bytes).</p>
<p>I suppose one <em>could</em> argue that what we care about here is the number of <a href="https://en.wikipedia.org/wiki/Grapheme">graphemes</a> rather than bytes or code points, and the <a href="https://crates.io/crates/unicode-segmentation">unicode-segmentation</a> crate can count graphemes, but that's not without its own costs (mostly performance, but also potentially its own &quot;huh?&quot; moments since the way it's currently counted aligns with Python's <code>len</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-16 00:32</div>
            <div class="timeline-body"><p>Always appreciate a clarification from someone who knows way more than me about a topic like this :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/keul">@keul</a> on 2022-12-16 07:43</div>
            <div class="timeline-body"><p>@lengau thanks for the spelunking! This is probably why my terminal has some issues rendering the ⚠️ (I've to separate multiple ones with a blank space) while ⚠ is OK!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:07 UTC
    </footer>
</body>
</html>
