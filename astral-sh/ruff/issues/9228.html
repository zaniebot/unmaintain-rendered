<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D406 inconsistent behaviour - astral-sh/ruff #9228</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>D406 inconsistent behaviour</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9228">#9228</a>
        opened by <a href="https://github.com/chaitanya2692">@chaitanya2692</a>
        on 2023-12-21 10:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chaitanya2692">@chaitanya2692</a></div>
            <div class="timeline-body"><p>I am running ruff on the following example code</p>
<pre><code>&quot;&quot;&quot;Toy Example.&quot;&quot;&quot;
import json
from pathlib import Path


class MyClass:
    &quot;&quot;&quot;Toy Class.&quot;&quot;&quot;

    def __init__(self):
        &quot;&quot;&quot;Initialize an instance of the class.&quot;&quot;&quot;

    def get_values(self):
        &quot;&quot;&quot;Get info on person.

        Returns:
        -------
            Dictionary of results
        &quot;&quot;&quot;
        return {
            &quot;name&quot;: &quot;John Doe&quot;,
            &quot;age&quot;: 30,
        }


def json_output(my_file: str):
    &quot;&quot;&quot;Read target json file.

    Args:
    ----
        my_file: path to target json file

    Raises:
    ------
        Exception: if json file could not be found.

    Returns:
    -------
        The content of json.
    &quot;&quot;&quot;
    json_file = &quot;my_file.json&quot;

    if not Path(json_file).is_file():
        raise Exception(f&quot;Could not find json file: {json_file}&quot;)

    print(&quot;Json file found:&quot;, json_file)
    with open(json_file, &quot;r&quot;) as file:
        return json.load(file)

</code></pre>
<p>The output of the linter is as below
<code>test.py:13:9: D406 [*] Section name should end with a newline (&quot;Returns&quot;)</code></p>
<p>If there's a fault, why is only one of the return statements flagged here?</p>
<p>The command I use is <code>ruff check --preview --config ci/dockerfiles/linting/ruff.toml test.py</code></p>
<p>Here's my current ruff.toml:</p>
<pre><code>line-length = 88

[lint]
preview = true
ignore = [&quot;E203&quot;,&quot;E231&quot;]
select = [  # https://docs.astral.sh/ruff/rules
    &quot;B&quot;,   # flake8-bugbear
    &quot;D&quot;,   # pydocstyle
    &quot;ERA&quot;, # eradicate
    &quot;PT&quot;,  # flake8-pytest-style
    &quot;RET&quot;, # flake8-return
    &quot;A&quot;,   # flake8_builtins
    &quot;I&quot;,   # isort
    &quot;C90&quot;, # mccabe
    &quot;N&quot;,   # pep8-naming
    &quot;E&quot;,   # pycodestyle
    &quot;W&quot;,   # pycodestyle
    &quot;F&quot;,   # pyflakes
    # No replacement for flake8-darglint yet
]

[mccabe]
max-complexity = 10
</code></pre>
<p>My current ruff version is <code>0.1.7</code>. <code>0.1.8</code> seems to have the same error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-21 20:01</div>
            <div class="timeline-body"><p>This is just a confusing thing that comes from not setting a <code>pydocstyle.convention</code> (https://docs.astral.sh/ruff/settings/#pydocstyle-convention)... Basically, we don't respect arbitrary section headers -- they need to match either the list of valid Google or NumPy section headers. And if you don't set a convention, then we try to infer from the existing headers. In the first docstring, we infer NumPy, because we can't differentiate it -- and that leads us to look at <code>Returns:</code>, and flag it. (You can fix this error by removing the colon, by the way.)</p>
<p>In the second docstring, we see <code>Args</code>, which is <em>not</em> a valid NumPy header. It only exists in the Google convention. (In NumPy, it's <code>Parameters</code>.) So we treat that docstring as a Google docstring, in which case, you're allowed to end the line with a colon.</p>
<p>I'd recommend setting a convention for more consistent behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-12-21 20:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">docstring</span> added by @charliermarsh on 2023-12-21 20:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-09 03:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:19 UTC
    </footer>
</body>
</html>
