<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannot set config option with struct type from command-line - astral-sh/ruff #13995</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cannot set config option with struct type from command-line</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/13995">#13995</a>
        opened by <a href="https://github.com/LordAro">@LordAro</a>
        on 2024-10-30 12:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/LordAro">@LordAro</a> on 2024-10-30 12:20</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>While trying out some adhoc testing, I ran the following:</p>
<pre><code>ruff check --extend-select=PT --config 'lint.flake8-pytest-style=&quot;csv&quot;'
</code></pre>
<p>which resulted in the error:</p>
<pre><code>error: invalid value 'lint.flake8-pytest-style=&quot;csv&quot;' for '--config &lt;CONFIG_OPTION&gt;'

  tip: A `--config` flag must either be a path to a `.toml` configuration file
       or a TOML `&lt;KEY&gt; = &lt;VALUE&gt;` pair overriding a specific configuration
       option

Could not parse the supplied argument as a `ruff.toml` configuration option:

invalid type: string &quot;csv&quot;, expected struct Flake8PytestStyleOptions
in `lint`

For more information, try '--help'
</code></pre>
<p>according to the tip (and the help text) it <em>should</em> work, but... doesn't. I'm not sure if there is a format where it does work, but if nothing else it's unclear.</p>
<p>I can imagine this applies to other options that use this form, but this is the only one I've found.</p>
<p>Ruff: 0.7.1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-30 12:40</div>
            <div class="timeline-body"><p>I think  you're missing the last name of the setting: <code>lint</code> and <code>flake8-pytest-style</code> are only the setting group:</p>
<pre><code>ruff check --extend-select=PT --config lint.flake8-pytest-style.parametrize-names-type=&quot;csv&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2024-10-30 12:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-30 12:44</div>
            <div class="timeline-body"><p>Okay, it's slightly more complicated because the value must be a string but this should work</p>
<pre><code class="language-bash">ruff check --extend-select=PT --config &quot;lint.flake8-pytest-style.parametrize-names-type='csv'&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LordAro">@LordAro</a> on 2024-10-30 14:29</div>
            <div class="timeline-body"><p>Oh you're quite right, I'm a fool and managed to only copy the section name rather than the rule itself.</p>
<p>Not that I want to be that guy, but maybe the error message could be improved somehow? Mentioning a struct seems unhelpful...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-30 15:02</div>
            <div class="timeline-body"><blockquote>
<p>Not that I want to be that guy, but maybe the error message could be improved somehow? Mentioning a struct seems unhelpful...</p>
</blockquote>
<p>That makes a lot of sense to me. I also had to play with the CLI to determine the right syntax (see my first answer). I'm not sure how much we can do about the struct part without writing our own deserialization framework but we should take a look if there are any low hanging improvements</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2024-10-30 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @MichaReiser on 2024-10-30 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @MichaReiser on 2024-10-30 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/15266.html">astral-sh/ruff#15266</a> on 2025-01-05 08:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-01-06 13:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:53 UTC
    </footer>
</body>
</html>
