<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is there a `noqa` equivalent for do not fix - astral-sh/ruff #3308</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Is there a `noqa` equivalent for do not fix</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/3308">#3308</a>
        opened by <a href="https://github.com/paddyroddy">@paddyroddy</a>
        on 2023-03-02 14:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 14:50</div>
            <div class="timeline-body"><p>Unfortunately for <code>pydantic</code> you can't use the new union syntax <code>X | Y</code> for models and so you have to change it to i.e. <code>Union[X, Y]</code> or <code>Optional[X]</code> (depending on use case) if using <code>python</code> &lt; <code>3.10</code> pydantic/pydantic#2609.</p>
<p>For now I've got around it by doing, i.e.</p>
<pre><code class="language-toml">[tool.ruff]
fix = true
select = [
    &quot;UP&quot;,
]
per-file-ignores = {&quot;btrack/models.py&quot; = [
    &quot;UP006&quot;,
    &quot;UP007&quot;,
], &quot;btrack/config.py&quot; = [
    &quot;UP006&quot;,
    &quot;UP007&quot;,
]}
</code></pre>
<p>However, this would mean if there are cases of <code>X | Y</code> or <code>list[Z]</code> for example outside of <code>pydantic</code> then they won't be fixed. Is there a way of doing, i.e. <code># nofix: UP006,UP007</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/calumy">@calumy</a> on 2023-03-02 14:53</div>
            <div class="timeline-body"><p>Setting a target version below 3.10 might be what you are looking for: https://beta.ruff.rs/docs/settings/#target-version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 14:58</div>
            <div class="timeline-body"><p>But we are also supporting <code>3.10</code>, i.e. <code>3.8&lt;= x &lt;= 3.10</code> at the moment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-02 14:58</div>
            <div class="timeline-body"><p>@paddyroddy - Hmm, you can turn off autofix for select rules like:</p>
<pre><code class="language-py">unfixable = [
  &quot;UP006&quot;,
  &quot;UP007&quot;,
]
</code></pre>
<p>But that won't activate on a per-file or per-case basis -- it'll tell Ruff to still flag those errors, but not fix them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 15:00</div>
            <div class="timeline-body"><p>I guess <code>target-version</code> may be the easiest but not the most satisfying IMO as another thing to remember when, for example, dropping <code>3.8</code> support. But thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 15:08</div>
            <div class="timeline-body"><p>I'm not sure <code>target-version</code> works this way? I changed it to the following, but my code is still full of, e.g. <code>|</code> typings.</p>
<pre><code>[tool.ruff]
fix = true
select = [
    &quot;UP&quot;,
]
target-version = &quot;py38&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 15:19</div>
            <div class="timeline-body"><p>Seems like <code>target-version</code> may have worked, but the problem is I've already upgraded without that flag. So the solution doesn't work well for me, as I'd have to manually downgrade throughout.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-02 15:21</div>
            <div class="timeline-body"><p>Can you revert your change, then re-run Ruff? Ruff won't actively &quot;downgrade&quot; the code if those changes have already been applied.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 15:25</div>
            <div class="timeline-body"><p>Yes but I've made a fair few manual changes since so a bit hesitant</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-02 22:06</div>
            <div class="timeline-body"><p>What's the advantage of <code># nofix: UP006,UP007</code> over <code># noqa: UP006,UP007</code>? Would the former <em>not</em> ignore the violation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-03-02 22:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paddyroddy">@paddyroddy</a> on 2023-03-02 22:15</div>
            <div class="timeline-body"><p>Not sure what happened there. <code>noqa</code> actually does the right thing - i.e. to not format it. I'm sure when playing around, it was doing something else, or I messed up.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @paddyroddy on 2023-03-02 22:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-02 22:19</div>
            <div class="timeline-body"><p>Oh no prob! Maybe it expected it on a different line than you tried initially or something.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:08 UTC
    </footer>
</body>
</html>
