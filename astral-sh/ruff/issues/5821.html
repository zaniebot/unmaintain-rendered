<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter: stub files only have one empty lines between top level items - astral-sh/ruff #5821</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Formatter: stub files only have one empty lines between top level items</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/5821">#5821</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2023-07-17 06:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/konstin">@konstin</a> on 2023-07-17 06:47</div>
            <div class="timeline-body"><p>Black only formats one empty line between top level items in stub files (.pyi), while it uses two empty lines in regular python files. When single line classes, method and functions of the same kind that are stubbed out with ellipses follow each they don't get any empty lines.</p>
<p><strong>scratch.py</strong></p>
<pre><code class="language-python">class A:
    def __init__(self):
        pass


class B:
    def __init__(self):
        pass


def foo():
    pass


class Del(expr_context):
    ...


class Load(expr_context):
    ...


class Store(expr_context):
    ...
</code></pre>
<p><strong>scratch.pyi</strong></p>
<pre><code class="language-python">class A:
    def __init__(self):
        pass

class B:
    def __init__(self):
        pass

def foo():
    pass

class Del(expr_context): ...
class Load(expr_context): ...
class Store(expr_context): ...
</code></pre>
<p>The relevant code is below, which doesn't have access to whether it's in a stub file or not yet.</p>
<p>https://github.com/astral-sh/ruff/blob/f5f8eb31ed94ee99ce02f7113a5253d1bdb27a69/crates/ruff_python_formatter/src/statement/suite.rs#L72</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @konstin on 2023-07-17 06:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-07-17 07:34</div>
            <div class="timeline-body"><p>Note: This requires knowing the file type during formatting by passing it to the format context.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Stable" by @MichaReiser on 2023-07-31 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @konstin on 2023-08-10 08:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @konstin on 2023-08-10 08:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-08-10 08:45</div>
            <div class="timeline-body"><p><code>PyFormatOptions</code> now has a <code>source_type</code> field</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-08-15 07:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Formatter: Stable" by @MichaReiser on 2023-08-22 14:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Alpha" by @MichaReiser on 2023-08-22 14:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:30:43 UTC
    </footer>
</body>
</html>
