<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>formatter deviation: line break not occurring on assignments where LHS goes over line-length - astral-sh/ruff #11820</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>formatter deviation: line break not occurring on assignments where LHS goes over line-length</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/11820">#11820</a>
        opened by <a href="https://github.com/jonathan-hill-visasq">@jonathan-hill-visasq</a>
        on 2024-06-10 05:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jonathan-hill-visasq">@jonathan-hill-visasq</a> on 2024-06-10 05:33</div>
            <div class="timeline-body"><p>I'm seeing a case where black is expanding an assignment but ruff is not - even re-writing the black formatted result.</p>
<p>To keep it concise, this example uses an ultra-short line-length of 14:</p>
<p>Input</p>
<pre><code>long_variable_name = 1234
</code></pre>
<p>Black:</p>
<pre><code>long_variable_name = (
    1234
)
</code></pre>
<p>Ruff:</p>
<pre><code>long_variable_name = 1234

</code></pre>
<p>This seems to occur only when the name of the variable assigned to, is longer than line-length (so expanding the line won't bring it within the allowed length).</p>
<p>I can't find this in the documented deviations or other issues at present, and this doesn't seem to be a duplicate of another issue.</p>
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2024-06-10 08:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-10 08:18</div>
            <div class="timeline-body"><p>I think this is related to https://github.com/astral-sh/ruff/pull/8940</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2024-06-10 08:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-06-10 08:23</div>
            <div class="timeline-body"><p>Yes, I can confirm that #8940 would fix the deviation. The problem is, that the PR has a few regressions around call expression formatting, which is why the PR was abandoned. So fixing this requires some more work and is also something that I don't think we can fix outside of a new formatter style guide as it would change how already formatted code gets formatted.</p>
<p>But we should have a second look at this when we work on the next formatter style guide to see if we can match Black more closely.</p>
<p>The main issue here is that Ruff doesn't parenthesize the expression if the <code>(</code> doesn't fit inside the line length, whereas Black only avoids the parentheses if the content doesn't fit into the line length.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @MichaReiser on 2024-06-10 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13371.html">astral-sh/ruff#13371</a> on 2024-09-16 16:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/14025.html">astral-sh/ruff#14025</a> on 2024-10-31 20:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/20482.html">astral-sh/ruff#20482</a> on 2025-09-19 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/20794.html">astral-sh/ruff#20794</a> on 2025-10-13 18:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:13 UTC
    </footer>
</body>
</html>
