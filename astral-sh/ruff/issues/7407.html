<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter causes E501 for long variable and attributes - astral-sh/ruff #7407</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Formatter causes E501 for long variable and attributes</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/7407">#7407</a>
        opened by <a href="https://github.com/aaravind100">@aaravind100</a>
        on 2023-09-15 10:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/aaravind100">@aaravind100</a> on 2023-09-15 10:30</div>
            <div class="timeline-body"><p>I'm testing the format option. Found that formatting scripts with long variables and attributes which are indented cases E501.</p>
<p>ruff check, would raise <code>11:89: E501 Line too long (92 &gt; 88 characters)</code> for this snippet.</p>
<ul>
<li>formatted with black</li>
</ul>
<pre><code class="language-py">class Foo:
    some_very_long_attribute_name: str = &quot;&quot;

    def __getitem__(self, val):
        ...


def main() -&gt; None:
    if True:
        some_very_long_variable_name_abcdefghijk = Foo()
        some_very_long_variable_name_abcdefghijk = (
            some_very_long_variable_name_abcdefghijk[
                some_very_long_variable_name_abcdefghijk.some_very_long_attribute_name
                == &quot;This is a very long string abcdefghijk&quot;
            ]
        )


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<ul>
<li>formatted with ruff</li>
</ul>
<pre><code class="language-py">class Foo:
    some_very_long_attribute_name: str = &quot;&quot;

    def __getitem__(self, val):
        ...


def main() -&gt; None:
    if True:
        some_very_long_variable_name_abcdefghijk = Foo()
        some_very_long_variable_name_abcdefghijk = some_very_long_variable_name_abcdefghijk[
            some_very_long_variable_name_abcdefghijk.some_very_long_attribute_name
            == &quot;This is a very long string abcdefghijk&quot;
        ]


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<ul>
<li>pyproject.toml</li>
</ul>
<pre><code class="language-toml">[tool.ruff]
target-version = &quot;py39&quot;
line-length = 88
select = [&quot;B&quot;, &quot;C&quot;, &quot;E&quot;, &quot;F&quot;, &quot;I&quot;, &quot;W&quot;]
ignore = [&quot;E731&quot;]

[tool.black]
line-length = 88
target-version = [&quot;py39&quot;]
</code></pre>
<ul>
<li><p>version
<code>Python 3.9.5</code>
<code>ruff 0.0.289</code>
<code>OS Ubuntu 22.04.3 LTS(WSL)</code></p>
</li>
<li><p>Additional info
In the original script the class Foo is a pandas dataframe and this pattern is quite common.</p>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Formatter causes E501for long variable and attributes" to "Formatter causes E501 for long variable and attributes" by @aaravind100 on 2023-09-15 10:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @MichaReiser on 2023-09-15 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-15 13:19</div>
            <div class="timeline-body"><p>Thanks @aaravind100 for reporting this incompatibility. Our recommendation on <code>E501</code> is to not use it in combination with a formatter and we plan to update our documentation accordingly. What's your use case for using <code>E501</code> with the formatter? Or did you run into it because <code>E501</code> is part of the default rule set?</p>
<p>Edit: What I find interesting is that Ruff formats the example differently than black.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aaravind100">@aaravind100</a> on 2023-09-15 13:52</div>
            <div class="timeline-body"><p>Hey @MichaReiser, &quot;E&quot; is selected along with line-length 88, wouldn't that mean E501 would also be checked?
This is a repo I inherited at work, and line length was always enforced to 88 to prevent longs lines in the pr which makes it difficult to review it.</p>
<p>Do you have a recommendation?</p>
<blockquote>
<p>Edit: What I find interesting is that Ruff formats the example differently than black.</p>
</blockquote>
<p>Yes this is curious, this is what prompted me to create this issue. ruff formats it in a way and complains about it :smile:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/7409.html">astral-sh/ruff#7409</a> on 2023-09-15 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vastbluesky">@vastbluesky</a> on 2023-09-15 19:05</div>
            <div class="timeline-body"><blockquote>
<p>What's your use case for using <code>E501</code> with the formatter?</p>
</blockquote>
<p>Speaking for myself, I would think the use case is for identifying long lines that the formatter doesn't or can't fix, and which therefore require manual intervention, like splitting a long string across multiple lines or even shortening a long variable name.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-09-16 14:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-16 14:32</div>
            <div class="timeline-body"><blockquote>
<p>Speaking for myself, I would think the use case is for identifying long lines that the formatter doesn't or can't fix, and which therefore require manual intervention, like splitting a long string across multiple lines or even shortening a long variable name.</p>
</blockquote>
<p>That sounds reasonable and is how we want to document the &quot;incompatibility&quot;. What we can't guarantee is that the formatter never produces code that conflicts with E501 (e.g. the formatter doesn't break overlong comments).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Beta" by @MichaReiser on 2023-09-25 09:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:10 UTC
    </footer>
</body>
</html>
