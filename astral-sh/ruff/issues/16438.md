```yaml
number: 16438
title: "SIM115 should exempt `unittest.TestCase.enterContext()` and `enterClassContext()`"
type: issue
state: closed
author: adamchainz
labels:
  - bug
  - accepted
assignees: []
created_at: 2025-02-28T11:31:07Z
updated_at: 2025-02-28T16:29:51Z
url: https://github.com/astral-sh/ruff/issues/16438
synced_at: 2026-01-10T01:56:55Z
```

# SIM115 should exempt `unittest.TestCase.enterContext()` and `enterClassContext()`

---

_Issue opened by @adamchainz on 2025-02-28 11:31_

### Summary

Like #1945, rule [open-file-with-context-handler (SIM115)](https://docs.astral.sh/ruff/rules/open-file-with-context-handler/#open-file-with-context-handler-sim115) should exempt context managers passed to the [`TestCase.enterContext()`](https://docs.python.org/3.13/library/unittest.html#unittest.TestCase.enterContext) and `enterClassContext()` methods. These methods methods act like `with`, so thereâ€™s no concern around the file not being closed.

Currently, an error is triggered for this code:

```pythonfrom unittest import TestCase


class ExampleTests(TestCase):
    def setUp(self):
        self.example_csv = self.enterContext(open("example.csv"))
```

Output:

```
example.py:6:46: SIM115 Use a context manager for opening files
  |
4 | class ExampleTests(TestCase):
5 |     def setUp(self):
6 |         self.example_csv = self.enterContext(open("example.csv"))
  |                                              ^^^^ SIM115
  |

Found 1 error.
```

### Version

0.9.7

---

_Referenced in [astral-sh/ruff#16439](../../astral-sh/ruff/pulls/16439.md) on 2025-02-28 11:59_

---

_Label `bug` added by @AlexWaygood on 2025-02-28 14:27_

---

_Label `accepted` added by @AlexWaygood on 2025-02-28 14:27_

---

_Closed by @AlexWaygood on 2025-02-28 16:29_

---
