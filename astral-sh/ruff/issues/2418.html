<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `flake8-cognitive-complexity` - astral-sh/ruff #2418</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>flake8-cognitive-complexity</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2418">#2418</a>
        opened by <a href="https://github.com/ngnpope">@ngnpope</a>
        on 2023-01-31 21:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ngnpope">@ngnpope</a></div>
            <div class="timeline-body"><p><a href="https://github.com/Melevir/flake8-cognitive-complexity">GitHub</a>, <a href="https://pypi.org/project/flake8-cognitive-complexity/">PyPI</a>.</p>
<ul>
<li>[ ] <a href=""><code>CCR001</code></a>: Cognitive complexity is too high (X &gt; Y)</li>
</ul>
<p>Configuration options: <code>max-cognitive-complexity</code></p>
<p>This plugin is focused on <a href="https://docs.codeclimate.com/docs/cognitive-complexity">cognitive complexity</a> vs <a href="https://docs.codeclimate.com/docs/cyclomatic-complexity">cyclomatic complexity</a> which we have via <code>mccabe</code>. Apparently this is the algorithm used by SonarSource, CodeClimate, etc. according to the README. See <a href="https://github.com/Melevir/cognitive_complexity/blob/master/README.md#what-is-cognitive-complexity">here</a> for more details.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">plugin</span> added by @charliermarsh on 2023-01-31 23:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbrugman">@sbrugman</a> on 2023-02-01 11:56</div>
            <div class="timeline-body"><p>Cool plugin! <code>ruff</code> would be a nice opportunity to spread this to a wider audience.</p>
<p>It passes over de function body once to computer a complexity score &gt;= 0. Should not be too hard or expensive to add.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KerberosMorphy">@KerberosMorphy</a> on 2023-02-21 22:03</div>
            <div class="timeline-body"><p>I was looking to replace my <code>flake8</code> plugins list with <code>ruff</code> and there's 2 plugins I couldn't replace yet:</p>
<ul>
<li><code>flake8-cognitive-complexity</code></li>
<li><code>flake8-expression-complexity</code></li>
</ul>
<p>Hope to see them implemented in ruff.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mariosker">@mariosker</a> on 2023-04-27 08:40</div>
            <div class="timeline-body"><p>Also in the same terms it would be nice to implement <a href="https://github.com/sasanjac/flake8-cohesion"><code>flake8-cohesion</code></a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KerberosMorphy">@KerberosMorphy</a> on 2023-04-27 15:00</div>
            <div class="timeline-body"><blockquote>
<p>Also in the same terms it would be nice to implement <a href="https://github.com/sasanjac/flake8-cohesion"><code>flake8-cohesion</code></a></p>
</blockquote>
<p>Didn't know that one, thanks for sharing ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/webknjaz">@webknjaz</a> on 2023-05-18 14:13</div>
            <div class="timeline-body"><p>It'd be also nice to implement https://github.com/Miserlou/JonesComplexity that WPS uses, for example..</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-05-19 07:40</div>
            <div class="timeline-body"><p>Are you planning to use these rules alongside the mccabe complexity rule or instead of it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/webknjaz">@webknjaz</a> on 2023-05-19 12:46</div>
            <div class="timeline-body"><p>I usually have all enabled, unless they are exact duplicates, of course..</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KerberosMorphy">@KerberosMorphy</a> on 2023-05-24 17:26</div>
            <div class="timeline-body"><blockquote>
<p>Are you planning to use these rules alongside the McCabe complexity rule or instead of it?</p>
</blockquote>
<p>I always include cyclomatic + expression + cognitive.</p>
<p>Here a quick example which demonstrate each complexity:</p>
<h3><code>foo</code></h3>
<p>Would be the best option if we only looks for Cyclomatic complexity.</p>
<p>But the expression is complex, especially for a junior developer or someone who just start with Python.</p>
<p>The Cognitive represent, as I interpret it myself, the amount of context you have to store in your brain.</p>
<pre><code class="language-python">def foo(**kwargs):  # Cognitive: 3, Cyclomatic: 1, Max Expression: 5
    return [  # Expression: 5
        key if key == value else value if value in kwargs else f&quot;{key}+{values}&quot;
        for key, value, in kwargs
    ]
</code></pre>
<h3><code>bar</code></h3>
<p>Would be the worst option if we only looks for Cyclomatic complexity.</p>
<p>But the expression is simple, each line is easy to understand.</p>
<p>You could need a higher level of context storage in your brain as you analyse this code, which is why it give a higher Cognitive complexity.</p>
<pre><code class="language-python">def bar(**kwargs):  # Cognitive: 5, Cyclomatic: 4, Max Expression: 2
    res = []  # Expression: 2

    for key, value, in kwargs.items():]  # Expression: 1
        if key == value:  # Expression: 1
            res.append(key)  # Expression: 1
            continue

        if value in kwargs:  # Expression: 1
            res.append(value)  # Expression: 1
            continue

        res.append(f&quot;{key}+{values}&quot;)  # Expression: 2

    return res
</code></pre>
<h3><code>boo</code> using <code>subboo</code></h3>
<p>Cyclomatic complexity is reduce compare to <code>bar</code> but still higher than <code>foo</code>.</p>
<p>Max Expression is the same than <code>bar</code>.</p>
<p>The Cognitive complexity is at 2, each function is pretty simple to analyze without the need to keep too much context in your brain.</p>
<pre><code class="language-python">def subboo(key, value, keys):  # Cognitive: 2, Cyclomatic: 3, Max Expression: 2
    if key == value:  # Expression: 1
        return key

    if value in keys:  # Expression: 1
        return value

    return f&quot;{key}+{values}&quot;  # Expression: 2

def boo(**kwargs):  # Cognitive: 0, Cyclomatic: 1, Max Expression: 2
    return [subbar(key, value, kwargs) for key, value, in kwargs.items()]  # Expression: 2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2023-08-08 23:57</div>
            <div class="timeline-body"><p>FWIW, <code>flake8-cognitive-complexity</code> and <code>flake8-cohesion</code> are the only two rules I still run. If those were added to Ruff, I could fully remove <code>flake8</code> from my project.</p>
<p>I do run McCabe in Ruff as well, but they serve three different purposes, IMHO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Anders-Steen">@Anders-Steen</a> on 2024-02-21 14:17</div>
            <div class="timeline-body"><p>Anyone want to look at my PR? #9812</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-03-28 16:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-design</span> added by @MichaReiser on 2024-03-28 16:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 16:14</div>
            <div class="timeline-body"><blockquote>
<p>I do run McCabe in Ruff as well, but they serve three different purposes, IMHO.</p>
</blockquote>
<p>Could you explain how the purpose between Mc Cabe and this rule differ in your view?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2024-03-28 16:20</div>
            <div class="timeline-body"><blockquote>
<p>Could you explain how the purpose between Mc Cabe and this rule differ in your view?
-@MichaReiser</p>
</blockquote>
<p>Cognitive complexity is how hard the code is to understand, while cyclomatic complexity is the number of independent branches. For example, a switch case that handles every letter of the alphabet might be very easy to understand, but it would have 26 separate branches.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-28 16:54</div>
            <div class="timeline-body"><p>Thanks, that makes sense. What's the motivation for catching the switch if it is easy to understand?</p>
<p>I'm asking because we're currently leaning towards having one single complexity rule with a configuration option for the metric to avoid overlap (and conflicts). However, that wouldn't support your use case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tylerlaprade">@tylerlaprade</a> on 2024-03-28 18:48</div>
            <div class="timeline-body"><p>Ah, I see your point! The main reason I run McCabe is because I don't want to run flake8 in Github Actions for just a single rule. I personally wouldn't mind replacing it.</p>
<p>However, I do find unique benefit from the related flake8-cohesion, which looks at a class as a whole.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cameronbrill">@cameronbrill</a> on 2024-11-26 21:48</div>
            <div class="timeline-body"><p>Hi @MichaReiser! I'm a big fan of the rule proposed in this issue, I'm curious have you/the astral team done any of <a href="https://github.com/astral-sh/ruff/pull/9812#issuecomment-2025605055">the design work here</a>/is this included in a product roadmap in any way?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MarcBresson">@MarcBresson</a> on 2025-03-04 13:41</div>
            <div class="timeline-body"><p>Hello! Is there any traction to have this implemented in ruff?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Tishka17">@Tishka17</a> on 2025-05-30 15:53</div>
            <div class="timeline-body"><p>Hi. Is there any plan for this feature?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cameronbrill">@cameronbrill</a> on 2025-08-29 19:27</div>
            <div class="timeline-body"><p>Hi @MichaReiser coming back to this one, if the team is open to it, I'd be interested in trying to implement the cognitive complexity rule to replace McCabe cyclomatic complexity. Any tips beyond the contribution guide would be appreciated ðŸ™‚</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-15 09:14</div>
            <div class="timeline-body"><p>Hi @cameronbrill Thanks for your interest.</p>
<p>I don't think we're currently in a position where we can accept a PR that replaces the existing rule AND we also don't want to add a new complexity rule before we figure out https://github.com/astral-sh/ruff/issues/1774. I'm sorry, this has to wait a little longer</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cameronbrill">@cameronbrill</a> on 2025-09-18 21:54</div>
            <div class="timeline-body"><p>no worries, thanks for getting back to me!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashrub-holvi">@ashrub-holvi</a> on 2026-01-07 12:17</div>
            <div class="timeline-body"><p>Just mentioning <a href="https://github.com/rubik/radon">radon</a> as someone make search by that name and now it's only mentioned in <a href="https://github.com/astral-sh/ruff/issues/20552">closed as duplicate ticket</a>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:46:20 UTC
    </footer>
</body>
</html>
