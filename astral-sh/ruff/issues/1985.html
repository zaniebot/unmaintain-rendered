<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improvement: N806 and `TypeVar`s inside functions - astral-sh/ruff #1985</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Improvement: N806 and `TypeVar`s inside functions</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1985">#1985</a>
        opened by <a href="https://github.com/patrick91">@patrick91</a>
        on 2023-01-19 00:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/patrick91">@patrick91</a> on 2023-01-19 00:14</div>
            <div class="timeline-body"><p>I don't think this is too important, but while running Ruff on Strawberry's codebase (tests especially) I had a lot of <code>N806</code> errors. I'm happy to ignore this check, but maybe this specific case can be improved, since it works for when T is defined outside the function (I guess it is taken as a global):</p>
<pre><code class="language-python">from typing import TypeVar

def x():
    T = TypeVar(&quot;T&quot;)

    print(T)
</code></pre>
<p>I don't know how common it is to create TypeVars (same goes for NewTypes) inside functions, so if it is not an easy fix I'd ignore the issue completely :D</p>
<p><a href="https://ruff.pages.dev/#N4KABGBECGA2sHsDuBTAJgWgMYIHYDMBXAZ2gCNYVjIAuMAbQF0AacKMwgS1gBdPdqdJqwiQ0hALYSAnhgBu0AE6dylDIoDmAD1pQAegAoA+gGoAPsZP1oGAF4BBDAC0ADBgCcRxgCprdx64ejCYA-ACUYQAkkCJQKFo8KLiYnBq4CIoousJskPGJyRjEKJRYPNksufkoirhwFbGQqemZDbmw-CgYlLgaPAAWugAcQ43FpeVCbKIAojHTUABi8xCiAHKQbJWiPEoaKDzyNcSceLqQAA7SAMwAjC4rUPiw0ADWKEMY0Ljpu3x4gjAoFWUBkVww-E4h0yPEItV0+DgxViomIhAuF0yxGIGHEUlke0BiNgyIWkDRGKxOPSuC6MLhuH4GgRSJQKKgcEQSCKu0UX00X1w0hZJJQbAAvo1nm8PhgyN80FDdMDVpB+ko0Dg0OgMDwJBdcZxMmUMsKpiDRAB6PUXR4gyCWhSKa36u2qy3auSW4j9CSbEGMCVSl7vT4cDRkFBKZVk6qFThSQi7ChdLCcwFMIO5aWhjA1RQSYjMugq0QSaBaHnKXrdJJ9QZ0FxZ0Q52UAR0ICESgNLUH4HVpGA7Xao5zQCEIKbdkAkhF43E6Q873bHE6n7LECCwxB41Y0S5HgM3k8o0+gcgQnEwVDTFyydF3hDFEEl2ZDsr4aFkCYuGR4PbJeVcHUEpoD4OQuh-P8jwuJQkn-acgNpTBoAuThlXFZsnnfT4oMUQ4cFwCDcH+AQY3tOAVGKACLSgWDkmgGC0DdVEozIDJcHOYgyPZURcEkK5zlwW1eI5XhoCNc44HKUSZzAi5EB4DoyAAOiuBSu3OBTygWTCX2DGVPiubtDh3aRTxLMl8E4BI4S6WDMhI-oqFHB9FCfDcHOgCQDmUWwujqHycR4aQ73OWEFKyTylG83zOH8+Q4CfYLQvvKAOh3acvJ83d4q6BRYGS9RkF1VLwvRU8N0UCTqJAjsjS6cseCwfoMHwDJsgWUQACFGJQGYtCwFALlIlioAGoaRtOTjZIANSS-rFEUDrZIAeQAZRmJaVq6qAAElVq25bFDGyAZiIo08B8kijp22jyS3d4eBU-MOoWbZVWqzharjTBMnqzIMCalq2o6oQPrLJRXgwBz4Oc6jdEfZ8wFfFscIwQh+OKFDNEkeCaNVZoMnypQVEVLAMEC1ywGJYosKaYg-3I1V2sUIaMCQaqDUovqiVZDdWfZk5ejUAc0tptkyWFjRRcXeIsEKk4ATae0cAkMhF0YiF9WgkVSXtYgFKhDA8F1L6B33NXy0R9zJftDJtT5MhZBCsK3I8qyMiFv8Oahfp+CKFAymmvnRQ3V50iQYDrMUHcYaUEKVdVCPkGAgYjUwBzE-Bjd8mqnkFQ1bpODIarFDNBgIagTIXnAyCdfwnEHZqc4iHw+HDh4BBsEQaiZLJf6uEyFIG4QnOyQVxiEfH1WAV2EiMyryAnRUFNF43dJi9pHFI1ZtLM303IJCwNNI2ZyHKzVyKtChCv7npu8Lk+QKmXPvs0mJynYozXbyQOABVESv9EhKAACKp1OsUHggCADCLxsSnRAYocBUc4FT0gQAi4ABZBA4hKrAKjMg1OOC8FRV-oxaQuAsDrUwadChVCAAqhCUEzV-lAwBTCdygLAtAU6iJuB2QmsNUaslEC9CwVQUg+xTrli0KAzg+B8D+lWEvSe2Icr9FwbiIOGQwIZB-vdNRxANG4OURAJeO4wKcCwCYzA2ocDVS7rHTq91LF8BsQcTRzF3oP2kFqKgIULJAjJETQGCAIKKDEfuXYxBoZW3xnrZGqM6LSHHNuQJaVgDJMuNIdEGhqrajfpAd4w11CYz4D5UqaFeiJIlCAcUkRGn4GWhIMArsmRgDwjwMADDUrzUUCAEA2p8BgC0AYMINAFgMLAAAXh6X0pQBhIAMMgGEQZIJMT8B4AYBhayQBAA">Playground link</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-01-20 23:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-20 23:34</div>
            <div class="timeline-body"><p>I think it's reasonable to special-case this, though could get tricky outside of the common case (e.g., <code>(A, B) = (TypeVar(&quot;A&quot;), TypeVar(&quot;B&quot;))</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/patrick91">@patrick91</a> on 2023-01-21 10:57</div>
            <div class="timeline-body"><blockquote>
<p>I think it's reasonable to special-case this, though could get tricky outside of the common case (e.g., <code>(A, B) = (TypeVar(&quot;A&quot;), TypeVar(&quot;B&quot;))</code>).</p>
</blockquote>
<p>I wonder if there's cases like those ðŸ¤”</p>
<p>They both work in <a href="https://ruff.pages.dev/#N4KABGBECGA2sHsDuBTAJgWgMYIHYDMBXAZ2gCNYVjIAuMAbQF0AacKMwgS1gBdPdqdJqwiQ0hALYSAnhgBu0AE6dylDIoDmAD1pQAegAoA+gGoAPsZP1oGAF4BBDAC0ADBgCcRxgCprdx64ejCYA-ACUYQAkkCJQKFo8KLiYnBq4CIoousJskPGJyRjEKJRYPNksufkoirhwFbGQqemZDbmw-CgYlLgaPAAWugAcQ43FpeVCbKIAojHTUABi8xCiAHKQbJWiPEoaKDzyNcSceLqQAA7SAMwAjC4rUPiw0ADWKEMY0Ljpu3x4gjAoFWUBkVww-E4h0yPEItV0+DgxViomIhAuF0yxGIGHEUlke0BiNgyIWkDRGKxOPSuC6MLhuH4GgRSJQKKgcEQSCKu0UX00X1w0hZJJQbAAvo1nm8PhgyN80FDdMDVpB+ko0Dg0OgMDwJBdcZxMmUMsKpiDRAB6PUXR4gyCWhSKa36u2qy3auSW4j9CSbEGMCVSl7vT4cDRkFBKZVk6qFThSQi7ChdLCcwFMIO5aWhjA1RQSYjMugq0QSaBaHnKXrdJJ9QZ0FxZ0Q52UAR0ICESgNLUH4HVpGA7Xao5zQCEIKbdkAkhF43E6Q873bHE6n7LECCwxB41Y0S5HgM3k8o0+gcgQnEwVDTFyydF3hDFEEl2ZDsr4aFkCYuGR4PbJeVcHUEpoD4OQuh-P8jwuJQkn-acgNpTBoAuThlXFZsnnfT4oMUQ4cFwCDcH+AQY3tOAVGKACLSgWDkmgGC0DdVEozIDJcHOYgyPZURcEkK5zlwW1eI5XhoCNc44HKUSZzAi5EB4DoyAAOiuBSu3OBTygWTCX2DGVPiubtDh3aRTxLMl8E4BI4S6WDMhI-oqFHB9FCfDcHOgCQDmUWwujqHycR4aQ73OWEFKyTylG83zOH8+Q4CfYLQvvKAOh3acvJ83d4q6BRYGS9RkF1VLwvRU8N0UCTqJAjsjS6cseCwfoMHwDJsgWUQACFGJQGYtCwFALlIlioAGoaRtOTjZIANSS-rFEUDrZIAeQAZRmJaVq6qAAElVq25bFDGyAZiIo08B8kijp22jyS3d4eBU-MOoWbZVWqzharjTBMnqzIMCalq2o6oQPrLJRXgwBz4Oc6jdEfZ8wFfFscIwQh+OKFDNEkeCaNVZoMnypQVEVLAMEC1ywGJYosKaYg-3I1V2sUIaMCQaqDUovqiVZDdWfZk5ejUAc0tptkyWFjRRcXeIsEKk4ATae0cAkMhF0YiF9WgkVSXtYgFKhDA8F1L6B33NXy0R9zJftDJtT5MhZBCsK3I8qyMiFv8Oahfp+CKFAymmvnRQ3V50iQYDrMUHcYaUEKVdVCPkGAgYjUwBzE-Bjd8mqnkFQ1bpODIarFDNBgIagTIXnAyCdfwnEHZqc4iHw+HDh4BBsEQaiZLJf6uEyFIG4QnOyQVxiEfH1WAV2EiMyryAnRUFNF43dJi9pHFI1ZtLM303IJCwNNI2ZyHKzVyKtChCv7npu8Lk+QKmXPvs0mJynYozXbyQOABVESv9EhKAACKp1OsUHggCADCLxsSnRAYocBUc4FT0gQAi4ABZBA4hKrAKjMg1OOC8FRV-oxaQuAsDrUwadChVCAAqhCUEzV-lAwBTCdygLAtAU6iJuB2QmsNUaslEC9CwVQUg+xTrli0KAzg+B8D+lWEvSe2Icr9FwbiIOGQwIZB-vdNRxANG4OURAJeO4wKcCwCYzA2ocDVS7rHTq91LF8BsQcTRzF3oP2kFqKgIULJAjJETQGCAIKKDEfuXYxBoZW3xnrZGqM6LSHHNuQJaVgDJMuNIdEGhqrajfpAd4w11CYz4D5UqaFeiJIlCAcUkRGn4GWhIMArsmRgDwjwMADDUrzUUCAEADCwAAF4el9KUAYSADDIBhBAPYZgYBuqjPGXefpUz7CzMWb0tZkzIDdVmYMkA2p8BgC0AYMINAFjDLGTslA6zpmHJBAspZKy7kPM2WEbZEzFBTIOXMhYmJ+A8AMAwgFQA">the playground</a> when outside functions.</p>
<p>I'm not sure how common it is to have typevars inside functions (we use them only in tests so it's not a big deal to skip this check there)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2085.html">astral-sh/ruff#2085</a> on 2023-01-22 14:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-22 17:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:04 UTC
    </footer>
</body>
</html>
