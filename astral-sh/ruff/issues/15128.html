<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expected Jupyter Notebook format 4, found: 5 - astral-sh/ruff #15128</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Expected Jupyter Notebook format 4, found: 5</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/15128">#15128</a>
        opened by <a href="https://github.com/amotl">@amotl</a>
        on 2024-12-23 21:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/amotl">@amotl</a></div>
            <div class="timeline-body"><p>Dear lovely authors and maintainers of Ruff,</p>
<p>we are just adding a Jupyter Notebook per <a href="https://github.com/crate/langchain-cratedb/pull/12">crate/langchain-cratedb#12</a>, which has been created using the most recent PyCharm 2024.3.1.1. When running most recent Ruff 0.8.4 on it, it trips, emitting this error message.</p>
<pre><code>$ ruff check
docs/cache.ipynb:1:1: Expected Jupyter Notebook format 4, found: 5
Found 1 error.
</code></pre>
<p>With kind regards,
Andreas.</p>
Observations
<p>Indeed, contrary to the other notebooks in this folder, this one apparently uses version 5 of the Jupyter Notebook format, where even nbformat doesn&#x27;t have a handler for? <a href="https://github.com/jupyter/nbformat/tree/main/nbformat">^1</a></p>
<pre><code>$ cat docs/vectorstores.ipynb | jq .nbformat
4

$ cat docs/cache.ipynb | jq .nbformat
5
</code></pre>
Thoughts
<p>Because even the documentation about <a href="https://nbformat.readthedocs.io/en/latest/format_description.html">the Notebook file format</a> does not mention anything about format v5.9, I guess my report might be totally bogus. As you can see at <a href="https://github.com/crate/langchain-cratedb/blob/64dfe9e/docs/cache.ipynb">docs/cache.ipynb @ 64dfe9e</a>, GitHub also rejects to render the notebook at all.</p>
<pre><code> &quot;nbformat&quot;: 5,
 &quot;nbformat_minor&quot;: 9
</code></pre>
References
<ul>
<li>https://github.com/jupyter/nbviewer/issues/545</li>
<li>https://github.com/jupyter/nbformat/issues/170</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amotl">@amotl</a> on 2024-12-23 21:52</div>
            <div class="timeline-body"><p>Just fixing this per https://github.com/crate/langchain-cratedb/commit/2dc4c2560a, Ruff doesn&#x27;t complain any longer, and GitHub also starts rendering the notebook properly, see <a href="https://github.com/crate/langchain-cratedb/blob/2dc4c2560a/docs/cache.ipynb">docs/cache.ipynb @ 2dc4c2560a</a>.</p>
<blockquote>
<p>I guess my report might be totally bogus.</p>
</blockquote>
<p>Closing this. Sorry for the noise.</p>
<p>NB: This apparently might have happened because the notebook has <em>never</em> been executed, so it also doesn&#x27;t have any metadata information <code>&quot;metadata&quot;: {}</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/amotl">@amotl</a> on 2024-12-23 21:52</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:49:12 UTC
    </footer>
</body>
</html>
