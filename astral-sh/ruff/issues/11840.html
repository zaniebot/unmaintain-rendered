<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>New rule: Decimal with float argument - astral-sh/ruff #11840</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>New rule: Decimal with float argument</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/11840">#11840</a>
        opened by <a href="https://github.com/kbaskett248">@kbaskett248</a>
        on 2024-06-11 21:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kbaskett248">@kbaskett248</a> on 2024-06-11 21:39</div>
            <div class="timeline-body"><p>I'm interested in adding a new rule to check for <code>Decimal</code> being called with a float literal argument. For example:</p>
<pre><code class="language-py"># Don't
d = Decimal(1.234)
# Do
d = Decimal('1.234')
</code></pre>
<p>This seems like a generally useful check. I searched for open issues and PRs involving <code>Decimal</code> and didn't find any mention of this type of check. I'm happy to work on a PR, but wanted to make sure this check makes sense in <code>ruff</code>. Please let me know if I'm missing something or there's any reason this check wouldn't be accepted.</p>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-12 02:34</div>
            <div class="timeline-body"><p>I don't <em>think</em> we have a check for this. Can you say more on why it's something to be avoided?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @charliermarsh on 2024-06-12 02:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mayanyax">@mayanyax</a> on 2024-06-12 05:32</div>
            <div class="timeline-body"><p>Consider:</p>
<pre><code>&gt;&gt;&gt; Decimal(0.3) == Decimal(0.1) + Decimal(0.1) + Decimal(0.1)
False
&gt;&gt;&gt; Decimal('0.3') == Decimal('0.1') + Decimal('0.1') + Decimal('0.1')
True
</code></pre>
<p>In the first example you basically creating an exact representation of the floating point approximation to 0.1. To my mind that is almost certainly not what is wanted as it seems to defeat the purpose of using Decimal in the first place.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbaskett248">@kbaskett248</a> on 2024-06-12 11:51</div>
            <div class="timeline-body"><p>Yeah, @mayanyax is exactly right. Passing a <code>float</code> literal could introduce imprecision, which is exactly what we're hoping to avoid.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mjgp2">@mjgp2</a> on 2024-07-18 09:46</div>
            <div class="timeline-body"><p>This would be a good addition, I have use cases where this has caused potential bugs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Matthieu-LAURENT39">@Matthieu-LAURENT39</a> on 2024-08-03 11:24</div>
            <div class="timeline-body"><p>this is a footgun i keep forgetting, and i would definitely enjoy seeing this rule implemented.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/12909.html">astral-sh/ruff#12909</a> on 2024-08-15 18:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-11-15 09:56</div>
            <div class="timeline-body"><p>Fixed by #12909</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2024-11-15 09:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:53 UTC
    </footer>
</body>
</html>
