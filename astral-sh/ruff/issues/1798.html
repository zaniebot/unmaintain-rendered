<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PIE794 should only remove simple code? - astral-sh/ruff #1798</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>PIE794 should only remove simple code?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/1798">#1798</a>
        opened by <a href="https://github.com/spaceone">@spaceone</a>
        on 2023-01-11 23:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/spaceone">@spaceone</a> on 2023-01-11 23:22</div>
            <div class="timeline-body"><pre><code>class Foo(object):
   bar = baz()
   bar = foo(bar)
</code></pre>
<p><code>bar</code> uses <code>bar</code>. The fixer removes that to (or something else since #1794):</p>
<pre><code>class Foo(object):
   bar = baz()
</code></pre>
<p>Even if the bar reference is not used I would say the code should not be changed as it makes function calls which might be necessary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-11 23:32</div>
            <div class="timeline-body"><p>Hmm. It's hard to think of logic that would work here, yet would still make the autofix behavior even marginally useful. The primary use-case is redefined fields in ORMs, which necessitate function calls. I guess in theory we could try to omit any call that relies on a variable bound within the same scope, but that will take a bit of time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-01-12 01:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 01:03</div>
            <div class="timeline-body"><p>Do you have any real-world examples of where this is triggering?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-01-12 01:10</div>
            <div class="timeline-body"><p>Actually, here's what I would propose (which would also resolve the other issue you filed around this rule): we only autofix if the <em>values</em> are the same. (Right now, we use that same logic for duplicate dictionary keys, so it feels very consistent.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-01-16 08:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2397.html">astral-sh/ruff#2397</a> on 2023-01-31 14:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:49 UTC
    </footer>
</body>
</html>
