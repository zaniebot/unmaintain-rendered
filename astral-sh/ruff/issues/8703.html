<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Change PT015 to trigger only on tests - astral-sh/ruff #8703</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Change PT015 to trigger only on tests</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/8703">#8703</a>
        opened by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a>
        on 2023-11-15 19:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a> on 2023-11-15 19:15</div>
            <div class="timeline-body"><p><a href="https://docs.astral.sh/ruff/rules/pytest-assert-always-false/">PT015</a> recommends using <code>pytest.fail</code>, which makes perfect sense inside a test.  But why is it triggering in ordinary code?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-15 20:16</div>
            <div class="timeline-body"><p>This may be an ignorant question, but how can we determine whether something is a test or not in the context of pytest? Aren't pytest tests just ordinary, arbitrary functions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2023-11-15 20:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NeilGirdhar">@NeilGirdhar</a> on 2023-11-15 21:46</div>
            <div class="timeline-body"><blockquote>
<p>Aren't pytest tests just ordinary, arbitrary functions?</p>
</blockquote>
<p>Here's the <a href="https://docs.pytest.org/en/7.2.x/explanation/goodpractices.html#conventions-for-python-test-discovery">test discovery from the docs</a>.</p>
<p>I'm not sure how careful you want this test to be, but this test could be made to only trigger on:</p>
<ul>
<li><code>test</code> prefixed functions outside of a class, and</li>
<li><code>test</code> prefixed methods inside <code>Test</code> prefixed test classes (without an <code>__init__</code> method)</li>
</ul>
<p>that are within files named <code>test_*.py</code> or <code>*_test.py</code>.   Although, this is technically <a href="https://docs.pytest.org/en/7.2.x/example/pythoncollection.html#changing-naming-conventions">changeable</a> by the user.</p>
<p>What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Why does PT015 trigger outside tests?" to "Change PT015 to trigger only on tests" by @NeilGirdhar on 2023-11-16 17:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8145.html">astral-sh/ruff#8145</a> on 2023-11-18 23:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8794.html">astral-sh/ruff#8794</a> on 2023-11-20 19:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-11-20 20:02</div>
            <div class="timeline-body"><p>Closing this in favor of #8794</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2023-11-20 20:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:11 UTC
    </footer>
</body>
</html>
