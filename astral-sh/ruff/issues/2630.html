<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`PT006` &amp; `PT007`: False negative with multiple `@pytest.mark.parametrize()` decorators - astral-sh/ruff #2630</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`PT006` &amp; `PT007`: False negative with multiple `@pytest.mark.parametrize()` decorators</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/2630">#2630</a>
        opened by <a href="https://github.com/ngnpope">@ngnpope</a>
        on 2023-02-07 17:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ngnpope">@ngnpope</a> on 2023-02-07 17:08</div>
            <div class="timeline-body"><pre><code class="language-python">import pytest

@pytest.mark.parametrize(&quot;a,b,c&quot;, [(1, 2), (3, 4), (5, 6)])  # Raises PT006
def test_single_decorator_for_pt006(a, b, c):
    pass

@pytest.mark.parametrize((&quot;a&quot;, &quot;b&quot;, &quot;c&quot;), ((1, 2), (3, 4), (5, 6)))  # Raises PT007
def test_single_decorator_for_pt007(a, b, c):
    pass

@pytest.mark.parametrize(&quot;a&quot;, [1, 2])  # OK
@pytest.mark.parametrize(&quot;b,c&quot;, [(3, 4), (5, 6)])  # Should raise PT006
def test_multiple_decorators_for_pt006(a, b, c):
    pass

@pytest.mark.parametrize(&quot;a&quot;, [1, 2])  # OK
@pytest.mark.parametrize((&quot;b&quot;, &quot;c&quot;), ((3, 4), (5, 6)))  # Should raise PT007
def test_multiple_decorators_for_pt007(a, b, c):
    pass
</code></pre>
<p>Gives the following:</p>
<pre><code class="language-console">❯ ruff --version
ruff 0.0.243

❯ ruff --isolated --select PT bug.py 
bug.py:3:26: PT006 [*] Wrong name(s) type in `@pytest.mark.parametrize`, expected `tuple`
bug.py:7:43: PT007 Wrong values type in `@pytest.mark.parametrize` expected `list` of `tuple`
Found 2 errors.
[*] 1 potentially fixable with the --fix option.
</code></pre>
<p>~~Makes me wonder whether there ought to be a new rule too to recommend using a single decorator?~~ <em>(Only makes sense if the arguments are the same length.)</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-02-08 15:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-02-08 15:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2662.html">astral-sh/ruff#2662</a> on 2023-02-08 16:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-02-08 16:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssbarnea">@ssbarnea</a> on 2023-04-12 16:43</div>
            <div class="timeline-body"><p>I see a conflict here as ruff asks to use a list while flake8 asks for</p>
<pre><code>ruff:
PT007 Wrong values type in `@pytest.mark.parametrize` expected `list` of `tuple`

flake8:
PT007 wrong values type in @pytest.mark.parametrize, expected tuple of tuples
</code></pre>
<p>Basically there is no way to sort this for both ruff and flake8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cidrblock">@cidrblock</a> on 2023-04-12 16:45</div>
            <div class="timeline-body"><p>A new entry in the pyproject.toml worked for me:</p>
<pre><code>[tool.ruff.flake8-pytest-style]
parametrize-values-type = &quot;tuple&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-04-12 16:46</div>
            <div class="timeline-body"><p>IIUC both plugins allow this to be configured. &quot;<code>list</code> of <code>tuple</code>&quot; for both Ruff and flake8-pytest-style. Is it possible that you have flake8-pytest-style configured to enforce tuples of tuples?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:05 UTC
    </footer>
</body>
</html>
