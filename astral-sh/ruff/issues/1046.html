<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One aliased import per line rule - astral-sh/ruff #1046</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>One aliased import per line rule</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1046">#1046</a>
        opened by <a href="https://github.com/smackesey">@smackesey</a>
        on 2022-12-05 01:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/smackesey">@smackesey</a> on 2022-12-05 01:05</div>
            <div class="timeline-body"><p>The codebase I work on uses code like this for explicit re-exports in many <code>__init__.py</code> files:</p>
<pre><code>from .utils import (
    test_directory as test_directory,
    test_id as test_id
)
</code></pre>
<p>It's useful to have code like this have exactly one import per line-- it's easier to tell at a glance what is being exported.</p>
<p>It's possible I've missed something but I don't think either <code>isort</code> or <code>ruff</code> offers a way to reliably achieve this formatting. By default, both formatters produce (1) below. If you turn on Isort's <code>combine-as</code> or ruff's <code>combine-as-imports</code> and you are under the line length limit, then you get (2).</p>
<pre><code># (1) One aliased import per line in separate import statements

from .utils import test_directory as test_directory
from .utils import test_id as test_id

# (2) Multiple imports per line if under line limit

from .utils import test_directory as test_directory, test_id as test_id
</code></pre>
<p>To get around this, we currently disable <code>isort</code> using <code># isort: off</code> comments when we use this pattern. The lack of ability to do something similar in <code>ruff</code> is preventing us adopting <code>ruff</code> in place of <code>isort</code>.</p>
<p>I propose an option that forces aliased imports to a single line, but still groups them together in a single import statement-- then we wouldn't even need to turn off the import sorter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 01:07</div>
            <div class="timeline-body"><p>Happy to support this.</p>
<p>If there's only a single import, are you imaging that it still enforces the same style? E.g.:</p>
<pre><code class="language-py">from .utils import (
    test_directory as test_directory,
)
</code></pre>
<p>Or would single-imports be retained on their own lines, like:</p>
<pre><code class="language-py">from .utils import test_directory as test_directory
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @charliermarsh on 2022-12-05 01:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @charliermarsh on 2022-12-05 01:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smackesey">@smackesey</a> on 2022-12-05 01:10</div>
            <div class="timeline-body"><p>Somewhat ambivalent but I prefer (1) to (2):</p>
<pre><code># (1)
from .utils import (
    test_directory as test_directory,
)

# (2)
from .utils import test_directory as test_directory
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 01:10</div>
            <div class="timeline-body"><p>Cool, I can add this now and cut another release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 01:11</div>
            <div class="timeline-body"><p>Would it make sense to <em>always</em> enforce this (one-per-line) behavior? Or at least for all <code>import-from</code> statements? Or would it be inconvenient if it applied beyond explicit re-exports?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 01:23</div>
            <div class="timeline-body"><p>(For now, I'll just apply this to <code>from</code> blocks where every member is a re-export.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smackesey">@smackesey</a> on 2022-12-05 01:25</div>
            <div class="timeline-body"><p>I think the rule makes sense for all <code>from X import Y as Z</code> imports-- visually parsing multiple <code>Y as Z</code> clauses on the same line can be difficult, regardless of whether they're explicit reexports (i.e. redundant aliases) or not. But if it only applies to re-exports, that would still solve our problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 01:49</div>
            <div class="timeline-body"><p>@smackesey - #1047 implements this as <code>force-wrap-aliases</code>. For now, the rules are: enforce multi-line formatting if an import-from has more than one member, and at least one member is aliased. But I'm happy to do whatever. (We don't combine straight imports, so it doesn't touch <code>import os as os</code>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smackesey">@smackesey</a> on 2022-12-05 02:20</div>
            <div class="timeline-body"><p>Ask and ye shall receive-- thanks!</p>
<blockquote>
<p>For now, the rules are: enforce multi-line formatting if an import-from has more than one member, and at least one member is aliased.</p>
</blockquote>
<p>Sounds reasonable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-12-05 02:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-05 02:23</div>
            <div class="timeline-body"><p>Cool, that's going out in <a href="https://github.com/charliermarsh/ruff/releases/tag/v0.0.158">v0.0.158</a> (building now). Since, as far as I know, you'll be the first user of the option, let me know if you'd like it tweaked to better fit the use-case!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:10:15 UTC
    </footer>
</body>
</html>
