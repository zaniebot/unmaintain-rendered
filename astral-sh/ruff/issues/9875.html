<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fmt: off doesn't work in `parametrized` decorator - astral-sh/ruff #9875</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fmt: off doesn&#x27;t work in <code>parametrized</code> decorator</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9875">#9875</a>
        opened by <a href="https://github.com/mdczaplicki">@mdczaplicki</a>
        on 2024-02-07 15:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mdczaplicki">@mdczaplicki</a></div>
            <div class="timeline-body"><p>I have a test that is heavily parametrized. Like this:</p>
<pre><code>@pytest.mark.parametrize(
    (
        &quot;business_x_y_fully_doing_something&quot;,
        &quot;business_x_y_not_doing_something&quot;,
        &quot;business_v_y_who_knows_doing_something&quot;,
        &quot;business_v_y_fully_doing_something&quot;,
        &quot;business_z_y_fully_doing_something&quot;,
        &quot;business_z_y_not_doing_something&quot;,
        &quot;expected_business_x_starting_something&quot;,
        &quot;expected_business_x_stopping_something&quot;,
        &quot;expected_business_v_starting_something&quot;,
        &quot;expected_business_v_stopping_something&quot;,
        &quot;expected_business_z_fully_doing_something&quot;,
        &quot;expected_business_z_not_doing_something&quot;,
        &quot;business_z_doing_threshold&quot;,
        &quot;business_z_doing_limit&quot;,
    ),
    [
        # fmt: off
        (0 , 29, 0 , 0 , 0 , 0 , 27, 0 , 0 , 0 , 0 , 0 , None, 100),
        (5 , 24, 0 , 0 , 0 , 0 , 22, 0 , 0 , 0 , 0 , 0 , None, 100),
        (30, 0 , 0 , 0 , 0 , 0 , 0 , 3 , 0 , 0 , 0 , 0 , None, 100),
        (28, 1 , 0 , 0 , 0 , 0 , 0 , 1 , 0 , 0 , 0 , 0 , None, 100),
        (0 , 29, 10, 0 , 0 , 0 , 25, 0 , 10, 0 , 0 , 0 , None, 100),
        (30, 0 , 0 , 10, 0 , 0 , 0 , 3 , 0 , 10, 0 , 0 , None, 100),
        (27, 0 , 0 , 4 , 0 , 0 , 0 , 0 , 0 , 4 , 0 , 0 , None, 100),
        (10, 0 , 0 , 0 , 0 , 10, 0 , 0 , 0 , 0 , 10, 0 , None, 100),
        (15, 5 , 0 , 0 , 4 , 5 , 5 , 0 , 0 , 0 , 7 , 2 , None, 100),
        (25, 0 , 0 , 0 , 0 , 10, 0 , 0 , 0 , 0 , 0 , 10, 50  , 100),
        (15, 5 , 0 , 0 , 4 , 5 , 5 , 0 , 0 , 0 , 5 , 4 , None, 1  ),
        # fmt: on
    ],
)
</code></pre>
<p>I want to maintain the readability of this by having exactly the same amount of distance between each value. I doesn&#x27;t work with <code># fmt: off</code> inside the decorator. In order for this to work - I&#x27;d have to surround whole test in a <code>fmt: off</code>, which I don&#x27;t want to do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-07 18:33</div>
            <div class="timeline-body"><p>Thank&#x27;s @mdczaplicki for opening the issue. I understand that you don&#x27;t like Ruff splitting the array after each element. I, unfortunately, haven&#x27;t had a lot of time working on it but we&#x27;ve started a discussion around formatting arrays in  https://github.com/astral-sh/ruff/discussions/8452 I want to keep this issue open because it is slightly different in that the list elements aren&#x27;t sub-lists but tuples.</p>
<p>One escape hatch for now is that you can add a <code>fmt: skip</code> comment at the end of the decorator. It&#x27;s not semantically identical to using a <code>fmt:off</code> - <code>fmt:on</code> region because it also disables formatting of the rest of the decorator. But it might help unblock you for now. See <a href="https://play.ruff.rs/5f84b2da-8483-49fb-9af5-72c9b2164c6c">this playground</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mdczaplicki">@mdczaplicki</a> on 2024-02-09 10:35</div>
            <div class="timeline-body"><p>Thanks @MichaReiser, <code>fmt: skip</code> works just fine. Now I can switch from <code>black</code> üòÅ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-02 13:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-02 13:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:49 UTC
    </footer>
</body>
</html>
