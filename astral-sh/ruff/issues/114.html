<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erroneous F821 on classes with parameter type annotations - astral-sh/ruff #114</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Erroneous F821 on classes with parameter type annotations</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/114">#114</a>
        opened by <a href="https://github.com/cjfuller">@cjfuller</a>
        on 2022-09-06 22:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cjfuller">@cjfuller</a> on 2022-09-06 22:36</div>
            <div class="timeline-body"><p>If I run ruff on a file containing a class with a type annotation at class level, it incorrectly gives F821 (undefined name).</p>
<p>Examples:</p>
<pre><code class="language-python">
from dataclasses import dataclass


@dataclass
class Bad:
    x: int


@dataclass
class AlsoBad:
    x: int = 3


class StillBad:
    x: int

    def __init__(self):
        self.x = 3


class Ok:
    x = 3
</code></pre>
<p>Running <code>ruff &lt;filename&gt;</code> on this file gives:</p>
<pre><code>ruff_test.py:6:5: F821 Undefined name `x`
ruff_test.py:11:5: F821 Undefined name `x`
ruff_test.py:15:5: F821 Undefined name `x`
</code></pre>
<p>(flake8 gives no errors)</p>
<p>Ruff version 0.0.28, python 3.8.13, ubuntu 22.04.1.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cjfuller">@cjfuller</a> on 2022-09-06 22:51</div>
            <div class="timeline-body"><p>Actually I guess that this also happens with top-level definitions too:</p>
<pre><code class="language-python">y: int = 4
</code></pre>
<p>also gives</p>
<pre><code>ruff_test.py:25:1: F821 Undefined name `y`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/115.html">astral-sh/ruff#115</a> on 2022-09-06 23:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-09-07 00:21</div>
            <div class="timeline-body"><p>I think I have to fix this in RustPython.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/117.html">astral-sh/ruff#117</a> on 2022-09-07 00:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2022-09-07 00:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:02 UTC
    </footer>
</body>
</html>
