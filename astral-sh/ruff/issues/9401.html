<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installing ruff v0.1.9+ with mamba and conda produces ModuleNotFoundError on Linux  - astral-sh/ruff #9401</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Installing ruff v0.1.9+ with mamba and conda produces ModuleNotFoundError on Linux</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/9401">#9401</a>
        opened by <a href="https://github.com/sogoodmo">@sogoodmo</a>
        on 2024-01-05 11:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sogoodmo">@sogoodmo</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Mac - Works
Linux - Fails
Windows - Not tested</p>
<ul>
<li>Importing ruff from mamba or conda on linux based machine and running python file that has <code>import ruff</code> produces <code>ModuleNotFound</code> error.</li>
<li>Importing ruff from <strong>pip</strong> on linux based machines <strong>does work</strong></li>
<li>Testing with python file that includes only <code>import ruff</code></li>
<li>Installed ruff by doing <code>mamba install ruff==0.1.9</code> <strong>Note</strong>: &lt;0.1.8 versions don't produce this error</li>
<li>Ruff version installed <code>0.1.9  py310h3d77a66_0  conda-forge/linux-64 </code></li>
</ul>
<p>Note:</p>
<ul>
<li>Using ruff in terminal to check a file does work on v0.1.9+ but importing it into my python file doesn't work.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Installing ruff v0.1.9+ on mamba produces ModuleNotFoundError on Linux " to "Installing ruff v0.1.9+ from mamba produces ModuleNotFoundError on Linux " by @sogoodmo on 2024-01-05 11:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Installing ruff v0.1.9+ from mamba produces ModuleNotFoundError on Linux " to "Installing ruff v0.1.9+ with mamba and conda produces ModuleNotFoundError on Linux " by @sogoodmo on 2024-01-05 11:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-05 15:58</div>
            <div class="timeline-body"><p>Interesting, need to see what changed here... The only thing I can see that possibly touched the release between v0.1.8 and v0.1.9 is https://github.com/astral-sh/ruff/pull/9031, but I don't see how it would've led to this error. Could something have changed in the conda-forge setup?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-05 15:58</div>
            <div class="timeline-body"><p>Hmm, no, nothing changed between those releases in https://github.com/conda-forge/ruff-feedstock.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-05 15:59</div>
            <div class="timeline-body"><p>Does <code>python -m ruff</code> work? I assume not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by @charliermarsh on 2024-01-05 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-01-05 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sogoodmo">@sogoodmo</a> on 2024-01-05 16:14</div>
            <div class="timeline-body"><blockquote>
<p>Does <code>python -m ruff</code> work? I assume not.</p>
</blockquote>
<p>Nope it doesn't :(.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-01-05 16:16</div>
            <div class="timeline-body"><p>The problem is that in the new release, the <code>ruff</code> folder isn't installed into the site-packages anymore, while the dist-info still is. In the env site-packages:</p>
<pre><code class="language-console">$ micromamba install ruff==0.1.8
$ ls
_distutils_hack  distutils-precedence.pth  pip  pip-23.3.2-py3.12.egg-info  pkg_resources  README.txt  ruff  ruff-0.1.8.dist-info  setuptools  setuptools-69.0.3-py3.12.egg-info  wheel  wheel-0.42.0.dist-info
$ micromamba install ruff==0.1.9
$ ls
_distutils_hack  distutils-precedence.pth  pip  pip-23.3.2-py3.12.egg-info  pkg_resources  README.txt  ruff-0.1.9.dist-info  setuptools  setuptools-69.0.3-py3.12.egg-info  wheel  wheel-0.42.0.dist-info
</code></pre>
<p>I assume this is a conda bug since there is no , but it's hard to even find out the correct build commands to verify a regression.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sogoodmo">@sogoodmo</a> on 2024-01-05 16:22</div>
            <div class="timeline-body"><p>Ah so is this not a ruff issue, but rather a conda bug?</p>
<p>And is it just a coincidence that 0.1.9 has https://github.com/astral-sh/ruff/pull/9188 as a breaking change and the problem is related to ruff not being found in the site-packages?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-01-05 16:29</div>
            <div class="timeline-body"><p>It's either a bug in the conda feedstock or in conda itself, i'm not a conda expert though; We build the wheel as basis for the conda package and we know that the wheel version works.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sogoodmo">@sogoodmo</a> on 2024-01-16 11:04</div>
            <div class="timeline-body"><p>Hey just updating, there is an open issue https://github.com/conda-forge/ruff-feedstock/issues/153 here detailing the same problem</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sogoodmo">@sogoodmo</a> on 2024-01-16 12:10</div>
            <div class="timeline-body"><p>Update: This issue seems to be fixed with 0.1.13 version. We can close this.</p>
<p><img src="https://github.com/astral-sh/ruff/assets/44754095/7b36f6fe-cc05-4ba8-a04b-22ee27038d8a" alt="ruff-9-bad" />
<img src="https://github.com/astral-sh/ruff/assets/44754095/1b03a1f2-c063-43b2-9071-ff59bd119e5e" alt="ruff-13-good" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sogoodmo on 2024-01-16 13:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-16 13:50</div>
            <div class="timeline-body"><p>Good to hear, thanks for reporting back!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:23 UTC
    </footer>
</body>
</html>
