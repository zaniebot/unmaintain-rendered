<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bug - Cannot ignore `TCH004` via config file - astral-sh/ruff #3472</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Bug - Cannot ignore <code>TCH004</code> via config file</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/3472">#3472</a>
        opened by <a href="https://github.com/Kilo59">@Kilo59</a>
        on 2023-03-13 01:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Kilo59">@Kilo59</a></div>
            <div class="timeline-body">

<p>Ignoring <code>TCH004</code> in the configuration file has no effect. This seems to be true for <code>ruff.toml</code> and <code>pyproject.toml</code> files.</p>
<p>Suppressing in-line with <code># noqa: TCH004</code> works fine.
Ignoring other <code>TCH**</code> rules seems to work fine.</p>
<pre><code>ruff 0.0.254
</code></pre>
<pre><code># ruff.toml
select = [&quot;TCH&quot;]
ignore = [&quot;TCH004&quot;]
</code></pre>
<pre><code># my_script.py
from typing import TYPE_CHECKING, Union

try:
    import numpy as np
except ImportError:
    np = None


if TYPE_CHECKING:
    import numpy as np


# Note: without postponed annotations, this will fail at runtime
def my_func(a: Union[float, np.float64], b: Union[float, np.float64]):
    return a + b
</code></pre>
<pre><code>❯ ruff my_script.py
my_script.py:10:12: TCH004 Move import `numpy` out of type-checking block. Import is used for more than type hinting.
Found 1 error.
</code></pre>
<p>☝️ I would expect to get no errors above due to the config ignore of <code>TCH004</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Bug - Cannot ignore `TCH004`&quot; to &quot;Bug - Cannot ignore `TCH004` via config file&quot; by <a href="https://github.com/Kilo59">@Kilo59</a> on 2023-03-13 01:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-13 02:15</div>
            <div class="timeline-body"><p>Just a bug, fixing...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-13 02:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-13 02:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-13 02:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:34 UTC
    </footer>
</body>
</html>
