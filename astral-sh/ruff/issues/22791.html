<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adding a new setting for rule E501 (`ignore-all-comments`) - astral-sh/ruff #22791</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Adding a new setting for rule E501 (<code>ignore-all-comments</code>)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/22791">#22791</a>
        opened by <a href="https://github.com/chirizxc">@chirizxc</a>
        on 2026-01-21 19:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chirizxc">@chirizxc</a></div>
            <div class="timeline-body">Summary
<p>Example:</p>
<p><code>main.py</code>:</p>
<pre><code>x = 1  # type: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
y = 2  # text text text text text
k = 3  # noqa
</code></pre>
<p><code>ruff.toml</code>:</p>
<pre><code>line-length = 5

[lint]
select = [&quot;E501&quot;]
task-tags = [
    &quot;type&quot;,
]

[lint.pycodestyle]
ignore-overlong-task-comments = false
</code></pre>
<pre><code>‚ùØ ruff check main.py                                                                                                                           
E501 Line too long (33 &gt; 5)                                                                                                                    
 --&gt; main.py:2:6
  |
1 | x = 1  # type: xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
2 | y = 2  # text text text text text
  |      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
3 | k = 3  # noqa
  |

Found 1 error.
</code></pre>
<p>I think it would be reasonable to make a non-default setting that can be enabled via</p>
<pre><code>[lint.pycodestyle]
ignore-all-comments = true
</code></pre>
<p>That is, in this case, all of these cases would be reported, as in the original flake8.</p>
<p>I mean that with the settings we could completely disable https://github.com/astral-sh/ruff/blob/main/crates/ruff_python_trivia/src/pragmas.rs</p>
<p>This question arose during a comparison of flake8 and ruff in a conversation about dishka on Telegram, screenshot example from @Tishka17:</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/ddc19008-c330-4bd6-b10e-25823dcdd363"></p>
<p>As you can see in the photo, the comments are not legible, i.e., they are simply not visible.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Adding a new setting for rule E501&quot; to &quot;Adding a new setting for rule E501 (`ignore-all-comments`)&quot; by <a href="https://github.com/chirizxc">@chirizxc</a> on 2026-01-21 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2026-01-21 19:54</div>
            <div class="timeline-body"><p>why not just disable E501 and rely on a formatter to enforce line length?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2026-01-21 19:56</div>
            <div class="timeline-body"><blockquote>
<p>why not just disable E501 and rely on a formatter to enforce line length?</p>
</blockquote>
<p>The formatter is not entirely suitable, at least in that it violates PEP8.</p>
<p>See: <a href="https://github.com/astral-sh/ruff/issues/20454">astral-sh/ruff#20454</a>#issuecomment-3304157224</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2026-01-21 20:01</div>
            <div class="timeline-body"><p>For me, <code>black</code> (and its implementation within <code>ruff</code>) is a very strange formatter, at least the style that was used before literally bloated the code and made it less readable (in my opinion).</p>
<p>I can give you an example of the <a href="https://black.readthedocs.io/en/stable/the_black_code_style/future_style.html#improved-multiline-dictionary-and-list-indentation-for-sole-function-parameter">old format</a> that black used to have:</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/01f5c743-043c-496f-bb3d-7ebe162005c5"></p>
<p>It is unclear why this was not done earlier, but remained unchanged for many years.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2026-01-21 21:48</div>
            <div class="timeline-body"><p>I guess I can see why you would want a mechanism for finding these lines, but there&#x27;s often not much you can do to fix it, which I think is why these are skipped in the current implementation (<a href="https://github.com/astral-sh/ruff/pull/7692">astral-sh/ruff#7692</a>). For example, our <code>noqa</code> comments (and ty&#x27;s) need to be at the end of the line and can&#x27;t really be moved, unless you somehow restructure the code itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2026-01-21 21:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2026-01-21 21:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2026-01-21 21:51</div>
            <div class="timeline-body"><blockquote>
<p>I guess I can see why you would want a mechanism for finding these lines, but there&#x27;s often not much you can do to fix it, which I think is why these are skipped in the current implementation (<a href="https://github.com/astral-sh/ruff/pull/7692">#7692</a>). For example, our <code>noqa</code> comments (and ty&#x27;s) need to be at the end of the line and can&#x27;t really be moved, unless you somehow restructure the code itself.</p>
</blockquote>
<p>This setting will be optional, and most likely only those who need it will use it. This setting will not conflict with others:</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/8fde5cd5-01d2-436b-ab5d-befb5b08f1e4"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2026-01-21 21:54</div>
            <div class="timeline-body"><p>The value <code>line-length = 5</code> is just an example. In real projects, such as the screenshot above from dishka, you can shift the code slightly so that it fits on the screen and you don&#x27;t have to scroll</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/1d20e585-4083-4fbc-99e7-0f6176495a33"></p>
<p>vvv</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/ffd67001-317e-4dec-b973-6f7070e004dd"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2026-01-21 21:56</div>
            <div class="timeline-body"><p>The same flake8 complains about this, we must take this setting into account for commands that have switched to ruff:</p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/30d25538-ccf5-4576-9edd-7e304e78da93"></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-21 22:08:55 UTC
    </footer>
</body>
</html>
