<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rule duplication `F509` and `PLE1300` - astral-sh/ruff #11403</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Rule duplication <code>F509</code> and <code>PLE1300</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/11403">#11403</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-05-13 11:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body"><p>Both rules check for invalid format character in <code>%</code> format style string.</p>
<p>The implementation is almost the same:</p>
<code>F509</code>
<p>https://github.com/astral-sh/ruff/blob/1f748b89ca73361146508b6f0af9afc756dc9cb2/crates/ruff_linter/src/checkers/ast/analyze/expression.rs#L1087-L1100</p>
<code>PLE1300</code>
<p>https://github.com/astral-sh/ruff/blob/1f748b89ca73361146508b6f0af9afc756dc9cb2/crates/ruff_linter/src/rules/pylint/rules/bad_string_format_character.rs#L117-L125</p>
<p>There&#x27;s one difference which can be noticed when an implicitly concatenated string is used. <code>F509</code> looks at the concatenated string while <code>PLE1300</code> looks at each part of an implicitly concatenated string. Refer to https://play.ruff.rs/6efd9945-2a3b-43e4-b9b7-a8d041b98318.</p>
<p>Reference:</p>
<ul>
<li><code>F509</code> https://docs.astral.sh/ruff/rules/percent-format-unsupported-format-character/</li>
<li><code>PLE1300</code> https://docs.astral.sh/ruff/rules/bad-string-format-character/</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-05-13 11:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;v0.5.0&quot; by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-13 14:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-13 14:51</div>
            <div class="timeline-body"><p>@dhruvmanila - Let&#x27;s remove <code>PLE1300</code> as part of v0.5.0?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-13 14:53</div>
            <div class="timeline-body"><p>See <a href="https://github.com/astral-sh/ruff/pull/9756">astral-sh/ruff#9756</a> for prior art.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-05-13 14:57</div>
            <div class="timeline-body"><blockquote>
<p>Let&#x27;s remove <code>PLE1300</code> as part of v0.5.0?</p>
</blockquote>
<p>Yeah, that makes sense but there&#x27;s one difference where <code>PLE1300</code> would check each part of an implicitly concatenated string while <code>F509</code> checks it as a whole. This means that the number of diagnostics would be reduced. That said, I think <code>F509</code> can be improved to either</p>
<ol>
<li>Include all the invalid characters in the message or</li>
<li>Raise violation for each invalid character and highlighting the part of the string instead of the entire string</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-25 03:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-25 03:59</div>
            <div class="timeline-body"><p>I&#x27;m looking into this and it seems that there&#x27;s one behavior which is different - <code>PLE1300</code> looks at <em>both</em> <code>%</code> style strings and <code>.format</code> strings while <code>F509</code> only looks at <code>%</code> style strings. Basically, <code>F509</code> is a subset of <code>PLE1300</code> which means we should remove <code>F509</code> instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Pierre-Sassoulas">@Pierre-Sassoulas</a> on 2024-06-25 04:14</div>
            <div class="timeline-body"><p>Shouldn&#x27;t they be aliased to match what&#x27;s expected from each tool and not break r√©tro compatibility ? (There&#x27;s another issue for human readable names where old_names from pylint and aliases came up).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-25 04:19</div>
            <div class="timeline-body"><p>Yeah, sorry, I meant that <code>F509</code> will redirect to <code>PLE1300</code> similar to <a href="https://github.com/astral-sh/ruff/pull/9756">astral-sh/ruff#9756</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-25 16:04</div>
            <div class="timeline-body"><p>We&#x27;ve decided to not do this via rule redirection but wait until rule re-categorization (#1774) is complete and merge these rules instead. Refer to #12020 for context.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;v0.5.0&quot; by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-25 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned <a href="https://github.com/dhruvmanila">@dhruvmanila</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-25 16:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:53 UTC
    </footer>
</body>
</html>
