<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`Pylint`] [preview] `PLE4703` false negative on any reassignment - astral-sh/ruff #18818</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[`Pylint`] [preview] `PLE4703` false negative on any reassignment</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18818">#18818</a>
        opened by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a>
        on 2025-06-20 07:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2025-06-20 07:22</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>If there is any reassignment of the target variable, even when both are as a set, <a href="https://docs.astral.sh/ruff/rules/modified-iterating-set/#modified-iterating-set-ple4703">modified-iterating-set (PLE4703)</a> will have a false negative. <a href="https://play.ruff.rs/9d10264a-9541-4f70-bc20-3483c22ce9b4">playground</a></p>
<pre><code class="language-py">works = {1, 2, 3}
for num in works:  # PLE4703
    works.add(num + 5)

nums = {1, 2, 3}
nums = {1, 2, 3}
for num in nums:   # No error
    nums.add(num + 5)
</code></pre>
<h3>Version</h3>
<p>playground</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-06-20 12:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ntBre on 2025-06-20 12:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/18833.html">astral-sh/ruff#18833</a> on 2025-06-20 20:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-24 06:24</div>
            <div class="timeline-body"><p>Same as for https://github.com/astral-sh/ruff/issues/18855</p>
<p>Simply using <code>resolve_name</code> over <code>only_binding</code> trades false negatives with false positives.</p>
<p>I think the right approach here is to modify the implementation to resolve all visible bindings and verify that all of them are dictionaries. I can't say how hard that is because I'm not very familiar with our semantic model.</p>
<p>An alternative is to change <code>only_binding</code> to return <code>Some</code> even if there are multiple bindings but if only one binding is visible unconditionally (not dependent on control flow paths)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:17 UTC
    </footer>
</body>
</html>
