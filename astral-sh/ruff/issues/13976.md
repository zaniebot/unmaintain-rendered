```yaml
number: 13976
title: add if TYPE_CHECKING section to isort section order
type: issue
state: open
author: fraser-langton
labels:
  - rule
  - typing
assignees: []
created_at: 2024-10-29T04:42:26Z
updated_at: 2025-01-27T15:31:15Z
url: https://github.com/astral-sh/ruff/issues/13976
synced_at: 2026-01-10T01:56:54Z
```

# add if TYPE_CHECKING section to isort section order

---

_Issue opened by @fraser-langton on 2024-10-29 04:42_

I am not sure if I just can't find the docs, because I expected this to be included in either I (isort) or TCH (flake8-type-checking).

Although no PEP recommends where `if TYPE_CHECKING` import blocks should go I think it's pretty standard to put after all other imports 

eg 
```python
import os
from typing import TYPE_CHECKING

import pydantic

import my_package

if TYPE_CHECKING:
    from requests import Request
```

ie I would expect the default value for [[tool.ruff.lint.isort.section-order]](https://docs.astral.sh/ruff/settings/#lint_isort_section-order) to be `["future", "standard-library", "first-party", "local-folder", "third-party", "type-checking"]`

(sorry if this is already included, I cannot find it anywhere)

---

_Comment by @MichaReiser on 2024-10-29 06:53_

Hi @fraser-langton 

>  I think it's pretty standard to put after all other imports

Could you share some reference suggesting that putting `TYPE_CHECKING` last is the standard? I did a quick [github code search](https://github.com/search?q=from+typing+import+TYPE_CHECKING&type=code) and the samples I found all have the `typing` imports together with the other standard library imports. 

What sorting do you suggest when there are other typing imports besides `TYPE_CHECKING`, e.g. `typing`?



---

_Label `question` added by @MichaReiser on 2024-10-29 06:54_

---

_Label `isort` added by @MichaReiser on 2024-10-29 06:54_

---

_Comment by @fraser-langton on 2024-10-29 22:52_

I think maybe I wasn't as clear as I should have been, is mean the `if TYPE_CHECKING:` block.

For example TCH --fix --unsafe-fixes put them last. 

Maybe the isort rules don't have a default, but it would be good to at least configure [[tool.ruff.lint.isort.section-order]](https://docs.astral.sh/ruff/settings/#lint_isort_section-order) = `["future", "standard-library", "first-party", "local-folder", "third-party", "type-checking"]` - maybe `if-type-checking` is a clearer section name

---

_Comment by @dhruvmanila on 2024-10-30 03:19_

> For example TCH --fix --unsafe-fixes put them last.

I think this only happens when the rules autofix would introduce a `TYPE_CHECKING` block like `TCH001-003`.

Is the feature request to allow configuring the position of this insertion of `TYPE_CHECKING` block?

---

_Comment by @fraser-langton on 2024-10-30 03:23_

@dhruvmanila not inserting it, configure how it should be sorted in [[tool.ruff.lint.isort.section-order]](https://docs.astral.sh/ruff/settings/#lint_isort_section-order) - ie so it must always be after all imports if you want

---

_Renamed from "add type checking to isort section order" to "add if TYPE_CHECKING section to isort section order" by @fraser-langton on 2024-10-30 03:24_

---

_Comment by @MichaReiser on 2024-10-30 06:18_

I don't think this should be part of `isort`. `isort` is only concerned with sorting imports and what I understand is that you want to configure the position of the `if TYPE_CHECKING` block. 

I'm open to iterating on the `TCH` fix to placing the `TYPE_CHECKING` block directly after all imports, if it is safe to do so.


---

_Label `isort` removed by @MichaReiser on 2024-10-30 06:18_

---

_Label `question` removed by @MichaReiser on 2024-10-30 06:18_

---

_Label `rule` added by @MichaReiser on 2024-10-30 06:18_

---

_Label `typing` added by @MichaReiser on 2024-10-30 06:18_

---

_Comment by @Daverball on 2024-10-30 07:15_

There is a particular style I use for typing imports I would like to enforce that has always stopped me from enabling isort and it's somewhat related to this request. I generally use the following style:

```python
from decimal import Decimal

from third_party import Foo

from my_module import Bar


from typing import Any
from typing import TYPE_CHECKING
if TYPE_CHECKING:
    from collections.abc import Sequence
    from typing_extensions import Self

    from typing_only_third_party import FooType

    from my_typing_only import BarType
```

i.e. the typing imports are all grouped together with the first `if TYPE_CHECKING` block and separated by two spaces from the other sections to clearly show which part of the import block is relevant for runtime and which part is only used for type hints.

So adding the ability to define some more complex layouts like this one would be appreciated, but it would likely involve having to switch to a template string for defining the layout of the sections and some smart logic for collapsing white space between missing sections and allowing the sections within an `if TYPE_CHECKING:` block to be different. Note how in my example `typing` and `typing_extensions` are in their own section in runtime scope but are folded into `standard-library` within typing only scope.

---

_Comment by @kdebrab on 2024-10-31 07:20_

It was unexpected to me, that, e.g., the following order is not flagged by isort (or any other rule like TCH or E402):

```python
import os
from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from my_package import my_function

import pydantic

import my_package
```

---

_Comment by @Avasam on 2024-11-03 17:27_

Looking at this from a different angle: Could this be related to `E402` instead ? "Module level import not at top of file" could trigger for imports found after top-level `if TYPE_CHECKING` blocks.

---

_Comment by @fraser-langton on 2024-11-06 22:26_

@MichaReiser 

> I don't think this should be part of `isort`. `isort` is only concerned with sorting imports and what I understand is that you want to configure the position of the `if TYPE_CHECKING` block.
> 

I agree with this, probably not in isort as you really only want it to be last (ie you wouldn't configure something like `["future", "standard-library", "first-party", "type-checking", "local-folder", "third-party"]`

> I'm open to iterating on the `TCH` fix to placing the `TYPE_CHECKING` block directly after all imports, if it is safe to do so.
>

`TCH` does make a lot of sense to me, as it already inserts a `TYPE_CHECKING` block after all imports.  

---

_Comment by @fraser-langton on 2024-12-12 03:19_

@MichaReiser have you had any other thoughts regarding this? 

---

_Comment by @Sxderp on 2025-01-27 15:31_

Yeah, I would also like TYPE_CHECKING to be at the end. 

---

_Referenced in [astral-sh/ruff#21132](../../astral-sh/ruff/issues/21132.md) on 2025-10-30 04:00_

---
