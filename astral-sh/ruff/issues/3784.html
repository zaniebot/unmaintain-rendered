<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&quot;Note that Ruff's pre-commit hook should run before Black, isort, and other formatting tools.&quot; ??? - astral-sh/ruff #3784</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>&quot;Note that Ruff's pre-commit hook should run before Black, isort, and other formatting tools.&quot; ???</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/3784">#3784</a>
        opened by <a href="https://github.com/brucearctor">@brucearctor</a>
        on 2023-03-28 20:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/brucearctor">@brucearctor</a> on 2023-03-28 20:27</div>
            <div class="timeline-body"><p>From:  https://github.com/charliermarsh/ruff/blob/main/docs/usage.md --&gt; &quot;Note that Ruff's pre-commit hook should run before Black, isort, and other formatting tools.&quot;</p>
<p>It is not clear why this is a 'should'.  Would anyone be willing to explain?  Thanks!</p>
<p>I don't see a dev/user mailing list, so imagine asking questions in issues is fair game.  If this project uses another method, happy to post there, please advise in that case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2023-03-28 20:36</div>
            <div class="timeline-body"><p>This is because ruff can remove and change the code which would require a second pass out black and isort.
That is why it must be run before.</p>
<p>There is also GitHub discussions that is available. I see discussions as non actionable questions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brucearctor">@brucearctor</a> on 2023-03-28 20:41</div>
            <div class="timeline-body"><p>awesome -- marking to be closed.  ðŸ¤¦ ... not used to discussions being enabled in repos ... that's a much more appropriate place!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @brucearctor on 2023-03-28 20:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-03-28 20:50</div>
            <div class="timeline-body"><p>Yeah, if you don't run autofix in pre-commit, then it makes sense to run Ruff <em>last</em>. If you <em>do</em> run autofix, you should run it first, otherwise Ruff might output code that Black then needs to reformat.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brucearctor">@brucearctor</a> on 2023-03-28 21:05</div>
            <div class="timeline-body"><p>That was my thinking, and why I was hung up on the directive of 'should'.  Still gaining confidence with ruff, so not allowing fix in precommit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3789.html">astral-sh/ruff#3789</a> on 2023-03-28 23:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/failable">@failable</a> on 2023-07-30 14:06</div>
            <div class="timeline-body"><p>If <code>ruff --fix</code> is run before <code>black</code>, <code>options = {&quot;debug&quot;: True,}</code> will be 'fixed' to <code>options = {&quot;debug&quot;: True}</code> before <code>black</code> formatting. But the comma is inserted here to expect <code>black</code> to format it into</p>
<pre><code>{
    &quot;debug&quot;: True,
}
</code></pre>
<p>I encounter many scenarios like this: running <code>ruff</code> before <code>black</code> would results in quite different output from without <code>ruff</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-07-30 15:51</div>
            <div class="timeline-body"><p>Do you have the trailing comma rules enabled (COM)? Ruff should not touch that trailing comma unless youâ€™ve opted into those rules, which arenâ€™t enabled by default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brucearctor">@brucearctor</a> on 2023-07-30 18:14</div>
            <div class="timeline-body"><p>There are some interesting behaviors when black modifies line [ex line
length ], which in turn changes the ruff noqa [if adding those].  Also, if
memory serves, #noqa counts as part of line length.</p>
<p>On Sun, Jul 30, 2023, 8:51 AM Charlie Marsh <em><strong>@</strong></em>.***&gt;
wrote:</p>
<blockquote>
<p>Do you have the trailing comma rules enabled (COM)? Ruff should not touch
that trailing comma unless youâ€™ve opted into those rules, which arenâ€™t
enabled by default.</p>
<p>â€”
Reply to this email directly, view it on GitHub
<a href="https://github.com/astral-sh/ruff/issues/3784#issuecomment-1657206211">https://github.com/astral-sh/ruff/issues/3784#issuecomment-1657206211</a>,
or unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/ABGMTJGG4PG3ATAEGPBGM73XSZ7HLANCNFSM6AAAAAAWLB2QDA">https://github.com/notifications/unsubscribe-auth/ABGMTJGG4PG3ATAEGPBGM73XSZ7HLANCNFSM6AAAAAAWLB2QDA</a>
.
You are receiving this because you modified the open/close state.Message
ID: <em><strong>@</strong></em>.***&gt;</p>
</blockquote>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:50 UTC
    </footer>
</body>
</html>
