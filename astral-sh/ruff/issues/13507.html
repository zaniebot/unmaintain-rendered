<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Idea: warn when a re-exported name is imported - astral-sh/ruff #13507</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Idea: warn when a re-exported name is imported</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13507">#13507</a>
        opened by <a href="https://github.com/dimaqq">@dimaqq</a>
        on 2024-09-25 01:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dimaqq">@dimaqq</a> on 2024-09-25 01:23</div>
            <div class="timeline-body"><p>Consider a library like this:</p>
<pre><code class="language-py"># lib/__init__.py
from .exceptions import LibError
from .client import Client

__all__ = [
    &quot;Client&quot;,
    &quot;LibError&quot;,
]

# lib/exceptions.py
class LibError(Exception): ...

# lib/client.py
from .exceptions import LibError

class Client:
    def some_method(self):
        if something.bad:
            raise LibError(&quot;thou shalt not pass&quot;)
</code></pre>
<p>Then the user code imports these names:</p>
<pre><code class="language-py">from lib import LibError  # OK, explicitly re-exported

from lib.exceptions import LibError  # OK, that's where it's defined

from lib.client import LibError  # WARN: lib.exceptions.LibError is re-exported via lib.client

from lib.client import Client  # OK
</code></pre>
<p>The reason to warn is that lib.client can change, for example to <code>raise exception.MoreSpecificError</code> instead, which would not be a breaking change is MoreSpecificError inherits from LibError.</p>
<p>However, in that case, LibError may no longer be re-exported via lib.client.</p>
<p>Thus user code that depends on LibError name being present on lib.client is mistaken.</p>
<p>Ideas how this could be implemented:</p>
<ol>
<li>get the <code>__qualname__</code> for the imported name</li>
<li>check if the import path is different from qualname</li>
<li>check if the imported name is also available at lib top level or</li>
<li>check if the imported name is available at some intermediate level between lib and qualname</li>
<li>suggest a more direct import</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> added by @MichaReiser on 2024-09-25 06:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by @MichaReiser on 2024-10-24 14:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> removed by @MichaReiser on 2024-10-24 14:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/johnthagen">@johnthagen</a> on 2024-11-26 16:35</div>
            <div class="timeline-body"><p>Related to Mypy's <code>no_implicit_reexport</code> feature:</p>
<ul>
<li>https://github.com/python/mypy/issues/10198</li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:35:14 UTC
    </footer>
</body>
</html>
