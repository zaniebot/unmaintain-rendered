<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiline f-strings and prefixing all with `f` - astral-sh/ruff #13675</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Multiline f-strings and prefixing all with <code>f</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13675">#13675</a>
        opened by <a href="https://github.com/PatrickJordanNutanix">@PatrickJordanNutanix</a>
        on 2024-10-08 09:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/PatrickJordanNutanix">@PatrickJordanNutanix</a></div>
            <div class="timeline-body"><p>We have soft rule in our code base that means we should prefix all multiline f-strings with an <code>f</code> even if no interpolation is happening on part of the string. For example, instead of doing this:</p>
<pre><code class="language-python">long_string = (
  &quot;This is a long string to demonstrate that when it wraps on to the next &quot;
  f&quot;line, all lines should be prefixed with an {f_prefix} to improve &quot;
  &quot;readability and effectively treat them along the same lines as a trailing &quot;
  &quot;comma, even if interpolation only happens on a subset of the lines.&quot;
)
</code></pre>
<p>We should be doing this:</p>
<pre><code class="language-python">long_string = (
  f&quot;This is a long string to demonstrate that when it wraps on to the next &quot;
  f&quot;line, all lines should be prefixed with an {f_prefix} to improve &quot;
  f&quot;readability and effectively treat them along the same lines as a trailing &quot;
  f&quot;comma, even if interpolation only happens on a subset of the lines.&quot;
)
</code></pre>
<p>Is there an existing rule that can catch this linting error? If not, can I request one be added please?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-08 12:29</div>
            <div class="timeline-body"><p>Does this rule of yours only apply if one of the string literals contain an expression or for all implicit concatenated strings?</p>
<p>E.g. what about</p>
<pre><code class="language-python">long_string = (
  &quot;This is a long string to demonstrate that when it wraps on to the next &quot;
  &quot;line, all lines should be prefixed with an ... to improve &quot;
  &quot;readability and effectively treat them along the same lines as a trailing &quot;
  &quot;comma, even if interpolation only happens on a subset of the lines.&quot;
)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/PatrickJordanNutanix">@PatrickJordanNutanix</a> on 2024-10-08 13:00</div>
            <div class="timeline-body"><blockquote>
<p>Does this rule of yours only apply if one of the string literals contain an expression or for all implicit concatenated strings?</p>
</blockquote>
<p>Yes, only if at some point a variable is being interpolated into it. If it's a multiline string with no interpolation, then we do not prefix with an <code>f</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-10-13 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-10-13 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-13 14:02</div>
            <div class="timeline-body"><p>Thanks. I now understand your use case. We could phrase it in a more general way and say that you want a common prefix for all string literals in implicit concatenated strings. The rule would then also enforce that all strings are raw-strings</p>
<pre><code class="language-python">a = (
	r&quot;flag&quot;
	&quot;this&quot;
)

# instead write
a = (
	r&quot;flag&quot;
	r&quot;this&quot;
)

# or
a = (
	&quot;flag&quot;
	&quot;this&quot;
)
</code></pre>
<p>Considering that this is an opinionated stylistic rule, we should wait for #1774 to avoid enabling the rule by default for everyone using <code>select=ALL</code>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:51:13 UTC
    </footer>
</body>
</html>
