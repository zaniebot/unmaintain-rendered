<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S113 - Rule Doesn't Take `httpx` Default Timeout into Account - astral-sh/ruff #12210</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>S113 - Rule Doesn&#x27;t Take <code>httpx</code> Default Timeout into Account</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/12210">#12210</a>
        opened by <a href="https://github.com/fullerzz">@fullerzz</a>
        on 2024-07-05 20:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/fullerzz">@fullerzz</a></div>
            <div class="timeline-body">

<p>The S113 rule has the following description:</p>
<blockquote>
<p>Checks for uses of the Python requests or httpx module that omit the timeout parameter.</p>
</blockquote>
<p>This rule fails to take into account that <code>httpx</code> enforces a default timeout of 5.0 seconds globally.</p>
<p>Omitting the timeout parameter in httpx&#x27;s top-level API calls still results in a 5 second timeout. Likewise, the same applies to both <code>httpx.Client</code> and <code>httpx.AsyncClient</code>.</p>
httpx Docs Used for Reference
<p>https://www.python-httpx.org/advanced/timeouts/</p>
<blockquote>
<p>HTTPX is careful to enforce timeouts everywhere by default.
The default behavior is to raise a TimeoutException after 5 seconds of network inactivity.</p>
</blockquote>
<pre><code>client = httpx.Client()  # 5s timeout by default
httpx.get(&#x27;http://example.com/api/v1/example&#x27;)  # 5s timeout by default
</code></pre>
<p>Timeouts can be explicitely disabled as so:</p>
<pre><code># Using the top-level API:
httpx.get(&#x27;http://example.com/api/v1/example&#x27;, timeout=None)

# Using a client instance:
with httpx.Client() as client:
    client.get(&quot;http://example.com/api/v1/example&quot;, timeout=None)
</code></pre>
Suggestion
<p>Maybe S113 can check for <code>timeout=None</code> in the case of <code>httpx</code>. Or I can just disable S113 if this rule is working as intended.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-05 20:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-05 20:32</div>
            <div class="timeline-body"><p>I think it makes sense to respect the default and only flag explicit <code>timeout=None</code>, at least based on the above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> on 2024-07-06 01:33</div>
            <div class="timeline-body"><p>Feel free to assign this to me, I have a local PR (mostly) working</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/evanrittenhouse">@evanrittenhouse</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-06 01:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-06 01:58</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2024-07-06 04:32</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/12213</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2024-07-07 03:43</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/12213 is merged, maybe we can close this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-07 04:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:55 UTC
    </footer>
</body>
</html>
