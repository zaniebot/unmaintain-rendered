<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff 2026 Style Guide - astral-sh/ruff #20482</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Ruff 2026 Style Guide</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/20482">#20482</a>
        opened by <a href="https://github.com/dylwil3">@dylwil3</a>
        on 2025-09-19 13:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-09-19 13:37</div>
            <div class="timeline-body"><p>From <a href="https://github.com/psf/black/blob/main/CHANGES.md">Black's changelog</a> and <a href="https://github.com/psf/black/blob/43135e9fafccbca723910a45aa62f0f182e85e5f/src/black/mode.py#L223"><code>Preview</code> enum</a>. Last checked 19.09.2025, Last release: v25.9.0.</p>
<p>Goals:</p>
<ul>
<li>Close parity with Black when migrating from Black to Ruff</li>
<li>Fix Ruff specific bugs</li>
<li>Innovate on local formatting (to keep close parity with black)</li>
</ul>
<h2>Preview Styles</h2>
<h3>Stabilized in Black and not available in Ruff (even in preview)</h3>
<ul>
<li>[ ] <a href="https://github.com/psf/black/pull/4312"><code>remove_lone_list_item_parens</code></a></li>
<li>[x] https://github.com/astral-sh/ruff/issues/9745  -- progress towards this here https://github.com/astral-sh/ruff/pull/21110</li>
</ul>
<h3>Black preview styles</h3>
<ul>
<li>[x] <a href="https://github.com/psf/black/pull/3440"><code>wrap_long_dict_values_in_parens</code></a> Non-goal, see https://github.com/psf/black/issues/4123 and https://github.com/astral-sh/ruff/issues/12856</li>
<li>[ ] <a href="https://github.com/psf/black/pull/4489"><code>always_one_newline_after_import</code></a> This is enforced by <a href="https://docs.astral.sh/ruff/rules/unsorted-imports/#unsorted-imports-i001">unsorted-imports (I001)</a> and configurable via <a href="https://docs.astral.sh/ruff/settings/#lint_isort_lines-after-imports"><code>lines-after-imports</code></a>. There is already some small conflict with the formatter depending on how the user configures this, and this may cause a little more. Unsure about this one...</li>
<li>[ ] <a href="https://github.com/psf/black/pull/4552"><code>fix_fmt_skip_in_one_liners</code></a> https://github.com/astral-sh/ruff/pull/20633</li>
<li>[x] <a href="https://github.com/psf/black/pull/4699"><code>wrap_comprehension_in</code></a><ul>
<li>https://github.com/astral-sh/ruff/pull/21005</li>
</ul>
</li>
<li>[x] <a href="https://github.com/psf/black/pull/4720"><code>remove_parens_around_except_types</code></a><ul>
<li>https://github.com/astral-sh/ruff/pull/20768</li>
</ul>
</li>
<li>[x] <a href="https://github.com/psf/black/pull/4710"><code>normalize_cr_newlines</code></a> Already handled by Ruff https://github.com/astral-sh/ruff/issues/20482#issuecomment-3314361284</li>
</ul>
<h3>Black unstable styles</h3>
<ul>
<li>[x] <a href="https://black.readthedocs.io/en/latest/the_black_code_style/future_style.html#labels-string-processing"><code>string_processing</code></a> Non-goal, various issues https://github.com/psf/black/issues?q=is%3Aissue%20state%3Aopen%20string_processing</li>
<li>[x] <a href="https://github.com/psf/black/pull/3964"><code>hug_parens_with_braces_and_square_brackets</code></a> Note this is already implemented as a Ruff preview feature (see below). So marking this as &quot;done&quot; here, and deferring to the below list for whether to stabilize. See also https://github.com/astral-sh/ruff/issues/11375</li>
<li>[x] <a href="https://github.com/psf/black/pull/1879"><code>multiline_string_handling</code></a> According to 2025 issue: &quot;non goal. Maybe a simplified version of it that only joins implicitly concatenated strings&quot;</li>
</ul>
<h3>Ruff preview styles</h3>
<p>Ruff specific preview styles that we may want to stabilize</p>
<ul>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/8279"><code>hug_parens_with_braces_and_square_brackets</code></a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/pull/17216"><code>no_chaperone_for_escaped_quote_in_triple_quoted_docstring</code></a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/18865"><code>blank_line_before_decorated_class_in_stub</code></a></li>
</ul>
<h3>Ruff improvements</h3>
<h2>Open Bugs</h2>
<p>Existing bugs in the ruff formatter for which no preview style exists.</p>
<h3>Require a new style guide</h3>
<p>Bug fixes that change how existing code is formatted and require a breaking change.</p>
<ul>
<li>[x] <a href="https://github.com/astral-sh/ruff/issues/17796">Unnecessary parantheses to long patterns with <code>as</code> captures</a> https://github.com/astral-sh/ruff/pull/21176<ul>
<li>https://github.com/astral-sh/ruff/pull/21176</li>
</ul>
</li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/11857">Dict key split to multiline (deviation from black)</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/13761">Ruff splits subscript targets instead of parenthesizing the value</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/11254">Handling of blank lines between module docstring and a comment</a> (unclear if it requires a new style guide) @konstin</li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/11820">Parenthesize assignment values that fit into the line length</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/8179">Handle over-long lambda expressions</a> (possibly requires a new style guide)</li>
</ul>
<h3>Bug fixes that don't change existing formatting</h3>
<p>Bug fixes that don't require a new style guide because they don't change existing code</p>
<ul>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/19603">Range formatting does not handle whitespace before new classes</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/19492">Formatter inserts trailing newline at the end of a file even when inside a fmt: off region</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/17331">Not respecting <code>fmt: skip</code></a> (possibly related to <code>fix_fmt_skip_in_one_liners</code> Black preview style)</li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/10275">Preserve trailing whitespace in docstring examples</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/11480">Incorrect docstring code block formatting for statement sequences</a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/9958">Handling of empty lines after <code>;</code></a></li>
<li>[ ] <a href="https://github.com/astral-sh/ruff/issues/11430">Suppressing statement sequences</a></li>
<li>[x] <a href="https://github.com/astral-sh/ruff/issues/11216">Using <code>fmt:skip</code> to suppress compound statements</a><ul>
<li>https://github.com/astral-sh/ruff/pull/20633</li>
</ul>
</li>
<li>[x] <a href="https://github.com/astral-sh/ruff/issues/19350">Parenthesized expression with comment on right hand side in assignment produces invalid syntax</a><ul>
<li>https://github.com/astral-sh/ruff/pull/20418</li>
</ul>
</li>
<li>[x] <a href="https://github.com/astral-sh/ruff/issues/19226">Fuzzer: comment in middle of operand causes panic</a><ul>
<li>https://github.com/astral-sh/ruff/pull/21501</li>
</ul>
</li>
<li>[x] <a href="https://github.com/astral-sh/ruff/issues/19138">Fuzzer: debug assert on dangling comments failed</a><ul>
<li>https://github.com/astral-sh/ruff/pull/20561</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @dylwil3 on 2025-09-19 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @dylwil3 on 2025-09-19 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @dylwil3 on 2025-09-19 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/s-banach">@s-banach</a> on 2025-09-20 00:54</div>
            <div class="timeline-body"><blockquote>
<p>Ruff specific preview styles that we may want to stabilize</p>
<ul>
<li>[ ]  <a href="https://github.com/astral-sh/ruff/issues/8279"><code>hug_parens_with_braces_and_square_brackets</code></a></li>
</ul>
</blockquote>
<p>I have been using ruff format with <code>preview = true</code> since 2023, just for this one feature.
The only reason I'm reading this issue is to see whether it will be stabilized.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2025-09-20 01:24</div>
            <div class="timeline-body"><p><code>ruff</code> already has the behavior from <code>normalize_cr_newlines</code>. I guess it was technically a formatting deviation before? But like usual no one noticed because dealing with newlines is so annoying.</p>
<details>

<summary>Demonstrating difference</summary>

<p>Input code powershell escaped: <code>&quot;a`rb`nc`r`n#1&quot;</code>
Input code backslash escaped: <code>a\rb\nc\r\n#1\r\n</code></p>
<p>|Formatter|Escaped Output|
|-----------|-----------------|
|Black 25.9.0 no preview|<code>a\nb\nc\n# 1\n</code>|
|ruff format|<code>a\rb\rc\r# 1\r</code>|
|Black 25.9.0 preview|<code>a\rb\rc\r# 1\r</code>|</p>
<p>Input code without visible newlines:</p>
<pre><code class="language-py">a
b
c
#1
</code></pre>
<p>Input code with written out newlines:</p>
<pre><code class="language-py">a&lt;cr&gt;
b&lt;nl&gt;
c&lt;cr&gt;&lt;nl&gt;
#1&lt;cr&gt;&lt;nl&gt;
</code></pre>
<p>Where the <code>#1</code> at the end is to cause the reformatting.</p>
<pre><code class="language-powershell">PS ~\Desktop\New_folder&gt;Set-Content issue.py &quot;a`rb`nc`r`n#1&quot;
PS ~\Desktop\New_folder&gt;Get-Escaped-Content issue.py
a\rb\nc\r\n#1\r\n
PS ~\Desktop\New_folder&gt;uvx black issue.py
reformatted issue.py

All done! ‚ú® üç∞ ‚ú®
1 file reformatted.
PS ~\Desktop\New_folder&gt;Get-Escaped-Content issue.py
a\nb\nc\n# 1\n
PS ~\Desktop\New_folder&gt;Set-Content issue.py &quot;a`rb`nc`r`n#1&quot;
PS ~\Desktop\New_folder&gt;uvx ruff format issue.py
1 file reformatted
PS ~\Desktop\New_folder&gt;Get-Escaped-Content issue.py
a\rb\rc\r# 1\r
PS ~\Desktop\New_folder&gt;Set-Content issue.py &quot;a`rb`nc`r`n#1&quot;
PS ~\Desktop\New_folder&gt;uvx black issue.py --preview
reformatted issue.py

All done! ‚ú® üç∞ ‚ú®
1 file reformatted.
PS ~\Desktop\New_folder&gt;Get-Escaped-Content issue.py
a\rb\rc\r# 1\r
</code></pre>
<p>Where <code>Get-Escaped-Content</code> is a custom powershell function specifically to help deal with these annoying newlines:</p>
<pre><code class="language-powershell">function Get-Escaped-Content {
	param (
		$Path
	)
	return Get-Content $Path -Raw | ForEach-Object { $_ -replace &quot;\n&quot;, &quot;\n&quot;} | ForEach-Object { $_ -replace &quot;\r&quot;, &quot;\r&quot;}
}
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-20 11:12</div>
            <div class="timeline-body"><p>For reference the tracking issue for the <a href="https://github.com/astral-sh/ruff/issues/13371">2025 style guide</a>.</p>
<ul>
<li>It was an intentional decision not to implement <code>https://github.com/psf/black/pull/3440</code> because of https://github.com/astral-sh/ruff/issues/12856.</li>
<li>The unstable styles are styles that black doesn't consider &quot;ready&quot; yet because of bugs. We should focus on the preview sytles first (but it's good to work on unstable styles in case black fixes all remaining issues and promotes them to preview and then stable)</li>
<li><code>multiline_string_handling</code>: Ruff now automatically joins implicitly concatenated strings. That's as far as we want to go for now.</li>
<li>I'm not sure what <code>string_processing</code> is</li>
<li>We should consider implementing and shipping https://github.com/astral-sh/ruff/issues/9745 (requires some design, maybe there's a middle ground that we dont' need to go as far as black)</li>
<li>There are also some black 2025 style changes that we didn't implement, see https://github.com/astral-sh/ruff/issues/15927</li>
</ul>
<p>@vlkorsakov is there a specific change that you dislike or do you dislike style changes in general?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2025-09-20 16:01</div>
            <div class="timeline-body"><p>Ruff already has part of <code>string_processing</code> in that <a href="https://docs.astral.sh/ruff/formatter/black/#implicit-concatenated-strings">short string literals will be merged</a> . Also part of it is splitting long string literals, see <a href="https://black.readthedocs.io/en/latest/the_black_code_style/future_style.html#improved-string-processing">the docs</a> for more info, but <code>string_processing</code> is almost certainly going to remain unstable for 2026. See the 2024 Black Stable Style issue https://github.com/psf/black/issues/4042 for more details, but there are still many outstanding serious issues https://github.com/psf/black/issues?q=is%3Aissue%20state%3Aopen%20string_processing . (But it also won't be removed since there are a ton of people that like it, so it's stuck in a difficult place)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-09-26 20:34</div>
            <div class="timeline-body"><p>It looks like the preview style <code>wrap_comprehension_in</code> also results in quite a few added parentheses: https://github.com/psf/black/blob/903bef54aa72e111c034ccec9997aac82bafbacc/tests/data/cases/preview_wrap_comprehension_in.py</p>
<p>So we may get into a similar situation as with https://github.com/astral-sh/ruff/issues/12856</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../brgl/libgpiod/issues/156.html">brgl/libgpiod#156</a> on 2025-10-14 15:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/21005.html">astral-sh/ruff#21005</a> on 2025-10-20 21:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-10 08:21</div>
            <div class="timeline-body"><p>Black published a <a href="https://github.com/psf/black/releases/tag/25.11.0">new release</a> today and they moved multiline_string from unstable into preview. We should double check how their multiline string handling differs from our (I might have confused it with the <a href="https://black.readthedocs.io/en/latest/the_black_code_style/future_style.html#labels-string-processing">string_processing</a> unstable style)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-11-10 18:54</div>
            <div class="timeline-body"><p>I tried updating our Black tests again, and the only changes to the multiline string styles were from this PR: https://github.com/psf/black/pull/4760, deleting some of the cases that I think do relate more to <code>string_processing</code>. So our <a href="https://github.com/astral-sh/ruff/blob/main/crates/ruff_python_formatter/tests/snapshots/black_compatibility%40cases__preview_multiline_strings.py.snap"><code>preview_multiline_strings</code> snapshot</a> should still accurately reflect how closely we match Black.</p>
<p>Mostly it looks like we insert more breaks around multiline strings:</p>
<p>https://github.com/astral-sh/ruff/blob/deeda5690617162bf7c7364a2cb3faa69e880a19/crates/ruff_python_formatter/tests/snapshots/black_compatibility%40cases__preview_multiline_strings.py.snap#L336-L345</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2025-11-10 23:22</div>
            <div class="timeline-body"><p>Does ruff have anything planned for https://github.com/astral-sh/ruff/issues/12856 ? Especially curious about <code>parenthesize_conditional_expressions</code> , I get asked about that at work sometimes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-11 10:49</div>
            <div class="timeline-body"><blockquote>
<p>I tried updating our Black tests again, and the only changes to the multiline string styles were from this PR</p>
</blockquote>
<p>I see. I suggest we wait then. Ruff uses some heuristics to preserve the indent for multiline strings to reduce the diff compared to the old style guide and I remember that it was a main concern for Black when they considered stabilizing in previous years. We can always follow along next year if the change works well for Black.</p>
<blockquote>
<p>Does ruff have anything planned for https://github.com/astral-sh/ruff/issues/12856 ? Especially curious about parenthesize_conditional_expressions , I get asked about that at work sometimes</p>
</blockquote>
<p>Unfortunately not. I very much hope that we'll have more dedicated time to improve Ruff's style guide next year. Shipping https://github.com/astral-sh/ruff/issues/12856 probably also requires formatter editions (that are independent of the ruff version), because I expect the diff compared to the current style guide to be rather large. You can upvote (or comment on) https://github.com/astral-sh/ruff/issues/12856 or https://github.com/astral-sh/ruff/issues/9722 specifically. This would help us prioritize the work next year.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/laymonage">@laymonage</a> on 2025-11-11 14:47</div>
            <div class="timeline-body"><p>I'd like to suggest #21380 to be included in the &quot;Stabilized in Black and not available in Ruff (even in preview)&quot; section, next to #21110 that has been released. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../psf/black/issues/4875.html">psf/black#4875</a> on 2025-11-29 15:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dylwil3">@dylwil3</a> on 2025-12-06 00:44</div>
            <div class="timeline-body"><p>Black added a new preview style on <code>main</code> (not yet released): https://github.com/psf/black/pull/4865</p>
<p>Removes LHS parentheses in examples such as</p>
<pre><code class="language-python">(b) = a()[0]
(c, *_) = a()
</code></pre>
<p>At the moment we preserve the user's parentheses or lack thereof.</p>
<p>I'm sort of okay making this a preview style, but I would hesitate stabilizing for 2026 - it seems like not a huge improvement but would cause big diffs everywhere.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-06 12:36</div>
            <div class="timeline-body"><blockquote>
<p>I'm sort of okay making this a preview style, but I would hesitate stabilizing for 2026 - it seems like not a huge improvement but would cause big diffs everywhere.</p>
</blockquote>
<p>I'm not sure I follow the reasoning here. The diff size doesn't depend on when we stabilize it; it's only defined by the change itself.</p>
<p>Removing the parentheses around tuples requires matching on the target and call the tuple formatting with <code>TupleParentheses::NeverPreserve</code>.</p>
<p>Removing unnecessary parentheses around <code>(b)</code> might be slightly trickier. I do agree that this isn't a change that we need to rush and I'd keep our existing prioritization:</p>
<ul>
<li>method chain formatting</li>
<li>fmt:skip bug</li>
<li>subscript issue</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-09 08:34</div>
            <div class="timeline-body"><p>Regarding: <code>(c, *_) = a()</code>. We intentionally preserve tuple parentheses in more places than black because it can be very easy to miss that something's a tuple if the parentheses are missing. I don't remember the exact details but we should ensure we preserve parentheses in assignment targets the same as we do in assignment values.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
