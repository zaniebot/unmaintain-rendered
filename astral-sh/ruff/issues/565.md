```yaml
number: 565
title: "feat: Ambiguous character detection"
type: issue
state: closed
author: samuelcolvin
labels:
  - rule
assignees: []
created_at: 2022-11-03T10:35:18Z
updated_at: 2022-11-09T15:24:20Z
url: https://github.com/astral-sh/ruff/issues/565
synced_at: 2026-01-10T01:56:44Z
```

# feat: Ambiguous character detection

---

_Issue opened by @samuelcolvin on 2022-11-03 10:35_

vscode identifies ambiguous unicode characters and warns about them, screenshot:

![image](https://user-images.githubusercontent.com/4039449/199698850-608984e7-0422-4b8c-95b8-e8067a5b6205.png)

It would be great if ruff could do the same. I guess most useful in comments and docstrings, but I guess could also be useful in any string - though you might get false positives.

I :heart: sourcegraph, it makes finding this stuff much easier in big codebases, [here](https://sourcegraph.com/github.com/microsoft/vscode@86f0f9bfa268fe21af7efae37d8f0da1dba8137f/-/blob/src/vs/base/common/strings.ts?L1094) is the raw data used by vscode, see also https://github.com/hediet/vscode-unicode-data.

This idea came from https://github.com/pydantic/pydantic/pull/4714 thanks to @adriangb.


---

_Referenced in [pydantic/pydantic#4714](../../pydantic/pydantic/pulls/4714.md) on 2022-11-03 13:19_

---

_Label `rule` added by @charliermarsh on 2022-11-03 13:19_

---

_Comment by @samuelcolvin on 2022-11-03 13:22_

Great, ye I was thinking auto-fixing would be great, not sure if the available dataset includes the substitution characters, but I would assume it does.

---

_Referenced in [astral-sh/ruff#577](../../astral-sh/ruff/issues/577.md) on 2022-11-04 03:24_

---

_Comment by @charliermarsh on 2022-11-04 03:29_

Coming together:

![Screen Shot 2022-11-03 at 11 29 08 PM](https://user-images.githubusercontent.com/1309177/199879066-1017f334-a5f6-469f-a2bf-2f379dcfb3c1.png)


---

_Comment by @charliermarsh on 2022-11-04 03:30_

Any input on what the error code should be for this? (E.g., I just used `X001` above.) It's one of the first rules that isn't indexed based on another plugin's coding.


---

_Referenced in [astral-sh/ruff#578](../../astral-sh/ruff/pulls/578.md) on 2022-11-04 03:39_

---

_Comment by @samuelcolvin on 2022-11-04 08:56_

I think the above wording looks great.

---

_Comment by @samuelcolvin on 2022-11-04 08:58_

What did you decide about docstrings, comments, strings?

Thinking about it, imagine I would want the error in all places. I guess if you used a different error code, people could easily switch it off in strings.

---

_Comment by @charliermarsh on 2022-11-04 15:02_

For now it's just doing errors in strings (including docstrings). I could add comments too. I'm hesitant to check _every_ character in every file since it's hard to make that fast.

---

_Closed by @charliermarsh on 2022-11-04 16:08_

---

_Comment by @charliermarsh on 2022-11-04 16:08_

I'm going to make a separate task for comments.

---

_Comment by @samuelcolvin on 2022-11-04 16:43_

Makes sense, but I do think a different code for strings vs docstrings would be good - there are legimate reasons to use unicode characters in strings that are unlike to be intentional in docstrings.

---

_Comment by @charliermarsh on 2022-11-04 16:44_

Okay, sounds good, I can change that.

---

_Comment by @charliermarsh on 2022-11-04 18:46_

Resolved in https://github.com/charliermarsh/ruff/pull/590.

---

_Comment by @charliermarsh on 2022-11-09 15:24_

Comment support went out in #653 as `RUF003`.

---
