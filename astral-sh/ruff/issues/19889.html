<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff crashes when pyproject.toml is being edited - astral-sh/ruff #19889</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Ruff crashes when pyproject.toml is being edited</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/19889">#19889</a>
        opened by <a href="https://github.com/luluxxxlulu">@luluxxxlulu</a>
        on 2025-08-13 01:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/luluxxxlulu">@luluxxxlulu</a> on 2025-08-13 01:40</div>
            <div class="timeline-body"><p>While I was editing <code>pyproject.toml</code>, the Ruff extension crashed. I know why, because the syntax was temporarily invalid. However, I don't think this should cause a crash. Perhaps Ruff should keep its current configuration until the <code>pyproject.toml</code> file becomes parse-able again.</p>
<p><img width="1355" height="427" alt="Image" src="https://github.com/user-attachments/assets/a4f9c633-337a-47b8-83b1-dbfadca40aac" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-13 04:47</div>
            <div class="timeline-body"><p>When you say it crashes, does it stop working? IIRC, it should mainly log the error and use the default settings, which is obviously not correct as it should use the last known valid settings instead.</p>
<p>Related: astral-sh/ruff-vscode#711</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @dhruvmanila on 2025-08-13 04:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @dhruvmanila on 2025-08-13 04:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-13 04:47</div>
            <div class="timeline-body"><p>(I'm going to move this to the Ruff repository as it's related to the language server and not the extension specifically.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @dhruvmanila on 2025-08-13 04:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/luluxxxlulu">@luluxxxlulu</a> on 2025-08-13 05:56</div>
            <div class="timeline-body"><p>Hi @dhruvmanila thank you for the quick response. It shows an error pop-up in visual studio every time you type something, given that <code>pyproject.toml</code>'s syntax remains invalid. I think it is an issue because it is unnecessarily distracting. This is what the pop-up looks like:</p>
<p><img width="475" height="164" alt="Image" src="https://github.com/user-attachments/assets/fea1ae9b-fb9d-4a70-8782-e7910a119921" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-13 06:21</div>
            <div class="timeline-body"><p>Ah, yes, it will also show a popup.</p>
<p>So, this must be coming from <code>workspace/didChangeWatchedFiles</code> notification. I think we would need to separately handle a fresh indexing of the project and the reload settings part and only show a notification on the fresh indexing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-13 07:09</div>
            <div class="timeline-body"><p>I think showing the notification after changes were made is useful because a user might indeed have made an unintentional mistake.</p>
<p>We could track internally if the settings are currently valid and only show the warning if it goes from valid -&gt; invalid. That's probably still somewhat distracting. An alternative is to add a debounce or something. It's definetely tricky to find the right balance here between letting users know that Ruff isn't working as expected vs being noisy</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
