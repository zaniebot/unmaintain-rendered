<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>F523: Single variable leads to literal rendering of newline - astral-sh/ruff #4826</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>F523: Single variable leads to literal rendering of newline</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/4826">#4826</a>
        opened by <a href="https://github.com/addisoncrump">@addisoncrump</a>
        on 2023-06-03 05:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/addisoncrump">@addisoncrump</a> on 2023-06-03 05:10</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<h2>Reproduction</h2>
<p>The following snippet is a minimal reproduction:</p>
<pre><code class="language-py">x = 5
&quot;\n&quot;.format(x)
</code></pre>
<p>The fix attempted:</p>
<pre><code class="language-py">x = 5
&quot;
&quot;.format(x)
</code></pre>
<h2>Command line</h2>
<pre><code class="language-bash">ruff check format2.py --fix --isolated
</code></pre>
<h2>Version information</h2>
<p>Built on e82160a83a76c11d04d727ee2349091351e63b32 (latest, bleeding).</p>
<h2>Misc</h2>
<p>Discovered by #4822.</p>
<p>This is potentially a duplicate of #4823, but I couldn't diagnose a root cause. Notably, I chose to open a separate issue because, where #4823 causes an incorrect replacement of single quotes with double quotes, this issue literally renders the content of a string (!) and may have a separate root cause.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-06-04 02:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-04 02:04</div>
            <div class="timeline-body"><p>I think we should rewrite the F523 fix to use LibCST.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-06-05 04:34</div>
            <div class="timeline-body"><p>This got fixed in d8a6109b698f4a53475926e88efc3907fd0386ad:</p>
<pre><code class="language-diff">--- /Users/dhruv/playground/ruff/src/F523.py
+++ /Users/dhruv/playground/ruff/src/F523.py
@@ -1,2 +1,2 @@
 x = 5
-&quot;\n&quot;.format(x)
+&quot;\n&quot;.format()

Would fix 1 error.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-05 16:03</div>
            <div class="timeline-body"><p>I think it will still do the wrong thing in some cases, like if we need to rewrite the string to remove positionals, in which case we end up reconstructing from the AST.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-06-05 18:29</div>
            <div class="timeline-body"><p>Actually, I don't think we can use LibCST for this. It doesn't include a format-string parser. Instead, we probably need to change the format-string parser to include ranges on the various pieces, so that we can update the string in-place rather than recreate it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4883.html">astral-sh/ruff#4883</a> on 2023-06-05 21:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-06-06 00:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4972.html">astral-sh/ruff#4972</a> on 2023-06-09 22:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:09 UTC
    </footer>
</body>
</html>
