<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Feature Request] Sort dict keys - astral-sh/ruff #10085</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>[Feature Request] Sort dict keys</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/10085">#10085</a>
        opened by <a href="https://github.com/Tatsh">@Tatsh</a>
        on 2024-02-22 21:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Tatsh">@Tatsh</a> on 2024-02-22 21:53</div>
            <div class="timeline-body"><p>Would be nice and I did not find this feature already being requested.</p>
<p>ESLint has this feature: <a href="https://eslint.org/docs/latest/rules/sort-keys">sort-keys</a>. Should have options like case-sensitivity, minimum keys, natural, asc/desc. <code># noqa: ...</code> should disable the requirement and stop the auto-fixer.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @MichaReiser on 2024-02-23 07:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-26 11:45</div>
            <div class="timeline-body"><p>Thanks for the feature request! For reference, this is similar to a few issues that have been opened before:</p>
<ul>
<li>https://github.com/astral-sh/ruff/issues/6175</li>
<li>https://github.com/astral-sh/ruff/issues/7929</li>
<li>#7220</li>
</ul>
<p>However, I think we should keep this open. The first two of those issues were closed in favour of #1198, which was closed out without implementing this specific feature. The third is different enough to this that it could be considered separate.</p>
<p>I'm not sure I'd want to turn on this rule in my Python projects, since Python dictionaries maintain insertion order when you iterate through them (they have been guaranteed to do so by the language spec since Python 3.7), and I've written code in the past that's relied on that useful property. That means that the autofix proposed here has the potential to break working code. The only Python builtin collections where it would be safe to autosort the collection are sets and frozensets, since those are the only two that do not maintain insertion order.</p>
<p>Nonetheless, it does seem like there's a fair amount of user demand for this feature, and I gather the ESLint rule also has the potential to change the iteration order of a JavaScript object. So I think we should consider having a rule like this. If we're sorting dictionary keys, though, we may as well also sort list, tuples and sets, since we'd already be doing something pretty unsafe by sorting dictionary keys.</p>
<p>One open question is whether enabling this rule should sort <em>all</em> collections? <code>isort</code> has a feature where collections that are marked with an <code># isort: unique-list</code> comment are deduplicated and sorted -- we could possibly consider doing something similar.</p>
<ul>
<li>The advantage is that it neatly works around the safety issues (we'd only be sorting collections where the user has explicitly asked us to do so).</li>
<li>The disadvantages are:<ul>
<li>It's another pragma comment for users to have to remember/more configuration is really confusing</li>
<li>It's more verbose to have to add a comment next to every collection you want to be sorted like this.</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @AlexWaygood on 2024-02-26 11:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-26 12:39</div>
            <div class="timeline-body"><blockquote>
<p>we may as well also sort list, tuples and sets, since we'd already be doing something pretty unsafe by sorting dictionary keys.</p>
</blockquote>
<p>It would be worth having different rules, at least for lists. I've used object sorting in very large code bases in JS with very little need to suppress the rules because it's uncommon that the ordering matters (at least in the projects I worked). However, that's different for lists where ordering is more likely to be semantically meaningful (or I would have used a set).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JelleZijlstra">@JelleZijlstra</a> on 2024-02-29 06:20</div>
            <div class="timeline-body"><p>I would like this specifically for set (I realize that's not what the issue is about). Sets don't have insertion ordering, so unlike with dicts or lists, there isn't as much of a concern about changing behavior. For example, it would be nice if Ruff sorted <a href="https://github.com/JelleZijlstra/taxonomy/blob/19b4c707e961a6a800d6b2f4bfaeb41d608f2140/taxonomy/parsing.py#L88">this set</a> so it's easier to keep track of which letters are in it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-29 07:58</div>
            <div class="timeline-body"><blockquote>
<p>I would like this specifically for set (I realize that's not what the issue is about). Sets don't have insertion ordering, so unlike with dicts or lists, there isn't as much of a concern about changing behavior. For example, it would be nice if Ruff sorted <a href="https://github.com/JelleZijlstra/taxonomy/blob/19b4c707e961a6a800d6b2f4bfaeb41d608f2140/taxonomy/parsing.py#L88">this set</a> so it's easier to keep track of which letters are in it.</p>
</blockquote>
<p>Yeah, I agree that it makes much more sense for sets than any other data structure. I wonder if this should be multiple rules â€” or one, configurable rule.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/18649.html">astral-sh/ruff#18649</a> on 2025-06-12 17:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/akx">@akx</a> on 2025-07-09 10:15</div>
            <div class="timeline-body"><p>I think a per-expression <code># fmt: sort</code> directive could be useful instead of/in addition to a blanket rule.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:12 UTC
    </footer>
</body>
</html>
