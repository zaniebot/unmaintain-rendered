<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff needs to formats files 2 times until there is nothing to format - astral-sh/ruff #7433</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff needs to formats files 2 times until there is nothing to format</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/7433">#7433</a>
        opened by <a href="https://github.com/qarmin">@qarmin</a>
        on 2023-09-16 09:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/qarmin">@qarmin</a> on 2023-09-16 09:40</div>
            <div class="timeline-body"><p>Ruff 0.0.289</p>
<p>Ruff after formating this files once, needs to format them again, because looks that not everything is applied after first run</p>
<p><a href="https://github.com/astral-sh/ruff/files/12640339/DOWNLOADED.zip">Example1</a></p>
<p>Here are 3 files - A2.py is original, A1.py after first run of ruff format and A0.py after second run</p>
<pre><code>--- A2.py	2023-09-16 11:33:41.426063461 +0200
+++ A1.py	2023-09-16 11:34:05.873498261 +0200
@@ -32,8 +32,8 @@
 
 def get_rocm_smi_stats() -&gt; Dict[str, Any]:
     command = [str(ROCM_SMI_CMD), &quot;-a&quot;, &quot;--json&quot;]
-    output = (
-        subprocess.check_output(command, universal_newlines=True).strip().split(&quot;\n&quot;)
+    output = subprocess.check_output(command, universal_newlines=True).strip().split(
+        &quot;\n&quot;
     )[0]
     return json.loads(output)  # type: ignore

</code></pre>
<pre><code>--- A1.py	2023-09-16 11:34:05.873498261 +0200
+++ A0.py	2023-09-16 11:34:15.089285492 +0200
@@ -32,9 +32,9 @@
 
 def get_rocm_smi_stats() -&gt; Dict[str, Any]:
     command = [str(ROCM_SMI_CMD), &quot;-a&quot;, &quot;--json&quot;]
-    output = subprocess.check_output(command, universal_newlines=True).strip().split(
-        &quot;\n&quot;
-    )[0]
+    output = (
+        subprocess.check_output(command, universal_newlines=True).strip().split(&quot;\n&quot;)[0]
+    )
     return json.loads(output)  # type: ignore
</code></pre>
<p>more files with same problems(28)</p>
<p><a href="https://github.com/astral-sh/ruff/files/12640340/broken_files.zip">broken_files.zip</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-09-16 13:16</div>
            <div class="timeline-body"><p>Thanks! Internally we refer to this as an &quot;instability&quot;. Instabilities are always bugs. (We have tests for this over a few projects.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-09-16 13:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @charliermarsh on 2023-09-16 13:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Formatter: Beta" by @charliermarsh on 2023-09-16 13:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2023-09-16 14:22</div>
            <div class="timeline-body"><p>Thanks. Identifying instabilities is extremely useful (and maybe something a fuzzer can do well). This seems to be fixed as of https://github.com/astral-sh/ruff/pull/7409</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2023-09-16 14:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9169.html">astral-sh/ruff#9169</a> on 2023-12-18 03:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:51 UTC
    </footer>
</body>
</html>
