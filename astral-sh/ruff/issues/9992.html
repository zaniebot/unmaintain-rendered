<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Option to vertically format arguments if wrapped. - astral-sh/ruff #9992</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Option to vertically format arguments if wrapped.</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/9992">#9992</a>
        opened by <a href="https://github.com/funkybob">@funkybob</a>
        on 2024-02-15 01:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/funkybob">@funkybob</a> on 2024-02-15 01:13</div>
            <div class="timeline-body"><p>Would it be possible to add a formatter option so that once it decides to split arguments to a call onto a new line, each argument goes on its own line?</p>
<p>So, for example, when it chooses to reformat:</p>
<pre><code>foo = bar(long_name=value, another_argument=1, something_else=&quot;12314&quot;)
</code></pre>
<p>into:</p>
<pre><code>foo = bar(
    long_name=value, another_argument=1, something_else=&quot;12314&quot;
)
</code></pre>
<p>it will instead produce:</p>
<pre><code>foo = bar(
    long_name=value,
    another_argument=1,
    something_else=&quot;12314&quot;
)
</code></pre>
<p>(and ideally also add the trailing comma, but that's a separate formatting option, I assume)</p>
<p>I know I can force this formatting to be retained by using the magic trailing comma, but I'd like to not have to think about this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @dhruvmanila on 2024-02-15 04:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @dhruvmanila on 2024-02-15 04:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @MichaReiser on 2024-02-15 09:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @MichaReiser on 2024-02-15 09:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @MichaReiser on 2024-02-15 09:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @MichaReiser on 2024-02-15 09:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-15 09:54</div>
            <div class="timeline-body"><p>Hy @funkybob</p>
<p>The main request in this issue is to have an option to disable the style where ruff tries to format all arguments on a single line before splitting each argument on a separate line. Ruff should already add the trailing comma as you want it to: It adds the trailing comma when each argument is on its own line, but it omits it when formatting all arguments on a single line (the style that you don't want to have).</p>
<p>We're still considering our position on how configurable our formatter should be. There are arguments for an opinionated formatter with very few options. But supporting many options also has its benefits. For now, our position is to avoid formatting style-related options, which includes the option you're asking for.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benblank">@benblank</a> on 2024-09-07 23:08</div>
            <div class="timeline-body"><p>If ruff prefers to avoid configurable formatting, then I think there's a case to be made that &quot;one argument per line&quot; should be how calls like this are wrapped.</p>
<p>Basically, the point of wrapping code is to improve readability, right? Long, unbroken lines may extend past the edge of a reading area and also tend to be more difficult to parse visually. Good wrapping helps with both of those issues.</p>
<p>But this kind of &quot;function name, then every-argument-on-a-single-line, then close parenthesis&quot; wrapping doesn't really do a lot for line lengths. This is especially noticeable with short function names; in funkybob's second example, the indented arguments line is only seven characters shorter than the original! A few more keystrokes, and it'll need rewrapped anyway.</p>
<p>I also don't think it does hardly anything for visual parsing; again, looking at the examples above, it's <em>really easy</em> to quickly spot that there are three arguments in the last example. But I find myself having to sort of stop-and-count-the-equals-signs in the other two. Putting each argument on a separate line makes a big difference for readability, I believe.</p>
<p>Finally, there's also a sense in which it seems oddly inconsistent to me. It feels like there's a kind of &quot;gap&quot; between calls which are short enough to not need wrapped at all and those which are long enough that all the arguments can't be made to fit on a single line, anyway. In between the two, there's this kind of &quot;partial wrapping&quot; which triples the vertical space taken by the call but often doesn't significantly reduce the horizontal space, nor improve readability much.</p>
<p><strong>TL;DR:</strong> If ruff is going to have only one wrapping behavior in this scenario, I think it should be the one funkybob describes, not it's current behaviorâ€¦ even though it would be a breaking change. ðŸ˜“</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alexei">@alexei</a> on 2024-10-30 13:48</div>
            <div class="timeline-body"><p>Because sometimes ruff puts each argument on its own line, and sometimes it puts all arguments on the same line, I often find myself having to review the changes and make manual adjustments. I too support to either have an option to instruct ruff to lean on always adding the comma, or have that as the default behavior. This would help enforcing a consistent style, especially in larger brownfield projects.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jorenham">@jorenham</a> on 2024-10-30 16:39</div>
            <div class="timeline-body"><p>I wrote a simple <code>libcst</code> codemod that adds a trailing comma to such half-wrapped parameters, so that <code>ruff format</code> will place them onto separate lines after that:</p>
<p>https://github.com/scipy/scipy-stubs/blob/4421f887972d7b79cee22bf50fa18a179aa1195c/codegen/mods.py#L99-L122</p>
<p>But clearly this is far from ideal; as it requires running <code>ruff format</code> twice, doesn't work if <code>skip-magic-trailing-comma</code> is set, and is very slow compared to <code>ruff</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/15846.html">astral-sh/ruff#15846</a> on 2025-01-31 10:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Tatsh">@Tatsh</a> on 2025-02-18 09:10</div>
            <div class="timeline-body"><p>I would like to have the option to keep arguments aligned after the bracket:</p>
<pre><code class="language-python">func(long1,
     long2,
     long3)
</code></pre>
<p>YAPF has an implicit way of controlling the line breaks which is by adding a trailing <code>,\n)</code> to the list or function arguments:</p>
<pre><code class="language-python">foo(1, 2, 3,
)
</code></pre>
<p>becomes:</p>
<pre><code class="language-python">foo(
    1,
    2,
    3,
)
</code></pre>
<p>These are what are keeping me from switching. Please make it configurable especially since YAPF is seeming more and more like a dead project.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-02-22 17:22</div>
            <div class="timeline-body"><blockquote>
<p>disable the style where ruff tries to format all arguments on a single line before splitting each argument on a separate line</p>
</blockquote>
<p>Basically. Others have already said it in more details, but for me:</p>
<ol>
<li>I see this current behaviour as going against the idea of formatting code so that it reduces merge conflicts. (you now have wrapping style transitions instead of one).</li>
<li>It's also not any more readable. Either fit on a line, or wrap the parameters, call args, comprehension statements (ref https://github.com/astral-sh/ruff/issues/11753), etc. individually.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-02-22 17:26</div>
            <div class="timeline-body"><blockquote>
<p>I wrote a simple <code>libcst</code> codemod that adds a trailing comma to such half-wrapped parameters, so that <code>ruff format</code> will place them onto separate lines after that:</p>
<p><a href="https://github.com/jorenham/scipy-stubs/blob/dd90c64c05a8f75f684662c277278e2c35400d4f/codegen/mods.py#L97-L121">jorenham/scipy-stubs@<code>dd90c64</code>/codegen/mods.py#L97-L121</a></p>
</blockquote>
<p>Your codemod is pretty small. But I'll still point to existing work https://pypi.org/project/add-trailing-comma/ which I have used. (I appreciate your work on scipy-stubs btw!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jorenham">@jorenham</a> on 2025-02-22 17:33</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I wrote a simple <code>libcst</code> codemod that adds a trailing comma to such half-wrapped parameters, so that <code>ruff format</code> will place them onto separate lines after that:
<a href="https://github.com/jorenham/scipy-stubs/blob/dd90c64c05a8f75f684662c277278e2c35400d4f/codegen/mods.py#L97-L121">jorenham/scipy-stubs@<code>dd90c64</code>/codegen/mods.py#L97-L121</a></p>
</blockquote>
<p>Your codemod is pretty small. But I'll still point to existing work <a href="https://pypi.org/project/add-trailing-comma/">pypi.org/project/add-trailing-comma</a> which I have used.</p>
</blockquote>
<p>Oh I didn't know about this one â€” I'll give it try. Thanks for sharing</p>
<blockquote>
<p>(I appreciate your work on scipy-stubs btw!)</p>
</blockquote>
<p>That's good to to hear! Thank you for contributing to it, as well :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/PedroPerpetua">@PedroPerpetua</a> on 2025-04-15 17:30</div>
            <div class="timeline-body"><p>Seconding this issue; I'd love to have the ability to enforce this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../PedroPerpetua/django-rest-framework-boilerplate/issues/73.html">PedroPerpetua/django-rest-framework-boilerplate#73</a> on 2025-04-15 17:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ivangabriele">@ivangabriele</a> on 2025-06-11 22:14</div>
            <div class="timeline-body"><p>@funkybob Maybe we should retitle / update this proposal to &quot;Always align arguments vertically for any wrapped statement&quot;?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jorenham">@jorenham</a> on 2025-06-11 22:38</div>
            <div class="timeline-body"><p>I would prefer this be an extra option, similar to the <a href="https://rust-lang.github.io/rustfmt/?version=v1.8.0&amp;search=#trailing_comma"><code>trailing_comma</code></a> option of <code>rustfmt</code>, which can be either <code>Vertical</code> (the current behavior), <code>Always</code> (the new option), or <code>Never</code> (if disabled)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11753.html">astral-sh/ruff#11753</a> on 2025-06-11 23:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ivangabriele">@ivangabriele</a> on 2025-06-16 04:26</div>
            <div class="timeline-body"><blockquote>
<p>I would prefer this be an extra option, similar to the <a href="https://rust-lang.github.io/rustfmt/?version=v1.8.0&amp;search=#trailing_comma"><code>trailing_comma</code></a> option of <code>rustfmt</code>, which can be either <code>Vertical</code> (the current behavior), <code>Always</code> (the new option), or <code>Never</code> (if disabled)</p>
</blockquote>
<p>I may be mistaken but I think the point of this proposal is to avoid &quot;intermediate&quot; states with some wrapping cases keeping args horizontally aligned. In Rust, by default, as soon as a list of args forces a line to wrap, they are aligned vertically without any &quot;intermediary&quot; state.</p>
<p>Rust code example with a classic 80 line width:</p>
<pre><code class="language-rust">pub async fn get_dashboard_state(app_handle: AppHandle, shared_state: State&lt;'_, state::DashboardSharedState&gt;) -&gt; Result&lt;(), ()&gt; {
</code></pre>
<p>is auto-formatted like that by <code>rustfmt</code>:</p>
<pre><code class="language-rust">pub async fn get_dashboard_state(
    app_handle: AppHandle,
    shared_state: State&lt;'_, state::DashboardSharedState&gt;,
) -&gt; Result&lt;(), ()&gt; {
</code></pre>
<p>and <strong>not</strong> like that:</p>
<pre><code class="language-rust">pub async fn get_dashboard_state(
    app_handle: AppHandle, shared_state: State&lt;'_, state::DashboardSharedState&gt;,
) -&gt; Result&lt;(), ()&gt; {
</code></pre>
<p>which IMO makes it a lot more readable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/funkybob">@funkybob</a> on 2025-06-16 04:33</div>
            <div class="timeline-body"><p>@ivangabriele you are correct.</p>
<p>I find the intermediate step pointless, as it really doesn't improve readability, it just prevents a line being over the max line length.</p>
<p>In all honesty I would prefer the choice to split to arg-per-line not depend on line length; however, I'll be the first to concede that trying to determine a rule for when readability is impacted is far from trivial.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nicknicolini">@nicknicolini</a> on 2025-06-26 01:51</div>
            <div class="timeline-body"><p>@MichaReiser @ntBre i'm curious if there is an up to date viewpoint on this ticket, I think @ivangabriele has the best articulation of what is being asked for <a href="https://github.com/astral-sh/ruff/issues/9992#issuecomment-2975063491">here</a>. Was wondering if ruff devs are open to putting the behavior behind a flag and/or changing the behavior in the next formatting break</p>
<p>As it stands, ruff users are forced to choose being using ruff with imo less readable &quot;intermediary&quot; wrapped code (as outlined by Ivan above), or using a separate, slower, formatting tool in pre-commit just to achieve desired vertical formatting (e.g. <code>add-trailing-commas</code>). Both of these options are kind of a bummer coming from formatting tooling in other languages</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-26 06:56</div>
            <div class="timeline-body"><p>No, there's no update on this issue. This formatting is also not specific to arguments. The same 3-layout formatting exists for many other nodes, e.g. dictionaries and an option would have to address all of them holistically or the formatting style becomes inconsistent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/funkybob">@funkybob</a> on 2025-06-26 07:07</div>
            <div class="timeline-body"><p>If it makes any difference, if I saw the same thing happen on dicts (moving the items to a new line to avoid line limit) I'd also object.</p>
<p>If it's hard to read on one line, it's hard to read on one line; it should be split to many lines.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nicknicolini">@nicknicolini</a> on 2025-06-26 21:02</div>
            <div class="timeline-body"><blockquote>
<p>No, there's no update on this issue. This formatting is also not specific to arguments. The same 3-layout formatting exists for many other nodes, e.g. dictionaries and an option would have to address all of them holistically or the formatting style becomes inconsistent.</p>
</blockquote>
<p>@MichaReiser does that mean ruff doesn't want to make a decision here? or could a decision be made + OSS contribution on the table? i'd imagine folks on this ticket would be willing to contribute (myself included) if there's a clear decision</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-27 06:56</div>
            <div class="timeline-body"><blockquote>
<p>does that mean ruff doesn't want to make a decision here?</p>
</blockquote>
<p>No, it's just not a priority for us right now. We're focusing on features with higher demand, but we might pick this up when working on the 2026 formatter style (which is when someone has time to focus on the formatter).</p>
<blockquote>
<p>or could a decision be made + OSS contribution on the table?</p>
</blockquote>
<p>That would certainly help drive the discussion forward but it probably still has the outcome that we won't have time to make the decision before working on the new formatter style.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nicknicolini">@nicknicolini</a> on 2025-06-30 16:51</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>does that mean ruff doesn't want to make a decision here?</p>
</blockquote>
<p>No, it's just not a priority for us right now. We're focusing on features with higher demand, but we might pick this up when working on the 2026 formatter style (which is when someone has time to focus on the formatter).</p>
<blockquote>
<p>or could a decision be made + OSS contribution on the table?</p>
</blockquote>
<p>That would certainly help drive the discussion forward but it probably still has the outcome that we won't have time to make the decision before working on the new formatter style.</p>
</blockquote>
<p>sounds good, just wanted to confirm! If a decision is made on what ruff would like to support and you are open to a contribution for the change, feel free to give an update here whenever that happens. Would be willing to take a stab at it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ivangabriele">@ivangabriele</a> on 2025-08-30 13:03</div>
            <div class="timeline-body"><blockquote>
<p>No, it's just not a priority for us right now. We're focusing on features with higher demand, but we might pick this up when working on the 2026 formatter style (which is when someone has time to focus on the formatter).</p>
</blockquote>
<p>@MichaReiser I ask just in case: would a PR help or would it be useless right now regarding your roadmap? It may be non-trivial (I didn't take time to check how that part works yet) and considered a breaking change (even though we can always make that an opt-in option on the current version).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-15 09:12</div>
            <div class="timeline-body"><p>@ivangabriele A PR could help to assess the changes but, as stated above, I don't think will get to reviewing or making a decision on this before working on the 2026 style guide.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:52 UTC
    </footer>
</body>
</html>
