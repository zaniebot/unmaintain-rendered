<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FURB103 false negative when when opening in mode &quot;w+&quot; - astral-sh/ruff #20990</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>FURB103 false negative when when opening in mode &quot;w+&quot;</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/20990">#20990</a>
        opened by <a href="https://github.com/berland">@berland</a>
        on 2025-10-20 11:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/berland">@berland</a> on 2025-10-20 11:53</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>We found code that did:</p>
<pre><code class="language-python">with open(&quot;foo.sh&quot;, &quot;w+&quot;, encoding=&quot;utf-8&quot;) as f:
    f.write(&quot;something&quot;)
</code></pre>
<p>which is not picked up by <a href="https://docs.astral.sh/ruff/rules/write-whole-file/">write-whole-file (FURB103)</a> due to the <code>+</code> in the mode argument, making the file opened both in write and read mode. But the code is only writing, meaning the presence of <code>+</code> is superfluous. Should the superfluous <code>+</code> be detected by FURB103 or should some other rule catch that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-10-20 14:10</div>
            <div class="timeline-body"><p>That's interesting, thanks for the report! It does seem a bit tricky for FURB103 to be sure the <code>+</code> isn't used, so maybe a separate rule like <code>unused-open-modes</code> is a good idea. We have <a href="https://docs.astral.sh/ruff/rules/redundant-open-modes/#redundant-open-modes-up015">redundant-open-modes (UP015)</a>, but I don't think the <code>+</code> is redundant in this case, just unused.</p>
<p>Anyway, I'm curious what others think!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-10-20 14:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @ntBre on 2025-10-20 14:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amyreese">@amyreese</a> on 2025-10-21 00:21</div>
            <div class="timeline-body"><p>I agree that this feels like it belongs in a new rule, that ensures both a read/write variant method is used when opened with &quot;+&quot; mode.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
