<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARG004 with typing.Protocol - astral-sh/ruff #21279</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ARG004 with typing.Protocol</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/21279">#21279</a>
        opened by <a href="https://github.com/Lexxx42">@Lexxx42</a>
        on 2025-11-05 06:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Lexxx42">@Lexxx42</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p><a href="https://docs.astral.sh/ruff/rules/unused-static-method-argument/#unused-static-method-argument-arg004">unused-static-method-argument (ARG004)</a></p>
<p>how to pass a ruff check when using typing.Protocol?</p>
<pre><code class="language-python">from dataclasses import dataclass
from typing import Protocol


class Proto(Protocol):
    &quot;&quot;&quot;doc.&quot;&quot;&quot;
    def __call__(self, items: list[str], name: str) -&gt; bool:
        &quot;&quot;&quot;Doc.&quot;&quot;&quot;
@dataclass
class Config:
    &quot;&quot;&quot;doc.&quot;&quot;&quot;
    strategy: Proto
    msg: str
class Checker:
    &quot;&quot;&quot;doc.&quot;&quot;&quot;
    def __init__(self):
        &quot;&quot;&quot;Doc.&quot;&quot;&quot;
        self._strategies: dict[str, Config] = {
            &quot;1&quot;: Config(strategy=self._is_cool, msg=&quot;1&quot;),
            &quot;2&quot;: Config(strategy=self._is_good, msg=&quot;2&quot;),
            &quot;3&quot;: Config(strategy=self._is_bad, msg=&quot;3&quot;),
        }

    @staticmethod
    def _is_cool(items: list[str], name: str) -&gt; bool:
        return True
    @staticmethod
    def _is_good(items: list[str], name: str) -&gt; bool:
        return name in items

    @staticmethod
    def _is_bad(items: list[str], name: str) -&gt; bool:
        return len(items) &gt; 0 and name == &quot;asd&quot;
</code></pre>
<pre><code>   |
27 |     @staticmethod
28 |     def _is_cool(items: list[str], name: str) -&gt; bool:
   |                  ^^^^^ ARG004
29 |         return True
   |
</code></pre>
<pre><code>   |
27 |     @staticmethod
28 |     def _is_cool(items: list[str], name: str) -&gt; bool:
   |                                    ^^^^ ARG004
29 |         return True
   |
</code></pre>
<ol>
<li><code> def _is_cool(_items: list[str], _name: str) -&gt; bool:</code></li>
</ol>
<p>but it's ty error, which is correct:</p>
<pre><code>error[invalid-argument-type]: Argument is incorrect
   |
24 |         &quot;&quot;&quot;Doc.&quot;&quot;&quot;
25 |         self._strategies: dict[str, Config] = {
26 |             &quot;1&quot;: Config(strategy=self._is_cool, msg=&quot;1&quot;),
   |                         ^^^^^^^^^^^^^^^^^^^^^^ Expected `Proto`, found `def _is_cool(_items: list[str], _name: str) -&gt; bool`
27 |             &quot;2&quot;: Config(strategy=self._is_good, msg=&quot;2&quot;),
28 |             &quot;3&quot;: Config(strategy=self._is_bad, msg=&quot;3&quot;),
   |
info: rule `invalid-argument-type` is enabled by default
</code></pre>
<ol start="2">
<li></li>
</ol>
<pre><code class="language-python">    @staticmethod
    def _is_cool(items: list[str], name: str) -&gt; bool:
        _ = items, name
        return True
</code></pre>
<ol start="3">
<li>noqa
<code>    def _is_cool(items: list[str], name: str) -&gt; bool:  # noqa: ARG004</code></li>
</ol>
<p>Maybe there is a way to pass a check more elegantly?</p>
<h3>Version</h3>
<p>ruff 0.14.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @Lexxx42 on 2025-11-05 06:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daverball">@Daverball</a> on 2025-11-05 21:55</div>
            <div class="timeline-body"><p>Usually with callback protocols it's a good idea to either make all of the arguments positional only or keyword only, this puts fewer constraints on the implementations.</p>
<p>In this case if you change the protocol to:</p>
<pre><code class="language-python">from typing import Protocol

class Proto(Protocol):
    def __call__(self, items: list[str], name: str, /) -&gt; bool:
</code></pre>
<p>You can change your implementation to:</p>
<pre><code class="language-python">    @staticmethod
    def _is_cool(_items: list[str], _name: str) -&gt; bool:
</code></pre>
<p>With the preceding underscore you're signaling that you're not using those arguments, so it will no longer trigger the <code>ARG004</code> violation.</p>
<p>But sometimes you're of course forced to use a certain argument name and in that case you will just have to live with the <code>noqa</code> comment, it's the only solution, besides disabling the rule altogether, which is a perfectly valid decision as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Lexxx42 on 2025-11-06 19:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:53:33 UTC
    </footer>
</body>
</html>
