<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unnecessary `crate::` prefixes in `crates/ruff_python_ast/generated.rs` - astral-sh/ruff #18651</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Unnecessary `crate::` prefixes in `crates/ruff_python_ast/generated.rs`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/18651">#18651</a>
        opened by <a href="https://github.com/chirizxc">@chirizxc</a>
        on 2025-06-12 19:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-06-12 19:11</div>
            <div class="timeline-body"><blockquote>
<p>there's also a question about <a href="https://github.com/astral-sh/ruff/blob/main/crates/ruff_python_ast/src/generated.rs">ruff_python_ast/src/generated.rs</a> file <img src="https://private-user-images.githubusercontent.com/109767616/454415857-a3ba28ec-3ae2-4698-9037-dd322b33e162.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDk3NDk4NDgsIm5iZiI6MTc0OTc0OTU0OCwicGF0aCI6Ii8xMDk3Njc2MTYvNDU0NDE1ODU3LWEzYmEyOGVjLTNhZTItNDY5OC05MDM3LWRkMzIyYjMzZTE2Mi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNjEyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDYxMlQxNzMyMjhaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zZjBjNzgyZjIyYzhlMjkwMTQxYmI5MzU2OTYwZjZjYzg3MDI0MDgwZDI1NjUxMzJiZjllMzgwNDYwM2FhNjYzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.I_VCJxgt8BZUJ1xaFWKyVcgtMCxA-WCvp0LDwG6Kf1M" alt="Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ" /></p>
<p>rustrover writes that <code>crate::</code> is not needed in 834 places, should the <code>crates/ruff_python_ast/generate.py</code> itself be corrected?</p>
</blockquote>
<p>This is interesting, I guess clippy doesn't warn about this. We could probably open a separate issue or PR for this, if you wanted!</p>
<p><em>Originally posted by @ntBre in https://github.com/astral-sh/ruff/issues/18645#issuecomment-2967674061</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-06-12 19:13</div>
            <div class="timeline-body"><p><img src="https://github.com/user-attachments/assets/71d0750b-6026-42c3-be0e-31402f078a3e" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-12 19:39</div>
            <div class="timeline-body"><p>Thanks for opening the issue! I think it should definitely be safe to remove these, but I'm not immediately seeing where this prefix is added in the code generation script, which I think was changed to include at least some of these in https://github.com/astral-sh/ruff/pull/17180. For example, I don't think I see any of the types from the screenshots here:</p>
<p>https://github.com/astral-sh/ruff/blob/02394b8049b52836ae7daca7132fab93031d1162/crates/ruff_python_ast/generate.py#L17-L21</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @ntBre on 2025-06-12 19:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/18652.html">astral-sh/ruff#18652</a> on 2025-06-12 20:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dcreager">@dcreager</a> on 2025-06-16 19:15</div>
            <div class="timeline-body"><p>As @chirizxc mentions https://github.com/astral-sh/ruff/pull/18652#issuecomment-2971652315, this is the <a href="https://doc.rust-lang.org/rustc/lints/listing/allowed-by-default.html#unused-qualifications"><code>unused_qualifications</code></a> lint from <code>rustc</code> (not <code>clippy</code>). That lint is marked as <code>allow</code> by default, because:</p>
<blockquote>
<p>it is somewhat pedantic, and doesn't indicate an actual problem, but rather a stylistic choice, and can be noisy when refactoring or moving around code</p>
</blockquote>
<p>If we activate this lint, then we should do so for the whole repo (as suggested here https://github.com/astral-sh/ruff/pull/18652#issuecomment-2971787538) so that this will be checked as part of CI moving forward.</p>
<p>That said, I'm not convinced that we should activate this lint just because rustrover has a different default than <code>rustc</code>. If we do, it should be because we agree with its suggestions. I'm ambivalent to mildly against. @ntBre @MichaReiser, do you have strong feelings on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-16 19:23</div>
            <div class="timeline-body"><p>I don't have strong feelings. I thought it might be nice and low-impact just for the generated code, but I didn't think about enabling the lint or the churn that could cause elsewhere. I usually prefer the style from the lint and fix it in my code when I notice it, but I definitely don't feel strongly enough to impose it throughout the project. And I agree with you that that's what the decision boils down to!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-06-16 19:28</div>
            <div class="timeline-body"><p>maybe just put <code>#![deny(unused_qualifications)]</code> at the beginning of the generated file?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dcreager">@dcreager</a> on 2025-06-16 20:50</div>
            <div class="timeline-body"><blockquote>
<p>maybe just put <code>#![deny(unused_qualifications)]</code> at the beginning of the generated file?</p>
</blockquote>
<p>I'm not in favor of that â€” I feel we should either enforce the lint for the whole repo or not at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-17 05:39</div>
            <div class="timeline-body"><p>I sometimes remove unnecessary prefixes if I come across them, but not always. For example, it has become an established pattern to use <code>ast::Node</code> in ty, and the prefix shouldn't be removed when the IDE imports a node directly. That's why I don't think we should enable this lint.</p>
<p>However, I don't mind removing the unnecessary prefixes in the generated file if it doesn't introduce extra complexity. I don't think it's worth it even if it adds just one line of extra branching in the generation script because the prefix doesn't hurt anyone and it's a generated fiel that no one should edit anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chirizxc">@chirizxc</a> on 2025-06-24 11:47</div>
            <div class="timeline-body"><p>what are we supposed to do about it? close?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-24 12:25</div>
            <div class="timeline-body"><p>Yeah, I'm leaning towards closing unless the &quot;cleanup&quot; comes at no extra cost (which this discussion already shows, it does not ðŸ˜†)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-06-24 12:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-06-24 12:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:17 UTC
    </footer>
</body>
</html>
