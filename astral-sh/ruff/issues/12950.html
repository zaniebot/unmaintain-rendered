<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>List variables that are set but never used - astral-sh/ruff #12950</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>List variables that are set but never used</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/12950">#12950</a>
        opened by <a href="https://github.com/Beliavsky">@Beliavsky</a>
        on 2024-08-17 13:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Beliavsky">@Beliavsky</a> on 2024-08-17 13:08</div>
            <div class="timeline-body"><p>For the code</p>
<pre><code>a = 10
b = 20
c = 30
print(b)
</code></pre>
<p>ruff is silent. Here is a function using the <code>ast</code> module that warns about variables that are set but not used later.</p>
<pre><code>import ast

class AssignmentVisitor(ast.NodeVisitor):
    def __init__(self):
        self.assigned = set()
        self.used = set()

    def visit_Assign(self, node):
        # Record all the variables assigned to
        for target in node.targets:
            if isinstance(target, ast.Name):
                self.assigned.add(target.id)
            elif isinstance(target, ast.Tuple):
                for element in target.elts:
                    if isinstance(element, ast.Name):
                        self.assigned.add(element.id)
        self.generic_visit(node)

    def visit_Name(self, node):
        # Record all the variables that are used
        if isinstance(node.ctx, ast.Load):
            self.used.add(node.id)
        self.generic_visit(node)

def find_unused_variables(code):
    tree = ast.parse(code)
    visitor = AssignmentVisitor()
    visitor.visit(tree)
    return visitor.assigned - visitor.used

# Example usage
code = &quot;&quot;&quot;
a = 10
b = 20
c = 30
print(b)
&quot;&quot;&quot;
    
unused_vars = find_unused_variables(code)
if unused_vars:
    print(&quot;Unused variables:&quot;, unused_vars)
else:
    print(&quot;No unused variables&quot;)
</code></pre>
<p>output:</p>
<p><code>Unused variables: {'a', 'c'}</code></p>
<p>Could such functionality be added to ruff? Thanks for the useful tool.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tjkuson">@tjkuson</a> on 2024-08-17 13:51</div>
            <div class="timeline-body"><p>Ruff will detect that via <a href="https://docs.astral.sh/ruff/rules/unused-variable/">unused-variable (F841)</a> if the unused names are in a local scope; for example,</p>
<pre><code class="language-python">def fn() -&gt; None:
    a = 10
    b = 20
    c = 30
    print(b)
</code></pre>
<p>If the names are globally scoped, Ruff can't determine if a name is used in a different file (see #7447).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-18 22:31</div>
            <div class="timeline-body"><p>Yeah, I think this is by design at the moment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-18 22:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:13 UTC
    </footer>
</body>
</html>
