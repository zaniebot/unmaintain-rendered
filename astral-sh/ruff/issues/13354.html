<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>I001: `zoneinfo` not recognized as a stdlib package for PEP-8 compliant import formatting. - astral-sh/ruff #13354</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>I001: `zoneinfo` not recognized as a stdlib package for PEP-8 compliant import formatting.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13354">#13354</a>
        opened by <a href="https://github.com/gtkacz">@gtkacz</a>
        on 2024-09-14 21:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gtkacz">@gtkacz</a> on 2024-09-14 21:14</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

<p>Ruff doesn't recognize <code>zoneinfo</code> (introduced with PEP-615 at Python 3.9) as a first-party package and formats imports with a way not compliant with PEP-8. More details below:</p>
<ul>
<li>Python version: 3.12.0</li>
<li>Ruff version: 0.6.5</li>
</ul>
<p>Ruff reformats the following correct PEP-8 compliant import statement:</p>
<pre><code class="language-python">import zoneinfo
from datetime import date, datetime, time
from typing import TYPE_CHECKING, Optional, Sequence, Tuple
</code></pre>
<p>To the following incorrect one:</p>
<pre><code class="language-python">from datetime import date, datetime, time
from typing import TYPE_CHECKING, Optional, Sequence, Tuple

import zoneinfo
</code></pre>
<p>Based on rule <code>I001 [*] Import block is un-sorted or un-formatted</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../python-telegram-bot/python-telegram-bot/pulls/4326.html">python-telegram-bot/python-telegram-bot#4326</a> on 2024-09-14 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "I001: `zoneinfo` not recognizes as a stdlib package for PEP-8 import formatting." to "I001: `zoneinfo` not recognized as a stdlib package for PEP-8 compliant import formatting." by @gtkacz on 2024-09-14 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gtkacz">@gtkacz</a> on 2024-09-14 21:18</div>
            <div class="timeline-body"><p>isort and Black for instance do not currently have these issues.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-09-14 23:51</div>
            <div class="timeline-body"><p>Hiya -- do you have <code>requires-python</code> or <code>tool.ruff.target-version</code> set in your <code>pyproject.toml</code> file? I can repro this in the playground without them set (which leads Ruff to infer <code>&quot;py38&quot;</code> as the target version, since that's our current default), but if you set <code>&quot;py39&quot;</code> as the target version then this isn't an issue: https://play.ruff.rs/640f351d-0d84-4638-b276-4a6239df7f20</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gtkacz">@gtkacz</a> on 2024-09-14 23:58</div>
            <div class="timeline-body"><p>@AlexWaygood hey, thanks for the quick response! This came up as a pre-commit check was failing on https://github.com/python-telegram-bot/python-telegram-bot/pull/4326 which does have a <code>requires-python = &quot;&gt;=3.8&quot;</code> on their <code>pyproject.toml</code> file. They do plan on dropping support on Python 3.8 soon, so I believe that will fix this, but even then, shouldn't Ruff properly format imports without a <code>pyproject.toml</code> file set-up? Thanks for your time! :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-09-15 00:02</div>
            <div class="timeline-body"><p>Well, the issue here is that we assume you'll only be importing stdlib modules available on all versions of Python you support. If you support Python 3.8, we'll only look at the list of stdlib modules available on Python 3.8 when trying to determine if a module is a stdlib module or a third-party module. So I <em>think</em> Ruff's behaviour is correct here :-)</p>
<p>If this is causing issues for you, you might find this setting helpful: https://docs.astral.sh/ruff/settings/#lint_isort_extra-standard-library</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @AlexWaygood on 2024-09-15 00:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">isort</span> added by @AlexWaygood on 2024-09-15 00:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gtkacz">@gtkacz</a> on 2024-09-15 00:23</div>
            <div class="timeline-body"><p>@AlexWaygood that worked for the pre-commit issue, thanks :)! Still, I think if <code>pyproject.toml</code> isn't used at all, the imports should be properly formatted. Maybe include a default value of</p>
<pre><code class="language-toml">[tool.ruff.lint.isort]
extra-standard-library = [&quot;zoneinfo&quot;]
</code></pre>
<p>When it's not overridden if <code>requires-python</code> isn't passed? Specially since the <code>isort</code> hook is properly formatting with the same <code>requires-python = &quot;&gt;=3.8&quot;</code> configuration in the PR I mentioned</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-09-15 00:31</div>
            <div class="timeline-body"><p>Hmm, I guess I'm not sure why you'd be running two separate import sorters in CI (Ruff and isort)! Just one should probably do the trick ðŸ˜„</p>
<p>That also honestly sounds like a bug in isort rather than ruff if they're treating <code>zoneinfo</code> as a stdlib module on Python versions before it was added to the stdlib.</p>
<blockquote>
<p>Still, I think if <code>pyproject.toml</code> isn't used at all, the imports should be properly formatted.</p>
</blockquote>
<p>We also support the same configuration options via a <code>ruff.toml</code> file, if you don't have a <code>pyproject.toml</code> file! Also, if you want to tell ruff not to infer the target version from the <code>requires-python</code> field, you can set the <code>tool.ruff.target-version</code> option instead :-) https://docs.astral.sh/ruff/settings/#target-version</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gtkacz">@gtkacz</a> on 2024-09-15 00:54</div>
            <div class="timeline-body"><p>Don't ask me on this one lol ðŸ¤· thanks for the help anyway! :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @gtkacz on 2024-09-15 00:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13446.html">astral-sh/ruff#13446</a> on 2024-09-22 05:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/10457.html">astral-sh/ruff#10457</a> on 2024-09-22 05:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:14 UTC
    </footer>
</body>
</html>
