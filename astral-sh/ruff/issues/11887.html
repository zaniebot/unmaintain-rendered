<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLOT002 gives a false positive because does take into account multiple inheritance - astral-sh/ruff #11887</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>SLOT002 gives a false positive because does take into account multiple inheritance</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/11887">#11887</a>
        opened by <a href="https://github.com/alessio-locatelli">@alessio-locatelli</a>
        on 2024-06-16 07:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/alessio-locatelli">@alessio-locatelli</a> on 2024-06-16 07:47</div>
            <div class="timeline-body"><h3>Search I have tried</h3>
<p><code>SLOT002</code></p>
<p>There are no duplicate issues.</p>
<h3>Problem</h3>
<p>Ruff says to me:</p>
<pre><code>SLOT002 Subclasses of `collections.namedtuple()` should define `__slots__`
</code></pre>
<p>But I inherit from <code>namedtuple</code> and <code>Enum</code> at the same time.</p>
<h3>Reproducible example</h3>
<pre><code class="language-py">from collections import namedtuple
from enum import Enum


class Foobar(namedtuple(&quot;conventional_sign&quot;, &quot;name description&quot;), Enum):
    __slots__ = ()
    FOO = 1, &quot;Hello, World!&quot;
    BAR = 2, &quot;Some text here&quot;

    @classmethod
    def item_description(cls, conventional_sign: int) -&gt; str:
        for value in cls.__members__.values():
            if conventional_sign == value[0]:
                return value[1]
        raise ValueError(f&quot;{conventional_sign} not in {cls.__members__.values()}&quot;)
</code></pre>
<h3>Correct (expected) behavior</h3>
<p>Look on all parent classes before recommending to add <code>__slots__</code>.</p>
<p>For example, <code>Enum</code> has no <code>__slots__</code> (https://github.com/python/cpython/issues/90290).</p>
<h3>Versions</h3>
<ul>
<li>Python 3.12.4</li>
<li>ruff 0.4.9</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-06-18 06:21</div>
            <div class="timeline-body"><p>I think this is a bug. I mainly tested it out by getting the size of the class using the following snippet:</p>
<pre><code class="language-py">import sys
from collections import namedtuple
from enum import Enum


class NamedTupleNoSlots(namedtuple(&quot;Point&quot;, [&quot;x&quot;, &quot;y&quot;])):
    pass


class NamedTupleWithSlots(namedtuple(&quot;Point&quot;, [&quot;x&quot;, &quot;y&quot;])):
    __slots__ = ()


class NamedTupleAndEnumNoSlots(namedtuple(&quot;Point&quot;, [&quot;x&quot;, &quot;y&quot;]), Enum):
    pass


class NamedTupleAndEnumWithSlots(namedtuple(&quot;Point&quot;, [&quot;x&quot;, &quot;y&quot;]), Enum):
    __slots__ = ()


for cls in (
    NamedTupleNoSlots,
    NamedTupleWithSlots,
    NamedTupleAndEnumNoSlots,
    NamedTupleAndEnumWithSlots,
):
    print(f&quot;{cls.__name__}: {sys.getsizeof(cls)}&quot;)
</code></pre>
<p>Output:</p>
<pre><code class="language-console">$ python3.13 src/play.py
NamedTupleNoSlots: 1712
NamedTupleWithSlots: 944
NamedTupleAndEnumNoSlots: 1712
NamedTupleAndEnumWithSlots: 1712
</code></pre>
<p>cc @AlexWaygood I think it should be an &quot;all&quot; behavior instead of &quot;any&quot; behavior for checking against the base class.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @dhruvmanila on 2024-06-18 06:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-07-26 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-26 14:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-26 14:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:34:11 UTC
    </footer>
</body>
</html>
