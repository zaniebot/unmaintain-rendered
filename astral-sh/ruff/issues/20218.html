<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Django rule suggestion, spot misuse of DRF `fields = [&quot;__all__&quot;]` - astral-sh/ruff #20218</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Django rule suggestion, spot misuse of DRF `fields = [&quot;__all__&quot;]`</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/20218">#20218</a>
        opened by <a href="https://github.com/Avasam">@Avasam</a>
        on 2025-09-03 20:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Avasam">@Avasam</a> on 2025-09-03 20:32</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Sorry for the less descriptive issue summary, I'm in a rush but didn't wanna forget about this.</p>
<p>We just had a contributor do the following in a Django Rest Framework Serializer, and I missed it in review. Seems like a common possible error that can be caught statically. So I figure I'd suggest it.</p>
<p><img width="482" height="269" alt="Image" src="https://github.com/user-attachments/assets/c655ad2d-564c-4677-a108-464b3ce4c49d" /></p>
<p>It should be <code>fields = &quot;__all__&quot;</code> instead of <code>fields = [&quot;__all__&quot;]</code> or <code>fields = (&quot;__all__&quot;,)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-09-04 12:58</div>
            <div class="timeline-body"><p>Thanks! Should this just be <code>&quot;__all__&quot;</code> instead of a list? That's what I found from some searching, but I'm not too familiar with Django.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-09-04 12:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @ntBre on 2025-09-04 12:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-09-04 14:27</div>
            <div class="timeline-body"><p>Hi. A bit less in a rush this morning. You are correct. I've updated the issue. I also realize this is technically using <code>rest_framework.serializer.ModelSerializer</code>, not part of the core django, but it is such a popular plugin.</p>
<p>I understand if this is out of scope, then I'd wait for something like AST-based custom rules (relates to https://github.com/astral-sh/ruff/issues/283). I wanted to at least write it down.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Django rule suggestion, spot misuse of `fields = ["__all__"]`" to "Django rule suggestion, spot misuse of DRF `fields = ["__all__"]`" by @Avasam on 2025-09-04 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-16 07:35</div>
            <div class="timeline-body"><p>Ideally, this would be something that a type checker would catch but it would require understanding that <code>Meta</code> needs to have a very specific shape when declared in a class inheriting from <code>ModelSerializer</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-09-16 16:07</div>
            <div class="timeline-body"><blockquote>
<p>Ideally, this would be something that a type checker would catch</p>
</blockquote>
<p>Good ol' &quot;str is a valid Sequence[str]&quot; issue ðŸ˜¢
Still, good point though.
<code>fields</code> could be typed as <code>tuple[str,...] | list[str] | Literal[&quot;__all__&quot;]</code> given this tends to be static, and only run once (being a classvar), I don't think anyone would really mind having to convert a Sequence to a List in special cases.</p>
<blockquote>
<p>but it would require understanding that <code>Meta</code> needs to have a very specific shape when declared in a class inheriting from <code>ModelSerializer</code></p>
</blockquote>
<p>Actually yeah, that might be more of an issue, I don't recall the typing system's limitations there off the top of my head. I'll try to play around with it and may bring that up with https://github.com/typeddjango/djangorestframework-stubs</p>
<p>At the very least it's something the mypy plugin may be able to handle.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:16 UTC
    </footer>
</body>
</html>
