<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adding go-to-definition support to `ruff server` - astral-sh/ruff #14046</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Adding go-to-definition support to `ruff server`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/ruff/issues/14046">#14046</a>
        opened by <a href="https://github.com/JTKBowers">@JTKBowers</a>
        on 2024-11-01 16:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JTKBowers">@JTKBowers</a> on 2024-11-01 16:06</div>
            <div class="timeline-body"><p>Hi,</p>
<p>I'd like to add support for go-to-definition to the <code>ruff server</code>. I've had a play round and have a (very limited) proof of concept working. It can currently go to the definition when that definition is in the same file (so imported symbols just go to the <code>import</code> statement).</p>
<p>I'm happy to finish this feature and help with any maintenance if it fits with the project's goals and timelines, but before making it feature complete I've got a few questions:</p>
<ol>
<li>I see that it's mentioned as a desired feature in the <a href="https://github.com/astral-sh/ruff/discussions/10581#discussioncomment-9164433">roadmap discussion</a>, but mostly in relation to the &quot;red-knot&quot; project. Would you accept a PR that works with the existing codebase, before that rewrite is complete?</li>
<li>What I currently have might still provide some value to users, even without being able to jump to a definition that's in another module. Is this something that you'd consider merging as-is, with the possibility to add more functionality later?</li>
<li>I have some ideas about how I might extend my branch to support definitions from other modules using existing code in the repository.<ol>
<li>Given my general unfamiliarity with the codebase, it's possible I've missed some showstoppers. Is there anything that you can think of there?</li>
<li>The most straightforward way of resolving imports seems to be to use the <code>ruff_python_resolver</code>. I see that it's somewhat experimental and isn't currently integrated with the rest of the codebase. Is that a blocker?</li>
</ol>
</li>
</ol>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-11-04 04:19</div>
            <div class="timeline-body"><p>Hey Jamie, thanks for opening this issue and providing your thoughts on this specific feature.</p>
<p>I appreciate you spending the time in understanding the codebase and implementing this feature but I'm not sure if this is going to be useful with the limitation that it can only resolve symbols within the same module. I think a lot of times the symbols will be coming from another module where this won't work.</p>
<p>Currently, we recommend using another language server which can provide other capabilities like goto definition along with using the Ruff language server (for example, Pyright). This means that the goto definition request will be sent to the second language server because Ruff doesn't advertise it's support for it. If we start doing that in a limited manner, then the user experience will be limited. I'm also unsure of how the client will handle the two different responses to the same request, the responses will be different when the symbol is in a different module.</p>
<p>There's also additional context in https://github.com/astral-sh/ruff/pull/13883 which implements the same capability using red-knot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @dhruvmanila on 2024-11-04 04:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JTKBowers">@JTKBowers</a> on 2024-11-04 11:06</div>
            <div class="timeline-body"><p>Hey Dhruv,</p>
<p>Thanks for your reply, and thanks for the link to the PR adding this functionality to red-knot. As that is further along than my effort I'll close this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @JTKBowers on 2024-11-04 11:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @dhruvmanila on 2025-01-07 05:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:14 UTC
    </footer>
</body>
</html>
