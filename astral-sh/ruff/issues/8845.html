<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consider scoping parent per-file globs to the base project when  - astral-sh/ruff #8845</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consider scoping parent per-file globs to the base project when</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8845">#8845</a>
        opened by <a href="https://github.com/strangemonad">@strangemonad</a>
        on 2023-11-26 21:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/strangemonad">@strangemonad</a></div>
            <div class="timeline-body"><p>Summary: per-file-ignores globs in a parent config file seem to resolve relative to the parent's location rather than the base project.</p>
<p>Consider the following</p>
<pre><code>project_a/
|_ pyproject.toml (extends ../config/shared-ruff.toml)
|_ src/...
|_ tests/...

config/
|_ shared-ruff.toml (attempts to set a per-file-ignores glob e.g. to exclude D100 from any tests/**/*.py file)
</code></pre>
<p>(Note that the parent config dirname isn't strictly a prefix of the other projects).</p>
<p>Expected: Sharing settings that involve globs across projects with similar layouts should be possible somehow. This seems in line with the other settings when extending config files e.g. https://docs.astral.sh/ruff/settings/#src</p>
<p>Actual:
The globs seems to be resolved as absolute paths in <code>/config/tests/**/*.py</code>. When the workspace is resolved, each configuration is given its own <code>project_root</code> with the path to the current config file being parsed. This means only the base-name glob matcher can be used e.g. I can exclude files like <code>__init__.py</code> or <code>*.py</code> but not <code>tests/__init__.py</code> or more complex globs.</p>
<p>Workaround:
It's possible to move the config file to a shared parent folder and use a prefix glob e.g. <code>**/tests/*.py</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-11-27 15:53</div>
            <div class="timeline-body"><p>Thanks for the report. This looks like a duplicate of https://github.com/astral-sh/ruff/issues/8795, we can track this there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2023-11-27 15:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:49:07 UTC
    </footer>
</body>
</html>
