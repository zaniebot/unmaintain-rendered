<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[flake8-django] DJ001 is not raised for fields inherited from text fields - astral-sh/ruff #7803</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[flake8-django] DJ001 is not raised for fields inherited from text fields</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/7803">#7803</a>
        opened by <a href="https://github.com/sshishov">@sshishov</a>
        on 2023-10-04 06:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sshishov">@sshishov</a></div>
            <div class="timeline-body"><p>In our project we are using custom fields with some mixings to extend the functionality of original fields</p>
<pre><code>class MyCharField(MyMixing, models.CharField):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, *kwargs)
        &lt;additional-pre-processing&gt;


class MyModel(models.Model):
    my_field = MyCharField(max_length=100, null=True, blank=True)  # &lt;-- the issue should be raised here, but it is not
</code></pre>
<p>Even easier example is not raising, like this:</p>
<pre><code>class MyCharField(models.CharField):
    pass


class MyModel(models.Model):
    my_field = MyCharField(max_length=100, null=True, blank=True)  # &lt;-- the issue should be raised here, but it is not
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-04 14:45</div>
            <div class="timeline-body"><p>Thanks for filing. Ruff doesn&#x27;t support cross-file analysis right now, so the best we could do here is flag cases like this in which the field is defined in the same file as the model. My guess is that wouldn&#x27;t be very helpful for your projects (I&#x27;m assuming these fields are defined in a central location, then imported into other files?), or would it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-04 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sshishov">@sshishov</a> on 2023-10-04 16:16</div>
            <div class="timeline-body"><p>Hi @charliermarsh, the custom field files defined in separate module, and for some apps it can be even separate packages.</p>
<p>Is it possible just to look into what the parent for the current field and if it is <code>CharField</code> or <code>TextField</code> - apply the same rule? I do not know how everything is working internally...</p>
<p>Just a question, how do you understand that it is <code>django.db.models.CharField</code>, analyzing the import and Module and then flag it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-08 18:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-08 18:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-08 18:19</div>
            <div class="timeline-body"><p>It would be possible to do that, but not possible to support those kinds of checks across files unfortunately (yet).</p>
<blockquote>
<p>Just a question, how do you understand that it is <code>django.db.models.CharField</code>, analyzing the import and Module and then flag it?</p>
</blockquote>
<p>Yeah, we track all the imports in a given file. Then, when we see something like <code>models.CharField</code>, we&#x27;re able to trace that back to <code>from django.db import models</code>, and determine that it&#x27;s <code>django.db.models.CharField</code>.</p>
<p>I&#x27;m going to close for now as unsupported but tag this with a multi-file label so that we know to come back to it in the future.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-08 18:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sshishov">@sshishov</a> on 2023-10-08 21:14</div>
            <div class="timeline-body"><p>Thank you very much @charliermarsh for the explanation üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type-inference</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-24 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">multifile-analysis</span> removed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-10-24 14:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:43 UTC
    </footer>
</body>
</html>
