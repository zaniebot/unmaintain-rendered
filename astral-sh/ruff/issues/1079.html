<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature request: support Cython and Jupyter magic? - astral-sh/ruff #1079</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature request: support Cython and Jupyter magic?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/1079">#1079</a>
        opened by <a href="https://github.com/9r0x">@9r0x</a>
        on 2022-12-05 21:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/9r0x">@9r0x</a></div>
            <div class="timeline-body"><p>Hi,</p>
<p>I was wondering if we could consider Cython support and/or Jupiter magic because</p>
<ol>
<li>Cython code sometimes exists alongside Python code in a project, and a unified linter would be very useful?</li>
<li>Many code and lint inside Jupyter notebook, and % in the code cell could break the lining, would be great if it can be ignored/supported.</li>
</ol>
<p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2022-12-06 02:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-06 02:28</div>
            <div class="timeline-body"><p>Cython I don't have much experience with so can't commit to anything on that front right now.</p>
<p>Jupyter integration though is very interesting to me and something I'd like to support!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MarcoGorelli">@MarcoGorelli</a> on 2022-12-06 09:19</div>
            <div class="timeline-body"><p>Hey,</p>
<p>I don't know how to use rust, but I've done some relevant work here on the Python side</p>
<p>For Cython, you might be interested in https://github.com/MarcoGorelli/cython-lint (which does everything flake8 used to, plus more) and seeing if that's portable to rust?</p>
<p>For Jupyter, I contributed its support to <code>black</code>, there's <a href="https://github.com/psf/black/blob/d4a85643a465f5fae2113d07d22d021d4af4795a/src/black/handle_ipynb_magics.py">this file</a> that deals with masking/unmasking magic symbols (<code>%</code>, <code>%%</code>, <code>!</code>, <code>?</code>) - if possible, I'd strongly suggest something like that over regular expressions</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-06 14:37</div>
            <div class="timeline-body"><p>Amazing, thank you @MarcoGorelli -- that's super helpful. I'll probably just port that file to Rust then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2022-12-28 02:19</div>
            <div class="timeline-body"><p>Ruff was actually integrated into <a href="https://github.com/nbQA-dev/nbQA/pull/773">nbQA</a> in the latest release, so you can now run (e.g.):</p>
<pre><code>‚ùØ nbqa ruff Untitled.ipynb
Untitled.ipynb:cell_1:2:5: F841 Local variable `x` is assigned to but never used
Untitled.ipynb:cell_2:1:1: E402 Module level import not at top of file
Untitled.ipynb:cell_2:1:8: F401 `os` imported but unused
Found 3 error(s).
1 potentially fixable with the --fix option.
</code></pre>
<p>Super cool :)</p>
<p>(Would still like to have a first-party integration at some point.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @charliermarsh on 2022-12-31 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">core</span> added by @charliermarsh on 2022-12-31 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2023-06-27 12:11</div>
            <div class="timeline-body"><p>(2) is being worked on (see #5030)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vyasr">@vyasr</a> on 2023-07-14 18:47</div>
            <div class="timeline-body"><p>@charliermarsh On the Cython side it's worth noting that <a href="https://pycqa.github.io/isort/docs/major_releases/introducing_isort_5.html#cython-support">isort supports Cython as of isort 5.0.0</a> so you may also be able to port those features over to rust (in the same way that you're hoping to port @MarcoGorelli's excellent cython-lint project). Between cython-lint and isort support I would probably consider that enough to claim Cython support, especially since flake8's support has always been patchy and incidental (prior to the change last year that disabled it entirely, necessitating <a href="https://github.com/kmaehashi/flake8-force">flake8-force</a>) and I believe the same is true for pylint. Just in case you were curious where to set the goalposts for this issue :smiley:</p>
<p>This might also be a strong argument for #283, though, and in particular supporting Python plugins alongside Rust plugins. Cython is a prime example of a case where the ruff developers may not have the expertise or interest in maintaining their own solution, but could happily delegate to a plugin author who doesn't have Rust experience but is willing to write one in Python.</p>
<p>Great work on ruff, by the way! Definitely a fan of ruff.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-23 21:58</div>
            <div class="timeline-body"><p>@dhruvmanila do we support this now that we support ipython magics?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-03-05 11:43</div>
            <div class="timeline-body"><blockquote>
<p>@dhruvmanila do we support this now that we support ipython magics?</p>
</blockquote>
<p>@MichaReiser Yes, we support (2) but not (1). I'm not familiar with Cython so can't say what will be required to support it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-05 11:50</div>
            <div class="timeline-body"><p>@9r0x could you help us understand what features you would expect from a linter supporting cpython? Is it Cython specific lint rules or is it something else?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 13:50</div>
            <div class="timeline-body"><p>Cython is a superset of Python. So at minimum it would require a different parser. Lets close this and create a new issue to track Cython, since there are really two independent requests here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-03-06 16:22</div>
            <div class="timeline-body"><p>Done, https://github.com/astral-sh/ruff/issues/10250</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-03-06 16:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:45:41 UTC
    </footer>
</body>
</html>
