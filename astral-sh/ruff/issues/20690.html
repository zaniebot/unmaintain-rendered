<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ruff check does not warn about duplicate if TYPE_CHECKING: import clauses - astral-sh/ruff #20690</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ruff check does not warn about duplicate if TYPE_CHECKING: import clauses</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/20690">#20690</a>
        opened by <a href="https://github.com/ktns">@ktns</a>
        on 2025-10-03 02:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ktns">@ktns</a> on 2025-10-03 02:49</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hi.</p>
<p>When I was poking around GitHub Copilot Agent, it emitted code like below and <code>ruff check</code> does not warn anything.</p>
<pre><code class="language-python">if TYPE_CHECKING:
    from collections.abc import Iterable


if TYPE_CHECKING:
    from ase import Atoms
</code></pre>
<p>I think superfluous <code>if TYPE_CHECKING:</code> should be warned. What do you think?</p>
<h3>Version</h3>
<p>0.11.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njhearp">@njhearp</a> on 2025-10-03 14:27</div>
            <div class="timeline-body"><p>If this is implemented I would suggest expanding it to another case. The same logic could also apply to duplicate <code>if __debug__</code>. Perhaps this could apply to version/platform (<code>sys.version_info &gt;= (3, 13)</code>, etc.) checking as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-10-03 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @ntBre on 2025-10-03 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maltevesper">@maltevesper</a> on 2025-10-17 07:56</div>
            <div class="timeline-body"><p>The general case would be</p>
<pre><code>if static_condition:
   dosomething()

if static_condition:
   dosomething2()
</code></pre>
<p>but I think it would be tricky to infer that <code>dosomething()</code> does not change <code>static_condition</code>.
Personally there are other rules which are higher priority to me, but it sounds like a nice addition.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ktns">@ktns</a> on 2025-10-17 10:48</div>
            <div class="timeline-body"><p>I think defining a general rule that covers all static conditions is too difficult.</p>
<p>My original rationale was that ruff already has TC00N which generates/modifies <code>if TYPE_CHECKING</code> clause when fixing, so it's already a special case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njhearp">@njhearp</a> on 2025-10-17 13:03</div>
            <div class="timeline-body"><p>Yes, I agree the cases I mentioned would not make sense.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:18 UTC
    </footer>
</body>
</html>
