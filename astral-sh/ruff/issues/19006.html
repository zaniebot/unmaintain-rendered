<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[`flake8-bandit`] `S601` does not account for calls through clients - astral-sh/ruff #19006</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[<code>flake8-bandit</code>] <code>S601</code> does not account for calls through clients</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ruff/issues/19006">#19006</a>
        opened by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a>
        on 2025-06-28 00:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I found this while working on #18972</p>
<p><a href="https://docs.astral.sh/ruff/rules/paramiko-call/#paramiko-call-s601">paramiko-call (S601)</a> only checks for a <code>paramiko.exec_command</code>, as seen in the test case:
https://github.com/astral-sh/ruff/blob/90cb0d3a7b0d1b9528854dad64dd17330bfd5f36/crates/ruff_linter/resources/test/fixtures/flake8_bandit/S601.py#L1-L3</p>
<p>And the given example code does not raise: https://play.ruff.rs/6b4aa322-f3b1-49cd-997d-f14b5c1bac41</p>
<p>However, as both the example in <code>S601</code>'s docs show, and on <a href="https://docs.paramiko.org/en/stable/api/client.html#paramiko.client.SSHClient"><code>paramiko</code>'s docs</a>, this call can also be done through an intermediary client object:</p>
<pre><code class="language-py">client = SSHClient()
client.load_system_host_keys()
client.connect('ssh.example.com')
stdin, stdout, stderr = client.exec_command('ls -l')
</code></pre>
<p>The rule needs to either be more general like how <a href="https://docs.astral.sh/ruff/rules/suspicious-subprocess-import/#suspicious-subprocess-import-s404">suspicious-subprocess-import (S404)</a> is a blanket search for importing <code>subprocess</code>, or have additional cases added, since reading through the <code>paramiko</code> docs it looks like <code>exec_command</code> is just a convenience wrapper around functionality provided in the <a href="https://docs.paramiko.org/en/stable/api/client.html#paramiko.client.SSHClient.exec_command"><code>Client</code></a> object, which would share the same security concerns. I'm also not certain <code>paramiko.exec_command</code> is even valid code using <code>paramiko</code>, as a <a href="https://github.com/search?q=%22paramiko.exec_command%22&amp;type=code&amp;p=1">github search</a> for <code>&quot;paramiko.exec_command&quot;</code> only returned it in <code>flake8-bandit</code>/<code>ruff</code> test cases.</p>
<h3>Version</h3>
<p>playground</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-06-30 13:24</div>
            <div class="timeline-body"><p>I think this makes sense and is arguably a bug in the rule. We only check for the qualified path <code>paramiko.exec_command</code>, as you said:</p>
<p>https://github.com/astral-sh/ruff/blob/db3dcd8ad60a352b175837063e71b321eab53fe6/crates/ruff_linter/src/rules/flake8_bandit/rules/paramiko_calls.rs#L41-L46</p>
<p>whereas I think upstream is checking for <em>any</em> call named <code>exec_command</code> if <code>paramiko</code> has been imported:</p>
<p>https://github.com/PyCQA/bandit/blob/ffed1bbf0adb2d259005aca6da506e86a291c987/bandit/plugins/injection_paramiko.py#L56-L58</p>
<p>I think we could try to resolve the call through a <code>Client</code>, at least within a single file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rule</span> added by @ntBre on 2025-06-30 13:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CodeMan62">@CodeMan62</a> on 2025-07-04 04:49</div>
            <div class="timeline-body"><p>I am fixing it</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:52:59 UTC
    </footer>
</body>
</html>
