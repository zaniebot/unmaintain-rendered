<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TC001-3 runtime-evaluated-decorators not working with generic framework decorators - astral-sh/ruff #21282</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>TC001-3 runtime-evaluated-decorators not working with generic framework decorators</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/21282">#21282</a>
        opened by <a href="https://github.com/hartungstenio">@hartungstenio</a>
        on 2025-11-05 14:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hartungstenio">@hartungstenio</a> on 2025-11-05 14:17</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Pydantic AI's <code>FunctionToolSet</code> is a <code>Generic</code> class providing a <code>@toolset.tool</code> decorator.</p>
<p><code>runtime-evaluated-decorators</code> works without providing the generic type: https://play.ruff.rs/5267d988-584d-4a3e-88d9-4b48cac7fbbc</p>
<pre><code class="language-python">toolset = FunctionToolset()
</code></pre>
<p>but it is now working when providing the generic type: https://play.ruff.rs/4e5c8e8c-f76a-4e77-91a5-3c89ca0624d1</p>
<pre><code class="language-python">toolset = FunctionToolset[Deps]()
</code></pre>
<h3>Version</h3>
<p>0.14.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Daverball">@Daverball</a> on 2025-11-05 21:43</div>
            <div class="timeline-body"><p>This like #20637 looks like another limitation of the very basic type inference in ruff. IIRC there's been another issue where inference failed in a different way. We can probably make the inference slightly more sophisticated than it currently is to at least work around some of these edge cases. This case definitely seems easier to support than the case in the linked issue.</p>
<p>What always works as a workaround in these cases is to add <code>toolset</code> with its fully qualified name to <code>runtime-evaluated-decorators</code> in addition to <code>FunctionToolset</code>. You would need to do this anyway, if you want <code>@toolset.tool</code> to work correctly if you access it from a different module.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:55 UTC
    </footer>
</body>
</html>
