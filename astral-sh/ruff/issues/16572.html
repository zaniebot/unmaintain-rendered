<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S324 false negatives for synonyms of insecure algorithm names - astral-sh/ruff #16572</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>S324 false negatives for synonyms of insecure algorithm names</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/16572">#16572</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2025-03-08 23:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-03-08 23:57</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><a href="https://docs.astral.sh/ruff/rules/hashlib-insecure-hash-function/">hashlib-insecure-hash-function (S324)</a> misses some insecure algorithm names that are equivalent to names that it currently flags. <code>&quot;ssl3-md5&quot;</code> and <code>&quot;1.2.840.113549.2.5&quot;</code> are synonyms of <code>&quot;md5&quot;</code>. <code>&quot;sha-1&quot;</code>, <code>&quot;ssl3-sha1&quot;</code>, and <code>&quot;1.3.14.3.2.26&quot;</code> are synonyms of <code>&quot;sha1&quot;</code>. Trailing spaces are ignored after any name. The details depend on the version of OpenSSL that Python is using, but those are the false negatives I’ve found on my machine.</p>
<pre><code class="language-python">import hashlib
print(hashlib.new(&quot;md5  &quot;).hexdigest())
print(hashlib.new(&quot;sha-1&quot;).hexdigest())
print(hashlib.new(&quot;ssl3-md5&quot;).hexdigest())
print(hashlib.new(&quot;ssl3-sha1&quot;).hexdigest())
print(hashlib.new(&quot;1.3.14.3.2.26&quot;).hexdigest())
print(hashlib.new(&quot;1.2.840.113549.2.5&quot;).hexdigest())
</code></pre>
<h3>Version</h3>
<p>ruff 0.9.10 (0dfa810e9 2025-03-07)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/VascoSch92">@VascoSch92</a> on 2025-03-09 20:23</div>
            <div class="timeline-body"><p>I opened a PR as I had already worked on a similar issue. I hope it is good.</p>
<p>Just out of curiosity: Is there a reference with a list of insecure hash functions and their aliases/equivalent names?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dscorbett">@dscorbett</a> on 2025-03-09 21:05</div>
            <div class="timeline-body"><p>I found these aliases in the OpenSSL source: <a href="https://github.com/openssl/openssl/blob/openssl-3.4.1/providers/implementations/include/prov/names.h#L253">MD5</a> and <a href="https://github.com/openssl/openssl/blob/openssl-3.4.1/providers/implementations/include/prov/names.h#L214">SHA-1</a>. Another insecure hash function, which is caught by the upstream flake8-bandit’s S324, is MD4. <a href="https://docs.astral.sh/ruff/rules/suspicious-insecure-hash-usage/"><code>suspicious-insecure-hash-usage</code> (S303)</a> also flags <a href="https://github.com/astral-sh/ruff/blob/0.9.10/crates/ruff_linter/src/rules/flake8_bandit/rules/suspicious_function_call.rs#L1030-L1034">MD2 and MD3</a>. MD4 and MD2 also have OID aliases. I don’t know of one authoritative reference listing all insecure hash functions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-10 08:39</div>
            <div class="timeline-body"><p>While this is correct, I think it's fine to change the documentation to say that we only lint for <a href="https://docs.python.org/3/library/hashlib.html#hashlib.algorithms_guaranteed">guaranteed hash functions</a>. I don't see us having the knowledge to maintain this list for all openssl supported hash functions (including some weird abbreviations). I'd also argue that most of them will be so rare, that it doesn't warrant our maintenance effort.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @MichaReiser on 2025-03-10 08:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ntBre on 2025-09-24 20:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:36:51 UTC
    </footer>
</body>
</html>
