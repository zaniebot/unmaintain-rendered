<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>formatter: Implicit tuple from trailing comma behaviour differs from black - astral-sh/ruff #8381</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>formatter: Implicit tuple from trailing comma behaviour differs from black</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/8381">#8381</a>
        opened by <a href="https://github.com/peterjc">@peterjc</a>
        on 2023-10-31 17:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/peterjc">@peterjc</a></div>
            <div class="timeline-body">

<p>Test case, note the trailing comma (based on https://github.com/peterjc/thapbi-pict/commit/580f74c89d7b988a64a596f72eeef7aa1559d550 - a real example where this was unintended):</p>
<pre><code>$ cat tests.py 
import sys

sys.stderr.write(&quot;Hello world\n&quot;),
</code></pre>
<p>Black makes no changes:</p>
<pre><code>$ black --version
black, 23.10.1 (compiled: yes)
Python (CPython) 3.10.12

$ black --diff tests.py
All done! ‚ú® üç∞ ‚ú®
1 file would be left unchanged.
</code></pre>
<p>Ruff does make an unwelcome change:</p>
<pre><code>$ ruff --version
ruff 0.1.3

$ ruff format --diff tests.py 
--- tests.py
+++ tests.py
@@ -1,3 +1,3 @@
 import sys
 
-sys.stderr.write(&quot;Hello world\n&quot;),
+(sys.stderr.write(&quot;Hello world\n&quot;),)

1 file would be reformatted
</code></pre>
<p>i.e. Ruff makes the (unintended) tuple explicit.</p>
<p>In this instance the ruff output alerted me to a harmless stylistic error in my code, but the appears to me an unexpected difference from black.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-10-31 17:09</div>
            <div class="timeline-body"><p>Hi! Thanks for the issue.</p>
<p>This is an intentional deviation documented at https://docs.astral.sh/ruff/formatter/black/#single-element-tuples-are-always-parenthesized ‚Äî we believe this makes accidental tuples easier to notice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2023-10-31 17:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2023-10-31 17:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/peterjc">@peterjc</a> on 2023-10-31 19:23</div>
            <div class="timeline-body"><p>Got it. I missed that in the docs, sorry.</p>
<p>Yes, it certainly makes accidental tuples easier to notice. Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-10-31 19:25</div>
            <div class="timeline-body"><p>Thanks for filing, and for writing such a clear issue.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:45 UTC
    </footer>
</body>
</html>
