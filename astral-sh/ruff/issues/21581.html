<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatter should avoid splitting arguments into their own line - astral-sh/ruff #21581</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Formatter should avoid splitting arguments into their own line</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/21581">#21581</a>
        opened by <a href="https://github.com/injust">@injust</a>
        on 2025-11-22 21:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/injust">@injust</a> on 2025-11-22 21:18</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>This is a silly contrived example, but unfortunately I cannot share the original code.</p>
<p><code>aa</code> and <code>bb</code> are identical, except the comparisons are reordered. Both lines are 61 characters long.</p>
<pre><code class="language-python">foo = 5

aa = float(&quot;16.0&quot;) &lt;= foo &lt;= float(&quot;20.0&quot;) and 5 &lt;= foo &lt;= 10
bb = 5 &lt;= foo &lt;= 10 and float(&quot;16.0&quot;) &lt;= foo &lt;= float(&quot;20.0&quot;)
</code></pre>
<p>When the line length is set to 60, this is the result (https://play.ruff.rs/56dffb27-828b-4cff-8903-5153da7ad31b?secondary=Format):</p>
<pre><code class="language-python">foo = 5

aa = (
    float(&quot;16.0&quot;) &lt;= foo &lt;= float(&quot;20.0&quot;) and 5 &lt;= foo &lt;= 10
)
bb = 5 &lt;= foo &lt;= 10 and float(&quot;16.0&quot;) &lt;= foo &lt;= float(
    &quot;20.0&quot;
)
</code></pre>
<p>When the line length is set to 59, this is the result(https://play.ruff.rs/a9d7d7fb-1535-4600-9dde-1bd94bca876f?secondary=Format):</p>
<pre><code class="language-python">foo = 5

aa = (
    float(&quot;16.0&quot;) &lt;= foo &lt;= float(&quot;20.0&quot;)
    and 5 &lt;= foo &lt;= 10
)
bb = 5 &lt;= foo &lt;= 10 and float(&quot;16.0&quot;) &lt;= foo &lt;= float(
    &quot;20.0&quot;
)
</code></pre>
<p>In both cases, <code>aa</code> is obviously easier to read. Ideally, the formatter would format <code>bb</code> the same way.</p>
<p>In other words, putting an expression on a new line (in parentheses) or splitting on <code>and</code> should be preferred over splitting a function call's arguments into their own line.</p>
<p>However, this would be a deviation from Black, so I'm not really sure what could be done.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Formatter should avoid splitting arguments from the last function call into a new line" to "Formatter should avoid splitting arguments into their own line" by @injust on 2025-11-22 21:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">formatter</span> added by @amyreese on 2025-11-24 18:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">style</span> added by @MichaReiser on 2025-11-25 18:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-25 18:38</div>
            <div class="timeline-body"><p>I agree that the inconsistency is a bit weird. The idea behind formatting it the way it is, is to avoid unnecessary parentheses, which is something that Black and Ruff both try very hard in expression contexts.</p>
<p>Taking <code>aa</code>, the reason it's formatted differently is that breaking the <code>float(&quot;16.0&quot;)</code> over the boolean operation would look strange:</p>
<pre><code class="language-py">aa = float(
	&quot;16.0&quot;
) &lt;= foo &lt;= float(&quot;20.0&quot;) and 5 &lt;= foo &lt;= 10
</code></pre>
<p>This is much harder to read because it requires scanning multiple lines.</p>
<p>On the other hand, the <code>bb</code> case is easier to read because there's nothing that comes after the closing parentheses of <code>float(&quot;20&quot;)</code> and it allows us to avoid an extra set of parentheses.</p>
<p>I think what makes this specific instance harder to read is that the comparsions both have a lower and upper bound. This in combination with <code>and</code> results in an overall fairly complicated expression that isn't easy to parse (at least, I find it not easy).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
