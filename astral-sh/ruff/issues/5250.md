```yaml
number: 5250
title: Shadowed variable incorrect report - F821 Undefined name
type: issue
state: closed
author: eddyashton
labels: []
assignees: []
created_at: 2023-06-21T12:53:19Z
updated_at: 2023-06-21T16:54:01Z
url: https://github.com/astral-sh/ruff/issues/5250
synced_at: 2026-01-10T01:56:47Z
```

# Shadowed variable incorrect report - F821 Undefined name

---

_Issue opened by @eddyashton on 2023-06-21 12:53_

Started getting a ruff failure from `0.0.273` (still present in `0.0.274`), which wasn't present in `0.0.272`. Believe the source is valid (though ugly) Python, and the ruff failure is incorrect.

Given this file:

```python
# tmp.py
list = [1, 2, 3]

for e in list:
    if e % 2 == 0:
        try:
            pass
        except Exception as e:
            pass
    else:
        print(e)
```

Old:
```
$ pip install ruff==0.0.272
...

$ ruff check tmp.py

$ echo $?
0
```

New:
```
$ pip install ruff==0.0.273
...

$ ruff check tmp.py
tmp.py:10:15: F821 Undefined name `e`
Found 1 error.

$ echo $?
1
```

The shadowing/reuse of `e` is risky, but (afaict) `e` is unambiguously defined at the line where `ruff` complains.

---

_Comment by @eddyashton on 2023-06-21 12:54_

Looks like this is also reported in #5249 - feel free to close this as dupe if its tracked there.

---

_Comment by @charliermarsh on 2023-06-21 14:00_

Thanks — gonna close as a dupe, but appreciate the clear issue and example.

(I do recommend against shadowing variable names with caught exceptions but agree we shouldn’t flag this.)

---

_Closed by @charliermarsh on 2023-06-21 14:01_

---

_Assigned to @charliermarsh by @charliermarsh on 2023-06-21 14:30_

---

_Referenced in [astral-sh/ruff#5256](../../astral-sh/ruff/pulls/5256.md) on 2023-06-21 15:29_

---

_Closed by @charliermarsh on 2023-06-21 16:54_

---
