<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ruff noqa feature and PGH004 - astral-sh/ruff #20913</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ruff noqa feature and PGH004</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/20913">#20913</a>
        opened by <a href="https://github.com/Morgadoooo">@Morgadoooo</a>
        on 2025-10-16 08:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Morgadoooo">@Morgadoooo</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p>Hello,</p>
<p>Quick question, I was wondering if a behaviour is &quot;intended&quot; regarding the <code># ruff: noqa</code> feature</p>
<p>Basically, let's say that i want to ignore a file.
I then do this at the top level of my file.</p>
<pre><code class="language-python"># ruff: noqa
</code></pre>
<p>I would expect it to ignore the file, but i get a <code>ruff check</code> error with</p>
<pre><code class="language-bash">  PGH004 Use specific rule codes when using `ruff: noqa`
   --&gt; /app.py:1:1
    |
  1 | # ruff: noqa
    | ^^^^^^^^^^^^
  2 | import logging
  3 | from collections import defaultdict
    |

  Found 1 error.
</code></pre>
<p>It seems odd to have to disable <code>PGH004</code> to be able to use this disabling feature.</p>
<p>I also know that, one can achieve this exclusion by providing the file in my ruff config but I didn't &quot;wanted&quot; to add it in the file.</p>
<p>Using ruff pre-commit hooks here</p>
<pre><code>-   repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.14.0
    hooks:
    -   id: ruff-check
    -   id: ruff-format
</code></pre>
<p>and</p>
<pre><code>‚ùØ uv self version
uv 0.9.3 (83635a6c4 2025-10-15)
</code></pre>
<h3>Version</h3>
<p>0.14.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @Morgadoooo on 2025-10-16 08:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-16 12:28</div>
            <div class="timeline-body"><p>I think the diagnostic message here is a bit confusing. For file level suppresesions, you always have to specify a rule code like this:</p>
<pre><code># ruff: noqa: PGH004
</code></pre>
<p>It doesn't support disabling all rules within a file. To ignore a file entirely, add it to <code>extend-exclude</code> in your ruff or pyproject.toml</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flashcode">@flashcode</a> on 2025-12-06 13:40</div>
            <div class="timeline-body"><p>I've hit the same issue when I use <code>--select ALL</code>, and I think it's a bug: the ruff doc says such line ignores <strong>all</strong> violations (<a href="https://docs.astral.sh/ruff/linter/#error-suppression">link</a>):</p>
<pre><code>To ignore all violations across an entire file, add the line # ruff: noqa anywhere in the file, preferably towards the top, like so:

# ruff: noqa
</code></pre>
<p>In my opinion, such line should really disable all errors, including PGH004.</p>
<p>PGH004 should only apply on such lines:</p>
<pre><code class="language-python">pass  # noqa
</code></pre>
<p>Having to exclude the file with <code>extend-exclude</code> should not be needed.</p>
<p>Also using <code>--ignore PGH004</code> is not a solution either, because I want to keep this error on lines ending with <code># noqa</code> (my example above).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-06 14:56</div>
            <div class="timeline-body"><p>You're right. <code># ruff: noqa</code> works.</p>
<p>I don't think it makes sense to suppress <code>PGH004</code> with <code>ruff: noqa</code>. The point of <code>PGH004</code> is to find blanked ignores.</p>
<p>You can do the following if you want to suppress <code>PGH004</code> in that file too:</p>
<pre><code class="language-py"># ruff: noqa: PGH004
# ruff: noqa
</code></pre>
<p>Note that Ruff will still show syntax errors even when disabling all rules. The only way to make Ruff skip a file entirely is to exclude it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2026-01-19 08:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-19 09:29:06 UTC
    </footer>
</body>
</html>
