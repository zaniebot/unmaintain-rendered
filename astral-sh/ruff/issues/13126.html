<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FURB105 fix removes `sep` arguments with side effects - astral-sh/ruff #13126</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>FURB105 fix removes `sep` arguments with side effects</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/13126">#13126</a>
        opened by <a href="https://github.com/dscorbett">@dscorbett</a>
        on 2024-08-27 18:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dscorbett">@dscorbett</a> on 2024-08-27 18:46</div>
            <div class="timeline-body"><p>The fix for <a href="https://docs.astral.sh/ruff/rules/print-empty-string/">FURB105</a> removes unneeded <code>sep</code> arguments even when they might have side effects. In that case, the fix should be omitted or marked unsafe.</p>
<pre><code class="language-console">$ ruff --version
ruff 0.6.2
$ cat furb105.py
print(sep=print(&quot;sep&quot;))
$ python furb105.py
sep

$ ruff check --isolated --select FURB105 furb105.py --fix
Found 1 error (1 fixed, 0 remaining).
$ cat furb105.py
print()
$ python furb105.py


</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @AlexWaygood on 2024-08-27 19:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fixes</span> added by @AlexWaygood on 2024-08-27 19:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-08-27 19:13</div>
            <div class="timeline-body"><p>I'd be happy to accept a PR that marked the fix as unsafe if we detected the argument to <code>sep=</code> as something that could have a side effect. We could use the <code>contains_effect</code> function we have here for that purpose: https://github.com/astral-sh/ruff/blob/483748c188e854370836182c6f08b35fb140ae93/crates/ruff_python_ast/src/helpers.rs#L46.</p>
<p>However, I think we should still offer the fix (though it'll be marked as unsafe), even in these situations. I think it'll honestly be relatively rare for somebody to pass in a function that has a side effect to <code>sep=</code> here, and <code>contains_effect()</code> errs on the side of assuming that arbitrary functions might have side effects, although in reality they often won't.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">accepted</span> added by @AlexWaygood on 2024-08-27 19:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-08-30 15:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/13165.html">astral-sh/ruff#13165</a> on 2024-08-30 16:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-30 16:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:14 UTC
    </footer>
</body>
</html>
