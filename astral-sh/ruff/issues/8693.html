<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UP032 fix can shadow INT002 violation - astral-sh/ruff #8693</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UP032 fix can shadow INT002 violation</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/ruff/issues/8693">#8693</a>
        opened by <a href="https://github.com/ThiefMaster">@ThiefMaster</a>
        on 2023-11-15 12:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2023-11-15 12:39</div>
            <div class="timeline-body"><h3>Python file</h3>
<pre><code class="language-py">_('foo {}'.format(bar))
</code></pre>
<h3>ruff output</h3>
<pre><code class="language-shell">$ ruff --isolated --select INT,UP --preview rufftest/ruff_sample.py
rufftest/ruff_sample.py:1:3: UP032 [*] Use f-string instead of `format` call
rufftest/ruff_sample.py:1:3: INT002 `format` method argument is resolved before function call; consider `_(&quot;string %s&quot;) % arg`
Found 2 errors.
[*] 1 fixable with the `--fix` option.

$ ruff --isolated --select INT,UP --preview rufftest/ruff_sample.py --diff
--- rufftest/ruff_sample.py
+++ rufftest/ruff_sample.py
@@ -1 +1 @@
-_('foo {}'.format(bar))
+_(f'foo {bar}')

Would fix 1 error.
</code></pre>
<p>Luckily the fixed version will then trigger INT001, but maybe UP032 could try to detect if it's inside a gettext call and in that case mark the fix as unsafe?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2023-11-15 12:45</div>
            <div class="timeline-body"><p>Alternatively a fixer for the <code>INT</code> violations would do the job. Probably easier to implement than detecting context in <code>UP032</code>...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2023-11-15 16:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2023-11-15 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2023-11-15 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-15 16:47</div>
            <div class="timeline-body"><p>Torn on this... It might be surprising that UP032 doesn't trigger in that case, if we were to change it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:51 UTC
    </footer>
</body>
</html>
