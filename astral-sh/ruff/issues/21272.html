<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>noqa: RET503 not working - astral-sh/ruff #21272</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>noqa: RET503 not working</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ruff/issues/21272">#21272</a>
        opened by <a href="https://github.com/Siecje">@Siecje</a>
        on 2025-11-04 13:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Siecje">@Siecje</a></div>
            <div class="timeline-body">Summary
<p>I&#x27;m using <code>flask.abort()</code> and want to ignore RET503 for this line by using <code>noqa: RET503</code>.</p>
<p><code>ruff</code> is complaining about <code>RET503</code> and also the <code>noqa</code> with RUF100.</p>
<p>This was working over a year ago when I last ran ruff on this project.</p>
<pre><code>RET503 Missing explicit `return` at the end of function able to return non-`None` value
   --&gt; htmd/site.py:261:1
    |
261 | / @app.route(&#x27;/draft/&lt;post_uuid&gt;/&#x27;)
262 | | def draft(post_uuid: str) -&gt; ResponseReturnValue:
263 | |     for post in posts:
264 | |         if str(post.meta.get(&#x27;draft&#x27;, &#x27;&#x27;)).replace(&#x27;build|&#x27;, &#x27;&#x27;) == post_uuid:
265 | |             return render_template(&#x27;post.html&#x27;, post=post)
266 | |     abort(404)  # noqa: RET503
    | |______________^
    |
help: Add explicit `return` statement

RUF100 [*] Unused `noqa` directive (unused: `RET503`)
   --&gt; htmd/site.py:266:17
    |
264 |         if str(post.meta.get(&#x27;draft&#x27;, &#x27;&#x27;)).replace(&#x27;build|&#x27;, &#x27;&#x27;) == post_uuid:
265 |             return render_template(&#x27;post.html&#x27;, post=post)
266 |     abort(404)  # noqa: RET503
    |                 ^^^^^^^^^^^^^^
    |
help: Remove unused `noqa` directive
</code></pre>
<p>Code in question:</p>
<p>https://github.com/Siecje/htmd/blob/a8974196d4c4ffabdba204b55ad6e7d0cff8896b/htmd/site.py#L261-L266</p>
Version
<p>ruff 0.14.3 (8737a2d5f 2025-10-30)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ntBre">@ntBre</a> on 2025-11-04 14:45</div>
            <div class="timeline-body"><p>I think this was an intentional change in version 0.12.0 (#18516). It looks like you now have to put the <code>noqa</code> on the line with the decorator: https://play.ruff.rs/1c8494eb-4dff-4a35-ab29-0dc55756a23b</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/ntBre">@ntBre</a> on 2025-11-04 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-04 14:47</div>
            <div class="timeline-body"><p>Including the decorator in the range seems wrong to me. I think the range should skip the decorators.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/Siecje">@Siecje</a> on 2025-11-04 15:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:50:35 UTC
    </footer>
</body>
</html>
