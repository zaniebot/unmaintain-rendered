<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add script to update `ty.json` in schemastore - astral-sh/ty #65</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add script to update <code>ty.json</code> in schemastore</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/ty/pull/65">#65</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-05-06 18:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-06 18:10</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Adds a script to update ty's schema in the schemastore repository</p>
<p>Closes https://github.com/astral-sh/ty/issues/13</p>
<h2>Test plan</h2>
<p>https://github.com/astral-sh/schemastore/pull/new/update-ty-52d16b44bcc060bec0a0381a1ea8052bf4479f14</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by @MichaReiser on 2025-05-06 18:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-06 18:25</div>
            <div class="timeline-body"><blockquote>
<p>Check that the ruff submodule has no changes or automatically update it</p>
</blockquote>
<p>You could crib this from the <code>release.sh</code> script (and / or move it to a <code>check-submodule.sh</code> script). I'm unsure it should be updated though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-06 18:30</div>
            <div class="timeline-body"><blockquote>
<p>You could crib this from the release.sh script (and / or move it to a check-submodule.sh script). I'm unsure it should be updated though.</p>
</blockquote>
<p>Yeah, updating feels a bit aggressive but I think it's important to warn if someone is on a stale revision. I've to figure out how to check that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>scripts/update_schemastore.py</code>:1 on 2025-05-07 09:00</div>
            <div class="timeline-body"><p>This is mostly just copy paste from the ruff repository. The only real addition is in <code>main</code> where we check the state of the <code>ruff</code> submodule</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @MichaReiser on 2025-05-07 09:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-05-07 09:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-05-07 14:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>scripts/update_schemastore.py</code>:17 on 2025-05-07 14:55</div>
            <div class="timeline-body"><p>It's more idiomatic to use ALL_CAPS for these module level constants.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-05-07 14:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>scripts/update_schemastore.py</code>:19 on 2025-05-07 14:55</div>
            <div class="timeline-body"><p>It's really quite naughty to run a subprocess on import. Could you avoid that? :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-05-07 14:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>scripts/update_schemastore.py</code>:19 on 2025-05-07 14:56</div>
            <div class="timeline-body"><p>Is this just <code>Path(__file__) / ..</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-05-07 14:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>scripts/update_schemastore.py</code>:21 on 2025-05-07 14:56</div>
            <div class="timeline-body"><p>This should be relative to <code>Path(__file__)</code> which makes the script working directory agnostic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-05-07 16:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>scripts/update_schemastore.py</code>:21 on 2025-05-07 16:30</div>
            <div class="timeline-body"><p>This is a relative path to the schemastore repository and it gets concatenated with the path to the schemastore repositroy. So I think what's here is correct.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-05-07 16:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>scripts/update_schemastore.py</code>:19 on 2025-05-07 16:32</div>
            <div class="timeline-body"><p>Yes. This was already present in the existing script. I don't mind it using <code>git</code> here, considering how much other git operations its running anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2025-05-07 16:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>scripts/update_schemastore.py</code>:19 on 2025-05-07 16:33</div>
            <div class="timeline-body"><blockquote>
<p>It's really quite naughty to run a subprocess on import. Could you avoid that? :)</p>
</blockquote>
<p>I don't think it matters. This is a one of script. Don't import it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2025-05-08 11:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-05-08 11:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-05-08 11:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:42:13 UTC
    </footer>
</body>
</html>
