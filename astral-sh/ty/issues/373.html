<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>error[invalid-type-form]: Variable of type `&lt;module 'PIL.Image'&gt;` is not allowed in a type expression - astral-sh/ty #373</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>error[invalid-type-form]: Variable of type `&lt;module 'PIL.Image'&gt;` is not allowed in a type expression</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/373">#373</a>
        opened by <a href="https://github.com/Ryang20718">@Ryang20718</a>
        on 2025-05-13 23:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Ryang20718">@Ryang20718</a> on 2025-05-13 23:44</div>
            <div class="timeline-body"><h3>Summary</h3>
<pre><code>from PIL import Image


def hello(x: Image):
     print(x)
</code></pre>
<p>error[invalid-type-form]: Variable of type <code>&lt;module 'PIL.Image'&gt;</code> is not allowed in a type expression</p>
<h3>Version</h3>
<p>ty 0.0.0-alpha.8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-13 23:52</div>
            <div class="timeline-body"><p>Thanks for the report. However, I think ty is correct in emitting this diagnostic. Mypy also emits a diagnostic on this code -- here's what it says here:</p>
<pre><code>% uvx --with=Pillow mypy foo.py      
Installed 4 packages in 11ms
foo.py:3: error: Module &quot;PIL.Image&quot; is not valid as a type  [valid-type]
foo.py:3: note: Perhaps you meant to use a protocol matching the module structure?
Found 1 error in 1 file (checked 1 source file)
</code></pre>
<p>And so does pyright:</p>
<pre><code>% uvx --with=Pillow pyright foo.py
Installed 4 packages in 91ms
/Users/alexw/dev/ruff/foo.py
  /Users/alexw/dev/ruff/foo.py:3:10 - error: Module cannot be used as a type (reportGeneralTypeIssues)
1 error, 0 warnings, 0 informations
</code></pre>
<p>Do you find our diagnostic here confusing? Could we make it clearer? :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> added by @AlexWaygood on 2025-05-13 23:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @AlexWaygood on 2025-05-13 23:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jelle-openai">@jelle-openai</a> on 2025-05-14 00:14</div>
            <div class="timeline-body"><p>You probably want to use <code>Image.Image</code> as an annotation, for what it's worth. <code>PIL.Image</code> is a module, <code>PIL.Image.Image</code> is a class.</p>
<p>Possibly ty could detect this case (a module having a member with the same name) and suggest that that's what the user meant.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @AlexWaygood by @AlexWaygood on 2025-05-21 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @AlexWaygood on 2025-05-21 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> removed by @AlexWaygood on 2025-05-21 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">diagnostics</span> added by @AlexWaygood on 2025-05-21 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-05-21 19:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:01 UTC
    </footer>
</body>
</html>
