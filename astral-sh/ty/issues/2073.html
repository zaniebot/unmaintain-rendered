<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Split more pedantic Liskov checks into separate error codes (and have them disabled by default) - astral-sh/ty #2073</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Split more pedantic Liskov checks into separate error codes (and have them disabled by default)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/2073">#2073</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-12-18 14:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><p>Our rule enforcing the Liskov Substitution Principle on method overrides (currently called <code>invalid-method-override</code>) is currently much stricter than any other type checker's equivalent rule. We should split the more pedantic parts of this rule out into separate error codes, so that it is easier for users switching from other type checkers to incrementally adopt ty: they will then be able to suppress the specific error codes that cover the parts pyright/mypy did not complain about on a per-module basis.</p>
<p>One situation where we are stricter than other type checkers currently is the situation where the subclass method parameter has the same type annotation to the superclass method parameter, but the parameter has a different name. Mypy <a href="https://mypy-play.net/?mypy=latest&amp;python=3.12&amp;gist=44806f2f7a48b90407ebfe700b029c41">does not</a> complain about this; pyright <a href="https://pyright-play.net/?pyrightVersion=1.1.405&amp;pythonVersion=3.13&amp;reportUnreachable=true&amp;code=MYGwhgzhAECCBcAoaLoBMCmAzaBbDALgBYD2aAFBBiFgDTQAe80AlgHYECU0AtAHzQAciTYYkqCdAAOkCIkShZ0AELlYncakw58xMpWp1oAT2bsuvAcNGbJ02YiA">does</a>, but only if the method is <a href="https://pyright-play.net/?pyrightVersion=1.1.405&amp;pythonVersion=3.13&amp;reportUnreachable=true&amp;code=MYGwhgzhAECCBcAoaLoBMCmAzaB9XAthgC4AWA9mvgBQQYhYA00AHvNAJYB2xAlNAFoAfNABy5LhiSoZ0AA6QIiRKEXQAQtVi9pqTDnxEylGnQbMAnu259BI8ZN2z5ixEA">not a dunder method</a>:</p>
<pre><code class="language-py">class A:
    def method(self, x: int) -&gt; None:
        pass

class B(A):
    def method(self, y: int) -&gt; None:
        pass
</code></pre>
<p>Another situation where we are stricter than other type checkers is the case where the superclass parameter is positional-or-keyword, but the subclass parameter is positional-only. Mypy <a href="https://mypy-play.net/?mypy=latest&amp;python=3.12&amp;gist=81eb1a0b42ad71aaeb24d13e2c054476">does not</a> complain about this, but pyright <a href="https://pyright-play.net/?pyrightVersion=1.1.405&amp;pythonVersion=3.13&amp;reportUnreachable=true&amp;code=MYGwhgzhAECCBcAoaLoBMCmAzaBbDALgBYD2aAFBBiFgDTQAe80AlgHYECU0AtAHzQAciTYYkqCdAAOkCIkShZ0AELlYncakw58xMpWp1GzdgXoB6bvyEixySShlREQA">does</a> (and for this one, pyright <a href="https://pyright-play.net/?pyrightVersion=1.1.405&amp;pythonVersion=3.13&amp;reportUnreachable=true&amp;code=MYGwhgzhAECCBcAoaLoBMCmAzaB9XAthgC4AWA9mvgBQQYhYA00AHvNAJYB2xAlNAFoAfNABy5LhiSoZ0AA6QIiRKEXQAQtVi9pqTDnxEylGnQbM2nHswD0-YWIlTkslAqiIgA">does not distinguish</a> between dunder methods and non-dunder methods).</p>
<pre><code class="language-py">class A:
    def method(self, x: int) -&gt; None:
        pass

class B(A):
    def method(self, x: int, /) -&gt; None:
        pass
</code></pre>
<p>Similar to https://github.com/astral-sh/ty/issues/1644, it's very hard to tackle this without propagating the reason for a subtyping failure out of our <code>Type::has_relation_to_impl</code> methods. So this is blocked by https://github.com/astral-sh/ty/issues/163 currently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @AlexWaygood on 2025-12-18 14:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">diagnostics</span> added by @AlexWaygood on 2025-12-18 14:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:21:26 UTC
    </footer>
</body>
</html>
