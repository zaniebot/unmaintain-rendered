<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Path handling on non-case sensitive systems - astral-sh/ty #189</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Path handling on non-case sensitive systems</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/189">#189</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-02-26 15:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-02-26 15:12</div>
            <div class="timeline-body"><p>The project file discovery and the <code>Files</code> interner assume that two paths that only different in casing are two unique paths. However, this is not true on all file systems and it could result in Red Knot considering two files as being different even though they're the same on disk.</p>
<p>We should test how Red Knot handles paths with different casing on case-insensitive file systems (looking at you Windows). That also includes project file discovery.</p>
<p>Related to https://github.com/astral-sh/ruff/issues/13691</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[red-knot] Path handling on non-path sensitive systems" to "[red-knot] Path handling on non-case sensitive systems" by @carljm on 2025-02-26 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-14 09:57</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/16521 makes the module resolver case sensitive. It also adds a test demonstrating where our watcher gets out of sync with the <code>Files</code> state on case-insensitive systems (the test is currently ignored because of it and fixing this PR should make this test pass)</p>
<p>The main outstanding issue is that <code>Files</code> is case sensitive but it doesn't use case-sensitive system calls. However, how we fix this depends on a UX question: Should paths passed to the Red Knot CLI or in configurations be case sensitive on all platforms or only on case-sensitve platforms. Depending on that, we may need to make <code>Files</code> case-sensitive or respect the platform's case sensitivity and we may have to do the same for all <code>SystemPath</code> methods that compare paths (<code>starts_with</code>, <code>ends_with</code>, <code>equals</code>, ...)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[red-knot] Path handling on non-case sensitive systems" to "Path handling on non-case sensitive systems" by @MichaReiser on 2025-05-07 15:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Beta" by @MichaReiser on 2025-08-08 14:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "GA" by @MichaReiser on 2025-08-08 14:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @carljm on 2025-11-13 00:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @carljm on 2025-11-13 00:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Stable" by @MichaReiser on 2025-11-14 08:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Z post-stable" by @MichaReiser on 2025-11-14 08:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Z post-stable" by @carljm on 2025-11-18 16:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:10:55 UTC
    </footer>
</body>
</html>
