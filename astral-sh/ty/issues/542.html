<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convert tracing warnings during `site-packages` discovery to diagnostic warnings - astral-sh/ty #542</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Convert tracing warnings during <code>site-packages</code> discovery to diagnostic warnings</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/542">#542</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-05-29 20:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><p>This file has lots of places where it emits tracing warnings if <code>site-packages</code> discovery doesn&#x27;t go to plan: https://github.com/astral-sh/ruff/blob/main/crates/ty_python_semantic/src/site_packages.rs. Ideally we should convert these to warning-level diagnostics so that they&#x27;re more visible to IDE users (suggested by @MichaReiser in <a href="https://github.com/astral-sh/ruff/pull/18335">astral-sh/ruff#18335</a>#discussion_r2111051215)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">diagnostics</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-29 20:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">imports</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-29 20:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-29 20:21</div>
            <div class="timeline-body"><p>To clarify: we should only convert the once that require user interaction (where we expect them to change something) because warning diagnostics can change the exit code</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-29 20:25</div>
            <div class="timeline-body"><p>Hrm. A message like this I think would be useful for the user to see (it&#x27;ll help them diagnose the cause of type-checking diagnostics) but I don&#x27;t know what we expect the user to do about it. It most likely indicates a bug in uv or ty, if it happens! But I don&#x27;t think we should fail the process, because type-checking <em>might</em> proceed just fine.</p>
<p>What about an info-level diagnostic? Would we still exit with code 0 if we did that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-29 20:27</div>
            <div class="timeline-body"><p>I guess one action the user could take in response to that diagnostic is to not use <code>uv run --with=ty</code>, and instead run ty using some other uv invocation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/carljm">@carljm</a> on 2025-11-13 06:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:42 UTC
    </footer>
</body>
</html>
