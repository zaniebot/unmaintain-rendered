<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyQt/PySide `unsupported-operator` error - astral-sh/ty #912</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>PyQt/PySide <code>unsupported-operator</code> error</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/912">#912</a>
        opened by <a href="https://github.com/my1e5">@my1e5</a>
        on 2025-07-29 13:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/my1e5">@my1e5</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I searched the issue tracker for <code>unsupported-operator</code> but couldn't determine exactly if this was a duplicate issue.</p>
<h2>MRE</h2>
<pre><code class="language-py">from PySide6.QtCore import Qt
from PySide6.QtGui import QKeySequence

QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_P)
</code></pre>
<p>Since ty <code>0.0.1a15</code> this is triggering an error:</p>
<h3><code>0.0.1a15</code></h3>
<pre><code>$ uvx --with pyside6 --with ty==0.0.1a15 ty check dev/ty.py
Installed 5 packages in 3.46s
WARN ty is pre-release software and not ready for production use. Expect to encounter bugs, missing features, and fatal errors.
error[unsupported-operator]: Operator `|` is unsupported between objects of type `Modifier` and `Key`
 --&gt; dev\ty.py:4:14
  |
2 | from PySide6.QtGui import QKeySequence
3 |
4 | QKeySequence(Qt.Modifier.CTRL | Qt.Key.Key_P)
  |              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
info: rule `unsupported-operator` is enabled by default

Found 1 diagnostic
</code></pre>
<h3><code>0.0.1a14</code></h3>
<pre><code>$ uvx --with pyside6 --with ty==0.0.1a14 ty check dev/ty.py
Installed 5 packages in 3.51s
WARN ty is pre-release software and not ready for production use. Expect to encounter bugs, missing features, and fatal errors.
All checks passed!
</code></pre>
<p>Reference  - https://doc.qt.io/qtforpython-6/PySide6/QtGui/QKeySequence.html#detailed-description</p>
<h3>Version</h3>
<p>ty 0.0.1-alpha.16 (c452e53a0 2025-07-25)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @sharkdp on 2025-07-29 14:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @sharkdp by @sharkdp on 2025-07-29 14:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-29 14:18</div>
            <div class="timeline-body"><p>Thank you for reporting this.</p>
<p>We now support enums, but we don't properly support <code>enum.Flag</code>-based classes yet (#876).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-29 14:48</div>
            <div class="timeline-body"><p>Upon closer inspection (and realizing that this OR-s together two different enums), I'm actually not sure this is a bug. The stubs for <code>QtCore</code> seem incomplete. This is <code>Modifier</code>:</p>
<pre><code class="language-pyi">class Modifier(enum.Flag):
    SHIFT                     = ...  # 0x2000000
    CTRL                      = ...  # 0x4000000
    ALT                       = ...  # 0x8000000
    META                      = ...  # 0x10000000
    MODIFIER_MASK             = ...  # 0xfe000000
</code></pre>
<p>And <code>Key</code> looks like:</p>
<pre><code class="language-pyi">class Key(enum.IntEnum):
    Key_Any                   = ...  # 0x20
    # […]
    Key_unknown               = ...  # 0x1ffffff
</code></pre>
<p>Notably, there is no custom <code>__or__</code> method that would allow <code>Modifier</code> and <code>Key</code> to be OR-ed. And <code>enum.Flag</code>'s <code>__or__</code> method is not applicable, because it requires <code>other</code> to be of the same type:</p>
<pre><code class="language-pyi">class Flag(Enum):
    # […]
    def __or__(self, other: Self) -&gt; Self: ...
</code></pre>
<p>pyright also issues an error:</p>
<pre><code>main.py:5:14 - error: Operator &quot;|&quot; not supported for types &quot;Literal[Modifier.CTRL]&quot; and &quot;Literal[Key.Key_P]&quot; (reportOperatorIssue)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @sharkdp on 2025-07-29 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @sharkdp on 2025-07-29 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sharkdp on 2025-07-29 15:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:20:23 UTC
    </footer>
</body>
</html>
