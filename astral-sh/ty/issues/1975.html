<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`dict` literal not accepted as `Mapping` argument - astral-sh/ty #1975</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>dict</code> literal not accepted as <code>Mapping</code> argument</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1975">#1975</a>
        opened by <a href="https://github.com/tibdex">@tibdex</a>
        on 2025-12-17 05:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tibdex">@tibdex</a></div>
            <div class="timeline-body">Summary
<p>In:</p>
<pre><code>from collections.abc import Mapping
from typing import Literal

type DataType = Literal[&quot;BOOL&quot;, &quot;INT&quot;, &quot;FLOAT&quot;]

def process(data_types: Mapping[str, DataType], /) -&gt; None:
    ...

process({&quot;foo&quot;:&quot;BOOL&quot;})
</code></pre>
<p>I would expect the type checker to see that <code>{&quot;foo&quot;:&quot;BOOL&quot;}</code> conforms to <code>Mapping[str, DataType]</code> when it is declared, and since it is not assigned anywhere, it cannot be mutated in a way that would modify its type before being passed as an argument.</p>
<p>However, I get:</p>
<pre><code>Argument to function `process` is incorrect: Expected `Mapping[str, DataType]`, found `dict[Unknown | str, Unknown | str]` (invalid-argument-type) [Ln 9, Col 9]
</code></pre>
<p><a href="https://www.typescriptlang.org/play/?#code/C4TwDgpgBAIghsOAVc0C8UBEAhA8rgGUygB8sBJAOSWLMwDEDcBBGgKDYGMB7AOwGdgUMACdunCP35QMACgAmCZKn4AuKACUIceXwA2IADwBvANq84AWwirBIgJa8A5gF118RCkgBfAHwBKGV8oY28Abg5RcUl+WWNuAGt1HHwib382KIkpON5uYFwkrBhWAFFMdI4eASF+bmtcACMAKwhOIQx4opTCCoismNk6hpa24H8woA">TypeScript 5.9.3 behaves like I expect</a>:</p>
<pre><code>type DataType = &quot;BOOL&quot; | &quot;INT&quot; | &quot;FLOAT&quot;

const process = (dataTypes: Readonly&lt;{[name:string]: DataType}&gt;) =&gt; {};

// This is accepted, but ty rejects it :(
process({ok: &quot;BOOL&quot;})

// Type &#x27;&quot;DATE&quot;&#x27; is not assignable to type &#x27;DataType&#x27;
process({notOk: &quot;DATE&quot;})

const someObject = {ok: &quot;BOOL&quot;};
// Argument of type &#x27;{ ok: string; }&#x27; is not assignable to parameter of type // &#x27;Readonly&lt;{ [name: string]: DataType; }&gt;&#x27;.
//   Property &#x27;ok&#x27; is incompatible with index signature.
//    Type &#x27;string&#x27; is not assignable to type &#x27;DataType&#x27;.
process(someObject);
</code></pre>
Version
<p>0.0.2.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-17 07:02</div>
            <div class="timeline-body"><p>Thanks! Please see #1576. We&#x27;re working on solutions to this :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-17 07:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tibdex">@tibdex</a> on 2025-12-17 13:39</div>
            <div class="timeline-body"><p>Thanks</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:28 UTC
    </footer>
</body>
</html>
