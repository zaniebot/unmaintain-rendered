<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>support `type[...]` where `...` is a generic alias - astral-sh/ty #1101</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>support <code>type[...]</code> where <code>...</code> is a generic alias</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1101">#1101</a>
        opened by <a href="https://github.com/carljm">@carljm</a>
        on 2025-08-27 21:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a></div>
            <div class="timeline-body"><p>https://play.ty.dev/1ac81fdc-057b-487a-9910-1d690b4ca673</p>
<pre><code class="language-py">class C[T]:
    pass

class D[T]:
    pass

var: type[C[int]] = D[int]

</code></pre>
<p>This assignment should be an error, but currently isn't.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Beta" by @carljm on 2025-08-27 21:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @carljm on 2025-08-27 21:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type properties</span> added by @carljm on 2025-08-27 21:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @dcreager by @carljm on 2025-09-19 14:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-11-10 12:26</div>
            <div class="timeline-body"><p>The behaviour here is just because we don't support <code>type[C[int]]</code> in user annotations yet -- you're hitting this TODO branch: https://github.com/astral-sh/ruff/blob/f44598dc113a7380ca52d6c969431ca929a93473/crates/ty_python_semantic/src/types/infer/builder/type_expression.rs#L683-L686</p>
<p>If you workaround the missing piece in our type-expression parsing, you'll find that we emit the error you expect here:</p>
<pre><code class="language-py">from ty_extensions import TypeOf

class C[T]:
    pass

class D[T]:
    pass

def f(x: C[int]):
    meta_x = type(x)
    reveal_type(meta_x)  # revealed: type[C[int]]
    _: TypeOf[meta_x] = D[int]  # error[invalid-assignment] &quot;Object of type `&lt;class 'D[int]'&gt;` is not assignable to `type[C[int]]`&quot;
</code></pre>
<p>https://play.ty.dev/eb85e9ee-1ce4-420e-bb61-6bfdf6297985</p>
<p>Possibly fixing the TODO branch in https://github.com/astral-sh/ruff/blob/f44598dc113a7380ca52d6c969431ca929a93473/crates/ty_python_semantic/src/types/infer/builder/type_expression.rs#L683-L686 should also be a Beta issue, but it's a pretty different issue to the one originally reported here ðŸ˜„</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @dcreager by @MichaReiser on 2025-11-10 16:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @oconnor663 by @MichaReiser on 2025-11-10 16:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "wrong assignability of mismatched GenericAlias to a SubclassOf type" to "support `type[...]` where `...` is a generic alias" by @carljm on 2025-11-10 16:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @oconnor663 on 2025-11-24 21:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:20:33 UTC
    </footer>
</body>
</html>
