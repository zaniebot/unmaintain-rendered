<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pass the typing conformance suite - astral-sh/ty #146</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Pass the typing conformance suite</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/146">#146</a>
        opened by <a href="https://github.com/carljm">@carljm</a>
        on 2025-03-27 18:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a></div>
            <div class="timeline-body"><p>...or explicitly document the cases where we intentionally choose to diverge from it? (In which case we should advocate for a change to / relaxation of the spec.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[red-knot] pass the typing conformance suite" to "pass the typing conformance suite" by @MichaReiser on 2025-05-07 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">typing semantics</span> added by @AlexWaygood on 2025-05-11 07:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "pass the typing conformance suite" to "Pass the typing conformance suite" by @dhruvmanila on 2025-07-18 14:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexanderWillner">@AlexanderWillner</a> on 2025-10-14 18:58</div>
            <div class="timeline-body"><p>Based on <a href="https://sinon.github.io/future-python-type-checkers/">How Well Do New Python Type Checkers Conform?</a> we see <a href="https://htmlpreview.github.io/?https://github.com/sinon/typing/blob/058ea116b6d8d98d3372c775865cec9f4f9e45c3/conformance/results/results.html">that ty 0.0.1-alpha.19 passes 20 tests</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/oconnor663">@oconnor663</a> on 2025-12-05 00:29</div>
            <div class="timeline-body"><p>Carl has pointed out some overly-strict asserts in the conformance suite that we might want to submit a PR upstream for. Copying from chat:</p>
<blockquote>
<p>the relevant tests (which we still fail, due to the over-specification of assert_type) are at https://github.com/python/typing/blob/main/conformance/tests/generics_defaults.py#L30 and following</p>
<p>for us, an unspecialized mention of the value NoNonDefaults is just a singleton &quot;class object&quot; type, which is a subtype of type[NoNonDefaults[str, int]], but not equivalent to it</p>
<p>but these conformance tests (IMO) over-specify here</p>
<p>they should instead just test that if you type-annotate something as NoNonDefaults, you get a type of NoNonDefaults[str, int] for that name (which is true for us)</p>
<p>https://play.ty.dev/e871464d-4c6e-4d71-b032-b055f0192997</p>
<p>Obviously that still uses assert_type -- I think the real problem isn't using assert_type, it's that &quot;the type of a generic class object as a value&quot; is not well-specified in the Python type system, and the conformance suite shouldn't implicitly assert that it must be a default-specialized type[] type</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-05 18:54</div>
            <div class="timeline-body"><p>In https://github.com/astral-sh/ty/issues/1762#issuecomment-3616910856 @AlexWaygood suggests a workaround we could implement in our <code>assert_type</code> handling that could be an alternative to changing these <code>assert_type</code> usages upstream. (The rationale is that this issue doesn't only impact the conformance suite, it also impacts other people using <code>assert_type</code> to test their stubs.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tsudol-plaid">@tsudol-plaid</a> on 2025-12-17 19:57</div>
            <div class="timeline-body"><p>Now that ty is in beta (congrats!!!!) are there plans to add it to the conformance test suite?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-12-17 20:01</div>
            <div class="timeline-body"><p>Yep, we're planning on working on it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "Stable" by @carljm on 2025-12-19 23:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "M1" by @carljm on 2025-12-19 23:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @AlexWaygood by @carljm on 2026-01-09 15:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:19:37 UTC
    </footer>
</body>
</html>
