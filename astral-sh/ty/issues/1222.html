<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>function containing infinite loop doesn't report any warning - astral-sh/ty #1222</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>function containing infinite loop doesn't report any warning</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1222">#1222</a>
        opened by <a href="https://github.com/KotlinIsland">@KotlinIsland</a>
        on 2025-09-20 15:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/KotlinIsland">@KotlinIsland</a> on 2025-09-20 15:22</div>
            <div class="timeline-body"><h3>Summary</h3>
<pre><code class="language-py">def f() -&gt; int:
    while True:
        pass
</code></pre>
<p>while this is technically valid, it doesn't make any sense, imo the infinite loop control flow shouldn't allow this, or at least display a warning</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @sharkdp on 2025-09-22 07:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">control flow</span> added by @sharkdp on 2025-09-22 07:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> removed by @sharkdp on 2025-09-22 07:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">lint</span> added by @sharkdp on 2025-09-22 07:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-09-22 08:01</div>
            <div class="timeline-body"><p>Thank you for reporting this.</p>
<p>It looks like other type checkers also don't report an error here, and as you've stated, there is nothing technically wrong with this function. There are also perfectly valid use cases for functions that return <code>int</code>, but contain an infinite loop. I agree that this particular case (with no <code>return</code> statements inside the loop) looks like an oversight, though.</p>
<p>So having a lint rule that would catch functions that are annotated with a non-empty type, but whose actual return type is <code>Never</code>, sounds like a reasonable idea.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KotlinIsland">@KotlinIsland</a> on 2025-09-22 08:14</div>
            <div class="timeline-body"><blockquote>
<p>but contain an infinite loop</p>
</blockquote>
<p>the specific loop i am describing here is a <code>Never</code> loop, not just any old infinite loop</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-09-22 20:23</div>
            <div class="timeline-body"><p>I agree that at best this should be a lint rule, not a type error.</p>
<blockquote>
<p>having a lint rule that would catch functions that are annotated with a non-empty type, but whose actual return type is <code>Never</code>, sounds like a reasonable idea.</p>
</blockquote>
<p>I've seen this lint rule proposed before. One issue is that it doesn't play well with methods and inheritance. The method <code>def method(self) -&gt; int: raise NotImplementedError()</code> is a common base-class pattern. One could argue that it should always be explicitly decorated with <code>@abstractmethod</code> or something? At that point it's firmly in the category of &quot;opinionated opt-in lint rule.&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/KotlinIsland">@KotlinIsland</a> on 2025-09-22 23:42</div>
            <div class="timeline-body"><p>@carljm i am only concerned with <code>Never</code> loops, i don't think this check should apply to anything else</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:31 UTC
    </footer>
</body>
</html>
