<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using the walrus operator together with callable causes TypeIs to be ignored. - astral-sh/ty #2300</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using the walrus operator together with callable causes TypeIs to be ignored.</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/2300">#2300</a>
        opened by <a href="https://github.com/phi-friday">@phi-friday</a>
        on 2026-01-02 05:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/phi-friday">@phi-friday</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>https://play.ty.dev/c4b6196b-5a1c-4f2e-a61c-09b50d38fbc0</p>
<pre><code class="language-python">from typing import Any, reveal_type
from collections.abc import Callable

class Test:
    func: Callable[..., Any]

foo = Test()
first = getattr(foo, &quot;func&quot;, None)
if callable(first):
    reveal_type(first)
if callable(second:=getattr(foo, &quot;func&quot;, None)):
    reveal_type(second)
</code></pre>
<pre><code>Revealed type: `Any &amp; Top[(...) -&gt; object]` (revealed-type) [Ln 10, Col 17]
Revealed type: `Any | None` (revealed-type) [Ln 12, Col 17]
</code></pre>
<p>Even if the ty can't fully infer the type of func, it should still be able to determine whether it is a callable object or not.</p>
<p>If this problem is caused by #626, please close it as a duplicate.</p>
<h3>Version</h3>
<p>playground 26230b1ed</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">narrowing</span> added by @mtshiba on 2026-01-02 07:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">callables</span> added by @mtshiba on 2026-01-02 07:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2026-01-04 18:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2026-01-06 01:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:21:39 UTC
    </footer>
</body>
</html>
