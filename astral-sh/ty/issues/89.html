<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LSP: Support Workspace folders - astral-sh/ty #89</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>LSP: Support Workspace folders</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/89">#89</a>
        opened by <a href="https://github.com/dhruvmanila">@dhruvmanila</a>
        on 2024-08-22 10:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a></div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/13041 restricts the red knot server to only work when there&#x27;s only one workspace opened in the editor. We should add support for multi-root workspaces.</p>
<p>The challenge here is that which workspace should the untitled / non-workspace files belong to.</p>
<p>Currently, we&#x27;ve made an assumption that any untitled files or non-workspace files are part of the only available workspace. When multi-root workspaces are supported, we need to make sure the user experience is still good and find a way to provide intellisense for non-workspace / untitled files when there are multiple workspaces.</p>
<p>One solution is to implement an ad-hoc database where these files would go but this limits the user experience because we won&#x27;t be able to resolve the virtual environment for a workspace thus not able to provide any intellisense features for third-party libraries.</p>
<p>The implementation should also consider the fact that workspaces can be added / removed while the server is active. This is supported currently in the Ruff native server and is done via the <a href="https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#workspace_didChangeWorkspaceFolders"><code>didChangeWorkspaceFolders</code></a> notification.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-22 10:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Support multi-root workspaces in Red Knot server&quot; to &quot;[red-knot] multi-root workspaces in server&quot; by <a href="https://github.com/carljm">@carljm</a> on 2025-03-27 19:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[red-knot] multi-root workspaces in server&quot; to &quot;multi-root workspaces in server&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-07 15:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-07 15:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-11 13:55</div>
            <div class="timeline-body"><p>I&#x27;m not proposing that we should do this but it seems to me that RustRover scans the project for any <code>Cargo.toml</code> when it is first opened and then asks the users which projects they want to &quot;attach&quot;.</p>
<p>What I find interesting about this approach (not saying we should open a dialog) is that I believe this approach works for mono repositories (for as long as all projects use the same ty version) and multifolder workspaces. The main downside is that it requires an extra traversal to find all projects</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-07-01 03:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;Beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 12:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;GA&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 12:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-14 09:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;multi-root workspaces in server&quot; to &quot;LSP: Support Workspace folders&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-14 09:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-05 12:31</div>
            <div class="timeline-body"><p>This is probably a must have if we want to become the default type checker in any VS Code based editor</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;Stable&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-31 16:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Pre-stable 1&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-31 16:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/Gankra">@Gankra</a> by <a href="https://github.com/Gankra">@Gankra</a> on 2026-01-09 03:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:05 UTC
    </footer>
</body>
</html>
