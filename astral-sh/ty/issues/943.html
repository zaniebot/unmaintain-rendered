<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module level __getattr__ not respected - astral-sh/ty #943</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Module level __getattr__ not respected</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/943">#943</a>
        opened by <a href="https://github.com/pelme">@pelme</a>
        on 2025-08-05 19:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/pelme">@pelme</a> on 2025-08-05 19:37</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Defining a module level <code>__getattr__</code> is not picked up by ty: https://play.ty.dev/d17f33d6-87ec-4305-b390-9a15f9d88e7c</p>
<p>ty:</p>
<pre><code>❯ ty check --output-format=concise main.py
WARN ty is pre-release software and not ready for production use. Expect to encounter bugs, missing features, and fatal errors.
main.py:1:23: error[unresolved-import] Module `upper` has no member `whatever`
main.py:3:1: warning[undefined-reveal] `reveal_type` used without importing it
main.py:3:13: info[revealed-type] Revealed type: `str`
main.py:4:1: warning[undefined-reveal] `reveal_type` used without importing it
main.py:4:13: info[revealed-type] Revealed type: `Unknown`
Found 5 diagnostics
</code></pre>
<p>mypy and pyright supports this:</p>
<pre><code>❯ mypy main.py
main.py:3: note: Revealed type is &quot;builtins.str&quot;
main.py:4: note: Revealed type is &quot;builtins.str&quot;
Success: no issues found in 1 source file

❯ pyright main.py
/private/tmp/stuff.XZqSg2LO0/main.py
  /private/tmp/stuff.XZqSg2LO0/main.py:3:13 - information: Type of &quot;hi&quot; is &quot;str&quot;
  /private/tmp/stuff.XZqSg2LO0/main.py:4:13 - information: Type of &quot;whatever&quot; is &quot;str&quot;
0 errors, 0 warnings, 2 informations
</code></pre>
<h3>Version</h3>
<p>ty 0.0.1-alpha.16 (c452e53a0 2025-07-25)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">runtime semantics</span> added by @carljm on 2025-08-05 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "GA" by @carljm on 2025-08-05 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @carljm on 2025-08-05 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-06 06:28</div>
            <div class="timeline-body"><p>If someone wants to work on this, this is a good place to start:</p>
<p>https://github.com/astral-sh/ruff/blob/18ad2848e3bb88ef7140b2e51de36312aa5981ab/crates/ty_python_semantic/src/types.rs#L3285-L3353</p>
<p>This functionality should probably be factored out into a function or moved to the top of the containing function, such that it can be used in <a href="https://github.com/astral-sh/ruff/blob/18ad2848e3bb88ef7140b2e51de36312aa5981ab/crates/ty_python_semantic/src/types.rs#L3247">the <code>Type::ModuleLiteral</code> branch</a> as well.</p>
<p>Also note that there is a comment regarding a fake <code>__getattr__</code> on <code>types.ModuleType</code> which should probably not affect the functionality here, though... because <code>Type::NominalInstance(tyes.ModuleType)</code> is just the supertype of all module literals, not a module literal itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2025-08-08 17:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:21 UTC
    </footer>
</body>
</html>
