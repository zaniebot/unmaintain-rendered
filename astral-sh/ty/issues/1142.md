```yaml
number: 1142
title: "Return type of sum(tuple[Decimal, ...]) is not Decimal"
type: issue
state: closed
author: JoanPuig
labels:
  - generics
assignees: []
created_at: 2025-09-07T16:43:04Z
updated_at: 2026-01-09T02:44:46Z
url: https://github.com/astral-sh/ty/issues/1142
synced_at: 2026-01-10T01:56:40Z
```

# Return type of sum(tuple[Decimal, ...]) is not Decimal

---

_Issue opened by @JoanPuig on 2025-09-07 16:43_

### Summary

The following code:
```
from decimal import Decimal


def my_function(values: tuple[Decimal, ...]) -> Decimal:
    return sum(values)

```

Will generate the following rule violation:

```
error[invalid-return-type]: Return type does not match returned value
 --> src\main.py:4:49
  |
4 | def my_function(values: tuple[Decimal, ...]) -> Decimal:
  |                                                 ------- Expected `Decimal` because of return type
5 |     return sum(values)
  |            ^^^^^^^^^^^ expected `Decimal`, found `int`
  |
info: rule `invalid-return-type` is enabled by default

Found 1 diagnostic
```

### Version

ty 0.0.1-alpha.20 (f41f00af1 2025-09-03)

---

_Label `generics` added by @sharkdp on 2025-09-08 06:34_

---

_Comment by @sharkdp on 2025-09-08 06:37_

Thank you for reporting this.

This is related to #623. We currently do not handle (generic) protocols in generic functions correctly in the call to `sum`:

https://github.com/python/typeshed/blob/bf484ab320778d9ced0a986243282691aa7425cb/stdlib/builtins.pyi#L1922-L1931

---

_Comment by @carljm on 2026-01-09 02:44_

We still report an error on this snippet, but the error we now report is "expected `Decimal`, found `Decimal | Literal[0]`". And that error is correct. If this function is called with an empty tuple argument, the default value of the `start` parameter of `sum` (which is the integer `0`) will be returned.

---

_Closed by @carljm on 2026-01-09 02:44_

---
