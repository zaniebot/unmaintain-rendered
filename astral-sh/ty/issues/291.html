<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reimplement popular Mypy Plugins - astral-sh/ty #291</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Reimplement popular Mypy Plugins</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/291">#291</a>
        opened by <a href="https://github.com/johnthagen">@johnthagen</a>
        on 2025-05-09 11:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/johnthagen">@johnthagen</a></div>
            <div class="timeline-body"><blockquote>
<p>For <a href="https://github.com/astral-sh/ruff/issues/15828#issuecomment-2865283264">better discoverability of the decision</a>, cross post  to document reasons for</p>
<ul>
<li>https://github.com/astral-sh/ruff/issues/15828</li>
</ul>
</blockquote>
<h3>Description</h3>
<p>In order to migrate from Mypy to Ruff for static type checking, one thing users may need are reimplementations of the most popular Mypy plugins.</p>
<ul>
<li>https://mypy.readthedocs.io/en/stable/extending_mypy.html#extending-mypy-using-plugins</li>
</ul>
<p>Assuming for a moment that exposing a Mypy-compatible plugin interface is out of scope, the following Mypy plugins are ones I've seen in wide use within the community and could be considered:</p>
<ul>
<li>Some appear built into Mypy already: https://github.com/python/mypy/tree/master/mypy/plugins</li>
<li>(Deprecated) Numpy: https://numpy.org/devdocs/reference/typing.html#mypy-plugin</li>
<li>Pydantic: https://docs.pydantic.dev/latest/integrations/mypy/#enabling-the-plugin</li>
<li><code>django-stubs</code>: https://github.com/typeddjango/django-stubs?tab=readme-ov-file#installation</li>
<li><code>djangorestframework-stubs</code>: https://github.com/typeddjango/djangorestframework-stubs?tab=readme-ov-file#installation</li>
</ul>
<p>Another list of Mypy plugins I found:</p>
<ul>
<li>https://github.com/typeddjango/awesome-python-typing?tab=readme-ov-file#mypy-plugins</li>
</ul>
<p>Related to</p>
<ul>
<li>https://github.com/astral-sh/ruff/issues/3893</li>
</ul>
<h3>References</h3>
<ul>
<li>https://news.ycombinator.com/item?id=43919746</li>
<li>https://www.youtube.com/live/XVwpL_cAvrw?feature=shared&amp;t=2528</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-05-09 15:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/max-muoto">@max-muoto</a> on 2025-05-09 16:22</div>
            <div class="timeline-body"><p>Implementation of a Pydantic plugin probably shouldn't be necessary post dataclass transforms - effectively every single behavior is natively supported in the typing system at this point: https://peps.python.org/pep-0681/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/max-muoto">@max-muoto</a> on 2025-05-09 16:28</div>
            <div class="timeline-body"><p>I think this also begs a more philosophical question around the direction of Ty. Some type-checkers such as Pyright have avoided implementing plugin support to instead push for extending the native type-system: https://github.com/microsoft/pyright/issues/637#issuecomment-632759717</p>
<p>This in turn led to the aforementioned dataclass transforms. I'm certainly sympathetic to lack of robust type-checking for Django for non-MyPy type-checkers but https://github.com/sbdchd/django-types does a good job of typing Django without the need for any custom extensions from my experience.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-05-09 16:37</div>
            <div class="timeline-body"><p>We also prefer a well-specified inter-operable type system over plugins. We currently have no plans to build a plugin system for <code>ty</code>. Implementing special-cased support for some widely-used library is more plausible, but also not on the current roadmap, and something we would prefer to avoid in favor of adding a general means to the type system to support the needed pattern(s).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/w0rp">@w0rp</a> on 2025-05-10 03:43</div>
            <div class="timeline-body"><p>I will add in that based on my professional on the job experience with Django for 11 years I have viewed typing Django as pretty much a lost cause. Django dev teams typically aren't interested in adopting type checking. I had previously success re-tooling Django classes to add in type information that gave better results than the mypy Django plugins.</p>
<p>In my opinion: Django was built a long time ago long before PEP 484, and it will take significant efforts from the Django team to make breaking changes to Django to make it easier to produce accurate types for QuerySet classes, Manager classes, and that's even without a refactoring I think is needed for better asyncio support and avoiding the N+1 query problem.</p>
<p>I'd probably say: avoid adopting a plugin architecture for some time to come and focus on achieving feature parity with pyright.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lexicalunit">@lexicalunit</a> on 2025-05-19 17:17</div>
            <div class="timeline-body"><p>+1 to feature party with pyright and to not adding plugins. Getting the most basic things working with https://github.com/sbdchd/django-types (django-stubs but with the mypy plugin stripped out) would be ideal.</p>
<p>Right now I get issues with code as simple as:</p>
<pre><code class="language-python">from django.db import models

class Foo(models.Model):
    id: int  # even with explicitly added annotations it still doesn't work
    name = models.TextField()

def bar():
    f = Foo.objects.create()
    print(f.id)
    print(f.name)
</code></pre>
<pre><code class="language-log">error[unresolved-attribute]: Type `Self` has no attribute `id`
  --&gt; my/test/file:9:11
   |
25 | def bar():
26 |     f = Foo.objects.create()
27 |     print(f.id)
   |           ^^^^
28 |     print(f.name)
   |
info: rule `unresolved-attribute` is enabled by default

error[unresolved-attribute]: Type `Self` has no attribute `name`
  --&gt; my/test/file:10:11
   |
26 |     f = Foo.objects.create()
27 |     print(f.id)
28 |     print(f.name)
   |           ^^^^^^
   |
info: rule `unresolved-attribute` is enabled by default
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jellis18">@jellis18</a> on 2025-06-18 14:22</div>
            <div class="timeline-body"><p>So it appears that django-types is incompatible with <code>ty</code> at the moment? Has anyone found a way to get it to work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/w0rp">@w0rp</a> on 2025-06-18 15:33</div>
            <div class="timeline-body"><blockquote>
<p>So it appears that django-types is incompatible with <code>ty</code> at the moment? Has anyone found a way to get it to work?</p>
</blockquote>
<p>See my comment above. In my experience re-implementing classes in Django with explicit declarations and <code># type: ignore</code> re-declarations of fields in Model classes works better. In combination with <a href="https://github.com/sbdchd/django-types">django-types</a> it's the best you will ever do. The same is true for Pyright, which backs Pylance.</p>
<p>Django is sorely in need of a new major version with first-class type support via a dataclass re-implementation of Django models and <code>async def</code> methods for <code>QuerySet</code> classes with a removal of the magic addition of QuerySet methods to <code>Manager</code> classes. (Would it really kill people to write <code>Foo.objects.all().bar()</code> instead of <code>Foo.objects.bar()</code>?)</p>
<p>I use FastAPI for all new APIs instead of Django and DRF. I recognise the ongoing need to maintain Django code, plus Django's ease-of-use for implementing interactive blog and news sites, forums, admin panels, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matmair">@matmair</a> on 2025-06-22 09:36</div>
            <div class="timeline-body"><p>No Django support will hold this back in a mayor part of the python ecosystem. You need to disable some pretty basic rules to use ty with Django right now. This is one of the few areas where Mypy still has the edge.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AdityaMayukhSom">@AdityaMayukhSom</a> on 2025-11-10 21:59</div>
            <div class="timeline-body"><blockquote>
<p>Implementation of a Pydantic plugin probably shouldn't be necessary post dataclass transforms - effectively every single behavior is natively supported in the typing system at this point: https://peps.python.org/pep-0681/</p>
</blockquote>
<p>Any thoughts on how to enable it to understand the kwargs for initialization on BaseModel implementations?</p>
<p><img width="542" height="190" alt="Image" src="https://github.com/user-attachments/assets/e2b40f8b-c8db-4d1d-bf35-8c25ad0cee68" /></p>
<p>Keeps on throwing <code>Argument </code>description<code> does not match any known parameterty[unknown-argument](https://ty.dev/rules#unknown-argument)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-11-10 22:08</div>
            <div class="timeline-body"><p>@AdityaMayukhSom Might be https://github.com/astral-sh/ty/issues/1425 -- are those fields on <code>Group</code> not type-annotated, by any chance?</p>
<p>If it's not that, you'd probably need to open a dedicated issue and show more of your code for a full repro.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AdityaMayukhSom">@AdityaMayukhSom</a> on 2025-11-10 23:15</div>
            <div class="timeline-body"><blockquote>
<p><a href="https://github.com/AdityaMayukhSom">@AdityaMayukhSom</a> Might be <a href="https://github.com/astral-sh/ty/issues/1425">#1425</a> -- are those fields on <code>Group</code> not type-annotated, by any chance?</p>
<p>If it's not that, you'd probably need to open a dedicated issue and show more of your code for a full repro.</p>
</blockquote>
<p><img width="923" height="365" alt="Image" src="https://github.com/user-attachments/assets/85edfecf-e5c9-48b8-bc8c-ca37f782bdab" /></p>
<p><img width="1092" height="605" alt="Image" src="https://github.com/user-attachments/assets/c7e6369f-235f-4a68-849e-f615040c1da6" /></p>
<p>All are type annotated. @carljm
P.S.: <code>TypeId</code> is alias for <code>uuid.UUID</code>, defined as <code>TypeId = uuid.UUID</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-11-10 23:33</div>
            <div class="timeline-body"><p>@AdityaMayukhSom Can you create a new issue (not a comment on this issue)? Thank you! If you are able to minimize the problem to the smallest example where it still reproduces (and show full code for that example, including all base classes) that would be super helpful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-11-14 14:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2026-01-08 18:25</div>
            <div class="timeline-body"><p>This issue is too broad -- we definitely don't intend to add built-in support for <em>all</em> mypy plugins. Closing in favor of #1018 , #2404 , #2403</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2026-01-08 18:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:19:48 UTC
    </footer>
</body>
</html>
