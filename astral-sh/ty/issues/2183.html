<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checking large Enum takes very long time - astral-sh/ty #2183</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Checking large Enum takes very long time</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2183">#2183</a>
        opened by <a href="https://github.com/ido123net">@ido123net</a>
        on 2025-12-23 10:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ido123net">@ido123net</a></div>
            <div class="timeline-body">Summary
<p>When trying to check code containing large Enum inside can cause <code>ty</code> to run very slow.</p>
<p>steps to reproduce:</p>
<pre><code>from enum import Enum, auto


class SomeEnum(Enum):
    A1 = auto()
    A2 = auto()
    A3 = auto()
    A4 = auto()
    A5 = auto()
    A6 = auto()
    A7 = auto()
    A8 = auto()
    A9 = auto()
    A10 = auto()

    B1 = auto()
    B2 = auto()
    B3 = auto()
    B4 = auto()
    B5 = auto()
    B6 = auto()
    B7 = auto()
    B8 = auto()
    B9 = auto()
    B10 = auto()

    C1 = auto()
    C2 = auto()
    C3 = auto()
    C4 = auto()
    C5 = auto()
    C6 = auto()
    C7 = auto()
    C8 = auto()
    C9 = auto()
    C10 = auto()

    D1 = auto()
    D2 = auto()
    D3 = auto()
    D4 = auto()
    D5 = auto()
    D6 = auto()
    D7 = auto()
    D8 = auto()
    D9 = auto()
    D10 = auto()

    E1 = auto()
    E2 = auto()
    E3 = auto()
    E4 = auto()
    E5 = auto()
    E6 = auto()
    E7 = auto()
    E8 = auto()
    E9 = auto()
    E10 = auto()

    F1 = auto()
    F2 = auto()
    F3 = auto()
    F4 = auto()
    F5 = auto()
    F6 = auto()
    F7 = auto()
    F8 = auto()
    F9 = auto()
    F10 = auto()


def get_default_mi_attrs(some_enum: SomeEnum):
    if some_enum in (SomeEnum.A1, SomeEnum.A2, SomeEnum.A3):
        return &quot;A&quot;
    elif some_enum in (SomeEnum.B6,):
        return &quot;B&quot;
    elif some_enum in (SomeEnum.C1, SomeEnum.C2, SomeEnum.C3):
        return &quot;C&quot;
    elif some_enum in (SomeEnum.D4, SomeEnum.D5):
        return &quot;D&quot;
    elif some_enum in (SomeEnum.E9,):
        return &quot;E&quot;
    # uncommenting this part will cause ty to run slower in order of magnitude
    # elif some_enum in (SomeEnum.F1,):
    #     return &quot;F&quot;
</code></pre>
<pre><code>$ ty check -v tmp/midb.py 
INFO Defaulting to python-platform `linux`
INFO Python version: Python 3.9, platform: linux
INFO Indexed 1 file(s) in 0.003s
INFO Could not find class `enum.StrEnum` in typeshed on Python 3.9. Falling back to `Unknown` for the symbol instead.
INFO Checking file `/path/to/test.py` took more than 100ms (4.180301732s)
All checks passed!

# uncommenting the above
$ ty check -v tmp/midb.py 
INFO Defaulting to python-platform `linux`
INFO Python version: Python 3.9, platform: linux
INFO Indexed 1 file(s) in 0.003s
INFO Could not find class `enum.StrEnum` in typeshed on Python 3.9. Falling back to `Unknown` for the symbol instead.
INFO Checking file `/path/to/test.py` took more than 100ms (243.977428347s)
All checks passed!
</code></pre>
Version
<p>ty 0.0.5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">performance</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-23 10:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enums</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-23 10:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Parsing large Enum takes very long time&quot; to &quot;Checking large Enum takes very long time&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-23 10:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-23 10:38</div>
            <div class="timeline-body"><p>Thank you. I suspect that this is the same as <a href="https://github.com/astral-sh/ty/issues/1588">astral-sh/ty#1588</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-12-23 10:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ido123net">@ido123net</a> on 2025-12-23 11:40</div>
            <div class="timeline-body"><p>@MichaReiser thx, you are right, I searched for the <code>StrEnum</code> in the open issues (my bad).</p>
<p>In any case, I think my reproduction is simpler :wink:</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:43 UTC
    </footer>
</body>
</html>
