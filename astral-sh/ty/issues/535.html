<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-import action - astral-sh/ty #535</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Auto-import action</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/535">#535</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-05-28 11:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><p>Provide an action to automatically import a symbol if it isn&#x27;t defined in the current module but exported by another module.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;GA&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-28 11:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-28 11:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-05-29 17:14</div>
            <div class="timeline-body"><p>@MichaReiser Can you give an example of this? In particular, the way I&#x27;m interpreting this seems to imply that completions should be offering suggestions that <em>aren&#x27;t</em> yet imported.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-29 17:24</div>
            <div class="timeline-body"><p>Thinking more about it, maybe that&#x27;s more a refactor than something that should be part of completions (because that could be noisy).</p>
<p>The idea was that if you write <code>TypeInferenc</code> that it would auto complete <code>TypeInference</code> and automatically add the necessary import.</p>
<p>I think a better start would be to provide a: Add import code action for when we see an unknown symbol which is exported by another module. E.g, you have <code>TypeInference</code> but it isn&#x27;t imported. ty should then show an action to import it. I&#x27;ll change the issue</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Auto-import completion&quot; to &quot;Auto-import action&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-29 17:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-05-29 17:26</div>
            <div class="timeline-body"><p>Yeah I think that&#x27;s probably a better starting point.</p>
<p>Do we already have a reverse index somewhere that maps names to modules available to import in the current environment?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-05-29 17:27</div>
            <div class="timeline-body"><p>This seems somewhat related to a &quot;find references to this symbol&quot; feature. Although they aren&#x27;t quite the same.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-29 17:33</div>
            <div class="timeline-body"><blockquote>
<p>Do we already have a reverse index somewhere that maps names to modules available to import in the current environment?</p>
</blockquote>
<p>Not yet, no. We also don&#x27;t have an index of all modules</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-05-30 08:54</div>
            <div class="timeline-body"><blockquote>
<p>I think a better start would be to provide a: Add import code action for when we see an unknown symbol which is exported by another module. E.g, you have <code>TypeInference</code> but it isn&#x27;t imported. ty should then show an action to import it. I&#x27;ll change the issue</p>
</blockquote>
<p>Agreed. Code action seems like a good start for this. Another thing is that I think it should just be a quickfix code action and not source level code action i.e., it should be specific to a single unknown symbol and not for all unknown symbols in the file.</p>
<p>If we want to break it down even further, we could limit the initial implementation to just have modules and not include any symbols within those modules. For example, <code>sys</code> could provide a code action to auto-import <code>import sys</code> but <code>version_in|</code> (using <code>from sys import version_info</code>) would not work for now. Or, this could be the next step in this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ibrokemypie">@ibrokemypie</a> on 2025-06-06 00:45</div>
            <div class="timeline-body"><p>Chiming in to say that auto-import as an auto-completion item like in other LSPs (pyright, ts_ls) is a very important feature to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-09 07:19</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ty/issues/614 might be a good first step</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone &quot;GA&quot; by <a href="https://github.com/carljm">@carljm</a> on 2025-06-11 00:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Beta&quot; by <a href="https://github.com/carljm">@carljm</a> on 2025-06-11 00:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seamuswn">@seamuswn</a> on 2025-07-23 11:17</div>
            <div class="timeline-body"><p>Most LSPs I&#x27;ve seen that provide this provide both a code completion and a code actions implementation, with the option to enable/disable each one independently of the other. Pycharm docs have a <a href="https://www.jetbrains.com/help/pycharm/creating-and-optimizing-imports.html#import-packages">pretty good example</a> of how code actions could work under &#x27;Creating imports on the flyï»¿&#x27;. Only callout is the support for adding imports either &#x27;locally&#x27; (import is added at the same indentation on the line just above the statement) or at the module level.</p>
<p>The standard configurations options I see for LSPs that support this are:</p>
<ol>
<li>Import syntax configuration (choosing between <code>import sys.version_info</code> and <code>from sys import version</code> statements being generated). Avoids having to pop up / suggest both syntax types in the context menus, since most projects will favor one or the other).</li>
<li>Configurable aliasing (e.g. providing a configuration value of <code>&quot;alias&quot;: {&quot;numpy&quot;: &quot;np&quot;}</code> and having that generate <code>import numpy as np</code> instead of <code>import numpy</code>) - more of a &#x27;nice to have&#x27;.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/BurntSushi">@BurntSushi</a> by <a href="https://github.com/carljm">@carljm</a> on 2025-08-15 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sirfz">@sirfz</a> on 2025-10-10 17:43</div>
            <div class="timeline-body"><p>For reference, when using basedpyright in neovim, this is the behavior:</p>
<ul>
<li>For example I input <code>dict[str, Any</code></li>
<li><code>Any</code> isn&#x27;t currently imported in my file but the autocomplete suggestions would display it and selecting it would automatically add <code>from typing import Any</code>.</li>
</ul>
<p>However, it does not offer code actions for it which would be a great addition.</p>
<p>Sometimes it would offer the same import from different modules which can be tricky for ranking but usually std lib import should prevail.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-10-10 17:51</div>
            <div class="timeline-body"><p>@sirfz The ranking is a work in progress, but <code>dict[str, Any&lt;CURSOR&gt;</code> should work today:</p>
<p>https://github.com/user-attachments/assets/369cb82f-8677-4067-baf4-713aa7ce5d12</p>
<p>Note that you do need to <a href="https://github.com/astral-sh/ty/blob/2f3190d0961d1067a097bfb2c00c3952311055c1/docs/reference/editor-settings.md#autoimport">explicitly opt into <code>autoImport</code></a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sirfz">@sirfz</a> on 2025-10-10 17:55</div>
            <div class="timeline-body"><p>@BurntSushi I just opted in and got it working, that&#x27;s wonderful thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-14 09:31</div>
            <div class="timeline-body"><p>I&#x27;m leaning towards closing this issue and tracking the auto import improvements in smaller tasks. I&#x27;ll create a new issue for a: Add import code action. But I&#x27;ll leave this decision up to you @BurntSushi</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-14 12:57</div>
            <div class="timeline-body"><p>Aye, I&#x27;ve opened an issue specifically for an &quot;add missing import&quot; action: <a href="https://github.com/astral-sh/ty/issues/1552">astral-sh/ty#1552</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-14 12:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:41 UTC
    </footer>
</body>
</html>
