<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Explicitly including a protocol as a base class doesn't verify class implementation is actually compatible - astral-sh/ty #2157</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Explicitly including a protocol as a base class doesn&#x27;t verify class implementation is actually compatible</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2157">#2157</a>
        opened by <a href="https://github.com/Ragzouken">@Ragzouken</a>
        on 2025-12-22 13:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Ragzouken">@Ragzouken</a></div>
            <div class="timeline-body">Summary
<p>Looking at the documentation / faq / existing issues I can&#x27;t see this reported/explained anywhere else, but I may not have looked for the right thing.</p>
<p>This <a href="https://typing.python.org/en/latest/reference/protocols.html#defining-subprotocols-and-subclassing-protocols">example from the python typing documentation</a> doesn&#x27;t seem to work as expected:</p>
<pre><code>from typing import Protocol

class SomeProto(Protocol):
    attr: int  # Note, no right hand side
    # If the body is literally just &quot;...&quot;, explicit subclasses will
    # be treated as abstract classes if they don&#x27;t implement the method.
    def method(self) -&gt; str: ...

class ExplicitSubclass(SomeProto):
    pass

ExplicitSubclass()  # error: Cannot instantiate abstract class &#x27;ExplicitSubclass&#x27;
                    # with abstract attributes &#x27;attr&#x27; and &#x27;method&#x27;
</code></pre>
<p>mypy gives an error as expected:</p>
<pre><code>&gt; mypy .\test.py    
test.py:16: error: Cannot instantiate abstract class &quot;ExplicitSubclass&quot; with abstract attributes &quot;attr&quot; and &quot;method&quot;  [abstract]
Found 1 error in 1 file (checked 1 source file)
</code></pre>
<p>ty gives no error, which is not correct (<code>ExplicitSubclass().method()</code> will return <code>None</code> which is not of type <code>str</code>):</p>
<pre><code>&gt; ty check .\test.py
All checks passed!
</code></pre>
Version
<p>ty 0.0.5 (d37b7dbd9 2025-12-20)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-22 14:02</div>
            <div class="timeline-body"><p>Thank you! I agree we don&#x27;t have an issue specifically open for this right now, but this is basically the same as <a href="https://github.com/astral-sh/ty/issues/1877">astral-sh/ty#1877</a>, so I&#x27;ll close this in favour of that one and add a comment saying that we also need to treat <code>Protocol</code> methods as implicitly abstract üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-22 14:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:42 UTC
    </footer>
</body>
</html>
