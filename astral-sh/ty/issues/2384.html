<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support installation on CI (GitHub Actions) - astral-sh/ty #2384</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support installation on CI (GitHub Actions)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/2384">#2384</a>
        opened by <a href="https://github.com/amotl">@amotl</a>
        on 2026-01-07 22:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/amotl">@amotl</a></div>
            <div class="timeline-body"><p>Hi. First things first: Thanks a stack for conceiving <code>ty</code>, and a happy new year!</p>
<p>We&#x27;d like to invoke <code>ty</code> in a traditional CI/GHA environment where we are not using <code>uv</code> yet. As such, the package and its dependencies are installed into the global system environment, because it&#x27;s ephemeral anyway. Currently, <code>ty</code> doesn&#x27;t find third-party modules, and we don&#x27;t know how to configure it properly, because we don&#x27;t know upfront where GHA (<code>actions/setup-python</code>) locates its Python environment.</p>
<ul>
<li>https://github.com/crate/pytest-cratedb/actions/runs/20797404169/job/59734360168</li>
</ul>
<p>Maybe you know a good trick how to make <code>ty</code> work in this environment? We tried to configure <a href="https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#environment-variables"><code>env.pythonLocation</code></a>, but it didn&#x27;t work.</p>
<pre><code>env:
  VIRTUAL_ENV: ${{ env.pythonLocation }}
</code></pre>
<pre><code>ty failed
  Cause: Failed to discover local Python environment
  Cause: Invalid `VIRTUAL_ENV` environment variable `/opt/hostedtoolcache/Python/3.14.2/x64`: points to a broken venv with no pyvenv.cfg file
</code></pre>
References
<ul>
<li>GH-2068</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2026-01-07 22:36</div>
            <div class="timeline-body"><p>Thanks for the report! I think this is basically a duplicate of #2068, since that&#x27;s how ty should support this case. But I&#x27;ll leave it open as a question, to help others maybe find it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/carljm">@carljm</a> on 2026-01-07 22:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Support installation on CI/GHA&quot; to &quot;Support installation on CI (GitHub Actions)&quot; by <a href="https://github.com/amotl">@amotl</a> on 2026-01-07 22:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/amotl">@amotl</a> on 2026-01-07 22:48</div>
            <div class="timeline-body"><p>Thank you Carl, you are right. I first posted this message at <a href="https://github.com/astral-sh/ty/issues/2068">astral-sh/ty#2068</a>#issuecomment-3720992492, but then decided to use a separate issue, because others might know some tricks how to configure <code>ty</code> properly on GHA without modifying it, and without using a virtualenv.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:27:00 UTC
    </footer>
</body>
</html>
