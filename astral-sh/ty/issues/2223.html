<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inconsistent type inference for time.perf_counter(): Inferred as int | float instead of float - astral-sh/ty #2223</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Inconsistent type inference for time.perf_counter(): Inferred as int | float instead of float</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2223">#2223</a>
        opened by <a href="https://github.com/Blinkion">@Blinkion</a>
        on 2025-12-26 02:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Blinkion">@Blinkion</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Summary
While testing ty, I noticed that the Inlay Hint for time.perf_counter() shows the type as int | float. However, the underlying typeshed stub (time.pyi) bundled with ty explicitly defines the return type as float. Additionally, per PEP 484's &quot;numeric tower&quot; convention, int is a subtype of float, making the int | float union redundant even if an integer were possible.</p>
<p>Environment
ty version: 0.0.7 (cf82a04b5 2025-12-24)</p>
<p>OS: macOS (as seen in screenshots)</p>
<p>Reproduction
Create a Python script:</p>
<p>Python</p>
<p>import time
start = time.perf_counter()
Observe the Inlay Hint for the start variable.</p>
<p>Actual Behavior
The inferred type is displayed as int | float.</p>
<p>Expected Behavior
The inferred type should be float, strictly matching the typeshed definition: def perf_counter() -&gt; float: ...</p>
<p>Additional Context
I've verified the vendored typeshed file within ty's cache (.cache/ty/vendored/typeshed/.../time.pyi) defines the return type as float.</p>
<p>In the context of static analysis, float should be sufficient as it encompasses int.</p>
<p><img width="576" height="212" alt="Image" src="https://github.com/user-attachments/assets/2c5600e5-9390-4e70-822d-15e2b04f5d24" />
<img width="827" height="203" alt="Image" src="https://github.com/user-attachments/assets/14c04426-d28f-4b23-aa85-eff0aba3fe96" /></p>
<h3>Version</h3>
<p>0.0.7 (cf82a04b5 2025-12-24)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wizzerinus">@Wizzerinus</a> on 2025-12-26 08:09</div>
            <div class="timeline-body"><p>I believe ty explicitly chose to use int | float for definitions because int isn't actually liskov-compatible with float. See here: https://docs.astral.sh/ty/reference/typing-faq/#why-does-ty-show-int-float-when-i-annotate-something-as-float</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Blinkion">@Blinkion</a> on 2025-12-26 08:09</div>
            <div class="timeline-body"><p>这是来自QQ邮箱的假期自动回复邮件。您好，我已经收到您的邮件。我将在阅读后，尽快给您回复。</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2025-12-26 08:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2025-12-26 17:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:21:34 UTC
    </footer>
</body>
</html>
