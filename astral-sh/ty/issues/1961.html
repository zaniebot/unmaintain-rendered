<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ty does not narrow types after NoReturn calls - astral-sh/ty #1961</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ty does not narrow types after NoReturn calls</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1961">#1961</a>
        opened by <a href="https://github.com/seangies">@seangies</a>
        on 2025-12-16 22:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/seangies">@seangies</a> on 2025-12-16 22:21</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><code>ty</code> does not handle type-narrowing after calls to <code>NoReturn</code> functions like <code>sys.exit()</code>:</p>
<pre><code>‚ùØ uvx ty check /tmp/ty-noreturn-bug.py
warning[possibly-missing-attribute]: Attribute `get` may be missing on object of type `dict[Unknown, Unknown] | None`
  --&gt; /tmp/ty-noreturn-bug.py:21:13
   |
19 |     # ty warns here: &quot;Attribute `get` may be missing on object of type `dict | None`&quot;
20 |     # even though sys.exit(1) above means result cannot be None here
21 |     value = result.get(&quot;key&quot;)
   |             ^^^^^^^^^^
22 |     print(value)
   |
info: rule `possibly-missing-attribute` is enabled by default

Found 1 diagnostic
</code></pre>
<p><a href="https://github.com/user-attachments/files/24200812/ty-noreturn-bug.py">ty-noreturn-bug.py</a></p>
<h3>Version</h3>
<p>ty 0.0.2 (42835578d 2025-12-16)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-16 22:25</div>
            <div class="timeline-body"><p>Thanks for the report! This is a known issue, tracked at #690, and a top priority to fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2025-12-16 22:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:54:35 UTC
    </footer>
</body>
</html>
