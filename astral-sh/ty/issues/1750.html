<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`tuple[Any, ...]` not assignable to `tuple[int, *tuple[int, ...]]` - astral-sh/ty #1750</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>tuple[Any, ...]</code> not assignable to <code>tuple[int, *tuple[int, ...]]</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1750">#1750</a>
        opened by <a href="https://github.com/jorenham">@jorenham</a>
        on 2025-12-03 21:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jorenham">@jorenham</a> on 2025-12-03 21:46</div>
            <div class="timeline-body"><h3>Summary</h3>
<pre><code class="language-py">from typing import Any

def f(shape: tuple[int, *tuple[int, ...]], /): ...

any_shape: tuple[Any, ...]
f(any_shape)  # ‚ùå
</code></pre>
<pre><code>Argument to function `f` is incorrect: Expected `tuple[int, *tuple[int, ...]]`, found `tuple[Any, ...]` (invalid-argument-type)
</code></pre>
<p>https://play.ty.dev/87952f02-8ba2-4d51-beb5-2e5920486b1e</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @carljm on 2025-12-03 21:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">typing semantics</span> added by @carljm on 2025-12-03 21:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-12-03 21:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-03 21:52</div>
            <div class="timeline-body"><p>Hmm yes, we should consider this to be assignable due to the exception the spec carves out:</p>
<blockquote>
<p>The type <code>tuple[Any, ...]</code> is special in that it is <a href="https://typing.python.org/en/latest/spec/glossary.html#term-consistent">consistent</a> with all tuple types, and <a href="https://typing.python.org/en/latest/spec/glossary.html#term-assignable">assignable</a> to a tuple of any length. This is useful for gradual typing. The type <code>tuple</code> (with no type arguments provided) is equivalent to <code>tuple[Any, ...]</code>.</p>
</blockquote>
<p>https://typing.python.org/en/latest/spec/tuples.html#tuple-type-form</p>
<p>(In general, <code>tuple[T,...]</code> is not assignable to <code>tuple[T, *tuple[T, ...]]</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jorenham">@jorenham</a> on 2025-12-03 21:54</div>
            <div class="timeline-body"><p>Yes exactly. The use-case is for annotating numpy arrays with unknown shape, i.e. as gradual shape-type.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-12-05 03:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-12-05 19:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:41:19 UTC
    </footer>
</body>
</html>
