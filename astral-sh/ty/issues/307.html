<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>can't infer `pydantic.dataclasses.dataclass` - astral-sh/ty #307</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>can&#x27;t infer <code>pydantic.dataclasses.dataclass</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/307">#307</a>
        opened by <a href="https://github.com/trim21">@trim21</a>
        on 2025-05-10 12:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/trim21">@trim21</a></div>
            <div class="timeline-body">Summary
<p>There are third party data classes use <code>@dataclass_transform</code> decoder on their <code>dataclass</code> decoder, for example, <code>pydantic.dataclasses.dataclass</code>, which is not support by ty.</p>
<pre><code>    @dataclass_transform(field_specifiers=(dataclasses.field, Field, PrivateAttr))
    @overload
    def dataclass(
...
</code></pre>
<p>ty won&#x27;t add add a <code>__init__</code> for this:</p>
<pre><code>from pydantic import dataclasses


@dataclasses.dataclass()
class Config:
    name: str
    age: int


Config(name=&quot;hello&quot;, age=18)

</code></pre>
<pre><code>error[unknown-argument]: Argument `name` does not match any known parameter of bound method `__init__`
  --&gt; e.py:10:8
   |
10 | Config(name=&quot;hello&quot;, age=18)
   |        ^^^^^^^^^^^^
   |
info: `unknown-argument` is enabled by default

error[unknown-argument]: Argument `age` does not match any known parameter of bound method `__init__`
  --&gt; e.py:10:22
   |
10 | Config(name=&quot;hello&quot;, age=18)
   |                      ^^^^^^
   |
info: `unknown-argument` is enabled by default
</code></pre>
Version
<p>ty 0.0.0-alpha.8 (0474b40e1 2025-05-09)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;missing support for `typing_extensions.dataclass_transform`&quot; to &quot;missing support for `typing.dataclass_transform`&quot; by <a href="https://github.com/trim21">@trim21</a> on 2025-05-10 12:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">dataclasses</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-10 17:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/abhijeetbodas2001">@abhijeetbodas2001</a> on 2025-05-11 07:11</div>
            <div class="timeline-body"><p>I beleive this is something that should&#x27;ve been handled as part of <a href="https://github.com/astral-sh/ruff/pull/17835">astral-sh/ruff#17835</a>. Let me try to investigate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2025-05-11 08:12</div>
            <div class="timeline-body"><p>emmm, sorry . I find that pydantic is actually using <code>typing_extensions.dataclass_transform</code>.</p>
<p>If <code>typing.dataclass_transform</code> works then I file this issue with wrong topic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;missing support for `typing.dataclass_transform`&quot; to &quot;missing support for `typing_extensions.dataclass_transform.dataclass_transform`&quot; by <a href="https://github.com/trim21">@trim21</a> on 2025-05-11 08:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;missing support for `typing_extensions.dataclass_transform.dataclass_transform`&quot; to &quot;missing support for `typing_extensions.dataclass_transform`&quot; by <a href="https://github.com/trim21">@trim21</a> on 2025-05-11 08:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-05-11 08:50</div>
            <div class="timeline-body"><p>Thank you for reporting this. This is not related to missing <code>dataclass_transform</code> support, it&#x27;s actually related to a bug (#261), which will be fixed by <a href="https://github.com/astral-sh/ruff/pull/18005">astral-sh/ruff#18005</a>. We currently infer <code>Never</code> for <code>pydantic.dataclasses.dataclass</code>:</p>
<pre><code>from pydantic import dataclasses

reveal_type(dataclasses.dataclass)  # Never
</code></pre>
<p>When checking the example from the original post above using the version from <a href="https://github.com/astral-sh/ruff/pull/18005">astral-sh/ruff#18005</a>, everything works as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trim21">@trim21</a> on 2025-05-11 08:53</div>
            <div class="timeline-body"><p>thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">imports</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-11 09:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;missing support for `typing_extensions.dataclass_transform`&quot; to &quot;can&#x27;t infer `pydantic.dataclasses.dataclass`&quot; by <a href="https://github.com/trim21">@trim21</a> on 2025-05-11 09:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-05-13 14:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-05-13 14:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:25 UTC
    </footer>
</body>
</html>
