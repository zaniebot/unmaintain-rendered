<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support dynamic import library such as gstreamer python binding - astral-sh/ty #1764</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support dynamic import library such as gstreamer python binding</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1764">#1764</a>
        opened by <a href="https://github.com/hermeschen1116">@hermeschen1116</a>
        on 2025-12-05 06:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/hermeschen1116">@hermeschen1116</a></div>
            <div class="timeline-body">Summary
<p>My project using gstreamer python binding under pygobject. And it uses dynamic import and ty always throws out unresolve-import.</p>
<p>I import the gstreamer lib as below, ty can only resolve gi.</p>
<pre><code>from __future__ import annotations


import gi


gi.require_version(&quot;Gst&quot;, &quot;1.0&quot;)
from gi.repository import Gst  


Gst.init(None)
</code></pre>
<p>And the diagnostics</p>
<pre><code>INFO Defaulting to python-platform `darwin`
INFO Python version: Python 3.12, platform: darwin
INFO Indexed 1 file(s) in 0.004s
error[unresolved-import]: Module `gi.repository` has no member `Gst`
  --&gt; src/stream_server/internal/stream/_GStreamer.py:15:27
   |
14 | gi.require_version(&quot;Gst&quot;, &quot;1.0&quot;)
15 | from gi.repository import Gst
   |                           ^^^
   |
info: rule `unresolved-import` is enabled by default

Found 1 diagnostic
</code></pre>
<p>More specific</p>
<pre><code>2025-12-05 14:41:50.24026 DEBUG Version: 0.0.1-alpha.31 (51c73d687 2025-12-04)
2025-12-05 14:41:50.246054 DEBUG Architecture: aarch64, OS: macos, case-sensitive: case-insensitive
2025-12-05 14:41:50.246275 DEBUG Searching for a project in &#x27;/Users/hermeschen/Repo/work/stream-server&#x27;
2025-12-05 14:41:50.248244 DEBUG Resolving requires-python constraint: `&gt;=3.12`
2025-12-05 14:41:50.248307 DEBUG Resolved requires-python constraint to: 3.12
2025-12-05 14:41:50.248328 DEBUG Project without `tool.ty` section: &#x27;/Users/hermeschen/Repo/work/stream-server&#x27;
2025-12-05 14:41:50.248345 DEBUG Searching for a user-level configuration at `/Users/hermeschen/.config/ty/ty.toml`
2025-12-05 14:41:50.252741 INFO Defaulting to python-platform `darwin`
2025-12-05 14:41:50.252925 DEBUG Resolving `VIRTUAL_ENV` environment variable: /Users/hermeschen/Repo/work/stream-server/.venv
2025-12-05 14:41:50.252973 DEBUG Attempting to parse virtual environment metadata at &#x27;/Users/hermeschen/Repo/work/stream-server/.venv/pyvenv.cfg&#x27;
2025-12-05 14:41:50.253426 DEBUG Searching for site-packages directory in sys.prefix /Users/hermeschen/Repo/work/stream-server/.venv
2025-12-05 14:41:50.253803 DEBUG Resolved site-packages directories for this virtual environment are: [&quot;/Users/hermeschen/Repo/work/stream-server/.venv/lib/python3.12/site-packages&quot;]
2025-12-05 14:41:50.254202 DEBUG Searching for real stdlib directory in sys.prefix /Users/hermeschen/.local/share/uv/python/cpython-3.12.12-macos-aarch64-none
2025-12-05 14:41:50.254209 DEBUG Resolved real stdlib path for this virtual environment is: /Users/hermeschen/.local/share/uv/python/cpython-3.12.12-macos-aarch64-none/lib/python3.12
2025-12-05 14:41:50.254214 DEBUG Including `.` and `./src` in `environment.root` because a `./src` directory exists
2025-12-05 14:41:50.254424 DEBUG Adding first-party search path `/Users/hermeschen/Repo/work/stream-server/src`
2025-12-05 14:41:50.254428 DEBUG Adding first-party search path `/Users/hermeschen/Repo/work/stream-server`
2025-12-05 14:41:50.254432 DEBUG Using vendored stdlib
2025-12-05 14:41:50.25609 DEBUG Adding site-packages search path `/Users/hermeschen/Repo/work/stream-server/.venv/lib/python3.12/site-packages`
2025-12-05 14:41:50.256109 INFO Python version: Python 3.12, platform: darwin
2025-12-05 14:41:50.256525 DEBUG Adding new file root &#x27;/Users/hermeschen/Repo/work/stream-server/.venv/lib/python3.12/site-packages&#x27; of kind LibrarySearchPath
2025-12-05 14:41:50.259387 DEBUG Adding new file root &#x27;/Users/hermeschen/Repo/work/stream-server&#x27; of kind Project
2025-12-05 14:41:50.260043 DEBUG Setting included paths: 1
2025-12-05 14:41:50.260047 DEBUG Reloading files for project `stream-server`
2025-12-05 14:41:50.260082 DEBUG Starting main loop
2025-12-05 14:41:50.260087 DEBUG Waiting for next main loop message.
2025-12-05 14:41:50.260151 DEBUG Checking all files in project &#x27;stream-server&#x27;
2025-12-05 14:41:50.265314 INFO Indexed 1 file(s) in 0.005s
2025-12-05 14:41:50.266975 DEBUG Checking file &#x27;/Users/hermeschen/Repo/work/stream-server/src/stream_server/internal/stream/_GStreamer.py&#x27;
2025-12-05 14:41:50.287359 DEBUG Resolving dynamic module resolution paths
2025-12-05 14:41:50.309481 DEBUG Module `gi.repository.Gst` not found in search paths
2025-12-05 14:41:50.309511 DEBUG Module `gi.repository.Gst` not found while looking in parent dirs
2025-12-05 14:41:50.317814 DEBUG Checking all files took 0.052s
</code></pre>
Version
<p>ty 0.0.1-alpha.31 (51c73d687 2025-12-04)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-05 23:43</div>
            <div class="timeline-body"><p>Thanks for the report! This is a limitation shared by all Python type checkers. Currently the only solution available for this in the Python typing ecosystem is for the library to provide stubs explicitly listing the attributes that should be considered available. There really is no solution for dynamically considering an attribute available only after <code>gi.require_version(...)</code> has been called for it. So this would require us building special-case support for pygobject into ty. That&#x27;s not totally out of the question, but it&#x27;s unlikely to be a near-term priority. At the moment, a type-ignore in your own code (or providing your own type stub that lists the submodules matching your own <code>require_version</code> calls) are the best available options.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">library</span> added by <a href="https://github.com/carljm">@carljm</a> on 2025-12-05 23:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by <a href="https://github.com/carljm">@carljm</a> on 2025-12-05 23:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hermeschen1116">@hermeschen1116</a> on 2025-12-06 04:52</div>
            <div class="timeline-body"><p>I see. Thank you for the response. It&#x27;ll be quite helpful if Ty can support sub modules under gi for better development experience.
But as what you said, it seems that need help from pyobject maintainers to have stub files included in library?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:16 UTC
    </footer>
</body>
</html>
