<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`contextmanager` decorator has inconsistencies when combined with `staticmethod` - astral-sh/ty #2114</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`contextmanager` decorator has inconsistencies when combined with `staticmethod`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2114">#2114</a>
        opened by <a href="https://github.com/mflova">@mflova</a>
        on 2025-12-19 16:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mflova">@mflova</a> on 2025-12-19 16:26</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>More specifically, it does not work only when the context manager is called within the instance itself. As you can see from the snippet below, same calls are valid or not valid depending on where the context manager is called from</p>
<pre><code class="language-py">from collections.abc import Iterator
from contextlib import contextmanager


class A:
    @staticmethod
    @contextmanager
    def my_context(num: int) -&gt; Iterator[None]:
        yield

    def method(self) -&gt; None:
        with self.my_context(10):  # Too many positional arguments: expected 0, got 1
            pass

with A.my_context(5):  # OK
    ...

with A().my_context(5):  # Too many positional arguments: expected 0, got 1
    ...
</code></pre>
<h3>Version</h3>
<p>0.0.4</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-20 17:02</div>
            <div class="timeline-body"><p>Thanks for the report!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-12-20 17:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-12-21 14:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-12-24 03:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:53:03 UTC
    </footer>
</body>
</html>
