<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Non-deterministic overload matching failure - astral-sh/ty #1389</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Non-deterministic overload matching failure</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1389">#1389</a>
        opened by <a href="https://github.com/mtshiba">@mtshiba</a>
        on 2025-10-17 15:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mtshiba">@mtshiba</a> on 2025-10-17 15:10</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>An error has been observed randomly appearing and disappearing in the mypy_primer report.
This has been seen in many PRs (e.g. https://github.com/astral-sh/ruff/pull/20871).</p>
<pre><code>scikit-build-core (https://github.com/scikit-build/scikit-build-core)
+ src/scikit_build_core/build/_wheelfile.py:51:22: error[no-matching-overload] No overload of function `field` matches arguments
</code></pre>
<p>https://github.com/scikit-build/scikit-build-core/blob/3f371fff3d0dd424811ef73f58d88389263d79db/src/scikit_build_core/build/_wheelfile.py#L51</p>
<p>Unfortunately, this is not easy to reproduce locally, and the only known way is to run mypy_primer.
So I haven't been able to identify the cause of this error.</p>
<p>Based on my current investigation, this error appears to have become apparent from https://github.com/astral-sh/ruff/pull/20476. However, I believe that the PR only exposed the error, and the seed of nondeterminism was likely planted before that.</p>
<p>Possibly related: https://github.com/astral-sh/ty/issues/369</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @AlexWaygood on 2025-10-17 15:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-10-17 17:00</div>
            <div class="timeline-body"><p>Does the overload matching iterate over any hash maps?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mtshiba">@mtshiba</a> on 2025-10-19 06:44</div>
            <div class="timeline-body"><p><code>TypeInferenceBuilder::check_overloaded_functions</code> seems suspicious. It uses <code>TypeInferenceBuilder::called_functions: FxHashSet</code>, which is used as an iterator.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-10-19 10:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @MichaReiser on 2025-11-21 17:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-11-21 17:28</div>
            <div class="timeline-body"><p>This is back. The message is slightly different but also on <code>scikit-build-core</code></p>
<p>Example runs:</p>
<ul>
<li>https://github.com/astral-sh/ruff/pull/21549#issuecomment-3560212530</li>
<li>https://github.com/astral-sh/ruff/pull/21560#issuecomment-3563186797</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-11-21 21:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:36 UTC
    </footer>
</body>
</html>
