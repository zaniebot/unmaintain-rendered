<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>False positive: type checker thinks `__getitem__` is required for `foo[2] = 2` - astral-sh/ty #862</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>False positive: type checker thinks <code>__getitem__</code> is required for <code>foo[2] = 2</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/862">#862</a>
        opened by <a href="https://github.com/mflova">@mflova</a>
        on 2025-07-21 12:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mflova">@mflova</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>It seems the tool mixes <code>__getitem__</code> protocol with <code>__setitem__</code>. In the situation below, <code>ty</code> seems to be thinking that I am accessing the <code>__getitem__</code> method when it is <code>__setitem__</code>:</p>
<pre><code class="language-py">class Foo:
    def __setitem__(self, key: int, value: int) -&gt; None:
        print(f&quot;Setting {key} to {value}&quot;)


foo = Foo()
foo[2] = 2  # Cannot subscript object of type `Foo` with no `__getitem__` method
</code></pre>
<h3>Version</h3>
<p>ty 0.0.1-alpha.15 (0369a3598 2025-07-18)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "False positive: type checker thinks __getitem__ is required for foo[2] = 2" to "False positive: type checker thinks `__getitem__` is required for `foo[2] = 2`" by @mflova on 2025-07-21 12:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @carljm on 2025-07-21 16:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-07-21 16:21</div>
            <div class="timeline-body"><p>Thanks for the report! This is definitely a bug.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Beta" by @carljm on 2025-07-23 23:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MatthewMckee4">@MatthewMckee4</a> on 2025-07-26 22:00</div>
            <div class="timeline-body"><p>Help wanted? If no one's has picked it up in the next couple of days I will when I'm available, thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-07-27 10:43</div>
            <div class="timeline-body"><p>go for it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @sharkdp on 2025-07-30 18:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:20:20 UTC
    </footer>
</body>
</html>
