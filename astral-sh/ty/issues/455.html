<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Failed to parse pyvenv.cfg file on MacOS - astral-sh/ty #455</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Failed to parse pyvenv.cfg file on MacOS</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/455">#455</a>
        opened by <a href="https://github.com/Skylion007">@Skylion007</a>
        on 2025-05-19 17:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Skylion007">@Skylion007</a> on 2025-05-19 17:05</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><code>ty 0.0.1-alpha.5 (3b726d87a 2025-05-17)</code></p>
<p>Contents of pyvenv.cfg</p>
<pre><code>home = /usr/local/Cellar/python@3.9/3.9.1_8/Frameworks/Python.framework/Versions/3.9
implementation = CPython
version_info = 3.9.1.final.0
virtualenv = 20.4.2
include-system-site-packages = false
base-prefix = /usr/local/Cellar/python@3.9/3.9.1_8/Frameworks/Python.framework/Versions/3.9
base-exec-prefix = /usr/local/Cellar/python@3.9/3.9.1_8/Frameworks/Python.framework/Versions/3.9
base-executable = /usr/local/opt/python@3.9/bin/python3.9
</code></pre>
<p>logs:</p>
<pre><code>2025-05-19 13:02:29.541067 WARN ty is pre-release software and not ready for production use. Expect to encounter bugs, missing features, and fatal errors.
2025-05-19 13:02:29.691439 DEBUG Version: 0.0.1-alpha.5 (3b726d87a 2025-05-17)
2025-05-19 13:02:29.691521 DEBUG Architecture: x86_64, OS: macos, case-sensitive: case-insensitive
2025-05-19 13:02:29.691559 DEBUG Searching for a project in '/Users/agokaslan/git/pytorch'
2025-05-19 13:02:29.691944 DEBUG Resolving requires-python constraint: `&gt;=3.9`
2025-05-19 13:02:29.69197 DEBUG Resolved requires-python constraint to: 3.9
2025-05-19 13:02:29.692004 DEBUG Project without `tool.ty` section: '/Users/agokaslan/git/pytorch'
2025-05-19 13:02:29.69202 DEBUG Searching for a user-level configuration at `/Users/agokaslan/.config/ty/ty.toml`
2025-05-19 13:02:29.692044 INFO Defaulting to python-platform `darwin`
2025-05-19 13:02:29.692062 INFO Python version: Python 3.9, platform: darwin
2025-05-19 13:02:29.692079 DEBUG Adding first-party search path '/Users/agokaslan/git/pytorch'
2025-05-19 13:02:29.692094 DEBUG Using vendored stdlib
2025-05-19 13:02:29.692741 DEBUG Discovering site-packages paths from sys-prefix `/Users/agokaslan/venvs/ai_habitat_brew_py3` (`VIRTUAL_ENV` environment variable')
2025-05-19 13:02:29.692805 DEBUG Attempting to parse virtual environment metadata at '/Users/agokaslan/venvs/ai_habitat_brew_py3/pyvenv.cfg'
</code></pre>
<p>Error:</p>
<pre><code>ty failed
  Cause: Invalid search path settings
  Cause: Failed to discover the site-packages directory: Failed to parse the pyvenv.cfg file at /Users/agokaslan/venvs/ai_habitat_brew_py3/pyvenv.cfg because the following error was encountered when trying to resolve the `home` value to a directory on disk: No such file or directory (os error 2)
</code></pre>
<p>Tis a shame because the previous version worked great too.</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Failed to parse pyvenv.cfg file on Mac" to "Failed to parse pyvenv.cfg file on MacOS" by @Skylion007 on 2025-05-19 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">imports</span> added by @AlexWaygood on 2025-05-19 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-19 17:11</div>
            <div class="timeline-body"><p>Does the path <code>/usr/local/Cellar/python@3.9/3.9.1_8/Frameworks/Python.framework/Versions/3.9</code> exist?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-19 17:11</div>
            <div class="timeline-body"><p>Given that we don't use that value. I think it would be okay for ty to pick up the path and instead print a warning</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-19 17:15</div>
            <div class="timeline-body"><p>IIRC MacOS system builds do some slightly cursed things with symlinks, which might be confusing us...</p>
<blockquote>
<p>Tis a shame because the previous version worked great too.</p>
</blockquote>
<p>I'm somewhat confused here because I don't think we've changed anything that would result in different behaviour here. Are you sure you were setting the <code>VIRTUAL_ENV</code> variable when you ran previous versions of ty, @Skylion007? (It's implicitly set whenever you activate a virtual environment in your shell.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2025-05-19 17:45</div>
            <div class="timeline-body"><blockquote>
<p>Does the path <code>/usr/local/Cellar/python@3.9/3.9.1_8/Frameworks/Python.framework/Versions/3.9</code> exist?</p>
</blockquote>
<p>Surprisingly no lol, the venv works though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2025-05-19 17:46</div>
            <div class="timeline-body"><p>Yeah everything wasn't upgraded to 3.9.22 under the hood at some point and the venv global packages did not get updated</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Skylion007">@Skylion007</a> on 2025-05-19 17:47</div>
            <div class="timeline-body"><blockquote>
<p>IIRC MacOS system builds do some slightly cursed things with symlinks, which might be confusing us...</p>
<blockquote>
<p>Tis a shame because the previous version worked great too.</p>
</blockquote>
<p>I'm somewhat confused here because I don't think we've changed anything that would result in different behaviour here. Are you sure you were setting the <code>VIRTUAL_ENV</code> variable when you ran previous versions of ty, <a href="https://github.com/Skylion007">@Skylion007</a>? (It's implicitly set whenever you activate a virtual environment in your shell.)</p>
</blockquote>
<p>This PR looks like it could be culprit? https://github.com/astral-sh/ruff/pull/17529</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-11-14 14:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:04 UTC
    </footer>
</body>
</html>
