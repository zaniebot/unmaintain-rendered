<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alternative or remove `lint` prefix in diagnostics - astral-sh/ty #289</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Alternative or remove <code>lint</code> prefix in diagnostics</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/289">#289</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-05-09 11:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 11:06</div>
            <div class="timeline-body"><p>I find the <code>lint::</code> prefix in front of every rule diagnostic very noisy. It's also somewhat confusing that it is <code>lint</code> but we use <code>rules</code> in the configuration.</p>
<pre><code>warning: lint:undefined-reveal: `reveal_type` used without importing it
  --&gt; /Users/micha/astral/test/notebook.ipynb:13:1
   |
11 | if &quot;ðŸ‡¬ðŸ‡§&quot;[::-1] and b == True: ...
12 |
13 | reveal_type(&quot;ðŸ‡¬ðŸ‡§&quot;[::-1] == &quot;ðŸ‡§ðŸ‡¬&quot;)
   | ^^^^^^^^^^^
14 | static_assert(&quot;ðŸ‡ºðŸ‡¦&quot;[::-1] == &quot;ðŸ‡¦ðŸ‡º&quot;)
15 | static_assert(&quot;ðŸ‡¸ðŸ‡ª&quot;[::-1] == &quot;ðŸ‡ªðŸ‡¸&quot;)
   |
info: This is allowed for debugging convenience but will fail at runtime
info: `lint:undefined-reveal` is enabled by default
</code></pre>
<p>The motivation for the <code>lint</code> prefix is that we want every <code>LintId</code> to be globally unique. This is important when it comes to suppression comments (although we already allow users to omit the prefix there).
The challenge with lint rules is that it is an open &quot;namespace&quot;.</p>
<p>Possible options:</p>
<ul>
<li>Rename <code>lint:</code> to <code>rule:</code></li>
<li>Make it a postfix, e.g. <code>undefined-reveal (rule)</code> where we render the <code>(rule)</code> is rendered <em>dimmed</em></li>
<li>Omit it entirely</li>
<li>... other ideas?</li>
</ul>
<p>CC: @BurntSushi</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">diagnostics</span> added by @MichaReiser on 2025-05-09 11:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-09 11:11</div>
            <div class="timeline-body"><blockquote>
<p>Omit it entirely</p>
</blockquote>
<p>I would just do this for now, personally. I don't think the reason for the prefix being there is at all obvious to users, and I also find it really noisy in the diagnostic rendering (especially when using <code>--output-format=concise</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-05-09 11:13</div>
            <div class="timeline-body"><p>I would also omit it. And I'd clean up the formatting a little bit too, e.g.,</p>
<pre><code>warning[undefined-reveal]: `reveal_type` used without importing it
...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 11:15</div>
            <div class="timeline-body"><p>I'm fine with that. We'll see if users get confused once ty supports multiple tools but we could e.g. use notes if necessary</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-09 11:17</div>
            <div class="timeline-body"><blockquote>
<p>And I'd clean up the formatting a little bit too, e.g.,</p>
<pre><code>warning[undefined-reveal]: `reveal_type` used without importing it
</code></pre>
</blockquote>
<p>Hmm, not sure -- I think the spaces we have currently make it more readable?</p>
<pre><code>warning: undefined-reveal: `reveal_type` used without importing it
</code></pre>
<p>Or maybe we could use round brackets -- it feels closer to English prose?</p>
<pre><code>warning(undefined-reveal): `reveal_type` used without importing it
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-05-09 11:19</div>
            <div class="timeline-body"><p>The <code>severity[id]</code> format is what rustc uses so I guess I'm used to it. I don't like the spaces personally. It looks oddly unbalanced to me. Parentheses seem okay to me. Or at least, not really much difference between them and square brackets to my eyes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 11:24</div>
            <div class="timeline-body"><p>I like the <code>warning[name]</code>, it removes some unnecessary space and the colons. I slightly prefer it over <code>warning(name)</code>. Not sure why</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-09 11:26</div>
            <div class="timeline-body"><blockquote>
<p>it removes some unnecessary space</p>
</blockquote>
<p>They're all exactly the same number of characters ðŸ˜†</p>
<pre><code>warning: undefined-reveal: `reveal_type` used without importing it
warning[undefined-reveal]: `reveal_type` used without importing it
warning(undefined-reveal): `reveal_type` used without importing it
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 11:28</div>
            <div class="timeline-body"><p>What I mean by space is whitespace. I also really dislike the double colon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-09 13:48</div>
            <div class="timeline-body"><p>I have felt strongly for a while now that <code>lint</code> is not an appropriate name for the type check rules / violations :)</p>
<p>Why is it being used for the concept when the user-facing config is &quot;rule&quot;?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 14:05</div>
            <div class="timeline-body"><blockquote>
<p>Why is it being used for the concept when the user-facing config is &quot;rule&quot;?</p>
</blockquote>
<p>Just a relict from when it was called <code>lint</code> in the configuration too.</p>
<p>We intentionally use the term <code>lint</code> internally because we may want to have some lints that aren't configurable but suppressable and those wouldn't be rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-09 14:13</div>
            <div class="timeline-body"><p>I'm not sure I understand how <code>lint</code> creates that distinction, can you say more?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 14:14</div>
            <div class="timeline-body"><p>lint is the generic concept for any suppressable violation. A lint rule is a specific form of lint that can be enabled or disabled. We don't have any lint today that isn't a lint rule.</p>
<p>This isn't a user-visible concept today</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-09 14:17</div>
            <div class="timeline-body"><p>I see, thanks! I think I stand by &quot;lint&quot; being a misleading term for this and would advocate for renaming it (which may be a separate question from removing the prefix). It sounds like it can't be a &quot;rule&quot; because that implies configurability, which seems fine. What's the concept for a non-suppressible violation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 14:21</div>
            <div class="timeline-body"><blockquote>
<p>I see, thanks! I think I stand by &quot;lint&quot; being a misleading term for this and would advocate for renaming it (which may be a separate question from removing the prefix). It sounds like it can't be a &quot;rule&quot; because that implies configurability, which seems fine. What's the concept for a non-suppressible violation?</p>
</blockquote>
<p>These are all just code internals. There's no single concept for other error codes. They're just <a href="https://github.com/astral-sh/ruff/blob/981bd70d393fe29324c07c3ffce5ecddd40e6bd6/crates/ruff_db/src/diagnostic/mod.rs#L575-L594"><code>DiagnosticId</code>s</a>. Examples are IO errors, syntax errors, revealed types, configuration errors (unknown rule), panics... Just anything that isn't a rule</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-09 14:29</div>
            <div class="timeline-body"><blockquote>
<p>Just anything that isn't a rule</p>
</blockquote>
<p>Anything that isn't a lint ;)</p>
<p>Would it be reasonable to call the top-level concept a &quot;rule&quot; even if it's not configurable? Why does it need a different name if there's configuration exposed? (just trying to understand the existing model, thanks for your patience!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-09 15:00</div>
            <div class="timeline-body"><blockquote>
<p>Would it be reasonable to call the top-level concept a &quot;rule&quot; even if it's not configurable? Why does it need a different name if there's configuration exposed? (just trying to understand the existing model, thanks for your patience!)</p>
</blockquote>
<p>Let's discuss this somewhere else and after the release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-10 13:03</div>
            <div class="timeline-body"><p>Fixed in https://github.com/astral-sh/ruff/pull/17987</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-05-10 13:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:39:30 UTC
    </footer>
</body>
</html>
