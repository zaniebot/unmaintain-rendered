<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No overload found for SQLModel's `session.exec` - astral-sh/ty #930</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>No overload found for SQLModel&#x27;s <code>session.exec</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/930">#930</a>
        opened by <a href="https://github.com/aclementev">@aclementev</a>
        on 2025-08-03 11:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/aclementev">@aclementev</a></div>
            <div class="timeline-body">Summary
<p>I ran into the following error while running the <a href="http://sqlmodel.tiangolo.com/tutorial/">SQLModel tutorial</a> using <code>ty</code>.</p>
<pre><code>No overload of bound method `exec` matches arguments
</code></pre>
<p>This is when running the following:</p>
<pre><code>    with Session(engine) as session:
        session.exec(delete(Hero))
</code></pre>
<p>Here&#x27;s a full repro script:</p>
<pre><code># /// script
# requires-python = &quot;&gt;=3.13&quot;
# dependencies = [
#     &quot;sqlmodel&quot;,
# ]
# ///
from sqlmodel import (
    Field,
    Session,
    SQLModel,
    create_engine,
    delete,
)


class Hero(SQLModel, table=True):
    id: int | None = Field(default=None, primary_key=True)
    name: str


def main():
    engine = create_engine(&quot;sqlite://&quot;, echo=True)
    SQLModel.metadata.create_all(engine)

    with Session(engine) as session:
        session.exec(delete(Hero))


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p>When I run <code>ty check repro.py</code> in an venv with <code>sqlmodel==0.0.24</code> I see the following:</p>
<pre><code>error[no-matching-overload]: No overload of bound method `exec` matches arguments
  --&gt; repro.py:26:9
   |
25 |     with Session(engine) as session:
26 |         session.exec(delete(Hero))
   |         ^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
info: First overload defined here
  --&gt; .venv/lib/python3.13/site-packages/sqlmodel/orm/session.py:29:9
   |
27 |   class Session(_Session):
28 |       @overload
29 |       def exec(
   |  _________^
30 | |         self,
31 | |         statement: Select[_TSelectParam],
32 | |         *,
33 | |         params: Optional[Union[Mapping[str, Any], Sequence[Mapping[str, Any]]]] = None,
34 | |         execution_options: Mapping[str, Any] = util.EMPTY_DICT,
35 | |         bind_arguments: Optional[Dict[str, Any]] = None,
36 | |         _parent_execute_state: Optional[Any] = None,
37 | |         _add_event: Optional[Any] = None,
38 | |     ) -&gt; TupleResult[_TSelectParam]: ...
   | |___________________________________^
39 |
40 |       @overload
   |
info: Possible overloads for bound method `exec`:
info:   (self, statement: Select[_TSelectParam], *, params: Mapping[str, Any] | Sequence[Mapping[str, Any]] | None = None, execution_options: Mapping[str, Any] = @Todo, bind_arguments: dict[str, Any] | None = None, _parent_execute_state: Any | None = None, _add_event: Any | None = None) -&gt; TupleResult[_TSelectParam]
info:   (self, statement: SelectOfScalar[_TSelectParam], *, params: Mapping[str, Any] | Sequence[Mapping[str, Any]] | None = None, execution_options: Mapping[str, Any] = @Todo, bind_arguments: dict[str, Any] | None = None, _parent_execute_state: Any | None = None, _add_event: Any | None = None) -&gt; ScalarResult[_TSelectParam]
info: Overload implementation defined here
  --&gt; .venv/lib/python3.13/site-packages/sqlmodel/orm/session.py:52:9
   |
50 |       ) -&gt; ScalarResult[_TSelectParam]: ...
51 |
52 |       def exec(
   |  _________^
53 | |         self,
54 | |         statement: Union[
55 | |             Select[_TSelectParam],
56 | |             SelectOfScalar[_TSelectParam],
57 | |             Executable[_TSelectParam],
58 | |         ],
59 | |         *,
60 | |         params: Optional[Union[Mapping[str, Any], Sequence[Mapping[str, Any]]]] = None,
61 | |         execution_options: Mapping[str, Any] = util.EMPTY_DICT,
62 | |         bind_arguments: Optional[Dict[str, Any]] = None,
63 | |         _parent_execute_state: Optional[Any] = None,
64 | |         _add_event: Optional[Any] = None,
65 | |     ) -&gt; Union[TupleResult[_TSelectParam], ScalarResult[_TSelectParam]]:
   | |_______________________________________________________________________^
66 |           results = super().execute(
67 |               statement,
   |
info: rule `no-matching-overload` is enabled by default

Found 1 diagnostic
</code></pre>
<p>When I run this with mypy this does not raise any error</p>
Version
<p>ty 0.0.1-alpha.16 (c452e53a0 2025-07-25)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aclementev">@aclementev</a> on 2025-08-03 19:44</div>
            <div class="timeline-body"><p>Never mind, I thought I checked it with mypy too but apparently I didn&#x27;t. I ran mypy again and I see a similar error.
This seems to be an issue with <code>sqlmodel</code>&#x27;s types (<a href="https://github.com/fastapi/sqlmodel/issues/909">fastapi/sqlmodel#909</a>).
Sorry for the noise</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/aclementev">@aclementev</a> on 2025-08-03 19:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-08 08:54</div>
            <div class="timeline-body"><p>No problem, thank you for following through and providing all the information!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:25:12 UTC
    </footer>
</body>
</html>
