<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promote literals in unannotated module globals - astral-sh/ty #1822</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Promote literals in unannotated module globals</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1822">#1822</a>
        opened by <a href="https://github.com/JanFontanet">@JanFontanet</a>
        on 2025-12-09 08:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JanFontanet">@JanFontanet</a> on 2025-12-09 08:24</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I've a 3rd party library that exposes some configuration through module variables, so I've to overwrite them in order for the library to work as I want. But when I run <code>ty check</code> on my code I got an error that can be reproduced with the minimal example below.</p>
<p>a.py:</p>
<pre><code class="language-python">MY_VAR=1
</code></pre>
<p>main.py</p>
<pre><code class="language-python">import a

a.MY_VAR=2
</code></pre>
<p>I got the following error:</p>
<pre><code>Object of type `Literal[2]` is not assignable to attribute `MY_VAR` of type `Literal[1]` (invalid-assignment) [Ln 3, Col 1]
</code></pre>
<h3>Version</h3>
<p>ty 0.0.1-alpha.32</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-12-09 18:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-09 18:50</div>
            <div class="timeline-body"><p>Thanks for the report!</p>
<p>We probably do need to do literal-promotion on un-annotated module globals, now that we aren't unioning them with <code>Unknown</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Module variables inferred as literals" to "Promote literals in unannotated module globals" by @carljm on 2025-12-09 18:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-24 13:04</div>
            <div class="timeline-body"><p>There was a lot of previous discussion around this in @sharkdp's PRs https://github.com/astral-sh/ruff/pull/20643 and https://github.com/astral-sh/ruff/pull/20664. I support experimenting with this, but I think there are definitely downsides as well as upsides to doing this.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:53:03 UTC
    </footer>
</body>
</html>
