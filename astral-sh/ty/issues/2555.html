<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Semantic token recognition for pandas.read_parquet - astral-sh/ty #2555</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Semantic token recognition for pandas.read_parquet</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2555">#2555</a>
        opened by <a href="https://github.com/mlisovyi">@mlisovyi</a>
        on 2026-01-18 14:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mlisovyi">@mlisovyi</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Token type of the commonly used pandas.read_xxx functions is not &quot;function&quot;:</p>
<p><img width="344" height="47" alt="Image" src="https://github.com/user-attachments/assets/c2ba5d1a-aca9-41da-b59e-7b625449820a" /></p>
<p><em>Note that <code>read_csv</code> is highlighted as a function, but <code>read_parquet</code> or <code>read_json</code> not</em></p>
<p>Here is the token type as reconstructed by ty:</p>
<p><img width="449" height="469" alt="Image" src="https://github.com/user-attachments/assets/9d69c577-81c8-4e6b-bd96-575359db30bb" /></p>
<h3>Version</h3>
<p>ty 0.0.12 (4b74e4ded 2026-01-14)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Semantic token reconnition for pandas.read_parquet" to "Semantic token recognition for pandas.read_parquet" by @AlexWaygood on 2026-01-18 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @AlexWaygood on 2026-01-18 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-18 17:39</div>
            <div class="timeline-body"><p>Thanks for the report!</p>
<p>I can reproduce this locally if I have only <code>pandas</code> installed in a virtual environment, but not if I also have <code>pandas-stubs</code> installed in my environment. I'd recommend also installing <code>pandas-stubs</code> for local development, especially if you're interested in using ty as a type checker as well as a language server -- it will give ty much better type information to work with.</p>
<p>The reason why we do not display the correct semantic token for <code>read_parquet</code> when <code>pandas-stubs</code> is not installed is because we infer the type of <code>read_parquet</code> as <code>Unknown</code>. The reason why we infer the type as <code>Unknown</code> is because on the 2.3.3 tag of <code>pandas</code> (things look a bit different on the <code>main</code> branch), <code>read_parquet</code> is <a href="https://github.com/pandas-dev/pandas/blob/9c8bc3e55188c8aff37207a74f1dd144980b8874/pandas/io/parquet.py#L500-L501">decorated</a> with <code>@doc(storage_options=_shared_docs[&quot;storage_options&quot;])</code>. If we look at the <a href="https://github.com/pandas-dev/pandas/blob/9c8bc3e55188c8aff37207a74f1dd144980b8874/pandas/util/_decorators.py#L343">definition</a> of the <code>doc</code> decorator, we can see that it has this signature:</p>
<pre><code class="language-py">def doc(*docstrings: None | str | Callable, **params) -&gt; Callable[[F], F]:
</code></pre>
<p>which means that the reason we infer <code>Unknown</code> for <code>read_parquet</code> is #1136</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2026-01-18 17:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> removed by @AlexWaygood on 2026-01-18 17:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-18 18:19:03 UTC
    </footer>
</body>
</html>
