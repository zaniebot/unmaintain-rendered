<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checking home-assistant-core stack overflows in `find_legacy_typevars` - astral-sh/ty #999</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Checking home-assistant-core stack overflows in <code>find_legacy_typevars</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/999">#999</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-08-15 11:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body">Summary
<p>It still requires an import but the repro is:</p>
<pre><code>from .connection import ActiveConnection


def handle_subscribe_bootstrap_integrations(
    hass: HomeAssistant, connection: ActiveConnection, msg: dict[str, Any]
) -&gt; None:
    &quot;&quot;&quot;Handle subscribe bootstrap integrations command.&quot;&quot;&quot;

    def forward_bootstrap_integrations(message: dict[str, Any]) -&gt; None:
        &quot;&quot;&quot;Forward bootstrap integrations to websocket.&quot;&quot;&quot;
        connection.send_message(messages.event_message(msg[&quot;id&quot;], message))

</code></pre>
<p>from <code>﻿﻿﻿homeassistant/components/websocket_api/commands.py</code></p>
<p>Stacktrace https://gist.github.com/MichaReiser/7727742b46821073b8a1a660238bec8e</p>
<p>Related to <a href="https://github.com/astral-sh/ty/issues/256">astral-sh/ty#256</a></p>
Version
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fatal</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 11:40</div>
            <div class="timeline-body"><p>CC: @dcreager</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Beta&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 11:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Checking home-assistant-core stack overflows&quot; to &quot;Checking home-assistant-core stack overflows in `find_legacy_typevars`&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 11:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-15 11:55</div>
            <div class="timeline-body"><p>Note: I wasn&#x27;t sure if I should open this one or if it&#x27;s still a known issue that we&#x27;re stack overflowing in some cases but I couldn&#x27;t find any issue specifically to stack overflows (the others mainly mention too many iterations). If this is tracked elsewhere, feel free to close without a commennt</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/dcreager">@dcreager</a> by <a href="https://github.com/carljm">@carljm</a> on 2025-08-15 15:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-08-22 12:11</div>
            <div class="timeline-body"><p>@dcreager it seems home assistant passes now. Did you land a fix for this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-08-22 16:21</div>
            <div class="timeline-body"><p>There have been a few recent PRs that improved our coverage of type visitors that might have fixed this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/carljm">@carljm</a> on 2025-08-22 16:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:25:17 UTC
    </footer>
</body>
</html>
