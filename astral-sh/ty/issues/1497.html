<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dict unpacking accepts invalid types - astral-sh/ty #1497</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Dict unpacking accepts invalid types</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1497">#1497</a>
        opened by <a href="https://github.com/refi64">@refi64</a>
        on 2025-11-06 23:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/refi64">@refi64</a></div>
            <div class="timeline-body">Summary
<p>https://play.ty.dev/6fed81b8-6589-4e8b-9adf-71bc1676d9cc</p>
<pre><code>x = {**1}
</code></pre>
<p>This succeeds without any errors, even though it of course fails at runtime. This seems to work just fine in list literals (show in the playground link) but not in dicts. Might be related to <a href="https://github.com/astral-sh/ty/issues/1332">astral-sh/ty#1332</a>? But that seems to be more specifically about &quot;mappings with the wrong types&quot; rather than &quot;not a mapping at all&quot;.</p>
Version
<p>35640dd85</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-11-07 01:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-11-07 02:13</div>
            <div class="timeline-body"><p>Thanks! Please see #1332 :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-11-07 04:05</div>
            <div class="timeline-body"><blockquote>
<p>Might be related to <a href="https://github.com/astral-sh/ty/issues/1332">astral-sh/ty#1332</a>? But that seems to be more specifically about &quot;mappings with the wrong types&quot; rather than &quot;not a mapping at all&quot;.</p>
</blockquote>
<p>Specifically, this line in the example in #1332 covers your issue here:</p>
<pre><code>    reveal_type({**d})  # dict[Unknown, Unknown]             (good, but no diagnostic emitted!)
</code></pre>
<p>Since <code>d</code> is typed as <code>object</code> in that snippet (it is not a mapping at all)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:25:55 UTC
    </footer>
</body>
</html>
