<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`from &lt;module&gt;` and `import &lt;module&gt;` detection for completions is not precise enough - astral-sh/ty #1562</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`from &lt;module&gt;` and `import &lt;module&gt;` detection for completions is not precise enough</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1562">#1562</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2025-11-14 19:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-14 19:17</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Currently, if you do <code>import collections a&lt;CURSOR&gt;</code>, then completions for <em>module</em> names will be shown. Instead, we should, at minimum, show scope completions. <em>Ideally</em> we'd only show <code>as</code> here.</p>
<p>Additionally, if you do <code>import collections.abc, collect&lt;CURSOR&gt;</code>, you'll actually get scope based completions instead of module completions.</p>
<p>This all stems from our <code>import &lt;module&gt;</code> and <code>from &lt;module&gt;</code> detection being not quite accurate:</p>
<p>https://github.com/astral-sh/ruff/blob/8599c7e5b3b301b2352d30302d74b72e2123347f/crates/ty_ide/src/completion.rs#L810-L854</p>
<p>It's pretty basic and doesn't try to tease apart the different import names.</p>
<p>There are a few other functions that recognize different forms of import statements. Perhaps we should try to unify these into one state machine that tries hard to recognize all forms of import statements and then returns what &quot;kind&quot; it is so that we can choose how we want to offer completions (if at all).</p>
<p>Originally reported here: https://github.com/astral-sh/ruff/pull/21460#pullrequestreview-3466201669</p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @BurntSushi on 2025-11-14 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @BurntSushi on 2025-11-14 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @BurntSushi on 2025-11-14 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">completions</span> added by @BurntSushi on 2025-11-14 19:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2025-11-17 14:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @BurntSushi on 2025-11-17 14:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-17 14:59</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/21484 partially addresses this issue, but <code>as</code> was just one example. This issue is meant to capture work toward making <code>import</code> detection more precise.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @BurntSushi by @BurntSushi on 2025-11-17 14:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-21 15:51</div>
            <div class="timeline-body"><p>Closed by https://github.com/astral-sh/ruff/pull/21547</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2025-11-21 15:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:42 UTC
    </footer>
</body>
</html>
