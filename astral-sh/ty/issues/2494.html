<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`unused-ignore-comment` should not handle unknown rules - astral-sh/ty #2494</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>unused-ignore-comment</code> should not handle unknown rules</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/2494">#2494</a>
        opened by <a href="https://github.com/lypwig">@lypwig</a>
        on 2026-01-14 14:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/lypwig">@lypwig</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I work on a Django application and I use both ty and Pyright for type checking.</p>
<p>I need to ignore typing on <code>Meta</code> classes, otherwise Pyright complains about <em>reportIncompatibleVariableOverride</em>:</p>
<pre><code class="language-py">    class Meta:  # type: ignore[reportIncompatibleVariableOverride]
</code></pre>
<p>But this comment triggers ty rule <a href="https://docs.astral.sh/ty/reference/rules/#unused-ignore-comment"><code>unused-ignore-comment</code></a> (<em>Unused blanket <code>type: ignore</code> directive</em>), incorrectly because the directive IS actually used, by Pyright.</p>
<h3>Version</h3>
<p>ty 0.0.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-14 15:01</div>
            <div class="timeline-body"><p>Thanks for the report! You can configure this by tweaking <a href="https://docs.astral.sh/ty/reference/configuration/#respect-type-ignore-comments">this setting</a>. This is stated in the docs that you link to.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2026-01-14 15:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-14 15:02</div>
            <div class="timeline-body"><p>I'll keep this open for now because I'm curious whether this setting works for them or if they want one that only disables <code>unused-ignore-comment</code> for <code>ty: ignore</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @MichaReiser on 2026-01-14 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2026-01-14 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lypwig">@lypwig</a> on 2026-01-14 15:12</div>
            <div class="timeline-body"><p>Ok thank you the <a href="https://docs.astral.sh/ty/reference/configuration/#respect-type-ignore-comments">respect-type-ignore-comments</a> settings works.</p>
<p>I was not aware of this option, I think it should be mentioned in <a href="https://docs.astral.sh/ty/reference/rules/#unused-ignore-comment">unused-ignore-comment</a> rule documentation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-14 15:13</div>
            <div class="timeline-body"><blockquote>
<p>I was not aware of this option, I think it should be mentioned in <a href="https://docs.astral.sh/ty/reference/rules/#unused-ignore-comment">unused-ignore-comment</a> rule documentation.</p>
</blockquote>
<p>It's already mentioned as the last sentence in that documentation</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lypwig">@lypwig</a> on 2026-01-14 15:24</div>
            <div class="timeline-body"><blockquote>
<p>It's already mentioned as the last sentence in that documentation</p>
</blockquote>
<p>Oh I'm so sorry I didn't pay attention.</p>
<hr />
<p>That said, I would like to suggest an other behavior.</p>
<p>The <code>type: ignore</code> is actually handy because I don't have to ignore both ty and Pyright rules.</p>
<p>I could ignore the ty rule with:</p>
<pre><code class="language-py">class Meta:  # type: ignore[reportIncompatibleVariableOverride] # ty: ignore[unused-ignore-comment]
</code></pre>
<p>But the fact is the ty rule <code>reportIncompatibleVariableOverride</code> does not exist...</p>
<p>So does it make sense for you to trigger <code>unused-ignore-comment</code> only if it an actual ty rule AND it is not used?</p>
<p>And eventually add an other rule to check if <code>type:</code> is used with an unknown rule?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-14 15:33</div>
            <div class="timeline-body"><blockquote>
<p>So does it make sense for you to trigger unused-ignore-comment only if it an actual ty rule AND it is not used?</p>
</blockquote>
<p>That's exactly the feedback I was looking for :) Thank you. Yes, I think splitting the rules makes sense. We just didn't know if there's any demand for it, that's why we initially deferred it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @MichaReiser on 2026-01-14 15:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @MichaReiser on 2026-01-14 15:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Pre-stable 1" by @MichaReiser on 2026-01-14 15:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @MichaReiser on 2026-01-14 15:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`unused-ignore-comment` should not handle `type:` comments" to "`unused-ignore-comment` should not handle unknown rules" by @lypwig on 2026-01-14 15:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2026-01-14 15:46</div>
            <div class="timeline-body"><p>It's not clear to me exactly what behavior we intend to implement in this issue. What @lypwig proposes (basing the behavior of <code>unused-ignore-comment</code> on whether a code is used that we recognize or not, and then having a separate diagnostic for &quot;type: ignore with unknown code&quot;) does not sound to me like any behavior we'd previously discussed when we discussed &quot;splitting the rule.&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-14 15:48</div>
            <div class="timeline-body"><p>Yeah, sorry. I didn't read the response carefully enough.</p>
<blockquote>
<p>So does it make sense for you to trigger unused-ignore-comment only if it an actual ty rule AND it is not used?</p>
</blockquote>
<p>I don't feel comfortable with that because it assumes that no two type checkers have overlapping rule names.</p>
<p>What I would suggest is that we make it a separate rule so that projects using multiple type checkers can disable the <code>type: ignore</code> one.</p>
<blockquote>
<p>And eventually add an other rule to check if type: is used with an unknown rule?</p>
</blockquote>
<p>I'm not sure how this would work if you use multiple type checkers as ty would warn about rules that it doesn't know but those might be pyright rules.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> removed by @MichaReiser on 2026-01-14 15:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2026-01-14 16:00</div>
            <div class="timeline-body"><p>Yes, I agree with all of that.</p>
<p>So then I just want to make sure that we properly understand @lypwig's use case, if we are going to take it as feedback in favor of two separate rules.</p>
<p>@lypwig I'm not sure I understand this example:</p>
<blockquote>
<p>class Meta:  # type: ignore[reportIncompatibleVariableOverride] # ty: ignore[unused-ignore-comment]</p>
</blockquote>
<p>If you set <code>respect-type-ignore-comments: false</code>, then you wouldn't need any <code># ty: ignore</code> there.</p>
<p>So can you clarify what is the problem you find with setting <code>respect-type-ignore-comments: false</code>? Is it that you have some <code>type: ignore</code> that should actually be respected by both ty and pyright? To me, in that case it actually seems better to use a separate <code>type: ignore</code> for pyright and <code>ty: ignore</code> for ty, because then you can use a rule code for both. If you use a single <code>type: ignore</code> to silence both, then (since pyright and ty don't share rule codes) it would have to be a blanket (code-less) ignore, which is more error-prone.</p>
<p>(Somewhat separately, I do wonder about our current behavior of interpreting any <code>type: ignore</code> with an unrecognized code as a blanket <code>type: ignore</code>. It seems unlikely to me that that will be the desired behavior for anyone -- but I'm also not sure what would be a better behavior.)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-14 16:42:20 UTC
    </footer>
</body>
</html>
