```yaml
number: 2405
title: Generic constraints inferred incorrectly in ty vs pyright
type: issue
state: closed
author: kszlim
labels: []
assignees: []
created_at: 2026-01-08T22:20:46Z
updated_at: 2026-01-09T21:15:06Z
url: https://github.com/astral-sh/ty/issues/2405
synced_at: 2026-01-10T01:56:41Z
```

# Generic constraints inferred incorrectly in ty vs pyright

---

_Issue opened by @kszlim on 2026-01-08 22:20_

### Summary

Using a LLM, I was able to create a MRE which works with pyright, but not ty:

```python
from typing import TypeVar, Iterable, reveal_type

class A:
    pass

class B:
    pass

T = TypeVar("T", A, B)

def process(items: Iterable[T]) -> T:
    for item in items:
        return item
    raise ValueError()


# WORKS: Explicit type annotation
def works() -> B:
    items: list[B] = []
    items.append(B())
    result = process(items)
    reveal_type(result)   # B âœ“
    return result


# BUG: Without annotation, ty resolves TypeVar to first constraint (A)
def fails() -> B:
    items = []
    items.append(B())
    items.append(B())
    reveal_type(items)    # list[Unknown] - same in both ty and pyright
    result = process(items)
    reveal_type(result)   # ty: A (wrong), pyright: Unknown (correct)
    return result         # ty error: A not assignable to B
```

### Version

0.0.10

---

_Comment by @carljm on 2026-01-08 23:43_

Thanks! I think this is a duplicate of #1100

---

_Closed by @carljm on 2026-01-08 23:43_

---

_Comment by @kszlim on 2026-01-09 21:15_

For my own tracking https://github.com/astral-sh/ty/issues/623

---
