<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-import completion suggestions should be ranked below other suggestions if the symbol is `@type_check_only` - astral-sh/ty #1558</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Auto-import completion suggestions should be ranked below other suggestions if the symbol is `@type_check_only`</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1558">#1558</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-11-14 16:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-11-14 16:34</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/20910 implemented a feature where <code>@type_check_only</code> symbols are ranked below other symbols in completion suggestions. However, this was implemented only for symbols in the same file -- and this has limited usefulness, since generally if your cursor in a <code>.py</code> file, most symbols in your file are not going to be marked as <code>@type_check_only</code>. It's a feature that's used much more often in stubs. Ideally, we would also rank auto-import suggestions below other auto-import suggestions if the relevant symbols are <code>@type_check_only</code>.</p>
<p>This is a bit of a hard problem, however, as we cannot eagerly infer the type of all auto-import suggestions. Possibly we can lazily infer the types of these symbols, but even that might be too much of a performance hit. If we can't use the type checker at all for this information, we may have to evaluate whether implementing this feature is worth the complexity.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">typing semantics</span> added by @AlexWaygood on 2025-11-14 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">completions</span> added by @AlexWaygood on 2025-11-14 16:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @AlexWaygood on 2025-11-14 17:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-17 16:35</div>
            <div class="timeline-body"><blockquote>
<p>If we can't use the type checker at all for this information, we may have to evaluate whether implementing this feature is worth the complexity.</p>
</blockquote>
<p>If <a href="https://github.com/search?q=repo%3Apython%2Ftypeshed%20type_check_only&amp;type=code">a lot of uses are trivial</a>, then it shouldn't be too hard for the auto-import symbol scanner to pick it up in most cases. The failure mode, I think, is that there are some cases where we don't correctly recognize it (either false positive or false negative) and thus rank that symbol higher (false negative) or lower (false positive) than we otherwise would. That might be an acceptable trade-off here.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:42 UTC
    </footer>
</body>
</html>
