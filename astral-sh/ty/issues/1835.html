<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consolidate handling of dataclass-params and dataclass-transformer-params - astral-sh/ty #1835</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Consolidate handling of dataclass-params and dataclass-transformer-params</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1835">#1835</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-12-10 09:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sharkdp">@sharkdp</a></div>
            <div class="timeline-body"><p>The goal of this ticket is to consolidate and clean up our handling of dataclass-params and dataclass-transformer-params for all different kinds of dataclasses: &quot;standard&quot; <code>dataclasses.dataclass</code> dataclasses, decorator-based dataclass transformers, base-class-based dataclass transformers, and metaclass-based dataclass transformers.</p>
<p>For more context, see <a href="https://github.com/astral-sh/ruff/pull/21820#issuecomment-3629221765">this comment</a>. In particular, this part:</p>
<blockquote>
<p>I think we never properly added support for default_* params on base-class and metaclass-based transformers, but some contributors added partial support when synthesizing <strong>init</strong>. Instead of that partial support, we should either have generalized methods for querying dataclass params (from anywhere) which always fall back to the dataclass-transformer-params, or we should ensure that dataclass_params on the class itself are always already initialized with values from the transformer param defaults. (It looks like this currently happens for function dataclass transforms but not for metaclass or base-class ones.) It also looks like we store dataclass_transformer_params on the class, but this also isn&#x27;t currently set for metaclass or base-class transformers. So this special-cased support for base-class and metaclass transformers that was added to <strong>init</strong> synthesis ought to be generalized, and if that happened this PR wouldn&#x27;t need to explicitly check the transformer params.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">dataclasses</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 09:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Stable&quot; by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-10 09:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-12-18 11:26</div>
            <div class="timeline-body"><p>For more context, see also this discussion: <a href="https://github.com/astral-sh/ruff/pull/22018">astral-sh/ruff#22018</a>/files#r2630663471</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-12-23 00:42</div>
            <div class="timeline-body"><p>Yeah, sounds like part of this ticket should be some clearer docstrings around <code>dataclass_params</code> and <code>dataclass_transformer_params</code> fields, that explain when we should/shouldn&#x27;t expect them to be set, and the right way to access those params (and detect dataclass-ness) reliably.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:21 UTC
    </footer>
</body>
</html>
