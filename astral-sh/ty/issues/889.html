<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Types that define `__iter__` with invalid signature are wrongly considered assignable to Iterable - astral-sh/ty #889</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Types that define <code>__iter__</code> with invalid signature are wrongly considered assignable to Iterable</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/889">#889</a>
        opened by <a href="https://github.com/github-actions">@github-actions</a>
        on 2025-07-25 12:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/github-actions">@github-actions</a> on 2025-07-25 12:06</div>
            <div class="timeline-body"><p>Run listed here: https://github.com/astral-sh/ty/actions/runs/16521468852</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @github-actions[bot] on 2025-07-25 12:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type properties</span> added by @github-actions[bot] on 2025-07-25 12:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-07-25 12:08</div>
            <div class="timeline-body"><pre><code>---- types::property_tests::stable::all_type_assignable_to_iterable_are_iterable stdout ----

thread 'types::property_tests::stable::all_type_assignable_to_iterable_are_iterable' panicked at /home/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/quickcheck-1.0.3/src/tester.rs:165:28:
[quickcheck] TEST FAILED. Arguments: (EnumLiteral(&quot;unsafe&quot;))
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace


failures:
    types::property_tests::stable::all_type_assignable_to_iterable_are_iterable
</code></pre>
<p>A merge race between https://github.com/astral-sh/ruff/pull/19187 and https://github.com/astral-sh/ruff/pull/19328, I'd guess.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @AlexWaygood by @AlexWaygood on 2025-07-25 12:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-25 12:19</div>
            <div class="timeline-body"><blockquote>
<p>AlexWaygood self-assigned this</p>
</blockquote>
<p>Thanks! Let me know if I can be of help</p>
<blockquote>
<p>A merge race between <a href="https://github.com/astral-sh/ruff/pull/19187">astral-sh/ruff#19187</a> and <a href="https://github.com/astral-sh/ruff/pull/19328">astral-sh/ruff#19328</a>, I'd guess.</p>
</blockquote>
<p>A bit of a stretch to call it a race: the enum literals PR was merged 10 days ago ðŸ˜œ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-07-25 12:22</div>
            <div class="timeline-body"><p>the issue is <em>fairly</em> obvious: <code>type(uuid.UUID.unsafe).__iter__</code> returns a bound attribute at runtime, and we recognize it as such in ty. But that's not sufficient for <code>uuid.UUID.unsafe</code> to be iterable, because the signature of <code>type(uuid.UUID.unsafe).__iter__</code> doesn't match the signature specified by the <code>typing.Iterable</code> protocol (its <code>Callable</code> supertype is <code>() -&gt; Iterator</code> rather than <code>(self) -&gt; Iterator</code>).</p>
<p>So this is just a missing <code>Protocol</code> feature, and it's the next one I was going to tackle anyway now that https://github.com/astral-sh/ruff/pull/19187 has landed!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Daily property test run failed on Fri Jul 25 2025" to "Some types that define `__iter__` with invalid signature are wrongly considered assignable to Iterable" by @carljm on 2025-07-25 15:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Some types that define `__iter__` with invalid signature are wrongly considered assignable to Iterable" to "Types that define `__iter__` with invalid signature are wrongly considered assignable to Iterable" by @carljm on 2025-07-25 15:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Beta" by @carljm on 2025-07-25 15:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-09-12 10:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:40:13 UTC
    </footer>
</body>
</html>
