```yaml
number: 632
title: "[panic] expression should belong to this 'UnpackResult' and 'Unpacker' should have inferred a type for it"
type: issue
state: open
author: correctmost
labels:
  - bug
  - fatal
  - fuzzer
assignees: []
created_at: 2025-06-11T03:38:24Z
updated_at: 2026-01-09T14:41:58Z
url: https://github.com/astral-sh/ty/issues/632
synced_at: 2026-01-10T01:56:40Z
```

# [panic] expression should belong to this 'UnpackResult' and 'Unpacker' should have inferred a type for it

---

_Issue opened by @correctmost on 2025-06-11 03:38_

### Summary

ty crashes on this fuzzed code:

```python
-a,f'{a}'=
```

```
error[panic]: Panicked at crates/ty_python_semantic/src/types/infer.rs:3529:26 when checking `c.py`: `expression should belong to this `UnpackResult` and `Unpacker` should have inferred a type for it`
```

### Version

ty 0.0.1-alpha.8

---

_Label `bug` added by @dhruvmanila on 2025-06-11 04:22_

---

_Label `fatal` added by @dhruvmanila on 2025-06-11 04:22_

---

_Comment by @dhruvmanila on 2025-06-11 04:33_

Thanks for the report!

It seems to be something around the fact that the variable that the f-string references is right there in the unpacking because changing that to some other variable removes the panic, so `-a,f'{b}'=` doesn't cause the panic.

---

_Comment by @dhruvmanila on 2025-06-11 04:58_

And, that the variable `a` isn't actually present in the unpack result because `-a` is an invalid expression so it doesn't contain any type for variable `a`. This (`a, f'{a}' =`) doesn't cause the panic because `a` should be present in the unpack result.

---

_Added to milestone `Stable` by @carljm on 2025-11-13 07:37_

---

_Label `fuzzer` added by @AlexWaygood on 2025-12-05 13:08_

---

_Comment by @MichaReiser on 2025-12-23 07:35_

Another example of this

```py
for+x,p*x
```

---

_Assigned to @dhruvmanila by @dhruvmanila on 2026-01-09 14:41_

---
