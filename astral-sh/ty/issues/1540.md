```yaml
number: 1540
title: Flaky tests in CI
type: issue
state: open
author: dhruvmanila
labels:
  - ci
  - testing
assignees: []
created_at: 2025-11-13T16:19:34Z
updated_at: 2026-01-09T18:13:24Z
url: https://github.com/astral-sh/ty/issues/1540
synced_at: 2026-01-10T01:56:40Z
```

# Flaky tests in CI

---

_Issue opened by @dhruvmanila on 2025-11-13 16:19_

### Summary

Collecting the flaky tests that we're seeing so far, re-running them makes them pass:

- ~~`ty_server::e2e pull_diagnostics::on_did_open`: https://github.com/astral-sh/ruff/actions/runs/19290646588/job/55160349507?pr=21363#step:7:5873~~
- `ty::file_watching directory_renamed`: https://github.com/astral-sh/ruff/actions/runs/19336380853/job/55312446927?pr=21421#step:7:5706
- `ty::file_watching unix::symlink_inside_project`: https://github.com/astral-sh/ruff/actions/runs/19322265094/job/55265874405?pr=21419#step:7:5706

### Version

_No response_

---

_Label `ci` added by @dhruvmanila on 2025-11-13 16:19_

---

_Label `testing` added by @dhruvmanila on 2025-11-13 16:19_

---

_Comment by @MichaReiser on 2025-11-13 16:37_

What's important to note is that they're all specific to macos

---

_Comment by @mtshiba on 2025-11-13 16:39_

another one: https://github.com/astral-sh/ruff/pull/21317#issuecomment-3503482666

* ~~`ty_server::e2e pull_diagnostics::document_diagnostic_caching_changed`: [astral-sh/ruff/actions/runs/19173434027/job/54811898939?pr=21317](https://github.com/astral-sh/ruff/actions/runs/19173434027/job/54811898939?pr=21317)~~

---

_Comment by @AlexWaygood on 2025-11-14 23:29_

`ty::file_watching directory_moved_to_trash` https://github.com/astral-sh/ruff/actions/runs/19377807970/job/55449565886

---

_Comment by @carljm on 2026-01-09 03:29_

Are we still seeing any of these? If so, it must not be super frequent. I can't remember the last time I saw a flaky test failure.

---

_Comment by @MichaReiser on 2026-01-09 07:15_

The file watching tests flake sometimes on macos. But it's not very often, which is why I never looked into it. The e2e tests are fixed 

---

_Comment by @dhruvmanila on 2026-01-09 10:04_

> The e2e tests are fixed

(I've marked them off from this thread.)

---

_Comment by @AlexWaygood on 2026-01-09 18:13_

they definitely still flake from time to time: https://github.com/astral-sh/ruff/actions/runs/20860850768/job/59939819903?pr=22481 was just now

---
