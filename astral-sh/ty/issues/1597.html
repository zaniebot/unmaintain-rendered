<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add command to generate type stubs (equivalent to mypy's `stubgen`) - astral-sh/ty #1597</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add command to generate type stubs (equivalent to mypy's `stubgen`)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1597">#1597</a>
        opened by <a href="https://github.com/MamadouSDiallo">@MamadouSDiallo</a>
        on 2025-11-20 03:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/MamadouSDiallo">@MamadouSDiallo</a> on 2025-11-20 03:54</div>
            <div class="timeline-body"><h3>Is your feature request related to a problem? Please describe.</h3>
<p>I am developing a Python library that includes compiled extensions (via Cython, PyO3, or C-extensions). To ensure users receive proper IDE support (autocompletion, signatures, and docstrings), I need to distribute <code>.pyi</code> stub files alongside my compiled binaries (<code>.so</code> / <code>.pyd</code>).</p>
<p>Currently, <code>ty</code> does not have a mechanism to generate these stubs. This forces me to maintain <code>mypy</code> in my build chain specifically to use <code>stubgen</code>, even if I intend to use <code>ty</code> for the actual type checking.</p>
<h3>Describe the solution you'd like</h3>
<p>I would like a built-in command (e.g., <code>ty stubgen</code> or <code>ty gen-stubs</code>) that can automatically generate <code>.pyi</code> files for a given package.</p>
<p>Crucially, this feature needs to support <strong>compiled extension introspection</strong>. It should be able to:</p>
<ol>
<li>Recurse through a target package.</li>
<li>Detect compiled modules (binary extensions).</li>
<li>Introspect them (similar to how <code>stubgen</code> imports modules at runtime) to extract function signatures and docstrings.</li>
<li>Output standard, compliant <code>.pyi</code> files to a specified directory.</li>
</ol>
<h3>Describe alternatives you've considered</h3>
<ul>
<li><strong>Using <code>mypy</code>:</strong> This is the current workaround. I install <code>mypy</code> solely to run <code>stubgen -p my_package</code>. This introduces a heavy dependency into the build environment that I am otherwise trying to replace.</li>
<li><strong>Hand-writing stubs:</strong> This is error-prone and not feasible for large or rapidly evolving codebases.</li>
</ul>
<h3>Additional context</h3>
<p>This feature is critical for library authors who distribute binary wheels. It aligns with the philosophy of a unified, high-performance toolchain. If <code>ty</code> is handling type checking, it would be highly beneficial if it also handled the generation of the artifacts (stubs) required for that checking to work for end-users of compiled libraries.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">feature</span> added by @carljm on 2025-11-20 04:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @carljm on 2025-11-20 04:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-11-20 04:53</div>
            <div class="timeline-body"><p>Thanks for the suggestion! I'm not necessarily opposed to doing this, but I think we have a lot of things that will come before it on the roadmap, especially considering that &quot;use mypy stubgen&quot; is a pretty workable option, and it's not clear that we can significantly improve on mypy's stubgen.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:43 UTC
    </footer>
</body>
</html>
