<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pyspark ML Vector Asembler: too many cycle iterations - astral-sh/ty #777</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Pyspark ML Vector Asembler: too many cycle iterations</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/777">#777</a>
        opened by <a href="https://github.com/michaelneely">@michaelneely</a>
        on 2025-07-08 09:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/michaelneely">@michaelneely</a></div>
            <div class="timeline-body">Summary
<p>Instantiating a <code>pyspark.ml.feature.VectorAssembler</code> causes a cycle panic.</p>
<p>Reproducible Example:</p>
<pre><code>from pyspark.ml.feature import VectorAssembler

VectorAssembler(
    inputCols=[&quot;col1&quot;, &quot;col2&quot;],
    outputCol=&quot;features&quot;,
)
</code></pre>
<p>Stack Trace:</p>
<pre><code>error[panic]: Panicked at /root/.cargo/git/checkouts/salsa-e6f3bb7c2a062968/fc00eba/src/function/execute.rs:212:25 when checking `/workspace/test.py`: `infer_definition_types(Id(6fd5)): execute: too many cycle iterations`
info: This indicates a bug in ty.
info: If you could open an issue at https://github.com/astral-sh/ty/issues/new?title=%5Bpanic%5D, we&#x27;d be very appreciative!
info: Platform: linux x86_64
info: Args: [&quot;ty&quot;, &quot;check&quot;, &quot;test.py&quot;]
info: Backtrace:
   0: &lt;unknown&gt;
   1: &lt;unknown&gt;
   2: &lt;unknown&gt;
   3: &lt;unknown&gt;
   4: &lt;unknown&gt;
   5: &lt;unknown&gt;
   6: &lt;unknown&gt;
   7: &lt;unknown&gt;
   8: &lt;unknown&gt;
   9: &lt;unknown&gt;
  10: &lt;unknown&gt;
  11: &lt;unknown&gt;
  12: &lt;unknown&gt;
  13: &lt;unknown&gt;
  14: &lt;unknown&gt;
  15: &lt;unknown&gt;
  16: &lt;unknown&gt;
  17: &lt;unknown&gt;
  18: &lt;unknown&gt;
  19: &lt;unknown&gt;
  20: &lt;unknown&gt;
  21: &lt;unknown&gt;
  22: &lt;unknown&gt;
  23: &lt;unknown&gt;
  24: &lt;unknown&gt;
  25: &lt;unknown&gt;
  26: &lt;unknown&gt;
  27: &lt;unknown&gt;
  28: &lt;unknown&gt;
  29: &lt;unknown&gt;
  30: &lt;unknown&gt;
  31: &lt;unknown&gt;
  32: &lt;unknown&gt;
  33: &lt;unknown&gt;
  34: &lt;unknown&gt;
  35: &lt;unknown&gt;
  36: &lt;unknown&gt;
  37: &lt;unknown&gt;
  38: &lt;unknown&gt;
  39: &lt;unknown&gt;
  40: &lt;unknown&gt;
  41: &lt;unknown&gt;
  42: &lt;unknown&gt;
  43: &lt;unknown&gt;
  44: &lt;unknown&gt;
  45: &lt;unknown&gt;
  46: &lt;unknown&gt;
  47: &lt;unknown&gt;
  48: &lt;unknown&gt;
  49: &lt;unknown&gt;
  50: &lt;unknown&gt;
  51: &lt;unknown&gt;
  52: &lt;unknown&gt;
  53: &lt;unknown&gt;
  54: &lt;unknown&gt;
  55: &lt;unknown&gt;
  56: &lt;unknown&gt;
  57: &lt;unknown&gt;
  58: &lt;unknown&gt;
  59: &lt;unknown&gt;
  60: &lt;unknown&gt;
  61: &lt;unknown&gt;
  62: &lt;unknown&gt;
  63: &lt;unknown&gt;
  64: &lt;unknown&gt;
  65: &lt;unknown&gt;
  66: &lt;unknown&gt;
  67: &lt;unknown&gt;
  68: &lt;unknown&gt;
  69: &lt;unknown&gt;
  70: &lt;unknown&gt;
  71: &lt;unknown&gt;
  72: &lt;unknown&gt;
  73: &lt;unknown&gt;
  74: &lt;unknown&gt;
  75: &lt;unknown&gt;
  76: &lt;unknown&gt;
  77: &lt;unknown&gt;
  78: &lt;unknown&gt;
  79: &lt;unknown&gt;
  80: &lt;unknown&gt;
  81: &lt;unknown&gt;
  82: &lt;unknown&gt;
  83: &lt;unknown&gt;
  84: &lt;unknown&gt;
  85: &lt;unknown&gt;
  86: &lt;unknown&gt;
  87: &lt;unknown&gt;
  88: &lt;unknown&gt;
  89: &lt;unknown&gt;
  90: &lt;unknown&gt;
  91: &lt;unknown&gt;
  92: &lt;unknown&gt;
  93: &lt;unknown&gt;
  94: &lt;unknown&gt;
  95: start_thread
  96: __clone

info: query stacktrace:
   0: infer_definition_types(Id(6fd8))
             at crates/ty_python_semantic/src/types/infer.rs:159
   1: place_by_id(Id(3820))
             at crates/ty_python_semantic/src/place.rs:623
   2: Type &lt; &#x27;db &gt;::member_lookup_with_policy_(Id(281d))
             at crates/ty_python_semantic/src/types.rs:583
   3: infer_definition_types(Id(1425))
             at crates/ty_python_semantic/src/types/infer.rs:159
   4: infer_deferred_types(Id(31c5))
             at crates/ty_python_semantic/src/types/infer.rs:198
   5: ClassLiteral &lt; &#x27;db &gt;::explicit_bases_(Id(4411))
             at crates/ty_python_semantic/src/types/class.rs:788
   6: infer_scope_types(Id(1000))
             at crates/ty_python_semantic/src/types/infer.rs:130
   7: check_types(Id(c00))
             at crates/ty_python_semantic/src/types.rs:89
</code></pre>
<p>Python version: Python 3.11.6</p>
Version
<p>ty 0.0.1-alpha.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-08 11:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fatal</span> added by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-08 11:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-08 11:43</div>
            <div class="timeline-body"><p>Thank you for reporting this. <a href="https://spark.apache.org/docs/latest/api/python/_modules/pyspark/ml/feature.html#VectorAssembler"><code>VectorAssembler</code></a> recursively inherits from a generic class that takes <code>VectorAssembler</code> itself as a paramter (CRTP-style), so this looks like a duplicate of #256</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-08 11:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:25:00 UTC
    </footer>
</body>
</html>
