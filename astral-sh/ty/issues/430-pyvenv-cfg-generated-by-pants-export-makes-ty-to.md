```yaml
number: 430
title: "pyvenv.cfg generated by `pants export` makes ty to fail"
type: issue
state: closed
author: achimnol
labels:
  - bug
  - help wanted
  - imports
assignees: []
created_at: 2025-05-16T19:35:10Z
updated_at: 2025-05-17T06:42:40Z
url: https://github.com/astral-sh/ty/issues/430
synced_at: 2026-01-12T15:54:23Z
```

# pyvenv.cfg generated by `pants export` makes ty to fail

---

_@achimnol_

### Summary

When using [Pantsbuild](https://www.pantsbuild.org/), I use `pants export` to auto-create virtualenvs for a dependency set.
The virtualenv created by it contains `pyvenv.cfg` like:
```dosini
home = /home/joongi/.pyenv/versions/3.13.3/bin
include-system-site-packages = false
version = 3.13.3
prompt = 'python-default/3.13.3'
executable = /home/joongi/.pyenv/versions/3.13.3/bin/python3.13
command = /home/joongi/.pyenv/versions/3.13.3/bin/python3.13 -m venv --without-pip --prompt="python-default/3.13.3" /home/joongi/bai-edge/dist/export/python/virtualenvs/python-default/3.13.3
```

After activating this virtualenv, `uvx ty check` currently fails with:
```
ty failed
  Cause: Invalid search path settings
  Cause: Failed to discover the site-packages directory: Failed to parse the pyvenv.cfg file at /home/joongi/bai-edge/dist/export/python/virtualenvs/python-default/3.13.3/pyvenv.cfg because line 6 has too many '=' characters
```

If I apply the following patch to `pyvenv.cfg`, replacing `=` with a space in the `command`'s arguments:
```diff
@@ -3,4 +3,4 @@
 version = 3.13.3
 prompt = 'python-default/3.13.3'
 executable = /home/joongi/.pyenv/versions/3.13.3/bin/python3.13
-command = /home/joongi/.pyenv/versions/3.13.3/bin/python3.13 -m venv --without-pip --prompt="python-default/3.13.3" /home/joongi/bai-edge/dist/export/python/virtualenvs/python-default/3.13.3
+command = /home/joongi/.pyenv/versions/3.13.3/bin/python3.13 -m venv --without-pip --prompt "python-default/3.13.3" /home/joongi/bai-edge/dist/export/python/virtualenvs/python-default/3.13.3
```
`uvx ty check` runs fine.

Since Python works without any issue with this virtualenv, `ty`'s `pyvenv.cfg` parsing should allow this case as well.


### Version

ty 0.0.1-alpha.4

---

_Label `imports` added by @AlexWaygood on 2025-05-16 19:36_

---

_Label `bug` added by @zanieb on 2025-05-16 20:16_

---

_Comment by @zanieb on 2025-05-16 20:16_

Thanks for the report!

---

_Comment by @AlexWaygood on 2025-05-16 20:45_

Thanks for the report! I guess we might just want to get rid of this check altogether? https://github.com/astral-sh/ruff/blob/3d55a16c916d1b89d9d4226d57dcaa11338b04a1/crates/ty_python_semantic/src/site_packages.rs#L135-L142

---

_Label `help wanted` added by @MichaReiser on 2025-05-16 20:53_

---

_Closed by @MichaReiser on 2025-05-17 06:42_

---
