<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Source tarballs missing ruff/ - astral-sh/ty #372</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Source tarballs missing ruff/</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/372">#372</a>
        opened by <a href="https://github.com/WhyNotHugo">@WhyNotHugo</a>
        on 2025-05-13 23:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/WhyNotHugo">@WhyNotHugo</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>The source tarballs (e.g.: https://github.com/astral-sh/ty/releases/download/0.0.1-alpha.1/source.tar.gz) contain an empty <code>ruff</code> directory.</p>
<p>These tarballs don't look like GitHub's auto-generated ones. Are these the correct ones to use for downstream packages?</p>
<h3>Version</h3>
<p>ty-0.0.1-alpha.1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WhyNotHugo">@WhyNotHugo</a> on 2025-05-13 23:19</div>
            <div class="timeline-body"><p>In the original repo, <code>ruff/</code> is a submodule. I think maybe when exporting the tarball the submodule is not previously initialised?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by @AlexWaygood on 2025-05-13 23:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-14 02:21</div>
            <div class="timeline-body"><p>Ah that's unfortunate. @Gankra noted this was a possibility. We can follow-up here, I'm not sure where those tarballs are generated off the top of my head.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-05-14 09:10</div>
            <div class="timeline-body"><p>Looking into it, but worth noting that if the github ones work fine the other ones can be ignored -- they're intended to be conceptually identical, the other ones uploaded are a future-proofing thing in case we ever support uploading to a different host than github releases (so we're not dependent on it for the source tarballs).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-05-14 09:13</div>
            <div class="timeline-body"><p>Hmm, the github auto-generated ones look identical? (both contain an empty <code>ruff</code> dir)</p>
<ul>
<li>uploaded: https://github.com/astral-sh/ty/releases/download/0.0.1-alpha.1/source.tar.gz</li>
<li>github generated: https://github.com/astral-sh/ty/archive/refs/tags/0.0.1-alpha.1.tar.gz</li>
</ul>
<p>(This would make sense, both are using git's builtin support for generating a source tarball -- <code>git archive</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-05-14 09:18</div>
            <div class="timeline-body"><p>Initial search suggests that there's no way to ask github to do anything useful here, but we can potentially add a feature to cargo-dist to mess around and force this to be better for our uploaded archives. We definitely aren't the first project to have this problem though -- I'd be interested to hear what distro maintainers do with these kinds of source archives.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WhyNotHugo">@WhyNotHugo</a> on 2025-05-14 10:13</div>
            <div class="timeline-body"><p>You can't do anything about the GitHub generated ones. There are many projects (including a couple which I maintain myself) which simply indicate &quot;don't use the auto-generated GitHub tarballs, they're useless&quot;.</p>
<p>It's the uploaded source.tar.gz ones which can potentially be fixed. I don't think git-archive itself can handle submodules, but I have found <a href="https://github.com/Kentzo/git-archive-all">some</a> <a href="https://github.com/fabacab/git-archive-all.sh/wiki">tools</a> which do this for you.</p>
<p>I haven't tested them to confirm whether the tarballs are reproducible. If you intend on keeping only a single submodule, then publishing a second git-archive tarball for it might be the simplest thing to do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-06-12 14:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:19:52 UTC
    </footer>
</body>
</html>
