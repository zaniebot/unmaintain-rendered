<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>numpy percentile &quot;It doesn't have an __iter__ method or a __getitem__ method info: rule not-iterable is enabled by default&quot; - astral-sh/ty #1025</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>numpy percentile &quot;It doesn't have an __iter__ method or a __getitem__ method info: rule not-iterable is enabled by default&quot;</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1025">#1025</a>
        opened by <a href="https://github.com/Gabriel-p">@Gabriel-p</a>
        on 2025-08-17 12:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Gabriel-p">@Gabriel-p</a> on 2025-08-17 12:32</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Running the code below with <code>uvx ty check temp.py</code> (brought from https://github.com/numpy/numpy/issues/29573)</p>
<h3>Reproduce the code example:</h3>
<pre><code class="language-python">import numpy as np

x = np.random.uniform(0, 100, 1000)

for pm in np.percentile(x, (10, 20, 30)):
    print(pm)

for pm in np.nanpercentile(x, (10, 20, 30)):
    print(pm)

p_75, p_85, p_95 = np.percentile(x, (75, 85, 95))

dim_x = np.percentile(x, (1, 99))
print(dim_x[0])
</code></pre>
<h3>Error message:</h3>
<pre><code class="language-shell">error[not-iterable]: Object of type `floating[Any]` is not iterable
 --&gt; temp.py:6:11
  |
4 | x = np.random.uniform(0, 100, 1000)
5 |
6 | for pm in np.percentile(x, (10, 20, 30)):
  |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
7 |     print(pm)
  |
info: It doesn't have an `__iter__` method or a `__getitem__` method
info: rule `not-iterable` is enabled by default

error[not-iterable]: Object of type `floating[Any]` is not iterable
  --&gt; temp.py:9:11
   |
 7 |     print(pm)
 8 |
 9 | for pm in np.nanpercentile(x, (10, 20, 30)):
   |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
10 |     print(pm)
   |
info: It doesn't have an `__iter__` method or a `__getitem__` method
info: rule `not-iterable` is enabled by default

error[not-iterable]: Object of type `floating[Any]` is not iterable
  --&gt; temp.py:12:20
   |
10 |     print(pm)
11 |
12 | p_75, p_85, p_95 = np.percentile(x, (75, 85, 95))
   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
info: It doesn't have an `__iter__` method or a `__getitem__` method
info: rule `not-iterable` is enabled by default

error[non-subscriptable]: Cannot subscript object of type `floating[Any]` with no `__getitem__` method
  --&gt; temp.py:16:7
   |
15 | dim_x = np.percentile(x, (1, 99))
16 | print(dim_x[0])
   |       ^^^^^
   |
info: rule `non-subscriptable` is enabled by default
</code></pre>
<h3>Python and NumPy Versions:</h3>
<p>2.2.4
3.11.11 (main, Feb  5 2025, 19:11:07) [Clang 19.1.6 ]</p>
<h3>Version</h3>
<p>ty 0.0.1-alpha.18</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-08-17 12:38</div>
            <div class="timeline-body"><p>Thanks for the report! The reason why we're inferring the wrong thing here is that numpy is using overloads where the arguments are annotated using type aliases. We're picking the wrong overload because we have only very limited support for type aliases right now. TL;DR, this is the same issue as https://github.com/astral-sh/ty/issues/221 :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2025-08-17 12:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:24 UTC
    </footer>
</body>
</html>
