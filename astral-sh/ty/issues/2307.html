<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature: Auto Format F-strings - astral-sh/ty #2307</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature: Auto Format F-strings</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/2307">#2307</a>
        opened by <a href="https://github.com/AndBoyS">@AndBoyS</a>
        on 2026-01-02 19:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AndBoyS">@AndBoyS</a></div>
            <div class="timeline-body"><p>Add an option to LSP: prefix string with f if <code>{</code> is typed inside a string (like in <a href="https://github.com/DetachHead/basedpyright/issues/280">DetachHead/basedpyright#280</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2026-01-02 20:30</div>
            <div class="timeline-body"><p>As a basedpyright user, this can be very nice, but can also be very annoying at times. If this does get implemented into ty, one change that would be very nice is not making the string an f-string if it has existing <code>{}</code>s in it (so in the string <code>&quot;&quot;</code> typing <code>{</code> at the end would turn it into <code>f&quot;{}&quot;</code>, while in the string <code>&quot;{}&quot;</code> typing <code>&quot;{&quot;</code> would leave it as a normal string)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by <a href="https://github.com/mtshiba">@mtshiba</a> on 2026-01-02 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-03 10:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2026-01-05 10:16</div>
            <div class="timeline-body"><p>This is available in Ruff using https://docs.astral.sh/ruff/rules/missing-f-string-syntax/ which is in <a href="https://docs.astral.sh/ruff/preview/">preview</a>. Once you turn on preview rules, the LSP should also provide you with a code action to fix this but (I think?) this will require turning on <a href="https://docs.astral.sh/ruff/settings/#unsafe-fixes">unsafe fixes</a> as the fix is unsafe.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeGaGiGaGon">@MeGaGiGaGon</a> on 2026-01-05 17:26</div>
            <div class="timeline-body"><p>That&#x27;s similar but not exactly it - with how basedpyright does it there&#x27;s no need to apply a code action, it does the change at the same time as you type the <code>{</code>:</p>
<p>https://github.com/user-attachments/assets/e5ff3d9b-af0d-4284-b76a-1435b559a299</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-05 17:30</div>
            <div class="timeline-body"><p>I really wouldn&#x27;t want that, personally. There are lots of strings that contain <code>{}</code> in them but aren&#x27;t necessarily meant to be f-strings. That&#x27;s why https://docs.astral.sh/ruff/rules/missing-f-string-syntax/ is still in preview: it&#x27;s really difficult to know for sure whether a string with <code>{}</code> is meant to be an f-string or not! The Ruff rule has too many false positives to be considered stable, and it&#x27;s hard to know how to improve it (I put up <a href="https://github.com/astral-sh/ruff/pull/13076">astral-sh/ruff#13076</a> ages ago, but I&#x27;m unlikely to get back to it any time soon)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-05 17:34</div>
            <div class="timeline-body"><p>I find this a reasonable opt-in feature. I certainly wouldn&#x27;t enable it by default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2026-01-06 11:02</div>
            <div class="timeline-body"><blockquote>
<p>That&#x27;s similar but not exactly it - with how basedpyright does it there&#x27;s no need to apply a code action, it does the change at the same time as you type the <code>{</code>:</p>
</blockquote>
<p>Interesting! My guess would be that this is done using <code>textDocument/onTypeFormatting</code> (<a href="https://github.com/astral-sh/ruff/issues/16829">astral-sh/ruff#16829</a>).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:53 UTC
    </footer>
</body>
</html>
