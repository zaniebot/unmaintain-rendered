<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add memory usage report to the LSP - astral-sh/ty #974</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add memory usage report to the LSP</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/974">#974</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-08-12 13:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><p>ty's CLI emits a detailed memory usage report when run with <code>TY_MEMORY_REPORT=full</code>. It would be great to have a similar command for the LSP that prints debug information, which also includes the memory report.</p>
<p>Ruff's LSP has something similar: https://github.com/astral-sh/ruff/blob/015222900f16ae3100b3415e1b6be44aed867e4b/crates/ruff_server/src/server/api/requests/execute_command.rs#L46-L57</p>
<p>This would be useful when debugging how adding an LRU cache improves memory usage over time</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @MichaReiser on 2025-08-12 13:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @MichaReiser on 2025-08-12 13:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-13 04:53</div>
            <div class="timeline-body"><p>Relevant VS Code extension issue: https://github.com/astral-sh/ty-vscode/issues/6</p>
<p>And, the implementation in Ruff VS Code extension: https://github.com/astral-sh/ruff-vscode/blob/3d052e6b11421e510264c01cf0e3a43b33595560/src/extension.ts#L200-L203</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2025-08-13 04:57</div>
            <div class="timeline-body"><p>Maybe we should make this a custom request instead of a command. Rust-analyzer uses a separate request endpoint e.g., https://rust-analyzer.github.io/book/contributing/lsp-extensions.html#analyzer-status, https://github.com/rust-lang/rust-analyzer/blob/master/docs/book/src/contributing/lsp-extensions.md#view-syntax-tree, etc. although I'm not sure which one is more beneficial.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-20 11:05</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/ruff/pull/20379 added the custom command. What's now left to do is to expose the command in VS code.</p>
<p>@Guillaume-Fgt: Are you also interested in contributing the necessary VS code changes:</p>
<ol>
<li>Adding the command in the <code>package.json</code> (<a href="https://github.com/astral-sh/ruff-vscode/blob/67f5c516ae2175a32a468aaaa05a614344230ad0/package.json#L447-L451">source</a>)</li>
<li>Add a handler that automatically opens a window in VS code (<a href="https://github.com/astral-sh/ruff-vscode/blob/67f5c516ae2175a32a468aaaa05a614344230ad0/src/common/commands.ts#L1-L124">source</a>)</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Guillaume-Fgt">@Guillaume-Fgt</a> on 2025-09-20 11:41</div>
            <div class="timeline-body"><p>As I said in the PR, yes I am. I will work on it üëç.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @Guillaume-Fgt by @MichaReiser on 2025-09-20 11:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-09-20 11:47</div>
            <div class="timeline-body"><p>Thank you. The code for the VS code extension is here https://github.com/astral-sh/ty-vscode</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2025-09-22 11:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:20:26 UTC
    </footer>
</body>
</html>
