<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generic classes with dynamic types (e.g. `A[Unknown]`) should not be considered fully static - astral-sh/ty #131</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Generic classes with dynamic types (e.g. <code>A[Unknown]</code>) should not be considered fully static</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/131">#131</a>
        opened by <a href="https://github.com/cake-monotone">@cake-monotone</a>
        on 2025-04-10 04:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/cake-monotone">@cake-monotone</a></div>
            <div class="timeline-body"><p>https://playknot.ruff.rs/73be425a-e02f-425f-b4dd-4eb70eb3fe8e</p>
<pre><code>from knot_extensions import is_fully_static, static_assert, TypeOf
from typing import reveal_type

class A[T]: ...

a_unknown = A()
reveal_type(a_unknown)  # revealed: A[Unknown]

static_assert(not is_fully_static(A))
static_assert(not is_fully_static(TypeOf[a_unknown]))
</code></pre>

Outdated

<p>https://playknot.ruff.rs/e59ddd94-b32c-4275-b038-42a1f8fc1823</p>
<pre><code>from knot_extensions import is_subtype_of, static_assert, TypeOf
from typing import reveal_type

class A[T]: ...

a_unknown = A()
a_int = A[int]()

reveal_type(a_unknown)  # revealed: A[Unknown]
reveal_type(a_int)  # revealed: A[int]

static_assert(is_subtype_of(A[int], A))
static_assert(is_subtype_of(TypeOf[a_int], TypeOf[a_unknown]))
</code></pre>
<p>It seems like there&#x27;s not yet proper support for subtype relationships in this case.
Considering the Liskov Substitution Principle, I guess <code>A[int]</code> should be a subtype of <code>A[Unknown]</code>.</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-04-10 10:45</div>
            <div class="timeline-body"><p>I don&#x27;t think <code>A[int]</code> should be considered a subtype of <code>A[Unknown]</code> because <code>A[Unknown]</code> isn&#x27;t a fully static type, so it doesn&#x27;t participate in subtyping at all. https://typing.python.org/en/latest/spec/concepts.html# is the long article in the typing spec describing all this in depth -- https://typing.python.org/en/latest/spec/glossary.html#term-subtype, https://typing.python.org/en/latest/spec/glossary.html#term-assignable, and https://typing.python.org/en/latest/spec/glossary.html#term-fully-static-type are some slightly shorter definitions</p>
<p><code>A[int]</code> <em>should</em> be considered <em>assignable</em> to <code>A[Unknown]</code>, however!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cake-monotone">@cake-monotone</a> on 2025-04-10 11:37</div>
            <div class="timeline-body"><p>Ah..! Thanks for your kind answer. That insight was really helpful :)
I see now. the issue must be that <code>A[Unknown]</code> isn&#x27;t considered a fully static. (even though the subtype is still false) I mistakenly thought that <code>A</code> (with generic) would still be fully static.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cake-monotone">@cake-monotone</a> on 2025-04-10 11:43</div>
            <div class="timeline-body"><p>Hmm, Iâ€™ll update this issue to focus on fully static rather than subtype</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cake-monotone">@cake-monotone</a> on 2025-04-10 11:45</div>
            <div class="timeline-body"><p>For now, <code>is_fully_static(A[Unknown])</code> is true; it should be false</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-04-10 11:47</div>
            <div class="timeline-body"><p>(cc. @dcreager who has been leading our work on generics recently)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[red-knot] Add proper `is_subtype_of` support for generic classes&quot; to &quot;[red-knot] Generic classes with dynamic types (e.g. `A[Unknown]`) should not be considered fully static&quot; by <a href="https://github.com/cake-monotone">@cake-monotone</a> on 2025-04-10 11:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[red-knot] Generic classes with dynamic types (e.g. `A[Unknown]`) should not be considered fully static&quot; to &quot;Generic classes with dynamic types (e.g. `A[Unknown]`) should not be considered fully static&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-07 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-10 18:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">generics</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-10 18:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">type properties</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-11 07:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-07-01 06:41</div>
            <div class="timeline-body"><p>I don&#x27;t think this is relevant anymore, now that <code>is_fully_static</code> is gone.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/carljm">@carljm</a> on 2025-07-01 06:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:09 UTC
    </footer>
</body>
</html>
