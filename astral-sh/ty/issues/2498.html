<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Some hover blocks are not always valid Python source - astral-sh/ty #2498</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Some hover blocks are not always valid Python source</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/2498">#2498</a>
        opened by <a href="https://github.com/rchl">@rchl</a>
        on 2026-01-14 19:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rchl">@rchl</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Code snippet displayed in the hover popups is not always a valid python source code. Some editors have more lenient syntax highlighting that makes it not really an issue, other have more strict highlighting that will introduce red error highlighting to indicate that the code is not valid. For example in ST we get something like this in some cases:</p>
<p><img width="698" height="215" alt="Image" src="https://github.com/user-attachments/assets/08f69ac5-f2da-4fe9-a3d5-ddcbb75070d3" /></p>
<p>Perhaps <code>ty</code> can tell whether the snippet is a valid code or not and based on that return either a python code block or plain text code block?</p>
<h3>Version</h3>
<p>0.0.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @AlexWaygood on 2026-01-14 20:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2026-01-15 05:15</div>
            <div class="timeline-body"><p>I think we use the <code>xml</code> language tag for such code blocks, I see the following hover content in Neovim:</p>
<pre><code>```xml
&lt;module 'collections.abc'&gt;
```
</code></pre>
<p>Is it that your editor's syntax highlighting doesn't support XML tags correctly? Can you try opening a XML file with the above content and see how does your editor highlight that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-15 07:51</div>
            <div class="timeline-body"><p>The issue is that an attribute without a name isn't valid in XML. So the editor's highlighting is correct. It's also not valid in any other XML like dialect that I'm aware of (HTML, JSX).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2026-01-15 07:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @MichaReiser on 2026-01-15 07:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rchl">@rchl</a> on 2026-01-15 07:57</div>
            <div class="timeline-body"><p>Right, I've assumed the part about using python code block. But yeah, still not a valid source for chosen code block language.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-15 08:00</div>
            <div class="timeline-body"><p>It's unfortunate that an LSP can't ship a custom syntax (at least to my knowledge)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-15 08:50:12 UTC
    </footer>
</body>
</html>
