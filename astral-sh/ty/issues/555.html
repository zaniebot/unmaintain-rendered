<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issues detecting unbound variables defined in the loops - astral-sh/ty #555</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Issues detecting unbound variables defined in the loops</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/555">#555</a>
        opened by <a href="https://github.com/Andrej730">@Andrej730</a>
        on 2025-05-30 18:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Andrej730">@Andrej730</a></div>
            <div class="timeline-body">Summary
<p>Noticed two kind of issues:</p>
<ol>
<li>Possibly unbound variable reported as not defined, not as &quot;possibly unbounded&quot;, which may create a bit of confusion.
https://play.ty.dev/99dfb31f-ac48-42cb-ae09-f9409534c4fc
Also could be related to #162</li>
</ol>
<pre><code>d = [(x := i) for i in range(5)]
reveal_type(d)
# error[unresolved-reference]: Name `x` used when not defined
print(x)
</code></pre>
<ol>
<li>Same case but with for-loop - it doesn&#x27;t detect variable neither as possibly unbound / undefined reference
https://play.ty.dev/8c5a457c-02ef-4c3b-91d1-47686ad1a50d</li>
</ol>
<pre><code>for i in range(5):
    x = i
# All checks passed!
print(x)
</code></pre>
Version
<p>ty 0.0.1-alpha.7 (afb20f6fe 2025-05-26)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-30 20:11</div>
            <div class="timeline-body"><p>Thanks! Your first issue is indeed a duplicate of #162, as you say.</p>
<p>Your second issue is a totally different topic. We do emit an error on this snippet if you enable our <code>possibly-unresolved-reference</code> error code: https://play.ty.dev/b4a24adb-681a-419c-8d08-17f1d1401c54. The error code is currently disabled by default -- you have to opt into it -- because it still has some false positives right now that we&#x27;re working on fixing. We hope to promote it to enabled-by-default before we release a stable version of ty.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-30 20:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-30 20:15</div>
            <div class="timeline-body"><p>Unfortunately the nature of <code>possibly-unresolved-reference</code> is such the number of false positives may always be too high to have it be enabled by default, however. There are a lot of ways you can write quite dynamic code which this kind of check would struggle to understand. If we had it be enabled by default, it would probably lead to lots of user complaints regarding false positives, sadly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-05-30 20:16</div>
            <div class="timeline-body"><p>Example case that no current type checker understands (and we don&#x27;t have any current plans to either) where this diagnostic leads to false positives:</p>
<pre><code>if flag:
    a = 1
...
if flag:
    use(a)
</code></pre>
<p>We provide the diagnostic, so that if you prefer to avoid this kind of code pattern you can opt in to it. But it&#x27;s disabled by default because we don&#x27;t want to emit false positives on working code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Andrej730">@Andrej730</a> on 2025-05-31 05:55</div>
            <div class="timeline-body"><p>Thank you, here goes the start of my <code>ty.toml</code> üòÅ</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:43 UTC
    </footer>
</body>
</html>
