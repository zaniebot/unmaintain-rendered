<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quoted type aliases not understood - astral-sh/ty #846</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Quoted type aliases not understood</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/846">#846</a>
        opened by <a href="https://github.com/sterliakov">@sterliakov</a>
        on 2025-07-17 21:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sterliakov">@sterliakov</a></div>
            <div class="timeline-body">Summary
<p>Check the following code:</p>
<pre><code>from typing import TypeAlias

Foo: TypeAlias = &quot;int | str&quot;
Bar: TypeAlias = int | str

x: Foo = 0  # Fails
y: Bar = 0  # OK
</code></pre>
<p>Output of <code>uvx ty check a.py --output-format concise</code> (without any config files, in a fresh <code>mktemp -d</code> with the above snippet cat&#x27;d into <code>a.py</code>):</p>
<pre><code>error[invalid-type-form] a.py:6:4: Variable of type `Literal[&quot;int | str&quot;]` is not allowed in a type expression
Found 1 diagnostic
</code></pre>
<p><a href="https://play.ty.dev/3c4a53d0-9a1e-41ed-889c-196333bbe242">playground link</a></p>
<p>As per <a href="https://typing.python.org/en/latest/spec/aliases.html#typealias">the spec</a>, quotes should be ignored in the RHS, it is not a literal definition:)</p>
<p>This isn&#x27;t a toy problem - quoted RHS is the most convenient way to define a recursive alias (at least prior to PEP695, but I&#x27;d personally use this on 3.12+ too) or make it dependent on <code>TYPE_CHECKING</code>-only imports.</p>
<pre><code>Foo: TypeAlias = &quot;int | Iterable[Foo]&quot;
</code></pre>
Version
<p>0.0.1-alpha.14</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-18 06:49</div>
            <div class="timeline-body"><p>Thank you for reporting this. We do not support <code>typing.TypeAlias</code> yet, see <a href="https://github.com/astral-sh/ty/issues/544">astral-sh/ty#544</a>. Once we do, it will also (automatically) support stringified annotations.</p>
<p>Stringified annotations are already supported in other places where type expressions are expected: https://play.ty.dev/5dbc7ee3-7b68-4498-9424-224baad866a1</p>
<pre><code>type IntOrStr = &quot;int | str&quot;

def _(x: &quot;int | str&quot;, y: IntOrStr):
    reveal_type(x)  # int | str
    reveal_type(y)  # int | str

    x = 1
    y = 1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-07-18 06:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-11-20 00:21</div>
            <div class="timeline-body"><p>Confirmed that this will be fixed by <a href="https://github.com/astral-sh/ruff/pull/21394">astral-sh/ruff#21394</a></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:25:05 UTC
    </footer>
</body>
</html>
