<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuration - astral-sh/ty #219</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Configuration</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/219">#219</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2025-01-15 09:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><p>Support configuring Red Knot in a persistent configuration:</p>
<ul>
<li>[x] Configuration in the project&#x27;s <code>pyproject.toml</code> or <code>knot.toml</code>.</li>
<li>[ ] Configuration sections:<ul>
<li>[x] <code>rules</code>: enable and disable rules</li>
<li>[x] <code>environment</code>: (python version, platform, search paths)</li>
<li>[x] <code>files</code>: Override a sub-set of settings on a path level</li>
<li>[x] <code>src</code>: Which files should be considered first-party and what&#x27;s the src root</li>
<li>[x] <code>terminal</code>: Configure color output, etc.</li>
<li>[x] root options (for now, only <code>respect-ignore-files</code>)</li>
<li>[x] <code>requires-python</code> (I&#x27;m leaning towards just making it a field on <code>ProjectMetadata</code> because we only respect the <code>requires-python</code> constraint in the project&#x27;s configuration file)</li>
</ul>
</li>
<li>[x] Path anchoring in configuration files (relative paths are relative to the current working directory, the configuration file, or the project root)</li>
<li>[x] Track the source of a configuration value for better error reporting: E.g. clippy tells you why a rule is enabled. Is it because the rule is enabled by default or because you enabled it in the configuration or in the CLI? Ideally, we&#x27;d have this for all options so that we can refer users to the right configuration file if we detect an invalid setting.</li>
<li>[x] User-level configuration</li>
<li>[x] Support overriding configuration options from the CLI</li>
<li>[ ] Hierarchical configuration (<code>knot.toml</code> in any ancestor directory)</li>
<li>[x] Generate a JSON schema</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/MichaReiser">@MichaReiser</a> by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-15 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2025-01-21 08:17</div>
            <div class="timeline-body"><p>Note mypy has gotten some use of being able to configure things on a module level, not path level. In particular, this works well for settings related to specific dependencies (e.g. ignoring them or ignoring their possible non-existence or ignoring PEP 561 warnings or setting implicit export behaviour etc etc)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-01-21 08:25</div>
            <div class="timeline-body"><p>Interesting. Overall, we don&#x27;t plan on emitting warnings for third-party code (we don&#x27;t check third party code). Allowing non-existent modules is its own setting that only takes module names and the same is probably true for PEP 561. I&#x27;d have to look into implicit export behavior more closely.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[red-knot] Persistent configuration&quot; to &quot;[red-knot] Configuration&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-03-14 09:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thejchap">@thejchap</a> on 2025-04-22 12:31</div>
            <div class="timeline-body"><p>@carljm @MichaReiser are any of these decent candidates for an outside contributor? I&#x27;d be interested in picking one or two up - perhaps file inclusion/exclusion?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-22 12:33</div>
            <div class="timeline-body"><p>There&#x27;s some design work left around file inclusion/exclusion, which makes it a not so good external contributor task. The same is true for <code>files</code>. The only one left is <code>respect-ignore-files</code> but that&#x27;s sort of trivial and probably not very interesting :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thejchap">@thejchap</a> on 2025-04-22 13:34</div>
            <div class="timeline-body"><p>@MichaReiser trivial and uninteresting sounds like a good first issue :) don&#x27;t think I see a subtask for that one - if you want to provide some quick context here or in a subtask I&#x27;ll get a PR up</p>
<p>Also in general this is a project I&#x27;m interested in - if other things are ready for execution feel free to tag me</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-04-23 06:52</div>
            <div class="timeline-body"><p>The basic idea is to add a <code>--respect-ignore-files</code> CLI and <code>knot.respect-ignore-files</code> setting which controls whether <code>walker.standard_filters</code> is set to true or false in</p>
<p>https://github.com/astral-sh/ruff/blob/c4578162d555a1555d4c7719272dbac5ebaaef17/crates/red_knot_project/src/walk.rs#L137</p>
<p>The behavior should be similar to https://github.com/astral-sh/ruff/blob/a192d96880399413432a0316e24ce7982cbc3cb2/crates/ruff_workspace/src/resolver.rs#L486-L487</p>
<p>A slightly more involved feature would be <a href="https://github.com/astral-sh/ty/issues/218">astral-sh/ty#218</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-04-24 00:45</div>
            <div class="timeline-body"><p>@thejchap you can also look for issues tagged <code>help-wanted</code> -- looks like currently we are short of those (thanks to a lot of helpful contributors!) but I&#x27;ll try to keep an eye out for new issues we could tag that way.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;[red-knot] Configuration&quot; to &quot;Configuration&quot; by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-05-07 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-05-11 07:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-18 14:16</div>
            <div class="timeline-body"><p>I&#x27;ll close this as completed. We can track the other changes in the corresponding issues.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2025-06-18 14:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:24:18 UTC
    </footer>
</body>
</html>
