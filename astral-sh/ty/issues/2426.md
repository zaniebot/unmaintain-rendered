```yaml
number: 2426
title: "ty thinks `Generator[None, None, A]` and `Generator[None, None, B]` are equivalent types on Python <3.13"
type: issue
state: open
author: carljm
labels:
  - bug
  - generics
  - Protocols
  - async
assignees: []
created_at: 2026-01-09T21:20:22Z
updated_at: 2026-01-09T21:29:21Z
url: https://github.com/astral-sh/ty/issues/2426
synced_at: 2026-01-10T01:56:41Z
```

# ty thinks `Generator[None, None, A]` and `Generator[None, None, B]` are equivalent types on Python <3.13

---

_Issue opened by @carljm on 2026-01-09 21:20_

```py
from ty_extensions import is_equivalent_to, is_subtype_of, static_assert
from typing import Generator

class A: ...
class B: ...

static_assert(not is_equivalent_to(Generator[None, None, A], Generator[None, None, B]))
static_assert(not is_subtype_of(Generator[None, None, A], Generator[None, None, B]))
static_assert(not is_subtype_of(Generator[None, None, B], Generator[None, None, A]))
```

https://play.ty.dev/0cd14b68-645f-461b-896a-31f78cc10b6c

The assertions here should pass. They do pass on Python 3.13+, but fail on Python 3.12 or older.

The reason is that `Generator` is a protocol, and its third type parameter (`ReturnT_co`) is unused in its interface (as defined in typeshed) in Python earlier than 3.13.

As far as the definition given in typeshed, I think ty's conclusion here is correct. But generators are rather special, specifically in that their "return" value also gets wrapped into the `StopIteration` exception that ends their iteration (even on 3.12 and earlier), but this is not visible in their type system interface. Thus their `ReturnT_co` always matters (quite a lot -- this is the key mechanism by which async/await works), but typeshed's definition doesn't make that explicit.

I think we will probably need to special-case this type somehow to understand that its `ReturnT_co` always matters, even on older Python versions.

---

_Renamed from "ty thinks `Generator[None, None, A]` and `Generator[None, None, B]` are equivalent types" to "ty thinks `Generator[None, None, A]` and `Generator[None, None, B]` are equivalent types on Python <3.13" by @carljm on 2026-01-09 21:23_

---

_Label `generics` added by @carljm on 2026-01-09 21:27_

---

_Label `Protocols` added by @carljm on 2026-01-09 21:27_

---

_Label `bug` added by @carljm on 2026-01-09 21:28_

---

_Label `async` added by @carljm on 2026-01-09 21:28_

---

_Added to milestone `Pre-stable 1` by @carljm on 2026-01-09 21:29_

---
