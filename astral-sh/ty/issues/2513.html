<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing diagnostics when parsing `NamedTuple()` and `namedtuple()` calls - astral-sh/ty #2513</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Missing diagnostics when parsing <code>NamedTuple()</code> and <code>namedtuple()</code> calls</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2513">#2513</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2026-01-15 12:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><p>All of the following calls are clearly invalid, but ty currently doesn&#x27;t emit any diagnostics for them:</p>
<pre><code>import collections
from typing import NamedTuple

Y = collections.namedtuple(&quot;Y&quot;)

Foo = NamedTuple(&quot;Foo&quot;)
Bar = NamedTuple(&quot;Bar&quot;, [&quot;a&quot;, &quot;b&quot;])
Baz = NamedTuple(&quot;Baz&quot;, [(&quot;foo&quot;, 123), (&quot;bar&quot;, 123)])
Spam = NamedTuple(&quot;Spam&quot;, &quot;definitely not valid&quot;)
</code></pre>
<p>I think for <code>typing.NamedTuple</code> we should in fact have <em>very</em> strict parsing. The only reason why you&#x27;d use <code>typing.NamedTuple</code> over <code>collections.namedtuple</code> is because you want precise type inference from your type checker. So while I think we should continue to <em>not</em> emit an error any of these:</p>
<pre><code>from collections import namedtuple

def f(*args, **kwargs):
    B = namedtuple(&quot;B&quot;, *args)
    C = namedtuple(&quot;C&quot;, &quot;a b c&quot;, *args)
    D = namedtuple(*args, **kwargs)
    E = namedtuple(&quot;E&quot;, *args, **kwargs)
    F = namedtuple(&quot;F&quot;, &quot;a b c&quot;, *args, **kwargs)
</code></pre>
<p>I think we should emit an error on all of these (we should ban variadic and keyword-variadic arguments entirely in calls):</p>
<pre><code>from typing import NamedTuple

def f(*args, **kwargs):
    B = NamedTuple(&quot;B&quot;, *args)
    C = NamedTuple(&quot;C&quot;, [(&quot;a&quot;, int), (&quot;b&quot;, str)], *args)
    D = NamedTuple(*args, **kwargs)
    E = NamedTuple(&quot;E&quot;, *args, **kwargs)
    F = NamedTuple(&quot;F&quot;, [(&quot;a&quot;, int), (&quot;b&quot;, str)], *args, **kwargs)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;Stable&quot; by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-15 12:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-15 12:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">runtime semantics</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-15 12:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">typing semantics</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-15 12:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">namedtuples</span> added by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-15 12:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-15 18:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:27:09 UTC
    </footer>
</body>
</html>
