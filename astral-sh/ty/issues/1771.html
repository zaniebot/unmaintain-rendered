<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teach the `SymbolVisitor` about more statements and expressions that can define symbols - astral-sh/ty #1771</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Teach the <code>SymbolVisitor</code> about more statements and expressions that can define symbols</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1771">#1771</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-12-05 13:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2025-12-05 13:03</div>
            <div class="timeline-body"><p>The <code>SymbolVisitor</code> in the ty_ide crate is much less exhaustive than the <code>ExportFinder</code> in the ty_python_semantic crate:</p>
<ul>
<li>It does not recognise that <code>type X = int</code> defines a symbol <code>X</code></li>
<li>It does not recognise that <code>for x in range(42)</code> defines a symbol <code>x</code></li>
<li>It does not recognise that <code>case bar:</code> in a <code>match</code> statement will define a symbol <code>bar</code></li>
<li>It does not recognise that <code>with expr as whatever</code> will define a symbol <code>whatever</code></li>
<li>It does not recognise that <code>(y := []).append(42)</code> defines a symbol <code>y</code></li>
<li>(There are more)</li>
</ul>
<p>Most of these are edge cases that won't usually occur in the global scope in well-written Python code. But some of them (e.g. the <code>type X = int</code> case) are reasonable things that could well occur in well-written code. And the most important thing here, in my opinion, is for the two crates to have a consistent understanding of which symbols will be potentially imported by a <code>*</code> import. Currently <code>ty_python_semantic</code> does a much more rigorous job here at attempting to emulate the runtime semantics.</p>
<p>Cc. @BurntSushi</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">server</span> added by @AlexWaygood on 2025-12-05 13:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">completions</span> added by @AlexWaygood on 2025-12-05 13:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 11:41:21 UTC
    </footer>
</body>
</html>
