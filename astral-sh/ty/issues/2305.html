<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>monorepo overrides patterns don't seem to be reported for extension opened to sub-repo - astral-sh/ty #2305</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>monorepo overrides patterns don't seem to be reported for extension opened to sub-repo</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2305">#2305</a>
        opened by <a href="https://github.com/VerdantFox">@VerdantFox</a>
        on 2026-01-02 17:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/VerdantFox">@VerdantFox</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hi, I couldn't find this bug already.</p>
<p>I love this change to add <a href="https://github.com/astral-sh/ty/issues/786">configuration file parameter support</a>. I set up our monorepo to use this feature. We have one configuration file for the monorepo at the root of the project, and we are gradually improving rules for the sub-repos by overriding rules with glob patterns in that file. This works well for our pre-commit hook at the project root, which respects the glob pattern overrides. However, the glob patterns don't seem to work correctly for the VS Code extension when I open a Workspace at a sub-repo level that matches one of the glob patterns. I'm guessing the glob patterns are working relative to the Workspace root, regardless of the <code>ty.toml</code> file existing several parent folders deep.</p>
<p>Example structure:</p>
<pre><code class="language-txt">parent
parent/ty.toml
parent/src/sub_repo
parent/src/sub_repo/file_with_error.py
</code></pre>
<p>Configuration file:</p>
<pre><code class="language-toml">invalid-assignment = &quot;ignore&quot;

[[overrides]]
include = [&quot;parent/src/sub_repo/**&quot;]

[overrides.rules]
invalid-assignment = &quot;error&quot;
</code></pre>
<p>If I open a VS Code workspace at <code>parent</code>, the error in <code>parent/src/sub_repo/file_with_error.py</code> shows as an error, as expected, because of the override. üéâ But if I open a Workspace at <code>parent/src/sub_repo</code> and set the extension to look for the <code>parent/ty.toml</code> config file (by absolute path), the error in <code>parent/src/sub_repo/file_with_error.py</code> is ignored (I assume due to not finding the override relative to the config file). üôÅ</p>
<p>Can I get this working for my use case? Is this a user error?</p>
<h3>Version</h3>
<p>0.0.8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-04 17:29</div>
            <div class="timeline-body"><p>What's the reason for setting the configuration file in the VS Code project? ty should automatically discover the configuration file in the workspace's ancestor directories and use that configuration instead. The difference in that case is that the paths are relative to the configuration file rather than the workspace root.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MichaReiser on 2026-01-04 17:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/VerdantFox">@VerdantFox</a> on 2026-01-06 16:41</div>
            <div class="timeline-body"><p>Yes, actually our setup does work correctly and correctly finds the parent <code>ty.toml</code> file when no configuration parameter is supplied to the VS Code extension. And when doing so, the configuration file properly follows the glob patterns. Thank you for the hint. Closing this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @VerdantFox on 2026-01-06 16:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:21:39 UTC
    </footer>
</body>
</html>
