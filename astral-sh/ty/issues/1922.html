<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Split error for empty function body into its own error code - astral-sh/ty #1922</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Split error for empty function body into its own error code</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/ty/issues/1922">#1922</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2025-12-16 12:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a></div>
            <div class="timeline-body"><p>Pyright allows functions to unsoundly have empty bodies even if they have a non-<code>None</code> return type, and mypy used to allow this too. As a result, we've seen several instances of users being confused by the fact that we do not allow this. For example:</p>
<pre><code class="language-py">def foo() -&gt; int: ...  # error[invalid-return-type]
</code></pre>
<p>It's a deliberate decision from us to be more strict than pyright here, since this function obviously does not return an <code>int</code> at runtime. We already have a <a href="https://github.com/astral-sh/ruff/blob/5b1d3ac9b9c458448e388075945869a4d49296a9/crates/ty_python_semantic/src/types/diagnostic.rs#L2676-L2679">subdiagnostic</a> message that explains the specific conditions in which we do allow functions to have empty bodies. However, splitting this into a separate <code>empty-body</code> error code would allow users who are heavily impacted by this inconsistency to switch it off on their codebase (even just temporarily while they work down the number of errors). This would also match mypy's behaviour (mypy has a dedicated <code>empty-body</code> error code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">diagnostics</span> added by @AlexWaygood on 2025-12-16 12:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Stable" by @carljm on 2025-12-16 14:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maifeeulasad">@maifeeulasad</a> on 2026-01-20 08:47</div>
            <div class="timeline-body"><p>Can I work on this one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-20 08:48</div>
            <div class="timeline-body"><p>@maifeeulasad sure!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @maifeeulasad by @AlexWaygood on 2026-01-20 08:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maifeeulasad">@maifeeulasad</a> on 2026-01-20 13:38</div>
            <div class="timeline-body"><p>Dear @AlexWaygood</p>
<p>I have created an issue upstream in <code>ruff</code>. Which is already linked here. Now waiting for their feedback. Either we can do it like this. Or I can just push my code update the submodule hash, which may become problamatic in future.</p>
<p>Any thought on this??</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2026-01-20 13:46</div>
            <div class="timeline-body"><p>hey @maifeeulasad -- sorry for the confusion! All the source code for ty is found in the Ruff respository, so to fix this issue you need to make a PR directly to the Ruff repository. Opening an issue over at Ruff isn't necessary, because that repository is maintained by the same team that works on ty. We update the submodule hash in this repository every time we make a release. You can see some more details on contributing to ty here: https://github.com/astral-sh/ruff/blob/main/crates/ty/CONTRIBUTING.md.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 14:44:28 UTC
    </footer>
</body>
</html>
