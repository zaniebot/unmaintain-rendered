<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[ty] Divergent fixpoint iteration in instance attribute inference - astral-sh/ty #1065</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[ty] Divergent fixpoint iteration in instance attribute inference</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/1065">#1065</a>
        opened by <a href="https://github.com/sharkdp">@sharkdp</a>
        on 2025-08-20 16:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-20 16:28</div>
            <div class="timeline-body"><p>Another example where divergent fixpoint iteration leads to a panic:</p>
<pre><code class="language-py">class Counter:
    def __init__(self: &quot;Counter&quot;):
        self.x = 0

    def inc(self: &quot;Counter&quot;):
        self.x = self.x + 1
</code></pre>
<p>I wonder why the union of literals -&gt; <code>int</code> mechanism doesn't trigger here?</p>
<p>Note: all of these panics appear with implicit instance attributes, but it's not at all related to attribute access. If we had cyclic control flow, this could certainly be demonstrated with something like:</p>
<pre><code class="language-py">x = 0
while True:
    x += 1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @sharkdp on 2025-08-20 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">fatal</span> added by @sharkdp on 2025-08-20 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[ty] Too many cycle iterations for cyclically dependent instance attributes" to "[ty] Divergent fixpoint iteration in instance attribute inference" by @sharkdp on 2025-08-20 16:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2025-08-20 17:53</div>
            <div class="timeline-body"><p>I think this is a duplicate of #660, and there's some discussion there of possible solutions. Although I think the best solution is #957, which isn't mentioned there yet.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @carljm on 2025-08-20 17:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sharkdp">@sharkdp</a> on 2025-08-20 18:01</div>
            <div class="timeline-body"><p>ðŸ™ˆ</p>
<p>I started with something else here and eventually minified it to something I had already reported. Totally forgot that this was still open. Thanks.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 02:11:25 UTC
    </footer>
</body>
</html>
