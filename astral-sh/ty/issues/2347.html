<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`ty` missing `unresolved-attribute` on classes that inherit from `sqlalchemy.DeclarativeBase` - astral-sh/ty #2347</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>ty</code> missing <code>unresolved-attribute</code> on classes that inherit from <code>sqlalchemy.DeclarativeBase</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2347">#2347</a>
        opened by <a href="https://github.com/rodda-kyusu">@rodda-kyusu</a>
        on 2026-01-05 15:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rodda-kyusu">@rodda-kyusu</a></div>
            <div class="timeline-body">Summary
<p>Loving the beta!  Our type check time went from &gt; 2 minutes to under 2 seconds.</p>
<p>We are experiencing <code>ty</code> not throwing the <code>unresolved-attribute</code> rule in cases where it seems it should.</p>
<p>Minimum example:</p>
<pre><code>from sqlalchemy import Column, Integer, String
from sqlalchemy.orm import DeclarativeBase


class SampleModel(DeclarativeBase):
    pass


SampleModel.non_existent_attribute  # does not throw unresolved-attribute


class Sample:
    pass


Sample.non_existent_attribute   # throws unresolved-attribute
</code></pre>
<p>Believe I have a clean environment (can reproduce the above in a standalone file with no configuration etc):</p>
<pre><code>ty 0.0.9 (f1652f05d 2026-01-05)
</code></pre>
<p>Thanks for the help!</p>
<p>(added after original posting)</p>
<p>Saw this issue <a href="https://github.com/astral-sh/ty/issues/384">astral-sh/ty#384</a>, but think it handles <code>ClassVar</code> behavior — didn&#x27;t see anything else regarding declarative base.</p>
Version
<p>ty 0.0.9 (f1652f05d 2026-01-05)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2026-01-05 20:30</div>
            <div class="timeline-body"><p>Hmm, that&#x27;s odd -- I can&#x27;t reproduce this:</p>
<pre><code>➜ mkdir issue2347 &amp;&amp; cd issue2347 &amp;&amp; uv init .
Initialized project `issue2347` at `/Users/carlmeyer/projects/ruff-examples/issue2347`

✘130 ➜ rm -f main.py &amp;&amp; cat &gt;main.py
from sqlalchemy import Column, Integer, String
from sqlalchemy.orm import DeclarativeBase


class SampleModel(DeclarativeBase):
    pass


SampleModel.non_existent_attribute

✘1 ➜ uv add sqlalchemy
Using CPython 3.13.2
Creating virtual environment at: .venv
Resolved 4 packages in 2ms
Installed 2 packages in 4ms
 + sqlalchemy==2.0.45
 + typing-extensions==4.15.0

➜ uvx ty@0.0.9 check .
error[unresolved-attribute]: Class `SampleModel` has no attribute `non_existent_attribute`
 --&gt; main.py:9:1
  |
9 | SampleModel.non_existent_attribute
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
info: rule `unresolved-attribute` is enabled by default

Found 1 diagnostic
</code></pre>
<p>Do your reproduction steps differ from the above? What version of SQLAlchemy are you using?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-info</span> added by <a href="https://github.com/carljm">@carljm</a> on 2026-01-05 20:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rodda-kyusu">@rodda-kyusu</a> on 2026-01-05 20:43</div>
            <div class="timeline-body"><p>Ah that&#x27;s it; was on:</p>
<p><code>sqlalchemy==2.0.35</code> and <code>typing-extensions==4.12.2</code></p>
<p>Confirmed that upgrading fixed this, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/rodda-kyusu">@rodda-kyusu</a> on 2026-01-05 20:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rodda-kyusu">@rodda-kyusu</a> on 2026-01-05 21:07</div>
            <div class="timeline-body"><p>Did a bit more investigation (for those who stumble upon this in the
future), as even though the example started working the code the example
was derived from remained to be not working.</p>
<p>Believe it&#x27;s because that code was using <code>db.Model</code>, a pattern from
<code>flask-sqlalchemy</code>, which is defined here (
https://github.com/pallets-eco/flask-sqlalchemy/blob/168cb4b7b50fe5176307a10d873781bfafc6eeda/src/flask_sqlalchemy/extension.py#L244-L246).
This won&#x27;t work I don&#x27;t think regardless of version.  We are migrating to
inheriting from <code>DeclarativeBase</code> directly as a result — which is what&#x27;s
recommend in SQLAlchemy 2.x anyways.</p>
<p>On Mon, Jan 5, 2026 at 3:31 PM Carl Meyer <em><strong>@</strong></em>.***&gt; wrote:</p>
<blockquote>
<p><em>carljm</em> left a comment (astral-sh/ty#2347)
<a href="https://github.com/astral-sh/ty/issues/2347#issuecomment-3711986013">astral-sh/ty#2347</a></p>
<p>Hmm, that&#x27;s odd -- I can&#x27;t reproduce this:</p>
<p>➜ mkdir issue2347 &amp;&amp; cd issue2347 &amp;&amp; uv init .
Initialized project <code>issue2347</code> at <code>/Users/carlmeyer/projects/ruff-examples/issue2347</code></p>
<p>✘130 ➜ rm -f main.py &amp;&amp; cat &gt;main.py
from sqlalchemy import Column, Integer, String
from sqlalchemy.orm import DeclarativeBase</p>
<p>class SampleModel(DeclarativeBase):
pass</p>
<p>SampleModel.non_existent_attribute</p>
<p>✘1 ➜ uv add sqlalchemy
Using CPython 3.13.2
Creating virtual environment at: .venv
Resolved 4 packages in 2ms
Installed 2 packages in 4ms</p>
<ul>
<li>sqlalchemy==2.0.45</li>
<li>typing-extensions==4.15.0</li>
</ul>
<p>➜ uvx <em><strong>@</strong></em>.*** check .
error[unresolved-attribute]: Class <code>SampleModel</code> has no attribute <code>non_existent_attribute</code>
--&gt; main.py:9:1
|
9 | SampleModel.non_existent_attribute
| ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
|
info: rule <code>unresolved-attribute</code> is enabled by default</p>
<p>Found 1 diagnostic</p>
<p>—
Reply to this email directly, view it on GitHub
<a href="https://github.com/astral-sh/ty/issues/2347#issuecomment-3711986013">astral-sh/ty#2347</a>, or
unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/BCPHULU6VOXWVBQNUSDWWQ34FLCZLAVCNFSM6AAAAACQXRW5SSVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTOMJRHE4DMMBRGM">https://github.com/notifications/unsubscribe-auth/BCPHULU6VOXWVBQNUSDWWQ34FLCZLAVCNFSM6AAAAACQXRW5SSVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTOMJRHE4DMMBRGM</a>
.
You are receiving this because you authored the thread.Message ID:
<em><strong>@</strong></em>.***&gt;</p>
</blockquote>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:26:56 UTC
    </footer>
</body>
</html>
