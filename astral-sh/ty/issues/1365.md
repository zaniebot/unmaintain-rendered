```yaml
number: 1365
title: Losing type with Pydantic RootModel
type: issue
state: closed
author: vlashada
labels:
  - generics
  - attribute access
assignees: []
created_at: 2025-10-15T23:33:05Z
updated_at: 2026-01-08T19:58:59Z
url: https://github.com/astral-sh/ty/issues/1365
synced_at: 2026-01-10T01:56:40Z
```

# Losing type with Pydantic RootModel

---

_Issue opened by @vlashada on 2025-10-15 23:33_

### Summary

When running `model_validate_json("")`, the type becomes unknown.

```python
from abc import ABC
from typing import Literal, Union, reveal_type

from pydantic import BaseModel, RootModel


class A(BaseModel):
    name: Literal["A"]


class B(BaseModel):
    name: Literal["A"]


AORB = RootModel[Union[A, B]]

reveal_type(AORB.model_validate_json("")) # Revealed type: `Unknown`
```

When I hover the method, I get the following type revealed:

```
bound method <class 'RootModel[A | B]'>.model_validate_json(
    json_data: str | bytes | bytearray,
    *,
    strict: bool | None = None,
    context: Any | None = None,
    by_alias: bool | None = None,
    by_name: bool | None = None
) -> RootModel[A | B]
```

### Version

73520e4ac

---

_Comment by @sharkdp on 2025-10-16 08:02_

Thank you for reporting this.

The signature of `model__validate_json` is here: https://github.com/pydantic/pydantic/blob/41cafa95c5fce8e1bb7af58c0f5bccb68a6ff389/pydantic/main.py#L726-L736

There are a two things missing in ty to support this:
* An implicit annotation of `type[Self]` for the `cls` attribute of `@classmethod`s. This is part of #159 
* Solving typevars inside `type[…]`. This is tracked in https://github.com/astral-sh/ty/issues/501, which itself is currently being worked on (see also #623)

---

_Label `generics` added by @sharkdp on 2025-10-16 08:02_

---

_Label `attribute access` added by @sharkdp on 2025-10-16 08:03_

---

_Comment by @MatthijsKok on 2026-01-08 19:57_

As of `ty 0.0.10 (d18902cdc 2026-01-07)`, the revealed type is `RootModel[A | B]` for the code block above.
This can be closed.

```
~ ❱ uvx ty --version
ty 0.0.10 (d18902cdc 2026-01-07)
~ ❱ uvx --with="pydantic==2.12.5" ty check ty_pydantic_rootmodel.py
Installed 6 packages in 48ms
info[revealed-type]: Revealed type
  --> ty_pydantic_rootmodel.py:17:13
   |
15 | AORB = RootModel[Union[A, B]]
16 |
17 | reveal_type(AORB.model_validate_json("")) # Revealed type: `Unknown`
   |             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^ `RootModel[A | B]`
   |

Found 1 diagnostic
```

<img width="902" height="399" alt="Image" src="https://github.com/user-attachments/assets/bdd5ecfa-faf6-4402-b29d-de2e8526ed27" />



---

_Closed by @AlexWaygood on 2026-01-08 19:58_

---
