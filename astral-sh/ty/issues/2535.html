<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`unused-ignore-comment` should not fire where the variable type is `Unknown` - astral-sh/ty #2535</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>unused-ignore-comment</code> should not fire where the variable type is <code>Unknown</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/ty/issues/2535">#2535</a>
        opened by <a href="https://github.com/lexrobin-te">@lexrobin-te</a>
        on 2026-01-16 15:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/lexrobin-te">@lexrobin-te</a></div>
            <div class="timeline-body">Summary
<p>ty is incorrectly telling me to remove <code># type: ignore</code> in a situation where it doesn&#x27;t know what the type being suppressed is.</p>
<pre><code>def funcname(my_seq: Sequence[SomeClass]):
    my_seq = sorted(
        my_seq,
        key=(lambda i: reveal_type(reveal_type(i).nullable_attr).attr),
    )
    # ...
</code></pre>
<pre><code>     ├╴  &quot;attr&quot; is not a known attribute of &quot;None&quot; Pyright (reportOptionalMemberAccess) [134, 66]
     ├╴  Revealed type: `Unknown` ty (revealed-type) [134, 48]
     ├╴  Type of &quot;i&quot; is &quot;SomeClass&quot; Pyright  [134, 48]
     ├╴  Revealed type: `Unknown` ty (revealed-type) [134, 36]
     └╴  Type of &quot;reveal_type(i).nullable_attr&quot; is &quot;OtherClass | None&quot; Pyright  [134, 36]
</code></pre>
Version
<p>ty 0.0.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">suppression</span> added by <a href="https://github.com/carljm">@carljm</a> on 2026-01-16 15:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carljm">@carljm</a> on 2026-01-16 15:25</div>
            <div class="timeline-body"><p>Hi, thanks for the report!</p>
<p>Unfortunately I don&#x27;t think there is any reliable way to implement this feature request. ty has no way to know what type error a <code># type: ignore</code> comment is intended to suppress, or which variable&#x27;s type it relates to. Ignoring all unused <code># type: ignore</code> on any line where there is <em>any</em> variable with <code>Unknown</code> type would lead to very hard-to-predict behavior and would miss some actually-unused <code># type: ignore</code>. I think it&#x27;s better to keep the behavior predictable: if there is a <code># type: ignore</code> on a line where ty does not emit any type error, that always emits <code>unused-ignore-comment</code>.</p>
<p>I realize that given type checkers have different behaviors (and especially while ty is still feature-incomplete and in beta), suppressing type errors while using multiple type checkers is painful. If pyright is the other type checker you are using on this codebase, my recommendation is to use <code># pyright: ignore</code> to suppress pyright type errors and <code># ty: ignore</code> to suppress ty type errors. For lines with a type error in both type checkers which you want to suppress, you can either use both comments (the advantage is that you can then suppress only a specific error code), or use a <code># type: ignore</code>.</p>
<p>Other options that might be useful include disabling the ty <code>unused-ignore-comment</code> rule, or setting <a href="https://docs.astral.sh/ty/reference/configuration/#respect-type-ignore-comments"><code>respect-type-ignore-comments = false</code></a> so that ty will ignore all <code># type: ignore</code> comments and respect only <code># ty: ignore</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/carljm">@carljm</a> on 2026-01-16 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2026-01-16 15:28</div>
            <div class="timeline-body"><p>We also plan to spli the <code>unused-ignore-comment</code> into two: One for <code>ty: ignore</code> and one for <code>type: ignore</code>, which might help with your use case</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lexrobin-te">@lexrobin-te</a> on 2026-01-16 15:34</div>
            <div class="timeline-body"><p>Thanks both, I&#x27;ll disable <code>unused-ignore-comment</code> until later then since I&#x27;ve found a bunch of other false positives with <code>TypedDicts</code> that will presumably become errors in later releases</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:27:10 UTC
    </footer>
</body>
</html>
