<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warn when missing minimal bounds when using `tool.uv.sources` - astral-sh/uv #3452</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Warn when missing minimal bounds when using <code>tool.uv.sources</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/3452">#3452</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-05-08 07:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>When using <code>tool.uv.sources</code>, we warn that requirements have a bound, i.e. at least a lower version constraint.</p>
<p>When using a library, the symbols you import were introduced in different versions, creating an implicit lower bound. This warning makes this explicit. This is crucial to prevent backtracking resolvers from selecting an ancient versions that is not compatible (or worse, doesn't build), and a performance optimization on top.</p>
<p>This feature is gated to <code>tool.uv.sources</code> (as it should have been to begin with for #3263/#3443) to not unnecessarily break legacy workflows. It is also helpful specifically when using a <code>tool.uv.sources</code> section that contains constraints that are not published to pypi, e.g. for workspace dependencies. We can adjust those later to e.g. not constrain workspace dependencies with <code>publish = false</code>, but i think it's the right setting to start with.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-08 13:31</div>
            <div class="timeline-body"><p>I think I have a strong preference for this being a warning?</p>
<p>Maybe it'd be configurable in the future.. i.e. <code>unconstrainted-requirements = error | warn | allow</code></p>
<p>A warning seems less likely to block adoption.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Enforce minimal bounds when using `tool.uv.sources`" to "Warn when missing minimal bounds when using `tool.uv.sources`" by @konstin on 2024-05-08 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @konstin on 2024-05-08 13:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-05-08 13:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-requirements/src/pyproject.rs</code>:410 on 2024-05-08 13:53</div>
            <div class="timeline-body"><p>Should we use <code>warn_user_once</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-05-08 13:54</div>
            <div class="timeline-body"><p>This is a correctness check (no lower bound is almost certainly incorrect), you should not be able to silence correctness checks; the correct way to get rid of the warning is to add the lower bound your project has, either implicitly or by policy.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-05-08 13:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-requirements/src/pyproject.rs</code>:497 on 2024-05-08 13:54</div>
            <div class="timeline-body"><p>Can we frame this without the &quot;You&quot; i.e. &quot;No version constraint (e.g. ...) specified for {}&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-05-08 13:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/pip_compile.rs</code>:8658 on 2024-05-08 13:55</div>
            <div class="timeline-body"><p>Is there a test ensuring this warning is not raised without <code>tool.uv.sources</code> present?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-05-08 13:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-08 14:16</div>
            <div class="timeline-body"><p>I'm not totally convinced that I want this, but I guess it's fine for now if it's limited to <code>tool.uv.sources</code> and doesn't show up for non-sources users.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-05-08 14:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-requirements/src/pyproject.rs</code>:497 on 2024-05-08 14:16</div>
            <div class="timeline-body"><p>Let's make this: &quot;Missing version constraint (e.g., lower bound) for <code>{}</code>&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-requirements/src/pyproject.rs</code>:497 on 2024-05-08 14:16</div>
            <div class="timeline-body"><p>Note the backticks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-05-08 14:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-05-08 14:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-requirements/src/pyproject.rs</code>:497 on 2024-05-08 14:33</div>
            <div class="timeline-body"><p>Please change &quot;e.g. a lower bound&quot; to &quot;e.g., lower bound&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-05-08 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-05-08 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-05-08 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/denkasyanov">@denkasyanov</a> on 2024-08-22 21:34</div>
            <div class="timeline-body"><p>Is there a way to add lower bounds automatically for installed dependencies that doesn't have them?</p>
<p>Not sure what exactly triggered the warning, update to 0.3.1 or (I guess more likely) adding a dependency from GitHub.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-08-23 08:13</div>
            <div class="timeline-body"><p>@denkasyanov Can you describe steps to reproduce your problem and the exact error you're seeing?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/denkasyanov">@denkasyanov</a> on 2024-08-23 11:05</div>
            <div class="timeline-body"><p>Sorry, should have added more context from the beginning.</p>
<p>I updated from uv 0.3.0 to 0.3.1 AND replaced the <code>spyne</code> package from pypi with <code>spyne</code> package from GitHub like that:</p>
<pre><code class="language-shell">uv remove spyne
uv add git+https://github.com/arskom/spyne@f105ec2f41495485fef1211fe73394231b3f76e5
</code></pre>
<p>After that I tried to run <code>uv sync</code> and received warnings</p>
<pre><code>warning: Missing version constraint (e.g., a lower bound) for `celery`
warning: Missing version constraint (e.g., a lower bound) for `django`
</code></pre>
<p>My dependencies at the moment:</p>
<pre><code class="language-toml">[project]
dependncies = [
  &quot;celery&quot;,
  &quot;django&quot;,
 ]
</code></pre>
<p>This was expected, so no error (not even a real problem) here.</p>
<p>But since I had a ton of dependencies, I thought, maybe there is a way to &quot;half-lock&quot; them in the [project] table.</p>
<p>So that I could turn the example above into something like:</p>
<pre><code class="language-toml">[project]
dependncies = [
  &quot;celery&gt;=5.4.0&quot;,
  &quot;django&gt;=5.1&quot;,
 ]
</code></pre>
<p>for all regular and dev dependencies.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:36:56 UTC
    </footer>
</body>
</html>
