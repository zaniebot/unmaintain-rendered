<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add proto and tlsv1.2 to curl commands - astral-sh/uv #14199</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add proto and tlsv1.2 to curl commands</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/14199">#14199</a>
        opened by <a href="https://github.com/pstoeckle">@pstoeckle</a>
        on 2025-06-22 11:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/pstoeckle">@pstoeckle</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>Use <code>--proto '=https' --tlsv1.2</code> in <code>curl</code> commands.</p>
<h2>Test Plan</h2>
<p>Added the flags also to <code>.github/workflows/ci.yml</code>. Thus, if the CI works, it should also be working in general.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add proto and tlsv1.2 to curl commands in installer script" to "Add proto and tlsv1.2 to curl commands" by @pstoeckle on 2025-06-22 11:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @Gankra by @konstin on 2025-06-22 11:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2025-06-22 11:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-22 12:56</div>
            <div class="timeline-body"><p>Hi! Thanks for the pull request.</p>
<p>Can you share your motivation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pstoeckle">@pstoeckle</a> on 2025-06-22 13:30</div>
            <div class="timeline-body"><p>With <code>--tlsv1.2</code>, <code>curl</code> only allows modern/secure TLS suites.</p>
<p>With <code>--proto '=https'</code>, <code>curl</code> only allows <code>https</code>, and no <code>http</code>.</p>
<p>You probably already configure your servers similarly, but with these options you can make it explicit on the client side.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-06-23 13:59</div>
            <div class="timeline-body"><p>So the motivation for these changes is to define a minimum acceptable protocol to basically guard against downgrade attacks, where a server claims it can only support <ancient obsolete protocol> or a redirect strips https. AFAICT the value of this is marginal but it's a nice little ritual to make things that little bit more secure.</p>
<p>These are exactly the flags that <a href="https://rustup.rs/">rustup includes</a>, and <a href="https://github.com/astral-sh/uv/releases/">that cargo-dist tells you to use</a>. <a href="https://github.com/rust-lang/rustup/issues/2581">Folks have argued for rustup to bump the minimum to tlsv1.3 but the longtail spectre of weird old machines was deemed worth supporting</a>.</p>
<p>I seem to recall astral stripped these for some obscure compatibility reason but I can't recall the details and no longer have access to the relevant chatlogs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-06-23 14:02</div>
            <div class="timeline-body"><p>I would bias to accepting this unless someone (@charliermarsh?) can remember why those flags had to be dropped.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-06-26 19:28</div>
            <div class="timeline-body"><p>I tried a debian bulleye, the oldest non-EOL debian, and it rejects everything older than TLS v1.2:</p>
<pre><code>$ curl -LsSf --tls-max 1.1 https://astral.sh/uv/install.sh
curl: (35) error:141E70BF:SSL routines:tls_construct_client_hello:no protocols available
</code></pre>
<p>A CentOS 7 server I have access to acts similarly:</p>
<pre><code>$ curl -LsSf --tls-max 1.1 https://astral.sh/uv/install.sh
curl: (35) OpenSSL/1.0.2k-fips: error:1407742E:SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert protocol version
</code></pre>
<p>openSUSE Leap 15.3:</p>
<pre><code>$ curl -LsSf --tls-max 1.1 https://astral.sh/uv/install.sh
curl: (35) error:1409442E:SSL routines:ssl3_read_bytes:tlsv1 alert protocol version
</code></pre>
<p>Only on Ubuntu 18.04 with extended security maintenance support TLS v1.1.</p>
<p>From that perspective, we're already guaranteeing TLS v1.2 on any reasonably up-to-date system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review request for @Gankra removed by @konstin on 2025-06-26 19:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @konstin on 2025-06-26 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-27 17:59</div>
            <div class="timeline-body"><p>I think we're leaning no on this. Thanks for taking the time to contribute though!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-06-27 17:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:43:41 UTC
    </footer>
</body>
</html>
