<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prioritize forks based on upper bounds - astral-sh/uv #5643</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Prioritize forks based on upper bounds</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/5643">#5643</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-07-30 23:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-30 23:37</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Given a fork like:</p>
<pre><code>pylint &lt; 3 ; sys_platform == 'darwin'
pylint &gt; 2 ; sys_platform != 'darwin'
</code></pre>
<p>Solving the top branch will typically yield a solution that also satisfies the bottom branch, due to maximum version selection (while the inverse isn't true).</p>
<p>To quote an example from the docs:</p>
<pre><code class="language-rust">// If there's no difference, prioritize forks with upper bounds. We'd prefer to solve
// `numpy &lt;= 2` before solving `numpy &gt;= 1`, since the resolution produced by the former
// might work for the latter, but the inverse is unlikely to be true due to maximum
// version selection. (Selecting `numpy==2.0.0` would satisfy both forks, but selecting
// the latest `numpy` would not.)
</code></pre>
<p>Closes https://github.com/astral-sh/uv/issues/4926 for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-07-30 23:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @charliermarsh on 2024-07-30 23:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @BurntSushi by @charliermarsh on 2024-07-30 23:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-07-30 23:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2024-07-30 23:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-resolver/src/resolver/mod.rs</code>:2873 on 2024-07-30 23:38</div>
            <div class="timeline-body"><p>Just a heuristic of course, and we don't really have a ton of examples to inform this work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-07-30 23:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-31 07:38</div>
            <div class="timeline-body"><p>While this is an improvement, it does not fix the transformers example. Fork points for transformers:</p>
<ul>
<li>Splitting on pydantic==2.8.2 over typing-extensions</li>
<li>Splitting on opencv-python==4.10.0.84 over numpy</li>
<li>Splitting on pandas==2.2.2 over numpy</li>
<li>Splitting on botocore==1.34.151 over urllib3</li>
</ul>
<p>~~I think we need to prioritize based on <code>python_version</code> for that.~~ I haven't dug in what part is missing yet.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-07-31 07:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> approved on 2024-07-31 14:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-31 14:28</div>
            <div class="timeline-body"><p>@konstin - Can you link to that example, and I'll explore it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-31 14:59</div>
            <div class="timeline-body"><p>I'Ve added it in https://github.com/astral-sh/uv/pull/5657</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-31 15:05</div>
            <div class="timeline-body"><p>Thanks! I'll merge this and then explore that separately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-07-31 15:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-31 15:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-31 15:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 13:37:39 UTC
    </footer>
</body>
</html>
