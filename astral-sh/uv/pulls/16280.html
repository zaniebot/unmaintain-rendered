<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add auto-detection for Intel GPU on Windows - astral-sh/uv #16280</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add auto-detection for Intel GPU on Windows</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/16280">#16280</a>
        opened by <a href="https://github.com/guangyey">@guangyey</a>
        on 2025-10-13 11:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/guangyey">@guangyey</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>This PR enables <code>--torch-backend=auto</code> to automatically detect Intel GPUs. It follows up on <a href="https://github.com/astral-sh/uv/pull/14386">#14386</a>.
On Windows, detection is implemented by querying the <code>Win32_VideoController</code> class via the <a href="https://github.com/ohadravid/wmi-rs/tree/v0.16.0">WMI crate</a>.</p>
<p>Currently, Intel GPUs (XPU) do not depend on specific driver or toolkit versions to determine which PyTorch wheel to use.</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<!-- How was it tested? -->

<p>Using <code>uv pip install torch --torch-backend=auto</code> could install torch-xpu successfully when Intel GPU is detected.</p>
<p><img width="906" height="745" alt="image" src="https://github.com/user-attachments/assets/d5eac4b4-0d09-40d5-83d7-4c645a6cfa25" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @guangyey on 2025-10-13 11:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add auto-detection for Intel GPU on Windows" to "[WIP] Add auto-detection for Intel GPU on Windows" by @guangyey on 2025-10-13 11:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @guangyey on 2025-10-14 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[WIP] Add auto-detection for Intel GPU on Windows" to "Add auto-detection for Intel GPU on Windows" by @guangyey on 2025-10-14 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guangyey">@guangyey</a> on 2025-10-14 13:24</div>
            <div class="timeline-body"><p>@charliermarsh and @geofft could you please help review this PR when you have time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @konstin on 2025-10-14 13:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @geofft by @konstin on 2025-10-14 13:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2025-10-15 18:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guangyey">@guangyey</a> on 2025-10-16 07:39</div>
            <div class="timeline-body"><p>@charliermarsh and @geofft May I know if you could help review this PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-16 14:19</div>
            <div class="timeline-body"><p>Please have patience with the uv team, we only have limited resources for reviewing complex PRs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guangyey">@guangyey</a> on 2025-10-16 14:42</div>
            <div class="timeline-body"><blockquote>
<p>Please have patience with the uv team, we only have limited resources for reviewing complex PRs.</p>
</blockquote>
<p>Totally understand, thanks for taking the time to review! Really appreciate the efforts from the uv team.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">no-build</span> added by @geofft on 2025-10-16 20:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">no-test</span> added by @geofft on 2025-10-16 20:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-10-16 20:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-torch/src/accelerator.rs</code>:9 on 2025-10-16 20:29</div>
            <div class="timeline-body"><p>nit: this should be <code>#[cfg(windows)]</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geofft">@geofft</a> on 2025-10-16 20:55</div>
            <div class="timeline-body"><p>Thanks, code looks good to me! As discussed in https://github.com/astral-sh/uv/pull/14386#issuecomment-3031706334, we <em>will</em> grab the XPU version on machines with an Intel iGPU that isn't actually useful for GPGPU work, but we said that's probably okay because this version still has CPU support, and detecting other types of GPUs takes precedence.</p>
<p>I manually tested this a little bit and the behavior is what I expect. (I tested on two EC2 VMs by modifying the code to match on Microsoft's PCI ID instead of Intel's, and on the one without an additional GPU it downloads the XPU version, and on the one that has an NVIDIA T4 it downloads the CUDA version.)</p>
<p>If anyone in the future feels like we should not download the XPU version on machines with insufficiently powerful iGPUs, we can definitely iterate on the behavior, please report a new issue and tag me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @geofft on 2025-10-16 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @geofft on 2025-10-16 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">no-build</span> removed by @geofft on 2025-10-16 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">no-test</span> removed by @geofft on 2025-10-16 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guangyey">@guangyey</a> on 2025-10-17 02:24</div>
            <div class="timeline-body"><p>@geofft  Thank you so much for the thorough testing and clear explanation! Really appreciate your detailed validation and feedback. Please feel free to tag me if there’s anything I can help with.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-10-17 02:25</div>
            <div class="timeline-body"><p>Thanks @guangyey, appreciate the contribution!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guangyey">@guangyey</a> on 2025-10-17 02:31</div>
            <div class="timeline-body"><p>@charliermarsh Thanks! Happy to contribute. It’s been an interesting and rewarding experience.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:45:02 UTC
    </footer>
</body>
</html>
