<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>replace backoff with backon - astral-sh/uv #10442</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>replace backoff with backon</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/10442">#10442</a>
        opened by <a href="https://github.com/Gankra">@Gankra</a>
        on 2025-01-09 20:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a></div>
            <div class="timeline-body"><p>This should be essentially the exact same behaviour, but backon is a total API redesign, so things had to be expressed slightly differently. Overall I think the code is more readable, which is nice.</p>
<p>Fixes #10001</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @Gankra on 2025-01-09 20:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-01-09 20:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/uv-fs/src/lib.rs</code>:223 on 2025-01-09 20:14</div>
            <div class="timeline-body"><p>I think these sleep calls are technically defaulted but their examples use them and once they were there I felt they improved readability.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-01-09 20:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/uv-fs/src/lib.rs</code>:342 on 2025-01-09 20:15</div>
            <div class="timeline-body"><p>This extra if-let from forgetting the analysis we did to decide to retry is the biggest &quot;flaw&quot; with backon's different API. small potatoes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-01-09 20:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-fs/src/lib.rs</code>:192 on 2025-01-09 20:23</div>
            <div class="timeline-body"><p>I feel so dumb, can you explain this math? (I assume the intention is to be unchanged.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2025-01-09 20:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-01-09 20:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/uv-fs/src/lib.rs</code>:192 on 2025-01-09 20:29</div>
            <div class="timeline-body"><p>we start at 10 milliseconds and try 9 times. the longest try is therefore <code>10*pow(2, 9)</code> milliseconds, which is 5 seconds. This gives us about 10 seconds of attempting to retry, because the sum of powers of 2 is just the next power of 2 (-1).</p>
<p>Or more intuitively, we wait about 5 seconds in the worst case, and that dwarfs everything else combined.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-01-09 20:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/uv-fs/src/lib.rs</code>:192 on 2025-01-09 20:38</div>
            <div class="timeline-body"><p>Updated the comment, thanks for calling it out!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @Gankra on 2025-01-09 21:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-01-09 21:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-09 21:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:41:22 UTC
    </footer>
</body>
</html>
