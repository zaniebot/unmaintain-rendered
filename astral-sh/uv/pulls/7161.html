<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use path file instead of `sitecustomize.py` - astral-sh/uv #7161</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use path file instead of <code>sitecustomize.py</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/7161">#7161</a>
        opened by <a href="https://github.com/bluss">@bluss</a>
        on 2024-09-07 09:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bluss">@bluss</a></div>
            <div class="timeline-body">Summary
<p>Use a path file (<code>.pth</code>) instead of <code>sitecustomize.py</code> for configuring path in emphemeral virtualenvs, overlaying the ephemeral venv on top of the base <code>.venv</code>.</p>
<p><code>sitecustomize.py</code> is a module in the python installation and as such a unique resource - homebrew pythons on macos already install such a file and thus uv&#x27;s <code>sitecustomize.py</code>, placed in the ephemeral env, did not have any effect.</p>
<p>I don&#x27;t find any documentation explicitly saying that addsitedir is valid in <code>.pth</code> files but from trial it seems to be - and there is the precedent of the existing _virtualenv.pth _virtualenv.py pair that do nontrivial operations.</p>
Test Plan
<ul>
<li>Testing on ephemeral venv, resolving to base venv including editable install in base: done (py3.7, 3.12)</li>
<li>Testing on homebrew python/macos: done (py3.11)</li>
<li>tests: run_editable</li>
</ul>
<p>Fixes #7152</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-07 16:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carljm">@carljm</a> approved on 2024-09-08 22:12</div>
            <div class="timeline-body"><p>This is a good idea, and it looks good to me. Thanks for the fix!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-09 13:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-09 13:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-09 13:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-09-09 18:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-08 12:37</div>
            <div class="timeline-body"><p>Cross-linking in case this becomes a problem</p>
<ul>
<li>https://github.com/python/cpython/issues/77102</li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:48:07 UTC
    </footer>
</body>
</html>
