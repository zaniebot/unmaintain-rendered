<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>puffin-client: generalize SimpleMetadaRaw into OwnedArchive&lt;A&gt; - astral-sh/uv #1208</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>puffin-client: generalize SimpleMetadaRaw into OwnedArchive<A></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1208">#1208</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2024-01-31 16:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a></div>
            <div class="timeline-body"><p>It turns out that the pattern I coded up for SimpleMetadataRaw is
generally useful when working with rkyv. This commit makes it generic by
supporting any type that implements rkyv's traits, and makes a few
simplifying assumptions by picking a concrete serializer, validator and
deserializer. In effect, this lets use own any archived value.</p>
<p>We also rejigger the API a little bit and double-down on
<code>OwnedArchive&lt;A&gt;</code> just being a owned wrapper for <code>Archived&lt;A&gt;</code>. Namely,
we implement <code>Deref</code> and turn its inherent methods into methods that
require fully qualified syntax. (As is standard for things that
implement <code>Deref</code> to avoid ambiguity with the deref target's methods.)</p>
<p>(This PR also makes a couple small simplifications to our custom rkyv
serializer since we no longer need to use it directly. We do still need
to name the type in trait bounds, so it has to be public.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @BurntSushi on 2024-01-31 16:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @BurntSushi on 2024-01-31 16:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-01-31 16:42</div>
            <div class="timeline-body"><p>Makes sense to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @BurntSushi on 2024-01-31 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2024-01-31 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-31 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @zanieb on 2024-02-02 17:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:35:25 UTC
    </footer>
</body>
</html>
