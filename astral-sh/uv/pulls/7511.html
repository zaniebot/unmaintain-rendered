<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Move uvx shell completion to uvx --generate-shell-completion - astral-sh/uv #7511</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Move uvx shell completion to uvx --generate-shell-completion</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/7511">#7511</a>
        opened by <a href="https://github.com/bluss">@bluss</a>
        on 2024-09-18 17:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bluss">@bluss</a></div>
            <div class="timeline-body">Summary
<p>Because a problem was found with Powershell and combining the generated completion scripts for uv and uvx, let&#x27;s try separating uv and uvx command completion scripts.</p>
<p>The generated powershell script template can be seen in clap_complete source, and it starts with <code>using</code> directives, which makes it impossible (apparently) to concatenate two of those script outputs.</p>
<p>As a side effect, this is available under <code>uv tool run --generate-shell-completion</code> too.</p>
<p>Fixes #7482</p>
Test Plan
<ul>
<li><code>eval &quot;$(cargo run --bin uvx -- --generate-shell-completion bash)&quot;</code></li>
<li>Test Powershell</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2024-09-18 17:21</div>
            <div class="timeline-body"><p>Link to the powershell generator template - https://docs.rs/clap_complete/4.5.28/src/clap_complete/aot/shells/powershell.rs.html#28 - IMO we should not try to patch the output of the generator, but it seems to be possible, feel free to go that route if you want to.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-19 02:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-19 02:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2024-09-19 06:05</div>
            <div class="timeline-body"><p>Cc @ilyagr if you are interested</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 01:19</div>
            <div class="timeline-body"><p>Why am I hitting this? ü§î</p>
<pre><code>‚ùØ cargo run --bin uvx -- --generate-shell-completion
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.15s
     Running `target/debug/uvx --generate-shell-completion`
error: unexpected argument &#x27;--generate-shell-completion&#x27; found

Usage: uvx [OPTIONS] [COMMAND]

For more information, try &#x27;--help&#x27;.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 01:20</div>
            <div class="timeline-body"><p>Oh I think I had to build <code>uv</code> too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-09-20 01:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 01:21</div>
            <div class="timeline-body"><p>Thanks for following up.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-20 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-09-20 06:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:48:20 UTC
    </footer>
</body>
</html>
