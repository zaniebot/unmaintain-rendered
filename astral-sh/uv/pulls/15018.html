<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chore(ci): address findings in publish-docs workflow - astral-sh/uv #15018</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>chore(ci): address findings in publish-docs workflow</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/15018">#15018</a>
        opened by <a href="https://github.com/woodruffw">@woodruffw</a>
        on 2025-08-01 19:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/woodruffw">@woodruffw</a></div>
            <div class="timeline-body"><p>This addresses all findings in <code>publish-docs.yml</code>.</p>
<h2>Summary</h2>
<p>Key changes:</p>
<ul>
<li>The workflow now runs with no latent permissions. This should be OK, since it looks like any permissioned actions the workflow does require an explicit secret anyways.</li>
<li>I've intermediated all template expansions with appropriate environment variables. <code>VERSION</code> in particular is now defined at the job level, since it doesn't vary.</li>
<li>I've disabled credential persistence in <code>actions/checkout</code>.</li>
</ul>
<h2>Test Plan</h2>
<p>Like #15016, we need to run and see what happens. It might also make sense to manually trigger a docs deploy afterwards.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @woodruffw on 2025-08-01 19:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @woodruffw by @woodruffw on 2025-08-01 19:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @woodruffw on 2025-08-01 19:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-08-01 19:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-01 19:32</div>
            <div class="timeline-body"><p>You should be able to run the docs deploy job before merging.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woodruffw">@woodruffw</a> on 2025-08-01 19:43</div>
            <div class="timeline-body"><p>Triggered manually; it deploys correctly but with a suboptimal <code>VERSION=</code> when manually dispatched. I think that behavior was pre-existing though.</p>
<p>(That has only a cosmetic effect on the commit message, doesn't appear to affect any actual built doc state.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @woodruffw on 2025-08-01 20:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @woodruffw on 2025-08-01 20:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-01 20:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:44:13 UTC
    </footer>
</body>
</html>
