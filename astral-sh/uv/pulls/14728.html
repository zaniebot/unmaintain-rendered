<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feat: Complete PEP 751 multi-use lock file for pylock.toml export - astral-sh/uv #14728</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>feat: Complete PEP 751 multi-use lock file for pylock.toml export</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/14728">#14728</a>
        opened by <a href="https://github.com/gaborbernat">@gaborbernat</a>
        on 2025-07-18 15:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a></div>
            <div class="timeline-body"><p>This PR adds <a href="https://packaging.python.org/en/latest/specifications/pylock-toml/">PEP 751</a> multi-use lock file support when exporting to <code>pylock.toml</code> format.</p>
What is a Multi-Use Lock File?
<p>A multi-use lock file describes <strong>all possible packages</strong> that might be installed across different scenarios, rather than just the packages for one specific configuration. This enables:</p>
<ul>
<li><strong>Multiple environments from one file</strong>: Install for Python 3.8, 3.9, 3.10+ all from the same lock file</li>
<li><strong>Optional features</strong>: Choose which extras (like <code>dev</code>, <code>test</code>, <code>docs</code>) to install at install-time</li>
<li><strong>Dependency groups</strong>: Select which dependency groups to include (like PEP 735 groups)</li>
<li><strong>Platform-specific packages</strong>: Different wheels for Linux, macOS, Windows from one source</li>
</ul>
<p>The lock file uses <strong>markers</strong> to indicate when each package should be installed, allowing installers to select the appropriate subset.</p>
What This Implements
<p>This PR adds the missing PEP 751 metadata fields and marker syntax to enable full multi-use lock file support:</p>
<ul>
<li><strong><code>environments</code></strong>: Resolution forks showing which platform/Python combinations are supported</li>
<li><strong><code>extras</code></strong>: List of available optional dependencies</li>
<li><strong><code>dependency-groups</code></strong>: List of available dependency groups (PEP 735)</li>
<li><strong><code>default-groups</code></strong>: Synthetic groups for default installation (currently empty per spec)</li>
<li><strong>PEP 751 marker syntax</strong>: <code>&#x27;extra&#x27; in extras</code> and <code>&#x27;group&#x27; in dependency_groups</code> for root project dependencies</li>
</ul>
Feature Examples
<p>Each feature is shown individually below, followed by a complete example showing all features together.</p>
1. <code>environments</code> Field
<p>Shows which platform/Python version combinations the lock file was created for:</p>
<p><strong>Input (<code>pyproject.toml</code>):</strong></p>
<pre><code>[tool.uv]
environments = [
  &quot;sys_platform == &#x27;darwin&#x27;&quot;,
  &quot;sys_platform == &#x27;linux&#x27;&quot;,
]
</code></pre>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>lock-version = &quot;1.0&quot;
created-by = &quot;uv&quot;
environments = [
    &quot;sys_platform == &#x27;darwin&#x27;&quot;,
    &quot;sys_platform == &#x27;linux&#x27;&quot;,
]
requires-python = &quot;&gt;=3.12&quot;
</code></pre>
<p>This allows consumers to check if the lock file is compatible with their target platform before attempting installation.</p>
<hr>
2. <code>extras</code> Field
<p>Lists all optional dependencies available in the project:</p>
<p><strong>Input (<code>pyproject.toml</code>):</strong></p>
<pre><code>[project.optional-dependencies]
test = [&quot;pytest&gt;=8.0&quot;]
docs = [&quot;sphinx&gt;=7.0&quot;]
</code></pre>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>lock-version = &quot;1.0&quot;
created-by = &quot;uv&quot;
requires-python = &quot;&gt;=3.12&quot;
extras = [
    &quot;docs&quot;,
    &quot;test&quot;,
]
</code></pre>
<p>Installers can use this to validate requested extras and show available options.</p>
<hr>
3. <code>dependency-groups</code> Field
<p>Lists all dependency groups defined in the project (PEP 735):</p>
<p><strong>Input (<code>pyproject.toml</code>):</strong></p>
<pre><code>[dependency-groups]
dev = [&quot;ruff&gt;=0.4.0&quot;]
type = [&quot;mypy&gt;=1.10.0&quot;]
</code></pre>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>lock-version = &quot;1.0&quot;
created-by = &quot;uv&quot;
requires-python = &quot;&gt;=3.12&quot;
dependency-groups = [
    &quot;dev&quot;,
    &quot;type&quot;,
]
</code></pre>
<p>Installers can use this to validate requested dependency groups and show available options.</p>
<hr>
4. <code>default-groups</code> Field
<p>Synthetic groups representing default installation (currently always empty):</p>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>lock-version = &quot;1.0&quot;
created-by = &quot;uv&quot;
requires-python = &quot;&gt;=3.12&quot;
extras = []
dependency-groups = []
default-groups = []
</code></pre>
<p>Per PEP 751, this is only needed when <code>packages.marker</code> necessitates synthetic groups for <code>project.dependencies</code>. This is an edge case; uv defaults to empty which is spec-compliant.</p>
<hr>
5. Root Project Extras with PEP 751 Markers
<p>Root project dependencies use PEP 751 <code>&#x27;extra&#x27; in extras</code> syntax:</p>
<p><strong>Input (<code>pyproject.toml</code>):</strong></p>
<pre><code>[project]
name = &quot;my-project&quot;
dependencies = [&quot;flask&gt;=3.0&quot;]

[project.optional-dependencies]
test = [&quot;pytest&gt;=8.0&quot;]
</code></pre>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>[[packages]]
name = &quot;my-project&quot;
dependencies = [
    { name = &quot;flask&quot;, version = &quot;3.0.2&quot; },
    { name = &quot;pytest&quot;, version = &quot;8.1.1&quot;, marker = &quot;&#x27;test&#x27; in extras&quot; },
]
directory = { path = &quot;.&quot;, editable = true }
</code></pre>
<p>The <code>pytest</code> dependency has marker <code>&#x27;test&#x27; in extras</code> indicating it&#x27;s only installed when the <code>test</code> extra is requested.</p>
<hr>
6. Root Project Dependency Groups with PEP 751 Markers
<p>Root project dependencies use PEP 751 <code>&#x27;group&#x27; in dependency_groups</code> syntax:</p>
<p><strong>Input (<code>pyproject.toml</code>):</strong></p>
<pre><code>[project]
name = &quot;my-project&quot;
dependencies = [&quot;flask&gt;=3.0&quot;]

[dependency-groups]
dev = [&quot;ruff&gt;=0.4.0&quot;]
</code></pre>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>[[packages]]
name = &quot;my-project&quot;
dependencies = [
    { name = &quot;flask&quot;, version = &quot;3.0.2&quot; },
    { name = &quot;ruff&quot;, version = &quot;0.4.5&quot;, marker = &quot;&#x27;dev&#x27; in dependency_groups&quot; },
]
directory = { path = &quot;.&quot;, editable = true }
</code></pre>
<p>The <code>ruff</code> dependency has marker <code>&#x27;dev&#x27; in dependency_groups</code> indicating it&#x27;s only installed when the <code>dev</code> dependency group is requested.</p>
<hr>
7. Transitive Package Extras with PEP 508 Markers
<p>Transitive packages (not the root project) use standard PEP 508 <code>extra == &#x27;name&#x27;</code> syntax:</p>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>[[packages]]
name = &quot;flask&quot;
version = &quot;3.0.2&quot;
dependencies = [
    { name = &quot;click&quot;, version = &quot;8.1.7&quot; },
    { name = &quot;python-dotenv&quot;, version = &quot;1.0.1&quot;, marker = &quot;extra == &#x27;dotenv&#x27;&quot; },
]
</code></pre>
<p>The <code>python-dotenv</code> dependency uses PEP 508 syntax because it&#x27;s a dependency of <code>flask</code>, not the root project.</p>
<hr>
Complete Example with All Features
<p><strong>Input (<code>pyproject.toml</code>):</strong></p>
<pre><code>[project]
name = &quot;my-project&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [&quot;flask&gt;=3.0&quot;]

[project.optional-dependencies]
test = [&quot;pytest&gt;=8.0&quot;]
docs = [&quot;sphinx&gt;=7.0&quot;]

[dependency-groups]
dev = [&quot;ruff&gt;=0.4.0&quot;]
type = [&quot;mypy&gt;=1.10.0&quot;]

[tool.uv]
environments = [
  &quot;sys_platform == &#x27;darwin&#x27;&quot;,
  &quot;sys_platform == &#x27;linux&#x27;&quot;,
]
</code></pre>
<p><strong>Output (<code>pylock.toml</code>):</strong></p>
<pre><code>lock-version = &quot;1.0&quot;
created-by = &quot;uv&quot;
environments = [
    &quot;sys_platform == &#x27;darwin&#x27;&quot;,
    &quot;sys_platform == &#x27;linux&#x27;&quot;,
]
requires-python = &quot;&gt;=3.12&quot;
extras = [
    &quot;docs&quot;,
    &quot;test&quot;,
]
dependency-groups = [
    &quot;dev&quot;,
    &quot;type&quot;,
]

[[packages]]
name = &quot;my-project&quot;
marker = &quot;sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;&quot;
dependencies = [
    { name = &quot;flask&quot;, version = &quot;3.0.2&quot;, marker = &quot;sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;&quot; },
    { name = &quot;pytest&quot;, version = &quot;8.1.1&quot;, marker = &quot;(sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;) and &#x27;test&#x27; in extras&quot; },
    { name = &quot;sphinx&quot;, version = &quot;7.2.6&quot;, marker = &quot;(sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;) and &#x27;docs&#x27; in extras&quot; },
    { name = &quot;ruff&quot;, version = &quot;0.4.5&quot;, marker = &quot;(sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;) and &#x27;dev&#x27; in dependency_groups&quot; },
    { name = &quot;mypy&quot;, version = &quot;1.10.0&quot;, marker = &quot;(sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;) and &#x27;type&#x27; in dependency_groups&quot; },
]
directory = { path = &quot;.&quot;, editable = true }

[[packages]]
name = &quot;flask&quot;
version = &quot;3.0.2&quot;
marker = &quot;sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;&quot;
dependencies = [
    { name = &quot;click&quot;, version = &quot;8.1.7&quot;, marker = &quot;sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;&quot; },
]
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/.../flask-3.0.2-py3-none-any.whl&quot;, hashes = { sha256 = &quot;...&quot; } },
]

[[packages]]
name = &quot;pytest&quot;
version = &quot;8.1.1&quot;
marker = &quot;(sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;) and &#x27;test&#x27; in extras&quot;
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/.../pytest-8.1.1-py3-none-any.whl&quot;, hashes = { sha256 = &quot;...&quot; } },
]

[[packages]]
name = &quot;ruff&quot;
version = &quot;0.4.5&quot;
marker = &quot;(sys_platform == &#x27;darwin&#x27; or sys_platform == &#x27;linux&#x27;) and &#x27;dev&#x27; in dependency_groups&quot;
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/.../ruff-0.4.5-py3-none-any.whl&quot;, hashes = { sha256 = &quot;...&quot; } },
]
</code></pre>
<p><strong>Features demonstrated:</strong></p>
<ol>
<li><code>environments</code> lists platform markers</li>
<li><code>extras</code> lists available extras</li>
<li><code>dependency-groups</code> lists available groups</li>
<li>Packages have combined platform + extras/groups markers</li>
<li>Root project uses PEP 751 syntax (<code>&#x27;test&#x27; in extras</code>, <code>&#x27;dev&#x27; in dependency_groups</code>)</li>
</ol>
<hr>
Marker Syntax Summary
<p>| Dependency Type | Marker Syntax | Example |
|----------------|---------------|---------|
| Unconditional | <em>(no marker)</em> | <code>{ name = &quot;flask&quot;, version = &quot;3.0.2&quot; }</code> |
| Platform-specific | PEP 508 | <code>marker = &quot;sys_platform == &#x27;win32&#x27;&quot;</code> |
| Root project extra | PEP 751 | <code>marker = &quot;&#x27;test&#x27; in extras&quot;</code> |
| Root project group | PEP 751 | <code>marker = &quot;&#x27;dev&#x27; in dependency_groups&quot;</code> |
| Transitive extra | PEP 508 | <code>marker = &quot;extra == &#x27;dotenv&#x27;&quot;</code> |</p>
<hr>
PEP 751 Compliance Status
‚úÖ Fully Implemented
<p>All <strong>required</strong> fields:</p>
<ul>
<li><code>lock-version</code></li>
<li><code>created-by</code></li>
<li><code>[[packages]]</code> and <code>packages.name</code></li>
</ul>
<p>All <strong>optional</strong> core fields:</p>
<ul>
<li><code>environments</code> (resolution fork markers)</li>
<li><code>requires-python</code></li>
<li><code>extras</code></li>
<li><code>dependency-groups</code></li>
<li><code>default-groups</code> (empty by design, spec-compliant)</li>
<li>All package source types (<code>vcs</code>, <code>directory</code>, <code>archive</code>, <code>sdist</code>, <code>wheels</code>)</li>
<li>All sub-fields (<code>upload-time</code>, <code>hashes</code>, <code>marker</code>, <code>requires-python</code>, <code>dependencies</code>)</li>
<li>PEP 751 marker syntax (<code>&#x27;extra&#x27; in extras</code>, <code>&#x27;group&#x27; in dependency_groups</code>)</li>
<li>Installation from pylock.toml files via <code>uv pip install -r pylock.toml</code></li>
</ul>
‚ö†Ô∏è Not Yet Implemented (Optional Features)
<ol>
<li><p><strong><code>[[packages.attestation-identities]]</code></strong>: Not implemented. PEP 751 says tools &quot;SHOULD include the attestation identities found&quot; for supply chain security/provenance tracking.</p>
</li>
<li><p><strong><code>[packages.tool]</code></strong>: Not implemented. Allows package-level tool metadata (similar to root-level <code>[tool]</code> but per-package).</p>
</li>
</ol>
<hr>
Usage
<pre><code># Export a project to pylock.toml format
uv export --format pylock.toml &gt; pylock.toml

# Export with platform restrictions
# (in pyproject.toml: tool.uv.environments = [&quot;sys_platform == &#x27;linux&#x27;&quot;])
uv export --format pylock.toml &gt; pylock.linux.toml

# Install from the multi-use lock file (base dependencies only)
uv pip install -r pylock.toml

# Install with specific extras
uv pip install -r pylock.toml --extra test --extra docs

# Install with specific dependency groups
uv pip install -r pylock.toml --group dev --group type

# Install with both extras and dependency groups
uv pip install -r pylock.toml --extra test --group dev
</code></pre>
<p>Resolves #13060</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-18 15:54</div>
            <div class="timeline-body"><p>I think this is more involved because we also need to preserve extra markers throughout the graph? Right now I believe they (intentionally) get resolved away <code>ExportableRequirements::from_lock</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-07-18 16:04</div>
            <div class="timeline-body"><blockquote>
<p>I think this is more involved because we also need to preserve extra markers throughout the graph? Right now I believe they (intentionally) get resolved away <code>ExportableRequirements::from_lock</code>.</p>
</blockquote>
<p>Yeah, ü§î this just computes for now the passed in extras/groups, but populating that into packages likely is more complicated. Looking at it, but feedback welcome.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Populate complete pylock.toml&quot; to &quot;Populate more information into pylock.toml&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-07-18 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/paveldikov">@paveldikov</a> reviewed on 2025-07-18 18:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/paveldikov">@paveldikov</a> on <code>crates/uv-resolver/src/lock/export/pylock_toml.rs</code>:1 on 2025-07-18 18:31</div>
            <div class="timeline-body"><p>question: is the aim here to cover <code>uv export</code> only? Or <code>uv pip compile</code> to be covered as well?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2025-07-19 15:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>crates/uv-resolver/src/lock/export/pylock_toml.rs</code>:1 on 2025-07-19 15:10</div>
            <div class="timeline-body"><p>For now let&#x27;s start with <code>uv export</code>, <code>pip compile</code> can come afterwards.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Populate more information into pylock.toml&quot; to &quot;feat: Add PEP 751 multi-use lock file support with extras and dependency groups markers&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-08 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-08 22:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/it/export.rs</code>:3652 on 2026-01-12 09:26</div>
            <div class="timeline-body"><p>Those dependencies aren&#x27;t conditional - do we need a simplify/complexify, or is this a marker graph implication?</p>
<p>https://inspector.pypi.io/project/anyio/3.7.0/packages/68/fe/7ce1926952c8a403b35029e194555558514b365ad77d75125f521a2bec62/anyio-3.7.0-py3-none-any.whl/anyio-3.7.0.dist-info/METADATA#line.26</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-pep508/src/marker/lowering.rs</code>:173 on 2026-01-12 09:28</div>
            <div class="timeline-body"><p>The added docstrings don&#x27;t add information here. We should either keep as-is, or add docstrings that explain e.g. what list</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/lock/export/marker_conversion.rs</code>:68 on 2026-01-12 09:31</div>
            <div class="timeline-body"><p>We should not parse this format, we know what conflicts there are from resolution input and resolution output.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/lock/export/marker_conversion.rs</code>:113 on 2026-01-12 09:34</div>
            <div class="timeline-body"><p>dead code</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-12 09:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2026-01-12 15:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>crates/uv/tests/it/export.rs</code>:3652 on 2026-01-12 15:35</div>
            <div class="timeline-body"><p>Ah, you&#x27;re correct fixed it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-12 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-12 18:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/lock/export/marker_conversion.rs</code>:7 on 2026-01-12 18:32</div>
            <div class="timeline-body"><p>These comments are now outdated</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-12 18:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/it/export.rs</code>:3881 on 2026-01-12 18:50</div>
            <div class="timeline-body"><p>Here, we need to use <code>extra ==</code>: That is not provided by the lockfile, but by flask.</p>
<p>Can you add a test case specifically for having conflicting dependencies and transitives extras?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>crates/uv/tests/it/export.rs</code>:3881 on 2026-01-12 19:16</div>
            <div class="timeline-body"><p>Done now I believe ü§î</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2026-01-12 19:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-12 19:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feat: Add PEP 751 multi-use lock file support with extras and dependency groups markers&quot; to &quot;feat: Add PEP 751 environments field and tool metadata to pylock.toml export&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-12 23:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feat: Add PEP 751 environments field and tool metadata to pylock.toml export&quot; to &quot;feat: Implement PEP 751 multi-use lock files with extras, dependency groups, and environments&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-12 23:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feat: Implement PEP 751 multi-use lock files with extras, dependency groups, and environments&quot; to &quot;feat: Implement PEP 751 multi-use lock files with extras, groups, and environments&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-12 23:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feat: Implement PEP 751 multi-use lock files with extras, groups, and environments&quot; to &quot;feat: Complete PEP 751 multi-use lock file implementation for pylock.toml&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-12 23:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-13 08:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/it/export.rs</code>:3881 on 2026-01-13 08:13</div>
            <div class="timeline-body"><p>I was thinking about a specific scenario: there&#x27;s conflicting extras a1 and a2, which depend on b[e1] and b[e2] respectively, so that we have an <code>&quot;a1&quot; in extras</code> that conditionally activates a <code>; extra == &quot;e1&quot;</code> dependency. This test should cover what the other new tests currently cover.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-13 08:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/lock/export/pylock_toml.rs</code>:734 on 2026-01-13 08:14</div>
            <div class="timeline-body"><p>This should go in a different PR, it&#x27;s a different change adding information that may change from version to version from adding fields that are always the same for a given resolution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-13 08:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/it/export.rs</code>:3881 on 2026-01-13 08:15</div>
            <div class="timeline-body"><p>We should also text that installation covers the correct subset.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2026-01-13 14:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>crates/uv-resolver/src/lock/export/pylock_toml.rs</code>:734 on 2026-01-13 14:20</div>
            <div class="timeline-body"><p>It&#x27;s mostly just encoding as machine readable toml what we already encoding as comment, and is part defined by the pep ü§î</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2026-01-13 14:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>crates/uv-resolver/src/lock/export/pylock_toml.rs</code>:734 on 2026-01-13 14:20</div>
            <div class="timeline-body"><p>It&#x27;s mostly just encoding as machine readable toml what we already encoding as comment, and is part defined by the pep ü§î</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-13 15:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/lock/export/pylock_toml.rs</code>:734 on 2026-01-13 15:02</div>
            <div class="timeline-body"><p>Fair, but the PR is large enough that I appreciate everything we can break out into a separately reviewable and mergable PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-14 14:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feat: Complete PEP 751 multi-use lock file implementation for pylock.toml&quot; to &quot;feat: Complete PEP 751 multi-use lock file for pylock.toml export&quot; by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-20 21:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2026-01-21 01:47</div>
            <div class="timeline-body">

<a href="https://codspeed.io/astral-sh/uv/branches/gaborbernat%3Atoml-extra?utm_source=github&amp;utm_medium=comment&amp;utm_content=header">CodSpeed Performance Report</a>
Merging this PR will <strong>not alter performance</strong>
<p>Comparing <code>gaborbernat:toml-extra</code> (3b10b90) with <code>main</code> (ba13064)</p>
Summary
<p><code>‚úÖ 5</code> untouched benchmarks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2026-01-21 08:21</div>
            <div class="timeline-body"><p>Once the <code>extra</code> vs. <code>extras</code> part is working, can you describe what algorithm we use for it and how we pass the required data through? This would be crucial to understand the approach this PR is taking and to verify whether it&#x27;s correct.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2026-01-21 13:53</div>
            <div class="timeline-body"><blockquote>
<p>Once the <code>extra</code> vs. <code>extras</code> part is working, can you describe what algorithm we use for it and how we pass the required data through? This would be crucial to understand the approach this PR is taking and to verify whether it&#x27;s correct.</p>
</blockquote>
<p>Sure.</p>
<blockquote>
<p>Once the <code>extra</code> vs. <code>extras</code> part is working</p>
</blockquote>
<p>What do you mean here exactly? Just so I fix the right thing üòÖ</p>
<p>For now trying to understand the reason for that soke failing test.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-21 13:59:35 UTC
    </footer>
</body>
</html>
