<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `uv export --format requirements.txt` - astral-sh/uv #6778</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>uv export --format requirements.txt</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/6778">#6778</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-08-28 21:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>The interface here is intentionally a bit more limited than <code>uv pip compile</code>, because we don't want <code>requirements.txt</code> to be a system of record -- it's just an export format. So, we don't write annotation comments (i.e., which dependency is requested from which), we don't allow writing extras, etc. It's just a flat list of requirements, with their markers and hashes.</p>
<p>Closes #6007.</p>
<p>Closes #6668.</p>
<p>Closes #6670.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-cli/src/lib.rs</code>:2787 on 2024-08-28 22:03</div>
            <div class="timeline-body"><p>Right now this is a required argument, even though we only support one format. We could make it optional, or even remove it? But if we add formats in the future, it will then be breaking.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-28 22:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-28 22:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-cli/src/lib.rs</code>:2787 on 2024-08-28 22:10</div>
            <div class="timeline-body"><p>I don't mind this, kind of funny though. What else might we support?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-28 22:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-cli/src/lib.rs</code>:2787 on 2024-08-28 22:27</div>
            <div class="timeline-body"><p>Perhaps some world in which we support PEP 751 if we end up with a more narrow PEP that doesn't do universal locking?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-08-28 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-08-28 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2024-08-28 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-28 22:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/tests/export.rs</code>:163 on 2024-08-28 22:38</div>
            <div class="timeline-body"><p>Wait... I thought this was a cool feature, but I don't think there's any way to &quot;activate&quot; these from <code>uv pip install</code> or <code>pip install</code>...? So we might need the <code>export</code> API to accept extras, to tell us which to include.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-28 22:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-cli/src/lib.rs</code>:2787 on 2024-08-28 22:39</div>
            <div class="timeline-body"><p>Actually, we can just make this an optional with a default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-cli/src/lib.rs</code>:2778 on 2024-08-29 08:30</div>
            <div class="timeline-body"><p>As written (kebab-case), only <code>requirements-txt</code> (dash, not dot) is supported</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-cli/src/lib.rs</code>:2784 on 2024-08-29 08:31</div>
            <div class="timeline-body"><p>More nitpick: We're always in a workspace (<code>uv export --package dummy</code> works with single <code>pyproject.toml</code> <code>project.name = &quot;dummy&quot;</code>)</p>
<pre><code class="language-suggestion">    /// If the workspace member does not exist, uv will exit with an error.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/export.rs</code>:26 on 2024-08-29 08:46</div>
            <div class="timeline-body"><p>Setuptools already requires wheel nowadays (https://setuptools.pypa.io/en/latest/build_meta.html#how-to-use-it)</p>
<pre><code class="language-suggestion">        requires = [&quot;setuptools&gt;=42&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/export.rs</code>:319 on 2024-08-29 08:48</div>
            <div class="timeline-body"><p>Could you add a comment on why we expect the markers to disappear? The combination of <code>python_version &gt; '3.11'</code> and <code>requires_python = &quot;&gt;=3.12&quot;</code> is hard to spot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-08-29 09:14</div>
            <div class="timeline-body"><p>Looks good! Only some nitpicks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-29 14:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/tests/export.rs</code>:26 on 2024-08-29 14:32</div>
            <div class="timeline-body"><p>Oh nice. I will change this separately since it's in all tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-29 17:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-cli/src/lib.rs</code>:2817 on 2024-08-29 17:14</div>
            <div class="timeline-body"><p>Can we write a bit more here? What are the implications for a user running an export here?  e.g.</p>
<blockquote>
<p>Do not update the <code>uv.lock</code> before exporting.</p>
<p>If a <code>uv.lock</code> does not exist, uv will exit with an error.</p>
</blockquote>
<p>Did you copy these from somewhere? I thought I touched most of these up to say stuff like that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-29 17:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/help.rs</code>:705 on 2024-08-29 17:15</div>
            <div class="timeline-body"><p>Should we say <code>project's</code> for consistency?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-08-29 17:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-29 17:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-cli/src/lib.rs</code>:2817 on 2024-08-29 17:24</div>
            <div class="timeline-body"><p>The <code>LockArgs</code> one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-cli/src/lib.rs</code>:2817 on 2024-08-29 17:31</div>
            <div class="timeline-body"><p>Ah, that one is the simplest because it's for <code>uv lock</code>. I'd look at the styling in <code>uv sync</code></p>
<pre><code>      --locked
          Assert that the `uv.lock` will remain unchanged.
          
          Requires that the lockfile is up-to-date. If the lockfile is missing or needs to be updated, uv will exit with an error.

      --frozen
          Sync without updating the `uv.lock` file.
          
          Instead of checking if the lockfile is up-to-date, uses the versions in the lockfile as the source of truth. If the lockfile
          is missing, uv will exit with an error. If the `pyproject.toml` includes changes to dependencies that have not been included
          in the lockfile yet, they will not be present in the environment.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-29 17:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-08-29 17:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-29 17:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-08-29 17:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/helderco">@helderco</a> on 2024-08-30 17:12</div>
            <div class="timeline-body"><p>Pretty cool, this will help migrate to <code>uv.lock</code> because users will have a way to revert easily if needed. ðŸŽ‰</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:39:16 UTC
    </footer>
</body>
</html>
