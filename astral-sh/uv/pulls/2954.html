<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enforce and backtrack on invalid versions in source metadata - astral-sh/uv #2954</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Enforce and backtrack on invalid versions in source metadata</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/2954">#2954</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-04-10 05:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-10 05:03</div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>If we build a source distribution from the registry, and the version doesn't match that of the filename, we should error, just as we do for mismatched package names. However, we should also backtrack here, which we didn't previously.</p>
<p>Closes https://github.com/astral-sh/uv/issues/2953.</p>
<h2>Test Plan</h2>
<p>Verified that <code>cargo run pip install docutils --verbose --no-cache --reinstall</code> installs <code>docutils==0.21</code> instead of the invalid <code>docutils==0.21.post1</code>.</p>
<p>In the logs, I see:</p>
<pre><code>WARN Unable to extract metadata for docutils: Package metadata version `0.21` does not match given version `0.21.post1`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Validate built version in source distribution database" to "Enforce and backtrack on invalid versions in source metadata" by @charliermarsh on 2024-04-10 05:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-04-10 05:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2024-04-10 05:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-04-10 05:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-04-10 05:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-04-10 05:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 14:43:51 UTC
    </footer>
</body>
</html>
