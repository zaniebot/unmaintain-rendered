<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Box clap commands to avoid windows debug clap stack overflow - astral-sh/uv #4768</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Box clap commands to avoid windows debug clap stack overflow</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/4768">#4768</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-07-03 12:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/konstin">@konstin</a> on 2024-07-03 12:58</div>
            <div class="timeline-body"><p>The changes in https://github.com/astral-sh/uv/pull/4708 caused an overflow in debug mode only of the 1MB default stack size in windows during clap. This means that even trivial wrong argument tests would fail without increasing the stack size. As remedy, we box the clap types.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @konstin on 2024-07-03 12:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @konstin on 2024-07-03 12:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-03 12:59</div>
            <div class="timeline-body"><p>I feel like Ibraheem said the size was still not that big though? Where is the rest of the stack being used?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-03 13:04</div>
            <div class="timeline-body"><p>The stack size was not the problem, but the tests that didn't set the stack size because they were only testing clap behavior, as you can see in https://github.com/astral-sh/uv/actions/runs/9777625178/job/26992714658.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-03 13:33</div>
            <div class="timeline-body"><p>I've confirmed in https://github.com/astral-sh/uv/actions/runs/9778590193/job/26995771136?pr=4765 that this unblocks #4708 and we can return to the 8MB stack size.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-07-03 13:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> approved on 2024-07-03 16:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @konstin on 2024-07-03 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-07-03 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-03 17:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 13:48:47 UTC
    </footer>
</body>
</html>
