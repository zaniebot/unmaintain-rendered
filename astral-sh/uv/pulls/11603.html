<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Require the command in `uvx &lt;name&gt;` to be available in the Python environment - astral-sh/uv #11603</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Require the command in <code>uvx &lt;name&gt;</code> to be available in the Python environment</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/11603">#11603</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-02-18 19:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Closes <a href="https://github.com/astral-sh/uv/issues/7804">astral-sh/uv#7804</a></p>
<p>Includes a few small minor changes to the messaging, but the primary change is that in, e.g., <code>uvx foo</code>, if the <code>foo</code> package does not provide the <code>foo</code> executable we will no longer execute an arbitrary <code>foo</code> executable if present on the <code>PATH</code>. This prevents confusing and surprising behavior, such as the user reported where they did <code>uv tool install foobar</code> (which provides <code>foo</code>) then <code>uvx foo</code> (which does not provide <code>foo</code>) later falls back to the executable provided by <code>foobar</code> since it&#x27;s on the <code>PATH</code>. We don&#x27;t enforce this for <code>--from</code>, so things like <code>uvx --from foo bash -c &quot;...&quot;</code> are still totally valid. We also still allow <code>uvx foo</code> where the <code>foo</code> executable is provided by a <em>dependency</em> of <code>foo</code> instead of <code>foo</code> itself.</p>
<p>Most of the diff here is consolidating the logic of the <code>hint_on_not_found</code> and <code>warn_executable_not_provided_by_package </code> utilities.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 20:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:276 on 2025-02-18 20:04</div>
            <div class="timeline-body"><p>The user is already using <code>--from</code> here, I don&#x27;t think we should hint it again.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:298 on 2025-02-18 20:05</div>
            <div class="timeline-body"><p>We no longer attempt to execute this / succeed if it&#x27;s on the <code>PATH</code>. Instead, we exit early.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 20:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 20:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:298 on 2025-02-18 20:05</div>
            <div class="timeline-body"><p>Arguably, this is breaking — but I think this is a bug.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 20:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:2206 on 2025-02-18 20:06</div>
            <div class="timeline-body"><p>I&#x27;m sort of tempted to just run the command when it matches the module-normalized package name :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 20:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/run.rs</code>:342 on 2025-02-18 20:07</div>
            <div class="timeline-body"><p>I&#x27;m not super pleased with this. It&#x27;d be nice to just avoid this by construction.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 20:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:276 on 2025-02-18 20:25</div>
            <div class="timeline-body"><p>It&#x27;s intended to be shown for like</p>
<pre><code>❯ uvx fastapi-cli
Installed 21 packages in 46ms
The executable `fastapi-cli` was not found.
warning: An executable named `fastapi-cli` is not provided by package `fastapi-cli`.
The following executables are provided by `fastapi-cli`:
- fastapi
Consider using `uvx --from fastapi-cli &lt;EXECUTABLE_NAME&gt;` instead.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 21:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/run.rs</code>:342 on 2025-02-18 21:28</div>
            <div class="timeline-body"><p>Fixed in <a href="https://github.com/astral-sh/uv/pull/11603">astral-sh/uv#11603</a>/commits/913dd90ad41683532f8c961b14864055483a04fe</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Improve executable checks in `uvx`&quot; to &quot;Require the command in `uvx &lt;name&gt;` to be available in the Python environment&quot; by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 21:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 21:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-02-18 21:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:2203 on 2025-02-18 21:32</div>
            <div class="timeline-body"><p>Agonizing about whether or not there should be a blank newline here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/src/commands/tool/run.rs</code>:324 on 2025-04-18 15:14</div>
            <div class="timeline-body"><p><code>Python environment</code></p>
<p><code>run in</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/src/commands/tool/run.rs</code>:522 on 2025-04-18 15:18</div>
            <div class="timeline-body"><p>It seems surprising that <code>Display</code> doesn&#x27;t display the representation of the type but warning and error information. Should this be a separate dedicated function or method?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-04-18 15:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-04-18 15:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/tests/it/tool_run.rs</code>:298 on 2025-04-18 15:21</div>
            <div class="timeline-body"><p>Yeah, I think as a user I wouldn&#x27;t expect <code>uvx</code> to execute something just because it&#x27;s on the <code>PATH</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-04-18 15:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/tests/it/tool_run.rs</code>:2203 on 2025-04-18 15:22</div>
            <div class="timeline-body"><p>Maybe I tend toward no newline since it feels connected to the line above, but no strong feeling</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-04-18 15:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/tests/it/tool_run.rs</code>:2206 on 2025-04-18 15:24</div>
            <div class="timeline-body"><p>It does seem designed to confound the user. But are there cases where this could be a coincidence?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-04-18 15:25</div>
            <div class="timeline-body"><p>Left a few comments but generally looks good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> approved on 2025-04-18 15:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 16:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/run.rs</code>:522 on 2025-04-18 16:06</div>
            <div class="timeline-body"><p>I&#x27;m not sure, the type only exists for the purpose of rendering these messages. Previously, it was a function that called <code>warn_user</code> and <code>println</code> directly but here I want the caller to be able to make that decision and I think <code>Display</code> is the easiest way to do that. I think I&#x27;d just end up needing into introduce a separate type, like <code>ExecutableProviderPackagesDisplay</code> that implements <code>Display</code>? Or I&#x27;d need to implement like <code>fn message(&amp;self)-&gt; String</code> and construct a string instead of using <code>Formatter</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-04-18 17:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/src/commands/tool/run.rs</code>:522 on 2025-04-18 17:31</div>
            <div class="timeline-body"><p>I was confused when I encountered <code>writeln!(printer.stderr(), &quot;{providers}&quot;)?;</code> above (before seeing this code). I didn&#x27;t understand why you would just log the providers without context. It seems pretty non-standard to have <code>Display</code> perform conditional logic and log warnings.</p>
<p>I&#x27;d recommend something like <code>providers.log_warnings()</code> (or something more descriptive) to accomplish what you&#x27;re doing here. You could pass in <code>printer</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 20:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/run.rs</code>:522 on 2025-04-18 20:46</div>
            <div class="timeline-body"><blockquote>
<p>perform conditional logic and log warnings.</p>
</blockquote>
<p>To be clear, it only logs one warning (which we could omit, but I don&#x27;t think it really hurts — it&#x27;s a case that should never happen). The rest of it is just writing to the formatter.</p>
<p>I can&#x27;t use a function that takes a <code>printer</code> because I want to be able to use it in <code>warn_user_once</code>.</p>
<p>I see this as the same thing as implementing <code>Display</code> on an error type, which we frequently include more context on. Would it be clearer if it was named like <code>ExecutableProviderHints</code> instead?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/src/commands/tool/run.rs</code>:522 on 2025-04-18 20:48</div>
            <div class="timeline-body"><p>Yeah that would be clearer</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-04-18 20:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 21:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/run.rs</code>:522 on 2025-04-18 21:34</div>
            <div class="timeline-body"><p>That makes sense, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-18 21:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 21:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:2206 on 2025-04-18 21:38</div>
            <div class="timeline-body"><p>I can&#x27;t really think of one, no.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 21:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/it/tool_run.rs</code>:2206 on 2025-04-18 21:50</div>
            <div class="timeline-body"><p>Tracking in #12976</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-18 21:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-18 21:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-04-18 21:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:50:56 UTC
    </footer>
</body>
</html>
