<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Implement `uv help` manually instead of using Clap default - astral-sh/uv #4906</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Implement <code>uv help</code> manually instead of using Clap default</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/4906">#4906</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-07-08 19:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Extends #4772</p>
<p>Implements <code>uv help</code> ourselves so we can do things like #4909
Adds hints to use <code>uv help</code> for more details during short help display.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-08 19:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-07-08 19:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/help.rs</code>:25 on 2024-07-08 19:47</div>
            <div class="timeline-body"><p>Should move this to the bottom again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 00:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 00:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 00:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-07-09 08:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/help.rs</code>:237 on 2024-07-09 08:56</div>
            <div class="timeline-body"><p>This should keep the uv prefix</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-07-09 08:58</div>
            <div class="timeline-body"><p>Found a way to make it panic, but i do like the more concise help a lot.</p>
<pre><code>$ cargo run -q -- help pip install
thread &#x27;main&#x27; panicked at /home/konsti/.cargo/registry/src/index.crates.io-6f17d22bba15001f/clap_builder-4.5.8/src/builder/debug_asserts.rs:214:13:
Command install: Argument or group &#x27;offline&#x27; specified in &#x27;conflicts_with*&#x27; for &#x27;refresh&#x27; does not exist
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-07-09 14:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/help.rs</code>:237 on 2024-07-09 14:35</div>
            <div class="timeline-body"><p>Will investigate. I don&#x27;t know how Clap renders these things in a parent-aware style.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/help.rs</code>:237 on 2024-07-09 17:14</div>
            <div class="timeline-body"><p>Fixed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-07-09 17:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 17:14</div>
            <div class="timeline-body"><p>Fixed the panic :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 17:28</div>
            <div class="timeline-body"><p>Should these be different?</p>
<pre><code>puffin on ÓÇ† zb/cli-help-cmd [$] is üì¶ v0.2.23 via üêç v3.12.3 via ü¶Ä v1.79.0
‚ùØ cargo run -- python --help
   Compiling uv-cli v0.0.1 (/Users/crmarsh/workspace/puffin/crates/uv-cli)
   Compiling uv v0.2.23 (/Users/crmarsh/workspace/puffin/crates/uv)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 2.81s
     Running `target/debug/uv python --help`
Manage Python installations

Usage: uv python [OPTIONS] &lt;COMMAND&gt;

Commands:
  list       List the available Python installations
  install    Download and install Python versions
  find       Search for a Python installation
  dir        Show the uv Python installation directory
  uninstall  Uninstall Python versions

Options:
  -q, --quiet                                  Do not print any output
  -v, --verbose...                             Use verbose output
      --color &lt;COLOR_CHOICE&gt;                   Control colors in output [default: auto] [possible values: auto, always, never]
      --native-tls                             Whether to load TLS certificates from the platform&#x27;s native certificate store [env: UV_NATIVE_TLS=]
      --offline                                Disable network access, relying only on locally cached data and locally available files
      --python-preference &lt;PYTHON_PREFERENCE&gt;  Whether to prefer using Python from uv or on the system [possible values: only-managed, installed, managed, system, only-system]
      --python-fetch &lt;PYTHON_FETCH&gt;            Whether to automatically download Python when required [possible values: automatic, manual]
  -n, --no-cache                               Avoid reading from or writing to the cache [env: UV_NO_CACHE=]
      --cache-dir &lt;CACHE_DIR&gt;                  Path to the cache directory [env: UV_CACHE_DIR=]
      --config-file &lt;CONFIG_FILE&gt;              The path to a `uv.toml` file to use for configuration [env: UV_CONFIG_FILE=]
  -h, --help                                   Print help
  -V, --version                                Print version

Use `uv help python` for more details.
puffin on ÓÇ† zb/cli-help-cmd [$] is üì¶ v0.2.23 via üêç v3.12.3 via ü¶Ä v1.79.0 took 3s
‚ùØ cargo run -- help python
   Compiling uv-cli v0.0.1 (/Users/crmarsh/workspace/puffin/crates/uv-cli)
   Compiling uv v0.2.23 (/Users/crmarsh/workspace/puffin/crates/uv)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 2.83s
     Running `target/debug/uv help python`
Manage Python installations

Usage: python &lt;COMMAND&gt;

Commands:
  list       List the available Python installations
  install    Download and install Python versions
  find       Search for a Python installation
  dir        Show the uv Python installation directory
  uninstall  Uninstall Python versions
  help       Print this message or the help of the given subcommand(s)

Options:
  -h, --help
          Print help (see a summary with &#x27;-h&#x27;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 17:32</div>
            <div class="timeline-body"><p>Yes they should be different but we should be displaying the long-form documentation for all those options in the second invocation. Will investigate that...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 17:33</div>
            <div class="timeline-body"><p>Ah I pushed a fix to #4909 but not here by accident.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-07-09 17:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 17:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-09 17:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-09 17:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:46:27 UTC
    </footer>
</body>
</html>
