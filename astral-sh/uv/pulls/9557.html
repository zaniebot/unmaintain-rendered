<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `--dry-run` to `uv pip uninstall` - astral-sh/uv #9557</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>--dry-run</code> to <code>uv pip uninstall</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/9557">#9557</a>
        opened by <a href="https://github.com/moreati">@moreati</a>
        on 2024-12-01 22:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/moreati">@moreati</a></div>
            <div class="timeline-body">

Summary
<p>This proposes adding the command line option <code>uv pip uninstall --dry-run ...</code>, complementing the existing <code>uv pip install --dry-run ...</code> added for #1244 in #1436.</p>
<p>This option does not exist in PyPA&#x27;s <code>pip uninstall</code>, if adopted it would be unique to <code>uv pip</code>. The code should be  considered PoC, it is baby&#x27;s first Rust.</p>
<p>The initial motivation was while investigating <a href="https://github.com/moreati/ansible-uv/issues/2">moreati/ansible-uv#2</a> - to allow Ansible module <code>moreati.uv.pip</code> to work with<code>state: absent</code> in &quot;check_mode&quot; (Ansible&#x27;s equivalent of a dry run),  without requiring <code>packaging</code> or <code>setuptools</code>.</p>
Test Plan
<p>One new unit test has been added. I pedge to add more if the feature is desired/accepted</p>
<p>Example usage</p>
<pre><code>➜  uv git:(pip-uninstall--dry-run) rm -rf .venv
➜  uv git:(pip-uninstall--dry-run) ./target/debug/uv venv                   
Using CPython 3.13.0
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
➜  uv git:(pip-uninstall--dry-run) ./target/debug/uv pip install httpx      
Resolved 7 packages in 178ms
Prepared 5 packages in 60ms
Installed 7 packages in 15ms
 + anyio==4.6.2.post1
 + certifi==2024.8.30
 + h11==0.14.0
 + httpcore==1.0.7
 + httpx==0.28.0
 + idna==3.10
 + sniffio==1.3.1
➜  uv git:(pip-uninstall--dry-run) ./target/debug/uv pip uninstall --dry-run httpx
Would uninstall 1 package
 - httpx==0.28.0
➜  uv git:(pip-uninstall--dry-run) ./target/debug/uv pip list                     
Package  Version
-------- -----------
anyio    4.6.2.post1
certifi  2024.8.30
h11      0.14.0
httpcore 1.0.7
httpx    0.28.0
idna     3.10
sniffio  1.3.1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/moreati">@moreati</a> on <code>crates/uv/src/commands/pip/uninstall.rs</code>:213 on 2024-12-01 22:42</div>
            <div class="timeline-body"><p>This <code>.dimmed()</code> might be redundant, given the one 2 lines down.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/moreati">@moreati</a> reviewed on 2024-12-01 22:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/moreati">@moreati</a> reviewed on 2024-12-01 22:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/moreati">@moreati</a> on <code>crates/uv/src/commands/pip/uninstall.rs</code>:233 on 2024-12-01 22:42</div>
            <div class="timeline-body"><p>This <code>.dimmed()</code> might be redundant, given the one 2 lines down.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-02 01:41</div>
            <div class="timeline-body"><p>I think this is a good idea! Happy to review it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-02 02:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-02 02:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-02 02:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-12-02 02:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-02 02:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-02 02:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-12-02 04:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/moreati">@moreati</a> on 2024-12-02 04:22</div>
            <div class="timeline-body"><p>Thanks, that was <em>way</em> faster and more decisive than I dreamed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;RFC: Add `--dry-run` to `uv pip uninstall`&quot; to &quot;Add `--dry-run` to `uv pip uninstall`&quot; by <a href="https://github.com/moreati">@moreati</a> on 2024-12-02 04:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:49:38 UTC
    </footer>
</body>
</html>
