<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feat(audit): add audit command for Python package vulnerability scanning - astral-sh/uv #15053</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>feat(audit): add audit command for Python package vulnerability scanning</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/15053">#15053</a>
        opened by <a href="https://github.com/nyudenkov">@nyudenkov</a>
        on 2025-08-04 06:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/nyudenkov">@nyudenkov</a></div>
            <div class="timeline-body">

Summary
<p>This PR implements the <code>uv audit</code> command as requested in issue #9189. The new command scans Python project dependencies for known security vulnerabilities offering multiple vulnerability data sources and several output formats.</p>
Multiple Vulnerability Data Sources
<ul>
<li><strong>PyPA Advisory Database</strong> (default) - ZIP download with local caching [https://github.com/pypa/advisory-database/archive/main.zip]</li>
<li><strong>PyPI JSON API</strong> - Direct queries to PyPI for real-time data  [https://pypi.org/pypi/{name}/{version}/json]</li>
<li><strong>OSV.dev API</strong> - Queries to Open Source Vulnerabilities database [https://api.osv.dev/v1]</li>
</ul>
Flexible Output Formats
<ul>
<li><strong>Human-readable</strong></li>
<li><strong>JSON</strong></li>
<li><strong>SARIF</strong></li>
</ul>
<p><strong>Command Usage:</strong></p>
<pre><code># Basic vulnerability scanning
uv audit                           # scan current project

# Choose vulnerability data source
uv audit --source pypa-zip         # PyPA Advisory DB (default, fastest)
uv audit --source pypi             # PyPI JSON API
uv audit --source osv              # OSV.dev API

# Output formats for different use cases
uv audit --format json             # automation &amp; CI/CD
uv audit --format sarif            # GitHub/GitLab integration
uv audit --output security-report.json  # save to file

# Advanced filtering and control
uv audit --severity critical,high  # only serious vulnerabilities
uv audit --ignore GHSA-xxxx-xxxx-xxxx CVE-2023-12345  # skip specific issues
uv audit --no-cache               # bypass local cache
</code></pre>
Test Plan
<p><strong>Unit Tests:</strong></p>
<ul>
<li>37 test cases covering all major functionality</li>
<li>Cache management and TTL handling</li>
<li>Output format generation (JSON, SARIF, human-readable)</li>
<li>Error handling for missing files and network issues</li>
</ul>
<p><strong>Integration Tests:</strong></p>
<ul>
<li>CLI command parsing and execution</li>
<li>Multiple output format validation</li>
<li>Cache behavior verification</li>
</ul>
<p><strong>Manual Testing:</strong></p>
<ul>
<li>Tested against real Python projects with known vulnerabilities</li>
<li>Verified output formats are properly structured</li>
<li>Confirmed performance with large dependency trees</li>
<li>Validated caching reduces subsequent scan times</li>
</ul>
<p><strong>Edge Cases Covered:</strong></p>
<ul>
<li>Missing <code>uv.lock</code> and <code>pyproject.toml</code> files</li>
<li>Network connectivity issues</li>
<li>Malformed vulnerability data</li>
<li>Empty projects and projects with no vulnerabilities</li>
<li>Invalid command line arguments</li>
</ul>
<p>Resolves #9189</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-04 07:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-04 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-04 15:17</div>
            <div class="timeline-body"><p>@zanieb, hi! Requesting someone to make a review and help with these failing windows tests :&#x27;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-04 15:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-05 19:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-06 21:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MattTheCuber">@MattTheCuber</a> on 2025-08-06 22:31</div>
            <div class="timeline-body"><p>Why close this PR?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-06 22:34</div>
            <div class="timeline-body"><p>@MattTheCuber currently I&#x27;m moving it to a standalone tool because rn, unfortunately, uv team can&#x27;t review and approve this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MattTheCuber">@MattTheCuber</a> on 2025-08-06 22:38</div>
            <div class="timeline-body"><p>That is most unfortunate. I was excited to utilize this feature directly in UV.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyudenkov">@nyudenkov</a> on 2025-08-07 05:03</div>
            <div class="timeline-body"><p>@MattTheCuber
https://github.com/nyudenkov/pysentry
Here it is :)
Would be glad to hear feedback and suggestions on how to improve</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-09-23 19:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:53:27 UTC
    </footer>
</body>
</html>
