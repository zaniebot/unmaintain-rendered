<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Always treat conda environments named `base` and `root` as base environments - astral-sh/uv #15682</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Always treat conda environments named <code>base</code> and <code>root</code> as base environments</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/15682">#15682</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-09-04 14:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Extends <a href="https://github.com/astral-sh/uv/pull/15679">astral-sh/uv#15679</a></p>
<p>I&#x27;m not sure if we want to do this. It is probably <em>generally</em> true, but I think I&#x27;d rather remove the special casing entirely? I think the main case for this is that it could help prevent regressions from #15679 and we can remove it in a breaking release?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-15 21:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-15 21:38</div>
            <div class="timeline-body"><p>Feedback welcome here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2025-09-16 07:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2025-09-17 14:51</div>
            <div class="timeline-body"><p>Trying this out locally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-17 14:55</div>
            <div class="timeline-body"><p>Appreciate it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2025-09-17 16:18</div>
            <div class="timeline-body"><p>This branch fixes how expected this should work.</p>
<p>Environment:</p>
<pre><code>$ env | grep -i &quot;^CONDA&quot;
CONDA_SHLVL=1
CONDA_EXE=/home/STRIKETECH/dshaw/miniforge3/bin/conda
CONDA_PREFIX=/home/STRIKETECH/dshaw/miniforge3
CONDA_PKGS_DIRS=/scratch/.cache/conda/pkgs
CONDA_PYTHON_EXE=/home/STRIKETECH/dshaw/miniforge3/bin/python
CONDA_PROMPT_MODIFIER=false
CONDA_DEFAULT_ENV=base
</code></pre>
<p>Current uv</p>
<pre><code>$ uv --version
uv 0.8.17

$ uv pip install python-stdnum
Using Python 3.13.2 environment at: /home/STRIKETECH/dshaw/miniforge3
Resolved 1 package in 67ms
Installed 1 package in 32ms
 + python-stdnum==2.1

$ uv pip uninstall python-stdnum
Using Python 3.13.2 environment at: /home/STRIKETECH/dshaw/miniforge3
Uninstalled 1 package in 6ms
</code></pre>
<p>This branches uv:</p>
<pre><code>$ ./target/release/uv --version
uv 0.8.17+58 (9410dc5c3 2025-09-17)

$  ./target/release/uv pip install python-stdnum
error: No virtual environment found; run `uv venv` to create an environment, or pass `--system` to install into a non-virtual environment
</code></pre>
<p>As an aside, I was initially confused because it turned out I had a stray virtual environment in my home directory, so this branches uv was installing and uninstalling to that, and I didn&#x27;t fully read the output and thought the behavior was the same.</p>
<p>Could not find any behavioral differences when installing into a non-base environment, even trying odd sequences of conda activate/deactivates, and in all those cases the new branch refused to install into the base.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-17 17:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-17 17:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-09-17 17:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:53:51 UTC
    </footer>
</body>
</html>
