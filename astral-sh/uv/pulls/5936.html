<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update the interface for declaring Python download preferences - astral-sh/uv #5936</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update the interface for declaring Python download preferences</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/5936">#5936</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-08-08 21:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>The loose consensus is that &quot;fetch&quot; doesn&#x27;t have much meaning and that a boolean flag makes more sense from the command line.</p>
<ol>
<li>Adds <code>--allow-python-downloads</code> (hidden, default) and <code>--no-python-downloads</code> to the CLI to quickly enable or disable downloads</li>
<li>Deprecates <code>--python-fetch</code> in favor of the options from (1)</li>
<li>Removes  <code>python-fetch</code> in favor of a <code>python-downloads</code> setting</li>
<li>Adds a <code>never</code> variant to the enum, allowing even explicit installs to be disabled via the configuration file</li>
</ol>
Test plan
<p>I tested this with various <code>pyproject.toml</code>-level settings and <code>uv venv --preview --python 3.12.2</code> and <code>uv python install 3.12.2</code> with and without the new CLI flags.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-08 21:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-08 21:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-08 21:35</div>
            <div class="timeline-body"><p>Notably I did not deprecate the <code>python-fetch</code> setting, just removed it. I&#x27;m not sure what the pattern is to deprecate a setting yet, nor am I sure it&#x27;s worth the extra effort.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-08 21:38</div>
            <div class="timeline-body"><p>I&#x27;m a little uncertain of the &quot;never&quot; value, but I do think it has some utility to require explicit opt-in from the CLI to install versions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-08 22:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-08 22:06</div>
            <div class="timeline-body"><p>Whoops I checked in my <code>pyproject.toml</code> change, and look, it works https://github.com/astral-sh/uv/actions/runs/10310109626/job/28541254932?pr=5936</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-09 02:48</div>
            <div class="timeline-body"><p>Thanks. Am I right that <code>--python-downloads</code> isn&#x27;t exposed on the command line? So those settings are only available in a configuration file?</p>
<p>I&#x27;m wondering it it should be <code>--download-python</code> and <code>--no-download-python</code> to match settings like <code>--compile-bytecode</code>. Are we consistent with that pattern?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-09 13:38</div>
            <div class="timeline-body"><p>I leaned away from <code>--download-python</code> because it won&#x27;t <em>force</em> Python to be downloaded, it just allows it if it would be, e.g. <code>--python-preference only-system --download-python</code> would still never download Python.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-09 13:39</div>
            <div class="timeline-body"><blockquote>
<p>Am I right that --python-downloads isn&#x27;t exposed on the command line? So those settings are only available in a configuration file?</p>
</blockquote>
<p>Yes, only a boolean option is available from the command line and the &quot;manual&quot; value is only accessible via the configuration file. I find that a little peculiar, but don&#x27;t think it&#x27;ll be problematic in practice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-08-09 18:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-09 18:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-09 18:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-08-09 18:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:47:16 UTC
    </footer>
</body>
</html>
