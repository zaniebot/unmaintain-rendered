<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support extras in editable requirements - astral-sh/uv #1113</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support extras in editable requirements</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1113">#1113</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-26 00:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-26 00:17</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR adds support for requirements like <code>-e .[d]</code>.</p>
<p>Closes #1091.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-01-26 00:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-01-26 00:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @charliermarsh on 2024-01-26 00:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-26 00:22</div>
            <div class="timeline-body"><p>Draft while I fix tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-resolver/src/resolution.rs</code>:168 on 2024-01-26 01:07</div>
            <div class="timeline-body"><p>This was an existing bug, we were dropping dependencies here in the annotation graph.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-26 01:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2024-01-26 01:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-26 01:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-resolver/tests/resolver.rs</code>:188 on 2024-01-26 01:11</div>
            <div class="timeline-body"><p>(An example of a dependency we lost, now fixed.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-26 01:11</div>
            <div class="timeline-body"><p>Ok, tests passing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/requirements-txt/src/lib.rs</code>:122 on 2024-01-26 08:38</div>
            <div class="timeline-body"><pre><code class="language-suggestion">                    Pep508ErrorSource::String(_) | Pep508ErrorSource::UrlError(_) =&gt; RequirementsTxtParserError::Pep508 {
                        start: err.start,
                        end: err.start + err.len,
                        source: err,
                    },
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/requirements-txt/src/lib.rs</code>:173 on 2024-01-26 08:48</div>
            <div class="timeline-body"><p>I find it too easy to mess up manual chars iteration (and harder too read) and the perf doesn't matter here.</p>
<pre><code class="language-rust">    let Some((path, extras)) = given
        .strip_suffix(&quot;]&quot;)
        .and_then(|given| given.rsplit_once(&quot;[&quot;))
    else {
        return None;
    };
    if extras.contains(&quot;]&quot;) {
        return None;
    }
    Some((paths, extras))
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-01-26 08:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-26 11:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/requirements-txt/src/lib.rs</code>:173 on 2024-01-26 11:55</div>
            <div class="timeline-body"><p>Ironically that's actually not quite correct because it omits the braces on <code>extras</code> which need to be retained :joy:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-26 11:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/requirements-txt/src/lib.rs</code>:173 on 2024-01-26 11:58</div>
            <div class="timeline-body"><p>I could do it with <code>rfind</code> but I don't know that it's that much simpler.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-26 12:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/requirements-txt/src/lib.rs</code>:173 on 2024-01-26 12:00</div>
            <div class="timeline-body"><p>I think it would be this:</p>
<pre><code class="language-rust">if !given.ends_with(']') {
    return None;
}
let index = given.rfind('[')?;
let (requirement, extras) = given.split_at(index);
if extras[..extras.len() - 1].contains(']') {
    return None;
}
Some((requirement, extras))
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-01-26 12:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-26 12:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-26 12:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-01-26 12:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/requirements-txt/src/lib.rs</code>:173 on 2024-01-26 12:34</div>
            <div class="timeline-body"><p>uh yeah i see why you went with char iterator</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 15:39:26 UTC
    </footer>
</body>
</html>
