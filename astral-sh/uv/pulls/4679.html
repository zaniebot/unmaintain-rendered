<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Rust crate pyo3 to 0.22.0 - astral-sh/uv #4679</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update Rust crate pyo3 to 0.22.0</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/4679">#4679</a>
        opened by <a href="https://github.com/renovate">@renovate</a>
        on 2024-07-01 01:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/renovate">@renovate</a> on 2024-07-01 01:31</div>
            <div class="timeline-body"><p><a href="https://renovatebot.com"><img src="https://app.renovatebot.com/images/banner.svg" alt="Mend Renovate" /></a></p>
<p>This PR contains the following updates:</p>
<p>| Package | Type | Update | Change |
|---|---|---|---|
| <a href="https://togithub.com/pyo3/pyo3">pyo3</a> | workspace.dependencies | minor | <code>0.21.0</code> -&gt; <code>0.22.0</code> |</p>
<hr />
<h3>Release Notes</h3>
<details>
<summary>pyo3/pyo3 (pyo3)</summary>

<h3><a href="https://togithub.com/pyo3/pyo3/blob/HEAD/CHANGELOG.md#0220---2024-06-24"><code>v0.22.0</code></a></h3>
<p><a href="https://togithub.com/pyo3/pyo3/compare/v0.21.2...v0.22.0">Compare Source</a></p>
<h5>Packaging</h5>
<ul>
<li>Update <code>heck</code> dependency to 0.5. <a href="https://togithub.com/PyO3/pyo3/pull/3966">#‚Äã3966</a></li>
<li>Extend range of supported versions of <code>chrono-tz</code> optional dependency to include version 0.10. <a href="https://togithub.com/PyO3/pyo3/pull/4061">#‚Äã4061</a></li>
<li>Update MSRV to 1.63. <a href="https://togithub.com/PyO3/pyo3/pull/4129">#‚Äã4129</a></li>
<li>Add optional <code>num-rational</code> feature to add conversions with Python's <code>fractions.Fraction</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4148">#‚Äã4148</a></li>
<li>Support Python 3.13. <a href="https://togithub.com/PyO3/pyo3/pull/4184">#‚Äã4184</a></li>
</ul>
<h5>Added</h5>
<ul>
<li>Add <code>PyWeakref</code>, <code>PyWeakrefReference</code> and <code>PyWeakrefProxy</code>. <a href="https://togithub.com/PyO3/pyo3/pull/3835">#‚Äã3835</a></li>
<li>Support <code>#[pyclass]</code> on enums that have tuple variants. <a href="https://togithub.com/PyO3/pyo3/pull/4072">#‚Äã4072</a></li>
<li>Add support for scientific notation in <code>Decimal</code> conversion. <a href="https://togithub.com/PyO3/pyo3/pull/4079">#‚Äã4079</a></li>
<li>Add <code>pyo3_disable_reference_pool</code> conditional compilation flag to avoid the overhead of the global reference pool at the cost of known limitations as explained in the performance section of the guide. <a href="https://togithub.com/PyO3/pyo3/pull/4095">#‚Äã4095</a></li>
<li>Add <code>#[pyo3(constructor = (...))]</code> to customize the generated constructors for complex enum variants. <a href="https://togithub.com/PyO3/pyo3/pull/4158">#‚Äã4158</a></li>
<li>Add <code>PyType::module</code>, which always matches Python <code>__module__</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4196">#‚Äã4196</a></li>
<li>Add <code>PyType::fully_qualified_name</code> which matches the &quot;fully qualified name&quot; defined in <a href="https://peps.python.org/pep-0737">PEP 737</a>. <a href="https://togithub.com/PyO3/pyo3/pull/4196">#‚Äã4196</a></li>
<li>Add <code>PyTypeMethods::mro</code> and <code>PyTypeMethods::bases</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4197">#‚Äã4197</a></li>
<li>Add <code>#[pyclass(ord)]</code> to implement ordering based on <code>PartialOrd</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4202">#‚Äã4202</a></li>
<li>Implement <code>ToPyObject</code> and <code>IntoPy&lt;PyObject&gt;</code> for <code>PyBackedStr</code> and <code>PyBackedBytes</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4205">#‚Äã4205</a></li>
<li>Add <code>#[pyclass(hash)]</code> option to implement <code>__hash__</code> in terms of the <code>Hash</code> implementation <a href="https://togithub.com/PyO3/pyo3/pull/4206">#‚Äã4206</a></li>
<li>Add <code>#[pyclass(eq)]</code> option to generate <code>__eq__</code> based on <code>PartialEq</code>, and <code>#[pyclass(eq_int)]</code> for simple enums to implement equality based on their discriminants. <a href="https://togithub.com/PyO3/pyo3/pull/4210">#‚Äã4210</a></li>
<li>Implement <code>From&lt;Bound&lt;'py, T&gt;&gt;</code> for <code>PyClassInitializer&lt;T&gt;</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4214">#‚Äã4214</a></li>
<li>Add <code>as_super</code> methods to <code>PyRef</code> and <code>PyRefMut</code> for accesing the base class by reference. <a href="https://togithub.com/PyO3/pyo3/pull/4219">#‚Äã4219</a></li>
<li>Implement <code>PartialEq&lt;str&gt;</code> for <code>Bound&lt;'py, PyString&gt;</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4245">#‚Äã4245</a></li>
<li>Implement <code>PyModuleMethods::filename</code> on PyPy. <a href="https://togithub.com/PyO3/pyo3/pull/4249">#‚Äã4249</a></li>
<li>Implement <code>PartialEq&lt;[u8]&gt;</code> for <code>Bound&lt;'py, PyBytes&gt;</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4250">#‚Äã4250</a></li>
<li>Add <code>pyo3_ffi::c_str</code> macro to create <code>&amp;'static CStr</code> on Rust versions which don't have 1.77's <code>c&quot;&quot;</code> literals. <a href="https://togithub.com/PyO3/pyo3/pull/4255">#‚Äã4255</a></li>
<li>Support <code>bool</code> conversion with <code>numpy</code> 2.0's <code>numpy.bool</code> type <a href="https://togithub.com/PyO3/pyo3/pull/4258">#‚Äã4258</a></li>
<li>Add <code>PyAnyMethods::{bitnot, matmul, floor_div, rem, divmod}</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4264">#‚Äã4264</a></li>
</ul>
<h5>Changed</h5>
<ul>
<li>Change the type of <code>PySliceIndices::slicelength</code> and the <code>length</code> parameter of <code>PySlice::indices()</code>. <a href="https://togithub.com/PyO3/pyo3/pull/3761">#‚Äã3761</a></li>
<li>Deprecate implicit default for trailing optional arguments <a href="https://togithub.com/PyO3/pyo3/pull/4078">#‚Äã4078</a></li>
<li><code>Clone</code>ing pointers into the Python heap has been moved behind the <code>py-clone</code> feature, as it must panic without the GIL being held as a soundness fix. <a href="https://togithub.com/PyO3/pyo3/pull/4095">#‚Äã4095</a></li>
<li>Add <code>#[track_caller]</code> to all <code>Py&lt;T&gt;</code>, <code>Bound&lt;'py, T&gt;</code> and <code>Borrowed&lt;'a, 'py, T&gt;</code> methods which can panic. <a href="https://togithub.com/PyO3/pyo3/pull/4098">#‚Äã4098</a></li>
<li>Change <code>PyAnyMethods::dir</code> to be fallible and return <code>PyResult&lt;Bound&lt;'py, PyList&gt;&gt;</code> (and similar for <code>PyAny::dir</code>). <a href="https://togithub.com/PyO3/pyo3/pull/4100">#‚Äã4100</a></li>
<li>The global reference pool (to track pending reference count decrements) is now initialized lazily to avoid the overhead of taking a mutex upon function entry when the functionality is not actually used. <a href="https://togithub.com/PyO3/pyo3/pull/4178">#‚Äã4178</a></li>
<li>Emit error messages when using <code>weakref</code> or <code>dict</code> when compiling for <code>abi3</code> for Python older than 3.9. <a href="https://togithub.com/PyO3/pyo3/pull/4194">#‚Äã4194</a></li>
<li>Change <code>PyType::name</code> to always match Python <code>__name__</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4196">#‚Äã4196</a></li>
<li>Remove CPython internal ffi call for complex number including: add, sub, mul, div, neg, abs, pow. Added PyAnyMethods::{abs, pos, neg} <a href="https://togithub.com/PyO3/pyo3/pull/4201">#‚Äã4201</a></li>
<li>Deprecate implicit integer comparision for simple enums in favor of <code>#[pyclass(eq_int)]</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4210">#‚Äã4210</a></li>
<li>Set the <code>module=</code> attribute of declarative modules' child <code>#[pymodule]</code>s and <code>#[pyclass]</code>es. <a href="https://togithub.com/PyO3/pyo3/pull/4213">#‚Äã4213</a></li>
<li>Set the <code>module</code> option for complex enum variants from the value set on the complex enum <code>module</code>. <a href="https://togithub.com/PyO3/pyo3/pull/4228">#‚Äã4228</a></li>
<li>Respect the Python &quot;limited API&quot; when building for the <code>abi3</code> feature on PyPy or GraalPy. <a href="https://togithub.com/PyO3/pyo3/pull/4237">#‚Äã4237</a></li>
<li>Optimize code generated by <code>#[pyo3(get)]</code> on <code>#[pyclass]</code> fields. <a href="https://togithub.com/PyO3/pyo3/pull/4254">#‚Äã4254</a></li>
<li><code>PyCFunction::new</code>, <code>PyCFunction::new_with_keywords</code> and <code>PyCFunction::new_closure</code> now take <code>&amp;'static CStr</code> name and doc arguments (previously was <code>&amp;'static str</code>). <a href="https://togithub.com/PyO3/pyo3/pull/4255">#‚Äã4255</a></li>
<li>The <code>experimental-declarative-modules</code> feature is now stabilized and available by default. <a href="https://togithub.com/PyO3/pyo3/pull/4257">#‚Äã4257</a></li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Fix panic when <code>PYO3_CROSS_LIB_DIR</code> is set to a missing path. <a href="https://togithub.com/PyO3/pyo3/pull/4043">#‚Äã4043</a></li>
<li>Fix a compile error when exporting an exception created with <code>create_exception!</code> living in a different Rust module using the <code>declarative-module</code> feature. <a href="https://togithub.com/PyO3/pyo3/pull/4086">#‚Äã4086</a></li>
<li>Fix FFI definitions of <code>PY_VECTORCALL_ARGUMENTS_OFFSET</code> and <code>PyVectorcall_NARGS</code> to fix a false-positive assertion. <a href="https://togithub.com/PyO3/pyo3/pull/4104">#‚Äã4104</a></li>
<li>Disable <code>PyUnicode_DATA</code> on PyPy: not exposed by PyPy. <a href="https://togithub.com/PyO3/pyo3/pull/4116">#‚Äã4116</a></li>
<li>Correctly handle <code>#[pyo3(from_py_with = ...)]</code> attribute on dunder (<code>__magic__</code>) method arguments instead of silently ignoring it. <a href="https://togithub.com/PyO3/pyo3/pull/4117">#‚Äã4117</a></li>
<li>Fix a compile error when declaring a standalone function or class method with a Python name that is a Rust keyword. <a href="https://togithub.com/PyO3/pyo3/pull/4226">#‚Äã4226</a></li>
<li>Fix declarative modules discarding doc comments on the <code>mod</code> node. <a href="https://togithub.com/PyO3/pyo3/pull/4236">#‚Äã4236</a></li>
<li>Fix <code>__dict__</code> attribute missing for <code>#[pyclass(dict)]</code> instances when building for <code>abi3</code> on Python 3.9. <a href="https://togithub.com/PyO3/pyo3/pull/4251">#‚Äã4251</a></li>
</ul>
</details>

<hr />
<h3>Configuration</h3>
<p>üìÖ <strong>Schedule</strong>: Branch creation - &quot;before 4am on Monday&quot; (UTC), Automerge - At any time (no schedule defined).</p>
<p>üö¶ <strong>Automerge</strong>: Disabled by config. Please merge this manually once you are satisfied.</p>
<p>‚ôª <strong>Rebasing</strong>: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.</p>
<p>üîï <strong>Ignore</strong>: Close this PR and you won't be reminded about this update again.</p>
<hr />
<ul>
<li>[ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box</li>
</ul>
<hr />
<p>This PR has been generated by <a href="https://www.mend.io/free-developer-tools/renovate/">Mend Renovate</a>. View repository job log <a href="https://developer.mend.io/github/astral-sh/uv">here</a>.</p>
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzNy40MjEuMCIsInVwZGF0ZWRJblZlciI6IjM3LjQyMS4wIiwidGFyZ2V0QnJhbmNoIjoibWFpbiIsImxhYmVscyI6WyJpbnRlcm5hbCJdfQ==-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/renovate[bot]">@renovate[bot]</a> on 2024-07-01 01:31</div>
            <div class="timeline-body"><h3>‚ö†Ô∏è Artifact update problem</h3>
<p>Renovate failed to update an artifact related to this branch. You probably do not want to merge this PR as-is.</p>
<p>‚ôª Renovate will retry this branch, including artifacts, only when one of the following happens:</p>
<ul>
<li>any of the package files in this branch needs updating, or</li>
<li>the branch becomes conflicted, or</li>
<li>you click the rebase/retry checkbox if found above, or</li>
<li>you rename this PR's title to start with &quot;rebase!&quot; to trigger it manually</li>
</ul>
<p>The artifact failure details are included below:</p>
<h5>File name: Cargo.lock</h5>
<pre><code>Command failed: cargo update --config net.git-fetch-with-cli=true --manifest-path Cargo.toml --workspace
    Updating crates.io index
error: failed to select a version for `pyo3-ffi`.
    ... required by package `pyo3 v0.21.0`
    ... which satisfies dependency `pyo3 = &quot;&gt;=0.21, &lt;0.22&quot;` of package `pyo3-log v0.10.0`
    ... which satisfies dependency `pyo3-log = &quot;^0.10.0&quot;` of package `pep508_rs v0.6.0 (/tmp/renovate/repos/github/astral-sh/uv/crates/pep508-rs)`
    ... which satisfies path dependency `pep508_rs` (locked to 0.6.0) of package `bench v0.0.0 (/tmp/renovate/repos/github/astral-sh/uv/crates/bench)`
versions that meet the requirements `=0.21.0` are: 0.21.0

the package `pyo3-ffi` links to the native library `python`, but it conflicts with a previous package which links to `python` as well:
package `pyo3-ffi v0.22.0`
    ... which satisfies dependency `pyo3-ffi = &quot;=0.22.0&quot;` of package `pyo3 v0.22.0`
    ... which satisfies dependency `pyo3 = &quot;^0.22.0&quot;` of package `pep440_rs v0.6.0 (/tmp/renovate/repos/github/astral-sh/uv/crates/pep440-rs)`
    ... which satisfies path dependency `pep440_rs` (locked to 0.6.0) of package `uv v0.2.18 (/tmp/renovate/repos/github/astral-sh/uv/crates/uv)`
Only one package in the dependency graph may specify the same links value. This helps ensure that only one copy of a native library is linked in the final binary. Try to adjust your dependencies so that only one package uses the `links = &quot;python&quot;` value. For more information, see https://doc.rust-lang.org/cargo/reference/resolver.html#links.

failed to select a version for `pyo3-ffi` which could resolve this conflict

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @renovate[bot] on 2024-07-01 01:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-01 01:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/renovate[bot]">@renovate[bot]</a> on 2024-07-01 01:46</div>
            <div class="timeline-body"><h3>Renovate Ignore Notification</h3>
<p>Because you closed this PR without merging, Renovate will ignore this update (<code>0.22.0</code>). You will get a PR once a newer version is released. To ignore this dependency forever, add it to the <code>ignoreDeps</code> array of your Renovate config.</p>
<p>If you accidentally closed this PR, or if you changed your mind: rename this PR to get a fresh replacement PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-01 01:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 13:48:47 UTC
    </footer>
</body>
</html>
