<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avoid using setuptools shim of distutils - astral-sh/uv #2305</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Avoid using setuptools shim of distutils</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/2305">#2305</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-03-08 19:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-08 19:41</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>It turns out that setuptools includes a shim to patch distutils. I'll admit that I don't fully understand why or how it's different, but this is the trick <code>pip</code> uses to ensure that it gets the &quot;original&quot; distutils.</p>
<p>We actually use distutils in two places: once for the system Python scheme, and once for virtual environments. In virtualenv, they <em>do</em> use the patched distutils, so this could deviate in ways I don't understand.</p>
<p>Closes #2302.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-03-08 19:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-03-08 19:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-08 19:42</div>
            <div class="timeline-body"><p>@gaborbernat - do you know if it's necessary for virtualenv to use the patched version of <code>distutils</code>? I see a note in https://github.com/pypa/virtualenv/pull/1771, but I can't tell if it's <em>required</em> or merely necessary for others that might import virtualenv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/potiuk">@potiuk</a> on 2024-03-08 19:45</div>
            <div class="timeline-body"><p>Nice!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2024-03-08 19:45</div>
            <div class="timeline-body"><p>I believe this aligns with how packages behave. pip uses setuptools distutils historically for installing packages. So without that shim you might end up with bug reports of installations ending up in expected locations when the OS patched distutils and setuptools distutils  information differs (primarily in debian).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-03-08 19:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-08 19:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-03-08 19:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 14:55:04 UTC
    </footer>
</body>
</html>
