<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modernize Python code - astral-sh/uv #1769</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Modernize Python code</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/1769">#1769</a>
        opened by <a href="https://github.com/gaborbernat">@gaborbernat</a>
        on 2024-02-20 17:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a></div>
            <div class="timeline-body"><p>Use f-strings, walrus operator and raise SystemExit instead of sys.exit.</p>
<p>Signed-off-by: Bern√°t G√°bor <a href="mailto:bgabor8@bloomberg.net">bgabor8@bloomberg.net</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-02-20 17:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>python/uv/__main__.py</code>:39 on 2024-02-20 17:31</div>
            <div class="timeline-body"><p>Hmm, I kinda prefer the <code>if</code>/<code>else</code> here -- I feel like it makes it more explicit that it's a binary choice: for Windows we do one thing; for all other platforms, we do a different thing</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2024-02-20 17:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>python/uv/__main__.py</code>:39 on 2024-02-20 17:34</div>
            <div class="timeline-body"><p>But raise SystemExit makes it redundant, ü§î so I prefer this üòÜ the raise makes it explicit that the execution of that branch ends there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-02-20 17:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>python/uv/__main__.py</code>:39 on 2024-02-20 17:39</div>
            <div class="timeline-body"><p>I agree with you that calling <code>sys.exit</code> is redundant, since all it does internally is raise <code>SystemExit</code>, so I too prefer raising <code>SystemExit</code> directly as a matter of style. But I'd still personally find it more readable, in this specific instance, to do this:</p>
<pre><code class="language-py">    if sys.platform == &quot;win32&quot;:
        import subprocess

        completed_process = subprocess.run(cmd, env=env)
        raise SystemExit(completed_process.returncode)
    else:
        os.execvpe(uv, cmd, env=env)
</code></pre>
<p>even though, as you say, the <code>else</code> is, strictly speaking, redundant.</p>
<p>Make a bikesheddy PR, expect bikesheddy review comments ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-20 17:42</div>
            <div class="timeline-body"><p>I think we're <em>technically</em> 3.7-compatible right now, so we may have to decide whether that's correct or not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2024-02-20 17:50</div>
            <div class="timeline-body"><blockquote>
<p>I think we're <em>technically</em> 3.7-compatible right now, so we may have to decide whether that's correct or not.</p>
</blockquote>
<p>https://github.com/astral-sh/uv/blob/main/pyproject.toml#L10 seems to strongly disagree üòÜ any modern installer would refuse installing the package in 3.7 because of that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on <code>python/uv/__main__.py</code>:39 on 2024-02-20 17:51</div>
            <div class="timeline-body"><p>I prefer my style, but if there's one more maintainer vote on the previous form can revert üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gaborbernat">@gaborbernat</a> reviewed on 2024-02-20 17:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-20 18:06</div>
            <div class="timeline-body"><p>We should be as backwards compatible as possible here. I do not think we should make these cosmetic changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2024-02-20 18:14</div>
            <div class="timeline-body"><p>Backwards compatible to what? Python 1.0? As pointed out above, the pyproject.toml metadata already makes you incompatible with anything before 3.8 for any installer that's not 5+ years old‚Ä¶</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-20 19:08</div>
            <div class="timeline-body"><p>We do not want to encourage use of Python 3.7, but we <em>are</em> compatible except for that line preventing installation with it. I think we should consider explicitly breaking runtime compatibility separately.</p>
<p>Separate from the compatibility comments, I'm unwilling to make stylistic changes to such critical code unless accompanied by other necessary changes ‚Äî the risk of breaking things for our users is not worth it.</p>
<p>I hope this doesn't come across as harsh, this just isn't the time for us to be reviewing these kinds of changes. We're focused on fixing bugs and improving correctness to unblock new users.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-02-20 19:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2024-02-20 19:15</div>
            <div class="timeline-body"><p><img src="https://media2.giphy.com/media/ETzdvyeIuYYvrV4d7V/giphy.gif?cid=36b14facvls3s8rnoqk19abb3nj64h19b009yj1qz23pzoxx&amp;ep=v1_gifs_search&amp;rid=giphy.gif&amp;ct=g" alt="" /></p>
<p>Fine, :-) I'll go away then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-20 19:38</div>
            <div class="timeline-body"><p>We do appreciate you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-02-20 19:50</div>
            <div class="timeline-body"><p>FYI just two days ago Pip dropped functional and runtime support for Python 3.7: https://github.com/pypa/pip/pull/11944</p>
<p>The motivating factor there was vendoring other Python packages. Something uv doesn't have to worry about I guess.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:35:40 UTC
    </footer>
</body>
</html>
