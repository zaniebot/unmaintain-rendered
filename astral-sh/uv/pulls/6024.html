<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Rust crate resvg to 0.43.0 - astral-sh/uv #6024</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update Rust crate resvg to 0.43.0</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/6024">#6024</a>
        opened by <a href="https://github.com/renovate">@renovate</a>
        on 2024-08-12 01:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/renovate">@renovate</a> on 2024-08-12 01:17</div>
            <div class="timeline-body"><p><a href="https://renovatebot.com"><img src="https://app.renovatebot.com/images/banner.svg" alt="Mend Renovate" /></a></p>
<p>This PR contains the following updates:</p>
<p>| Package | Type | Update | Change |
|---|---|---|---|
| <a href="https://togithub.com/RazrFalcon/resvg">resvg</a> | dependencies | minor | <code>0.29.0</code> -&gt; <code>0.43.0</code> |</p>
<hr />
<h3>Release Notes</h3>
<details>
<summary>RazrFalcon/resvg (resvg)</summary>

<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0430---2024-08-10"><code>v0.43.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.42.0...v0.43.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li>Support WebP images.
Thanks to <a href="https://togithub.com/notjosh">@â€‹notjosh</a>.</li>
</ul>
<h5>Changed</h5>
<ul>
<li>Use <code>zune-jpeg</code> instead of <code>jpeg-decoder</code>.
Thanks to <a href="https://togithub.com/mattfbacon">@â€‹mattfbacon</a>.</li>
<li>Update dependencies.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Canvas size limits calculation.</li>
<li>SVG fonts handling.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Transforms in COLR fonts.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0420---2024-06-01"><code>v0.42.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.41.0...v0.42.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>resvg</code> can render color fonts now, aka Emojis.<br>
In TrueType terms, <code>COLRv0</code>, <code>COLRv1</code> (mostly), <code>sbix</code>, <code>CBDT</code> and <code>SVG</code> tables are supported.<br>
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Fonts matching and fallback can be controlled by the caller via <code>usvg::FontResolver</code> now.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li><code>usvg::Options::font_resolver</code>. Similar to <code>usvg::Options::image_href_resolver</code> we already had.</li>
<li><code>usvg::Options::fontdb</code></li>
<li>Support double-quoted FuncIRIs, aka <code>url(&quot;#id&quot;)</code>.</li>
<li><code>image</code> element viewbox flattening.<br>
Instead of having <code>usvg::Image::view_box</code> that the caller should handle themselves,
we instead replace it with <code>transform</code> and optional <code>clip-path</code>.
This greatly simplifies <code>image</code> rendering.</li>
<li><code>usvg::Image::size</code></li>
<li>Tree viewbox flattening.<br>
Similar to <code>image</code> above, but affects the root <code>svg</code> element instead.</li>
<li><code>pattern</code> viewbox flattening.<br>
Similar to <code>image</code> above, but for patterns.</li>
<li>Improve vertical text rendering.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h5>Changed</h5>
<ul>
<li><p><code>usvg::fontdb::Database</code> should be set in <code>usvg::Options</code> and not passed
to the parser separately now.</p>
</li>
<li><p><code>usvg::Options</code> and <code>usvg::ImageHrefResolver</code> have a lifetime now.</p>
</li>
<li><p>Replace <code>usvg::Visibility</code> enum with just <code>bool</code>.</p>
</li>
<li><p><code>usvg::Path::visibility()</code> is replaced with <code>usvg::Path::is_visible()</code></p>
</li>
<li><p><code>usvg::Image::visibility()</code> is replaced with <code>usvg::Image::is_visible()</code></p>
</li>
<li><p><code>usvg::TextSpan::visibility()</code> is replaced with <code>usvg::TextSpan::is_visible()</code></p>
</li>
<li><p>Always represent <code>feImage</code> content as a link to an element.<br>
In SVG, <code>feImage</code> can contain a link to an element or a base64 image data, just like <code>image</code>.
From now, the inlined base64 data will always be represented by a link to an actual <code>image</code> element.</p>
<pre><code class="language-xml">&lt;filter&gt;
  &lt;feImage xlink:href=&quot;data:image/png;base64,...&quot;/&gt;
&lt;/filter&gt;
</code></pre>
<p>will be parsed as</p>
<pre><code class="language-xml">&lt;image id=&quot;image1&quot; xlink:href=&quot;data:image/png;base64,...&quot;/&gt;
&lt;filter&gt;
  &lt;feImage xlink:href=&quot;#image1&quot;/&gt;
&lt;/filter&gt;
</code></pre>
<p>This simplifies <code>feImage</code> rendering, since we don't have to handle both cases now.</p>
</li>
<li><p>The <code>--list-fonts</code> resvg argument can be used without providing an SVG file now.
Can simply call <code>resvg --list-fonts</code> now.</p>
</li>
<li><p>The <code>--list-fonts</code> resvg argument includes generic font family names as well now.</p>
</li>
<li><p>Make sure all warning and errors are printed to stderr.
Thanks to <a href="https://togithub.com/ahaoboy">@â€‹ahaoboy</a>.</p>
</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>usvg::ViewBox</code>, <code>usvg::AspectRatio</code>, <code>usvg::Align</code> types. Nol longer used.</li>
<li><code>usvg::filter::Image::aspect</code>. No longer needed.</li>
<li><code>usvg::filter::Image::rendering_mode</code>. No longer needed.</li>
<li><code>usvg::filter::Image::data</code>. Use <code>usvg::filter::Image::root</code> instead.</li>
<li><code>usvg::Tree::view_box</code>. No longer needed.</li>
<li><code>usvg::Image::view_box</code>. No longer needed.</li>
<li><code>usvg::Image::pattern</code>. No longer needed.</li>
<li><code>usvg::utils::align_pos</code>. No longer needed.</li>
<li><code>usvg::Visibility</code>. No longer needed.</li>
<li>(c-api) <code>resvg_get_image_viewbox</code>. Use <code>resvg_get_image_size</code> instead.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li><code>context-fill</code> handling.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0410---2024-04-03"><code>v0.41.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.40.0...v0.41.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>context-fill</code> and <code>context-stroke</code> support.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li><code>usvg::Text::layouted()</code>, which returns a list of glyph IDs.
It can be used to manually draw glyphs, unlike with <code>usvg::Text::flattened()</code>, which returns
just vector paths.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Missing text when a <code>text</code> element uses multiple fonts and one of them produces ligatures.</li>
<li>Absolute transform propagation during <code>use</code> resolving.</li>
<li>Absolute transform propagation during nested <code>svg</code> resolving.</li>
<li><code>Node::abs_transform</code> documentation. The current element's transform <em>is</em> included.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0400---2024-02-17"><code>v0.40.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.39.0...v0.40.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>usvg::Tree</code> is <code>Send + Sync</code> compatible now.</li>
<li><code>usvg::WriteOptions::preserve_text</code> to control how <code>usvg</code> generates an SVG.</li>
<li><code>usvg::Image::abs_bounding_box</code></li>
</ul>
<h5>Changed</h5>
<ul>
<li>All types in <code>usvg</code> are immutable now. Meaning that <code>usvg::Tree</code> cannot be modified
after creation anymore.</li>
<li>All struct fields in <code>usvg</code> are private now. Use getters instead.</li>
<li>All <code>usvg::Tree</code> parsing methods require the <code>fontdb</code> argument now.</li>
<li>All <code>defs</code> children like gradients, patterns, clipPaths, masks and filters are guarantee
to have a unique, non-empty ID.</li>
<li>All <code>defs</code> children like gradients, patterns, clipPaths, masks and filters are guarantee
to have <code>userSpaceOnUse</code> units now. No <code>objectBoundingBox</code> units anymore.</li>
<li><code>usvg::Mask</code> is allowed to have no children now.</li>
<li>Text nodes will not be parsed when the <code>text</code> build feature isn't enabled.</li>
<li><code>usvg::Tree::clip_paths</code>, <code>usvg::Tree::masks</code>, <code>usvg::Tree::filters</code> returns
a pre-collected slice of unique nodes now.
It's no longer a closure and you do not have to deduplicate nodes by yourself.</li>
<li><code>usvg::filter::Primitive::x</code>, <code>y</code>, <code>width</code> and <code>height</code> methods were replaced
with <code>usvg::filter::Primitive::rect</code>.</li>
<li>Split <code>usvg::Tree::paint_servers</code> into <code>usvg::Tree::linear_gradients</code>,
<code>usvg::Tree::radial_gradients</code>, <code>usvg::Tree::patterns</code>.
All three returns pre-collected slices now.</li>
<li>A <code>usvg::Path</code> no longer can have an invalid bbox. Paths with an invalid bbox will be
rejected during parsing.</li>
<li>All <code>usvg</code> methods that return bounding boxes return non-optional <code>Rect</code> now.
No <code>NonZeroRect</code> as well.</li>
<li><code>usvg::Text::flattened</code> returns <code>&amp;Group</code> and not <code>Option&lt;&amp;Group&gt;</code> now.</li>
<li><code>usvg::ImageHrefDataResolverFn</code> and <code>usvg::ImageHrefStringResolverFn</code>
require <code>fontdb::Database</code> argument.</li>
<li>All shared nodes are stored in <code>Arc</code> and not <code>Rc&lt;RefCell&gt;</code> now.</li>
<li><code>resvg::render_node</code> now includes filters bounding box. Meaning that a node with a blur filter
no longer be clipped.</li>
<li>Replace <code>usvg::utils::view_box_to_transform</code> with <code>usvg::ViewBox::to_transform</code>.</li>
<li>Rename <code>usvg::XmlOptions</code> into <code>usvg::WriteOptions</code> and embed <code>xmlwriter::Options</code>.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>usvg::Tree::postprocess()</code> and <code>usvg::PostProcessingSteps</code>. No longer needed.</li>
<li><code>usvg::ClipPath::units()</code>, <code>usvg::Mask::units()</code>, <code>usvg::Mask::content_units()</code>,
<code>usvg::Filter::units()</code>, <code>usvg::Filter::content_units()</code>, <code>usvg::LinearGradient::units()</code>,
<code>usvg::RadialGradient::units()</code>, <code>usvg::Pattern::units()</code>, <code>usvg::Pattern::content_units()</code>
and <code>usvg::Paint::units()</code>. They are always <code>userSpaceOnUse</code> now.</li>
<li><code>usvg::Units</code>. No longer needed.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Text bounding box is accounted during SVG size resolving.
Previously, only paths and images were included.</li>
<li>Font selection when an italic font isn't explicitly marked as one.</li>
<li>Preserve <code>image</code> aspect ratio when only <code>width</code> or <code>height</code> are present.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0390---2024-02-06"><code>v0.39.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.38.0...v0.39.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>font</code> shorthand parsing.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li><code>usvg::Group::abs_bounding_box</code></li>
<li><code>usvg::Group::abs_stroke_bounding_box</code></li>
<li><code>usvg::Path::abs_bounding_box</code></li>
<li><code>usvg::Path::abs_stroke_bounding_box</code></li>
<li><code>usvg::Text::abs_bounding_box</code></li>
<li><code>usvg::Text::abs_stroke_bounding_box</code></li>
</ul>
<h5>Changed</h5>
<ul>
<li>All <code>usvg-*</code> crates merged into one. There is just the <code>usvg</code> crate now, as before.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>usvg::Group::abs_bounding_box()</code> method. It's a field now.</li>
<li><code>usvg::Group::abs_filters_bounding_box()</code></li>
<li><code>usvg::TreeParsing</code>, <code>usvg::TreePostProc</code> and <code>usvg::TreeWriting</code> traits.
They are no longer needed.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li><code>font-family</code> parsing.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Absolute bounding box calculation for paths.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0380---2024-01-21"><code>v0.38.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.37.0...v0.38.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li>Each <code>usvg::Node</code> stores its absolute transform now.
<code>Node::abs_transform()</code> executes in constant time now.</li>
<li><code>usvg::Tree::calculate_bounding_boxes</code> to calculate all bounding boxes beforehand.</li>
<li><code>usvg::Node::bounding_box</code> which returns a precalculated node's bounding box in object coordinates.</li>
<li><code>usvg::Node::abs_bounding_box</code> which returns a precalculated node's bounding box in canvas coordinates.</li>
<li><code>usvg::Node::stroke_bounding_box</code> which returns a precalculated node's bounding box,
including stroke, in object coordinates.</li>
<li><code>usvg::Node::abs_stroke_bounding_box</code> which returns a precalculated node's bounding box,
including stroke, in canvas coordinates.</li>
<li>(c-api) <code>resvg_get_node_stroke_bbox</code></li>
<li><code>usvg::Node::filters_bounding_box</code></li>
<li><code>usvg::Node::abs_filters_bounding_box</code></li>
<li><code>usvg::Tree::postprocess</code></li>
</ul>
<h5>Changed</h5>
<ul>
<li><code>resvg</code> renders <code>usvg::Tree</code> directly again. <code>resvg::Tree</code> is gone.</li>
<li><code>usvg</code> no longer uses <code>rctree</code> for the nodes tree implementation.
The tree is a regular <code>enum</code> now.<ul>
<li>A caller no longer need to use the awkward <code>*node.borrow()</code>.</li>
<li>No more panics on incorrect mutable <code>Rc&lt;RefCell&gt;</code> access.</li>
<li>Tree nodes respect tree's mutability rules. Before, one could mutate tree nodes when the tree
itself is not mutable. Because <code>Rc&lt;RefCell&gt;</code> provides a shared mutable access.</li>
</ul>
</li>
<li>Filters, clip paths, masks and patterns are stored as <code>Rc&lt;RefCell&lt;T&gt;&gt;</code> instead of <code>Rc&lt;T&gt;</code>.
This is required for proper mutability since <code>Node</code> itself is no longer an <code>Rc</code>.</li>
<li>Rename <code>usvg::NodeKind</code> into <code>usvg::Node</code>.</li>
<li>Upgrade to Rust 2021 edition.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>resvg::Tree</code>. No longer needed. <code>resvg</code> can render <code>usvg::Tree</code> directly once again.</li>
<li><code>rctree::Node</code> methods. The <code>Node</code> API is completely different now.</li>
<li><code>usvg::NodeExt</code>. No longer needed.</li>
<li><code>usvg::Node::calculate_bbox</code>. Use <code>usvg::Node::abs_bounding_box</code> instead.</li>
<li><code>usvg::Tree::convert_text</code>. Use <code>usvg::Tree::postprocess</code> instead.</li>
<li><code>usvg::TreeTextToPath</code> trait. No longer needed.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Mark <code>mask-type</code> as a presentation attribute.</li>
<li>Do not show needless warnings when parsing some attributes.</li>
<li><code>feImage</code> rendering with a non-default position.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0370---2023-12-16"><code>v0.37.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.36.0...v0.37.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>usvg</code> can write text back to SVG now.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li><code>--preserve-text</code> flag to the <code>usvg</code> CLI tool.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Support <a href="https://drafts.csswg.org/css-transforms/#transform-origin-property"><code>transform-origin</code></a>
property.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Support non-default markers order via
<a href="https://svgwg.org/svg2-draft/painting.html#PaintOrder"><code>paint-order</code></a>.
Previously, only fill and stroke could have been swapped.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li><code>usvg_tree::Text::flattened</code> that will contain a flattened/outlined text.</li>
<li><code>usvg_tree::Text::bounding_box</code>. Will be set only after text flattening.</li>
<li>Optimize <code>usvg_tree::NodeExt::abs_transform</code> by storing absolute transforms in the tree
instead of calculating them each time.</li>
</ul>
<h5>Changed</h5>
<ul>
<li><code>usvg_tree::Text::positions</code> was replaced with <code>usvg_tree::Text::dx</code> and <code>usvg_tree::Text::dy</code>.<br>
<code>usvg_tree::CharacterPosition::x</code> and <code>usvg_tree::CharacterPosition::y</code> are gone.
They were redundant and you should use <code>usvg_tree::TextChunk::x</code>
and <code>usvg_tree::TextChunk::y</code> instead.</li>
<li><code>usvg_tree::LinearGradient::id</code> and <code>usvg_tree::RadialGradient::id</code> are moved to
<code>usvg_tree::BaseGradient::id</code>.</li>
<li>Do not generate element IDs during parsing. Previously, some elements like <code>clipPath</code>s
and <code>filter</code>s could have generated IDs, but it wasn't very reliable and mostly unnecessary.
Renderer doesn't rely on them and usvg writer would generate them anyway.</li>
<li>Text-to-paths conversion via <code>usvg_text_layout::Tree::convert_text</code> no longer replaces
original text elements with paths, but instead puts them into <code>usvg_tree::Text::flattened</code>.</li>
</ul>
<h5>Removed</h5>
<ul>
<li>The <code>transform</code> field from <code>usvg_tree::Path</code>, <code>usvg_tree::Image</code> and <code>usvg_tree::Text</code>.
Only <code>usvg_tree::Group</code> can have it.<br>
It doesn't break anything, because those properties were never used before anyway.<br>
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li><code>usvg_tree::CharacterPosition</code></li>
<li><code>usvg_tree::Path::text_bbox</code>. Use <code>usvg_tree::Text::bounding_box</code> instead.</li>
<li><code>usvg_text_layout::TextToPath</code> trait for <code>Text</code> nodes.
Only the whole tree can be converted at once.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Path object bounding box calculation. We were using point bounds instead of tight contour bounds.
Was broken since v0.34</li>
<li>Convert text-to-paths in embedded SVGs as well. The one inside the <code>Image</code> node.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Indirect <code>text-decoration</code> resolving in some cases.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>(usvg) Clip paths writing to SVG.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0360---2023-10-01"><code>v0.36.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.35.0...v0.36.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>stroke-linejoin=miter-clip</code> support. SVG2.
Thanks to <a href="https://togithub.com/torokati44">@â€‹torokati44</a>.</li>
<li>Quoted FuncIRI support. Like <code>fill=&quot;url('#gradient')&quot;</code>. SVG2.
Thanks to <a href="https://togithub.com/romanzes">@â€‹romanzes</a>.</li>
<li>Allow float values in <code>rgb()</code> and <code>rgba()</code> colors. SVG2.
Thanks to <a href="https://togithub.com/yisibl">@â€‹yisibl</a>.</li>
<li><code>auto-start-reverse</code> variant support to <code>orient</code> in markers. SVG2.
Thanks to <a href="https://togithub.com/EpicEricEE">@â€‹EpicEricEE</a>.</li>
</ul>
<h5>Changed</h5>
<ul>
<li>Update dependencies.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Increase precision of the zero-scale transform check.
Was rejecting some valid transforms before.</li>
<li>Panic when rendering a very specific text.</li>
<li>Greatly improve parsing performance when an SVG has a lot of references.
Thanks to <a href="https://togithub.com/wez">@â€‹wez</a>.</li>
<li>(Qt API) Fix scaling factor calculation.
Thanks to <a href="https://togithub.com/missdeer">@â€‹missdeer</a>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0350---2023-06-27"><code>v0.35.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.34.1...v0.35.0">Compare Source</a></p>
<h5>Fixed</h5>
<ul>
<li>Panic when an element is completely outside the viewbox.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>FillPaint</code> and <code>StrokePaint</code> filter inputs support.
It's a mostly undocumented SVG feature that no one supports and no one uses.
And it was adding a significant complexity to the codebase.</li>
<li><code>usvg::filter::Filter::fill_paint</code> and <code>usvg::filter::Filter::stroke_paint</code>.</li>
<li><code>BackgroundImage</code>, <code>BackgroundAlpha</code>, <code>FillPaint</code> and <code>StrokePaint</code> from <code>usvg::filter::Input</code>.</li>
<li><code>usvg::Group::filter_fill_paint</code> and <code>usvg::Group::filter_stroke_paint</code>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0341---2023-05-28"><code>v0.34.1</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.34.0...v0.34.1">Compare Source</a></p>
<h5>Fixed</h5>
<ul>
<li>Transform components order. Affects only <code>usvg</code> SVG output and C API.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0340---2023-05-27"><code>v0.34.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.33.0...v0.34.0">Compare Source</a></p>
<h5>Changed</h5>
<ul>
<li><code>usvg</code> uses <code>tiny-skia</code> geometry primitives now, including the <code>Path</code> container.<br>
The main difference compared to the old <code>usvg</code> primitives
is that <code>tiny-skia</code> uses <code>f32</code> instead of <code>f64</code>.
So while in theory we could loose some precision, in practice, <code>f32</code> is used mainly
as a storage type and precise math operations are still done using <code>f64</code>.<br>
<code>tiny-skia</code> primitives are move robust, strict and have a nicer API.<br>
More importantly, this change reduces the peak memory usages for SVGs with large paths
(in terms of the number of segments).
And removes the need to convert <code>usvg::PathData</code> into <code>tiny-skia::Path</code> before rendering.
Which was just a useless reallocation.</li>
<li>All numbers are stored as <code>f32</code> instead of <code>f64</code> now.</li>
<li>Because we use <code>tiny-skia::Path</code> now, we allow <em>quadratic curves</em> as well.
This includes <code>usvg</code> CLI output.</li>
<li>Because we allow <em>quadratic curves</em> now, text might render slightly differently (better?).
This is because TrueType fonts contain only <em>quadratic curves</em>
and we were converting them to cubic before.</li>
<li><code>usvg::Path</code> no longer implements <code>Default</code>. Use <code>usvg::Path::new</code> instead.</li>
<li>Replace <code>usvg::Rect</code> with <code>tiny_skia::NonZeroRect</code>.</li>
<li>Replace <code>usvg::PathBbox</code> with <code>tiny_skia::Rect</code>.</li>
<li>Unlike the old <code>usvg::PathBbox</code>, <code>tiny_skia::Rect</code> allows both width and height to be zero.
This is not an error.</li>
<li><code>usvg::filter::Turbulence::base_frequency</code> was split into <code>base_frequency_x</code> and <code>base_frequency_y</code>.</li>
<li><code>usvg::NodeExt::calculate_bbox</code> no longer includes stroke bbox.</li>
<li>(c-api) Use <code>float</code> instead of <code>double</code> everywhere.</li>
<li>The <code>svgfilters</code> crate was merged into <code>resvg</code>.</li>
<li>The <code>rosvgtree</code> crate was merged into <code>usvg-parser</code>.</li>
<li><code>usvg::Group::filter_fill</code> moved to <code>usvg::filter::Filter::fill_paint</code>.</li>
<li><code>usvg::Group::filter_stroke</code> moved to <code>usvg::filter::Filter::stroke_paint</code>.</li>
</ul>
<h5>Remove</h5>
<ul>
<li><code>usvg::Point</code>. Use <code>tiny_skia::Point</code> instead.</li>
<li><code>usvg::FuzzyEq</code>. Use <code>usvg::ApproxEqUlps</code> instead.</li>
<li><code>usvg::FuzzyZero</code>. Use <code>usvg::ApproxZeroUlps</code> instead.</li>
<li>(c-api) <code>resvg_path_bbox</code>. Use <code>resvg_rect</code> instead.</li>
<li><code>svgfilters</code> crate.</li>
<li><code>rosvgtree</code> crate.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Write <code>transform</code> on <code>clipPath</code> children in <code>usvg</code> SVG output.</li>
<li>Do not duplicate marker children IDs.
Previously, each element resolved for a marker would preserve its ID.
Affects only <code>usvg</code> SVG output and doesn't affect rendering.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0330---2023-05-17"><code>v0.33.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.32.0...v0.33.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li>A new rendering algorithm.<br>
When rendering <a href="https://razrfalcon.github.io/notes-on-svg-parsing/isolated-groups.html">isolated groups</a>,
aka layers, we have to know the layer bounding box beforehand, which is ridiculously hard in SVG.<br>
Previously, resvg would simply use the canvas size for all the layers.
Meaning that to render a 10x10px layer on a 1000x1000px canvas, we would have to allocate and then blend
a 1000x1000px layer, which is just a waste of CPU cycles.<br>
The new rendering algorithm is able to calculate layer bounding boxes, which dramatically improves
performance when rendering a lot of tiny layers on a large canvas.<br>
Moreover, it makes performance more linear with a canvas size increase.<br>
The <a href="https://togithub.com/google/forma/blob/681e8bfd348caa61aab47437e7d857764c2ce522/assets/svgs/paris-30k.svg">paris-30k.svg</a>
sample from <a href="https://togithub.com/google/forma">google/forma</a> is rendered <em>115 times</em> faster on M1 Pro now.
From ~33760ms down to ~290ms. 5269x3593px canvas.<br>
If we restrict the canvas to 1000x1000px, which would contain only the actual <code>paris-30k.svg</code> content,
then we're <em>13 times</em> faster. From ~3252ms down to ~253ms.</li>
<li><code>resvg::Tree</code>, aka a render tree, which is an even simpler version of <code>usvg::Tree</code>.
<code>usvg::Tree</code> had to be converted into <code>resvg::Tree</code> before rendering now.</li>
</ul>
<h5>Changed</h5>
<ul>
<li>Restructure the root directory. All crates are in the <code>crates</code> directory now.</li>
<li>Restructure tests. New directory structure and naming scheme.</li>
<li>Use <code>resvg::Tree::render</code> instead of <code>resvg::render</code>.</li>
<li>resvg's <code>--export-area-drawing</code> option uses calculated bounds instead of trimming
excessive alpha now. It's faster, but can lead to a slightly different output.</li>
<li>(c-api) Removed <code>fit_to</code> argument from <code>resvg_render</code>.</li>
<li>(c-api) Removed <code>fit_to</code> argument from <code>resvg_render_node</code>.</li>
<li><code>usvg::ScreenSize</code> moved to <code>resvg</code>.</li>
<li><code>usvg::ScreenRect</code> moved to <code>resvg</code>.</li>
<li>Rename <code>resvg::ScreenSize</code> into <code>resvg::IntSize</code>.</li>
<li>Rename <code>resvg::ScreenRect</code> into <code>resvg::IntRect</code>.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>filter</code> build feature from <code>resvg</code>. Filters are always enabled now.</li>
<li><code>resvg::FitTo</code></li>
<li><code>usvg::utils::view_box_to_transform_with_clip</code></li>
<li><code>usvg::Size::to_screen_size</code>. Use <code>resvg::IntSize::from_usvg</code> instead.</li>
<li><code>usvg::Rect::to_screen_size</code>. Use <code>resvg::IntSize::from_usvg(rect.size())</code> instead.</li>
<li><code>usvg::Rect::to_screen_rect</code>. Use <code>resvg::IntRect::from_usvg</code> instead.</li>
<li>(c-api) <code>resvg_fit_to</code></li>
<li>(c-api) <code>resvg_fit_to_type</code></li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Double quotes parsing in <code>font-family</code>.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0320---2023-04-23"><code>v0.32.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.31.1...v0.32.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li>Clipping and masking is up to 20% faster.</li>
<li><code>mask-type</code> property support. SVG2</li>
<li><code>usvg_tree::MaskType</code></li>
<li><code>usvg_tree::Mask::kind</code></li>
<li>(rosvgtree) New SVG 2 mask attributes.</li>
</ul>
<h5>Changed</h5>
<ul>
<li><code>BackgroundImage</code> and <code>BackgroundAlpha</code> filter inputs will produce the same output
as <code>SourceGraphic</code> and <code>SourceAlpha</code> respectively.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>enable-background</code> support. This feature was never supported by browsers
and was deprecated in SVG 2. To my knowledge, only Batik has a good support of it.
Also, it's a performance nightmare, which caused multiple issues in resvg already.</li>
<li><code>usvg_tree::EnableBackground</code></li>
<li><code>usvg_tree::Group::enable_background</code></li>
<li><code>usvg_tree::NodeExt::filter_background_start_node</code></li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Improve rectangular clipping anti-aliasing quality.</li>
<li>Mask's RGB to Luminance converter was ignoring premultiplied alpha.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0311---2023-04-22"><code>v0.31.1</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.31.0...v0.31.1">Compare Source</a></p>
<h5>Fixed</h5>
<ul>
<li>Use the latest <code>tiny-skia</code> to fix SVGs with large masks rendering.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0310---2023-04-10"><code>v0.31.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.30.0...v0.31.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li><code>usvg::Tree::paint_servers</code></li>
<li><code>usvg::Tree::clip_paths</code></li>
<li><code>usvg::Tree::masks</code></li>
<li><code>usvg::Tree::filters</code></li>
<li><code>usvg::Node::subroots</code></li>
<li>(usvg) <code>--coordinates-precision</code> and <code>--transforms-precision</code> writing options.
Thanks to <a href="https://togithub.com/flxzt">@â€‹flxzt</a>.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li><code>fill-opacity</code> and <code>stroke-opacity</code> resolving.</li>
<li>Double <code>transform</code> when resolving <code>symbol</code>.</li>
<li><code>symbol</code> clipping when its viewbox is the same as the document one.</li>
<li>(usvg) Deeply nested gradients, patterns, clip paths, masks and filters
were ignored during SVG writing.</li>
<li>Missing text in nested clip paths and mask, text decoration patterns, filter inputs and feImage.</li>
</ul>
<h3><a href="https://togithub.com/RazrFalcon/resvg/blob/HEAD/CHANGELOG.md#0300---2023-03-25"><code>v0.30.0</code></a></h3>
<p><a href="https://togithub.com/RazrFalcon/resvg/compare/v0.29.0...v0.30.0">Compare Source</a></p>
<h5>Added</h5>
<ul>
<li>Readd <code>usvg</code> CLI tool. Can be installed via cargo as before.</li>
</ul>
<h5>Changed</h5>
<ul>
<li>Extract most <code>usvg</code> internals into new <code>usvg-tree</code> and <code>usvg-parser</code> crates.
<code>usvg-tree</code> contains just the SVG tree and all the types.
<code>usvg-parser</code> parsers SVG into <code>usvg-tree</code>.
And <code>usvg</code> is just an umbrella crate now.</li>
<li>To use <code>usvg::Tree::from*</code> methods one should import the <code>usvg::TreeParsing</code> trait now.</li>
<li>No need to import <code>usvg-text-layout</code> manually anymore. It is part of <code>usvg</code> now.</li>
<li><code>rosvgtree</code> no longer reexports <code>svgtypes</code>.</li>
<li><code>rosvgtree::Node::attribute</code> returns just a string now.</li>
<li><code>rosvgtree::Node::find_attribute</code> returns just a <code>rosvgtree::Node</code> now.</li>
<li>Rename <code>usvg::Stretch</code> into <code>usvg::FontStretch</code>.</li>
<li>Rename <code>usvg::Style</code> into <code>usvg::FontStyle</code>.</li>
<li><code>usvg::FitTo</code> moved to <code>resvg::FitTo</code>.</li>
<li><code>usvg::IsDefault</code> trait is private now.</li>
</ul>
<h5>Removed</h5>
<ul>
<li><code>rosvgtree::FromValue</code>. Due to Rust's orphan rules this trait is pretty useless.</li>
</ul>
<h5>Fixed</h5>
<ul>
<li>Recursive markers detection.</li>
<li>Skip malformed <code>transform</code> attributes without skipping the whole element.</li>
<li>Clipping path rectangle calculation for nested <code>svg</code> elements.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>Panic when applying <code>text-decoration</code> on text with only one cluster.
Thanks to <a href="https://togithub.com/LaurenzV">@â€‹LaurenzV</a>.</li>
<li>(Qt API) Image size wasn't initialized. Thanks to <a href="https://togithub.com/missdeer">@â€‹missdeer</a>.</li>
<li><code>resvg</code> CLI allows files with XML DTD again.</li>
<li>(svgtypes) Handle implicit MoveTo after ClosePath segments.</li>
</ul>
</details>

<hr />
<h3>Configuration</h3>
<p>ðŸ“… <strong>Schedule</strong>: Branch creation - &quot;before 4am on Monday&quot; (UTC), Automerge - At any time (no schedule defined).</p>
<p>ðŸš¦ <strong>Automerge</strong>: Disabled by config. Please merge this manually once you are satisfied.</p>
<p>â™» <strong>Rebasing</strong>: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.</p>
<p>ðŸ”• <strong>Ignore</strong>: Close this PR and you won't be reminded about this update again.</p>
<hr />
<ul>
<li>[ ] <!-- rebase-check -->If you want to rebase/retry this PR, check this box</li>
</ul>
<hr />
<p>This PR was generated by <a href="https://www.mend.io/free-developer-tools/renovate/">Mend Renovate</a>. View the <a href="https://developer.mend.io/github/astral-sh/uv">repository job log</a>.</p>
<!--renovate-debug:eyJjcmVhdGVkSW5WZXIiOiIzOC4yMC4xIiwidXBkYXRlZEluVmVyIjoiMzguMjAuMSIsInRhcmdldEJyYW5jaCI6Im1haW4iLCJsYWJlbHMiOlsiaW50ZXJuYWwiXX0=-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @renovate[bot] on 2024-08-12 01:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-12 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-12 01:56</div>
            <div class="timeline-body"><p>This is a dev dependency, and I don't consider it worth the effort of upgrading right now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/renovate[bot]">@renovate[bot]</a> on 2024-08-12 01:57</div>
            <div class="timeline-body"><h3>Renovate Ignore Notification</h3>
<p>Because you closed this PR without merging, Renovate will ignore this update (<code>0.43.0</code>). You will get a PR once a newer version is released. To ignore this dependency forever, add it to the <code>ignoreDeps</code> array of your Renovate config.</p>
<p>If you accidentally closed this PR, or if you changed your mind: rename this PR to get a fresh replacement PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-08-12 01:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 13:32:10 UTC
    </footer>
</body>
</html>
