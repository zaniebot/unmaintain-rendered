<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for extras in editable requirements - astral-sh/uv #1531</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for extras in editable requirements</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1531">#1531</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-02-16 19:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 19:26</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>If you're developing on a package like <code>attrs</code> locally, and it has a recursive extra like <code>attrs[dev]</code>, it turns out that we then try to find the <code>attrs</code> in <code>attrs[dev]</code> from the registry, rather than recognizing that it's part of the editable.</p>
<p>This PR fixes the issue by making editables slightly more first-class throughout the resolver. Instead of mocking metadata, we explicitly check for extras in various places. Part of the problem here is that we treated editables as URL dependencies, but when we saw an <em>extra</em> like <code>attrs[dev]</code>, we didn't map that back to the URL. So now, we treat them as registry dependencies, but with the appropriate guardrails throughout.</p>
<p>Closes https://github.com/astral-sh/uv/issues/1447.</p>
<h2>Test Plan</h2>
<ul>
<li>Cloned <code>attrs</code>.</li>
<li>Ran <code>cargo run venv &amp;&amp; cargo run pip install -e &quot;.[dev]&quot; -v</code>.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-16 19:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-resolver/src/resolver/mod.rs</code>:170 on 2024-02-16 19:27</div>
            <div class="timeline-body"><p>I think removing this is good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-16 19:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-resolver/src/resolver/mod.rs</code>:629 on 2024-02-16 19:27</div>
            <div class="timeline-body"><p>The only downside to all of this is that we now pay the cost of doing these lookups for all packages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-02-16 19:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-02-16 19:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewfeickert">@matthewfeickert</a> on 2024-02-16 21:13</div>
            <div class="timeline-body"><p>Ah, thank you very much for this! I was just about to report it given</p>
<pre><code>uv pip install --upgrade &quot;.[all,test]&quot;
...
error: Failed to parse `.[all,test]`
  Caused by: Expected package name starting with an alphanumeric character, found '.'
.[all,test]
</code></pre>
<p>. :)</p>
<p>(Go Astral team go! :rocket: :star:)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-02-16 23:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-02-16 23:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-16 23:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-02-16 23:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewfeickert">@matthewfeickert</a> on 2024-02-18 01:24</div>
            <div class="timeline-body"><p>@charliermarsh @zanieb we're still seeing this in https://github.com/scikit-hep/pyhf when we try to do</p>
<pre><code class="language-console">$ uv --version
uv 0.1.4
$ python -m uv pip install --upgrade &quot;.[all,test]&quot;
error: Failed to parse `.[all,test]`
  Caused by: Expected package name starting with an alphanumeric character, found '.'
.[all,test]
^
$
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-18 01:49</div>
            <div class="timeline-body"><p>That’s a slightly different issue — you can either use -e (like -e “.[all,test]”) or provide a package name like “pyhf @ .[all,test]”. We have a limitation that we require package names upfront for non-editable requirements, but we’ll be lifting that in the future.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewfeickert">@matthewfeickert</a> on 2024-02-18 07:09</div>
            <div class="timeline-body"><p>Ah okay great. I was alreadying watching Issue https://github.com/astral-sh/uv/issues/313 but for some reason hadn't made the connection. Thanks!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 15:33:43 UTC
    </footer>
</body>
</html>
