<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avoid displaying &quot;failed to download&quot; on build failures for local source distributions - astral-sh/uv #6075</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Avoid displaying &quot;failed to download&quot; on build failures for local source distributions</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/6075">#6075</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-08-14 00:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Especially with workspace members (e.g., <a href="https://github.com/astral-sh/uv/pull/6073/files#diff-273076013b4f5a8139defd5dcd24f5d1eb91c0266dceb4448fdeddceb79f7738R1377-R1379">this new test case</a>), I find it very confusing that we say we failed to download these distributions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-14 00:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-14 00:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/pip_install.rs</code>:179 on 2024-08-14 00:05</div>
            <div class="timeline-body"><p>Unfortunately, we have a duplicate &quot;Failed to build&quot; here because of <code>uv-distribution::Error::Build</code> â€” I&#x27;m exploring a way to avoid that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-14 00:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/pip_install.rs</code>:179 on 2024-08-14 00:22</div>
            <div class="timeline-body"><p>Removed in <a href="https://github.com/astral-sh/uv/pull/6075">astral-sh/uv#6075</a>/commits/6cf1a949806c079dde6fdd94374eb7f503810ffb</p>
<p>It becomes a little ambiguous where we failed for some errors, but I think it&#x27;s a net improvement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-14 00:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-14 00:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/pip_install.rs</code>:3485 on 2024-08-14 00:28</div>
            <div class="timeline-body"><p>This is arguably more ambiguous now, but I think dropping the duplicate package URL is nice. I&#x27;m not sure how to improve this in the general case? I think we&#x27;d need to implement display for <code>Error::FetchAndBuild</code> to include a bit more logic which seems wrong.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-08-14 22:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/tests/pip_install.rs</code>:3485 on 2024-08-14 22:26</div>
            <div class="timeline-body"><p>Don&#x27;t we have the URL in the line just above? It looks like it was repeated</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-08-14 22:26</div>
            <div class="timeline-body"><p>Significantly better.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-08-14 22:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/pip_install.rs</code>:3485 on 2024-08-14 22:27</div>
            <div class="timeline-body"><p>Yeah, it&#x27;s an improvement not to repeat the URL. The ambiguity here is that it&#x27;s not clear if the following error, e.g., &quot;Build backend failed to determine metadata&quot;, is a <em>build</em> or <em>download</em> error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-14 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-14 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-08-14 22:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:47:22 UTC
    </footer>
</body>
</html>
