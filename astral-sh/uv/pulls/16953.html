<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clarify UV_HTTP_TIMEOUT format in error message for streaming timeout - astral-sh/uv #16953</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Clarify UV_HTTP_TIMEOUT format in error message for streaming timeout</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/16953">#16953</a>
        opened by <a href="https://github.com/anoop-rehman">@anoop-rehman</a>
        on 2025-12-03 04:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/anoop-rehman">@anoop-rehman</a> on 2025-12-03 04:03</div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<!-- What's the purpose of the change? What does it do, and why? -->

<p>Relevant issues: #16940</p>
<h3>Problem</h3>
<p>The error message for network streaming timeouts is misleading about the expected format:</p>
<pre><code>Failed to download distribution due to network timeout.
Try increasing UV_HTTP_TIMEOUT (current value: 30s).
</code></pre>
<p>This suggests users should set values like <code>120s</code> or <code>180s</code>, but the actual required format is a plain integer representing seconds.</p>
<h3>Solution</h3>
<p>This PR updates the hint to be clearer about the input format, changing it from <code>Try increasing UV_HTTP_TIMEOUT (current value: {}s).</code> to <code>Try increasing UV_HTTP_TIMEOUT to a larger integer value (in seconds), e.g., UV_HTTP_TIMEOUT=60</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Clarify UV_HTTP_TIMEOUT format in error message" to "Clarify UV_HTTP_TIMEOUT format in error message for streaming timeout" by @anoop-rehman on 2025-12-03 04:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @anoop-rehman on 2025-12-03 04:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-12-04 15:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-client/src/registry_client.rs</code>:1210 on 2025-12-04 15:38</div>
            <div class="timeline-body"><p>Sorry I realized this wrong after I approved :D</p>
<p>Two things</p>
<ol>
<li>I don't think we need to be so verbose about &quot;integer value (in seconds)&quot; if we show a concrete example</li>
<li>We need to actually make sure the new value is larger than the current one! We should hint <code>self.timeout().as_secs() * 2</code> instead of hard-coding 60</li>
</ol>
<pre><code class="language-suggestion">                    &quot;Failed to download distribution due to network timeout ({}s).\nTry increasing UV_HTTP_TIMEOUT to a larger value, e.g., UV_HTTP_TIMEOUT={}&quot;,
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-12-04 15:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-12-04 15:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-client/src/registry_client.rs</code>:1210 on 2025-12-04 15:38</div>
            <div class="timeline-body"><p>As a third thing, we should use backticks, e.g., <code>UV_HTTP_TIMEOUT</code> and <code>UV_HTTP_TIMEOUT=60</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/anoop-rehman">@anoop-rehman</a> reviewed on 2025-12-04 18:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/anoop-rehman">@anoop-rehman</a> on <code>crates/uv-client/src/registry_client.rs</code>:1210 on 2025-12-04 18:31</div>
            <div class="timeline-body"><p>Thank you sm for taking the time to review this! Agreed with all 3 points and applied these changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-12-15 14:44</div>
            <div class="timeline-body"><p>I'm trying to write a test case for this, proving tricky :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/anoop-rehman">@anoop-rehman</a> on 2026-01-07 21:26</div>
            <div class="timeline-body"><p>Same here, I wasnt able to figure out how to delay only the body and not the header with wiremock - if you have any suggestions/ideas lmk</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LoukasPap">@LoukasPap</a> on 2026-01-08 17:51</div>
            <div class="timeline-body"><p>So, if I'm correct, the problem is fixed and we are trying to write a test case to cause the timeout, correct?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 05:43:35 UTC
    </footer>
</body>
</html>
