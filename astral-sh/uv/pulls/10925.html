<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feat: error on non-existent extra from lock file - astral-sh/uv #10925</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>feat: error on non-existent extra from lock file</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/10925">#10925</a>
        opened by <a href="https://github.com/mkniewallner">@mkniewallner</a>
        on 2025-01-24 01:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mkniewallner">@mkniewallner</a></div>
            <div class="timeline-body">Summary
<p>Based on <a href="https://github.com/astral-sh/uv/pull/11063">astral-sh/uv#11063</a>.</p>
<p>Alternative to #10869 which follows the suggestion, in <a href="https://github.com/astral-sh/uv/pull/10869">astral-sh/uv#10869</a>#issuecomment-2609916298, to validate extras from the lock file instead of <code>pyproject.toml</code>.</p>
Test Plan
<p>Snapshot tests.</p>
<p>Some tests are failing, but it seems unrelated to the changes, and likely due to the branch being based on an outdated branch (rebasing the branch from latest <code>main</code> makes one of the failing test pass locally).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/mkniewallner">@mkniewallner</a> on <code>crates/uv/src/commands/project/mod.rs</code>:157 on 2025-01-24 01:50</div>
            <div class="timeline-body"><p>Wording could probably be adapted here, as the check happens at lock file level, but not sure exactly how we would want to phrase this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mkniewallner">@mkniewallner</a> reviewed on 2025-01-24 01:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/mkniewallner">@mkniewallner</a> on 2025-02-09 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 15:53</div>
            <div class="timeline-body"><p>Oh rad, thanks for the rewrite/rebase! (We&#x27;ll land the base branch this week at which point this can land too)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/Gankra">@Gankra</a> by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 15:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 19:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 19:40</div>
            <div class="timeline-body"><p><em>forehead slap</em></p>
<p>What a terrible github behaviour. I can&#x27;t even reopen this! Sorry! (It needs to be retargetted to <a href="https://github.com/astral-sh/uv/tree/tracking/060">tracking/060</a>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 19:41</div>
            <div class="timeline-body"><p>In the meantime I&#x27;ll still review this...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mkniewallner">@mkniewallner</a> on 2025-02-11 20:41</div>
            <div class="timeline-body"><blockquote>
<p><em>forehead slap</em></p>
<p>What a terrible github behaviour. I can&#x27;t even reopen this! Sorry! (It needs to be retargetted to <a href="https://github.com/astral-sh/uv/tree/tracking/060">tracking/060</a>)</p>
</blockquote>
<p>No worries, will rebase and recreate the PR :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Gankra">@Gankra</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:2627 on 2025-02-11 20:45</div>
            <div class="timeline-body"><p>I&#x27;m not sure if this is the right place to handle this but I believe this isn&#x27;t our desired semantic for the case where <code>provides_extras</code> is undefined. We aren&#x27;t doing a lockfile version bump, so we&#x27;re still supporting <code>provides_extras</code> being missing.</p>
<p>Some part of this code should handle that as &quot;I don&#x27;t actually have information on if the extra is defined, and will conservatively not error, because I&#x27;m uncertain&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-02-11 20:47</div>
            <div class="timeline-body"><p>Basic idea <em>looks</em> right but needs to handle a corner case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/mkniewallner">@mkniewallner</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:2627 on 2025-02-11 20:53</div>
            <div class="timeline-body"><p>Oh yeah definitely, will update the logic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mkniewallner">@mkniewallner</a> reviewed on 2025-02-11 20:53</div>
            <div class="timeline-body"></div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:50:29 UTC
    </footer>
</body>
</html>
