<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WIP: Improve performance of windows-aarch64 builds - astral-sh/uv #10402</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>WIP: Improve performance of windows-aarch64 builds</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/10402">#10402</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-01-08 17:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Extending #10306 ‚Äî trying to reach an acceptable perf</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-08 17:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;zb/speedup aarch64&quot; to &quot;WIP: Improve performance of windows-aarch64 builds&quot; by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-08 17:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rich-ayr">@rich-ayr</a> on 2025-01-09 01:25</div>
            <div class="timeline-body"><p>The &quot;Install LLVM&quot; step already installs LLVM/Clang 19 and puts it in path.
Visual Studio comes with Clang 18 which has a <code>bindgen</code> bug affecting <code>aarch64</code>, so I would advise not installing <code>Microsoft.VisualStudio.ComponentGroup.NativeDesktop.Llvm.Clang</code> unless you need Clang 18 specifically.</p>
<p>This will save some time on the installer as well, only getting the build tools and SDK takes around 5m 23s; although that shouldn&#x27;t matter once you get the caching working üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-09 02:53</div>
            <div class="timeline-body"><p>Interesting, thanks for the tips!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-09 02:53</div>
            <div class="timeline-body"><p>Right now the problem is that the cache is <em>huge</em>, 7GB is going to cause cache churn since we have a 10GB limit in the repository.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rich-ayr">@rich-ayr</a> on 2025-01-09 03:11</div>
            <div class="timeline-body"><blockquote>
<p>Right now the problem is that the cache is <em>huge</em>, 7GB is going to cause cache churn since we have a 10GB limit in the repository.</p>
</blockquote>
<p>Oh wow even with caching it takes 3m 21s because of the download I assume.</p>
<p>I think it might be worth it to only use the native ARM64 runner in a release CI, Rust can use <code>--target aarch64...</code> just fine on <code>x86_64</code> hosts and this whole &quot;&gt;10 min CI just for getting a the bare minimum setup to compile rust&quot; is kind of just burning money for no upside.</p>
<p>Probably best to wait for Microsoft/GitHub to ship a usable VM image.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-09 14:40</div>
            <div class="timeline-body"><blockquote>
<p>I think it might be worth it to only use the native ARM64 runner in a release CI, Rust can use --target aarch64... just fine on x86_64 hosts and this whole &quot;&gt;10 min CI just for getting a the bare minimum setup to compile rust&quot; is kind of just burning money for no upside.</p>
</blockquote>
<p>Yeah, but then it can regress and then I have to burn a bunch of cycles fixing a release :( trade-offs</p>
<blockquote>
<p>Probably best to wait for Microsoft/GitHub to ship a usable VM image.</p>
</blockquote>
<p>Sort of agree.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:50:09 UTC
    </footer>
</body>
</html>
