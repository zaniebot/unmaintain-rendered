<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `--no-wait` argument for the `run` command to not wait for spawned process to finish - astral-sh/uv #16249</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>--no-wait</code> argument for the <code>run</code> command to not wait for spawned process to finish</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/16249">#16249</a>
        opened by <a href="https://github.com/CrendKing">@CrendKing</a>
        on 2025-10-11 05:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/CrendKing">@CrendKing</a></div>
            <div class="timeline-body"><p>Here is an unsolicited attempt to implement the feature to <code>uv run</code> a script and make <code>uv</code> exit immediately without waiting for the spawned <code>python</code> process to finish.</p>


Summary
<p>I usually need to wrap a bunch of <code>uv</code> invocations in other Python scripts. Since <code>uv</code> always waits for child process to finish, this ends up with a lot of recursive <code>uv</code> processes lingering. Sometimes this is useful, so that logic that must happen after the child process can run at right time. Other times this is unnecessary/wasteful because all I need is to let <code>uv</code> to spawn the virtual env. The child script will handle everything by themselves.</p>
<p>This is a very rough initial attempt to implement <code>uv run --no-wait</code>. The PR basically consists of adding and passing the argument, then if user needs <code>--no-wait</code>, skip the <code>run_to_completion(handle).await</code> call. Additionally, only in Windows, to avoid the child process console being detached to the terminal, the process is spawned with <a href="https://learn.microsoft.com/en-us/windows/win32/procthread/process-creation-flags">CREATE_NEW_CONSOLE</a>. This way it has its own console.</p>
Test Plan
<p>As this is rough initial attempt, I only tested manually. If the PR is OK to be moved to next phase, I&#x27;ll add programmatic tests.</p>
<ol>
<li>Create two Python scripts, <code>a.py</code> and <code>b.py</code>.</li>
</ol>
<pre><code>a.py

import subprocess
subprocess.check_call([&#x27;uv.exe&#x27;, &#x27;run&#x27;, &#x27;b.py&#x27;])
</code></pre>
<pre><code>b.py

import time
time.sleep(9999)
</code></pre>
<ol>
<li><code>uv run a.py</code>.</li>
<li>Verify that there is no lingering <code>uv.exe</code> process in task manager.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-12 13:05</div>
            <div class="timeline-body"><p>There&#x27;s some relevant discussion on <a href="https://github.com/astral-sh/uv/issues/3095">astral-sh/uv#3095</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CrendKing">@CrendKing</a> on 2025-10-12 18:56</div>
            <div class="timeline-body"><p>I see. You guys worry about temporary resource cleanup before the child is finished. Sure, there are use case where <code>uv run</code> needs to maintain and cleanup like temporary directory between invocations. But there are also other (majority for me) cases where nothing needs to be cleaned. The project is permanent. The dependencies are declared in <code>pyproject.toml</code> and saved in <code>.venv</code>. If the documentation for this argument explains what can be expected, I think it&#x27;s fine.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:54:15 UTC
    </footer>
</body>
</html>
