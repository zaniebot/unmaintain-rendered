<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Move smoke tests into dedicated jobs and build `uvx` explicitly - astral-sh/uv #10824</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Move smoke tests into dedicated jobs and build <code>uvx</code> explicitly</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/10824">#10824</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-01-21 20:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-21 20:40</div>
            <div class="timeline-body"><p>In the interest of expanding these tests and debugging weird behaviors, I've moved the smoke tests out of the <code>cargo test</code> job and into dedicated <code>smoke test</code> jobs. We explicitly build <code>uvx</code> in the <code>build binary</code> jobs instead of relying on the implicit build for the test run.</p>
<p>I also added a <code>uvx</code> test case to the smoke tests: <code>uvx ruff --version</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by @zanieb on 2025-01-21 20:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zanieb on 2025-01-21 21:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-21 21:18</div>
            <div class="timeline-body"><p>Why is the compilation not re-used when running <code>cargo test</code> after <code>cargo build</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-21 21:19</div>
            <div class="timeline-body"><p>This may be an unacceptable performance degradation in the test CI jobs â€” in which case I'll move the smoke testing out into separate tests (which may be best anyway).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Explicitly build `uvx` in CI" to "Move smoke tests into dedicated jobs and build `uvx` explicitly" by @zanieb on 2025-01-21 22:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @Gankra by @zanieb on 2025-01-21 22:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-01-21 22:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-01-21 22:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-01-21 22:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-21 22:59</div>
            <div class="timeline-body"><p>One downside of this change: these don't block CI / auto-merge anymore</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Gankra">@Gankra</a> reviewed on 2025-01-22 14:02</div>
            <div class="timeline-body"><p>Hmm might have been able to use a matrix here but nbd</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-22 15:27</div>
            <div class="timeline-body"><p>I think maybe I could use a matrix if I used <code>bash</code> on Windows but I need some PowerShell-specific invocations? I might move some of the testing out into a script, I could consider it then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-01-22 16:44</div>
            <div class="timeline-body"><p>I was picturing having the power-shell specific part wrapped in an <code>if matrix.platform == &quot;windows&quot;:</code> or something but yeah that's the hardest part.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:18 UTC
    </footer>
</body>
</html>
