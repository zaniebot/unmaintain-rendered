<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Set `COLUMNS` during tests  - astral-sh/uv #11589</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Set <code>COLUMNS</code> during tests</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/11589">#11589</a>
        opened by <a href="https://github.com/mgorny">@mgorny</a>
        on 2025-02-18 07:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mgorny">@mgorny</a></div>
            <div class="timeline-body">Summary
<p>When tests are run downstream, the <code>COLUMNS</code> environment variable is used to force fixed output width and avoid test failures due to different terminal widths.  However, this occasionally causes test regressions when other tests rely on different output width. Use the same <code>COLUMNS</code> value in CI to ensure consistent output and catch any regressions.</p>
Test Plan
<p>It wasn&#x27;t, it&#x27;s supposed to be tested by the CI :-).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mgorny">@mgorny</a> on 2025-02-18 07:31</div>
            <div class="timeline-body"><p>It failed with #11588, so it works :-).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/konstin">@konstin</a> on 2025-02-18 08:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-02-18 08:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 14:37</div>
            <div class="timeline-body"><p>Thank you!</p>
<p>Can we set this in the test context instead?</p>
<p>https://github.com/astral-sh/uv/blob/5765e4bdee26fae7208d9fc380568bde2db66712/crates/uv/tests/it/common/mod.rs#L565</p>
<p>We may want a comment about how we already disable line-wrapping in all of <em>our</em> output for snapshots but snapshotted output from other tools may still wrap?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-02-18 15:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Set `COLUMNS` in Linux CI workflow to prevent regressions&quot; to &quot;Set `COLUMNS` during tests &quot; by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 15:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mgorny">@mgorny</a> on 2025-02-18 16:31</div>
            <div class="timeline-body"><p>Sorry for not handling the CI problems timely, and thanks for taking it over!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 16:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 16:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-02-20 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-26 16:10</div>
            <div class="timeline-body"><p>No problem!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:50:56 UTC
    </footer>
</body>
</html>
