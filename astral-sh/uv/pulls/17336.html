<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for delocating macOS wheels - astral-sh/uv #17336</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for delocating macOS wheels</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/17336">#17336</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2026-01-06 15:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body">Summary
<p>This PR adds support for delocating macOS wheels. The behavior is not yet exposed on the CLI; it&#x27;s only intended for internal-to-uv use. The implementation is based on https://github.com/matthew-brett/delocate, specifically <code>delocate-listdeps {wheel}</code> to list library dependencies (exposed as <code>list_wheel_dependencies()</code>) and <code>delocate-wheel --require-archs {delocate_archs} -w {dest_dir} {wheel}</code> to copy external libraries into binaries (exposed as <code>delocate_wheel()</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-06 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-06 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-06 17:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-06 17:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:215 on 2026-01-07 09:37</div>
            <div class="timeline-body"><p>How does this logic compare to the one in install-wheel-rs?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:86 on 2026-01-07 09:41</div>
            <div class="timeline-body"><pre><code>fn hash_file(path: &amp;Path) -&gt; Result&lt;(String, u64), DelocateError&gt; {
    let mut file = File::open(path)?;
    let mut hasher = Sha256::new();
    let size = io::copy(&amp;mut file, &amp;mut hasher)?;

    let hash = hasher.finalize();
    let hash_str = format!(&quot;sha256={}&quot;, URL_SAFE_NO_PAD.encode(hash));

    Ok((hash_str, size))
}
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:106 on 2026-01-07 09:42</div>
            <div class="timeline-body"><p>Do we actually want to conserve all permissions, or only the executable bit? https://github.com/astral-sh/uv/blob/cc1ca8b4a1730be2997222b6ab317e7a69c49099/crates/uv-build-backend/src/wheel.rs#L675</p>
<p>Alternatively, should we remember the permission from the origin wheel instead?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:96 on 2026-01-07 09:44</div>
            <div class="timeline-body"><p>We should show both paths in the error message</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:25 on 2026-01-07 09:48</div>
            <div class="timeline-body"><p>Does this guarantee that the compressed tag sets are sorted? https://packaging.python.org/en/latest/specifications/platform-compatibility-tags/#compressed-tag-sets</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:59 on 2026-01-07 10:08</div>
            <div class="timeline-body"><p>We have existing slightly different logic in <code>macos_deployment_target</code> in uv-configuration.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:70 on 2026-01-07 10:08</div>
            <div class="timeline-body"><p>Do these have a specific source that documents what are system prefixes?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:98 on 2026-01-07 10:12</div>
            <div class="timeline-body"><p>Do we need the patch version?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:150 on 2026-01-07 10:14</div>
            <div class="timeline-body"><p>We should use the constants from goblin: https://docs.rs/goblin/latest/goblin/mach/header/index.html</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:102 on 2026-01-07 10:20</div>
            <div class="timeline-body"><p>This looks a lot like https://docs.rs/goblin/latest/goblin/mach/fn.peek_bytes.html</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:266 on 2026-01-07 10:26</div>
            <div class="timeline-body"><p>goblin uses <code>bytes.pread::&lt;&amp;str&gt;(cmd.offset + command.dylib.name as usize)</code> for this, can we use that too? https://github.com/m4b/goblin/blob/fddcc4747ccf306469ff6092a953bd667ec8ed7d/src/mach/mod.rs#L216</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:295 on 2026-01-07 11:05</div>
            <div class="timeline-body"><p>This is already parsed in <code>macho.rpaths</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:90 on 2026-01-07 11:11</div>
            <div class="timeline-body"><p>Where are we reading this field?</p>
<p>In case we aren&#x27;t reading it, the names are already parsed as <code>macho.libs</code> by goblin</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/error.rs</code>:37 on 2026-01-07 11:17</div>
            <div class="timeline-body"><p>Those should be separate variants instead of a string payload</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/tests/integration_test.rs</code>:16 on 2026-01-07 11:27</div>
            <div class="timeline-body"><p>Inline mods don&#x27;t match the patterns we usually use</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-07 11:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-07 14:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/tests/integration_test.rs</code>:16 on 2026-01-07 14:02</div>
            <div class="timeline-body"><p>It makes it easier to <code>#cfg</code> out chunks of tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-07 14:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/wheel.rs</code>:25 on 2026-01-07 14:03</div>
            <div class="timeline-body"><p>Wait, does our <code>WheelFilename</code> display logic even do that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-07 14:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/tests/integration_test.rs</code>:16 on 2026-01-07 14:06</div>
            <div class="timeline-body"><p>I can move them into separate files though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-07 14:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/macho.rs</code>:266 on 2026-01-07 14:08</div>
            <div class="timeline-body"><p>We can but we have to pull in <code>scroll</code> (which we already transitively depend on).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-07 14:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:25 on 2026-01-07 14:19</div>
            <div class="timeline-body"><p>We retain the input order, so given that all input wheels are correctly sorted, and all wheel the uv build backend creates are correctly sorted (<code>py3-none-any</code> matches that), we won&#x27;t create invalid compressed tag sets. Or simpler: If there wasn&#x27;t already an unsorted compressed tag set, we won&#x27;t create one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-07 15:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-07 15:39</div>
            <div class="timeline-body"><p>Thanks for the great review @konstin.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2026-01-08 13:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-configuration/src/target_triple.rs</code>:949 on 2026-01-08 13:29</div>
            <div class="timeline-body"><p>I think this might belong in <code>uv-platform</code>, but I think we can explore that separately from this pull request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2026-01-08 13:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-delocate/src/macho.rs</code>:102 on 2026-01-08 13:31</div>
            <div class="timeline-body"><p>Hm this is duplicated with <code>uv-configuration</code> now?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-delocate/src/macho.rs</code>:31 on 2026-01-08 13:35</div>
            <div class="timeline-body"><p>I think I&#x27;d expect this to have <code>Known(Arch)</code> wrapping one of our other types instead. e.g., <code>uv-platform-tags::Arch</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2026-01-08 13:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2026-01-08 13:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-delocate/src/macho.rs</code>:102 on 2026-01-08 13:39</div>
            <div class="timeline-body"><p>maybe that means <a href="https://github.com/astral-sh/uv/pull/17336">astral-sh/uv#17336</a>#discussion_r2672368365 is actually relevant?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-08 13:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/macho.rs</code>:102 on 2026-01-08 13:54</div>
            <div class="timeline-body"><p>Yeah I just didnâ€™t think it was important to  de-duplicate it, but happy to.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2026-01-08 14:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-delocate/src/macho.rs</code>:102 on 2026-01-08 14:14</div>
            <div class="timeline-body"><p>I&#x27;m just a little wary of our platform code sprawling further, I don&#x27;t feel super strongly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:102 on 2026-01-08 14:47</div>
            <div class="timeline-body"><p>It would be nice to centralize the default macOS version assumption so they don&#x27;t get out of sync.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-08 14:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-08 15:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/macho.rs</code>:31 on 2026-01-08 15:22</div>
            <div class="timeline-body"><p>Personally it seems okay to me to have this here since it&#x27;s specifically about Mach-O binary types and the use is very limited.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-configuration/src/target_triple.rs</code>:303 on 2026-01-12 10:40</div>
            <div class="timeline-body"><p>That version is hardcoded both here and in https://github.com/astral-sh/uv/blob/330e56e778cb5313a8ddb84cace8ce32e87a944b/crates/uv-configuration/src/target_triple.rs#L300 and in the env var docs, I see use diverging in these locations.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:483 on 2026-01-12 10:41</div>
            <div class="timeline-body"><p>We can avoid duplicating the RPATH/RECORD/writing logic by inverting this condition.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:541 on 2026-01-12 10:42</div>
            <div class="timeline-body"><p>Is that a known constant?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-platform/src/macos.rs</code>:82 on 2026-01-13 08:28</div>
            <div class="timeline-body"><p>Those seem like very fine-grained unit test, shouldn&#x27;t we be able to rely on the derive for that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:45 on 2026-01-13 08:40</div>
            <div class="timeline-body"><p>This looks a lot like <code>macos_deployment_target</code>, can we unify this into e.g. a <code>MacOSVersion::from_env</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:24 on 2026-01-13 10:07</div>
            <div class="timeline-body"><p>Currently, these fields aren&#x27;t written beyond the default constructor. Do we anticipate that we will expose all of them?</p>
<p>For example, will there be a delocate in uv where we modify the <code>require_archs</code> beyond the input tag, or where we wouldn&#x27;t want to sanitize the rpaths?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/error.rs</code>:41 on 2026-01-13 10:32</div>
            <div class="timeline-body"><p>This error is duplicating the filename context</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/macho.rs</code>:105 on 2026-01-13 10:55</div>
            <div class="timeline-body"><p>Why would the file not exist after we found it in the walkdir?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/tests/delocate_integration.rs</code>:17 on 2026-01-13 10:59</div>
            <div class="timeline-body"><p>This test doesn&#x27;t cover the output of <code>list_wheel_dependencies</code>, the part that&#x27;s different from <code>delocate_wheel</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:115 on 2026-01-13 11:21</div>
            <div class="timeline-body"><p>We can avoid the unwrap with if-let for all <code>strip_prefix</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:122 on 2026-01-13 11:31</div>
            <div class="timeline-body"><p>The branches look the same to me</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:165 on 2026-01-13 11:38</div>
            <div class="timeline-body"><p>Aren&#x27;t we stripping any potential relative path here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:128 on 2026-01-13 11:40</div>
            <div class="timeline-body"><p>Is it intentional that we&#x27;re using canonicalize as <code>is_file</code> check?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:365 on 2026-01-13 11:43</div>
            <div class="timeline-body"><p>Do we need to handle the error path here? This looks like a way to create a half-delocated wheel through a broken file somewhere in the dep tree</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:178 on 2026-01-13 11:45</div>
            <div class="timeline-body"><p>Isn&#x27;t it the other way round, libraries that the binary in the wheel depends on?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:37 on 2026-01-13 11:53</div>
            <div class="timeline-body"><p>This flag is deprecated in the python delocate: https://github.com/matthew-brett/delocate/commit/ae65b6de12136053a4d4069c38ef0558702b31b2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:385 on 2026-01-13 12:00</div>
            <div class="timeline-body"><p>We should be logging each edge here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:27 on 2026-01-13 12:06</div>
            <div class="timeline-body"><p>I originally reads this as a typo of <code>libs_dir</code>, can we name this e.g. <code>lib_subdir</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:521 on 2026-01-13 12:09</div>
            <div class="timeline-body"><pre><code>        let dest_path = dest_dir.join(&amp;filename_str);
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/tests/macho_parsing.rs</code>:73 on 2026-01-13 12:13</div>
            <div class="timeline-body"><p>Do we have a test case that transitive delocating works?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:588 on 2026-01-13 12:17</div>
            <div class="timeline-body"><p>This isn&#x27;t necessarily a problem cause both are used in uv, but how are deciding between <code>relative_to</code> and <code>diff_paths</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:589 on 2026-01-13 12:21</div>
            <div class="timeline-body"><p>I see two <code>return None</code> in that function, should they ever be reachable from this code? https://docs.rs/pathdiff/0.2.3/src/pathdiff/lib.rs.html#43</p>
<p>fwiw I&#x27;m not advocating for an <code>.unwrap()</code>here, I&#x27;d rather reduce their number, but maybe a <code>debug_assert!</code> or a runtime error, this call doesn&#x27;t look like something that should have a static fallback.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:597 on 2026-01-13 12:23</div>
            <div class="timeline-body"><p>Can you change the comment to explain what the <code>dependent_in_wheel.exists()</code> condition does?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:467 on 2026-01-13 12:24</div>
            <div class="timeline-body"><p>Do we care about the <code>min_macos_version</code> of the libraries we vendor?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:238 on 2026-01-13 12:34</div>
            <div class="timeline-body"><p>I know I asked this in the last iteration too, but does this ensure that compressed tag sets are sorted?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:529 on 2026-01-13 12:40</div>
            <div class="timeline-body"><p>We should delocate all modules in the wheel, not just the first one. It&#x27;s a set in the original implementation, though that implementation fails with namespace packages: https://github.com/matthew-brett/delocate/blob/cf158a3a0c64fb1ed2db42aee6b1b470f652488f/delocate/tools.py#L937-L956 . Should we instead delocate the entire wheel, skipping only over top level directories that aren&#x27;t module names (i.e. <code>.dist-info</code>, existing <code>.libs</code>)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:760 on 2026-01-13 12:56</div>
            <div class="timeline-body"><p>This should test wheel filename strings to wheel filename strings, so we can see the string formed output and whether the wheel filename are valid.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:614 on 2026-01-13 13:14</div>
            <div class="timeline-body"><p>If we changed the tag, we must update the .dist-info/WHEELfile, otherwise we get bugs like <a href="https://github.com/astral-sh/uv/issues/16581">astral-sh/uv#16581</a></p>
<p>https://github.com/matthew-brett/delocate/blob/a97bc907ea5fab9256e2c92b995b332605fcd98b/delocate/delocating.py#L794-L821</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:121 on 2026-01-13 13:17</div>
            <div class="timeline-body"><pre><code>        let relative_str = relative.portable_display();
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:86 on 2026-01-13 13:20</div>
            <div class="timeline-body"><p>Is there a reason why we&#x27;re using the version with manual iteration?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/wheel.rs</code>:125 on 2026-01-13 13:24</div>
            <div class="timeline-body"><p>Is there a reason we&#x27;re not using the existing <code>find_dist_info</code> with it&#x27;s robust logic?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-static/src/env_vars.rs</code>:722 on 2026-01-13 13:30</div>
            <div class="timeline-body"><pre><code>    #[attr_added_in(&quot;next version&quot;)]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-static/src/env_vars.rs</code>:728 on 2026-01-13 13:30</div>
            <div class="timeline-body"><pre><code>    #[attr_added_in(&quot;next version&quot;)]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-13 13:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-15 18:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 18:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:24 on 2026-01-15 18:58</div>
            <div class="timeline-body"><p>I&#x27;m going to remove the two booleans.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:128 on 2026-01-15 19:19</div>
            <div class="timeline-body"><p>Yes!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 19:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:178 on 2026-01-15 19:33</div>
            <div class="timeline-body"><p>I think the comment is correct... The keys are external libraries (like <code>/usr/local/lib/libfoo.dylib</code>), and the values are wheel binaries (or other bundled libs) that depend on this external library... I will improve...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 19:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 19:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:467 on 2026-01-15 19:49</div>
            <div class="timeline-body"><p>We do -- I believe that&#x27;s `libraries.keys().map(PathBuf::as_path).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 19:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:760 on 2026-01-15 19:51</div>
            <div class="timeline-body"><p>I don&#x27;t think I agree with this? That would be testing the wheel filename display, which shouldn&#x27;t be tested here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 19:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:529 on 2026-01-15 19:54</div>
            <div class="timeline-body"><p>Doesn&#x27;t this just control where we <em>put</em> the dylibs? we&#x27;re still iterating over all binaries in the entire wheel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/wheel.rs</code>:86 on 2026-01-15 20:07</div>
            <div class="timeline-body"><p>(I thought we&#x27;d need to wrap the <code>File</code> in a buffered reader anyway, which was incorrect.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-15 20:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-15 20:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-15 20:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-15 20:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-21 12:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:529 on 2026-01-21 12:36</div>
            <div class="timeline-body"><p>:+1: for the new naming, makes this much easier to follow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2026-01-21 12:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-delocate/src/delocate.rs</code>:760 on 2026-01-21 12:39</div>
            <div class="timeline-body"><p>Maybe that&#x27;s a different test, what I&#x27;m interested in seeing more than the exact shape of the tags is that the eventual string wheel filename is correct, after going through everything include the <code>WheelFilename</code>&#x27;s internal representation and the <code>Display</code> implementation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2026-01-21 15:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-delocate/src/delocate.rs</code>:760 on 2026-01-21 15:03</div>
            <div class="timeline-body"><p>Done</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-21 16:09:24 UTC
    </footer>
</body>
</html>
