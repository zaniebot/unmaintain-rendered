<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Docker integration guide to prefer `COPY` over `ADD` for simple cases - astral-sh/uv #16883</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update Docker integration guide to prefer `COPY` over `ADD` for simple cases</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/16883">#16883</a>
        opened by <a href="https://github.com/MatthijsKok">@MatthijsKok</a>
        on 2025-11-28 15:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/MatthijsKok">@MatthijsKok</a> on 2025-11-28 15:17</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Docker best practices recommend to use <code>COPY</code> when the additional functionality of <code>ADD</code> is not used.</p>
<p>See:</p>
<ul>
<li>https://docs.docker.com/build/building/best-practices/#add-or-copy</li>
<li>https://www.docker.com/blog/docker-best-practices-understanding-the-differences-between-add-and-copy-instructions-in-dockerfiles/</li>
</ul>
<h2>Test Plan</h2>
<p>Docs only change</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-12-02 23:25</div>
            <div class="timeline-body"><p>I'm fine with using <code>COPY</code> but I'd rather not change the ordering of the working directory as well. I find it less clear to <code>COPY . .</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @zanieb on 2025-12-02 23:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-12-03 14:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 14:59</div>
            <div class="timeline-body"><p>Can you revert this change too please?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthijsKok">@MatthijsKok</a> reviewed on 2025-12-03 15:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthijsKok">@MatthijsKok</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:03</div>
            <div class="timeline-body"><p>The first example was the only one that did not start with the <code>WORKDIR</code>, so I thought I'd align them.
But whatever you prefer :) I can see how this is simpler in a way.</p>
<p>Reverted.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-12-03 15:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthijsKok">@MatthijsKok</a> reviewed on 2025-12-03 15:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthijsKok">@MatthijsKok</a> on <code>docs/guides/integration/docker.md</code>:170 on 2025-12-03 15:05</div>
            <div class="timeline-body"><p>thought: with only 1 statement making use of the <code>WORKDIR</code> you could even</p>
<pre><code>RUN uv --directory=app sync --locked
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-12-03 15:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:05</div>
            <div class="timeline-body"><p>Ah I didn't notice that, I presume we need it earlier in the other ones because we're relying on it for the cache mounts. I'm not quite sure how I feel about it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthijsKok">@MatthijsKok</a> reviewed on 2025-12-03 15:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthijsKok">@MatthijsKok</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:07</div>
            <div class="timeline-body"><p>The cache mounts all target the absolute path <code>/root/.cache/uv</code>, so they are not impacted by <code>WORKDIR</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthijsKok">@MatthijsKok</a> reviewed on 2025-12-03 15:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthijsKok">@MatthijsKok</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:08</div>
            <div class="timeline-body"><p>Personally I <em>always</em> start my dockerfiles with a <code>WORKDIR</code>, so I moved it without too much thought haha.</p>
<p>It's not that important :) The current situation is perfectly fine</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:09</div>
            <div class="timeline-body"><p>hm?</p>
<p>https://github.com/astral-sh/uv/blob/e7af5838bbd3fe00d45b0ae6f399975846dbf41b/docs/guides/integration/docker.md#L408-L412</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-12-03 15:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-12-03 15:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:09</div>
            <div class="timeline-body"><p>Sorry, &quot;bind mounts&quot; :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MatthijsKok">@MatthijsKok</a> reviewed on 2025-12-03 15:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MatthijsKok">@MatthijsKok</a> on <code>docs/guides/integration/docker.md</code>:166 on 2025-12-03 15:13</div>
            <div class="timeline-body"><p>ahhh. ok that makes a lot more sense!</p>
<p>I think the dilemma can be summed up as</p>
<ul>
<li>&quot;<code>WORKDIR</code> statement before first time it's used&quot; vs</li>
<li>&quot;<code>WORKDIR</code> statement at the start of the file&quot; (potentially 'far away')</li>
</ul>
<p>whatever you think is best &lt;3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-12-03 15:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-12-03 15:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../Homebrew/homebrew-core/pulls/257541.html">Homebrew/homebrew-core#257541</a> on 2025-12-06 14:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:16 UTC
    </footer>
</body>
</html>
