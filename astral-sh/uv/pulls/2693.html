<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv/tests: add regression test for `echo pendulum | uv pip compile -` - astral-sh/uv #2693</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv/tests: add regression test for <code>echo pendulum | uv pip compile -</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/2693">#2693</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2024-03-27 15:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a></div>
            <div class="timeline-body"><p>I stumbled across this when writing tests for
<code>--emit-marker-expressions</code>. Namely, I observed that in CI, the <code>tzdata</code>
dependency of <code>pendulum</code> wasn&#x27;t included in the <code>requirements.txt</code>
output on Windows.</p>
<p>@konstin <a href="https://github.com/astral-sh/uv/pull/2651#discussion_r1539722464">suggested</a> that this was a bug, so I&#x27;ve created a test for it.
In particular, it looks like <a href="https://inspector.pypi.io/project/pendulum/3.0.0/packages/67/5e/e646afbd1632bfbacdae79289d7d5879efdeeb5f5e58327bc5c698731107/pendulum-3.0.0-cp310-none-win_amd64.whl/pendulum-3.0.0.dist-info/METADATA#line.12"><code>tzdata</code> is an unconditional dependency of
<code>pendulum</code></a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-27 16:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-27 16:09</div>
            <div class="timeline-body"><p>Is this related to our filters, which always remove <code>tzdata</code> on Windows...?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-03-27 16:23</div>
            <div class="timeline-body"><blockquote>
<p>Is this related to our filters, which always remove <code>tzdata</code> on Windows...?</p>
</blockquote>
<p>Oh, I guess so: https://github.com/astral-sh/uv/blob/f9db0ed8f0fc50972f2a5d99f4099d6ca7d49f52/crates/uv/tests/common/mod.rs</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-27 16:32</div>
            <div class="timeline-body"><p>Sorry, i got fooled by the windows filters i actually myself -.-</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-03-27 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-03-27 16:46</div>
            <div class="timeline-body"><p>@konstin I added a short comment noting why we do the filters, and kept the &quot;regression&quot; test, but with Windows filters disabled. (And indeed, the tests pass.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-03-27 16:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-03-27 17:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-03-27 17:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-03-27 17:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:44:32 UTC
    </footer>
</body>
</html>
