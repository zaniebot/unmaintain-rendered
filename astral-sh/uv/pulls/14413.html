<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build `path` sources without build systems by default - astral-sh/uv #14413</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Build <code>path</code> sources without build systems by default</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/14413">#14413</a>
        opened by <a href="https://github.com/jtfmumm">@jtfmumm</a>
        on 2025-07-02 09:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a></div>
            <div class="timeline-body"><p>We currently treat path sources as virtual if they do not specify a build system, which is surprising behavior. This PR updates the behavior to treat path sources as packages unless the path source is explicitly marked as <code>package = false</code> or its own <code>tool.uv.package</code> is set to <code>false</code>.</p>
<p>Closes #12015</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @jtfmumm on 2025-07-02 09:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @jtfmumm on 2025-07-02 09:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-07-02 09:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv-workspace/src/pyproject.rs</code>:84 on 2025-07-02 09:30</div>
            <div class="timeline-body"><p>I left the existing logic in place in <code>is_package</code> (factoring out the <code>tool.uv.package</code> check) to constrain this change to path sources only.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 14:20</div>
            <div class="timeline-body"><p>This should be based on #14164 right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-07-02 15:11</div>
            <div class="timeline-body"><blockquote>
<p>This should be based on #14164 right?</p>
</blockquote>
<p>Yes, updated</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.8.0" by @jtfmumm on 2025-07-02 15:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-07-02 16:23</div>
            <div class="timeline-body"><p>We need to update https://docs.astral.sh/uv/reference/settings/#package in conjunction with this change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-07-02 16:40</div>
            <div class="timeline-body"><blockquote>
<p>We need to update https://docs.astral.sh/uv/reference/settings/#package in conjunction with this change.</p>
</blockquote>
<p>This doesn’t actually change the behavior there. It’s limited to updating the default behavior when a path source definition has no package value.</p>
<p>But we can discuss if we want this to hold more generally. I was trying to limit the scope of the change to the issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "No longer treat path sources as virtual if missing build specification" to "Build `path` sources without build systems by default" by @zanieb on 2025-07-02 16:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 16:46</div>
            <div class="timeline-body"><p>Can you add test coverage for cases where there are various <code>package = ..</code> options set?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-07-02 16:54</div>
            <div class="timeline-body"><blockquote>
<p>Can you add test coverage for cases where there are various <code>package = ..</code> options set?</p>
</blockquote>
<p>There are already existing tests but I can point them out</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 18:11</div>
            <div class="timeline-body"><p>Yes please. I'm particularly interested in <code>package = true</code> / <code>package = false</code> conflicts.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-07-02 18:34</div>
            <div class="timeline-body"><ul>
<li><p><code>sync_override_package</code> on <code>main</code> tests for a dependency with a build specification:</p>
<ul>
<li><code>tool.uv.package</code> is unset<ul>
<li>override with <code>package = false</code>: does not install</li>
<li>no override: does install</li>
</ul>
</li>
<li><code>tool.uv.package</code> is <code>false</code><ul>
<li>override with <code>package = true</code>: does install</li>
<li>no override: doesn't install</li>
</ul>
</li>
<li>In this PR, I added:<ul>
<li><code>tool.uv.package</code> is <code>true</code><ul>
<li>override with <code>package = false</code>: does not install</li>
<li>no override: does install</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><code>lock_implicit_package_path</code> (renamed) is updated in this PR to check that the default behavior is to build even when the path source itself had no build specification and no <code>tool.uv.package</code> value. This is testing the core behavior for this PR.</p>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 19:41</div>
            <div class="timeline-body"><p>There should be <em>some</em> documentation change here. Perhaps in https://docs.astral.sh/uv/concepts/projects/dependencies/#path</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:441 on 2025-07-03 14:25</div>
            <div class="timeline-body"><p>Which &quot;project&quot; are you referring to here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:441 on 2025-07-03 14:27</div>
            <div class="timeline-body"><p>Can you wrap the line so it's ~close to the line length in the rest of the file? The autoformatter can't wrap admonitions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:442 on 2025-07-03 14:27</div>
            <div class="timeline-body"><p>I think this link will break if split across lines.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:442 on 2025-07-03 14:28</div>
            <div class="timeline-body"><p>Why &quot;build specification&quot;? Is that a term we use elsewhere? We should just say &quot;build system&quot; for consistency?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:441 on 2025-07-03 14:28</div>
            <div class="timeline-body"><p>It feels weird this is first framed around &quot;If the project is marked as a non-package&quot;, since that's the advanced use-case. The more common scenario is that the dependency just doesn't declare a build system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:439 on 2025-07-03 14:29</div>
            <div class="timeline-body"><p>We should probably change this from an admonition to a whole section, it's getting long and then we can link to it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>docs/concepts/projects/dependencies.md</code>:441 on 2025-07-03 14:34</div>
            <div class="timeline-body"><p>Here I was trying to emphasize the combination of <code>package</code> values since the point about building dependencies without a declared build system is already covered in the build systems section of the docs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-07-03 14:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-03 14:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/projects/dependencies.md</code>:441 on 2025-07-03 14:56</div>
            <div class="timeline-body"><p>That section is about building the current project, where-as here we need to talk about how we build projects when they're dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/concepts/projects/dependencies.md</code>:415 on 2025-07-04 09:51</div>
            <div class="timeline-body"><pre><code class="language-suggestion">[`[build-system]` table](./config.md#build-systems). If you'd like to override this behavior and
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-07-04 09:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/T-256">@T-256</a> reviewed on 2025-07-04 21:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/T-256">@T-256</a> on <code>docs/concepts/projects/dependencies.md</code>:420 on 2025-07-04 21:31</div>
            <div class="timeline-body"><p>Invalid <code>project</code> table? (missing name and version)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>docs/concepts/projects/dependencies.md</code>:420 on 2025-07-07 07:58</div>
            <div class="timeline-body"><p>This is following a pattern found throughout this file. If we want to change that, I think it's out of scope here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-07-07 07:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-15 17:55</div>
            <div class="timeline-body"><p>I posted some documentation edits at https://github.com/astral-sh/uv/pull/14632</p>
<p>I've rolled it out of the &quot;Path&quot; section because I think it was getting too long and nested.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-07-16 21:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-07-16 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-07-16 21:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-07-16 21:17</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:43:50 UTC
    </footer>
</body>
</html>
