<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>disable Force color over no color - astral-sh/uv #8183</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>disable Force color over no color</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/pull/8183">#8183</a>
        opened by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a>
        on 2024-10-14 18:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a></div>
            <div class="timeline-body"><p>closes #8173</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-10-14 18:31</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/settings.rs</code>:84 on 2024-10-14 18:31</div>
            <div class="timeline-body"><p>Won't this always match since the default is &quot;auto&quot; at the clap-level?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> reviewed on 2024-10-14 18:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on <code>crates/uv/src/settings.rs</code>:84 on 2024-10-14 18:36</div>
            <div class="timeline-body"><p>Yupp, But I thought if <code>--color</code> is passed explicitly, we can use the value of <code>args.color</code> directly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> reviewed on 2024-10-14 18:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on <code>crates/uv/src/settings.rs</code>:84 on 2024-10-14 18:39</div>
            <div class="timeline-body"><p>Also, when I tested the expected result was coming for all three separate cases. Means for <code>FORCE_COLOR</code> and <code>--color</code> and with sub arguments.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-10-14 18:42</div>
            <div class="timeline-body"><p>Unless I'm missing something, I believe this changes standard behavior since env var should still take priority over cli when honoring the order of <code>no color &gt; force color | force cli color &gt; auto</code></p>
<p>For example, if you have <code>NO_COLOR</code> set and pass <code>--color always</code> as well, <code>NO_COLOR</code> should take precedence.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> reviewed on 2024-10-14 19:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on <code>crates/uv/src/settings.rs</code>:84 on 2024-10-14 19:37</div>
            <div class="timeline-body"><blockquote>
<p>Won't this always match since the default is &quot;auto&quot; at the clap-level?</p>
</blockquote>
<p>Done purposely, as when the user does not anything (neither the environment variables nor the --color), then I wanted the auto property. As If <code>--color</code> is given, it doesn't matter the value, we can always use them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-14 20:08</div>
            <div class="timeline-body"><blockquote>
<p>if you have NO_COLOR set and pass --color always as well, NO_COLOR should take precedence.</p>
</blockquote>
<p>Should it? Honestly not sure.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-10-14 20:24</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>if you have NO_COLOR set and pass --color always as well, NO_COLOR should take precedence.</p>
</blockquote>
<p>Should it? Honestly not sure.</p>
</blockquote>
<p>Fair, I was considering CI scenarios when I said this. Wouldn't this be a breaking if changed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-14 20:25</div>
            <div class="timeline-body"><p>The docs (https://no-color.org/) at least state that &quot;per-instance command-line arguments should override the NO_COLOR environment variable&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-10-14 20:27</div>
            <div class="timeline-body"><blockquote>
<p>The docs (https://no-color.org/) at least state that &quot;per-instance command-line arguments should override the NO_COLOR environment variable&quot;.</p>
</blockquote>
<p>Does the same apply for FORCE_COLOR? Or CLICOLOR_FORCE?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-10-14 20:31</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>The docs (https://no-color.org/) at least state that &quot;per-instance command-line arguments should override the NO_COLOR environment variable&quot;.</p>
</blockquote>
<p>Does the same apply for FORCE_COLOR? Or CLICOLOR_FORCE?</p>
</blockquote>
<p>Sounds like it does at least for <code>CLICOLOR_FORCE</code>, https://bixense.com/clicolors/
<code>FORCE_COLOR</code> doesn't say.</p>
<p>I've likely been using it wrong ðŸ˜†</p>
<p>To me, its a bit vague since the relationship between <code>NO_COLOR</code> and <code>FORCE_COLOR</code> and <code>CLICOLOR_FORCE</code> in this scenario is not well defined in any of the standards from what I can see.</p>
<p>Sounds like <code>uv</code> should follow this then?</p>
<ol>
<li>Explicit CLI <code>--color never</code> / <code>--color always</code> takes precedence over the env vars.</li>
<li>Env vars then kick-in, <code>NO_COLOR</code> &gt; <code>FORCE_COLOR</code> | <code>CLICOLOR_FORCE</code></li>
<li>Auto Detection</li>
</ol>
<p>What about an explicit <code>--color auto</code>? It's not clear which one would apply in the presence of the env vars being set.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-14 23:36</div>
            <div class="timeline-body"><p>Yeah, agree with this @samypr100:</p>
<ul>
<li>Explicit CLI --color never / --color always takes precedence over the env vars.</li>
<li>Env vars then kick-in, NO_COLOR &gt; FORCE_COLOR | CLICOLOR_FORCE</li>
<li>Auto Detection</li>
</ul>
<p>I think <code>--color=auto</code> should also override the env vars (https://bixense.com/clicolors/ shows an example of that, arguably).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-15 12:26</div>
            <div class="timeline-body"><p>@Aditya-PS-05 - Do you plan to pursue the follow-up changes mentioned here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on 2024-10-15 12:29</div>
            <div class="timeline-body"><blockquote>
<p>Yeah, agree with this @samypr100:</p>
<pre><code>* Explicit CLI --color never / --color always takes precedence over the env vars.

* Env vars then kick-in, NO_COLOR &gt; FORCE_COLOR | CLICOLOR_FORCE

* Auto Detection</code></pre>
<p>I think <code>--color=auto</code> should also override the env vars (https://bixense.com/clicolors/ shows an example of that, arguably).</p>
</blockquote>
<p>@charliermarsh
I am making this change following your instructions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Aditya-PS-05 on 2024-10-15 13:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on 2024-10-15 13:28</div>
            <div class="timeline-body"><p>All the required changes are done in the pr #8215</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:40:05 UTC
    </footer>
</body>
</html>
