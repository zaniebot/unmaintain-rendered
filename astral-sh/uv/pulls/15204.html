<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Filter date in GitHub release URLs for `python_install_no_cache` test - astral-sh/uv #15204</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1> Filter date in GitHub release URLs for `python_install_no_cache` test</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/15204">#15204</a>
        opened by <a href="https://github.com/ubaidsk">@ubaidsk</a>
        on 2025-08-10 17:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/ubaidsk">@ubaidsk</a> on 2025-08-10 17:02</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>fixes https://github.com/astral-sh/uv/issues/15172</p>
<p>This change adds a regex filter to normalize dates in GitHub release URLs within the <code>python_install_no_cache</code> test snapshot.</p>
<p><strong>Problem:</strong>
The test was hardcoding the date <code>20250808</code> in the expected error message URL:</p>
<pre><code class="language-console">https://github.com/astral-sh/python-build-standalone/releases/download/20250808/cpython-3.12.[PATCH]-[DATE]-[PLATFORM].tar.gz
</code></pre>
<p>This creates a maintenance burden as the snapshot would need to be updated whenever the underlying Python release date changes.</p>
<p><strong>Solution:</strong>
Added a regex filter <code>r&quot;releases/download/\d{8}/&quot;</code> → <code>&quot;releases/download/[DATE]/&quot;</code> to replace any 8-digit date in the GitHub release URL path with a generic <code>[DATE]</code> placeholder.</p>
<p><strong>Result:</strong>
The test is now resilient to new Python releases and won't require snapshot updates when the underlying release date changes. The error message now consistently shows:</p>
<pre><code class="language-console">https://github.com/astral-sh/python-build-standalone/releases/download/[DATE]/cpython-3.12.[PATCH]-[DATE]-[PLATFORM].tar.gz
</code></pre>
<h2>Test Plan</h2>
<p><code>python_install</code> tests seem to pass ✅</p>
<pre><code class="language-console">$ cargo test --package uv --test it -- python_install
   Compiling uv-cli v0.0.1 (/home/ubaid/projects/uv/crates/uv-cli)
   Compiling uv v0.8.8 (/home/ubaid/projects/uv/crates/uv)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 19.04s
     Running tests/it/main.rs (target/debug/deps/it-14d47eb0324a8a0a)

running 30 tests
test python_install::python_install_unknown ... ok
test network::python_install_io_error ... ok
test network::python_install_http_500 ... ok
test python_install::python_install_invalid_request ... ok
test python_install::python_install_broken_link ... ok
test python_install::python_install_preview_no_bin ... ok
test python_install::regression_cpython ... ok
test python_install::uninstall_last_patch ... ok
test python_install::install_no_transparent_upgrade_with_venv_patch_specification ... ok
test python_install::install_lower_patch_automatically ... ok
test python_install::uninstall_highest_patch ... ok
test python_install::install_transparent_patch_upgrade_venv_module ... ok
test python_install::python_install_default_from_env ... ok
test python_install::python_install ... ok
test python_install::python_reinstall_patch ... ok
test python_install::python_install_force ... ok
test python_install::install_transparent_patch_upgrade_uv_venv ... ok
test python_install::install_multiple_patches ... ok
test python_install::python_install_314 ... ok
test python_install::python_install_default ... ok
test python_install::python_install_automatic ... ok
test python_install::python_install_freethreaded ... ok
test python_install::python_install_preview_upgrade ... ok
test python_install::python_install_no_cache ... ok
test python_install::python_install_default_preview ... ok
test python_install::python_install_preview ... ok
test python_install::python_install_minor ... ok
test python_install::python_reinstall ... ok
test python_install::python_install_cached ... ok
test python_install::python_install_multiple_patch ... ok

test result: ok. 30 passed; 0 failed; 0 ignored; 0 measured; 2207 filtered out; finished in 23.34s
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-08-11 21:15</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">testing</span> added by @zanieb on 2025-08-11 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-08-11 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-08-11 21:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-12 05:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 06:47:20 UTC
    </footer>
</body>
</html>
