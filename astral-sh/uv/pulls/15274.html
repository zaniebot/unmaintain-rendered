<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Persist cache info when re-installing cached wheels - astral-sh/uv #15274</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Persist cache info when re-installing cached wheels</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/15274">#15274</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2025-08-14 11:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-14 11:48</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>I noticed that these paths aren't returning the cache information, so if you install through these paths, we actually don't write <code>uv_cache.json</code> at all. I'm not sure how a user would actually end up here, because assuming there are no bugs, we don't really ever use this path? The install plan indexes the cached wheels and marks the wheel as installed, which means it's typically a mistake if we're asking the <code>DistributionDatabase</code> for a wheel that's already available in the cache... But I did verify that if I <em>skip</em> the install plan's cache lookup, we write a wheel without <code>uv_cache.json</code>, so this is definitely more correct.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2025-08-14 11:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2025-08-14 11:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-08-14 11:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-distribution/src/source/built_wheel_metadata.rs</code>:60 on 2025-08-14 11:50</div>
            <div class="timeline-body"><p>Instead of using these <code>with_</code> methods, I split up the struct to make the fields required (which makes this mistake much harder to do).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2025-08-14 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-08-14 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-14 12:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 06:47:21 UTC
    </footer>
</body>
</html>
