<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support `--find-links`-style &quot;flat&quot; indexes in `[[tool.uv.index]]` - astral-sh/uv #12407</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support <code>--find-links</code>-style &quot;flat&quot; indexes in <code>[[tool.uv.index]]</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/12407">#12407</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2025-03-24 01:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-24 01:56</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR extends <code>[[tool.uv.index]]</code> to support <code>--find-links</code>-style &quot;flat&quot; indexes, so that users can point to such indexes without using <code>--find-links</code> <em>and</em> get access to the full functionality of <code>[[tool.uv.index]]</code> (e.g., they can now pin packages to <code>--find-links</code>-style indexes).</p>
<p>Note that, at present, <code>--find-links</code> indexes actually have some quirky behavior, in that we combine them into a single entity and then merge the discovered distributions into each Simple API-style index. The motivation here, IIRC, was to match pip's behavior quite closely. I'm interested in <em>removing</em> that behavior, but it'd be breaking (and may also be inconvenient for some use-cases). So, the behavior for indexes passed in via <code>--find-links</code> remains completely unchanged. However, <code>[[tool.uv.index]]</code> entries with <code>format = &quot;flat&quot;</code> are now treated identically to those defined with <code>format = &quot;simple&quot;</code> (the default), in that we stop after we find the first-matching index, etc.</p>
<p>Closes https://github.com/astral-sh/uv/issues/11634.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2025-03-24 01:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">no-build</span> added by @charliermarsh on 2025-03-24 02:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2025-03-24 02:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2025-03-24 14:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2025-03-24 14:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/flat_index.rs</code>:66 on 2025-03-24 19:41</div>
            <div class="timeline-body"><p>This field docs say:</p>
<pre><code>/// Whether any `--find-links` entries could not be resolved due to a lack of network
/// connectivity.</code></pre>
<p>which sounds different from this docstring.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-distribution-types/src/index.rs</code>:73 on 2025-03-24 19:46</div>
            <div class="timeline-body"><p>Can't comment there, but the jsonschema description of <code>IndexUrl</code> needs to be updated</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-client/src/registry_client.rs</code>:309 on 2025-03-24 19:48</div>
            <div class="timeline-body"><p>Is this still &quot;approximately&quot;?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/it/lock.rs</code>:9673 on 2025-03-24 19:50</div>
            <div class="timeline-body"><p>Can you add a description what this test is checking? It's not clear to me from the name</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/it/lock.rs</code>:10124 on 2025-03-24 19:51</div>
            <div class="timeline-body"><p>nit (also below):</p>
<pre><code class="language-suggestion">        Url::from_file_path(context.temp_dir.join(&quot;links/&quot;)).unwrap()
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2025-03-24 19:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-03-25 01:49</div>
            <div class="timeline-body"><p>I approve of the design choices here (but did not read the implementation)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2025-03-26 01:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-03-26 01:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-03-26 01:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:22 UTC
    </footer>
</body>
</html>
