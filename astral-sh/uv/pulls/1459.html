<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix list rendering in `venv --help` output - astral-sh/uv #1459</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Fix list rendering in <code>venv --help</code> output</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1459">#1459</a>
        opened by <a href="https://github.com/MichaReiser">@MichaReiser</a>
        on 2024-02-16 09:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Use <a href="https://docs.rs/clap/latest/clap/_derive/index.html#arg-attributes"><code>verbatim_doc_comment</code></a> to preserve the formatting of the venv <code>python</code> command line option to avoid that the list formatting gets mangled.</p>
<p>I changed the lists to use <code>-</code> which is what clap uses to render possible options (see color) and removed the <code>-p</code> in front of each format (again, to match claps possible options rendering)</p>
<p>Fixes https://github.com/astral-sh/uv/issues/1364</p>
<h2>Test Plan</h2>
<pre><code>Create a virtual environment

Usage: uv venv [OPTIONS] [NAME]

Arguments:
  [NAME]
          The path to the virtual environment to create
          
          [default: .venv]

Options:
  -p, --python &lt;PYTHON&gt;
          The Python interpreter to use for the virtual environment.
          
          Supported formats:
          - `3.10` searches for an installed Python 3.10 (`py --list-paths` on Windows, `python3.10` on Linux/Mac).
            Specifying a patch version is not supported.
          - `python3.10` or `python.exe` looks for a binary in `PATH`.
          - `/home/ferris/.local/bin/python3.10` uses this exact Python.
          
          Note that this is different from `--python-version` in `pip compile`, which takes `3.10` or `3.10.13` and
          doesn't look for a Python interpreter on disk.

      --seed
          Install seed packages (`pip`, `setuptools`, and `wheel`) into the virtual environment

  -i, --index-url &lt;INDEX_URL&gt;
          The URL of the Python Package Index
          
          [env: UV_INDEX_URL=]
          [default: https://pypi.org/simple]

      --extra-index-url &lt;EXTRA_INDEX_URL&gt;
          Extra URLs of package indexes to use, in addition to `--index-url`

  -q, --quiet
          Do not print any output

      --no-index
          Ignore the registry index (e.g., PyPI), instead relying on direct URL dependencies and those discovered via `--find-links`

  -v, --verbose
          Use verbose output

      --offline
          Run offline, i.e., without accessing the network

      --color &lt;COLOR&gt;
          Control colors in output
          
          [default: auto]

          Possible values:
          - auto:   Enables colored output only when the output is going to a terminal or TTY with support
          - always: Enables colored output regardless of the detected environment
          - never:  Disables colored output

  -n, --no-cache
          Avoid reading from or writing to the cache
          
          [env: UV_NO_CACHE=]

      --cache-dir &lt;CACHE_DIR&gt;
          Path to the cache directory
          
          [env: UV_CACHE_DIR=]

  -h, --help
          Print help (see a summary with '-h')

  -V, --version
          Print version

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Fix venv help text for python version option" to "Fix list rendering in `venv --help` output" by @MichaReiser on 2024-02-16 09:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MichaReiser on 2024-02-16 09:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/dhruvmanila">@dhruvmanila</a> approved on 2024-02-16 09:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-16 14:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/main.rs</code>:638 on 2024-02-16 14:26</div>
            <div class="timeline-body"><p>Can we toggle the comment with cfg to have it be platform relevant? I think that'd make it a lot shorter and it wouldn't need to be listed like this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-16 14:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/main.rs</code>:638 on 2024-02-16 14:28</div>
            <div class="timeline-body"><p>(Happy to track this in a follow-up too)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MichaReiser">@MichaReiser</a> reviewed on 2024-02-16 14:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on <code>crates/uv/src/main.rs</code>:638 on 2024-02-16 14:36</div>
            <div class="timeline-body"><p>Hmm, no if <code>cfg</code> applies to comments. We could define a custom struct for the <code>Path</code> and have two different definitions for each platform but that's a bit more involved (and requires copying the configuration)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @MichaReiser on 2024-02-16 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MichaReiser on 2024-02-16 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-02-16 14:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:35:33 UTC
    </footer>
</body>
</html>
