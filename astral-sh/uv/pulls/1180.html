<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prompt user for missing `-r` and `-e` flags in `pip install` - astral-sh/uv #1180</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Prompt user for missing <code>-r</code> and <code>-e</code> flags in <code>pip install</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1180">#1180</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-30 01:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>If the user runs a command like <code>pip install requirements.txt</code>, we now prompt them to ask if they meant to include the <code>-r</code> flag:</p>
<p><img src="https://github.com/astral-sh/puffin/assets/1309177/82b9f7a2-2526-4144-b200-a5015e5b8a4b" alt="Screenshot 2024-01-29 at 8 38 29 PM" /></p>
<p><img src="https://github.com/astral-sh/puffin/assets/1309177/bd8ebb51-2537-4540-a0e0-718e66a1c69c" alt="Screenshot 2024-01-29 at 8 38 33 PM" /></p>
<p>The specific logic is: if the requirement ends in <code>.txt</code> or <code>.in</code>, and the file exists locally, prompt the user for <code>-r</code>. If the requirement contains a directory separator, and the directory exists locally, prompt the user for <code>-e</code>.</p>
<p>Closes #1166.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 01:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>Cargo.toml</code>:32 on 2024-01-30 01:41</div>
            <div class="timeline-body"><p>We already depend on <code>console</code> via <code>indicatif</code>, so this doesn't actually add any new dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 01:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 01:41</div>
            <div class="timeline-body"><p>(This package will be invalid anyway, it'll get rejected when we try to parse it.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-01-30 01:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-01-30 01:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-01-30 01:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/main.rs</code>:674 on 2024-01-30 01:51</div>
            <div class="timeline-body"><p>I got rid of the <code>From&lt;PathBuf&gt;</code> implementation for this, it felt a bit magical.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 01:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/confirm.rs</code>:7 on 2024-01-30 01:51</div>
            <div class="timeline-body"><p>We could pull in <code>dialoguer</code> for this but it added 70 KB to the binary and it felt like overkill. It's the exact same code as below though (modulo more configuration options).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 01:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-01-30 02:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/src/requirements.rs</code>:54 on 2024-01-30 02:54</div>
            <div class="timeline-body"><p>Should we say &quot;looks like a requirements file but was passed as a package name&quot; ? Otherwise what I did wrong is not immediately obvious (same for the directory case)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-01-30 02:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 02:56</div>
            <div class="timeline-body"><p>Uh... <code>pip</code> allows this. It installs the local directory without making it editable e.g. <code>pip install ../../zanieb/packse</code> works fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 03:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 03:00</div>
            <div class="timeline-body"><p>Okay, should we support it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 03:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 03:03</div>
            <div class="timeline-body"><p>(We obviously can't support it today since we require a package name.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-01-30 03:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 03:07</div>
            <div class="timeline-body"><p>Let's see if we can avoid supporting it to start. I'm not sure what the use case is, I guess maybe to test installation from what is basically a source distribution instead of having the full package source available? Maybe to pin the package from a temporary checkout? I use it locally sometimes but not with a great deal of intention.</p>
<p>Presuming we fix the bug in #1181 will it work if a package name is provided?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 03:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 03:10</div>
            <div class="timeline-body"><p>Sounds good. Yeah should be supported: https://github.com/astral-sh/puffin/pull/1182. Do you think it's worth including this prompt, or no?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-01-30 03:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 03:16</div>
            <div class="timeline-body"><p>Yeah I think so. It might be worth including a note about the other syntax too?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-01-30 03:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 03:16</div>
            <div class="timeline-body"><p>Maybe this one could be an error since it's ambiguous... but <code>-e</code> seems <em>much</em> more common</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-01-30 05:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:54 on 2024-01-30 05:09</div>
            <div class="timeline-body"><p>Changed it. My only hesitation is that it's a pretty long message now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 05:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-01-30 08:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 08:10</div>
            <div class="timeline-body"><p>What happens if you do <code>pip install &lt;dir&gt;</code> with a package that doesn't support editable builds, do we error? In that we case we should support <code>pip install &lt;dir&gt;</code>. My example use case is you clone the repo, patch something and want to know if it fixes your bug, so you do with <code>pip install ../foo &amp;&amp; python ./tests/reproducer.py</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-01-30 08:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 15:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 15:37</div>
            <div class="timeline-body"><p>We can't support <code>pip install &lt;dir&gt;</code> right now because we need a package name. We could add a similar workflow whereby we prompt for a package name, what do you think of that? Same for <code>pip install https://...</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-01-30 15:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 15:43</div>
            <div class="timeline-body"><p>I think we should try to avoid expanding scope with more prompts. I feel like a suggestion that you can provide the package name as an alternative should be sufficient? Do you want me to try to actually come up with a message I like?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 16:01</div>
            <div class="timeline-body"><p>Yes feel free!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 16:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-01-30 16:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-01-30 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-30 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-30 18:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-30 19:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 19:18</div>
            <div class="timeline-body"><p>FTR, I use <code>pip install &lt;dir&gt;</code> without <code>-e</code> sometimes to check I've got my pyproject.toml setup correctly. End users downloading my package from PyPI won't be getting editable installs, and editable installs have access to files hanging around on my local filesystem that non-editable installs don't have -- so to accurately test what the end user will be getting, I have to use a non-editable install. Editable installs also sometimes behave differently for <code>--version</code> etc.</p>
<p>I think some GitHub actions to check packaging stuff might do a similar thing as well</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-30 19:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 19:39</div>
            <div class="timeline-body"><p>Yeah, we should support it, but we currently don't (independent of this change), because we require a package name for all dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AlexWaygood">@AlexWaygood</a> reviewed on 2024-01-30 19:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on <code>crates/puffin/src/requirements.rs</code>:65 on 2024-01-30 19:41</div>
            <div class="timeline-body"><p>Makes sense!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:35:23 UTC
    </footer>
</body>
</html>
