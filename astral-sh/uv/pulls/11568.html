<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update Rust crate jiff to 0.2.0 - astral-sh/uv #11568</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update Rust crate jiff to 0.2.0</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/11568">#11568</a>
        opened by <a href="https://github.com/renovate">@renovate</a>
        on 2025-02-17 01:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/renovate">@renovate</a></div>
            <div class="timeline-body"><p>This PR contains the following updates:</p>
<p>| Package | Type | Update | Change |
|---|---|---|---|
| <a href="https://redirect.github.com/BurntSushi/jiff">jiff</a> | workspace.dependencies | minor | <code>0.1.14</code> -&gt; <code>0.2.0</code> |</p>
<hr>
Release Notes

BurntSushi/jiff (jiff)

<a href="https://redirect.github.com/BurntSushi/jiff/blob/HEAD/CHANGELOG.md#021-2025-02-16"><code>v0.2.1</code></a>
<p><a href="https://redirect.github.com/BurntSushi/jiff/compare/0.2.0...0.2.1">Compare Source</a></p>
<p>==================
This release includes a massive number of optimizations that significantly
improves performance in some cases. If you had a workload whose performance
with Jiff was underwhelming, please give it a try. I welcome questions via
[Discussions on GitHub].</p>
<p>This release also provides a new API, <code>Timestamp::constant</code>, for constructing
<code>Timestamp</code> values in a <code>const</code> context.</p>
<p>Enhancements:</p>
<ul>
<li><a href="https://redirect.github.com/BurntSushi/jiff/discussions/235">#â€‹235</a>,
<a href="https://redirect.github.com/BurntSushi/jiff/discussions/255">#â€‹255</a>,
<a href="https://redirect.github.com/BurntSushi/jiff/pull/266">#â€‹266</a>:
A massive number of performance improvements. Jiff should now generally be
faster than <code>chrono</code> and <code>time</code>.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/263">#â€‹263</a>:
Add <code>Timestamp::constant</code> for constructing timestamps in <code>const</code> context.</li>
</ul>
<a href="https://redirect.github.com/BurntSushi/jiff/blob/HEAD/CHANGELOG.md#020-2025-02-10"><code>v0.2.0</code></a>
<p><a href="https://redirect.github.com/BurntSushi/jiff/compare/0.1.29...0.2.0">Compare Source</a></p>
<p>==================
This is a new semver incompatible release of Jiff. It contains several breaking
changes. I expect most users of Jiff to be able to upgrade without any changes.
The fundamental API organization of Jiff has not changed.</p>
<p>Some of the highlights of this release include reducing footguns and better
ecosystem integration.</p>
<p>For reducing footguns, APIs on <code>Span</code> will no longer implicitly assume that
days are always 24 hours long. And <code>Span</code> no longer implements <code>PartialEq</code> or
<code>Eq</code> (instead favoring <code>span.fieldwise()</code> to create a value that supports naive
fieldwise comparison). Moreover, when using <code>TimeZone::system()</code> (perhaps via
<code>Zoned::now()</code>), if the system time zone could not be detected, then a special
<code>Etc/Unknown</code> time zone will be used instead. This avoids erroring, but also
surfaces itself to make it clearer that something has (perhaps) gone wrong.</p>
<p>As for ecosystem integration, this release coincides with the publication
of the [<code>jiff-icu</code>], [<code>jiff-sqlx</code>] and [<code>jiff-diesel</code>] crates. <code>jiff-icu</code>
integrates with the [ICU4X project], and is now the recommended way to use
Jiff to work with non-Gregorian calendars or to localize datetimes for end
users. <code>jiff-sqlx</code> and <code>jiff-diesel</code> provide wrapper types that implement the
necessary traits to make it ergonomic to store and retrieve Jiff values in a
database using [SQLx] or [Diesel], respectively.</p>
<p>Unless something unexpected happens, my plan is for the next breaking change
release to be Jiff 1.0 in about 6 months. Once Jiff 1.0 is out, I plan to
commit to it indefinitely.</p>
<p><strong>BREAKING CHANGES</strong>:</p>
<p>This is an exhaustive list of breaking changes. Changes with the bolded
<strong>RUNTIME</strong> prefix are changes that will not be caught by the Rust compiler.
That is, they are changes in runtime behavior.</p>
<ul>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/28">#â€‹28</a>:
The deprecated <code>intz</code> routines on <code>Zoned</code>, <code>Timestamp</code>, <code>civil::DateTime</code> and
<code>civil::Date</code> have been removed. You can use <code>in_tz</code> instead. This change was
made because many found the name <code>intz</code> to be unclear.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/32">#â€‹32</a>:
The <code>PartialEq</code> and <code>Eq</code> trait implementations on <code>Span</code> have been removed.
Ideally these shouldn&#x27;t have been used, but if you do need them, please use
<code>Span::fieldwise</code> to create a <code>SpanFieldwise</code>, which does have the <code>PartialEq</code>
and <code>Eq</code> traits implemented. These were removed on <code>Span</code> itself because they
made it very easy to commit subtle bugs.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/36">#â€‹36</a>:
Turn panics during <code>Timestamp::saturing_add</code> into errors. Callers adding
spans that are known to contain units of hours or smaller are guaranteed that
this will not return an error.</li>
<li><strong>RUNTIME</strong> <a href="https://redirect.github.com/BurntSushi/jiff/issues/48">#â€‹48</a>:
On <code>Span</code> APIs, days are no longer silently assumed to always be 24 hours when
a relative datetime is not provided. Instead, to perform operations on units
of days or bigger, callers must either provide a relative date or opt into
invariant 24-hour days with <code>SpanRelativeTo::days_are_24_hours</code>. Shortcuts have
been added to the span builders. For example, <code>SpanTotal::days_are_24_hours</code>.</li>
<li><strong>RUNTIME</strong> <a href="https://redirect.github.com/BurntSushi/jiff/issues/147">#â€‹147</a>:
Change the behavior of the deprecated <code>%V</code> conversion specifier in
<code>jiff::fmt::strtime</code> from formatting an IANA time zone identifier to formatting
an ISO 8601 week number. To format an IANA time zone identifier, use <code>%Q</code> or
<code>%:Q</code> (which were introduced in <code>jiff 0.1</code>).</li>
<li><strong>RUNTIME</strong> <a href="https://redirect.github.com/BurntSushi/jiff/issues/212">#â€‹212</a>:
When parsing into a <code>Zoned</code> with a civil time corresponding to a gap, we treat
all offsets as invalid and return an error. Previously, we would accept the
offset as given. This brings us into line with Temporal&#x27;s behavior. For
example, previously Jiff accepted <code>2006-04-02T02:30-05[America/Indiana/Vevay]</code>
but will now return an error. This is desirable for cases where a datetime in
the future is serialized before a change in the daylight saving time rules.
For more examples, see <code>jiff::fmt::temporal::DateTimeParser::offset_conflict</code>
for details on how to change Jiff&#x27;s default behavior. This behavior change also
applies to <code>tz::OffsetConflict::PreferOffset</code>.</li>
<li><strong>RUNTIME</strong> <a href="https://redirect.github.com/BurntSushi/jiff/issues/213">#â€‹213</a>:
Tweak the semantics of <code>tz::TimeZoneDatabase</code> so that it only initializes one
internal tzdb instead of trying to find as many as possible. It is unlikely
that you&#x27;ll be impacted by this change, but it&#x27;s meant to make the semantics
be a bit more sensible. (In <code>jiff 0.1</code>, it was in theory possible for one tz
lookup to succeed in the system zoneinfo and then another tz lookup to fail
in zoneinfo but succeed automatically via the bundled copy. But this seems
confusing and possibly not desirable. Hence the change.)</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/218">#â€‹218</a>:
In order to make naming a little more consistent between <code>Zoned</code>
and <code>civil::Date</code>, the <code>civil::Date::to_iso_week_date</code> and
<code>civil::ISOWeekDate::to_date</code> APIs were renamed to <code>civil::Date::iso_week_date</code>
and <code>civil::ISOWeekDate::date</code>.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/220">#â€‹220</a>:
Remove <code>Span::to_duration</code> for converting a <code>Span</code> to a <code>std::time::Duration</code>
and rename <code>Span::to_jiff_duration</code> to <code>Span::to_duration</code>. This prioritizes
<code>SignedDuration</code> as the &quot;primary&quot; non-calendar duration type in Jiff. And makes
it more consistent with APIs like <code>Zoned::duration_since</code>. For non-calendar
spans, the <code>TryFrom&lt;Span&gt; for std::time::Duration</code> still exists. For calendar
durations, use <code>Span::to_duration</code> and then convert the <code>SignedDuration</code> to
<code>std::time::Duration</code>. Additionally, <code>Timestamp::from_jiff_duration</code> and
<code>Timestamp::as_jiff_duration</code> were renamed to <code>Timestamp::from_duration</code> and
<code>Timestamp::as_duration</code>, respectively. The old deprecated routines on the
unsigned <code>std::time::Duration</code> have been removed.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/221">#â€‹221</a>:
Change the type of the value yielded by the <code>jiff::tz::TimeZoneNameIter</code>
iterator from <code>String</code> to <code>jiff::tz::TimeZoneName</code>. This opaque type is more
API evolution friendly. To access the string, either use <code>TimeZoneName</code>&#x27;s
<code>Display</code> trait implementation, or its <code>as_str</code> method.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/222">#â€‹222</a>:
Split <code>TimeZone::to_offset</code> into two methods. One that just returns the
offset, and another, <code>TimeZone::to_offset_info</code>, which includes the offset,
DST status and time zone abbreviation. The extra info is rarely needed and
is sometimes more costly to compute. Also, make the lifetime of the time
zone abbreviation returned by <code>TimeZoneTransition::abbreviation</code> tied to
the transition instead of the time zone (for future API flexibility, likely
in core-only environments). This change was overall motivated by wanting to
do less work in the common case (where we only need the offset), and for
reducing the size of a <code>TimeZone</code> considerably in core-only environments.
Callers previously using <code>TimeZone::to_offset</code> to get DST status and time zone
abbreviation should now use <code>TimeZone::to_offset_info</code>.</li>
<li><strong>RUNTIME</strong> <a href="https://redirect.github.com/BurntSushi/jiff/issues/230">#â€‹230</a>:
When <code>TimeZone::system()</code> cannot find a system configured time zone, <code>jiff 0.1</code> would automatically fall back to <code>TimeZone::UTC</code> (with a WARN-level log
message). In <code>jiff 0.2</code>, the fall back is now to <code>TimeZone::unknown()</code>, which
has a special <code>Etc/Unknown</code> identifier (as specified by Unicode and reserved by
the IANA time zone database). The fallback otherwise still behaves as if it
were <code>TimeZone::UTC</code>. This helps surface error conditions related to finding
the system time zone without causing unrecoverable failure.</li>
</ul>
<p>Enhancements:</p>
<ul>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/136">#â€‹136</a>:
When the special <code>SpanRelativeTo::days_are_24_hours()</code> marker is used, weeks
will also be treated as invariant. That is, seven 24-hour days. In all cases,
working with years and months still requires a relative date.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/issues/228">#â€‹228</a>:
It is now possible to forcefully use a bundled copy of the IANA time zone
database without relying on disabling crate features. This can be done by
enabling the <code>tzdb-bundle-always</code> crate feature and explicitly creating a
<code>jiff::tz::TimeZoneDatabase::bundled()</code> database. Once in hand, you must use
APIs like <code>TimeZoneDatabase::get</code> to create a <code>TimeZone</code> and avoid any APIs
that implicitly use the global time zone database (like <code>Timestamp::in_tz</code> or
even <code>Zoned::from_str</code>).</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/pull/238">#â€‹238</a>:
Add integration with the ICU4X project via the [<code>jiff-icu</code>] crate. <code>jiff-icu</code>
provides traits for easily converting between datetime types defined in Jiff
and datetime types defined in ICU4X.</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/pull/240">#â€‹240</a>:
Add integration with the SQLx project via the [<code>jiff-sqlx</code>] crate. <code>jiff-sqlx</code>
provides wrapper types that implement the necessary traits in SQLx for
reasonably ergonomic integration. This includes PostgreSQL and SQLite support,
but not MySQL support. (It&#x27;s not clear if it&#x27;s possible at present to provide
MySQL supprot fro SQLx for datetime types outside of SQLx itself.)</li>
<li><a href="https://redirect.github.com/BurntSushi/jiff/pull/241">#â€‹241</a>:
Add integration with the Diesel project via the [<code>jiff-diesel</code>] crate.
<code>jiff-diesel</code> provides wrapper types that implement the necessary traits in
Diesel for reasonably ergonomic integration. This includes MySQL, PostgreSQL
and SQLite support.</li>
</ul>


<hr>
Configuration
<p>ðŸ“… <strong>Schedule</strong>: Branch creation - &quot;before 4am on Monday&quot; (UTC), Automerge - At any time (no schedule defined).</p>
<p>ðŸš¦ <strong>Automerge</strong>: Disabled by config. Please merge this manually once you are satisfied.</p>
<p>â™» <strong>Rebasing</strong>: Whenever PR becomes conflicted, or you tick the rebase/retry checkbox.</p>
<p>ðŸ”• <strong>Ignore</strong>: Close this PR and you won&#x27;t be reminded about this update again.</p>
<hr>
<ul>
<li>[ ] If you want to rebase/retry this PR, check this box</li>
</ul>
<hr>
<p>This PR was generated by <a href="https://mend.io/renovate/">Mend Renovate</a>. View the <a href="https://developer.mend.io/github/astral-sh/uv">repository job log</a>.</p>


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/renovate[bot]">@renovate[bot]</a> on 2025-02-17 01:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-17 02:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-17 02:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-02-17 02:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:50:55 UTC
    </footer>
</body>
</html>
