<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow use of free-threaded variants in Python 3.14+ without explicit opt-in - astral-sh/uv #16142</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow use of free-threaded variants in Python 3.14+ without explicit opt-in</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/16142">#16142</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-10-06 20:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-06 20:45</div>
            <div class="timeline-body"><p>Closes https://github.com/astral-sh/uv/issues/15739
Closes #12445</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zanieb on 2025-10-07 03:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/geofft">@geofft</a> on <code>crates/uv-python/src/discovery.rs</code>:1685 on 2025-10-07 16:10</div>
            <div class="timeline-body"><p>Is it intentional that the logic above isn't present on these two lines? If I understand correctly, the implication is <code>uvx python3.13t</code> and <code>uvx python3.13d</code> will both use a python3.13td if that's the only one you can find?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/geofft">@geofft</a> reviewed on 2025-10-07 16:11</div>
            <div class="timeline-body"><p>If Python 3.14 is not installed, is there any chance that <code>uvx python3.14</code> will install a freethreading build instead of a normal one because they now both satisfy the request?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 16:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/discovery.rs</code>:1685 on 2025-10-07 16:14</div>
            <div class="timeline-body"><p>Yeah, that's the same &quot;backwards compatible&quot; idea captured in the TODO that debug builds don't require opt-in.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zsol">@zsol</a> approved on 2025-10-07 16:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-07 16:15</div>
            <div class="timeline-body"><blockquote>
<p>If Python 3.14 is not installed, is there any chance that <code>uvx python3.14</code> will install a freethreading build instead of a normal one because they now both satisfy the request?</p>
</blockquote>
<p>No, that's defined by the ordering of downloads. This only changes logic for whether discovered interpreters match a request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-07 16:15</div>
            <div class="timeline-body"><p>It does mean that if you do <code>uvx python@3.14</code> and you have a free-threaded interpreter on your PATH before a GIL-enabled interpreter, we'll use the free-threaded one now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2025-10-07 16:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-10-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-10-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-10-07 16:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geofft">@geofft</a> on 2025-10-07 16:24</div>
            <div class="timeline-body"><blockquote>
<p>No, that's defined by the ordering of downloads. This only changes logic for whether discovered interpreters match a request.</p>
</blockquote>
<p>It looks like crates/uv-python/download-metadata.json currently orders them as plain, freethreaded, freethreaded+debug, and debug. ... but on prod uv, <code>uvx python3.14d</code> grabs debug, not freethreaded+debug, not sure why. If I already have the freethreaded+debug version installed, then it uses that. I think this behavior is fine, but I don't totally understand why....</p>
<pre><code>$ uvx python3.14d
cpython-3.14.0rc3+debug-linux-x86_64-gnu (download) ------------------------------ 28.05 MiB/49.79 MiB
^C
$ uvx python3.14td
cpython-3.14.0rc3+freethreaded+debug-linux-x86_64-gnu (download) ------------------------------ 8.01 MiB/55.64 MiB
^C
$ uvx python3.14td
[let it download without interrupting]
Python 3.14.0rc3 free-threading build (main, Sep 18 2025, 19:46:00) [Clang 20.1.4 ] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; 
$ uvx python3.14d
[no download]
Python 3.14.0rc3 free-threading build (main, Sep 18 2025, 19:46:00) [Clang 20.1.4 ] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; 
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-07 17:38</div>
            <div class="timeline-body"><p>For future reference, the ordering is defined at https://github.com/astral-sh/uv/blob/8f3583a6e63800b770fec3b7be9b754be9d65602/crates/uv-python/src/installation.rs#L580-L590</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ido123net">@ido123net</a> on 2025-10-10 11:32</div>
            <div class="timeline-body"><p>@zanieb is there a way now to explicitly use the GIL enable version if I already installed the free-threaded variant?</p>
<p>Because for 3.13, I need to explicitly add the <code>t</code>, but for 3.14, I have no option to add anything for the GIL version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-10 14:11</div>
            <div class="timeline-body"><p>We should prefer the GIL version, e.g., if you do <code>uv python install 3.14 3.14t</code> we'll always prefer the GIL version. Otherwise, we'll take the one that's first in <code>PATH</code>. Does that help? What's your setup?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ido123net">@ido123net</a> on 2025-10-10 14:51</div>
            <div class="timeline-body"><p>Thanks @zanieb
Thats helps.</p>
<p>But still, if for example I do:</p>
<pre><code class="language-shell">❯ uv sync -p3.14t
Using CPython 3.14.0
Removed virtual environment at: .venv
Creating virtual environment at: .venv
...

❯ uv sync -p3.14 
Resolved 26 packages in 6ms
Audited 22 packages in 1ms

❯ uv run python -VV      
Python 3.14.0 free-threading build (main, Oct  7 2025, 15:52:23) [Clang 20.1.4 ]
</code></pre>
<p>I have no way to return to the GIL version, without going through different version in between.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zsol">@zsol</a> on 2025-10-10 16:39</div>
            <div class="timeline-body"><blockquote>
<p>I have no way to return to the GIL version, without going through different version in between.</p>
</blockquote>
<p>One way would be to clear the venv:</p>
<pre><code>uv venv --clear
uv sync -p 3.14
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-10 16:40</div>
            <div class="timeline-body"><p>I'll add a way to explicitly request a GIL-enabled version, but I don't know what the syntax will be yet.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ido123net">@ido123net</a> on 2025-10-11 16:45</div>
            <div class="timeline-body"><p>Maybe environment variable is suitable here, like PREFER_GIL or something similar.</p>
<p>because I agree that it should be the default one, and there is no suffix that make sense..</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 06:38:54 UTC
    </footer>
</body>
</html>
