<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add a `pip-install` subcommand - astral-sh/uv #607</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add a <code>pip-install</code> subcommand</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/607">#607</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-12-11 19:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR adds a <code>pip-install</code> command that operates like, well, <code>pip install</code>. In short, it resolves the provided dependency, then makes sure they're all installed in the environment. The primary differences with <code>pip-sync</code> are that (1) <code>pip-sync</code> ignores dependencies, and assumes that the packages represent a complete set; and (2) <code>pip-sync</code> uninstalls any unlisted packages.</p>
<p>There are a bunch of TODOs that I'll resolve in subsequent PRs.</p>
<p>Closes https://github.com/astral-sh/puffin/issues/129.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2023-12-11 19:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2023-12-11 19:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-cli/src/commands/mod.rs</code>:76 on 2023-12-11 19:23</div>
            <div class="timeline-body"><p>(Moved out of <code>pip_sync.rs</code>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-12-11 19:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-12-11 19:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-cli/src/commands/pip_install.rs</code>:431 on 2023-12-11 19:24</div>
            <div class="timeline-body"><p>There's some code that's repeated between this file and <code>pip_sync.rs</code> and <code>pip_compile.rs</code>, but honestly, I would rather repeat it here than try to DRY it up. The code is honestly fairly straightforward and mechanical, and I'd hate to introduce a bunch of abstractions to DRY it up while capturing the differences.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-cli/src/commands/mod.rs</code>:67 on 2023-12-12 04:29</div>
            <div class="timeline-body"><p>nit: I know this isn't new here, but events feel like they shouldn't be imperative e.g. use <code>Removed</code>, <code>Added</code> instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-cli/src/main.rs</code>:278 on 2023-12-12 04:32</div>
            <div class="timeline-body"><p>Perhaps note what will happen if wheels are not available?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-cli/tests/pip_install.rs</code>:108 on 2023-12-12 04:35</div>
            <div class="timeline-body"><p>Unnecessary, right?</p>
<pre><code class="language-suggestion">    requirements_txt.write_str(&quot;Flask&quot;)?;
</code></pre>
<p>e.g. https://github.com/astral-sh/puffin/blob/2d1e19e474cbbbcd0008e150988807f893aacada/crates/puffin-cli/tests/pip_compile.rs#L163-L164</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-cli/tests/pip_install.rs</code>:146 on 2023-12-12 04:37</div>
            <div class="timeline-body"><p>Why use the requirements txt syntax to install single requirements? Doesn't this support specifying packages to install directly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-cli/tests/pip_install.rs</code>:1 on 2023-12-12 04:39</div>
            <div class="timeline-body"><p>It looks like we're missing a lot of test coverage here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2023-12-12 04:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2023-12-12 04:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-cli/tests/pip_install.rs</code>:1 on 2023-12-12 04:47</div>
            <div class="timeline-body"><p>I don't think it's worth duplicating all of the resolution and installation tests here, personally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2023-12-12 04:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-cli/tests/pip_install.rs</code>:1 on 2023-12-12 04:50</div>
            <div class="timeline-body"><p>I agree, but like... <code>pip-install foo</code> seems reasonable to include at least.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/puffin-cli/src/main.rs</code>:301 on 2023-12-12 10:10</div>
            <div class="timeline-body"><p>We could allow this module-wide</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/puffin-cli/src/commands/pip_install.rs</code>:98 on 2023-12-12 10:14</div>
            <div class="timeline-body"><p>This is ok for now, but we should eventually move to passing more information, e.g. files attached to the requirements</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/puffin-cli/src/commands/pip_install.rs</code>:431 on 2023-12-12 10:22</div>
            <div class="timeline-body"><p>I'd refactor reporter handling (move it to the constructor most likely) if we want to make this more concise.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2023-12-12 10:23</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2023-12-12 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-12-12 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-12-12 17:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:34:53 UTC
    </footer>
</body>
</html>
