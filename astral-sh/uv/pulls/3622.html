<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discard markers on editable requirements - astral-sh/uv #3622</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Discard markers on editable requirements</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/3622">#3622</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-05-15 19:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-15 19:48</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>If a user includes markers after an editable, we now ignore them (rather than including them in the parsed URL). This matches pip's behavior. In the future, we could further improve by respecting them, but that <em>would</em> be a deviation from pip.</p>
<p>For example, given:</p>
<pre><code>-e ./scripts/packages/black_editable ; python_version &gt;= &quot;3.9&quot; and python_ver
</code></pre>
<p>We now split at the first whitespace (just before the <code>;</code>), parse everything before, and throw out everything after.</p>
<p>This logic also extends to extras. So given:</p>
<pre><code>-e ./scripts/packages/black_editable[dev, colorama]
</code></pre>
<p>We'll now parse this as the URL <code>./scripts/packages/black_editable[dev,</code>, and throw out <code> colorama]</code>. Instead, you need to do:</p>
<pre><code>-e ./scripts/packages/black_editable[dev,colorama]
</code></pre>
<p>(I.e., remove the space.)</p>
<p>This <em>also</em> matches pip's behavior. I could &quot;fix&quot; this but I'm unsure if I should -- it means requirements files will be parseable by uv that won't work with pip. Open to input. My gut reaction is that we <em>should</em> properly support <code>-e ./scripts/packages/black_editable[dev, colorama]</code> even if pip would reject it, but <code>requirements.txt</code> is implementation-defined so it'd be a &quot;deviation&quot;.</p>
<p>Closes https://github.com/astral-sh/uv/issues/3604.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-05-15 19:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-05-15 19:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-05-15 19:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2024-05-15 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-05-15 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-05-16 07:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/requirements-txt/test-data/requirements-txt/editable.txt</code>:1 on 2024-05-16 07:47</div>
            <div class="timeline-body"><p>This file contained some regression tests for whitespace behavior in the parser</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-05-16 07:47</div>
            <div class="timeline-body"><p>To me, https://github.com/pypa/pip/issues/8581#issuecomment-658794436 makes it look like this is a bug in pip, could we check back with the pip devs on this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-05-16 11:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/requirements-txt/test-data/requirements-txt/editable.txt</code>:1 on 2024-05-16 11:12</div>
            <div class="timeline-body"><p>I’m pretty sure those exist in a separate file. This was just a duplicate of another test file, no?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-16 12:10</div>
            <div class="timeline-body"><p>I don’t think it’s a bug. I think it’s an intentional limitation right now because it’s not covered by any standard. For that reason I’m also somewhat hesitant to support it… It also means that files that work with uv won’t work with pip.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-05-16 13:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-16 20:09</div>
            <div class="timeline-body"><p>Ok, I decided to change the behavior to continue to allow spaces between extras in editables (i.e., we continue to support <code>-e /editable[d, dev]</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-05-16 20:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-05-16 20:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-05-16 20:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 14:32:37 UTC
    </footer>
</body>
</html>
