<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>add helper script to download the needed files to mirror for UV_PYTHON_INSTALL_MIRROR - astral-sh/uv #8548</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>add helper script to download the needed files to mirror for UV_PYTHON_INSTALL_MIRROR</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/8548">#8548</a>
        opened by <a href="https://github.com/MeitarR">@MeitarR</a>
        on 2024-10-24 22:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MeitarR">@MeitarR</a></div>
            <div class="timeline-body">Summary
<p>I added <code>crates/uv-python/create-mirror.py</code> to make it easy to download all the needed files to create a mirror for Python distributions in an offline environment.</p>
<p>the script also has an option to iterate over the git history of the <code>download-metadata.json</code> to make sure we have all the files needed for all the uv versions</p>
Test Plan
<pre><code>uv run create-mirror.py --from-all-history --os linux --arch x86_64 --name cpython
2024-10-25 01:31:12,973 - INFO - Starting download of 466 files.
Downloading: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 466/466 [06:11&lt;00:00,  1.26file/s]
Successfully downloaded: 466
now you can run UV_PYTHON_INSTALL_MIRROR=&#x27;file:///home/meitar/dev/uv/crates/uv-python/mirror&#x27; uv python install
</code></pre>
<p>then checked (the <code>unshare</code> command make sure that the process don&#x27;t have any netwok)</p>
<pre><code>UV_PYTHON_INSTALL_MIRROR=file:///home/meitar/dev/uv/crates/uv-python/mirror sudo -E unshare -n /home/meitar/.local/bin/uv python install 3.13
Searching for Python versions matching: Python 3.13
Installed Python 3.13.0 in 2.91s
 + cpython-3.13.0-linux-x86_64-gnu
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-25 04:04</div>
            <div class="timeline-body"><p>Cool! This may be better hosted outside this repository since it&#x27;s just a Python script. I&#x27;ll take a closer look though.</p>
<p>Related #8062</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-25 04:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeitarR">@MeitarR</a> on 2024-10-25 08:43</div>
            <div class="timeline-body"><blockquote>
<p>Cool! This may be better hosted outside this repository since it&#x27;s just a Python script. I&#x27;ll take a closer look though.</p>
<p>Related #8062</p>
</blockquote>
<p>Yes, I thought about it, but decided that it would be better to keep it close to the JSON for a couple of reasons:</p>
<ol>
<li>Simplicity – It removes the need to specify the path to the JSON file and the repo containing the full history.</li>
<li>Coupling with JSON format – If the format of the JSON changes, having the script nearby ensures we can quickly update it to stay compatible.</li>
<li>Discoverability – When someone looks into how to create a mirror, they’ll naturally find this script since it contains relevant strings like <code>UV_PYTHON_INSTALL_MIRROR</code> that they&#x27;ll likely search for.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeitarR">@MeitarR</a> on 2024-11-13 21:16</div>
            <div class="timeline-body"><p>So, What do you think @zanieb ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeitarR">@MeitarR</a> on 2024-11-26 18:35</div>
            <div class="timeline-body"><p>@charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-26 18:42</div>
            <div class="timeline-body"><p>After looking more closely, I feel the same way — I don&#x27;t want to maintain this and think it makes more sense as an external script. I think @charliermarsh is partial to merging it. I won&#x27;t stand in the way of that, but since we&#x27;re not testing this I wouldn&#x27;t be surprised if it becomes outdated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeitarR">@MeitarR</a> on 2024-11-26 19:25</div>
            <div class="timeline-body"><p>So we are waiting for @charliermarsh decision?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-04 01:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-12-04 01:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-04 01:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-04 01:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeitarR">@MeitarR</a> on 2024-12-04 05:56</div>
            <div class="timeline-body"><p>Thank you for merging ♥️</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jeffcarrico">@jeffcarrico</a> on 2025-01-03 04:45</div>
            <div class="timeline-body"><p>Thank you for contributing this script, I was about to set out to try to automate exactly this so it saved me a lot of time and worked perfectly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MeitarR">@MeitarR</a> on 2025-01-04 10:09</div>
            <div class="timeline-body"><p>@jeffcarrico
this issue might also interest you #10203</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:48:59 UTC
    </footer>
</body>
</html>
