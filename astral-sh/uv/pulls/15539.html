<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `uv auth` commands (`login`, `logout`, and `token`) - astral-sh/uv #15539</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add `uv auth` commands (`login`, `logout`, and `token`)</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/15539">#15539</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-08-26 17:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-26 17:20</div>
            <div class="timeline-body"><p>Picks up the work from</p>
<ul>
<li>#14559</li>
<li>https://github.com/astral-sh/uv/pull/14896</li>
</ul>
<p>There are some high-level changes from those pull requests</p>
<ol>
<li>We do not stash seen credentials in the keyring automatically, that can be future work</li>
<li>We use <code>auth login</code> and <code>auth logout</code> (for future consistency)</li>
<li>We add a <code>token</code> command for showing the credential that will be used</li>
</ol>
<p>As well as many smaller changes to API, messaging, testing, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add `uv auth` commands (`login`, `logout`, and `show`)" to "Add `uv auth` commands (`login`, `logout`, and `token`)" by @zanieb on 2025-08-27 17:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-08-28 01:17</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/commands/auth/login.rs</code>:54 on 2025-08-28 01:17</div>
            <div class="timeline-body"><p>Do we need to enable users to specify a keyring provider type on a per-URL basis? Like, would it ever be the case that a user wants to use (e.g.) the AWS keyring plugin via subprocess, but then store credentials for some URLs via the native plugin? (This is, in a vague way, coming from me being confused that <code>--keyring-provider</code> is respected here at all, since it <em>only</em> ever works for <code>native</code>.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-08-28 01:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/commands/auth/login.rs</code>:59 on 2025-08-28 01:18</div>
            <div class="timeline-body"><p>I am also wondering if we should <em>not</em> accept credentials over plaintext on the CLI, hmm.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-08-28 01:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/commands/auth/login.rs</code>:74 on 2025-08-28 01:19</div>
            <div class="timeline-body"><p>Again a vague thing where I'm wondering if we should be using <code>Credentials::Bearer</code> for tokens, rather than basic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-08-28 01:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/commands/auth/logout.rs</code>:21 on 2025-08-28 01:22</div>
            <div class="timeline-body"><p>If you wanted to get fancy, you could make this <code>Cow</code>... Like <code>username.map(Cow::Owned).unwrap_or(Cow::Borrowed(&quot;__token__&quot;))</code>.</p>
<p>(You def don't need to do this, just thought you mind find it interesting.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-08-28 01:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/commands/auth/token.rs</code>:20 on 2025-08-28 01:24</div>
            <div class="timeline-body"><p>Should we move this into the <code>else</code> on line 41?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-08-28 13:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/auth/login.rs</code>:54 on 2025-08-28 13:12</div>
            <div class="timeline-body"><blockquote>
<p>(This is, in a vague way, coming from me being confused that --keyring-provider is respected here at all, since it only ever works for native.)</p>
</blockquote>
<p>I think we actually can support the subprocess keyring here ‚Äî I just didn't want to add support for that yet.</p>
<blockquote>
<p>Do we need to enable users to specify a keyring provider type on a per-URL basis? Like, would it ever be the case that a user wants to use (e.g.) the AWS keyring plugin via subprocess, but then store credentials for some URLs via the native plugin?</p>
</blockquote>
<p>This is probably a realistic use-case, yeah. I think we'd need to add a concept like <code>keyring-provider-service</code> which maps a service URL to a keyring provider.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-08-28 13:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/auth/login.rs</code>:59 on 2025-08-28 13:13</div>
            <div class="timeline-body"><p>As in, not accept it via a CLI flag and require stdin?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-08-28 13:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/auth/login.rs</code>:74 on 2025-08-28 13:14</div>
            <div class="timeline-body"><p>Ah that's complicated. Our current semantics for tokens is that it's a shortcut for <code>__token__:&lt;token&gt;</code> because that's a common pattern for allowing tokens over HTTP basic authentication. This matches, e.g., the <code>publish</code> API we have. I think we want to allow Bearer authentication too, but I think it'd be another dimension of options?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-08-28 13:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/auth/logout.rs</code>:21 on 2025-08-28 13:15</div>
            <div class="timeline-body"><p>üëç I thought about using Cow but figured it wasn't worth the time right now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-08-28 13:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/auth/token.rs</code>:20 on 2025-08-28 13:20</div>
            <div class="timeline-body"><p>Fine with me ‚Äî I must have refactored something so it was only needed once.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-08-28 13:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/auth/login.rs</code>:59 on 2025-08-28 13:25</div>
            <div class="timeline-body"><p>I don't think it's quite right to outright ban this, e.g., Git allows credentials interactively and we already allow passwords in plaintext in URLs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zanieb on 2025-08-28 13:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-08-28 13:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-08-28 13:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-08-28 13:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 06:47:26 UTC
    </footer>
</body>
</html>
