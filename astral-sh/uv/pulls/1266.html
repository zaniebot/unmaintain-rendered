<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validate instead of discovering python patch version - astral-sh/uv #1266</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Validate instead of discovering python patch version</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1266">#1266</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-02-08 20:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>Contrary to our prior assumption, we can&#x27;t reliably select a specific patch version. With the deadsnakes PPA for example, <code>python3.12</code> is installed into <code>PATH</code>, but <code>python3.12.1</code> isn&#x27;t. Based on the assumption (or rather, observation) that users have a single python patch version per python minor version installed, generally the latest, we only check if the installed patch version matches the selected patch version, if any, instead of search for one.</p>
<p>In the process, i deduplicated the python discovery logic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/konstin">@konstin</a> on 2024-02-08 20:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-08 20:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-interpreter/src/interpreter.rs</code>:182 on 2024-02-08 20:41</div>
            <div class="timeline-body"><p>What&#x27;s an explicit interpreter here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-08 20:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-interpreter/src/interpreter.rs</code>:171 on 2024-02-08 20:41</div>
            <div class="timeline-body"><p>What does the &quot;platform specific search&quot; mean here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-08 20:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-interpreter/src/lib.rs</code>:67 on 2024-02-08 20:42</div>
            <div class="timeline-body"><p>Perhaps <code>PatchVersionMismatch</code> or <code>PatchVersionNotFound</code>? The message should probably say &quot;does not have the requested patch version&quot; instead of &quot;has the wrong patch version&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-08 20:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-interpreter/src/python_query.rs</code>:34 on 2024-02-08 20:45</div>
            <div class="timeline-body"><p>Is it <em>often</em> not on the path or is it just not on the path in some of the cases you tried? Is there actually a significant cost to <em>checking</em> for the full version in the path? I have a strong preference for seeing if it&#x27;s available instead of just assuming it can never exist. I would be confused if a tool skipped the more exact executable and then complained that the more general one (i.e. minor version) has an incompatible patch version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-08 20:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-interpreter/src/lib.rs</code>:64 on 2024-02-08 20:46</div>
            <div class="timeline-body"><p>We should update this to match the <code>NoSuchPython</code> error message.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-02-08 20:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/puffin-interpreter/src/python_query.rs</code>:34 on 2024-02-08 20:59</div>
            <div class="timeline-body"><p>My thinking was to choose simplicity and consistency over better discovery; Independent of platform and of the way you installed python, we always only check the minor version. For the rare cases where users who actually want exact control over which python interpreter gets picked, they can pass an absolute path. I don&#x27;t feel it&#x27;s worth building and maintaining that level of complexity when users shouldn&#x27;t need to specify patch versions anyway; I&#x27;d be in favor of removing explicit patch version support in general if it wasn&#x27;t for the pip compile overwrites.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-08 21:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-interpreter/src/python_query.rs</code>:34 on 2024-02-08 21:02</div>
            <div class="timeline-body"><p>It feels <em>more</em> complex to me to skip that executable file if it&#x27;s in your path but ü§∑‚Äç‚ôÄÔ∏è we can always revisit this if it&#x27;s problematic</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-02-08 21:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/konstin">@konstin</a> on 2024-02-08 21:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2024-02-08 21:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-02-08 21:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:43:33 UTC
    </footer>
</body>
</html>
