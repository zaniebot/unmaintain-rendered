<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark path-based cache entries as stale during install plan - astral-sh/uv #957</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Mark path-based cache entries as stale during install plan</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/957">#957</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-18 04:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-18 04:08</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This is a small correctness improvement that ensures that we avoid using stale cache entries for local dependencies in the install plan. We already have some logic like this in the source distribution builder, but it didn't apply in the install plan, and so we'd end up using stale wheels.</p>
<p>Specifically, now, if you create a new local wheel, and run <code>pip sync</code>, we'll mark the cache entries as stale and make sure we unzip it and install it. (If the wheel is <em>already</em> installed, we won't reinstall it though, which will be a separate change. This is just about reading from the cache, not the environment.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-01-18 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-01-18 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-01-18 04:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-01-18 04:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-distribution/src/index/built_wheel_index.rs</code>:44 on 2024-01-18 04:10</div>
            <div class="timeline-body"><p>We get to remove a TODO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/puffin-cli/tests/pip_sync.rs</code>:1152 on 2024-01-18 11:59</div>
            <div class="timeline-body"><p>We can set the mtime to <code>SystemTime::now()</code> instead https://doc.rust-lang.org/std/fs/struct.File.html#method.set_times</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-01-18 12:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-01-18 19:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-18 19:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-01-18 19:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 15:39:25 UTC
    </footer>
</body>
</html>
