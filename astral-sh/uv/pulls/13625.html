<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows paths are valid URLs - astral-sh/uv #13625</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Windows paths are valid URLs</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/13625">#13625</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2025-05-23 19:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>Currently, it is not possible to set a custom Python downloads JSON on Windows, as Windows paths can be valid URLs.</p>
<pre><code>use url::Url;

fn main() {
    dbg!(Url::parse(r&quot;C:\Users\Ferris\download.json&quot;));
}
</code></pre>
<p>Tested by <a href="https://github.com/astral-sh/uv/pull/13585">astral-sh/uv#13585</a> (where it is currently failing CI).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/Gankra">@Gankra</a> by <a href="https://github.com/konstin">@konstin</a> on 2025-05-23 19:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-05-23 19:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-05-23 19:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2025-05-23 19:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-23 19:05</div>
            <div class="timeline-body"><p>I might suggest using <code>split_scheme</code> and <code>Scheme::parse</code> here instead of <code>Url::parse</code>? That&#x27;s what we tend to do elsewhere.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-23 19:07</div>
            <div class="timeline-body"><p>To support <code>file:</code> URLs or to check something more specific than <code>Url::parse</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-23 19:07</div>
            <div class="timeline-body"><p>To check something more specific, e.g., that it&#x27;s a known remote host like http or https.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-24 15:06</div>
            <div class="timeline-body"><p>As-is, won&#x27;t this erroneously tell you that remote URLs aren&#x27;t supported if you use a Windows path and it fails to open?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-26 10:49</div>
            <div class="timeline-body"><p>Oh now I understand, good catch.</p>
<p>I&#x27;ve changed the logic to assume that one-letter protocols are Windows drives, and to also support <code>file://</code> URLs while I&#x27;m at it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-26 11:19</div>
            <div class="timeline-body"><p>Why not just use the scheme detection code we use everywhere else?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-05-27 03:25</div>
            <div class="timeline-body"><p>I agree with charlie, we should be allow-listing http: and https: instead of trying to detect file paths in particular.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-27 14:33</div>
            <div class="timeline-body"><p>wdym with allow-listing http(s)? I&#x27;m specifically only fixing the Windows case that turned out to be broken in #13585, without adding support for remote URLs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-27 14:58</div>
            <div class="timeline-body"><p>I think the suggestion is that this error should only show up if the scheme is <code>http</code> or <code>https</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-27 14:58</div>
            <div class="timeline-body"><p>Make sense!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-05-28 14:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:96 on 2025-05-28 14:11</div>
            <div class="timeline-body"><p>Not your change, but &quot;python&quot; should be capitalized.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-05-28 14:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-28 15:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-28 15:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-05-28 15:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:52:18 UTC
    </footer>
</body>
</html>
