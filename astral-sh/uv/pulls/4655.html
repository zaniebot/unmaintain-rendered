<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>implements `--package` for `pip tree` - astral-sh/uv #4655</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>implements <code>--package</code> for <code>pip tree</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/4655">#4655</a>
        opened by <a href="https://github.com/ChannyClaus">@ChannyClaus</a>
        on 2024-06-29 23:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/ChannyClaus">@ChannyClaus</a> on 2024-06-29 23:33</div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>partially resolves https://github.com/astral-sh/uv/issues/4439</p>
<!-- What's the purpose of the change? What does it do, and why? -->

<h2>Test Plan</h2>
<p>the existing tests pass + added a couple of tests to ensure <code>--package</code> behaves as expected.</p>
<!-- How was it tested? -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-07-01 16:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:283 on 2024-07-01 16:48</div>
            <div class="timeline-body"><p>Why are we adding newlines? We don't do this in the regular output.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ChannyClaus">@ChannyClaus</a> reviewed on 2024-07-01 18:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ChannyClaus">@ChannyClaus</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:283 on 2024-07-01 18:10</div>
            <div class="timeline-body"><p><code>cargo tree</code> seems to do this with <code>-p</code>, presumably so that it's clear each output block corresponds to a different <code>--package</code> value.</p>
<pre><code>$ cargo tree -p futures-util -p tracing
futures-util v0.3.30
├── futures-core v0.3.30
├── futures-task v0.3.30
├── pin-project-lite v0.2.14
└── pin-utils v0.1.0

tracing v0.1.40
├── log v0.4.21
├── pin-project-lite v0.2.14
└── tracing-core v0.1.32
    └── once_cell v1.19.0
</code></pre>
<p>happy to revert this, i just thought it was helpful to look at with an empty line in-between.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-07-01 18:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:283 on 2024-07-01 18:43</div>
            <div class="timeline-body"><p>This seems sensible to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-07-01 19:23</div>
            <div class="timeline-body"><p>Looks like your merge got messed up somewhere and you ended up overwriting some changes. Because this is a small PR I would suggest reapplying your changes to <code>pip/tree.rs</code> manually with the latest changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-07-01 20:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:119 on 2024-07-01 20:33</div>
            <div class="timeline-body"><p>You can use <code>SitePackages::get_packages</code> instead of recreating that map here. See https://github.com/astral-sh/uv/pull/4702/files#diff-1dce93dfbaf1f210c15966453b85cf8268055cf502820abf10915fea1a7c2f45.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:292 on 2024-07-01 20:35</div>
            <div class="timeline-body"><pre><code class="language-suggestion">                for installed_dist in self.site_packages.get_packages(&amp;package) {
                    path.clear();
                    lines.extend(self.visit(installed_dist, &amp;mut visited, &amp;mut path)?);
                }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-07-01 20:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:119 on 2024-07-01 20:53</div>
            <div class="timeline-body"><pre><code class="language-suggestion"></code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:290 on 2024-07-01 20:53</div>
            <div class="timeline-body"><pre><code class="language-suggestion">                for installed_dist in self.site_packages.get_packages(package) {
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-07-01 20:53</div>
            <div class="timeline-body"><p>CI should pass after this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ChannyClaus">@ChannyClaus</a> reviewed on 2024-07-01 20:53</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ChannyClaus">@ChannyClaus</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:119 on 2024-07-01 20:53</div>
            <div class="timeline-body"><p>hmm, is there a reason that <code>get_packages</code> returns a vector? specifically, are there times when we expect a package name to map to multiple packages? (i thought there can never be two versions of the same package, or at least that's not supposed to happen)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/src/commands/pip/tree.rs</code>:119 on 2024-07-01 21:02</div>
            <div class="timeline-body"><p>It is technically possible, though not expected in any real word usage. See: https://github.com/jaraco/pip-run?tab=readme-ov-file#experiments-and-testing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-07-01 21:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-07-01 21:05</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @ibraheemdev on 2024-07-01 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ibraheemdev on 2024-07-01 21:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 13:48:47 UTC
    </footer>
</body>
</html>
