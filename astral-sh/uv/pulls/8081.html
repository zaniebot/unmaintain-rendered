<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update pip compatibility guide to note transitive URL dependency support - astral-sh/uv #8081</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update pip compatibility guide to note transitive URL dependency support</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/8081">#8081</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-10-10 10:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 10:13</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Closes https://github.com/astral-sh/uv/issues/8080.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @charliermarsh on 2024-10-10 10:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-10-10 10:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-10-10 10:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-10-10 10:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/slochower">@slochower</a> reviewed on 2024-10-11 03:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/slochower">@slochower</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 03:03</div>
            <div class="timeline-body"><p>When reading the original text and this version, it sounds (to me) like you are suggesting a workaround of adding the URL dependency to <em>your</em> <code>pyproject.toml</code> or <code>requirements.in</code> (in the case that you depend on registry package A which depends on package B with a URL dependency). Rather, I think the advice is to add the URL dependency directly to package A in that scenario. Would phrasing like this be more clear?</p>
<blockquote>
<p>If uv rejects a transitive URL dependency in a package from a registry, the best course of action is to provide the URL dependency as a direct dependency in the <code>pyproject.toml</code> or <code>requirement.in</code> file of the registry package, as the above constraints do not apply to direct dependencies.</p>
</blockquote>
<p>Maybe it is a little clunky, but I definitely spent a few hours thinking I could just add the transitive URL dependency as a direct dependency in <em>my</em> package and that would satisfy <code>uv</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-10-11 09:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 09:43</div>
            <div class="timeline-body"><p>If you depend on a package A from the registry, which lists package B as a direct URL dependency (e.g., <code>B @ https://...</code>), adding package B to your <code>pyproject.toml</code> <em>will</em> work. That's the recommended solution. Something like:</p>
<pre><code class="language-toml">[project]
dependencies = [&quot;A&quot;, &quot;B @ https://...&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/slochower">@slochower</a> reviewed on 2024-10-11 14:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/slochower">@slochower</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 14:21</div>
            <div class="timeline-body"><p>Ah, sorry -- I'm talking about one more layer of redirection. Say I'm writing a script with inline metadata. The script depends on registry package A. Registry package A depends on registry package B. In package B's <code>pyproject.toml</code> is a URL dependency. Adding that URL dependency directly to the inline metadata of a script will not satisfy <code>uv run</code>. I'm not sure there is a solution. Is there?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-10-11 14:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 14:45</div>
            <div class="timeline-body"><p>I would actually still expect that to work. Are you running into a failure there? The way to think about it is: it's actually fine if registry packages depend on URL dependencies, but uv has to <em>know</em> about all possible URL dependencies upfront.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/slochower">@slochower</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 15:50</div>
            <div class="timeline-body"><p>If I run without adding the URL dependency, I get:</p>
<pre><code>error: Package `openeye-toolkits-python3-osx-universal` attempted to resolve via URL: https://pypi.anaconda.org/openeye/simple/openeye-toolkits-python3-osx-universal/2023.1.1/OpenEye-toolkits-python3-osx-universal-2023.1.1.tar.gz. URL dependencies must be expressed as direct requirements or constraints....
</code></pre>
<p>If I add <code>openeye-toolkits-python3-osx-universal @ https://...</code> to my script metadata, I then see:</p>
<pre><code>error: No `project` table found in: `/Volumes/xxx/pyproject.toml
</code></pre>
<p>If I use <code>uv run --no-project</code> I still see the same thing, confusingly.</p>
<pre><code>❯ uv run tmp.py --no-project

error: No `project` table found in: `/Volumes/xxx/pyproject.toml`
(.venv) 
</code></pre>
<p>The script metadata looks like this:</p>
<pre><code># /// script
# requires-python = &quot;&gt;=3.10&quot;
# dependencies = [
#   &quot;package-hosted-on-internal-registry==3.3.0&quot;,
#   &quot;openeye-toolkits-python3-osx-universal @ https://pypi.anaconda.org/openeye/simple/openeye-toolkits-python3-osx-universal/2023.1.1/OpenEye-toolkits-python3-osx-universal-2023.1.1.tar.gz&quot;
# ]
# ///
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/slochower">@slochower</a> reviewed on 2024-10-11 15:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-10-11 17:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 17:54</div>
            <div class="timeline-body"><p>I think you need to put the no-project flag before the filename, not after. Otherwise, it’s treated as an argument to the Python call.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/slochower">@slochower</a> reviewed on 2024-10-11 18:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/slochower">@slochower</a> on <code>docs/pip/compatibility.md</code>:195 on 2024-10-11 18:27</div>
            <div class="timeline-body"><p>Ah! Great, thanks.</p>
<p>This comment of yours really helped:</p>
<blockquote>
<p>The way to think about it is: it's actually fine if registry packages depend on URL dependencies, but uv has to know about all possible URL dependencies upfront.</p>
</blockquote>
<p>And maybe some form could be put into the documentation.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 13:01:56 UTC
    </footer>
</body>
</html>
