<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ci: add musl ppc64le - astral-sh/uv #3537</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ci: add musl ppc64le</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/3537">#3537</a>
        opened by <a href="https://github.com/henryiii">@henryiii</a>
        on 2024-05-13 04:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/henryiii">@henryiii</a></div>
            <div class="timeline-body">

Summary
<p>Working on followup to #3523. I expect some changes will be required to match the glibc versions above.</p>


Test Plan


</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-05-13 05:02</div>
            <div class="timeline-body"><p>I&#x27;m not sure how to cross-compile for these targets. Binaries are not provided, AFAICT, so I think the target needs to be built. I vaguely have clues on how to do that, but not sure how to inject my ideas into maturin-action.</p>
<p>I don&#x27;t think it&#x27;s going to work, locally I tried:</p>
<pre><code>docker run -v $PWD:/uv -w /uv --rm -it ubuntu
apt update &amp;&amp; apt install curl build-essential cmake
curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh
. &quot;$HOME/.cargo/env&quot;
rustup install nightly
rustup +nightly component add rust-src
cargo +nightly build -Z build-std --target powerpc64le-unknown-linux-musl
</code></pre>
<p>It makes it pretty far, but crashes compiling OpenSSL.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-14 00:17</div>
            <div class="timeline-body"><p>@konstin or @messense may have ideas.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-05-14 01:51</div>
            <div class="timeline-body"><p>It looks like there&#x27;s mention of the powerpc64le one in maturin-action, so I was rather thinking that might work. s309x is sounds like it&#x27;s not possible currently. I&#x27;m checking to see if missing uv on these two (I would assume) rarely used images is acceptable in manylinux.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/messense">@messense</a> on 2024-05-14 01:59</div>
            <div class="timeline-body"><p>ppc64le musl requires Rust nightly, I have tried to <a href="https://github.com/rust-cross/rust-musl-cross/pull/62">build a Docker image for s390x musl</a> in the past, but it seems to have some issues (see <a href="https://github.com/rust-cross/rust-musl-cross/issues/63">rust-cross/rust-musl-cross#63</a>) so I haven&#x27;t added it to <code>maturin-action</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;ci: add builds for other musl targets&quot; to &quot;ci: add musl ppc64le&quot; by <a href="https://github.com/henryiii">@henryiii</a> on 2024-05-14 05:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-05-14 05:16</div>
            <div class="timeline-body"><p>Great! Only musl s390x for manylinux (and Windows ARM for cibuildwheel) left!</p>
<p>Is <a href="https://github.com/rust-cross/rust-musl-cross/issues/63">rust-cross/rust-musl-cross#63</a> still an issue? Looks like it&#x27;s been a while since it was attempted?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/henryiii">@henryiii</a> on 2024-05-14 12:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/messense">@messense</a> on 2024-05-15 02:29</div>
            <div class="timeline-body"><blockquote>
<p>Is <a href="https://github.com/rust-cross/rust-musl-cross/issues/63">rust-cross/rust-musl-cross#63</a> still an issue? Looks like it&#x27;s been a while since it was attempted?</p>
</blockquote>
<p>Probably still an issue, but I think it&#x27;s solvable given that Alpine Linux has the target working for years now, although it&#x27;s a hard problem for people without deep knowledge in GCC.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2024-05-15 03:39</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-15 03:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-15 03:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-15 03:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:45:18 UTC
    </footer>
</body>
</html>
