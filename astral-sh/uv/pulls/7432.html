<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cache ecosystem tests - astral-sh/uv #7432</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cache ecosystem tests</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/7432">#7432</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-09-16 16:19
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>Use a cache in <code>target</code> for ecosystem checks. I had frequent timeouts with the transformers test, which this fixes. Locally, the transformers test alone goes from 15s to 2s on my machine.</p>
<p>By using <code>uv cache prune --ci</code>, the runtime would go up from 2s to 5.5s, with the cache shrinking from 425MB to 415MB. This is due to uv not being optimized for the case where we have a warm cache but no lockfile, so in this test we&#x27;re doing what we otherwise don&#x27;t recommend and don&#x27;t prune the cache.</p>
<p>Fixes #6330</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by <a href="https://github.com/konstin">@konstin</a> on 2024-09-16 16:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> approved on 2024-09-16 16:25</div>
            <div class="timeline-body"><p>SGTM</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/konstin">@konstin</a> on 2024-09-17 11:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-09-17 11:52</div>
            <div class="timeline-body"><p>I trimmed it down to not touch the <code>--cache-dir</code> or we would have to change all the <code>requirements.txt</code> snapshots containing <code>--cache-dir</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/konstin">@konstin</a> on 2024-09-18 09:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2024-09-18 09:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-09-18 09:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:48:16 UTC
    </footer>
</body>
</html>
