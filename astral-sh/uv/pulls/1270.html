<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add an `--offline` mode - astral-sh/uv #1270</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add an <code>--offline</code> mode</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/1270">#1270</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-02-10 21:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-10 21:05</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR adds an <code>--offline</code> flag to Puffin that disables network requests (implemented as a Reqwest middleware on our registry client). When <code>--offline</code> is provided, we also allow the HTTP cache to return stale data.</p>
<p>Closes #942.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>Cargo.toml</code>:89 on 2024-02-10 21:06</div>
            <div class="timeline-body"><p>We already have this and <code>async-trait</code> in our dependency tree, but they seem to be needed to write Middleware implementations directly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-10 21:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-10 21:13</div>
            <div class="timeline-body"><p>Not ready for review since I want to improve the error messages building on Zanie's work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-02-10 21:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2024-02-11 02:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-02-11 02:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-02-11 02:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/tests/pip_compile.rs</code>:3150 on 2024-02-11 02:03</div>
            <div class="timeline-body"><p>@zanieb - This is implemented following your pattern for <code>NoIndex</code>, made it very easy.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/tests/pip_compile.rs</code>:3239 on 2024-02-11 02:03</div>
            <div class="timeline-body"><p>@zanieb - Do you think this is worth fixing? It likely requires refactoring <code>--find-links</code> and threading through the offline result.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-11 02:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-11 02:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/src/main.rs</code>:337 on 2024-02-11 02:05</div>
            <div class="timeline-body"><p>This isn't <em>necessarily</em> a conflict, e.g., you might want to use <code>--refresh</code> with a local package... But I think it's sufficiently confusing to allow both, since what should happen if you try to access a package from the registry?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-11 02:21</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin/tests/pip_compile.rs</code>:3239 on 2024-02-11 02:21</div>
            <div class="timeline-body"><p>I put up a separate PR for it here: https://github.com/astral-sh/puffin/pull/1271</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin/tests/pip_compile.rs</code>:3150 on 2024-02-12 19:12</div>
            <div class="timeline-body"><p>Yay :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-12 19:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-02-12 19:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/puffin-resolver/src/pubgrub/report.rs</code>:509 on 2024-02-12 19:14</div>
            <div class="timeline-body"><p>I wonder if we should do a hint per package for this one? It seemed annoying in the <code>--no-index</code> case but might be nicer here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-02-12 19:14</div>
            <div class="timeline-body"><p>Smooth :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-02-13 03:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/puffin-resolver/src/pubgrub/report.rs</code>:509 on 2024-02-13 03:24</div>
            <div class="timeline-body"><p>I could see it either way... I'll leave it as-is for now, it seems annoying if you try to resolve offline with an empty cache and <em>every</em> package is offline.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-02-13 03:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-13 03:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-02-13 03:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 15:33:43 UTC
    </footer>
</body>
</html>
