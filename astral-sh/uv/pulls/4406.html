<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opt-out `tool.uv.sources` support for `uv add` - astral-sh/uv #4406</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Opt-out <code>tool.uv.sources</code> support for <code>uv add</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/4406">#4406</a>
        opened by <a href="https://github.com/ibraheemdev">@ibraheemdev</a>
        on 2024-06-18 22:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a></div>
            <div class="timeline-body">Summary
<p>After this change, <code>uv add</code> will try to use <code>tool.uv.sources</code> for all source requirements. If a source cannot be resolved, i.e. an ambiguous Git reference is provided, it will error. Git references can be specified with the <code>--tag</code>, <code>--branch</code>, or <code>--rev</code> arguments. Editables are also supported with <code>--editable</code>.</p>
<p>Users can opt-out of <code>tool.uv.sources</code> support with the <code>--raw</code> flag, which will force uv to use <code>project.dependencies</code>.</p>
<p>Part of <a href="https://github.com/astral-sh/uv/issues/3959">astral-sh/uv#3959</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-18 22:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-18 22:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-18 22:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/tests/edit.rs</code>:966 on 2024-06-18 22:58</div>
            <div class="timeline-body"><p>I&#x27;m not sure how to make <code>--editable</code> a Clap flag with it being represented as an <code>Option&lt;bool&gt;</code>. It&#x27;s optional because we don&#x27;t want to write <code>editable = true/false</code> if it&#x27;s not provided as that&#x27;s implied.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-06-18 22:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-06-19 00:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/tests/edit.rs</code>:966 on 2024-06-19 00:04</div>
            <div class="timeline-body"><p>I think you&#x27;re looking for <a href="https://docs.rs/clap/latest/clap/struct.Arg.html#method.default_missing_value"><code>default_missing_value</code></a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-distribution/src/pyproject.rs</code>:240 on 2024-06-19 14:19</div>
            <div class="timeline-body"><p>We normally just do <code>to_string_lossy</code> and skip the error handling</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/tests/edit.rs</code>:520 on 2024-06-19 14:21</div>
            <div class="timeline-body"><p>Odd that the lockfile is different, shouldn&#x27;t we disambiguate before locking (or merge all to rev)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-06-19 14:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> reviewed on 2024-06-19 18:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on <code>crates/uv/tests/edit.rs</code>:520 on 2024-06-19 18:19</div>
            <div class="timeline-body"><p>Opened <a href="https://github.com/astral-sh/uv/issues/4417">astral-sh/uv#4417</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-19 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-19 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-06-19 18:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:46:00 UTC
    </footer>
</body>
</html>
