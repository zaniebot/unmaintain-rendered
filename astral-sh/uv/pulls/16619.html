<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warn on managed prerelease interpreters when a stable build is available - astral-sh/uv #16619</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Warn on managed prerelease interpreters when a stable build is available</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/16619">#16619</a>
        opened by <a href="https://github.com/terror">@terror</a>
        on 2025-11-06 18:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a></div>
            <div class="timeline-body"><p>Resolves <a href="https://github.com/astral-sh/uv/issues/16616">astral-sh/uv#16616</a></p>
<p>This PR detects managed prerelease interpreters during discovery and warns when a matching stable build is available, wiring the new helper into <code>PythonInstallation::find</code>, <code>find_best</code>, and <code>find_or_download</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/terror">@terror</a> on 2025-11-06 19:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-06 19:50</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/project/run.rs</code>:945 on 2025-11-06 19:50</div>
            <div class="timeline-body"><p>I think we&#x27;d want to put this somewhere in Python discovery instead? Like, when we choose to use an interpreter?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-06 20:04</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv/src/commands/project/run.rs</code>:945 on 2025-11-06 20:04</div>
            <div class="timeline-body"><p>Ah interesting, I initially thought this would be scoped to <code>uv run</code> only, but if we want it for other commands this makes sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/src/commands/project/run.rs</code>:2084 on 2025-11-06 20:05</div>
            <div class="timeline-body"><p>I don&#x27;t think that function is complex enough that it needs a unit test, if possible I&#x27;d test a bigger function. If we don&#x27;t find a good scope what to unit test, an integration test is sufficient.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/src/commands/project/run.rs</code>:1862 on 2025-11-06 20:10</div>
            <div class="timeline-body"><p>Can the are-we-on-an-outdated-prerelease logic go into <code>uv-python</code>? This should also make unit testing easier, cause the unit test can access <code>pub(crate)</code> in that crate. The <code>uv</code> is already heavy, so I&#x27;d move specific tasks into dedicated crates.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-11-06 20:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-06 20:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/project/run.rs</code>:1897 on 2025-11-06 20:13</div>
            <div class="timeline-body"><p>I think I&#x27;d expect this to be like... <code>PythonDownloadRequest::try_from(interpreter.key())</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/project/run.rs</code>:1930 on 2025-11-06 20:14</div>
            <div class="timeline-body"><p>A dedicated function for this seems kind of overkill. What was your motivation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-06 20:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-06 20:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/project/run.rs</code>:1904 on 2025-11-06 20:15</div>
            <div class="timeline-body"><p>I think we need to avoid this warning if they&#x27;ve explicitly requested a pre-release version already?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv/src/commands/project/run.rs</code>:1930 on 2025-11-06 20:15</div>
            <div class="timeline-body"><p>Introducing a few unit tests, now realizing that was was a bit overkill (<a href="https://github.com/astral-sh/uv/pull/16619">astral-sh/uv#16619</a>#discussion_r2500649392) ðŸ˜…</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-06 20:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv/src/commands/project/run.rs</code>:1904 on 2025-11-06 20:57</div>
            <div class="timeline-body"><p>Changed this up in the new approach and added a test for it, we&#x27;ll now early return if the request allows pre-releases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-06 20:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-06 20:58</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv/src/commands/project/run.rs</code>:1897 on 2025-11-06 20:58</div>
            <div class="timeline-body"><p>Yeah this simplifies the call site a ton, I&#x27;ve added the plumbing for this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Add managed-prerelease upgrade hint to `uv run`&quot; to &quot;Warn on managed prerelease interpreters when a stable build is available&quot; by <a href="https://github.com/terror">@terror</a> on 2025-11-06 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-11-10 11:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 20:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:381 on 2025-11-10 20:35</div>
            <div class="timeline-body"><p>Why only CPython?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 20:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:384 on 2025-11-10 20:36</div>
            <div class="timeline-body"><p>I&#x27;m a little confused that we&#x27;re not just doing <code>request.iter_downloads()</code> and looking for a stable download?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 20:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:349 on 2025-11-10 20:37</div>
            <div class="timeline-body"><p>We should add documentation here</p>
<p>I&#x27;d probably rename to <code>warn_if_outdated_prerelease</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-10 21:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/installation.rs</code>:381 on 2025-11-10 21:27</div>
            <div class="timeline-body"><p>I looked at the upgrade flow and noticed that we <a href="https://github.com/astral-sh/uv/blob/9a21897f3d5a36413c1d1305a5cd5a3da05b1391/crates/uv-python/src/managed.rs#L754">gatekeep transparent upgrades</a> for CPython only, so this ensures we don&#x27;t warn users where the upgrade would effectively be a no-op. I could be missing something though since this part is new to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-10 21:28</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/installation.rs</code>:384 on 2025-11-10 21:28</div>
            <div class="timeline-body"><p>Yeah I can inline this, <code>has_stable_download_at_least</code> is doing exactly that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 21:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:381 on 2025-11-10 21:36</div>
            <div class="timeline-body"><p>I see. Let&#x27;s just open an issue to figure that out later. Please add a comment here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 21:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:384 on 2025-11-10 21:37</div>
            <div class="timeline-body"><p>Part of my question is why we&#x27;re not just using <code>request</code> instead of constructing a new <code>download_request</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/installation.rs</code>:384 on 2025-11-10 22:01</div>
            <div class="timeline-body"><p>Ah, my thinking here is that we want to construct a download request for the specific interpreter we&#x27;ve actually resolved, not necessarily what the user requested (which could be broader, and unable to be converted into a download request).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-10 22:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 22:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:384 on 2025-11-10 22:13</div>
            <div class="timeline-body"><p>mm I see, that makes sense. Thanks for explaining!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 22:14</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:404 on 2025-11-10 22:14</div>
            <div class="timeline-body"><p>Note this suggestion will not work in some edge cases, e.g., if the user request has an alternative architecture in it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:384 on 2025-11-10 22:15</div>
            <div class="timeline-body"><p>I think I&#x27;d prefer if it was inlined for now anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 22:15</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/installation.rs</code>:404 on 2025-11-10 22:30</div>
            <div class="timeline-body"><p>Hmm interesting, we can detect when the interpreter&#x27;s key matches the host platform defaults (in this case its safe to suggest) and then fall back to suggesting <code>uv python upgrade</code>? I don&#x27;t particularly like this, but this is what I&#x27;m thinking.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-10 22:30</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 22:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:404 on 2025-11-10 22:51</div>
            <div class="timeline-body"><p>I think the transformation we&#x27;re looking for is...</p>
<ol>
<li>We have a <code>PythonDownloadRequest</code></li>
<li>We want to unset any values that match the defaults (restore to <code>None</code>)</li>
<li>We want to drop the patch version from the <code>VersionRequest</code> component</li>
<li>We want to display it without <code>any</code> in the <code>None</code> positions</li>
</ol>
<p>This would get us the request we&#x27;re looking to pass to <code>uv python upgrade</code>. Maybe like <code>download_request.unset_defaults().without_patch().simplified_display()</code>? Is that ridiculous? :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-10 23:29</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/installation.rs</code>:404 on 2025-11-10 23:29</div>
            <div class="timeline-body"><p>This doesn&#x27;t sound unreasonable to me. It would be nice to have <code>uv python upgrade</code> accept fully-qualified installation keys, but I understand why there are specific constraints for this in place.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-10 23:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:404 on 2025-11-10 23:32</div>
            <div class="timeline-body"><p>Oh it could accept fully qualified keys, I just think it&#x27;d be ugly to tell a user to use it :D</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 20:40</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:403 on 2025-11-11 20:40</div>
            <div class="timeline-body"><p>Why do we need to clone it? Isn&#x27;t this the last use of the variable?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 20:41</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:458 on 2025-11-11 20:41</div>
            <div class="timeline-body"><p>This should explain when it would return <code>None</code>, e.g., &quot;Returns [<code>None</code>] when no segments are explicitly set&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-11-11 20:45</div>
            <div class="timeline-body"><p><code>any</code> vs <code>default</code> have different semantics, should we omit it in those cases?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 20:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:425 on 2025-11-11 20:47</div>
            <div class="timeline-body"><p>It seems weird to allow <code>Option</code> here?</p>
<p>I think I&#x27;d have <code>unset_defaults</code> include the implementation filtering, then have <code>unset_platform_defaults</code> include the platform specific part and do the <code>let Some(host) ...</code> matching in <code>unset_defaults</code>. Does that make sense?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 20:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:428 on 2025-11-11 20:48</div>
            <div class="timeline-body"><p>Can we use <code>ImplementationName::default()</code> here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 20:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:443 on 2025-11-11 20:48</div>
            <div class="timeline-body"><p>This feels like it deserves a comment</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 20:48</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-11 20:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/downloads.rs</code>:443 on 2025-11-11 20:55</div>
            <div class="timeline-body"><p>Agreed!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-11 21:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/installation.rs</code>:403 on 2025-11-11 21:07</div>
            <div class="timeline-body"><p>Ah it was the iterator from the outer <code>download_request.iter_downloads(...)</code> call that held onto a reference. I&#x27;ve put this into the <code>has_stable_download</code> block instead to fix it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-11 21:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/downloads.rs</code>:425 on 2025-11-11 21:13</div>
            <div class="timeline-body"><p>Yeah this makes sense. I do agree its a bit awkward with <code>None</code>, I guess part of my thinking was that <code>unset_defaults_with_host</code> wouldn&#x27;t be user-facing so it didn&#x27;t matter too much.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-11-11 21:19</div>
            <div class="timeline-body"><p>Hmm, we are omitting them here right (i.e. !matches)? My understanding is we&#x27;d like to surface only the segments a user explicitly set, and these both represent (afaik) no explicit version constraint.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-11 21:19</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-11 22:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-11-11 22:52</div>
            <div class="timeline-body"><p>Sorry, I meant &quot;should we be omitting it&quot;</p>
<p>That&#x27;s fair. I think I&#x27;d expect those to be filtered in the <code>unset_defaults</code> method instead though?</p>
<p>It&#x27;s a possible foot gun, in the sense that they have different semantics so omitting them could have a different result, but I can&#x27;t really think of a concrete situation where this would occur. Emitting <code>any</code> would probably mess up the key parser anyway? :/ I&#x27;m fine omitting them until there&#x27;s a problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/terror">@terror</a> reviewed on 2025-11-11 23:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/terror">@terror</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-11-11 23:42</div>
            <div class="timeline-body"><blockquote>
<p>That&#x27;s fair. I think I&#x27;d expect those to be filtered in the <code>unset_defaults</code> method instead though?</p>
</blockquote>
<p>Yeah agreed, I think <code>simplified_display</code> should be simple in that it just filters out <code>None</code> values.</p>
<blockquote>
<p>It&#x27;s a possible foot gun, in the sense that they have different semantics so omitting them could have a different result, but I can&#x27;t really think of a concrete situation where this would occur. Emitting any would probably mess up the key parser anyway? :/ I&#x27;m fine omitting them until there&#x27;s a problem.</p>
</blockquote>
<p>Looks like omitting anything will screw up the key parser (it expects 5 components), but since what we pass into <code>uv python upgrade</code> doesn&#x27;t go through the key parsing flow, I think it&#x27;s fine? ðŸ¤” Especially sine omitting <code>any</code>/<code>default</code> here doesn&#x27;t have any semantic loss, but I understand how if we use this for some other purpose there could be issues.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-12 13:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-11-12 13:44</div>
            <div class="timeline-body"><p>Just as a note</p>
<blockquote>
<p>Looks like omitting anything will screw up the key parser (it expects 5 components),</p>
</blockquote>
<p>I was referring to <code>PythonDownloadRequest</code>, which is how a request for a &quot;key&quot; is formed and does support missing components since <a href="https://github.com/astral-sh/uv/pull/14399">astral-sh/uv#14399</a></p>
<blockquote>
<p>since what we pass into uv python upgrade doesn&#x27;t go through the key parsing flow</p>
</blockquote>
<p>It could, e.g., we use the generic parser</p>
<p>https://github.com/astral-sh/uv/blob/caf49f845f1112a242f93f6860438e8ada324d6c/crates/uv/src/commands/python/install.rs#L262</p>
<p>https://github.com/astral-sh/uv/blob/60a811e715d1d1919afd73b0e4dec4c4be8aa3f9/crates/uv-python/src/discovery.rs#L1822-L1824</p>
<p>so if you request <code>uv python upgrade 3.14-x86_64</code> or something that goes through the key parsing flow</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-11-12 13:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-12 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-12 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MeitarR">@MeitarR</a> reviewed on 2025-11-12 19:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/MeitarR">@MeitarR</a> on <code>crates/uv-python/src/installation.rs</code>:82 on 2025-11-12 19:51</div>
            <div class="timeline-body"><p>Hey @terror and @zanieb, it&#x27;s problematic to not always pass the <code>python_downloads_json_url</code> as it may warn users about versions that are not really available to them, as it does not look at the actual json that they use (if it&#x27;s configured)</p>
<p>I think it should be passed, or not try to warn at all if <code>python_downloads_json_url</code> is configured</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:82 on 2025-11-12 19:54</div>
            <div class="timeline-body"><p>Thanks, I missed that</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-12 19:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-12 19:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:82 on 2025-11-12 19:54</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/uv/issues/16711</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:54:30 UTC
    </footer>
</body>
</html>
