<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add documentation for intermediate Docker layers in a workspace - astral-sh/uv #16787</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add documentation for intermediate Docker layers in a workspace</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/16787">#16787</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-11-20 14:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-20 14:44</div>
            <div class="timeline-body"><p><em>No description provided.</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @zanieb on 2025-11-20 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add documentation for intermediate layers with a workspace" to "Add documentation for intermediate Docker layers in a workspace" by @zanieb on 2025-11-20 15:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @zanieb on 2025-11-20 17:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-11-20 18:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/guides/integration/docker.md</code>:453 on 2025-11-20 18:55</div>
            <div class="timeline-body"><p>I think I would recommend <code>--frozen</code> here, isn't it much simpler? That's what we tend to do in our own Dockerfiles.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-20 19:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/guides/integration/docker.md</code>:453 on 2025-11-20 19:47</div>
            <div class="timeline-body"><p>In what sense? <code>--frozen</code> <em>here</em> doesn't change anything because the whole workspace has been added already, it'd be up above where using <code>--frozen</code> instead of <code>--locked</code> makes things simpler.</p>
<p>I don't think we should recommend <code>--frozen</code> in general though, because I think <code>--locked</code> asserting that your <code>uv.lock</code> is not stale is meaningful and helpful.</p>
<p>I think it's fine to recommend <code>--frozen</code> above and rely on this subsequent <code>--locked</code> to catch a stale lock, but I worry that will also be confusing to people (i.e., I recommended exactly this in the issue and the user opted to do the additional mounts instead)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-11-21 00:33</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>docs/guides/integration/docker.md</code>:453 on 2025-11-21 00:33</div>
            <div class="timeline-body"><p>Sorry, I meant to comment on the line above. I personally find it unnecessary to enumerate all of the <code>pyproject.toml</code> files in the <code>uv sync --no-install-workspace</code> when you're doing a locked install here anyway? (But -- again personally -- I wouldn't use <code>--locked</code> in a Dockerfile, I think that validation should be done in CI.)</p>
<p>In pyx at least, we instead use <code>--frozen</code> for this install phase, but enumerate all the workspace members when we do the <code>ADD</code> (to minimize invalidation).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-21 16:52</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/guides/integration/docker.md</code>:453 on 2025-11-21 16:52</div>
            <div class="timeline-body"><p>Yeah... I'll change it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zhcn000000">@zhcn000000</a> on 2025-11-23 12:40</div>
            <div class="timeline-body"><p>If I need to install all the packages for a specific workspace, how should I handle it? If I directly use uv sync --package, will the packages in the project root directory be ignored</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-24 15:09</div>
            <div class="timeline-body"><p>Yeah, use <code>--package</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-11-24 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-11-24 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-11-24 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codspeed-hq[bot]">@codspeed-hq[bot]</a> on 2025-11-24 15:27</div>
            <div class="timeline-body"><!-- __CODSPEED_PERFORMANCE_REPORT_COMMENT__ -->

<h2><a href="https://codspeed.io/astral-sh/uv/branches/zb%2Fdocker-workspace?utm_source=github&amp;utm_medium=comment&amp;utm_content=header">CodSpeed Performance Report</a></h2>
<h3>Merging #16787 will <strong>degrade performances by 19.45%</strong></h3>
<p><sub>Comparing <code>zb/docker-workspace</code> (29fc564) with <code>main</code> (d6eb285)</sub></p>
<h3>Summary</h3>
<p><code>❌ 1</code> regression<br />
<code>✅ 5</code> untouched</p>
<blockquote>
<p>:warning: <em>Please fix the performance issues or <a href="https://codspeed.io/astral-sh/uv/branches/zb%2Fdocker-workspace?utm_source=github&amp;utm_medium=comment&amp;utm_content=acknowledge">acknowledge them on CodSpeed</a>.</em></p>
</blockquote>
<h3>Benchmarks breakdown</h3>
<p>|     | Mode | Benchmark | <code>BASE</code> | <code>HEAD</code> | Change |
| --- | ---- | --------- | ------ | ------ | ------ |
| ❌ | Simulation | <a href="https://codspeed.io/astral-sh/uv/branches/zb%2Fdocker-workspace?uri=crates%2Fuv-bench%2Fbenches%2Fuv.rs%3A%3Auv%3A%3Aresolve_warm_airflow%3A%3Aresolve_warm_airflow&amp;runnerMode=Instrumentation&amp;utm_source=github&amp;utm_medium=comment&amp;utm_content=benchmark"><code>resolve_warm_airflow</code></a> | 808.3 ms | 1,003.6 ms | -19.45% |</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 05:52:32 UTC
    </footer>
</body>
</html>
