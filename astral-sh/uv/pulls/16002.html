<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for explicit variants and `--all-variants` flag with `uv python list` - astral-sh/uv #16002</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for explicit variants and <code>--all-variants</code> flag with <code>uv python list</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/16002">#16002</a>
        opened by <a href="https://github.com/shaanmajid">@shaanmajid</a>
        on 2025-09-23 14:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/shaanmajid">@shaanmajid</a> on 2025-09-23 14:46</div>
            <div class="timeline-body"><p>Adds <code>--all-variants</code> flag to <code>uv python list</code> to show debug Python builds that are normally hidden.</p>
<h2>Functional Requirements Met:</h2>
<ul>
<li><strong>Default behavior</strong>: Only default variants shown (hides debug/freethreaded)</li>
<li><strong>--all-variants flag</strong>: Shows all variants including debug, freethreaded, freethreaded+debug</li>
<li><strong>Explicit requests</strong>: <code>3.13+debug</code> works without needing the flag</li>
<li><strong>Flag compatibility</strong>: Works with <code>--all-versions</code>, <code>--only-downloads</code>, etc.</li>
</ul>
<h2>Key Behavior:</h2>
<pre><code class="language-bash"># Default - only shows default variant
uv python list 3.13  # → cpython-3.13.7-platform

# Show all variants for specific version  
uv python list 3.13 --all-variants  # → default, debug, freethreaded, freethreaded+debug

# Explicit variant request (works without flag)
uv python list 3.13+debug  # → cpython-3.13.7+debug-platform
</code></pre>
<p>Fixes #15983</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-09-23 14:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/python/list.rs</code>:79 on 2025-09-23 14:55</div>
            <div class="timeline-body"><p>This looks wrong — we shouldn't drop the original request from the user. Though I see you filter using it later, then we'll need to duplicate a bunch of logic that happens in discovery. We'll also do a bunch of work querying interpreters that do not match the request. I'm not quite sure how best to achieve what you're trying to do here though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-23 14:57</div>
            <div class="timeline-body"><p>I think this issue may be harder than it looks. Maybe it'd be a good place to start just adjusting the <em>downloads</em> we show based on an <code>--all-variants</code> flag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-23 15:09</div>
            <div class="timeline-body"><p>Oh it looks like you are only changing the download listing logic here, so perhaps disregard that part (though we'll need to figure out how to show all variants we discover too at some point)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-23 15:11</div>
            <div class="timeline-body"><p>Maybe you need to add something like</p>
<p>https://github.com/astral-sh/uv/blob/dea17009455249b7c76a8575d73dd76c7796a0fc/crates/uv-python/src/downloads.rs#L163-L165</p>
<p>for variants?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shaanmajid">@shaanmajid</a> reviewed on 2025-09-24 16:13</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on <code>crates/uv/src/commands/python/list.rs</code>:79 on 2025-09-24 16:13</div>
            <div class="timeline-body"><p>yeah that was pretty troll mb :/</p>
<p>Reworked the implementation based on your feedback</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @shaanmajid on 2025-09-24 21:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on 2025-09-24 21:36</div>
            <div class="timeline-body"><p>Testing was a bit annoying ; I didn't realize debug variants were not supported on Windows at first. Last minute split up a lot of test-cases based off target, but lmk if you think it's worth organizing this better</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on 2025-09-29 17:25</div>
            <div class="timeline-body"><p>Hey @zanieb, just wanted to check whether there’s anything else you’d like me to do on this PR. Happy to rebase or tweak if needed :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 18:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/discovery.rs</code>:1731 on 2025-10-07 18:59</div>
            <div class="timeline-body"><p>We generally prefer to list all the variants so if we add a new one we're forced to revisit this and see if it needs to be updated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 18:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:167 on 2025-10-07 18:59</div>
            <div class="timeline-body"><p>What does &quot;to filter by the requested variant&quot; mean here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 19:00</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:167 on 2025-10-07 19:00</div>
            <div class="timeline-body"><p>You mean like, one in the <code>VersionRequest</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 19:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-10-07 19:01</div>
            <div class="timeline-body"><p>I'm confused that this is an <code>Option</code> if we're not using the inner boolean value?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 19:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/python/list.rs</code>:63 on 2025-10-07 19:01</div>
            <div class="timeline-body"><p>I don't think we should use this — we're moving away from <code>miette</code>. You can see other <code>hint</code> formatting to see how we're handling this for now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 19:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/python/list.rs</code>:94 on 2025-10-07 19:05</div>
            <div class="timeline-body"><p>Leaving a note for https://github.com/astral-sh/uv/pull/16002/files#r2411619048</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-07 19:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/python/list.rs</code>:144 on 2025-10-07 19:05</div>
            <div class="timeline-body"><p>I'm confused that we're changing the filtering here <em>and</em> at https://github.com/astral-sh/uv/pull/16002/files#r2411618419</p>
<p>Why do we need both?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shaanmajid">@shaanmajid</a> reviewed on 2025-10-08 21:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on <code>crates/uv/src/commands/python/list.rs</code>:63 on 2025-10-08 21:10</div>
            <div class="timeline-body"><p>Switched to use standard <code>hint</code> formatting</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shaanmajid">@shaanmajid</a> reviewed on 2025-10-08 21:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on <code>crates/uv-python/src/downloads.rs</code>:465 on 2025-10-08 21:10</div>
            <div class="timeline-body"><p>Fixed to use an explicit boolean</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "feat: add --all-variants flag to uv python list" to "Add support for explicit variants and `--all-variants` flag with `uv python list`" by @shaanmajid on 2025-10-08 22:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shaanmajid">@shaanmajid</a> reviewed on 2025-10-08 22:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on <code>crates/uv/src/commands/python/list.rs</code>:144 on 2025-10-08 22:47</div>
            <div class="timeline-body"><p>Updated and consolidated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shaanmajid">@shaanmajid</a> reviewed on 2025-10-08 23:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on <code>crates/uv-python/src/discovery.rs</code>:1731 on 2025-10-08 23:01</div>
            <div class="timeline-body"><p>Updated to use explicit listing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shaanmajid">@shaanmajid</a> reviewed on 2025-10-08 23:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on <code>crates/uv-python/src/downloads.rs</code>:167 on 2025-10-08 23:02</div>
            <div class="timeline-body"><p>Yeah, that was the intent. Sorry, the conflicting terminology / overload between Python's &quot;variants&quot; and Rust variants is a bit unfortunate here haha. Updated the comment a bit to further elaborate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on 2025-10-08 23:12</div>
            <div class="timeline-body"><p>@zanieb Wanted to quickly double-check about pre-existing behavior with the display of freethreaded variants.</p>
<p>Currently:</p>
<ul>
<li><code>uv python list</code> (i.e. no explicit request) shows both default and free-threaded variants (i.e. all non-debug variants)</li>
<li><code>uv python list 3.13</code> (i.e. explicit request) shows only the default variant</li>
</ul>
<p>This seems intentional and aligns with treating freethreaded as non-experimental in Python 3.14+ and uv 0.9+ (per #16142). Just wanted to confirm this is the intended behavior, since this PR makes the variant filtering more explicit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @shaanmajid on 2025-10-08 23:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shaanmajid">@shaanmajid</a> on 2025-11-03 22:49</div>
            <div class="timeline-body"><p>Hey @zanieb, just wanted to check back on this. Is there anything else you would like changed? Also happy to just close the PR if you don't think y'all have time for it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:30 UTC
    </footer>
</body>
</html>
