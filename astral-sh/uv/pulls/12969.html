<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obfuscate username in tracing URL - astral-sh/uv #12969</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Obfuscate username in tracing URL</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/12969">#12969</a>
        opened by <a href="https://github.com/jtfmumm">@jtfmumm</a>
        on 2025-04-18 14:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-04-18 14:06</div>
            <div class="timeline-body"><p>A URL username can be a secret token, so we should avoid logging it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">security</span> added by @jtfmumm on 2025-04-18 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-18 16:08</div>
            <div class="timeline-body"><p>I think we might need a way to recover this, because it can be important for debugging to see which username is being used (this is frequently relevant since the username is used downstream, e.g., in keyring fetches).</p>
<p>Separately, should we only obfuscate the username if we don't have a password? That's the only case where it can be a token, right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-04-18 17:39</div>
            <div class="timeline-body"><blockquote>
<p>I think we might need a way to recover this, because it can be important for debugging to see which username is being used (this is frequently relevant since the username is used downstream, e.g., in keyring fetches).</p>
</blockquote>
<blockquote>
<p>Separately, should we only obfuscate the username if we don't have a password? That's the only case where it can be a token, right?</p>
</blockquote>
<p>It's possible but probably pretty uncommon for people to accidentally switch the two. For now, I could update it to only obfuscate the username when it's on its own (since it's still more secure than <code>main</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-04-18 18:07</div>
            <div class="timeline-body"><p>I've updated to only mask the username when it's on its own and added a test for the various scenarios.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 20:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-auth/src/middleware.rs</code>:521 on 2025-04-18 20:54</div>
            <div class="timeline-body"><p>A comment would probably be helpful here, re. tokens</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-04-18 20:54</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @jtfmumm on 2025-04-19 09:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @jtfmumm on 2025-04-19 09:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-04-19 09:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:23 UTC
    </footer>
</body>
</html>
