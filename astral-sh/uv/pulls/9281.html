<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improve build backend excludes - astral-sh/uv #9281</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Improve build backend excludes</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/9281">#9281</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-11-20 16:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>This PR contains three smaller improvements:</p>
<ul>
<li>Improve the include/exclude logging. We're still showing the current directory as empty backticks, not sure what to do about that</li>
<li>Add early stopping to license file globbing, so we don't traverse the whole directory recursively when license files can only be in few places</li>
<li>Support explicit wheel excludes. These are still not entirely right, but at least we're correctly excluding compiled python files now. The next step is to make sure that the wheel excludes contain all pattern from source dist excludes, to make sure source tree -&gt; wheel can't have more files than source tree -&gt; source dist -&gt; wheel.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @konstin on 2024-11-20 16:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @BurntSushi by @konstin on 2024-11-20 16:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/uv-build-backend/src/lib.rs</code>:509 on 2024-11-20 16:54</div>
            <div class="timeline-body"><p>Is this the thing that will emit an empty string for the CWD? Can we make it emit <code>./</code> instead for that case?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/uv-build-backend/src/lib.rs</code>:323 on 2024-11-20 16:55</div>
            <div class="timeline-body"><p>Can you say why you don't want to get more files in <code>source tree -&gt; wheel</code> versus <code>source tree -&gt; source dist -&gt; wheel</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> approved on 2024-11-20 16:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-11-21 11:18</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-build-backend/src/lib.rs</code>:509 on 2024-11-21 11:18</div>
            <div class="timeline-body"><p>I have an idea, but it affects more places so I'll follow up</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2024-11-21 11:20</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-build-backend/src/lib.rs</code>:323 on 2024-11-21 11:20</div>
            <div class="timeline-body"><p>Imagine we exclude <code>src/a/b.py</code> in source dist, but not in wheel. That means in source dist -&gt; wheel, <code>src/a/b.py</code> is part of the final packages, but we remove it in source tree -&gt; source dist, so the source dist -&gt; wheel step can't include it (the file doesn't exist in the <code>.tar.gz</code>), so <code>src/a/b.py</code> isn't part of the final package.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @konstin on 2024-11-21 11:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-11-21 11:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-11-21 11:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:40:43 UTC
    </footer>
</body>
</html>
