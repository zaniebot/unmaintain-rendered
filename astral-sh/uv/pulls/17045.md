```yaml
number: 17045
title: "Implement `uv pip freeze --exclude` flag"
type: pull_request
state: open
author: gaardhus
labels: []
assignees: []
base: main
head: freeze-exclude
created_at: 2025-12-09T10:20:22Z
updated_at: 2025-12-11T08:57:58Z
url: https://github.com/astral-sh/uv/pull/17045
synced_at: 2026-01-10T01:57:38Z
```

# Implement `uv pip freeze --exclude` flag

---

_Pull request opened by @gaardhus on 2025-12-09 10:20_

## Summary

Implements the `--exclude` flag to `uv pip freeze`, which allows to filter unwanted dependencies from the resulting requirements.txt file.

```bash
uv pip freeze --exclude pandas
```

part of https://github.com/astral-sh/uv/issues/3141


## Test Plan

Unit test with simple exclusions based on a synced requirements.text.


---

_@zanieb reviewed on 2025-12-10 14:05_

---

_Review comment by @zanieb on `crates/uv/src/commands/pip/freeze.rs`:89 on 2025-12-10 14:05_

Why do we do the `exclude.is_empty` check?

---

_@zanieb reviewed on 2025-12-10 14:05_

---

_Review comment by @zanieb on `crates/uv/src/commands/pip/freeze.rs`:25 on 2025-12-10 14:05_

Should this be a hash set instead?

---

_Review comment by @zanieb on `crates/uv/src/settings.rs`:2755 on 2025-12-10 14:06_

I presume we'd transform to a hash set here

---

_@zanieb reviewed on 2025-12-10 14:06_

---

_Review comment by @zanieb on `crates/uv/src/commands/pip/freeze.rs`:25 on 2025-12-10 14:06_

https://github.com/astral-sh/uv/pull/17045/files#r2606798282

---

_@zanieb reviewed on 2025-12-10 14:06_

---

_@zanieb reviewed on 2025-12-10 14:07_

---

_Review comment by @zanieb on `crates/uv/tests/it/pip_freeze.rs`:595 on 2025-12-10 14:07_

I might just `pip install` these packages instead since it's simpler, and you don't need to pin versions because we use exclude-newer in the test suite.

---

_@gaardhus reviewed on 2025-12-11 08:39_

---

_Review comment by @gaardhus on `crates/uv/src/commands/pip/freeze.rs`:89 on 2025-12-11 08:39_

redundant indeed

---

_Review comment by @gaardhus on `crates/uv/tests/it/pip_freeze.rs`:595 on 2025-12-11 08:43_

changed to pip_install, and can also remove pins, however I just adopted that from the other test cases, so unsure how to move forward with that.

---

_@gaardhus reviewed on 2025-12-11 08:43_

---

_@gaardhus reviewed on 2025-12-11 08:49_

---

_Review comment by @gaardhus on `crates/uv/src/settings.rs`:2783 on 2025-12-11 08:49_

transform to hash set here seems to be how I can make it work? `exclude: exclude.into_iter().collect(),`

however, like pinning versions in pip_install test, I'm unsure if other similar cases should be changed, i.e. PipListSettings implements a similar exclude argument which is also currently a Vec.

@zanieb 

---
