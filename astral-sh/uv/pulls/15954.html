<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add a &quot;storage&quot; reference document - astral-sh/uv #15954</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add a &quot;storage&quot; reference document</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/15954">#15954</a>
        opened by <a href="https://github.com/zsol">@zsol</a>
        on 2025-09-19 20:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zsol">@zsol</a></div>
            <div class="timeline-body"><p>This is based on, and super<strong>s</strong>edes @zanieb's #13976</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @zsol on 2025-09-19 20:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zsol on 2025-09-19 20:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @zsol on 2025-09-19 20:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @zsol on 2025-09-19 20:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zsol on 2025-09-19 20:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-09-20 02:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/geofft">@geofft</a> on <code>docs/reference/storage.md</code>:43 on 2025-10-03 13:37</div>
            <div class="timeline-body"><p>We use XDG for everything on macOS, no? (Like this sentence implies that we otherwise put things in ~/Library/sh.astral.uv or whatever, which I don't think we do.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/geofft">@geofft</a> on <code>docs/reference/storage.md</code>:59 on 2025-10-03 13:38</div>
            <div class="timeline-body"><p>Probably worth not having two headings titled &quot;Cache,&quot; especially since this one links to the other one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/geofft">@geofft</a> on <code>docs/reference/storage.md</code>:89 on 2025-10-03 13:39</div>
            <div class="timeline-body"><p>I thought this is out of preview now, at least for the explicit-installation form e.g. <code>uv python install 3.14</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/geofft">@geofft</a> on <code>docs/reference/storage.md</code>:46 on 2025-10-03 13:40</div>
            <div class="timeline-body"><p>It's probably worth adding something somewhere about how already-created virtual environments symlink to this directory, and so if you change this directory after having started to use uv, it will break venvs and require a sync, or something.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/geofft">@geofft</a> on <code>docs/reference/storage.md</code>:195 on 2025-10-13 17:07</div>
            <div class="timeline-body"><p>I would combine these into one paragraph because that link is where the documentation for the format of this variable is (e.g. relative / absolute paths).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/geofft">@geofft</a> reviewed on 2025-10-13 17:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-10-14 10:24</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/reference/storage.md</code>:10 on 2025-10-14 10:24</div>
            <div class="timeline-body"><p>What about adding the table from https://github.com/astral-sh/uv/issues/11360#issuecomment-3228297622 as quick overview so you don't need to read the whole doc?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-17 14:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/reference/storage.md</code>:43 on 2025-10-17 14:55</div>
            <div class="timeline-body"><p>Yeah we don't respect the system native macOS directories</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-10-17 14:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/reference/storage.md</code>:89 on 2025-10-17 14:55</div>
            <div class="timeline-body"><p>Yeah this is out of preview</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zsol">@zsol</a> on 2025-11-02 04:03</div>
            <div class="timeline-body"><p>Thanks for all the feedback. I've rewritten the first section (directory strategies) based on it, including the excellent table @konstin mentioned, extending it a bit. I think the page is now more concise, less repetitive.</p>
<p>After some digging, I now think that <code>.uv</code> in the current directory is technically a fallback <a href="https://github.com/astral-sh/uv/blob/ab186137e57f9b37298a73915c08f547f9ec0831/crates/uv-state/src/lib.rs#L95">in the code</a>, I think that branch is unreachable because <code>uv_dirs::user_state_dir()</code> always returns an <code>Ok</code> value, so I removed that bit from the docs. We should get rid of it from the code, too, IMO.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-11-04 16:37</div>
            <div class="timeline-body"><blockquote>
<p>After some digging, I now think that <code>.uv</code> in the current directory is technically a fallback <a href="https://github.com/astral-sh/uv/blob/ab186137e57f9b37298a73915c08f547f9ec0831/crates/uv-state/src/lib.rs#L95">in the code</a>, I think that branch is unreachable because <code>uv_dirs::user_state_dir()</code> always returns an <code>Ok</code> value, so I removed that bit from the docs. We should get rid of it from the code, too, IMO.</p>
</blockquote>
<p>The code can fail if there's a <code>HomeDirError</code> cause the home dir function is fallible. From my experience there's always some minimal Docker or some Windows entreprise configuration where it fails, so a <code>.uv</code> fallback is convenient.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/reference/storage.md</code>:10 on 2025-11-04 16:44</div>
            <div class="timeline-body"><pre><code class="language-suggestion">For determining where to store different types of data, uv follows the [XDG](https://specifications.freedesktop.org/basedir-spec/latest/) conventions on Linux and macOS and the platform defaults on Windows, with XDG paths where Windows does not have defaults. Generally, it's best to configure these rather than each uv-specific storage location.
</code></pre>
<p>It kind of an awkward sentence cause XDG is kinda the platform default on Linux, except</p>
<ul>
<li>it's not defined by Linux but something people aligned on,</li>
<li>we're using XDG on macOS over the macOS platform APIs because we want to treat it more like a Unix that follows XDG, which aligns better with dev usage,</li>
<li>we're following the actual platform conventions on Windows, except where non exist (user-level binaries), there we follow the XDG spec. We also had a thread about respecting XDG on Windows when set, and falling back to the native APIs, but that didn't happen (yet).</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/reference/storage.md</code>:16 on 2025-11-04 16:46</div>
            <div class="timeline-body"><p>I wouldn't call it fallback, <code>XDG_CACHE_HOME</code> is often not set, to me <code>~/.cache/uv</code> feels more like the default and <code>XDG_CACHE_HOME</code> like an override, but I would just document the order.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/reference/storage.md</code>:17 on 2025-11-04 19:10</div>
            <div class="timeline-body"><p>On a fresh install, it uses <code>%APPDATA%\uv</code> to e.g. install Pythons, we should document that as default location, the <code>%APPDATA%\uv\data</code> exists only not to break legacy paths.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/reference/storage.md</code>:34 on 2025-11-04 19:13</div>
            <div class="timeline-body"><pre><code class="language-suggestion">[virtual environments](#project-environments) uv operates on.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-11-04 19:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zsol">@zsol</a> reviewed on 2025-11-05 13:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zsol">@zsol</a> on <code>docs/reference/storage.md</code>:17 on 2025-11-05 13:42</div>
            <div class="timeline-body"><p>Agreed. Do you think it's important to emphasize this nuance here? I think what the PR has currently is correct.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zsol">@zsol</a> on 2025-11-05 13:43</div>
            <div class="timeline-body"><p>Thanks! I addressed all of your feedback except for the one I replied to</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-11-05 14:05</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/reference/storage.md</code>:17 on 2025-11-05 14:05</div>
            <div class="timeline-body"><p>I'd document where a user can expect their data to go, and which levers they have to change this. So I'd put <code>%APPDATA%\uv</code>centrally: It's the location to find uv data, and changing <code>APPDATA</code> can change the location of uv data. <code>%APPDATA%\uv\data</code> should be more akin to a footnote, it something that may be used on a legacy setup, but never when setting something new up, or when changing the location manually. Currently, it reads to me as if <code>%APPDATA%\uv\data</code> is the main one, and <code>%APPDATA%\uv</code> is a fallback.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zsol">@zsol</a> reviewed on 2025-11-05 14:42</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zsol">@zsol</a> on <code>docs/reference/storage.md</code>:17 on 2025-11-05 14:42</div>
            <div class="timeline-body"><p>OK, changed it. PTAL</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2025-11-05 15:02</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-11-05 17:22</div>
            <div class="timeline-body"><p>Should we pull in the changes from https://github.com/astral-sh/uv/pull/16590 here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-14 14:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/reference/installer.md</code>:7 on 2025-11-14 14:07</div>
            <div class="timeline-body"><pre><code class="language-suggestion">`XDG_DATA_HOME/../bin`. See [storage reference](./storage.md#executables) for details on these
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-11-14 18:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/reference/storage.md</code>:17 on 2025-11-14 18:45</div>
            <div class="timeline-body"><p>I omitted the legacy location entirely, that's really old functionality.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zsol">@zsol</a> on <code>docs/reference/storage.md</code>:28 on 2025-11-17 11:04</div>
            <div class="timeline-body"><p>IMO these should be numbered to make the order of preference clear.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zsol">@zsol</a> reviewed on 2025-11-17 11:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zsol on 2025-11-17 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zsol on 2025-11-17 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-11-17 14:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:44:49 UTC
    </footer>
</body>
</html>
