<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validate URL wheel tags against `Requires-Python` and required environments - astral-sh/uv #16824</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Validate URL wheel tags against `Requires-Python` and required environments</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/16824">#16824</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2025-11-23 21:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-23 21:08</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Closes #16818.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2025-11-23 21:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2025-11-23 21:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2025-11-23 21:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-11-23 21:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/tests/it/lock.rs</code>:32247 on 2025-11-23 21:09</div>
            <div class="timeline-body"><p>Today, this resolution passes and the wheel is just omitted from the lockfile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-11-23 21:09</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/tests/it/lock.rs</code>:32279 on 2025-11-23 21:09</div>
            <div class="timeline-body"><p>Same here -- this passes too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/resolver/mod.rs</code>:1202 on 2025-11-24 12:51</div>
            <div class="timeline-body"><p>Here, we compute through which marker paths the package is currently reachable. Doesn't that mean we can miss an incompatible package if the dependency with a wider marker only appears later?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-11-24 12:52</div>
            <div class="timeline-body"><p>One question about the resolver order, otherwise looks good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-11-24 14:08</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-resolver/src/resolver/mod.rs</code>:1202 on 2025-11-24 14:08</div>
            <div class="timeline-body"><p>Hmm, maybe? But I think this is the same strategy as in the <code>choose_version_registry</code> path`.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-11-24 14:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-resolver/src/resolver/mod.rs</code>:1202 on 2025-11-24 14:59</div>
            <div class="timeline-body"><p>It looks like we're getting saved by pseudo-packages having their version selection, with this PR this fails as it should:</p>
<pre><code class="language-toml">[project]
name = &quot;test-toml&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.14&quot;
dependencies = [
    'numpy; sys_platform == &quot;win32&quot;',
    'pandas',
]

[tool.uv]
required-environments = ['sys_platform == &quot;linux&quot;', 'sys_platform == &quot;win32&quot;']

[tool.uv.sources]
numpy = { url = &quot;https://files.pythonhosted.org/packages/a3/2e/235b4d96619931192c91660805e5e49242389742a7a82c27665021db690c/numpy-2.3.5-cp314-cp314-win_amd64.whl&quot; }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2025-11-24 14:59</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2025-11-26 01:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-11-26 01:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-11-26 01:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 05:52:33 UTC
    </footer>
</body>
</html>
