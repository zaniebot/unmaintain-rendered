<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Update documentation about reusing cache across multiple containers - astral-sh/uv #12676</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Update documentation about reusing cache across multiple containers</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/12676">#12676</a>
        opened by <a href="https://github.com/potiuk">@potiuk</a>
        on 2025-04-04 17:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/potiuk">@potiuk</a></div>
            <div class="timeline-body"><p>With #12359 I&#x27;ve learned about the power of mounting shared cache when you run multiple containers, I think it&#x27;s worth mentioning it in the <code>uv</code> documentation so that others can discover it more easily</p>
<p>Closes: #12359</p>


Summary


Test Plan


</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-04 18:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/kaxil">@kaxil</a> reviewed on 2025-04-04 18:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/kaxil">@kaxil</a> on <code>docs/concepts/cache.md</code>:165 on 2025-04-04 18:51</div>
            <div class="timeline-body"><pre><code>your CI tests where you want to run `uv sync` as part of your CI tests. In such case you can share
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jscheffl">@jscheffl</a> reviewed on 2025-04-04 20:22</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jscheffl">@jscheffl</a> on <code>docs/concepts/cache.md</code>:169 on 2025-04-04 20:22</div>
            <div class="timeline-body"><pre><code>In order to do it, the folder where the cache is stored must be mounted to the `~/.cache/uv` directory
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-16 15:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/cache.md</code>:159 on 2025-04-16 15:43</div>
            <div class="timeline-body"><p>Should this go in the Docker integration guide instead? We could keep a stub here, like</p>
<pre><code>## Sharing the cache

uv shares a cache across processes on the same machine by default.

See the [Docker integration guide](...) for details on how to share the cache across containers.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/cache.md</code>:170 on 2025-04-16 15:44</div>
            <div class="timeline-body"><p>I&#x27;d probably share the Docker invocation for this too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-16 15:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-16 15:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/cache.md</code>:161 on 2025-04-16 15:44</div>
            <div class="timeline-body"><p>Please stylize as &quot;uv&quot; not &quot;UV&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-16 15:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>docs/concepts/cache.md</code>:167 on 2025-04-16 15:45</div>
            <div class="timeline-body"><p>Is the parallel part particularly important here? Isn&#x27;t it helpful that the cache is shared regardless of concurrency?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/potiuk">@potiuk</a> reviewed on 2025-06-22 17:35</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/potiuk">@potiuk</a> on <code>docs/concepts/cache.md</code>:159 on 2025-06-22 17:35</div>
            <div class="timeline-body"><p>Good idea</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/potiuk">@potiuk</a> reviewed on 2025-06-22 17:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/potiuk">@potiuk</a> on <code>docs/concepts/cache.md</code>:170 on 2025-06-22 17:43</div>
            <div class="timeline-body"><p>absolutely.l</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/potiuk">@potiuk</a> reviewed on 2025-06-22 17:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/potiuk">@potiuk</a> on <code>docs/concepts/cache.md</code>:161 on 2025-06-22 17:43</div>
            <div class="timeline-body"><p>my bad</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/potiuk">@potiuk</a> reviewed on 2025-06-22 17:46</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/potiuk">@potiuk</a> on <code>docs/concepts/cache.md</code>:167 on 2025-06-22 17:46</div>
            <div class="timeline-body"><p>I think it&#x27;s not obvious that you can do it for parallel docker containers but yes I think it makes sense to mention that until your machine is run the cache will also be used when running containers sequentially.</p>
<p>I reworded it a bit and in the &quot;docker,md&quot; I split caching strategy into two cases:</p>
<ol>
<li>when you run containers locally or on long running VMs -&gt; better to use cache mount in this case</li>
<li>when you run containers on CI (there it makes more sense to use mounted volume when you run parallel or sequential builds</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/potiuk">@potiuk</a> on 2025-06-22 17:52</div>
            <div class="timeline-body"><p>Sorry it took so long, but I hope I can finally contribute to uv :) . Happy to get more comments and apply them</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/potiuk">@potiuk</a> on 2025-06-23 05:38</div>
            <div class="timeline-body"><p>I also updated the description to better separate two cases:</p>
<ul>
<li>one is cache_mount when you build image</li>
<li>anotehr is mounting volume from host when you run containers</li>
</ul>
<p>This is the <strong>real</strong> difference between those two cases - both of them using containers, and both can be used either locally or when running things in CI/ephemeral runners (but the second case only makes sense when you run more than one build/container per job).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cgravill">@cgravill</a> on 2025-09-24 14:38</div>
            <div class="timeline-body"><p>The pointers in this PR were really useful, thanks!</p>
<p>Not sure it&#x27;s quite the right place, but I wanted to share that we now do ephemeral GitHub builds self-hosted based on this. We initially had a pypi proxy but it was still slow. @zanieb suggested looking here, then I made a very direct adjustment to our CI runs:</p>
<pre><code>container:
  volumes:
    - uv-cache:/github/home/.cache/uv
</code></pre>
<p>which shares the cache on the host. We&#x27;ve been running it for a while with Ubuntu as the base container and it&#x27;s worked great. You can be more explicit and pass a volume to the runners but this works straight in the actions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/potiuk">@potiuk</a> on 2025-10-16 13:50</div>
            <div class="timeline-body"><blockquote>
<p>The pointers in this PR were really useful, thanks!</p>
</blockquote>
<p>Maybe worth merging it then :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/potiuk">@potiuk</a> on 2025-10-21 11:58</div>
            <div class="timeline-body"><p>Shall we @zanieb :) ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/potiuk">@potiuk</a> on 2025-10-25 21:11</div>
            <div class="timeline-body"><p>:) ? .. It hangs on my unmerged PRs</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:51:36 UTC
    </footer>
</body>
</html>
