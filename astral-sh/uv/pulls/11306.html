<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Include archive bucket version in archive pointers - astral-sh/uv #11306</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Include archive bucket version in archive pointers</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/11306">#11306</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2025-02-07 02:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-07 02:00</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>We've never bumped the version of this bucket, and we may never do so... But it's still incorrect for us to omit it from these serialized structs in the cache. Specifically, these structs include a pointer into the archive bucket (namely, the ID). But we don't include the bucket version! So, in theory, we could end up pointing to archives that don't match the current bucket version expected in the code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2025-02-07 02:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2025-02-07 02:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2025-02-07 02:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-02-07 02:20</div>
            <div class="timeline-body"><p>Well, you know I think it's a good idea.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.6.0" by @charliermarsh on 2025-02-07 02:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/T-256">@T-256</a> on <code>crates/uv-cache/src/lib.rs</code>:795 on 2025-02-07 16:03</div>
            <div class="timeline-body"><pre><code class="language-suggestion">            // in `crates/uv/tests/it/cache_prune.rs`.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/T-256">@T-256</a> reviewed on 2025-02-07 16:03</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2025-02-07 22:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-02-07 22:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-02-07 22:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:19 UTC
    </footer>
</body>
</html>
