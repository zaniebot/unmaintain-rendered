<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refactor *Settings to clarify and reduce repetition - astral-sh/uv #12138</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Refactor *Settings to clarify and reduce repetition</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/12138">#12138</a>
        opened by <a href="https://github.com/jtfmumm">@jtfmumm</a>
        on 2025-03-12 16:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-03-12 16:32</div>
            <div class="timeline-body"><p>When making changes to uv that require new (or altered) settings, there are many places in the code that need to change. This slows down work, reduces confidence in changes for new developers, and adds noise to PRs. The goal of this PR is to reduce the number of points that need to change (and that the developer needs to understand) when making changes to settings.</p>
<p>This PR consolidates <code>ResolverSettings</code> and <code>ResolverInstallerSettings</code> by factoring out the shared settings and using a new field <code>resolver_settings</code> on <code>ResolverInstallerSettings</code>. This not only reduces repetition, but makes it easier for a human to parse the code without having to compare long lists of fields to spot differences (the difference was that <code>ResolverInstallerSettings</code> had two extra fields).</p>
<p>This also removes <code>ResolverSettingsRef</code> and <code>ResolverInstallerSettingsRef</code>, using normal Rust references instead. For the time being, I've left <code>InstallerSettingsRef</code> in place because it appears to have a semantic meaning that might be relied upon. However, it would now be straightforward to refactor to pass <code>&amp;ResolverInstallerSettings</code> wherever <code>InstallerSettingsRef</code> appears, further reducing sprawl.</p>
<p>The change has the downside of adding <code>settings.resolver_settings.&lt;field&gt;</code> and requiring dereferencing at various points where it was not required before (with the *SettingsRef approach). But this means there are significantly fewer places that must change to update settings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">internal</span> added by @jtfmumm on 2025-03-12 16:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @charliermarsh by @jtfmumm on 2025-03-12 16:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @jtfmumm on 2025-03-12 16:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @jtfmumm on 2025-03-12 16:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-03-12 21:06</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/commands/build_frontend.rs</code>:178 on 2025-03-12 21:06</div>
            <div class="timeline-body"><p>Does this need to take an owned value?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2025-03-12 21:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv/src/settings.rs</code>:2494 on 2025-03-12 21:07</div>
            <div class="timeline-body"><p>I'd prefer to call this <code>resolver</code>, what do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> approved on 2025-03-12 21:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/src/settings.rs</code>:2494 on 2025-03-13 08:10</div>
            <div class="timeline-body"><p><code>resolver_settings</code> is definitely clunky. I went back and forth but I've updated it to <code>resolver</code> now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-03-13 08:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jtfmumm">@jtfmumm</a> reviewed on 2025-03-13 08:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on <code>crates/uv/src/commands/build_frontend.rs</code>:178 on 2025-03-13 08:10</div>
            <div class="timeline-body"><p>Fixed</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @jtfmumm on 2025-03-13 08:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @jtfmumm on 2025-03-13 08:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-03-13 08:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:21 UTC
    </footer>
</body>
</html>
