<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build and install workspace members that are dependencies by default - astral-sh/uv #14663</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Build and install workspace members that are dependencies by default</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/14663">#14663</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-07-16 16:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Regardless of the presence of a build system, as in https://github.com/astral-sh/uv/pull/14413</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-16 20:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:1732 on 2025-07-16 20:11</div>
            <div class="timeline-body"><p>We use <code>seen</code> since it includes all the recursively collected dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zanieb on 2025-07-16 20:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @zanieb on 2025-07-16 20:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-16 21:32</div>
            <div class="timeline-body"><p>This seems to have a bad interaction with #14413 now that it's based on it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-16 22:55</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-workspace/src/workspace.rs</code>:767 on 2025-07-16 22:55</div>
            <div class="timeline-body"><p>This isn't strictly correct, as you could have an unused source here? However, if the workspace member is a dependency, you <em>do</em> need the source entry. I'm hesitant to add collection of the full requirement graph here. We might need to consider a different approach.</p>
<p>Unfortunately, I think we need to do something like this (collect the required members when constructing the <code>Workspace</code>) because in places like <code>Workspace:: members_requirements</code> we don't otherwise have enough information to construct the proper <code>editable</code> and <code>virtual</code> values. It was &quot;working&quot; before #14197, but somehow that leads to conflicting URL errors now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-16 22:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-workspace/src/workspace.rs</code>:767 on 2025-07-16 22:57</div>
            <div class="timeline-body"><p>(You can see the previous approach prior to https://github.com/astral-sh/uv/pull/14663/commits/94efd22fcf3cd64ae02d2a334f1ad37d8c4a476c)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @zanieb on 2025-07-16 22:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-16 22:57</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:1732 on 2025-07-16 22:57</div>
            <div class="timeline-body"><p>We're not doing this anymore, see https://github.com/astral-sh/uv/pull/14663#discussion_r2211772923</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-17 00:16</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-workspace/src/workspace.rs</code>:767 on 2025-07-17 00:16</div>
            <div class="timeline-body"><p>cc @konstin in case you have any ideas here</p>
<p>We could also just not differentiate workspace member build behavior based on whether or not its a dependency, that'd make life way easier.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>docs/concepts/projects/dependencies.md</code>:870 on 2025-07-17 14:06</div>
            <div class="timeline-body"><p>The backticks look wrong</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv/src/commands/project/lock_target.rs</code>:163 on 2025-07-17 14:29</div>
            <div class="timeline-body"><p>nit: Does this need to be static if we clone it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-workspace/src/workspace.rs</code>:402 on 2025-07-17 14:34</div>
            <div class="timeline-body"><p>Do we need to / should we filter for <code>package = false</code> here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @konstin on 2025-07-17 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @konstin on 2025-07-17 14:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-07-17 14:34</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-07-17 14:37</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-workspace/src/workspace.rs</code>:767 on 2025-07-17 14:37</div>
            <div class="timeline-body"><p>I think both this and a proper graph are fine, though I like this one for only looking at the workspace structure and not at the user input, so that whether we build is independent of the specific sync args.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-17 14:47</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-workspace/src/workspace.rs</code>:402 on 2025-07-17 14:47</div>
            <div class="timeline-body"><p><code>Source::Workspace</code> doesn't allow <code>package</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-07-17 15:51</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-workspace/src/workspace.rs</code>:402 on 2025-07-17 15:51</div>
            <div class="timeline-body"><p>It's an open question, I guess, if it needs to?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/konstin">@konstin</a> on <code>crates/uv-workspace/src/workspace.rs</code>:402 on 2025-07-17 16:26</div>
            <div class="timeline-body"><p>I expect we'll want to add it for symmetry with <code>path</code>, but it's not a pressing concern. It's non-breaking to add it from what I can tell, so I'd start without it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> reviewed on 2025-07-17 16:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @zanieb on 2025-07-17 18:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-07-17 18:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-07-17 18:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-07-17 18:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:44:00 UTC
    </footer>
</body>
</html>
