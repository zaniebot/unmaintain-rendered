<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Python and PyPy install mirrors configurable in uv.toml - astral-sh/uv #8695</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Make Python and PyPy install mirrors configurable in uv.toml</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/8695">#8695</a>
        opened by <a href="https://github.com/owenbrooks">@owenbrooks</a>
        on 2024-10-30 11:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/owenbrooks">@owenbrooks</a> on 2024-10-30 11:31</div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
-->

<h2>Summary</h2>
<p>Adds python-install-mirror and pypy-install-mirror as keys for uv.toml, and cli args for <code>uv python install</code>.</p>
<p>Could leave the cli args out if we think the env vars and configs are sufficient.</p>
<p>Fixes #8186</p>
<!-- What's the purpose of the change? What does it do, and why? -->

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @konstin on 2024-10-30 11:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-10-30 13:01</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-30 13:01</div>
            <div class="timeline-body"><p>Do we need to thread the values through here too?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/owenbrooks">@owenbrooks</a> reviewed on 2024-10-31 07:36</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/owenbrooks">@owenbrooks</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-31 07:36</div>
            <div class="timeline-body"><p>That would keep it consistent. Do we want the cli args? Looks like that fetch function ends up being called by quite a few commands.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-cli/src/lib.rs</code>:3888 on 2024-10-31 13:25</div>
            <div class="timeline-body"><p>I would probably rename this to <code>mirror</code> in the CLI context</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-10-31 13:25</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-10-31 13:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-cli/src/lib.rs</code>:3896 on 2024-10-31 13:26</div>
            <div class="timeline-body"><p>I think this can be <code>pypy-mirror</code> in this context</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-10-31 13:26</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-31 13:26</div>
            <div class="timeline-body"><p>I don't think we want to add the CLI args everywhere. I'd propagate the settings to here instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-10-31 13:27</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-31 13:27</div>
            <div class="timeline-body"><p>I guess we also have to resolve the settings with the environment variable at some point then?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/s1as3r">@s1as3r</a> reviewed on 2024-10-31 14:07</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/s1as3r">@s1as3r</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-31 14:07</div>
            <div class="timeline-body"><p>Adding to this. I worked on this a bit before this pr was made. I tried doing this a bit differently.</p>
<ul>
<li>I added the python and pypy install mirros to <code>GloablOptions</code> in <code>uv-settings</code></li>
<li>the env vars for the same were also added to <code>env</code> (vars not exposed as cli args) inside of the <code>uv</code> crate.</li>
<li>the setting from uv.toml and the environment variables are combined in <code>GlobalSettings::resolve</code></li>
<li>There were quite a few functions that had to be changed to include the mirrors as parameters.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a> reviewed on 2024-10-31 16:10</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-31 16:10</div>
            <div class="timeline-body"><p>@zanieb -- Should these just be globals, like <code>--allow-insecure-host</code>? (Do they even need to be exposed on the command-line at all?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-10-31 16:12</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-python/src/installation.rs</code>:134 on 2024-10-31 16:12</div>
            <div class="timeline-body"><p>I think it's reasonable to expose them in <code>uv python install</code>, but I wouldn't expose them elsewhere.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Fau57">@Fau57</a> on 2024-11-03 09:39</div>
            <div class="timeline-body"><p>Not sure if this change has happened or will happen or once at all but I am all for it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/owenbrooks">@owenbrooks</a> reviewed on 2024-11-04 23:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/owenbrooks">@owenbrooks</a> on <code>crates/uv-cli/src/lib.rs</code>:3888 on 2024-11-04 23:44</div>
            <div class="timeline-body"><p>Done</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/owenbrooks">@owenbrooks</a> on 2024-11-04 23:47</div>
            <div class="timeline-body"><p>Config has been threaded through the other relevant commands. The CLI args take precedence over env vars which take precedence over config values. CLI args are present only for <code>python install</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @owenbrooks on 2024-11-04 23:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Vynce">@Vynce</a> on 2024-11-12 22:48</div>
            <div class="timeline-body"><p>@owenbrooks, thanks for picking this up!</p>
<p>@zanieb, I think this is ready for review again unless you want a rebase/merge from main to address the conflicts first?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-11-13 14:45</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2024-11-13 15:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2024-11-13 16:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-11-13 16:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Vynce">@Vynce</a> on 2024-11-13 19:12</div>
            <div class="timeline-body"><p>Thanks for getting this merged ðŸ˜Š</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:13 UTC
    </footer>
</body>
</html>
