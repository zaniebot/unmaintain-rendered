<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filter out markers based on Python requirement - astral-sh/uv #4912</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Filter out markers based on Python requirement</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/4912">#4912</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-07-09 04:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body">Summary
<p>In marker normalization, we now remove any markers that are redundant with the <code>requires-python</code> specifier (i.e., always true for the given Python requirement).</p>
<p>For example, given <code>iniconfig ; python_version &gt;= &#x27;3.7&#x27;</code>, we can remove the <code>python_version &gt;= &#x27;3.7&#x27;</code> marker when resolving with <code>--python-version 3.8</code>.</p>
<p>Closes #4852.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/BurntSushi">@BurntSushi</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 04:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/ibraheemdev">@ibraheemdev</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 04:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 04:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 04:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 04:59</div>
            <div class="timeline-body"><p>This presumes that we actually want to omit these.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 06:00</div>
            <div class="timeline-body"><p>The snapshot changes do represent a nice simplification.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 06:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-09 08:49</div>
            <div class="timeline-body"><p>transformers:</p>
<pre><code>diff --git a/uv.lock b/uv.lock
index cb0d754..ddc9775 100644
--- a/uv.lock
+++ b/uv.lock
@@ -1452,7 +1452,7 @@ name = &quot;humanfriendly&quot;
 version = &quot;10.0&quot;
 source = { registry = &quot;https://pypi.org/simple&quot; }
 dependencies = [
-    { name = &quot;pyreadline3&quot;, marker = &quot;python_version &gt;= &#x27;3.8&#x27; and sys_platform == &#x27;win32&#x27;&quot; },
+    { name = &quot;pyreadline3&quot;, marker = &quot;sys_platform == &#x27;win32&#x27;&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/cc/3f/2c29224acb2e2df4d2046e4c73ee2662023c58ff5b113c4c1adac0886c43/humanfriendly-10.0.tar.gz&quot;, hash = &quot;sha256:6b0b831ce8f15f7300721aa49829fc4e83921a9a301cc7f606be6686a2288ddc&quot;, size = 360702 }
 wheels = [
@@ -2607,7 +2607,7 @@ name = &quot;opencv-python&quot;
 version = &quot;4.10.0.84&quot;
 source = { registry = &quot;https://pypi.org/simple&quot; }
 dependencies = [
-    { name = &quot;numpy&quot;, marker = &quot;python_version &gt;= &#x27;3.7&#x27; or (python_version &lt;= &#x27;3.9&#x27; and platform_machine == &#x27;arm64&#x27; and platform_system == &#x27;Darwin&#x27;) or (python_version &gt;= &#x27;3.6&#x27; and platform_machine == &#x27;aarch64&#x27; and platform_system == &#x27;Linux&#x27;) or (python_version &gt;= &#x27;3.10&#x27; and platform_system == &#x27;Darwin&#x27;)&quot; },
+    { name = &quot;numpy&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/4a/e7/b70a2d9ab205110d715906fc8ec83fbb00404aeb3a37a0654fdb68eb0c8c/opencv-python-4.10.0.84.tar.gz&quot;, hash = &quot;sha256:72d234e4582e9658ffea8e9cae5b63d488ad06994ef12d81dc303b17472f3526&quot;, size = 95103981 }
 wheels = [
@@ -4165,7 +4165,7 @@ name = &quot;sqlalchemy&quot;
 version = &quot;2.0.31&quot;
 source = { registry = &quot;https://pypi.org/simple&quot; }
 dependencies = [
-    { name = &quot;greenlet&quot;, marker = &quot;python_version &lt; &#x27;3.13&#x27; and (platform_machine == &#x27;aarch64&#x27; or (platform_machine == &#x27;ppc64le&#x27; or (platform_machine == &#x27;x86_64&#x27; or (platform_machine == &#x27;amd64&#x27; or (platform_machine == &#x27;AMD64&#x27; or (platform_machine == &#x27;WIN32&#x27; or platform_machine == &#x27;win32&#x27;))))))&quot; },
+    { name = &quot;greenlet&quot;, marker = &quot;python_version &lt; &#x27;3.13&#x27; and (platform_machine == &#x27;AMD64&#x27; or platform_machine == &#x27;WIN32&#x27; or platform_machine == &#x27;aarch64&#x27; or platform_machine == &#x27;amd64&#x27; or platform_machine == &#x27;ppc64le&#x27; or platform_machine == &#x27;win32&#x27; or platform_machine == &#x27;x86_64&#x27;)&quot; },
     { name = &quot;typing-extensions&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/ba/7d/e3312ae374fe7a4af7e1494735125a714a0907317c829ab8d8a31d89ded4/SQLAlchemy-2.0.31.tar.gz&quot;, hash = &quot;sha256:b607489dd4a54de56984a0c7656247504bd5523d9d0ba799aef59d4add009484&quot;, size = 9524110 }
@@ -5391,7 +5391,7 @@ standard = [
     { name = &quot;httptools&quot; },
     { name = &quot;python-dotenv&quot; },
     { name = &quot;pyyaml&quot; },
-    { name = &quot;uvloop&quot;, marker = &quot;sys_platform != &#x27;win32&#x27; and (platform_python_implementation != &#x27;PyPy&#x27; and sys_platform != &#x27;cygwin&#x27;)&quot; },
+    { name = &quot;uvloop&quot;, marker = &quot;platform_python_implementation != &#x27;PyPy&#x27; and sys_platform != &#x27;cygwin&#x27; and sys_platform != &#x27;win32&#x27;&quot; },
     { name = &quot;watchfiles&quot; },
     { name = &quot;websockets&quot; },
 ]
</code></pre>
<p>warehouse</p>
<pre><code>diff --git a/uv.lock b/uv.lock
index 5002a7d10..46cc86ceb 100644
--- a/uv.lock
+++ b/uv.lock
@@ -295,7 +295,7 @@ source = { registry = &quot;https://pypi.org/simple&quot; }
 dependencies = [
     { name = &quot;jmespath&quot; },
     { name = &quot;python-dateutil&quot; },
-    { name = &quot;urllib3&quot;, marker = &quot;python_version &gt;= &#x27;3.10&#x27;&quot; },
+    { name = &quot;urllib3&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/c2/30/42e7921baec564207e1593a6816a6739eeba6517307a51d0ec3e8b0e5628/botocore-1.34.139.tar.gz&quot;, hash = &quot;sha256:df023d8cf8999d574214dad4645cb90f9d2ccd1494f6ee2b57b1ab7522f6be77&quot;, size = 12565834 }
 wheels = [
@@ -1754,7 +1754,7 @@ dependencies = [
     { name = &quot;gitpython&quot; },
     { name = &quot;mkdocs&quot; },
     { name = &quot;requests&quot; },
-    { name = &quot;tzdata&quot;, marker = &quot;python_version &gt;= &#x27;3.9&#x27; and sys_platform == &#x27;win32&#x27;&quot; },
+    { name = &quot;tzdata&quot;, marker = &quot;sys_platform == &#x27;win32&#x27;&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/97/7f/6d668a1f6210db0738c9043922e38c2ff8646559d200e94ad1b4766a677f/mkdocs_rss_plugin-1.15.0.tar.gz&quot;, hash = &quot;sha256:92995ed6c77b2ae1f5f2913e62282c27e50c35d618c4291b5b939e50badd7504&quot;, size = 32566 }
 wheels = [
@@ -3278,7 +3278,7 @@ name = &quot;sqlalchemy&quot;
 version = &quot;2.0.31&quot;
 source = { registry = &quot;https://pypi.org/simple&quot; }
 dependencies = [
-    { name = &quot;greenlet&quot;, marker = &quot;python_version &lt; &#x27;3.13&#x27; and (platform_machine == &#x27;aarch64&#x27; or (platform_machine == &#x27;ppc64le&#x27; or (platform_machine == &#x27;x86_64&#x27; or (platform_machine == &#x27;amd64&#x27; or (platform_machine == &#x27;AMD64&#x27; or (platform_machine == &#x27;WIN32&#x27; or platform_machine == &#x27;win32&#x27;))))))&quot; },
+    { name = &quot;greenlet&quot;, marker = &quot;python_version &lt; &#x27;3.13&#x27; and (platform_machine == &#x27;AMD64&#x27; or platform_machine == &#x27;WIN32&#x27; or platform_machine == &#x27;aarch64&#x27; or platform_machine == &#x27;amd64&#x27; or platform_machine == &#x27;ppc64le&#x27; or platform_machine == &#x27;win32&#x27; or platform_machine == &#x27;x86_64&#x27;)&quot; },
     { name = &quot;typing-extensions&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/ba/7d/e3312ae374fe7a4af7e1494735125a714a0907317c829ab8d8a31d89ded4/SQLAlchemy-2.0.31.tar.gz&quot;, hash = &quot;sha256:b607489dd4a54de56984a0c7656247504bd5523d9d0ba799aef59d4add009484&quot;, size = 9524110 }
@@ -3346,8 +3346,8 @@ name = &quot;stripe&quot;
 version = &quot;10.1.0&quot;
 source = { registry = &quot;https://pypi.org/simple&quot; }
 dependencies = [
-    { name = &quot;requests&quot;, marker = &quot;python_version &gt;= &#x27;3.0&#x27;&quot; },
-    { name = &quot;typing-extensions&quot;, marker = &quot;python_version &gt;= &#x27;3.7&#x27;&quot; },
+    { name = &quot;requests&quot; },
+    { name = &quot;typing-extensions&quot; },
 ]
 sdist = { url = &quot;https://files.pythonhosted.org/packages/a4/58/2389ae1328d8f47b9fe83d9e21f0731e4ec81d2f31452fb2ba2266e97752/stripe-10.1.0.tar.gz&quot;, hash = &quot;sha256:241a2cba4fe8412369bfbbfaea9971c350247c4fb6e96ce8884057ebac60f1f9&quot;, size = 1290758 }
 wheels = [
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-07-09 08:49</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-09 08:51</div>
            <div class="timeline-body"><p>Warehouse shows that there&#x27;s yet another normalization opportunity: The full python requirements is <code>requires-python = &quot;&gt;=3.11, &lt;3.12&quot;</code>, so we could remove <code>python_version &lt; &#x27;3.13&#x27;</code>, too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> approved on 2024-07-09 14:26</div>
            <div class="timeline-body"><p>Yes. I like this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ibraheemdev">@ibraheemdev</a> approved on 2024-07-09 16:11</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 16:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 16:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-09 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-09 16:16</div>
            <div class="timeline-body"><p>Transient Git failures.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:46:27 UTC
    </footer>
</body>
</html>
