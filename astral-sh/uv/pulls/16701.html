<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fix CMD path in FastAPI Dockerfile - astral-sh/uv #16701</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Fix CMD path in FastAPI Dockerfile</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/16701">#16701</a>
        opened by <a href="https://github.com/jspablo">@jspablo</a>
        on 2025-11-12 10:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/jspablo">@jspablo</a> on 2025-11-12 10:17</div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<h2>Summary</h2>
<p>Fix suggestion for uv when used with FastAPI and Docker.</p>
<h2>Test Plan</h2>
<p>The Dockerfile sets <code>/app</code> as workdir, later the CMD command points again to <code>app/main.py</code> instead of only <code>main.py</code>, causing the following error:</p>
<pre><code>Path does not exist app/main.py
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2025-11-12 13:38</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @zanieb on 2025-11-12 13:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2025-11-12 13:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-11-12 13:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Vminoz">@Vminoz</a> on 2025-11-16 11:10</div>
            <div class="timeline-body"><p>@jspablo sorry, this change was incorrect, please see https://github.com/astral-sh/uv-fastapi-example</p>
<p>It may be somewhat confusing though that the project structure uses <code>app/</code> as main module and copies files to <code>/app</code> as per docker conventions.</p>
<p>In short main.py is in fact at <code>/app/app/main.py</code> at runtime and this change is invalid.</p>
<h3>Example</h3>
<pre><code class="language-sh">$ git clone https://github.com/astral-sh/uv-fastapi-example &amp;&amp; cd uv-fastapi-example
Cloning into 'uv-fastapi-example'...
remote: Enumerating objects: 33, done.
remote: Counting objects: 100% (19/19), done.
remote: Compressing objects: 100% (13/13), done.
remote: Total 33 (delta 8), reused 6 (delta 6), pack-reused 14 (from 1)
Receiving objects: 100% (33/33), 26.33 KiB | 4.39 MiB/s, done.
Resolving deltas: 100% (9/9), done.
$ git rev-parse HEAD
a1e313147b9be055167fe500d457d7c0b2f51318
$ grep -e 'app\b' Dockerfile
COPY . /app
WORKDIR /app
CMD [&quot;/app/.venv/bin/fastapi&quot;, &quot;run&quot;, &quot;app/main.py&quot;, &quot;--port&quot;, &quot;80&quot;]
$ docker build -qt fastapi-app . &amp;&amp; docker run -p 8000:80 fastapi-app
sha256:9c0fe8617c2c026bd7193ce1a096dc44b62180c52a8531fa7aa0e847242c1b2a
INFO     Using path app/main.py
INFO     Resolved absolute path /app/app/main.py
INFO     Searching for package file structure from directories with __init__.py
         files
INFO     Importing from /app

 â•­â”€ Python package file structure â”€â•®
 â”‚                                 â”‚
 â”‚  ğŸ“ app                         â”‚
 â”‚  â”œâ”€â”€ ğŸ __init__.py             â”‚
 â”‚  â””â”€â”€ ğŸ main.py                 â”‚
 â”‚                                 â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

INFO     Importing module app.main
INFO     Found importable FastAPI app

 â•­â”€â”€ Importable FastAPI app â”€â”€â•®
 â”‚                            â”‚
 â”‚  from app.main import app  â”‚
 â”‚                            â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

INFO     Using import string app.main:app

 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ FastAPI CLI - Production mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
 â”‚                                                     â”‚
 â”‚  Serving at: http://0.0.0.0:80                      â”‚
 â”‚                                                     â”‚
 â”‚  API docs: http://0.0.0.0:80/docs                   â”‚
 â”‚                                                     â”‚
 â”‚  Running in production mode, for development use:   â”‚
 â”‚                                                     â”‚
 â”‚  fastapi dev                                        â”‚
 â”‚                                                     â”‚
 â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

INFO:     Started server process [1]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:80 (Press CTRL+C to quit)
</code></pre>
<p>I suppose a reverting PR is in order or some other change to lower the risk of confusion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-16 16:33</div>
            <div class="timeline-body"><p>@jspablo did you not test the change as described in the test plan.. ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jspablo">@jspablo</a> on 2025-11-16 21:35</div>
            <div class="timeline-body"><p>It was a mistake on my side when moving to a compose file, the build context was different and thought the error was the folder, which caused the misunderstanding and fixing it locally with the wrong setup.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-16 22:57</div>
            <div class="timeline-body"><p>Interesting, thanks for the context</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 05:52:31 UTC
    </footer>
</body>
</html>
