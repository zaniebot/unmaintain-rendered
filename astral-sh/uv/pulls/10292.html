<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft: Add `uv license` command - astral-sh/uv #10292</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Draft: Add <code>uv license</code> command</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/pull/10292">#10292</a>
        opened by <a href="https://github.com/ryanleary">@ryanleary</a>
        on 2025-01-03 16:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ryanleary">@ryanleary</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>Add a new command, <code>uv license</code>, to uv to assist with dependency license audit needs in response to #8156. Design of command arguments loosely informed by https://crates.io/crates/cargo-license.</p>
<p>Example invocation:</p>
<pre><code class="language-bash">$ cat pyproject.toml
[project]
name = &quot;project&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [
    &quot;scikit-learn==1.4.1.post1&quot;
]
classifiers = [
    &quot;License :: OSI Approved :: MIT License&quot;
]
$
$ uv license --universal
project: 0.1.0, MIT License
scikit-learn: 1.4.1.post1, BSD License
joblib: 1.3.2, BSD License
numpy: 1.26.4, BSD License
scipy: 1.12.0, BSD License
threadpoolctl: 3.4.0, BSD License
</code></pre>
<p>As of right now, the implementation is very rough, with this PR intended to gather feedback on the approach, with the initial focus on pulling license information from Trove classifiers. A refined implementation would pivot to following <a href="https://peps.python.org/pep-0639/">PEP-639</a> guidelines, return license information as SPDX expressions, and gracefully fall back to Trove, and finally the (legacy?) license field.</p>
<p>I'd like feedback on whether or not the current approach:</p>
<ul>
<li>is a relatively expensive <code>license()</code> method on <code>Package</code> objects to trigger calls to <code>DistributionDatabase.get_or_build_wheel_metadata</code> sensible?  is a better way that I am missing that would be minimally disruptive to the overall <code>uv</code> codebase?</li>
<li>There are many <code>Metadata</code>-related structs within the codebase which explicitly comment that they contain only the subset of fields required for dependency resolution. Adding additional optional fields here breaks this constraint and I'm not sure if is desirable or would be acceptable to the maintainers.</li>
</ul>
<p>Note: the display code is entirely copied from <code>uv tree</code> and cut down. I would rewrite to enable display organized by package or license/serialization to machine-readable summary, etc.</p>
<p>Any feedback appreciated. I am new to both the uv codebase and Rust, but will continue on this if we can agree on an approach.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by @ryanleary on 2025-01-03 18:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ranjithrajv">@ranjithrajv</a> on 2025-01-16 17:06</div>
            <div class="timeline-body"><p>Maybe we could consider using <code>uv tree --show-licences</code>, similar to <code>uv python list --show-urls</code>.
Just a suggestion, feel free to let me know what you think</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-01-16 17:49</div>
            <div class="timeline-body"><p>I had actually started with that, but abandoned it because you may not want to show a tree. You may want to get a list of all dependencies and their licenses, or you may want to group by licenses, etc. I am not opposed if that's a consensus, the bigger issue is getting the data.</p>
<p>With all that said, until PEP-639 is ratified and becomes commonplace, this will necessarily be a bit of a minefield, and we would have to be very careful about what guarantees are made about the data returned (none), and deal with the fact that licenses may be displayed in inconsistent ways depending on the source project.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-01-21 16:24</div>
            <div class="timeline-body"><p>@charliermarsh would you mind weighing in on the approach and if you would be supportive to the inclusion of this if cleaned up?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-01-22 03:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-22 03:42</div>
            <div class="timeline-body"><p>I can own taking a look at the broad place of this in our interface.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-02-13 15:20</div>
            <div class="timeline-body"><p>Thanks @zanieb!</p>
<p>Two questions:
(1) is this directionally correct? Do you see the addition of something akin to <code>uv license</code> as sensible?
(2) any opinions on the scope of the reporting to go after initially? The license information is Python is a mess right now. I'm not sure what &quot;good enough&quot; for a v0 would realistically look like.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-13 15:45</div>
            <div class="timeline-body"><p>I'm all for some sort of command to query license information, but there are other, similar use-cases like auditing dependencies for vulnerabilities. I don't want to have a new top-level command for each thing, so this is loosely blocked on the design of a top-level <code>uv &lt;something&gt;</code> command which performs queries or audits of your dependencies.</p>
<p>Related</p>
<ul>
<li>https://github.com/astral-sh/uv/issues/9189</li>
<li>https://github.com/astral-sh/uv/pull/10886</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-02-13 15:47</div>
            <div class="timeline-body"><p>Fair enough. I'll push forward with the machinery of the license data collection then. We could potentially separate this into two efforts:
(1) internal ability to gather license information
(2) exposing that ability via a CLI/public API that is expected to be relatively stable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/marhoy">@marhoy</a> on 2025-03-10 15:49</div>
            <div class="timeline-body"><p>We need a tool that can check our dependencies for copyleft licenses like GPL.
How close is this PR to being merged?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-10 17:12</div>
            <div class="timeline-body"><blockquote>
<p>How close is this PR to being merged?</p>
</blockquote>
<p>Not close, because we need a broader coherent design for this kind of interface and that work takes a lot of engagement from our team. We're focusing on other design work right now, like #5903. We're thinking about this though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/marhoy">@marhoy</a> on 2025-03-10 21:29</div>
            <div class="timeline-body"><p>@zanieb Thanks for the reply! I'm glad to hear that you are thinking about it üòäüëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-04-22 18:43</div>
            <div class="timeline-body"><p>Now that PEP-639 is final, any suggestions on how to proceed here? There are two questions, I think:</p>
<ol>
<li>how to expose this capability within <code>uv</code>, and</li>
<li>how should we handle versions that are specified prior to Metadata v2.4, which is far more parseable/reliable, if at all</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eyalballa">@eyalballa</a> on 2025-06-11 06:08</div>
            <div class="timeline-body"><p>Hey folks, this is something that could really help me! Any update on the status of this PR or a rough ETA on when it might be merged?
anything I can pitch in to move this forward?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-07-09 16:18</div>
            <div class="timeline-body"><blockquote>
<p>we need a broader coherent design for this kind of interface and that work takes a lot of engagement from our team</p>
</blockquote>
<p>@zanieb any further thoughts on this? would the team be willing to entertain adding this feature in some kind of 'experimental' capacity, with the interface subject to change based on feedback/further refinement?</p>
<p>it would be great to mainline the core contributions, unblock those who are needing this kind of tool, and further iterate</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanleary">@ryanleary</a> on 2025-07-09 16:39</div>
            <div class="timeline-body"><p>Also tagging @konstin for input as someone who contributing code related to license parsing since this draft was first written</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danieleades">@danieleades</a> on 2025-07-09 17:50</div>
            <div class="timeline-body"><blockquote>
<p>Now that PEP-639 is final, any suggestions on how to proceed here? There are two questions, I think:</p>
<ol>
<li>how to expose this capability within <code>uv</code>, and</li>
<li>how should we handle versions that are specified prior to Metadata v2.4, which is far more parseable/reliable, if at all</li>
</ol>
</blockquote>
<p>To that last point, it would be acceptable (for me) if only metadata v2.4+ was parsed and if older metadata is encountered a warning (and package list) was surfaced. This would allow manual review of the older packages.</p>
<p>For bonus points, you could allow manually configuring the licenses for these packages in a config file. There's prior art for this in cargo-deny. It would need to account for hashing the license information or pinning to a specific version to account for the fact the licence might change between versions.</p>
<p>Obviously going back further than that would be great, but a lack of support for &lt;2.4 need not be a blocker for incremental delivery of this feature. Even a partial implementation would add immediate value</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:41:16 UTC
    </footer>
</body>
</html>
