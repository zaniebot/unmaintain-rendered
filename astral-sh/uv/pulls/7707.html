<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Don't create Python bytecode files during interpreter discovery - astral-sh/uv #7707</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Don't create Python bytecode files during interpreter discovery</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/7707">#7707</a>
        opened by <a href="https://github.com/akx">@akx</a>
        on 2024-09-26 12:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/akx">@akx</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>As @konstin noted, <code>python -I</code> ignores <code>PYTHONDONTWRITEBYTECODE</code>, so <code>--no-compile-bytecode</code> may end up with bytecode spilled onto the disk nevertheless.</p>
<p>This should fix that by way of adding <a href="https://docs.python.org/3.12/using/cmdline.html#cmdoption-B"><code>-B</code></a>.</p>
<h2>Test Plan</h2>
<p>None so far. I can add proper tests if required, if this is deemed a good idea :)</p>
<p>Closes #7696.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-09-26 12:40</div>
            <div class="timeline-body"><p>Seems reasonable to me if @konstin signs off.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @konstin by @zanieb on 2024-09-26 12:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-09-26 13:48</div>
            <div class="timeline-body"><p>We have test coverage through the general ecosystem and python discovery tests, i don't think we need specific tests that we are not writing bytecode.</p>
<p>For performance considerations: We're caching interpreter discovery, so this code should run only once, so the lack for writing bytecode should not matter. If this should turn out to affect could start times of containers, we should extend <code>--compile</code> to also bytecode compile the standard library, if permissions allow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @konstin on 2024-09-26 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Disallow writing Python bytecode when querying interpreter info" to "Don't create Python bytecode files during interpreter discovery" by @konstin on 2024-09-26 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @konstin on 2024-09-26 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-09-26 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-09-26 13:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:39:48 UTC
    </footer>
</body>
</html>
