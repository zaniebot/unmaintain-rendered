<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add upload time to `uv.lock` - astral-sh/uv #12968</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add upload time to <code>uv.lock</code></h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/12968">#12968</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2025-04-18 14:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Pull request opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-04-18 14:03</div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This is included in PEP 751, so we lose it when converting from <code>uv.lock</code>. I think it's a good piece of information to include in the <code>uv.lock</code> anyway.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by @charliermarsh on 2025-04-18 14:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @BurntSushi by @charliermarsh on 2025-04-18 14:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2025-04-18 14:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:73 on 2025-04-18 16:35</div>
            <div class="timeline-body"><p>\o/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:73 on 2025-04-18 16:36</div>
            <div class="timeline-body"><p>Do we need any process around rolling out a new revision?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:73 on 2025-04-18 16:36</div>
            <div class="timeline-body"><p>Wait it looks like upload time is optional? Do we need to bump the revision number here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-04-18 16:38</div>
            <div class="timeline-body"><p>This LGTM, with one question about bumping the revision number.</p>
<p>Otherwise, I think using RFC 3339 with a Zulu offset is the right thing for this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 16:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:73 on 2025-04-18 16:43</div>
            <div class="timeline-body"><p>I think the bumped revision means we can tell if the optional field is expected to be available.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2025-04-18 16:43</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:73 on 2025-04-18 16:43</div>
            <div class="timeline-body"><p>(REVISION != VERSION)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> reviewed on 2025-04-18 17:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>crates/uv-resolver/src/lock/mod.rs</code>:73 on 2025-04-18 17:02</div>
            <div class="timeline-body"><p>Ah okay!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> approved on 2025-04-18 17:02</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2025-04-21 01:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-04-21 01:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-04-21 01:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adamchainz">@adamchainz</a> on 2025-04-28 12:55</div>
            <div class="timeline-body"><p>Mentioning so this PR appears in search results for <code>upload_time</code> (with underscore): this PR added <code>upload_time</code> to <code>uv.lock</code> files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-04-28 13:25</div>
            <div class="timeline-body"><p>Ugh, that's my mistake -- this should've been kebab-cased. I will likely change it ASAP to minimize the number of users that have to deal with the churn twice (but retain support for reading <code>upload_time</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adamchainz">@adamchainz</a> on 2025-04-28 13:32</div>
            <div class="timeline-body"><p>Oh, I wasn't even commenting on that. I was just noting that searching for <code>upload_time</code> in the release notes and issues list found nothing, because the field had never been mentioned.</p>
<p>But well-spotted on the inconsistency and quick fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-04-28 13:33</div>
            <div class="timeline-body"><p>üëç It turns out we have very few fields with multiple segments but we do use <code>requires-dist</code> and <code>exclude-newer</code>, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LDVSOFT">@LDVSOFT</a> on 2025-04-29 17:34</div>
            <div class="timeline-body"><p>Can you hint is there a way to cleanly update <code>uv.lock</code> for the new revision without actually updating any versions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-29 19:56</div>
            <div class="timeline-body"><p>uv shouldn't update any package versions when migrating to the new lockfile revision, the package versions should only change when the requirements change. Do you see package version updates you didn't expect, and if so, can you share commands to reproduce this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LDVSOFT">@LDVSOFT</a> on 2025-04-29 20:03</div>
            <div class="timeline-body"><p>I was doing <code>uv sync -U</code> and a lot of the file was different due to revision change, not package version changes.</p>
<p>I've managed to side step it like this:</p>
<ul>
<li>Find in a package that was not updated,</li>
<li><code>git restore uv.lock &amp;&amp; uv sync</code>,</li>
<li><code>uv sync --update-package=‚Äπunchanged package‚Ä∫</code></li>
<li>Congratulations, <code>uv.lock</code> is rewritten, but not a single version change! Now I can commit this, and then do another proper <code>uv sync -U</code> with clearly visible changes.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JeanFred">@JeanFred</a> on 2025-05-06 11:33</div>
            <div class="timeline-body"><blockquote>
<p>I was doing <code>uv sync -U</code> and a lot of the file was different due to revision change, not package version changes.</p>
<p>I've managed to side step it like this:</p>
<pre><code>* Find in a package that was not updated,

* `git restore uv.lock &amp;&amp; uv sync`,

* `uv sync -U --update-package=‚Äπunchanged package‚Ä∫`

* Congratulations, `uv.lock` is rewritten, but not a single version change! Now I can commit this, and then do another proper `uv sync -U` with clearly visible changes.</code></pre>
</blockquote>
<p>Thanks, I had the same issue. I think your third point should be <code>uv sync --upgrade-package=&lt;unchanged&gt;</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LDVSOFT">@LDVSOFT</a> on 2025-05-06 14:37</div>
            <div class="timeline-body"><p>@JeanFred Thanks, I was writing from memory.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:23 UTC
    </footer>
</body>
</html>
