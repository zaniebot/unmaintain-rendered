<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cache metadata for source tree dependencies - astral-sh/uv #5423</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cache metadata for source tree dependencies</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/5423">#5423</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-07-24 20:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><h2>Summary</h2>
<p>This PR re-introduces caching for source trees. In short, we treat the metadata as cached unless the <code>pyproject.toml</code>, <code>setup.py</code>, or <code>setup.cfg</code> file changes. This is a heuristic and not a good one, especially for extension modules, but without it, we have to rebuild every project every time (unless you have static metadata, like a <code>pyproject.toml</code> that we can read directly).</p>
<p>Now that we support persistent configuration, users should add:</p>
<pre><code class="language-toml">[tool.uv]
reinstall = [&quot;foo&quot;]
</code></pre>
<p>If they want a package to always be refreshed (ignore cache) and reinstalled (ignore environment).</p>
<p>Closes https://github.com/astral-sh/uv/issues/5420.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @charliermarsh on 2024-07-24 20:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 20:24</div>
            <div class="timeline-body"><p>Should <code>refresh</code> imply <code>reinstall</code>? I hate that you need to specify both, it's really bad. But they mean different things. <code>reinstall</code> tells us to ignore the already-installed version, and <code>refresh</code> tells us to ignore the already-cached metadata.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @zanieb by @charliermarsh on 2024-07-24 20:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Review requested from @konstin by @charliermarsh on 2024-07-24 20:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 20:28</div>
            <div class="timeline-body"><p>(I expect a couple tests to fail.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 20:30</div>
            <div class="timeline-body"><p>I guess it would make more sense for <code>reinstall</code> to imply <code>refresh</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 22:15</div>
            <div class="timeline-body"><p>This is only &quot;breaking&quot; in the sense that some things that weren't cached are now cached, so some users that rely on it may see a change in behavior. They will not see any errors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-24 22:19</div>
            <div class="timeline-body"><p>I wonder if we need another label for that kind of thing? Otherwise we're automatically bumping to the next minor version because of the breaking label (which is nice for flagging things, but annoying to change as a release manager. Alternatively, I can document how to bypass the automatic bump in Rooster?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> removed by @charliermarsh on 2024-07-24 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cache</span> added by @charliermarsh on 2024-07-24 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @charliermarsh on 2024-07-24 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 22:23</div>
            <div class="timeline-body"><p>I relabeled it though not sure what the best options are.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a> approved on 2024-07-25 09:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @charliermarsh on 2024-07-25 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-25 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2024-07-25 13:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:38:23 UTC
    </footer>
</body>
</html>
