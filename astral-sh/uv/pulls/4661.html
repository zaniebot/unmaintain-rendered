<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add entrypoints to tool list - astral-sh/uv #4661</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add entrypoints to tool list</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/astral-sh/uv/pull/4661">#4661</a>
        opened by <a href="https://github.com/moreaupascal56">@moreaupascal56</a>
        on 2024-06-30 17:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/moreaupascal56">@moreaupascal56</a></div>
            <div class="timeline-body"><!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

<p>Closes #4654</p>
<h2>Summary</h2>
<p>The purpose of this is to show the entrypoints of each tool when running <code>uv tool list</code> as below:</p>
<pre><code>$ uv tool list
black
    black
    blackd

</code></pre>
<p>I used the proposed formatting as it was written in #4653 by @blueraft.
I had to use spaces instead of tabs in order to make the test successful. Indeed in the test we are using a raw string and I did not manage to make the test pass when escaping the tab in the list.rs file so I used spaces everywhere.</p>
<p>I had a deeper look into #4653 as well but it is more difficult as we need to get the version of the tool in the Tool object, I will continue on this next one later.</p>
<p>Please tell me if anything else is needed I tried to follow the contribution guidelines but I might have forgotten something.
Have a great day!</p>
<h2>Test Plan</h2>
<p><code>cargo clippy</code></p>
<p>then by using the local version of uv as described in the Readme.md.</p>
<pre><code>my-computer :~/mypath/uv$ cargo run -- tool list
   Compiling uv-cli v0.0.1 (/mypath/uv/crates/uv-cli)
   Compiling uv v0.2.18 (/mypath/uv/crates/uv)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 18.69s
     Running `target/debug/uv tool list`
warning: `uv tool list` is experimental and may change without warning.
black
  black
  blackd
isort
  isort
  isort-identify-imports

</code></pre>
<p>and</p>
<p><code>cargo test tool_list</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Add entrypoints to tool list" to "Draft: Add entrypoints to tool list" by @moreaupascal56 on 2024-06-30 17:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Draft: Add entrypoints to tool list" to "Add entrypoints to tool list" by @moreaupascal56 on 2024-06-30 22:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2024-07-01 17:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/list.rs</code>:39 on 2024-07-01 20:44</div>
            <div class="timeline-body"><p>Why collect here instead of just doing <code>for entrypoint in tool.entrypoints() { writeln(...) }</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-07-01 20:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> reviewed on 2024-07-01 20:44</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/zanieb">@zanieb</a> on <code>crates/uv/src/commands/tool/list.rs</code>:29 on 2024-07-01 20:44</div>
            <div class="timeline-body"><p>Can you delete the TODO as well?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-01 20:45</div>
            <div class="timeline-body"><p>Thank you for contributing!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/moreaupascal56">@moreaupascal56</a> reviewed on 2024-07-02 09:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/moreaupascal56">@moreaupascal56</a> on <code>crates/uv/src/commands/tool/list.rs</code>:39 on 2024-07-02 09:56</div>
            <div class="timeline-body"><p>indeed i have overcomplicated this a lot, the new <a href="https://github.com/astral-sh/uv/pull/4661/commits/94e79061197ed3cdfb651c962e2827c661c834d7">commit</a> should be better</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/moreaupascal56">@moreaupascal56</a> reviewed on 2024-07-02 09:56</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/moreaupascal56">@moreaupascal56</a> on <code>crates/uv/src/commands/tool/list.rs</code>:29 on 2024-07-02 09:56</div>
            <div class="timeline-body"><p>done :+1:</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/moreaupascal56">@moreaupascal56</a> on 2024-07-02 10:49</div>
            <div class="timeline-body"><p>Hi, so I fixed the issue but the windows test is failing because of something else. Here is the test output:</p>
<pre><code>        FAIL [   2.335s] uv::tool_list tool_list

--- STDOUT:              uv::tool_list tool_list ---

running 1 test
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_list
Source: E:\uv:24
───────────────────────────────────────────────────────────────────────────────
Expression: snapshot
───────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬──────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
    3     3 │ black
    4       │-    black
    5       │-    blackd
          4 │+    black.exe
          5 │+    blackd.exe
    6     6 │ 
    7     7 │ ----- stderr -----
    8     8 │ warning: `uv tool list` is experimental and may change without warning.
────────────┴──────────────────────────────────────────────────────────────────
Stopped on the first failure. Run `cargo insta test` to run all snapshots.
test tool_list ... FAILED

failures:

failures:
    tool_list

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 2 filtered out; finished in 2.32s


--- STDERR:              uv::tool_list tool_list ---


</code></pre>
<p>Indeed in windows the entrypoint name now ends with <code>.exe</code>.
This test worked yesterday and i do not think the former loop was removing the &quot;.exe&quot; ends of the Strings (I might miss something obvious :thinking: ).
I guess this has been introduced from this PR #4693 but I am unsure about this assumption.</p>
<p>Should we keep this <code>.exe</code> in the output (then adapting the tests accordingly) OR remove the .<code>exe</code> from the string (ie. either an if clause or somthing like <code>entrypoint.replace(&quot;.exe&quot;,&quot;&quot;)</code> to have a unified output in all OS?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-03 04:31</div>
            <div class="timeline-body"><p>Yep you can use <code>let context = TestContext::new(&quot;3.12&quot;).with_filtered_exe_suffix();</code> to turn on that filtering automatically :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a> approved on 2024-07-03 04:32</div>
            <div class="timeline-body"></div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-03 04:33</div>
            <div class="timeline-body"><p>Nice work! Thanks again :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @zanieb on 2024-07-03 04:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-07-03 04:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:37:50 UTC
    </footer>
</body>
</html>
