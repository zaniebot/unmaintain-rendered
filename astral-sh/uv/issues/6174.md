```yaml
number: 6174
title: Limit iteration range by version bounds in candidate selector
type: issue
state: closed
author: charliermarsh
labels:
  - performance
assignees: []
created_at: 2024-08-17T19:48:36Z
updated_at: 2025-01-02T01:21:38Z
url: https://github.com/astral-sh/uv/issues/6174
synced_at: 2026-01-10T01:57:13Z
```

# Limit iteration range by version bounds in candidate selector

---

_Issue opened by @charliermarsh on 2024-08-17 19:48_

When searching for candidate versions, we have a `Range`, and a `BTreeMap`. We iterate over the whole `BTreeMap` in order, ignoring versions that are outside of the given range. Would it be more efficient to apply `BTreeMap::range` on the iterator directly, so that we can skip over entire sections in log(N) time, rather than linear time?


---

_Label `performance` added by @charliermarsh on 2024-08-17 19:48_

---

_Comment by @charliermarsh on 2024-08-19 01:16_

This actually might be impossible right now because the range is represented as a set of holes, rather than having a clear upper bound...

---

_Referenced in [astral-sh/uv#10266](../../astral-sh/uv/pulls/10266.md) on 2025-01-02 01:09_

---

_Closed by @charliermarsh on 2025-01-02 01:21_

---

_Closed by @charliermarsh on 2025-01-02 01:21_

---
