<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv sync`  isn't able to install dynamic extra dependencies - astral-sh/uv #8071</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv sync`  isn't able to install dynamic extra dependencies</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/8071">#8071</a>
        opened by <a href="https://github.com/falckt">@falckt</a>
        on 2024-10-10 05:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/falckt">@falckt</a> on 2024-10-10 05:44</div>
            <div class="timeline-body"><p>Setuptools supports dynamic optional requirements, see <a href="https://github.com/kornia/kornia/blob/ec347a978d23103e16cd8b439f51e1a1b6d56f33/pyproject.toml#L74">here</a> for an example.</p>
<p>When running <code>uv sync --extra &lt;optional&gt;</code> or <code>uv sync --all-extras</code> these optional dependencies are not collected. Running <code>uv pip install .[&lt;optional&gt;]</code> does work though.</p>
<p>MWE</p>
<pre><code class="language-command">&gt; git clone https://github.com/kornia/kornia.git
&gt; cd kornia
&gt; uv sync --extra dev
Using CPython 3.11.9 interpreter at: /home/ubuntu/.local/share/mise/installs/python/3.11/bin/python
Creating virtual environment at: .venv
Resolved 25 packages in 492ms
Installed 25 packages in 224ms
[...]

&gt; uv pip install &quot;.[dev]&quot;
Resolved 60 packages in 791ms
Uninstalled 1 package in 0.42ms
Installed 36 packages in 226ms
 + accelerate==1.0.0
 + certifi==2024.8.30
 + cfgv==3.4.0
 + charset-normalizer==3.4.0
 + coverage==7.6.2
[...]
</code></pre>
<p>I tested this using <code>uv 0.4.20</code> on ubuntu 22.04 running on x86_64.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-10-10 08:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 09:39</div>
            <div class="timeline-body"><p>Yeah <code>uv sync</code> and friends definitely don't support this. Honestly, I'm sort of undecided on whether we <em>should</em>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-10-10 09:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-10-10 09:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 09:40</div>
            <div class="timeline-body"><p>The basic issue is that we feed the set of members + their extras to the resolver, but if the extras aren't known upfront, they don't get included in the resolution. We'd need to reorder the resolver to resolve the members first.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 09:54</div>
            <div class="timeline-body"><p>We probably should support this, though it's annoying (and I personally don't recommend the use of dynamic metadata).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/falckt">@falckt</a> on 2024-10-10 09:57</div>
            <div class="timeline-body"><p>No worries, from my side it has extremely low priority. Just stumbled over it and couldn't find an existing ticket.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 10:13</div>
            <div class="timeline-body"><p>It took me a while to figure out why this was happening, but it does make sense to me now. Good bug!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @charliermarsh on 2024-10-10 11:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/8091.html">astral-sh/uv#8091</a> on 2024-10-10 13:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-10-10 14:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:05 UTC
    </footer>
</body>
</html>
