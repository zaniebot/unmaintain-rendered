<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv export` includes duplicates for projects with conflicts - astral-sh/uv #11559</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv export` includes duplicates for projects with conflicts</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/11559">#11559</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2025-02-16 18:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-16 18:12</div>
            <div class="timeline-body"><p>E.g., given:</p>
<pre><code class="language-toml">[project]
name = &quot;project&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.12.0&quot;
dependencies = [&quot;anyio&quot;]

[project.optional-dependencies]
cpu = [
  &quot;idna&lt;=1&quot;,
]
cu124 = [
  &quot;idna&lt;=2&quot;,
]

[tool.uv]
conflicts = [
  [
    { extra = &quot;cpu&quot; },
    { extra = &quot;cu124&quot; },
  ],
]
</code></pre>
<p>Then <code>uv export</code> produces:</p>
<pre><code>‚ùØ uv export
Using CPython 3.13.0
Resolved 9 packages in 0.64ms
# This file was autogenerated by uv via the following command:
#    uv export
anyio==1.3.1 ; extra == 'extra-7-project-cpu' or extra == 'extra-7-project-cu124' \
    --hash=sha256:a46bb2b7743455434afd9adea848a3c4e0b7321aee3e9d08844b11d348d3b5a0 \
    --hash=sha256:f21b4fafeec1b7db81e09a907e44e374a1e39718d782a488fdfcdcf949c8950c
anyio==4.8.0 ; (extra == 'extra-7-project-cpu' and extra == 'extra-7-project-cu124') or (extra != 'extra-7-project-cpu' and extra != 'extra-7-project-cu124') \
    --hash=sha256:1d9fe889df5212298c0c0723fa20479d1b94883a2df44bd3897aa91083316f7a \
    --hash=sha256:b5011f270ab5eb0abf13385f851315585cc37ef330dd88e27ec3d34d651fd47a
async-generator==1.10 ; extra == 'extra-7-project-cpu' or extra == 'extra-7-project-cu124' \
    --hash=sha256:01c7bf666359b4967d2cda0000cc2e4af16a0ae098cbffcb8472fb9e8ad6585b \
    --hash=sha256:6ebb3d106c12920aaae42ccb6f787ef5eefdcdd166ea3d628fa8476abe712144
idna==3.10 ; (extra == 'extra-7-project-cpu' and extra == 'extra-7-project-cu124') or (extra != 'extra-7-project-cpu' and extra != 'extra-7-project-cu124') \
    --hash=sha256:12f65c9b470abda6dc35cf8e63cc574b1c52b11df2c86030af0ac09b01b13ea9 \
    --hash=sha256:946d195a0d259cbba61165e88e65941f16e9b36ea6ddb97f00452bae8b1287d3
sniffio==1.3.1 \
    --hash=sha256:2f6da418d1f1e0fddd844478f41680e794e6051915791a034ff65e5f100525a2 \
    --hash=sha256:f4324edc670a0f49750a81b895f35c3adb843cca46f0530f79fc1babb23789dc
typing-extensions==4.12.2 ; (python_full_version &lt; '3.13' and extra != 'extra-7-project-cpu' and extra != 'extra-7-project-cu124') or (extra == 'extra-7-project-cpu' and extra == 'extra-7-project-cu124') \
    --hash=sha256:04e5ca0351e0f3f85c6853954072df659d0d13fac324d0072316b67d7794700d \
    --hash=sha256:1a7ead55c7e559dd4dee8856e3a88b41225abfe1ce8df57b7c13915fe121ffb8
</code></pre>
<p>I believe I know how to fix this; we applied a fix to <code>Installable</code> that wasn't carried over to the export logic.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-02-16 18:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2025-02-16 18:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-16 19:58</div>
            <div class="timeline-body"><p>To clarify, this is only true for the given example after #11513 \cc @BurntSushi since before that PR, this example doesn't write any conflict markers to the lockfile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11513.html">astral-sh/uv#11513</a> on 2025-02-18 01:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11643.html">astral-sh/uv#11643</a> on 2025-02-19 22:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-02-20 20:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-02-20 20:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:02 UTC
    </footer>
</body>
</html>
