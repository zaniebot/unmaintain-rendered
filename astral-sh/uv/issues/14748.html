<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>feat: `UV_PYTHON` but only scoped to `uv venv` and similar internal commands which create a `venv`. - astral-sh/uv #14748</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>feat: `UV_PYTHON` but only scoped to `uv venv` and similar internal commands which create a `venv`.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/14748">#14748</a>
        opened by <a href="https://github.com/gabyx">@gabyx</a>
        on 2025-07-19 16:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gabyx">@gabyx</a> on 2025-07-19 16:16</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><code>uv</code> is a much better improvement then the berhavior <code>poetry</code> has:</p>
<p>I am coming from a determinstic usecase with NixOS  with devenv, I am a contributor in https://github.com/cachix/devenv.</p>
<p>We set <code>UV_PYTHON_DOWNLOAD=never</code> because a Nix DevShell will define the <code>python</code> version available and Nix dev shell setups
dont want any system python etc to be used in any use case. So its strictly forbidden to do that.</p>
<ul>
<li><p>We have currently no way to really forcefully set the python version which <code>uv venv</code> use (and underlying internal flow which use a virt. env)
It would be really nice if a <code>UV_PYTHON_VENV</code> would exist which <code>uv</code> would always consult and use that python executable to create a virtual environment ( <code>uv venv</code>). This will give devenv/nix a more deterministic/stable way to have always the same python used when a virt. env is created. When <code>uv venv</code>.</p>
</li>
<li><p>The <code>UV_PYTHON</code> variable is to globally scoped as when set to lets say <code>/nix/store/...-python-3.13.../bin/python</code></p>
<ul>
<li><code>uv venv</code> will work initially but any <code>uv pip install</code> will fail as it will pick up the system (read-only) python etc.</li>
</ul>
</li>
</ul>
<h1>Suggestions</h1>
<ul>
<li><p>Enhance CLI <code>uv venv</code> to have the flag <code>--python</code> be represented as</p>
<pre><code> -p, --python &lt;PYTHON&gt;      The Python interpreter to use for the virtual environment. [env: UV_PYTHON_VENV=&quot;...&quot; (if    set) or UV_PYTHON=&quot;...&quot;]
</code></pre>
</li>
<li><p>Make the <code>UV_PYTHON_VENV</code> be used instead of <code>UV_PYTHON</code> when creating virt. envs and fallback to <code>UV_PYTHON</code> if not set.</p>
</li>
</ul>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @gabyx on 2025-07-19 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../cachix/devenv/pulls/1959.html">cachix/devenv#1959</a> on 2025-07-19 16:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-07-21 11:03</div>
            <div class="timeline-body"><p>Can you use one of the other mechanisms to control the Python interpreter, such as the <code>--python</code> option, placing the Python you want to use at the top of <code>PATH</code>, or <code>uv python pin</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gabyx">@gabyx</a> on 2025-07-21 11:35</div>
            <div class="timeline-body"><p>Oh I didnt know <code>uv python pin</code>. I check.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gabyx">@gabyx</a> on 2025-08-04 20:40</div>
            <div class="timeline-body"><p>Ok so far <code>devevn.sh</code> places the python at the top of the path which is ok and work mostly:</p>
<p><strong>But</strong> not in all cases.</p>
<p>Lets say we have <code>/nix/store/.../bin/python</code> in the top of the path and developer activates another virtual env. somewhere else with <code>source /b/bin/activate</code>. Now any <code>uv sync -v</code> <em>when the env. folder is not yet there</em> will use that python <code>/b/bin/python</code> and create the venv. We dont want this, we want to fully control what python <code>uv</code> uses when creating the environment when doing <code>uv sync ...</code> or with <code>uv venv dir</code> etc, we use <code>UV_PROJECT_ENVIRONMENT=.devenv/state/venv</code> hardcode that venv directory so far.</p>
<p>So the only way to achieve the above is to set <code>UV_PYTHON</code> but that also influences other commands <code>uv pip install</code> etc which is a bit weird. Therefore it would be nice to think about the proposed solution above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-04 21:18</div>
            <div class="timeline-body"><p>Sort of similar to https://github.com/astral-sh/uv/issues/6645</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @gabyx on 2025-09-06 17:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/15709.html">astral-sh/uv#15709</a> on 2025-09-06 19:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:09 UTC
    </footer>
</body>
</html>
