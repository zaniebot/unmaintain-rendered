```yaml
number: 13196
title: "`jupyter` doesn't work if directory is renamed"
type: issue
state: closed
author: juhaszp95
labels:
  - question
assignees: []
created_at: 2025-04-29T13:33:59Z
updated_at: 2025-06-12T15:13:55Z
url: https://github.com/astral-sh/uv/issues/13196
synced_at: 2026-01-10T01:57:30Z
```

# `jupyter` doesn't work if directory is renamed

---

_Issue opened by @juhaszp95 on 2025-04-29 13:33_

### Summary

Hi There,

I've bumped into a bug: I was trying to follow [the docs](https://docs.astral.sh/uv/guides/integration/jupyter/) to run a Jupyter server (via `uv run --with jupyter jupyter lab`), and it failed with the message

```error: Failed to spawn: `jupyter`
  Caused by: No such file or directory (os error 2)```

I've realised this is because I moved the project directory after I ran `uv init`. When I moved it back to the original path, it all started to work again.

I've checked the same thing happens if I rename the directory.

I've managed to solve this by removing the `.venv` library altogether from the project, and then trying to run Jupyter again.

I guess this is a bug, unless I missed the part that we aren't supposed to move/rename the project directory.

### Platform

Linux 4.18.0-425.3.1.el8.x86_64 x86_64 GNU/Linux

### Version

0.6.17

### Python version

_No response_

---

_Label `bug` added by @juhaszp95 on 2025-04-29 13:34_

---

_Renamed from "`jupyter server` doesn't work if directory is renamed" to "`jupyter` doesn't work if directory is renamed" by @juhaszp95 on 2025-04-29 13:34_

---

_Comment by @konstin on 2025-04-29 15:14_

This is a general limitation of venvs: The `.venv/bin/jupyter` launcher has an absolute path to `.venv/bin/python` and by renaming the directory, that moves, too. You can create a moveable venv with `uv venv --relocatable`. However, `uv run` should recreate the venv if the directory was renamed.

---

_Assigned to @jtfmumm by @jtfmumm on 2025-04-29 15:15_

---

_Comment by @juhaszp95 on 2025-04-29 15:27_

Makes sense - although `uv run` just failed with the output above in my case.

---

_Comment by @konstin on 2025-04-29 15:33_

Yeah, not catching that is a bug in uv.

---

_Comment by @charliermarsh on 2025-05-04 12:50_

(How can we catch this?)

---

_Comment by @konstin on 2025-05-04 15:28_

We can read the beginning of all entrypoints we created (through `entry_points.txt`) and if any of them points to a python interpreter that doesn't exist, we invalidate the environment. There are some details to be figured out around perf and where the scripts come from, e.g. we don't cover non-entrypoint scripts (I don't think we keep a record of `#!python` script we rewrote vs. script where the shebang was user-provided).

Another approach is recording the venv location (either `pyvenv.cfg` or a different file we create, iirc it's not recorded yet anywhere) and invalidating it if the original location and the current location aren't the same directory (usually, because the original location doesn't exist anymore, but we want to allow symlinks above the `.venv`).

---

_Comment by @juhaszp95 on 2025-06-12 11:07_

Hey - I'm hitting this again now, so any progress on this would be appreciated!

---

_Referenced in [astral-sh/uv#13989](../../astral-sh/uv/issues/13989.md) on 2025-06-12 13:21_

---

_Label `bug` removed by @zanieb on 2025-06-12 13:29_

---

_Label `question` added by @zanieb on 2025-06-12 13:29_

---

_Referenced in [astral-sh/uv#13992](../../astral-sh/uv/issues/13992.md) on 2025-06-12 13:33_

---

_Comment by @zanieb on 2025-06-12 15:13_

Let's track some concrete suggestions to improve this in https://github.com/astral-sh/uv/issues/13989 and #13992 

---

_Closed by @zanieb on 2025-06-12 15:13_

---
