```yaml
number: 16411
title: "`python -m venv` does not work with uv-managed Python installations"
type: issue
state: closed
author: notable-equivalent
labels:
  - duplicate
assignees: []
created_at: 2025-10-22T15:47:47Z
updated_at: 2025-10-31T01:16:05Z
url: https://github.com/astral-sh/uv/issues/16411
synced_at: 2026-01-10T01:57:36Z
```

# `python -m venv` does not work with uv-managed Python installations

---

_Issue opened by @notable-equivalent on 2025-10-22 15:47_

### Summary

Attempting to use a Python executable installed by `uv` to create a virtual environment in the standard Python way using `python -m venv` fails.

(I specifically ran into this because I've been working with projects that have their own complex environment setup scripts that create and manage their own Python virtual environments, and when running these with a `uv`-installed Python binary (which I'm using because it's the easiest way to get newer Python versions on Ubuntu 20.04 now that deadsnakes isn't supporting it anymore), those scripts fail. But the actual minimal steps to reproduce are simple).

Steps to reproduce:

```bash
$ uv python install 3.14

$ python3.14 -m venv /tmp/test-venv1
Error: Command '['/tmp/test-venv1/bin/python3.14', '-m', 'ensurepip', '--upgrade', '--default-pip']' returned non-zero exit status 1.
```

Running the mentioned command to see what went wrong:
```
$ /tmp/test-venv1/bin/python3.14 -m ensurepip --upgrade --default-pip
Could not find platform independent libraries <prefix>
Could not find platform dependent libraries <exec_prefix>
Fatal Python error: Failed to import encodings module
Python runtime state: core initialized
ModuleNotFoundError: No module named 'encodings'

Current thread 0x0000784757682740 [python3.14] (most recent call first):
  <no Python frame>
```

I get the same error trying to do most anything with the python executable in this venv, such as . 

The culprit seems to be the `home` setting in `pyvenv.cfg`:

```
$ cat /tmp/test-venv1/pyvenv.cfg 
home = /home/myname/.local/bin
include-system-site-packages = false
version = 3.14.0
executable = /home/myname/.local/share/uv/python/cpython-3.14.0-linux-x86_64-gnu/bin/python3.14
command = /home/myname/.local/bin/python3.14 -m venv /tmp/test-venv
```

If I instead create the virtual environment with the python executable directly instead of using the `python3.14` symlink, then there's no error, and the `home` setting is different:

```
$ which python3.14
/home/myname/.local/bin/python3.14

$ realpath /home/myname/.local/bin/python3.14
/home/myname/.local/share/uv/python/cpython-3.14.0-linux-x86_64-gnu/bin/python3.14

$ /home/myname/.local/share/uv/python/cpython-3.14.0-linux-x86_64-gnu/bin/python3.14 -m venv /tmp/test-venv2

$ cat /tmp/test-venv2/pyvenv.cfg 
home = /home/myname/.local/share/uv/python/cpython-3.14.0-linux-x86_64-gnu/bin
include-system-site-packages = false
version = 3.14.0
executable = /home/myname/.local/share/uv/python/cpython-3.14.0-linux-x86_64-gnu/bin/python3.14
command = /home/myname/.local/share/uv/python/cpython-3.14.0-linux-x86_64-gnu/bin/python3.14 -m venv /tmp/test-venv2
```

Editing the `home` setting in `test-venv1` to be the same as in `test-venv2` results in that executable working as well (e.g. `/tmp/test-venv1/bin/python3.14 -i` works).

### Platform

Ubuntu 20.04 (Linux 6.6.87.2-microsoft-standard-WSL2 x86_64 GNU/Linux)

### Version

uv 0.9.5

### Python version

Python 3.14.0

---

_Label `bug` added by @notable-equivalent on 2025-10-22 15:47_

---

_Comment by @notable-equivalent on 2025-10-22 15:53_

A workaround is to modify Python's `venv` package to resolve the path to its executable before using that to calculate the home directory. This is done by replacing the line `executable = sys._base_executable` with `executable = os.path.realpath(sys._base_executable)` in the `venv` module's `__init__.py` file (editing [this line](https://github.com/python/cpython/blob/01b52ea5c03ed83dbf44369b75f3b158c14dd912/Lib/venv/__init__.py#L160)):

```
uv run --python 3.14 --managed-python python -c 'from pathlib import Path; import venv; p = Path(venv.__file__); p.write_text(p.read_text().replace("executable = sys._base_executable", "executable = os.path.realpath(sys._base_executable)", 1))'
```

But I'm not sure what other implications this has since I don't have a full understanding of how the `home` setting is used.

---

_Comment by @zanieb on 2025-10-22 17:53_

This is a duplicate of multiple other reports.

We're working on a fix here, but there are various underlying problems, some of which are upstream CPython bugs.

The comment at https://github.com/astral-sh/python-build-standalone/issues/381#issuecomment-2628405086 is a good overview.

See also

- https://github.com/astral-sh/uv/issues/12173
- https://github.com/astral-sh/python-build-standalone/issues/380
- https://github.com/astral-sh/python-build-standalone/issues/381
- https://github.com/astral-sh/uv/issues/8821

---

_Label `bug` removed by @zanieb on 2025-10-22 17:53_

---

_Label `duplicate` added by @zanieb on 2025-10-22 17:53_

---

_Comment by @geofft on 2025-10-22 18:02_

There are a couple of related bugs here. The one you're running into is more astral-sh/python-build-standalone#380 than astral-sh-python/build-standalone#381.

Another workaround for this bug: instead of resolving the symlink yourself, using uv to invoke Python e.g. `uv run --python 3.14 python -m venv` (or just `uvx python3.14 -m venv`) will also skip the symlink. Not sure if that's helpful in the context that you're running Python.

---

_Referenced in [SkyLabsAI/workspace#4](../../SkyLabsAI/workspace/issues/4.md) on 2025-10-22 21:55_

---

_Comment by @notable-equivalent on 2025-10-23 02:19_

I found 381 but it didn't seem like exactly the same issue, but I didn't see 380, and indeed this seems to be exactly the same issue as 380. Happy for this to be closed as a dupe.

---

_Comment by @sergiocallegari on 2025-10-25 07:16_

I do not know if this is related, but I am experiencing the following. If I do `python -m venv --without-pip TEST`, where python is a managed python version, this *seems* to succeed. However:
```
cd TEST
. bin/activate
```
then gives me a broken interpreter:
```
python
Could not find platform independent libraries <prefix>
Could not find platform dependent libraries <exec_prefix>
Fatal Python error: Failed to import encodings module
Python runtime state: core initialized
ModuleNotFoundError: No module named 'encodings'

Current thread 0x00007f31d7921780 (most recent call first):
  <no Python frame>
```

---

_Closed by @charliermarsh on 2025-10-31 01:16_

---
