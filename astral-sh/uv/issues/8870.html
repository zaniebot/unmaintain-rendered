<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow hiding &quot;Missing version constraint&quot; warning via configuration, or only warn for entire workspace - astral-sh/uv #8870</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow hiding &quot;Missing version constraint&quot; warning via configuration, or only warn for entire workspace</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/8870">#8870</a>
        opened by <a href="https://github.com/vvuk">@vvuk</a>
        on 2024-11-06 17:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/vvuk">@vvuk</a> on 2024-11-06 17:55</div>
            <div class="timeline-body"><p>The configuration:</p>
<ul>
<li>virtual workspace with A &amp; B</li>
<li>package A that depends on &quot;torch&quot;</li>
<li>package B that depends on &quot;torch==2.5.1&quot;</li>
</ul>
<p>doing a <code>uv sync</code> gives a warning about a missing version constraint for torch, I assume while it's processing A's dependencies. I'd like to hide these warnings, since they're just noise for my developers. I also tried with <code>--all-packages</code> by turning my workspace root into a non-virtual workspace and adding a <code>torch&gt;1</code> dependency into the workspace root; but I still got the warning, so this seems like it's a per-package warning, not an overall workspace warning.</p>
<p>Alternatively, this request could be to wait until the entire workspace constraints are collected and only then print the warnings.</p>
<p>(I've got a bunch of pre-pyproject external python projects in a monorepo; I'm creating the pyproject to mirror their requirements.txt files exactly, so I'd rather go in and fix the dependencies in their individual pyproject files)</p>
<p>Also -- thank you for <code>uv</code>! It's brought a lot of sanity to my developers :)
Also also -- I'm happy to make a PR for stuff like this; just let me know if it's a PR you'd be OK with accepting</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-11-07 13:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-07 13:18</div>
            <div class="timeline-body"><p>Thanks for the kind words and the offer :)</p>
<p>I'm open to this but can I ask why you can't add a lower-bound on torch in package A? Is it inconvenient, or is it impossible?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-11-07 14:05</div>
            <div class="timeline-body"><p>Another question for my understanding: Are the packages in the workspace intended to be published, or do the run without publishing (e.g. deploying in docker container)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vvuk">@vvuk</a> on 2024-11-07 17:36</div>
            <div class="timeline-body"><blockquote>
<p>I'm open to this but can I ask why you can't add a lower-bound on torch in package A? Is it inconvenient, or is it impossible?</p>
</blockquote>
<p>It's not impossible, but very inconvenient -- since it's not just package A, it's package A...Z (currently around two dozen in our monorepo) :) Whenever we pull an update to one of those packages I've been just doing a <code>uv add -r requirements.txt</code> to pull in updated dependencies into our pyproject files (since those are not in the upstream packages).</p>
<p>Easiest thing would be to add a uv.tool config option for missing_version_constraint=ignore vs. warn; more complex would be to add the ability to warn only if the workspace is missing a constraint (which would be the most useful I think). I'd probably do the config first, and then extend it to missing_version_constraint=workspace or something to do the second.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ods">@ods</a> on 2024-12-06 17:43</div>
            <div class="timeline-body"><p>Lower bounds may be useful for libraries, but they are entirely irrelevant for applications that always work with all packages pinned to exact versions in a lock file. In my typical application, I encounter around 50 warnings of this type, creating significant noise and increasing the likelihood of missing important warnings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-06 17:47</div>
            <div class="timeline-body"><p>Why is a lower-bound irrelevant for an application?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ods">@ods</a> on 2024-12-06 18:13</div>
            <div class="timeline-body"><p>An application (like microservice), in contrast to a library, does not need to work with multiple versions of its dependencies. The typical workflow involves updating some or all dependencies (manually or using a tool like Renovate), testing the application with the updated versions, and deploying if everything works fine. If issues arise, the problematic dependency version is restricted (typically using <code>!=</code>, rarely with <code>&lt;</code>), and the process is repeated. Since updates generally involve moving forward rather than downgrading versions, lower bounds have no impact on the outcome.</p>
<p>The best practice is to justify every version restriction on dependencies. For a library, this typically involves specifying the oldest version that provides the required features or, at the very least, the lowest version tested in a matrix. For an application, however, there is no need to support older versions of dependencies, and testing in a matrix is often too resource-intensive. Consequently, there is little reason to test with older versions. If lower bounds are set, they often become arbitrary numbers that cannot be justified or guaranteed to work with the application. Alternatively, if the lower bounds are updated along with the versions in the lock file, they end up duplicating the lock fileâ€™s role.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-06 19:51</div>
            <div class="timeline-body"><blockquote>
<p>...however, there is no need to support older versions of dependencies, and testing in a matrix is often too resource-intensive. Consequently, there is little reason to test with older versions. If lower bounds are set, they often become arbitrary numbers that cannot be justified or guaranteed to work with the application...</p>
</blockquote>
<p>Unfortunately these lower bounds are important for resolution purposes. For example, prevent one package from being downgraded to an unsupported version when another is upgraded. They're also not entirely devoid of meaning, e.g., updating your lower bounds on semver boundaries is normal and comes with a set of expectations.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samsja">@samsja</a> on 2025-01-06 10:07</div>
            <div class="timeline-body"><p>This lower bound warning only happens when adding input in <code>tool.uv.sources</code>. Example</p>
<pre><code>[tool.uv.sources]
torch-shampoo = { path = &quot;third_party/optimizers&quot;, editable = true }
</code></pre>
<p>will trigger the lower bound warning even for dependencies that are not related to this source</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MrMarvel">@MrMarvel</a> on 2025-01-29 20:28</div>
            <div class="timeline-body"><p>I need workaround for that. (ignore warning: Missing version constraint (e.g., a lower bound) for <code>torch</code>)
Do not force people to do smth. Even if it's bad way to do that sometimes it makes someone happy.
I change poetry to uv because poetry has universal limitation to platform specific rules. They seems to me like putting sticks in a wheel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samsja">@samsja</a> on 2025-01-29 20:31</div>
            <div class="timeline-body"><blockquote>
<p>I need workaround for that. (ignore warning: Missing version constraint (e.g., a lower bound) for <code>torch</code>) Do not force people to do smth. Even if it's bad way to do that sometimes it makes someone happy. I change poetry to uv because poetry has universal limitation to platform specific rules. They seems to me like putting sticks in a wheel.</p>
</blockquote>
<p>I updated to the latest uv version and the issue does not appear anymore when doing <code>uv run ...</code> only doing <code>uv sync </code> for which its probably not a real issue</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MrMarvel">@MrMarvel</a> on 2025-01-29 20:33</div>
            <div class="timeline-body"><p>I have an example from my project.
I repeat version 3x times. It's annoying. But it is another problem.
I just wanted to remove some of versions for optional dependencies but I face warning <code>Missing version constraint (e.g., a lower bound) for torch</code> when I call <code>uv sync</code> or <code>uv lock</code></p>
<pre><code class="language-Toml">[project]
name = &quot;a&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
    &quot;requests&gt;=2.32.3&quot;,
    &quot;torch&gt;=2.6.0&quot;,
]

[project.optional-dependencies]
cpu = [
    &quot;torch&quot;,
]
gpu = [
    &quot;torch&quot;,
]

[tool.uv]
package = false
conflicts = [
  [
    { extra = &quot;cpu&quot; },
    { extra = &quot;gpu&quot; },
  ],
]

[tool.uv.sources]
torch = [
  { index = &quot;torch_cuda&quot;, extra = &quot;gpu&quot; },
  { index = &quot;torch_cpu&quot;, extra = &quot;cpu&quot; },
]


[[tool.uv.index]]
name = &quot;torch_cuda&quot;
url = &quot;https://download.pytorch.org/whl/cu124&quot;
explicit = true


[[tool.uv.index]]
name = &quot;torch_cpu&quot;
url = &quot;https://download.pytorch.org/whl/cpu&quot;
explicit = true
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MrMarvel">@MrMarvel</a> on 2025-01-29 20:35</div>
            <div class="timeline-body"><p><a href="https://github.com/astral-sh/uv/issues/8870#issuecomment-2622780914">comment</a></p>
<blockquote>
<p>I updated to the latest uv version and the issue does not appear anymore when doing uv run ... only doing uv sync  for which its
probably not a real issue</p>
</blockquote>
<p>@samsja, I want to specificaly define property in my project (<code>setting</code>) so it hides warning for <code>sync</code> or <code>lock</code> (<strong>FEATURE</strong>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ods">@ods</a> on 2025-01-30 07:51</div>
            <div class="timeline-body"><p>I find this alias handy for solving the issue:</p>
<pre><code class="language-shell">alias uv='2&gt; &gt;(grep -vF &quot;Missing version constraint&quot;) uv --color=always'
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11091.html">astral-sh/uv#11091</a> on 2025-01-30 11:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-30 11:58</div>
            <div class="timeline-body"><p>@MrMarvel thank you for the reproducer, fixed in https://github.com/astral-sh/uv/pull/11091.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-23 23:59</div>
            <div class="timeline-body"><p>I believe we removed these.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-02-23 23:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../PufferAI/PufferLib/issues/337.html">PufferAI/PufferLib#337</a> on 2025-08-21 00:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:24 UTC
    </footer>
</body>
</html>
