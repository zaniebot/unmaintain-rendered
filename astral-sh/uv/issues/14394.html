<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is it possible to upgrade just a single package if you change exclude-newer? - astral-sh/uv #14394</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Is it possible to upgrade just a single package if you change exclude-newer?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/14394">#14394</a>
        opened by <a href="https://github.com/alarthast">@alarthast</a>
        on 2025-07-01 14:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/alarthast">@alarthast</a></div>
            <div class="timeline-body">Question
<p>The default behaviour of <code>uv</code> is to prefer the previously locked versions of packages if there is an existing <code>uv.lock</code> file<a href="https://docs.astral.sh/uv/concepts/projects/sync/#upgrading-locked-package-versions">^1</a>. However, if we use the <code>--exclude-newer</code> option, then upgrading a single package also upgrades all other packages:</p>
<p>i.e.</p>
<pre><code>uv lock --exclude-newer &lt;yesterday&gt;
uv lock --exclude-newer &lt;today&gt; --upgrade-package foo
</code></pre>
<p>will lead to something like:</p>
<pre><code>Ignoring existing lockfile due to change in timestamp cutoff: `2025-06-30T23:00:00Z` vs. `2025-07-01T23:00:00Z`
</code></pre>
<p>And the attempt to upgrade a single package will upgrade all packages with the new timestamp.</p>
<p>Is there a way to upgrade a single package with a newer timestamp, while preserving the versions of existing locked packages? The only way we have found to do this is to manually edit the timestamp in the lockfile before updating a single package, which is obviously not recommended.</p>
<p>Our use-case is that we use <code>--exclude-newer</code> to implement a 7 day cool-off period for upgrading dependencies in our projects. However, on occasion there are critical security updates to a dependency that we want to upgrade without waiting for the 7 day cool-off. Weâ€™d like to be able to update occasional urgent exceptions (and their required transitive dependencies) to a more recent version without simultaneously upgrading all the other packages.</p>
Platform
<p>Linux 6.8.0-60-generic x86_64 GNU/Linux</p>
Version
<p>uv 0.7.17</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/alarthast">@alarthast</a> on 2025-07-01 14:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-02 00:52</div>
            <div class="timeline-body"><p>Yeah we ignore the existing versions entirely if the <code>--exclude-newer</code> timestamp changes, though we don&#x27;t necessarily have to -- we could respect them as preferences. I&#x27;m worried that behavior would lead to more user-surprise, though, since incrementing the <code>--exclude-newer</code> wouldn&#x27;t cause any dependencies to get upgraded by default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alarthast">@alarthast</a> on 2025-07-02 15:48</div>
            <div class="timeline-body"><p>Thanks for answering! We&#x27;re certainly interested for there to be some way of doing a single package upgrade with <code>--exclude-newer</code>, but see why that hadn&#x27;t been made an option so far. (If there is some workaround that we have missed, please kindly let us know!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 15:50</div>
            <div class="timeline-body"><p>I guess the easiest fix within the existing design would be to support <code>exclude-newer-package</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-07-28 10:09</div>
            <div class="timeline-body"><blockquote>
<p>Yeah we ignore the existing versions entirely if the <code>--exclude-newer</code> timestamp changes, though we don&#x27;t necessarily have to -- we could respect them as preferences. I&#x27;m worried that behavior would lead to more user-surprise, though, since incrementing the <code>--exclude-newer</code> wouldn&#x27;t cause any dependencies to get upgraded by default.</p>
</blockquote>
<p>I would find it more consistent to not invalidate the lockfile when exclude-newer changes; iirc the current design happened because we did not consider use cases the cutoff moves in the initial design. It is already possible to invalidate the lockfile with <code>--upgrade</code>, but there&#x27;s no equivalent <code>--no-upgrade</code> to avoid invalidating the lockfile. Upgrading when changing <code>--exclude-newer</code> is opposite to how other options work, which avoid changing the lockfile as much as possible.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-29 22:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alarthast">@alarthast</a> on 2025-08-20 13:07</div>
            <div class="timeline-body"><p>On behalf of our team, thank you so much for releasing the <code>--exclude-newer-package</code> feature! We have tested it and are happy with how it&#x27;s working :D</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-20 13:08</div>
            <div class="timeline-body"><p>Awesome, thanks for following up!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:39:15 UTC
    </footer>
</body>
</html>
