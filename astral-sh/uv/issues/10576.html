<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv run --with` not using pre-built wheels - astral-sh/uv #10576</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`uv run --with` not using pre-built wheels</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/10576">#10576</a>
        opened by <a href="https://github.com/VaasuDevanS">@VaasuDevanS</a>
        on 2025-01-13 21:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/VaasuDevanS">@VaasuDevanS</a> on 2025-01-13 21:00</div>
            <div class="timeline-body"><p>First and foremost, I'd really like to appreciate <code>Astral ⚡</code> for this amazing project.</p>
<h2>Description</h2>
<p>I stumbled upon an issue today when I was trying to build a package locally and pass it to <code>uv run</code> command.</p>
<h3>Steps to reproduce</h3>
<p>I used the following commands to build <code>my-package</code></p>
<pre><code>uv init my-package --package --python 3.11
cd my-package
uv add numpy==1.26.4
uv build
</code></pre>
<p>To test the generated .whl file, I created virtual environment in another folder using <code>uv venv --python 3.11</code> and installed the built .whl using <code>uv pip install my_package-0.1.0-py3-none-any.whl</code>. I was able to successfully import numpy, my_package and calling <code>my_package.main()</code> printed out <code>Hello from my-package!</code></p>
<p>However, when I tried this command <code>uv run --with &quot;my_package-0.1.0-py3-none-any.whl&quot; my-package</code>, I experience the following error.</p>
<pre><code>× Failed to build `numpy==1.26.4`
  ├─ The build backend returned an error
  ╰─ Call to `mesonpy.build_wheel` failed (exit code: 1)

      [stdout]
      + C:\Users\Vaasu\AppData\Local\uv\cache\builds-v0\.tmp67wRXn\Scripts\python.exe
      C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src\vendored-meson\meson\meson.py
      setup C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src
      C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src\.mesonpy-de6d_b46
      -Dbuildtype=release -Db_ndebug=if-release -Db_vscrt=md
      --native-file=C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src\.mesonpy-de6d_b46\meson-python-native-file.ini
      The Meson build system
      Version: 1.2.99
      Source dir: C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src
      Build dir:
      C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src\.mesonpy-de6d_b46
      Build type: native build
      Project name: NumPy
      Project version: 1.26.4
      WARNING: Failed to activate VS environment: Could not find C:\Program Files (x86)\Microsoft Visual
      Studio\Installer\vswhere.exe

      ..\meson.build:1:0: ERROR: Unknown compiler(s): [['icl'], ['cl'], ['cc'], ['gcc'], ['clang'], ['clang-cl'],
      ['pgcc']]
      The following exception(s) were encountered:
      Running `icl &quot;&quot;` gave &quot;[WinError 2] The system cannot find the file specified&quot;
      Running `cl /?` gave &quot;[WinError 2] The system cannot find the file specified&quot;
      Running `cc --version` gave &quot;[WinError 2] The system cannot find the file specified&quot;
      Running `gcc --version` gave &quot;[WinError 2] The system cannot find the file specified&quot;
      Running `clang --version` gave &quot;[WinError 2] The system cannot find the file specified&quot;
      Running `clang-cl /?` gave &quot;[WinError 2] The system cannot find the file specified&quot;
      Running `pgcc --version` gave &quot;[WinError 2] The system cannot find the file specified&quot;

      A full log can be found at
      C:\Users\Vaasu\AppData\Local\uv\cache\sdists-v6\pypi\numpy\1.26.4\Sq-StyJ3pScoVbBLTQlzw\src\.mesonpy-de6d_b46\meson-logs\meson-log.txt

      hint: This usually indicates a problem with the package or the build environment.
  help: `numpy` (v1.26.4) was included because `my-package` (v0.1.0) depends on `numpy`
</code></pre>
<pre><code>&gt; uv --version
uv 0.5.18 (27d1bad55 2025-01-11)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-13 21:02</div>
            <div class="timeline-body"><p>My <em>guess</em> is that <code>uv run</code> is using Python 3.13, which doesn't have built wheels for that NumPy version. Can you include the <code>--verbose</code> logs, and/or try running with <code>--python 3.12</code> or similar?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-01-13 21:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dsantiago">@dsantiago</a> on 2025-01-14 02:59</div>
            <div class="timeline-body"><p>I tried the OP instructions and it workd...</p>
<pre><code class="language-bash">uv init my-package --package --python 3.11
cd my-package
uv add numpy==1.26.4
uv build
</code></pre>
<p>Just ot note, I'm on MacOs (M1 pro).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/VaasuDevanS">@VaasuDevanS</a> on 2025-01-14 15:54</div>
            <div class="timeline-body"><p>Thanks @charliermarsh. You are right about the python version. After passing <code>--python 3.11</code> in the <code>uv run</code> command, it's working as expected. I thought uv run would infer the python version constraints from the wheel file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-01-14 16:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mesonbuild/meson-python/issues/805.html">mesonbuild/meson-python#805</a> on 2025-10-28 20:09</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
