<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add a hint on `uv tool update &lt;name&gt;` when the package is pinned to a version - astral-sh/uv #15665</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add a hint on <code>uv tool update &lt;name&gt;</code> when the package is pinned to a version</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15665">#15665</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-09-03 15:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>e.g., in <a href="https://github.com/astral-sh/uv/issues/15662">astral-sh/uv#15662</a>#issuecomment-3249450531 we should hint that the tool isn&#x27;t going to be updated because it was installed with a specific version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-03 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-03 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mdevino">@mdevino</a> on 2025-09-03 20:46</div>
            <div class="timeline-body"><p>Hello. I just started using <code>uv</code> and would like to make my first contribution. Could I work on this one, or do we already have an assignee?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-03 20:52</div>
            <div class="timeline-body"><p>Feel free!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mdevino">@mdevino</a> on 2025-09-04 12:14</div>
            <div class="timeline-body"><p>Hi @zanieb, I have a first version of this <a href="https://github.com/astral-sh/uv/compare/4162005df8017ab30461e174ffb846a6ae01f0d5...mdevino:uv:warn-of-fixed-versions?expand=1">here</a>. I&#x27;ve included a new test, which passes, but now four existing tests are failing.</p>
<pre><code>failures:
    tool_upgrade::test_tool_upgrade_additional_entrypoints
    tool_upgrade::tool_upgrade_python
    tool_upgrade::tool_upgrade_python_with_all
    tool_upgrade::tool_upgrade_with
</code></pre>
<p>Before I go ahead and make any further changes, could you take a look and let me know if 1) these failing tests should be edited or 2) there&#x27;s a flaw in my logic?</p>
<p>Also, let me know if it&#x27;s easier to open a PR instead of discussing further changes here in the issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-04 12:27</div>
            <div class="timeline-body"><p>What are the tests failing with?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mdevino">@mdevino</a> on 2025-09-04 12:36</div>
            <div class="timeline-body"><p>Here are the test logs. On a first glance, it seems to me that I need to change my logic to account for the scenario in <code>tool_upgrade_python</code>. I gotta look at other scenarios further, though.</p>
<pre><code>mdevino:uv$ cargo test tool_upgrade
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.30s
     Running unittests src/lib.rs (/home/mdevino/dev/projects/uv/target/debug/deps/uv-e698e1d53fb5c0d8)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s

     Running unittests src/bin/uv.rs (/home/mdevino/dev/projects/uv/target/debug/deps/uv-89f68e70ba278f83)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/bin/uvx.rs (/home/mdevino/dev/projects/uv/target/debug/deps/uvx-14ff50dba34e8caa)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests/it/main.rs (/home/mdevino/dev/projects/uv/target/debug/deps/it-0093f24abfb9f169)

running 14 tests
test tool_upgrade::tool_upgrade_non_existing_package ... ok
test tool_upgrade::tool_upgrade_name_pinned ... ok
test tool_upgrade::tool_upgrade_python ... FAILED
test tool_upgrade::tool_upgrade_settings ... ok
test tool_upgrade::test_tool_upgrade_additional_entrypoints ... FAILED
test tool_upgrade::tool_upgrade_python_with_all ... FAILED
test tool_upgrade::tool_upgrade_empty ... ok
test tool_upgrade::tool_upgrade_not_stop_if_upgrade_fails ... ok
test tool_upgrade::tool_upgrade_with ... FAILED
test tool_upgrade::tool_upgrade_respect_constraints ... ok
test tool_upgrade::tool_upgrade_constraint ... ok
test tool_upgrade::tool_upgrade_all ... ok
test tool_upgrade::tool_upgrade_multiple_names ... ok
test tool_upgrade::tool_upgrade_name ... ok

failures:

---- tool_upgrade::tool_upgrade_python stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 2 packages in 1.21s
Prepared 2 packages in 4.35s
Installed 2 packages in 26ms
 + babel==2.6.0
 + pytz==2018.5
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Nothing to upgrade

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_python-2
Source: crates/uv/tests/it/tool_upgrade.rs:765
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5       │-Prepared [N] packages in [TIME]
    6       │-Installed [N] packages in [TIME]
    7       │- + babel==2.6.0
    8       │- + pytz==2018.5
    9       │-Installed 1 executable: pybabel
   10       │-Upgraded tool environment for `babel` to Python 3.12
          6 │+Nothing to upgrade
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread &#x27;tool_upgrade::tool_upgrade_python&#x27; panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for &#x27;tool_upgrade_python-2&#x27; failed in line 765
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

---- tool_upgrade::test_tool_upgrade_additional_entrypoints stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 7 packages in 1.52s
Prepared 7 packages in 5.67s
Installed 7 packages in 33ms
 + babel==2.14.0
 + black==24.3.0
 + click==8.1.7
 + mypy-extensions==1.0.0
 + packaging==24.0
 + pathspec==0.12.1
 + platformdirs==4.2.0
Installed 2 executables from `black`: black, blackd
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Nothing to upgrade

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_additional_entrypoints-2
Source: crates/uv/tests/it/tool_upgrade.rs:927
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5       │-Prepared [N] packages in [TIME]
    6       │-Installed [N] packages in [TIME]
    7       │- + babel==2.14.0
    8       │- + black==24.3.0
    9       │- + click==8.1.7
   10       │- + mypy-extensions==1.0.0
   11       │- + packaging==24.0
   12       │- + pathspec==0.12.1
   13       │- + platformdirs==4.2.0
   14       │-Installed 2 executables from `black`: black, blackd
   15       │-Installed 1 executable: pybabel
   16       │-Upgraded tool environment for `babel` to Python 3.12
          6 │+Nothing to upgrade
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread &#x27;tool_upgrade::test_tool_upgrade_additional_entrypoints&#x27; panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for &#x27;tool_upgrade_additional_entrypoints-2&#x27; failed in line 927

---- tool_upgrade::tool_upgrade_python_with_all stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 2 packages in 1.20s
Prepared 2 packages in 3.68s
Installed 2 packages in 35ms
 + babel==2.6.0
 + pytz==2018.5
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 1 package in 1.12s
Prepared 1 package in 483ms
Installed 1 package in 21ms
 + python-dotenv==0.10.2.post2
Installed 1 executable: dotenv

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Prepared 1 package in 1ms
Installed 1 package in 15ms
 + python-dotenv==0.10.2.post2
Installed 1 executable: dotenv
Upgraded tool environment for `python-dotenv` to Python 3.12

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_python_with_all-3
Source: crates/uv/tests/it/tool_upgrade.rs:844
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5     6 │ Prepared [N] packages in [TIME]
    6     7 │ Installed [N] packages in [TIME]
    7       │- + babel==2.6.0
    8       │- + pytz==2018.5
    9       │-Installed 1 executable: pybabel
   10       │-Prepared [N] packages in [TIME]
   11       │-Installed [N] packages in [TIME]
   12     8 │  + python-dotenv==0.10.2.post2
   13     9 │ Installed 1 executable: dotenv
   14       │-Upgraded tool environments for `babel` and `python-dotenv` to Python 3.12
         10 │+Upgraded tool environment for `python-dotenv` to Python 3.12
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread &#x27;tool_upgrade::tool_upgrade_python_with_all&#x27; panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for &#x27;tool_upgrade_python_with_all-3&#x27; failed in line 844

---- tool_upgrade::tool_upgrade_with stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 2 packages in 1.23s
Prepared 2 packages in 2.79s
Installed 2 packages in 24ms
 + babel==2.6.0
 + pytz==2018.5
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Nothing to upgrade

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_with-2
Source: crates/uv/tests/it/tool_upgrade.rs:718
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5       │-Modified babel environment
    6       │- - pytz==2018.5
    7       │- + pytz==2024.1
          6 │+Nothing to upgrade
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread &#x27;tool_upgrade::tool_upgrade_with&#x27; panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for &#x27;tool_upgrade_with-2&#x27; failed in line 718


failures:
    tool_upgrade::test_tool_upgrade_additional_entrypoints
    tool_upgrade::tool_upgrade_python
    tool_upgrade::tool_upgrade_python_with_all
    tool_upgrade::tool_upgrade_with

test result: FAILED. 10 passed; 4 failed; 0 ignored; 0 measured; 2266 filtered out; finished in 33.11s

error: test failed, to rerun pass `--test it`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-04 13:05</div>
            <div class="timeline-body"><p>Yeah it looks like you&#x27;re exiting early when you shouldn&#x27;t be.</p>
<p>I&#x27;d maybe update the <code>Noop</code> variant to have a <code>NoopReason</code> enum which has variants for reasons it was a noop? Then return from the same place it&#x27;s currently being returned. The print should be implemented in the CLI.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mdevino">@mdevino</a> on 2025-09-04 13:21</div>
            <div class="timeline-body"><p>Sounds good. I&#x27;ll give it a try until tomorrow and let you know. Thansk for the suggestion!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mdevino">@mdevino</a> on 2025-09-08 12:10</div>
            <div class="timeline-body"><p>Hello. Just wanted to say that I couldn&#x27;t get a working version of this yet, but I&#x27;m still looking into it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-07 16:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:40:14 UTC
    </footer>
</body>
</html>
