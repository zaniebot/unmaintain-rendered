```yaml
number: 10615
title: FastAPI not being found in PATH after installing with uv in a Docker container
type: issue
state: closed
author: carrollpaul
labels:
  - question
assignees: []
created_at: 2025-01-14T22:38:57Z
updated_at: 2025-01-14T23:26:17Z
url: https://github.com/astral-sh/uv/issues/10615
synced_at: 2026-01-10T01:57:24Z
```

# FastAPI not being found in PATH after installing with uv in a Docker container

---

_Issue opened by @carrollpaul on 2025-01-14 22:38_

I'm attempting to use `uv` with Docker for my hobby project. I'm following yall's [guide](https://docs.astral.sh/uv/guides/integration/docker/) and copied the Dockerfile from the [example project](https://github.com/astral-sh/uv-docker-example) (with the exception of changing the `CMD` to use "main"):

```Dockerfile
# Dockerfile

FROM ghcr.io/astral-sh/uv:python3.12-bookworm-slim AS builder
ENV UV_COMPILE_BYTECODE=1 UV_LINK_MODE=copy
WORKDIR /app
RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --frozen --no-install-project --no-dev
ADD . /app
RUN --mount=type=cache,target=/root/.cache/uv \
    uv sync --frozen --no-dev

FROM python:3.12-slim-bookworm

# Copy the application from the builder
COPY --from=builder --chown=app:app /app /app

# Place executables in the environment at the front of the path
ENV PATH="/app/.venv/bin:$PATH"

# Run the FastAPI application by default
CMD ["fastapi", "dev", "--host", "0.0.0.0", "main"]
```

Here's my `pyproject.toml`:
```pyproject.toml
[project]
name = "backend"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
    "fastapi[standard]>=0.115.6",
    "pydantic-settings>=2.7.1",
    "sqlalchemy>=2.0.37",
    "uvicorn>=0.34.0",
    "websockets>=14.1",
]

[dependency-groups]
dev = ["pytest>=8.3.4"]

[tool.uv]
dev-dependencies = ["ruff>=0.6.2", "fastapi-cli>=0.0.5"]
```

```docker-compose.yaml
# docker-compose.yaml
services:
  backend:
    build:
      context: ./backend
    ports:
      - "1234:8000" # FastAPI app
      - "8080:8080" # TCP server
      - "8765:8765" # WebSocket server
    develop:
      watch:
        # Sync the working directory with the `/app` directory in the container
        - action: sync
          path: ./backend
          target: /app
          ignore:
            - ./backend/.venv/

        # Rebuild the image on changes to the `pyproject.toml`
        - action: rebuild
          path: ./pyproject.toml
    volumes:
      - ./backend/app:/app
    logging:
      driver: "json-file"
      options:
        max-size: "200k"
        max-file: "10"

  frontend:
    build:
      context: ./frontend
    ports:
      - "1235:80"
    volumes:
      - ./frontend:/usr/share/nginx/html
```


My project structure looks like this:
```
.
├── backend
│   ├── main.py
│   ├── Dockerfile
│   ├── pyproject.toml
│   ├── uv.lock
│   ├── app
│   │   ├──etc...
├── frontend
│   ├── etc...
| docker-compose.yaml
| README.md
```

`main.py` contains the FastAPI `app`. 

From the root of the project I execute `docker compose up` and get this error:

>Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: "fastapi": executable file not found in $PATH: unknown

Not sure if this is a bug or a me problem (probably the latter).

---

_Comment by @zanieb on 2025-01-14 22:45_

Is the problem that you're mounting a volume over the image's virtual environment?

---

_Comment by @zanieb on 2025-01-14 22:46_

Some commentary on that in https://docs.astral.sh/uv/guides/integration/docker/#developing-in-a-container and https://github.com/astral-sh/uv-docker-example/blob/a14ebc89e3a5e5b33131284968d8969ae054ed0d/run.sh#L11

---

_Comment by @carrollpaul on 2025-01-14 22:49_

Ah, that seems to have something to do with it. Removing the `backend` volume from the docker-compose led to a new, separate error:
```
backend-1 exited with code 1
2025-01-14 17:47:02 exec /app/.venv/bin/fastapi: no such file or directory
```

---

_Comment by @zanieb on 2025-01-14 22:51_

That error usually indicates the `python` executable referenced by the virtual environment has moved and can't be found. Opaque I know, but this is the Python shebang for installing package entrypoints and we have little control. Try `cat /app/.venv/bin/fastapi` to see what it's looking for (or, if that's missing entirely I've misdiagnosed the problem).

---

_Comment by @carrollpaul on 2025-01-14 22:56_

```
backend-1   | #!/app/.venv/bin/python
backend-1   | # -*- coding: utf-8 -*-
backend-1   | import re
backend-1   | import sys
backend-1   | from fastapi.cli import main
backend-1   | if __name__ == "__main__":
backend-1   |     sys.argv[0] = re.sub(r"(-script\.pyw|\.exe)?$", "", sys.argv[0])
backend-1   |     sys.exit(main())
backend-1 exited with code 0
```

---

_Comment by @zanieb on 2025-01-14 22:58_

Then `ls -la /app/.venv/bin/python`?

---

_Comment by @carrollpaul on 2025-01-14 23:01_

```
2025-01-14 18:00:30 lrwxrwxrwx 1 root root 76 Jan 14 23:00 /app/.venv/bin/python -> /root/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/bin/python3.10
```

---

_Comment by @zanieb on 2025-01-14 23:10_

It looks like that's referring to a uv-managed interpreter, I presume it's missing and that you want to be using the python3.12 interpreter that comes with your image?

---

_Label `question` added by @zanieb on 2025-01-14 23:10_

---

_Comment by @carrollpaul on 2025-01-14 23:14_

Yes, that's correct

---

_Comment by @zanieb on 2025-01-14 23:17_

It's not clear from your example why that would not be the case. Is the `.venv` in your `dockerignore` file too?

---

_Comment by @carrollpaul on 2025-01-14 23:20_

Ah, I had a `.python-version` file in my project with `3.10` for some reason. Removing that seems to get things working!

---

_Comment by @zanieb on 2025-01-14 23:22_

Wonderful! Feel free to ask if you have more problems.

---

_Closed by @zanieb on 2025-01-14 23:22_

---

_Comment by @carrollpaul on 2025-01-14 23:26_

Thanks for your patience and assistance!

---

_Referenced in [astral-sh/uv#11454](../../astral-sh/uv/issues/11454.md) on 2025-02-12 17:04_

---
