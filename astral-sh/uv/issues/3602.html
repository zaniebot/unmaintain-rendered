<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip compile --upgrade` can fail when `uv pip compile` succeeds if `requirements.txt` contains pre-release - astral-sh/uv #3602</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv pip compile --upgrade` can fail when `uv pip compile` succeeds if `requirements.txt` contains pre-release</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/3602">#3602</a>
        opened by <a href="https://github.com/Phlogistique">@Phlogistique</a>
        on 2024-05-15 08:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Phlogistique">@Phlogistique</a> on 2024-05-15 08:15</div>
            <div class="timeline-body"><p>My <code>requirements.in</code> contains a package which depends on <code>betterproto&gt;=2.0.0b6</code>. The <code>requirements.txt</code> was initially generated using <code>pip</code> and contains <code>betterproto==2.0.0b6</code>.</p>
<p>Running <code>uv pip compile</code> works, but <code>uv pip compile --upgrade</code> refuses to pick up that pre-release version, and therefore fails resolution.</p>
<p>I would think it would be more intuitive for either:</p>
<ul>
<li><code>uv pip compile</code> to fail if any pre-release version is already in <code>requirements.txt</code>, or</li>
<li><code>uv pip compile --upgrade</code> to accept pre-releases if they are already in <code>requirements.txt</code></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-15 14:50</div>
            <div class="timeline-body"><p>I think &quot;<code>uv pip compile --upgrade</code> to accept pre-releases if they are already in <code>requirements.txt</code>&quot; does make sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-05-15 14:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-16 16:54</div>
            <div class="timeline-body"><p>I would probably say the same of yanked packages... If you run with <code>--upgrade</code>, and your lockfile uses a yanked package, we should probably allow you to continue using it...?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-17 02:03</div>
            <div class="timeline-body"><p>That's a little more dubious imo. If something is yanked you ought to be pushed to resolve it. If you want to keep using the yanked version you should have to pin? Can we consider that separately? (see #3644)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-17 13:59</div>
            <div class="timeline-body"><p>Yeah that's fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3644.html">astral-sh/uv#3644</a> on 2024-05-17 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5729.html">astral-sh/uv#5729</a> on 2024-08-02 15:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:58 UTC
    </footer>
</body>
</html>
