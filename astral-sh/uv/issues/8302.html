<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create best practice example of uv workspace for vscode supporting tests and more - astral-sh/uv #8302</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Create best practice example of uv workspace for vscode supporting tests and more</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/8302">#8302</a>
        opened by <a href="https://github.com/NixBiks">@NixBiks</a>
        on 2024-10-17 19:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/NixBiks">@NixBiks</a></div>
            <div class="timeline-body"><p>I&#x27;m working on a monorepo and trying to make a good developer setup in vscode. I think my use case is pretty common so I&#x27;m wondering if it would make sense to create a &quot;best practice&quot; example.</p>
<p>I hope the example supports the following</p>
<ul>
<li>[ ]  tests for each app/lib</li>
<li>[ ]  ability to run tests in a &quot;synced&quot; environment for each particular app/lib - current workaround would be something like <code>uv sync --package a &amp;&amp; uv run --package a --directory packages/a pytest</code></li>
<li>[ ] add coverage for each app/lib</li>
<li>[ ] support testing interface in vscode</li>
<li>[ ] support devcontainer in vscode</li>
<li>[ ] support docker containerization for the apps</li>
<li>[ ] maybe exploit vscode workspaces</li>
</ul>
<p>I imagine the root is not really a package itself but simply configuring the workspace</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AndreuCodina">@AndreuCodina</a> on 2024-10-17 23:11</div>
            <div class="timeline-body"><p>I can help, but TBH I&#x27;m tired of DevContainer. It crashes after each Docker update.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NixBiks">@NixBiks</a> on 2024-10-18 04:39</div>
            <div class="timeline-body"><blockquote>
<p>I can help, but TBH I&#x27;m tired of DevContainer. It crashes after each Docker update.</p>
</blockquote>
<p>Great. Devcontainer can be left out too</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thorbenk">@thorbenk</a> on 2024-10-18 12:58</div>
            <div class="timeline-body"><p>Also see <a href="https://github.com/astral-sh/uv/issues/6786">astral-sh/uv#6786</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NixBiks">@NixBiks</a> on 2024-10-18 13:59</div>
            <div class="timeline-body"><p>I&#x27;ve created this repo for a start: https://github.com/NixBiks/uv-monorepo-template</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AndreuCodina">@AndreuCodina</a> on 2024-10-21 20:23</div>
            <div class="timeline-body"><p>https://github.com/AndreuCodina/python-monorepo</p>
<ul>
<li><p>I&#x27;ve created a monorepo with 2 deployable projects (<code>api</code> and <code>transcriber</code>).</p>
</li>
<li><p>WIP, but I have doubts about how I should organize the workspace members and at the same time support Jupyter notebooks.</p>
</li>
<li><p><code>transcriber</code> is not a library, so it doesn&#x27;t have <code>py.typed</code>, but then when I import code from the notebook, I receive the message <code>Stub file not found for &quot;transcriber.transcriber_printer&quot;</code>, and I only can fix it adding the <code>py.typed</code> or adding <code>extraPaths</code>:</p>
<pre><code>[tool.pyright]
typeCheckingMode = &quot;strict&quot;
extraPaths = [&quot;transcriber/src/&quot;]
</code></pre>
<p>I dislike both options:</p>
</li>
<li><p>Each package has its own <code>src</code> and <code>tests</code>, so I need the package <code>test_utils</code> to share builders, etc.</p>
</li>
<li><p>I could save all packages in a <code>src</code> folder, but there&#x27;re so many <code>src</code> folders, so I don&#x27;t know, and it&#x27;s strange for me to split libraries and applications, so for the moment I&#x27;m putting the projects in the root, as in .NET.</p>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TheRealBecks">@TheRealBecks</a> on 2024-12-10 15:23</div>
            <div class="timeline-body"><p>Also see #8737</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mgrinshpon">@mgrinshpon</a> on 2024-12-22 13:44</div>
            <div class="timeline-body"><p>@AndreuCodina @NixBiks how are your monorepo designs able to install all packages for all modules without dev containers?</p>
<p>The only workaround I&#x27;d been able to find is to add all modules as sources and add them as dev dependencies in the top level project while disabling package building for the top level dir at the top level monorepo:</p>
<pre><code>[tool.uv]
package = false
</code></pre>
<p>This repo is doing the same thing https://github.com/JasperHG90/uv-monorepo but by making every project a source, <code>uv sync --all-extras</code> now installs all dependencies for the entire repo which is nice for moving between projects rapidly. It also massively reduces the boilerplate per-project. Unfortunately, dependency hierarchies are no longer strictly enforced which feels wrong.</p>
<p>FWIW this all works flawlessly in PyCharm and sort-of in zed.dev but enabling teammates on VSCode, Cursor, and Windsurf without import errors is the remaining struggle.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matthewadams">@matthewadams</a> on 2025-01-30 13:55</div>
            <div class="timeline-body"><p>You might be interested in <a href="https://github.com/astral-sh/uv/issues/10960">astral-sh/uv#10960</a></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:34:51 UTC
    </footer>
</body>
</html>
