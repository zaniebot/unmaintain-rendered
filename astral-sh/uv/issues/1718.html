<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip compile` error message not readable. - astral-sh/uv #1718</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv pip compile</code> error message not readable.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1718">#1718</a>
        opened by <a href="https://github.com/Czaki">@Czaki</a>
        on 2024-02-19 20:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Czaki">@Czaki</a> on 2024-02-19 20:14</div>
            <div class="timeline-body"><p>I try to play with <code>--resolution=lowest</code> for minimum requirements testing.
However, it fails with following traceback. As the same command passes with <code>resolution=lowest-direct</code> it looks like there is a problem with some indirect dependecy dependecies not pinning setuptools to proer version.</p>
<p>However traceback do not consin any information about dependecy path to problematic package.
It will be nice to add such information. It will be also nice to not try using python2 only packages.</p>
<pre><code class="language-bash">uv pip compile -p 3.8 -o resources/constraints/constraints_py3.8_min_req.txt pyproject.toml --extra testing --extra pyqt5 --resolution=lowest -U       
error: Failed to download and build: setuptools==0.7.2
  Caused by: Failed to build: setuptools==0.7.2
  Caused by: Build backend failed to determine extra requires with `build_wheel()`:
--- stdout:

--- stderr:
Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 4, in &lt;module&gt;
  File &quot;/home/czaki/.cache/uv/built-wheels-v0/pypi/setuptools/0.7.2/50gYfHetQiLPzvTHRj8sH/setuptools-0.7.2.tar.gz/setuptools/__init__.py&quot;, line 2, in &lt;module&gt;
    from setuptools.extension import Extension, Library
  File &quot;/home/czaki/.cache/uv/built-wheels-v0/pypi/setuptools/0.7.2/50gYfHetQiLPzvTHRj8sH/setuptools-0.7.2.tar.gz/setuptools/extension.py&quot;, line 5, in &lt;module&gt;
    from setuptools.dist import _get_unpatched
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 991, in _find_and_load
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 975, in _find_and_load_unlocked
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 671, in _load_unlocked
  File &quot;/home/czaki/.cache/uv/.tmpYy6E4Q/.venv/lib/python3.8/site-packages/_virtualenv.py&quot;, line 91, in exec_module
    old(module)
  File &quot;/home/czaki/.cache/uv/built-wheels-v0/pypi/setuptools/0.7.2/50gYfHetQiLPzvTHRj8sH/setuptools-0.7.2.tar.gz/setuptools/dist.py&quot;, line 103
    except ValueError, e:
                     ^
SyntaxError: invalid syntax
---                
</code></pre>
<p>The pyproject toml used as input is available here:
https://github.com/napari/napari/pull/6673</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-19 20:14</div>
            <div class="timeline-body"><p>What version of <code>uv</code> are you on?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Czaki">@Czaki</a> on 2024-02-19 20:16</div>
            <div class="timeline-body"><p>uv 0.1.5</p>
<p>(maybe for lowest resolution it may be nice to provide barier date to not get packages older than a given date, with exception for packages that do not have newer release).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2024-02-19 20:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-02-20 04:21</div>
            <div class="timeline-body"><blockquote>
<p>It will be also nice to not try using python2 only packages</p>
</blockquote>
<p>That's the fun thing about sdists, at least for now, you can't tell what they're compatible with until you try to build them!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-20 04:25</div>
            <div class="timeline-body"><p>Yeah I don't think there's any way for us to know that unfortunately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Czaki">@Czaki</a> on 2024-02-20 08:36</div>
            <div class="timeline-body"><p>Maybe you could use python classifier provided by package?</p>
<p>For example for setuptools 0.7.2 provides information that is compatible up to python 3.3 so maybe should not be checked for python 3.8?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hmc-cs-mdrissi">@hmc-cs-mdrissi</a> on 2024-02-20 09:01</div>
            <div class="timeline-body"><p>Python classifiers are not very useful beyond as documentation metadata the author put of we expect it to support this version. Except for many packages (especially most pure python ones), they usually support newer python versions just fine. And many packages don't have classifiers in first place. I think today classifiers do not effect resolution at all for other python resolvers, and heuristics here would likely throw out a lot of valid solutions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Czaki">@Czaki</a> on 2024-02-20 09:16</div>
            <div class="timeline-body"><p>I do not know any python resolver that supports <code>lowest</code> mode. Many packages do not specify lower bound.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-20 09:21</div>
            <div class="timeline-body"><p>We should exempt unconstrained build dependencies from using the lowest version, otherwise we'll break everyone using a plain <code>setuptools</code> as build backend.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-20 13:57</div>
            <div class="timeline-body"><p>@konstin - this must be a direct dependency, right? We don’t propagate resolution-lowest to build dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-20 13:57</div>
            <div class="timeline-body"><p>In which case, it’s kind of… correct, to fail here? Since the markers are incorrect. The package doesn’t work with arbitrary setuptools versions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-02-20 14:08</div>
            <div class="timeline-body"><p>I assumed reading this thread that error was indeed correct, as testing the lowest resolution will mostly be revealing failing builds.</p>
<p>I thought the ask here from OP is that when a package build fails, to show the dependency chain of how uv got to that package, so the appropriate requirements can be added.</p>
<p>In general though I think users are going to find task of creating requirements that work on lowest resolution very tough, without specifying every transitive dependency. The ecosystem has never had good tooling around this, so very few maintainers add lower bound requirements unless they have a specific reason.</p>
<p>It depends on the motivation of the user, but it may make sense to build a lower bounds constraints file rather than an extensive requirements file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv pip compile` erro message not readable." to "`uv pip compile` error message not readable." by @Czaki on 2024-02-20 14:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-20 15:08</div>
            <div class="timeline-body"><blockquote>
<p>this must be a direct dependency, right? We don’t propagate resolution-lowest to build dependencies.</p>
</blockquote>
<p>Indeed! I think we should warn when we encounter dependencies with now lower limit and <code>--resolution=lowest</code> is set, hinting the user at defining a lower limit themselves.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-09-09 00:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-09 00:57</div>
            <div class="timeline-body"><p>Closing as we've added more warnings here.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:28 UTC
    </footer>
</body>
</html>
