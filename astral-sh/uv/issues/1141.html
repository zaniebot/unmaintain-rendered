<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Re-enable ARM Windows builds in release pipeline - astral-sh/uv #1141</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Re-enable ARM Windows builds in release pipeline</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1141">#1141</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-27 01:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-27 01:10</div>
            <div class="timeline-body"><p>See: https://github.com/astral-sh/puffin/actions/runs/7673412766 (failure to build <code>libgit2</code>).</p>
<p>See: https://github.com/astral-sh/puffin/actions/runs/7673603363 (failure to build <code>libgit2</code>, even after enabling vendoring).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-01-27 01:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-01-27 10:52</div>
            <div class="timeline-body"><p>Does this mean we want support aarch64 windows? Then we need e.g. launcher binaries and some testing that puffin actually works.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-27 11:24</div>
            <div class="timeline-body"><p>I'll turn this into a more general issue. This was just about getting CI building but that makes sense. I assume I should similarly disable the i686 Windows then?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @charliermarsh on 2024-01-29 03:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2024-01-29 03:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-01-30 17:50</div>
            <div class="timeline-body"><p>I don't understand which of the errors was the fatal one. On linux with  <code>cargo xwin build --target x86_64-pc-windows-msvc</code>, libgit2 compile but then the linking fails with</p>
<pre><code>lld-link: error: could not open 'msvcrtd.lib': No such file or directory
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/messense">@messense</a> on 2024-03-28 08:39</div>
            <div class="timeline-body"><p>@konstin This is because <code>cargo-xwin</code> does not keep debug libs by default, you can pass <code>--xwin-include-debug-libs</code> to keep them, or build in release mode instead.</p>
<p>FYI, <code>msvcrtd.dll</code> is a &quot;debug&quot;-version of the file <code>msvcrt.dll</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-28 08:58</div>
            <div class="timeline-body"><p>Thank you, release mode indeed works!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-05-14 03:31</div>
            <div class="timeline-body"><p>Any plans here? Did it just need to be built in release mode? Windows ARM is another platform cibuildwheel supports. I also have a Windows ARM dev box that I'd like to be able to use uv on. :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-05-14 08:51</div>
            <div class="timeline-body"><p>The trampolines are <a href="https://github.com/astral-sh/uv/tree/12a96ad4227b82420443d80e19ea997af27f7284/crates/uv-trampoline/trampolines">committed</a> and <a href="https://github.com/astral-sh/uv/blob/ad99e3af631ff90b8aefa4544ae2a5bdaea23788/crates/install-wheel-rs/src/wheel.rs#L172-L179">ready</a>. Last time we were investigating arm windows we were told that not even microsoft themselves properly support it, so we just haven't made CI builds for a priority.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matterhorn103">@matterhorn103</a> on 2024-09-18 08:29</div>
            <div class="timeline-body"><p>If you guys would be helped at all by someone testing or compiling on a Windows ARM machine, I have one and am happy to help!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/darthtrevino">@darthtrevino</a> on 2024-10-17 16:30</div>
            <div class="timeline-body"><p>So with the advent of the Snapdragon X chips, we're seeing Windows ARM machines become more commonplace. Older ARM chips were pretty lame, but they're dramatically improving, and dev ecosystem support is too. I have one team member who uses Windows ARM as their personal dev machine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-17 21:59</div>
            <div class="timeline-body"><p>If someone wants to put some effort into getting an ARM build working I'm all for it. I think we could start with something low impact like the #8269 build then move to distributing releases as a secondary goal.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kalradivyanshu">@kalradivyanshu</a> on 2025-01-04 20:54</div>
            <div class="timeline-body"><p>@zanieb can you give me some guidance on how to go about it? I have a snapdragon laptop and heavily use UV, would love to contribute.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-04 21:55</div>
            <div class="timeline-body"><p>@kalradivyanshu</p>
<p>I added a runner called <code>github-windows-11-aarch64-4</code> to the org. I think the idea would basically be to copy the following job with the aarch64 runner and call it <code>build-binary-windows-aarch64</code> (as we do for macOS)</p>
<p>https://github.com/astral-sh/uv/blob/9d417da4e19b590e1026fb65014facbcb28707da/.github/workflows/ci.yml#L529-L560</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kalradivyanshu">@kalradivyanshu</a> on 2025-01-05 10:28</div>
            <div class="timeline-body"><p>So @zanieb basically, I need to clone the uv repo, run the steps to build it on my local machine, fix any bugs, and then write: https://github.com/astral-sh/uv/blob/9d417da4e19b590e1026fb65014facbcb28707da/.github/workflows/ci.yml#L529-L560 for windows arm?</p>
<p>Is this the right approach?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-05 17:07</div>
            <div class="timeline-body"><p>That sounds correct to me, yep!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kalradivyanshu">@kalradivyanshu</a> on 2025-01-05 18:58</div>
            <div class="timeline-body"><p>Ok @zanieb I was able to get <code>uv</code> installed for arm, and then after downloading python for arm windows, everything seems to be working fine, all I had to do was get clang, arm visual studio installed -&gt; rust installed -&gt; clone uv -&gt; <code>cargo build --release --target aarch64-pc-windows-msvc</code></p>
<p>It worked without any bugs/hiccups.</p>
<p>Do you think:</p>
<pre><code> build-binary-windows-arm:
    needs: determine_changes
    timeout-minutes: 10
    if: ${{ github.repository == 'astral-sh/uv' &amp;&amp; !contains(github.event.pull_request.labels.*.name, 'no-test') &amp;&amp; (needs.determine_changes.outputs.code == 'true' || github.ref == 'refs/heads/main') }}
    runs-on:
      labels: windows-latest-large
    name: &quot;build binary | windows&quot;
    steps:
      - uses: actions/checkout@v4

      - name: Create Dev Drive using ReFS
        run: ${{ github.workspace }}/.github/workflows/setup-dev-drive.ps1

      # actions/checkout does not let us clone into anywhere outside ${{ github.workspace }}, so we have to copy the clone...
      - name: Copy Git Repo to Dev Drive
        run: |
          Copy-Item -Path &quot;${{ github.workspace }}&quot; -Destination &quot;${{ env.UV_WORKSPACE }}&quot; -Recurse

      - uses: Swatinem/rust-cache@v2
        with:
          workspaces: ${{ env.UV_WORKSPACE }}

      - name: &quot;Build&quot;
        working-directory: ${{ env.UV_WORKSPACE }}
        run: cargo build --release --target aarch64-pc-windows-msvc

      - name: &quot;Upload binary&quot;
        uses: actions/upload-artifact@v4
        with:
          name: uv-windows-${{ github.sha }}
          path: ${{ env.UV_WORKSPACE }}/target/debug/uv.exe
          retention-days: 1
</code></pre>
<p>will work? Will <code>run: ${{ github.workspace }}/.github/workflows/setup-dev-drive.ps1</code> have rust for windows arm, or will that need to be modified?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-05 19:09</div>
            <div class="timeline-body"><p>Feel free to just post the PR and we can see if CI works.</p>
<pre><code>    runs-on:
      labels: windows-latest-large
    name: &quot;build binary | windows&quot;
</code></pre>
<p>You need to change the <code>runs-on</code> to the arm runner and add <code>aarch64</code> to the name. We prefer <code>aarch64</code> over <code>arm</code>, as it's the official terminology.</p>
<blockquote>
<p>Will run: ${{ github.workspace }}/.github/workflows/setup-dev-drive.ps1 have rust for windows arm, or will that need to be modified?</p>
</blockquote>
<p>Presumably it will work â€” if not we can just drop the dev-drive.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kalradivyanshu">@kalradivyanshu</a> on 2025-01-05 19:28</div>
            <div class="timeline-body"><p>@zanieb Can you tell me the label for windows aarch64 runner? According to this https://github.blog/news-insights/product-news/arm64-on-github-actions-powering-faster-more-efficient-build-systems/#get-started-using-arm-hosted-runners-today and https://www.youtube.com/watch?v=cgI6SBP8pEM it is only available to enterprise github accounts, does <code>uv</code> have access?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-05 19:42</div>
            <div class="timeline-body"><p>I set one up, see https://github.com/astral-sh/uv/issues/1141#issuecomment-2571421457</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kalradivyanshu">@kalradivyanshu</a> on 2025-01-05 19:52</div>
            <div class="timeline-body"><p>@zanieb , can you take a look at this https://github.com/astral-sh/uv/pull/10306?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-01-24 15:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:29:59 UTC
    </footer>
</body>
</html>
