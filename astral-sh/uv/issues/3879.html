<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using build as tool fails while pipx suceeds - astral-sh/uv #3879</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using build as tool fails while pipx suceeds</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/3879">#3879</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-05-28 13:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>When trying to build https://github.com/konstin/transformers/tree/konsti/repr-for-uv (4b33866235c546f4cd602c6e11efe3cc167b289b), <code>pipx run build --installer uv .</code> passes, while <code>uv tool run --from build python -m build --installer uv .</code> fails with:</p>
<pre><code>Resolved 3 packages in 1ms
Installed 3 packages in 2ms
 + build==1.2.1
 + packaging==24.0
 + pyproject-hooks==1.1.0
* Creating isolated environment: venv+uv...
* Using external uv from /home/konsti/.cargo/bin/uv
* Installing packages in isolated environment:
  - hatchling
* Getting build dependencies for sdist...
* Building sdist...

Traceback (most recent call last):
  File &quot;/home/konsti/projects/transformers/.uv/.tmpyXHcNs/lib/python3.12/site-packages/build/__main__.py&quot;, line 178, in _handle_build_error
    yield
  File &quot;/home/konsti/projects/transformers/.uv/.tmpyXHcNs/lib/python3.12/site-packages/build/__main__.py&quot;, line 429, in main
    built = build_call(
            ^^^^^^^^^^^
  File &quot;/home/konsti/projects/transformers/.uv/.tmpyXHcNs/lib/python3.12/site-packages/build/__main__.py&quot;, line 276, in build_package_via_sdist
    t.extractall(sdist_out)
  File &quot;/home/konsti/.pyenv/versions/3.12.3/lib/python3.12/tarfile.py&quot;, line 2261, in extractall
    tarinfo = self._get_extract_tarinfo(member, filter_function, path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/konsti/.pyenv/versions/3.12.3/lib/python3.12/tarfile.py&quot;, line 2315, in _get_extract_tarinfo
    self._handle_fatal_error(e)
  File &quot;/home/konsti/.pyenv/versions/3.12.3/lib/python3.12/tarfile.py&quot;, line 2313, in _get_extract_tarinfo
    tarinfo = filter_function(tarinfo, path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/konsti/.pyenv/versions/3.12.3/lib/python3.12/tarfile.py&quot;, line 828, in data_filter
    new_attrs = _get_filtered_attrs(member, dest_path, True)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/konsti/.pyenv/versions/3.12.3/lib/python3.12/tarfile.py&quot;, line 805, in _get_filtered_attrs
    raise AbsoluteLinkError(member)
tarfile.AbsoluteLinkError: &#x27;transformers-4.39.0.dev0/.uv/.tmpyXHcNs/bin/python&#x27; is a link to an absolute path

ERROR &#x27;transformers-4.39.0.dev0/.uv/.tmpyXHcNs/bin/python&#x27; is a link to an absolute path
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by <a href="https://github.com/konstin">@konstin</a> on 2024-05-28 13:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/njzjz">@njzjz</a> on 2024-06-10 21:12</div>
            <div class="timeline-body"><p>For my build backend, this can be resolved by adding <code>.uv</code> into <code>.gitignore</code>. I think uv should add a <code>gitignore</code> file like ruff: <a href="https://github.com/astral-sh/ruff/pull/208">astral-sh/ruff#208</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-10 21:16</div>
            <div class="timeline-body"><p>Yes I can fix that separately. Can you file another issue? Can be very brief / short.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> removed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-20 18:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-14 18:57</div>
            <div class="timeline-body"><p>Can&#x27;t reproduce this anymore, and we changed python symlink path handling that has probably fixed it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2025-01-14 18:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:31:17 UTC
    </footer>
</body>
</html>
