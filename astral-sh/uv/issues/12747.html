<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV implementation with Base and app lock/requirement files - astral-sh/uv #12747</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>UV implementation with Base and app lock/requirement files</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/12747">#12747</a>
        opened by <a href="https://github.com/ihelmer07">@ihelmer07</a>
        on 2025-04-08 16:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ihelmer07">@ihelmer07</a> on 2025-04-08 16:32</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I am trying to transition to uv from pip.
We have multiple (40+) custom apps that all share a common core of dependencies.
I want those common dependencies to be listed in a central repo so I can preinstall into the base docker image, as well as make things easier to upgrade (one upgrade spot vs 40).</p>
<p>I can't figure out how to support this set up.
<code>uv lock</code> are out it seems.</p>
<p>I can use <code>uv pip compile -o app.lock pyproject.toml</code> to generate an app.lock file based on the dependencies listed in the pyproject.toml.
However that pyproject.toml is misleading as it only can have the app dependencies listed, as listing the common dependencies in the pyproject.toml causes the requirements generated to include the common.</p>
<p>Can anyone help me out?</p>
<h3>Platform</h3>
<p>Ubuntu</p>
<h3>Version</h3>
<p>0.6.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @ihelmer07 on 2025-04-08 16:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-08 17:12</div>
            <div class="timeline-body"><p>So, you want to generate a combined list of all your direct dependencies (but not transitive dependencies) for all of your projects?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ihelmer07">@ihelmer07</a> on 2025-04-08 17:53</div>
            <div class="timeline-body"><p>I believe so, although I'm likely unknowing of the nuance.</p>
<p>For example:
base requirements for all apps:</p>
<pre><code>#base.txt
- django
- celery
- django-storages

#app A requirement
-r base.txt
- polars

#app B requirement:
-r base.txt
- anotherlib
</code></pre>
<p>I use the <code>-r</code> functionality today using pip.
however I'm trying to translate that to the uv framework, which doesn't seem possible as <code>uv sync</code></p>
<p><code>base.txt</code> is in a central repo so a dedicated team can maintain it.
the app teams have their own <code>app.txt</code> which they can add to, but <code>base.txt</code> is 'fixed' for them.</p>
<p>I don't believe uv supports this structure with <code>uv sync</code> or <code>uv lock</code>. so i'm investigting if <code>uv pip compile</code> can.
or do I force the app teams to update <code>app.txt</code> manually and skip the <code>pyproject.toml</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-08 18:09</div>
            <div class="timeline-body"><p><code>uv pip compile</code> supports references with <code>-r</code>, yeah. You'd have...</p>
<p><code>base.in</code></p>
<pre><code>foo
bar
</code></pre>
<p><code>appA.in</code></p>
<pre><code>-r base.in
foobar
</code></pre>
<p>then <code>uv pip compile appA.in -o appA.txt</code> to lock requirements for an application</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ihelmer07">@ihelmer07</a> on 2025-04-08 18:13</div>
            <div class="timeline-body"><p>Makes sense - but I wouldn't be able to use the pyproject.toml dependancies, <code>uv sync</code> or <code>uv lock</code> commands and still achieve this same functionality?
Or is there a way?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-08 18:15</div>
            <div class="timeline-body"><p>You could also do <code>uv pip compile appA/pyproject.toml -o appA.txt</code></p>
<p>I'm not sure I fully understand what you want though.</p>
<p>You could add a <code>base/pyproject.toml</code> then in <code>appA/pyproject.toml</code> just create a dependency on <code>base</code> (e.g., <code>uv add ../base</code>)  â€” then you'd have those dependencies in <code>appA</code> and could use <code>uv sync</code> etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ihelmer07">@ihelmer07</a> on 2025-04-09 01:21</div>
            <div class="timeline-body"><p>@zanieb - what you described was super helpful. I never considered having a <code>base/pyproject.toml</code> and have the <code>app/pyproject.toml</code> depend on base so thanks for the suggestion.
That's exactly what I needed.
Time to fully implement <code>uv</code> everywhere.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ihelmer07 on 2025-04-09 01:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @ihelmer07 on 2025-04-09 21:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:27 UTC
    </footer>
</body>
</html>
