<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv.lock` has superfluous changes after running `uv run` - astral-sh/uv #4274</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv.lock` has superfluous changes after running `uv run`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/4274">#4274</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2024-06-12 15:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-06-12 15:15</div>
            <div class="timeline-body"><p>To reproduce:</p>
<pre><code>$ git clone https://github.com/zanieb/packse
$ git checkout 0e8dd5f0a0b6738b4d007d7093c737f38183a0fe
$ uv run --all-extras packse serve scenarios/ --no-hash
$ git diff
diff --git a/uv.lock b/uv.lock
index a0596b9..c2cda5f 100644
--- a/uv.lock
+++ b/uv.lock
@@ -589,11 +589,6 @@ source = &quot;registry+https://pypi.org/simple&quot;

 [distribution.optional-dependencies]

-[[distribution.optional-dependencies.index]]
-name = &quot;pypiserver&quot;
-version = &quot;2.1.1&quot;
-source = &quot;registry+https://pypi.org/simple&quot;
-
 [[distribution.optional-dependencies.serve]]
 name = &quot;pypiserver&quot;
 version = &quot;2.1.1&quot;
@@ -604,6 +599,11 @@ name = &quot;watchfiles&quot;
 version = &quot;0.22.0&quot;
 source = &quot;registry+https://pypi.org/simple&quot;

+[[distribution.optional-dependencies.index]]
+name = &quot;pypiserver&quot;
+version = &quot;2.1.1&quot;
+source = &quot;registry+https://pypi.org/simple&quot;
+
 [distribution.dev-dependencies]

 [[distribution.dev-dependencies.dev]]
</code></pre>
<p>It looks like the order of <code>optional-dependencies</code> is changing. I do not think there should be any diff here. Perhaps hashmap iteration is being used during serialization?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @BurntSushi on 2024-06-12 15:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-06-12 15:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-06-12 15:46</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 05:34:14 UTC
    </footer>
</body>
</html>
