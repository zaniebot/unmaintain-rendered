<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inconsistent behavior of format = &quot;flat&quot; between find-links and index-url in uv tool run - astral-sh/uv #16051</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Inconsistent behavior of format = &quot;flat&quot; between find-links and index-url in uv tool run</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16051">#16051</a>
        opened by <a href="https://github.com/byeblack">@byeblack</a>
        on 2025-09-28 14:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/byeblack">@byeblack</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p>I'm experiencing inconsistent behavior with <code>format = &quot;flat&quot;</code> between <code>find-links</code> and <code>index-url</code> when using <code>uv tool run</code>.</p>
<p>When installing and running an offline package using command-line flags with <code>find-links</code>, the tool fails to find the installed package:</p>
<pre><code class="language-bash">❯ uv tool install --offline -n --no-config -f temp pip@25.0
Resolved 1 package in 2ms
Prepared 1 package in 71ms
Installed 1 package in 109ms
 + pip==25.0
Installed 3 executables: pip, pip3, pip3.12

❯ uv tool run --offline -n --no-config --from pip pip --version
  × No solution found when resolving tool dependencies:
  ╰─▶ Because pip was not found in the cache and you require pip, we can conclude that your requirements are unsatisfiable.

      hint: Packages were unavailable because the network was disabled. When the network is disabled, registry packages may only be read from the cache.
</code></pre>
<p>If I continue using <code>-f</code> to specify the path, it temporarily runs the pip package from the temp directory instead of the installed one:</p>
<pre><code class="language-bash">❯ uv tool run --offline -n --no-config -f temp --from pip pip --version
Installed 1 package in 126ms
pip 25.2 ...
</code></pre>
<p>However, when using a <code>uv.toml</code> configuration file with <code>index-url</code> and <code>format = &quot;flat&quot;</code>, everything works correctly:</p>
<pre><code class="language-toml"># uv.toml
[[index]]
name = &quot;local&quot;
url = 'temp'
format = &quot;flat&quot;
</code></pre>
<pre><code class="language-bash">❯ uv tool install --offline -n --config-file uv.toml pip@25.0
Resolved 1 package in 2ms
Prepared 1 package in 71ms
Installed 1 package in 109ms
 + pip==25.0
Installed 3 executables: pip, pip3, pip3.12

❯ uv tool run --offline -n --config-file uv.toml --from pip pip --version
pip 25.0 from ...
</code></pre>
<p>Comparing the <code>uv-receipt.toml</code> files reveals the difference:</p>
<pre><code class="language-toml"># From: uv tool install --offline -n --no-config -f temp pip@25.0
[tool.options]
find-links = [&quot;...&quot;]
</code></pre>
<pre><code class="language-toml"># From: uv tool install --offline -n --config-file uv.toml pip@25.0
[tool.options]
index = [
    { name = &quot;local&quot;, url = &quot;...&quot;, explicit = false, default = false, format = &quot;flat&quot;, authenticate = &quot;auto&quot; },
]
</code></pre>
<p>In my opinion, The behavior should be consistent between these two approaches.</p>
<h3>Platform</h3>
<p>Windows 11 x86_64</p>
<h3>Version</h3>
<p>uv 0.8.22 (ade2bdbd2 2025-09-23)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @byeblack on 2025-09-28 14:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "I'm experiencing inconsistent behavior with `format = "flat"` between `find-links` and `index-url` when using `uv tool run`." to "Inconsistent behavior of format = "flat" between find-links and index-url in uv tool run" by @byeblack on 2025-09-28 14:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-09-28 18:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2025-09-28 18:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-09-29 17:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:33:01 UTC
    </footer>
</body>
</html>
