<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv` attempts to install the newer version if one has been released while `uv` is running. - astral-sh/uv #14885</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv</code> attempts to install the newer version if one has been released while <code>uv</code> is running.</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/14885">#14885</a>
        opened by <a href="https://github.com/babinskiy">@babinskiy</a>
        on 2025-07-25 08:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/babinskiy">@babinskiy</a> on 2025-07-25 08:45</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have a project with the NumPy package, and the version of NumPy is not pinned.</p>
<p>Recently, I encountered an issue when a new version of NumPy was issued and published while I was running a CI where uv was building the project dependencies. uv built NumPy 2.3.1 (the latest at the start of the build) but then attempted to install NumPy 2.3.2, which was released during the build.</p>
<pre><code>  Downloading pycryptodome (2.2MiB)
  Downloading pycryptodomex (2.2MiB)
  Downloading brotli (2.8MiB)
  Downloading scipy (35.6MiB)
   Downloaded pycryptodomex
   Downloaded brotli
   Downloaded pycryptodome
   Downloaded scipy
     Building numpy==2.3.1
        Built numpy==2.3.1
  Prepared 14 packages in 2m 16s
  Installed 14 packages in 13ms
   + brotli==1.1.0
   + inflate64==1.0.3
   + multivolumefile==0.2.3
   + numpy==2.3.1
   + psutil==7.0.0
   + py7zr==1.0.0
   + pybcj==1.0.6
   + pycryptodome==3.23.0
   + pycryptodomex==3.23.0
   + pyppmd==1.2.0
   + pyzstd==0.17.0
   + scipy==1.15.3
   + texttable==1.7.0
   + typing-extensions==4.14.1
  error: Distribution `numpy==2.3.2 @ registry+[https://pypi.org/simple`](https://pypi.org/simple%60) can't be installed because it doesn't have a source distribution or wheel for the current platform

  hint: You're on Linux (`manylinux_2_26_x86_64`), but `numpy` (v2.3.2) only has wheels for the following platforms: `manylinux_2_27_aarch64`, `manylinux_2_27_x86_64`, `manylinux_2_28_aarch64`, `manylinux_2_28_x86_64`, `musllinux_1_2_aarch64`, `musllinux_1_2_x86_64`, `macosx_10_13_x86_64`, `macosx_11_0_arm64`, `macosx_14_0_arm64`, `macosx_14_0_x86_64`, `win32`, `win_amd64`, `win_arm64`
</code></pre>
<h3>Platform</h3>
<p>Amazon Linux 2</p>
<h3>Version</h3>
<p>uv 0.7.3</p>
<h3>Python version</h3>
<p>Python 3.12.9</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @babinskiy on 2025-07-25 08:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-25 14:21</div>
            <div class="timeline-body"><p>My guess is that this is just the result of NumPy being in a partially-uploaded state at the time you ran your command. There isn't anything we can do about this, since the upload API requires you to upload one file at a time. There's a PEP for Upload API 2.0 that would solve this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/babinskiy">@babinskiy</a> on 2025-07-25 14:55</div>
            <div class="timeline-body"><p>yes, i totally agree that it was so, but shouldn't 'uv' finish installing exactly the version that he started installing?
It can save the version that it started installing and use it on all stages</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-25 14:59</div>
            <div class="timeline-body"><p>Maybe, it's just very hard to say what happened here without being able to reproduce it or at minimum getting access to the <code>--verbose</code> logs.</p>
<p>Were you running two <code>uv</code> instances in parallel or something? I don't understand how it's possible that we'd print the list of installed packages, <em>then</em> show you that error. It doesn't really make sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/babinskiy">@babinskiy</a> on 2025-07-25 15:21</div>
            <div class="timeline-body"><p>I caught it in my CI, in a nightly build; apparently, it was running when the new NumPy version was released.
I understand that it is a rather rare occurrence, and it is difficult to reproduce.
This log is everything I have. The actual command that was running is uv pip install -r pyproject.toml --no-progress.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-25 16:00</div>
            <div class="timeline-body"><p>As Charlie notes,  there must be two uv invocations there? It doesn't make sense that we'd show that error <em>after</em> the install summary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/babinskiy">@babinskiy</a> on 2025-07-25 17:16</div>
            <div class="timeline-body"><blockquote>
<p>As Charlie notes, there must be two uv invocations there?</p>
</blockquote>
<p>Ah, I understand your point. No, it was a single uv invocation. Such a strange order is most likely caused by the CI tool, as it printed the full stdout buffer content first and then stderr.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-25 17:32</div>
            <div class="timeline-body"><p>It shouldn't be possible for uv to both display that error message <em>and</em> the install summary, regardless of the ordering.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/babinskiy">@babinskiy</a> on 2025-07-28 10:06</div>
            <div class="timeline-body"><p>I see.
Actually, the CI script makes several uv invocations, one by one, in an isolated environment. There is no way to run another instance of uv in that environment.</p>
<p>By the way, I noticed that NumPy 2.3.1 was reported as installed in the run summary. Therefore, I have no idea where NumPy 2.3.2 came from.
It looks rather ambiguous, and considering that I have a rather old version of uv in my CI, the issue could be negligible.</p>
<p>I apologize for taking up your time.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:05 UTC
    </footer>
</body>
</html>
