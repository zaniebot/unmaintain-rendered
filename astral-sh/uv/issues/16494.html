<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>build system requirements not properly resolved - astral-sh/uv #16494</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>build system requirements not properly resolved</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/16494">#16494</a>
        opened by <a href="https://github.com/nschloe">@nschloe</a>
        on 2025-10-29 12:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/nschloe">@nschloe</a> on 2025-10-29 12:21</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I try to <code>uv build .</code> a local package that has</p>
<pre><code class="language-toml">[build-system]
build-backend = &quot;foo.build_meta&quot;
requires = [
  &quot;foo&gt;=0.1a2&quot;,
]
</code></pre>
<p><code>foo</code> depends on <code>bar&gt;=0.2a7</code>. uv reports</p>
<pre><code>  ├─▶ Failed to resolve requirements from `build-system.requires`
  ├─▶ No solution found when resolving: `foo&gt;=0.1a2`
  ╰─▶ Because only bar&lt;0.2a7 is available and
      foo==0.1a2 depends on bar&gt;=0.2a7, we can
      conclude that foo==0.1a2 cannot be used.
      And because only foo&lt;=0.1a2 is available and you require
      foo&gt;=0.1a2, we can conclude that your requirements are unsatisfiable.
</code></pre>
<p>After manually adding</p>
<pre><code class="language-toml">[build-system]
build-backend = &quot;foo.build_meta&quot;
requires = [
  &quot;foo&gt;=0.1a2&quot;,
  &quot;bar&gt;=0.2a7&quot;,
]
</code></pre>
<p>it all works fine. This suggests that the build system requirements resolver is buggy. Perhaps the fact that there are alpha-versions involved plays a role here.</p>
<h3>Platform</h3>
<p>Linux 6.12.55-1-lts x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.9.5</p>
<h3>Python version</h3>
<p>all</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @nschloe on 2025-10-29 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "build system requirements not probably resolved" to "build system requirements not properly resolved" by @nschloe on 2025-10-29 12:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nschloe">@nschloe</a> on 2025-10-29 12:40</div>
            <div class="timeline-body"><p>It <em>does</em> have to do with prereleases. When doing</p>
<pre><code>uv pip install foo==0.1a2
</code></pre>
<p>on the command line, I get the same error message with the added</p>
<pre><code>      hint: `bar` was requested with a pre-release marker
      (e.g., bar&gt;=0.2a7), but pre-releases weren't enabled
      (try: `--prerelease=allow`)
</code></pre>
<p>Calling</p>
<pre><code>uv pip install foo==0.1a2 --prerelease=allow
</code></pre>
<p>does indeed work. How can I use this for building the package?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-29 14:18</div>
            <div class="timeline-body"><p>Using <code>--prerelease=allow</code> seems correct.</p>
<p>We do not allow selection of pre-releases in child packages without opt-in at the top-level.</p>
<p>See https://docs.astral.sh/uv/pip/compatibility/#pre-release-compatibility</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/16496.html">astral-sh/uv#16496</a> on 2025-10-29 14:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-10-31 01:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-31 03:55</div>
            <div class="timeline-body"><p>Per https://github.com/astral-sh/uv/issues/16496#issuecomment-3462197600 and #8192 we don't actually propagate <code>--prerelease=allow</code> to build environments, so that's not the fix. I'm not sure what is.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @zanieb on 2025-10-31 03:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-10-31 14:26</div>
            <div class="timeline-body"><p>Yeah I think right now, explicitly requesting the pre-release dependencies like that is the only solution.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:30 UTC
    </footer>
</body>
</html>
