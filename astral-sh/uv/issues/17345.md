```yaml
number: 17345
title: "Resolving `tensorrt` in macOS fails -- even with `dependency-metadata` declaration."
type: issue
state: open
author: ggoggam
labels:
  - bug
assignees: []
created_at: 2026-01-07T14:06:25Z
updated_at: 2026-01-07T14:46:14Z
url: https://github.com/astral-sh/uv/issues/17345
synced_at: 2026-01-10T01:57:37Z
```

# Resolving `tensorrt` in macOS fails -- even with `dependency-metadata` declaration.

---

_Issue opened by @ggoggam on 2026-01-07 14:06_

### Summary

I have a workspace layout **where one of the workspace member** has the following `pyproject.toml`:

```toml
[project]
name = "example"
version = "0.1.0"
description = "An example workspace member"
readme = "README.md"
requires-python = ">=3.11"
dependencies = [
    "torch-tensorrt==2.8.0+cu126; sys_platform != 'darwin'",
]

[tool.uv]
package = false
index = [
    { name = "pytorch", url = "https://download.pytorch.org/whl/cu126" }
]
dependency-metadata = [
    { name = "tensorrt", requires-dist = ["tensorrt-cu12==10.3.0"] },
    { name = "tensorrt-cu12", requires-dist = ["tensorrt-cu12-bindings==10.12.0.36", "tensorrt-cu12-libs==10.12.0.36", "tensorrt==10.12.0.36"] },
    { name = "tensorrt-cu12-libs", requires-dist = ["nvidia-cuda-runtime-cu12==12.6.77"] },
    { name = "nvidia-cuda-runtime-cu12" },
    { name = "tensorrt-cu12-bindings" }
]


[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["."]
sources = { "." = "example" }
exclude = ["**/*_test.py", "**/conftest.py"]

[tool.hatch.build.targets.sdist]
exclude = ["**/*_test.py", "**/conftest.py"]
```

Running `uv {sync,run,lock}` for universal dependency resolution fails on macOS with the following error:

```
  × Failed to build `tensorrt-cu12==10.12.0.36`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_wheel` failed (exit status: 1)

      [stderr]
      Traceback (most recent call last):
        File "<string>", line 14, in <module>
        File "~/.cache/uv/builds-v0/.tmpj1kRN4/lib/python3.11/site-packages/setuptools/build_meta.py", line 331, in
      get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "~/.cache/uv/builds-v0/.tmpj1kRN4/lib/python3.11/site-packages/setuptools/build_meta.py", line 301, in
      _get_build_requires
          self.run_setup()
        File "~/.cache/uv/builds-v0/.tmpj1kRN4/lib/python3.11/site-packages/setuptools/build_meta.py", line 512, in run_setup
          super().run_setup(setup_script=setup_script)
        File "~/.cache/uv/builds-v0/.tmpj1kRN4/lib/python3.11/site-packages/setuptools/build_meta.py", line 317, in run_setup
          exec(code, locals())
        File "<string>", line 65, in <module>
      RuntimeError: TensorRT currently only builds wheels for Linux and Windows

      hint: This usually indicates a problem with the package or the build environment.
  help: `tensorrt-cu12` (v10.12.0.36) was included because `example` (v0.1.0) depends on `torch-tensorrt==2.8.0+cu126` (v2.8.0+cu126) which
        depends on `tensorrt>=10.12.0, <10.13.0` (v10.12.0.36) which depends on `tensorrt-cu12==10.12.0.36
```

I am aware that `tensorrt` does not provide static metadata, which requires build at runtime. Following the [guide](https://docs.astral.sh/uv/concepts/resolution/#dependency-metadata) and one of the many other [issues](https://github.com/astral-sh/uv/issues/13942) regarding this, I have defined `tool.uv.dependency-metadata` like below but this does not resolve the issue:

```
dependency-metadata = [
    { name = "tensorrt", requires-dist = ["tensorrt-cu12==10.3.0"] },
    { name = "tensorrt-cu12", requires-dist = ["tensorrt-cu12-bindings==10.12.0.36", "tensorrt-cu12-libs==10.12.0.36", "tensorrt==10.12.0.36"] },
    { name = "tensorrt-cu12-libs", requires-dist = ["nvidia-cuda-runtime-cu12==12.6.77"] },
    { name = "nvidia-cuda-runtime-cu12" },
    { name = "tensorrt-cu12-bindings" }
]
```

I only need to resolve the dependency when working with the project in the macOS, nothing more. I have separate CI for resolving dependencies in linux, which I have no problem with. 

### Platform

Darwin 25.2.0 arm64

### Version

uv 0.9.22 (82a6a66b8 2026-01-06)

### Python version

3.11.14

---

_Label `bug` added by @ggoggam on 2026-01-07 14:06_

---
