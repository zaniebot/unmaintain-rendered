<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>When does `uv pip` create a `REQUESTED` file? - astral-sh/uv #13278</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>When does `uv pip` create a `REQUESTED` file?</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/13278">#13278</a>
        opened by <a href="https://github.com/notatallshaw">@notatallshaw</a>
        on 2025-05-03 18:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-05-03 18:48</div>
            <div class="timeline-body"><p>I was looking to write a small script that would be used in a one-liner with uv pip compile and uv pip sync to help people with the request in https://github.com/astral-sh/uv/issues/1419</p>
<p>I was going to do this by extracting the packages with a <code>REQUESTED</code> which was <a href="https://peps.python.org/pep-0376/#one-dist-info-directory-per-installed-distribution">introduced in PEP 376</a> but the <a href="https://packaging.python.org/en/latest/specifications/recording-installed-packages/#the-dist-info-directory">latest spec</a> says:</p>
<blockquote>
<p>The previous versions of this specification also specified a REQUESTED file. This file is now considered a tool-specific extension, but may be standardized again in the future. See <a href="https://www.python.org/dev/peps/pep-0376/#requested">PEP 376</a> for its original meaning.</p>
</blockquote>
<p>Anyway, here is a MRE script:</p>
<pre><code class="language-python">import importlib.metadata

for dist in importlib.metadata.distributions():
    requested_marker = [path for path in dist.files if path.match('*dist-info/REQUESTED')]
    if requested_marker:
        print(dist.name)
</code></pre>
<p>And when you create a fresh environment with pip in it:</p>
<pre><code>$ pip install requests
...
Successfully installed certifi-2025.4.26 charset-normalizer-3.4.2 idna-3.10 requests-2.32.3 urllib3-2.4.0

$ python requested-packages.py
pip
requests
</code></pre>
<p>And when you create a fresh environment and use uv pip:</p>
<pre><code>$ uv pip install requests
Resolved 5 packages in 56ms
Installed 5 packages in 23ms
...

$ python requested-packages.py
certifi
idna
charset-normalizer
urllib3
requests
</code></pre>
<p>I'm not sure if this is a bug and must be fixed or a design issue and should be added to the pip compatability docs?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "When does `uv pip` created a `REQUESTED` file?" to "When does `uv pip` create a `REQUESTED` file?" by @notatallshaw on 2025-05-03 18:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-04 12:37</div>
            <div class="timeline-body"><p>I think we write it for everything, based on my read of the code? I feel like we should probably <em>never</em> write it given the above -- what do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2025-05-04 12:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2025-05-04 12:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-05-04 14:28</div>
            <div class="timeline-body"><p>Well for pip compatibility you should write it only for packages the user has explicitly requested, not dependencies. Although I've not thought about the edge cases, e.g you install B and then you install A which requires a different version of B.</p>
<p>But never writing it is probably better than always writing it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pypa/pip/issues/13430.html">pypa/pip#13430</a> on 2025-06-18 20:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-09-25 13:34</div>
            <div class="timeline-body"><p>I still think uv should change it's behavior here. Either don't create a <code>REQUESTED</code> file or only create it for top level requests, not transitive dependencies.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
