<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Feature request] add option to allow UV_ENV_FILE to point to non-existing file - astral-sh/uv #9270</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Feature request] add option to allow UV_ENV_FILE to point to non-existing file</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/9270">#9270</a>
        opened by <a href="https://github.com/WouterJTB">@WouterJTB</a>
        on 2024-11-20 10:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/WouterJTB">@WouterJTB</a></div>
            <div class="timeline-body">

Problem
<p>I&#x27;d like to be able to do the following:</p>
<pre><code>export UV_ENV_FILE=./.env
uv run &lt;something&gt;
cd &lt;new repo without .env file&gt;
uv run &lt;something&gt;
</code></pre>
<p>or even better, add <code>export UV_ENV_FILE=./.env</code> to my <code>.bash_profile</code></p>
<p>Currently, uv will throw an error if <code>UV_ENV_FILE</code> doesn&#x27;t point to a valid file:</p>
<pre><code>error: No environment file found at: `./.env`
</code></pre>
Proposed solution
<p>Add a config option/env var to proceed on missing env file, e.g. proceed with <code>uv run</code> (and throw a warning instead) if <code>UV_WARN_ON_MISSING_ENV_FILE=1</code>.</p>
<p>Alternatively, maybe there&#x27;s a solution where a missing env-file is only an error if it&#x27;s passed with the <code>--env-file</code> flag, and a warning if it&#x27;s set with the <code>UV_ENV_FILE</code> var.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pszpetkowski">@pszpetkowski</a> on 2024-11-20 23:40</div>
            <div class="timeline-body"><p>I&#x27;ve stumbled upon a similar problem. Imo it would be great to just have a flag (or even default behavior) to read <code>.env</code> in the project directory if such file exists.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-22 03:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-22 03:15</div>
            <div class="timeline-body"><p>What&#x27;s the use-case that you&#x27;re trying to accomplish? You want <code>.env</code> to be read always, and ignore errors if it doesn&#x27;t exist?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WouterJTB">@WouterJTB</a> on 2024-11-22 07:12</div>
            <div class="timeline-body"><p>Essentially, yes. There&#x27;s generally some env vars that I source centrally (i.e. artifactory/docker login credentials), and some that I have in a .env file in the repo (i.e. db connection strings, mlflow tracking uri etc.), I can&#x27;t really store them centrally because the apps/libs generally look for specific var names to find and connect to the resources.</p>
<p>I&#x27;d like to be able to configure uv to use my repo scoped .env files (if found) by default, without breaking my development workflow if I switch to another repo.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pszpetkowski">@pszpetkowski</a> on 2024-11-22 12:33</div>
            <div class="timeline-body"><p>The use case I have is probably basically the same as @WouterJTB.</p>
<p>I have a <code>.zshrc</code> file that exports some common environment variables that are shared by all projects and then I have project repositories. The following situation occurs (obviously greatly simplified):</p>
<p>I maintain multiple projects with varying requirements:</p>
<ul>
<li><strong>Project A</strong> needs an environment variable <code>DATABASE_URL</code> to connect to a local database during development.</li>
<li><strong>Project B</strong> does not require any environment variables.</li>
</ul>
<p>Without additional config I have to explicitly specify an environment file for <strong>Project A</strong>:</p>
<pre><code>uv run --env-file .env cmd
</code></pre>
<p>And the following for <strong>Project B</strong>:</p>
<pre><code>uv run cmd
</code></pre>
<p>The above limits my ability to provide common Dockerfile for <strong>Project A</strong> and <strong>Project B</strong> and other tooling utilities.</p>
<p>Fortunately, I am able to provide <code>UV_ENV_FILE</code> which I actually store defined in the <code>.zshrc</code>. And all would be fine if not for the <strong>Project B</strong> which doesn&#x27;t need any environment variables and doesn&#x27;t have the <code>.env</code> file. Obviously, that explodes and the workaround I use is to simply create empty <code>.env</code> file but that&#x27;s somewhat cumbersome and adds another step after cloning the repository.</p>
Proposed Solution
<p>Enhance uv to automatically detect and load a <code>.env</code> file during uv run execution if:</p>
<ul>
<li>The <code>.env</code> file exists in the project directory.</li>
<li>No explicit <code>--env-file</code> argument is provided by the user.</li>
</ul>
<p>Alternatively, provide a configuration option through environment variable (e.g., <code>UV_AUTO_USE_DOTENV</code>?) to enable this behavior explicitly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fernandogrd">@fernandogrd</a> on 2025-06-20 16:42</div>
            <div class="timeline-body"><p>I&#x27;m using this wrapper in fish for now to implement this behavior.</p>
<pre><code>function _uv_auto_env --wraps uv
    if test -f .env
        set --export UV_ENV_FILE .env
    else
        set --erase UV_ENV_FILE
    end

    set cmd (status function)
    command $cmd $argv
end

functions -c _uv_auto_env uv
functions -c _uv_auto_env uvx
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:35:37 UTC
    </footer>
</body>
</html>
