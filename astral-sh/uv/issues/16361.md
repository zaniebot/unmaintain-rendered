```yaml
number: 16361
title: "Inconsistent behaviour of `uv add` when passing the `--group` and `-r` flag."
type: issue
state: closed
author: ale18V
labels:
  - bug
assignees: []
created_at: 2025-10-19T16:26:23Z
updated_at: 2025-10-29T15:31:04Z
url: https://github.com/astral-sh/uv/issues/16361
synced_at: 2026-01-10T01:57:36Z
```

# Inconsistent behaviour of `uv add` when passing the `--group` and `-r` flag.

---

_Issue opened by @ale18V on 2025-10-19 16:26_

### Summary

The behaviour of the following command:
```sh
   ➜ uv add -r requirements.txt --group user
```
is inconsistent.

I have the following `pyproject.toml`:
```toml
[project]
name = "foo"
version = "0.1.0"
readme = "README.md"
description = "bar"
requires-python = "~=3.11.0"
dependencies = [
    "flwr==1.20.0",
    "loguru>=0.7.2",
]

[project.optional-dependencies]
ml = [
    "pandas>=2.2.3",
    "scikit-learn>=1.6.1",
    "torch>=2.7.0",
]
```

And if I run the aforementioned command with a non-empty `requirements.txt` file such as this one:
```
# requirements.txt
pytest
```
It works:
```
   ➜ uv add -r requirements.txt --group user
Resolved 75 packages in 1.51s
Prepared 1 package in 68ms
Installed 3 packages in 11ms
 + iniconfig==2.3.0
 + pluggy==1.6.0
 + pytest==8.4.2
```

On the other hand, if I run it with an empty `requirements.txt` it doesn't:
```
   ➜ uv add -r requirements.txt --group user
warning: Requirements file `requirements.txt` does not contain any dependencies
Resolved 71 packages in 9ms
error: Group `user` is not defined in the project's `dependency-groups` table
```

Now, it's fair that it would maybe fail if the file was empty but this error seems misleading, as in the other case it worked even though the `user` group was not defined in the `pyproject.toml`.

I agree that this seems a pretty niche scenario which wouldn't arise during normal development workflows. I happened to catch it because I use `uv` for some programmatic dependency management workflows, where it might happen that the `requirements.txt` is empty.

### Platform

Arch Linux

### Version

uv 0.9.3 (83635a6c4 2025-10-15)

### Python version

Python 3.11.11

---

_Label `bug` added by @ale18V on 2025-10-19 16:26_

---

_Comment by @konstin on 2025-10-20 08:39_

We can create an empty group here for consistency, or at least we can improve the error message that `requirements.txt` is empty.

---

_Assigned to @charliermarsh by @charliermarsh on 2025-10-29 00:18_

---

_Referenced in [astral-sh/uv#16490](../../astral-sh/uv/pulls/16490.md) on 2025-10-29 00:38_

---

_Closed by @charliermarsh on 2025-10-29 15:31_

---
