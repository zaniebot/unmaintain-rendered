<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avoid taking GitHub fast path for git clones - astral-sh/uv #3952</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Avoid taking GitHub fast path for git clones</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/3952">#3952</a>
        opened by <a href="https://github.com/ibraheemdev">@ibraheemdev</a>
        on 2024-05-31 22:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-05-31 22:22</div>
            <div class="timeline-body"><p>Avoid using <a href="https://github.com/astral-sh/uv/blob/a0652921fcf01ac34dbd6ceb1126ff1250bf15cf/crates/uv-git/src/git.rs#L448"><code>github_fast_path</code></a> for the initial clone of a repository. This would require using <code>git clone</code> instead of <code>git init</code> + <code>git fetch</code>, and using the <code>--branch</code> argument to resolve refspecs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">performance</span> added by @ibraheemdev on 2024-05-31 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-01 18:19</div>
            <div class="timeline-body"><p>What's the motivation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-06-01 22:12</div>
            <div class="timeline-body"><p>There were also some discussions about other approaches in #3287</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-03 13:26</div>
            <div class="timeline-body"><p>That discussion is mostly unrelated to this. The GitHub fast path primarily tells us if the commit we have is up to date, so we shouldn't need to take it for the initial clone.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-04 00:16</div>
            <div class="timeline-body"><p>Don't we need to figure out the precise commit from (e.g.) the branch / tag though? I thought we skipped this anyway if we had a precise commit already, and that the fast path was mostly for <em>that</em> operation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ibraheemdev">@ibraheemdev</a> on 2024-06-04 00:34</div>
            <div class="timeline-body"><p>I don't see an early return in <a href="https://github.com/astral-sh/uv/blob/77e93157fb829dee83ff29582e4852a3731477b9/crates/uv-git/src/git.rs#L652"><code>github_fast_path</code></a> unless we find the local repo is up to date, and the resulting oid is used <a href="https://github.com/astral-sh/uv/blob/77e93157fb829dee83ff29582e4852a3731477b9/crates/uv-git/src/git.rs#L494">pretty rarely</a>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:19 UTC
    </footer>
</body>
</html>
