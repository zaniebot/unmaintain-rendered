```yaml
number: 13223
title: "Handling prerelease versions in `uv version --bump`"
type: issue
state: closed
author: tmke8
labels:
  - enhancement
  - good first issue
assignees: []
created_at: 2025-04-30T11:08:59Z
updated_at: 2025-07-10T13:45:19Z
url: https://github.com/astral-sh/uv/issues/13223
synced_at: 2026-01-10T01:57:30Z
```

# Handling prerelease versions in `uv version --bump`

---

_Issue opened by @tmke8 on 2025-04-30 11:08_

### Summary

I see these two use cases, but there might be more:

### 1. Incrementing the number of a prerelease

This means going from `1.2.3a4` to `1.2.3a5`, for example. I think this can be handled by adding a new allowed value to `--bump`. For example `prerelease-counter`: `uv version --bump prerelease-counter`.

### 2. Adding or removing a prerelease suffix

This means going from `1.2.3a5` to `1.2.3`, for example. I think this can be handled by a new argument to `uv version`. For example `--set-suffix`: `uv version --set-suffix none`. Allowed values would be `dev`, `alpha`, `beta`, `rc`, `none`, `post`.

### Example

```
$ uv version --short
0.4.1.dev0
$ uv version --bump prerelease-counter
0.4.1.dev0 => 0.4.1.dev1
$ uv version --set-suffix none
0.4.1.dev1 => 0.4.1
$ uv version --bump patch
0.4.1 => 0.4.2
$ uv version --set-suffix alpha
0.4.2 => 0.4.2a0
$ uv version --bump prerelease-counter
0.4.2a0 => 0.4.2a1
```

---

_Label `enhancement` added by @tmke8 on 2025-04-30 11:08_

---

_Comment by @konstin on 2025-04-30 11:32_

CC @Gankra 

---

_Comment by @Gankra on 2025-04-30 20:12_

Worth noting that it's typical to want to bump a version number and set a prerelease at the same time.

I see the three relevant patterns being:

1. 1.2.3 => 2.0.0a1 (bump version and set alpha)
2. 2.0.0a1 => 2.0.0a2 (bump alpha)
3. 2.0.0a1 => 2.0.0 (clear alpha)

I propose we can address all 3 cases with the addition on new `--bump` modes, and supporting multiple `--bump` arguments.

* `--bump dev|alpha|beta|rc`: increments the relevant prerelease counter, sets it to 1 if it wasn't set (0 feels weird? is that a python idiom?)
* `--bump stable`: clears all prerelease counters

With this we get the above 3 cases as:

1. `uv version --bump major --bump alpha`
2. `uv version --bump alpha`
3. `uv version --bump stable`

Note here that it is "wrong" that `1.2.3 --bump alpha` => `1.2.3a1` in that it's actually creating a version less than the original, but I don't think that's actually confusing/problematic, and it Does What You Want. Alternatively you could make `1.2.3 --bump alpha` an error, requiring it to be paired with `--bump major|minor|patch` for it to "make sense". I don't feel like that's necessary though.

Also I suppose if you wanted to "change alpha3 to beta1" then we could allow that to be done with `uv version --bump stable --bump beta`?

---

_Assigned to @Gankra by @Gankra on 2025-04-30 20:13_

---

_Label `good first issue` added by @Gankra on 2025-04-30 20:13_

---

_Comment by @Gankra on 2025-04-30 20:14_

(I marked this as a good first issue but the cli design should be settled before anyone goes off to implement)

---

_Comment by @christeefy on 2025-05-01 01:11_

In your proposal, is it correct to that say that the underlying rule when handling suffixes is to treat them as literal components of the version string, rather than interpreting them? (Which is why "change alpha3 to beta1" is `uv version --bump stable --bump beta` instead of `uv version --bump beta`?)

> Alternatively you could make 1.2.3 --bump alpha an error, requiring it to be paired with --bump major|minor|patch for it to "make sense". I don't feel like that's necessary though.

Perhaps, at least a warning can be raised when a bump results in an earlier semver? Accidentally releasing a new version as `1.2.3a1` instead of `1.2.4a1` is probably not a breaking change, but I think a few folks may be surprised initially by that behaviour until they have given it more thought.

---

_Comment by @Gankra on 2025-05-01 12:37_

> In your proposal, is it correct to that say that the underlying rule when handling suffixes is to treat them as literal components of the version string, rather than interpreting them? (Which is why "change alpha3 to beta1" is uv version --bump stable --bump beta instead of uv version --bump beta?)

I'm not sure I follow, but mostly I was mostly punting on remembering/enforcing the exact versioning relationships between the various suffixes. Having now refreshed my memory, there's at most one of each:

* pre: `alpha1`, `beta1`, `rc1`
* dev: `dev1`
* post: `post1`
* local: `+asdassd`

I can't find the exact text stating this unambiguously, but `alpha` < `beta` < `rc`, yeah? So I suppose `--bump beta` should be fine clearing `alpha1`.

It's a bit less clear to me how dev/post/local should interact here, and those might still be cases where we say "use `--bump stable` to just purge it all" is the right answer (although post is actually post-stable ðŸ˜¿).

---

_Comment by @Gankra on 2025-05-01 12:39_

(I think we can just scope this issue to prereleases and ignore dev/post/local for the most part, but we do need to determine if they should be preserved or clobbered when you bump the prerelease. Starting to convince myself all those can be cleared if you bump prerelease.)

---

_Referenced in [cthoyt/cookiecutter-snekpack#43](../../cthoyt/cookiecutter-snekpack/issues/43.md) on 2025-05-02 11:23_

---

_Comment by @oefe on 2025-05-04 13:41_

> Note here that it is "wrong" that `1.2.3 --bump alpha` => `1.2.3a1` in that it's actually creating a version less than the original, but I don't think that's actually confusing/problematic, and it Does What You Want. Alternatively you could make `1.2.3 --bump alpha` an error, requiring it to be paired with `--bump major|minor|patch` for it to "make sense". I don't feel like that's necessary though.

> Perhaps, at least a warning can be raised when a bump results in an earlier semver? Accidentally releasing a new version as 1.2.3a1 instead of 1.2.4a1 is probably not a breaking change, but I think a few folks may be surprised initially by that behaviour until they have given it more thought.

Another option would be to bump to the next possible larger (patch) version in this case (and only in this case), i.e. at `1.2.3`, `--bump alpha` would result `1.2.4a1`.

That's essentially what [`poetry version prerelease`](https://python-poetry.org/docs/cli/#version) does in this case. 



---

_Comment by @T-256 on 2025-05-11 21:13_

My 2cents:

New value for `--bump`, let's call it _next_ for now, it used to increase least valuable number of current version's channel, i.e _patch_ section for stable channel (`1.2.3 -> next -> 1.2.4`) and suffix number of pre-release channel (`1.0.0a1 -> next -> 1.0.0a2`).

New option `--pre-bump` which cycles tags:
- 1.2.3 -> (`--pre-bump`) -> 1.2.3a1
- 1.2.3 -> (`--bump minor --pre-bump`) -> 1.3.0a1
- 1.2.3a1 -> (`--bump next`) -> 1.2.0a2
- 1.2.3a1 -> (`--pre-bump`) -> 1.2.0b1
- 1.2.3rc6 -> (`--pre-bump`) -> it can either warn and switch to stable channel (i.e. set version to `1.2.3`) OR exit with error.

New option `--suffix-bump` with values [<list of pre-release values, local, post, dev>]. these values and their order is configurable in `tool.uv`.
- 1.2.3 -> (`--suffix-bump b`) -> 1.2.3b1
- 1.2.3 -> (`--bump minor --suffix-bump dev`) -> 1.3.0dev1
- 1.2.3dev1 -> (`--suffix-bump rc`) -> 1.3.0rc1


---

_Referenced in [astral-sh/uv#13578](../../astral-sh/uv/pulls/13578.md) on 2025-05-21 14:51_

---

_Referenced in [astral-sh/uv#14353](../../astral-sh/uv/issues/14353.md) on 2025-06-29 21:54_

---

_Closed by @zanieb on 2025-07-10 13:45_

---
