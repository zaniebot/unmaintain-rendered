```yaml
number: 16320
title: "`uv add --active` doesn't appear to use active environment"
type: issue
state: closed
author: geophpherie
labels:
  - question
assignees: []
created_at: 2025-10-15T17:39:09Z
updated_at: 2025-10-15T21:12:14Z
url: https://github.com/astral-sh/uv/issues/16320
synced_at: 2026-01-10T01:57:36Z
```

# `uv add --active` doesn't appear to use active environment

---

_Issue opened by @geophpherie on 2025-10-15 17:39_

### Summary

In the example below, I create a venv in venv1, activate it, then move out of that folder into another one that isn't a descendant of venv1. In this new folder, with venv1 still activated, I try to `uv add --active <any_package>` but get the error that a `pyproject.toml` is not found in the current dir or parent dir.

Based on the docs for --active under uv add:

> Prefer the active virtual environment over the project's virtual environment.

I would have expected it to find the `pyproject.toml` file for my `venv1` since it is activated? Or is my interpretation there incorrect?

```zsh
~ () ✘ mkdir active_test
~ () ✘ cd active_test
~/active_test () ✘ uv init venv1
Initialized project `venv1` at `/Users/jbeyer/active_test/venv1`
~/active_test () ✘ cd venv1
~/active_test/venv1 (main) ✘ uv sync
Using CPython 3.13.2
Creating virtual environment at: .venv
Resolved 1 package in 9ms
Audited in 0.04ms
~/active_test/venv1 (main) ✘ source .venv/bin/activate
(venv1) ~/active_test/venv1 (main) ✘ cd ..
(venv1) ~/active_test () ✘ mkdir novenv
(venv1) ~/active_test () ✘ cd novenv
(venv1) ~/active_test/novenv () ✘ uv add --active pandas
error: No `pyproject.toml` found in current directory or any parent directory
```

`env` output shows path to venv1 as expected:

```zsh
VIRTUAL_ENV=/Users/jbeyer/active_test/venv1/.venv
VIRTUAL_ENV_PROMPT=venv1
```

### Platform

macOS Tahoe 26.0.1 arm64

### Version

uv 0.9.3 (83635a6c4 2025-10-15)

### Python version

3.13.2

---

_Label `bug` added by @geophpherie on 2025-10-15 17:39_

---

_Comment by @zanieb on 2025-10-15 18:27_

The `pyproject.toml` is always searched for relative to the current directory. `--active` just affects the virtual environment location, not discovery of the project itself.

---

_Label `bug` removed by @zanieb on 2025-10-15 18:27_

---

_Label `question` added by @zanieb on 2025-10-15 18:27_

---

_Comment by @geophpherie on 2025-10-15 18:38_

Ok thanks. It seems my interpretation that it would discover the project based on the active environment was incorrect.

---

_Closed by @geophpherie on 2025-10-15 21:12_

---
