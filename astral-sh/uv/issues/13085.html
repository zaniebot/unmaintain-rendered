<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip compile` strips optional dependencies `package[optional-dep]` - astral-sh/uv #13085</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv pip compile` strips optional dependencies `package[optional-dep]`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/13085">#13085</a>
        opened by <a href="https://github.com/benjaoming">@benjaoming</a>
        on 2025-04-24 09:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/benjaoming">@benjaoming</a> on 2025-04-24 09:59</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hello!</p>
<p>Thanks for the amazing project!</p>
<p>I'm seeing an unexpected and breaking behavior in relation to <code>pip-compile</code> compatibility. In the example below, the optional dependency spec <code>phonenumberslite</code> from <code>test.in</code> isn't added to the final <code>test.txt</code> requirements file.</p>
<p>Reproducing:</p>
<pre><code>❯ cat test.in
django-phonenumber-field[phonenumberslite]==4.0.0

❯ uv pip compile test.in --output-file test.txt
Resolved 6 packages in 5.23s
# This file was autogenerated by uv via the following command:
#    uv pip compile test.in --output-file test.txt
asgiref==3.8.1
    # via django
babel==2.17.0
    # via django-phonenumber-field
django==5.2
    # via django-phonenumber-field
django-phonenumber-field==4.0.0
    # via -r test.in
phonenumberslite==9.0.3
    # via django-phonenumber-field
sqlparse==0.5.3
    # via django
</code></pre>
<p>What happened here is that <code>django-phonenumber-field==4.0.0</code> was set as the dependency, so it will be missing the <code>phonenumberslite</code> optional dependency.</p>
<h3>Platform</h3>
<p>Docker, Linux (tested on both)</p>
<h3>Version</h3>
<p>Tested on 0.5.11 and 0.6.16</p>
<h3>Python version</h3>
<p>Python 3.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @benjaoming on 2025-04-24 09:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benjaoming">@benjaoming</a> on 2025-04-24 10:19</div>
            <div class="timeline-body"><p>I just learned about <code>--extra optional</code> and will check if that solves my problem...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benjaoming">@benjaoming</a> on 2025-04-24 10:24</div>
            <div class="timeline-body"><p>This was a duplicate of https://github.com/astral-sh/uv/issues/1595</p>
<p>(used GitHub to search issues, ended up finding the duplicate via Google)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @benjaoming on 2025-04-24 10:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
