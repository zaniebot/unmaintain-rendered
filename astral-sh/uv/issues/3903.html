<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip install doesn't read the index url in the requirements.txt file - astral-sh/uv #3903</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv pip install doesn't read the index url in the requirements.txt file</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/3903">#3903</a>
        opened by <a href="https://github.com/aybidi">@aybidi</a>
        on 2024-05-29 13:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/aybidi">@aybidi</a> on 2024-05-29 13:28</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>We have a private index that we use to find packages. We add it to our requirements.txt file like so:</p>
<pre><code class="language-txt"># This file was autogenerated by uv via the following command:
#    uv pip compile --python 3.9 --python-platform linux -o requirements.txt requirements.in
--index-url &lt;private-index-url&gt; # via nox edit of uv pip compile output
--extra-index-url &lt;private-index-url-2&gt;  # via nox edit of uv pip compile output
--extra-index-url https://download.pytorch.org/whl/cpu  # via nox edit of uv pip compile output

# packages
</code></pre>
<p>When we run <code>uv pip install -r requirements.txt</code>, <code>uv</code> doesn't use the index urls in the file and some packages fail to install. When I explicitly add the index url and the extra index url to the command, then it works:</p>
<pre><code class="language-bash">$ uv pip install -r requirements.txt --index-url &lt;private-index-url&gt; --extra-index-url https://download.pytorch.org/whl/cpu
</code></pre>
<p>How do I make <code>uv</code> pick up the index URLs in the requirements file?</p>
<p>I'm using <code>uv==0.1.44</code> on linux</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-29 13:30</div>
            <div class="timeline-body"><p>We do read index URLs in requirements files. Can you include the output logs for whatever failure you're seeing? This on its own isn't quite enough to help unfortunately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aybidi">@aybidi</a> on 2024-05-29 13:38</div>
            <div class="timeline-body"><p>The output logs just show the error when I don't pass in the index url through the command:</p>
<pre><code>Built 11 editables in 4.89s
  × No solution found when resolving dependencies:
  ╰─▶ Because there is no version of torch==2.1.2+cpu and you require torch==2.1.2+cpu, we can conclude that the requirements are
      unsatisfiable.
</code></pre>
<p>I do have the following extra index url in my generated <code>requirements.txt</code> file:</p>
<pre><code>--extra-index-url https://download.pytorch.org/whl/cpu  # via nox edit of uv pip compile output
</code></pre>
<p>when I add extra index URL directly to the command, it works:</p>
<pre><code class="language-bash">$ uv pip install -r requirements.txt --index-url &lt;private-index-url&gt; --extra-index-url https://download.pytorch.org/whl/cpu
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aybidi">@aybidi</a> on 2024-05-29 13:39</div>
            <div class="timeline-body"><pre><code>$ uv --version
uv 0.1.44
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-29 13:40</div>
            <div class="timeline-body"><p>Why is <code>--extra-index-url &lt;private-index-url-2&gt;</code> included in the requirements file but not on the command-line?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aybidi">@aybidi</a> on 2024-05-29 13:43</div>
            <div class="timeline-body"><p>It is. I shortened it for brevity. Here's the full command that works:</p>
<pre><code class="language-bash">$ uv pip install -r requirements.txt \
--index-url &lt;private-index-url&gt; \
--extra-index-url https://download.pytorch.org/whl/cpu  \
--extra-index-url &lt;private-index-url-2&gt; \
--index-strategy unsafe-best-match
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-29 13:46</div>
            <div class="timeline-body"><p>Ok, and you're passing <code>--index-strategy unsafe-best-match</code> even when omitting the index URLs on the command-line?</p>
<p>What you have on the command-line is meaningfully different than what you have in the requirements file -- the order of the extra index URLs is not the same.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aybidi">@aybidi</a> on 2024-05-29 13:49</div>
            <div class="timeline-body"><p>ah I see! I wasn't passing <code>--index-strategy unsafe-best-match</code> when omitting the index URLs on the command line</p>
<p>adding it worked!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aybidi">@aybidi</a> on 2024-05-29 13:49</div>
            <div class="timeline-body"><p>happy to close the issue. thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-29 13:51</div>
            <div class="timeline-body"><p>Awesome, thanks! Sorry for the confusion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-05-29 13:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-05-29 13:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:28 UTC
    </footer>
</body>
</html>
