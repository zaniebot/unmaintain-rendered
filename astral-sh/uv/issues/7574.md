```yaml
number: 7574
title: "Install jieba failed, when `editable_mode = \"compat\"`"
type: issue
state: closed
author: fanck0605
labels:
  - bug
assignees: []
created_at: 2024-09-20T09:08:10Z
updated_at: 2024-09-21T01:46:14Z
url: https://github.com/astral-sh/uv/issues/7574
synced_at: 2026-01-10T01:57:17Z
```

# Install jieba failed, when `editable_mode = "compat"`

---

_Issue opened by @fanck0605 on 2024-09-20 09:08_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

## Excepted result

Install `jieba` successfully, when `editable_mode = "compat"`


## Current result


pyproject.toml    `editable_mode = "compat"`

```
[project]
name = "jieba_test"
version = "0.1.0"
description = ""
authors = [
]
requires-python = ">=3.9,<4"

[tool.uv]
package = false
index-url = "https://mirrors.sangfor.com/pypi/simple"
config-settings = { editable_mode = "compat" }

[build-system]
requires = ["setuptools==74.1.2", "cython==3.0.11"]
build-backend = "setuptools.build_meta"
```

install `jieba` failed

```
root@1e9604c7cf38:/jieba_test# uv venv 
Using Python 3.10.15 interpreter at: /usr/local/bin/python3
Creating virtualenv at: .venv
root@1e9604c7cf38:/jieba_test# uv pip install jieba --verbose
DEBUG uv 0.4.9
DEBUG Searching for Python interpreter in system path
DEBUG Found `cpython-3.10.15-linux-x86_64-gnu` at `/jieba_test/.venv/bin/python3` (virtual environment)
DEBUG Using Python 3.10.15 environment at .venv/bin/python3
DEBUG Acquired lock for `.venv`
DEBUG At least one requirement is not satisfied: jieba
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.10.15
DEBUG Solving with target Python version: >=3.10.15
DEBUG Adding direct dependency: jieba*
DEBUG Found fresh response for: https://mirrors.sangfor.com/pypi/simple/jieba/
DEBUG Searching for a compatible version of jieba (*)
DEBUG Selecting: jieba==0.42.1 [compatible] (jieba-0.42.1.tar.gz)
DEBUG Acquired lock for `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1`
DEBUG Found fresh response for: https://mirrors.sangfor.com/pypi/packages/jieba/0.42.1/jieba-0.42.1.tar.gz#sha256=055ca12f62674fafed09427f176506079bc135638a14e23e25be909131928db2
DEBUG No static `pyproject.toml` available for: jieba==0.42.1 (MissingPyprojectToml)
DEBUG No static `PKG-INFO` available for: jieba==0.42.1 (PkgInfo(UnsupportedMetadataVersion("1.1")))
DEBUG No static `egg-info` available for: jieba==0.42.1 (MissingRequiresTxt)
DEBUG Using cached metadata for: jieba==0.42.1
DEBUG Released lock at `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1/.lock`
DEBUG Tried 1 versions: jieba 1
DEBUG Split specific environment resolution took 0.002s
Resolved 1 package in 3ms
DEBUG Identified uncached requirement: jieba==0.42.1
DEBUG Acquired lock for `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1`
DEBUG Found fresh response for: https://mirrors.sangfor.com/pypi/packages/jieba/0.42.1/jieba-0.42.1.tar.gz#sha256=055ca12f62674fafed09427f176506079bc135638a14e23e25be909131928db2
DEBUG Building: jieba==0.42.1
DEBUG Released lock at `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1/.lock`
DEBUG Released lock at `/jieba_test/.venv/.lock`
error: Failed to prepare distributions
  Caused by: Failed to fetch wheel: jieba==0.42.1
  Caused by: /root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1/WHnmGU4IBuinTZd1vlJoH/208709eb0bfebd25/jieba-0.42.1.tar.gz does not appear to be a Python project, as neither `pyproject.toml` nor `setup.py` are present in the directory
root@1e9604c7cf38:/jieba_test#
```

remove `config-settings = { editable_mode = "compat" }` 

```diff
 [tool.uv]
 package = false
 index-url = "https://mirrors.sangfor.com/pypi/simple"
-config-settings = { editable_mode = "compat" }
 
 [build-system]
```

install `jieba` success

```
root@1e9604c7cf38:/jieba_test# uv pip install jieba --verbose
DEBUG uv 0.4.9
DEBUG Searching for Python interpreter in system path
DEBUG Found `cpython-3.10.15-linux-x86_64-gnu` at `/jieba_test/.venv/bin/python3` (virtual environment)
DEBUG Using Python 3.10.15 environment at .venv/bin/python3
DEBUG Acquired lock for `.venv`
DEBUG At least one requirement is not satisfied: jieba
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.10.15
DEBUG Solving with target Python version: >=3.10.15
DEBUG Adding direct dependency: jieba*
DEBUG Found stale response for: https://mirrors.sangfor.com/pypi/simple/jieba/
DEBUG Sending revalidation request for: https://mirrors.sangfor.com/pypi/simple/jieba/
DEBUG Found not-modified response for: https://mirrors.sangfor.com/pypi/simple/jieba/
DEBUG Searching for a compatible version of jieba (*)
DEBUG Selecting: jieba==0.42.1 [compatible] (jieba-0.42.1.tar.gz)
DEBUG Acquired lock for `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1`
DEBUG Found stale response for: https://mirrors.sangfor.com/pypi/packages/jieba/0.42.1/jieba-0.42.1.tar.gz#sha256=055ca12f62674fafed09427f176506079bc135638a14e23e25be909131928db2
DEBUG Sending revalidation request for: https://mirrors.sangfor.com/pypi/packages/jieba/0.42.1/jieba-0.42.1.tar.gz#sha256=055ca12f62674fafed09427f176506079bc135638a14e23e25be909131928db2
DEBUG Found not-modified response for: https://mirrors.sangfor.com/pypi/packages/jieba/0.42.1/jieba-0.42.1.tar.gz#sha256=055ca12f62674fafed09427f176506079bc135638a14e23e25be909131928db2
DEBUG No static `pyproject.toml` available for: jieba==0.42.1 (MissingPyprojectToml)
DEBUG No static `PKG-INFO` available for: jieba==0.42.1 (PkgInfo(UnsupportedMetadataVersion("1.1")))
DEBUG No static `egg-info` available for: jieba==0.42.1 (MissingRequiresTxt)
DEBUG Using cached metadata for: jieba==0.42.1
DEBUG Released lock at `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1/.lock`
DEBUG Tried 1 versions: jieba 1
DEBUG Split specific environment resolution took 0.047s
Resolved 1 package in 49ms
DEBUG Identified uncached requirement: jieba==0.42.1
DEBUG Acquired lock for `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1`
DEBUG Found fresh response for: https://mirrors.sangfor.com/pypi/packages/jieba/0.42.1/jieba-0.42.1.tar.gz#sha256=055ca12f62674fafed09427f176506079bc135638a14e23e25be909131928db2
DEBUG Building: jieba==0.42.1
DEBUG Ignoring empty directory
DEBUG Resolving build requirements
DEBUG Solving with installed Python version: 3.10.15
DEBUG Solving with target Python version: >=3.10.15
DEBUG Adding direct dependency: setuptools>=40.8.0
DEBUG Found stale response for: https://mirrors.sangfor.com/pypi/simple/setuptools/
DEBUG Sending revalidation request for: https://mirrors.sangfor.com/pypi/simple/setuptools/
DEBUG Found not-modified response for: https://mirrors.sangfor.com/pypi/simple/setuptools/
DEBUG Searching for a compatible version of setuptools (>=40.8.0)
DEBUG Selecting: setuptools==75.1.0 [compatible] (setuptools-75.1.0-py3-none-any.whl)
DEBUG Found stale response for: https://mirrors.sangfor.com/pypi/packages/setuptools/75.1.0/setuptools-75.1.0-py3-none-any.whl#sha256=35ab7fd3bcd95e6b7fd704e4a1539513edad446c097797f2985e0e4b960772f2
DEBUG Sending revalidation request for: https://mirrors.sangfor.com/pypi/packages/setuptools/75.1.0/setuptools-75.1.0-py3-none-any.whl#sha256=35ab7fd3bcd95e6b7fd704e4a1539513edad446c097797f2985e0e4b960772f2
DEBUG Found not-modified response for: https://mirrors.sangfor.com/pypi/packages/setuptools/75.1.0/setuptools-75.1.0-py3-none-any.whl#sha256=35ab7fd3bcd95e6b7fd704e4a1539513edad446c097797f2985e0e4b960772f2
DEBUG Tried 1 versions: setuptools 1
DEBUG Split specific environment resolution took 0.126s
DEBUG Installing in setuptools==75.1.0 in /root/.cache/uv/builds-v0/.tmpNwtZSF
DEBUG Requirement already cached: setuptools==75.1.0
DEBUG Installing build requirement: setuptools==75.1.0
DEBUG Creating PEP 517 build environment
DEBUG Calling `setuptools.build_meta:__legacy__.get_requires_for_build_wheel()`
DEBUG Calling `setuptools.build_meta:__legacy__.build_wheel("/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1/WHnmGU4IBuinTZd1vlJoH/.tmpSGN8H7", {}, None)`
WARN The .dist-info directory jieba-0.42.1 does not start with the normalized version: 0.42.1
DEBUG Finished building: jieba==0.42.1
DEBUG Released lock at `/root/.cache/uv/built-wheels-v3/index/eb35d7ac5361a07a/jieba/0.42.1/.lock`
Prepared 1 package in 4.22s
Installed 1 package in 3ms
 + jieba==0.42.1
DEBUG Released lock at `/jieba_test/.venv/.lock`
```

---

_Assigned to @charliermarsh by @charliermarsh on 2024-09-20 14:16_

---

_Comment by @charliermarsh on 2024-09-20 14:16_

Thanks, I think this is my bug. I'll fix it today.

---

_Label `bug` added by @charliermarsh on 2024-09-20 14:16_

---

_Comment by @charliermarsh on 2024-09-20 17:17_

Ok, I just tested and I believe this is actually fixed in 0.4.13. Do you mind upgrading?

---

_Closed by @charliermarsh on 2024-09-20 17:17_

---

_Comment by @fanck0605 on 2024-09-21 01:46_

Sorry, when I discovered this issue, uv 0.4.13 had not yet been released. I upgrade to uv 0.4.14 and now this issue has been resolved. Thanks for your reply.

---
