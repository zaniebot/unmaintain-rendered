<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv install -r …` fails with comment in `-e ./local_package   # via other_package` - astral-sh/uv #3011</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv install -r …</code> fails with comment in <code>-e ./local_package   # via other_package</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/3011">#3011</a>
        opened by <a href="https://github.com/PeterW-LWL">@PeterW-LWL</a>
        on 2024-04-12 08:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/PeterW-LWL">@PeterW-LWL</a></div>
            <div class="timeline-body">The Problem
<p>Running <code>uv pip install -r requirements.txt -v</code> failes with error code 2 and the following output:</p>
<pre><code>INFO Found a virtualenv through VIRTUAL_ENV at: [workspace]/.venv
DEBUG Cached interpreter info for Python 3.12.2, skipping probing: .venv/bin/python
DEBUG Using Python 3.12.2 environment at .venv/bin/python
DEBUG Trying to lock if free: .venv/.lock
DEBUG Using registry request timeout of 300s
DEBUG Building (editable) file://[workspace]/lwl_inclusive_plugins
DEBUG Solving with target Python version 3.12.2
DEBUG Adding direct dependency: setuptools&gt;=40.8.0
DEBUG Building (editable) file://[workspace]/local_package_2%20%20%20%20%20%20#%20via%20local_package_1
error: Failed to build editables
  Caused by: Source distribution not found at: [workspace]/local_package_2
</code></pre>
<p>The <code>requirements.txt</code> looks like this:</p>
<pre><code># This file was autogenerated by uv via the following command:
#    uv pip compile --annotation-style=line --output-file=requirements.txt requirements.in
-e ./local_package_1
-e ./local_package_2      # via local_package_1
</code></pre>
The possible solution
<p>Removing the comment in the last line of the <code>requirements.txt</code> fixes the problem.</p>
<pre><code># This file was autogenerated by uv via the following command:
#    uv pip compile --annotation-style=line --output-file=requirements.txt requirements.in
-e ./local_package_1
-e ./local_package_2
</code></pre>
<p>The <code>uv pip compile</code> command will regenerate this comment (as there is a dependency from <code>local_package_1</code> to <code>local_package_2</code>.</p>
<p><code>uv pip install -r …</code> should ignore the comment not just for normal lines like</p>
<pre><code>django==5.0.3             # via django-cms
</code></pre>
<p>but also for lines starting the <code>-e</code></p>
Global information
<p>Platform</p>
<ul>
<li>macOS 13.4.1</li>
<li>Chip Apple M2 Pro (arm64)</li>
</ul>
<pre><code>&gt; uv --version
uv 0.1.31 (7bcca28b1 2024-04-09)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`uv install -r req….txt` fails with comment in `-e .local_package   # via other_package`&quot; to &quot;`uv install -r …` fails with comment in `-e ./local_package   # via other_package`&quot; by <a href="https://github.com/PeterW-LWL">@PeterW-LWL</a> on 2024-04-12 08:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-12 14:06</div>
            <div class="timeline-body"><p>Oh interesting, will take a look...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-12 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-12 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-12 19:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:30:48 UTC
    </footer>
</body>
</html>
