<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv add textract` fails with parse error on requires - astral-sh/uv #9194</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`uv add textract` fails with parse error on requires</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/9194">#9194</a>
        opened by <a href="https://github.com/DRMacIver">@DRMacIver</a>
        on 2024-11-18 13:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/DRMacIver">@DRMacIver</a> on 2024-11-18 13:34</div>
            <div class="timeline-body"><p>Running <code>uv add textract==1.6.4</code> on uv version <code>0.3.2</code> (on OSX if relevant) produces the following error:</p>
<pre><code>â ¹ textract==1.6.4                                                                                                                                                                                                     error: Failed to download and build `textract==1.6.4`
  Caused by: Build backend failed to determine extra requires with `build_wheel()` with exit status: 1
--- stdout:

--- stderr:
error in textract setup command: 'install_requires' must be a string or iterable of strings containing valid project/version requirement specifiers; .* suffix can only be used with `==` or `!=` operators
    extract-msg&lt;=0.29.*
               ~~~~~~~^
---
</code></pre>
<p>The package in question pip installs fine.</p>
<p>This is presumably just the uv requirement parser being stricter than pip's, and this particular requirements construct is just sufficiently unusual to see in the wild that it hasn't come up before.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from ".* suffix can only be used with `==` or `!=` operators" to "`uv add textract` fails with ".* suffix can only be used with `==` or `!=` operators"" by @DRMacIver on 2024-11-18 13:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv add textract` fails with ".* suffix can only be used with `==` or `!=` operators"" to "`uv add textract` fails with parse error on requires" by @DRMacIver on 2024-11-18 13:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-18 13:38</div>
            <div class="timeline-body"><p>Yeah that is an invalid specifier -- wildcards are only allowed on <code>==</code> and <code>!=</code> specifiers. We have a &quot;fixup&quot; system that can handle cases like that, though. I guess it's intended to be <code>&lt;=0.29</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-11-18 13:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-18 13:42</div>
            <div class="timeline-body"><p>Oh sorry, I think this is actually <code>setuptools</code> raising the error, and not uv, in which case... there isn't much we can do about it. I think the best you can do is add <code>--build-constraint constraints.txt</code>, and set a constraint to use an older version of setuptools. Sorry!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-18 13:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DRMacIver">@DRMacIver</a> on 2024-11-18 13:56</div>
            <div class="timeline-body"><p>If the error is purely setuptools related, why does pip install work with the same package specifier?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-18 13:58</div>
            <div class="timeline-body"><p>Are pip and uv using the same version of Python? Is the package already cached by pip from some other install on your machine? Do you see the same behavior with <code>pip install --use-pep517 --no-cache --force-reinstall</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DRMacIver">@DRMacIver</a> on 2024-11-18 14:03</div>
            <div class="timeline-body"><p>Same version of Python. Also correctly installs with <code>uv pip install</code>. Not cached. But indeed <code>--use-pep517</code> does cause pip to exhibit the same error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-18 14:17</div>
            <div class="timeline-body"><p>Okay thanks, got it. That means the package is indeed broken with that version of setuptools, and the same breakage will occur in future versions of PEP, once <code>--use-pep517</code> is made the default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-11-18 14:25</div>
            <div class="timeline-body"><p>For me locally, <code>pip install textract==1.6.4</code> errors on both Python 3.10 and Python 3.13 on ubuntu 24.04. My guess would be that the package is still in the pip cache, and was built before https://github.com/pypa/packaging/pull/407, which was released a <code>packaging</code> <a href="https://github.com/pypa/packaging/releases/tag/22.0">22.0</a> which was merged in <code>setuptools</code> <a href="https://setuptools.pypa.io/en/latest/history.html#v67-0-0">67.0.0</a>. Before packaging 22.0 pip and setuptools were much more lenient with version specifiers, afterwards they started only accepting spec-compliant versions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DRMacIver">@DRMacIver</a> on 2024-11-18 14:43</div>
            <div class="timeline-body"><p>Fair enough. In fact, I went to file a bug at textract and discovered this is already filed with them as an issue: https://github.com/deanmalmgren/textract/issues/533 (I didn't think to check there first because it seemed to work with pip).</p>
<p>Not that this necessarily matters to you, but it doesn't look very likely that's going to be fixed any time soon, as the package appears... lightly maintained. It would be good to have some way to work around this problem for similar issues, but that probably has to be on the setuptools side.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:24 UTC
    </footer>
</body>
</html>
