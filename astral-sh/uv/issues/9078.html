<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip install` fails to install package while `pip install` succeeds - astral-sh/uv #9078</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv pip install` fails to install package while `pip install` succeeds</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/9078">#9078</a>
        opened by <a href="https://github.com/arpitg-sh">@arpitg-sh</a>
        on 2024-11-13 06:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/arpitg-sh">@arpitg-sh</a> on 2024-11-13 06:26</div>
            <div class="timeline-body"><p><strong>Description:</strong> I'm encountering an issue when using uv pip to install Python packages. Specifically, the build process for jsmin==2.2.2 fails, while doing the same with native pip passes.</p>
<p><strong>Steps to Reproduce</strong></p>
<p>Using uv:</p>
<pre><code>uv pip install setuptools
uv pip install azure-cli
</code></pre>
<p>This results in a failure:</p>
<pre><code>9.923   × Failed to download and build `jsmin==2.2.2`
9.923   ╰─▶ Build backend failed to determine requirements with `build_wheel()`
9.923       (exit status: 1)
9.923
9.923       [stderr]
9.923       /root/.cache/uv/builds-v0/.tmpdkIMOq/lib/python3.9/site-packages/setuptools/_distutils/dist.py:261:        
9.923       UserWarning: Unknown distribution option: 'test_suite'
9.923         warnings.warn(msg)
9.923       error in jsmin setup command: `use_2to3` is invalid.
</code></pre>
<p>Using regular pip(v24.0):</p>
<pre><code>pip install setuptools
pip install azure-cli
</code></pre>
<p>This works successfully without errors.
Additional Information</p>
<pre><code>uv Platform: &quot;Debian GNU/Linux 10 (buster)&quot;
uv Version: uv 0.5.1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dimbleby">@dimbleby</a> on 2024-11-13 08:19</div>
            <div class="timeline-body"><p>You will want to allow prereleases when adding azure-cli</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-13 16:24</div>
            <div class="timeline-body"><p>Yeah adding <code>--pre</code> seems to get this to work. I think this is correct as-is -- without <code>--pre</code>, we end up trying to build a dependency but failing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-13 16:28</div>
            <div class="timeline-body"><p>Actually, I think this is failing during pre-fetching, maybe? I have a separate solution to this, so I'll leave it open.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-11-13 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-11-13 16:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dimbleby">@dimbleby</a> on 2024-11-13 17:54</div>
            <div class="timeline-body"><p>It's failing because when pre-releases are disallowed, uv searches way back to old versions of azure-cli that no-one should want.</p>
<p>I think it's understood (by those who know!) that uv takes a different view of pre-releases than other installers, and different also than the specs. Of course there are reasons, but this is an example of the downsides.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-13 17:56</div>
            <div class="timeline-body"><p>Yeah -- I generally agree. The thing I noticed in this specific case though is that we don't actually seem to ever consider <code>jsmin</code>, we just &quot;pre-fetch&quot; it when looking at certain <code>azure-cli</code> versions. So we should be able to delay the error here such that the resolution still succeeds (but would fail, as today, if the resolution proceeded differently and we <em>did</em> end up looking at <code>jsmin</code> as a candidate).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/9098.html">astral-sh/uv#9098</a> on 2024-11-13 20:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-13 20:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-13 20:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/arpitg-sh">@arpitg-sh</a> on 2024-11-14 11:05</div>
            <div class="timeline-body"><p>@charliermarsh Do you know when will this be released?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:01 UTC
    </footer>
</body>
</html>
