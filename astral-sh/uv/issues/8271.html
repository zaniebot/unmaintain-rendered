<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>package version identifier is limited to 18446744073709551615 - astral-sh/uv #8271</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>package version identifier is limited to 18446744073709551615</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/8271">#8271</a>
        opened by <a href="https://github.com/dschneiderch">@dschneiderch</a>
        on 2024-10-16 21:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dschneiderch">@dschneiderch</a> on 2024-10-16 21:14</div>
            <div class="timeline-body"><p>It seems that UV doesn't support version identifiers great than 18446744073709551615.   I don't believe https://peps.python.org/pep-0440/ has this restriction and assume it is a function of using Int64 to parse the build number.</p>
<p>To reproduce simply add a dependency with a dev version identifier &gt; 18446744073709551615.</p>
<p>Internally we are using a concatenation of the hash of a branch name and the git commit to version development packages. We don't use the local identifier syntax because google won't let us install those in the cloud-composer (even though we use a private artifactory) :(</p>
<pre><code class="language-%">error: Failed to build: `vi-composer @ file:///Users/dschneider/bombora/repos/vi-composer`
  Caused by: Failed to parse metadata from built wheel
  Caused by: expected number less than or equal to 18446744073709551615, but number found in &quot;768230559194918072045&quot; exceeds it
bombora-composer3-airflow2 ==0.2.1.dev768230559194918072045
</code></pre>
<pre><code class="language-%">uv 0.4.13 (b8f9ee3b4 2024-09-19) 
</code></pre>
<p>on macos</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @BurntSushi by @zanieb on 2024-10-16 21:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-10-16 21:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-17 01:36</div>
            <div class="timeline-body"><p>It's hard to say if we should support larger integers. I assume it will come with more complexity and performance degradation. Curious to see what @BurntSushi thinks though, as he's the expert on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chrisrodrigue">@chrisrodrigue</a> on 2024-10-17 21:34</div>
            <div class="timeline-body"><p>https://crates.io/crates/num-bigint</p>
<p>Max size is <code>~3.079 x 10^22212093154093428519</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-17 21:57</div>
            <div class="timeline-body"><p>We have a highly optimized data structure for version identifiers — they're in the critical path for performance.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-10-18 07:09</div>
            <div class="timeline-body"><p>We're using an <code>u64</code>, an unsigned 64-bit integer, for the dev segment, and I think that's a reasonable upper limit. With higher numbers, we start using potentially non-cpu-native numbers and increase the size of the performance critical <code>VersionFull</code> even further.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dschneiderch on 2024-10-21 17:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-10-28 13:22</div>
            <div class="timeline-body"><p>I think an experiment here could be warranted. My understanding here is that <code>VersionFull</code> is the &quot;slow&quot; path, where <code>VersionSmall</code> is the fast path. We wouldn't change <code>VersionSmall</code>, but rather, change <code>VersionFull</code>. The problem, I think, is that even though <code>VersionFull</code> is specifically constructed in a way that it is &quot;rare,&quot; it could still be frequent enough where if we used a bignum, I wouldn't be shocked if that caused perf problems in some workloads. But even that may not be a show-stopper, since we could add a third <code>VersionFullLarge</code> variant that handles the case where the parsed integer is bigger than what is natively supported. It would add some moderate complexity overall, but nothing sticks out to me as being infeasible.</p>
<p>With that said, at a higher level, it's not clear that it's worth supporting integers bigger than <code>2^64 - 1</code>. @dschneiderch Do you have a work-around for this, or does this block adoption of uv for you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dschneiderch">@dschneiderch</a> on 2024-10-28 18:54</div>
            <div class="timeline-body"><p>Thanks for the response. Yeah, we're good. We just decided to use unixtime
in seconds since epoch . It's unlikely that'll conflict across users and
it's good as int64 for millenia ;)
I was originally just caught off guard by the restriction .</p>
<p>On Mon, Oct 28, 2024, 06:22 Andrew Gallant <em><strong>@</strong></em>.***&gt; wrote:</p>
<blockquote>
<p>I think an experiment here could be warranted. My understanding here is
that VersionFull is the &quot;slow&quot; path, where VersionSmall is the fast path.
We wouldn't change VersionSmall, but rather, change VersionFull. The
problem, I think, is that even though VersionFull is specifically
constructed in a way that it is &quot;rare,&quot; it could still be frequent enough
where if we used a bignum, I wouldn't be shocked if that caused perf
problems in some workloads. But even that may not be a show-stopper, since
we could add a third VersionFullLarge variant that handles the case where
the parsed integer is bigger than what is natively supported. It would add
some moderate complexity overall, but nothing sticks out to me as being
infeasible.</p>
<p>With that said, at a higher level, it's not clear that it's worth
supporting integers bigger than 2^64 - 1. @dschneiderch
<a href="https://github.com/dschneiderch">https://github.com/dschneiderch</a> Do you have a work-around for this, or
does this block adoption of uv for you?</p>
<p>—
Reply to this email directly, view it on GitHub
<a href="https://github.com/astral-sh/uv/issues/8271#issuecomment-2441577903">https://github.com/astral-sh/uv/issues/8271#issuecomment-2441577903</a>, or
unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/ABY5SZLGBP32XZPD53D3HHTZ5Y3CBAVCNFSM6AAAAABQCLBO5SVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDINBRGU3TOOJQGM">https://github.com/notifications/unsubscribe-auth/ABY5SZLGBP32XZPD53D3HHTZ5Y3CBAVCNFSM6AAAAABQCLBO5SVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDINBRGU3TOOJQGM</a>
.
You are receiving this because you were mentioned.Message ID:
<em><strong>@</strong></em>.***&gt;</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9572.html">astral-sh/uv#9572</a> on 2024-12-02 09:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:00 UTC
    </footer>
</body>
</html>
