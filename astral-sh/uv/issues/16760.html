<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip install`: option to only install dependencies of a given package (without package itself) - astral-sh/uv #16760</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv pip install</code>: option to only install dependencies of a given package (without package itself)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16760">#16760</a>
        opened by <a href="https://github.com/paveldikov">@paveldikov</a>
        on 2025-11-17 15:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/paveldikov">@paveldikov</a> on 2025-11-17 15:06</div>
            <div class="timeline-body"><h3>Summary</h3>
<h1>Use case</h1>
<p>I am building a container image of my project. I have previously built my project into a wheel.
I am using <code>uv pip install</code> to install the wheel into my container.</p>
<p>Currently my process works along the lines of</p>
<pre><code>RUN uv pip install /mnt/my-wheel.whl -c /mnt/constraints.txt
</code></pre>
<p>This creates <em>one layer</em> with everything. I would like to separate it into <em>two</em>, in order to be able to beneift from reproducible layer builds, and ultimately deduplicate storage/data xfer on the registry end.</p>
<h1>Example CLI interface</h1>
<p>The end result would look something like:</p>
<pre><code>RUN uv pip install /mnt/my-wheel.whl --only-deps -c /mnt/constraints.txt
RUN uv pip install /mnt/my-wheel.whl --no-deps
</code></pre>
<h1>Why not {...}?</h1>
<p><strong>Why not just install <code>constraints.txt</code>?</strong> Because it also includes the dev toolchain, and other irrelevant extras.</p>
<p><strong>Why not use 'proper' lockfiles and <code>--no-package</code>?</strong> Maturity. In the long run, I'd be using <code>uv pip sync</code> and PEP 751 lockfiles, but I need a stopgap until tooling support is at feature parity with constraints files. I'd need both <code>pip</code> and <code>uv</code> to support them pretty exhaustively for me to be able to adopt them.</p>
<p>This is also partly why I can't use <code>uv.lock</code> -- the format is unique to <code>uv</code> and I can't (easily) bootstrap it from <code>pip</code>.</p>
<p><strong>I <em>could</em> use <code>uv pip compile</code> in a JIT style</strong>: compiling wheel + constraints into a whittled-down lockfile, that I then modify out-of-band to remove the top-level package. This would work, although it would be quite an inelegant and brittle solution.</p>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @paveldikov on 2025-11-17 15:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dwt">@dwt</a> on 2025-12-02 20:15</div>
            <div class="timeline-body"><p>I would also like this, but in the meantime I have worked around this by using <code>requirements.txt</code> files for the dependencies, and just installing that in its own layer. Not having to do that would be useful though.</p>
<p>The workaround of generating a dependencies file with <code>uv pip compile &gt; requirements.txt</code> file is also valid though, as it is easily scripted.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dwt">@dwt</a> on 2025-12-02 20:20</div>
            <div class="timeline-body"><p>And now I just noticed that <code>uv pip install -r pyproject.toml</code> does exactly what we want. I think this can be closed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paveldikov">@paveldikov</a> on 2025-12-03 10:03</div>
            <div class="timeline-body"><p>No, I do not think that would work for my use case -- I do not have access to the project's source code in this context. (The project has been built into a wheel a long time ago by this stage in the pipeline.)</p>
<p>The <code>uv pip compile</code> trick <em>does</em> work as mentioned before, but it makes the resulting Containerfile:</p>
<ol>
<li>ridiculously hard to read/troubleshoot (therefore: fragile!)</li>
<li>less efficient to execute:<ul>
<li>I am now running two <code>uv pip {compile,install}</code> commands, one after the other (well, one piped into the other, but since <code>install</code> waits for <code>compile</code> to be done, it's serialised anyway)</li>
<li>...since I am running both commands with <code>UV_NO_CACHE</code> (as is standard practice for container builds)...</li>
<li>...this means that I now have 2x the downloads happening from the package index</li>
</ul>
</li>
</ol>
<p>(I could mitigate 2) by dropping <code>UV_NO_CACHE</code> and instead mounting a dedicated <code>tmpfs</code> cache... this would exacerbate 1) )</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dwt">@dwt</a> on 2025-12-06 11:27</div>
            <div class="timeline-body"><p>So... you do have a wheel, and only want to install its dependencies? Basically like <code>--no-deps</code>, but <code>--only-deps</code>?</p>
<p>On the other hand, why not bring in the pyproject.toml as artifact into the docker file? It probably is way easier than getting the <code>pip compile</code> thing working.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:10 UTC
    </footer>
</body>
</html>
