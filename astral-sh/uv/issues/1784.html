<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Any way to create a stdlib style venv instead of virtualenv style? - astral-sh/uv #1784</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Any way to create a stdlib style venv instead of virtualenv style?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/1784">#1784</a>
        opened by <a href="https://github.com/wimglenn">@wimglenn</a>
        on 2024-02-20 21:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/wimglenn">@wimglenn</a> on 2024-02-20 21:27</div>
            <div class="timeline-body"><p>I wonder if it is possible to ask <code>uv venv</code> for a <a href="https://docs.python.org/3/library/venv.html">stdlib venv</a> style env instead of a <a href="https://github.com/pypa/virtualenv">virtualenv</a> style one?</p>
<p>The latter registers a new <code>meta_path</code> importer which I don't really want in my envs (it makes every import statement a little bit slower).</p>
<pre><code>$ uv venv -q .venv1
$ python3 -m venv .venv2
$ .venv1/bin/python3 -c 'import sys; print(sys.meta_path)'
[&lt;_virtualenv._Finder object at 0x7ffff6f99c10&gt;, &lt;class '_frozen_importlib.BuiltinImporter'&gt;, &lt;class '_frozen_importlib.FrozenImporter'&gt;, &lt;class '_frozen_importlib_external.PathFinder'&gt;]
$ .venv2/bin/python3 -c 'import sys; print(sys.meta_path)'
[&lt;class '_frozen_importlib.BuiltinImporter'&gt;, &lt;class '_frozen_importlib.FrozenImporter'&gt;, &lt;class '_frozen_importlib_external.PathFinder'&gt;]
</code></pre>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mitsuhiko">@mitsuhiko</a> on 2024-02-20 21:32</div>
            <div class="timeline-body"><p>While it's true to that it makes the imports a tiny bit slower, I wonder how the stdlib avoids this finder. It exists to solve specific issues with distutils and setuptools.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wimglenn">@wimglenn</a> on 2024-02-20 21:35</div>
            <div class="timeline-body"><p>Maybe they don't? Not sure.
My env is externally managed, and it's Python 3.12+ so the stdlib distutils is gone.
I don't have setuptools/distutils installed in the env so there is no issue for the finder to solve (but still the check happens on every import statement).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mitsuhiko">@mitsuhiko</a> on 2024-02-20 21:39</div>
            <div class="timeline-body"><p>I have been trying to get rid of this finder in rye for a while and I have not found a good alternative. You can find some history and related links to it: https://github.com/pypa/virtualenv/pull/1688</p>
<p>I really wish this hack was not necessary but I'm not aware of a much better one. It might be interesting to see if that <code>.pth</code> can be placed only when <code>setuptools</code> or <code>distutils</code> are in the venv.</p>
<p>I really don't like giving the user a flag to shoot themselves in the foot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2024-02-21 00:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @zanieb on 2024-02-21 00:21</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:23 UTC
    </footer>
</body>
</html>
