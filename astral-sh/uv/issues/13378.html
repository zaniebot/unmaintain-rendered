<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What's the recommended way to install &amp; run with 2 arch under MacOS? - astral-sh/uv #13378</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>What's the recommended way to install &amp; run with 2 arch under MacOS?</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/13378">#13378</a>
        opened by <a href="https://github.com/freelancerhc">@freelancerhc</a>
        on 2025-05-10 12:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/freelancerhc">@freelancerhc</a> on 2025-05-10 12:37</div>
            <div class="timeline-body"><h3>Question</h3>
<p>We have a set of scripts which need to run under both arm64 and x86_64 on MacOS for different tasks, before moving to uv, we use pip &amp; venv to manage it in separate venv like below:</p>
<pre><code>arch=arm64 (or x86_64)
python3 -m venv &quot;$arch&quot;
source &quot;$arch/bin/activate&quot;
arch -&quot;$arch&quot; pip3 install -r requirements-freeze.txt
arch -&quot;$arch&quot; python3 start.py
</code></pre>
<p>When I tried to migrate to uv, I found uv seems to not respect the process arch to determine which arch of the pypi packages to be installed, and I do find this https://github.com/astral-sh/uv/issues/2326, so I guess uv only use the python interpreter arch to determine, then I tried to use <code>uv python list</code> on some of machines, and I do get different results like below, but both machine are setup with same ansible playbook, so I would like to ask for what's the recommended way for my case to install the packages with given arch?</p>
<p><img width="1244" alt="Image" src="https://github.com/user-attachments/assets/4b03a28d-6acf-4fa4-991f-8811ccf33b78" /></p>
<p><img width="1521" alt="Image" src="https://github.com/user-attachments/assets/adc5a543-1266-4446-b4f8-b7f78c19d0d9" /></p>
<p><img width="1534" alt="Image" src="https://github.com/user-attachments/assets/c30e2b36-2fa3-41bb-aa29-0d52b5fac95e" /></p>
<p>And, another tricky thing I found is that, if I run with <code>arch -x86_64 python3 -m uv python list</code>, both machines can detect the python 3.9.6 as x86_64 instead of arm64, but 3.9.13 is always detected as the same. The 3.9.13 is an universal build downloaded from https://www.python.org/ftp/python/3.9.13/python-3.9.13-macos11.pkg, and the 3.9.6 is MacOS builtin.</p>
<p><img width="1236" alt="Image" src="https://github.com/user-attachments/assets/cf0515c0-7e24-4cbb-99a0-ed70022c7393" /></p>
<h3>Platform</h3>
<p>MacOS Sonoma</p>
<h3>Version</h3>
<p>uv 0.7.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @freelancerhc on 2025-05-10 12:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cudmore">@cudmore</a> on 2025-08-02 15:51</div>
            <div class="timeline-body"><p>I am curious how to do this as well.</p>
<p>I need to create two different venv, one for x86 and the other for arm64.</p>
<p>I am then running pyinstaller to build 2 apps, one for mac intel and a second for apple silicon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/axman6">@axman6</a> on 2025-08-13 05:06</div>
            <div class="timeline-body"><p>We also need to be able to do this, we create self contained binaries using pyinstaller, and currently need a frankensteinian process of installing dependencies with C code using <code>pip</code> to ensure that the universal binary made by pyinstaller can be executed. We're currently using a build that looks like this:</p>
<pre><code class="language-yaml">    - uv venv venv # Use macOS' python so we can have univeral installer
    - source venv/bin/activate
    # install pip because uv pip doesn't know about --platform
    - python -m ensurepip --upgrade
    - pip3 install zstandard zeroconf --target venv  --upgrade --platform=arm64 --platform=x86_64 --no-deps --no-cache-dir
    - uv pip install pyinstaller .
    - pyinstaller --name=foo foo/main.py --add-binary=&quot;./executables/mac/somebinary:backend&quot; --target-arch=universal2
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:27 UTC
    </footer>
</body>
</html>
