<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Decord package will uninstall and install when running uv sync - astral-sh/uv #15832</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Decord package will uninstall and install when running uv sync</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/15832">#15832</a>
        opened by <a href="https://github.com/HarborYuan">@HarborYuan</a>
        on 2025-09-14 06:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/HarborYuan">@HarborYuan</a> on 2025-09-14 06:05</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hi,</p>
<p>I have a pyproject.toml file like this.</p>
<pre><code class="language-config">[project]
name = &quot;test&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [
    &quot;decord&gt;=0.6.0&quot;,
]
</code></pre>
<p>However, everytime I run &quot;uv sync&quot; or &quot;uv run&quot;, it will uninstall the decord package and reinstall the decord package.</p>
<pre><code class="language-output">Resolved 3 packages in 20ms
Uninstalled 1 package in 32ms
Installed 1 package in 78ms
 ~ decord==0.6.0
</code></pre>
<h3>Platform</h3>
<p>Linux 6.8.0-64-generic x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>0.8.15</p>
<h3>Python version</h3>
<p>Python 3.11.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @HarborYuan on 2025-09-14 06:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-14 11:01</div>
            <div class="timeline-body"><p>Can you share the verbose logs from <code>uv sync -v</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/HarborYuan">@HarborYuan</a> on 2025-09-14 23:49</div>
            <div class="timeline-body"><p>Hi @konstin ,</p>
<pre><code>DEBUG uv 0.8.15
DEBUG Found project root: `/home/haobo/code/dev/test`
DEBUG No workspace root found, using project root
DEBUG Acquired lock for `/home/haobo/code/dev/test`
DEBUG Reading Python requests from version file at `/home/haobo/code/dev/test/.python-version`
DEBUG Using Python request `3.12` from version file at `.python-version`
DEBUG Checking for Python environment at: `.venv`
DEBUG The project environment's Python version satisfies the request: `Python 3.12`
DEBUG Released lock at `/tmp/uv-ad72d244d41ec98d.lock`
DEBUG Acquired lock for `.venv`
DEBUG Using request timeout of 30s
DEBUG Found static `pyproject.toml` for: test @ file:///home/haobo/code/dev/test
DEBUG No workspace root found, using project root
DEBUG Existing `uv.lock` satisfies workspace requirements
Resolved 3 packages in 13ms
DEBUG Using request timeout of 30s
DEBUG Platform tags mismatch for decord: decord==0.6.0
DEBUG Requirement installed, but mismatched:
  Installed: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;decord&quot;), version: &quot;0.6.0&quot;, path: &quot;/home/haobo/code/dev/test/.venv/lib/python3.12/site-packages/decord-0.6.0.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(Some(ExpandedTags([Small { small: WheelTagSmall { python_tag: CPython { python_version: (3, 6) }, abi_tag: CPython { gil_disabled: false, python_version: (3, 6) }, platform_tag: Manylinux2010 { arch: X86_64 } } }]))) }
  Requested: Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;0.6.0&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Registry requirement already cached: decord==0.6.0
DEBUG Requirement already installed: numpy==2.3.3
DEBUG Uninstalled decord (60 files, 12 directories)
Uninstalled 1 package in 30ms
Installed 1 package in 69ms
 ~ decord==0.6.0
DEBUG Released lock at `/home/haobo/code/dev/test/.venv/.lock`
</code></pre>
<p>I think it may be because of the decord packages are not following the standard platform flags.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../dmlc/decord/issues/356.html">dmlc/decord#356</a> on 2025-09-15 07:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @konstin on 2025-09-15 07:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">external</span> added by @konstin on 2025-09-15 07:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-15 07:36</div>
            <div class="timeline-body"><p>Thanks for the logs! This is a problem with the decord wheel: https://github.com/dmlc/decord/issues/356</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/HarborYuan">@HarborYuan</a> on 2025-09-15 07:48</div>
            <div class="timeline-body"><p>Hi @konstin ,</p>
<p>Thanks for your help. Does uv currently have tag-override feature similar to the dependency?</p>
<p>e.g.,</p>
<pre><code>[[tool.uv.dependency-metadata]]
name = &quot;flash-attn&quot;
version = &quot;2.6.3&quot;
requires-dist = [&quot;torch&quot;, &quot;einops&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-15 07:53</div>
            <div class="timeline-body"><p>This is the first time we're encountering this problem, there's no override for it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/HarborYuan">@HarborYuan</a> on 2025-09-15 08:02</div>
            <div class="timeline-body"><p>Ok I see. Hope the decord maintainers can fix this bug.</p>
<p>I also think this should not be common if using packaging tools to build the python wheel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fadedDexofan">@fadedDexofan</a> on 2025-09-24 15:33</div>
            <div class="timeline-body"><p>Same issue with <a href="https://pypi.org/project/yggdrasil-engine/">yggdrasil-engine</a>:</p>
<pre><code>...
DEBUG Platform tags mismatch for yggdrasil-engine==1.0.0: The distribution is compatible with `abi3`, but you're using CPython 3.13 (`cp313`)
...
Uninstalled 1 package in 0.67ms
Installed 1 package in 1ms
 ~ yggdrasil-engine==1.0.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-25 09:02</div>
            <div class="timeline-body"><p>@fadedDexofan Could you check if it's the same shape of problem as https://github.com/dmlc/decord/issues/356, and if that's the case, report it upstream?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/HarborYuan">@HarborYuan</a> on 2025-09-25 10:59</div>
            <div class="timeline-body"><p>@konstin Is that possible to add an override feature in uv to circumvent that?</p>
<p>Sometimes, maybe even though the python or OS is not matching, I know the package is suitable for my environment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-25 11:16</div>
            <div class="timeline-body"><p>This should be fixed in the package build itself rather than overriding it in uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hiromon0125">@hiromon0125</a> on 2025-10-03 15:27</div>
            <div class="timeline-body"><p>I also have the same issue, but the package works when I run it. I just wish uv had a way for the dependency to stop being reinstalled every time I run <code>uv run</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-10-03 18:41</div>
            <div class="timeline-body"><p>If uv did have a way to override, users would most likely just enable it without pushing upstream packages to fix their broken distribution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hiromon0125">@hiromon0125</a> on 2025-10-03 19:14</div>
            <div class="timeline-body"><p>I understand that, but I also think having it reinstall on every run that never gets resolved is not ideal either.
I would prefer it to be a configuration with a warning message if uv does detect an unsupported version. That way its great for regular dev that doesn't contribute to the package to use older packages that may have partial support or get by temporary.
The reinstallation message on <code>uv run</code> is also just not friendly to be honest because I don't actually know what's being reinstalled unless I use <code>uv sync</code> with the verbose flag.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:12 UTC
    </footer>
</body>
</html>
