<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uvx --from git+https://....git@... ignores the lockfile - astral-sh/uv #13414</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uvx --from git+https://....git@... ignores the lockfile</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13414">#13414</a>
        opened by <a href="https://github.com/Ark-kun">@Ark-kun</a>
        on 2025-05-12 19:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Ark-kun">@Ark-kun</a></div>
            <div class="timeline-body">Summary
<p>I have a CLI project.
My customers run it via <code>uv run --refresh --frozen --with git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 oasis</code> or <code>uvx --from git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 oasis</code></p>
<p>It has a <code>uv.lock</code> lockfile with <code>click==8.1.8</code>.
https://github.com/Cloud-Pipelines/oasis-cli/blob/5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154/uv.lock#L77
Despite that, uv run always installs <code>click==8.2.0</code> which is a broken release.</p>
<pre><code>uvx --from git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 python -c &quot;import click; print(click.__version__)&quot;
    Updated https://github.com/Cloud-Pipelines/oasis-cli.git (5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154)
8.2.0
</code></pre>
<pre><code>% uv run --refresh --exact --with git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 python -c &quot;import click; print(click.__version__)&quot; 
    Updated https://github.com/Cloud-Pipelines/oasis-cli.git (5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154)
Installed 29 packages in 16ms
8.2.0
</code></pre>
<pre><code>% uv run --refresh --frozen --with git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 python -c &quot;import click; print(click.__version__)&quot; 
    Updated https://github.com/Cloud-Pipelines/oasis-cli.git (5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154)
Installed 29 packages in 18ms
8.2.0
</code></pre>
<pre><code>% uv run --refresh --locked --with git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 python -c &quot;import click; print(click.__version__)&quot; 
    Updated https://github.com/Cloud-Pipelines/oasis-cli.git (5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154)
Installed 29 packages in 18ms
8.2.0
</code></pre>
<p>This seems problematic. I&#x27;ve pinned everything. I&#x27;m using exact pinned SHA commit and uv.lock. And yet the package got broken over the weekend.</p>
Platform
<p>macOS 15</p>
Version
<p>0.7.0</p>
Python version
<p>Python 3.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/Ark-kun">@Ark-kun</a> on 2025-05-12 19:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-12 19:45</div>
            <div class="timeline-body"><p>Please don&#x27;t post multiple times. See my other comment at <a href="https://github.com/astral-sh/uv/issues/13410">astral-sh/uv#13410</a>#issuecomment-2873773771</p>
<p>Your customers will need to add that as a dependency (<code>uv add</code>) in order to have pinned dependencies. <code>uv.lock</code> files (and, more broadly, <em>any</em> lockfile) are not a part of the package installation standard. The <em>local</em> <code>uv.lock</code> file in the project where <code>uv run</code> is used is what is relevant here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-12 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-12 19:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-12 19:47</div>
            <div class="timeline-body"><p>Replying to</p>
<blockquote>
<p>Is there any way I can let users run my app with versions pinned to prevent breakages like the ongoing clock incident?</p>
</blockquote>
<p>You&#x27;ll need to pin all the versions in your <code>pyproject.toml</code> so it&#x27;s reflected in the distribution metadata. This is tedious, but the only standards compliant method right now. <code>uv export | uv add -r -</code> will do it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/Ark-kun">@Ark-kun</a> on 2025-05-12 19:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by <a href="https://github.com/Ark-kun">@Ark-kun</a> on 2025-05-12 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ark-kun">@Ark-kun</a> on 2025-05-12 19:58</div>
            <div class="timeline-body"><p>I guess I was just using <code>uv run --with</code> instead of <code>uvx --from</code>.
Anyways,</p>
<pre><code>uvx --from git+https://github.com/Cloud-Pipelines/oasis-cli.git@5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154 python -c &quot;import click; print(click.__version__)&quot;
    Updated https://github.com/Cloud-Pipelines/oasis-cli.git (5625f4ef1b4c6de65bee913c3cc31bf1cb1c3154)
8.2.0
</code></pre>
<blockquote>
<p>If you want to pin the dependencies of oasis-cli, then add it as a dependency to your project instead of using --with.</p>
</blockquote>
<blockquote>
<p>For now, you can specify click in your pyproject.toml</p>
</blockquote>
<p>unfortunately, there is no project. I&#x27;m basically doing <code>uvx</code>.</p>
<blockquote>
<p>Yeah, we don&#x27;t support that yet. Installations from remote source trees (like Git) still currently go through the fully &quot;standardized&quot; package build and install path â€” which does not allow for tool-specific metadata to have an effect.</p>
</blockquote>
<p>I see. Just brainstorming. Is there any way I can let users run my app with versions pinned to prevent breakages like the ongoing clock incident?</p>
<p>https://github.com/pallets/click/issues/2908
https://github.com/fastapi/typer/discussions/1215
<a href="https://github.com/modelcontextprotocol/python-sdk/issues/688">modelcontextprotocol/python-sdk#688</a>
<a href="https://github.com/ai-dynamo/dynamo/issues/1039">ai-dynamo/dynamo#1039</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;uv run --refresh --locked --with git+https://....git@... ignores the lockfile&quot; to &quot;uvx --from git+https://....git@... ignores the lockfile&quot; by <a href="https://github.com/Ark-kun">@Ark-kun</a> on 2025-05-12 19:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ark-kun">@Ark-kun</a> on 2025-05-12 20:00</div>
            <div class="timeline-body"><blockquote>
<p>Please don&#x27;t post multiple times.</p>
</blockquote>
<p>Sorry about that. Thank you for you patience. I posted in that thread, then thought that maybe a separate issue would have been better.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-12 20:01</div>
            <div class="timeline-body"><p>It&#x27;s alright! Just makes it hard to tell where to respond :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-13 18:00</div>
            <div class="timeline-body"><p>Let&#x27;s track this in <a href="https://github.com/astral-sh/uv/issues/5815">astral-sh/uv#5815</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-13 18:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:36 UTC
    </footer>
</body>
</html>
