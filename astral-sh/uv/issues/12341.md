```yaml
number: 12341
title: An error occurs when switching to the commit
type: issue
state: closed
author: Wintreist
labels:
  - bug
  - windows
assignees: []
created_at: 2025-03-20T15:53:14Z
updated_at: 2025-03-20T16:31:39Z
url: https://github.com/astral-sh/uv/issues/12341
synced_at: 2026-01-10T01:57:28Z
```

# An error occurs when switching to the commit

---

_Issue opened by @Wintreist on 2025-03-20 15:53_

### Summary

```
PS E:\ROBO\Repositories\my_repo\tc_hub> uv add -U git+ssh://git@host/qa/my_repo.git#subdirectory=vm_hub --branch=my_branch
   Updating ssh://git@host/qa/my_repo.git (my_branch)
error: Git operation failed
  Caused by: process didn't exit successfully: `C:\Program Files\Git\cmd\git.exe reset --hard 9868272c464ec2f075aa0a08bf1badf364cfd969` (exit code: 128)
--- stderr
warning: unable to access 'tc_hub/src/tc_hub/server/queue_manager/pyqt_client/main_window/tab/tests_selector_widget/product_templates/win10_devx_template/.gitattributes': Filename too long
warning: unable to access 'tc_hub/src/tc_hub/server/queue_manager/pyqt_client/main_window/tab/tests_selector_widget/product_templates/win10_hotfix_release_template/.gitattributes': Filename too long
fatal: cannot create directory at 'tc_hub/src/tc_hub/server/queue_manager/pyqt_client/main_window/tab/tests_selector_widget/product_templates/win10__prestable_new_template': Filename too long
```
I'm trying to add a dependency for my project.
I'm in tc_hub, and I'm in the my_branch branch.
For some reason, when the queue reaches vm_hub dependency, an error occurs.
I looked that the problem is in the cache:
`C:\Users\wintreist\AppData\Local\uv\cache\git-v0\checkouts\e551289a4868813a\9868272c4\tc_hub\src\tc_hub\server\queue_manager\pyqt_client\main_window\tab\tests_selector_widget\product_templates`
The transition to the commit stops here.
I cloned my repository to another location, and did a `git.exe reset --hard 9868272c464ec2f075aa0a08bf1badf364cfd969` there, and I succeeded. So I think there's some kind of UV problem here.
At the same time, if my project is already added as a dependency, then everything is fine (even if I manually enter the vm_hub I need into pyproject.toml)

### Platform

Windows 10 x86_64

### Version

uv 0.6.8

### Python version

Python 3.12.2

---

_Label `bug` added by @Wintreist on 2025-03-20 15:53_

---

_Label `windows` added by @zanieb on 2025-03-20 16:02_

---

_Comment by @zanieb on 2025-03-20 16:06_

Unfortunately Windows has a very low path length limit. It's likely that the uv cache directory is just introducing a longer initial path than when you check it out elsewhere? I'd recommend using `UV_CACHE_DIR` to move the uv cache to `C:\uv-cache` to see if that gets you below the limit? We're exploring solutions to this, but it's hard.

---

_Comment by @Wintreist on 2025-03-20 16:23_

Yes, it really helped me. Thanks! It's a pity that Windows does this.

Do I need to close the task?

---

_Comment by @zanieb on 2025-03-20 16:31_

I can close it; thanks!

Related #2410 

---

_Closed by @zanieb on 2025-03-20 16:31_

---
