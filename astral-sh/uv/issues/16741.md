```yaml
number: 16741
title: "`uv sync` with a private repo does not work in docker with uv >= 0.98"
type: issue
state: open
author: morbatex
labels:
  - bug
  - external
assignees: []
created_at: 2025-11-14T17:47:48Z
updated_at: 2026-01-06T19:20:59Z
url: https://github.com/astral-sh/uv/issues/16741
synced_at: 2026-01-10T01:57:37Z
```

# `uv sync` with a private repo does not work in docker with uv >= 0.98

---

_Issue opened by @morbatex on 2025-11-14 17:47_

### Summary

When using `uv sync` in docker with uv >=  0.99 the with a private repo the following error occurs in some cases:

```
uv sync --no-dev --frozen --no-install-project
Using CPython 3.13.9 interpreter at: /usr/local/bin/python3
Creating virtual environment at: .venv
× Failed to download `hexaly==14.0.20251029`
├─▶ Failed to fetch:
│   `https://pip.hexaly.com/hexaly/hexaly-14.0.20251029-py2.py3.py27.py36.py37.py38.py39.py310.py311.py312.py313.py314-none-linux_x86_64.whl`
├─▶ Request failed after 3 retries
├─▶ error sending request for url
│   (https://pip.hexaly.com/hexaly/hexaly-14.0.20251029-py2.py3.py27.py36.py37.py38.py39.py310.py311.py312.py313.py314-none-linux_x86_64.whl)├─▶ client error (Connect)
├─▶ dns error
╰─▶ failed to lookup address information: Name does not resolve
help: `hexaly` (v14.0.20251029) was included because `optimization` (v0.1.0)
depends on `hexaly`
```

As stated this only happens in some cases. I encountered it only when running `docker build` inside in a docker based gitlab runner. When executing the same build locally or without gitlab-ci on the same machine as the gitlab runner it works flawless.
 

<details>

<summary>Docker file</summary>

```
ARG PYTHON_VERSION
FROM python:3.13.3-slim

COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

ENV UV_COMPILE_BYTECODE=1
ENV UV_LINK_MODE=copy
ENV UV_CACHE_DIR=/root/.cache/uv

WORKDIR /app
COPY uv.lock backend/pyproject.toml ./
# install just the requirements
RUN --mount=type=cache,target=/root/.cache/uv \
    uv sync --no-dev --frozen --no-install-project

COPY backend .
# install the project again to make sure scripts are working
RUN --mount=type=cache,target=/root/.cache/uv \
    uv sync --no-dev --frozen

EXPOSE 80
ENTRYPOINT ["entrypoint"]
```

</details>

<details>

<summary>pyproject.toml</summary>

```
[project]
name = "optimization"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.13"
dependencies = [
    "hexaly>=14.0",
]

[tool.uv.sources]
hexaly = { index = "hexaly" }

[[tool.uv.index]]
name = "hexaly"
url = "https://pip.hexaly.com/"
explicit = true
```
</details>

As this is only happening in the pipeline and I am not able to reproduce it outside of it I cannot provide more information regarding reproduction.  If I can assist with any information, I will gladly provide them.

If I change the dockerfile so that `pip install uv` is used to install uv, the build works without problems.

As the uv version copied from the docker image is linked against musl and the one istalled via pip is linked against glibc, I assume that the issue is somehow caused by musl in specific environments.

Furthermore as 0.97 worked and 0.98 does not work anymore I assume that the [switch](https://github.com/astral-sh/uv/pull/16584) from musl 1.24 to 1.25 introduced this, while fixing a similar [issue](https://github.com/astral-sh/uv/issues/8450).

### Platform

Linux 6.14.0-35-generic x86_64 GNU/Linux

### Version

uv 0.9.9

### Python version

Python 3.13.3

---

_Label `bug` added by @morbatex on 2025-11-14 17:47_

---

_Comment by @zanieb on 2025-11-14 18:05_

That's quite unfortunate.

You can also use our standalone installer (i.e., `curl ..`) instead of `pip` to workaround this.


---

_Comment by @zanieb on 2025-11-14 18:08_

As a note.... While I appreciate the report, I think the resolution here will be to file an issue against musl and hexaly — there's nothing we're going to be able to do here in uv.

---

_Comment by @Linnore on 2025-11-21 10:33_

Encounter the same problem here. UV will not fall back to other indexes (e.g. pypi) if it fails to connect to the private index.

---

_Comment by @konstin on 2025-11-28 08:46_

@Linnore That's a security feature, we don't want to use a public package where a private one should be used due to e.g. unstable internet, or because the private server is temporarily down.

---

_Comment by @hrushikesh-hd1-tfs on 2025-12-26 20:49_

Any update on this?? I am using `ghcr.io/astral-sh/uv:0.9.5` the sync fails to install private packages while building the image.

---

_Label `external` added by @konstin on 2026-01-06 19:20_

---
