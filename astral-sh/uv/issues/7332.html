<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinning system dependencies in pyproject.toml - astral-sh/uv #7332</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Pinning system dependencies in pyproject.toml</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/7332">#7332</a>
        opened by <a href="https://github.com/thepowerfuldeez">@thepowerfuldeez</a>
        on 2024-09-12 14:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/thepowerfuldeez">@thepowerfuldeez</a></div>
            <div class="timeline-body"><p>Hi! I have a question which is related to using NGC Docker image with pre-release torch2.5.0 included.
Version inside docker container (which comes with pre-installed CUTLASS, CUDNN and are of correct versions) is 2.5.0a0+872d972e41.nv24.08</p>
<p>This version is not resolvable if I add it directly to pyproject.toml in a list of dependencies. If I change to torch2.4.0 stable then all set of requirements from this torch version will be downloaded (including cuda bindings, etc). This might break compiled CUDA libraries that were included inside docker image, and increase install time.</p>
<p>Current approach:</p>
<ol>
<li>Use docker image <code>nvcr.io/nvidia/pytorch:24.08-py3</code></li>
<li>Set <code>UV_SYSTEM_PYTHON=1</code></li>
<li>Install dependencies with lower level uv pip cmd: <code>uv pip install --system -r pyproject.toml</code></li>
</ol>
<p>Problem with that approach is that library versions are not explicitly pinned, and it&#x27;s not usable in production settings. I would like to add pre-release installed torch version to pyproject.toml, let is resolve dependencies when I run <code>uv lock</code> and then use higher-level project management command <code>uv sync</code> to sync with lockfile. I could still use system python to circumvent setting up required venv, since there&#x27;s conda env inside docker image with installed libraries.</p>
<p>Required featues:</p>
<ol>
<li>Setting up pre-release and installed libraries inside system python</li>
<li>Running <code>uv lock --system</code> and <code>uv sync --system</code> to use system python and not install existing libraries (how it&#x27;s done with <code>uv pip install --system</code> at the moment.</li>
</ol>
<p>Thank you very much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thepowerfuldeez">@thepowerfuldeez</a> on 2024-09-16 20:38</div>
            <div class="timeline-body"><p>@charliermarsh do you have an opinion?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thepowerfuldeez">@thepowerfuldeez</a> on 2024-09-24 16:33</div>
            <div class="timeline-body"><p>Hi @zanieb @konstin @charliermarsh , what do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-24 16:36</div>
            <div class="timeline-body"><p>@thepowerfuldeez please don&#x27;t ping us repeatedly. We don&#x27;t have an obvious answer to this.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:33:58 UTC
    </footer>
</body>
</html>
