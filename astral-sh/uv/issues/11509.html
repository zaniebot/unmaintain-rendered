<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv add package upgrade doesn't work - astral-sh/uv #11509</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv add package upgrade doesn't work</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11509">#11509</a>
        opened by <a href="https://github.com/sglbl">@sglbl</a>
        on 2025-02-14 14:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sglbl">@sglbl</a> on 2025-02-14 14:09</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I'm sorry for opening this issue here maybe there is a really simple solution. But I cannot find it in documentation.
I want to upgrade my package to the latest version and at the same time updating pyproject.toml file.</p>
<p><img src="https://github.com/user-attachments/assets/a9824524-da9b-45c6-9da6-813ec5e5bc4f" alt="Image" /></p>
<p><img src="https://github.com/user-attachments/assets/e60b447e-d588-49d8-ad23-8a0fda3ba031" alt="Image" /></p>
<p>But it doesn't update to the latest version.
<code>uv pip install haystack-ai --upgrade</code> command upgrades but it doesn't update toml file.</p>
<h3>Platform</h3>
<p>Linux 6.11.0-17-generic 24.04.2-Ubuntu SMP PREEMPT_DYNAMIC x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>0.5.31</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @sglbl on 2025-02-14 14:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-14 15:22</div>
            <div class="timeline-body"><p>Can you please add text versions of the output per #9452</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-14 18:10</div>
            <div class="timeline-body"><p>I don't think <code>uv add -U</code> modifies the version bounds in the <code>pyproject.toml</code>, but it should upgrade the version in the lockfile. Is it necessary for you upgrade the lower-bound in the <code>pyproject.toml</code>? If so, why?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sglbl">@sglbl</a> on 2025-02-15 14:49</div>
            <div class="timeline-body"><blockquote>
<p>I don't think <code>uv add -U</code> modifies the version bounds in the <code>pyproject.toml</code>, but it should upgrade the version in the lockfile. Is it necessary for you upgrade the lower-bound in the <code>pyproject.toml</code>? If so, why?</p>
</blockquote>
<p>@charliermarsh But it doesn't upgrade the package anyway.
So if I wanted to upgrade a package and lock this information do I need to use two commands?</p>
<pre><code class="language-python">uv pip install haystack-ai --upgrade
uv lock --upgrade-package haystack-ai
</code></pre>
<p>Even when I do it doesn't work. It upgrades to 2.10 but doesn't make any change neither on <code>lock </code>or <code>toml</code>.</p>
<pre><code class="language-diff">+sglbl@SGLBLPC11:~/codes/example$ uv lock --upgrade-package haystack-ai
Resolved 39 packages in 194ms
+sglbl@SGLBLPC11:~/codes/example$ cat uv.lock | grep haystack-ai
    { name = &quot;haystack-ai&quot; },
requires-dist = [{ name = &quot;haystack-ai&quot;, specifier = &quot;==2.4.0&quot; }]
name = &quot;haystack-ai&quot;
    { name = &quot;haystack-ai&quot; },
+sglbl@SGLBLPC11:~/codes/example$ uv add -U haystack-ai
Resolved 39 packages in 355ms
Audited 37 packages in 0.01ms
+sglbl@SGLBLPC11:~/codes/example$ cat uv.lock | grep haystack-ai
    { name = &quot;haystack-ai&quot; },
requires-dist = [{ name = &quot;haystack-ai&quot;, specifier = &quot;==2.4.0&quot; }]
name = &quot;haystack-ai&quot;
    { name = &quot;haystack-ai&quot; },
+sglbl@SGLBLPC11:~/codes/example$ uv add haystack-ai --refresh
Resolved 39 packages in 0.79ms
Audited 37 packages in 0.01ms
+sglbl@SGLBLPC11:~/codes/example$ cat uv.lock | grep haystack-ai
    { name = &quot;haystack-ai&quot; },
requires-dist = [{ name = &quot;haystack-ai&quot;, specifier = &quot;==2.4.0&quot; }]
name = &quot;haystack-ai&quot;
    { name = &quot;haystack-ai&quot; },
+sglbl@SGLBLPC11:~/codes/example$ uv pip install haystack-ai --upgrade
Resolved 52 packages in 712ms
Prepared 18 packages in 2.36s
Uninstalled 3 packages in 21ms
Installed 18 packages in 48ms
 + aiohappyeyeballs==2.4.6
 + aiohttp==3.11.12
 + aiosignal==1.3.2
 + async-timeout==5.0.1
 + attrs==25.1.0
 + frozenlist==1.5.0
- haystack-ai==2.4.0
+ haystack-ai==2.10.0
 + jsonref==1.1.0
 + jsonschema==4.23.0
 + jsonschema-specifications==2024.10.1
 + multidict==6.1.0
 - numpy==1.26.4
 + numpy==2.2.3
 + openapi-llm==0.4.1
 - posthog==3.13.0
 + posthog==3.11.0
 + propcache==0.2.1
 + referencing==0.36.2
 + rpds-py==0.22.3
 + yarl==1.18.3
+sglbl@SGLBLPC11:~/codes/example$ cat uv.lock | grep haystack-ai
    { name = &quot;haystack-ai&quot; },
requires-dist = [{ name = &quot;haystack-ai&quot;, specifier = &quot;==2.4.0&quot; }]
name = &quot;haystack-ai&quot;
    { name = &quot;haystack-ai&quot; },
+sglbl@SGLBLPC11:~/codes/example$ uv add -U haystack-ai
Resolved 39 packages in 309ms
Prepared 3 packages in 0.77ms
Uninstalled 3 packages in 22ms
Installed 3 packages in 43ms
 - haystack-ai==2.10.0
 + haystack-ai==2.4.0
 - numpy==2.2.3
 + numpy==1.26.4
 - posthog==3.11.0
 + posthog==3.13.0
+sglbl@SGLBLPC11:~/codes/example$ uv pip install haystack-ai --upgrade
Resolved 52 packages in 339ms
Prepared 3 packages in 0.55ms
Uninstalled 3 packages in 18ms
Installed 3 packages in 37ms
- haystack-ai==2.4.0
+ haystack-ai==2.10.0
 - numpy==1.26.4
 + numpy==2.2.3
 - posthog==3.13.0
 + posthog==3.11.0
+sglbl@SGLBLPC11:~/codes/example$ uv lock --upgrade-package haystack-ai
Resolved 39 packages in 134ms
+sglbl@SGLBLPC11:~/codes/example$ cat uv.lock | grep haystack-ai
    { name = &quot;haystack-ai&quot; },
@@requires-dist = [{ name = &quot;haystack-ai&quot;, specifier = &quot;==2.4.0&quot; }]@@  # there is no change
name = &quot;haystack-ai&quot;
    { name = &quot;haystack-ai&quot; },
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kshpytsya">@kshpytsya</a> on 2025-03-04 16:46</div>
            <div class="timeline-body"><p>I have been looking for uv's equivalent of <a href="https://github.com/MousaZeidBaker/poetry-plugin-up">poetry up</a> (plugin) and this issue seems to be related.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sglbl">@sglbl</a> on 2025-03-05 09:14</div>
            <div class="timeline-body"><blockquote>
<p>I have been looking for uv's equivalent of <a href="https://github.com/MousaZeidBaker/poetry-plugin-up">poetry up</a> (plugin) and this issue seems to be related.</p>
</blockquote>
<p>Yes, thank you @kshpytsya. I didn't know poetry had the same deficiency / lack.<br />
@charliermarsh I checked that repo and there are more 300 stars. I'm sure many uv users would like this feature to be in uv too.  I use uv in <code>--no-package --app</code>  mode so I always need to upgrade some specific packages without touching the others to not create more conflicts.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kshpytsya">@kshpytsya</a> on 2025-03-10 16:37</div>
            <div class="timeline-body"><p>Related #6794</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11973.html">astral-sh/uv#11973</a> on 2025-03-10 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-14 00:46</div>
            <div class="timeline-body"><p>I think you're looking for <code>uv sync --upgrade</code> or <code>uv sync --upgrade-package haystack-ai</code>. You might just be missing the <code>uv sync</code> command here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hoechenberger">@hoechenberger</a> on 2025-03-14 06:14</div>
            <div class="timeline-body"><blockquote>
<p>I think you're looking for <code>uv sync --upgrade</code> or <code>uv sync --upgrade-package haystack-ai</code>. You might just be missing the <code>uv sync</code> command here?</p>
</blockquote>
<p><code>uv sync</code> will only update the lockfile (and venv); I believe OP wants the version boundaries in <code>pyproject.toml</code> bumped, too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zouri">@zouri</a> on 2025-03-14 07:49</div>
            <div class="timeline-body"><p>My solution is</p>
<pre><code>uv pip install haystack-ai --upgrade
uv pip freeze &gt; requirements.txt
uv add -r requirements.txt
uv export --format requirements-txt &gt; requirements.txt
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sglbl">@sglbl</a> on 2025-03-14 08:32</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I think you're looking for <code>uv sync --upgrade</code> or <code>uv sync --upgrade-package haystack-ai</code>. You might just be missing the <code>uv sync</code> command here?</p>
</blockquote>
<p><code>uv sync</code> will only update the lockfile (and venv); I believe OP wants the version boundaries in <code>pyproject.toml</code> bumped, too.</p>
</blockquote>
<p>Thank you. Yes, but in my case it doesn't even update the lockfile. It's still is the same version</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sglbl">@sglbl</a> on 2025-03-14 09:17</div>
            <div class="timeline-body"><blockquote>
<p>My solution is</p>
<pre><code>uv pip install haystack-ai --upgrade
uv pip freeze &gt; requirements.txt
uv add -r requirements.txt
uv export --format requirements-txt &gt; requirements.txt
</code></pre>
</blockquote>
<p>Thank you @zouri, Unfortunately I got this error probably because of another dependency conflict. Normally I didn't have a conflict</p>
<p><img src="https://github.com/user-attachments/assets/471bb0d3-5789-4868-9534-39b8ab32c1b9" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lsaint">@lsaint</a> on 2025-04-23 07:40</div>
            <div class="timeline-body"><p>I supose what we need is a command which is going to update a package to latest version and update pyprject.toml and uv.lock  automatically.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-06-30 23:41</div>
            <div class="timeline-body"><p>I'm going to merge this with https://github.com/astral-sh/uv/issues/6794.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-06-30 23:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sglbl">@sglbl</a> on 2025-07-16 10:48</div>
            <div class="timeline-body"><p>But isn't the issue @charliermarsh mentioned is about upgrading every package.
I just want to upgrade 1 package I specified (for example if I installed it with ==2.4.0, later I want to upgrade it to the latest version)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-16 13:02</div>
            <div class="timeline-body"><p>(That command would also allow upgrading a single package.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sglbl">@sglbl</a> on 2025-07-16 13:39</div>
            <div class="timeline-body"><pre><code class="language-sh">sglbl@deducepc:~/codes$ uv self update
info: Checking for updates...
success: Youre on the latest version of uv (v0.7.21)
sglbl@deducepc:~/codes$ uv init trial &amp;&amp; cd trial
Initialized project `trial` at `/home/sglbl/codes/trial`
sglbl@deducepc:~/codes/trial$ uv add ruff==0.11
Using CPython 3.10.12
Creating virtual environment at: .venv
Resolved 2 packages in 13ms
Installed 1 package in 2ms
 + ruff==0.11.0
sglbl@deducepc:~/codes/trial$ uv sync --upgrade ruff
error: unexpected argument 'ruff' found

Usage: uv sync [OPTIONS]

For more information, try '--help'.
sglbl@deducepc:~/codes/trial$ uv sync --upgrade-package ruff
Resolved 2 packages in 82ms
Audited 1 package in 0.01ms
sglbl@deducepc:~/codes/trial$ uv lock --upgrade-package ruff
Resolved 2 packages in 76ms
sglbl@deducepc:~/codes/trial$ uv add --refresh ruff
Resolved 2 packages in 0.48ms
Audited 1 package in 0.00ms
sglbl@deducepc:~/codes/trial$ uv add --refresh-package ruff
error: the following required arguments were not provided:
  &lt;PACKAGES|--requirements &lt;REQUIREMENTS&gt;&gt;

Usage: uv add --refresh-package &lt;REFRESH_PACKAGE&gt; &lt;PACKAGES|--requirements &lt;REQUIREMENTS&gt;&gt;

For more information, try '--help'.
sglbl@deducepc:~/codes/trial$ uv add --upgrade-package ruff
error: the following required arguments were not provided:
  &lt;PACKAGES|--requirements &lt;REQUIREMENTS&gt;&gt;

Usage: uv add --upgrade-package &lt;UPGRADE_PACKAGE&gt; &lt;PACKAGES|--requirements &lt;REQUIREMENTS&gt;&gt;

For more information, try '--help'.
sglbl@deducepc:~/codes/trial$ ^C
sglbl@deducepc:~/codes/trial$ cat pyproject.toml | grep ruff
    &quot;ruff==0.11&quot;,
sglbl@deducepc:~/codes/trial$ uv pip list | grep ruff
ruff    0.11.0
sglbl@deducepc:~/codes/trial$ cat uv.lock | grep 'name = &quot;ruff&quot;,'
requires-dist = [{ name = &quot;ruff&quot;, specifier = &quot;==0.11&quot; }]
</code></pre>
<p>I tried all of them but still no luck with upgrading ruff to 0.12. I guess I will need to change the file by hand or finding the latest version and install that specifically again.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-16 13:41</div>
            <div class="timeline-body"><p>Yes, there's no way at present to update both the <code>uv.lock</code> and the <code>pyproject.toml</code>. That's why the linked issue exists :)</p>
<p>As an aside, it's typical to put a lower-bound in your <code>pyproject.toml</code> (like <code>&gt;=0.11</code>), not a hard pin like <code>==0.11</code>, and leave the pinning to the <code>uv.lock</code>. In that world, it's not even really necessary to update the bounds in your <code>pyproject.toml</code> when upgrading.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:00 UTC
    </footer>
</body>
</html>
