<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv sync` should not emit &quot;DEBUG Removing existing directory due to `--clear`&quot; message - astral-sh/uv #14734</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`uv sync` should not emit &quot;DEBUG Removing existing directory due to `--clear`&quot; message</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/14734">#14734</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-07-18 17:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-18 17:14</div>
            <div class="timeline-body"><p>This message is confusing in <code>uv sync</code>, because... <code>--clear</code> isn't provided, that's jut the default <code>uv sync</code> behavior.</p>
<p>This may require adding an optional <code>Option&lt;OnExistingSource&gt;</code> enum to the <code>OnExisting</code> type so we can differentiate between <code>OnExisting::Remove(Some(OnExistingSource::ClearFlag))</code> and <code>OnExisting::Remove(None)</code>. We'd also be able to differentiate between <code>OneExistingSource::ClearEnv</code> if we wanted? I'm not sure if this is the best approach, just an option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @zanieb on 2025-07-18 17:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">tracing</span> added by @zanieb on 2025-07-18 17:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @charliermarsh on 2025-07-18 17:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vkreddy">@vkreddy</a> on 2025-07-22 02:03</div>
            <div class="timeline-body"><p>@zanieb can I look into this one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yuri-potatoq">@yuri-potatoq</a> on 2025-07-30 23:20</div>
            <div class="timeline-body"><p>Hey. Am i missing something? I downloaded the project and didn't find the message when running the command provided (even with verbose mode).
The only mention to a message similar to that was <a href="https://github.com/astral-sh/uv/blob/3df972f18a0fca92c278a0ec1492e9c29314118d/crates/uv-python/src/downloads.rs#L935">here</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-31 02:25</div>
            <div class="timeline-body"><p>@vkreddy no need to ask permission, feel free.</p>
<p>The message is emitted at https://github.com/astral-sh/uv/blob/bfb4bc2aebe1dbff9aeba84d0c96e3ffcbf0ddd1/crates/uv-virtualenv/src/virtualenv.rs#L111</p>
<p>I'm actually not sure what code path triggers the message. I saw it, but I might have refactored things in a way that makes it impossible from <code>uv sync</code>. We'd need to be removing an existing environment, but we usually will remove it manually ahead of time at</p>
<p>https://github.com/astral-sh/uv/blob/6856a27711910d240a488d53d7967b73340b1524/crates/uv/src/commands/project/mod.rs#L1382-L1396</p>
<p>during sync operations.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-31 02:30</div>
            <div class="timeline-body"><p>This may be resolved, I guess I should have included logs of what I was doing ðŸ˜¬</p>
<p>If nobody sees a clear way to hit that code path I shared, we could close this out for now. The problem still exists though, it'll probably be annoying in the future so if someone is interested it's probably still worth changing?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/14985.html">astral-sh/uv#14985</a> on 2025-07-31 02:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/15881.html">astral-sh/uv#15881</a> on 2025-09-15 19:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-09-16 18:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:28 UTC
    </footer>
</body>
</html>
