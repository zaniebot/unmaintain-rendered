<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv (sync|run) --only-group` doesn't include project - astral-sh/uv #10752</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`uv (sync|run) --only-group` doesn't include project</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/10752">#10752</a>
        opened by <a href="https://github.com/cjw296">@cjw296</a>
        on 2025-01-19 10:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cjw296">@cjw296</a> on 2025-01-19 10:58</div>
            <div class="timeline-body"><p>I'm attempting to build the docs for a new project on <a href="https://readthedocs.org/">Read the Docs</a>.</p>
<p>I want to keep dependencies for this in a <code>doc</code> group:</p>
<pre><code>[project]
...
requires-python = &quot;&gt;=3.12&quot;
dependencies = []

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;

[dependency-groups]
docs = [
    &quot;furo&gt;=2024.8.6&quot;,
    &quot;sphinx&gt;=8.1.3&quot;,
]

</code></pre>
<p>The will be more groups later (dev, maybe build, etc).</p>
<p>When I attempt to sync and run with only that group, my project is uninstalled:</p>
<pre><code class="language-bash">$ uv sync --only-group docs
Resolved 27 packages in 1ms
Uninstalled 1 package in 0.69ms
 - paradigms==0.0.0.dev1 (from file:///Users/chris/vcs/git/paradigms)
$ uv run --only-group docs sphinx-build -T -b html docs docs/_build/html/
Running Sphinx v8.1.3
...
importlib.metadata.PackageNotFoundError: No package metadata was found for paradigms
</code></pre>
<p>How should I be getting the project to be included here?</p>
<p>What's weird is that any other combination of <code>uv sync</code> and <code>uv run</code> where either of them does not have <code>--only-group docs</code> works:</p>
<pre><code class="language-bash">$ uv sync
Resolved 27 packages in 1ms
Installed 1 package in 3ms
 + paradigms==0.0.0.dev1 (from file:///Users/chris/vcs/git/paradigms)
$ uv run --only-group docs sphinx-build -T -b html docs docs/_build/html/
Running Sphinx v8.1.3
...build succeeded.
The HTML pages are in docs/_build/html.
</code></pre>
<pre><code class="language-bash">$ uv sync --only-group docs
Resolved 27 packages in 1ms
Uninstalled 1 package in 0.69ms
 - paradigms==0.0.0.dev1 (from file:///Users/chris/vcs/git/paradigms)
(docs) tweedledee:paradigms chris:
$ uv run sphinx-build -T -b html docs docs/_build/html/
Installed 1 package in 3ms
...
The HTML pages are in docs/_build/html.
</code></pre>
<p>This second permutation definitely feels like a bug...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ravencentric">@Ravencentric</a> on 2025-01-19 11:06</div>
            <div class="timeline-body"><p>Use <code>--group</code> instead of <code>--only-group</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cjw296">@cjw296</a> on 2025-01-19 11:18</div>
            <div class="timeline-body"><blockquote>
<p>Use <code>--group</code> instead of <code>--only-group</code>.</p>
</blockquote>
<p>If I have multiple default groups (since I want the developer experience to be &quot;everything by default&quot;), then how do I get the dependencies for only one of those groups?</p>
<p>Separately, what's the intended use case for <code>--only-group</code> if it doesn't include the project?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ravencentric">@Ravencentric</a> on 2025-01-19 11:55</div>
            <div class="timeline-body"><p>You can use <code>uv (sync|run) --group docs --no-group dev</code> to install the project + <code>docs</code> while excluding <code>dev</code> group.</p>
<blockquote>
<p>Separately, what's the intended use case for --only-group if it doesn't include the project?</p>
</blockquote>
<p>Sometimes you don't need the project, e.g., a linter/formatter doesn't need the project installed so you can just use <code>uv sync --only-group lint</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-19 14:04</div>
            <div class="timeline-body"><p>It's intentional that <code>--only-group</code> does not include the project. If you want to run the project, with one group enabled, you'd use <code>--group</code>.</p>
<blockquote>
<p>If I have multiple default groups (since I want the developer experience to be &quot;everything by default&quot;), then how do I get the dependencies for only one of those groups?</p>
</blockquote>
<p>You would need to pass <code>--no-default-groups </code>(#10618).</p>
<blockquote>
<p>What's weird is that any other combination of uv sync and uv run where either of them does not have --only-group docs works</p>
</blockquote>
<p>The second <code>uv run</code> is re-installing your project. <code>uv run</code> will sync the project prior to running. It doesn't &quot;remember&quot; the state of the previous <code>uv sync</code>. You can try using <code>--exact</code> with <code>uv run</code> if you want a clearer model. By default, <code>uv run</code> will avoid removing dependencies unless necessary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-01-19 14:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cjw296">@cjw296</a> on 2025-01-20 07:10</div>
            <div class="timeline-body"><blockquote>
<p>It's intentional that --only-group does not include the project. If you want to run the project, with one group enabled, you'd use --group.</p>
</blockquote>
<p>Okay, but <code>--group</code> gives a union of the default groups and the requested docs, right?</p>
<blockquote>
<p>You would need to pass <code>--no-default-groups</code></p>
</blockquote>
<p>Okay, so get install the project and a single group, I need to do <code>--no-default-groups --group docs</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cjw296">@cjw296</a> on 2025-01-20 07:15</div>
            <div class="timeline-body"><p>Hmm, when is <code>--no-default-groups</code> expected to make it into a release?</p>
<pre><code>$ uv self update
info: Checking for updates...
success: Upgraded uv from v0.5.18 to v0.5.21! https://github.com/astral-sh/uv/releases/tag/0.5.21
$ uv sync --no-default-groups --group docs
error: unexpected argument '--no-default-groups' found
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-20 13:58</div>
            <div class="timeline-body"><p>Please follow the linked PR; itâ€™s still open.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @cjw296 on 2025-01-21 09:18</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
