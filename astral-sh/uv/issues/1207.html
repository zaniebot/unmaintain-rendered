<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A `uv run` subcommand - astral-sh/uv #1207</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>A `uv run` subcommand</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1207">#1207</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-01-31 15:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/konstin">@konstin</a> on 2024-01-31 15:57</div>
            <div class="timeline-body"><p>In the initial implementation, the <code>puffin run</code> subcommand looks for a venv in <code>.venv</code> in the current or any parent directory, activates it by setting <code>VIRTUAL_ENV</code> and <code>PATH</code> and then replaces itself with the python interpreter with the trailing args (on unix, it might be faster to not spawn a new process but load libpython and run <code>Py_Main</code>).</p>
<p>In further steps we can extend this to read pyproject.toml, create a venv if none exists, install all (missing) dependencies and run. This enables a &quot;git clone and puffin run&quot; workflow where the user does not need to manually handle venvs and dependency installation anymore. <code>puffin run</code> could replace <code>python</code> as batteries-included entrypoint for running python code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2024-01-31 15:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "A `puffin run` subcommand" to "A `uv run` subcommand" by @zanieb on 2024-02-15 19:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-15 19:51</div>
            <div class="timeline-body"><p>xref #1173</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-02-16 04:09</div>
            <div class="timeline-body"><p>This would support PEP 721? One issue with <code>pipx run</code> is it prioritizes classic PyPI apps, so <code>pipx run file.py</code> will look for a <code>file-py</code> on PyPI. So <code>uv run file.py</code> could run a local file, wile <code>uv pipx run</code> could be the PyPI one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-20 10:38</div>
            <div class="timeline-body"><p>Good question! I'm wondering how to handle conflicts. If a file contains a PEP 723 comment and exists in a uv workspace (with a pyproject.toml with uv configuration), should <code>uv run</code> use the inline metadata or the workspace metadata?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-02-20 13:28</div>
            <div class="timeline-body"><p>I believe the inline metadata should override the more general config. It’s the same way I’d hope Ruff support for PEP 723 would work, it’s a way to put per file config in the files. Like the matching feature in Rust (that partially inspired the PEP).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2027.html">astral-sh/uv#2027</a> on 2024-02-28 02:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1173.html">astral-sh/uv#1173</a> on 2024-02-29 15:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pfmoore">@pfmoore</a> on 2024-03-19 11:32</div>
            <div class="timeline-body"><p>I agree that PEP 723 metadata should take precedence. An obvious use case I would have for a feature like this would be to write small &quot;workflow support&quot; scripts in my project directory. These would have their own dependencies, and could very easily not share any dependencies with the project itself (imagine, for example, a <code>make_docs.py</code> script that depended on Sphinx). Such scripts would be a lightweight alternative to a tool like nox.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2024-04-14 16:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-13 18:13</div>
            <div class="timeline-body"><p>See https://github.com/astral-sh/uv/pull/3074 for the initial implementation of this.</p>
<p>#3096 tracks PEP 723 support.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-05-13 18:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3096.html">astral-sh/uv#3096</a> on 2024-05-13 18:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
