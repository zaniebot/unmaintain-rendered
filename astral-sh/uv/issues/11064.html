<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow embedding of script lock files - astral-sh/uv #11064</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow embedding of script lock files</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/11064">#11064</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-01-29 14:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-29 14:30</div>
            <div class="timeline-body"><p>e.g., see https://github.com/astral-sh/uv/issues/6318#issuecomment-2621176886</p>
<p>We added support for script lock files, but they're separate from the script. This makes them easier to detect and operate on. However, for fully reproducible scripts, it may be nice to embed a lockfile in the script itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2025-01-29 14:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/6318.html">astral-sh/uv#6318</a> on 2025-01-29 14:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @zanieb on 2025-01-29 14:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/marengaz">@marengaz</a> on 2025-01-29 14:59</div>
            <div class="timeline-body"><p>agree with <a href="https://github.com/astral-sh/uv/issues/6318#issuecomment-2621851205">charlie's comment</a> that &quot;embedded lockfile is somewhat impractical&quot;
perhaps a suitable compromise would be a flag to enforce the use with a lock file?</p>
<pre><code># /// script
# requires-python = &quot;&gt;=3.12&quot;
# dependencies = [
#     &quot;requests&lt;3&quot;,
#     &quot;rich&quot;,
# ]
# enforce-lock-file = true
# ///
</code></pre>
<p>where <code>uv run --script</code> would throw a helpful error if the lock file wasn't resolvable by usual logic?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-01-29 15:05</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/uv/issues/6318#issuecomment-2621851205</p>
<blockquote>
<p>I personally think the embedded lockfile is somewhat impractical -- just way too big. But we can probably support it.</p>
</blockquote>
<p>Depends on the use case, for general development environments I agree.</p>
<p>But I can imagine situations where you'd like to send a file to someone outside traditional development, such as sending files to a semi technical user, or academic or other organizations where development best practices are not great and they email or copy files around. In cases like these there's a huge convenience to having just one file, not keeping two together and in sync.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/martimlobao">@martimlobao</a> on 2025-01-29 15:20</div>
            <div class="timeline-body"><p>@marengaz The usecase I'm envisioning is more what @notatallshaw is getting at: I don't want the script to fail if there isn't a lockfile, I want to be able to run the script reproducibly as a standalone executable.</p>
<p>I can sympathize with the argument that an inline lockfile might be impractical in some cases though. At the risk of proposing yet another option, perhaps a <code>--inline</code> flag might be a good alternative to allow for each behavior depending on the use case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-30 03:14</div>
            <div class="timeline-body"><p>It seems fine to support this as an opt-in thing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11104.html">astral-sh/uv#11104</a> on 2025-01-30 21:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zmackie-datadog">@zmackie-datadog</a> on 2025-02-07 20:49</div>
            <div class="timeline-body"><p>FWIW a nice workflow to support would be &quot;I work on a script at first, and then at some point I want to go from a script to a repoducible script to a project&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12303.html">astral-sh/uv#12303</a> on 2025-03-20 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gsemet">@gsemet</a> on 2025-04-04 06:34</div>
            <div class="timeline-body"><p>Hello. I really like the idea of an automatically managed lockfile even without hashes. Would help a lot sharing scripts without pyproject.toml file while having full reproductivity both locally and in CI.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:32:58 UTC
    </footer>
</body>
</html>
