<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Behavior of &quot;uv sync&quot; with workspaces - astral-sh/uv #16026</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Behavior of &quot;uv sync&quot; with workspaces</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16026">#16026</a>
        opened by <a href="https://github.com/maxime-tremblay-hq">@maxime-tremblay-hq</a>
        on 2025-09-25 15:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/maxime-tremblay-hq">@maxime-tremblay-hq</a> on 2025-09-25 15:02</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I am trying to use workspaces to manage a large project as described here https://docs.astral.sh/uv/concepts/projects/workspaces/</p>
<p>From the documentation</p>
<blockquote>
<p>In a workspace, each package defines its own pyproject.toml, but the workspace shares a single lockfile, ensuring that the workspace operates with a consistent set of dependencies.
As such, uv lock operates on the entire workspace at once, while uv run and uv sync operate on the workspace root by default, though both accept a --package argument, allowing you to run a command in a particular workspace member from any workspace directory.</p>
</blockquote>
<p>However, this is not the behavior that I observe. For example, consider this script that basically create a workspace with a single package and run a few <code>uv sync</code> in different locations.</p>
<pre><code class="language-bash">log () {
  echo &quot;&quot;
  echo &quot;$1&quot;
  echo &quot;&quot;
  uv pip list
  echo &quot;&quot;
}

mkdir demo
cd demo
uv init . -q

uv add pytest -q

log &quot;From workspace root before creating packages&quot; 

mkdir packages
cd packages

uv init --lib some_package -q
cd some_package
uv add numpy -q

log &quot;From some_package before syncing&quot; 

uv sync -q

log &quot;From some_package after syncing&quot; 

cd ../..

log &quot;From workspace root before syncing&quot; 

uv sync -q

log &quot;From workspace root after syncing&quot; 
</code></pre>
<p>Running the script, I get the following output</p>
<pre><code>From workspace root before creating packages

Package   Version
--------- -------
iniconfig 2.1.0
packaging 25.0
pluggy    1.6.0
pygments  2.19.2
pytest    8.4.2


From some_package before syncing

Package      Version Editable project location
------------ ------- -------------------------------------------------------------
iniconfig    2.1.0
numpy        2.3.3
packaging    25.0
pluggy       1.6.0
pygments     2.19.2
pytest       8.4.2
some-package 0.1.0   /mnt/automountdir/gpfs/home/dn3868/demo/packages/some_package


From some_package after syncing

Package      Version Editable project location
------------ ------- -------------------------------------------------------------
numpy        2.3.3
some-package 0.1.0   /mnt/automountdir/gpfs/home/dn3868/demo/packages/some_package


From workspace root before syncing

Package      Version Editable project location
------------ ------- -------------------------------------------------------------
numpy        2.3.3
some-package 0.1.0   /mnt/automountdir/gpfs/home/dn3868/demo/packages/some_package


From workspace root after syncing

Package   Version
--------- -------
iniconfig 2.1.0
packaging 25.0
pluggy    1.6.0
pygments  2.19.2
pytest    8.4.2
</code></pre>
<p>As you can see, the <code>uv sync</code> command seems to operate differently if I am at the root or inside a package. This seems to contradict the documentation.</p>
<p>Am I missing something? Is this a bug? Maybe I don't understand the documentation.</p>
<h3>Platform</h3>
<p>Rocky linux 8</p>
<h3>Version</h3>
<p>0.8.16</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @maxime-tremblay-hq on 2025-09-25 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-26 00:50</div>
            <div class="timeline-body"><p>Yeah we will infer <code>--package &lt;member&gt;</code> as the default when your working directory is that member. You can still use <code>--package</code> to select another member (or even the root package). We can consider tweaking the wording in the documentation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maxime-tremblay-hq">@maxime-tremblay-hq</a> on 2025-09-26 13:29</div>
            <div class="timeline-body"><p>Ok. Thanks for the clarification.</p>
<p>What is the best practice to include dev dependencies like pytest that are shared accross all packages? Should I include them in all my pyproject.toml files? Same for stuff like ruff configuration that I want to apply to the whole project.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-01 20:03</div>
            <div class="timeline-body"><p>We generally specify them in each workspace member (so, in each <code>pyproject.toml</code> file).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-11-01 20:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:12 UTC
    </footer>
</body>
</html>
