<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIRTUAL_ENV_PROMPT format in uv differs from venv or virtualenv - astral-sh/uv #13456</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>VIRTUAL_ENV_PROMPT format in uv differs from venv or virtualenv</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13456">#13456</a>
        opened by <a href="https://github.com/ericbn">@ericbn</a>
        on 2025-05-14 16:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ericbn">@ericbn</a> on 2025-05-14 16:31</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>With venv:</p>
<pre><code>$ python3 -m venv .venv --prompt base
$ source .venv/bin/activate
$ echo &quot;'$VIRTUAL_ENV_PROMPT'&quot;
'base'
$ deactivate
</code></pre>
<p>With virtualenv:</p>
<pre><code>$ uvx virtualenv .venv --prompt base
$ source .venv/bin/activate
$ echo &quot;'$VIRTUAL_ENV_PROMPT'&quot;
'base'
$ deactivate
</code></pre>
<p>With uv:</p>
<pre><code>$ uv venv --prompt base
$ source .venv/bin/activate
$ echo &quot;'$VIRTUAL_ENV_PROMPT'&quot;
'(base) '
$ deactivate
</code></pre>
<p>uv adds parenthesis and a trailing space to <code>VIRTUAL_ENV_PROMPT</code>, while venv and virtualenv do not. Also, without <code>--prompt base</code>, all 3 cases above differ in the following way: venv and virtualenv yield <code>'.venv'</code> and uv yields <code>'(pwd) '</code> where <code>pwd</code> is the current directory name.</p>
<p>Just calling out the differences to make sure which ones are intentional. I'd argue adding the parenthesis and the trailing space to <code>VIRTUAL_ENV_PROMPT</code> might be differing too much from the other tools and confusing for scripts that want to use the value of this environment value. A typical case is setting <code>VIRTUAL_ENV_DISABLE_PROMPT=1</code> and then using <code>$VIRTUAL_ENV_PROMPT</code> when rendering a custom shell prompt.</p>
<p>Also, I see the 3 tools above set the <code>prompt</code> in <code>.venv/pyvenv.cfg</code> the same way (no parenthesis and no trailing space), so maybe another argument in favor of keeping <code>VIRTUAL_ENV_PROMPT</code> also the same.</p>
<h3>Platform</h3>
<p>macOS 15 arm64</p>
<h3>Version</h3>
<p>uv 0.7.3 (Homebrew 2025-05-07)</p>
<h3>Python version</h3>
<p>Python 3.12.9</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ericbn on 2025-05-14 16:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ericbn">@ericbn</a> on 2025-05-17 02:26</div>
            <div class="timeline-body"><p>This issue was introduced in 0ec2d4e434878c6f99f7fea77b5236292a35093a to try to fix #8006. Since all tools are consistently producing <code>VIRTUAL_ENV_PROMPT</code> values without parenthesis and a trailing space, that issue is arguably an issue with VSCode and not with uv. Also, that commit only updated the bash/POSIX script and not the others, making everything even more inconsistent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-05-17 11:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-05-17 11:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/muzimuzhi">@muzimuzhi</a> on 2025-06-06 10:11</div>
            <div class="timeline-body"><blockquote>
<p>Also, without <code>--prompt base</code>, all 3 cases above differ in the following way: venv and virtualenv yield <code>'.venv'</code> and uv yields <code>'(pwd) '</code> where <code>pwd</code> is the current directory name.</p>
</blockquote>
<p>This part of the problem persists in uv 0.7.11.</p>
<p><code>uv venv</code> without <code>--prompt</code> still sets <code>VIRTUAL_ENV_PROMPT</code> to the <em>current directory name</em>, though now without parenthesis and the trailing space.</p>
<p>Preparation</p>
<pre><code>$ mkdir my-proj
$ cd my-proj
</code></pre>
<p>With venv:</p>
<pre><code>$ python3 -m venv .venv
$ source .venv/bin/activate
$ echo &quot;'$VIRTUAL_ENV_PROMPT'&quot;
'.venv'
$ deactivate
</code></pre>
<p>With virtualenv:</p>
<pre><code>$ uvx virtualenv .venv
$ source .venv/bin/activate
$ echo &quot;'$VIRTUAL_ENV_PROMPT'&quot;
'.venv'
$ deactivate
</code></pre>
<p>With uv:</p>
<pre><code>$ uv venv
$ source .venv/bin/activate
$ echo &quot;'$VIRTUAL_ENV_PROMPT'&quot;
'my-proj'
$ deactivate
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:35:31 UTC
    </footer>
</body>
</html>
