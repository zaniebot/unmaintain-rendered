<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows AV software causes 0.5 second delay for unsigned binaries - astral-sh/uv #10288</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Windows AV software causes 0.5 second delay for unsigned binaries</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/10288">#10288</a>
        opened by <a href="https://github.com/paugier">@paugier</a>
        on 2025-01-03 14:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/paugier">@paugier</a> on 2025-01-03 14:30</div>
            <div class="timeline-body"><p>I observe a very slow Python startup in venv created by UV.</p>
<pre><code class="language-sh">uv venv my-uv-venv
.\my-uv-venv\Scripts\activate
Measure-Command { python --version }
# slow (~0.5 second)
Measure-Command { .\venv-uv\Scripts\python.exe --version }
# slow (~0.5 second)
Measure-Command { .\AppData\Roaming\uv\python\cpython-3.13.1-windows-x86_64-none\python.exe --version }
# quite fast (~0.06 second)
</code></pre>
<p>The same kind of startup delays are observed for Python applications installed with <code>uv tools</code>.</p>
<p>I start to understand after some experiments and discussions (https://discuss.python.org/t/about-exe-wrappers-created-by-frontends-when-installing-wheels-on-windows/75942/8) that it is related to a virus scan triggered each time the .exe files are launched.</p>
<p>This delay is related to this particular computer with a antivirus software doing some checks when modified .exe are launched. I guess it is a quite common situation for UV users on Windows. It would be nice to find a solution. Possibly UV could do something to produce files that are not checked at startup by antivirus software. Alternatively, it would be nice to document how to avoid these startup delays.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @charliermarsh on 2025-01-03 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-03 15:28</div>
            <div class="timeline-body"><p>I'm not sure that there's much we can do here. Did you learn anything that we can apply concretely from the discussion.python.org thread?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-01-03 23:32</div>
            <div class="timeline-body"><p>Wow! I wonder what those slow AV's are searching for / doing. These are the results on my Windows system.</p>
<pre><code>(uv) âžœ uv git:(main) Measure-Command { python --version }

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 0
Milliseconds      : 47
Ticks             : 473388
TotalDays         : 5.47902777777778E-07
TotalHours        : 1.31496666666667E-05
TotalMinutes      : 0.00078898
TotalSeconds      : 0.0473388
TotalMilliseconds : 47.3388

(uv) âžœ uv git:(main) Measure-Command { %USERPROFILE%\AppData\Local\Programs\Python\Python312\python.exe --version }

Days              : 0
Hours             : 0
Minutes           : 0
Seconds           : 0
Milliseconds      : 44
Ticks             : 440542
TotalDays         : 5.09886574074074E-07
TotalHours        : 1.22372777777778E-05
TotalMinutes      : 0.000734236666666667
TotalSeconds      : 0.0440542
TotalMilliseconds : 44.0542
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-01-03 23:47</div>
            <div class="timeline-body"><p>I once worked in a large Enterprise that was testing a security tool on Windows that implemented an allow list, however the allow list wasn't stored on the computer, a hash of the executable was made and sent over the network on each process open.</p>
<p>Further, when starting multiple processes simultaneously the security toolâ€™s response time scaled superlinearly, I had examples, like opening PyCharm, where it took over 30 seconds and started to time out (I, and several other developers, successfully made the case that this meant it was unworkable on our machines). It's a wild world of latency inducing security tools out there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-01-04 01:32</div>
            <div class="timeline-body"><blockquote>
<p>I had examples, like opening PyCharm, where it took over 30 seconds and started to time out</p>
</blockquote>
<p>Indeed, I've also been there a couple of times ðŸ˜­</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paugier">@paugier</a> on 2025-01-04 06:17</div>
            <div class="timeline-body"><p>I don't come from Windows, so I don't understand everything but it seems (https://discuss.python.org/t/slow-startup-on-windows-for-virtual-environments/75758/27) that it is important to</p>
<ul>
<li>sign the binaries</li>
<li>copy python.exe without modification for venvs</li>
</ul>
<p>Indeed virtual envs from Python installed from the official installers do not suffer from startup delays. <code>python.exe</code> in virtual envs is just a copy and just check a text file <code>pyvenv.cfg</code> next to it.</p>
<p>For <code>uv tools</code>, find a great solution not involving modifying .exe files ðŸ™‚</p>
<p>I don't yet now how to do this but it seems that for some antivirus programs, one can add a kind of white list of programs or directories (see https://discuss.python.org/t/slow-startup-on-windows-for-virtual-environments/75758/29). If it is indeed possible for popular security software, it might be nice to add a note on UV tools documentation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-01-04 23:04</div>
            <div class="timeline-body"><blockquote>
<p>sign the binaries</p>
</blockquote>
<p>Fair, python build standalone binaries would benefit from signing</p>
<blockquote>
<p>For uv tools, find a great solution not involving modifying .exe files ðŸ™‚</p>
</blockquote>
<p>Which .exe files? Executable scripts launchers are generated on the fly, they're not pre-existing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/python-build-standalone/issues/89.html">astral-sh/python-build-standalone#89</a> on 2025-01-05 16:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/paugier">@paugier</a> on 2025-01-07 15:53</div>
            <div class="timeline-body"><p>Note that it also apply to Rust applications like ruff. Ruff installed with UV is very slow on this computer.</p>
<pre><code>Measure-Command { .\AppData\Roaming\uv\tools\ruff\Scripts\ruff.exe --version }
TotalMilliseconds : 782,1066
</code></pre>
<p>Moreover, I confirm that it is due to an antivirus software (see https://discuss.python.org/t/slow-startup-on-windows-for-virtual-environments/75758/34) and that the solutions are to sign binaries (python.exe in the venvs, launchers for python entrypoints, Rust applications like ruff.exe, etc.) and not modify binaries with shebang (what is done for launchers for python entrypoints). Instead of modifying binaries with shebang, one could use 2 files (black.exe and black-script.json for example).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Windows: 0.5 second delay before startup for venv and tools" to "Windows AV software causes 0.5 second delay for unsigned binaries" by @konstin on 2025-12-15 17:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
