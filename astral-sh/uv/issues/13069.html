<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow override dependencies in workspace members - astral-sh/uv #13069</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow override dependencies in workspace members</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13069">#13069</a>
        opened by <a href="https://github.com/haarisr">@haarisr</a>
        on 2025-04-23 15:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/haarisr">@haarisr</a> on 2025-04-23 15:02</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>In the docs, it is mentioned that override-dependencies always falls back to the workspace root.</p>
<p>In the scenario that I only sync a certain workspace member, I would like that to use the override dependencies of the workspace member.</p>
<p>I expect it to work in the following two scenarios</p>
<ol>
<li></li>
</ol>
<pre><code class="language-bash">cd member &amp;&amp; uv sync
</code></pre>
<ol start="2">
<li></li>
</ol>
<pre><code class="language-bash">uv sync --package member
</code></pre>
<p>If I sync from the workspace root without specifying package then it can respect the override-dependencies in the root workspace.</p>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @haarisr on 2025-04-23 15:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-23 15:34</div>
            <div class="timeline-body"><p>Does https://docs.astral.sh/uv/concepts/projects/config/#conflicting-dependencies work for you? Otherwise, can you describe why you need to override dependencies? With a specific use case, it's easier to find a fitting solution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/haarisr">@haarisr</a> on 2025-04-23 18:57</div>
            <div class="timeline-body"><blockquote>
<p>Does https://docs.astral.sh/uv/concepts/projects/config/#conflicting-dependencies work for you? Otherwise, can you describe why you need to override dependencies? With a specific use case, it's easier to find a fitting solution.</p>
</blockquote>
<p>No, I do not think that solves it.</p>
<p>I am trying to shrink the total number of dependencies in our package/workspace. But some 3rd party dependencies do have a lot of transitive dependencies, some of which are used in certain modules that we do not import.</p>
<p>For eg a package may declare <code>matplotlib</code> as a dependency, but I for sure know I am not going to import that part of the module that is used for visualization..</p>
<p>One solution is to ask the maintainer of the package to declare it optional but that is a lot more work than me just overriding the dep in the workspace member to remove <code>matplotlib</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-04-23 20:17</div>
            <div class="timeline-body"><p>Yeah we don't support this. Overrides have to be declared in the root, as you point out, because we lock the entire workspace at once.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/haarisr">@haarisr</a> on 2025-04-24 21:06</div>
            <div class="timeline-body"><p>I was thinking a little more about this.</p>
<p>Is this not similar to resolution of conflicting dependencies?</p>
<p>Workspace A can require matplotlib, Workspace B can override it.</p>
<p>With uv sync --package A, I get matplotlib. With uv sync --package B I remove matplotlib.</p>
<p>If I do uv sync --all-packages i get a matplotlib since A requires it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-25 07:08</div>
            <div class="timeline-body"><p>Only your workspace root can apply overrides, as overrides are global and break the usual rules of dependencies. They are an escape hatch for the regular rules to get out of an dependency conflict which gets defined once for the entire lockfile.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:05 UTC
    </footer>
</body>
</html>
