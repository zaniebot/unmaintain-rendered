<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip writes incorrect shebang for a specific project - astral-sh/uv #11962</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv pip writes incorrect shebang for a specific project</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11962">#11962</a>
        opened by <a href="https://github.com/mistydemeo">@mistydemeo</a>
        on 2025-03-04 23:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mistydemeo">@mistydemeo</a></div>
            <div class="timeline-body">Summary
<p>I&#x27;ve noticed that, for one specific project I have, <code>uv pip install -e .</code> is writing out incorrect shebangs for its scripts. Instead of writing shebangs using paths from within the venv, it&#x27;s writing out paths from UV&#x27;s build cache - which don&#x27;t exist anymore, and can&#x27;t be run.</p>
<p>Steps to repro:</p>
<ol>
<li>Clone this repository: https://github.com/mistydemeo/umbra</li>
<li>Check out the branch <code>misty/python-12</code></li>
<li>Run <code>uv venv</code></li>
<li>Run <code>uv pip install -e .</code></li>
<li>Check the shebang on <code>.venv/bin/umbra</code></li>
</ol>
<p>Expected:</p>
<p>The shebang reads <code>#!$HOME/git/umbra/.venv/bin/python3</code></p>
<p>Actual:</p>
<p>The shebang reads <code>#!$HOME/.cache/uv/builds-v0/.tmpQMKYdQ/bin/python</code></p>
Platform
<p>macOS 15 arm64</p>
Version
<p>uv 0.6.4 (04db70662 2025-03-03)</p>
Python version
<p>Python 3.12.8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/mistydemeo">@mistydemeo</a> on 2025-03-04 23:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-05 00:04</div>
            <div class="timeline-body"><p>I think this might be <a href="https://github.com/astral-sh/uv/issues/2744">astral-sh/uv#2744</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 00:04</div>
            <div class="timeline-body"><p>Without digging deeply here, I worry this is because <code>scripts</code> is using a glob https://github.com/mistydemeo/umbra/blob/1a9a39606856b30f17885518dba8436c8909e0a2/setup.py#L15 and that this is a <code>setuptools</code> specific problem.</p>
<p>If editable installs of entry points were generally broken, we&#x27;d have more reports.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 00:05</div>
            <div class="timeline-body"><p>Looks like the issue Charlie linked to confirms that. I think this needs to be fixed upstream in setuptools.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">external</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 00:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mistydemeo">@mistydemeo</a> on 2025-03-05 00:06</div>
            <div class="timeline-body"><p>You&#x27;re right, this looks like the same issue. Sorry about that, I&#x27;d searched but hadn&#x27;t found it. I can close this in favour of that issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 00:07</div>
            <div class="timeline-body"><p>No problem</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 00:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-05 00:07</div>
            <div class="timeline-body"><p>All good, I wouldn&#x27;t expect anyone to connect the dots on these issues, the issue tracker history is just buried deep in my brain so I might as well use that knowledge for good.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 00:08</div>
            <div class="timeline-body"><p>I changed the title a little to try to help with discovery.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:37:36 UTC
    </footer>
</body>
</html>
