<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv venv: support Pythons installed via the Microsoft Store - astral-sh/uv #2105</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv venv: support Pythons installed via the Microsoft Store</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2105">#2105</a>
        opened by <a href="https://github.com/madig">@madig</a>
        on 2024-03-01 09:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/madig">@madig</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p><code>uv venv</code> currently (v0.1.13) fails to create venvs with Pythons installed via the Microsoft Store (Windows 11 Version 10.0.22631 Build 22631). Example with Python 3.12:</p>
<pre><code>❯ uv venv --verbose -p 3.12 vvv
 uv_interpreter::python_query::find_requested_python request=3.12
      0.003583s   0ms DEBUG uv_interpreter::python_query Starting interpreter discovery for Python @ `3.12`
      0.004400s   0ms DEBUG uv_interpreter::interpreter Cached interpreter info for Python 3.8.10, skipping probing: C:\Program Files\Python38\python.exe
      0.004961s   1ms DEBUG uv_interpreter::interpreter Cached interpreter info for Python 3.6.8, skipping probing: C:\Program Files\Python36\python.exe
      0.005404s   1ms DEBUG uv_interpreter::interpreter Probing interpreter info for: C:\Python27\python.exe
      0.062965s  59ms DEBUG uv_interpreter::python_query Found a Python 2 installation that isn't supported by uv, skipping.
      0.063666s  60ms DEBUG uv_interpreter::interpreter Probing interpreter info for: C:\Python27-64\python.exe
      0.114595s 111ms DEBUG uv_interpreter::python_query Found a Python 2 installation that isn't supported by uv, skipping.
  × failed to canonicalize path `C:\Users\...\AppData\Local\Microsoft\WindowsApps\python3.12.exe`
  ╰─▶ The file cannot be accessed by the system. (os error 1920)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @MichaReiser on 2024-03-01 10:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-01 13:56</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-03-01 13:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-03-01 15:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NMertsch">@NMertsch</a> on 2024-03-01 21:04</div>
            <div class="timeline-body"><p>Probably related:</p>
<ul>
<li>Multiple Python versions installed via Microsoft Store (Win11, x64)</li>
<li>uv finds the requested Python version</li>
<li>copy-pasting the path from the uv error message works</li>
<li><code>sys.executable</code> reports a different path</li>
</ul>
<pre><code class="language-shell">PS C:\Users\username&gt; # try `uv venv`
PS C:\Users\username&gt; uv venv --verbose --python 3.11
 uv_interpreter::python_query::find_requested_python request=3.11
      0.002206s   0ms DEBUG uv_interpreter::python_query Starting interpreter discovery for Python @ `3.11`
  × failed to canonicalize path `C:\Users\username\AppData\Local\Microsoft\WindowsApps\python3.11.exe`
  ╰─▶ The file cannot be accessed by the system. (os error 1920)
PS C:\Users\username&gt; # execute python directly
PS C:\Users\username&gt; C:\Users\username\AppData\Local\Microsoft\WindowsApps\python3.11.exe
Python 3.11.8 (tags/v3.11.8:db85d51, Feb  6 2024, 22:03:32) [MSC v.1937 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.executable
'C:\\Users\\username\\AppData\\Local\\Microsoft\\WindowsApps\\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\\python.exe'
&gt;&gt;&gt;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-01 21:07</div>
            <div class="timeline-body"><p>Yeah I'm working on this now. Should work soon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-03 17:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/madig">@madig</a> on 2024-03-05 10:09</div>
            <div class="timeline-body"><p>I'm not sure this is fixed?</p>
<pre><code>AppData\Local\Temp
❯ uv --version
uv 0.1.14 (c525fdf2b 2024-03-04)

AppData\Local\Temp
❯ uv venv -p 3.12 vvv
  × failed to canonicalize path `C:\Users\...\AppData\Local\Microsoft\WindowsApps\python3.12.exe`
  ╰─▶ The file cannot be accessed by the system. (os error 1920)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 13:58</div>
            <div class="timeline-body"><p>It works without issue on my Windows Store installation. Do you mind sharing the outputs of <code>import sys; print(sys.executable); print(sys._base_executable)</code> on that installation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/madig">@madig</a> on 2024-03-05 14:44</div>
            <div class="timeline-body"><pre><code>❯ python3.12
Python 3.12.2 (tags/v3.12.2:6abddd9, Feb  6 2024, 21:26:36) [MSC v.1937 64 bit (AMD64)] on win32
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import sys; print(sys.executable); print(sys._base_executable)
C:\Users\...\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
C:\Users\...\AppData\Local\Microsoft\WindowsApps\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\python.exe
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 15:14</div>
            <div class="timeline-body"><p>If I push to a branch, would you be able to test locally by running <code>cargo build</code> in the uv repo?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-05 17:42</div>
            <div class="timeline-body"><p>Creating a new issue for this specific fix (https://github.com/astral-sh/uv/issues/2208), which I'm working on now.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:24:08 UTC
    </footer>
</body>
</html>
