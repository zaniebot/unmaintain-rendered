<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication when downloading package from private registry using `oauth2accesstoken` fails with 401 Unauthorized - astral-sh/uv #1449</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Authentication when downloading package from private registry using <code>oauth2accesstoken</code> fails with 401 Unauthorized</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1449">#1449</a>
        opened by <a href="https://github.com/fellhorn">@fellhorn</a>
        on 2024-02-16 07:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/fellhorn">@fellhorn</a></div>
            <div class="timeline-body"><p>Thanks a lot for this project, happy to see the so much progress in the python packaging ecosystem!</p>
<p>I tried to use <code>uv</code> with a private pip repository hosted in Google artifact registry:</p>
<pre><code>&gt; uv pip compile --extra-index-url https://oauth2accesstoken:$(gcloud auth print-access-token)@my-region-python.pkg.dev/my-project/my-repo/simple/ requirements.in

error: Failed to download: my-package==0.7.1
  Caused by: HTTP status client error (401 Unauthorized) for url (https://my-region-python.pkg.dev/my-project/my-repo/my-package/my-package-0.7.1-cp38-abi3-manylinux_2_28_x86_64.whl#sha256=my-sha)
</code></pre>
<p>This is the same both for <code>uv pip install</code> and <code>uv pip compile</code>.
It seems like the authentication for listing works (version <code>0.7.1</code> is read from the repo, I did not provide it), but the token is not used when downloading.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gwdekker">@gwdekker</a> on 2024-02-16 08:22</div>
            <div class="timeline-body"><p>FWIW, I am seeing something very similar for a gitlab-hosted artifact registry. Same error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tfcace">@tfcace</a> on 2024-02-17 07:05</div>
            <div class="timeline-body"><p>Probably related to #1458</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-23 04:34</div>
            <div class="timeline-body"><p>Should be resolved in the latest version ref #1886</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-23 04:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fellhorn">@fellhorn</a> on 2024-02-23 08:24</div>
            <div class="timeline-body"><p>Thanks, I can confirm it works now :+1:</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:29:24 UTC
    </footer>
</body>
</html>
