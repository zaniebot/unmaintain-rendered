<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>support uv run invoked via subprocess - astral-sh/uv #7449</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>support uv run invoked via subprocess</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7449">#7449</a>
        opened by <a href="https://github.com/mraesener-aubex">@mraesener-aubex</a>
        on 2024-09-17 06:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mraesener-aubex">@mraesener-aubex</a></div>
            <div class="timeline-body"><p><code>system=&#x27;Windows&#x27;, release=&#x27;10&#x27;, version=&#x27;10.0.20348&#x27;, machine=&#x27;AMD64&#x27;</code>
<code>uv 0.4.10 (690716484 2024-09-13)</code></p>
<p>not sure if that&#x27;s actually working as intended but @charliermarsh&#x27;s &quot;uv should just elevate the experience/abstract things away&quot; (if I got that right) leads me to thinking this might be something <code>uv</code> wants to handle.</p>
<p>the topic is that <code>process.terminate()</code> terminates uv (I guess), not the python interpreter invoked with <code>uv run</code>, when used via <code>subprocess</code>. example steps to reproduce:</p>
<pre><code>uv init my_foo
</code></pre>
<pre><code># app.py
import tkinter as tk

app = tk.Tk(&quot;foo&quot;)
app.mainloop()
</code></pre>
<pre><code># main.py
&quot;&quot;&quot;
example module just to run a hello world tkinter app via subprocess.
1st invocation gets started and closed as expected.
2nd invocation via `uv run` eliminating the need to find the correct python interpreter, but terminate doesn&#x27;t close the python interpreter then.
&quot;&quot;&quot; 
import subprocess
import time
from pathlib import Path


venv_python = (
    subprocess.check_output(
        [&quot;uv&quot;, &quot;run&quot;, &quot;python&quot;, &quot;-c&quot;, &quot;import sys; print(sys.executable)&quot;]
    )
    .decode()
    .strip()
)

app = Path(__file__) / &quot;..&quot; / &quot;app.py&quot;

# works and closes the tkinter app from app.py after 3 seconds
process = subprocess.Popen(
    [venv_python, app],
    stdout=subprocess.PIPE,
    stderr=subprocess.PIPE,
)

time.sleep(3)

process.terminate()


# works rather unexpected since it terminates the uv run process I guess
# tkinter app keeps running
process = subprocess.Popen(
    [&quot;uv&quot;, &quot;run&quot;, app],
    stdout=subprocess.PIPE,
    stderr=subprocess.PIPE,
)

time.sleep(3)

process.terminate()
</code></pre>
<p>just experienced this and though it&#x27;s worth an issue.</p>
<p>greetings,
Marius</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-17 13:29</div>
            <div class="timeline-body"><p>Thanks for the report, definitely a bug.</p>
<p>Related to #6738
Sort of a duplicate of <a href="https://github.com/astral-sh/uv/issues/6724">astral-sh/uv#6724</a> â€” let&#x27;s track this there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-17 13:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-17 13:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:34:05 UTC
    </footer>
</body>
</html>
