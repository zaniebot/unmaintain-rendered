<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add support for setting all remote packages to --only-binary - astral-sh/uv #3513</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add support for setting all remote packages to --only-binary</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/3513">#3513</a>
        opened by <a href="https://github.com/yeswalrus">@yeswalrus</a>
        on 2024-05-10 17:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/yeswalrus">@yeswalrus</a> on 2024-05-10 17:21</div>
            <div class="timeline-body"><p>Feature request/suggestion:
If your requirements.txt file contains both local packages that are meant to be built as well as remote packages, the <code>--no-build</code> flag becomes unusable. It would be very useful to be able to specify you don't want to build any package that needs to be fetched remotely.  At minimum this could be achieved with <code>--only-binary :remote:</code>.</p>
<p>Perhaps more flexible would be adding wildcard pattern support for the <code>--only-binary</code> flag, perhaps in the form <code>:&lt;package&gt;@&lt;remote&gt;:</code>, so you could say <code>--only-binary :some-package@*:</code> or <code>--only-binary :*@remote.url:</code></p>
<p>edit:
The simplest option would be to simply ignore the --only-binary flag for any package marked with <code>--editable</code> in the requirements.txt</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-11 02:20</div>
            <div class="timeline-body"><p>I'm having a hard time pulling up the code to confirm this, but I'm pretty sure that we already do not apply <code>--only-binary</code> to editable requirements.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-11 02:28</div>
            <div class="timeline-body"><p>Here's a demonstrative test case https://github.com/astral-sh/uv/pull/3521</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yeswalrus">@yeswalrus</a> on 2024-05-11 03:19</div>
            <div class="timeline-body"><p>Interesting. I've got some --editable local packages, and when I set --no-build, I wind up with failures. Ex:</p>
<pre><code>Built 6 editables in 868ms
error: Failed to build `sim-scores @ file:///home/user/dev/prod/pins/python/sim_scores`
  Caused by: Building source distributions is disabled
</code></pre>
<p>where my requirements.txt looks like:</p>
<pre><code>...
--editable python/sim_scores
...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yeswalrus">@yeswalrus</a> on 2024-05-11 05:15</div>
            <div class="timeline-body"><p>I think I figured out the issue.
Packages A and B are both listed in the requirements.txt with <code>--editable</code>.
Package B has Package A listed as a dependency in it's setup.py, which is sufficient to cause the error.</p>
<p>This appears to be an issue with cycle resolution. I think the <em>actual</em> bug is that if a package is listed as --editable, the ignoring of --no-build should be extended to all subsequent discoveries of it (and possibly a more detailed error message naming which dependency of the package caused the failure).</p>
<p>I can work a bit on putting together a repro test case a bit later today</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3559.html">astral-sh/uv#3559</a> on 2024-05-13 18:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yeswalrus">@yeswalrus</a> on 2024-05-13 18:51</div>
            <div class="timeline-body"><p>I've managed to reproduce the error in a unit test here: https://github.com/astral-sh/uv/pull/3559</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3561.html">astral-sh/uv#3561</a> on 2024-05-13 20:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-13 20:36</div>
            <div class="timeline-body"><p>Thanks! I've reproduced that in https://github.com/astral-sh/uv/pull/3561</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3562.html">astral-sh/uv#3562</a> on 2024-05-13 20:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-13 20:37</div>
            <div class="timeline-body"><p>Going to track this in a more focused issue at https://github.com/astral-sh/uv/issues/3562</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-05-13 20:42</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:57 UTC
    </footer>
</body>
</html>
