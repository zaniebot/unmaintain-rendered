<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document support for platform-specific dependencies in pyproject.toml - astral-sh/uv #6758</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Document support for platform-specific dependencies in pyproject.toml</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/6758">#6758</a>
        opened by <a href="https://github.com/BeeGass">@BeeGass</a>
        on 2024-08-28 15:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/BeeGass">@BeeGass</a> on 2024-08-28 15:27</div>
            <div class="timeline-body"><h2>Feature Description</h2>
<p>Currently, uv doesn't support specifying platform-specific dependencies directly in the <code>pyproject.toml</code> file. It would be incredibly useful to have the ability to define different dependencies for various platforms (e.g., Linux, macOS, Windows) within the same <code>pyproject.toml</code> file.</p>
<h2>Use Case</h2>
<p>As a developer working on a project that needs to run on multiple platforms (specifically Linux and macOS with M1 chip), I need to specify different dependencies for each platform. For example, I need to install the CUDA-enabled version of JAX on Linux, but the standard version on macOS.</p>
<h2>Proposed Solution</h2>
<p>Add support for platform-specific dependency sections in <code>pyproject.toml</code>. This could be implemented similar to how <code>pip</code> handles it with <code>sys_platform</code> markers, or as a new section under <code>[tool.uv]</code>. For example:</p>
<pre><code class="language-toml">[tool.uv.platform-dependencies]
linux = [
    &quot;jax[cuda12_pip]&gt;=0.4.18,&lt;0.5.0&quot;
]
darwin = [
    &quot;jax&gt;=0.4.18,&lt;0.5.0&quot;
]
</code></pre>
<p>Or alternatively:</p>
<pre><code class="language-toml">[project]
dependencies = [
    &quot;common-dep1&quot;,
    &quot;common-dep2&quot;,
    &quot;jax&gt;=0.4.18,&lt;0.5.0; sys_platform == 'darwin'&quot;,
    &quot;jax[cuda12_pip]&gt;=0.4.18,&lt;0.5.0; sys_platform == 'linux'&quot;
]
</code></pre>
<h2>Benefits</h2>
<ol>
<li>Simplified dependency management for cross-platform projects</li>
<li>Reduced need for separate requirements files or complex setup scripts</li>
<li>Improved developer experience when working across different environments</li>
</ol>
<h2>Additional Context</h2>
<p>This feature would align uv more closely with other packaging tools and standards in the Python ecosystem, making it easier for developers to transition to using uv in their projects.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "title: Feature Request: Support for platform-specific dependencies in pyproject.toml" to "Feature Request: Support for platform-specific dependencies in pyproject.toml" by @BeeGass on 2024-08-28 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-28 15:29</div>
            <div class="timeline-body"><pre><code class="language-toml">[project]
dependencies = [
    &quot;common-dep1&quot;,
    &quot;common-dep2&quot;,
    &quot;jax&gt;=0.4.18,&lt;0.5.0; sys_platform == 'darwin'&quot;,
    &quot;jax[cuda12_pip]&gt;=0.4.18,&lt;0.5.0; sys_platform == 'linux'&quot;
]
</code></pre>
<p>Does this not work as-is?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-08-28 17:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BeeGass">@BeeGass</a> on 2024-08-29 12:21</div>
            <div class="timeline-body"><blockquote>
<pre><code class="language-toml">[project]
dependencies = [
    &quot;common-dep1&quot;,
    &quot;common-dep2&quot;,
    &quot;jax&gt;=0.4.18,&lt;0.5.0; sys_platform == 'darwin'&quot;,
    &quot;jax[cuda12_pip]&gt;=0.4.18,&lt;0.5.0; sys_platform == 'linux'&quot;
]
</code></pre>
<p>Does this not work as-is?</p>
</blockquote>
<p>@charliermarsh
This works and works really well. Cant believe I wrote this out and never actually tried this on my own. I swore I did, but anyways. Sorry for the needless feature request. Thanks so much.</p>
<p>Great feature by the way</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-29 12:58</div>
            <div class="timeline-body"><p>No worries! Thanks for following up.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-29 12:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-08-29 12:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @zanieb on 2024-08-29 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Feature Request: Support for platform-specific dependencies in pyproject.toml" to "Document support for platform-specific dependencies in pyproject.toml" by @zanieb on 2024-08-29 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @zanieb on 2024-08-29 13:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-29 13:38</div>
            <div class="timeline-body"><p>Mind if I keep this open? We should add some documentation around this, I've seen it a couple times.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/7411.html">astral-sh/uv#7411</a> on 2024-09-15 17:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-09-15 21:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-09-15 21:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NellyWhads">@NellyWhads</a> on 2024-11-13 02:39</div>
            <div class="timeline-body"><p>How can I replicate this for pytorch? When installing on <code>darwin</code>, I need to use the regular pypi index, however, when installing on another linux machine, I'd like to explicitly use the <code>https://download.pytorch.org/whl/cu118/</code> as per the <a href="https://pytorch.org/get-started/locally/">pytorch docs</a></p>
<p>Edit: never mind - found it: https://docs.astral.sh/uv/concepts/dependencies/#platform-specific-sources</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../PMEAL/porespy/issues/1046.html">PMEAL/porespy#1046</a> on 2025-03-10 00:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/12829.html">astral-sh/uv#12829</a> on 2025-04-11 08:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:59 UTC
    </footer>
</body>
</html>
