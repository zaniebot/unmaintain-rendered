<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Integrated Security Vulnerability Scanning (`uv audit`) - astral-sh/uv #16646</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Integrated Security Vulnerability Scanning (`uv audit`)</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/16646">#16646</a>
        opened by <a href="https://github.com/cherchyk">@cherchyk</a>
        on 2025-11-09 02:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cherchyk">@cherchyk</a> on 2025-11-09 02:33</div>
            <div class="timeline-body"><h1>Feature Request: Integrated Security Vulnerability Scanning (<code>uv audit</code>)</h1>
<h2>Summary</h2>
<p>Add native security vulnerability scanning and auto-remediation capabilities to uv, leveraging uv's existing speed and resolver to provide instant security feedback during development.</p>
<h2>Motivation</h2>
<h3>Current Pain Points</h3>
<ol>
<li><strong>Fragmented tooling</strong>: Developers must use separate tools (<code>pip-audit</code>, <code>safety</code>, Snyk) for security scanning</li>
<li><strong>Performance bottleneck</strong>: Existing Python security scanners are slow, making them impractical for local development</li>
<li><strong>Manual remediation</strong>: When vulnerabilities are found, developers must manually research and test safe version upgrades</li>
<li><strong>CI-only scanning</strong>: Slow tools are relegated to CI pipelines, catching issues late in the development cycle</li>
<li><strong>No resolver integration</strong>: Current tools report issues but don't leverage dependency resolution to suggest fixes</li>
</ol>
<h3>Why This Fits uv's Mission</h3>
<ul>
<li><strong>Speed</strong>: uv's Rust implementation and existing resolver can scan dependency trees in milliseconds</li>
<li><strong>Comprehensive tooling</strong>: Aligns with uv's goal to be a unified Python tool (replacing pip, poetry, pipx, etc.)</li>
<li><strong>Developer experience</strong>: Catch vulnerabilities at <code>uv add</code> time, not just in CI</li>
<li><strong>Enterprise adoption</strong>: Security is a critical requirement for enterprise Python adoption</li>
</ul>
<h2>Proposed Solution</h2>
<h3>Core Feature: <code>uv audit</code></h3>
<p>A new command that scans Python dependencies for known security vulnerabilities:</p>
<pre><code class="language-bash"># Scan current project for vulnerabilities
uv audit

# Auto-fix by upgrading to safe versions
uv audit --fix

# Preview changes without modifying lockfile
uv audit --fix --dry-run

# Audit before adding a dependency
uv add requests --audit

# Filter by severity
uv audit --severity critical,high
</code></pre>
<h3>Example Output</h3>
<pre><code>Scanning 145 packages...

Found 3 vulnerabilities in 2 packages:

┌─────────────────────────────────────────────────────────┐
│ CRITICAL: Remote Code Execution in requests            │
├─────────────────────────────────────────────────────────┤
│ Package:    requests                                    │
│ Installed:  2.25.0                                      │
│ Fixed in:   2.31.0                                      │
│ Advisory:   GHSA-j8r2-6x86-q33q                        │
│ CVE:        CVE-2023-32681                             │
│ URL:        https://github.com/advisories/GHSA-...     │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ HIGH: Denial of Service in werkzeug                    │
├─────────────────────────────────────────────────────────┤
│ Package:    werkzeug                                    │
│ Installed:  2.0.0                                       │
│ Fixed in:   2.2.3, 2.3.0                               │
│ Advisory:   GHSA-px8h-6qxv-m22q                        │
└─────────────────────────────────────────────────────────┘

Run `uv audit --fix` to automatically upgrade to safe versions.
</code></pre>
<h3>Key Capabilities</h3>
<ol>
<li><strong>Instant scanning</strong>: Leverage uv's speed to scan entire dependency trees in &lt;100ms</li>
<li><strong>Smart resolution</strong>: Use uv's PubGrub resolver to automatically find safe version combinations</li>
<li><strong>Multiple data sources</strong>:<ul>
<li>GitHub Advisory Database (24,600+ Python advisories, free API)</li>
<li>OSV.dev API (comprehensive, free)</li>
<li>PyPA Advisory Database (can be mirrored locally)</li>
</ul>
</li>
<li><strong>Auto-remediation</strong>: Automatically update <code>uv.lock</code> to safe versions while maintaining compatibility</li>
<li><strong>Integration points</strong>: Hook into <code>uv add</code>, <code>uv sync</code>, <code>uv lock</code> with <code>--audit</code> flag</li>
<li><strong>Caching</strong>: Leverage uv's existing cache infrastructure for vulnerability data</li>
</ol>
<h3>Integration with Existing Commands</h3>
<pre><code class="language-bash"># Audit during dependency addition (fail if vulnerable)
uv add requests --audit

# Audit during sync (warn about vulnerabilities)
uv sync --audit

# Lock with audit checks
uv lock --audit

# Enable audit checks globally
uv config set audit.enabled true
uv config set audit.severity high  # Only fail on high/critical
</code></pre>
<h2>Technical Approach</h2>
<h3>Data Sources (All Free)</h3>
<ol>
<li><p><strong>GitHub Advisory Database</strong></p>
<ul>
<li>REST API: <code>https://api.github.com/advisories?ecosystem=pip</code></li>
<li>24,600+ reviewed Python advisories</li>
<li>Free, no authentication required</li>
<li>CC-BY-4.0 license</li>
</ul>
</li>
<li><p><strong>OSV.dev API</strong></p>
<ul>
<li><code>https://api.osv.dev/v1/query</code></li>
<li>Free, comprehensive coverage</li>
<li>Used by pip-audit</li>
</ul>
</li>
<li><p><strong>PyPA Advisory Database</strong></p>
<ul>
<li>Git repo: <code>https://github.com/pypa/advisory-database</code></li>
<li>Can be mirrored locally for offline support</li>
<li>OSV format</li>
</ul>
</li>
</ol>
<h3>Implementation Strategy</h3>
<ol>
<li><strong>New crate</strong>: <code>uv-audit</code> for vulnerability scanning logic</li>
<li><strong>Cache integration</strong>: Store advisory data in uv's existing cache (refresh daily)</li>
<li><strong>Resolver integration</strong>: Use existing PubGrub resolver to find safe version upgrades</li>
<li><strong>CLI integration</strong>: Add <code>audit</code> subcommand to <code>uv-cli</code></li>
<li><strong>Async fetching</strong>: Use existing <code>uv-client</code> for parallel advisory API requests</li>
</ol>
<h3>Proposed Module Structure</h3>
<pre><code>crates/
  uv-audit/
    src/
      advisory.rs      # Advisory data structures
      client.rs        # Fetch from GitHub/OSV APIs
      scanner.rs       # Scan dependency tree for vulnerabilities
      resolver.rs      # Find safe version combinations
      cache.rs         # Cache advisory data
      report.rs        # Format vulnerability reports
</code></pre>
<h2>Benefits</h2>
<h3>For Developers</h3>
<ul>
<li><strong>Shift-left security</strong>: Catch vulnerabilities during development, not in CI</li>
<li><strong>Zero friction</strong>: No additional tools to install or configure</li>
<li><strong>Instant feedback</strong>: Sub-second scanning thanks to uv's speed</li>
<li><strong>Actionable fixes</strong>: Auto-remediation instead of just warnings</li>
</ul>
<h3>For Teams</h3>
<ul>
<li><strong>Faster CI</strong>: Lightning-fast audit checks don't slow down pipelines</li>
<li><strong>Supply chain security</strong>: Continuous monitoring of dependencies</li>
<li><strong>Compliance</strong>: Built-in security scanning for audit requirements</li>
</ul>
<h3>For the Python Ecosystem</h3>
<ul>
<li><strong>Democratize security</strong>: Make enterprise-grade security accessible to all</li>
<li><strong>Better defaults</strong>: Security-by-default for new Python projects</li>
<li><strong>Network effects</strong>: More usage = more vulnerability awareness</li>
</ul>
<h2>Differentiation</h2>
<p>No other Python package manager offers this level of integration:</p>
<p>| Feature | uv audit | pip-audit | safety | Snyk |
|---------|----------|-----------|--------|------|
| Speed | &lt;100ms | ~5-30s | ~10-60s | ~15-45s |
| Auto-fix | ✅ | ❌ | ❌ | ✅ (paid) |
| Free | ✅ | ✅ | ⚠️ (limited) | ⚠️ (limited) |
| Integrated resolver | ✅ | ❌ | ❌ | ❌ |
| Offline support | ✅ | ❌ | ❌ | ❌ |
| Add-time checking | ✅ | ❌ | ❌ | ❌ |</p>
<h2>Alternative: Interactive Conflict Resolution</h2>
<p>If <code>uv audit</code> is not aligned with uv's roadmap, an alternative high-value feature would be <strong>interactive dependency conflict resolution</strong>. When resolution fails, use uv's speed to explore the solution space and suggest specific version combinations with explanations of conflicts.</p>
<h2>Implementation Effort</h2>
<p><strong>Estimated scope</strong>: Medium-large feature</p>
<ul>
<li><strong>Core scanning logic</strong>: ~1-2 weeks</li>
<li><strong>Resolver integration</strong>: ~1 week (reuse existing resolver)</li>
<li><strong>API client + caching</strong>: ~1 week</li>
<li><strong>CLI integration</strong>: ~3-5 days</li>
<li><strong>Testing + docs</strong>: ~1 week</li>
</ul>
<p><strong>Total</strong>: ~4-6 weeks for MVP</p>
<h2>Open Questions</h2>
<ol>
<li><strong>Scope</strong>: Should this be in uv core or a plugin/extension system?</li>
<li><strong>Default behavior</strong>: Enable audit checks by default or opt-in?</li>
<li><strong>Offline support</strong>: Bundle advisory database or fetch on-demand?</li>
<li><strong>Output format</strong>: Support machine-readable output (JSON/SARIF) for CI integration?</li>
<li><strong>Exit codes</strong>: Fail builds on any vulnerability or only critical/high?</li>
</ol>
<h2>Prior Art</h2>
<ul>
<li><strong>pip-audit</strong>: Python tool using PyPA advisory database (~5-30s scan time)</li>
<li><strong>cargo audit</strong>: Rust equivalent (instant, integrated with cargo)</li>
<li><strong>npm audit</strong>: Node.js built-in (fast, integrated)</li>
<li><strong>bundler-audit</strong>: Ruby built-in</li>
</ul>
<h2>Next Steps</h2>
<p>If this proposal aligns with uv's vision, I'd be happy to:</p>
<ol>
<li>Create a detailed technical design document</li>
<li>Prototype the core scanning functionality</li>
<li>Open a PR for initial implementation</li>
<li>Help with documentation and testing</li>
</ol>
<h2>Additional Context</h2>
<p>This feature would position uv not just as a faster package manager, but as a <strong>safer, smarter foundation</strong> for Python development. Given the increasing focus on supply chain security (SBOM requirements, SLSA frameworks, etc.), built-in security scanning could be a major differentiator for uv.</p>
<p>I'm excited about this opportunity and would love to contribute to making Python development more secure!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-09 02:36</div>
            <div class="timeline-body"><p>(This looks like a duplicate of https://github.com/astral-sh/uv/issues/9189.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cherchyk">@cherchyk</a> on 2025-11-09 02:37</div>
            <div class="timeline-body"><p>To clarify: I'm eager to implement this feature myself and contribute it to uv. I'm not requesting the uv team to build it - I want to take ownership of the implementation.</p>
<p>If this aligns with uv's roadmap, I'll:</p>
<ul>
<li>Lead the development effort</li>
<li>Create the detailed technical design</li>
<li>Implement the core functionality</li>
<li>Write comprehensive tests and documentation</li>
<li>Iterate based on code review feedback</li>
</ul>
<p>I'm ready to start working on this as soon as we have alignment on the approach.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cherchyk">@cherchyk</a> on 2025-11-09 02:41</div>
            <div class="timeline-body"><p>Thanks for pointing out the duplicate @charliermarsh! I should have searched more thoroughly before opening this.</p>
<p>I've read through #9189 and understand that the uv team isn't ready to accept external contributions for this feature yet due to bandwidth constraints around design work.</p>
<p>I'm very interested in contributing to this when the time is right, and I'll subscribe to #9189 to follow the discussion. In the meantime, I'll check out the existing community solutions like pysentry and uv-secure.</p>
<p>Closing this as a duplicate.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @cherchyk on 2025-11-09 02:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:05 UTC
    </footer>
</body>
</html>
