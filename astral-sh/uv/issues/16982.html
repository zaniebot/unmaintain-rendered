<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatic platform specific wheel sources via path - astral-sh/uv #16982</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Automatic platform specific wheel sources via path</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/16982">#16982</a>
        opened by <a href="https://github.com/danielkonecny">@danielkonecny</a>
        on 2025-12-04 15:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/danielkonecny">@danielkonecny</a> on 2025-12-04 15:49</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>This concerns a case where:</p>
<ul>
<li>wheels are provided via path - <code>[tool.uv.sources] package = [{path = &quot;...&quot;}]</code>; and</li>
<li>wheels are compiled for different platforms/Python versions/... in separate wheel files -  <code>[tool.uv.sources] package = [{marker = &quot;...&quot;}]</code></li>
</ul>
<p>These two are hard to combine with uv - I searched the docs and haven't found any way how to specify this neatly.
When providing paths for those wheel in <code>pyproject.toml</code>, it is necessary to specify markers for each case (<code>python_version = ... and sys_platform = ... and platform_machine = ...</code>) and it becomes very long.</p>
<p>When resolving a package via index, this is done automatically, therefore, I would expect such thing possible with a folder with wheels instead of index while the naming convention of wheels is kept.</p>
<p>I would like to propose such feature, if it's already not available. If it is, please, let me know about the syntax and maybe it would be worth adding it to the docs as well. Thank you.</p>
<h3>Example</h3>
<p>I would imagine it like this.</p>
<p>In <code>pyproject.toml</code> either (like a wildcard syntax):</p>
<pre><code class="language-toml">[tool.uv.sources]
my_package = [{ path = &quot;packages/my_package-*.whl&quot; }]
</code></pre>
<p>or (via changing the index parameter from <code>url</code> to <code>path</code>):</p>
<pre><code class="language-toml">[tool.uv.sources]
my_package = [{ index = &quot;my_package-index&quot; }]
[[tool.uv.index]]
name = &quot;my_package-index&quot;
path = &quot;packages&quot; # instead of url
explicit = true
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @danielkonecny on 2025-12-04 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-12-04 15:53</div>
            <div class="timeline-body"><p>You looking for a flat index, which uses a directory and considers the files in it an index, similar to a remote index: https://docs.astral.sh/uv/concepts/indexes/#flat-indexes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @konstin on 2025-12-04 15:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @konstin on 2025-12-04 15:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danielkonecny">@danielkonecny</a> on 2025-12-04 16:06</div>
            <div class="timeline-body"><p>Works like a charm, thank you very much! For future readers, this is the <code>pyproject.toml</code> syntax:</p>
<pre><code class="language-toml">[tool.uv.sources]
my_package = [{ index = &quot;my_package-index&quot; }]
[[tool.uv.index]]
name = &quot;my_package-index&quot;
url = &quot;path/to/packages&quot;
format = &quot;flat&quot;
explicit = true
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @danielkonecny on 2025-12-04 16:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danielkonecny">@danielkonecny</a> on 2025-12-05 10:35</div>
            <div class="timeline-body"><p>Hi @konstin, I stumbled upon one more trouble, if you could please help me. Is it possible to specify the path in the <code>tool.uv.index.url</code> with tilde (~) to get the home path? It throws an error that seems like the tilde isn't parsed in this case:</p>
<pre><code>error: Failed to read `--find-links` directory: /path/to/project/root/~/path/to/packages
Caused by: The system cannot find the path specified. (os error 3)
</code></pre>
<p>Since the tilde is available for <a href="https://docs.astral.sh/uv/concepts/projects/dependencies/#path">path dependencies</a>, I guess it would be nice to have it here too.
I'm on Windows 11 and using the latest uv (0.9.15).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @danielkonecny on 2025-12-05 10:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-12-08 11:22</div>
            <div class="timeline-body"><p>We currently don't actually support tilde expansion in uv paths, we currently support only either relative or absolute paths exclusively.</p>
<p>The example in the docs relies on shell expansion by the shell that <code>uv add</code> is invoked in:</p>
<pre><code>$ echo ~/projects/bar/
/home/konsti/projects/bar/
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danielkonecny">@danielkonecny</a> on 2025-12-08 15:06</div>
            <div class="timeline-body"><p>Thank you for the info, I will try to find a workaround. Is there any timeline on the tilde expansion implementation? Can I propose it somewhere to get that functionality some traction? I see that this is currently being discussed in a related PR https://github.com/astral-sh/uv/pull/17019.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-12-10 19:29</div>
            <div class="timeline-body"><p>Doing inference on string fields is a complex topic on its own (it goes from every path is interpreter verbatim by the OS to us adding a layer where some strings now suddenly mean something else depending on the environment you run in. e.g. <code>~</code> is technically a valid filename, and OS APIs made the choice to not support this, so we'd be making a choice above the OS APIs), I think https://github.com/astral-sh/uv/pull/17019 is a good place to discuss this.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:06 UTC
    </footer>
</body>
</html>
