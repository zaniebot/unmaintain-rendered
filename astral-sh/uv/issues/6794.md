```yaml
number: 6794
title: "Upgrade dependencies in `pyproject.toml` (`uv upgrade`)"
type: issue
state: open
author: KotlinIsland
labels:
  - enhancement
assignees: []
created_at: 2024-08-29T06:28:27Z
updated_at: 2025-12-21T23:09:15Z
url: https://github.com/astral-sh/uv/issues/6794
synced_at: 2026-01-10T01:57:15Z
```

# Upgrade dependencies in `pyproject.toml` (`uv upgrade`)

---

_Issue opened by @KotlinIsland on 2024-08-29 06:28_

# this will update the version pins in the pyproject.toml file

prior art:
- deno: https://deno.com/blog/v2.2#dependency-management
- poetry: https://github.com/MousaZeidBaker/poetry-plugin-up
- npm: https://docs.npmjs.com/cli/v10/commands/npm-update
  - npm-check-updates: https://www.npmjs.com/package/npm-check-updates

```py
> uv upgrade
upgraded 10 dependencies in 0.001 seconds üöÄ
```

why? when i want to update all the dependencies in a project, it can be tedious to manually search for and update each and every dependency. additionally, for application projects (not libraries), i like to be able to squizz the pyproject file for an easy overview of which dependencies are actually installed, not just some possible range

---

_Comment by @nathanscain on 2024-08-29 12:50_

Does `uv sync` cover this use case?

Also, I'm pretty sure dependencies will also be updated during every `uv run` call by default.

---

_Comment by @bjorhn on 2024-08-29 12:53_

I don't think uv sync can bump the pinned versions of every dependency to the latest available version, which I believe is what the issue creator is asking about. uv sync just downloads modules that match the pin, it doesn't change the pin.

This topic always ends up being confusing, people have different definitions of what it means to update or upgrade a dependency. üòÖ

---

_Comment by @nathanscain on 2024-08-29 12:59_

Ahh, yes `uv sync` updates the environments but not the install specs.

Would it be recommended to not pin exact dependencies in the `pyproject.toml` - instead to use the lock file for tracking that?

`pyproject.toml` should track compatibility and `uv.lock` should track exact versions for deployments/reproducibility.

---

_Comment by @bjorhn on 2024-08-29 13:04_

I suspect a lot of teams have a similar workflow to my team, which most project tooling has poor support for.

In the pre-Dependabot days, once a month or so we'd open up the project file on one screen and pypi on the other, then manually bump all the versions to the latest we could find. Then we'd install everything, read release notes, check what broke, and perhaps go back a version or two for some of the dependencies (which is why unpinning all the deps wouldn't work). After that we'd generate a new lock file.

Having an upgrade command would remove the manual labor of having to look up all the versions and editing the file for each individual dependency.

---

_Comment by @Mazyod on 2024-08-29 15:22_

Poetry has a nice workflow by using `poetry show --outdated` rather than opening PyPI.

---

_Comment by @akx on 2024-08-29 15:57_

`uv upgrade-interactive` would also be great, like yarn (v1):

<img width="748" alt="Screenshot 2024-08-29 at 18 57 22" src="https://github.com/user-attachments/assets/3022b134-8249-4560-98a6-c89e6a477dcc">


---

_Comment by @pythonweb2 on 2024-08-29 16:20_

Use `uv sync -U` to update packages

---

_Comment by @pythonweb2 on 2024-08-29 16:20_

Although I will note that it would be nice to be able to see which packages are outdated, similar to `pip list --outdated` or the `poetry show --outdated` command which does the same thing.

---

_Comment by @akx on 2024-08-30 05:54_

> Although I will note that it would be nice to be able to see which packages are outdated, 

That's tracked in #2150.



---

_Referenced in [astral-sh/uv#7019](../../astral-sh/uv/issues/7019.md) on 2024-09-04 13:49_

---

_Referenced in [astral-sh/uv#8585](../../astral-sh/uv/issues/8585.md) on 2024-10-26 16:22_

---

_Referenced in [johnthagen/python-blueprint#238](../../johnthagen/python-blueprint/issues/238.md) on 2024-10-28 18:18_

---

_Comment by @johnthagen on 2024-10-28 18:32_

Like @KotlinIsland said, especially for _applications_ it's really nice to be able to browse narrow ranges of your _top_ level dependencies within `pyproject.toml` and have a tool automatically bump them for you so you don't have to go to PyPI and look at each top level dependency to see what the latest version is.

It's also important to be able to skip dependencies that the user has pinned to a specific version in `pyproject.toml` so that if you know you can't upgrade past a version, you can pin it in `pyproject.toml` until the issue is resolved upstream.

The old `poetryup` plugin had a `--skip-exact` flag for this

- https://github.com/MousaZeidBaker/poetryup?tab=readme-ov-file#usage

For more prior art, see `npm-check-updates`

- https://www.npmjs.com/package/npm-check-updates

It has a nice output UI:

![image](https://github.com/user-attachments/assets/1ede6cb0-20d9-472f-967e-a5a78f6c5868)

(Long) discussion from the same feature requested in Poetry

- https://github.com/python-poetry/poetry/issues/461

---

_Comment by @krishan-patel001 on 2024-11-01 15:17_

I agree this would be a really helpful feature, especially useful in PRs for tracking version increments. Its a lot easier to see these in pyproject.toml than a lock file

---

_Comment by @daeh on 2024-11-18 00:21_

I'm also a big fan of yarn's `yarn upgrade-interactive` for interactively updating dependency versions in `package.json` and would love to see similar `uv` functionality for updating dependency versions in `pyproject.toml`.

---

_Referenced in [zanieb/uv#6](../../zanieb/uv/issues/6.md) on 2024-11-26 17:33_

---

_Referenced in [astral-sh/uv#9452](../../astral-sh/uv/issues/9452.md) on 2024-11-26 21:15_

---

_Renamed from "(üéÅ) add an `upgrade` command" to "Add a command to "upgrade" dependency constraints in the `pyproject.toml`" by @zanieb on 2024-11-26 23:57_

---

_Referenced in [astral-sh/uv#1419](../../astral-sh/uv/issues/1419.md) on 2024-12-05 03:01_

---

_Comment by @yhoiseth on 2024-12-05 11:08_

I use [this tiny script](https://gist.github.com/yhoiseth/c80c1e44a7036307e424fce616eed25e). Works like a charm.

---

_Referenced in [astral-sh/uv#6781](../../astral-sh/uv/issues/6781.md) on 2024-12-09 20:03_

---

_Renamed from "Add a command to "upgrade" dependency constraints in the `pyproject.toml`" to "(üéÅ) Add a command to "upgrade" dependency constraints in the `pyproject.toml`" by @KotlinIsland on 2024-12-11 00:18_

---

_Referenced in [astral-sh/uv#6692](../../astral-sh/uv/issues/6692.md) on 2024-12-23 17:07_

---

_Comment by @wgordon17 on 2024-12-24 15:37_

Is this intended to handle the following use case?

```
dependencies = [
    "httpx==0.27",
]
```

`uv upgrade`


```
dependencies = [
    "httpx==0.28",
]
```

(where `0.28.1` is the _latest_ version of `httpx` as listed in `uv tree --outdated`)

Would it require something like `uv upgrade --outdated [<package>]` or `uv upgrade --override [<package>]` or similar?

Currently, even an ugly hack like

`uv tree --outdated -d1 | grep "latest" | sed -E 's/.*‚îÄ‚îÄ ([^ ]*) .*latest: v(.*)\)/\1==\2/' | xargs -I {} uv lock --upgrade-package {}`

isn't working, because `uv lock --upgrade-packages` still attempts to satisfy the existing constraints. And the `uv remove`/`uv add` workaround doesn't address handling different dependency groups.

---

_Comment by @yhoiseth on 2024-12-25 14:48_

@wgordon17 

> [The] `uv remove`/`uv add` workaround doesn't address handling different dependency groups.

You might be interested in @KotlinIsland‚Äôs [improved version](https://gist.github.com/yhoiseth/c80c1e44a7036307e424fce616eed25e?permalink_comment_id=5335497#gistcomment-5335497), as this should handle dependency groups.

---

_Comment by @JakubDotPy on 2025-01-06 21:31_

Would this count as using uv? 

`uvx pdm update --unconstrained`



---

_Comment by @wgordon17 on 2025-01-09 21:23_

ü§î Does `--unconstrained` then write the difference back to `pyproject.toml`, i.e., the updated packages? Or is `pyproject.toml` now lagging behind?

---

_Comment by @Goldziher on 2025-01-10 05:52_

> Would this count as using uv? 
> 
> `uvx pdm update --unconstrained`
> 
> 

PDM is excruciatingly slow... 

The current work around with a script that uses UV to remove and readd deps is many times faster

---

_Comment by @lucebert on 2025-01-23 19:14_

+1

---

_Referenced in [astral-sh/uv#11027](../../astral-sh/uv/issues/11027.md) on 2025-01-28 19:02_

---

_Referenced in [astral-sh/uv#11300](../../astral-sh/uv/issues/11300.md) on 2025-02-06 23:52_

---

_Comment by @kedvall on 2025-02-13 11:24_

Any update on this feature request? We also used to rely on the poetry up plugin which worked well.

This is really useful for top-level dependencies, we typically care about specific versions of these packages and it's very helpful to be able to bump this without having to manually go check if there's an update available for a given package.

---

_Comment by @zanieb on 2025-02-13 15:40_

Please don't ask for updates (see #9452) ‚Äî we definitely post updates if we have them.

We haven't started working on this. It's obviously high impact / priority, but so are lots of other things.

---

_Comment by @zundertj on 2025-02-16 13:56_

The script posted above has been useful to me, but it does ignore pins and bounds, on purpose, whereas I was looking for something where I could selectively not upgrade using the existing `pyproject.toml` syntax (like the poetryup `--skip-exact` argument). I.e. specify dependency versions with `>=` by default, and add pins or upper bounds if needed, whilst the tool handles bumping the minimum versions on `>=`. So I coded up a small tool for the time being to do this, in case anyone finds it useful, you can find it here:  https://github.com/zundertj/uv-bump

---

_Comment by @wikiped on 2025-02-17 00:17_

@wgordon17 
> ü§î Does `--unconstrained` then write the difference back to `pyproject.toml`, i.e., the updated packages? Or is `pyproject.toml` now lagging behind?

`pyproject.toml` is updated (overwritten) with the latest resolved versions of the pinned packages.

`pdm update -h` for `--unconstrained`:

> -u, --unconstrained   Ignore the version constraints in pyproject.toml and overwrite with new ones from the resolution result

---

_Referenced in [astral-sh/uv#11679](../../astral-sh/uv/issues/11679.md) on 2025-02-23 23:59_

---

_Comment by @sanmai-NL on 2025-02-26 11:45_

@zanieb 
> Please don't ask for updates (see [#9452](https://github.com/astral-sh/uv/issues/9452)) ‚Äî we definitely post updates if we have them.
> 
> We haven't started working on this. It's obviously high impact / priority, but so are lots of other things.

One could also say that this feature were better handled by an external tool, like [Renovate](https://docs.renovatebot.com/python/). That tool can update dependencies more broadly, and in more advanced ways. Work on the end of uv towards a universal lockfile or other such changes is more fruitful that crafting a CLI for this.


---

_Comment by @softinio on 2025-02-26 17:40_

As a stop gap do people just use the lock file for PR reviews of dependency changes?

---

_Comment by @zundertj on 2025-03-01 08:12_

If you specify all your (direct) dependencies in `pyproject.toml` using pins (i.e. `==`), then the lock file can only change if someone has run `uv sync --upgrade` as, by default, `uv sync` will not upgrade if the current lock file satisfies the requirements in `pyproject.toml`. And it would only be dependencies of dependencies. If a PR comes in and updates a pinned version, then only that package version will change. So you would not need to review the lock file for your direct dependencies, the `pyproject.toml` is sufficient.

On the other hand, if you have not all versions pinned in `pyproject.toml`, all bets are off basically. You may get upgrades and/or downgrades, and the lock file is the place where you can see what is happening on the PR. Unfortunately, because of the contents, it is not a an easy to read summary of "package A moved from version Y to Z, package B got removed, package C was added with version X". 

I dont think it is too bad right now when it comes to reviewing PR's though, keeping `pyproject.toml` up to date is the more painful part.




---

_Comment by @samypr100 on 2025-03-02 04:18_

> For more prior art, see `npm-check-updates`
> 
>     * https://www.npmjs.com/package/npm-check-updates

I'm a fan of [npm-check-updates](https://www.npmjs.com/package/npm-check-updates) personally, especially because you can filter via `-t` for `major`, `minor`, and `patch` changes at direct and transitive layers and bump at the semver tiers which for application development is quite nice. I originally opened https://github.com/astral-sh/uv/issues/2745 with the desire of one day having semver filtering in uv for this kind of purpose.

For poetry, I've used a combination of `poetry show --outdated` with `-T` to filter for direct dependencies. I've also used [pip-check-updates](https://pypi.org/project/pip-check-updates/) in the past with `poetry export` and `uv`, but nothing quite like the ergonomics of ncu exists to my knowledge.

---

_Referenced in [astral-sh/uv#11973](../../astral-sh/uv/issues/11973.md) on 2025-03-05 19:03_

---

_Referenced in [astral-sh/uv#11509](../../astral-sh/uv/issues/11509.md) on 2025-03-10 16:37_

---

_Referenced in [astral-sh/uv#12190](../../astral-sh/uv/issues/12190.md) on 2025-03-17 13:25_

---

_Comment by @kedvall on 2025-03-17 22:05_

Hi guys, as a temporary solution I've wrote a small program to sync the minimum versions of top-level dependencies.
Please note that since it's intended to be a temporary solution it's not very robust or feature-rich and there's a few known issues I haven't had time to solve.

Anyways, hope it might be helpful! Feel free to check it out: https://github.com/kedvall/pysync.

---

_Comment by @domWalters on 2025-03-21 15:42_

> I suspect a lot of teams have a similar workflow to my team, which most project tooling has poor support for.
> 
> In the pre-Dependabot days, once a month or so we'd open up the project file on one screen and pypi on the other, then manually bump all the versions to the latest we could find. Then we'd install everything, read release notes, check what broke, and perhaps go back a version or two for some of the dependencies (which is why unpinning all the deps wouldn't work). After that we'd generate a new lock file.
> 
> Having an upgrade command would remove the manual labor of having to look up all the versions and editing the file for each individual dependency.

For anyone using `nvim`, there is a completer that might speed up this process called [`cmp-pypi`](https://github.com/vrslev/cmp-pypi) which will autocomplete available versions of a package read from the PyPi index.

Basically just `curl`s the index for the package and pulls out the available versions.

I recently improved it by adding the ability to search the optional dependencies.

Note: It doesn't currently sort into version order.

---

_Comment by @Goldziher on 2025-03-21 15:53_

So, I used a variation of the script discussed above for this. But now I am working inside a monorepo with multiple UV modules, and writing a script for this has become increasingly complex. 

I think this has to be a part of the built-in uv command, and I frankly don't see why this should be complex - it's rather smallish.

The question is, is there interest and willingness from the uv maintainers? If there is, I or someone else can contribute to this. 

---

_Referenced in [johnthagen/python-blueprint#95](../../johnthagen/python-blueprint/issues/95.md) on 2025-03-21 18:23_

---

_Referenced in [astral-sh/uv#12349](../../astral-sh/uv/pulls/12349.md) on 2025-03-22 02:07_

---

_Comment by @aretrace on 2025-03-25 02:47_

Interested in this as well.

---

_Referenced in [astral-sh/uv#6783](../../astral-sh/uv/issues/6783.md) on 2025-04-09 15:32_

---

_Referenced in [astral-sh/uv#12789](../../astral-sh/uv/issues/12789.md) on 2025-04-09 23:00_

---

_Referenced in [vrslev/cmp-pypi#5](../../vrslev/cmp-pypi/issues/5.md) on 2025-04-13 18:36_

---

_Comment by @tdamsma on 2025-04-15 09:48_


I bit gross, but this bash command works for me. It removes and then adds all dependencies 
```bash
deps=$(sed -n '/^\s*dependencies\s*=\s*\[/,/^\s*]/p' pyproject.toml | \
  grep -vE '^\s*dependencies\s*=\s*\[|^\s*\]' | \
  sed -E 's/[",]//g' | \
  sed -E 's/[<>=!~].*//' | \
  grep -vE '^\s*$' | \
  xargs)

bash -c "uv remove $deps && uv add $deps"
```

---

_Comment by @reneleonhardt on 2025-04-15 10:55_

> I bit gross, but this bash command works for me. It removes and then adds all dependencies

Nice! Now optional dependencies would be good (every line is a list) üòÖ
https://github.com/pipecat-ai/pipecat/blob/main/pyproject.toml#L41

---

_Renamed from "(üéÅ) Add a command to "upgrade" dependency constraints in the `pyproject.toml`" to "Add a command to upgrade dependencies in `pyproject.toml`" by @konstin on 2025-04-30 13:39_

---

_Label `enhancement` added by @konstin on 2025-04-30 13:39_

---

_Assigned to @konstin by @konstin on 2025-04-30 13:39_

---

_Referenced in [astral-sh/uv#9084](../../astral-sh/uv/issues/9084.md) on 2025-05-03 17:56_

---

_Renamed from "Add a command to upgrade dependencies in `pyproject.toml`" to "Upgrade dependencies in `pyproject.toml` (`uv upgrade`)" by @konstin on 2025-05-04 21:01_

---

_Comment by @trevorstr on 2025-05-07 12:10_

I just tried to manually change a dependency version in `pyproject.toml` and then executed `uv run`, and it still used the old package version.

I updated `browser-use` to include the version specifier, whereas previously it didn't.

```
dependencies = [
    "boto3>=1.37.36",
    "browser-use==0.1.45",
    "watchtower>=3.4.0",
]
```

After running `uv run <script>`, I checked the `./lib/python3.13/site-packages` directory, and the new package version was not in there.

It's kind of deceiving (unintentionally) for `uv` to simply ignore the updated version specifier, and continue using the old version, when the developer has explicitly updated `pyproject.toml`.

That is my use case for needing the `upgrade` sub-command.

---

_Comment by @Goldziher on 2025-05-07 13:00_

the uv-bump solution above works pretty well. Perhpas it can be published?

---

_Comment by @reneleonhardt on 2025-05-07 14:25_

> After running `uv run <script>`, I checked the `./lib/python3.13/site-packages` directory, and the new package version was not in there.

Do you mean:
* uv.lock contained browser-use==old.version.x (<0.1.45)
* pyproject.toml changed from "browser-use" to "browser-use==0.1.45" (manual update)
* uv run didn't change uv.lock to browser-use==0.1.45
* [Please don't use the latest version, then you will see better if your constraint has been respected. For example `0.1.44`]

I don't think uv run changes the lockfile, did you call `uv lock --check` and `uv lock --upgrade-package browser-use`?
https://docs.astral.sh/uv/reference/cli/#uv-lock--upgrade-package

There should be no other "output" files laying around (only pyproject.toml and uv.lock).
My problem was that when requirements.txt existed while I was exporting it (overwriting the whole file), uv wouldn't update minor versions even if they were allowed by constraints.

And pay attention to the log output, other dependencies can influence the outcome (preventing updates).
So in your case a single dependency browser-use would be best üòÖ

---

_Comment by @Lauszus on 2025-05-08 20:59_

Here is a shell script for upgrading all dependencies:

```bash
#!/bin/bash -e

# Allow to specify a directory as the first argument
dir=.
if [ $# -gt 0 ]; then
  dir=$1
fi

# Sync the current project
uv --directory "$dir" sync --refresh --locked

# Get all the outdated dependencies
outdated="$(uv --directory "$dir" pip list --outdated --format json | jq -r '.[] | {name,version,latest_version} | join(" ")')"

# Iterate over all of them
upgraded=false
while IFS= read -r line; do
    [ -z "$line" ] && continue
    IFS=' ' read -r name version latest_version <<< "$line"
    # Check if they are actually present in pyproject.toml or a dependency of a dependency
    if grep -q "$name" "$dir/pyproject.toml"; then
        echo "Upgrading $name $version -> $latest_version"
        sed -i -E "s/$name( ?[~=>]?[>=] ?)$version/$name\1$latest_version/" "$dir/pyproject.toml"
        upgraded=true
    fi
done <<< "$outdated"

# Re-lock the project if a dependency was upgraded
if $upgraded; then
    uv --directory "$dir" lock
fi
```

---

_Comment by @ssteinerx on 2025-05-09 04:40_

@Lauszus -- great idea, but unfortunately, it misses what is, I would think, a pretty common case.   

If the *installed* version is the latest (because the version spec in `pyproject.toml` allows it), then `uv pip list --outdated` won't pick it up since the latest version *is* in the `.venv`.

For example, if  `"pydantic>=2.8.0"`, is in `pyproject.toml`, then `uv sync --refresh` will upgrade to `"pydantic=2.11.4"` in the `.venv`.

`uv pip list --outdated`  won't pick it up because the `.venv` *has* the latest version and, so, nothing will happen.

@tdamsma's script above will replace the old version *spec* with the new in this case (by removing, then reinstalling), but that might not always be right, either.

I think the only reasonable way to really do this is to snag all the version specs out of pyproject.toml, snag them from a refreshed `.venv`, compare, then ask the user what they want to do (or have a config for this behaviour).   

Also, there are some ambiguities around how to update the spec e.g. do you use `>=` just because that's what was there before, or do you restrict it to `=` to make sure the update check is more obvious/accurate/narrower in the future?

Regardless, I don't know about you, but I sure wouldn't want to do that in a bash script ;-).



---

_Comment by @Lauszus on 2025-05-09 08:38_

> [@Lauszus](https://github.com/Lauszus) -- great idea, but unfortunately, it misses what is, I would think, a pretty common case.
> 
> If the _installed_ version is the latest (because the version spec in `pyproject.toml` allows it), then `uv pip list --outdated` won't pick it up since the latest version _is_ in the `.venv`.
> 
> For example, if `"pydantic>=2.8.0"`, is in `pyproject.toml`, then `uv sync --refresh` will upgrade to `"pydantic=2.11.4"` in the `.venv`.
> 
> `uv pip list --outdated` won't pick it up because the `.venv` _has_ the latest version and, so, nothing will happen.
> 
> [@tdamsma](https://github.com/tdamsma)'s script above will replace the old version _spec_ with the new in this case (by removing, then reinstalling), but that might not always be right, either.
> 
> I think the only reasonable way to really do this is to snag all the version specs out of pyproject.toml, snag them from a refreshed `.venv`, compare, then ask the user what they want to do (or have a config for this behaviour).
> 
> Also, there are some ambiguities around how to update the spec e.g. do you use `>=` just because that's what was there before, or do you restrict it to `=` to make sure the update check is more obvious/accurate/narrower in the future?
> 
> Regardless, I don't know about you, but I sure wouldn't want to do that in a bash script ;-).

Ahh I see your point. It won't work for `>=` or `>`. I don't use that for my application, so it's not a problem in my case.

This was just a quick script I did to get it working for me since Dependabot keeps breaking, so wanted to share it in case somebody else might find it useful :)

---

_Comment by @zundertj on 2025-05-10 06:15_

> the uv-bump solution above works pretty well. Perhpas it can be published?

I have published it here: https://pypi.org/project/uv-bump/.

---

_Comment by @zundertj on 2025-05-10 07:04_


> I think the only reasonable way to really do this is to snag all the version specs out of pyproject.toml, snag them from a refreshed `.venv`, compare, then ask the user what they want to do (or have a config for this behaviour).
> 
> Also, there are some ambiguities around how to update the spec e.g. do you use `>=` just because that's what was there before, or do you restrict it to `=` to make sure the update check is more obvious/accurate/narrower in the future?

This is why in uv-bump I decided to define dependencies with `>=` and let the UV resolver do its thing. If you want to pin, you can define a dependency version with `==` instead, and it will pin as intended. Same for holding off a major version upgrade, you can just say `plotly>=5.1.0,<6` with the normal syntax and version 6 wont be installed. The versions on `>=` in the `pyproject.toml` will still be updated, i.e. the whole purpose is to upgrade and not allow falling back to older versions in the future, so it is still possible to see which version is actually used, it is just slightly less pleasant on the eyes than `==`. In return, it does completely remove the ambiguity on upgrading and does not require a separate interface where you need to ask the user what to do for each dependency, i.e. does `==` mean "please upgrade" or does `==` mean "please pin on this version" for each dependency in the context of an "upgrade" command.


---

_Comment by @sterliakov on 2025-05-15 20:34_

I'd appreciate a workflow similar to `pnpm update -i -L`: **i**nteractive, ignoring version constraints. That's extremely helpful when you have to deal with a pyproject.toml with arbitrary constraints: you can just compare "current" vs "latest" for every package and pick packages you're going to update now. 

---

_Comment by @BrodaNoel on 2025-05-18 01:27_

Guys... Instead of creating external dependencies for this, please send a PR on this project!

---

_Comment by @sakalys on 2025-05-22 08:08_

> Use `uv sync -U` to update packages

What's wrong with this approach?

---

_Comment by @matdibu on 2025-05-22 08:49_

> > Use `uv sync -U` to update packages
> 
> What's wrong with this approach?

it will only update `uv.lock`, not the constraints in `pyproject.toml`

---

_Referenced in [PrefectHQ/prefect#17850](../../PrefectHQ/prefect/issues/17850.md) on 2025-05-22 13:55_

---

_Referenced in [astral-sh/uv#13613](../../astral-sh/uv/issues/13613.md) on 2025-05-23 08:30_

---

_Referenced in [astral-sh/uv#13632](../../astral-sh/uv/issues/13632.md) on 2025-05-26 10:39_

---

_Comment by @richardkmichael on 2025-06-09 19:05_

I would find it convenient if:

* `uv` commands with `--upgrade` (`sync`, `lock`, `tree`)  could update the lower-bounded spec in `pyproject.toml` -- to keep the proj file authoritative (for anyone not using `uv`) and for clarity when reading it

* `uv`commands with `--outdated` indicated the highest version permitted by the `project.toml` spec -- reminds me if the spec itself needs updating, since `uv sync --upgrade` does nothing, but is _silent_ once the package is at the upper-bound of the spec despite the package being out-of-date

e.g.,

`pyproject.toml`:

```
dependencies = [
  "fastmcp>=2.5.1,<2.7.0"
]
```

```
# Here, edit pyproject.toml to "fastmcp>=2.6.1,<2.7.0"
$ uv sync --upgrade
Resolved 43 packages in 295ms
Prepared 11 packages in 111ms
Uninstalled 7 packages in 24ms
Installed 11 packages in 13ms
 - fastmcp==2.5.2
 + fastmcp==2.6.1

$ uv tree --outdated --depth 1
Resolved 43 packages in 1ms
mcp-toolbox v0.1.0
‚îú‚îÄ‚îÄ fastmcp v2.6.1 (latest: v2.7.1)   # Here, also indicate the spec prohibits the latest version

# Here, notify if latest versions are spec prohibited
$ uv sync --upgrade
Resolved 43 packages in 246ms
Audited 42 packages in 0.22ms
```

---

_Referenced in [astral-sh/uv#13934](../../astral-sh/uv/pulls/13934.md) on 2025-06-09 20:35_

---

_Comment by @reneleonhardt on 2025-06-09 20:40_

If someone wants to test my example implementation: #13934
```
uv upgrade --dry-run --recursive --filter=prod,dev,optional,groups --allow=1,2,3,4 # (major, minor, patch, build number)
```

<img width="997" alt="Image" src="https://github.com/user-attachments/assets/5c3643ea-e23c-45f6-9970-53a359e81e9e" />

---

_Comment by @eruvanos on 2025-06-13 08:04_

I just found this, the idea to use the `uv.lock` to identify the updated versions seems like a good idea in our setup, but we also do not have constraints, which provide upper bounds.
https://gist.github.com/yamanahlawat/270a120dd1981010a9336b871f80a39b

---

_Comment by @reneleonhardt on 2025-06-13 11:25_

> I just found this, the idea to use the `uv.lock` to identify the updated versions seems like a good idea in our setup, but we also do not have constraints, which provide upper bounds. https://gist.github.com/yamanahlawat/270a120dd1981010a9336b871f80a39b

That's no upgrade assuming uv.lock has been updated from the same pyproject.toml constraints the last time.
But it could "upgrade" lower bounds if it would have been designed that way, i.e. `>1` becomes `>2` if uv.lock contains 2.3.4.
If you want to try upgrading you could checkout my example implementation #13934.

---

_Referenced in [aws/aws-codebuild-docker-images#779](../../aws/aws-codebuild-docker-images/issues/779.md) on 2025-06-13 21:43_

---

_Referenced in [jbsinger-jpg/issue_tracker#2](../../jbsinger-jpg/issue_tracker/issues/2.md) on 2025-07-12 14:30_

---

_Referenced in [dependabot/dependabot-core#12788](../../dependabot/dependabot-core/issues/12788.md) on 2025-08-07 17:39_

---

_Unassigned @konstin by @konstin on 2025-08-08 13:28_

---

_Referenced in [astral-sh/uv#15383](../../astral-sh/uv/issues/15383.md) on 2025-08-19 17:19_

---

_Referenced in [astral-sh/uv#15632](../../astral-sh/uv/issues/15632.md) on 2025-09-05 12:22_

---

_Referenced in [astral-sh/uv#7515](../../astral-sh/uv/issues/7515.md) on 2025-10-17 00:48_

---

_Referenced in [equinor/dataorc#30](../../equinor/dataorc/pulls/30.md) on 2025-11-04 08:12_

---

_Comment by @m-walters on 2025-11-10 09:50_

Bumping this.
Another use case: Returning to an old project (or any project in general) and you want to upgrade the project and then have these versions reflected in the `pyproject`. Of course, this should probably by default only operate on `>` and `>=` packages.

It's fine if this is two commands, where e.g. the lock is upgraded, but then we need a command that updates the `pyproject` from the lock.

---

_Comment by @vdboor on 2025-11-11 09:12_

Another prior art in Python:

* https://github.com/alanhamlett/pip-update-requirements (pur)
* https://pypi.org/project/uppd/ (works for `pyproject.toml`!)

```
$ pur -r requirements.txt
Updated flask: 0.9 -> 1.0.2
Updated sqlalchemy: 0.9.10 -> 1.2.8
Updated alembic: 0.8.4 -> 0.9.9
All requirements up-to-date.
```

It is really useful to be able to upgrade the base dependency list. Otherwise it becomes out of date with the actual required versions that `uv.lock` has. When my project requires new base versions, I want `pyproject.toml` to reflect that.

`pur` also has a simple but effective solution to respect major/minor releases:

    pur -r requirements.txt --patch=Django

That does upgrade Django, but only to new patch versions (e.g. 5.0.9 -> 5.0.14 instead of upgrading to 5.1 / 6.0)

---

_Referenced in [janusheide/uppd#33](../../janusheide/uppd/issues/33.md) on 2025-11-11 09:20_

---

_Comment by @Quidge on 2025-11-11 13:47_

I've been subscribed to this issue for quite a while because I want it. But in the interim I've been using this slash command prompt with Claude Code to pretty good success once per week (for ~2 months now). I've set this up as a slash command (as `/dep-upgrade`). So I can pop in a CC session, run `/dep-upgrade`, wait a few minutes, and come back to my dependencies 'bumped' with the pyproject.toml file updated.

A deterministic way to do most of this would be swell, but this has been working quite well in the interim (added bonus that it handles my pre-commit deps too).

```
---
description: Upgrade dependencies in lock file and pyproject.toml
allowed-tools: Read, Grep, Edit, Bash(uv sync:*), Bash(uv pip list), Bash(uv run pre-commit autoupdate), Bash(just format), Bash(just test-all)
---

1. Run `uv sync --upgrade --all-groups` to upgrade all dependencies
2. Find all dependencies explicitly mentioned in the pyproject.toml file. Use `uv pip list` to show the packages that
   are now installed.
3. Update the minimum version constraints in pyproject.toml to match the exact versions from the `uv pip list` output
   (e.g., change `>=2,<3` to `>=2.4.0,<3` if lockfile shows 2.4.0). If versions already match, skip to next step.
4. Run `uv sync --all-groups` again to ensure the updated constraints work (skip if no changes were made)
5. Run `uv run pre-commit autoupdate` to upgrade pre-commit hook versions
6. Update pinned versions in pyproject.toml to match .pre-commit-config.yaml (ruff and sqlfluff must be kept in sync
   between both files). If versions already match, skip to next step.
7. Run `uv sync --all-groups` again to install the updated pinned versions (skip if no changes were made)
8. Run `just format` and fix any formatting issues (run again if files were modified)
9. Run `just test-all` to verify all tests still pass

Important notes:

- Pinned versions (with `==` like ruff and sqlfluff) must be kept in sync between pyproject.toml and
  .pre-commit-config.yaml - update both files when pre-commit autoupdate changes them
- Preserve all comments in pyproject.toml
- Unless explicitly noted, DO NOT upgrade to pre-release or alpha versions. Upgrade only to stable versions.

Files included in context:

- @pyproject.toml
- @.pre-commit-config.yaml
```

---

_Comment by @tomaszbk on 2025-11-11 15:18_

Most private application projects don‚Äôt need dependency ranges. In production, we always use the exact versions specified in uv.lock, so having different lower bounds in pyproject.toml just adds confusion: it makes us dig into uv.lock to find out what‚Äôs actually installed. It would be much clearer if the versions matched directly.

Looking forward to seeing this addressed.

---

_Comment by @samuelhwilliams on 2025-11-24 08:34_

Definitely continues to confuse me/catch me out that this isn't supported in `uv` yet üôá 

---

_Comment by @timziebart on 2025-11-25 14:33_

Just came here looking for that exact feature. I would definitely love to have it, so it could make my life a lot easier :)

---

_Comment by @y2kbugger on 2025-12-05 18:32_

Friendly reminder that `uv pip list --outdated` gets you halfway there

---

_Comment by @Alirex on 2025-12-08 03:05_

I created app `uv-upgrade` (in Python, with uv).

https://github.com/Alirex/uv_upgrade

It is created mainly as proof-of-concept for personal usage.

But it can be useful for someone else.

Now it supports:
- `>=` constraints (others are skipped)
- main `dependencies`
- `dependency-groups`
- styles preserving (comments in TOML)
- auto-rollback (if `uv lock` after changing `pyproject.toml` have errors)

It uses some actions from `uv` via subprocess.

Extra information in readme.

After installation (with uv) it can be run as simple as `uv-upgrade` in any directory with `pyproject.toml`.

If you have any suggestions or issues, please create them in the GitHub repository.

---

_Referenced in [zundertj/uv-bump#7](../../zundertj/uv-bump/issues/7.md) on 2025-12-10 12:29_

---

_Comment by @Alirex on 2025-12-10 12:33_

I added some extra features.

Also, I find out other similar implementations. 

Anyway, I put my solution to PyPI: https://pypi.org/project/uv-upx/

I made a comparison with other solutions.

My implementation now supports workspaces (1 `uv.lock`, many `pyproject.toml`) (in some way).
Also, it automatically fixes "no version" dependencies.
And have some extra features.

---

_Referenced in [astral-sh/uv#17113](../../astral-sh/uv/issues/17113.md) on 2025-12-13 03:03_

---

_Referenced in [astral-sh/uv#17029](../../astral-sh/uv/issues/17029.md) on 2025-12-13 03:04_

---

_Comment by @calliecameron on 2025-12-19 17:08_

I have a different implementation that always uses pinned packages, e.g. for an application - it would be useful if this was supported too.

https://github.com/calliecameron/copier-template/blob/main/.template_files/uv_update_deps_internal.py

---

_Comment by @Alirex on 2025-12-20 22:17_

@calliecameron can you provide more details? Maybe some concrete example?

I see that the provided implementation is reinstalling the dependencies from the root pyproject. So, comments relations can be lost.

Maybe this tool will be enough for you: https://pypi.org/project/uv-upx/ (command `uv-upgrade`)

It also preserves comments. Like here

```toml
dependencies = [
    # Better classes and data validation
    "pydantic>=2.12.5",
    # TOML parser and writer with preserved formatting
    "tomlkit>=0.13.3",
    # CLI app framework
    "typer>=0.20.0",
]
```

And have some extra features.
That, I hope, will be implemented in `uv upgrade` from `uv` :)



---

_Comment by @calliecameron on 2025-12-21 07:39_

@Alirex for applications rather than libraries, I pin all my dependencies with `==`, and want them all to be updated with the new version also pinned with `==` - e.g. from `foo==0.1.0` to `foo==0.2.0`.

Some earlier commenters seem to want this behaviour too. My implementation is specific to this use case, and shows how you can do this by combining a few existing UV commands - it doesn't try to be a general tool like uv-upx does (and is currently tied to my copier template rather than being a separate tool).

I was just pointing out it would be useful for whatever eventually gets implemented in UV to support this use case, too.

---

_Comment by @johnthagen on 2025-12-21 13:00_

> for applications rather than libraries, I pin all my dependencies with `==`

One issue with always using exact pinning in `pyproject.toml` is that then you can't distinguish between "here's the version I use, update it" and "here's the version I use, *don't* update it, because I know newer versions are broken". Work with enough dependencies long enough and you are likely to run into this problem.

That is part of the motivation on my comment earlier

- https://github.com/astral-sh/uv/issues/6794#issuecomment-2442335752

---

_Comment by @y2kbugger on 2025-12-21 14:01_

> [@Alirex](https://github.com/Alirex) for applications rather than libraries, I pin all my dependencies with `==`, and want them all to be updated with the new version also pinned with `==` - e.g. from `foo==0.1.0` to `foo==0.2.0`.
> 
> Some earlier commenters seem to want this behaviour too. My implementation is specific to this use case, and shows how you can do this by combining a few existing UV commands - it doesn't try to be a general tool like uv-upx does (and is currently tied to my copier template rather than being a separate tool).
> 
> I was just pointing out it would be useful for whatever eventually gets implemented in UV to support this use case, too.

Isn't that what the lock file is for?

---

_Comment by @bjorhn on 2025-12-21 14:04_

> Isn't that what the lock file is for?

No, for a lot of people the lock file is primarily for subdependencies.

---

_Comment by @Alirex on 2025-12-21 23:02_

@calliecameron @johnthagen 

https://pypi.org/project/uv-upx/ upgraded.

New features:

---

### Upgrade `equal`/`pinned` dependencies

Honestly, I think it's insecure to upgrade pinned dependencies automatically.
Because they must be pinned for a reason.

For applications that require strict control of dependencies, maybe better to use `frozen` mode of `uv sync`.

But for someone it can be useful to upgrade pinned dependencies automatically.

And we can do it.

```shell
uv-upgrade --profile with_pinned
```

It handles only `equal` (`==`) and NOT `strictly equal` (`===`) operators.

So, even in this mode, it won't change `bla===2.0.0`.

Under the hood it:

- collect all top-level dependencies information
- changes `==` version constraints to `>=`
- runs the standard upgrade process by `uv`
- upgrade `pyproject.toml` files accordingly with returning `==` constraints back

Note: more `upgrade` profiles can be added later. Or/and custom verbose `features` options.

Note: Can be combined with `--interactive` mode.

### Interactive mode

You can run the tool in interactive mode.

You must `Accept` or `Reject` each proposed change.

```shell
uv-upgrade --interactive
```

Demo example:

<img width="582" height="562" alt="Image" src="https://github.com/user-attachments/assets/ab03fdca-155c-4399-8553-b3efbe254e53" />



---
