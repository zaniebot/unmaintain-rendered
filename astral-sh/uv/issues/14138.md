```yaml
number: 14138
title: "Overriding dependency with locally compiled *.whl"
type: issue
state: closed
author: PawelPeczek-Roboflow
labels:
  - question
assignees: []
created_at: 2025-06-18T19:26:37Z
updated_at: 2025-06-24T09:02:41Z
url: https://github.com/astral-sh/uv/issues/14138
synced_at: 2026-01-10T01:57:32Z
```

# Overriding dependency with locally compiled *.whl

---

_Issue opened by @PawelPeczek-Roboflow on 2025-06-18 19:26_

### Question

Hello team.

I do have a question regarding the following use-case in my project:
There is a library that uses `opencv-python` and uv sync resolved into newest version `4.11.0.86` (but in general, dependency is defined in the following way `opencv-python>=4.8.1.78`). For some installations of my package, I would like to have **opencv compiled from sources** with CUDA support included. I do have a script that creates a custom OpenCV wheel in my docker build, at the end of the script I run `uv pip install --system my-opencv.whl` and then follow with installation of remaining dependencies (`uv pip install --system -r pyproject.toml`).

At the end of the day I find the env in mismatched state - import of opencv is raising:
```
ImportError: ERROR: recursion is detected during loading of "cv2" binary extensions. Check OpenCV installation.
```

Is there a way on how to reliably include locally compiled packages when installing library under uv control?

### Platform

independent

### Version

newesr

---

_Label `question` added by @PawelPeczek-Roboflow on 2025-06-18 19:26_

---

_Comment by @zanieb on 2025-06-18 20:01_

This sounds specific to `opencv-python`, I'm not sure what uv-specific behavior would be relevant here. We support this, either, by installing the wheel separately as you are or by using a [`source`](https://docs.astral.sh/uv/concepts/projects/dependencies/#path).

---

_Comment by @PawelPeczek-Roboflow on 2025-06-19 10:01_

thanks for the answer - was digging a little bit deeper into docs and  https://docs.astral.sh/uv/concepts/projects/sync/#partial-installations may be helpful - testing it out, will let know how it goes

---

_Comment by @PawelPeczek-Roboflow on 2025-06-24 09:02_

ok, it works 
this is the scratch of what I did:
```
RUN UV_PROJECT_ENVIRONMENT=/usr $HOME/.local/bin/uv sync --locked --no-install-package opencv-python --extra torch-jp6-cu126 --extra onnx-jp6-cu126
RUN $HOME/.local/bin/uv pip install --system /build/opencv_compilation/opencv-4.11.0/release/python_loader/dist/opencv-4.11.0-py3-none-any.whl
COPY inference_experimental/inference_exp inference_exp
RUN $HOME/.local/bin/uv build
RUN WHEEL=$(ls dist/inference_exp-*.whl) && $HOME/.local/bin/uv pip install --system --no-deps "${WHEEL}"
```

@zanieb some suggestion regarding the convenience of usage:
I want to mention that it seems to be important to have ability for reproducible resolution of dependencies in selected env rather than venv which is not practical for my project. 
The `UV_PROJECT_ENVIRONMENT` works fine, but required additional tweaks (seems like the `python3` binary is looked for, which required from me additional `update-alternatives` configs when multiple python binaries were available - so maybe `uv sync --system ...` would be more handy?

---

_Closed by @PawelPeczek-Roboflow on 2025-06-24 09:02_

---
