<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can python versions be restricted on a specific sys_platform? - astral-sh/uv #16525</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Can python versions be restricted on a specific sys_platform?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16525">#16525</a>
        opened by <a href="https://github.com/mhicks-cfs">@mhicks-cfs</a>
        on 2025-10-30 21:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mhicks-cfs">@mhicks-cfs</a> on 2025-10-30 21:53</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I am currently trying to update a <code>uv</code> project to add py3.13 support to the project. Unfortunately there is a issue with dependencies that is currently preventing this on MacOS (Darwin). We would like to allow Windows and Linux to upgrade, but hold back Darwin until the upstream dependency issue is resolved.</p>
<p>Is it possible to have different python version ranges for the Darwin <code>sys_platform</code> than for other <code>sys_platform</code>s? Specifically we need 3.11-3.12 on Darwin and 3.11-3.13 for all others. I could not find this described in the docs, and a error was emitted when I tried to use the same syntax for specifying different package dependencies per platform for this.</p>
<h3>Platform</h3>
<p>Linux, Windows, Darwin</p>
<h3>Version</h3>
<p>0.9.6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @mhicks-cfs on 2025-10-30 21:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/muhammad-fiaz">@muhammad-fiaz</a> on 2025-10-31 06:31</div>
            <div class="timeline-body"><p>@mhicks-cfs you can do that by <code>markers</code>  and also using uv prebuild <a href="https://docs.astral.sh/uv/reference/settings/">settings</a></p>
<p>also there's feature for <a href="https://docs.astral.sh/uv/concepts/projects/config/#limited-resolution-environments">Limited resolution environments</a></p>
<p>also you can use like this</p>
<pre><code class="language-toml">[project]
dependencies = [&quot;httpx&quot;]

[tool.uv.sources]
httpx = [
  { git = &quot;https://github.com/encode/httpx&quot;, tag = &quot;0.27.2&quot;, marker = &quot;sys_platform == 'darwin' and python_version &gt;= '3.11'&quot; },
  { git = &quot;https://github.com/encode/httpx&quot;, tag = &quot;0.24.1&quot;, marker = &quot;sys_platform == 'linux' and python_version &lt; '3.11'&quot; },
]
</code></pre>
<p>or</p>
<pre><code class="language-toml">[project]
dependencies = [&quot;torch&quot;]

[tool.uv.sources]
torch = [
  { index = &quot;torch-cpu&quot;, marker = &quot;platform_system == 'Darwin'&quot;},
  { index = &quot;torch-gpu&quot;, marker = &quot;platform_system == 'Linux'&quot;},
]

[[tool.uv.index]]
name = &quot;torch-cpu&quot;
url = &quot;https://download.pytorch.org/whl/cpu&quot;
explicit = true

[[tool.uv.index]]
name = &quot;torch-gpu&quot;
url = &quot;https://download.pytorch.org/whl/cu124&quot;
explicit = true
</code></pre>
<p>for above refer <a href="https://docs.astral.sh/uv/concepts/projects/dependencies/#multiple-sources">here</a></p>
<p>i hope this helps :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mhicks-cfs">@mhicks-cfs</a> on 2025-10-31 22:39</div>
            <div class="timeline-body"><p>Thanks @muhammad-fiaz, using Limited Resolution Environments ended up working. If anyone comes across the same question here is a solution to limit python on MacOS but not other platforms. With this configuration the lock file does not contain a resolution for 3.13 under MaxOS, as desired:</p>
<pre><code>[project]
requires-python = &quot;&gt;=3.11, &lt;3.14&quot;
...

[tool.uv]
environments = [
    &quot;sys_platform == 'darwin' and python_version &lt; '3.13'&quot;,
    &quot;sys_platform != 'darwin'&quot;,
]
</code></pre>
<p>I do think this may be a good example to add to the docs as well since it is non-obvious that it differs from the way package dependencies are specified for different platforms.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-01 20:26</div>
            <div class="timeline-body"><p>Yeah, that solution looks reasonable to me (and I think it should also fail (correctly) if you try to install on macOS with Python 3.14).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-11-01 20:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:14 UTC
    </footer>
</body>
</html>
