<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add &quot;package depth&quot; to prioritization - astral-sh/uv #3149</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add &quot;package depth&quot; to prioritization</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/3149">#3149</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-04-19 23:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-19 23:17</div>
            <div class="timeline-body"><p>After &quot;directly pinned packages&quot;, pip breaks ties based on package depth: https://github.com/pypa/pip/blob/ef78c129b1a966dbbbdb8ebfffc43723e89110d1/src/pip/_internal/resolution/resolvelib/provider.py#L120. We don't have a straightforward measurement for this right now, so it's not included in the heuristics. (Instead, we track &quot;the order in which we visit packages&quot;, which isn't the same thing.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">performance</span> added by @charliermarsh on 2024-04-19 23:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/3148.html">astral-sh/uv#3148</a> on 2024-04-19 23:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4372.html">astral-sh/uv#4372</a> on 2024-06-18 07:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wakamex">@wakamex</a> on 2024-06-18 13:19</div>
            <div class="timeline-body"><p>I'd love to see a slower &quot;bleeding edge&quot; resolution mode whose goal is to install latest versions as much as possible.  To do this reliably, you'd need to visit all direct dependencies and pull up the release date of their one-back version, in order to backtrack to the most recent.</p>
<p>It would be helpful for personal projects where my aim is to try out the latest version of everything and help teams with issues as they arise.</p>
<p>It might be useful more generally too, to avoid race-to-the-bottom backtracks. Basically switching from depth-first to breadth-might resolve faster and with a happier outcome of versions that work well together since they were released around the same time.</p>
<p>See #4372 for an example of dependency hell that is happily resolved with a reliable &quot;most recent&quot; trackback.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/6209.html">astral-sh/uv#6209</a> on 2024-08-27 00:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-11-07 14:49</div>
            <div class="timeline-body"><p>FWIW, I don't think depth is a good heuristic in terms of finding a solution faster. It actually got <a href="https://github.com/pdm-project/pdm/pull/3235#issuecomment-2451150062">broken </a> in the recent <a href="https://github.com/sarugaku/resolvelib/blob/main/CHANGELOG.rst#110-2024-10-31">resolvelib release</a> and my testing of fixing it I find it makes pip worse at resolving than just removing it.</p>
<blockquote>
<p>I'd love to see a slower &quot;bleeding edge&quot; resolution mode whose goal is to install latest versions as much as possible. To do this reliably, you'd need to visit all direct dependencies and pull up the release date of their one-back version, in order to backtrack to the most recent.</p>
</blockquote>
<p>I would request this seperately as it's not really related to depth. A preference on &quot;upload-time&quot; might be possible without doing everything you say, but it would depend on the Simple Index 1.1 (i.e. PEP 700) and lots of non-PyPI indexes do not do that, so it might be fairly unreliable for lots of use cases.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:57 UTC
    </footer>
</body>
</html>
