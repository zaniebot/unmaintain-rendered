<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv sync --locked --no-install-project fails if only project version changes - astral-sh/uv #15643</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv sync --locked --no-install-project fails if only project version changes</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/15643">#15643</a>
        opened by <a href="https://github.com/carlosjourdan">@carlosjourdan</a>
        on 2025-09-02 21:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/carlosjourdan">@carlosjourdan</a> on 2025-09-02 21:21</div>
            <div class="timeline-body"><h3>Summary</h3>
<h1>Description</h1>
<p>When running <code>uv sync --locked --no-install-project</code> I would expect the operation to succeed if all the dependencies are in line with the <code>uv.lock</code> file, regardless of the project version.</p>
<h1>Steps to reproduce</h1>
<p>Create a new project with <code>uv init</code> and add any dependencies
Run <code>uv sync --no-install-project</code>
Run <code>uv sync --locked --no-install-project</code> and validate that it works
Update the version to <code>0.2.0</code> on the <code>pyproject.toml</code>
Run <code>uv sync --locked --no-install-project</code> and receive an error</p>
<h1>Context</h1>
<p>We are developing a python library where the ci/cd pipelines auto increment the versions using <code>commitizen</code>. We also use devcontainers to standardize the development experience, but rebuilding the containers using the recommended <code>uv sync --locked --no-install-project</code> step on the dockerfile will fail if we don't resync the lockfile with every change.</p>
<h3>Platform</h3>
<p>inux 6.6.87.2-microsoft-standard-WSL2 x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.8.14</p>
<h3>Python version</h3>
<p>Python 3.13.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @carlosjourdan on 2025-09-02 21:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-09-02 21:25</div>
            <div class="timeline-body"><p>Personally, I think it's correct to fail here, because the lockfile is no longer up-to-date, and the intent of <code>--locked</code> is to error if the lockfile doesn't match the project metadata. I'd probably suggest using <code>--frozen</code> here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carlosjourdan">@carlosjourdan</a> on 2025-09-03 00:07</div>
            <div class="timeline-body"><p>Using <code>--frozen</code> would allow building an environment that doesn't match the dependencies on the <code>pyproject.toml</code>. Is there any way to generate a lockfile for the dependencies of the project, not the project itself? I thought this was kind of the point of runing <code>uv sync --no-install-project</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-03 00:11</div>
            <div class="timeline-body"><p>Why not update the lockfile to reflect the proper project version first?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carlosjourdan">@carlosjourdan</a> on 2025-09-03 00:34</div>
            <div class="timeline-body"><p>As I mentioned, project version is incremented automatically using <code>commitizen</code>. This is post merging into a alpha/rc/main branch. Not sure it would make sense to update the lockfile at this point. I'd rather have any changes being made intentionally on PRs since they can impact the ci steps.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:05 UTC
    </footer>
</body>
</html>
