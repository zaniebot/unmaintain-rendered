<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv lock --upgrade` should add an additional marker for major version upgrades - astral-sh/uv #10842</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`uv lock --upgrade` should add an additional marker for major version upgrades</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/10842">#10842</a>
        opened by <a href="https://github.com/purajit">@purajit</a>
        on 2025-01-22 03:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/purajit">@purajit</a> on 2025-01-22 03:27</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>A symbol (like a <code>!</code>) at the end of the lines <code>Updated v... -&gt; v...</code> where a major version is bumped (and as a moonshot, for the minor version where they are similarly significant) would make changes much easier to review.</p>
<p>The more direct context is that we have a monorepo with several independent uv projects, and run <code>uv lock --upgrade</code> on a cron on all of them. We put the <code>Updated</code> logs into the PR description for the papertrail, but also to help the reviewer, and having a symbol to easily check these lines would make it much easier to narrow down the expected scope of impact. Currently we parse and use <code>python-packaging</code> to inject these.</p>
<p>Willing to PR if this seems reasonable, just using <code>PythonVersion::major</code>.</p>
<p>Couple add-ons:</p>
<ul>
<li>it would be good to differentiate <code>Update</code> based on whether the version increased or decreased, and use appropriate symbols</li>
<li>we don't need this, but this could be easily extended to other things people might want to know, like if they're being upgraded to a pre-release</li>
</ul>
<h3>Example</h3>
<p>This is what I'm currently doing with some manual parsing:</p>
<p>(+/- for added/removed, &gt; for upgraded, ≫ for major version upgraded; I have been trying to
think of something that stands out more than ≫ - <code>›</code> for a normal upgrade and <code>&gt;</code> for major
works, but just looks a bit weird - any of these are fine by me)</p>
<pre><code>+ pytz v2024.2
+ rapidfuzz v3.11.0
&gt; referencing v0.35.1 -&gt; v0.36.1
- requests-toolbelt v1.0.0
- sniffio v1.3.1
+ tini v4.0.0
+ types-pyyaml v6.0.12.20241230
≫ tzdata v2024.2 -&gt; v2025.1
- websockets v11.0.3
- yarl v1.18.3
</code></pre>
<p>Example for the alternative:</p>
<pre><code>› referencing v0.35.1 -&gt; v0.36.1
&gt; tzdata v2024.2 -&gt; v2025.1
</code></pre>
<p>with emojis (could also be ▶️/⏩):</p>
<pre><code>➕ pytz v2024.2
➕ rapidfuzz v3.11.0
⬆️ referencing v0.35.1 -&gt; v0.36.1
➖ sniffio v1.3.1
➕ tini v4.0.0
➕ types-pyyaml v6.0.12.20241230
⏫ tzdata v2024.2 -&gt; v2025.1
➖ websockets v11.0.3
➖ yarl v1.18.3
</code></pre>
<p>I mostly chose to do it this way to have a constant-sized column at the beginning since it's
visually easy to grok, but any kind of indication would be good enough. Particularly, I think
being able to clearly distinguish the lines even without color would be great, since you won't
be  able to preserve that while posting comments/PRs. I don't have strong opinions myself about
sticking to the ASCII chart, using emojis, etc.</p>
<p>One kinda neat thing about <code>+/-/!</code> is that those lines can be colored using GitHub's <code>diff</code>
syntax highlighter, but the problem there is typically we wouldn't care about tertiary
dependencies being added/removed, and those are the ones that would stand out the most,
and major upgrades <em>don't</em> stand out:</p>
<pre><code class="language-diff">+ types-pyyaml v6.0.12.20241230
! tzdata v2024.2 -&gt; v2025.1
- websockets v11.0.3
</code></pre>
<p>I understand these are all bigger changes; just showing what I've been doing. Any kind of visual
marker that helps things stand out is good enough.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @purajit on 2025-01-22 03:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @zanieb on 2025-01-22 03:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-22 03:39</div>
            <div class="timeline-body"><p>Seems reasonable, but I'm not quite sure how we'd want it to look. Can you share an example of the current output and your desired one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/purajit">@purajit</a> on 2025-01-22 04:30</div>
            <div class="timeline-body"><p>UPDATE: Added all context to the issue itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-29 16:25</div>
            <div class="timeline-body"><p>I'd somewhat prefer not to make this change, in part because there isn't really a guarantee or culture of SemVer in Python, so it isn't necessarily the case that a major bump is any difference than a patch bump (depending on the project).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/purajit">@purajit</a> on 2025-02-03 23:19</div>
            <div class="timeline-body"><p>Yeah, definitely; several packages do &quot;major&quot; changes with minor versions, etc, but it was more to visually set apart the most &quot;obvious&quot; changes, or at least &quot;potentially large&quot; changes. But it makes sense to not place rules or opinions around that ambiguity at a <code>uv</code> level.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
