<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executables installed via `uv` cannot be run from a subprocess on Windows - astral-sh/uv #1612</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Executables installed via <code>uv</code> cannot be run from a subprocess on Windows</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1612">#1612</a>
        opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a>
        on 2024-02-17 19:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-17 19:49</div>
            <div class="timeline-body"><p>Minimal repro in PowerShell:</p>
<pre><code class="language-ps">PS C:\Users\alexw&gt; uv venv env
Using Python 3.12.1 interpreter at C:\Users\alexw\AppData\Local\Programs\Python\Python312\python.exe
Creating virtualenv at: env
PS C:\Users\alexw&gt; env\scripts\activate
(env) PS C:\Users\alexw&gt; uv pip install black
Resolved 7 packages in 395ms
Downloaded 1 package in 218ms
Installed 7 packages in 106ms
 + black==24.2.0
 + click==8.1.7
 + colorama==0.4.6
 + mypy-extensions==1.0.0
 + packaging==23.2
 + pathspec==0.12.1
 + platformdirs==4.2.0
(env) PS C:\Users\alexw&gt; python -c &quot;import subprocess; subprocess.run(['black', 'coding/typeshed'])&quot;
C:\Users\alexw\AppData\Local\Programs\Python\Python312\python.exe: can't open file 'C:\\Users\\alexw\\black': [Errno 2] No such file or directory
</code></pre>
<p>The same commands work fine if I use the stdlib <code>venv</code> module to create the virtual environment and I use <code>pip</code> to install black. Invoking <code>black</code> directly from the command line seems to work fine; it's only invoking it <em>via a subprocess</em> that doesn't seem to work.</p>
<p>A consequence of this bug seems to be that it's impossible to run <code>coverage -m pytest</code> on Windows inside a GitHub Actions workflow if you've installed <code>coverage</code> using <code>uv</code>. Here's my attempt at switching <code>typeshed-stats</code> to use <code>uv</code>:</p>
<ul>
<li>https://github.com/AlexWaygood/typeshed-stats/pull/189</li>
</ul>
<p>CI is now green everywhere, except on Windows, where invoking <code>coverage -m pytest</code> fails with the message:</p>
<pre><code> Error: The system cannot find the file specified.
 (from CreateProcessA(null(), child_cmdline.as_mut_ptr(), null(), null(), 1, 0,
    null(), null(), addr_of!(*si), child_process_info.as_mut_ptr()))
</code></pre>
<p>(Running <code>python -m coverage</code> works, but one test in my suite still fails, because I have a test that asserts that running <code>typeshed-stats</code> as a standalone executable works, and I invoke the standalone executable using a subprocess for <em>that</em> test...)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @AlexWaygood on 2024-02-17 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @AlexWaygood on 2024-02-17 19:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-17 22:04</div>
            <div class="timeline-body"><p>I think that should be fixed by https://github.com/astral-sh/uv/pull/1523</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-17 23:24</div>
            <div class="timeline-body"><p>My local repro is now fixed -- thanks! However, I'm still seeing the strange errors over at https://github.com/AlexWaygood/typeshed-stats/pull/189 (which is now using <code>uv==0.1.4</code>). I thought those errors had the same cause as the local repro I posted above, but perhaps not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-18 10:58</div>
            <div class="timeline-body"><p>Since the original repro at the top of this issue is now fixed, I'll close this and open a new, more targeted issue</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AlexWaygood on 2024-02-18 10:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AlexWaygood">@AlexWaygood</a> on 2024-02-18 11:04</div>
            <div class="timeline-body"><p>This is the new issue:</p>
<ul>
<li>#1639</li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:28 UTC
    </footer>
</body>
</html>
