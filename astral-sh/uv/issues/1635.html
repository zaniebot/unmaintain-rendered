<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>support on manylinux builder image (older glibc)? - astral-sh/uv #1635</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>support on manylinux builder image (older glibc)?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1635">#1635</a>
        opened by <a href="https://github.com/davidszotten">@davidszotten</a>
        on 2024-02-18 09:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/davidszotten">@davidszotten</a></div>
            <div class="timeline-body"><p>atm the newest images from https://github.com/pypa/manylinux <code>manylinux_2_28 </code> use glibc 2.28</p>
<pre><code>)$ docker run --rm -ti quay.io/pypa/manylinux_2_28_aarch64:2024-02-16-b3cad8f
[root@378f4d94282b /]# curl -LsSf https://astral.sh/uv/install.sh | sh
System glibc version (`2.28&#x27;) is too old; using musl
ERROR: there isn&#x27;t a package for aarch64-unknown-linux-musl-static
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-19 00:12</div>
            <div class="timeline-body"><p>Could you provide some more information?</p>
<p>We explicitly build and test wheels on this image</p>
<p>https://github.com/astral-sh/uv/blob/e923dba4b4a01c70e2a207d5e74aef578cb20887/.github/workflows/build-binaries.yml#L277-L297</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-19 00:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/davidszotten">@davidszotten</a> on 2024-02-19 08:47</div>
            <div class="timeline-body"><p>ah, it looks like i can install with pip but not with your installer script</p>
<blockquote>
<p>Could you provide some more information?</p>
</blockquote>
<p>sure, what would be helpful?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-19 08:52</div>
            <div class="timeline-body"><p>I think this is the same issue as <a href="https://github.com/astral-sh/uv/issues/1392">astral-sh/uv#1392</a> except that it tries to pick the statically linked musl instead of the dynamic. We&#x27;re working with axo on a fix. I&#x27;ll close this issue in favor of <a href="https://github.com/astral-sh/uv/issues/1392">astral-sh/uv#1392</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-19 08:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/davidszotten">@davidszotten</a> on 2024-02-19 16:36</div>
            <div class="timeline-body"><p>how come the installer isn&#x27;t able to use whatever is built for the wheel on the same platform?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-20 12:04</div>
            <div class="timeline-body"><p>We use cargo-dist to generate the installer and the latest version had a bug where it failed to generate the necessary mappings for aarch64-musl.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/davidszotten">@davidszotten</a> on 2024-02-21 09:16</div>
            <div class="timeline-body"><p>maybe i&#x27;m misunderstanding something (my knowledge in this area is limited) so maybe this question makes no sense, but the version installed with pip looks like it is dynamically linked to glibc 2.28</p>
<pre><code>ldd /opt/python/cp312-cp312/bin/uv
	linux-vdso.so.1 (0x0000ffff83094000)
	libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x0000ffff8198b000)
	libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x0000ffff81956000)
	libm.so.6 =&gt; /lib64/libm.so.6 (0x0000ffff81895000)
	libdl.so.2 =&gt; /lib64/libdl.so.2 (0x0000ffff81874000)
	libc.so.6 =&gt; /lib64/libc.so.6 (0x0000ffff816fe000)
	/lib/ld-linux-aarch64.so.1 (0x0000ffff83056000)
</code></pre>
<p>So my question is: as opposed to (or in addition to) fixing the static musl fallback, could the installer be less strict about it&#x27;s glibc version requirement <code>System glibc version (&#x27;2.28&#x27;) is too old; using musl</code> ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-21 09:24</div>
            <div class="timeline-body"><p>I think this is cargo-dist being overly strict, the value looks <a href="https://github.com/axodotdev/cargo-dist/blob/6d50ff6ea148033028285db6e1002a3908f89d98/cargo-dist/templates/installer/installer.sh.j2#L545">hardcoded</a> (CC @gankra; For context, you need to use an image such as manylinux_2_28 with glibc 2.28 if you want to build python packages with that compatibility tag, i we unfortunatly should support ancient distros). The other problem is that we need an aarch64-unknown-linux-musl-static package.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:29:41 UTC
    </footer>
</body>
</html>
