<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flakey test failure in `dependency_excludes_range_of_compatible_versions` - astral-sh/uv #863</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Flakey test failure in <code>dependency_excludes_range_of_compatible_versions</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/863">#863</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-10 00:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>This test failed for me in https://github.com/astral-sh/puffin/actions/runs/7468310714/job/20323498659?pr=842:</p>
<pre><code>---- dependency_excludes_range_of_compatible_versions stdout ----
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: dependency_excludes_range_of_compatible_versions
Source: crates/puffin-cli/tests/pip_install_scenarios.rs:243
────────────────────────────────────────────────────────────────────────────────
program: puffin
args:
  - pip-install
  - dependency-excludes-range-of-compatible-versions-2023222f-a
  - &quot;dependency-excludes-range-of-compatible-versions-2023222f-b&gt;=2.0.0,&lt;3.0.0&quot;
  - dependency-excludes-range-of-compatible-versions-2023222f-c
  - &quot;--extra-index-url&quot;
  - &quot;https://test.pypi.org/simple&quot;
  - &quot;--cache-dir&quot;
  - /tmp/.tmpzx3x5G
env:
  PUFFIN_NO_WRAP: &quot;1&quot;
  VIRTUAL_ENV: /tmp/.tmpG2Gepe/.venv
────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────
    7     7 │ ␊
    8     8 │       Because there are no versions of c&lt;1.0.0 | &gt;1.0.0, &lt;2.0.0 | &gt;2.0.0 and c==1.0.0 depends on a&lt;2.0.0, c&lt;2.0.0 depends on a&lt;2.0.0.␊
    9     9 │       And because c==2.0.0 depends on a&gt;=3.0.0, c depends on a&lt;2.0.0 | &gt;=3.0.0.␊
   10    10 │       And because a&lt;2.0.0 depends on b==1.0.0 (1), a!=3.0.0, c*, b!=1.0.0 are incompatible.␊
   11       │-      And because a==3.0.0 depends on b==3.0.0, c depends on b&lt;=1.0.0 | &gt;=3.0.0.␊
   12       │-      And because root depends on c and root depends on b&gt;=2.0.0, &lt;3.0.0, version solving failed.
         11 │+      And because a==3.0.0 depends on b==3.0.0, c depends on b==1.0.0 | ==3.0.0.␊
         12 │+      And because root depends on c and root depends on b&gt;=2.0.0, &lt;3.0.0, version solving failed.␊
────────────┴───────────────────────────────────────────────────────────────────
Stopped on the first failure. Run `cargo insta test` to run all snapshots.
thread &#x27;dependency_excludes_range_of_compatible_versions&#x27; panicked at /home/runner/.cargo/registry/src/index.crates.io-6f17d22bba15001f/insta-1.34.0/src/runtime.rs:563:9:
snapshot assertion for &#x27;dependency_excludes_range_of_compatible_versions&#x27; failed in line 243
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre>
<p>I then pushed no-op commit, and it succeeded: https://github.com/astral-sh/puffin/actions/runs/7468378577/job/20323700268.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-10 00:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-01-10 00:14</div>
            <div class="timeline-body"><p>Ah interesting the diff is at <code>c depends on b&lt;=1.0.0 | &gt;=3.0.0</code> and <code>c depends on b==1.0.0 | ==3.0.0</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/BurntSushi">@BurntSushi</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-01-22 16:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-28 14:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:29:06 UTC
    </footer>
</body>
</html>
