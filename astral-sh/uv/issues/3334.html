<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature request: single hash pinning for containerized python environments - astral-sh/uv #3334</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Feature request: single hash pinning for containerized python environments</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/3334">#3334</a>
        opened by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a>
        on 2024-05-01 23:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2024-05-01 23:33</div>
            <div class="timeline-body"><p>For containerized python builds only a single hash is in fact correct and accurate, not to mention is more secure with a much cleaner diff. Presently in uv all hashes are put into the resultant output of <code>uv pip compile --generate-hashes</code> -- is there a way to get a single hash for this environment? With pip this can be achieved with <code>pip compile --dry-run ...</code> or a combination of <code>pip download</code> and <code>pip hash</code> -- an option to be able to do so in <code>uv pip compile</code> would be extremely valuable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vlad-ivanov-name">@vlad-ivanov-name</a> on 2024-05-02 12:45</div>
            <div class="timeline-body"><p>Wouldn't piping the output of <code>uv pip compile</code> into e. g. <code>sha256</code> achieve this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-02 12:53</div>
            <div class="timeline-body"><p>It does sound like you're just looking for a sha of a lockfile e.g. <code>sha256 requirements.txt</code>. Is there more that you need?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-05-02 12:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2024-05-02 13:35</div>
            <div class="timeline-body"><p>@vlad-ivanov-name @zanieb not looking for a SHA of the requirements.txt (aka lock file) -- looking for items in the lockfile to have a single SHA pin -- for just the containerized python environment installation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-02 13:38</div>
            <div class="timeline-body"><p>What does that mean to you / how is it different?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2024-05-02 13:46</div>
            <div class="timeline-body"><p>Today what a hash pinned requirements.txt looks like:</p>
<p>Consider something like this for every single dependency in file.</p>
<p>...
uv==0.1.39 <br />
--hash=sha256:2333dd52e6734e0da6722bdd7b7257d0f8beeac89623c5cfc3888b4c56bc812e <br />
--hash=sha256:2ae930189742536f8178617c4ec05cb10271cb3886f6039abd36ee6ab511b160 <br />
--hash=sha256:2bda6686a9bb1370d7f53436d34f8ede0fa1b9877b5e152aedd9b22fc3cb33a9 <br />
--hash=sha256:3330bd7ab8a6160d815fdc36f48479edf6db8b58d39d20959555095ea7eb63c5 <br />
--hash=sha256:3365e0631a738a482d2379e565a230b135f7c5665394313829ccabf7c76c1362 <br />
--hash=sha256:388018659e5d73fdeb8ce13c1d812391ec981bf446ab86fb9c0e3d227f727da2 <br />
--hash=sha256:4c6ee1148f23aa5d6edf1a1106cc33c4aa57bdbfe8d4c5068c672105415d3b99 <br />
--hash=sha256:6b2acc907f7a1735dd9ffeb20d8c7aeeb86b1e5ba0a999e09433ad7f2789dc78 <br />
--hash=sha256:7848d703201e6867ae2c70d611e6ffd53d5e5adfc2c9abe89b6d021975e43e81 <br />
--hash=sha256:7ee426e0c5fa048cc44f3ac78e476121ef4365bb8bc9199d3cbffc372a80e55d <br />
--hash=sha256:88f5601ee957f9be2efc7a24d186f9d2641053806e107e0e42c5e522882c89e0 <br />
--hash=sha256:93217578e68a431df235173e390ad7df090499367cd7f5c811520fd4ea3d5047 <br />
--hash=sha256:c131dba5fe5079d9c5f06846649e35662901a9afd9b31de17714c63e042d91d2 <br />
--hash=sha256:c20b9023dac12ee518de79c91df313be7abb052440cb78f8ffb20dea81d3289e <br />
--hash=sha256:cd6d9629ab0e22ab2336b8d6363573ea5a7060ef82ff5d3e6da4b1b30522ef13 <br />
--hash=sha256:ce911087f56edc97a5792c17f682ed7611fedead0ea117f56bb6f3942eb3e7b3 <br />
--hash=sha256:fba96b3049aea5c1394cd360e5900e4af39829df48ed6fc55eba115c00c8195a
...</p>
<p>Single hash for just the target container example requirements.txt:</p>
<p>...</p>
<p>uv==0.1.39 <br />
--hash=sha256:6b2acc907f7a1735dd9ffeb20d8c7aeeb86b1e5ba0a999e09433ad7f2789dc78</p>
<p>...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-02 13:51</div>
            <div class="timeline-body"><p>I see. Thanks for clarifying!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @konstin on 2024-05-02 13:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2024-05-02 13:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2024-05-06 18:28</div>
            <div class="timeline-body"><p>@zanieb with pip to get the hash pin for just the specific environment, one can use <code>pip install --dry-run --report -r requirements.txt</code> or a mix of <code>pip download</code> and <code>pip hash</code> for each requirement -- does uv provide a way to get the pip compliant sha hash of a python module dependency that is resolved for the specific environment? Greatly appreciate any insights.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3516.html">astral-sh/uv#3516</a> on 2024-05-10 21:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2024-05-12 17:19</div>
            <div class="timeline-body"><p>This was an approach pip-tools was working on for this if it provides any insights: https://github.com/jazzband/pip-tools/pull/1406</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-06-20 16:04</div>
            <div class="timeline-body"><p>Has there been any recent thoughts on this or https://github.com/astral-sh/uv/issues/3516?</p>
<p>I would like to add hashes to my out file, but it's important to me that I can review diffs when I update it and go through each dependency and transative dependency that has been updated and at least do a cursory check of their changelogs. At the moment adding hashes adds too much noise, even though it should only be 1 of those hashes they we are using for each dependency we have.</p>
<p>Or perhaps the intention is to move such use cases to the <code>uv.lock</code> file? Which I would need to experiment with to see if it fits my works existing workflow or not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-02-10 17:54</div>
            <div class="timeline-body"><p>When dependencies, either direct or transitive, are installed, there is a single SHA version of the package that is selected. Is there a way in uv to get what SHA's would be resolved and installed for the specific environment?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EpicWink">@EpicWink</a> on 2025-07-31 13:27</div>
            <div class="timeline-body"><p>I've created a script which converts <code>pip install --report</code> to a pip requirements file <code>requirements.txt</code>: <a href="https://gist.github.com/EpicWink/a6239a5a5ed8052f1f72f22f745a0a6d"><code>pip-install-report-to-requirements.py</code></a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-31 20:36</div>
            <div class="timeline-body"><p>@gary-wall-hpe please don't be snarky, it's reasonable for someone to share their workaround in case it's useful to the community.</p>
<p>I think I'm conceptually fine with this, though I'm not sure if there are any lurking implications. It sounds like Charlie was aligned with the idea in https://github.com/astral-sh/uv/issues/3516. I think the behavior needs to be opt-in for compatibility, but that's my only qualm.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @gary-wall-hpe on 2025-08-01 03:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EpicWink">@EpicWink</a> on 2025-08-01 03:17</div>
            <div class="timeline-body"><blockquote>
<p>their workaround</p>
</blockquote>
<p>Not so much of a workaround (although I am using it instead of pip-tools' <code>compile</code>), as it is a suggestion towards the implementation of the solution (albeit with a recomputation of the reverse dependencies in the script, which can be skipped if integrated).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:19 UTC
    </footer>
</body>
</html>
