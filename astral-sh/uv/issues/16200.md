```yaml
number: 16200
title: "uv sync on a docker container requires `--frozen` instead of `--locked`"
type: issue
state: closed
author: gabriel-vanzandycke
labels: []
assignees: []
created_at: 2025-10-09T08:50:43Z
updated_at: 2025-11-01T19:58:56Z
url: https://github.com/astral-sh/uv/issues/16200
synced_at: 2026-01-10T01:57:35Z
```

# uv sync on a docker container requires `--frozen` instead of `--locked`

---

_Issue opened by @gabriel-vanzandycke on 2025-10-09 08:50_

Following the doc on how to use `uv` with `docker`, I have the following `Dockerfile`
```
FROM nvidia/cuda:12.6.1-base-ubuntu24.04
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/
WORKDIR /app
ENV UV_LINK_MODE=copy
RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --locked --no-install-project --no-install-workspace
```

However, building it fails with the following error:
```
1.145 Creating virtual environment at: .venv
1.148   × Failed to build `app @ file:///app`
1.148   ├─▶ Failed to parse entry: `my-dep`
1.148   ╰─▶ `my-dep` references a workspace in `tool.uv.sources` (e.g., `my-dep = {
1.148       workspace = true }`), but is not a workspace member
------
Dockerfile:5
```

The issue occurs with this dummy tree
```
├── Dockerfile
├── pyproject.toml
├── src
│   └── package
│       └── __init__.py
├── uv.lock
└── workspace
    └── my_dep
        ├── pyproject.toml
        └── src
            └── my_dep
                └── __init__.py
```

and the main `pyproject.toml` is
```
[project]
name = "app"
version = "0.1.0"
requires-python = "==3.11.*"
dependencies = ["my-dep"]

[tool.uv.workspace]
members = ["workspace/*"]

[tool.uv.sources]
my-dep = { workspace = true }
```

When using `uv sync --frozen` instead, I don't have the issue.
If the documentation is not wrong, can someone explain why it fails and how I should use a workspace in a docker container ?

---

_Comment by @charliermarsh on 2025-11-01 19:58_

That's occurring because `--locked` has to resolve the dependencies (to verify that the lockfile is up-to-date), but you didn't copy over any of the project sources. For example, `workspace/my_dep/pyproject.toml` isn't in the Dockerfile, so we can't know its dependencies. If you copy over all the project sources (at least the `pyproject.toml` files), you can use `--locked`, but then you have inferior caching.

---

_Closed by @charliermarsh on 2025-11-01 19:58_

---

_Assigned to @charliermarsh by @charliermarsh on 2025-11-01 19:58_

---
