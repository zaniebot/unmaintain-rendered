<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip install --system` not installing into python environment - astral-sh/uv #12398</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv pip install --system` not installing into python environment</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/12398">#12398</a>
        opened by <a href="https://github.com/droidnoob">@droidnoob</a>
        on 2025-03-22 21:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/droidnoob">@droidnoob</a> on 2025-03-22 21:27</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><code>uv pip install --system</code> does not seem to install the packages into the python environment. I'm using the latest release (<code>uv 0.6.9</code>).</p>
<p>I using a multi stage Dockerfile in the final image I am installing <code>uvicorn</code></p>
<pre><code class="language-Dockerfile"># final stage
FROM python:3.12-slim-bookworm

# Copy UV binaries to the final image
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

# Create app user
RUN groupadd -r app || true &amp;&amp; useradd -r -g app app || true

# Copy the Python packages from the builder stage
COPY --from=builder /usr/local/lib/python3.12/site-packages /usr/local/lib/python3.12/site-packages

# Copy the application code
COPY . /app

WORKDIR /app

# Install uvicorn and gunicorn system-wide
RUN uv pip install --system uvicorn gunicorn

CMD [&quot;uvicorn&quot;, &quot;src.main:app&quot;, &quot;--host&quot;, &quot;0.0.0.0&quot;, &quot;--port&quot;, &quot;8000&quot;]
</code></pre>
<p>Both build and final stages uses <code>ghcr.io/astral-sh/uv:latest</code>. While building and running the dockerfile I am getting the following error</p>
<pre><code>bash: line 1: uvicorn: command not found
</code></pre>
<p>I changed the <code>latest</code> to <code>0.6.9</code> had the same issue.
This was resolved when I changed to <code>0.6.8</code></p>
<h3>Platform</h3>
<p>Linux 6.8.0-38-generic x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.6.9</p>
<h3>Python version</h3>
<p>Python 3.12.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @droidnoob on 2025-03-22 21:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-22 23:21</div>
            <div class="timeline-body"><p>Can you share logs for <code>uv pip install --system uvicorn gunicorn -v</code> in the image?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/droidnoob">@droidnoob</a> on 2025-03-23 04:45</div>
            <div class="timeline-body"><pre><code>DEBUG uv 0.6.9
DEBUG Searching for default Python interpreter in search path
DEBUG Found `cpython-3.12.9-linux-x86_64-gnu` at `/usr/local/bin/python` (first executable in the search path)
Using Python 3.12.9 environment at: /usr/local
DEBUG Acquired lock for `/usr/local`
DEBUG Requirement satisfied: click&gt;=7.0
DEBUG Requirement satisfied: gunicorn
DEBUG Requirement satisfied: h11&gt;=0.8
DEBUG Requirement satisfied: packaging
DEBUG Requirement satisfied: uvicorn
Audited 2 packages in 27ms
DEBUG Released lock at `/tmp/uv-1b696e695b7c17a7.lock`

</code></pre>
<p>I'm getting similar results in <code>latest</code> and <code>0.6.8</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/droidnoob">@droidnoob</a> on 2025-03-23 05:02</div>
            <div class="timeline-body"><p>In <code>0.6.8</code></p>
<pre><code class="language-sh">$ which uvicorn

 /usr/local/bin/uvicorn

$ python -m pip show uvicorn
Name: uvicorn
Version: 0.34.0
Summary: The lightning-fast ASGI server.
Home-page: https://www.uvicorn.org/
Author: 
Author-email: Tom Christie &lt;tom@tomchristie.com&gt;, Marcelo Trylesinski &lt;marcelotryle@gmail.com&gt;
License: BSD-3-Clause
Location: /usr/local/lib/python3.12/site-packages
Requires: click, h11
Required-by: 
</code></pre>
<p>In <code>0.6.9</code></p>
<pre><code class="language-sh">$ which uvicorn

$ python -m pip show uvicorn
Name: uvicorn
Version: 0.34.0
Summary: The lightning-fast ASGI server.
Home-page: https://www.uvicorn.org/
Author: 
Author-email: Tom Christie &lt;tom@tomchristie.com&gt;, Marcelo Trylesinski &lt;marcelotryle@gmail.com&gt;
License: BSD-3-Clause
Location: /usr/local/lib/python3.12/site-packages
Requires: click, h11
Required-by: 
</code></pre>
<p>uvicorn binary is not being installed in  <code>/usr/local/bin</code>. So the issue is not it's not being installed in python environment, but not getting installed as binary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/droidnoob">@droidnoob</a> on 2025-03-25 13:24</div>
            <div class="timeline-body"><p>@zanieb Is this a bug with uv?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-25 14:26</div>
            <div class="timeline-body"><p>It looks like you're copying the site packages but not <code>/usr/local/bin</code> so we see the package as installed already and don't reinstall? I would recommend you copy over the package executable too? I don't think this is a bug with uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-03-25 14:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-03-25 14:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-07-11 02:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
