<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv init test fails if a directory ~&lt;user&gt;/.venv with no pyvenv.cfg is found - astral-sh/uv #8092</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv init test fails if a directory ~<user>/.venv with no pyvenv.cfg is found</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/8092">#8092</a>
        opened by <a href="https://github.com/pelamlio">@pelamlio</a>
        on 2024-10-10 13:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/pelamlio">@pelamlio</a> on 2024-10-10 13:56</div>
            <div class="timeline-body"><p>uv version 0.4.20
Linux Ubuntu 24.04.1 LTS</p>
<p>When transitioning (previously using venv, not virtualenv), uv does not find any pyvenv.cfg file directly under the .venv directory and generates an error:</p>
<p>uv init test
error: Broken virtualenv <code>/home/&lt;user&gt;/.venv</code>: <code>pyvenv.cfg</code> is missing</p>
<p>Should the directory be removed or an empty pyvenv.cfg be created at the root of ~/.venv, the command completes as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 14:01</div>
            <div class="timeline-body"><p>What do you find to be wrong here? In other words, what behavior would you expect to see?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-10-10 14:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pelamlio">@pelamlio</a> on 2024-10-10 15:52</div>
            <div class="timeline-body"><p>Not sure whether I can provide a clean answer.</p>
<p>In part, my issue was related to migrating to uv from an pre-existing development environment, and having a very limited knowledge of uv.
Should other users take the same path, they might trigger the same behavior (subdirectories per env in the .venv directory).</p>
<p>Per the documentation (https://docs.astral.sh/uv/guides/projects/), it was not immediately clear that uv init would need  an venv to be defined ab initio. More so, when the .venv could be created in the said project later (same url; Project structure).</p>
<p>My 2 cents.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jramcast">@jramcast</a> on 2024-10-14 11:33</div>
            <div class="timeline-body"><p>Same problem here. I personally use the <code>$HOME/.venv</code> directory to store regular venvs for other projects.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2024-10-14 17:30</div>
            <div class="timeline-body"><p>I was thinking, here are some steps to reproduce:</p>
<pre><code>mkdir myroot
cd myroot
uv venv .venv/a
uv venv .venv/b
uv init testproject
</code></pre>
<p>The error from <code>uv init</code> is:</p>
<pre><code>error: Broken virtualenv `/home/user/myroot/.venv`: `pyvenv.cfg` is missing
</code></pre>
<p>This could be a bug because: there shouldn't be a problem with <code>.venv</code> and testproject coexisting, and I don't think there is a problem if they are created in opposite order?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-11-13 03:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-11-13 03:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:45 UTC
    </footer>
</body>
</html>
