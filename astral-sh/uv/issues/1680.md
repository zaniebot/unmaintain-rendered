```yaml
number: 1680
title: "Recursive extras not supported when installing a local package with `package-name[extra] @ .`"
type: issue
state: closed
author: edgarrmondragon
labels:
  - bug
  - great writeup
assignees: []
created_at: 2024-02-19T05:08:59Z
updated_at: 2024-02-20T02:56:22Z
url: https://github.com/astral-sh/uv/issues/1680
synced_at: 2026-01-10T01:57:03Z
```

# Recursive extras not supported when installing a local package with `package-name[extra] @ .`

---

_Issue opened by @edgarrmondragon on 2024-02-19 05:08_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

```console
$ uv --version                                                        
uv 0.1.5
```

Consider:

```toml
[project]
name = "uv-recursive-extras-repro"
version = "0.1.0"
dependencies = [
    "requests>=2.28",
]
optional-dependencies.tests = [
    "pytest",
]
optional-dependencies.typing = [
    "uv-recursive-extras-repro[tests]",
    "mypy",
]
```

Installing the `[tests]` extra works as expected:

```console
$ uv pip install 'uv-recursive-extras-repro[tests] @ .' --no-cache
Resolved 10 packages in 2.66s
   Built uv-recursive-extras-repro @ file:///Users/edgarramirez/repro/uv-recursive              Downloaded 10 packages in 545ms
Installed 10 packages in 16ms
 + certifi==2024.2.2
 + charset-normalizer==3.3.2
 + idna==3.6
 + iniconfig==2.0.0
 + packaging==23.2
 + pluggy==1.4.0
 + pytest==8.0.1
 + requests==2.31.0
 + urllib3==2.2.1
 + uv-recursive-extras-repro==0.1.0 (from file:///Users/edgarramirez/repro/uv-recursive)
```

But trying to install `[typing]` fails:

```console
$ uv pip install 'uv-recursive-extras-repro[typing] @ .'               
  √ó No solution found when resolving dependencies:
  ‚ï∞‚îÄ‚ñ∂ Because uv-recursive-extras-repro[tests] was not found in the
      package registry and uv-recursive-extras-repro[typing]==0.1.0
      depends on uv-recursive-extras-repro[tests], we can conclude that
      uv-recursive-extras-repro[typing]==0.1.0 cannot be used.
      And because uv-recursive-extras-repro[typing]<0.1.0 |
      >0.1.0 was not found in the package registry and you require
      uv-recursive-extras-repro[typing], we can conclude that the
      requirements are unsatisfiable.
```

Related:

* https://github.com/astral-sh/uv/issues/313
* https://github.com/astral-sh/uv/issues/1447


---

_Label `bug` added by @zanieb on 2024-02-19 06:34_

---

_Label `great writeup` added by @zanieb on 2024-02-19 06:34_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-02-19 14:44_

---

_Comment by @charliermarsh on 2024-02-19 14:45_

I can take this one since it's related to some other issues I fixed. Does it work ok with `-e`?

---

_Comment by @edgarrmondragon on 2024-02-19 19:25_

> I can take this one since it's related to some other issues I fixed. Does it work ok with `-e`?

Not AFAICT:

```console
$ uv pip install -e 'uv-recursive-extras-repro[typing] @ .'                                                                                                                                                    
error: Failed to build editables
  Caused by: Failed to build editable: file:///Users/edgarramirez/repro/uv-recursive/uv-recursive-extras-repro[typing]%20@%20.
  Caused by: Source distribution not found at: /Users/edgarramirez/repro/uv-recursive/uv-recursive-extras-repro[typing] @ .


---

_Comment by @charliermarsh on 2024-02-19 19:54_

You'd need to do `uv pip install -e '.[typing]'`

---

_Comment by @edgarrmondragon on 2024-02-19 21:03_

> You'd need to do `uv pip install -e '.[typing]'`

Oh yeah, that totally works üëç

---

_Referenced in [astral-sh/uv#1729](../../astral-sh/uv/pulls/1729.md) on 2024-02-20 02:43_

---

_Closed by @charliermarsh on 2024-02-20 02:56_

---
