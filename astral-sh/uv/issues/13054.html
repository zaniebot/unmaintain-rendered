<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problems with git installs when run via CI - astral-sh/uv #13054</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Problems with git installs when run via CI</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/13054">#13054</a>
        opened by <a href="https://github.com/drcongo">@drcongo</a>
        on 2025-04-22 13:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/drcongo">@drcongo</a> on 2025-04-22 13:18</div>
            <div class="timeline-body"><h3>Question</h3>
<p>Hello. Sorry this is such a vague question, it would definitely have been better placed in <code>discussions</code> rather than <code>issues</code> but we don't seem to have discussions on this repo. Anyway, I have a project with a git post-receive hook on a remote server run via CI, which runs <code>uv sync --no-dev</code> and everything is fine until my <code>uv.lock</code> contains a git install, which then errors out the whole install process with this...</p>
<pre><code>remote: Resolved 120 packages in 5ms        
remote:    Updating https://github.com/someorg/somedep.git (ee67c93fa95ffb7379be1ad4730d6c7504baf581)        
remote:   × Failed to download and build `somedep @        
remote:   │ git+https://github.com/someorg/somedep.git@ee67c93fa95ffb7379be1ad4730d6c7504baf581`
remote:   ├─▶ Git operation failed        
remote:   ╰─▶ process didn't exit successfully: `/usr/bin/git rev-parse` (exit status:        
remote:       128)        
remote:       --- stderr        
remote:       fatal: not a git repository: '.'        
remote: 
remote:   help: `somedep` was included because `myproject` (v0.1.0) depends on        
remote:         `somedep`    
</code></pre>
<p>The weirdest thing about this though is that if I ssh into the server, and then run <code>sh /path/to/my/post-receive</code> as the same user that CI runs as, everything works fine.</p>
<h3>Platform</h3>
<p>Ubuntu 24.04</p>
<h3>Version</h3>
<p>Any (but on 0.6.9 in this case)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @drcongo on 2025-04-22 13:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-22 16:08</div>
            <div class="timeline-body"><p>Does clearing the cache with <code>uv cache clean</code> help?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/emdneto">@emdneto</a> on 2025-07-24 22:49</div>
            <div class="timeline-body"><p>Facing a similar issue in opentelemetry-python https://github.com/open-telemetry/opentelemetry-python/actions/runs/16509062023/job/46686986557?pr=4692</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-24 22:54</div>
            <div class="timeline-body"><p>@emdneto that looks pretty different?</p>
<pre><code>├─▶ failed to find branch, tag, or commit
  │   `0f166e3136033f3230a692f82381fb66f39d417f`
  ╰─▶ process didn't exit successfully: `/usr/bin/git rev-parse
      '0f166e3136033f3[23](https://github.com/open-telemetry/opentelemetry-python/actions/runs/16509062023/job/46686986557?pr=4692#step:5:24)0a692f82381fb66f39d417f^0'` (exit status: 128)
      --- stdout
      0f166e3136033f3230a692f82381fb66f39d417f^0

      --- stderr
      fatal: ambiguous argument '0f166e3136033f3230a692f82381fb66f39d417f^0':
      unknown revision or path not in the working tree.
      Use '--' to separate paths from revisions, like this:
      'git &lt;command&gt; [&lt;revision&gt;...] -- [&lt;file&gt;...]'
</code></pre>
<p>I think you should open a new issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/emdneto">@emdneto</a> on 2025-07-25 12:54</div>
            <div class="timeline-body"><p>@zanieb opened https://github.com/astral-sh/uv/issues/14894</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-25 13:03</div>
            <div class="timeline-body"><p>(We never got a reply here so I'm going to close this out)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-07-25 13:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/16102.html">astral-sh/uv#16102</a> on 2025-10-02 11:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
