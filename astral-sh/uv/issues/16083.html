<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.netrc parsing fails when there are commented lines - astral-sh/uv #16083</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>.netrc parsing fails when there are commented lines</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16083">#16083</a>
        opened by <a href="https://github.com/iluetkeb">@iluetkeb</a>
        on 2025-10-01 10:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/iluetkeb">@iluetkeb</a> on 2025-10-01 10:58</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>.netrc parsing fails with <code>WARN uv_auth::middleware Error reading netrc file: parsing error: bad follower token '&lt;machine name&gt;' (line 14) in the file '/home/&lt;myuser&gt;/.netrc'</code> on lines commented with '#'. This is with verbose logging enabled, otherwise no error shows.</p>
<p>Strictly speaking, <code>.netrc</code> do not have a comment syntaxbut most other tools just silently ignore lines like that, while uv stops parsing the .netrc file after such a line occurs.</p>
<p>It would be helpful if uv either reported such things more prominently, or continued parsing after such errors.</p>
<h3>Platform</h3>
<p>Ubuntu 22.04</p>
<h3>Version</h3>
<p>0.5.24</p>
<h3>Python version</h3>
<p>3.13.1</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @iluetkeb on 2025-10-01 10:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-10-01 15:58</div>
            <div class="timeline-body"><p>We actually don't parse this ourselves -- we use the <a href="https://docs.rs/rust-netrc/latest/netrc/">rust-netrc</a> crate. This may be better reported there?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">external</span> added by @charliermarsh on 2025-10-01 15:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/terror">@terror</a> on 2025-10-01 16:55</div>
            <div class="timeline-body"><p>Would you be able to provide a sample <code>netrc</code> file that fails to parse? This might help in investigating the issue upstream.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/iluetkeb">@iluetkeb</a> on 2025-10-01 17:58</div>
            <div class="timeline-body"><p>Sure, here is one with a regular entry, a commented entry and then a regular entry again. The actual content doesn't matter, it fails immediately when encountering the comment. Most likely, it sees three elements in a line where only two are expected.</p>
<pre><code>machine localhost
login user
password abc12345

# machine 127.0.0.1
# login none
# password PAT

machine remote
login root
password fine
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../gribouille/netrc/issues/12.html">gribouille/netrc#12</a> on 2025-10-01 18:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/terror">@terror</a> on 2025-10-01 19:09</div>
            <div class="timeline-body"><blockquote>
<p>Sure, here is one with a regular entry, a commented entry and then a regular entry again. The actual content doesn't matter, it fails immediately when encountering the comment. Most likely, it sees three elements in a line where only two are expected.</p>
<pre><code>machine localhost
login user
password abc12345

# machine 127.0.0.1
# login none
# password PAT

machine remote
login root
password fine
</code></pre>
</blockquote>
<p>I've <a href="https://github.com/gribouille/netrc/pull/13">put up a PR</a> in the upstream crate that should resolve this issue. Hoping for a speedy review/release so this can get fixed for <code>uv</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/iluetkeb">@iluetkeb</a> on 2025-10-02 08:04</div>
            <div class="timeline-body"><p>@terror Awesome, thank you!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:13 UTC
    </footer>
</body>
</html>
