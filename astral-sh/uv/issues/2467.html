<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>error: Cannot uninstall package; RECORD file not found  - astral-sh/uv #2467</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>error: Cannot uninstall package; RECORD file not found </h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2467">#2467</a>
        opened by <a href="https://github.com/ksamuel">@ksamuel</a>
        on 2024-03-14 21:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ksamuel">@ksamuel</a> on 2024-03-14 21:44</div>
            <div class="timeline-body"><p>Trying to install a package with uv stops because the RECORD file for a dependency package it needs to uninstall does not exist. This means if a command goes wrong, the venv is corrupted for good an can't be fixed without manual intervention.</p>
<p>E.G:</p>
<pre><code>uv pip install wagtail-localize 
Resolved 36 packages in 6ms
error: Cannot uninstall package; RECORD file not found at: /.../.venv/lib/python3.11/site-packages/wagtail-6.0.1.dist-info/RECORD
</code></pre>
<p>And indeed /.../.venv/lib/python3.11/site-packages/wagtail-6.0.1.dist-info/ is empty, because some previous uninstallation failed and left the env in a dirty state.</p>
<p>Interestingly, I use only uv on this project, which means it is also responsible for the empty dir. This is another problem to solve but I cannot reproduce it reliably.</p>
<p>Ubuntu 20.04, Python 3.11.8, uv 0.1.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-14 22:01</div>
            <div class="timeline-body"><p>Hmm, yeah. This is the correct behavior though as described in the spec:</p>
<blockquote>
<p>If the RECORD file is missing, tools that rely on .dist-info must not attempt to uninstall or upgrade the package. (This restriction does not apply to tools that rely on other sources of information, such as system package managers in Linux distros.)</p>
</blockquote>
<p>I don't know that it's wrong to require some manual intervention in this case -- the environment <em>is</em> broken. (In general, I think virtualenvs should be viewed as completely disposable. Re-creating the virtualenv is effectively free with uv.)</p>
<p>I think the alternative would be that we just ignore the package entirely and overwrite the contents when we go to install, but that also risks leaving your environment in a broken state. We could just proceed-but-warn, I suppose?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-03-15 02:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-15 03:18</div>
            <div class="timeline-body"><p>I can change this to a warning.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-03-15 03:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2557.html">astral-sh/uv#2557</a> on 2024-03-20 00:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-20 01:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8690.html">astral-sh/uv#8690</a> on 2024-10-29 23:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:25 UTC
    </footer>
</body>
</html>
