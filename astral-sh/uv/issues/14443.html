<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow setting frozen=true or locked=true for `uv run` in pyproject.toml - astral-sh/uv #14443</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow setting frozen=true or locked=true for `uv run` in pyproject.toml</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/14443">#14443</a>
        opened by <a href="https://github.com/benjsec">@benjsec</a>
        on 2025-07-03 16:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/benjsec">@benjsec</a> on 2025-07-03 16:29</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>After switching to UV we were a little surprised with the default behaviour of uv updating the lockfile implicitly when running any command. It goes against some of our workflows, where we aim to keep dependency updates (including transient dependencies) separate from code changes where possible.
We've been able to use the environment variable UV_FROZEN to disable this behaviour in CI, but we can't find a good way of enforcing it on developers machines.</p>
<p>Could you add a way to set uv_frozen=true in the pyproject.toml so we can avoid inadvertently upgrading dependencies, please?</p>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @benjsec on 2025-07-03 16:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-03 16:51</div>
            <div class="timeline-body"><blockquote>
<p>default behaviour of uv updating the lockfile implicitly when running any command</p>
</blockquote>
<p>Can you share some more details about when dependencies are changing? The lockfile should not change unless someone has changed the dependencies, asked for an explicit upgrade, or otherwise invalidated the lockfile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benjsec">@benjsec</a> on 2025-07-08 08:50</div>
            <div class="timeline-body"><p>The documentation at https://docs.astral.sh/uv/concepts/projects/sync/#automatic-lock-and-sync says</p>
<blockquote>
<p>Locking and syncing are automatic in uv. For example, when uv run is used, the project is locked and synced before invoking the requested command.</p>
</blockquote>
<p>I have confirmed this with</p>
<pre><code>➜  uv lock --check
Resolved 157 packages in 2.36s
error: The lockfile at `uv.lock` needs to be updated, but `--locked` was provided. To update the lockfile, run `uv lock`.
➜  uv run ruff
      Built api @ file:///Users/ben/Documents/Projects/api
Uninstalled 29 packages in 298ms
Installed 28 packages in 51ms
➜  uv lock --check
Resolved 157 packages in 9ms
</code></pre>
<p>Running <code>uv run ruff</code> has updated the lockfile automatically</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Allow setting frozen=true or locked=true in pyproject.toml" to "Allow setting frozen=true or locked=true for `uv run` in pyproject.toml" by @konstin on 2025-08-01 08:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rbebb">@rbebb</a> on 2025-10-06 18:54</div>
            <div class="timeline-body"><p>It would be great to have this functionality.</p>
<p>When working on projects with a team, we want to ensure consistency across each dev's environment. Having the lock file update every time someone runs <code>uv run</code> can lead to confusion if an issue arises since it's not immediately clear if a dependency update caused it or a code change caused it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/helpmefindaname">@helpmefindaname</a> on 2025-10-08 10:36</div>
            <div class="timeline-body"><p>Same here,
I personally disagree with the default values, so being able to change them for <code>--frozen</code> and similar (like <code>--no-sync</code>, <code>--locked</code>) in the pyproject.toml or uv.toml on a project level would be very helpful</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:04 UTC
    </footer>
</body>
</html>
