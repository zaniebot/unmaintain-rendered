<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dependent local package becomes editable - astral-sh/uv #15297</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Dependent local package becomes editable</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/15297">#15297</a>
        opened by <a href="https://github.com/tonnico">@tonnico</a>
        on 2025-08-15 04:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/tonnico">@tonnico</a> on 2025-08-15 04:39</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I try to follow the <a href="https://docs.astral.sh/uv/guides/integration/aws-lambda/#deploying-a-zip-archive">AWS CDK example</a>.</p>
<p>I have the following structure:</p>
<pre><code class="language-bash">uv init --bare foo
cd foo
uv init --lib a
uv init --lib b
uv init --lib shared
(cd a &amp;&amp; uv add shared)
(cd b &amp;&amp; uv add shared)
</code></pre>
<p>now I want to export my dependencies for package <code>a</code>.</p>
<pre><code class="language-bash">foo uv export --frozen --no-dev --no-editable --package a -o requirements.txt
</code></pre>
<details>
<summary>requirements.txt</summary>

<pre><code class="language-txt"># This file was autogenerated by uv via the following command:
#    uv export --frozen --no-dev --no-editable --package a -o requirements.txt
./a
./shared
    # via a
</code></pre>
</details>

<p>Finally I install the dependencies in a target directory, but the <code>shared</code> dependency becomes editable.</p>
<pre><code class="language-bash">uv pip install \
   --no-installer-metadata \
   --no-compile-bytecode \
   --python-platform x86_64-manylinux2014 \
   --python 3.13 \
   --target packages \
   -r requirements.txt
</code></pre>
<details><summary>debug output</summary>

<pre><code class="language-txt">DEBUG uv 0.8.10 (Homebrew 2025-08-13)
DEBUG Searching for Python 3.13 in virtual environments, managed installations, or search path
DEBUG Found `cpython-3.13.5-macos-x86_64-none` at `/Users/nico/projects/uv-bug/foo/.venv/bin/python3` (virtual environment)
Using CPython 3.13.5 interpreter at: .venv/bin/python3
DEBUG Using `--target` directory at packages
DEBUG Acquired lock for `packages`
DEBUG At least one requirement is not satisfied: file:///Users/nico/projects/uv-bug/foo/a
DEBUG Using request timeout of 30s
DEBUG Found PEP 621 metadata for /Users/nico/projects/uv-bug/foo/a in `pyproject.toml` (a)
DEBUG Found PEP 621 metadata for /Users/nico/projects/uv-bug/foo/shared in `pyproject.toml` (shared)
DEBUG Found static `pyproject.toml` for: a @ file:///Users/nico/projects/uv-bug/foo/a
DEBUG Found static `pyproject.toml` for: shared @ file:///Users/nico/projects/uv-bug/foo/shared
DEBUG Found workspace root: `/Users/nico/projects/uv-bug/foo`
DEBUG Adding root workspace member: `/Users/nico/projects/uv-bug/foo`
DEBUG Found workspace root: `/Users/nico/projects/uv-bug/foo`
DEBUG Adding root workspace member: `/Users/nico/projects/uv-bug/foo`
DEBUG Adding discovered workspace member: `/Users/nico/projects/uv-bug/foo/a`
DEBUG Adding discovered workspace member: `/Users/nico/projects/uv-bug/foo/a`
DEBUG Adding discovered workspace member: `/Users/nico/projects/uv-bug/foo/b`
DEBUG Adding discovered workspace member: `/Users/nico/projects/uv-bug/foo/b`
DEBUG Adding discovered workspace member: `/Users/nico/projects/uv-bug/foo/shared`
DEBUG Adding discovered workspace member: `/Users/nico/projects/uv-bug/foo/shared`
DEBUG Allowing an editable variant of file:///Users/nico/projects/uv-bug/foo/shared
DEBUG Solving with installed Python version: 3.13.5
DEBUG Solving with target Python version: &gt;=3.13.5
DEBUG Adding direct dependency: a*
DEBUG Adding direct dependency: shared*
DEBUG Searching for a compatible version of a @ file:///Users/nico/projects/uv-bug/foo/a (*)
DEBUG Adding transitive dependency for a==0.1.0: shared*
DEBUG Searching for a compatible version of shared @ file:///Users/nico/projects/uv-bug/foo/shared (*)
DEBUG Tried 2 versions: a 1, shared 1
DEBUG marker environment resolution took 0.006s
Resolved 2 packages in 44ms
DEBUG Computed cache info: Some(Timestamp(SystemTime { tv_sec: 1755231649, tv_nsec: 330989051 })), None, None, {}, {&quot;src&quot;: Some(Timestamp(Timestamp(SystemTime { tv_sec: 1755231649, tv_nsec: 108338081 })))}
DEBUG Directory source requirement already cached: a==0.1.0 (from file:///Users/nico/projects/uv-bug/foo/a)
DEBUG Computed cache info: Some(Timestamp(SystemTime { tv_sec: 1755231649, tv_nsec: 253928064 })), None, None, {}, {&quot;src&quot;: Some(Timestamp(Timestamp(SystemTime { tv_sec: 1755231649, tv_nsec: 254012372 })))}
DEBUG Directory source requirement already cached: shared==0.1.0 (from file:///Users/nico/projects/uv-bug/foo/shared)
Installed 2 packages in 4ms
 + a==0.1.0 (from file:///Users/nico/projects/uv-bug/foo/a)
 + shared==0.1.0 (from file:///Users/nico/projects/uv-bug/foo/shared)
DEBUG Released lock at `packages/.lock`
</code></pre>
</details>

<pre><code class="language-bash">&gt; ls -l packages
total 8
drwxr-xr-x  4 nico  staff  128 Aug 15 06:28 a
drwxr-xr-x  5 nico  staff  160 Aug 15 06:28 a-0.1.0.dist-info
drwxr-xr-x  5 nico  staff  160 Aug 15 06:28 shared-0.1.0.dist-info
-rw-r--r--  1 nico  staff   42 Aug 15 06:20 shared.pth
</code></pre>
<p>This problem did not occur when I added the <code>--no-deps</code> flag to the installation.</p>
<p>Is this the correct behaviour, whereby a dependent package is always editable by default?
Perhaps there is a missing <code>--no-editable</code> flag for<code>uv pip install</code>?</p>
<h3>Platform</h3>
<p>macOS 15.6</p>
<h3>Version</h3>
<p>uv 0.8.10 (Homebrew 2025-08-13)</p>
<h3>Python version</h3>
<p>Python 3.13.5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @tonnico on 2025-08-15 04:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-15 13:46</div>
            <div class="timeline-body"><p>If you pass <code>--no-sources</code>, I think that will disable the editables here. (The packages are being included as editable because they're workspace members.) I need to think a bit more on the &quot;right&quot; behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tonnico">@tonnico</a> on 2025-08-15 15:40</div>
            <div class="timeline-body"><blockquote>
<p>If you pass <code>--no-sources</code></p>
</blockquote>
<p>I can confirm that this produces my expected output.</p>
<blockquote>
<p>The packages are being included</p>
</blockquote>
<p>It is only the <code>shared</code> package which is editable. The package <code>a</code> is not editable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-15 15:45</div>
            <div class="timeline-body"><p>See also</p>
<ul>
<li>https://github.com/astral-sh/uv/issues/14963</li>
<li>https://github.com/astral-sh/uv/issues/14617</li>
<li>https://github.com/astral-sh/uv/issues/5631</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vivekd22">@vivekd22</a> on 2025-08-25 14:17</div>
            <div class="timeline-body"><p>@charliermarsh Does <code>--no-sources</code> work with <code>uv sync</code> or <code>uv build</code> in this case -
I have workspace members that are dependencies of other workspace members. During development, I would want to sync with upstream PyPI version (for example, to verify some functionality or to build a wheel). It seems that as long as the versioning is satisfied by the local workspace member, uv always picks that. If the version is not satisfied by the local workspace member, then uv fails with the error -</p>
<pre><code>  × No solution found when resolving dependencies:
  ╰─▶ Because a depends on uv-demo and your workspace requires a, we can conclude that your workspace's requirements are unsatisfiable.
</code></pre>
<p>Example is same as this -</p>
<pre><code>uv init --bare foo
cd foo
uv init --lib a
uv init --lib shared
(cd a &amp;&amp; uv add shared)
</code></pre>
<p>I would want shared to be fetched from PyPI when using <code>--no-sources</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../AllenInstitute/aibs-informatics-cdk-lib/pulls/45.html">AllenInstitute/aibs-informatics-cdk-lib#45</a> on 2025-11-06 20:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:11 UTC
    </footer>
</body>
</html>
