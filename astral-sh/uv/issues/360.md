```yaml
number: 360
title: "panic when trying to `pip-compile scripts/benchmarks/requirements/pydantic.in` for the second time"
type: issue
state: closed
author: BurntSushi
labels:
  - bug
assignees: []
created_at: 2023-11-07T18:06:20Z
updated_at: 2023-11-07T18:58:19Z
url: https://github.com/astral-sh/uv/issues/360
synced_at: 2026-01-10T01:57:00Z
```

# panic when trying to `pip-compile scripts/benchmarks/requirements/pydantic.in` for the second time

---

_Issue opened by @BurntSushi on 2023-11-07 18:06_

To reproduce:

```
$ git rev-parse HEAD
294955ecffe9441248e467083e0414150b726865
$ virtualenv ve
$ . ve/bin/activate
$ cargo run -p puffin-cli -- pip-compile ./scripts/benchmarks/requirements/pydantic.in
[.. snip ..]
    Finished dev [unoptimized + debuginfo] target(s) in 23.37s
     Running `target/debug/puffin pip-compile ./scripts/benchmarks/requirements/pydantic.in`
Updated https://github.com/pydantic/pydantic-extra-types.git (a973b79)
Updated https://github.com/jimporter/mike.git (076a4af)
Built mike @ git+https://github.com/jimporter/mike.git@076a4af3270a448f6aeb880c9c6c2fc0d80f603f
Built pydantic-extra-types @ git+https://github.com/pydantic/pydantic-extra-types.git@a973b7942112df731e2618336e55e3343a2e1c32
Resolved 84 packages in 3.61s
# This file was autogenerated by Puffin v0.0.1 via the following command:
#    target/debug/puffin pip-compile ./scripts/benchmarks/requirements/pydantic.in
annotated-types==0.6.0
    # via pydantic
ansi2html==1.8.0
asttokens==2.4.1
    # via devtools
[.. snip ..]
$ cargo run -p puffin-cli -- pip-compile ./scripts/benchmarks/requirements/pydantic.in
    Finished dev [unoptimized + debuginfo] target(s) in 0.08s
     Running `target/debug/puffin pip-compile ./scripts/benchmarks/requirements/pydantic.in`
Updated https://github.com/jimporter/mike.git (076a4af)
Updating https://github.com/pydantic/pydantic-extra-types.git (main)
та╝ Resolving dependencies...                                                                                                                                                                thread 'tokio-runtime-worker' panicked at crates/puffin-cli/src/commands/reporters.rs:300:29:
removal index (is 1) should be < len (is 1)
Updating https://github.com/pydantic/pydantic-extra-types.git (main)
Building mike @ git+https://github.com/jimporter/mike.git@076a4af3270a448f6aeb880c9c6c2fc0d80f603f
таж Resolving dependencies...                                                                                                                                                                thread 'main' panicked at crates/puffin-cli/src/commands/reporters.rs:263:41:
called `Result::unwrap()` on an `Err` value: PoisonError { .. }
```

Notice that I ran `cargo run -p puffin-cli -- pip-compile ./scripts/benchmarks/requirements/pydantic.in` twice. The first time seems to have succeeded, but the second one panics.

---

_Label `bug` added by @charliermarsh on 2023-11-07 18:16_

---

_Added to milestone `Feature complete` by @charliermarsh on 2023-11-07 18:16_

---

_Assigned to @charliermarsh by @charliermarsh on 2023-11-07 18:52_

---

_Referenced in [astral-sh/uv#362](../../astral-sh/uv/pulls/362.md) on 2023-11-07 18:54_

---

_Comment by @charliermarsh on 2023-11-07 18:55_

Thanks for filing, very clear issue. Fixed in #362.

---

_Closed by @charliermarsh on 2023-11-07 18:58_

---
