<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV publish on test Pypi fails - astral-sh/uv #17251</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UV publish on test Pypi fails</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/17251">#17251</a>
        opened by <a href="https://github.com/UbeyOzcan">@UbeyOzcan</a>
        on 2025-12-29 14:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/UbeyOzcan">@UbeyOzcan</a></div>
            <div class="timeline-body">Summary
<p>Reproducing the package publication example but using <code>UV build</code> and <code>UV publish</code> : https://packaging.python.org/en/latest/tutorials/packaging-projects/</p>
<p><code>UV publish</code> works perfectly on Pypi but keeps failing on testPypi <strong><em>with code 403 Forbidden  Server says: 403 Invalid or non-existent authentication information.</em></strong></p>
<p>I have than try to upload using twine with this command :</p>
<p><code>python3 -m twine upload --repository testpypi dist/*</code></p>
<p>and that works perfectly.</p>
<p>Any idea why UV publish works perfectly on pypi and not on testpypi ?</p>
<p>Thanks in advance !</p>
<p>pyproject.toml :</p>
<pre><code>[project]
name = &quot;example_package_ubeyozcan&quot;
version = &quot;0.0.2&quot;
authors = [
  { name=&quot;Example Author&quot;, email=&quot;author@example.com&quot; },
]
description = &quot;A small example package&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.9&quot;
classifiers = [
    &quot;Programming Language :: Python :: 3&quot;,
    &quot;Operating System :: OS Independent&quot;,
]
license = &quot;MIT&quot;
license-files = [&quot;LICEN[CS]E*&quot;]

[project.urls]
Homepage = &quot;https://github.com/pypa/sampleproject&quot;
Issues = &quot;https://github.com/pypa/sampleproject/issues&quot;

[build-system]
requires = [&quot;uv_build &gt;= 0.9.18, &lt;0.10.0&quot;]
build-backend = &quot;uv_build&quot;

[[tool.uv.index]]
name = &quot;example_package_ubeyozcan&quot;
url = &quot;https://test.pypi.org/simple/&quot;
publish-url = &quot;https://test.pypi.org/legacy/&quot;
explicit = true
</code></pre>
Platform
<p>Darwin 24.6.0 arm64</p>
Version
<p>uv 0.9.18 (0cee76417 2025-12-16)</p>
Python version
<p>Python 3.13.5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/UbeyOzcan">@UbeyOzcan</a> on 2025-12-29 14:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EliteTK">@EliteTK</a> on 2025-12-29 15:38</div>
            <div class="timeline-body"><p>I can only reproduce this if I use an invalid token. This could be from the command line (<code>--token</code>), from the environment (<code>UV_PUBLISH_TOKEN</code>), from the credential store (<code>uv help auth</code>), etc.</p>
<p>One good way to figure out where it&#x27;s coming would be to run <code>uv publish</code> with <code>-v</code> or <code>-vv</code>.</p>
<p>Feel free to post the output, but be careful not to accidentally publish your tokens (<code>uv</code> shouldn&#x27;t print these, but you should double check anyway).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woodruffw">@woodruffw</a> on 2025-12-29 16:10</div>
            <div class="timeline-body"><p>In addition to what @EliteTK said, make sure you&#x27;re not using <code>.pypirc</code> for your TestPyPI credentials, since <code>uv publish</code> doesn&#x27;t support that: #7676</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/UbeyOzcan">@UbeyOzcan</a> on 2025-12-29 21:29</div>
            <div class="timeline-body"><p>Thanks for the reply @EliteTK  and @woodruffw.</p>
<p>@EliteTK  I will have a look with -v or -vv to check this.</p>
<p>@woodruffw I&#x27;m not using <code>.pypirc</code> as I was just trying to publish using only <code>uv</code> and i put the <code>TOKEN</code> manually in the command line.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2026-01-04 18:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:41:24 UTC
    </footer>
</body>
</html>
