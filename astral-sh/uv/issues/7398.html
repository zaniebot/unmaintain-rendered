<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv uses old wheels in cache when building bindings locally - astral-sh/uv #7398</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv uses old wheels in cache when building bindings locally</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7398">#7398</a>
        opened by <a href="https://github.com/pacjac">@pacjac</a>
        on 2024-09-14 20:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/pacjac">@pacjac</a></div>
            <div class="timeline-body"><p>For a project I'm using pybind11 to create python bindings.</p>
<p>Running uv 0.3.2. on x86_64 GNU/Linux.</p>
<ul>
<li>A minimal code snippet that reproduces the bug.</li>
</ul>
<ol>
<li>Set up an example project:
<code>uv tool run cookiecutter gh:scientific-python/cookie</code>, select 9 &quot;scikit-build&quot;.</li>
<li>Install first version
<code>uv add pip &amp; uv run pip install .</code></li>
<li>Modify source code
`sed -i -e &quot;s/add/plus/g&quot; src/main.cpp&quot;</li>
<li>in a second terminal, open a python session <code>uv run python</code></li>
<li>Install upgraded wheel
<code>uv run pip install . --upgrade</code>
Here, everything works as expected, the changes take effect.
In the running python session</li>
</ol>
<pre><code class="language-python">import mymodule._core as mwe
print(dir(mwe))
</code></pre>
<p>shows the renamed plus function.
5. Run another uv utility, e.g. <code>uv run python</code>
The old version of our local wheel is installed again</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pacjac">@pacjac</a> on 2024-09-14 20:16</div>
            <div class="timeline-body"><p>The great <a href="https://docs.astral.sh/uv/concepts/cache/#dynamic-metadata">documentation on caching</a> fully solves my problem, I was merely too stupid to RTFM.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pacjac on 2024-09-14 20:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:27:08 UTC
    </footer>
</body>
</html>
