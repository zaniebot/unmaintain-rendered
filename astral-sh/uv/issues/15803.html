<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add config to allow connection errors when searching across indexes - astral-sh/uv #15803</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Add config to allow connection errors when searching across indexes</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/15803">#15803</a>
        opened by <a href="https://github.com/chrisirhc">@chrisirhc</a>
        on 2025-09-12 07:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/chrisirhc">@chrisirhc</a> on 2025-09-12 07:10</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Use case:
There's a private index url which can only be accessed via certain network configurations such as within company VPN. And another public index url that is authenticated.</p>
<p>I want to be able to configure uv once and to try and use the private index url first, then still conclude successfully even if the private url can't be connected to, but the subsequent index url(s) were successful.
However, when I try to do this today, it errors out with:</p>
<pre><code>…
TRACE Considering retry of error: Error { kind: WrappedReqwestError(DisplaySafeUrl { scheme: &quot;http&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;some.internal&quot;)), port: Some(4587), path: &quot;/…/simple/pyomo/&quot;, query: None, fragment: None }, WrappedReqwestError(Middleware(Request failed after 3 retries

Caused by:
    0: error sending request for url (http://some.internal:4587/…/pyomo/)
    1: client error (Connect)
    2: dns error
    3: failed to lookup address information: nodename nor servname provided, or not known))), retries: 0 }
TRACE Cannot retry IO error `uncategorized error`, not a retryable IO error kind
TRACE Streams::recv_eof
TRACE Error trace: Failed to fetch: `http://some.internal:4587/…/pyomo/`
</code></pre>
<h3>Example</h3>
<p>A configuration like the following would allow the connect error to be ignored:</p>
<pre><code class="language-toml">[[index]]
url = &quot;http://some.internal:4587/…/simple&quot;
ignore-connect-error = true

[[index]]
url = &quot;https://publicurl.com/…/simple&quot;
</code></pre>
<p>This is similar to <code>ignore-error-codes</code>, and could also be <code>ignore-error-codes = [400]</code>. Since <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Status/400">400</a> is synonymous with a Client error.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @chrisirhc on 2025-09-12 07:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-12 13:36</div>
            <div class="timeline-body"><p>It seems like the concept you want here is more like a mirror than multiple indexes? The problem with this approach is that the lockfile will change depending on whether you can connect to the private index.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chrisirhc">@chrisirhc</a> on 2025-09-20 05:14</div>
            <div class="timeline-body"><p>Yes, this is more like a mirror or an alternative url for the same index. If uv is able to retrieve from either of the urls, it should not result in an error.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:29 UTC
    </footer>
</body>
</html>
