<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV Workspaces setup  and imports - astral-sh/uv #7576</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UV Workspaces setup  and imports</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7576">#7576</a>
        opened by <a href="https://github.com/pablo-a">@pablo-a</a>
        on 2024-09-20 10:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/pablo-a">@pablo-a</a> on 2024-09-20 10:00</div>
            <div class="timeline-body"><p>Hi ! Thanks a lot for this really promising project !
I however fail to understand how to setup correctly uv workspaces even for a minimalist project that follow uv documentation</p>
<p>TLDR;
i have a repository containing an app and a package. I fail to import the package code in the app code
here is a link to the public repository with full code i made to try out uv workspaces : https://github.com/pablo-a/uv_workspaces/tree/master</p>
<h2>Repository structure</h2>
<pre><code>.
└── uv_workspaces ## Repository name/
    ├── pyproject.toml
    ├── .python-version
    ├── uv.lock
    ├── packages/
    │   └── p1/
    │       ├── hello.py
    │       ├── pyproject.toml
    │       └── .python-version
    └── src/
        └── uv_workspaces/
            └── hello.py
</code></pre>
<h2>app hello.py</h2>
<pre><code>from p1 import main as main_p1

def main():
    main_p1()
    print(&quot;Hello from uv-workspaces!&quot;)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<h2>Command run and error :</h2>
<pre><code>uv run src/uv_workspaces/hello.py
Traceback (most recent call last):
  File &quot;/Users/pabloabril/Documents/deepki/uv_workspaces/src/uv_workspaces/hello.py&quot;, line 1, in &lt;module&gt;
    from p1.hello import main as main_p1
ModuleNotFoundError: No module named 'p1'
</code></pre>
<p>uv version : uv 0.4.10 (690716484 2024-09-13)
platform: Macos M1 pro ARM64</p>
<h2>Same error for example repo uv-fastapi-example</h2>
<p>It seems to me that i'm not running the good command ? for example i tried cloning your uv-fastapi-example repository and ran into the same error :</p>
<pre><code>uv run app/main.py
Traceback (most recent call last):
  File &quot;/Users/pabloabril/Documents/deepki/uv-fastapi-example/app/main.py&quot;, line 3, in &lt;module&gt;
    from .dependencies import get_query_token, get_token_header
ImportError: attempted relative import with no known parent package
</code></pre>
<p>Thanks a lot for your hard work and let me know if i can give any more information to help.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BaccanoMob">@BaccanoMob</a> on 2024-09-21 04:54</div>
            <div class="timeline-body"><p>Use this folder structure (for some reason p1 did'nt work but pone did).</p>
<p>Packages have a different <code>folder structure</code> and different <code>pyproject.toml</code> compared to app (<a href="https://docs.astral.sh/uv/concepts/projects/">Check docs</a>) which packages folder did not follow.</p>
<pre><code>.
├── package/
│   └── pone/
│       ├── src/
│       │   └── pone/
│       │       ├── __init__.py
│       │       └── hello.py
│       ├── .python-version
│       ├── pyproject.toml
│       └── README.md
├── src/
│   └── uv_workspaces/
│       ├── __init__.py
│       └── hello.py
├── .python-version
├── pyproject.toml
└── README.md
</code></pre>
<p>pone/pyproject.toml</p>
<pre><code class="language-toml">[project]
name = &quot;pone&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = []

# BELOW ARE REQUIRED FOR PACKAGES
[tool.hatch.build.targets.wheel]
packages = [&quot;src/pone&quot;]

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;
</code></pre>
<p>pyproject.toml</p>
<pre><code class="language-toml">[project]
name = &quot;uv-workspaces&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
    &quot;pone&quot;,
]

[tool.uv.workspace]
members = [&quot;packages/pone&quot;]

[tool.uv.sources]
pone = { workspace = true }

# BELOW ARE REQUIRED FOR PACKAGED APPS
[tool.hatch.build.targets.wheel]
packages = [&quot;src/uv_workspaces&quot;]

[project.scripts]
hello = &quot;uv_workspaces.hello:main&quot;

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;
</code></pre>
<p>Add <code>from pone.hello import main as main_p1</code> in hello.py</p>
<p>run this with</p>
<pre><code>uv run hello
</code></pre>
<p>Do not run packaged app with <code>uv run src/uv_workspaces/hello.py</code>, use project.scripts. For your case, since its one file it would still work but with larger projects you might get import errors when using relative imports (thats how i found this issue).</p>
<p>pone package can also have project.scripts and can run with <code>uv run</code> (for below it would be <code>uv run hello_pone</code>) so you can test pone package independently.</p>
<pre><code class="language-toml">[project.scripts]
hello_pone = &quot;pone.hello:main&quot;
</code></pre>
<p>Delete .venv, uv.lock, <strong>pycache</strong> and try again if the above changes do not work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pablo-a">@pablo-a</a> on 2024-09-22 10:40</div>
            <div class="timeline-body"><p>Thanks a lot ! I understand it a lot better now,
i was missing the part about including the build-system for each package that can be importable :)</p>
<p>I still find it a bit confusing, not being able to run a file directly without invoking it from pyproject.script section.
Feel like workspaces section could use some clarifications :)</p>
<p>Thanks a lot anyway !</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @pablo-a on 2024-09-22 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BaccanoMob">@BaccanoMob</a> on 2024-09-22 13:10</div>
            <div class="timeline-body"><blockquote>
<p>I still find it a bit confusing, not being able to run a file directly without invoking it from pyproject.script section.</p>
</blockquote>
<p>I think it will run if the hello.py was in the root directory rather than inside src/uv_workspaces folder.</p>
<p>If uses case is package or packaged app -&gt; it needs to be under src folder (or you will need to specify a path in tool.hatch.build.targets.wheel), this is related to building the package</p>
<p>If its app -&gt; root folder, does not need src folder</p>
<p>Check all the project structure in the <a href="https://docs.astral.sh/uv/concepts/projects/">docs</a> where the hello function is and how it is called for different projects</p>
<p>For bigger applications like the fastapi example, you prolly need to move main.py (aka entrypoint) to root directory (and remove relative imports in the files in root directory) for it to work as an application. This is more of a python related issue rather than uv why it needs to be in the root directory. (I do not know python enough to resolve this sorry)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/C-Loftus">@C-Loftus</a> on 2025-03-20 14:42</div>
            <div class="timeline-body"><p>Sorry to bump an old thread but do others find that you can go to type definition or use similar static tools when using uv workspaces? In vscode my common package can be imported from, gets syntax highlighting, and works fine at runtime, but there appears to be something wrong with module resolution since I can't jump to definitions.</p>
<p><img src="https://github.com/user-attachments/assets/21378197-6112-40d1-9a41-bb35c9c8f85b" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/C-Loftus">@C-Loftus</a> on 2025-03-20 15:11</div>
            <div class="timeline-body"><blockquote>
<p>Sorry to bump an old thread but do others find that you can go to type definition or use similar static tools when using uv workspaces?</p>
</blockquote>
<p>Figured this out sorry to bump again! In my case it was a lib so turns out you need to run <code>uv init --lib $YOUR_PACKAGE_DIR/$YOUR_PACKAGE_NAME</code>. Not exactly sure why this works and the cli doesn't but notably the lib puts a <code>py.typed</code> file in the directory which might be relevant? It also generates the package with a <code>src/</code> directory which I didn't have before.</p>
<p>tldr use the cli options I guess</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alexcochran">@alexcochran</a> on 2025-03-20 15:11</div>
            <div class="timeline-body"><blockquote>
<p>Sorry to bump an old thread but do others find that you can go to type definition or use similar static tools when using uv workspaces? In vscode my common package can be imported from, gets syntax highlighting, and works fine at runtime, but there appears to be something wrong with module resolution since I can't jump to definitions.</p>
<p><img src="https://github.com/user-attachments/assets/21378197-6112-40d1-9a41-bb35c9c8f85b" alt="Image" /></p>
</blockquote>
<p>I'm noticing something similar in my VS Code environment while using <a href="https://github.com/fedragon/uv-workspace-example/tree/main#">someone else's working example</a>. I can successfully run a script in the root-level package that imports and executes a function from the subpackage, but Pylance complains that the package import can't be resolved, and I can't navigate to the definitions:</p>
<p><img src="https://github.com/user-attachments/assets/7610af46-4bb2-4ff7-b9f5-8ff7328a9b4a" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/C-Loftus">@C-Loftus</a> on 2025-03-20 15:38</div>
            <div class="timeline-body"><blockquote>
<p>I'm noticing something similar in my VS Code environment while using <a href="https://github.com/fedragon/uv-workspace-example/tree/main#">someone else's working example</a>. I can successfully run a script in the root-level package that imports and executes a function from the subpackage, but Pylance complains that the package import can't be resolved, and I can't navigate to the definitions:</p>
</blockquote>
<p>@alexcochran Not sure about your specific example, but if it helps I have now have a working project with uv workspaces, 2 packages, and one library; it works with vscode and pylance for me. It is all open source so feel free to take a look https://github.com/cgs-earth/IODH-Mappings It should be straightforward to build with the makefile at the root.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:44:05 UTC
    </footer>
</body>
</html>
