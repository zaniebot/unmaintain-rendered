<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv install` installs incompatible package for python version - astral-sh/uv #7462</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv install</code> installs incompatible package for python version</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7462">#7462</a>
        opened by <a href="https://github.com/timvink">@timvink</a>
        on 2024-09-17 14:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/timvink">@timvink</a></div>
            <div class="timeline-body"><p>First of all, <code>uv</code> is ðŸ”¥ ! Really enjoying working with it!</p>
<p>I am able to install packages with <code>uv pip install</code> that I cannot install with <code>pip install</code> because the python version is incompatible. Consider the <a href="https://pypi.org/project/dataclasses/">dataclasses </a> library which <code>Requires: Python &gt;=3.6, &lt;3.7</code> :</p>
<pre><code>python -V
# Python 3.10.14

pip install dataclasses==0.8
# Looking in indexes: http://&lt;redacted&gt;@&lt;redacted&gt;/artifactory/api/pypi/&lt;redacted&gt;/simple, https://pypi.org/simple
# ERROR: Ignored the following versions that require a different python version: 0.7 Requires-Python &gt;=3.6, &lt;3.7; 0.8 Requires-Python &gt;=3.6, &lt;3.7
# ERROR: Could not find a version that satisfies the requirement dataclasses==0.0.8 (from versions: 0.1, 0.2, 0.3, 0.4, 0.5, 0.6)
# ERROR: No matching distribution found for dataclasses==0.0.8

uv pip install dataclasses==0.8 --verbose
# DEBUG uv 0.4.8
# DEBUG Searching for Python interpreter in system path
# DEBUG Found `cpython-3.10.14-linux-x86_64-gnu` at `/anaconda/envs/redacted/bin/python3` (conda prefix)
# DEBUG Using Python 3.10.14 environment at /anaconda/envs/redacted/bin/python3
# DEBUG Acquired lock for `/anaconda/envs/redacted`
# DEBUG At least one requirement is not satisfied: dataclasses==0.8
# DEBUG Using request timeout of 30s
# DEBUG Solving with installed Python version: 3.10.14
# DEBUG Solving with target Python version: &gt;=3.10.14
# DEBUG Adding direct dependency: dataclasses==0.8
# DEBUG No cache entry for: https://artifactory&lt;redacted&gt;
# DEBUG Found fresh response for: https://pypi.org/simple/dataclasses/
# DEBUG Searching for a compatible version of dataclasses (==0.8)
# DEBUG Selecting: dataclasses==0.8 [compatible] (dataclasses-0.8-py3-none-any.whl)
# DEBUG Found fresh response for: https://files.pythonhosted.org/packages/fe/ca/75fac5856ab5cfa51bbbcefa250182e50441074fdc3f803f6e76451fab43/dataclasses-0.8-py3-none-any.whl.metadata
# DEBUG Tried 1 versions: dataclasses 1
# DEBUG Split specific environment resolution took 0.104s
# Resolved 1 package in 107ms
# DEBUG Requirement already cached: dataclasses==0.8
# DEBUG Unnecessary package:  # &lt;-- long list of these
# Installed 1 package in 0.70ms
#  + dataclasses==0.8
# DEBUG Released lock at `/tmp/uv-0ef8d6f78fde4fb3.lock`
</code></pre>
<p>Using uv <code>0.4.10</code> on ubuntu. I have confirmed this problem in two different systems (one with custom index, one without). And also on uv versions <code>0.4.9</code>, <code>0.4.8</code>, <code>0.4.7</code>. And I tried using <code>uv pip install --python 3.10.14</code> explicitly.</p>
<p>This has some downstream problems. In my case, the <code>dataclasses</code> dependency appeared in my <code>requirements.txt</code> file after <code>uv pip compile</code>, and the ML model logged to <code>mlflow </code> with the <code>requirements.txt</code> file, could not be loaded back, because <code>pip</code> could not install the dependency.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-17 14:30</div>
            <div class="timeline-body"><p>Thanks for the well written report!</p>
<p>We ignore upper bounds on Python versions during resolution, so we will resolve as though the <code>dataclasses</code> only declares <code>Requires: Python &gt;=3.6</code>. The reasons for this are quite complicated, there&#x27;s some context in <a href="https://github.com/astral-sh/uv/issues/4022">astral-sh/uv#4022</a></p>
<p>I&#x27;m  think you may need to declare a lower bound on dataclasses, which would be ideal anyway if that version truly doesn&#x27;t support Python 3.10.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/timvink">@timvink</a> on 2024-09-17 14:58</div>
            <div class="timeline-body"><p>Thanks for the context! Not sure there is much we can do then.</p>
<p>I cannot declare the lower bound myself, as in my case <code>dataclasses</code> is a downstream dependency that was resolved during <code>uv pip compile</code>.</p>
<p>For anyone hitting this issue, my workaround was using <code>uv</code> in the inference environment :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/timvink">@timvink</a> on 2024-09-17 14:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-17 15:05</div>
            <div class="timeline-body"><p>@timvink you can add a lower bound using constraints or overrides https://docs.astral.sh/uv/concepts/resolution/#dependency-constraints</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:34:06 UTC
    </footer>
</body>
</html>
