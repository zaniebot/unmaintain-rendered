<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unable to authenticate to GCP artifact registry - astral-sh/uv #2055</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Unable to authenticate to GCP artifact registry</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/2055">#2055</a>
        opened by <a href="https://github.com/meridionaljet">@meridionaljet</a>
        on 2024-02-28 21:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/meridionaljet">@meridionaljet</a> on 2024-02-28 21:05</div>
            <div class="timeline-body"><p>uv version: 0.1.11
Platform: Linux</p>
<p>I can't seem to get <code>uv</code> to authenticate to a GCP artifact registry that <code>pip</code> is able to pull packages from. In pip's case, I believe it uses <code>keyring</code> to provide the GCP credentials for the registry, with the keyring implementation set up by the <code>keyrings.google-artifactregistry-auth</code> package. I don't know if <code>uv</code> is designed to use keyring to facilitate this use case or whether that's the root of the issue here. The error below is identical whether or not the keyring packages are installed.</p>
<pre><code class="language-bash">$ uv pip install --index-url https://us-west2-python.pkg.dev/&lt;project&gt;/&lt;repo&gt;/simple &lt;package&gt; --verbose
 uv::requirements::from_source source=&lt;package&gt;
    0.012747s DEBUG uv_interpreter::virtual_env Found a virtualenv through CONDA_PREFIX at: /home/user/micromamba/envs/test2
    0.013021s DEBUG uv_interpreter::interpreter Cached interpreter info for Python 3.12.0, skipping probing: /home/user/micromamba/envs/test2/bin/python
    0.013077s DEBUG uv::commands::pip_install Using Python 3.12.0 environment at /home/user/micromamba/envs/test2/bin/python
    0.015614s DEBUG uv_client::registry_client Using registry request timeout of 300s
 uv_client::flat_index::from_entries
 uv_resolver::resolver::solve
      0.020199s   0ms DEBUG uv_resolver::resolver Solving with target Python version 3.12.0
   uv_resolver::resolver::choose_version package=root
   uv_resolver::resolver::get_dependencies package=root, version=0a0.dev0
        0.020380s   0ms DEBUG uv_resolver::resolver Adding direct dependency: &lt;package&gt;*
   uv_resolver::resolver::choose_version package=&lt;package&gt;
     uv_resolver::resolver::package_wait package_name=&lt;package&gt;
 uv_resolver::resolver::process_request request=Versions &lt;package&gt;
   uv_client::registry_client::simple_api package=&lt;package&gt;
     uv_client::cached_client::get_cacheable
       uv_client::cached_client::read_and_parse_cache file=/home/user/.cache/uv/simple-v3/4d3bb4184f3a25c0/&lt;package&gt;.rkyv
 uv_resolver::resolver::process_request request=Prefetch &lt;package&gt; *
 uv_client::cached_client::from_path_sync path=&quot;/home/user/.cache/uv/simple-v3/4d3bb4184f3a25c0/&lt;package&gt;.rkyv&quot;
          0.021611s   0ms DEBUG uv_client::cached_client No cache entry for: https://us-west2-python.pkg.dev/&lt;project&gt;/&lt;repo&gt;/simple/&lt;package&gt;/
       uv_client::cached_client::fresh_request url=&quot;https://us-west2-python.pkg.dev/&lt;project&gt;/&lt;repo&gt;/simple/&lt;package&gt;/&quot;
error: HTTP status client error (401 Unauthorized) for url (https://us-west2-python.pkg.dev/&lt;project&gt;/&lt;repo&gt;/simple/&lt;package&gt;/)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-28 21:06</div>
            <div class="timeline-body"><p>Thanks -- I think this should be covered by https://github.com/astral-sh/uv/issues/1520, so I'll probably merge this issue into that one? We don't support keyring yet, but plan to.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/meridionaljet">@meridionaljet</a> on 2024-02-28 21:09</div>
            <div class="timeline-body"><blockquote>
<p>Thanks -- I think this should be covered by #1520, so I'll probably merge this issue into that one? We don't support keyring yet, but plan to.</p>
</blockquote>
<p>Ah, apologies, I missed that issue. Thanks for the info!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-28 21:09</div>
            <div class="timeline-body"><p>Np! We'll get to it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-28 21:09</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:57 UTC
    </footer>
</body>
</html>
