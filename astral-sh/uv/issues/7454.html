<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚ú® Allow patching third-party packages via new command `uv patch &lt;pkg_name&gt;` - astral-sh/uv #7454</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>‚ú® Allow patching third-party packages via new command <code>uv patch &lt;pkg_name&gt;</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/7454">#7454</a>
        opened by <a href="https://github.com/jd-solanki">@jd-solanki</a>
        on 2024-09-17 10:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jd-solanki">@jd-solanki</a> on 2024-09-17 10:47</div>
            <div class="timeline-body"><p>Hi üëãüèª</p>
<p>When working on node based project there's <a href="https://pnpm.io/">pnpm</a> package manager that allows patching third-party packages installed in node_modules if we want to fix something for all the contributors of the project.</p>
<p>pnpm allows this via <a href="https://pnpm.io/cli/patch">patch</a></p>
<p>I came across similar situation where I want to patch the package &quot;fastapi-users&quot; until I get response on my PR/discussion. I noticed UV don't have such feature.</p>
<p>Thanks for the UV it's superfast üöÄ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-17 13:01</div>
            <div class="timeline-body"><p>You <em>can</em> patch third-party dependencies via <code>tool.uv.sources</code>. Like, you could clone anyio locally, and then add:</p>
<pre><code class="language-toml">[tool.uv.sources]
anyio = { path = &quot;/path/to/anyio&quot; }
</code></pre>
<p>Assuming you make <code>anyio</code> a direct dependency. Is this different than the patch workflow?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-09-17 13:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jd-solanki">@jd-solanki</a> on 2024-09-18 05:39</div>
            <div class="timeline-body"><p>Hi Charlie,</p>
<p>Glad to see you. Unfortunetly, this is not patch workflow. In our case with above solution everyone has to either go through steps you mentioned to start working on project or else we have to commit third-package along with source code with is really bad.</p>
<p>Assume I want to do minor fix in some unmaintained library but we don't prefer forking and making a seperate package just for that minor change. So, in pnpm we run <code>pnpm patch &lt;that-lib&gt;</code> and it'll copy that dep somewhere in temp location where we can edit the dependency however we want for example adding print in python or console.log in node. Once we are done with editing we run <code>pnpm patch-commit &lt;temp-path-where-pnpm-gen-clone&gt;</code> this generates patch (git diff) in our source code as you can see <a href="https://youtu.be/0GjLqRGRbcY?t=118">here</a>. Now, whenever someone clone our repo and run <code>pnpm install</code> these patch inside <code>patches</code> directory get applied to node_modules automatically for everyone without any additional steps.</p>
<p>Checkout this <a href="https://www.youtube.com/watch?v=0GjLqRGRbcY">pnpm video</a></p>
<hr />
<p>Usecases:</p>
<ul>
<li>Making minor fixes in unmaintained libs</li>
<li>Continue working on project as a team until lib author merges the PR or addes feature</li>
<li>Tweak third party package without extra hassle of maintaining it</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aretrace">@aretrace</a> on 2024-12-17 15:23</div>
            <div class="timeline-body"><p>‚ú® YES YES YES ‚ú®
<code>uv patch &lt;pkg_name&gt;</code> will be insurmountably useful!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonathanPlasse">@JonathanPlasse</a> on 2025-01-03 13:26</div>
            <div class="timeline-body"><p>That is exactly what I am looking for to allow using <a href="https://github.com/nutti/fake-bpy-module">fake-bpy-module</a> with custom properties for Blender add-on development.
The <code>patch</code> workflow is especially need here as the <code>fake-bpy-module</code> package is auto-generated and would need every person using it with custom properties to maintain a separate git repository mirroring it with their additional changes for every add-on project.
With the <code>patch</code> workflow, the add-on custom properties would not need to be in to separate repo.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Avasam">@Avasam</a> on 2025-03-07 04:14</div>
            <div class="timeline-body"><p>Here's some prior art in the npm ecosystem: https://www.npmjs.com/package/patch-package</p>
<p>that package has saved my ass too many times. Also allowed us to enforce better type safety by patching unsafe types directly in the source !</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jd-solanki">@jd-solanki</a> on 2025-03-07 09:55</div>
            <div class="timeline-body"><p>Hi @charliermarsh We should update the label now from question to something else</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/simplegr33n">@simplegr33n</a> on 2025-03-12 21:18</div>
            <div class="timeline-body"><p>would really appreciate ability to patch 3rd party packages as well, ideally via configuring in <code>pyproject.toml</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/calebpitan">@calebpitan</a> on 2025-04-29 20:19</div>
            <div class="timeline-body"><p>I feared there was no way to patch packages with uv becuase I can say for sure I've seen every corner of the documentation and I don't remember ever seeing any such thing as &quot;patch package&quot;; now I run to the internet to find out if I can patch a package and my fear wins.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/roniemartinez">@roniemartinez</a> on 2025-05-23 21:32</div>
            <div class="timeline-body"><p>Had worked on a TS project recently where a 3rd-party lib was inactive and no releases have been done to fix multiple bugs. Luckily, I was able to use <code>yarn patch/patch-commit</code> which saved us from using an old buggy version of the library.</p>
<p>The workflow is:</p>
<ol>
<li>Run <code>yarn patch &lt;package-name&gt;</code> which copies the library to a temp dir.</li>
<li>Edit the package with an editor (like vim).</li>
<li>Run <code>yarn patch-commit ...</code> which then generates a diff, comparing the original package and the package you edited.</li>
<li>Every time you run install, the patches are applied &quot;post-install&quot;.</li>
</ol>
<p>It would really be awesome if this is supported in <code>uv</code> as we are using our forks of inactive libraries (it's messy).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MattTheCuber">@MattTheCuber</a> on 2025-07-11 20:45</div>
            <div class="timeline-body"><p>This would be super useful for working with security vulnerabilities (#9189 reference).</p>
<p>For example, the current torch version has a vulnerability: https://github.com/advisories/GHSA-887c-mr87-cxwp. It was applied in this commit: https://github.com/pytorch/pytorch/commit/46fc5d8e360127361211cb237d5f9eef0223e567. To set this up, we would need to clone the repository, cherry-pick the commit, build wheels, then install. Having a way to configure this in our <code>pyproject.toml</code> would be amazing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/oliverzy">@oliverzy</a> on 2025-08-23 13:00</div>
            <div class="timeline-body"><p>This is only thing I miss. Please consider it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zhuoqun-chen">@zhuoqun-chen</a> on 2025-09-19 07:14</div>
            <div class="timeline-body"><p>would it be possible to install a package with its patch in the form of the same repo's unmerged pull request? It could be super convenient to install super old packages and make it compatible with modern pytorch bundles.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/oliverzy">@oliverzy</a> on 2025-09-19 07:45</div>
            <div class="timeline-body"><p>https://github.com/nomyfan/patch-package-py</p>
<p>We developed this package to solve this problem, please help youself and let us know whether it helps</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:43 UTC
    </footer>
</body>
</html>
