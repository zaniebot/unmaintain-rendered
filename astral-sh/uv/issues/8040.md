```yaml
number: 8040
title: "add `[tool.pyright]` section when `uv init`"
type: issue
state: closed
author: bnjox
labels:
  - question
assignees: []
created_at: 2024-10-09T09:24:23Z
updated_at: 2024-10-16T09:23:03Z
url: https://github.com/astral-sh/uv/issues/8040
synced_at: 2026-01-10T01:57:18Z
```

# add `[tool.pyright]` section when `uv init`

---

_Issue opened by @bnjox on 2024-10-09 09:24_

can we add this block when we do `uv init` 
```toml
[tool.pyright]
venvPath = "."
venv = ".venv"
```
- It helps avoid creating a pyrightconfig file for small _(or all)_ projects
- Helps avoid always adding it manually or creating the pyrightconfig file to add extra config. 

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->


---

_Comment by @my1e5 on 2024-10-09 10:57_

If you have a specific configuration you want to use, you can set up a command. For example
```
$ uv init foo && cd foo && echo $'\n[tool.pyright]\nvenvPath = "."\nvenv = ".venv"' >> pyproject.toml
```
You could put this as a command in a ` .zshrc` or `.bashrc` file
```
init_uv_pyright() {
    uv init "$1" && cd "$1" && echo $'\n[tool.pyright]\nvenvPath = "."\nvenv = ".venv"\n' >> pyproject.toml
}
```
then run 
```
$ init_uv_pyright foo
```
```
$ cat pyproject.toml
[project]
name = "foo"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.12"
dependencies = []

[tool.pyright]
venvPath = "."
venv = ".venv"
```

---

_Comment by @bnjox on 2024-10-09 11:02_

that could work, but having to setup a custom script just for that is a lot.
what if the tool could either make an option or add it in like we had for the build backend (previously)

---

_Comment by @MikeHart85 on 2024-10-13 09:52_

Assuming you want correct lsp library resolution in your editor, try activating the venv before starting the editor:

```sh
$ . .venv/bin/activate
(venv) $ nvim .
```

Doing it this way has the added benefit that pyright also correctly resolves standard library imports, particularly when a non-system Python install is being used:

```sh
$ uv init --python=3.8
$ uv sync
$ nvim pyproject.toml  # your tool.pyright edit
$ nvim hello.py
```

```py
from pathlib import Path  # try go definition on Path
```

You'll find it either resolves to the system Python library version or, more likely, the typeshed-fallback pyi that pyright ships with. Either way, this will give partially incorrect hints for that Python version.

If you activate the venv instead, **without** edits to pyproject.toml, it will correctly resolve to `~/.local/share/uv/[...]/lib/python3.8/pathlib.py`.

Adding this config block to pyproject.toml would break correct resolution for everyone collaborating on the project, even if they activate their venv before starting their editor.

---

_Comment by @bluss on 2024-10-13 11:33_

@MikeHart85 I think that you're right this is a "bug" in pyright, but I can't find that it's tracked. The fork basedpyright has an issue tracking this.

I think VS Code doesn't need this setting because it configures the LSP with pythonPath or extraPaths instead.

I use neovim and have decided to do the same thing - configure basedpyright with pythonPath/extraPaths per project dynamically - detect a local .venv and query that python for its paths, and use that. That both removes the need for the venv/venvPath configuration, has no need for venv activation, and fixes that bug with jump-to-definition on standard library items.

It's more complicated, but it also allows correct include paths with multiple projects open in the same editor instance.

@sparrowsl: I think the venv/venvPath settings are good, better than requiring environment activation, but IMO just a stepping stone on the way to a fully satisfactory configuration. Even better is to not need those settings at all..

---

_Comment by @MikeHart85 on 2024-10-13 15:23_

Yeah, it definitely smells like a pyright bug. It has everything it needs to figure out the correct location with venvPath/venv set, but just doesn't.

Neovim users could also consider https://github.com/linux-cultist/venv-selector.nvim, which has no trouble finding the .venv that `uv` generates, and remembers which venv to use on a per project basis. However, it currently has the same problem as setting the venPath/venv in pyproject.toml, presumably because it effectively does the same thing and so runs into the same pyright bug.

Perhaps it could be updated to set pythonPath/extraPaths instead, as you suggest. But that feels like a workaround for a bug that shouldn't exist. Really, it's up to based/pyright to fix this properly.

---

_Label `question` added by @konstin on 2024-10-14 08:34_

---

_Comment by @konstin on 2024-10-16 09:23_

We try to avoid adding configuration for external tools in uv. There are some workarounds in this thread, otherwise I recommend raising this with pyright.

---

_Closed by @konstin on 2024-10-16 09:23_

---

_Referenced in [tmcw/indiepixel#18](../../tmcw/indiepixel/pulls/18.md) on 2025-02-09 16:01_

---
