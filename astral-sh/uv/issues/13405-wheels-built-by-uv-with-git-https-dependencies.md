```yaml
number: 13405
title: wheels built by uv with git+https dependencies wrongly installs a package from PyPI with the same name
type: issue
state: closed
author: soof-golan
labels:
  - question
assignees: []
created_at: 2025-05-12T10:37:50Z
updated_at: 2025-05-14T16:38:27Z
url: https://github.com/astral-sh/uv/issues/13405
synced_at: 2026-01-12T16:01:27Z
```

# wheels built by uv with git+https dependencies wrongly installs a package from PyPI with the same name

---

_@soof-golan_

### Summary

Evil twin of #13404

Hi!
For some reason I have not figured out yet, git+https dependency information is lost when consuming wheels or sdist assets produced by `uv build` (by default with hatchling as the build system)

# Reproduction

```bash
cd $(mktemp -d)
mkdir uv-build-repro && cd uv-build-repro
uv init --lib
# The consumer of the wheel gets the results from PyPI, not the fork!
uv add git+https://github.com/soof-golan/uv-build-repro-more-itertools.git
uv build
export WHL_LOCATION="$(realpath dist/*.whl)"

cd $(mktemp -d)
mkdir uv-build-whl-consumer && cd uv-build-whl-consumer
uv init --lib
uv add "$WHL_LOCATION"
uv export
```


## Results

```plaintext
cd $(mktemp -d)
mkdir uv-build-repro && cd uv-build-repro
uv init --lib
# The consumer of the wheel gets the results from PyPI, not the fork!
uv add git+https://github.com/soof-golan/uv-build-repro-more-itertools.git
uv build
export WHL_LOCATION="$(realpath dist/*.whl)"

cd $(mktemp -d)
mkdir uv-build-whl-consumer && cd uv-build-whl-consumer
uv init --lib
uv add "$WHL_LOCATION"
uv export
Initialized project `uv-build-repro`
Using CPython 3.10.17
Creating virtual environment at: .venv
Resolved 2 packages in 245ms
      Built uv-build-repro @ file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.h1FVDJdtYR/uv-build-repro
Prepared 1 package in 444ms
Installed 2 packages in 1ms
 + more-itertools==10.7.0 (from git+https://github.com/soof-golan/uv-build-repro-more-itertools.git@e922b86d1629b38610e2db6748574be543c34115)
 + uv-build-repro==0.1.0 (from file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.h1FVDJdtYR/uv-build-repro)
Building source distribution...
Building wheel from source distribution...
Successfully built dist/uv_build_repro-0.1.0.tar.gz
Successfully built dist/uv_build_repro-0.1.0-py3-none-any.whl
Initialized project `uv-build-whl-consumer`
Using CPython 3.10.17
Creating virtual environment at: .venv
Resolved 3 packages in 2ms
      Built uv-build-whl-consumer @ file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.RCQJIP9Kgd/uv-build-whl-consumer
Prepared 1 package in 128ms
Installed 3 packages in 1ms
 + more-itertools==10.7.0
 + uv-build-repro==0.1.0 (from file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.h1FVDJdtYR/uv-build-repro/dist/uv_build_repro-0.1.0-py3-none-any.whl)
 + uv-build-whl-consumer==0.1.0 (from file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.RCQJIP9Kgd/uv-build-whl-consumer)
Resolved 3 packages in 1ms
# This file was autogenerated by uv via the following command:
#    uv export
-e .
../../tmp.h1FVDJdtYR/uv-build-repro/dist/uv_build_repro-0.1.0-py3-none-any.whl \
    --hash=sha256:2ba6438d239fb36b04a340fb3b2cefb2b4ef1b2ca3c6a23ceab5938cfdfa690f
    # via uv-build-whl-consumer
more-itertools==10.7.0 \
    --hash=sha256:9fddd5403be01a94b204faadcff459ec3568cf110265d3c54323e1e866ad29d3 \
    --hash=sha256:d43980384673cb07d2f7d2d918c616b30c659c089ee23953f601d6609c67510e
    # via uv-build-repro
```

### Platform

Darwin 24.3.0 arm64

### Version

uv 0.7.3 (3c413f74b 2025-05-07)

### Python version

Python 3.10.17

---

_Label `bug` added by @soof-golan on 2025-05-12 10:37_

---

_Renamed from "git+https://dependency information is lost when using uv build with hatchling" to "wheels built by uv with git+https dependencies wrongly installs a package from PyPI with the same name" by @soof-golan on 2025-05-12 11:35_

---

_Comment by @charliermarsh on 2025-05-12 14:02_

`tool.uv.sources` are not applicable when building a wheel or installing from a pre-built wheel: https://docs.astral.sh/uv/concepts/projects/dependencies/#dependency-sources. `uv add` by default uses `tool.uv.sources`; you can use `uv add --raw-sources` to instead use PEP 508 syntax where possible

---

_Label `bug` removed by @charliermarsh on 2025-05-12 14:02_

---

_Label `question` added by @charliermarsh on 2025-05-12 14:02_

---

_Closed by @charliermarsh on 2025-05-13 13:14_

---

_Comment by @tsvikas on 2025-05-14 16:38_

> `tool.uv.sources` are not applicable when building a wheel or installing from a pre-built wheel: https://docs.astral.sh/uv/concepts/projects/dependencies/#dependency-sources. `uv add` by default uses `tool.uv.sources`; you can use `uv add --raw-sources` to instead use PEP 508 syntax where possible

Shouldn't the program fail to build or to publish if there is a non-applicable source? or at least show a warning to the user?


---
