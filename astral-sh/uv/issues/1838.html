<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Do not include `unsafe` dependencies in the compiled file unless some flag specified - astral-sh/uv #1838</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Do not include <code>unsafe</code> dependencies in the compiled file unless some flag specified</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1838">#1838</a>
        opened by <a href="https://github.com/drjackild">@drjackild</a>
        on 2024-02-21 22:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/drjackild">@drjackild</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>Hey guys, it's me again! ðŸ˜… <code>uv</code> includes some packages in the compiled file, which are considered <code>unsafe</code> (for example, <a href="https://peps.python.org/pep-0518/#rationale">PEP 518</a> specifically asking to not pin <code>setuptools</code> unless you know what you're doing). By default, <code>pip-tools</code> do not pin <code>setuptools</code>, <code>pip</code> and <code>distibute</code> packages (https://github.com/jazzband/pip-tools/blob/9d0a91a382748a68f86d58a9e086b46a9b7c74f7/piptools/utils.py#L11).</p>
<p>You could tweak this behaviour by those options:</p>
<pre><code>--allow-unsafe / --no-allow-unsafe
                                  Pin packages considered unsafe: distribute,
                                  pip, setuptools.

                                  WARNING: Future versions of pip-tools will
                                  enable this behavior by default. Use --no-
                                  allow-unsafe to keep the old behavior. It is
                                  recommended to pass the --allow-unsafe now
                                  to adapt to the upcoming change.
 --unsafe-package TEXT           Specify a package to consider unsafe; may be
                                  used more than once. Replaces default unsafe
                                  packages: distribute, pip, setuptools
</code></pre>
<p>Probably would be good to implement something in <code>uv</code>, wdyt?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-02-21 22:30</div>
            <div class="timeline-body"><p>Duplicate of https://github.com/astral-sh/uv/issues/1353 and https://github.com/astral-sh/uv/issues/1415</p>
<p>Not sure how PEP 518 is relevant here, that would apply to build environments. If you have a compiled lock file for your build environment I think you'd need <code>--no-build-isolation</code> or similar to get it to actually work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/drjackild">@drjackild</a> on 2024-02-21 22:42</div>
            <div class="timeline-body"><p>Ah, didn't search before creating an issue, sorry! Closing as duplicate</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @drjackild on 2024-02-21 22:42</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:23:55 UTC
    </footer>
</body>
</html>
