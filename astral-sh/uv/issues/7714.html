<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mismatch error introduced by #2484 makes it impossible to create some trivial packages - astral-sh/uv #7714</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Mismatch error introduced by #2484 makes it impossible to create some trivial packages</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/7714">#7714</a>
        opened by <a href="https://github.com/jsbueno">@jsbueno</a>
        on 2024-09-26 16:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jsbueno">@jsbueno</a></div>
            <div class="timeline-body"><p>Relative to issue  #2484</p>
<p>What is even the purpose of that artificial restriction?</p>
<p>Anyway, I don't think it is mimicking whatever PIP does (if it does):
To be specific - I am editting a package with</p>
<pre><code class="language-toml">[tool.setuptools]
# required named for package importing:
packages = [&quot;pgu&quot;]
 
@ ... 


[project]
# project name as published on pypi:
name = &quot;pygame-pgu&quot;
</code></pre>
<p>And <code>uv pip</code> fails with this mismatch error.</p>
<p>It installs without any issue with native pip.</p>
<p>I am ok if there is any workaround that could be set
in  a <code>[tool.uv] </code> session, but I obviously need a workaround, or fix -
this can't really be such an uncomon thing.  Just in the same
project I have to deal with <code>pygame-ce</code> which is imported
as <code>pygame</code> - but then the specifier is a suffix.
Thank you for taking the time to report an issue! We're glad to have you involved with uv.</p>
<p>My terminal output:</p>
<pre><code>(env312) [jsbueno@fedora pgu]$ uv pip install .
error: Failed to build: `pgu @ file:///home/jsbueno/projetos/pgu`
  Caused by: Package metadata name `pygame-pgu` does not match given name `pgu`
(env312) [jsbueno@fedora pgu]$ uv --version
uv 0.4.16
</code></pre>
<p>I am attaching the current pyproject.toml (being activelly modified) bellow</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsbueno">@jsbueno</a> on 2024-09-26 16:06</div>
            <div class="timeline-body"><pre><code class="language-toml">[build-system]
requires = [&quot;setuptools&quot;, &quot;wheel&quot;, &quot;setuptools-scm&gt;=8&quot;]
build-backend = &quot;setuptools.build_meta&quot;

[tool.setuptools]
include-package-data = true
packages = [&quot;pgu&quot;, &quot;pgu.scripts&quot;, &quot;pgu.examples&quot;, &quot;pgu.data&quot;]

[tool.setuptools.dynamic]
version = {attr = &quot;pgu.__version__&quot;}

[tool.setuptools.package-dir]
&quot;pgu&quot; = &quot;pgu&quot;
&quot;pgu.scripts&quot; = &quot;scripts&quot;
&quot;pgu.examples&quot; = &quot;examples&quot;
&quot;pgu.data&quot; = &quot;data&quot;

[project]
name = &quot;pygame-pgu&quot;
dynamic = [&quot;version&quot;]
description = &quot;Phil's Pygame Utilities - a collection of handy modules and scripts for PyGame.&quot;
readme = {file = &quot;README.md&quot;, content-type = &quot;text/markdown&quot;}
requires-python = &quot;&gt;= 3.8&quot;
dependencies = [
    &quot;pygame-ce &gt; 2.0&quot;
]
authors = [{ name = &quot;Joao S. O. Bueno&quot; }, { name = &quot;Peter Rogers&quot; }, { name = &quot;Phil Hassey&quot; }]
classifiers = [
    &quot;Development Status :: 5 - Production/Stable&quot;,
    &quot;Intended Audience :: Developers&quot;,
    &quot;Programming Language :: Python :: 3.8&quot;,
    &quot;Programming Language :: Python :: 3.9&quot;,
    &quot;Programming Language :: Python :: 3.10&quot;,
    &quot;Programming Language :: Python :: 3.11&quot;,
    &quot;Programming Language :: Python :: 3.12&quot;,
    &quot;Programming Language :: Python :: 3.13&quot;,
    &quot;Programming Language :: Python :: Implementation :: CPython&quot;,
    &quot;Programming Language :: Python :: Implementation :: PyPy&quot;,
    &quot;License :: OSI Approved :: GNU Lesser General Public License v3 or later (LGPLv3+)&quot;,
    &quot;Operating System :: OS Independent&quot;,
]

[project.urls]
repository = &quot;https://github.com/parogers/pgu&quot;


[project.optional-dependencies]
dev = []

[tool.pytest.ini_options]
testpaths = &quot;tests&quot;
python_files = &quot;test_*.py&quot;
python_functions = &quot;test_*&quot;
addopts = &quot;-v --doctest-modules&quot;

[tool.mypy]
mypy_path = &quot;typecheck&quot;
implicit_reexport = true
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-26 16:19</div>
            <div class="timeline-body"><p>Can you share the output of running with<code> --verbose</code>? The invocation you'd want to see is <code>pygame-pgu @ file:///home/jsbueno/projetos/pgu</code> -- <code>pgu @ file:///home/jsbueno/projetos/pgu</code> is legitimately wrong.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2024-09-26 16:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsbueno">@jsbueno</a> on 2024-09-26 18:14</div>
            <div class="timeline-body"><p>Thanks  -
The thing is then putting the project name separated by an <code>@</code> of the project location - typing in
<code>uv install &quot;pygame-pgu @ .&quot;</code>  worked for me</p>
<p>So I am ok if you consider this can be  closed now - but the behavior from <code>pip</code> still differs - <code>pip install .</code>, without the project name just works.</p>
<p>Attaching the run with verbose next.  (different machine and venv)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsbueno">@jsbueno</a> on 2024-09-26 18:14</div>
            <div class="timeline-body"><p><a href="https://github.com/user-attachments/files/17153971/uv_pip_verbose.txt">uv_pip_verbose.txt</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-26 18:23</div>
            <div class="timeline-body"><p>It looks like you have a <code>PKG-INFO</code> file in the directory that lists the name as <code>pgu</code>. Is that true?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-26 18:23</div>
            <div class="timeline-body"><p>(Also, is this open-source? Can I test with it?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsbueno">@jsbueno</a> on 2024-09-26 20:12</div>
            <div class="timeline-body"><p>Yes, there is indeed a PKG-INFO file there.</p>
<p>The project is here: https://github.com/parogers/pgu  -
I have had commit access there for a while, and this week I took it to &quot;ressurect&quot; the thing - as it provide some tooling for pygame that is not widely available.</p>
<p>I am setting up the shift to pyproject.toml in the &quot;pyproject&quot; branch - https://github.com/parogers/pgu/tree/pyproject</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-28 19:08</div>
            <div class="timeline-body"><p>The issue is that <code>PKG-INFO</code> lists <code>Name: pgu</code>. But, isn't that incorrect? That's not the name of the package.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:27:21 UTC
    </footer>
</body>
</html>
