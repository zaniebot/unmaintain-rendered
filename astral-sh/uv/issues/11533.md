```yaml
number: 11533
title: uv has different behaviour compared to python for brotli
type: issue
state: closed
author: SerJaimeLannister
labels:
  - needs-mre
assignees: []
created_at: 2025-02-15T09:18:45Z
updated_at: 2025-03-14T00:42:06Z
url: https://github.com/astral-sh/uv/issues/11533
synced_at: 2026-01-10T01:57:26Z
```

# uv has different behaviour compared to python for brotli

---

_Issue opened by @SerJaimeLannister on 2025-02-15 09:18_

### Summary
This is where UV isn't working and python is
![Image](https://github.com/user-attachments/assets/89aca3de-c037-47d3-bf6c-bb7a99d731d6)
This is where python gives an error yet Uv can create brotli file which if I remember correctly just brotli's the python file itself I think
![Image](https://github.com/user-attachments/assets/a01c16a2-5579-40b7-a306-f34325067f6d)

This is where seemingly  both work
![Image](https://github.com/user-attachments/assets/532ad357-687c-463c-a6db-b2aa1592a9de)

I can provide non visual scripts as well if that could help , I used it because as you can see replicating things caused multiple bugs (where one worked and other didn't so I thought of recording the terminal )
### Platform

ArchLinux

### Version

uv 0.5.25 (9c07c3fc5 2025-01-28)

### Python version

Python 3.12.8

---

_Label `bug` added by @SerJaimeLannister on 2025-02-15 09:18_

---

_Comment by @charliermarsh on 2025-02-15 13:56_

I'm really sorry, I'm having trouble following what's going on here. Could you provide a sequence of commands (as text) that I can use to reproduce, along with any test files you're using and a description of the expected behavior vs. the experienced behavior?

---

_Label `bug` removed by @charliermarsh on 2025-02-15 13:56_

---

_Label `needs-mre` added by @charliermarsh on 2025-02-15 13:56_

---

_Comment by @SerJaimeLannister on 2025-02-15 14:41_

https://github.com/SerJaimeLannister/uv-bug

Created a repository for this.

Try to run each of them by 
A) Installing python & brotli & urllib3 (In my case , since I am on archlinux , I did it by sudo pacman -S python-brotli python-urllib3 & run them directly via python 1.py or 2.py and so on
B) Try running them via uv run --with=urllib3 brotli <python filename>.py

Also note that there is a certain example (2.py) where you don't need urllib3 , so maybe if you face an error with this uv command try removing urllib3 from uv run command 

---

_Comment by @zanieb on 2025-02-15 15:58_

It looks like you're running `uv run --with=brotli urllib main-bug.py` in which case we think the command is `urllib` and fail.

You need to repeat `--with`

```
‚ùØ uv run --with brotli --with urllib3 python -c "import urllib3; import brotli"
Installed 2 packages in 8ms
```

---

_Closed by @charliermarsh on 2025-03-14 00:41_

---

_Comment by @charliermarsh on 2025-03-14 00:42_

Closing due to lack of follow-up but happy to help if it gets revived.

---
