<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`python -m pip install uv` does not install stub - `pip install uv` does - astral-sh/uv #2486</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>python -m pip install uv</code> does not install stub - <code>pip install uv</code> does</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2486">#2486</a>
        opened by <a href="https://github.com/bersbersbers">@bersbersbers</a>
        on 2024-03-16 12:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bersbersbers">@bersbersbers</a></div>
            <div class="timeline-body"><p>I am not even sure this is a bug in <code>uv</code> (rather than in <code>pip</code> or <code>pyenv</code>), but since I have never noticed such behavior (e.g., with <code>pylint</code>), I thought it made sense to report it.</p>
<p>Basically, <code>python -m pip install uv</code> behaves different from <code>pip install uv</code> in installing a <code>uv</code> executable with <code>pyenv</code>, see below:</p>
<pre><code>(project_3.12) bers@hostname:/mnt/c/ws/project$ which python
/home/bers/.pyenv/shims/python

(project_3.12) bers@hostname:/mnt/c/ws/project$ python --version
Python 3.12.1

(project_3.12) bers@hostname:/mnt/c/ws/project$ uv
-bash: /home/bers/.pyenv/shims/uv: No such file or directory

(project_3.12) bers@hostname:/mnt/c/ws/project$ python -m uv
/home/bers/.pyenv/versions/project_3.12/bin/python3: No module named uv

(project_3.12) bers@hostname:/mnt/c/ws/project$ python -m pip install uv
Collecting uv
  Using cached uv-0.1.21-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (25 kB)
Using cached uv-0.1.21-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.1 MB)
Installing collected packages: uv
Successfully installed uv-0.1.21

(project_3.12) bers@hostname:/mnt/c/ws/project$ uv
-bash: /home/bers/.pyenv/shims/uv: No such file or directory

(project_3.12) bers@hostname:/mnt/c/ws/project$ python -m uv
Usage: uv [OPTIONS] &lt;COMMAND&gt;

Commands:
  pip      Resolve and install Python packages
  venv     Create a virtual environment
  cache    Manage the cache
  version  Display uv&#x27;s version
  help     Print this message or the help of the given subcommand(s)

Options:
  -q, --quiet                  Do not print any output
  -v, --verbose...             Use verbose output
      --color &lt;COLOR&gt;          Control colors in output [default: auto] [possible values: auto, always, never]
      --native-tls             Whether to load TLS certificates from the platform&#x27;s native certificate store [env: UV_NATIVE_TLS=]
  -n, --no-cache               Avoid reading from or writing to the cache [env: UV_NO_CACHE=]
      --cache-dir &lt;CACHE_DIR&gt;  Path to the cache directory [env: UV_CACHE_DIR=]
  -h, --help                   Print help (see more with &#x27;--help&#x27;)
  -V, --version                Print version

(project_3.12) bers@hostname:/mnt/c/ws/project$ pip install uv
Requirement already satisfied: uv in /home/bers/.pyenv/versions/project_3.12/lib/python3.12/site-packages (0.1.21)

(project_3.12) bers@hostname:/mnt/c/ws/project$ uv
Usage: uv [OPTIONS] &lt;COMMAND&gt;

Commands:
  pip      Resolve and install Python packages
  venv     Create a virtual environment
  cache    Manage the cache
  version  Display uv&#x27;s version
  help     Print this message or the help of the given subcommand(s)

Options:
  -q, --quiet                  Do not print any output
  -v, --verbose...             Use verbose output
      --color &lt;COLOR&gt;          Control colors in output [default: auto] [possible values: auto, always, never]
      --native-tls             Whether to load TLS certificates from the platform&#x27;s native certificate store [env: UV_NATIVE_TLS=]
  -n, --no-cache               Avoid reading from or writing to the cache [env: UV_NO_CACHE=]
      --cache-dir &lt;CACHE_DIR&gt;  Path to the cache directory [env: UV_CACHE_DIR=]
  -h, --help                   Print help (see more with &#x27;--help&#x27;)
  -V, --version                Print version
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-18 03:16</div>
            <div class="timeline-body"><p>Is it possible that this worked prior to v0.1.19? If so, it might be fixed by <a href="https://github.com/astral-sh/uv/pull/2503">astral-sh/uv#2503</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-03-18 08:30</div>
            <div class="timeline-body"><blockquote>
<p>Is it possible that this worked prior to v0.1.19?</p>
</blockquote>
<p>Doesn&#x27;t look like it:</p>
<pre><code>(project_3.12) bers@hostname:/mnt/c/ws/project$ uv --version
-bash: uv: command not found

(project_3.12) bers@hostname:/mnt/c/ws/project$ python -m pip install uv==0.1.19
Collecting uv==0.1.19
  Downloading uv-0.1.19-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (25 kB)
Downloading uv-0.1.19-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.0/11.0 MB 9.6 MB/s eta 0:00:00
Installing collected packages: uv
Successfully installed uv-0.1.19

(project_3.12) bers@hostname:/mnt/c/ws/project$ uv --version
-bash: uv: command not found

(project_3.12) bers@hostname:/mnt/c/ws/project$ python -m pip install uv==0.1.18
Collecting uv==0.1.18
  Downloading uv-0.1.18-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (23 kB)
Downloading uv-0.1.18-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 11.0/11.0 MB 13.5 MB/s eta 0:00:00
Installing collected packages: uv
  Attempting uninstall: uv
    Found existing installation: uv 0.1.19
    Uninstalling uv-0.1.19:
      Successfully uninstalled uv-0.1.19
Successfully installed uv-0.1.18

(project_3.12) bers@hostname:/mnt/c/ws/project$ uv --version
-bash: uv: command not found

(project_3.12) bers@hostname:/mnt/c/ws/project$ python -m pip install uv==0.1.1
Collecting uv==0.1.1
  Downloading uv-0.1.1-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (16 kB)
Downloading uv-0.1.1-py3-none-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (10.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 10.1/10.1 MB 5.2 MB/s eta 0:00:00
Installing collected packages: uv
  Attempting uninstall: uv
    Found existing installation: uv 0.1.18
    Uninstalling uv-0.1.18:
      Successfully uninstalled uv-0.1.18
Successfully installed uv-0.1.1

(project_3.12) bers@hostname:/mnt/c/ws/project$ uv --version
-bash: uv: command not found

(project_3.12) bers@hostname:/mnt/c/ws/project$ pip install uv==0.1.1
Requirement already satisfied: uv==0.1.1 in /home/bers/.pyenv/versions/project_3.12/lib/python3.12/site-packages (0.1.1)
</code></pre>
<blockquote>
<p>If so, it might be fixed by #2503.</p>
</blockquote>
<p>I found the binaries in https://github.com/astral-sh/uv/actions/runs/8320517237, but how can I try with pip installation using those? :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-22 13:33</div>
            <div class="timeline-body"><p>Do you mind re-resting?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-05-24 09:22</div>
            <div class="timeline-body"><p>Thanks, will retest in early June.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-06-01 06:50</div>
            <div class="timeline-body"><p>I can still reproduce the problem (Python 3.12.3, uv 0.2.5).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-28 00:50</div>
            <div class="timeline-body"><p>I think you need to activate the virtual environment here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-07-28 06:54</div>
            <div class="timeline-body"><p>Unlikely - I use <code>PIP_REQUIRE_VIRTUALENV</code> everywhere. But I can re-test again in two weeks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-08-10 18:42</div>
            <div class="timeline-body"><p>I can still reproduce this with <code>pip==24.2</code> and <code>uv==0.2.35</code>. Virtual env is activated (in fact, <code>PIP_REQUIRE_VIRTUALENV</code> is set).</p>
<p>Both</p>
<pre><code>python -m pip uninstall -y pip &amp;&amp; python -m ensurepip &amp;&amp; python -m pip install -U pip==24.2 &amp;&amp; pip uninstall -y uv &amp;&amp; python -m pip install uv &amp;&amp; uv
</code></pre>
<p>and</p>
<pre><code>python -m pip uninstall -y pip &amp;&amp; python -m ensurepip &amp;&amp; python -m pip install -U pip==24.2 &amp;&amp; python -m pip uninstall -y uv &amp;&amp; python -m pip install uv &amp;&amp; uv
</code></pre>
<p>sometimes fail like this:</p>
<pre><code>...
-bash: /home/bers/.pyenv/shims/uv: No such file or directory
</code></pre>
<p>Interestingly, it always works this way:</p>
<pre><code>python -m pip uninstall -y pip &amp;&amp; python -m ensurepip &amp;&amp; python -m pip install -U pip==24.2 &amp;&amp; python -m pip uninstall -y uv &amp;&amp; pip install uv &amp;&amp; uv 
</code></pre>
<p>and once it works this way, the above two commands also work. So there must be some additional state that causes breakage.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-10 18:50</div>
            <div class="timeline-body"><p>Hmm ok, I ran the first command without issue just now. I&#x27;m guessing it&#x27;s something to do with the pyenv interaction...?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-08-11 07:28</div>
            <div class="timeline-body"><p>May well be, yes. Unfortunately, I do not use system python anywhere and would like to avoid polluting my system with all the dependencies that come with it, so I cannot compare. But I was able to come up with very simple reproduction steps on another, clean WSL instance (in terms of Python):</p>
<pre><code>curl https://pyenv.run | bash
# manipulate ~/.profile as instructed by the above command and restart shell

pyenv install 3
pyenv global 3
python -m pip install uv
uv --version # does not work

python -m pip uninstall -y uv
pip install uv
uv --version # works
</code></pre>
<p>So whatever state makes the commands above sometimes work and sometimes not, installing <code>pyenv</code> from scratch is close to the &quot;broken&quot; state.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-11 15:11</div>
            <div class="timeline-body"><p>Is this issue specific to uv? The reproduction you just shared seems entirely unrelated to our behaviors — i.e. it&#x27;s pip and pyenv&#x27;s job to properly install uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-08-11 15:25</div>
            <div class="timeline-body"><blockquote>
<p>The reproduction you just shared seems entirely unrelated to our behaviors — i.e. it&#x27;s pip and pyenv&#x27;s job to properly install uv.</p>
</blockquote>
<p>Agreed.</p>
<blockquote>
<p>Is this issue specific to uv?</p>
</blockquote>
<p>I thought so, and I remember that I tested <code>black</code> and <code>pylint</code> before, and saw the same thing. But maybe I was falling for the randomness of the issue, and it was simply working for <code>black</code> and <code>pyint</code> because they had been installed and brought into the &quot;working&quot; state before.</p>
<p>Long story short: with the above reproduction steps, in a clean environment, I can reproduce the same behavior with <code>black</code> and <code>pylint</code> now. Thanks for following up!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-08-11 15:38</div>
            <div class="timeline-body"><p>Follow <a href="https://github.com/pypa/pip/issues/12909">pypa/pip#12909</a> if interested.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-08-11 15:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:30:28 UTC
    </footer>
</body>
</html>
