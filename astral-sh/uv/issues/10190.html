<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`error decoding response body` when resolving dependencies from aws codeartifact repo since 0.5.12 - astral-sh/uv #10190</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`error decoding response body` when resolving dependencies from aws codeartifact repo since 0.5.12</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10190">#10190</a>
        opened by <a href="https://github.com/okan-agca-entrix">@okan-agca-entrix</a>
        on 2024-12-27 09:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/okan-agca-entrix">@okan-agca-entrix</a> on 2024-12-27 09:34</div>
            <div class="timeline-body"><p>Hello,
I'm encountering a new error since upgrading to <code>0.5.12</code> while running <code>uv sync</code>. The setup is described below. The error is not present with version <code>0.5.11</code> of uv. If there are migration steps I missed, would be happy if you can direct me there. Had a brief look at the release notes but didn't see anything relevant.</p>
<p>Error Message from Github Actions:</p>
<pre><code>Using CPython 3.12.8 interpreter at: /opt/hostedtoolcache/Python/3.12.8/x64/bin/python3
Creating virtual environment at: .venv
error: Failed to generate package metadata for `*****`
  Caused by: Failed to resolve requirements from `build-system.requires`
  Caused by: No solution found when resolving: `hatchling`, `hatch-vcs`
  Caused by: Failed to fetch: `https://***-***.d.codeartifact.eu-west-1.amazonaws.com/pypi/***/simple/hatchling/`
  Caused by: error decoding response body
  Caused by: there are extra bytes after body has been decompressed
Error: Process completed with exit code 2.
</code></pre>
<p>Setup:
The code artifact url is setup in the pyproject toml</p>
<pre><code class="language-[[tool.uv.index]]">name = &quot;aws-code&quot;
url = &quot;https://***-***.d.codeartifact.eu-west-1.amazonaws.com/pypi/***/simple/&quot;
</code></pre>
<p>The credentials are setup as environment variables as documented here: https://docs.astral.sh/uv/guides/integration/alternative-indexes/#aws-codeartifact</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/olafdeleeuw">@olafdeleeuw</a> on 2024-12-27 10:15</div>
            <div class="timeline-body"><p>I can confirm same error occurs with Azure Artifacts. With v0.5.11 dependencies from our private Azure Artifacts library were installed by <code>uv</code>. Now, with v0.5.12 I get the same error as @okan-agca-entrix .</p>
<pre><code>Creating virtual environment at: .venv
Resolved 128 packages in 1ms
  × Failed to build `emd-client @ file:///home/vsts/work/1/s`
  ├─▶ Failed to resolve requirements from `build-system.requires`
  ├─▶ No solution found when resolving: `hatchling`
  ├─▶ Failed to fetch:
  │   `[https://***.pkgs.visualstudio.com/***/_packaging/***/pypi/simple/hatchling/`](https://***.pkgs.visualstudio.com/***/_packaging/***/pypi/simple/hatchling/%60)
  ├─▶ error decoding response body
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kyriakost">@kyriakost</a> on 2024-12-27 12:02</div>
            <div class="timeline-body"><p>Can verify the error</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thiago-pythonic">@thiago-pythonic</a> on 2024-12-27 12:50</div>
            <div class="timeline-body"><p>Error happens with Gitlab package registry:</p>
<pre><code>Using Python 3.8.10 environment at: virtualenvs/***
error: Failed to fetch: `https://gitlab.com/api/v4/groups/***/-/packages/pypi/simple/***/`
  Caused by: error decoding response body
  Caused by: there are extra bytes after body has been decompressed
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-27 13:36</div>
            <div class="timeline-body"><p>Sorry -- this is a bug in <code>reqwests</code> that I fixed last night (#10187), but didn't realize that the subsequent release failed. I'll get it out now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/10191.html">astral-sh/uv#10191</a> on 2024-12-27 13:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-12-27 13:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-12-27 13:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/olafdeleeuw">@olafdeleeuw</a> on 2024-12-27 13:52</div>
            <div class="timeline-body"><p>No problem. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-27 14:02</div>
            <div class="timeline-body"><p>This should be fixed in v0.5.13.</p>
<p>If you're on v0.5.12, you may need to reinstall with cURL rather than via <code>uv self update</code>:</p>
<pre><code class="language-shell">curl -LsSf https://astral.sh/uv/install.sh | sh
</code></pre>
<p>Sorry for the inconvenience! It's my mistake for going to bed without double-checking the release pipeline.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-12-27 14:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thiago-pythonic">@thiago-pythonic</a> on 2024-12-27 14:06</div>
            <div class="timeline-body"><p>Thanks for the quick turnaround! 0.5.13 works just fine!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/olafdeleeuw">@olafdeleeuw</a> on 2024-12-27 14:07</div>
            <div class="timeline-body"><p>Thanks! Also with Azure Artifacts. Everything works fine again with 0.5.13.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flipdazed">@flipdazed</a> on 2024-12-29 21:43</div>
            <div class="timeline-body"><p>out of interest is there any way you can maintain previous versions in <code>homebrew</code> just in case there is a problem like this again? This caused us a bit of havoc because <code>brew</code> doesn't maintain any old versions</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-29 22:52</div>
            <div class="timeline-body"><p>Hmm, I think that's ultimately up to Homebrew, since I didn't do anything specific to have it <em>not</em> publish to Homebrew. It's possible that the releases were just too close together, and so Homebrew never built and uploaded 0.5.12?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:56 UTC
    </footer>
</body>
</html>
