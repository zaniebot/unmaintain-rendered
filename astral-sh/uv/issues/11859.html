<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inverting a requirements.txt - astral-sh/uv #11859</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Inverting a requirements.txt</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11859">#11859</a>
        opened by <a href="https://github.com/EricDepagne">@EricDepagne</a>
        on 2025-02-28 15:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/EricDepagne">@EricDepagne</a></div>
            <div class="timeline-body">Summary
<p>I have inherited a project that was built without a requirements.in file, and the only thing I have is the list of installed packages.
To create the requirements.txt, my current strategy (and probably the only one currently), is to add packages in a requirements.in file, compile it and compare it to the list of installed packages, until I have them all.</p>
<p>I was wondering if it would be possible to have uv do that task for me.</p>
Example
<p><code>uv pip compile requirements.in </code> produces a requirements.txt.
<code>uv pip list --format freeze &gt; Reqs.txt</code> generates a list of all the modules installed in the virtual environment.
<code>uv pip compile --invert Reqs.txt -o requirements.in</code> could generate the requirements.in file that would produce requirements.txt when used with <code>uv pip compile</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/EricDepagne">@EricDepagne</a> on 2025-02-28 15:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-28 17:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-28 17:48</div>
            <div class="timeline-body"><p>I don&#x27;t think this is possible, e.g., given</p>
<pre><code>❯ echo &quot;anyio&gt;0.1.0&quot; | uv pip compile -
Resolved 3 packages in 77ms
# This file was autogenerated by uv via the following command:
#    uv pip compile -
anyio==4.8.0
idna==3.10
    # via anyio
sniffio==1.3.1
    # via anyio
</code></pre>
<p>We don&#x27;t retain the version constraints.</p>
<p>We also lose track of first-order dependencies, e.g., this does not show that <code>idna</code> was explicitly requested</p>
<pre><code>❯ echo &quot;anyio&gt;0.1.0\nidna&quot; | uv pip compile -
Resolved 3 packages in 1ms
# This file was autogenerated by uv via the following command:
#    uv pip compile -
anyio==4.8.0
idna==3.10
    # via anyio
sniffio==1.3.1
    # via anyio
</code></pre>
<p>Your best bet is probably to take all the packages with comments after them, and drop them. Then take the remaining packages and change <code>==</code> to <code>&gt;=</code>. e.g., the above would become</p>
<pre><code>anyio&gt;=4.8.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EricDepagne">@EricDepagne</a> on 2025-02-28 18:06</div>
            <div class="timeline-body"><p>Thanks @zanieb for the explanation.
The list I have just lists the package and the version, coming from <code>uv pip list --format freeze</code> :</p>
<pre><code>[snip]
pillow               10.4.0
pip                  24.3.1
[snip]
</code></pre>
<p>Then,<code>using</code>uv pip show ` I know if a package is required by another or not, so in the file becomes after manually editing each line:</p>
<pre><code>[snip]
pillow               10.4.0
    bokeh, matplotlib
pip                  24.3.1

[snip]

</code></pre>
<p>My plan is then to find what are the packages that install all other (those who do not require any package to be installed), and then put those in my <code>requirements.in</code>.
I thought that as <code>uv</code> could do that :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EricDepagne">@EricDepagne</a> on 2025-02-28 18:09</div>
            <div class="timeline-body"><p>That said, I see with another package that my strategy will probably not work, as there are some circular dependencies:</p>
<pre><code>poetry               1.8.3
    poetry-plugin-export
poetry-core          1.9.0
    poetry, poetry-plugin-export
poetry-plugin-export 1.8.0
    poetry
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/EricDepagne">@EricDepagne</a> on 2025-03-01 15:23</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:37:33 UTC
    </footer>
</body>
</html>
