<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV ignores PIP_INDEX_URL? - astral-sh/uv #2183</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UV ignores PIP_INDEX_URL?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2183">#2183</a>
        opened by <a href="https://github.com/david-waterworth">@david-waterworth</a>
        on 2024-03-04 22:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/david-waterworth">@david-waterworth</a></div>
            <div class="timeline-body"><p>We use AWS code-artifact as a private PyPi repository. Different tools (poetry/pip etc) have different mechanisms for controlling where to install from, i.e. for pip you need to set</p>
<pre><code class="language-bash">PIP_INDEX_URL=&quot;https://aws:${CODEARTIFACT_AUTH_TOKEN}@${domain}-${account}.d.codeartifact.${region}.amazonaws.com/pypi/${repository}/simple/&quot;
</code></pre>
<p>I did a quick test of <code>uv</code> - I like what I see so far but first without <code>--verbose</code> it doesn't tell me the index url where packages are being installed from. I think this is useful in cases where users are using a private index.</p>
<p>Setting  <code>--verbose</code>  it seems that it's ignoring <code>PIP_INDEX_URL</code>, i.e. <code>uv pip install torch --verbose</code></p>
<pre><code> uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/home/dave/.cache/uv/wheels-v0/pypi/nvidia-cusparse-cu12/nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.http
 uv_client::cached_client::from_path_sync path=&quot;/home/dave/.cache/uv/wheels-v0/pypi/nvidia-cusparse-cu12/nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.http&quot;
   uv_installer::downloader::get_wheel name=triton==2.2.0, size=Some(167900779), url=&quot;https://files.pythonhosted.org/packages/95/05/ed974ce87fe8c8843855daa2136b3409ee1c126707ab54a8b72815c08b49/triton-2.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot;
     uv_distribution::distribution_database::get_or_build_wheel dist=Built(Registry(RegistryBuiltDist { filename: WheelFilename { name: PackageName(&quot;triton&quot;), version: &quot;2.2.0&quot;, python_tag: [&quot;cp310&quot;], abi_tag: [&quot;cp310&quot;], platform_tag: [&quot;manylinux_2_17_x86_64&quot;, &quot;manylinux2014_x86_64&quot;] }, file: File { dist_info_metadata: Some(Hashes(Hashes { md5: None, sha256: Some(&quot;2039905bfe08510b724a9b3d16ff8d087889914358fda23faf669cc51efaa4dd&quot;) })), filename: &quot;triton-2.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot;, hashes: Hashes { md5: None, sha256: Some(&quot;a2294514340cfe4e8f4f9e5c66c702744c4a117d25e618bd08469d0bfed1e2e5&quot;) }, requires_python: None, size: Some(167900779), upload_time_utc_ms: Some(1704856316576), url: AbsoluteUrl(&quot;https://files.pythonhosted.org/packages/95/05/ed974ce87fe8c8843855daa2136b3409ee1c126707ab54a8b72815c08b49/triton-2.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot;), yanked: Some(Bool(false)) }, index: Pypi(VerbatimUrl { url: Url { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }) }))
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
</code></pre>
<p>It looks like its downloading from <code>https://files.pythonhosted.org</code> and not AWS. Is there an alternative mechanism for setting PIP_INDEX_URL globally?</p>
<p>Also in passing, the default timeout of 300s isn't long enough to install torch.</p>
<pre><code>error: Failed to download distributions
  Caused by: Failed to fetch wheel: torch==2.2.1
  Caused by: Failed to extract source distribution
  Caused by: Failed to download distribution due to network timeout. Try increasing UV_HTTP_TIMEOUT (current value: 300s).
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-04 22:27</div>
            <div class="timeline-body"><p>Hi! You can use <code>UV_INDEX_URL</code> instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-04 22:28</div>
            <div class="timeline-body"><p>This is a duplicate of https://github.com/astral-sh/uv/issues/1535 â€” you can see more discussion there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-03-04 22:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by @zanieb on 2024-03-04 22:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-03-04 22:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:24:12 UTC
    </footer>
</body>
</html>
