<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip install does not conform to PEP-721 - astral-sh/uv #12163</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv pip install does not conform to PEP-721</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/12163">#12163</a>
        opened by <a href="https://github.com/calebbrown">@calebbrown</a>
        on 2025-03-14 03:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/calebbrown">@calebbrown</a> on 2025-03-14 03:03</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I was testing the behaviour of <code>pip</code> and <code>uv</code> when extracting a sdist package containing a symlink with an absolute path outside the destination.</p>
<p>When I run <code>pip install package.tgz</code> I get the error:</p>
<p><code>ERROR: Invalid member in the tar file package.tgz: 'somefile' is a link to an absolute path</code> (where <code>somefile</code> is a symlink to say <code>/etc/profile</code>)</p>
<p>However, when I run <code>uv pip install package.tgz</code> the package happily installs.</p>
<p>According to PEP-721 and the spec (https://packaging.python.org/en/latest/specifications/source-distribution-format/#sdist-archive-features) the behavior of uv is not correct:</p>
<blockquote>
<p>Tools that do not use the data filter directly (e.g. for backwards compatibility, allowing additional features, or not using Python) MUST follow this section. (At the time of this writing, the data filter also follows this section, but it may get out of sync in the future.)</p>
<p>The following files are invalid in an sdist archive. Upon encountering such an entry, tools SHOULD notify the user, MUST NOT unpack the entry, and MAY abort with a failure:</p>
<ul>
<li>Files that would be placed outside the destination directory.</li>
<li>Links (symbolic or hard) pointing outside the destination directory.</li>
<li>Device files (including pipes).</li>
</ul>
</blockquote>
<h3>Platform</h3>
<p>Darwin 24.3.0 arm64</p>
<h3>Version</h3>
<p>uv 0.6.6 (c1a0bb85e 2025-03-12)</p>
<h3>Python version</h3>
<p>Python 3.13.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @calebbrown on 2025-03-14 03:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-14 15:00</div>
            <div class="timeline-body"><p>Interesting, thanks! We can fix that. For reference, we do disallow symlinks that would result in <em>writing</em> outside of the target directory (which would be exploitable).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-03-14 15:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/tokio-tar/pulls/46.html">astral-sh/tokio-tar#46</a> on 2025-03-14 17:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/12259.html">astral-sh/uv#12259</a> on 2025-03-18 02:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-07-22 13:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/14897.html">astral-sh/uv#14897</a> on 2025-07-25 18:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
