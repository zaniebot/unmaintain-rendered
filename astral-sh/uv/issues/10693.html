<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyTorch nightly inconsistency between `uv pip install` vs `uv sync` (missing nvidia packages) - astral-sh/uv #10693</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>PyTorch nightly inconsistency between `uv pip install` vs `uv sync` (missing nvidia packages)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/10693">#10693</a>
        opened by <a href="https://github.com/tmm1">@tmm1</a>
        on 2025-01-16 20:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/tmm1">@tmm1</a> on 2025-01-16 20:06</div>
            <div class="timeline-body"><p>in https://github.com/astral-sh/uv/issues/2541#issuecomment-2487052583, <code>uv pip install</code> was fixed for torch-nightly:</p>
<pre><code class="language-console">$ uv venv
$ uv pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/nightly/cu126
Resolved 27 packages in 637ms
Prepared 9 packages in 23.32s
Installed 27 packages in 42.07s
 + filelock==3.16.1
 + fsspec==2024.10.0
 + jinja2==3.1.4
 + markupsafe==2.1.5
 + mpmath==1.3.0
 + networkx==3.4.2
 + numpy==2.1.2
 + nvidia-cublas-cu12==12.6.4.1
 + nvidia-cuda-cupti-cu12==12.6.80
 + nvidia-cuda-nvrtc-cu12==12.6.77
 + nvidia-cuda-runtime-cu12==12.6.77
 + nvidia-cudnn-cu12==9.5.1.17
 + nvidia-cufft-cu12==11.3.0.4
 + nvidia-curand-cu12==10.3.7.77
 + nvidia-cusolver-cu12==11.7.1.2
 + nvidia-cusparse-cu12==12.5.4.2
 + nvidia-cusparselt-cu12==0.6.3
 + nvidia-nccl-cu12==2.21.5
 + nvidia-nvjitlink-cu12==12.6.85
 + nvidia-nvtx-cu12==12.6.77
 + pillow==11.0.0
 + pytorch-triton==3.2.0+git0d4682f0
 + sympy==1.13.1
 + torch==2.7.0.dev20250116+cu126
 + torchaudio==2.6.0.dev20250116+cu126
 + torchvision==0.22.0.dev20250116+cu126
 + typing-extensions==4.12.2
</code></pre>
<p>and in https://github.com/astral-sh/uv/issues/9651#issuecomment-2571833461, <code>uv sync</code> was fixed for torch-nightly:</p>
<pre><code class="language-toml">[project]
name = &quot;torchnightly&quot;
requires-python = &quot;&gt;=3.11.9&quot;
dependencies = [
    &quot;torch&quot;,
    &quot;torchao&quot;,
    &quot;torchaudio&quot;,
    &quot;torchvision&quot;,
]
dynamic = [&quot;version&quot;]

[tool.uv.sources]
torch = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchvision = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchaudio = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchao = [{ index = &quot;pytorch-nightly-cu126&quot; }]

[[tool.uv.index]]
name = &quot;pytorch-nightly-cu126&quot;
url = &quot;https://download.pytorch.org/whl/nightly/cu126&quot;
explicit = true
</code></pre>
<pre><code class="language-console">$ uv sync
Using CPython 3.11.9
Creating virtual environment at: .venv
‚†ã Resolving dependencies...
warning: Missing version constraint (e.g., a lower bound) for `torch`
warning: Missing version constraint (e.g., a lower bound) for `torchao`
warning: Missing version constraint (e.g., a lower bound) for `torchaudio`
warning: Missing version constraint (e.g., a lower bound) for `torchvision`
Resolved 19 packages in 8.01s
Prepared 3 packages in 1m 03s
Installed 14 packages in 38.06s
 + filelock==3.16.1
 + fsspec==2024.12.0
 + jinja2==3.1.5
 + markupsafe==3.0.2
 + mpmath==1.3.0
 + networkx==3.4.2
 + numpy==2.2.1
 + pillow==11.1.0
 + sympy==1.13.1
 + torch==2.7.0.dev20250116+cu126
 + torchao==0.8.0.dev20250116+cu126
 + torchaudio==2.6.0.dev20250116+cu126
 + torchvision==0.22.0.dev20250116+cu126
 + typing-extensions==4.12.2
</code></pre>
<p>however, notice how both produce different results</p>
<pre><code class="language-diff">-Installed 27 packages in 42.07s
+Installed 14 packages in 38.06s
</code></pre>
<p>in the <code>uv sync</code>/<code>pyproject.toml</code> version, the nvidia packages are missing causing runtime failures.</p>
<p>cc @charliermarsh https://github.com/astral-sh/uv/issues/10119#issuecomment-2595958499</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-16 20:09</div>
            <div class="timeline-body"><p>I'm not surprised these are different.</p>
<p>In the first, you set <code>--index-url https://download.pytorch.org/whl/nightly/cu126</code> which makes that the default index for all packages.</p>
<p>In the latter, you set</p>
<pre><code>[tool.uv.sources]
torch = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchvision = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchaudio = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchao = [{ index = &quot;pytorch-nightly-cu126&quot; }]

[[tool.uv.index]]
name = &quot;pytorch-nightly-cu126&quot;
url = &quot;https://download.pytorch.org/whl/nightly/cu126&quot;
explicit = true
</code></pre>
<p>which only uses that index for those exact packages due to <code>explicit = true</code>.</p>
<p>The first also performs single-platform resolution while the latter does a universal resolution.</p>
<p>Can you share your lockfile?</p>
<p>What platform are you on?</p>
<p>Can you reproduce in a Dockerfile?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmm1">@tmm1</a> on 2025-01-16 20:48</div>
            <div class="timeline-body"><p>I'm on linux. Not using docker. Removing <code>explicit = true</code> didn't make a difference.</p>
<details>
<summary>uv.lock</summary>

<pre><code>version = 1
requires-python = &quot;&gt;=3.11.9&quot;
resolution-markers = [
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &gt;= '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &gt;= '3.12' and sys_platform != 'linux')&quot;,
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &lt; '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &lt; '3.12' and sys_platform != 'linux')&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
]

[[package]]
name = &quot;filelock&quot;
version = &quot;3.16.1&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/filelock-3.16.1-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;fsspec&quot;
version = &quot;2024.10.0&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/fsspec-2024.10.0-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;jinja2&quot;
version = &quot;3.1.4&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
dependencies = [
    { name = &quot;markupsafe&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/Jinja2-3.1.4-py3-none-any.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/jinja2-3.1.4-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;markupsafe&quot;
version = &quot;2.1.5&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
sdist = { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5.tar.gz&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp311-cp311-macosx_10_9_universal2.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp311-cp311-macosx_10_9_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp311-cp311-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp312-cp312-macosx_10_9_universal2.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp312-cp312-macosx_10_9_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp312-cp312-manylinux_2_5_i686.manylinux1_i686.manylinux_2_17_i686.manylinux2014_i686.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/MarkupSafe-2.1.5-cp312-cp312-win_amd64.whl&quot; },
]

[[package]]
name = &quot;mpmath&quot;
version = &quot;1.3.0&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/mpmath-1.3.0-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;networkx&quot;
version = &quot;3.4.2&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/networkx-3.4.2-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;numpy&quot;
version = &quot;2.1.2&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-macosx_10_9_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-macosx_14_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-macosx_14_0_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-macosx_10_13_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-macosx_14_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-macosx_14_0_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp312-cp312-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-macosx_10_13_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-macosx_14_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-macosx_14_0_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313t-macosx_10_13_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313t-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313t-macosx_14_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313t-macosx_14_0_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313t-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/numpy-2.1.2-cp313-cp313t-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
]

[[package]]
name = &quot;pillow&quot;
version = &quot;11.0.0&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-macosx_10_10_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-manylinux_2_28_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp311-cp311-win_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-macosx_10_13_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-manylinux_2_28_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp312-cp312-win_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-macosx_10_13_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-manylinux_2_28_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313-win_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313t-macosx_10_13_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313t-macosx_11_0_arm64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313t-manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313t-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313t-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/pillow-11.0.0-cp313-cp313t-win_arm64.whl&quot; },
]

[[package]]
name = &quot;setuptools&quot;
version = &quot;70.2.0&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/setuptools-70.2.0-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;sympy&quot;
version = &quot;1.13.1&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
dependencies = [
    { name = &quot;mpmath&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/sympy-1.13.1-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;torch&quot;
version = &quot;2.7.0.dev20250116+cu126&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
dependencies = [
    { name = &quot;filelock&quot; },
    { name = &quot;fsspec&quot; },
    { name = &quot;jinja2&quot; },
    { name = &quot;networkx&quot; },
    { name = &quot;setuptools&quot;, marker = &quot;python_full_version &gt;= '3.12'&quot; },
    { name = &quot;sympy&quot; },
    { name = &quot;typing-extensions&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp312-cp312-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp312-cp312-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp312-cp312-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313t-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313t-manylinux_2_28_x86_64.whl&quot; },
]

[[package]]
name = &quot;torchao&quot;
version = &quot;0.8.0.dev20250116&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
resolution-markers = [
    &quot;(python_full_version &gt;= '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &gt;= '3.12' and sys_platform != 'linux')&quot;,
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &lt; '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &lt; '3.12' and sys_platform != 'linux')&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchao-0.8.0.dev20250116-py3-none-any.whl&quot; },
]

[[package]]
name = &quot;torchao&quot;
version = &quot;0.8.0.dev20250116+cu126&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
resolution-markers = [
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchao-0.8.0.dev20250116%2Bcu126-cp39-abi3-manylinux_2_24_x86_64.manylinux_2_28_x86_64.whl&quot; },
]

[[package]]
name = &quot;torchaudio&quot;
version = &quot;2.6.0.dev20250116&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
resolution-markers = [
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
]
dependencies = [
    { name = &quot;torch&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116-cp311-cp311-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116-cp312-cp312-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116-cp313-cp313-linux_aarch64.whl&quot; },
]

[[package]]
name = &quot;torchaudio&quot;
version = &quot;2.6.0.dev20250116+cu126&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
resolution-markers = [
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &gt;= '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &gt;= '3.12' and sys_platform != 'linux')&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &lt; '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &lt; '3.12' and sys_platform != 'linux')&quot;,
]
dependencies = [
    { name = &quot;torch&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116%2Bcu126-cp311-cp311-linux_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116%2Bcu126-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116%2Bcu126-cp312-cp312-linux_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116%2Bcu126-cp312-cp312-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116%2Bcu126-cp313-cp313-linux_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchaudio-2.6.0.dev20250116%2Bcu126-cp313-cp313-win_amd64.whl&quot; },
]

[[package]]
name = &quot;torchnightly&quot;
version = &quot;0.0.0&quot;
source = { virtual = &quot;.&quot; }
dependencies = [
    { name = &quot;torch&quot; },
    { name = &quot;torchao&quot;, version = &quot;0.8.0.dev20250116&quot;, source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }, marker = &quot;platform_machine != 'x86_64' or sys_platform != 'linux'&quot; },
    { name = &quot;torchao&quot;, version = &quot;0.8.0.dev20250116+cu126&quot;, source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }, marker = &quot;platform_machine == 'x86_64' and sys_platform == 'linux'&quot; },
    { name = &quot;torchaudio&quot;, version = &quot;2.6.0.dev20250116&quot;, source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;torchaudio&quot;, version = &quot;2.6.0.dev20250116+cu126&quot;, source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;torchvision&quot;, version = &quot;0.22.0.dev20250116&quot;, source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;torchvision&quot;, version = &quot;0.22.0.dev20250116+cu126&quot;, source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
]

[package.metadata]
requires-dist = [
    { name = &quot;torch&quot;, index = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; },
    { name = &quot;torchao&quot;, index = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; },
    { name = &quot;torchaudio&quot;, index = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; },
    { name = &quot;torchvision&quot;, index = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; },
]

[[package]]
name = &quot;torchvision&quot;
version = &quot;0.22.0.dev20250116&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
resolution-markers = [
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
]
dependencies = [
    { name = &quot;numpy&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;pillow&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;torch&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116-cp311-cp311-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116-cp312-cp312-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116-cp313-cp313-linux_aarch64.whl&quot; },
]

[[package]]
name = &quot;torchvision&quot;
version = &quot;0.22.0.dev20250116+cu126&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
resolution-markers = [
    &quot;python_full_version &gt;= '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &gt;= '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &gt;= '3.12' and sys_platform != 'linux')&quot;,
    &quot;python_full_version &lt; '3.12' and platform_machine == 'x86_64' and sys_platform == 'linux'&quot;,
    &quot;(python_full_version &lt; '3.12' and platform_machine != 'aarch64' and platform_machine != 'x86_64') or (python_full_version &lt; '3.12' and sys_platform != 'linux')&quot;,
]
dependencies = [
    { name = &quot;numpy&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;pillow&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;torch&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116%2Bcu126-cp311-cp311-linux_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116%2Bcu126-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116%2Bcu126-cp312-cp312-linux_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116%2Bcu126-cp312-cp312-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116%2Bcu126-cp313-cp313-linux_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torchvision-0.22.0.dev20250116%2Bcu126-cp313-cp313-win_amd64.whl&quot; },
]

[[package]]
name = &quot;typing-extensions&quot;
version = &quot;4.12.2&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/typing_extensions-4.12.2-py3-none-any.whl&quot; },
]
</code></pre>
</details>

<p>vs</p>
<details>
<summary>uv pip freeze</summary>

<pre><code>filelock==3.16.1
fsspec==2024.10.0
jinja2==3.1.4
markupsafe==2.1.5
mpmath==1.3.0
networkx==3.4.2
numpy==2.1.2
nvidia-cublas-cu12==12.6.4.1
nvidia-cuda-cupti-cu12==12.6.80
nvidia-cuda-nvrtc-cu12==12.6.77
nvidia-cuda-runtime-cu12==12.6.77
nvidia-cudnn-cu12==9.5.1.17
nvidia-cufft-cu12==11.3.0.4
nvidia-curand-cu12==10.3.7.77
nvidia-cusolver-cu12==11.7.1.2
nvidia-cusparse-cu12==12.5.4.2
nvidia-cusparselt-cu12==0.6.3
nvidia-nccl-cu12==2.21.5
nvidia-nvjitlink-cu12==12.6.85
nvidia-nvtx-cu12==12.6.77
pillow==11.0.0
pytorch-triton==3.2.0+git0d4682f0
sympy==1.13.1
torch==2.7.0.dev20250116+cu126
torchaudio==2.6.0.dev20250116+cu126
torchvision==0.22.0.dev20250116+cu126
typing-extensions==4.12.2
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-16 21:37</div>
            <div class="timeline-body"><p>Sharing a reproduction with a Dockerfile would be useful for us to isolate the issue.</p>
<p>Anyway... I can reproduce this on my x86-64 Linux machine</p>
<p>During <code>uv pip install</code>, it looks like those nvidia dependencies from <code>torch</code></p>
<pre><code>DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cuda-nvrtc-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.6.77, &lt;12.6.77+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cuda-runtime-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.6.77, &lt;12.6.77+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cuda-cupti-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.6.80, &lt;12.6.80+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cudnn-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=9.5.1.17, &lt;9.5.1.17+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cublas-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.6.4.1, &lt;12.6.4.1+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cufft-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=11.3.0.4, &lt;11.3.0.4+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-curand-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=10.3.7.77, &lt;10.3.7.77+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cusolver-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=11.7.1.2, &lt;11.7.1.2+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cusparse-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.5.4.2, &lt;12.5.4.2+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-cusparselt-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=0.6.3, &lt;0.6.3+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-nccl-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=2.21.5, &lt;2.21.5+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-nvtx-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.6.77, &lt;12.6.77+
DEBUG Adding transitive dependency for torch==2.7.0.dev20250116+cu126: nvidia-nvjitlink-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.6.85, &lt;12.6.85+
</code></pre>
<p>These dependencies are missing from torch in the lockfile</p>
<pre><code>[[package]]
name = &quot;torch&quot;
version = &quot;2.7.0.dev20250116+cu126&quot;
source = { registry = &quot;https://download.pytorch.org/whl/nightly/cu126&quot; }
dependencies = [
    { name = &quot;filelock&quot; },
    { name = &quot;fsspec&quot; },
    { name = &quot;jinja2&quot; },
    { name = &quot;networkx&quot; },
    { name = &quot;setuptools&quot;, marker = &quot;python_full_version &gt;= '3.12'&quot; },
    { name = &quot;sympy&quot; },
    { name = &quot;typing-extensions&quot; },
]
wheels = [
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp312-cp312-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp312-cp312-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp312-cp312-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313-manylinux_2_28_x86_64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313-win_amd64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313t-linux_aarch64.whl&quot; },
    { url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313t-manylinux_2_28_x86_64.whl&quot; },
]
</code></pre>
<p>This occurs because pytorch has different metadata depending on the wheel.</p>
<p>e.g., the x86-64 wheel we use in <code>uv pip</code></p>
<pre><code>‚ùØ wget https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313t-manylinux_2_28_x86_64.whl
‚ùØ unzip torch-2.7.0.dev20250116+cu126-cp313-cp313t-manylinux_2_28_x86_64.whl
‚ùØ cat ./torch-2.7.0.dev20250116+cu126.dist-info/METADATA | grep Requires-Dist
Requires-Dist: filelock
Requires-Dist: typing-extensions&gt;=4.10.0
Requires-Dist: setuptools; python_version &gt;= &quot;3.12&quot;
Requires-Dist: sympy==1.13.1; python_version &gt;= &quot;3.9&quot;
Requires-Dist: networkx
Requires-Dist: jinja2
Requires-Dist: fsspec
Requires-Dist: nvidia-cuda-nvrtc-cu12==12.6.77; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cuda-runtime-cu12==12.6.77; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cuda-cupti-cu12==12.6.80; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cudnn-cu12==9.5.1.17; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cublas-cu12==12.6.4.1; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cufft-cu12==11.3.0.4; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-curand-cu12==10.3.7.77; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cusolver-cu12==11.7.1.2; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cusparse-cu12==12.5.4.2; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-cusparselt-cu12==0.6.3; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-nccl-cu12==2.21.5; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-nvtx-cu12==12.6.77; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: nvidia-nvjitlink-cu12==12.6.85; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: pytorch-triton==3.2.0+git0d4682f0; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
Requires-Dist: optree&gt;=0.13.0; extra == &quot;optree&quot;
Requires-Dist: opt-einsum&gt;=3.3; extra == &quot;opt-einsum&quot;
</code></pre>
<p>But when we lock, we use an arbitrary wheel because it's a universal resolution</p>
<pre><code>‚ùØ uv lock -v 2&gt;&amp;1 | grep torch-2.7.0.dev20250116
DEBUG Selecting: torch==2.7.0.dev20250116+cu126 [compatible] (torch-2.7.0.dev20250116+cu126-cp311-cp311-linux_aarch64.whl)
‚ùØ wget https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp311-cp311-linux_aarch64.whl
‚ùØ unzip -q torch-2.7.0.dev20250116+cu126-cp311-cp311-linux_aarch64.whl
‚ùØ cat torch-2.7.0.dev20250116+cu126.dist-info/METADATA | grep Requires-Dist
Requires-Dist: filelock
Requires-Dist: typing-extensions&gt;=4.10.0
Requires-Dist: setuptools; python_version &gt;= &quot;3.12&quot;
Requires-Dist: sympy==1.13.1; python_version &gt;= &quot;3.9&quot;
Requires-Dist: networkx
Requires-Dist: jinja2
Requires-Dist: fsspec
Requires-Dist: optree&gt;=0.13.0; extra == &quot;optree&quot;
Requires-Dist: opt-einsum&gt;=3.3; extra == &quot;opt-einsum&quot;
</code></pre>
<p>Frankly, it's really not ideal that they change their dependencies from wheel to wheel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">lock</span> added by @zanieb on 2025-01-16 21:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmm1">@tmm1</a> on 2025-01-16 21:42</div>
            <div class="timeline-body"><p>Very interesting. This is presumably because the nvidia libraries only exist in x64 and not arm64?</p>
<p>Maybe I can force x64 resolution in my project file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-16 21:46</div>
            <div class="timeline-body"><p>Yeah presumably. They could still put the dependencies there with the same platform markers they're using in the other wheel though... ü§∑‚Äç‚ôÄ</p>
<p>You can force use of the x86-64 wheel with</p>
<pre><code class="language-toml">[tool.uv.sources]
torch = [{ url = &quot;https://download.pytorch.org/whl/nightly/cu126/torch-2.7.0.dev20250116%2Bcu126-cp313-cp313t-manylinux_2_28_x86_64.whl&quot; }]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmm1">@tmm1</a> on 2025-01-16 21:52</div>
            <div class="timeline-body"><p>Ick, I was hoping for something like:</p>
<pre><code class="language-toml">[tool.uv]
environments = [
    &quot;platform_arch == 'x86_64'&quot;,
]
</code></pre>
<p>Let me see if I can start a thread upstream, maybe they're amenable to fixing up the wheels.</p>
<p>EDIT: I see now this was the same conclusion reached by @charliermarsh in https://github.com/astral-sh/uv/issues/10119#issuecomment-2559898792</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmm1">@tmm1</a> on 2025-01-16 23:33</div>
            <div class="timeline-body"><blockquote>
<p>Let me see if I can start a thread upstream, maybe they're amenable to fixing up the wheels.</p>
</blockquote>
<p>The change upstream is pretty trivial, and root cause here may just be an oversight.</p>
<p>Funny it appears the cpu linux/arm64 wheels have the cuda dependencies listed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmm1">@tmm1</a> on 2025-01-18 05:17</div>
            <div class="timeline-body"><p>I opened a PR on the pytorch repo to fix the metadata on the nightly wheels.</p>
<p>In the mean time, I had to specify the dependencies explicitly to get things working:</p>
<pre><code class="language-toml">[project.optional-dependencies]
nvidia = [
    # workaround for pytorch/pytorch#145021 and astral-sh/uv#10693
    &quot;nvidia-cuda-nvrtc-cu12 == 12.6.77&quot;,
    &quot;nvidia-cuda-runtime-cu12 == 12.6.77&quot;,
    &quot;nvidia-cuda-cupti-cu12 == 12.6.80&quot;,
    &quot;nvidia-cudnn-cu12 == 9.5.1.17&quot;,
    &quot;nvidia-cublas-cu12 == 12.6.4.1&quot;,
    &quot;nvidia-cufft-cu12 == 11.3.0.4&quot;,
    &quot;nvidia-curand-cu12 == 10.3.7.77&quot;,
    &quot;nvidia-cusolver-cu12 == 11.7.1.2&quot;,
    &quot;nvidia-cusparse-cu12 == 12.5.4.2&quot;,
    &quot;nvidia-cusparselt-cu12 == 0.6.3&quot;,
    &quot;nvidia-nccl-cu12 == 2.21.5&quot;,
    &quot;nvidia-nvtx-cu12 == 12.6.77&quot;,
    &quot;nvidia-nvjitlink-cu12 == 12.6.85&quot;,
]
torch = [
    &quot;torch&quot;,
    &quot;torchao&quot;,
    &quot;torchaudio&quot;,
    &quot;torchvision&quot;,
]

[tool.uv.sources]
torch = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchvision = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchaudio = [{ index = &quot;pytorch-nightly-cu126&quot; }]
torchao = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cuda-nvrtc-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cuda-runtime-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cuda-cupti-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cudnn-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cublas-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cufft-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-curand-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cusolver-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cusparse-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-cusparselt-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-nccl-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-nvtx-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]
nvidia-nvjitlink-cu12 = [{ index = &quot;pytorch-nightly-cu126&quot; }]

[[tool.uv.index]]
name = &quot;pytorch-nightly-cu126&quot;
url = &quot;https://download.pytorch.org/whl/nightly/cu126&quot;
explicit = true
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-18 15:28</div>
            <div class="timeline-body"><p>Nice -- thank you for doing that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/warner-benjamin">@warner-benjamin</a> on 2025-02-21 21:50</div>
            <div class="timeline-body"><p>This is also an issue with the released PyTorch 2.6.0 Cuda 12.6 on x86. Maybe it's related to pytorch/pytorch#146679? If so, then it should be resolved for PyTorch 2.6.1.</p>
<p>@tmm1's <a href="https://github.com/astral-sh/uv/issues/10693#issuecomment-2599538154">solution</a> resolves the issue.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:52:44 UTC
    </footer>
</body>
</html>
