<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`requires-python = &quot;~=3.10&quot;` uses docker container python 3.11 and not a managed python 3.10 - astral-sh/uv #7682</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`requires-python = &quot;~=3.10&quot;` uses docker container python 3.11 and not a managed python 3.10</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7682">#7682</a>
        opened by <a href="https://github.com/gabriel-vanzandycke">@gabriel-vanzandycke</a>
        on 2024-09-25 08:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gabriel-vanzandycke">@gabriel-vanzandycke</a> on 2024-09-25 08:44</div>
            <div class="timeline-body"><p>I use a docker container bundled with python 3.11.9 but my app requires python ~=3.10.
Running <code>uv sync</code> uses python system rather than the expected python version <code>~=3.10</code>.
When enforcing <code>==3.10</code>, uv downloads and uses a managed python version as expected.</p>
<p><strong>Dockerfile</strong></p>
<pre><code class="language-dockerfile">FROM python:3.11.9-slim-bookworm
COPY --from=ghcr.io/astral-sh/uv:0.4.10 /uv /bin/uv
ENTRYPOINT /bin/bash
ADD . /root

RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --frozen --no-install-project --no-install-workspace &gt; /tmp/uv_sync.log 2&gt;&amp;1
</code></pre>
<p><strong>pyprojects.toml</strong></p>
<pre><code class="language-pyproject.toml">[project]
name = &quot;app&quot;
version = &quot;1.6.0&quot;
description = &quot;&quot;
requires-python = &quot;~=3.10&quot;
dependencies = [
    &quot;jupyter&gt;=1.0&quot;,
]

[tool.uv]
package = true
</code></pre>
<p><strong>With <code>requires-python = &quot;~=3.10&quot;</code> in pyproject.toml:</strong>
Inspecting the beginning of uv sync output shows it is using python 3.11.9.</p>
<pre><code>$ docker build -t app:latest -f Dockerfile .
$ docker run -it --rm app:latest
# head -1 /tmp/uv_sync.log
Using Python 3.11.9 interpreter at: /usr/local/bin/python3
</code></pre>
<p><strong>With <code>requires-python = &quot;==3.10&quot;</code> in pyproject.toml:</strong>
When requiring <code>3.10</code> instead, inspecting the uv sync output shows it is using python 3.10 as expected.</p>
<pre><code>$ docker build -t app:latest -f Dockerfile .
$ docker run -it --rm app:latest
root@d93a4e3c8011:/# head -1 /tmp/uv_sync.log
Using Python 3.10.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "requires-python = "~=3.10" uses docker container python 3.11 and not a python 3.10" to "requires-python = "~=3.10" uses docker container python 3.11 and not a managed python 3.10" by @gabriel-vanzandycke on 2024-09-25 08:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "requires-python = "~=3.10" uses docker container python 3.11 and not a managed python 3.10" to "`requires-python = "~=3.10"` uses docker container python 3.11 and not a managed python 3.10" by @gabriel-vanzandycke on 2024-09-25 08:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/weihenglim">@weihenglim</a> on 2024-09-25 09:14</div>
            <div class="timeline-body"><p>The version specifier <code>~=3.10</code> is equivalent to <code>&gt;=3.10, ==3.*</code>, which matches <code>3.11</code></p>
<p>You should specify <code>~=3.10.0</code> if you want to target Python <code>3.10.*</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @gabriel-vanzandycke on 2024-09-25 09:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gabriel-vanzandycke">@gabriel-vanzandycke</a> on 2024-09-25 09:26</div>
            <div class="timeline-body"><p>Thanks. I didn't know that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gabriel-vanzandycke">@gabriel-vanzandycke</a> on 2024-09-25 10:04</div>
            <div class="timeline-body"><p>I still have the problem with <code>~=3.10.0</code> though</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @gabriel-vanzandycke on 2024-09-25 10:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gabriel-vanzandycke">@gabriel-vanzandycke</a> on 2024-09-25 10:06</div>
            <div class="timeline-body"><p>it's not easy to replicate my exact setup in a minimum working example, but when I use <code>~=3.10.0</code>, running</p>
<pre><code>uv run jupyter notebook
</code></pre>
<p>and importing one of my dependency within a notebook fails with &quot;module not found&quot;. It all seems like uv run is not loading/using the environment created previously.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/weihenglim">@weihenglim</a> on 2024-09-25 10:15</div>
            <div class="timeline-body"><p>I'm not familiar with <code>jupyter</code> but you can try taking a look at https://github.com/astral-sh/uv/issues/7679#issuecomment-2373102667</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-25 12:36</div>
            <div class="timeline-body"><p>If <code>~=3.10.0</code> is giving you <code>3.11.X</code>, that may be a bug.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-25 12:46</div>
            <div class="timeline-body"><p>I cannot produce that:</p>
<pre><code>Using Python 3.11.7
error: The requested interpreter resolved to Python 3.11.7, which is incompatible with the project's Python requirement: `&gt;=3.10.0, &lt;3.11`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2024-09-25 12:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/7426.html">astral-sh/uv#7426</a> on 2024-09-25 19:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-23 00:02</div>
            <div class="timeline-body"><p>Happy to reopen if we're able to find a reproduction.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-10-23 00:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/14335.html">astral-sh/uv#14335</a> on 2025-07-01 21:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:55 UTC
    </footer>
</body>
</html>
