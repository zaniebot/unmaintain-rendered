<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip sync pyproject.toml` does not install all dependencies - astral-sh/uv #8527</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv pip sync pyproject.toml` does not install all dependencies</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/8527">#8527</a>
        opened by <a href="https://github.com/MtkN1">@MtkN1</a>
        on 2024-10-24 14:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/MtkN1">@MtkN1</a> on 2024-10-24 14:14</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p><code>pyproject.toml</code> (just added <code>requests</code>):</p>
<pre><code class="language-toml">[project]
name = &quot;uv-demo&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.13&quot;
dependencies = [
    &quot;requests&gt;=2.32.3&quot;,
]
</code></pre>
<p>reproduce command:</p>
<pre><code class="language-sh-session">$ uv venv
$ uv pip sync pyproject.toml
Resolved 1 package in 2ms
Installed 1 package in 1ms
 + requests==2.32.3
$ uv pip freeze
requests==2.32.3
</code></pre>
<p>The dependencies required by the <code>requests</code> are not installed. In fact, there are dependencies such as <code>urllib3</code>.</p>
<pre><code class="language-sh-session">$ echo requests | uv pip compile -
Resolved 5 packages in 79ms
# This file was autogenerated by uv via the following command:
#    uv pip compile -
certifi==2024.8.30
    # via requests
charset-normalizer==3.4.0
    # via requests
idna==3.10
    # via requests
requests==2.32.3
urllib3==2.2.3
    # via requests
</code></pre>
<p>Don't you think this is a bug?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-24 14:25</div>
            <div class="timeline-body"><p><code>uv pip sync</code> installs <em>exactly</em> the requirements defined in a file â€” in this case just <code>requests</code>.</p>
<p>It sounds like you're looking for <code>uv pip compile pyproject.toml | uv pip sync -</code>, <code>uv pip install .</code>, or <code>uv sync</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-10-24 14:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MtkN1">@MtkN1</a> on 2024-10-24 15:14</div>
            <div class="timeline-body"><blockquote>
<p>uv pip sync installs <em>exactly</em> the requirements defined in a file</p>
</blockquote>
<p>Ah I see, <code>uv pip sync</code> does not resolve dependencies. I understood that it is a function to synchronise each requirements.</p>
<blockquote>
<p><code>uv pip compile pyproject.toml | uv pip sync -</code></p>
</blockquote>
<p>This is the solution! I thought I read the documentation carefully, but I missed that you can enter it from stdin. (I'm a library developer and I just wanted to upgrade my virtual environment without lock file)</p>
<p>Thank you very much for teaching me. This is as designed, so I'm closing the issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MtkN1 on 2024-10-24 15:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MtkN1">@MtkN1</a> on 2024-10-24 15:24</div>
            <div class="timeline-body"><p>However, <code>uv pip sync pyproject.toml</code> as described <a href="https://docs.astral.sh/uv/pip/compile/#syncing-an-environment">in the documentation</a> caused some confusion (enough to open this issue). I'm not sure if there's any value in syncing an uncompiled pyproject.toml.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/orishamir">@orishamir</a> on 2025-03-06 09:39</div>
            <div class="timeline-body"><p>Why should <code>uv sync</code> include dependencies but not <code>uv pip sync</code>? What is the value of syncing without dependencies?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../KCL-BMEIS/UltraFlwr/issues/49.html">KCL-BMEIS/UltraFlwr#49</a> on 2025-04-28 19:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pelson">@pelson</a> on 2025-09-24 09:51</div>
            <div class="timeline-body"><p>@zanieb sorry for the ping, but I found this issue and think it has been mis-classified.</p>
<p><code>pip-tools</code> <em>does</em> resolve dependencies in sync by default:</p>
<pre><code>$ uv venv ./venv --seed
Using CPython 3.13.5
Creating virtual environment with seed packages at: ./venv
 + pip==25.2
Activate with: source venv/bin/activate

$ echo &quot;requests==2.32.5&quot; &gt; requirements.txt

$ uv run --with pip-tools pip-sync ./requirements.txt --python-executable=${VIRTUAL_ENV}/bin/python
Collecting requests==2.32.5 (from -r /tmp/tmpt06qmqtf (line 1))
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Collecting charset_normalizer&lt;4,&gt;=2 (from requests==2.32.5-&gt;-r /tmp/tmpt06qmqtf (line 1))
  Using cached charset_normalizer-3.4.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (36 kB)
Collecting idna&lt;4,&gt;=2.5 (from requests==2.32.5-&gt;-r /tmp/tmpt06qmqtf (line 1))
  Using cached idna-3.10-py3-none-any.whl.metadata (10 kB)
Collecting urllib3&lt;3,&gt;=1.21.1 (from requests==2.32.5-&gt;-r /tmp/tmpt06qmqtf (line 1))
  Using cached urllib3-2.5.0-py3-none-any.whl.metadata (6.5 kB)
Collecting certifi&gt;=2017.4.17 (from requests==2.32.5-&gt;-r /tmp/tmpt06qmqtf (line 1))
  Using cached certifi-2025.8.3-py3-none-any.whl.metadata (2.4 kB)
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Using cached charset_normalizer-3.4.3-cp313-cp313-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (151 kB)
Using cached idna-3.10-py3-none-any.whl (70 kB)
Using cached urllib3-2.5.0-py3-none-any.whl (129 kB)
Using cached certifi-2025.8.3-py3-none-any.whl (161 kB)
Installing collected packages: urllib3, idna, charset_normalizer, certifi, requests
Successfully installed certifi-2025.8.3 charset_normalizer-3.4.3 idna-3.10 requests-2.32.5 urllib3-2.5.0
</code></pre>
<p>Whereas <code>uv pip sync</code> doesn't:</p>
<pre><code>$ uv venv ./venv --seed
$ VIRTUAL_ENV=./venv/ uv pip sync ./requirements.txt
Using Python 3.13.5 environment at: venv
Resolved 1 package in 41ms
Installed 1 package in 1ms
 + requests==2.32.5
</code></pre>
<p>To get <code>pip-tools</code> to not resolve, you have to go out of your way a bit...</p>
<pre><code>$ uv venv ./venv --seed
$ uv run --with pip-tools pip-sync ./requirements.txt --python-executable=./venv/bin/python --pip-args=&quot;--no-deps&quot;
Collecting requests==2.32.5 (from -r /tmp/tmpgqoczsaz (line 1))
  Using cached requests-2.32.5-py3-none-any.whl.metadata (4.9 kB)
Using cached requests-2.32.5-py3-none-any.whl (64 kB)
Installing collected packages: requests
Successfully installed requests-2.32.5
</code></pre>
<p>FWIW, I found this because I actually wanted <code>uv pip sync</code> to not spend so much time resolving (as I have a complete <code>requirements.txt</code> in my case), and can't find a satisfying solution. Something like <code>--no-deps</code> is essentially what I'm looking for (happy to open a feature request for that separately if you think it is worth it).</p>
<p>My case above is best demonstrated with:</p>
<pre><code>$ echo &quot;scipy==1.16.2&quot; &gt;&gt; ./requirements.txt
$ uv pip sync ./requirements.txt --no-cache
Using Python 3.13.5 environment at: venv
Resolved 2 packages in 237ms
Prepared 1 package in 515ms
Installed 1 package in 14ms
 + scipy==1.16.2
$ uv pip sync ./requirements.txt --no-cache
Using Python 3.13.5 environment at: venv
Resolved 2 packages in 242ms
Audited 2 packages in 0.04ms
</code></pre>
<p>It should not be necessary for a resolution step in the second instance, and even the first instance the &quot;resolution&quot; is to figure out which wheels to install given the version. Is there an optimisation that can be made in <code>uv pip sync</code>?</p>
<p>In the second instance, I can add <code>--no-index</code> and I get the desired performance, but this obviously fails if there is some actual sync to be done.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:00 UTC
    </footer>
</body>
</html>
