<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV does not download a python version to satisfy both .python-version and requires-python, even if only-managed is set - astral-sh/uv #16012</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UV does not download a python version to satisfy both .python-version and requires-python, even if only-managed is set</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16012">#16012</a>
        opened by <a href="https://github.com/Wesztman">@Wesztman</a>
        on 2025-09-24 09:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Wesztman">@Wesztman</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>It does not seem that UV correctly downloads the correct python version to satisfy the combination of .python-version and requires-python</p>
<p><img width="1311" height="779" alt="Image" src="https://github.com/user-attachments/assets/9aac2f3d-9c46-4f90-adb9-117e1e2bdfd4" /></p>
<p>In this example I had a .python-version with 3.13 in it and a requires-python&gt;=3.13.7</p>
<p>I've set <code>python-preference = &quot;only-managed&quot;</code>.</p>
<p>During the first run it seems that because I have downloaded a managed version 3.13.2 before, uv will try to use that? Just to error out straight after because requires-python is set to &gt;=3.13.7.</p>
<p>If I change .python-version to 3.13.7 (second sync) it correctly downloads that version and everything works.</p>
<p>Cheers
Carl</p>
<h3>Platform</h3>
<p>Windows 11, WSL2, Ubuntu24</p>
<h3>Version</h3>
<p>0.8.12</p>
<h3>Python version</h3>
<p>Python 3.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @Wesztman on 2025-09-24 09:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-09-24 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-24 14:48</div>
            <div class="timeline-body"><p>That looks like a bug, thanks!</p>
<p>Please use code blocks instead of screenshots in the future.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wesztman">@Wesztman</a> on 2025-09-24 15:57</div>
            <div class="timeline-body"><blockquote>
<p>That looks like a bug, thanks!</p>
<p>Please use code blocks instead of screenshots in the future.</p>
</blockquote>
<p>Ahh yee, sry bout that, will do üòäüëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-24 18:04</div>
            <div class="timeline-body"><p>This might be hard to fix, we'd have to combine the requests from the <code>.python-version</code> file with the <code>requires-python</code> range. I'd recommend including the patch version in your <code>.python-version</code> file or omitting the file entirely in the meantime.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wesztman">@Wesztman</a> on 2025-09-24 18:38</div>
            <div class="timeline-body"><blockquote>
<p>This might be hard to fix, we'd have to combine the requests from the <code>.python-version</code> file with the <code>requires-python</code> range. I'd recommend including the patch version in your <code>.python-version</code> file or omitting the file entirely in the meantime.</p>
</blockquote>
<p>Is it possible to configure in the pyproject.toml so that uv does not generate or use the .python-version and only takes the requires-python into account when downloading and installing a python version? :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wesztman">@Wesztman</a> on 2025-09-24 18:50</div>
            <div class="timeline-body"><p>Oh wait, it's only <code>uv init</code> that creates the .python-version? <code>uv sync</code> does not create it again? So I could just remove the .python-version and uv would still install python versions automatically in accordance with my <code>requires-python</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-24 18:59</div>
            <div class="timeline-body"><p>Yeah, <code>.python-version</code> just sets the default version within the <code>requires-python</code> range, in a sense.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-24 18:59</div>
            <div class="timeline-body"><p>You can omit it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wesztman">@Wesztman</a> on 2025-09-24 19:36</div>
            <div class="timeline-body"><p>While I have you on the line, is there any documentation on what is taken into account of the host system &quot;stats&quot; when evaluating which python version to download.</p>
<p>I had <code>require-python:&gt;=3.13</code> in my pyproject toml.</p>
<p>On my local Linux machine, x86, Ubuntu 24 uv installed 3.13.7 and on my build agent vm also Linux, x86 but Ubuntu 22 uv installed 3.13.4</p>
<p>And when I ran <code>uv python list</code> on the VM I had nothing higher than 3.13.4</p>
<p>Just wondered if it was only cause of the Ubuntu version or something else ü§î</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-24 19:50</div>
            <div class="timeline-body"><p>It's probably the uv version, we embed the available versions into the binary</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wesztman">@Wesztman</a> on 2025-09-24 19:57</div>
            <div class="timeline-body"><p>Ahh, I see, thanks for the answer üëç while I can see the benefit of that, and that it makes it more predictable, it also makes it hard to use strict version like ==3.13.4 on <code>requires-python</code> and let Renovate update the version whenever there is a new patch, because if the pipeline running Renovate has newer version of uv then the devs they will not be able to sync.</p>
<p>But I guess it's just a matter of keeping your uv installation up to date informing everyone that if you cannot build or if your pipeline cannot build because the python version is not available, update uv üòä there's always pros and cons</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-24 20:13</div>
            <div class="timeline-body"><p>This is true :) we'll probably add some sort of remote fallback in the future, but it doesn't exist yet.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:32:59 UTC
    </footer>
</body>
</html>
