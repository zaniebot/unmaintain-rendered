<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Windows] Processes spawned by uv are not killed when uv is killed - astral-sh/uv #11817</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Windows] Processes spawned by uv are not killed when uv is killed</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/11817">#11817</a>
        opened by <a href="https://github.com/gau-nernst">@gau-nernst</a>
        on 2025-02-27 02:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gau-nernst">@gau-nernst</a> on 2025-02-27 02:29</div>
            <div class="timeline-body"><h3>Summary</h3>
<pre><code class="language-python"># sleep.py
import time

time.sleep(100000)
</code></pre>
<pre><code>uv run sleep.py
</code></pre>
<p>Then I manually kill uv process in Task manager. I can still see the Python process.</p>
<p>On MacOS/Linux, if I kill it with <code>kill pid</code> (which sends SIGTERM), the Python process will exit. Though I also notice that if I kill with SIGKILL instead <code>kill -9 pid</code>, the Python process does not stop.</p>
<p>In a larger context, in my application, I'm trying to spawn uv as a subprocess to launch Python apps. And I want to be able to kill the uv subprocess and its python process. Having troubles to do it on Windows right now.</p>
<h3>Platform</h3>
<p>Windows 11 64bit</p>
<h3>Version</h3>
<p>uv 0.6.2 (6d3614eec 2025-02-19)</p>
<h3>Python version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @gau-nernst on 2025-02-27 02:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-02-27 18:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-27 18:50</div>
            <div class="timeline-body"><p>Thanks for the report. I can look into our implementation of this, might need @Gankra to test Windows-specific parts though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-27 18:53</div>
            <div class="timeline-body"><p>As a note on <code>kill -9</code> on Unix — we can't do anything like forward signals there. We'd need to rely on the OS to send SIGKILL to any children too. Are you sending the signal to the <em>process group id</em>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-27 18:55</div>
            <div class="timeline-body"><p>On Windows, you probably want <code>taskkill /t</code>? https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/taskkill</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gau-nernst">@gau-nernst</a> on 2025-02-28 00:29</div>
            <div class="timeline-body"><blockquote>
<p>As a note on kill -9 on Unix — we can't do anything like forward signals there. We'd need to rely on the OS to send SIGKILL to any children too. Are you sending the signal to the process group id?</p>
</blockquote>
<p>I'm just putting my observation there regarding <code>SIGKILL</code>. It's not a problem for me. I'm currently using <code>SIGTERM</code> (which propagates correctly) on Unix, so that works fine.</p>
<blockquote>
<p>On Windows, you probably want taskkill /t?</p>
</blockquote>
<p>Just tried and it worked <code>taskkill /pid &lt;pid&gt; /t /F</code>! Currently I'm using Job Object https://learn.microsoft.com/en-us/windows/win32/procthread/job-objects, which seems to serve my purpose well. Since I'm managing this programmatically via C++ code, I will prefer not to spawn another <code>taskkill</code> process :). Though I will probably look into how <code>taskkill</code> list a process's children.</p>
<p>Perhaps you might want to use Job Object when uv spawns Python process on Windows too? Not sure if there is perf complications.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-02-28 02:14</div>
            <div class="timeline-body"><p>I think this is expected behavior based on https://github.com/rust-lang/rust/blob/master/library/std/src/sys/pal/windows/process.rs as the child process effectively becomes orphaned when killed that way. I believe killing the process group instead is the right approach I'd take.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-01 17:50</div>
            <div class="timeline-body"><blockquote>
<p>Perhaps you might want to use Job Object when uv spawns Python process on Windows too? Not sure if there is perf complications.</p>
</blockquote>
<p>That's pretty interesting, there could be something there but I don't foresee having time to pursue it myself right now.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:52:57 UTC
    </footer>
</body>
</html>
