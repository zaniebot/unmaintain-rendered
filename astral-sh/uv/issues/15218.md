```yaml
number: 15218
title: "`match-runtime = true` build dependencies should invalidate installed distributions"
type: issue
state: closed
author: charliermarsh
labels:
  - bug
assignees: []
created_at: 2025-08-11T11:37:44Z
updated_at: 2025-08-15T15:15:56Z
url: https://github.com/astral-sh/uv/issues/15218
synced_at: 2026-01-10T01:57:34Z
```

# `match-runtime = true` build dependencies should invalidate installed distributions

---

_Issue opened by @charliermarsh on 2025-08-11 11:37_

The issue here is that if you install `flash-attn` with a certain `torch` version and `match-runtime = true`, then change the `torch` version, on `uv sync`, we won't invalidate the already-installed version. (If you use `--reinstall`, we _will_ correctly rebuild it, because the `torch` version is part of the cache key; but if it's already-installed, the logic there isn't the same.)

---

_Assigned to @charliermarsh by @charliermarsh on 2025-08-11 11:37_

---

_Label `bug` added by @charliermarsh on 2025-08-11 11:37_

---

_Comment by @zanieb on 2025-08-11 13:02_

I'm also curious if we should do the same for `config-settings-package` and `extra-build-variables`

---

_Comment by @charliermarsh on 2025-08-11 13:55_

I think we _probably_ should, and hopefully it's the ~same problem.

---

_Referenced in [astral-sh/uv#6437](../../astral-sh/uv/issues/6437.md) on 2025-08-13 03:43_

---

_Referenced in [astral-sh/uv#15289](../../astral-sh/uv/pulls/15289.md) on 2025-08-14 22:47_

---

_Closed by @charliermarsh on 2025-08-15 15:15_

---

_Referenced in [astral-sh/uv#16850](../../astral-sh/uv/issues/16850.md) on 2025-11-25 20:06_

---
