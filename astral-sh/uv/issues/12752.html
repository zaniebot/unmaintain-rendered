<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip compile requires pyproject.toml name exactly - why? - astral-sh/uv #12752</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv pip compile requires pyproject.toml name exactly - why?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12752">#12752</a>
        opened by <a href="https://github.com/ihelmer07">@ihelmer07</a>
        on 2025-04-08 16:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ihelmer07">@ihelmer07</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<h2>Background</h2>
<p><code>uv pip compile</code> requires a file named <code>pyproject.toml</code> to be in current directory (or others like requirements.ini)
if no <code>pyproject.toml</code> is found uv provides the following error:</p>
<pre><code>~/temp/uv2$ uv pip compile -o app.lock 
error: the following required arguments were not provided:
  &lt;SRC_FILE|--group &lt;GROUP&gt;&gt;
</code></pre>
<p>this would lead one to believe they can provide any SRC_FILE and have it work, which is not the case.</p>
<h2>Problem</h2>
<p>If one wants to have a <code>pyproject.toml</code> that isn't named <code>pyproject.toml</code> (e.g. multiple <code>pyproject.toml</code> in the same folder (e.g. <code>app-pyproject.toml</code> vs <code>base-pyproject.toml</code>)) <em>that is properly formatted pyproject.toml</em> <code>uv pip compile</code> will not parse correctly.</p>
<pre><code>~/temp/uv2$ uv pip compile -o app.lock app-pyproject.toml
error: Unexpected '[', expected '-c', '-e', '-r' or the start of a requirement at pyprojecst.toml:2:1
</code></pre>
<p>Renaming <code>app-pyproject.toml</code> to <code>pyproject.toml</code> fixes it.</p>
<p><strong>why is the manual renaming of files needed?</strong></p>
<h2>Steps to recreate</h2>
<ol>
<li>Create standard pyproject.toml named <code>app-pyproject.toml</code></li>
</ol>
<pre><code># app-pyproject.toml
[project]
name=&quot;app&quot;
requires-python = &quot;&gt;=3.11&quot;
version=&quot;0.1.0&quot;
dependencies = [
  &quot;numpy&gt;=2.2.4&quot;,
  &quot;polars==1.26&quot;,
]

</code></pre>
<ol start="2">
<li>Run <code>uv pip compile -o app.lock app-pyproject.toml</code></li>
<li>See error</li>
<li>Rename <code>app-pyproject.toml</code> to <code>pyproject.toml</code></li>
<li>run <code>uv pip compile -o app.lock pyproject.toml</code></li>
<li>success</li>
</ol>
<h3>Platform</h3>
<p>any</p>
<h3>Version</h3>
<p>0.6.13</p>
<h3>Python version</h3>
<p>3.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ihelmer07 on 2025-04-08 16:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-08 17:04</div>
            <div class="timeline-body"><p><code>pyproject.toml</code> is the official standard name for the file format. We don't assume all toml files are <code>pyproject.toml</code> formatted. I think we're pretty unlikely to support alternative names without a strong justification.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-04-08 17:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-04-08 17:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-08 17:04</div>
            <div class="timeline-body"><blockquote>
<p>If one wants to have a pyproject.toml that isn't named pyproject.toml (e.g. multiple pyproject.toml in the same folder (e.g. app-pyproject.toml vs base-pyproject.toml)) that is properly formatted pyproject.toml uv pip compile will not parse correctly.</p>
</blockquote>
<p>This will break lots of tooling. I'd recommend not doing that if you can avoid it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ihelmer07">@ihelmer07</a> on 2025-04-08 17:46</div>
            <div class="timeline-body"><p>@zanieb - I agree that it will break a lot of tooling, I just don't understand why if the user explicitly states the <code>.toml</code> file it won't parse correctly? From my understanding only <code>requirements.ini</code>, <code>requirements.txt</code> and <code>pyproject.toml</code> are valid for <code>uv pip compile</code>. why is uv forcing the filename?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-08 18:04</div>
            <div class="timeline-body"><p>There are other <code>.toml</code> files, e.g., the new lockfile format from PEP 741 is <code>pylock.toml</code> and will be supported here. The name is used to declare the schema of the file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ihelmer07">@ihelmer07</a> on 2025-04-08 18:10</div>
            <div class="timeline-body"><p>Got it - thanks very much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ihelmer07 on 2025-04-08 18:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:30:52 UTC
    </footer>
</body>
</html>
