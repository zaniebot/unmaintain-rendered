```yaml
number: 4711
title: "`uv pip tree` machine readable output"
type: issue
state: open
author: ibraheemdev
labels:
  - help wanted
  - cli
assignees: []
created_at: 2024-07-01T21:24:17Z
updated_at: 2025-11-20T19:07:09Z
url: https://github.com/astral-sh/uv/issues/4711
synced_at: 2026-01-10T01:57:10Z
```

# `uv pip tree` machine readable output

---

_Issue opened by @ibraheemdev on 2024-07-01 21:24_

e.g. JSON with `-j`. This is useful for interacting with graph tools such as mermaid.

---

_Label `cli` added by @ibraheemdev on 2024-07-01 21:24_

---

_Referenced in [astral-sh/uv#4439](../../astral-sh/uv/issues/4439.md) on 2024-07-01 21:24_

---

_Comment by @zanieb on 2024-07-01 21:26_

I think we should probably use `--format json` for consistency with other interfaces?

---

_Label `help wanted` added by @zanieb on 2024-07-01 21:26_

---

_Comment by @zanieb on 2024-07-01 21:30_

See also https://github.com/astral-sh/uv/issues/411

---

_Comment by @ChannyClaus on 2024-07-03 04:55_

should this be part of `uv pip tree` or `uv pip list`? `uv pip list --format json` seems to already print something very similar to what `pipdeptree --json` prints:
```
$ uv pip list --format json | jq 
[
  {
    "name": "certifi",
    "version": "2024.6.2"
  },
  {
    "name": "charset-normalizer",
    "version": "3.3.2"
  },
  {
    "name": "idna",
    "version": "3.7"
  },
  {
    "name": "requests",
    "version": "2.32.3"
  },
  {
    "name": "urllib3",
    "version": "2.2.2"
  }
]
```
additionally the output of `pipdeptree --json` doesn't seem to necessarily relate to the concept of tree, since when there's a nested dependency, it doesn't actually nest it in the json output.

thoughts @dsully @kdeldycke?

---

_Comment by @kdeldycke on 2024-07-03 06:10_

Oh I'm not really picky about the shape of the JSON output, as long as it is machine readable.

That's because I'm only interested in creating a Mermaid diagram to visualize dependencies like so: https://kdeldycke.github.io/meta-package-manager/install.html#python-dependencies

So whatever the JSON looks like, I'll have to write a script to generate [the `.mmd` file](https://github.com/kdeldycke/meta-package-manager/blob/main/docs/assets/dependencies.mmd?short_path=61b3aea) out of `uv pip tree` output.

---

_Referenced in [astral-sh/uv#4821](../../astral-sh/uv/pulls/4821.md) on 2024-07-04 21:58_

---

_Comment by @paveldikov on 2024-07-24 11:51_

I'm interested in this in an SBOM context. A JSON representation of the tree would be a fantastic precursor format that can be easily post-processed into one of the many SBOM formats out there. In particular, being able to distinguish between direct and transitive dependencies is key.

(not sure if doing this in `uv pip list` would work for this usage? If it does, great!)

---

_Comment by @kdeldycke on 2024-08-02 19:31_

Lol. I just realized I solved this problem myself, as my [Meta Package Manager](https://github.com/kdeldycke/meta-package-manager) CLI allows you to:

- Export a JSON list of installed packages from a uv environment:
    ```shell-session
    $ mpm --uv --output-format json installed
    ```
    ```json
    {
        "uv": {
            "errors": [],
            "id": "uv",
            "name": "UV",
            "packages": [
                {
                    "id": "alabaster",
                    "installed_version": "0.7.16",
                    "name": null
                },
                {
                    "id": "arrow",
                    "installed_version": "1.3.0",
                    "name": null
                },
                {
                    "id": "attrs",
                    "installed_version": "23.2.0",
                    "name": null
                },
    ...
    ```

- Export an SBOM of a uv environment:
    ```shell-session
    $ mpm --uv sbom --spdx                   
    info: User selection of managers by priority: > uv
    info: Managers dropped by user: None
    info: Print SPDX export to <stdout>
    info: Export packages from uv...
    ```
    ```json
    {
        "SPDXID": "SPDXRef-DOCUMENT",
        "creationInfo": {
            "created": "2024-08-02T23:29:10Z",
            "creators": [
                "Tool: meta-package-manager-5.18.1"
            ]
        },
        "dataLicense": "CC0-1.0",
        "name": "macOS-Darwin-23.6.0-arm64",
        "spdxVersion": "SPDX-2.3",
        "documentNamespace": "https://github.com/kdeldycke/meta-package-manager/releases/tag/v5.18.1/fdcf50b29504cc4c0df620af2283ed3",
        "packages": [
            {
                "SPDXID": "SPDXRef-pkg-uv-alabaster-0.7.16",
                "downloadLocation": "https://www.example.com",
                "externalRefs": [
                    {
                        "referenceCategory": "PACKAGE_MANAGER",
                        "referenceLocator": "pkg:uv/alabaster@0.7.16",
                        "referenceType": "purl"
                    }
                ],
                "filesAnalyzed": false,
                "name": "alabaster",
                "primaryPackagePurpose": "INSTALL",
                "supplier": "Organization: UV",
                "versionInfo": "0.7.16"
            },
            {
                "SPDXID": "SPDXRef-pkg-uv-arrow-1.3.0",
                "downloadLocation": "https://www.example.com",
                "externalRefs": [
                    {
                        "referenceCategory": "PACKAGE_MANAGER",
                        "referenceLocator": "pkg:uv/arrow@1.3.0",
                        "referenceType": "purl"
                    }
                ],
                "filesAnalyzed": false,
                "name": "arrow",
                "primaryPackagePurpose": "INSTALL",
                "supplier": "Organization: UV",
                "versionInfo": "1.3.0"
            },
    ...
    ```

---

_Referenced in [astral-sh/uv#5627](../../astral-sh/uv/issues/5627.md) on 2024-08-02 19:33_

---

_Referenced in [astral-sh/uv#6012](../../astral-sh/uv/issues/6012.md) on 2024-08-12 09:08_

---

_Comment by @dsully on 2024-10-12 14:56_

I'm not picky about the output of the JSON either, and it doesn't need to take a tree shape.

Just represent the consumers and producers in the environment / lock file.

Alternatively if there was a consumable crate that I could depend on to walk the tree/lock file that would almost be better.

---

_Referenced in [astral-sh/uv#10886](../../astral-sh/uv/pulls/10886.md) on 2025-01-23 07:00_

---

_Referenced in [oss-review-toolkit/ort#10020](../../oss-review-toolkit/ort/pulls/10020.md) on 2025-03-17 17:39_

---

_Referenced in [astral-sh/uv#14021](../../astral-sh/uv/issues/14021.md) on 2025-06-13 12:03_

---

_Referenced in [marimo-team/marimo#5358](../../marimo-team/marimo/pulls/5358.md) on 2025-06-19 16:27_

---

_Comment by @kapilt on 2025-06-25 17:56_

I'd prefer a tree shape to be able to understand the top level depend, ie which package in a workspace pulled in this dependency.

---

_Referenced in [prefix-dev/pixi#4130](../../prefix-dev/pixi/issues/4130.md) on 2025-08-01 18:23_

---

_Comment by @cr-klarna on 2025-08-29 11:38_

interested in any ongoing work here. I recognize that people want to at least distinguish between transitive and direct dependencies, and this is ofc doable at a glance, though there seems to be no specification on how people want it to look like. Personally I don't mind a flattened list approach for our needs where we would just have packages listed with the dependency type as a field in the object. Just gonna throw a suggestion:

e.g. 
```
[
{
  "package": "name",
  "versionConstraint": ">x.x.x",
  "version": "x.x.x",
  "type": "direct",
  "dependencies": [
    {"package": "some_transitive_package", "versionConstraint": "x.x.x"},
    ...
  ]
},
...
]
```

for the dependencies, we would only need the package identifier and the constraint. We can collect the actual package info in the flat list and you would be able to build from this a graph including the constraints each dependency had, vs the actual resolved version. Also trivial to format this way since we have the tree, it's just leaf-first traversal at that point to turn them into this I assume?

---

_Comment by @cr-klarna on 2025-09-04 15:12_

https://github.com/cr-klarna/uv/tree/add-tree-json-format 
Ended up needing to sacrifice some initial info, but as an example what I have now would generate for example if given the project:

```toml
[project]
name = "project"
version = "0.1.0"
requires-python = ">=3.12"
dependencies = [
    "iniconfig",
    "pip",
    "anyio < 2 ; sys_platform == 'win32'",
    "anyio > 2 ; sys_platform == 'linux'",
    "flask[dotenv,async]",
]

[dependency-groups]
dev = [
    "plotly",
    "pip",
]
test = [
    "pytest",
]
```

you would get the following (heavily truncated):
```
[
      {
        "name": "project",
        "version": "0.1.0",
        "dependency_type": "project",
        "extras": [],
        "dependencies": [
          {
            "name": "pip",
            "version": "24.0",
            "extra": ""
          },...
       ],
       "group": ""
       },
        ...
      {
        "name": "flask",
        "version": "3.0.2",
        "dependency_type": "direct",
        "extras": [
          "async",
          "dotenv"
        ],
        "dependencies": [
          {
            "name": "python-dotenv",
            "version": "1.0.1",
            "extra": "dotenv"
          },
          {
            "name": "asgiref",
            "version": "3.8.1",
            "extra": "async"
          },
       ],
       group: "",
      },
      {
        "name": "pip",
        "version": "24.0",
        "dependency_type": "direct",
        "extras": [],
        "dependencies": [],
        "group": "dev"
      },
      ...
]
```

If people are okay with that or don't care within a day or so I'll start finalizing this including some flag logic (for example --invert makes no sense with json formats)

---

_Comment by @woodruffw on 2025-11-20 19:07_

Triage: https://github.com/astral-sh/uv/pull/16523 added JSON formatted SBOM support to `uv export`, which we encourage over the pip compatibility layer for users who are already using uv lockfiles ðŸ™‚

---
