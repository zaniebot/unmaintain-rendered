<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to Configure Different Sources for Different `dependency-groups` Like `optional-dependencies` - astral-sh/uv #11941</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>How to Configure Different Sources for Different <code>dependency-groups</code> Like <code>optional-dependencies</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11941">#11941</a>
        opened by <a href="https://github.com/pplmx">@pplmx</a>
        on 2025-03-04 05:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/pplmx">@pplmx</a></div>
            <div class="timeline-body">Question
My Configuration:
<pre><code># ...

[dependency-groups]
cuda = [
    &quot;torch&gt;=2.6.0&quot;,
    &quot;megatron-core&quot;,
]
custom = [
    &quot;torch&quot;,
    &quot;megatron-core&quot;,
]

[tool.uv.sources]
megatron-core = [
    { git = &quot;https://github.com/NVIDIA/Megatron-LM&quot;, tag = &quot;core_r0.8.0&quot;, extra = &quot;cuda&quot; },
    { git = &quot;http://xxx.git&quot;, branch = &quot;main&quot;, extra = &quot;custom&quot; },
]
torch = { url = &quot;http://xxx.whl&quot;, extra = &quot;custom&quot; }

# ...
</code></pre>
<p>Currently, this configuration throws an error because <code>extra</code> seems to only support <code>optional-dependencies</code>. Is there a way to configure extra sources for different <code>dependency-groups</code> in a similar manner? Any suggestions or workarounds would be greatly appreciated!</p>
Log
<pre><code>$ uv sync
Using CPython 3.10.12 interpreter at: /usr/bin/python3.10
Creating virtual environment at: .venv
error: Failed to generate package metadata for `megatron-test==0.0.1 @ editable+.`
  Caused by: Source entry for `megatron-core` only applies to extra `cuda`, but the `cuda` extra does not exist. When an extra is present on a source (e.g., `extra = &quot;cuda&quot;`), the relevant package must be included in the `project.optional-dependencies` section for that extra (e.g., `project.optional-dependencies = { &quot;cuda&quot; = [&quot;megatron-core&quot;] }`).
</code></pre>
Platform
<p>Ubuntu 22.04</p>
Version
<p>uv 0.6.4</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/pplmx">@pplmx</a> on 2025-03-04 05:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pplmx">@pplmx</a> on 2025-03-04 06:22</div>
            <div class="timeline-body"><p>I&#x27;ve found the solution! The <code>dependency-groups</code> use <code>group</code> for identification.</p>
<p>Hereâ€™s the correct configuration:</p>
<pre><code># ...

[dependency-groups]
cuda = [
    &quot;torch&gt;=2.6.0&quot;,
    &quot;megatron-core&quot;,
]
custom = [
    &quot;torch&quot;,
    &quot;megatron-core&quot;,
]

[tool.uv]
conflicts = [
    [
        { group = &quot;cuda&quot; },
        { group = &quot;custom&quot; },
    ],
]

[tool.uv.sources]
megatron-core = [
    { git = &quot;https://github.com/NVIDIA/Megatron-LM&quot;, tag = &quot;core_r0.8.0&quot;, group = &quot;cuda&quot; },
    { git = &quot;http://xxx.git/&quot;, branch = &quot;main&quot;, group = &quot;custom&quot; },
]
torch = { url = &quot;http://xxx.whl/&quot;, group = &quot;custom&quot; }

# ...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/pplmx">@pplmx</a> on 2025-03-04 06:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;How to Configure Extra Sources for Different `dependency-groups` Like `optional-dependencies`&quot; to &quot;How to Configure Different Sources for Different `dependency-groups` Like `optional-dependencies`&quot; by <a href="https://github.com/pplmx">@pplmx</a> on 2025-03-04 06:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pplmx">@pplmx</a> on 2025-03-04 07:04</div>
            <div class="timeline-body"><p>Hi @team,</p>
<p>I think it would be helpful to add more documentation on <code>dependency-groups</code> and the use of <code>group</code>. The solution I provided is based on my best guess, as I couldn&#x27;t find direct documentation on configuring <code>uv.sources</code> with <code>group</code>.</p>
<p>The only reference to <code>group</code> I found in the documentation is in the <strong>conflicts</strong> section: <a href="https://docs.astral.sh/uv/concepts/projects/config/#conflicting-dependencies">Conflicting Dependencies</a>.</p>
<p>Clarifying this in the official docs would be greatly appreciated! ðŸš€</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leo2www">@leo2www</a> on 2025-11-04 06:52</div>
            <div class="timeline-body"><p><a href="https://docs.astral.sh/uv/guides/integration/pytorch/#configuring-accelerators-with-optional-dependencies">Configuring accelerators with optional dependencies</a>
I think this doc is good example of multi source, conficts and command running.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:37:35 UTC
    </footer>
</body>
</html>
