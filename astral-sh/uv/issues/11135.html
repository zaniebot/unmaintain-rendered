<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv fails to install package (binary wheel) from internal index while pip succeeds - astral-sh/uv #11135</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv fails to install package (binary wheel) from internal index while pip succeeds</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/11135">#11135</a>
        opened by <a href="https://github.com/kzorba">@kzorba</a>
        on 2025-01-31 17:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kzorba">@kzorba</a> on 2025-01-31 17:01</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hello,</p>
<p>We have an internal company index and have developed a Python C extension module that is available on the index as a binary wheel (multilinux like <code>&lt;module&gt;-0.1.1-cp310-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_28_x86_64.whl</code>).</p>
<p>pip (22.0.2) installs the package fine</p>
<pre><code>
# kzorba @ kzorba-dev01 in ~/WorkingArea/&lt;project&gt; on git:&lt;branch&gt; x std-venv [16:34:24]
$ pip install -i &lt;internal_index_url&gt; --no-cache-dir &lt;module&gt;
Looking in indexes: &lt;internal_index_url&gt;
Collecting &lt;module&gt;
  Downloading &lt;internal_index_url&gt;/%2Bf/177/6c35106dc4acc/&lt;module&gt;-0.1.1-cp310-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_28_x86_64.whl (60 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 60.9/60.9 KB 167.9 MB/s eta 0:00:00
Installing collected packages: &lt;module&gt;
Successfully installed &lt;module&gt;-0.1.1
(std-venv)
 
</code></pre>
<p>Unfortunately uv fails on the same installation:</p>
<pre><code>$ uv pip install -v --index &lt;internal_index_url&gt; &lt;module&gt;
DEBUG uv 0.5.20
DEBUG Searching for default Python interpreter in virtual environments
DEBUG Found `cpython-3.10.12-linux-x86_64-gnu` at `/home/kzorba/WorkingArea/&lt;project&gt;/venv/dev-3.10/bin/python3` (active virtual environment)
Using Python 3.10.12 environment at: venv/dev-3.10
DEBUG Acquired lock for `venv/dev-3.10`
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.10.12
DEBUG Solving with target Python version: &gt;=3.10.12
DEBUG Adding direct dependency: &lt;module&gt;*
DEBUG Found stale response for: &lt;internal_index_url&gt;/&lt;module&gt;
DEBUG Sending revalidation request for: &lt;internal_index_url&gt;/&lt;module&gt;
DEBUG Found modified response for: &lt;internal_index_url&gt;/&lt;module&gt;
WARN Skipping file for &lt;module&gt;:
WARN Skipping file for &lt;module&gt;:
WARN Skipping file for &lt;module&gt;:
WARN Skipping file for &lt;module&gt;: +searchhelp
WARN Skipping file for &lt;module&gt;: +status
WARN Skipping file for &lt;module&gt;: 0.1.1
WARN Skipping file for &lt;module&gt;: &lt;module&gt;
WARN Skipping file for &lt;module&gt;: latest
WARN Skipping file for &lt;module&gt;: packages
WARN Skipping file for &lt;module&gt;: pypi
WARN Skipping file for &lt;module&gt;: stable
WARN Skipping file for &lt;module&gt;: stable
DEBUG Searching for a compatible version of &lt;module&gt; (*)
DEBUG No compatible version found for: &lt;module&gt;
  × No solution found when resolving dependencies:
  ╰─▶ Because there are no versions of &lt;module&gt; and you require &lt;module&gt;, we can conclude that your requirements are unsatisfiable.

      hint: `&lt;module&gt;` was found on &lt;internal_index_url&gt;, but not at the requested version (all versions of &lt;module&gt;).
      A compatible version may be available on a subsequent index (e.g., https://pypi.org/simple). By default, uv will only consider versions that
      are published on the first index that contains a given package, to avoid dependency confusion attacks. If all indexes are equally trusted,
      use `--index-strategy unsafe-best-match` to consider all versions from all indexes, regardless of the order in which they were defined.
DEBUG Released lock at `/home/kzorba/WorkingArea/&lt;project&gt;/venv/dev-3.10/.lock`
</code></pre>
<p>My understanding is that something is wrong with the html info of the internal index. Issue #11089 seems similar.</p>
<p>How can I help with further investigation? This issue will prevent us from using <code>uv</code> in our project and we are already hooked with it :)</p>
<p>Best regards</p>
<h3>Platform</h3>
<p>Linux 5.15.0-113-generic x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.5.20</p>
<h3>Python version</h3>
<p>Python &gt;= 3.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @kzorba on 2025-01-31 17:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kzorba">@kzorba</a> on 2025-01-31 17:05</div>
            <div class="timeline-body"><p>Just tested with latest uv version (0.5.26) and the problem is still there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-31 17:07</div>
            <div class="timeline-body"><p>What kind of index server are you using?</p>
<p>If you access the index without authentication does it return a 404 / 403 / 401 (etc.) or does it just return an empty list of packages?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-01-31 17:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-31 17:16</div>
            <div class="timeline-body"><p>Are you using the <code>/simple</code> endpoint for your index?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kzorba">@kzorba</a> on 2025-01-31 17:21</div>
            <div class="timeline-body"><p>Here is the relevant html that I receive from the package endpoint (sensitive info removed), hope it helps. Thanks for the amazing response time!</p>
<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;packages/stable/: &lt;module&gt; versions&lt;/title&gt;
        
    
    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://&lt;internal_host&gt;/+static-4.0.8/style.css&quot; /&gt;
    

    
    &lt;script src=&quot;https://&lt;internal_host&gt;/+static-4.0.8/jquery-1.11.1.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://&lt;internal_host&gt;/+static-4.0.8/moment-2.8.2.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://&lt;internal_host&gt;/+static-4.0.8/common.js&quot;&gt;&lt;/script&gt;
    


    &lt;/head&gt;
    &lt;body&gt;
        
    &lt;div class=&quot;header&quot;&gt;
        
    &lt;form method=&quot;get&quot; id=&quot;search&quot; action=&quot;https://&lt;internal_host&gt;/+search&quot;&gt;
        
    &lt;h1&gt;&lt;a href=&quot;https://&lt;internal_host&gt;/&quot;&gt;devpi&lt;/a&gt;&lt;/h1&gt;

        &lt;input type=&quot;text&quot; size=&quot;60&quot; name=&quot;query&quot; autofocus /&gt;
        &lt;input type=&quot;submit&quot; value=&quot;Search&quot; /&gt;
        &lt;span class=&quot;help&quot;&gt;
            &lt;a href=&quot;https://&lt;internal_host&gt;/+searchhelp&quot;&gt;How to&lt;br /&gt; search?&lt;/a&gt;
        &lt;/span&gt;
        &lt;div class=&quot;query_doc inline&quot; style=&quot;display: none&quot;&gt;
            &lt;span class=&quot;help&quot;&gt;
                &lt;a href=&quot;#&quot;&gt;Close help&lt;/a&gt;
            &lt;/span&gt;
            
    &lt;p&gt;
                To specify a term which contains spaces, use single quotes like this:
                &lt;code&gt;'term with spaces'&lt;/code&gt;&lt;/p&gt;
    &lt;p&gt;
                By using a search like &lt;code&gt;fieldname:term&lt;/code&gt;,
                you can search in the following fields:&lt;br /&gt;&lt;dl&gt;&lt;dt&gt;&lt;code&gt;classifiers&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;
                The &lt;a href=&quot;https://pypi.org/pypi?%3Aaction=list_classifiers&quot; target=&quot;_blank&quot;&gt;trove classifiers&lt;/a&gt; of a package.
                Use single quotes to specify a classifier, as they contain spaces:
                &lt;code&gt;classifiers:'Programming Language :: Python :: 3'&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;index&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;The name of the index. This is only the name part, without the user. For example: &lt;code&gt;index:pypi&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;keywords&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;The keywords of a package.&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;name&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;The package name. For example: &lt;code&gt;name:devpi-client&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;path&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;The path of the package in the form '/{user}/{index}/{name}'.  For example: &lt;code&gt;path:/root/pypi/devpi-server&lt;/code&gt;&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;serial&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;Undocumented&lt;/dd&gt;&lt;dt&gt;&lt;code&gt;type&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;
                The type of text.
                One of &lt;code&gt;project&lt;/code&gt; for the project name,
                &lt;code&gt;title&lt;/code&gt; for the title of a documentation page,
                &lt;code&gt;page&lt;/code&gt; for a documentation page,
                or one of the following project metadata fields:
                &lt;code&gt;author&lt;/code&gt;, &lt;code&gt;author_email&lt;/code&gt;,
                &lt;code&gt;description&lt;/code&gt;, &lt;code&gt;keywords&lt;/code&gt;,
                &lt;code&gt;summary&lt;/code&gt;. For example: &lt;code&gt;type:page&lt;/code&gt;
                &lt;/dd&gt;&lt;dt&gt;&lt;code&gt;user&lt;/code&gt;&lt;/dt&gt;&lt;dd&gt;The user name.&lt;/dd&gt;&lt;/dl&gt;&lt;/p&gt;
    &lt;p&gt;
                End a term with an asterisk to search by prefix like this: &lt;code&gt;path:/fschulze/*&lt;/code&gt;&lt;/p&gt;
    &lt;p&gt;
                Group query clauses with parentheses.&lt;/p&gt;
    &lt;p&gt;
                Use the &lt;code&gt;AND&lt;/code&gt;, &lt;code&gt;OR&lt;/code&gt;,
                &lt;code&gt;ANDNOT&lt;/code&gt;, &lt;code&gt;ANDMAYBE&lt;/code&gt;, and &lt;code&gt;NOT&lt;/code&gt;&lt;br /&gt;
                operators to further refine your search.&lt;br /&gt;
                Write them in all capital letters, otherwise they will be interpreted as search terms.&lt;br /&gt;
                An example search would be: &lt;code&gt;devpi ANDNOT client&lt;/code&gt;&lt;/p&gt;
    &lt;p&gt;
                Boost a term by adding a circumflex followed by the boost value like this:
                &lt;code&gt;term^2&lt;/code&gt;&lt;/p&gt;

        &lt;/div&gt;
    &lt;/form&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
    //&lt;![CDATA[
        $(function() {
            $('.help a').click(function() {
                var $help = $('.query_doc.inline');
                // is there a docview iframe?
                var $iframe = $('iframe');
                if ($iframe.length &amp;&amp; $help.is(':hidden')) {
                    // then hide the iframe's scrollbar
                    // (double scrollbar doesn't look nice)
                    $('body', $iframe[0].contentWindow.document
                      ).css('overflow', 'hidden');
                }
                $help.slideToggle({
                    complete: function () {
                        if ($iframe.length &amp;&amp; $help.is(':hidden')) {
                            // give focus and scrollbar back to iframe
                            var iframeWindow = $iframe[0].contentWindow;
                            iframeWindow.focus();
                            $('body', iframeWindow.document
                              ).css('overflow', 'auto');
                        }
                    }
                });
                return false;
            });
        });
    //]]&gt;
    &lt;/script&gt;

        &lt;div id=&quot;navigation&quot;&gt;
            &lt;span&gt;
                &lt;a href=&quot;https://&lt;internal_host&gt;/&quot;&gt;devpi&lt;/a&gt;
            &lt;/span&gt;
            &lt;span&gt;
                &lt;a href=&quot;https://&lt;internal_host&gt;/packages&quot;&gt;packages&lt;/a&gt;
            &lt;/span&gt;
            &lt;span&gt;
                &lt;a href=&quot;https://&lt;internal_host&gt;/packages/stable&quot;&gt;stable&lt;/a&gt;
            &lt;/span&gt;
            &lt;span&gt;
                &lt;a href=&quot;https://&lt;internal_host&gt;/packages/stable/&lt;module&gt;&quot;&gt;&lt;module&gt;&lt;/a&gt;
            &lt;/span&gt;
            
    &lt;a class=&quot;statusbadge ok&quot;
       href=&quot;https://&lt;internal_host&gt;/+status&quot;&gt;
        ok
    &lt;/a&gt;

        &lt;/div&gt;
        
    

        
    &lt;/div&gt;

        &lt;div id=&quot;content&quot;&gt;
        &lt;h1&gt;packages/stable/: &lt;module&gt; versions&lt;/h1&gt;

        &lt;p class=&quot;infonote&quot;&gt;
            Because this project isn't in the &lt;code&gt;mirror_whitelist&lt;/code&gt;,
            no releases from &lt;strong&gt;root/pypi&lt;/strong&gt; are included.
        &lt;/p&gt;

        &lt;p&gt;Latest version on stage is: &lt;a href=&quot;https://&lt;internal_host&gt;/packages/stable/&lt;module&gt;/latest&quot;&gt;0.1.1&lt;/a&gt;&lt;/p&gt;

        &lt;p&gt;Python C extension module &lt;rest of module description&gt; &lt;/p&gt;

        &lt;table class=&quot;versions&quot;&gt;
            &lt;thead&gt;
                &lt;tr&gt;
                    &lt;th&gt;Index&lt;/th&gt;
                    &lt;th&gt;Version&lt;/th&gt;
                    &lt;th&gt;Documentation&lt;/th&gt;
                &lt;/tr&gt;
            &lt;/thead&gt;
            &lt;tbody&gt;
                &lt;tr&gt;
                    &lt;td&gt;&lt;a href=&quot;https://&lt;internal_host&gt;/packages/stable&quot;&gt;packages/stable&lt;/a&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;a href=&quot;https://&lt;internal_host&gt;/packages/stable/&lt;module&gt;/0.1.1&quot;&gt;0.1.1&lt;/a&gt;&lt;/td&gt;
                    &lt;td&gt;&lt;/td&gt;
                &lt;/tr&gt;
            &lt;/tbody&gt;
        &lt;/table&gt;
        &lt;/div&gt;
        
    &lt;footer&gt;
        
        
    &lt;ul class=&quot;footer-versions&quot;&gt;
        &lt;li&gt;devpi-server-6.5.1&lt;/li&gt;
        &lt;li&gt;devpi-web-4.0.8&lt;/li&gt;
    &lt;/ul&gt;

    &lt;/footer&gt;

    &lt;/body&gt;
&lt;/html&gt;

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kzorba">@kzorba</a> on 2025-01-31 17:27</div>
            <div class="timeline-body"><p>We have 3 &quot;directories&quot; for dev, staging, production/stable packages, I use a url like</p>
<p><code>https://&lt;index_host&gt;/packages/stable</code></p>
<p>No http auth, I can access this directly from the internal machines. Hopefully this answers your question.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-31 17:30</div>
            <div class="timeline-body"><p>We expect a <a href="https://packaging.python.org/en/latest/specifications/simple-repository-api/#base-html-api">Simple API</a> compliant result, e.g., <code>view-source:pypi.org/simple/anyio/</code></p>
<p>It looks like you're using devpi. devpi serves a non-complaint index (which I believe there is legacy support for in pip) at its root path. I think you need to add <code>/+simple</code> to the end of your index URL.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kzorba">@kzorba</a> on 2025-01-31 17:31</div>
            <div class="timeline-body"><p>Using</p>
<p><code>https://&lt;internal_index_host&gt;/packages/stable/+simple/</code></p>
<p>solved it!!!!</p>
<p>Thanks a lot, keep up the excellent work :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-31 17:34</div>
            <div class="timeline-body"><p>Yep no problem.</p>
<p>We're tracking support for that index type in https://github.com/astral-sh/uv/issues/4907</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-01-31 17:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11136.html">astral-sh/uv#11136</a> on 2025-01-31 17:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11276.html">astral-sh/uv#11276</a> on 2025-02-06 11:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ada-lave">@Ada-lave</a> on 2025-02-06 11:13</div>
            <div class="timeline-body"><p>Thx</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:02 UTC
    </footer>
</body>
</html>
