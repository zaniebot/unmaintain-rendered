<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error when building PyTorch from source - astral-sh/uv #13436</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Error when building PyTorch from source</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13436">#13436</a>
        opened by <a href="https://github.com/cora-codes">@cora-codes</a>
        on 2025-05-13 19:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cora-codes">@cora-codes</a> on 2025-05-13 19:28</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I'm using the latest version of UV.</p>
<p><code>uv add --editable external/pytorch/</code></p>
<p>Gives the following error:</p>
<pre><code>  × Failed to build `torch @ file:///home/ubuntu/pytorch`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.prepare_metadata_for_build_editable` failed (exit
      status: 1)

      [stdout]
      -- Configuring incomplete, errors occurred!
      Building wheel torch-2.8.0a0+git20ba8fe
      -- Building version 2.8.0a0+git20ba8fe
      -- Checkout nccl release tag: v2.26.2-1
      cmake -GNinja -DBUILD_PYTHON=True -DBUILD_TEST=True -DCMAKE_BUILD_TYPE=Release
      -DCMAKE_INSTALL_PREFIX=/home/ubuntu/pytorch/torch
      -DCMAKE_PREFIX_PATH=/home/ubuntu/.cache/uv/builds-v0/.tmpiKso57/lib/python3.10/site-packages
      -DPython_EXECUTABLE=/home/ubuntu/.cache/uv/builds-v0/.tmpiKso57/bin/python
      -DTORCH_BUILD_VERSION=2.8.0a0+git20ba8fe -DUSE_NUMPY=True
      /home/ubuntu/pytorch

      [stderr]
      CMake Error at CMakeLists.txt:26 (project):
        Running

         '/home/ubuntu/.cache/uv/builds-v0/.tmpVYbIyZ/bin/ninja' '--version'

        failed with:

         no such file or directory



      hint: This usually indicates a problem with the package or the build environment.
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen`
        flag to skip locking and syncing.
</code></pre>
<p>Could be related to build isolation or something? I've tried cleaning the uv cache and I've ensured that ninja and cmake are installed and up to date.</p>
<h3>Platform</h3>
<p><em>No response</em></p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @cora-codes on 2025-05-13 19:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cora-codes">@cora-codes</a> on 2025-05-13 19:44</div>
            <div class="timeline-body"><p>Just documenting other issues that have came up:</p>
<ol>
<li>I needed to manually install typing extentions, pyyaml and pybind11 (<code>uv add typing_extensions pyyaml pybind11</code>). I also installed ninja and cmake, but I'm unsure if this is best practice or if apt should be used to install them instead.</li>
<li><code>make clean</code> inside the pytorch directory fixed the error above</li>
<li><code>CUDA::cuFile</code> can't be found as a target (I believe this is an issue with poetry too). <code>USE_CUFILE</code> can be turned off, but there isn't a way to have uv automatically set this env variable (yet)</li>
</ol>
<p>I'm leaving the issue open since it would be nice to make this workflow less painful (by which I mean installing pytorch from source). It's very possible I am missing something and that's why I'm hitting these issues, but I can also believe most people are happy with just using the wheels and so this hasn't been done much (or <code>uv pip</code> is used instead)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-13 20:59</div>
            <div class="timeline-body"><p>PyTorch is a complex, hard to build project with gotchas around different build systems and CUDA versions. You'll likely have a better time following https://github.com/pytorch/pytorch/blob/main/CONTRIBUTING.md than approaching this through uv, which can only use PEP 517.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cora-codes">@cora-codes</a> on 2025-05-13 21:23</div>
            <div class="timeline-body"><p>Yes, I am very familiar with the complexity of building PyTorch. I guess I optimistically see a future where uv can build it from source (perhaps with some patches to PyTorch which I'd be happy to submit)...</p>
<p>Also, flash attention works which has a similar level of complexity?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:06 UTC
    </footer>
</body>
</html>
