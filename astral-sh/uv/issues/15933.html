<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interrupted self update will result in incomplete binary file - astral-sh/uv #15933</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Interrupted self update will result in incomplete binary file</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/15933">#15933</a>
        opened by <a href="https://github.com/criyle">@criyle</a>
        on 2025-09-18 14:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/criyle">@criyle</a> on 2025-09-18 14:05</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I was doing <code>uv self update</code> after I logged to a remote host in vs code, but it was interrupted by vs code because it wants to activate virtual environment for that terminal. Then the uv binary becomes incomplete and running the command will result in <code>segment fault</code>. I suspect the update is not atomic operation.</p>
<h3>Platform</h3>
<p>Red Hat Enterprise Linux 9.4 (Plow)</p>
<h3>Version</h3>
<p>uv 0.8.16</p>
<h3>Python version</h3>
<p>Python 3.12.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @criyle on 2025-09-18 14:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-18 14:12</div>
            <div class="timeline-body"><p>cc @Gankra</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EliteTK">@EliteTK</a> on 2026-01-09 14:56</div>
            <div class="timeline-body"><p>At least on linux, when the installer script does the <a href="https://github.com/axodotdev/cargo-dist/blob/5ae4cffc4ecf4f4d26b4d4e6970cad0f63cb0931/cargo-dist/templates/installer/installer.sh.j2#L641C16-L641C18">mv into the final location</a>, it does so from a tempdir, which can be on a different filesystem, in those cases we'll end up copying it rather than renaming it. So I think the fix there might just be to &quot;move&quot; to a temporary file in the same directory first before moving that file over the target binary/library. But we use cargo-dist for this?</p>
<p>Do we want to keep the fix in-tree, or should we report it upstream?</p>
<p>I could also be wrong and the issue could be somewhere else, but so far I couldn't find anything else which stuck out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zsyo">@zsyo</a> on 2026-01-12 05:55</div>
            <div class="timeline-body"><p>The same here, in the Windows environment, when running uv self update, the download was interrupted halfway through the network. When executing uv self update again, it reported an error</p>
<pre><code>~ ‚ùØ uv self update

uv: The term 'uv' is not recognized as a name of a cmdlet, function, script file, or executable program.

Check the spelling of the name, or if a path was included, verify that the path is correct and try again.
</code></pre>
<p>I found that <code>uv.exe</code> in the installation directory was renamed to <code>uv.exe.previous.exe</code>, and because of network issues, I used Ctrl+C to terminate the download program, which may have resulted in <code>uv.exe.previous.exe</code> not being restored to <code>uv.exe</code>. I think this update logic violates common sense. It seems more reasonable to first download the new file completely, and then move it to overwrite the old file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2026-01-12 11:29</div>
            <div class="timeline-body"><blockquote>
<p>Do we want to keep the fix in-tree, or should we report it upstream?</p>
</blockquote>
<p>I'd try reporting in axoupdater first.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 11:58:05 UTC
    </footer>
</body>
</html>
