<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add a `--universal-strategy`-like setting to the resolver - astral-sh/uv #7190</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add a <code>--universal-strategy</code>-like setting to the resolver</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7190">#7190</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-09-08 15:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-08 15:13</div>
            <div class="timeline-body"><p>In the universal resolver, we prioritize solving for as few versions as possible. Sometimes, users instead want to get the <em>newest</em> possible version for every fork (e.g., they'd prefer getting the newest versions of <code>foo</code> for Python 3.10+, even if it means they have two versions of <code>foo</code> in the lockfile, one for Python 3.9 and earlier, and one for Python 3.10 and later).</p>
<p>(<code>--universal-strategy</code> is obviously a bad name.)</p>
<p>One implementation of this would be to ignore preferences from other forks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">resolver</span> added by @charliermarsh on 2024-09-08 15:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2024-10-29 17:01</div>
            <div class="timeline-body"><p>I'd even think this might be a nice default. Currently, the following simple example:</p>
<pre><code class="language-console">$ mkdir example
$ cd example
$ cat &gt; pyproject.toml &lt;&lt; EOL
[project]
name = &quot;example&quot;
version = &quot;0.1&quot;
requires-python = &quot;&gt;=3.8&quot;
dependencies = [&quot;numpy&quot;]
EOL
$ uv run python
Resolved 2 packages in 7ms
error: Failed to prepare distributions
  Caused by: Failed to download and build `numpy==1.24.4`
  Caused by: Build backend failed to determine requirements with `build_wheel()` (exit status: 1)

[stderr]
Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 8, in &lt;module&gt;
  File &quot;/Users/henryschreiner/.cache/uv/builds-v0/.tmpjYjj2d/lib/python3.12/site-packages/setuptools/__init__.py&quot;, line 10, in &lt;module&gt;
    import distutils.core
ModuleNotFoundError: No module named 'distutils'
  Caused by: distutils was removed from the standard library in Python 3.12. Consider adding a constraint (like `numpy &gt;1.24.4`) to avoid building a version of numpy that depends on distutils.
</code></pre>
<p>will break on Python 3.12 and newer. Any package that supports a narrower range than you do (and packages should be allowed to stop supporting old Python versions) will cause you do never get updates, and updates are often required for new Python versions.</p>
<p>This is one of the biggest drawbacks of a universal solver, as most users starting out don't realize that &quot;dependencies = [&quot;numpy&quot;]` isn't going to give them the latest version on the version of Python they are running. I think this would really reduce the friction when starting out.</p>
<p>See https://github.com/astral-sh/uv/issues/8492 also.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-10-29 17:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-12-13 21:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:42 UTC
    </footer>
</body>
</html>
