<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv managed python fails installing `sasl` dependency with python 3.9.18 - astral-sh/uv #12283</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv managed python fails installing `sasl` dependency with python 3.9.18</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/12283">#12283</a>
        opened by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a>
        on 2025-03-18 14:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-03-18 14:46</div>
            <div class="timeline-body"><h3>Summary</h3>
<h2>How to reproduce</h2>
<pre><code>uvx --python 3.9.18 sasl
</code></pre>
<h2>Error</h2>
<p>Error contains the following:</p>
<pre><code>      [stderr]
      &lt;string&gt;:34: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      &lt;string&gt;:35: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      sasl/saslwrapper.cpp:624:10: fatal error: 'ios' file not found
        624 | #include &quot;ios&quot;
            |          ^~~~~
      1 error generated.
      error: command '/usr/bin/c++' failed with exit code 1

      hint: This usually indicates a problem with the package or the build environment.
</code></pre>
<h2>Impact</h2>
<p>Installing the same library with pyenv python 3.9.18 works fine. This prevents me migrating some projects to use <code>uv</code>.</p>
<h3>Platform</h3>
<p>macOS 15.3.2 arm64</p>
<h3>Version</h3>
<p>uv 0.6.3 (a0b9f22a2 2025-02-24)</p>
<h3>Python version</h3>
<p>Python 3.9.18</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ignacio-amaya-rovio on 2025-03-18 14:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-18 14:58</div>
            <div class="timeline-body"><p>When you use pyenv, I presume the package is still built from source? Can you share logs for that?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-03-19 12:03</div>
            <div class="timeline-body"><p>With pyenv I set in <code>~/.config/uv/uv.toml</code> the following setting so that it would use pyenv python:</p>
<pre><code>python-preference = &quot;only-system&quot;
</code></pre>
<p>Then running the same command <code>uvx --python 3.9.18 sasl</code> I get the following:</p>
<pre><code>‚ùØ uvx --python 3.9.18 sasl
      Built sasl==0.3.1
Installed 2 packages in 18ms
The executable `sasl` was not found.
warning: Package `sasl` does not provide any executables.
</code></pre>
<p>Package was properly installed and a warning is printed as there is no executable as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-03-26 15:58</div>
            <div class="timeline-body"><p>How can I try to fix these C++ issues with the uv managed python? With pyenv or brew python solution is usually to install additional packages using <code>brew</code>, but I am not sure how to fix these in <code>uv</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-01 19:31</div>
            <div class="timeline-body"><p>We need more insight into the <code>sasl</code> build process, which I don't have the time to investigate. I'd recommend getting logs for the build with your pyenv Python and comparing them to the logs for the failing build. Determining if <code>/usr/bin/c++</code> is used would be a good place to start.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-01 19:32</div>
            <div class="timeline-body"><p>We're just calling the system compiler, in a similar way as builds with the pyenv or brew Python would. Sometimes, they set additional flags in <code>sysconfig</code> that are specific to your machine's libraries and such that we can't know about. You could also compare <code>python -m sysconfig</code> values.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-04-15 19:04</div>
            <div class="timeline-body"><p>I was having similar issues with <code>sasl</code> in CI/CD pipeline recently. It seems this was a dependency from <code>pyhive</code> that causes issues (and btw <code>pyhive</code> is out of maintenance). In that case the solution was to get rid of <code>sasl</code> and instead have in toml <code>pyhive[hive_pure_sasl]</code>.</p>
<p>The installation failed with poetry in a container using <code>python:3.9.21-slim-bookworm</code> due to lack of g++ (different error that in the case of <code>uv</code>), but in a container with <code>python:3.9-bookworm</code> the installation works. So my guess is that uv also uses its own <em>slim</em> version that could explain why this failed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-04-15 19:05</div>
            <div class="timeline-body"><p>Also on another note, I can not replicate the error anymore, not sure if something changed on <code>uv</code> side that would explain that, but I did not update my <code>uv</code> version so that is weird ü§∑‚Äç‚ôÇ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-04-15 19:13</div>
            <div class="timeline-body"><p>I wonder if some recent releases in this repo might have fixed this: https://github.com/astral-sh/python-build-standalone</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-17 13:58</div>
            <div class="timeline-body"><p>If you didn't update <code>uv</code>, you wouldn't have a new Python distribution from <code>python-build-standalone</code> (unless something else is managing those)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ignacio-amaya-rovio">@ignacio-amaya-rovio</a> on 2025-04-22 07:40</div>
            <div class="timeline-body"><p>Right, I think I had some things cached, after running <code>uv cache clean</code> I could replicate the issue again.</p>
<p>Anyway, for fixing this issue I guess the simplest thing is to stop using <code>sasl</code>, I guess for other cases where system deps are missing in the uv python distribution it would be nice to have some easy way to be able to install system deps on top of the provided default.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
