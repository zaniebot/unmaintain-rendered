<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip install parse wrong version with &quot;+&quot; - astral-sh/uv #15692</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv pip install parse wrong version with &quot;+&quot;</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15692">#15692</a>
        opened by <a href="https://github.com/cos120">@cos120</a>
        on 2025-09-05 04:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/cos120">@cos120</a> on 2025-09-05 04:16</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hi, I am using uv create env with system</p>
<pre><code class="language-bash">uv venv --relocatable --no-managed-python --system-site-packages test
</code></pre>
<p>And I have installed <code>torch==2.8.0+cu128</code> in my system site, when I use
<code>uv pip install accelerate -v --dry-run</code>, I found uv ignore the version <code>torch==2.8.0+cu128</code></p>
<pre><code class="language-bash">DEBUG Adding transitive dependency for accelerate==1.10.1: torch&gt;=2.0.0
DEBUG Found fresh response for: https://mirrors.aliyun.com/pypi/simple/torch/
DEBUG Found fresh response for: https://mirrors.aliyun.com/pypi/packages/99/a8/6acf48d48838fb8fe480597d98a0668c2beb02ee4755cc136de92a0a956f/torch-2.8.0-cp312-cp312-manylinux_2_28_x86_64.whl
DEBUG Searching for a compatible version of torch (&gt;=2.0.0)
DEBUG Selecting: torch==2.8.0 [compatible] (torch-2.8.0-cp312-cp312-manylinux_2_28_x86_64.whl)
DEBUG Adding transitive dependency for torch==2.8.0: filelock*
DEBUG Adding transitive dependency for torch==2.8.0: typing-extensions&gt;=4.10.0
DEBUG Adding transitive dependency for torch==2.8.0: setuptools{python_full_version &gt;= '3.12'}*
DEBUG Adding transitive dependency for torch==2.8.0: sympy&gt;=1.13.3
DEBUG Adding transitive dependency for torch==2.8.0: networkx*
DEBUG Adding transitive dependency for torch==2.8.0: jinja2*
DEBUG Adding transitive dependency for torch==2.8.0: fsspec*
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cuda-nvrtc-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.8.93, &lt;12.8.93+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cuda-runtime-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.8.90, &lt;12.8.90+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cuda-cupti-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.8.90, &lt;12.8.90+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cudnn-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=9.10.2.21, &lt;9.10.2.21+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cublas-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.8.4.1, &lt;12.8.4.1+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cufft-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=11.3.3.83, &lt;11.3.3.83+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-curand-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=10.3.9.90, &lt;10.3.9.90+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cusolver-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=11.7.3.90, &lt;11.7.3.90+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cusparse-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.5.8.93, &lt;12.5.8.93+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cusparselt-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=0.7.1, &lt;0.7.1+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-nccl-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=2.27.3, &lt;2.27.3+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-nvtx-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.8.90, &lt;12.8.90+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-nvjitlink-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=12.8.93, &lt;12.8.93+
DEBUG Adding transitive dependency for torch==2.8.0: nvidia-cufile-cu12{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=1.13.1.3, &lt;1.13.1.3+
DEBUG Adding transitive dependency for torch==2.8.0: triton{platform_machine == 'x86_64' and sys_platform == 'linux'}&gt;=3.4.0, &lt;3.4.0+
</code></pre>
<p>But I use pip in venv native,</p>
<pre><code class="language-bash">pip install accelerate --break-system-packages --dry-run

Collecting accelerate
  Using cached https://mirrors.aliyun.com/pypi/packages/5f/a0/d9ef19f780f319c21ee90ecfef4431cbeeca95bec7f14071785c17b6029b/accelerate-1.10.1-py3-none-any.whl (374 kB)
Requirement already satisfied: numpy&lt;3.0.0,&gt;=1.17 in /usr/local/lib/python3.12/dist-packages (from accelerate) (1.26.4)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.12/dist-packages (from accelerate) (25.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.12/dist-packages (from accelerate) (7.0.0)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.12/dist-packages (from accelerate) (6.0.2)
Requirement already satisfied: torch&gt;=2.0.0 in /usr/local/lib/python3.12/dist-packages (from accelerate) (2.8.0+cu128)
Requirement already satisfied: huggingface_hub&gt;=0.21.0 in /usr/local/lib/python3.12/dist-packages (from accelerate) (0.34.4)
Requirement already satisfied: safetensors&gt;=0.4.3 in /usr/local/lib/python3.12/dist-packages (from accelerate) (0.6.2)
Requirement already satisfied: filelock in /usr/local/lib/python3.12/dist-packages (from huggingface_hub&gt;=0.21.0-&gt;accelerate) (3.19.1)
Requirement already satisfied: fsspec&gt;=2023.5.0 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub&gt;=0.21.0-&gt;accelerate) (2024.6.1)
Requirement already satisfied: requests in /usr/local/lib/python3.12/dist-packages (from huggingface_hub&gt;=0.21.0-&gt;accelerate) (2.32.5)
Requirement already satisfied: tqdm&gt;=4.42.1 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub&gt;=0.21.0-&gt;accelerate) (4.67.1)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub&gt;=0.21.0-&gt;accelerate) (4.12.2)
Requirement already satisfied: hf-xet&lt;2.0.0,&gt;=1.1.3 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub&gt;=0.21.0-&gt;accelerate) (1.1.9)
Requirement already satisfied: setuptools in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (79.0.1)
Requirement already satisfied: sympy&gt;=1.13.3 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (1.13.3)
Requirement already satisfied: networkx in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (3.3)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (3.1.6)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.8.93 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.8.93)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.8.90 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.8.90)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.8.90 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.8.90)
Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (9.10.2.21)
Requirement already satisfied: nvidia-cublas-cu12==12.8.4.1 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.8.4.1)
Requirement already satisfied: nvidia-cufft-cu12==11.3.3.83 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (11.3.3.83)
Requirement already satisfied: nvidia-curand-cu12==10.3.9.90 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (10.3.9.90)
Requirement already satisfied: nvidia-cusolver-cu12==11.7.3.90 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (11.7.3.90)
Requirement already satisfied: nvidia-cusparse-cu12==12.5.8.93 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.5.8.93)
Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (0.7.1)
Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (2.27.3)
Requirement already satisfied: nvidia-nvtx-cu12==12.8.90 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.8.90)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.8.93 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (12.8.93)
Requirement already satisfied: nvidia-cufile-cu12==1.13.1.3 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (1.13.1.3)
Requirement already satisfied: triton==3.4.0 in /usr/local/lib/python3.12/dist-packages (from torch&gt;=2.0.0-&gt;accelerate) (3.4.0)
Requirement already satisfied: mpmath&lt;1.4,&gt;=1.1.0 in /usr/local/lib/python3.12/dist-packages (from sympy&gt;=1.13.3-&gt;torch&gt;=2.0.0-&gt;accelerate) (1.3.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2-&gt;torch&gt;=2.0.0-&gt;accelerate) (2.1.5)
Requirement already satisfied: charset_normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;huggingface_hub&gt;=0.21.0-&gt;accelerate) (3.4.3)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;huggingface_hub&gt;=0.21.0-&gt;accelerate) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;huggingface_hub&gt;=0.21.0-&gt;accelerate) (2.5.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.12/dist-packages (from requests-&gt;huggingface_hub&gt;=0.21.0-&gt;accelerate) (2025.8.3)
Would install accelerate-1.10.1
</code></pre>
<p>Looks like <code>uv pip install do not parse version with '+'</code>?</p>
<h3>Platform</h3>
<p>Ubuntu24.04 amd64</p>
<h3>Version</h3>
<p>uv 0.8.15</p>
<h3>Python version</h3>
<p>3.12.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @cos120 on 2025-09-05 04:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-05 09:29</div>
            <div class="timeline-body"><p>It's a different problem: uv doesn't see packages in the system site packages, this is a duplicate of #2500. If you want to work around this, you can use a hack by setting an override with <code>torch==2.8.0+cu128; python_version &lt; &quot;0&quot;</code> which makes uv pretend it doesn't need to install torch. This is something I usually wouldn't recommend, I rather recommend installing torch into the venv too, but in some cases it may not be avoidable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cos120">@cos120</a> on 2025-09-05 10:52</div>
            <div class="timeline-body"><p>Thanks for your clearly! I am using uv for building multiple user env based on one readonly system env in my docker image. So if I want to separate multiple env from system, what is the best practice? @konstin</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-05 11:21</div>
            <div class="timeline-body"><p>I would create a venv in the docker image and install both torch and the other packages in that venv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-09-05 15:41</div>
            <div class="timeline-body"><p>Some further reading you may be interested in: https://hynek.me/articles/docker-virtualenv/</p>
<p>There is a general misconception that using a docker image replaces the need to use a virtual environment (venv), but unless the docker image has been very carefully constructed this is often not true, and using a venv is often still useful to produces more consistent  images across multiple builds.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-09-06 02:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:12 UTC
    </footer>
</body>
</html>
