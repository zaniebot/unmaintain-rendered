<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Extras are sometimes not collapsed properly - astral-sh/uv #6062</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Extras are sometimes not collapsed properly</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6062">#6062</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-08-13 17:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>Given:</p>
<pre><code class="language-toml">[project]
name = &quot;foo&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [
    &quot;datasets &lt; 2.19 ; sys_platform == 'darwin' &quot;,
    &quot;datasets &gt;= 2.19 ; sys_platform == 'win32'&quot;
]

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;

</code></pre>
<p>Produces:</p>
<pre><code class="language-toml">[[package]]
name = &quot;datasets&quot;
version = &quot;2.18.0&quot;
source = { registry = &quot;https://pypi.org/simple&quot; }
environment-markers = [
    &quot;sys_platform == 'darwin'&quot;,
]
dependencies = [
    { name = &quot;aiohttp&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;dill&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;filelock&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;fsspec&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;fsspec&quot;, extra = [&quot;http&quot;] },
    { name = &quot;huggingface-hub&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;multiprocess&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;numpy&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;packaging&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;pandas&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;pyarrow&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;pyarrow-hotfix&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;pyyaml&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;requests&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;tqdm&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
    { name = &quot;xxhash&quot;, marker = &quot;sys_platform == 'darwin'&quot; },
]
sdist = { url = &quot;https://files.pythonhosted.org/packages/ff/d5/d0fffd6afdf24c062e3c289f0b13f7636f074005c1e76e322633e8c5508c/datasets-2.18.0.tar.gz&quot;, hash = &quot;sha256:cdf8b8c6abf7316377ba4f49f9589a4c74556d6b481afd0abd2284f3d69185cb&quot;, size = 589972 }
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/95/fc/661a7f06e8b7d48fcbd3f55423b7ff1ac3ce59526f146fda87a1e1788ee4/datasets-2.18.0-py3-none-any.whl&quot;, hash = &quot;sha256:f1bbf0e2896917a914de01cbd37075b14deea3837af87ad0d9f697388ccaeb50&quot;, size = 510519 },
]
</code></pre>
<p>Notice <code>{ name = &quot;fsspec&quot;, extra = [&quot;http&quot;] }</code> alongside <code>{ name = &quot;fsspec&quot;, marker = &quot;sys_platform == 'darwin'&quot; }</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-08-13 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @charliermarsh on 2024-08-13 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-08-13 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-13 17:38</div>
            <div class="timeline-body"><p>That actually doesn't <em>quite</em> repro as-is, I had a change on my branch. Let me find a clearer repro (now that I see the underlying problem).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-13 17:51</div>
            <div class="timeline-body"><p>Edited to include a real repro.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-14 13:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-08-14 13:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:26:08 UTC
    </footer>
</body>
</html>
