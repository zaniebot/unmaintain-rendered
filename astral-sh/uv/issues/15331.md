```yaml
number: 15331
title: Failure to maintain version
type: issue
state: closed
author: afrenkai
labels:
  - question
assignees: []
created_at: 2025-08-17T19:09:07Z
updated_at: 2025-08-21T17:12:10Z
url: https://github.com/astral-sh/uv/issues/15331
synced_at: 2026-01-10T01:57:34Z
```

# Failure to maintain version

---

_Issue opened by @afrenkai on 2025-08-17 19:09_

### Summary

When attempting to use `uv pip install -r` from a file that contains both `datasets` (which has an older version of `huggingface-hub`, `0.31.4`) and `transformers` (which has a newer version, `0.34.4`), the older version persists  no matter what I do. Not sure this is a flaw of uv, or me. I am on a slurm environment, and cannot replicate this behavior on my local linux environment (24.04, or 22.04). Could this be because of the lockfile? I got around this by manually adjusting it. 

For reproducibility, I have a minimal example here. 

## python

```
import huggingface_hub
print(huggingface_hub.__version__)
```

## bash
```
#!/bin/bash
#SBATCH -N 1
#SBATCH -n 8
#SBATCH --mem=32g
#SBATCH -J "hf_hub_test"
#SBATCH -p short
#SBATCH -t 12:00:00
#SBATCH --output="hf_hub_test%j.txt"

set-e
#assumes uv is setup, I have a script for it
CHECK="uv run check_hf_hub.py"
output=$($CHECK)
fname='requirements.txt'
if [ ! -f "$fname" ]; then
    echo "no reqs"
    exit 1
else
    echo "reqs found"
    while read line; do
        echo "$line"
        uv pip install -r "$line"
        echo "$output"
    done
fi
```

### Platform

Ubuntu 20.04.6 LTS (GNU/ Linux 5.4.0-216-generic x86_64)

### Version

uv 0.8.11

### Python version

Python 3.12.10

---

_Label `bug` added by @afrenkai on 2025-08-17 19:09_

---

_Comment by @charliermarsh on 2025-08-21 12:47_

Have you tried the `--upgrade` flag?

---

_Label `bug` removed by @charliermarsh on 2025-08-21 12:47_

---

_Label `question` added by @charliermarsh on 2025-08-21 12:47_

---

_Comment by @zanieb on 2025-08-21 12:49_

It sounds like you might be installing with `uv pip install -r` then undoing it with `uv run`? hard to say without a simpler example of what you're doing

---

_Comment by @zanieb on 2025-08-21 12:51_

Perhaps you want `uv run --no-sync`?

---

_Comment by @afrenkai on 2025-08-21 17:12_

`--upgrade` remedied this, closing. Much appreciated.

---

_Closed by @afrenkai on 2025-08-21 17:12_

---
