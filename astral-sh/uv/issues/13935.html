<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv python pin` crashes trying to inspect another Python - astral-sh/uv #13935</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv python pin` crashes trying to inspect another Python</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13935">#13935</a>
        opened by <a href="https://github.com/geofft">@geofft</a>
        on 2025-06-09 21:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/geofft">@geofft</a> on 2025-06-09 21:53</div>
            <div class="timeline-body"><p><a href="https://discord.com/channels/1039017663004942429/1381692679439519846">This question in #help on Discord</a> is fundamentally about #13288, that we misdetect (32-bit) arm vs. armhf and install the wrong Python variant. But as part of that question I asked,</p>
<blockquote>
<p>are you able to work around it with <code>uv python pin</code> (maybe <code>--global</code>) or something?</p>
</blockquote>
<p>to which the reply was</p>
<blockquote>
<p>nope. It's trying to test the non-hf version before it even pins</p>
</blockquote>
<pre><code>$ uv python pin cpython-3.13.4-linux-armv7-gnueabihf
error: Failed to inspect Python interpreter from managed installations at `/home/frank/.local/share/uv/python/cpython-3.13.4-linux-armv7-gnueabi/bin/python3.13`
  Caused by: Querying Python at `/home/frank/.local/share/uv/python/cpython-3.13.4-linux-armv7-gnueabi/bin/python3.13` failed with exit status signal: 8 (SIGFPE)
</code></pre>
<p>which also seems like a bug.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-09 21:58</div>
            <div class="timeline-body"><p>This is because we attempt to find a Python installation matching the request after pinning</p>
<p>https://github.com/astral-sh/uv/blob/7dd564d3d09668488c179b02bfe446754e58a5ea/crates/uv/src/commands/python/pin.rs#L101-L114</p>
<p>We only query this interpreter because we fail to detect the proper architecture? Or it'd be filtered from the list.</p>
<p>Regardless, we should be able to eagerly avoid querying this interpreter here because the key clearly doesn't match the request?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2025-06-09 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/13936.html">astral-sh/uv#13936</a> on 2025-06-09 22:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kageurufu">@kageurufu</a> on 2025-06-09 23:44</div>
            <div class="timeline-body"><details><summary>If it helps, with RUST_LOG=trace</summary>

<pre><code>frank@ganymede:~ $ RUST_LOG=trace uv python pin cpython-3.13.4-linux-armv7-gnueabihf
DEBUG uv 0.7.12
DEBUG Failed to discover virtual project: No `pyproject.toml` found in current directory or any parent directory
DEBUG No Python version file found in ancestors of working directory: /home/frank
DEBUG Searching for cpython-3.13.4-linux-armv7-gnueabihf in managed installations or search path
DEBUG Searching for managed installations at `.local/share/uv/python`
TRACE Found `ld` path: /lib/ld-linux-armhf.so.3
TRACE stdout output from `ld`: &quot;&quot;
TRACE stderr output from `ld`: &quot;/lib/ld-linux-armhf.so.3: missing program name\nTry '/lib/ld-linux-armhf.so.3 --help' for more information.\n&quot;
TRACE Tried to find musl version by running `&quot;/lib/ld-linux-armhf.so.3&quot;`, but failed: Could not find musl version in output of: `/lib/ld-linux-armhf.so.3`
TRACE Tried to find libc version from possible symlink at &quot;/lib/ld-linux-armhf.so.3&quot;, but failed: Failed to find glibc version in the filename of linker: `arm-linux-gnueabihf/ld-linux-armhf.so.3`
TRACE stdout output from `ld.so --version`: &quot;ld.so (Debian GLIBC 2.36-9+rpt2+deb12u10) stable release version 2.36.\nCopyright (C) 2022 Free Software Foundation, Inc.\nThis is free software; see the source for copying conditions.\nThere is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A\nPARTICULAR PURPOSE.\n&quot;
TRACE Found manylinux 2.36 in stdout of ld.so version
TRACE Searching PATH for executables: cpython3.13.4, cpython3.13, cpython3, cpython, python3.13.4, python3.13, python3, python
TRACE Checking `PATH` directory for interpreters: /home/frank/.local/bin
TRACE Checking `PATH` directory for interpreters: /home/frank/.cargo/bin
TRACE Checking `PATH` directory for interpreters: /usr/local/sbin
TRACE Checking `PATH` directory for interpreters: /usr/local/bin
TRACE Checking `PATH` directory for interpreters: /usr/sbin
TRACE Checking `PATH` directory for interpreters: /usr/bin
TRACE Found possible Python executable: /usr/bin/python3
TRACE Cached interpreter info for Python 3.11.2, skipping probing: /usr/bin/python3
DEBUG Found `cpython-3.11.2-linux-armv7-gnu` at `/usr/bin/python3` (first executable in the search path)
DEBUG Skipping interpreter at `/usr/bin/python3` from first executable in the search path: does not satisfy request `3.13.4`
TRACE Found possible Python executable: /usr/bin/python
TRACE Querying interpreter executable at /usr/bin/python
DEBUG Failed to inspect Python interpreter from search path at `/usr/bin/python`
DEBUG Skipping bad interpreter at /usr/bin/python from search path: Python executable does not support `-I` flag. Please use Python 3.8 or newer.
TRACE Checking `PATH` directory for interpreters: /sbin
TRACE Skipping already seen directory: /sbin
TRACE Checking `PATH` directory for interpreters: /bin
TRACE Skipping already seen directory: /bin
TRACE Checking `PATH` directory for interpreters: /usr/local/games
TRACE Checking `PATH` directory for interpreters: /usr/games
error: Failed to inspect Python interpreter from search path at `/usr/bin/python`
  Caused by: Can't use Python at `/usr/bin/python`
  Caused by: Python executable does not support `-I` flag. Please use Python 3.8 or newer.
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/13944.html">astral-sh/uv#13944</a> on 2025-06-10 12:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-06-13 13:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:07 UTC
    </footer>
</body>
</html>
