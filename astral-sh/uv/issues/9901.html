<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can't install PyTorch because `nvidia-cublas-cu12` can't be installed - astral-sh/uv #9901</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Can't install PyTorch because `nvidia-cublas-cu12` can't be installed</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/9901">#9901</a>
        opened by <a href="https://github.com/AshkanArabim">@AshkanArabim</a>
        on 2024-12-15 01:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AshkanArabim">@AshkanArabim</a> on 2024-12-15 01:57</div>
            <div class="timeline-body"><p>I'm trying to create a docker container with PyTorch (aka <code>torch</code>). I closely followed <a href="https://docs.astral.sh/uv/guides/integration/pytorch/">the documentation</a> but I just can't get it to work. I tried three methods, which I'll cover below</p>
<h2>method 1: installing using <code>uv add</code></h2>
<p>reproduction steps:</p>
<ul>
<li><code>docker run -it ghcr.io/astral-sh/uv:python3.10-alpine /bin/sh</code></li>
<li><code>cd home</code></li>
<li><code>uv init</code></li>
<li><code>uv add torch --index https://download.pytorch.org/whl/cu124</code> (note: host's CUDA version is 12.7)</li>
<li>it returns this error:</li>
</ul>
<pre><code>/home # uv add torch --index https://download.pytorch.org/whl/cu124
Resolved 24 packages in 3.16s
error: Distribution `nvidia-cublas-cu12==12.4.5.8 @ registry+https://download.pytorch.org/whl/cu124` can't be installed because it doesn't have a source distribution or wheel for the current platform
/home # 
</code></pre>
<h2>method 2: installing using a cusom <code>pyproject.toml</code> file with custom indices (just like the docs)</h2>
<p>reproduction steps:</p>
<ul>
<li><code>docker run -it ghcr.io/astral-sh/uv:python3.10-alpine /bin/sh</code></li>
<li><code>cd home</code></li>
<li><code>uv init</code></li>
<li>modify <code>pyproject.toml</code> to the following:</li>
</ul>
<pre><code>[project]
name = &quot;home&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
        &quot;torch&gt;=2.5.0&quot;,
]

[tool.uv.sources]
torch = [
    { index = &quot;pytorch-cu124&quot; },
]

[[tool.uv.index]]
name = &quot;pytorch-cu124&quot;
url = &quot;https://download.pytorch.org/whl/cu124&quot;
explicit = true
</code></pre>
<ul>
<li><code>uv sync</code></li>
<li>returns this error:</li>
</ul>
<pre><code>/home # uv sync
Resolved 24 packages in 913ms
error: Distribution `nvidia-cublas-cu12==12.4.5.8 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform
</code></pre>
<h2>method 3: directly using pytorch's installation guide using the pip interface</h2>
<p>Here's the <a href="https://pytorch.org/">link</a> to PyTorch's installation guide. I clicked on &quot;Stable&quot; &gt; &quot;Linux&quot; &gt; &quot;Pip&quot; &gt; &quot;Python&quot; &gt; &quot;Cuda 12.4&quot;.</p>
<p>reproduction steps:</p>
<ul>
<li><code>docker run -it ghcr.io/astral-sh/uv:python3.10-alpine /bin/sh</code></li>
<li><code>cd home</code></li>
<li><code>uv init</code></li>
<li><code>uv venv</code></li>
<li><code>source .venv/bin/activate</code></li>
<li><code>uv pip install torch torchvision torchaudio</code></li>
<li>returns this error</li>
</ul>
<pre><code>/home # uv pip install torch torchvision torchaudio
error: No virtual environment found; run `uv venv` to create an environment, or pass `--system` to install into a non-virtual environment
/home # uv venv
Using CPython 3.10.16 interpreter at: /usr/local/bin/python
Creating virtual environment at: .venv
/home # source .venv/bin/activate
(home) /home # uv pip install torch torchvision torchaudio
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of torch are available:
          torch==1.0.0
          torch==1.0.1
          torch==1.1.0
          torch==1.2.0
          torch==1.3.0
          torch==1.3.1
          torch==1.4.0
          torch==1.5.0
          torch==1.5.1
          torch==1.6.0
          torch==1.7.0
          torch==1.7.1
          torch==1.8.0
          torch==1.8.1
          torch==1.9.0
          torch==1.9.1
          torch==1.10.0
          torch==1.10.1
          torch==1.10.2
          torch==1.11.0
          torch==1.12.0
          torch==1.12.1
          torch==1.13.0
          torch==1.13.1
          torch==2.0.0
          torch==2.0.1
          torch==2.1.0
          torch==2.1.1
          torch==2.1.2
          torch==2.2.0
          torch==2.2.1
          torch==2.2.2
          torch==2.3.0
          torch==2.3.1
          torch==2.4.0
          torch==2.4.1
          torch==2.5.0
          torch==2.5.1
      and torch&lt;=1.10.1 has no wheels with a matching Python ABI tag, we can conclude that torch&lt;=1.10.1 cannot be used.
      And because torch&gt;=1.10.2 has no wheels with a matching platform tag and you require torch, we can conclude that your requirements are unsatisfiable.
</code></pre>
<p>I may have missed something in the docs. If that's the case please point me to the right direction and I'll take it from there.</p>
<p>Thanks in advance!</p>
<hr />
<p>EDIT: Host information:</p>
<ul>
<li>Ubuntu noble 24.04 x86_64</li>
<li>Linux 6.8.0-49-generic</li>
<li>Docker version 27.3.1, build ce12230</li>
<li>GPU: Nvidia RTX 3060</li>
<li>CUDA Version: 12.7</li>
<li>GPU Driver Version: 565.57.01</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-15 02:07</div>
            <div class="timeline-body"><p>I think this is because you're on Alpine? But PyTorch doesn't publish musl wheels, which you'd need. See https://download.pytorch.org/whl/cu124/nvidia-cublas-cu12.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-12-15 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-15 14:47</div>
            <div class="timeline-body"><p>(So, the fix here is to use a non-Alpine container.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AshkanArabim">@AshkanArabim</a> on 2024-12-15 16:44</div>
            <div class="timeline-body"><p>Thanks! My original pyproject.toml works just fine on Debian.</p>
<p>You can mark this issue as resolved.</p>
<pre><code>[project]
name = &quot;home&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
        &quot;torch&gt;=2.5.0&quot;,
]

[tool.uv.sources]
torch = [
    { index = &quot;pytorch-cu124&quot; },
]

[[tool.uv.index]]
name = &quot;pytorch-cu124&quot;
url = &quot;https://download.pytorch.org/whl/cu124&quot;
explicit = true

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @AshkanArabim on 2024-12-15 16:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:01 UTC
    </footer>
</body>
</html>
