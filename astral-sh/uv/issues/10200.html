<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Headache: when dev dependencies have stricter requirements than runtime deps - astral-sh/uv #10200</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Workflow Headache: when dev dependencies have stricter requirements than runtime deps</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/10200">#10200</a>
        opened by <a href="https://github.com/ayjayt">@ayjayt</a>
        on 2024-12-27 16:59
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ayjayt">@ayjayt</a> on 2024-12-27 16:59</div>
            <div class="timeline-body"><p>Hi!</p>
<ul>
<li>sometimes my development dependencies have a higher requirements than the package</li>
</ul>
<p>I wrote the package to work with python versions &gt;=3.9, but a development dependency is &gt;-3.10.</p>
<p>I want <code>uv</code> to accept that while I do need a higher python version in my <code>.venv</code>, I don't need to increase the value in the <code>pyproject.toml</code>.</p>
<p>Just posting this here to start a discussion!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-27 23:46</div>
            <div class="timeline-body"><p>Could you provide a full example (e.g. pyproject.toml) of what you're trying to achieve? Are you using dependency groups?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @samypr100 on 2024-12-27 23:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @samypr100 on 2024-12-27 23:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/10201.html">astral-sh/uv#10201</a> on 2024-12-27 23:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ayjayt">@ayjayt</a> on 2024-12-28 00:06</div>
            <div class="timeline-body"><p>Okay, it actually seems that this was <em>somewhat</em> addressed in a new version of uv, since now there is a help comment about how to bypass the restriction.</p>
<p>However, for posterity</p>
<pre><code class="language-toml"># pyproject.toml
requires-python = &quot;&gt;=3.8&quot;
</code></pre>
<p><code>uv add --group foo choreographer</code></p>
<p>Output:</p>
<pre><code class="language-text">  × No solution found when resolving dependencies for split (python_full_version == '3.8.*'):
  ╰─▶ Because the requested Python version (&gt;=3.8) does not satisfy Python&gt;=3.9 and all versions of choreographer depend on Python&gt;=3.9, we
      can conclude that all versions of choreographer cannot be used.
      And because temp:foo depends on choreographer and your project requires temp:foo, we can conclude that your project's requirements
      are unsatisfiable.

      hint: The `requires-python` value (&gt;=3.8) includes Python versions that are not supported by your dependencies (e.g., all versions of
      choreographer only supports &gt;=3.9). Consider using a more restrictive `requires-python` value (like &gt;=3.9).
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
</code></pre>
<p>I'm generally okay with this.</p>
<p>I do think it's worth mentioning, conceptually, the idea that groups may have different python requirements than the main dependencies or extras.</p>
<p>edit: And I don't know what other commands within the workflow will prompt the above errors and warnings, but I would sort of like to have a development group which is outside the restrictions of the <strong>package</strong>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AKuederle">@AKuederle</a> on 2025-01-03 10:16</div>
            <div class="timeline-body"><p>Just as a note on this: A common case where this occurs is with sphinx. They seem to quite aggressively remove support for older Python versions. This means you suddenly can not use a newer version of Sphinx to build your documentation, just because your own package still needs to support older Python versions. It feels like that the version of my documentation tool should be independent of the supported versions of my package.</p>
<p>Given that &quot;requires-python&quot; and development dependencies also serve different audiences (consumer of a a package vs. developer of a package), the existens of a <code>require-python</code> in the developer dependencies (that is stricter than the require-python of the actual package), would not feel to much out of place I think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ayjayt">@ayjayt</a> on 2025-01-29 23:05</div>
            <div class="timeline-body"><p>@AKuederle i 100% agree with you, it would be nice!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-29 23:18</div>
            <div class="timeline-body"><p>You can do <code>sphinx; python_version &gt;= '3.12'</code> (or similar) to solve for a newer version of sphinx despite your <code>requires-python</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-01-29 23:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-29 23:18</div>
            <div class="timeline-body"><p>(Closing because I'm not sure this is actionable as-is. Markers are a reasonable solution. We might also allow applying separate Python requirements to entire dependency groups)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:01 UTC
    </footer>
</body>
</html>
