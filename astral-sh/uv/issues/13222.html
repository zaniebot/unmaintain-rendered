<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installing package from local pypiserver not working with `0.7.0` - astral-sh/uv #13222</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Installing package from local pypiserver not working with `0.7.0`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/13222">#13222</a>
        opened by <a href="https://github.com/my1e5">@my1e5</a>
        on 2025-04-30 10:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/my1e5">@my1e5</a> on 2025-04-30 10:35</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have a pypiserver running on my local network. I'm unable to install packages from it starting <code>0.7.0</code>. Here is a minimal reproducable example.</p>
<h2>Create a <code>.whl</code> and copy to a folder</h2>
<pre><code>$ uv init --package foo
$ cd foo
$ uv build
$ mkdir ~/packages
$ mv dist/foo-0.1.0-py3-none-any.whl ~/packages
</code></pre>
<h2>Run a <code>pypi-server</code></h2>
<pre><code>$ uv tool install pypiserver
$ pypi-server run -p 8080 ~/packages &amp;
</code></pre>
<h2>Add package to another project</h2>
<pre><code>$ uv init bar
$ cd bar/
</code></pre>
<h3><code>0.6.17</code></h3>
<p>This works fine.</p>
<pre><code>$ uv self update 0.6.17
info: Checking for updates...
success: Upgraded uv from v0.7.0 to v0.6.17! https://github.com/astral-sh/uv/releases/tag/0.6.17

$ uv add --index http://localhost:8080 foo
Using CPython 3.13.1
Creating virtual environment at: .venv
Resolved 2 packages in 17ms
Prepared 1 package in 6ms
Installed 1 package in 6ms
 + foo==0.1.0

$ uv remove foo
Resolved 1 package in 2ms
Uninstalled 1 package in 3ms
 - foo==0.1.0
</code></pre>
<h3><code>0.7.0</code></h3>
<p>Remove <code>foo</code> before trying agan with <code>0.7.0</code>. Now we get a <code>No solution found when resolving dependencies</code> error.</p>
<pre><code>$ uv self update 0.7.0
info: Checking for updates...
success: Upgraded uv from v0.6.17 to v0.7.0! https://github.com/astral-sh/uv/releases/tag/0.7.0

$ uv add --index http://localhost:8080 foo
  × No solution found when resolving dependencies:
  ╰─▶ Because there are no versions of foo and your project depends on foo, we can conclude that
      your project's requirements are unsatisfiable.
  help: If you want to add the package regardless of the failed resolution, provide the
        `--frozen` flag to skip locking and syncing.
</code></pre>
<details>

<summary>Verbose logs</summary>

<pre><code>DEBUG uv 0.7.0 (62bca8c34 2025-04-29)
DEBUG Found project root: `/Users/rd/Documents/bar`
DEBUG No workspace root found, using project root
DEBUG Acquired lock for `/Users/rd/Documents/bar`
DEBUG Reading Python requests from version file at `/Users/rd/Documents/bar/.python-version`
DEBUG Using Python request `3.13` from version file at `.python-version`
DEBUG Checking for Python environment at `.venv`
DEBUG The virtual environment's Python version satisfies the request: `Python 3.13`
DEBUG Released lock at `/var/folders/zq/tmmf50wd6p3gmy630_7j62x40000gp/T/uv-e0a65891d657ea58.lock`
DEBUG Using request timeout of 30s
DEBUG Found static `pyproject.toml` for: bar @ file:///Users/rd/Documents/bar
DEBUG No workspace root found, using project root
DEBUG Ignoring existing lockfile due to mismatched requirements for: `bar==0.1.0`
  Requested: {Requirement { name: PackageName(&quot;foo&quot;), extras: [], groups: [], marker: true, source: Registry { specifier: VersionSpecifiers([]), index: None, conflict: None }, origin: None }}
  Existing: {}
DEBUG Solving with installed Python version: 3.13.1
DEBUG Solving with target Python version: &gt;=3.13
DEBUG Adding direct dependency: bar*
DEBUG Searching for a compatible version of bar @ file:///Users/rd/Documents/bar (*)
DEBUG Adding direct dependency: foo*
DEBUG Found stale response for: http://localhost:8080/foo/
DEBUG Sending revalidation request for: http://localhost:8080/foo/
DEBUG Found modified response for: http://localhost:8080/foo/
DEBUG Searching for a compatible version of foo (*)
DEBUG No compatible version found for: foo
DEBUG Recording unit propagation conflict of foo from incompatibility of (bar)
DEBUG Searching for a compatible version of bar @ file:///Users/rd/Documents/bar (&lt;0.1.0 | &gt;0.1.0)
DEBUG No compatible version found for: bar
DEBUG Reverting changes to `pyproject.toml`
DEBUG Reverting changes to `uv.lock`
  × No solution found when resolving dependencies:
  ╰─▶ Because there are no versions of foo and your project depends on foo, we can conclude that your project's requirements are unsatisfiable.
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
</code></pre>
</details>

<h3>Platform</h3>
<p>macOS</p>
<h3>Version</h3>
<p>0.7.0</p>
<h3>Python version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @my1e5 on 2025-04-30 10:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Installating package from local pypiserver not working with `0.7.0`" to "Installing package from local pypiserver not working with `0.7.0`" by @my1e5 on 2025-04-30 10:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">great writeup</span> added by @konstin on 2025-04-30 10:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-30 10:48</div>
            <div class="timeline-body"><p>Fixes by 0.7.1</p>
<p>CC @jtfmumm we should test this too when re-introducing the redirect behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-04-30 10:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @jtfmumm on 2025-04-30 11:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:27 UTC
    </footer>
</body>
</html>
