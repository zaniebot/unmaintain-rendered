<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support for `unsafe-binary-first` or `unsafe-wheel-first` in `tool.uv.index-strategy` - astral-sh/uv #13607</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support for `unsafe-binary-first` or `unsafe-wheel-first` in `tool.uv.index-strategy`</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13607">#13607</a>
        opened by <a href="https://github.com/gbdlin">@gbdlin</a>
        on 2025-05-22 23:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gbdlin">@gbdlin</a> on 2025-05-22 23:29</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Right now there are 3 strategies of resolving packages with multiple indexes:</p>
<ul>
<li><code>first-index</code> always picking first index where package exists</li>
<li><code>unsafe-first-match</code> allows moving to the next index if package exist in previous one, but no version satisfies requirements</li>
<li><code>unsafe-best-match</code> resolves versions from all indexes and picks the best matching version from any index.</li>
</ul>
<p>But sometimes there is need for a 4th option: pick first version from any index that does have binary resolution for the current platform (either matching first found, or matching best found). This is very useful especially when developing for</p>
<h3>Example</h3>
<p>Given example project:</p>
<pre><code class="language-toml">[project]                          
name = &quot;project-name&quot;                                                                                                                                                                                                                                                                                
version = &quot;0.1.0&quot;                                                                                                                                                                                                                                                                               
description = &quot;Add your description here&quot;                                                                                                                                                                                                                                                              
readme = &quot;README.md&quot;                                                                                                                                                                                                                                                                                   
requires-python = &quot;&gt;=3.11&quot;
dependencies = [ 
    &quot;pydantic~=2.11.5&quot;                        
]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       
          
[[tool.uv.index]]                                                                                                                                                                             
name = &quot;pypi&quot;                                                                                                                                                                                 
url = &quot;https://pypi.org/simple&quot;
                                                 
[[tool.uv.index]]                                                                                                                                                                                                                                                                         
name = &quot;piwheels&quot;                                                                                                                                                                                                                                                                                    
url = &quot;https://piwheels.org/simple&quot;                                                                                                                                                                                                                                                             
</code></pre>
<p>When installing it on 32 bit Raspberry PI system, uv will not use wheel for <code>pydantic-core</code> available on piwheels, but instead will compile the package from source. When we swap the order of used indexes or use any other index strategy, we will either fetch all packages from <code>piwheels</code> index, where newest versions of packages can be published with a delay, so if a universal wheel for any package exists, normal pypi index would be preferred.</p>
<p>With an option to prefer sources with binary distribution whenever possible, uv could resolve only <code>pydantic-core</code> from <code>piwheels</code> index and rest of it from <code>pypi</code> and manual pinning won't be necessary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @gbdlin on 2025-05-22 23:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @konstin on 2025-05-23 08:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:06 UTC
    </footer>
</body>
</html>
