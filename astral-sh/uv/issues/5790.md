```yaml
number: 5790
title: 0.2.28 broke Nox support by changing how local reinstallation works
type: issue
state: closed
author: hynek
labels: []
assignees: []
created_at: 2024-08-05T08:08:47Z
updated_at: 2024-08-06T15:05:05Z
url: https://github.com/astral-sh/uv/issues/5790
synced_at: 2026-01-10T01:57:12Z
```

# 0.2.28 broke Nox support by changing how local reinstallation works

---

_Issue opened by @hynek on 2024-08-05 08:08_

I've run into the weirdness that Nox paired with uv stopped re-installing the local package and the tests ran against old code.

I've bisected the behavior and it looks like the change was introduced with uv 0.2.28 because it works with 0.2.27. It doesn't seem to be cache related since deleting the cache didn't help.

I've seen mentions of `--reinstall-package` for uv, but it used to work recently and I'd rather not hard-couple my noxfile to uv if it can be helped.

I've ran into it while working on https://github.com/hynek/stamina so it could be a decent way to test. I've even added debug output out the package versions when running pytest. The number behind dev should increment after each commit.

---

_Comment by @konstin on 2024-08-05 08:33_

Are you using dynamic metadata? In that case it's probably https://github.com/astral-sh/uv/pull/5206. We're trying to rebuild less often for better performance.

---

_Comment by @hynek on 2024-08-05 08:46_

I do! hatch-vcs (which is setuptools-scm under the hood).

---

_Comment by @konstin on 2024-08-05 08:54_

Does this option help? https://docs.astral.sh/uv/reference/settings/#reinstall-package

---

_Comment by @hynek on 2024-08-05 15:16_

Hm yes but since I didn't want to couple my noxfile to uv (they support graceful fallbacks), I've set it in pyproject.toml using `tool.uv.reinstall-package`. Is that how it's supposed to be used or will that have some weird side-effects?

---

_Comment by @charliermarsh on 2024-08-05 16:27_

@hynek -- That should be totally fine. If you want to "always reinstall the package" (the previous behavior), that's the right thing to do.

---

_Comment by @hynek on 2024-08-06 15:05_

OK, I guess it's a documentation issue for Nox then â€“ thanks!

---

_Closed by @hynek on 2024-08-06 15:05_

---

_Referenced in [wntrblm/nox#840](../../wntrblm/nox/issues/840.md) on 2024-08-06 15:12_

---
