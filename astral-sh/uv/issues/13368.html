<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv add package fails after upgrading uv to version 0.7.3 - astral-sh/uv #13368</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv add package fails after upgrading uv to version 0.7.3</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/13368">#13368</a>
        opened by <a href="https://github.com/jenriquehdez">@jenriquehdez</a>
        on 2025-05-09 19:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/jenriquehdez">@jenriquehdez</a> on 2025-05-09 19:41</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>This issue started happening after upgrading uv to  version <code>0.7.3</code>. Previously this was working fine with <code>uv 0.6.13</code></p>
<p><strong>What is not working</strong>
<code>uv add sinapsis --index https://pypi.sinapsis.tech/ </code></p>
<pre><code class="language-bash">  × No solution found when resolving dependencies for split (python_full_version &gt;= '3.13'):
  ╰─▶ Because sinapsis was not found in the package registry and your project depends on sinapsis, we can conclude that your project's requirements are unsatisfiable.

      hint: An index URL (https://pypi.sinapsis.tech/) could not be queried due to a lack of valid authentication credentials (403 Forbidden).
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
</code></pre>
<p><strong>What is working but not desired</strong>
<code>uv add sinapsis --index https://pypi.sinapsis.tech/ --index-strategy unsafe-first-match</code></p>
<pre><code class="language-bash">Resolved 13 packages in 926ms
Installed 10 packages in 9ms`
</code></pre>
<p>Index is already included in the pyproject.toml file.</p>
<pre><code class="language-bash">[[tool.uv.index]]
url = &quot;https://pypi.sinapsis.tech/&quot;
</code></pre>
<h3>Platform</h3>
<p>Ubuntu 22.04.4 LTS</p>
<h3>Version</h3>
<p>uv 0.7.3</p>
<h3>Python version</h3>
<p>Python 3.10.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @jenriquehdez on 2025-05-09 19:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-09 20:56</div>
            <div class="timeline-body"><p>It looks like your index returns a 403 for &quot;Not found&quot; packages. I think you should add:</p>
<pre><code class="language-toml">[[tool.uv.index]]
url = &quot;https://pypi.sinapsis.tech/&quot;
ignore-error-codes = [403]
</code></pre>
<p>See: https://docs.astral.sh/uv/configuration/indexes/#ignoring-error-codes-when-searching-across-indexes</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-05-09 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-05-09 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jenriquehdez">@jenriquehdez</a> on 2025-05-09 22:25</div>
            <div class="timeline-body"><p>Thanks for your reply. I think that only partially fix the issue, similar error occurs when trying to install the package in a virtual environment located in a project folder without a pyproject file. For example:</p>
<p><code>uv pip install sinapsis --extra-index-url https://pypi.sinapsis.tech</code></p>
<p>produces</p>
<pre><code class="language-bash">No solution found when resolving dependencies:
  ╰─▶ Because sinapsis was not found in the package registry and you require sinapsis, we can conclude that your requirements are unsatisfiable.

      hint: An index URL (https://pypi.sinapsis.tech/) could not be queried due to a lack of valid authentication credentials (403 Forbidden).
</code></pre>
<p>which don't happen when using raw pip</p>
<p><code>pip install sinapsis --extra-index-url https://pypi.sinapsis.tech</code></p>
<p>Output:</p>
<pre><code class="language-bash">Looking in indexes: https://pypi.org/simple, https://pypi.ngc.nvidia.com, https://pypi.sinapsis.tech
Collecting sinapsis
  Downloading sinapsis-0.2.10-py3-none-any.whl.metadata (9.3 kB)
Collecting sinapsis-core&gt;=0.1.0 (from sinapsis)
  Downloading https://pypi.sinapsis.tech/sinapsis-core/sinapsis_core-0.1.3-py3-none-any.whl (64 kB)
Collecting pydantic&gt;=2.8.2 (from sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading pydantic-2.11.4-py3-none-any.whl.metadata (66 kB)
Collecting docstring-parser&gt;=0.16 (from sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading docstring_parser-0.16-py3-none-any.whl.metadata (3.0 kB)
Collecting pyyaml&gt;=6.0.2 (from sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (2.1 kB)
Collecting loguru&gt;=0.7.3 (from sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading loguru-0.7.3-py3-none-any.whl.metadata (22 kB)
Collecting annotated-types&gt;=0.6.0 (from pydantic&gt;=2.8.2-&gt;sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading annotated_types-0.7.0-py3-none-any.whl.metadata (15 kB)
Collecting pydantic-core==2.33.2 (from pydantic&gt;=2.8.2-&gt;sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading pydantic_core-2.33.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.8 kB)
Collecting typing-extensions&gt;=4.12.2 (from pydantic&gt;=2.8.2-&gt;sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading typing_extensions-4.13.2-py3-none-any.whl.metadata (3.0 kB)
Collecting typing-inspection&gt;=0.4.0 (from pydantic&gt;=2.8.2-&gt;sinapsis-core&gt;=0.1.0-&gt;sinapsis)
  Downloading typing_inspection-0.4.0-py3-none-any.whl.metadata (2.6 kB)
Downloading sinapsis-0.2.10-py3-none-any.whl (29 kB)
Downloading docstring_parser-0.16-py3-none-any.whl (36 kB)
Downloading loguru-0.7.3-py3-none-any.whl (61 kB)
Downloading pydantic-2.11.4-py3-none-any.whl (443 kB)
Downloading pydantic_core-2.33.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 22.8 MB/s eta 0:00:00
Downloading annotated_types-0.7.0-py3-none-any.whl (13 kB)
Downloading PyYAML-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (751 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 751.2/751.2 kB 25.5 MB/s eta 0:00:00
Downloading typing_extensions-4.13.2-py3-none-any.whl (45 kB)
Downloading typing_inspection-0.4.0-py3-none-any.whl (14 kB)
Installing collected packages: typing-extensions, pyyaml, loguru, docstring-parser, annotated-types, typing-inspection, pydantic-core, pydantic, sinapsis-core, sinapsis
Successfully installed annotated-types-0.7.0 docstring-parser-0.16 loguru-0.7.3 pydantic-2.11.4 pydantic-core-2.33.2 pyyaml-6.0.2 sinapsis-0.2.10 sinapsis-core-0.1.3 typing-extensions-4.13.2 typing-inspection-0.4.0
</code></pre>
<p>Could you please elaborate if there are plans to handle these scenarios? So there's no need to force users to use flags like <code>--index-strategy unsafe-first-match</code> when adding or installing a package. Or forcing to add this additional config  <code>ignore-error-codes = [403]</code> in pyproject files.</p>
<p>Also could you please explain what are the advantages to follow this new approach considering these flags were not needed in previous versions?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-09 23:59</div>
            <div class="timeline-body"><blockquote>
<p>Also could you please explain what are the advantages to follow this new approach considering these flags were not needed in previous versions?</p>
</blockquote>
<p>The motivation for the differences from pip are discussed at https://docs.astral.sh/uv/pip/compatibility/#packages-that-exist-on-multiple-indexes</p>
<p>In brief, the advantage is that this approach is more secure by default and reduces the possibility of dependency confusion attacks. See #12805 as well.</p>
<blockquote>
<p>I think that only partially fix the issue, similar error occurs when trying to install the package in a virtual environment located in a project folder without a pyproject file.</p>
</blockquote>
<p>We're still figuring out the best way to expose the <code>ignore-error-codes</code> configuration option to the <code>uv pip</code> command-line interface.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-05-13 03:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-13 03:04</div>
            <div class="timeline-body"><p>(You might be interested in https://github.com/astral-sh/uv/pull/13249 which would expose this on the CLI.)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
