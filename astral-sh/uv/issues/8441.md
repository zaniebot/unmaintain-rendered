```yaml
number: 8441
title: Trying to use custom gitconfig location, appears to get ignored
type: issue
state: open
author: EdgyMeshx
labels:
  - bug
  - needs-design
assignees: []
created_at: 2024-10-22T09:40:24Z
updated_at: 2024-10-25T08:15:45Z
url: https://github.com/astral-sh/uv/issues/8441
synced_at: 2026-01-10T01:57:19Z
```

# Trying to use custom gitconfig location, appears to get ignored

---

_Issue opened by @EdgyMeshx on 2024-10-22 09:40_

This is a follow on from #8413, I have a custom `.gitconfig` in a child directory that is picked up if I am editing a repo inside that child directory (effectively allowing me to commit etc under a user other than my default self.)

This works fine using git normally, but if I configure it to point to a custom `.git-credentials` file, it appears to go ignored by `uv`. I think this is somewhat expected behaviour as my custom `.gitconfig` is only picked up if you are in a subdirectory of the location of that custom config.

I am assuming that uv is running git from its own location not the `cwd` and this is causing custom configuration to be ignored. Is there any way to prevent this from happening, or any way this could be addressed (have uv pick up the cwd where it was executed and have that be the context its children commands like git run in?) as a part of uv.

Example configs
~/.gitconfig
```
[user]
	email = email@me.com
	name = Default User

[includeIf "gitdir:~/code/work/**"]
    path = ~/code/work/.gitconfig
```

~/code/work/.gitconfig
```
[user]
    email = email@work.com
    name = Work User

[credential]
	helper = store --file ~/code/work/.git-credentials
```

If I move the git credentials to home, uv picks them up just fine.

---

_Comment by @zanieb on 2024-10-22 11:10_

Hm, this seems challenging. We might need to copy the file into the build context? Or clone in the user's directory then move it into the cache? It's possible we'll need the config for future fetches though.

---

_Label `bug` added by @zanieb on 2024-10-22 11:10_

---

_Label `needs-design` added by @zanieb on 2024-10-22 11:10_

---

_Comment by @EdgyMeshx on 2024-10-22 12:15_

The issue with copying it is it can be in multiple pieces depending on current location. Currently we only go one repo deep so a single fetch would suffice, but if we ever did nest repos you are right, additional fetches could be needed.

If there is some way for the cwd to be the context uv runs against, so any file look ups start in the "correct" location and walk the tree upwards, I believe it would solve (at least my version) of the problem.

---

_Comment by @EdgyMeshx on 2024-10-22 12:29_

Have just tested and gitconfig does not honor relative paths, so the store file should be a full path if it was to be copied.

---

_Comment by @EdgyMeshx on 2024-10-22 13:03_

To clarify, this isn't just a git-credentials issue, this would impact custom ssh keys in the same way

having this instead of credential in `/code/work/.gitconfig` is also lost by uv.
```
[core]
    sshCommand = "ssh -i ~/.ssh/id_work"
```

have updated issue title

---

_Renamed from "Trying to use custom git-credentials location, appears to get ignored" to "Trying to use custom gitconfig location, appears to get ignored" by @EdgyMeshx on 2024-10-22 13:04_

---

_Comment by @EdgyEdgemond on 2024-10-25 08:15_

@zanieb not sure if this will assist in a solution for you, but I believe if you can run `git config --list` in the context of the cwd before switching over to uv location. You could extract the lowest down core.sshcommand and credential.helper settings if provided.

I'm not sure exactly how you could inject them as `git config --local` only works in the context of an active git repo.

Global config appears before included config appears before local config
```
user.email=email@me.com
user.name=Default User
filter.lfs.clean=git-lfs clean -- %f
filter.lfs.smudge=git-lfs smudge -- %f
filter.lfs.process=git-lfs filter-process
filter.lfs.required=true
init.defaultbranch=main
merge.ff=false
pull.ff=true
includeif.gitdir:~/code/work/**.path=~/code/work/.gitconfig
user.email=email@work.com
user.name=Work User
core.sshcommand=ssh -i ~/.ssh/id_work
credential.helper=store --file ~/code/work/.git-credentials
core.repositoryformatversion=0
core.filemode=true
core.bare=false
core.logallrefupdates=true
remote.origin.url=git@github.com:org/backend.git
remote.origin.fetch=+refs/heads/*:refs/remotes/origin/*
branch.main.remote=origin
branch.main.merge=refs/heads/main
branch.concepts.remote=origin
branch.concepts.merge=refs/heads/concepts
```


---
