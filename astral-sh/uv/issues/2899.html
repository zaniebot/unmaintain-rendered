<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>failing to install a package from private pypi repo - Caused by: relative URL without a base - astral-sh/uv #2899</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>failing to install a package from private pypi repo - Caused by: relative URL without a base</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2899">#2899</a>
        opened by <a href="https://github.com/etele">@etele</a>
        on 2024-04-08 10:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/etele">@etele</a></div>
            <div class="timeline-body"><p>Failing to install a packge, from private pypi repo, the repo is set through <code>UV_INDEX_URL</code> environment variable.
Seems it finds the candidate to isntall, but in the end failing with</p>
<pre><code>error: Failed to download: pytz==2022.7.1
  Caused by: relative URL without a base
</code></pre>
<p>it happens for all of the packages, this is just one for demonstration.</p>
<p>Details and example:</p>
<p>platform:</p>
<pre><code>$ uname -a
Linux 6.5.0-26-generic #26-Ubuntu SMP PREEMPT_DYNAMIC Tue Mar  5 21:19:28 UTC 2024 x86_64 x86_64 x86_64 GNU/Linux
</code></pre>
<p>uv version:</p>
<pre><code>$ uv --version
uv 0.1.29
</code></pre>
<p>private repo settting:</p>
<pre><code>$ env | grep UV_
UV_INDEX_URL=https://pypi.private.repo/simple/
</code></pre>
<p>the command:</p>
<pre><code>$ uv -v pip install pytz==2022.7.1
INFO Found a virtualenv through VIRTUAL_ENV at: /home/user/.local/share/virtualenvs/api-v3W8N2Or
DEBUG Cached interpreter info for Python 3.11.8, skipping probing: /home/user/.local/share/virtualenvs/api-v3W8N2Or/bin/python
DEBUG Using Python 3.11.8 environment at /home/user/.local/share/virtualenvs/api-v3W8N2Or/bin/python
DEBUG Trying to lock if free: /home/user/.local/share/virtualenvs/api-v3W8N2Or/.lock
DEBUG Using registry request timeout of 300s
DEBUG Solving with target Python version 3.11.8
DEBUG Adding direct dependency: pytz==2022.7.1
TRACE Fetching metadata for pytz from https://pypi.private.repo/simple/pytz/
TRACE cached request https://pypi.private.repo/simple/pytz/ is storable because its response has a heuristically cacheable status code 200
TRACE cached request https://pypi.private.repo/simple/pytz/ has a cached response that does not allow staleness
TRACE request https://pypi.private.repo/simple/pytz/ does not have a fresh cache because its age is 1554 seconds, it is greater than the freshness lifetime of 0 seconds and stale cached responses are not allowed
DEBUG Found stale response for: https://pypi.private.repo/simple/pytz/
DEBUG Sending revalidation request for: https://pypi.private.repo/simple/pytz/
DEBUG No credentials found for: https://pypi.private.repo/simple/pytz/
TRACE is modified because status is 200 and not 304
DEBUG Found modified response for: https://pypi.private.repo/simple/pytz/
TRACE cached request https://pypi.private.repo/simple/pytz/ is storable because its response has a heuristically cacheable status code 200
TRACE Received package metadata for: pytz
TRACE selecting candidate for package PackageName(&quot;pytz&quot;) with range Range { segments: [(Included(&quot;2022.7.1&quot;), Included(&quot;2022.7.1&quot;))] } with 70 remote versions
TRACE found candidate for package PackageName(&quot;pytz&quot;) with range Range { segments: [(Included(&quot;2022.7.1&quot;), Included(&quot;2022.7.1&quot;))] } after 6 steps: &quot;2022.7.1&quot; version
error: Failed to download: pytz==2022.7.1
  Caused by: relative URL without a base
</code></pre>
<p>Same error when running it in a pipeline in a docker image, where the index is set through the requirements file:</p>
<pre><code>$ cat requirements.txt 
-i https://pypi.private.rep/simple/
...
pytz==2022.7.1
...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-08 13:34</div>
            <div class="timeline-body"><p>Can you share what the download URLs look like in https://pypi.private.repo/simple/pytz/ ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2024-04-08 13:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/etele">@etele</a> on 2024-04-08 14:30</div>
            <div class="timeline-body"><p>Sure, here is a samle from it:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta name=&quot;pypi:repository-version&quot; content=&quot;1.1&quot;&gt;
    &lt;title&gt;Links for pytz&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;Links for pytz&lt;/h1&gt;
    
      
        
          &lt;a href=&quot;/packages/5a/d8/4d75d1e4287ad9d051aab793c68f902c9c55c4397636b5ee540ebd15aedf/pytz-2005k.tar.bz2?hash=597b596dc1c2c130cd0a57a043459c3bd6477c640c07ac34ca3ce8eed7e6f30c&amp;remote=https://files.pythonhosted.org/packages/5a/d8/4d75d1e4287ad9d051aab793c68f902c9c55c4397636b5ee540ebd15aedf/pytz-2005k.tar.bz2#sha256=597b596dc1c2c130cd0a57a043459c3bd6477c640c07ac34ca3ce8eed7e6f30c&quot; &gt;pytz-2005k.tar.bz2&lt;/a&gt;
        
      
    &lt;/br&gt;
    
      
        
          &lt;a href=&quot;/packages/73/b2/12575d53aa86b02dfb6d8ac808e2b0a866afaa598139aac4423795d1f150/pytz-2005k.tar.gz?hash=6b026144c04d29dc2f57e37754f9c62e99b2b9d8a863b2faf741af41956b3dcb&amp;remote=https://files.pythonhosted.org/packages/73/b2/12575d53aa86b02dfb6d8ac808e2b0a866afaa598139aac4423795d1f150/pytz-2005k.tar.gz#sha256=6b026144c04d29dc2f57e37754f9c62e99b2b9d8a863b2faf741af41956b3dcb&quot; &gt;pytz-2005k.tar.gz&lt;/a&gt;
        
      
    &lt;/br&gt;
    ...
    
&lt;/body&gt;
&lt;/html&gt;
&lt;!--SERIAL 21700107



--&gt;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-08 14:42</div>
            <div class="timeline-body"><p>I assume that omitting the trailing slash from your index URL has no effect?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/etele">@etele</a> on 2024-04-08 14:54</div>
            <div class="timeline-body"><blockquote>
<p>I assume that omitting the trailing slash from your index URL has no effect?</p>
</blockquote>
<p>no effect</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-04-08 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> removed by @charliermarsh on 2024-04-08 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-04-08 16:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-08 16:56</div>
            <div class="timeline-body"><p>Ah yes, I see the issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-08 16:56</div>
            <div class="timeline-body"><p>We're getting confused by the <code>remote=https://...</code> piece. Will fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-04-08 21:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:24:37 UTC
    </footer>
</body>
</html>
