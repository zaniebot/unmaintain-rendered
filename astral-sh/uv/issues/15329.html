<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gunicorn worker timeouts in Docker when using uv run - astral-sh/uv #15329</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Gunicorn worker timeouts in Docker when using uv run</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15329">#15329</a>
        opened by <a href="https://github.com/SoAp9035">@SoAp9035</a>
        on 2025-08-17 08:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/SoAp9035">@SoAp9035</a></div>
            <div class="timeline-body">Summary
<p>When the Flask site is refreshed repeatedly (or sometimes after random idle periods), a Gunicorn worker times out and logs an error while parsing the HTTP request (Error handling request (no URI read)). The application previously ran stably using Docker when started without uv / virtual env tooling (plain python + gunicorn). After migrating to uv (using uv lock + uv run + gunicorn) the intermittent timeout began appearing.</p>
<p>This error does not occur when I run the project directly as uv run main.py without using Docker.</p>
<p>I tried other Python images and the other fixes that were suggested on the internet, but I couldn&#x27;t fix it.</p>
<p>Logs</p>
<pre><code>[2025-08-17 07:48:56 +0000] [10] [INFO] Starting gunicorn 23.0.0
[2025-08-17 07:48:56 +0000] [10] [INFO] Listening at: http://0.0.0.0:8080 (10)
[2025-08-17 07:48:56 +0000] [10] [INFO] Using worker: sync
[2025-08-17 07:48:56 +0000] [11] [INFO] Booting worker with pid: 11
[2025-08-17 07:49:43 +0000] [10] [CRITICAL] WORKER TIMEOUT (pid:11)
[2025-08-17 07:49:43 +0000] [11] [ERROR] Error handling request (no URI read)
Traceback (most recent call last):
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/workers/sync.py&quot;, line 133, in handle
    req = next(parser)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/parser.py&quot;, line 41, in __next__
    self.mesg = self.mesg_class(self.cfg, self.unreader, self.source_addr, self.req_count)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 259, in __init__
    super().__init__(cfg, unreader, peer_addr)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 60, in __init__
    unused = self.parse(self.unreader)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 271, in parse
    self.get_data(unreader, buf, stop=True)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 262, in get_data
    data = unreader.read()
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/unreader.py&quot;, line 36, in read
    d = self.chunk()
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/unreader.py&quot;, line 63, in chunk
    return self.sock.recv(self.mxchunk)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/workers/base.py&quot;, line 204, in handle_abort
    sys.exit(1)
SystemExit: 1
[2025-08-17 07:49:43 +0000] [11] [INFO] Worker exiting (pid: 11)
</code></pre>
<p>Previous Dockerfile (stable):</p>
<pre><code>FROM python:3.13.5-alpine

WORKDIR /usr/src/app

COPY ./requirements.txt .

RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 8080

CMD [&quot;gunicorn&quot;, &quot;--bind&quot;, &quot;0.0.0.0:8080&quot;, &quot;main:app&quot;]
</code></pre>
<p>Current Dockerfile (problematic):</p>
<pre><code>FROM python:3.13.6-slim-bookworm

COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

WORKDIR /app
ADD . /app

RUN uv sync --locked

EXPOSE 8080

CMD [&quot;uv&quot;, &quot;run&quot;, &quot;--no-sync&quot;, &quot;gunicorn&quot;, &quot;--bind&quot;, &quot;0.0.0.0:8080&quot;, &quot;main:app&quot;]
</code></pre>
<p>I also ran these commands in the Docker container, in case that helps. I don&#x27;t know.</p>
<pre><code># uv run python -c &quot;import sys; print(sys.executable)&quot;
/app/.venv/bin/python3
# python -c &quot;import sys; print(sys.executable)&quot;
/usr/local/bin/python
</code></pre>
<p>Environment:</p>
<ul>
<li>uv: latest</li>
<li>Python: 3.13.6</li>
<li>Flask: 3.1.1</li>
<li>gunicorn: 23.0.0 (default sync worker)</li>
<li>Other deps: supabase client, google-cloud-storage, beautifulsoup4</li>
</ul>
<p>Thanks!</p>
Platform
<p>Windows 11</p>
Version
<p>uv 0.8.11 (f892276ac 2025-08-14)</p>
Python version
<p>Python 3.13.6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/SoAp9035">@SoAp9035</a> on 2025-08-17 08:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-17 08:52</div>
            <div class="timeline-body"><p>Candidly I would be a little surprised if this were a uv issue, because it seems like application code, but if you&#x27;d like, you can change your invocation at the end to <code>CMD [&quot;/app/.venv/bin/gunicorn&quot;, &quot;--bind&quot;, &quot;0.0.0.0:8080&quot;, &quot;main:app&quot;]</code> to avoid calling <code>uv run</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SoAp9035">@SoAp9035</a> on 2025-08-17 19:01</div>
            <div class="timeline-body"><p>@charliermarsh I also tried it, but it didn’t work. I still have the same problem.</p>
<p>To test it, I created a small Flask app. But the issue still happens.</p>
<p>Here is what I did:</p>
<ol>
<li><p>I ran this command:</p>
<pre><code>uv init
</code></pre>
</li>
<li><p>Then I installed the dependencies:</p>
<pre><code>uv add flask gunicorn
</code></pre>
</li>
<li><p>I created a <code>main.py</code> file with this content:</p>
<pre><code>from flask import Flask

app = Flask(__name__)

@app.route(&quot;/&quot;)
def home():
    return &quot;&lt;h1&gt;It is working.&lt;/h1&gt;&quot;

if __name__ == &quot;__main__&quot;:
    app.run(debug=True)
</code></pre>
</li>
<li><p>When I run the app using <code>uv run main.py</code>, everything works fine.</p>
</li>
<li><p>Here is my <code>Dockerfile</code>:</p>
<pre><code>FROM python:3.13.6-slim-bookworm

COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

WORKDIR /app

ADD . /app

RUN uv sync --locked

CMD [&quot;uv&quot;, &quot;run&quot;, &quot;gunicorn&quot;, &quot;--bind&quot;, &quot;0.0.0.0:8080&quot;, &quot;main:app&quot;]
</code></pre>
</li>
<li><p>When I visit the web page and refresh several times (including hard refresh), I get this error:</p>
<pre><code>[2025-08-17 18:47:55 +0000] [10] [INFO] Starting gunicorn 23.0.0
[2025-08-17 18:47:55 +0000] [10] [INFO] Listening at: http://0.0.0.0:8080 (10)
[2025-08-17 18:47:55 +0000] [10] [INFO] Using worker: sync
[2025-08-17 18:47:55 +0000] [11] [INFO] Booting worker with pid: 11
[2025-08-17 18:48:40 +0000] [10] [CRITICAL] WORKER TIMEOUT (pid:11)
[2025-08-17 18:48:40 +0000] [11] [ERROR] Error handling request (no URI read)
Traceback (most recent call last):
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/workers/sync.py&quot;, line 133, in handle
    req = next(parser)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/parser.py&quot;, line 41, in __next__
    self.mesg = self.mesg_class(self.cfg, self.unreader, self.source_addr, self.req_count)
                ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 259, in __init__
    super().__init__(cfg, unreader, peer_addr)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 60, in __init__
    unused = self. Parse(self.unreader)
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 271, in parse
    self.get_data(unreader, buf, stop=True)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 262, in get_data
    data = unreader.read()
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/unreader.py&quot;, line 36, in read
    d = self. Chunk()
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/unreader.py&quot;, line 63, in chunk
    return self.sock.recv(self.mxchunk)
           ~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/workers/base.py&quot;, line 204, in handle_abort
    sys.exit(1)
    ~~~~~~~~^^^
SystemExit: 1
[2025-08-17 18:48:40 +0000] [11] [INFO] Worker exiting (pid: 11)
[2025-08-17 18:48:40 +0000] [12] [INFO] Booting worker with pid: 12
</code></pre>
</li>
</ol>
<p>This error keeps happening over and over when I refresh the page. I’m not sure what is wrong. Everything works fine locally with <code>uv run main.py</code>, but not in Docker using Gunicorn.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SoAp9035">@SoAp9035</a> on 2025-08-17 19:32</div>
            <div class="timeline-body"><p>I added a <code>.dockerignore</code> file and added <code>.venv</code> to it.</p>
<p>Then, I followed the official <code>uv-docker-example</code> from GitHub:<br>
https://github.com/astral-sh/uv-docker-example/blob/main/Dockerfile</p>
<p>I tried again with the two new Dockerfiles below. But I&#x27;m still getting the same error.</p>
<pre><code>FROM python:3.13.6-slim-bookworm

COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

WORKDIR /app

ADD . /app

RUN uv sync --locked

ENV PATH=&quot;/app/.venv/bin:$PATH&quot;

CMD [&quot;gunicorn&quot;, &quot;--bind&quot;, &quot;0.0.0.0:8080&quot;, &quot;main:app&quot;]
</code></pre>
<pre><code>FROM python:3.13.6-slim-bookworm

COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

WORKDIR /app

COPY pyproject.toml uv.lock ./

RUN uv sync --locked

COPY . .

ENV PATH=&quot;/app/.venv/bin:$PATH&quot;

EXPOSE 8080

CMD [&quot;gunicorn&quot;, &quot;--bind&quot;, &quot;0.0.0.0:8080&quot;, &quot;main:app&quot;]
</code></pre>
<p>Both Dockerfiles give me the same timeout error.</p>
<p>I noticed that I can trigger the error immediately when I do a &quot;hard refresh&quot; (clear cache and refresh) on the website.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edmorley">@edmorley</a> on 2025-08-17 19:36</div>
            <div class="timeline-body"><blockquote>
<p>Previous Dockerfile (stable):</p>
<pre><code>FROM python:3.13.5-alpine
</code></pre>
</blockquote>
<p>Your working <code>Dockerfile</code> is:
(a) using a different OS (Alpine instead of Debian),
(b) using a different patch version of Python (3.13.5 instead of 3.13.6)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SoAp9035">@SoAp9035</a> on 2025-08-17 19:48</div>
            <div class="timeline-body"><p>@edmorley Sorry, I forgot to mention. When I migrated the project to use <code>uv</code>, I also updated the versions. So I get the same results with Python 3.13.6 as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/abkarada">@abkarada</a> on 2025-08-19 11:02</div>
            <div class="timeline-body"><p>Well, if the problem is a network bottleneck it would be easier to investigate. I feel like it’s probably a socket bug from this:
[CRITICAL] WORKER TIMEOUT
[ERROR] Error handling request (no URI read)
That means the WORKER takes a request, but before the HTTP (TCP) request is processed, the socket is closed or frozen. The “frozen” option is tricky — I’m thinking about refusing or closing. If it’s about refusing, you could try from your PowerShell:
sudo ufw allow 8080/TCP</p>
<p>But it’s probably already in the open state. I don’t think it’s refusing, I bet it’s about blocking. If that’s the case, it’s because of the worker’s idle connection handling: in some cases the connection doesn’t close, and Gunicorn’s request parser receives an “empty” packet and gets stuck.</p>
<p>Or it could be crashing (because when started with uv run, Gunicorn’s worker fork/exec model and uv’s virtualenv isolation may conflict). Or closing (earlier you used Alpine, now slim-bookworm. These two differ in libc, network stack, and socket timeout behavior).</p>
<p>If this is a socket-related issue, you can test Docker network bridge behavior: in slim-bookworm + uv environments, test how sockets close / handle keep-alive (for example with netstat -anp | grep 8080).</p>
<p>Gunicorn timeout / keepalive settings to try:</p>
<p>--timeout 120 → longer timeout, see if behavior changes.</p>
<p>--keep-alive 2 → speeds up idle connection closure.</p>
<p>Alpine vs Slim difference: Alpine uses musl libc, Slim uses glibc. TCP socket closure behavior can differ slightly.</p>
<p>Error log (and why it matches my diagnosis)
[2025-08-17 18:47:55 +0000] [10] [INFO] Starting gunicorn 23.0.0
[2025-08-17 18:47:55 +0000] [10] [INFO] Listening at: http://0.0.0.0:8080 (10)
[2025-08-17 18:47:55 +0000] [10] [INFO] Using worker: sync
[2025-08-17 18:47:55 +0000] [11] [INFO] Booting worker with pid: 11
[2025-08-17 18:48:40 +0000] [10] [CRITICAL] WORKER TIMEOUT (pid:11)
[2025-08-17 18:48:40 +0000] [11] [ERROR] Error handling request (no URI read)
Traceback (most recent call last):
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/workers/sync.py&quot;, line 133, in handle
req = next(parser)
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/parser.py&quot;, line 41, in <strong>next</strong>
self.mesg = self.mesg_class(self.cfg, self.unreader, self.source_addr, self.req_count)
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 259, in <strong>init</strong>
super().<strong>init</strong>(cfg, unreader, peer_addr)
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 60, in <strong>init</strong>
unused = self.parse(self.unreader)
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 271, in parse
self.get_data(unreader, buf, stop=True)
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/message.py&quot;, line 262, in get_data
data = unreader.read()
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/unreader.py&quot;, line 36, in read
d = self.chunk()
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/http/unreader.py&quot;, line 63, in chunk
return self.sock.recv(self.mxchunk)
File &quot;/app/.venv/lib/python3.13/site-packages/gunicorn/workers/base.py&quot;, line 204, in handle_abort
sys.exit(1)
SystemExit: 1
[2025-08-17 18:48:40 +0000] [11] [INFO] Worker exiting (pid: 11)
[2025-08-17 18:48:40 +0000] [12] [INFO] Booting worker with pid: 12</p>
<p>This log shows exactly what I described: the worker accepts a TCP connection, then blocks on recv() waiting for data that never arrives. Eventually Gunicorn’s watchdog triggers a timeout and kills the worker. The error message “no URI read” literally means the HTTP request line never came in, which is consistent with my hypothesis.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-08-19 11:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-08-19 11:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-08-19 11:12</div>
            <div class="timeline-body"><p>Do the errors also occur when just replacing <code>pip install</code> with <code>uv pip install</code>?</p>
<pre><code>RUN pip install --no-cache-dir -r requirements.txt
</code></pre>
<p>to</p>
<pre><code>RUN uv pip install --no-cache-dir -r requirements.txt
</code></pre>
<p>When you do <code>uv sync</code>, what Python interpreter is used (<code>-v</code> will give more information)?</p>
<p>The best way to debug this is changing the Dockerfile step-by-step, checking which change exactly makes the problem occur and looking at the logs during the docker build.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SoAp9035">@SoAp9035</a> on 2025-08-19 13:14</div>
            <div class="timeline-body"><p>@abkarada thanks so much for the detailed suggestions.</p>
<p>I tried again on both alpine and slim-bookworm, the problem is still there. I noticed that this problem occurs even without uv.</p>
<p>But when i added your gunicorn commands (--timeout 120 and --keep-alive 2), after a long wait on refresh the page actually loads with no error. However, the random slow refresh is still there.</p>
<p>After all this testing, im pretty sure this is docker and gunicorn issue and not related to uv at all. So im going to close this issue. Thanks again to everyone for the help</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/SoAp9035">@SoAp9035</a> on 2025-08-19 13:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rubms">@rubms</a> on 2025-10-23 14:38</div>
            <div class="timeline-body"><p>I&#x27;ve had the same issues. It works locally but in ECS it times out. My recommendation: don&#x27;t use <code>uv</code> inside the container, and use the system Python environment instead. I tried with <code>uv pip install --system</code> but it still failed. The only way I made it work:</p>
<pre><code>RUN uv export --frozen --no-hashes -o requirements.txt
RUN pip install -r requirements.txt
</code></pre>
<p>This way I have the advantages of uv locally, but in CI/CD I leverage the container Python instance and prevent the issue.</p>
<p><code>uv</code>&#x27;s documentation itself touches on this in https://docs.astral.sh/uv/pip/environments/#deactivating-an-environment:</p>
<blockquote>
<p>Although we generally recommend using virtual environments for dependency management, --system is appropriate in continuous integration and containerized environments.</p>
</blockquote>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:40:02 UTC
    </footer>
</body>
</html>
