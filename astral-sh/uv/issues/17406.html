<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bad error message trying to install abi3 wheel on a free threaded venv - astral-sh/uv #17406</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Bad error message trying to install abi3 wheel on a free threaded venv</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/17406">#17406</a>
        opened by <a href="https://github.com/AngheloAlf">@AngheloAlf</a>
        on 2026-01-11 22:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AngheloAlf">@AngheloAlf</a> on 2026-01-11 22:37</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I tried looking for a similar issue but I couldn't find one.</p>
<p>The error message for trying to install a CPython GIL wheel on a free threaded wheel is confusing because it does not show anywhere the installation failed because the current venv is free threaded.</p>
<pre><code class="language-bash">$ uv pip install dist/crunch64-0.6.1-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl 
Resolved 1 package in 21ms
error: Failed to determine installation plan
  Caused by: A path dependency is incompatible with the current platform: dist/crunch64-0.6.1-cp37-abi3-manylinux_2_17_x86_64.manylinux2014_x86_64.whl

hint: The wheel is compatible with CPython 3.7 (`cp37`), but you're using CPython 3.14 (`cp314`)
</code></pre>
<p>I only encountered this problem because I got an error in CI where the CI failed while trying to test the built wheel by installing it in a freshly created venv, but <code>uv venv -p 3.14</code> installed <code>3.14t</code> instead of <code>3.14</code> (gil one) because the <code>t</code> one was available in the <code>PATH</code> while the gil one wasn't.
Trying to figure out this issue was annoying because I couldn't reproduce it locally until I figured out the problem was caused by the discrepancy between the free threaded and gil.</p>
<p>So this is a pretty niche issue since most people won't be installing wheels directly, but I still think improving the error message could be helpful.</p>
<p>To reproduce the problem just try to install any Python GIL wheel in a 3.14t venv:</p>
<pre><code class="language-bash">$ uv venv -p 3.14t
$ source .venv/bin/activate
$ uv pip install ./any_wheel_for_gil_python.whl 
</code></pre>
<h3>Example</h3>
<p>I think this error should mention somewhere that the current venv is using a free threaded Python, the most basic thing would be something among the lines of</p>
<pre><code>hint: The wheel is compatible with CPython 3.7 (`cp37`), but you're using CPython 3.14t (`cp314t`)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @AngheloAlf on 2026-01-11 22:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @konstin on 2026-01-12 10:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @konstin on 2026-01-12 10:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @konstin on 2026-01-12 10:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Improve the error message for trying to install a CPython GIL wheel on a free threaded venv" to "Bad error message trying to install abi3 wheel on a free threaded venv" by @konstin on 2026-01-12 10:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2026-01-12 10:37</div>
            <div class="timeline-body"><p>That's a really bad error message, we should fix that</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nooscraft">@nooscraft</a> on 2026-01-12 11:13</div>
            <div class="timeline-body"><p>I'm going to take this one</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nooscraft">@nooscraft</a> on 2026-01-12 12:12</div>
            <div class="timeline-body"><p>@konstin @zanieb - https://github.com/astral-sh/uv/pull/17415
please review, thanks</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 13:02:54 UTC
    </footer>
</body>
</html>
