<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constraint support for `uv lock` (as `uv pip install -r requirements.txt --constraint constraints.txt`) - astral-sh/uv #6644</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Constraint support for <code>uv lock</code> (as <code>uv pip install -r requirements.txt --constraint constraints.txt</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6644">#6644</a>
        opened by <a href="https://github.com/mthiboust">@mthiboust</a>
        on 2024-08-26 12:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mthiboust">@mthiboust</a> on 2024-08-26 12:51</div>
            <div class="timeline-body"><p>Is there an equivalent of  <code>uv pip install -r requirements.txt --constraint constraints.txt</code> for <code>uv lock</code>/<code>uv sync</code>?</p>
<h3>Use case:</h3>
<p>I want to install my python project inside a docker image whose base image (<a href="https://github.com/jupyter/docker-stacks/tree/main/images/base-notebook">jupyter/base-notebook</a> with dependencies installed via <code>mamba</code> in this case) has already installed some python libraries. I would like to avoid version conflicts by giving previously installed lib versions as constraints to lock my project dependencies (exporting previously installed libs with <code>pip list --format freeze</code> to create the <code>constraints.txt</code> file).</p>
<p>Is it possible or do you see a workaround?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-26 12:54</div>
            <div class="timeline-body"><p>You can provide constraints in the <code>pyproject.toml</code> like:</p>
<pre><code class="language-toml">[tool.uv]
constraint-dependencies = [&quot;flask==3.0.0&quot;]
</code></pre>
<p>But we don't currently have a way for you to provide a list of constraints like that. A few people have asked about it though, we should probably figure out a realistic workflow for it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-08-26 12:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-26 17:44</div>
            <div class="timeline-body"><p>I think we can track this in https://github.com/astral-sh/uv/issues/6518</p>
<p>I feel relatively strongly that constraints should be defined in the project metadata instead of provided directly to <code>uv lock</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-08-26 17:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mthiboust">@mthiboust</a> on 2024-08-26 20:45</div>
            <div class="timeline-body"><p>Thanks for your answers and linking this to the other issue.</p>
<p>Indeed, the following workflow using <code>uv add</code> would be great:</p>
<ul>
<li>Retrieving already installed packages with their version: <code>pip list --format freeze &gt; constraints.txt</code></li>
<li>Adding those as constraint dependencies to project metadata: <code>uv add --constraint constraints.txt</code></li>
<li>Locking the project: <code>uv lock</code></li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:40 UTC
    </footer>
</body>
</html>
