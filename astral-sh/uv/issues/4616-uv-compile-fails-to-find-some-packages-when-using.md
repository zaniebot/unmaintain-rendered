---
number: 4616
title: uv compile fails to find some packages when using --python-platform
type: issue
state: closed
author: jcugat
labels:
  - question
assignees: []
created_at: 2024-06-28T13:45:39Z
updated_at: 2024-06-28T13:55:37Z
url: https://github.com/astral-sh/uv/issues/4616
synced_at: 2026-01-10T01:23:39Z
---

# uv compile fails to find some packages when using --python-platform

---

_Issue opened by @jcugat on 2024-06-28 13:45_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

I'm trying to freeze some dependencies that I built locally for arm64 macs, but when using `uv pip compile` with the argument `--python-platform=macos` it fails the resolution, and removing the argument works perfectly even though I'm running it from an arm64 machine.

Detailed steps to reproduce:

```
❯ python -c 'import platform;import sys;print(f"{sys.platform=} {platform.machine()=}")'
sys.platform='darwin' platform.machine()='arm64'

❯ cat mydeps.in
ml-metadata==1.14.1.dev0

❯ la dist/ml-metadata/1.14.1.dev0/
total 37288
-rw-r--r--  1 josepc  staff    18M Jun 26 18:16 ml_metadata-1.14.1.dev0-cp38-cp38-macosx_13_0_arm64.whl

❯ uv pip compile --python-platform=macos --find-links /Users/josepc/work/python-arm64-packages/dist/ml-metadata/1.14.1.dev0/ mydeps.in -o mydeps.txt
  × No solution found when resolving dependencies:
  ╰─▶ Because ml-metadata==1.14.1.dev0 has no wheels are available with a matching platform and you require ml-metadata==1.14.1.dev0, we can conclude that the requirements are unsatisfiable.

❯ uv pip compile --find-links /Users/josepc/work/python-arm64-packages/dist/ml-metadata/1.14.1.dev0/ mydeps.in -o mydeps.txt
Resolved 6 packages in 1.62s
# This file was autogenerated by uv via the following command:
#    uv pip compile mydeps.in -o mydeps.txt
absl-py==1.4.0
    # via ml-metadata
attrs==21.4.0
    # via ml-metadata
grpcio==1.64.1
    # via ml-metadata
ml-metadata==1.14.1.dev0
    # via -r mydeps.in
protobuf==3.20.3
    # via ml-metadata
six==1.16.0
    # via ml-metadata
```


---

_Comment by @charliermarsh on 2024-06-28 13:47_

Can you share the list of wheels in `/Users/josepc/work/python-arm64-packages/dist/ml-metadata/1.14.1.dev0/`?

---

_Comment by @jcugat on 2024-06-28 13:50_

It's the third command I executed in my steps, do you need anything from inside the wheel?

---

_Comment by @charliermarsh on 2024-06-28 13:52_

Ah sorry, I missed it.

The default macOS deployment target is 12.0. So if you pass `--python-platform macos`, it tries to resolve for a minimum of macOS 12.0, but your wheel only supports 13.0 and later.

You can set the `MACOSX_DEPLOYMENT_TARGET=13.0` environment variable to override it.

---

_Comment by @charliermarsh on 2024-06-28 13:52_

(Or, of course, you can increase the compatibility of your wheel and try to lower the minimum supported macOS version.)

---

_Comment by @jcugat on 2024-06-28 13:54_

Ah gotcha, I completely missed this env var in the documentation. Thanks for the help!

---

_Closed by @jcugat on 2024-06-28 13:54_

---

_Comment by @charliermarsh on 2024-06-28 13:55_

No prob!

---

_Label `question` added by @charliermarsh on 2024-06-28 13:55_

---
