```yaml
number: 9861
title: Resolver error trees with collapsed unavailable conclusion is out of order
type: issue
state: closed
author: zanieb
labels: []
assignees: []
created_at: 2024-12-13T05:28:02Z
updated_at: 2024-12-13T21:06:40Z
url: https://github.com/astral-sh/uv/issues/9861
synced_at: 2026-01-10T01:57:22Z
```

# Resolver error trees with collapsed unavailable conclusion is out of order

---

_Issue opened by @zanieb on 2024-12-13 05:28_

e.g.,

```
❯ echo "open3d" | cargo run -- pip compile --no-cache --exclude-newer 2024-03-25T00:00:00Z --python-platform linux --python 3.10 -
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.49s
     Running `target/debug/uv pip compile --no-cache --exclude-newer '2024-03-25T00:00:00Z' --python-platform linux --python 3.10 -`
Resolver derivation tree before reduction
term root==0a0.dev0
  root==0a0.dev0 depends on open3d*
  term open3d*
    open3d==0.18.0 no wheels with a matching platform tag
    term open3d<0.18.0 | >0.18.0
      open3d==0.17.0 no wheels with a matching platform tag
      term open3d<0.17.0 | >0.17.0, <0.18.0 | >0.18.0
        open3d==0.16.1 no wheels with a matching platform tag
        term open3d<0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
          open3d==0.16.0 no wheels with a matching platform tag
          term open3d<0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
            open3d==0.15.2 no wheels with a matching Python ABI tag
            term open3d<0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
              open3d==0.15.1 no wheels with a matching Python ABI tag
              term open3d<0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                open3d==0.14.1 no wheels with a matching Python ABI tag
                term open3d<0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                  open3d==0.13.0 no wheels with a matching Python ABI tag
                  term open3d<0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                    open3d==0.12.0 no wheels with a matching Python ABI tag
                    term open3d<0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                      open3d==0.11.2 no wheels with a matching Python ABI tag
                      term open3d<0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                        open3d==0.11.1 no wheels with a matching Python ABI tag
                        term open3d<0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                          open3d==0.11.0 no wheels with a matching Python ABI tag
                          term open3d<0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                            open3d==0.10.0.1 no wheels with a matching Python ABI tag
                            term open3d<0.10.0.1 | >0.10.0.1, <0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                              open3d==0.10.0.0 no wheels with a matching Python ABI tag
                              term open3d<0.10.0.0 | >0.10.0.0, <0.10.0.1 | >0.10.0.1, <0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                                open3d==0.9.0.0 no wheels with a matching Python ABI tag
                                term open3d<0.9.0.0 | >0.9.0.0, <0.10.0.0 | >0.10.0.0, <0.10.0.1 | >0.10.0.1, <0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
                                  open3d==0.8.0.0 no wheels with a matching Python ABI tag
                                  no versions of open3d<0.8.0.0 | >0.8.0.0, <0.9.0.0 | >0.9.0.0, <0.10.0.0 | >0.10.0.0, <0.10.0.1 | >0.10.0.1, <0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
Resolver derivation tree after reduction
term root==0a0.dev0
  root==0a0.dev0 depends on open3d*
  term open3d<0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
    open3d==0.16.0 | ==0.16.1 | ==0.17.0 | ==0.18.0 no wheels with a matching platform tag
    term open3d<0.9.0.0 | >0.9.0.0, <0.10.0.0 | >0.10.0.0, <0.10.0.1 | >0.10.0.1, <0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
      open3d==0.8.0.0 | ==0.9.0.0 | ==0.10.0.0 | ==0.10.0.1 | ==0.11.0 | ==0.11.1 | ==0.11.2 | ==0.12.0 | ==0.13.0 | ==0.14.1 | ==0.15.1 | ==0.15.2 no wheels with a matching Python ABI tag
      no versions of open3d<0.8.0.0 | >0.8.0.0, <0.9.0.0 | >0.9.0.0, <0.10.0.0 | >0.10.0.0, <0.10.0.1 | >0.10.0.1, <0.11.0 | >0.11.0, <0.11.1 | >0.11.1, <0.11.2 | >0.11.2, <0.12.0 | >0.12.0, <0.13.0 | >0.13.0, <0.14.1 | >0.14.1, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of open3d are available:
          open3d==0.8.0.0
          open3d==0.9.0.0
          open3d==0.10.0.0
          open3d==0.10.0.1
          open3d==0.11.0
          open3d==0.11.1
          open3d==0.11.2
          open3d==0.12.0
          open3d==0.13.0
          open3d==0.14.1
          open3d==0.15.1
          open3d==0.15.2
          open3d==0.16.0
          open3d==0.16.1
          open3d==0.17.0
          open3d==0.18.0
      and open3d<=0.15.2 has no wheels with a matching Python ABI tag, we can conclude that open3d<0.9.0.0 cannot be used.
      And because open3d>=0.16.0 has no wheels with a matching platform tag and you require open3d, we can conclude that your
      requirements are unsatisfiable.
```

We make the conclusion "we can conclude that open3d<0.9.0.0 cannot be used" before we make the second proof about the incompatible range "because open3d>=0.16.0 has no wheels"

There's some more context in https://github.com/pubgrub-rs/pubgrub/issues/297 as I've explored a couple issues here — the root cause might be the same.

---

_Referenced in [pubgrub-rs/pubgrub#297](../../pubgrub-rs/pubgrub/issues/297.md) on 2024-12-13 05:28_

---

_Comment by @zanieb on 2024-12-13 05:30_

Interestingly, adding a bound fixes this? I added `>0.15.0` just in an attempt to minimize the problem.

```
❯ echo "open3d>0.15.0" | cargo run -- pip compile --no-cache --exclude-newer 2024-03-25T00:00:00Z --python-platform linux --python 3.10 -
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.15s
     Running `target/debug/uv pip compile --no-cache --exclude-newer '2024-03-25T00:00:00Z' --python-platform linux --python 3.10 -`
Resolver derivation tree before reduction
term root==0a0.dev0
  root==0a0.dev0 depends on open3d>0.15.0
  term open3d>0.15.0
    open3d==0.18.0 no wheels with a matching platform tag
    term open3d>0.15.0, <0.18.0 | >0.18.0
      open3d==0.17.0 no wheels with a matching platform tag
      term open3d>0.15.0, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
        open3d==0.16.1 no wheels with a matching platform tag
        term open3d>0.15.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
          open3d==0.16.0 no wheels with a matching platform tag
          term open3d>0.15.0, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
            open3d==0.15.2 no wheels with a matching Python ABI tag
            term open3d>0.15.0, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
              open3d==0.15.1 no wheels with a matching Python ABI tag
              no versions of open3d>0.15.0, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
Resolver derivation tree after reduction
term root==0a0.dev0
  root==0a0.dev0 depends on open3d>0.15.0
  term open3d>0.15.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
    open3d==0.16.0 | ==0.16.1 | ==0.17.0 | ==0.18.0 no wheels with a matching platform tag
    term open3d>0.15.0, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
      open3d==0.15.1 | ==0.15.2 no wheels with a matching Python ABI tag
      no versions of open3d>0.15.0, <0.15.1 | >0.15.1, <0.15.2 | >0.15.2, <0.16.0 | >0.16.0, <0.16.1 | >0.16.1, <0.17.0 | >0.17.0, <0.18.0 | >0.18.0
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of open3d are available:
          open3d<0.15.0
          open3d==0.15.1
          open3d==0.15.2
          open3d==0.16.0
          open3d==0.16.1
          open3d==0.17.0
          open3d==0.18.0
      and open3d>=0.15.1,<=0.15.2 has no wheels with a matching Python ABI tag, we can conclude that open3d>0.15.0,<0.15.2 cannot be used.
      And because open3d>=0.16.0 has no wheels with a matching platform tag and you require open3d>0.15.0, we can conclude that your requirements are unsatisfiable.
``

---

_Comment by @zanieb on 2024-12-13 05:33_

Though it does not work with a smaller version

```
❯ echo "open3d>=0.11.0" | cargo run -- pip compile --no-cache --exclude-newer 2024-03-25T00:00:00Z --python-platform linux --python 3.10 -
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.14s
     Running `target/debug/uv pip compile --no-cache --exclude-newer '2024-03-25T00:00:00Z' --python-platform linux --python 3.10 -`
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of open3d are available:
          open3d<=0.11.0
          open3d==0.11.1
          open3d==0.11.2
          open3d==0.12.0
          open3d==0.13.0
          open3d==0.14.1
          open3d==0.15.1
          open3d==0.15.2
          open3d==0.16.0
          open3d==0.16.1
          open3d==0.17.0
          open3d==0.18.0
      and open3d>=0.11.0,<=0.15.2 has no wheels with a matching Python ABI tag, we can conclude that open3d>=0.11.0,<0.11.1 cannot be used.
      And because open3d>=0.16.0 has no wheels with a matching platform tag and you require open3d>=0.11.0, we can conclude that your requirements are unsatisfiable.
```

Removing the `simplify` call is helpful?

```
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of open3d are available:
          open3d<=0.11.0
          open3d==0.11.1
          open3d==0.11.2
          open3d==0.12.0
          open3d==0.13.0
          open3d==0.14.1
          open3d==0.15.1
          open3d==0.15.2
          open3d==0.16.0
          open3d==0.16.1
          open3d==0.17.0
          open3d==0.18.0
      and open3d>=0.11.0,<=0.15.2 has no wheels with a matching Python ABI tag, we can conclude that all of:
          open3d>=0.11.0,<0.11.1
          open3d>0.11.1,<0.11.2
          open3d>0.11.2,<0.12.0
          open3d>0.12.0,<0.13.0
          open3d>0.13.0,<0.14.1
          open3d>0.14.1,<0.15.1
          open3d>0.15.1,<0.15.2
          open3d>0.15.2,<0.16.0
          open3d>0.16.0,<0.16.1
          open3d>0.16.1,<0.17.0
          open3d>0.17.0,<0.18.0
          open3d>0.18.0
       cannot be used.
      And because open3d>=0.16.0 has no wheels with a matching platform tag and you require open3d>=0.11.0, we can conclude that your requirements are unsatisfiable.
```

And so is the complement

```
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of open3d are available:
          open3d<=0.11.0
          open3d==0.11.1
          open3d==0.11.2
          open3d==0.12.0
          open3d==0.13.0
          open3d==0.14.1
          open3d==0.15.1
          open3d==0.15.2
          open3d==0.16.0
          open3d==0.16.1
          open3d==0.17.0
          open3d==0.18.0
      and open3d>=0.11.0,<=0.15.2 has no wheels with a matching Python ABI tag, we can conclude that all of:
          open3d<0.11.0
          open3d==0.11.1
          open3d==0.11.2
          open3d==0.12.0
          open3d==0.13.0
          open3d==0.14.1
          open3d==0.15.1
          open3d==0.15.2
          open3d==0.16.0
          open3d==0.16.1
          open3d==0.17.0
          open3d==0.18.0
       cannot be used.
      And because open3d>=0.16.0 has no wheels with a matching platform tag and you require open3d>=0.11.0, we can conclude that your requirements are unsatisfiable.
```

but this doesn't work for most conclusions? (i.e., many regressions if I run the test suite with these changes)

Here, at least, it's very clear the ordering is wrong?

---

_Referenced in [astral-sh/uv#9877](../../astral-sh/uv/pulls/9877.md) on 2024-12-13 19:33_

---

_Closed by @zanieb on 2024-12-13 21:06_

---
