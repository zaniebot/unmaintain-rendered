<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sync with system Python? - astral-sh/uv #5964</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Sync with system Python?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5964">#5964</a>
        opened by <a href="https://github.com/b-phi">@b-phi</a>
        on 2024-08-09 16:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/b-phi">@b-phi</a></div>
            <div class="timeline-body"><p>I&#x27;m trying to use uv to synchronize environments across a cluster. This involves creating a lock file and then using it to install dependencies everywhere. As far as I can tell, <code>uv sync</code> only supports installing dependencies in a uv managed venv. Is there anyway to run sync against a target environment, the system Python in this case?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/b-phi">@b-phi</a> on 2024-08-09 17:54</div>
            <div class="timeline-body"><p>I was able to workaround this by activating the environment dynamically, but this does feel like a bit of a hack since it doesn&#x27;t guarantee that the environments are actually synced. This is with a dask cluster, I&#x27;m not aware of an easy way to &quot;switch&quot; to the new venv if the workers are started with the system python.</p>
<pre><code>import runpy

runpy.run_path(&#x27;.venv/bin/activate_this.py&#x27;)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-09 17:55</div>
            <div class="timeline-body"><p>Na this isn&#x27;t supported yet.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chrisrodrigue">@chrisrodrigue</a> on 2024-08-11 01:39</div>
            <div class="timeline-body"><p>I think you can use <code>uv venv --system-site-packages</code> but <code>uv sync</code> is not yet aware of requirements that are already satisfied by the system/inherited environment so it still attempts to resolve and install them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SamuelT-Beslogic">@SamuelT-Beslogic</a> on 2024-08-14 20:38</div>
            <div class="timeline-body"><p>In the mean time, I&#x27;m addind the venv&#x27;s bin (or Scripts on Windows) folder to PATH as per https://github.com/jakebailey/pyright-action/tree/v2/?tab=readme-ov-file#using-pyright-from-path :</p>
<pre><code>jobs:
  mypy:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: canopeum_backend
    steps:
      - uses: actions/checkout@v4
      - name: Install uv using the standalone installer
        run: curl -LsSf https://astral.sh/uv/install.sh | sh
      - run: uv sync --locked --extra dev
      - run: echo &quot;$PWD/.venv/bin&quot; &gt;&gt; $GITHUB_PATH
      - run: mypy . --python-version=3.12

  pyright:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: canopeum_backend
    steps:
      - uses: actions/checkout@v4
      - name: Install uv using the standalone installer
        run: curl -LsSf https://astral.sh/uv/install.sh | sh
      - run: uv sync --locked --extra dev
      - run: echo &quot;$PWD/.venv/bin&quot; &gt;&gt; $GITHUB_PATH
      - uses: jakebailey/pyright-action@v2
        with:
          version: PATH
          python-version: &quot;3.12&quot;
          working-directory: canopeum_backend
</code></pre>
<p>And making sure that my docker commands are using <code>uv run</code> instead of <code>python</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seppzer0">@seppzer0</a> on 2024-08-25 15:16</div>
            <div class="timeline-body"><p>I upvote for the optional synchronization with the host system rather than with venv-only. Not only for CI/CD, but for me personally it is also occasionally preferable to install project packages into the system directly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-08-25 20:04</div>
            <div class="timeline-body"><p>One option is to symlink:</p>
<pre><code>ln -sf $(/path/to/target/python -c &#x27;import sys; print(sys.prefix)&#x27;) .venv 
uv sync
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-26 17:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-26 17:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-26 17:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seppzer0">@seppzer0</a> on 2024-09-05 11:33</div>
            <div class="timeline-body"><p>I suppose it is a functional workaround, but having this implemented natively into uv would be a big improvement</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-05 13:56</div>
            <div class="timeline-body"><p>This is now supported via <code>UV_PROJECT_ENVIRONMENT</code> (#6834) â€” I still don&#x27;t recommend it but you don&#x27;t need to do a symlink.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-05 13:56</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:32:39 UTC
    </footer>
</body>
</html>
