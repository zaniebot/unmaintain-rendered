<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>` uv venv --preview --python` with a new version of Python gives a garbled repl prompt - astral-sh/uv #4209</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>` uv venv --preview --python` with a new version of Python gives a garbled repl prompt</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/4209">#4209</a>
        opened by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a>
        on 2024-06-10 18:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2024-06-10 18:42</div>
            <div class="timeline-body"><p>Perhaps I'm trying out this feature too quickly, and it's a known issue, but I was interested to see if I was likely able to drop using conda for local development.</p>
<p>But on my machine when I get <code> uv venv --preview --python</code> to install a version of Python the repl prompt is garbled:</p>
<pre><code>$ uv venv --preview --python 3.8
$ source .venv/bin/activate
$ python
Python 3.8.19 (default, Apr 15 2024, 18:26:04) 
[Clang 17.0.6 ] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
]633;E;exit()]633;D;0]633;A&gt;&gt;&gt; ]633;B]633;C
</code></pre>
<p>I can type into the repl as normal:</p>
<pre><code>]633;E;exit()]633;D;0]633;A&gt;&gt;&gt; ]633;B]633;C1+1
2
]633;E;1+1]633;D;0]633;A&gt;&gt;&gt; ]633;B]633;C
</code></pre>
<p>Here's the verbose output of the initial install (after I cleared out everything in the toolchain directory):</p>
<pre><code>uv venv --preview --python 3.8 -v
DEBUG Searching for Python 3.8 in search path or managed toolchains
DEBUG Searching for managed toolchains at `/home/STRIKETECH/dshaw/.local/share/uv/toolchains`
DEBUG Found CPython 3.11.2 at `/home/STRIKETECH/dshaw/miniforge3/envs/backoffice/bin/python3` (search path)
DEBUG Found CPython 3.11.2 at `/home/STRIKETECH/dshaw/miniforge3/envs/backoffice/bin/python` (search path)
DEBUG Found CPython 3.11.2 at `/usr/local/bin/python3` (search path)
DEBUG Found CPython 3.7.2 at `/usr/bin/python3` (search path)
DEBUG Can't use Python at `/usr/bin/python`
DEBUG Requested Python not found, checking for available download...
DEBUG Using request timeout of 30s
INFO Fetching requested toolchain...
DEBUG Downloading https://github.com/indygreg/python-build-standalone/releases/download/20240415/cpython-3.8.19%2B20240415-x86_64-unknown-linux-gnu-debug-full.tar.zst to temporary location /home/STRIKETECH/dshaw/.local/share/uv/toolchains/.tmpz2lFVI
DEBUG Extracting cpython-3.8.19%2B20240415-x86_64-unknown-linux-gnu-debug-full.tar.zst
DEBUG Moving /home/STRIKETECH/dshaw/.local/share/uv/toolchains/.tmpz2lFVI/python to /home/STRIKETECH/dshaw/.local/share/uv/toolchains/cpython-3.8.19-linux-x86_64-gnu
Using Python 3.8.19 interpreter at: /home/STRIKETECH/dshaw/.local/share/uv/toolchains/cpython-3.8.19-linux-x86_64-gnu/install/bin/python3
Creating virtualenv at: .venv
INFO Removing existing directory
Activate with: source .venv/bin/activate
</code></pre>
<p>I assume this is related to my old Linux distro vs. whatever was expected when it was compiled, but conda Python installs work fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "` uv venv --preview --python` a new version of Python with uv gives a garbled repl line" to "` uv venv --preview --python` with a new version of Python gives a garbled repl line" by @notatallshaw-gts on 2024-06-10 18:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "` uv venv --preview --python` with a new version of Python gives a garbled repl line" to "` uv venv --preview --python` with a new version of Python gives a garbled repl prompt" by @notatallshaw-gts on 2024-06-10 18:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-10 18:46</div>
            <div class="timeline-body"><p>Hm interesting. What's your system?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2024-06-10 18:47</div>
            <div class="timeline-body"><p>Oh, I see this is probably a bug with https://github.com/indygreg/python-build-standalone, I'll check over there and see if I can resolve the issue with my own config or if it's a bug with their config.</p>
<blockquote>
<p>Hm interesting. What's your system?</p>
</blockquote>
<p>Fedora release 29</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @notatallshaw-gts on 2024-06-10 18:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-10 18:50</div>
            <div class="timeline-body"><p>We're maintainers over there too :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2024-06-10 18:58</div>
            <div class="timeline-body"><p>Ah, well, I quickly tried manually downloading both the <code>musl</code> and <code>gnu</code> versions, and I got the same issue with both.</p>
<p>When I have some time to read through their documentation, and test if it's a recent regression or has always been the case, I will open an issue there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2024-06-17 15:52</div>
            <div class="timeline-body"><p>And going back to this today to file an issue against https://github.com/indygreg/python-build-standalone I can't reproduce it... ðŸ˜•</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:28 UTC
    </footer>
</body>
</html>
