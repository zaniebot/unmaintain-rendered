<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incorrect dependency version constraints, maybe due to wrong python verison - astral-sh/uv #9283</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Incorrect dependency version constraints, maybe due to wrong python verison</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/9283">#9283</a>
        opened by <a href="https://github.com/tigersoldier">@tigersoldier</a>
        on 2024-11-20 17:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/tigersoldier">@tigersoldier</a> on 2024-11-20 17:15</div>
            <div class="timeline-body"><p>gensim 3.8.3 should only <a href="https://github.com/piskvorky/gensim/blob/e889fa3d45a406cabbc7e180fa9a8ee3f76ac6f0/setup.py#L335-L345">require numpy&gt;=1.11.3 on Python 3.x</a>. However uv is using the 2.x constraints (numpy &lt;= 1.16.1)</p>
<pre><code class="language-bash">$ uv --version
uv 0.5.2 (195f4b634 2024-11-14)
$ uv run python --version
Python 3.10.15
$ uv pip install gensim==3.8.3 numpy==1.22.0
  × No solution found when resolving dependencies:
  ╰─▶ Because gensim==3.8.3 depends on numpy&lt;=1.16.1 and you require gensim==3.8.3, we can conclude that you require numpy&lt;=1.16.1.
      And because you require numpy==1.22.0, we can conclude that your requirements are unsatisfiable.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-20 17:19</div>
            <div class="timeline-body"><p>I presume this is related to the lack of wheels with a compatible Python version? https://inspector.pypi.io/project/gensim/3.8.3/</p>
<p>Can you share verbose logs with <code>-v</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tigersoldier">@tigersoldier</a> on 2024-11-21 04:58</div>
            <div class="timeline-body"><p>Sure. Looks like it's resolving to a metadata for py 2.7 and macos x86 while I was on arm</p>
<pre><code class="language-bash">uv pip install gensim==3.8.3 numpy==1.22.0 --no-binary gensim -v
DEBUG uv 0.5.2 (195f4b634 2024-11-14)
DEBUG Searching for default Python interpreter in virtual environments
DEBUG Found `cpython-3.10.15-macos-aarch64-none` at `/Users/caibin.chen/tmp/.venv/bin/python3` (active virtual environment)
Using Python 3.10.15 environment at /Users/caibin.chen/tmp/.venv
DEBUG Acquired lock for `/Users/caibin.chen/tmp/.venv`
DEBUG At least one requirement is not satisfied: numpy==1.22.0
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.10.15
DEBUG Solving with target Python version: &gt;=3.10.15
DEBUG Adding direct dependency: gensim&gt;=3.8.3, &lt;3.8.3+
DEBUG Adding direct dependency: numpy&gt;=1.22.0, &lt;1.22.0+
DEBUG Found stale response for: https://pypi.org/simple/gensim/
DEBUG Sending revalidation request for: https://pypi.org/simple/gensim/
DEBUG Found stale response for: https://pypi.org/simple/numpy/
DEBUG Sending revalidation request for: https://pypi.org/simple/numpy/
DEBUG Found not-modified response for: https://pypi.org/simple/numpy/
DEBUG Found not-modified response for: https://pypi.org/simple/gensim/
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/0b/d8/98f051eb7b4c7b8837be3f062a2decb1e99467296603128211851f20c3b5/numpy-1.22.0-cp310-cp310-macosx_11_0_arm64.whl.metadata
DEBUG Searching for a compatible version of gensim (&gt;=3.8.3, &lt;3.8.3+)
DEBUG Selecting: gensim==3.8.3 [compatible] (gensim-3.8.3.tar.gz)
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/e5/1c/eeea5353730937ab38259e057e5c99507bb7cf8ad96d29f8a947ea5e66a7/gensim-3.8.3-cp27-cp27m-macosx_10_9_x86_64.whl.metadata
DEBUG Adding transitive dependency for gensim==3.8.3: numpy&lt;=1.16.1+
DEBUG Adding transitive dependency for gensim==3.8.3: scipy&lt;=1.2.3+
DEBUG Adding transitive dependency for gensim==3.8.3: six&gt;=1.5.0
DEBUG Adding transitive dependency for gensim==3.8.3: smart-open&gt;=1.8.1, &lt;1.11
DEBUG Searching for a compatible version of gensim (&gt;3.8.3, &lt;3.8.3+)
DEBUG No compatible version found for: gensim
DEBUG Found stale response for: https://pypi.org/simple/six/
DEBUG Sending revalidation request for: https://pypi.org/simple/six/
DEBUG Found stale response for: https://pypi.org/simple/smart-open/
DEBUG Sending revalidation request for: https://pypi.org/simple/smart-open/
DEBUG Found stale response for: https://pypi.org/simple/scipy/
DEBUG Sending revalidation request for: https://pypi.org/simple/scipy/
DEBUG Found not-modified response for: https://pypi.org/simple/six/
DEBUG Found not-modified response for: https://pypi.org/simple/scipy/
DEBUG Found not-modified response for: https://pypi.org/simple/smart-open/
  × No solution found when resolving dependencies:
  ╰─▶ Because gensim==3.8.3 depends on numpy&lt;=1.16.1 and you require gensim==3.8.3, we can conclude that you require numpy&lt;=1.16.1.
      And because you require numpy==1.22.0, we can conclude that your requirements are unsatisfiable.
DEBUG Released lock at `/Users/&lt;...&gt;/tmp/.venv/.lock`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-21 22:40</div>
            <div class="timeline-body"><p>I know what the problem is here (none of the wheels are compatible, but we're fetching the &quot;least compatible&quot; Python implementation due to the issue in https://github.com/astral-sh/uv/issues/7553).</p>
<p>I'd note though that this is at least in part a gensim problem: they publish inconsistent metadata across the wheels, which will generally cause problems for uv (and Poetry, and possibly other tools). The wheel that we fetched does indeed say <code>Requires-Dist: numpy (&lt;=1.16.1)</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-11-21 22:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-11-21 22:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/9339.html">astral-sh/uv#9339</a> on 2024-11-21 22:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-22 14:58</div>
            <div class="timeline-body"><p>We read metadata from one of the wheels and assume it's consistent with the other ones — this makes resolution far more tractable.</p>
<p>We're considering improving the behavior around this https://github.com/astral-sh/uv/pull/7381, but there are trade-offs.</p>
<p>I did think we ignored py27 wheels regardless though, cc @charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-22 14:59</div>
            <div class="timeline-body"><p>Oh sorry this refreshed to show Charlie's comment <em>after</em> I replied. What he said is more correct :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-26 14:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-26 14:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:01 UTC
    </footer>
</body>
</html>
