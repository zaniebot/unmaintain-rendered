<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv self update not working behind zscaler proxy - astral-sh/uv #10724</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv self update not working behind zscaler proxy</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10724">#10724</a>
        opened by <a href="https://github.com/MonkeyLeeT">@MonkeyLeeT</a>
        on 2025-01-17 22:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MonkeyLeeT">@MonkeyLeeT</a></div>
            <div class="timeline-body"><p>Error looks like https://github.com/astral-sh/uv/issues/1474. Also any scripts requiring http requests are failing due to same certificate issue of <code>unable to get local issuer certificate</code>.</p>
<p>Running script directly with python3 works so my certificate is fine. Turning off zscaler (a corporate proxy) also works.</p>
<p>I have followed suggestions from https://github.com/search?q=repo%3Aastral-sh%2Fuv+certificate&amp;type=issues, but I'm still hitting the error as if the right certificate is not used by uv at all.</p>
<ul>
<li>--native-tls flag when running uv command</li>
<li>export SSL_CERT_FILE to point to the cert file used by native python</li>
<li>Making sure the same certificate file is used across all python versions and certifi package.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "uv self update not working behind zscaler" to "uv self update not working behind zscaler proxy" by @MonkeyLeeT on 2025-01-17 22:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-01-17 22:56</div>
            <div class="timeline-body"><p>Similar to https://github.com/astral-sh/uv/issues/10709 I think</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-18 16:05</div>
            <div class="timeline-body"><p>Can I merge into #10709?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/deffi">@deffi</a> on 2025-01-18 18:12</div>
            <div class="timeline-body"><p>This one is about certificates (SSL), while #10709 is about proxy authentication (user credentials). These might be two distinct issues.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-01-18 18:20</div>
            <div class="timeline-body"><p>In most corporate environments the proxy just needs connection to be secure with the local certificates. The auth flow then occurs securly via redirects (similiar to oauth). I <em>assume</em> reqwests can talk to proxies via SSL and just need the certificates, but I could be wrong, not all HTTP libraries support secure proxy connections.</p>
<p>If the auth flow requires some byzantine authentication protocol (I've seen very obscure Microsoft APIs that even Microsoft recommended to not use anymore) then the chances are pretty small any Rust library will support it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">network</span> added by @charliermarsh on 2025-01-20 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/deffi">@deffi</a> on 2025-01-20 16:29</div>
            <div class="timeline-body"><p>For the record: #10709 turned out to be about the installer script and the Windows-specific machinery it invokes, and therefore unrelated to Python, reqwest, and certificates.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MonkeyLeeT">@MonkeyLeeT</a> on 2025-01-20 17:34</div>
            <div class="timeline-body"><p>Somehow I couldn't reproduce it today with zscaler on, not sure if my corp did anything so I'll close this for now and reopen if I could reproduce.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MonkeyLeeT on 2025-01-20 17:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wleftwich">@wleftwich</a> on 2025-01-21 11:59</div>
            <div class="timeline-body"><p>I ran into the same problem with Zscaler (on Linux Mint), and this is what worked</p>
<pre><code>~$ uv python install 3.7
error: Failed to install cpython-3.7.9-linux-x86_64-gnu
  Caused by: Failed to download https://github.com/astral-sh/python-build-standalone/releases/download/20200822/cpython-3.7.9-x86_64-unknown-linux-gnu-pgo-20200823T0036.tar.zst
  Caused by: Request failed after 3 retries
  Caused by: error sending request for url (https://github.com/astral-sh/python-build-standalone/releases/download/20200822/cpython-3.7.9-x86_64-unknown-linux-gnu-pgo-20200823T0036.tar.zst)
  Caused by: client error (Connect)
  Caused by: invalid peer certificate: UnknownIssuer

~$ # Find the Zscaler cert
~$ ls -l /etc/ssl/certs/Z*
lrwxrwxrwx 1 root root 49 Jan 15 09:52 /etc/ssl/certs/ZscalerRoot0.pem -&gt; /usr/local/share/ca-certificates/ZscalerRoot0.crt
~$ # Might need to `sudo update-ca-certificates`

~$ export SSL_CERT_FILE=/etc/ssl/certs/ca-certificates.crt

~$ uv python install 3.7
Installed Python 3.7.9 in 2.53s
 + cpython-3.7.9-linux-x86_64-gnu
</code></pre>
<p>At the company where I work, if you have SSL problems, &quot;blame Zscaler&quot; is usually correct.
You also have to jump through some hoops to get it working with Docker.</p>
<p>More info on this from Zscaler:
https://community.zscaler.com/zenith/s/question/0D54u00009jZpG7CAK/installing-tls-ssl-root-certificates-to-nonstandard-environments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/remerjohnson">@remerjohnson</a> on 2025-03-27 13:51</div>
            <div class="timeline-body"><blockquote>
<p>At the company where I work, if you have SSL problems, &quot;blame Zscaler&quot; is usually correct. You also have to jump through some hoops to get it working with Docker.</p>
</blockquote>
<p>I'm running into this exact issue with Docker. Did you ever find a way to set this up in Docker?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:29:24 UTC
    </footer>
</body>
</html>
