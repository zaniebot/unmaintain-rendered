<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv .venv and VS Code Jupyter Notebook: Connecting to Kernel - astral-sh/uv #6672</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv .venv and VS Code Jupyter Notebook: Connecting to Kernel</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/6672">#6672</a>
        opened by <a href="https://github.com/wes-stone">@wes-stone</a>
        on 2024-08-27 05:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/wes-stone">@wes-stone</a> on 2024-08-27 05:36</div>
            <div class="timeline-body"><p>Hello and thanks for all the great work with uv!</p>
<p>I was hoping to be able to use VS Code Jupyter notebooks with just uv to install Python. Loading the .venv works fine, but when running a code block, it is stuck in an infinite loop trying to connect to a Kernel. This only happens with VS Code Jupyter Notebooks as well. If I have the web version installed but specify to use the python installed with <code>uv venv --python 3.10</code> it works fine. Would be great to not have to have a web version installed and only use uv to manage Python but understand if there's no workaround. Thanks for the help!</p>
<pre><code>PS C:\Users\USER\testing stuff&gt; uv python list
cpython-3.12.5-windows-x86_64-none     &lt;download available&gt;
cpython-3.11.9-windows-x86_64-none     &lt;download available&gt;
cpython-3.10.14-windows-x86_64-none    C:\Users\USER\AppData\Roaming\uv\data\python\cpython-3.10.14-windows-x86_64-none\python.exe
cpython-3.9.19-windows-x86_64-none     &lt;download available&gt;
cpython-3.8.19-windows-x86_64-none     &lt;download available&gt;
pypy-3.7.13-windows-x86_64-none        &lt;download available&gt;
PS C:\Users\wesst\testing stuff&gt; 
 *  History restored 
</code></pre>
<p>Jupyter installed as well</p>
<pre><code>PS C:\Users\wesst\testing stuff&gt; uv pip tree
fqdn v1.5.1
isoduration v20.11.0
‚îî‚îÄ‚îÄ arrow v1.3.0
    ‚îú‚îÄ‚îÄ python-dateutil v2.9.0.post0
    ‚îÇ   ‚îî‚îÄ‚îÄ six v1.16.0
    ‚îî‚îÄ‚îÄ types-python-dateutil v2.9.0.20240821
jsonpointer v3.0.0
jupyter v1.0.0
‚îú‚îÄ‚îÄ notebook v7.2.1
.....
</code></pre>
<pre><code>Visual Studio Code (1.92.2, undefined, desktop)
Jupyter Extension Version: 2024.7.0.
Python Extension Version: 2024.12.3.
Pylance Extension Version: 2024.8.2.
Platform: win32 (x64).
Workspace folder ~\testing stuff, Home = c:\Users\USER
22:17:38.461 [info] Starting Kernel (Python Path: ~\testing stuff\.venv\Scripts\python.exe, Venv, 3.10.14) for '~\testing stuff\test.ipynb' (disableUI=true)
22:17:39.048 [info] Process Execution: ~\testing stuff\.venv\Scripts\python.exe -m pip list
22:17:39.060 [info] Process Execution: ~\testing stuff\.venv\Scripts\python.exe -c &quot;import ipykernel; print(ipykernel.__version__); print(&quot;5dc3a68c-e34e-4080-9c3e-2a532b2ccb4d&quot;); print(ipykernel.__file__)&quot;
22:17:39.268 [info] Process Execution: ~\testing stuff\.venv\Scripts\python.exe -c &quot;import pip;print('6af208d0-cb9c-427f-b937-ff563e17efdf')&quot;
22:17:39.410 [warn] No interpreter with path ~\example\.venv\Scripts\python.exe found in Python API, will convert Uri path to string as Id ~\example\.venv\Scripts\python.exe
22:17:39.458 [warn] Failed to get activated env vars for ~\.virtualenvs\Documents-f1-lh8zo\Scripts\python.exe in 208ms
22:17:39.460 [error] Unable to determine site packages path for python ~\.virtualenvs\Documents-f1-lh8zo\Scripts\python.exe (Venv)
22:17:39.471 [info] Process Execution: ~\.virtualenvs\Documents-f1-lh8zo\Scripts\python.exe c:\Users\~\.vscode\extensions\ms-toolsai.jupyter-2024.7.0-win32-x64\pythonFiles\vscode_datascience_helpers\kernel_interrupt_daemon.py --ppid 14064
    &gt; cwd: ~\.vscode\extensions\ms-toolsai.jupyter-2024.7.0-win32-x64\pythonFiles\vscode_datascience_helpers
22:17:41.868 [warn] Disposing old controller startUsingPythonInterpreter:'.jvsc74a57bd0425368e222807f297773663fdefa9d8713b24c56578a546e4a90a8565a35668f.c:\Users\~\AppData\Local\Programs\Python\Python313\python.exe.c:\Users\~\AppData\Local\Programs\Python\Python313\python.exe.-m#ipykernel_launcher' for view = 'jupyter-notebook'
22:17:41.869 [warn] Disposing old controller startUsingPythonInterpreter:'.jvsc74a57bd0425368e222807f297773663fdefa9d8713b24c56578a546e4a90a8565a35668f.c:\Users\~\AppData\Local\Programs\Python\Python313\python.exe.c:\Users\~\AppData\Local\Programs\Python\Python313\python.exe.-m#ipykernel_launcher (Interactive)' for view = 'interactive'
</code></pre>
<p>Below seems to be main issue.</p>
<pre><code>22:17:39.458 [warn] Failed to get activated env vars for ~\.virtualenvs\Documents-f1-lh8zo\Scripts\python.exe in 208ms
22:17:39.460 [error] Unable to determine site packages path for python ~\.virtualenvs\Documents-f1-lh8zo\Scripts\python.exe (Venv)
22:17:39.471 [info] Process Execution: ~\.virtualenvs\Documents-f1-lh8zo\Scripts\python.exe c:\Users\~\.vscode\extensions\
</code></pre>
<p>Python scripts run fine</p>
<pre><code>PS C:\Users\USER\testing stuff&gt; uv run .\test.py   
hello uv
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-27 11:33</div>
            <div class="timeline-body"><p>Very weird, thanks for the report and sorry you ran into troubles here. We might need to escalate this to someone that's familiar with the Jupyter extension (cc @dhruvmanila), I have no idea why it would fail like that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-08-27 11:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @zanieb on 2024-08-27 11:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-28 06:39</div>
            <div class="timeline-body"><blockquote>
<pre><code>22:17:39.268 [info] Process Execution: ~\testing stuff\.venv\Scripts\python.exe -c &quot;import pip;print('6af208d0-cb9c-427f-b937-ff563e17efdf')&quot;
22:17:39.410 [warn] No interpreter with path ~\example\.venv\Scripts\python.exe found in Python API, will convert Uri path to string as Id ~\example\.venv\Scripts\python.exe
</code></pre>
</blockquote>
<p>Huh, why is it looking for the interpreter in the &quot;example&quot; directory when the environment should be in &quot;testing stuff&quot; directory? How did you select the kernel in VS Code?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-28 06:45</div>
            <div class="timeline-body"><p>Which kernel do you see here? Can you click on it and select the current virtual environment?</p>
<img width="1728" alt="Screenshot 2024-08-28 at 12 14 04" src="https://github.com/user-attachments/assets/affbf2d5-3d5b-4424-a2fc-12ea694876e8">

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wes-stone">@wes-stone</a> on 2024-08-29 06:09</div>
            <div class="timeline-body"><p>Thanks for following up and yep, just the typical set up with the kernel.
Actually just solved it by deleting below folder in <code>Users\user</code> Seems I hadn't cleaned out thoroughly
<img src="https://github.com/user-attachments/assets/b642b59c-8d3d-4fb5-a2db-321b2194a74a" alt="image" />Thanks again!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-08-29 07:38</div>
            <div class="timeline-body"><p>Yeah, I guess there must be some mismatch between the (old) kernel configuration and the (new) virtual environment itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bjornasm">@bjornasm</a> on 2024-09-25 09:17</div>
            <div class="timeline-body"><p>I am not sure if it is related, but my VSCode hangs (kernel is just spinning, vscode claims it is trying to save to file) every time I add a new library using uv add and then try to import it. Have to restart vscode for it to work. I have no previous .venv in this project.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhruvmanila">@dhruvmanila</a> on 2024-09-30 11:09</div>
            <div class="timeline-body"><p>@wesstone12 I'm assuming that the issue is resolved on your end so closing this issue.</p>
<p>@bjornasm It might be unrelated. Do you mind opening a new issue with the details on how to reproduce?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dhruvmanila on 2024-09-30 11:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/scotho3">@scotho3</a> on 2025-01-17 15:57</div>
            <div class="timeline-body"><p><code>uv pip install ipykernel</code></p>
<p>fixed this for me. Adding for posterity</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rram12">@rram12</a> on 2025-07-21 22:16</div>
            <div class="timeline-body"><p>To explain more the solution of @scotho3, thanks Thomas btw,
1- activate your virtual environment  <code>source /path/to/venv/bin/activate</code>
2- install the ipykernel <code>uv pip install ipykernel</code>
3- start vscode or jupyter server from the same command line, otherwise the kernel in question won't be selectable <code>code .</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/meehanman">@meehanman</a> on 2025-10-17 14:03</div>
            <div class="timeline-body"><p>Thanks for the help! I'm able to quickly setup a new project on MacOS with VSCode via:</p>
<ol>
<li>Open a fresh directory in VSCode</li>
<li>Run <code>git init &amp;&amp; uv init</code> to setup the project</li>
<li>Run <code>uv add ipykernel</code> to add Python Notebook Tools</li>
<li>Create a new Python Notebook via <code>touch notebook.ipynb</code></li>
<li>Open the Notebook in VSCode and Select <code>Python Environments... &gt; .venv/bin/python</code></li>
<li>üïπÔ∏è Notebook is now working with <code>uv</code> + <code>VSCode</code></li>
</ol>
<p>I can then add additional packages via the command-line eg. <code>uv add boto3</code> for AWS Tools and this will be added to my environment and <code>pyproject.toml</code> as well as work within my `notebook.ipynb eg:</p>
<pre><code class="language-python">import boto3

response = boto3.client('s3').list_objects_v2(Bucket='your-bucket-name')
</code></pre>
<hr />
<p>Bonus Quickstart</p>
<pre><code class="language-bash">mkdir notebook &amp;&amp; cd notebook &amp;&amp; git init &amp;&amp; uv init &amp;&amp; uv add ipykernel &amp;&amp; touch notebook.ipynb
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JDeanThomas">@JDeanThomas</a> on 2025-12-30 04:01</div>
            <div class="timeline-body"><p>If you build a global python on a Mac via uv, VS Code will not see your env if you use tools to have a clean python and stuff everything into jupyter. You will always get an:</p>
<p>`Running cells with '.venv (Python 3.12.12)' requires the ipykernel package.</p>
<p>Install 'ipykernel' into the Python environment.`</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:59 UTC
    </footer>
</body>
</html>
