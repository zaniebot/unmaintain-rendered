<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python dev headers missing in venv - astral-sh/uv #9347</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Python dev headers missing in venv</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9347">#9347</a>
        opened by <a href="https://github.com/arogozhnikov">@arogozhnikov</a>
        on 2024-11-22 05:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/arogozhnikov">@arogozhnikov</a></div>
            <div class="timeline-body"><p>I think python dev headers are now missing when uv installs venv; repro (start from ubuntu 22.04):</p>
<p>confirmed on uv==0.5.0 and 0.5.4, not tested on other versions</p>
<pre><code>export $VIRTUAL_ENV=/tmp/.venv
curl -LsSf https://astral.sh/uv/0.5.0/install.sh | sh
. $HOME/.local/bin/env
uv venv --python 3.10 $VIRTUAL_ENV 
. $VIRTUAL_ENV/bin/activate
uv pip install ihm
</code></pre>
<p>output:</p>
<pre><code>[stderr]
src/ihm_format_wrap_1.7.c:203:11: fatal error: Python.h: No such file or directory
  203 | # include &lt;Python.h&gt;
      |           ^~~~~~~~~~
compilation terminated.
error: command &#x27;/usr/bin/x86_64-linux-gnu-gcc&#x27; failed with exit code 1
  Caused by: This error likely indicates that you need to install a library that provides &quot;Python.h&quot; for ihm@1.7
</code></pre>
<p>Annoyingly, <strong>it used to work</strong> - I was able to install this package, but a couple of weeks ago binaries shipped with uv were swapped for some other builds, this affected even previous versions of uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-11-23 02:06</div>
            <div class="timeline-body"><p>Similar to <a href="https://github.com/astral-sh/uv/issues/8966">astral-sh/uv#8966</a>#issuecomment-2466513707</p>
<p>TL;DR Try <a href="https://github.com/bluss/sysconfigpatcher">sysconfigpatcher</a> to adjust the uv python downloads to have the proper pkgconfig and sysconfig metadata for your system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/samypr100">@samypr100</a> on 2024-11-23 02:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-02 22:30</div>
            <div class="timeline-body"><blockquote>
<p>but a couple of weeks ago binaries shipped with uv were swapped for some other builds, this affected even previous versions of uv.</p>
</blockquote>
<p>This doesn&#x27;t quite make sense, we didn&#x27;t change previous versions of uv and the Python distributions we use are hard-coded for each release and cannot change.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-02 22:38</div>
            <div class="timeline-body"><p>If you&#x27;re using a system interpreter, you should install the headers, e.g., the following works:</p>
<pre><code>docker run --platform linux/x86_64 -it ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install python3-dev &amp;&amp; uv venv &amp;&amp; uv pip install ihm&quot;
</code></pre>
<p>I can&#x27;t reproduce this failure using a managed interpreter:</p>
<pre><code>docker run --platform linux/x86_64 -it ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install clang &amp;&amp; uv venv -p 3.10 &amp;&amp; uv pip install ihm&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/arogozhnikov">@arogozhnikov</a> on 2024-12-04 03:46</div>
            <div class="timeline-body"><p>this works:</p>
<pre><code>docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install clang --yes &amp;&amp; uv venv -p 3.10 &amp;&amp; uv pip install ihm&quot;
</code></pre>
<p>this doesn&#x27;t</p>
<pre><code>docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install clang --yes &amp;&amp; uv venv -p 3.11 &amp;&amp; uv pip install ihm&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wjakob">@wjakob</a> on 2024-12-08 09:26</div>
            <div class="timeline-body"><p>I am also having this issue, and using Docker is not a feasible workaround. Could UV not be modified so that installs the Python headers when creating a venv?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-08 14:32</div>
            <div class="timeline-body"><p>üëã  @wjakob, the docker examples here are to provide an MRE, you can apply the same steps outside of docker.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wjakob">@wjakob</a> on 2024-12-08 14:35</div>
            <div class="timeline-body"><p>This is on a machine where I don&#x27;t have root access, hence installing the headers via <code>apt</code> is not an option (also, that would be for the OS Python version, which is often quite outdated). With <code>uv</code> not installing them as part of the virtual environment, it is impossible to build C extensions within the environment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-08 16:14</div>
            <div class="timeline-body"><p>@arogozhnikov your failing example uses the system interpreter (3.11 is installed in the image already)</p>
<pre><code>root@c0d1cea75e52:/# uv python list
cpython-3.13.0+freethreaded-linux-x86_64-gnu    &lt;download available&gt;
cpython-3.12.7-linux-x86_64-gnu                 &lt;download available&gt;
cpython-3.11.10-linux-x86_64-gnu                &lt;download available&gt;
cpython-3.11.2-linux-x86_64-gnu                 /usr/bin/python3.11
cpython-3.11.2-linux-x86_64-gnu                 /usr/bin/python3 -&gt; python3.11
cpython-3.11.2-linux-x86_64-gnu                 /bin/python3.11
cpython-3.11.2-linux-x86_64-gnu                 /bin/python3 -&gt; python3.11
cpython-3.10.15-linux-x86_64-gnu                &lt;download available&gt;
cpython-3.9.20-linux-x86_64-gnu                 &lt;download available&gt;
cpython-3.8.20-linux-x86_64-gnu                 &lt;download available&gt;
cpython-3.7.9-linux-x86_64-gnu                  &lt;download available&gt;
pypy-3.10.14-linux-x86_64-gnu                   &lt;download available&gt;
pypy-3.9.19-linux-x86_64-gnu                    &lt;download available&gt;
pypy-3.8.16-linux-x86_64-gnu                    &lt;download available&gt;
pypy-3.7.13-linux-x86_64-gnu                    &lt;download available&gt;
</code></pre>
<p>That&#x27;s why you need to install development headers via the system package manager.</p>
<p>If you force uv to use a managed interpreter with <code>--python-preference only-manage</code>, the example works</p>
<pre><code>docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install clang --yes &amp;&amp; uv venv -p 3.11 --python-preference only-managed &amp;&amp; uv pip install ihm&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-08 16:15</div>
            <div class="timeline-body"><p>@wjakob please share a reproducible example</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-08 17:27</div>
            <div class="timeline-body"><blockquote>
<pre><code>docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install clang --yes &amp;&amp; uv venv -p 3.11 --python-preference only-managed &amp;&amp; uv pip install ihm&quot;
</code></pre>
</blockquote>
<p>Thanks @zanieb, I&#x27;ve been incorrectly under assumption OP wanted to use <code>gcc</code> and not <code>clang</code>, hence my suggestions to use <a href="https://github.com/bluss/sysconfigpatcher">sysconfigpatcher</a>.</p>
<pre><code>docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;uv venv -p 3.11.10 &amp;&amp; uv tool install git+https://github.com/bluss/sysconfigpatcher &amp;&amp; uv tool run sysconfigpatcher /root/.local/share/uv/python/cpython-3.11.10-linux-x86_64-gnu &amp;&amp; uv pip install ihm&quot;
</code></pre>
<p>Do you think it&#x27;s worth expanding in docs when is it reasonable to attempt to use <code>sysconfigpatcher</code> by adding a note to <code>python-versions.md</code> or maybe a troubleshooting faq.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-08 22:07</div>
            <div class="timeline-body"><blockquote>
<p>Do you think it&#x27;s worth expanding in docs when is it reasonable to attempt to use sysconfigpatcher by adding a note to python-versions.md or maybe a troubleshooting faq.</p>
</blockquote>
<p>It&#x27;s sort of a priority for me to understand the problems people are encountering and fix it here rather than recommend <code>sysconfigpatcher</code> ‚Äî it&#x27;s nice that it exists and I&#x27;m sure we&#x27;ll learn from it but I&#x27;d prefer a first-party solution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Tristan971">@Tristan971</a> on 2024-12-11 18:49</div>
            <div class="timeline-body"><blockquote>
<p>please share a reproducible example</p>
</blockquote>
<p>Here&#x27;s one:</p>
<pre><code>FROM fedora:41

RUN dnf update -y &amp;&amp; \
    dnf group install -y &#x27;development-tools&#x27; &amp;&amp; \
    dnf install -y \
      gcc \
      gcc-c++ \
      gtk3 \
      gtk3-devel \
      libxcrypt-compat \
      python3 \
      python3-devel \
      which

RUN curl -LsSf https://astral.sh/uv/install.sh | sh
</code></pre>
<p>Run the resulting image then:</p>
<pre><code># just ensuring we don&#x27;t use the system-managed one which is 3.13
[root@0a8793bee0ed ~]# uv init --python &quot;&gt;=3.10,&lt;3.11&quot; repro
[root@0a8793bee0ed ~]# cd repro
[root@0a8793bee0ed repro]# uv add &#x27;wxpython&gt;=4.0.0&#x27;
# ... takes a minute then fails with...
...
      The configuration failed
      (complete log in /root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src/build/waf/3.10/gtk3/config.log)
</code></pre>
<p>Then we go and look at the detailed logs</p>
<pre><code>[root@0a8793bee0ed repro]# cat /root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src/build/waf/3.10/gtk3/config.log
# ... bunch of noise until ...
[&#x27;/usr/bin/g++&#x27;, &#x27;-g&#x27;, &#x27;-fwrapv&#x27;, &#x27;-O3&#x27;, &#x27;-fPIC&#x27;, &#x27;-fno-strict-aliasing&#x27;, &#x27;-I/install/include/python3.10&#x27;, &#x27;-DPYTHONDIR=&quot;/root/.cache/uv/builds-v0/.tmpn5kGVI/lib/python3.10/site-packages&quot;&#x27;, &#x27;-DPYTHONARCHDIR=&quot;/root/.cache/uv/builds-v0/.tmpn5kGVI/lib/python3.10/site-packages&quot;&#x27;, &#x27;-DNDEBUG&#x27;, &#x27;../test.cpp&#x27;, &#x27;-c&#x27;, &#x27;-o/root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src/build/waf/3.10/gtk3/.conf_check_ef50035bd89e2895b752adc35a4fe169/testbuild/test.cpp.1.o&#x27;]
err: ../test.cpp:2:10: fatal error: Python.h: No such file or directory
    2 | #include &lt;Python.h&gt;
      |          ^~~~~~~~~~
compilation terminated.

from /root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src: Test does not build: Traceback (most recent call last):
  File &quot;/root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src/bin/.waf3-2.1.2-5b48554f897113218781486acfe4d78e/waflib/Configure.py&quot;, line 337, in run_build
    bld.compile()
  File &quot;/root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src/bin/.waf3-2.1.2-5b48554f897113218781486acfe4d78e/waflib/Build.py&quot;, line 176, in compile
    raise Errors.BuildError(self.producer.error)
waflib.Errors.BuildError: Build failed
 -&gt; task in &#x27;testprog&#x27; failed with exit status 1 (run with -v to display more information)

Broken python installation? Get python-config now!
from /root/.cache/uv/sdists-v6/pypi/wxpython/4.2.2/0ju17OLUIdGAvvjIAN9Zx/src: The configuration failed
</code></pre>
<p>I can confirm that using sysconfigpatcher fixes this issue (the wxpython build takes a bit of an eternity, but it eventually does succeed)</p>
<pre><code>[root@0a8793bee0ed repro]# uv tool install &#x27;git+https://github.com/bluss/sysconfigpatcher&#x27;
 Updated https://github.com/bluss/sysconfigpatcher (c1ebf8a)
Resolved 1 package in 0.49ms
   Built sysconfigpatcher @ git+https://github.com/bluss/sysconfigpatcher@c1ebf8ab9274dcde255484d93ce0f1fd1f76a248
Prepared 1 package in 322ms
Installed 1 package in 0.99ms
 + sysconfigpatcher==0.3.1 (from git+https://github.com/bluss/sysconfigpatcher@c1ebf8ab9274dcde255484d93ce0f1fd1f76a248)
Installed 1 executable: sysconfigpatcher
[root@0a8793bee0ed repro]# realpath .venv/bin/python
/root/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/bin/python3.10
[root@0a8793bee0ed repro]# sysconfigpatcher /root/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/bin/python3.10
INFO: Patched /root/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/python3.10/_sysconfigdata__linux_x86_64-linux-gnu.py
INFO: Patched /root/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/pkgconfig/python-3.10-embed.pc
INFO: Patched /root/.local/share/uv/python/cpython-3.10.16-linux-x86_64-gnu/lib/pkgconfig/python-3.10.pc
[root@0a8793bee0ed repro]# uv add &#x27;wxpython&gt;=4.0.0&#x27;
Resolved 4 packages in 36ms
   Built wxpython==4.2.2
Prepared 1 package in 2m 58s
Installed 3 packages in 29ms
 + numpy==2.2.0
 + six==1.17.0
 + wxpython==4.2.2
</code></pre>
<p>Also worth noting that UV&#x27;s manager isn&#x27;t the only one that leads to these kinds of issues; back then I experienced a similar (but not the same exact) issue with pyenv+poetry, linked here https://gitlab.com/ita1024/waf/-/issues/2420</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-11 19:16</div>
            <div class="timeline-body"><p>Thanks @Tristan971, I believe that one is a manifestation of <a href="https://github.com/indygreg/python-build-standalone/issues/374">indygreg/python-build-standalone#374</a> which we&#x27;re also tracking in <a href="https://github.com/astral-sh/uv/issues/8429">astral-sh/uv#8429</a></p>
<p>The workaround for this is:</p>
<pre><code>export CPPFLAGS=&quot;-I/root/.local/share/uv/python/cpython-3.10.16-linux-aarch64-gnu/include/python3.10&quot;
export LDFLAGS=&quot;-L/root/.local/share/uv/python/cpython-3.10.16-linux-aarch64-gnu/lib&quot;
</code></pre>
<p>(with the proper path to the Python you&#x27;re using)</p>
<p>As you said it&#x27;s taking forever to build so I can&#x27;t <em>confirm</em> at this second, but it&#x27;s definitely past that early failure.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Tristan971">@Tristan971</a> on 2024-12-11 19:19</div>
            <div class="timeline-body"><p>Great to see it‚Äôs already being looked at! :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 03:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 13:27</div>
            <div class="timeline-body"><p>Gonna review this today to see if it&#x27;s resolved with latest changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-17 13:49</div>
            <div class="timeline-body"><p>If it&#x27;s any help, this would still fail</p>
<pre><code>&gt; docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:0.5.9-bookworm /bin/bash -c &quot;uv venv -p 3.11.10 &amp;&amp; uv pip install ihm&quot;
Using CPython 3.11.10
Creating virtual environment at: .venv
Resolved 2 packages in 330ms
  x Failed to download and build `ihm==1.8`
  `-&gt; Build backend failed to build wheel through `build_wheel` (exit status: 1)

      [stdout]
      running bdist_wheel
      running build
      running build_py
      creating build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/__init__.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/dataset.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/representation.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/analysis.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/report.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/metadata.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/flr.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/cross_linkers.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/reader.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/restraint.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/source.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/startmodel.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/format.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/model.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/test.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/geometry.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/citations.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/format_bcif.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/protocol.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/multi_state_scheme.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/dictionary.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/location.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/dumper.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      copying ihm/reference.py -&gt; build/lib.linux-x86_64-cpython-311/ihm
      creating build/lib.linux-x86_64-cpython-311/ihm/util
      copying ihm/util/__init__.py -&gt; build/lib.linux-x86_64-cpython-311/ihm/util
      copying ihm/util/make_mmcif.py -&gt; build/lib.linux-x86_64-cpython-311/ihm/util
      running build_ext
      building &#x27;ihm._format&#x27; extension
      creating build/temp.linux-x86_64-cpython-311/src
      clang -pthread -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3
      -Wall -fPIC -fPIC -Isrc -I/root/.cache/uv/builds-v0/.tmpOq7G05/include
      -I/root/.local/share/uv/python/cpython-3.11.10-linux-x86_64-gnu/include/python3.11 -c src/ihm_format.c -o
      build/temp.linux-x86_64-cpython-311/src/ihm_format.o

      [stderr]
      error: command &#x27;clang&#x27; failed: No such file or directory
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wjakob">@wjakob</a> on 2024-12-17 13:52</div>
            <div class="timeline-body"><p>@samypr100 You need to have a sane build setup (C++ dev environment) in your container. This is not related to the main issue, which was about the presence of Python headers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-17 16:30</div>
            <div class="timeline-body"><blockquote>
<p><a href="https://github.com/samypr100">@samypr100</a> You need to have a sane build setup (C++ dev environment) in your container. This is not related to the main issue, which was about the presence of Python headers.</p>
</blockquote>
<p>Thanks, note this is a <code>buildpack-deps</code> based image so it has a sane build setup.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-17 16:50</div>
            <div class="timeline-body"><p>I presume the point is that we&#x27;d need #9916 for that example to work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 17:06</div>
            <div class="timeline-body"><p>Yeah for me that&#x27;s separate from this issue (though a good point from @samypr100).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 18:41</div>
            <div class="timeline-body"><p>Confirmed that this works on latest (with <code>CC=gcc</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 18:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-18 01:38</div>
            <div class="timeline-body"><p>My last example now also works as of 0.5.10 release without the need for <code>CC=gcc</code> ü•≥</p>
<pre><code>&gt; docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:0.5.10-bookworm /bin/bash -c &quot;uv venv -p 3.11.10 &amp;&amp; uv pip install ihm&quot;
Using CPython 3.11.10
Creating virtual environment at: .venv
Resolved 2 packages in 406ms
   Built ihm==1.8
Prepared 2 packages in 2.72s
Installed 2 packages in 2ms
 + ihm==1.8
 + msgpack==1.1.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jcelerier">@jcelerier</a> on 2025-07-10 20:52</div>
            <div class="timeline-body"><p>Hello,
I&#x27;m trying to understand in which way this issue is solved.</p>
<pre><code>$ docker run --platform linux/x86_64 -it --rm ghcr.io/astral-sh/uv:bookworm /bin/sh -c &quot;uv venv -p 3.13 &amp;&amp; find .venv&quot;
Status: Downloaded newer image for ghcr.io/astral-sh/uv:bookworm
Using CPython 3.13.5
Creating virtual environment at: .venv
.venv
.venv/CACHEDIR.TAG
.venv/.gitignore
.venv/bin
.venv/bin/python
.venv/bin/python3
.venv/bin/python3.13
.venv/bin/activate
.venv/bin/activate.csh
.venv/bin/activate.fish
.venv/bin/activate.nu
.venv/bin/activate.ps1
.venv/bin/activate.bat
.venv/bin/deactivate.bat
.venv/bin/pydoc.bat
.venv/bin/activate_this.py
.venv/pyvenv.cfg
.venv/lib
.venv/lib/python3.13
.venv/lib/python3.13/site-packages
.venv/lib/python3.13/site-packages/_virtualenv.py
.venv/lib/python3.13/site-packages/_virtualenv.pth
.venv/lib64
</code></pre>
<p>At no point the includes are in the venv, they end up in a $HOME/.local/share folder outside of my control.
What must I do to get the python headers of the  version installed by uv in a path accessible from within the .venv ? (or at least a path I can easily access programmatically without knowledge of the user&#x27;s OS or $HOME).</p>
<p>The context is a C++ software that lives entirely outside of uv&#x27;s venv but needs to access the Python headers of a python installed with a specific .venv</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-10 21:00</div>
            <div class="timeline-body"><p>I don&#x27;t think it&#x27;s a part of the standard for includes to be present in the virtual environment. See https://peps.python.org/pep-0405/</p>
<blockquote>
<p>The site and sysconfig standard-library modules are modified such that the standard library and header files are found relative to sys.base_prefix / sys.base_exec_prefix, while site-package directories (‚Äúpurelib‚Äù and ‚Äúplatlib‚Äù, in sysconfig terms) are still found relative to sys.prefix / sys.exec_prefix.</p>
</blockquote>
<p>Use <code>sys.base_prefix</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jcelerier">@jcelerier</a> on 2025-07-11 02:41</div>
            <div class="timeline-body"><p>I would like to be able to reach these folders without invoking python as part of my cmake scripts - for instance I could be cross-compiling with the python binary not being in the architecture of my host in the part of my build script which needs to know the location of this include folder</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-07-11 02:55</div>
            <div class="timeline-body"><blockquote>
<p>I would like to be able to reach these folders without invoking python as part of my cmake scripts - for instance I could be cross-compiling with the python binary not being in the architecture of my host in the part of my build script which needs to know the location of this include folder</p>
</blockquote>
<p>Sadly includes are not in virtualenvs per spec like Zanie mentioned. You can use CMake Python3 <a href="https://cmake.org/cmake/help/latest/module/FindPython3.html">module</a> for this as suggested in <a href="https://github.com/astral-sh/uv/issues/10267">astral-sh/uv#10267</a>#issuecomment-2569938357 and tell it use the virtual environment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jcelerier">@jcelerier</a> on 2025-07-11 03:10</div>
            <div class="timeline-body"><p>Thanks, I did not know about these variables, I&#x27;ll try with them!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:35:41 UTC
    </footer>
</body>
</html>
