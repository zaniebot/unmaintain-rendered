<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Error message on direct references isn't super helpful - astral-sh/uv #14795</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Error message on direct references isn't super helpful</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/14795">#14795</a>
        opened by <a href="https://github.com/thatch">@thatch</a>
        on 2025-07-21 16:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/thatch">@thatch</a> on 2025-07-21 16:33</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Context: We run a private index that allows/allowed direct references.</p>
<p>A transitive dep (let's call it <code>a &gt; b &gt; metaflow</code> started backtracking and hit an old artifact of <code>b</code> that had a git dependency for metaflow. In this case, what I'd like to see is info on <code>b</code> -- the one that has the dependency, not <code>metaflow</code> (because it's not that project's fault).</p>
<p>Diagnosing:</p>
<p>I managed to run <code>uv -v</code> and exhaustively check metadata urls looking for the string and figure out what was going on.</p>
<p>Solution Finding:</p>
<p>The error message is a little ambiguous on first read -- it seems like it just wants me to add <code>metaflow @</code> to the beginning of the dep line in <code>b</code> and it would then accept the url dependency, but that comes from an interpretation of &quot;your dependencies&quot;.  In reality, it doesn't allow direct references at all?  If there's an escape hatch, it's not mentioned.</p>
<p>Current error:</p>
<pre><code>error: Package `metaflow` attempted to resolve via URL: git+https://github.com/Netflix/metaflow.git@2.12.29. URL dependencies must be expressed as direct requirements or constraints. Consider adding `metaflow @ git+https://github.com/Netflix/metaflow.git@2.12.29` to your dependencies or constraints file.
</code></pre>
<p>A better error would be:</p>
<pre><code>error: Package `foo==2.13.0` contains a url dependency.  URL dependencies MUST be done using direct project requirements or constraints, or with config setting &lt;blah&gt;.
</code></pre>
<h3>Platform</h3>
<p>macOS 15.5 arm64 (M2)</p>
<h3>Version</h3>
<p>uv 0.8.0 (0b2357294 2025-07-17)</p>
<h3>Python version</h3>
<p>Python 3.10.16 (but that shouldn't matter)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @thatch on 2025-07-21 16:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-07-21 17:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2025-07-21 17:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-21 20:52</div>
            <div class="timeline-body"><p>Just to clarify, doesn't adding <code>metaflow @ git+https://github.com/Netflix/metaflow.git@2.12.29</code> as a direct dependency (as suggested in the error) solve this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-07-21 21:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-21 21:10</div>
            <div class="timeline-body"><p>I think we should try to show the derivation chain here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/14824.html">astral-sh/uv#14824</a> on 2025-07-22 17:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-07-22 19:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:09 UTC
    </footer>
</body>
</html>
