<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv add` with `uv-dynamic-version`? - astral-sh/uv #12837</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>`uv add` with `uv-dynamic-version`?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/12837">#12837</a>
        opened by <a href="https://github.com/Ox54">@Ox54</a>
        on 2025-04-11 13:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Ox54">@Ox54</a> on 2025-04-11 13:43</div>
            <div class="timeline-body"><h3>Question</h3>
<p>Hi all!  I'm not entirely sure if I should be asking <code>uv</code> or the <a href="https://github.com/ninoseki/uv-dynamic-versioning/issues/34"><code>uv-dynamic-version</code></a> this question.. so I'm asking both.  Sorry in advance if this isn't the right place ðŸ˜„</p>
<p>I have a <code>uv</code> powered mono-repo project with many child-packages.  I'm currently attempting to integrate <code>uv-dynamic-version</code> into my project.  Things go fine, until I want to configure dynamic dependencies.</p>
<p>My root pyproject.toml looks like this:</p>
<pre><code class="language-toml">[project]
name = &quot;root-pkg&quot;
dynamic = [
    &quot;version&quot;,
    &quot;dependencies&quot;,
]
description = &quot;...&quot;
authors = []
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;

[project.optional-dependencies]
pygraphviz = [
    &quot;pygraphviz&gt;=1.14&quot;,
]

[build-system]
requires = [
    &quot;hatchling&quot;,
    &quot;uv-dynamic-versioning&quot;,
]
build-backend = &quot;hatchling.build&quot;

[tool.hatch.version]
source = &quot;uv-dynamic-versioning&quot;

[tool.hatch.build.targets.wheel]
only-include = [
    &quot;README.md&quot;,
]

[tool.hatch.build.targets.sdist]
include = [
    &quot;README.md&quot;,
]

[tool.hatch.metadata.hooks.uv-dynamic-versioning]
dependencies = [
    &quot;child-one=={{ version }}&quot;,
    &quot;child-two=={{ version }}&quot;,
]

[tool.uv-dynamic-versioning]
vcs = &quot;git&quot;
style = &quot;pep440&quot;
bump = true

[tool.uv.sources.child-two]
workspace = true

[tool.uv.sources.child-one]
workspace = true

[tool.uv.workspace]
members = [
    &quot;packages/child-one&quot;,
    &quot;packages/child-two&quot;,
]

[tool.ruff]
exclude = [
    &quot;docs/Notebooks/*.py&quot;,
]
line-length = 88

[dependency-groups]
dev = [...]
</code></pre>
<p>As you can see i've configured my dependencies to be &quot;dynamic&quot;, and have defined them in the <code>tool.hatch.metadata.hooks.uv-dynamic-versioning</code> table.</p>
<p>Now, when I try to run <code>uv add &lt;pkg&gt;</code>... uv tries to add the packages to <code>project.dependencies</code>, and thus fails to sync afterwards.</p>
<blockquote>
<p>ValueError: 'dependencies' is dynamic but already listed in [project].</p>
</blockquote>
<p>Is there any way to instruct uv to add dependences to <code>tool.hatch.metadata.hooks.uv-dynamic-versioning.dependencies</code> when <code>uv-dynamic-version</code> &amp; <code>project.dynamic.dependencies</code> is configured?</p>
<p>If not, is this something that the <code>uv-dynamic-version</code> package would be able to accomplish?</p>
<p>Thanks in advance!</p>
<h3>Platform</h3>
<p><em>No response</em></p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @Ox54 on 2025-04-11 13:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../ninoseki/uv-dynamic-versioning/issues/34.html">ninoseki/uv-dynamic-versioning#34</a> on 2025-04-11 23:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-16 14:33</div>
            <div class="timeline-body"><p>Looks like this was closed in <code>uv-dynamic-versioning</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-07-16 14:33</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:27 UTC
    </footer>
</body>
</html>
