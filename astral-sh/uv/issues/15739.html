<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv run` discards free-threaded (3.13t) environments and recreates non-free-threaded ones - astral-sh/uv #15739</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv run</code> discards free-threaded (3.13t) environments and recreates non-free-threaded ones</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15739">#15739</a>
        opened by <a href="https://github.com/Ravencentric">@Ravencentric</a>
        on 2025-09-08 17:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Ravencentric">@Ravencentric</a></div>
            <div class="timeline-body"><p>I’ve been working on adding free-threaded support to my libraries. Like most libraries, mine support a wide range of Python versions (e.g., <code>requires-python = &quot;&gt;=3.10&quot;</code>).</p>
<p>My first step was running <code>uv sync --python 3.13t</code> and then testing my code with <code>uv run ...</code>. To my surprise, <code>uv run</code> discarded the free-threaded environment and recreated a non-free-threaded one.</p>
<p>The only workarounds I’ve found are:</p>
<ul>
<li>Setting <code>UV_PYTHON=3.13t</code>. This applies globally, not just to the current project, which makes it unsuitable if I am juggling multiple projects.</li>
<li>Adding <code>--python 3.13t</code> to every <code>uv run</code> invocation. This is repetitive and easy to forget.</li>
<li>Activating the environment directly and skipping <code>uv run</code>. This forces me to think about venvs, which defeats the convenience of <code>uv run</code>.</li>
</ul>
<h1>Minimal Reproducible Example</h1>
<pre><code class="language-console">❯ docker run --rm -it ghcr.io/astral-sh/uv:0.8.15-python3.13-bookworm /bin/sh
# uv init foobar --package --python &quot;&gt;=3.10&quot;
Initialized project `foobar` at `/home/foobar`
# cd foobar
# uv sync --python 3.13t   # I want to use a free-threaded build
Using CPython 3.13.7
Creating virtual environment at: .venv
Resolved 1 package in 29ms
      Built foobar @ file:///home/foobar
Prepared 1 package in 21ms
Installed 1 package in 3ms
 + foobar==0.1.0 (from file:///home/foobar)
# uv run foobar   # uv run discards the free-threaded venv and rebuilds with a non-free-threaded interpreter
Using CPython 3.13.7 interpreter at: /usr/local/bin/python3.13
Removed virtual environment at: .venv
Creating virtual environment at: .venv
Installed 1 package in 11ms
Hello from foobar!
# uv run python -c 'import sys; print(sys._is_gil_enabled())'
True
</code></pre>
<h3>Platform</h3>
<p>Windows 11, Debian Bookworm</p>
<h3>Version</h3>
<p>0.8.15</p>
<h3>Python version</h3>
<p>Python 3.13t</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @Ravencentric on 2025-09-08 17:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-09-08 17:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-16 23:06</div>
            <div class="timeline-body"><p>I think this is a duplicate of #12445</p>
<p>Thanks for the MRE!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-10-07 16:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:32:50 UTC
    </footer>
</body>
</html>
