<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trouble creating and managing venv - astral-sh/uv #10022</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Trouble creating and managing venv</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10022">#10022</a>
        opened by <a href="https://github.com/jiwidi">@jiwidi</a>
        on 2024-12-19 09:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jiwidi">@jiwidi</a></div>
            <div class="timeline-body"><p>Hi!</p>
<p>First of all sorry i&#x27;ve missed something. I went through the docs and i think i&#x27;m doing the right think but can figure out what&#x27;s wrong.</p>
<p>So I&#x27;m trying to move out my project from conda to uv. It worked well when moving all my dockerfiles and scripts but when i try to create my local venv for quick development it can&#x27;t pick up the venv i create.</p>
<p>I first create it with:</p>
<pre><code>uv venv test_env
</code></pre>
<p>I get</p>
<pre><code>Using CPython 3.12.7
Creating virtual environment at: test_env
Activate with: source test_env/bin/activate.fish
</code></pre>
<p>I activate it with</p>
<pre><code>source test_env/bin/activate.fish
</code></pre>
<p>Which runs fine, but when i try to install some requirements with</p>
<pre><code>uv pip install --system -r requirements.txt
</code></pre>
<p>I get</p>
<pre><code>Using Python 3.12.6 environment at: /opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12
error: The interpreter at /opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12 is externally managed, and indicates the following:

  To install Python packages system-wide, try brew install
  xyz, where xyz is the package you are trying to
  install.

  If you wish to install a Python library that isn&#x27;t in Homebrew,
  use a virtual environment:

  python3 -m venv path/to/venv
  source path/to/venv/bin/activate
  python3 -m pip install xyz

  If you wish to install a Python application that isn&#x27;t in Homebrew,
  it may be easiest to use &#x27;pipx install xyz&#x27;, which will manage a
  virtual environment for you. You can install pipx with

  brew install pipx

  You may restore the old behavior of pip by passing
  the &#x27;--break-system-packages&#x27; flag to pip, or by adding
  &#x27;break-system-packages = true&#x27; to your pip.conf file. The latter
  will permanently disable this error.

  If you disable this error, we STRONGLY recommend that you additionally
  pass the &#x27;--user&#x27; flag to pip, or set &#x27;user = true&#x27; in your pip.conf
  file. Failure to do this can result in a broken Homebrew installation.

  Read more about this behavior here: &lt;https://peps.python.org/pep-0668/&gt;

Consider creating a virtual environment with `uv venv`.
</code></pre>
<p>Which is complaining about using an external 3.12 and not the recently created venv.</p>
<p>Any help appreciated ty</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jiwidi">@jiwidi</a> on 2024-12-19 09:59</div>
            <div class="timeline-body"><p>To add.</p>
<p>I created a project within this repository a few days ago, when i look at the <code>.venv/pyvenv.cfg</code> file looks like:</p>
<pre><code>home = /Users/jiwidi/.local/share/uv/python/cpython-3.12.7-macos-aarch64-none/bin
implementation = CPython
uv = 0.5.6
version_info = 3.12.7
include-system-site-packages = false
prompt = ml-cronjobs

</code></pre>
<p>So its not pointing to the <code>test_env/bin/activate.fish</code> environment created before. I see a python bin inside the .venv path too, should I be using that one then? Is this limited then for a project to have 1 venv? How do i manage them or change?</p>
<p>If I try sourcing that one</p>
<pre><code>source .venv/bin/activate.fish
</code></pre>
<p>and run my install</p>
<pre><code>uv pip install --system -r requirements.txt
</code></pre>
<p>I still get:</p>
<pre><code>
Using Python 3.12.6 environment at: /opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12
error: The interpreter at /opt/homebrew/opt/python@3.12/Frameworks/Python.framework/Versions/3.12 is externally managed, and indicates the following:

  To install Python packages system-wide, try brew install
  xyz, where xyz is the package you are trying to
  install.

  If you wish to install a Python library that isn&#x27;t in Homebrew,
  use a virtual environment:

  python3 -m venv path/to/venv
  source path/to/venv/bin/activate
  python3 -m pip install xyz

  If you wish to install a Python application that isn&#x27;t in Homebrew,
  it may be easiest to use &#x27;pipx install xyz&#x27;, which will manage a
  virtual environment for you. You can install pipx with

  brew install pipx

  You may restore the old behavior of pip by passing
  the &#x27;--break-system-packages&#x27; flag to pip, or by adding
  &#x27;break-system-packages = true&#x27; to your pip.conf file. The latter
  will permanently disable this error.

  If you disable this error, we STRONGLY recommend that you additionally
  pass the &#x27;--user&#x27; flag to pip, or set &#x27;user = true&#x27; in your pip.conf
  file. Failure to do this can result in a broken Homebrew installation.

  Read more about this behavior here: &lt;https://peps.python.org/pep-0668/&gt;

Consider creating a virtual environment with `uv venv`.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2024-12-19 10:07</div>
            <div class="timeline-body"><p>Why do you need the <code>--system</code> flag? According to the documentation, this flag is supposed to ignore virtual environments.</p>
<pre><code>--system
Install packages into the system Python environment.

By default, uv installs into the virtual environment in the current working directory or any parent directory. The --system option instructs uv to instead use the first Python found in the system PATH.

WARNING: --system is intended for use in continuous integration (CI) environments and should be used with caution, as it can modify the system Python installation.

May also be set with the UV_SYSTEM_PYTHON environment variable.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-21 06:45</div>
            <div class="timeline-body"><p><code>home</code> in <code>pyvenv.cfg</code> is not the place where things are installed to, it&#x27;s used to find the Python interpreter libraries. uv will error if you attempt to install into one of the environments at <code>/home/myuser/.local/share/uv/python</code>.</p>
<p>@FishAlchemist is correct, do not include the <code>--system</code> flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-21 06:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jiwidi">@jiwidi</a> on 2024-12-28 09:10</div>
            <div class="timeline-body"><p>sorry for the late reply, the system did indeed work. Was using it from another command in our dockerfiles so mb there, ty!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/jiwidi">@jiwidi</a> on 2024-12-28 09:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:36:18 UTC
    </footer>
</body>
</html>
