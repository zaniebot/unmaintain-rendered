<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv tool shouldn't use Python from homebrew version directories - astral-sh/uv #7634</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv tool shouldn't use Python from homebrew version directories</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7634">#7634</a>
        opened by <a href="https://github.com/frostming">@frostming</a>
        on 2024-09-23 03:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/frostming">@frostming</a> on 2024-09-23 03:36</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>On a macos machine with homebrew python installed, when installing executables using <code>uv tool install</code>, the base interpreter of the venv points to a python inside homebrew's version directory, for example:</p>
<pre><code>‚ùØ cat '/Users/fming/Library/Application Support/uv/tools/posting/pyvenv.cfg' -p
home = /opt/homebrew/Cellar/python@3.12/3.12.4/Frameworks/Python.framework/Versions/3.12/bin
implementation = CPython
uv = 0.2.23
version_info = 3.12.4
include-system-site-packages = false
</code></pre>
<p>And the <code>bin/python</code> also symlinks to the same interpreter.</p>
<p>This is subject to breakage when users upgrade the version of <code>python@3.12</code> formula, because the new intepreter will be in a different directory. It's a huge pain when user run <code>brew upgrade</code> and suddenly all venvs become broken.</p>
<p>To compare, this is what pipx creates:</p>
<pre><code>home = /opt/homebrew/opt/python@3.12/bin
include-system-site-packages = false
version = 3.12.6
executable = /opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/bin/python3.12
command = /opt/homebrew/opt/python@3.12/bin/python3.12 -m venv --without-pip /Users/fming/.local/pipx/venvs/posting
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/frostming">@frostming</a> on 2024-09-23 03:57</div>
            <div class="timeline-body"><p>ok, the issue actually lies in <code>uv venv</code>, where it should not resolve symlinks for the python executable passed in:</p>
<pre><code>$ uv venv .venv -p /opt/homebrew/opt/python@3.12/bin/python3
$ ls -l .venv/bin/python
lrwxr-xr-x  1 fming  staff    96B  9 23 11:56 .venv/bin/python -&gt; /opt/homebrew/Cellar/python@3.12/3.12.6/Frameworks/Python.framework/Versions/3.12/bin/python3.12
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-23 04:00</div>
            <div class="timeline-body"><p>I believe this is a duplicate of https://github.com/astral-sh/uv/issues/1640</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by @zanieb on 2024-09-23 04:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-23 04:01</div>
            <div class="timeline-body"><p>And yeah, sorry this sounds painful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/frostming">@frostming</a> on 2024-09-23 04:11</div>
            <div class="timeline-body"><p>Yeah, that is duplicate. Closing this now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @frostming on 2024-09-23 04:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:47:53 UTC
    </footer>
</body>
</html>
