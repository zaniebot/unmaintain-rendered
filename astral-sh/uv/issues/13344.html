<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resolver panics when adding qlmaas as dependency - astral-sh/uv #13344</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Resolver panics when adding qlmaas as dependency</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13344">#13344</a>
        opened by <a href="https://github.com/shumpohl">@shumpohl</a>
        on 2025-05-08 10:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shumpohl">@shumpohl</a></div>
            <div class="timeline-body">Summary
<p>To reproduce execute <code>uv init test_env</code>, <code>cd test_env</code>, <code>uv add qlmaas</code>.</p>
<p>On windows:</p>
<pre><code>PS &gt; uv --version
uv 0.7.3 (3c413f74b 2025-05-07)
</code></pre>
<pre><code>PS &gt; uv add myqlm
Using CPython 3.12.9 interpreter at: C:\Users\%USER%\AppData\Local\Programs\Python\Python312\python.exe
Creating virtual environment at: .venv
⠼ qlmaas==1.11.2
thread &#x27;uv-resolver&#x27; panicked at C:\Users\runneradmin\.cargo\git\checkouts\pubgrub-e6d66ebc0e28e95d\a3b4db3\src\term.rs:89:18:
Positive term cannot unwrap negative set
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: The channel closed unexpectedly
</code></pre>
<p>And on debian:</p>
<pre><code>$ uv --version
uv 0.7.3
</code></pre>
<pre><code>$ uv add qlmaas
Using CPython 3.11.12
Creating virtual environment at: .venv
⠙ qlmaas==1.11.2
thread &#x27;uv-resolver&#x27; panicked at /root/.cargo/git/checkouts/pubgrub-e6d66ebc0e28e95d/a3b4db3/src/term.rs:89:18:
Positive term cannot unwrap negative set
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
error: The channel closed unexpectedly
</code></pre>
Platform
<p>Linux 6.12.21-amd64 x86_64 GNU/Linux</p>
Version
<p>uv 0.7.3</p>
Python version
<p>3.11 and 3.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/shumpohl">@shumpohl</a> on 2025-05-08 10:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shumpohl">@shumpohl</a> on 2025-05-08 10:49</div>
            <div class="timeline-body"><p>The problem seems to be caused by the wheel&#x27;s METADATA containing itself multiple times as a dependency:</p>
<pre><code>Metadata-Version: 2.2
Name: qlmaas
Version: 1.11.2
Summary: Module qlmaas [ecea8019] - Compiled by Eviden
Home-page: https://atos.net/en/lp/myqlm
Author: Eviden Quantum Lab
Author-email: myqlm@atos.net
License: Eviden myQLM EULA
Project-URL: Documentation, https://myqlm.github.io
Project-URL: Bug Tracker, https://github.com/myQLM/myqlm-issues/issues
Project-URL: Community, https://myqlmworkspace.slack.com
Keywords: Quantum,myQLM,QLM,Atos,Eviden
Platform: Operating System :: Microsoft :: Windows
Classifier: Operating System :: Microsoft :: Windows
Classifier: Programming Language :: Python :: 3.1
Classifier: Topic :: Scientific/Engineering
Classifier: License :: Other/Proprietary License
Description-Content-Type: text/markdown
License-File: LICENSE.txt
Requires-Dist: dill
Requires-Dist: prompt_toolkit
Requires-Dist: prettytable
Requires-Dist: pyOpenSSL
Requires-Dist: cffi
Requires-Dist: qat-hardware&gt;=1.5.0
Requires-Dist: qat-quops&gt;=1.4.0
Requires-Dist: packaging
Requires-Dist: qat-comm
Requires-Dist: qat-core
Requires-Dist: qat-hardware
Requires-Dist: qat-lang
Requires-Dist: qat-quops
Requires-Dist: qlmaas
Requires-Dist: qlmaas
Requires-Dist: qlmaas
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: license
Dynamic: platform
Dynamic: project-url
Dynamic: requires-dist
Dynamic: summary

&lt;-- snip --&gt;
</code></pre>
<p>If I delete 2 of the 3 <code>Requires-Dist: qlmaas</code> lines and repackage the wheel, the installation completes without problems.</p>
<p>I tested this on windows. The wheel was apparently packaged with setuptools as the <code>WHEEL</code> file reads</p>
<pre><code>Wheel-Version: 1.0
Generator: setuptools (75.8.0)
Root-Is-Purelib: true
Tag: cp312-cp312-win_amd64
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/konstin">@konstin</a> on 2025-05-09 14:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-09 16:41</div>
            <div class="timeline-body"><p>Thank you for the clear bug report and the investigation</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-13 03:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:32 UTC
    </footer>
</body>
</html>
