<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>macOS: `uv run` panics inside SystemConfiguration when sandboxed (Codex/seatbelt) — &quot;Attempted to create a NULL object&quot; - astral-sh/uv #16664</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>macOS: <code>uv run</code> panics inside SystemConfiguration when sandboxed (Codex/seatbelt) — &quot;Attempted to create a NULL object&quot;</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16664">#16664</a>
        opened by <a href="https://github.com/onutc">@onutc</a>
        on 2025-11-10 10:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/onutc">@onutc</a> on 2025-11-10 10:50</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><strong>IMPORTANT: This is a major blocker for running Python through <code>uv</code> in <a href="https://github.com/openai/codex">OpenAI Codex</a> on macOS.</strong></p>
<p>When <code>uv run</code> is executed inside a macOS sandbox (e.g., OpenAI Codex’ default seatbelt or a minimal seatbelt profile), <code>uv</code> panics in Rust while initializing SystemConfiguration’s dynamic store. The process aborts <strong>before</strong> the target command (Python) starts.</p>
<p>I am not very knowledgeable about uv-seatbelt interaction, I have a feeling that there might be more than one issue here.</p>
<h2>Reproduction A — inside Codex</h2>
<p>Install codex v0.55.0, and ask it to run <code>run uv run python -c &quot;print('hello')&quot;</code></p>
<pre><code>/ T R A N S C R I P T / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / / /
╭────────────────────────────────────────────────╮
│ &gt;_ OpenAI Codex (v0.55.0)                      │
│                                                │
│ model:     gpt-5-codex high   /model to change │
│ directory: ~/copies/platform-2                 │
╰────────────────────────────────────────────────╯

  To get started, describe a task or try one of these commands:

  /init - create an AGENTS.md file with instructions for Codex
  /status - show current session configuration
  /approvals - choose what Codex can do without approval
  /model - choose what model and reasoning effort to use
  /review - review any changes and find issues


› run uv run python -c &quot;print('hello from backend dir')&quot;


• Preparing to run backend Python command

$ uv run python -c &quot;print('hello')&quot;

thread 'main2' panicked at /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/system-configuration-0.6.1/src/dynamic_store.rs:154:1:
Attempted to create a NULL object.
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

thread 'main' panicked at /Users/runner/work/uv/uv/crates/uv/src/lib.rs:2409:10:
Tokio executor failed, was there a panic?: Any { .. }
✗ (101) • 133ms
</code></pre>
<p>Note that I cannot reproduce it in every folder. It doesn't raise an error when I open codex in /tmp directory.</p>
<h2>Reproduction B — pure macOS seatbelt</h2>
<p>Save the following in a file repro.sh and run it:</p>
<pre><code class="language-bash">cd /tmp &amp;&amp; mkdir uv-sandbox-test &amp;&amp; cd uv-sandbox-test

# Sandbox profile blocking SystemConfiguration
cat &gt; block-sysconfig.sb &lt;&lt;'EOF'
(version 1)
(allow default)
(deny mach-lookup (global-name &quot;com.apple.SystemConfiguration.configd&quot;))
EOF

# Create project and run from inside it
uv init test-project
cd test-project

env RUST_BACKTRACE=full sandbox-exec -f ../block-sysconfig.sb \
uv run python -c &quot;print('hello')&quot;
</code></pre>
<p>I am not sure this is the EXACT same error or seatbelt configuration on Codex that causes this error, but it seems very relevant.</p>
<p>Output:</p>
<pre><code>Mac :: /tmp » bash repro.sh
mkdir: uv-sandbox-test: File exists
Initialized project `test-project` at `/private/tmp/test-project`
Using CPython 3.13.7
Creating virtual environment at: .venv

thread 'main2' panicked at /Users/runner/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/system-configuration-0.6.1/src/dynamic_store.rs:154:1:
Attempted to create a NULL object.
stack backtrace:
   0:        0x105545e44 - __mh_execute_header
   1:        0x1051faaf0 - __mh_execute_header
   2:        0x105545684 - __mh_execute_header
   3:        0x105545ce4 - __mh_execute_header
   4:        0x10554526c - __mh_execute_header
   5:        0x105544894 - __mh_execute_header
   6:        0x105544864 - __mh_execute_header
   7:        0x106ccc22c - __mh_execute_header
   8:        0x10542e094 - __mh_execute_header
   9:        0x10642a55c - __mh_execute_header
  10:        0x106428374 - __mh_execute_header
  11:        0x106458ba4 - __mh_execute_header
  12:        0x105067c70 - __mh_execute_header
  13:        0x10505e190 - __mh_execute_header
  14:        0x10504aaa8 - __mh_execute_header
  15:        0x104f99274 - __mh_execute_header
  16:        0x104fa7368 - __mh_execute_header
  17:        0x10510c2b0 - __mh_execute_header
  18:        0x106028388 - __mh_execute_header
  19:        0x105d1441c - __mh_execute_header
  20:        0x10557d99c - __mh_execute_header
  21:        0x184a72c0c - __pthread_cond_wait

thread 'main' panicked at /Users/runner/work/uv/uv/crates/uv/src/lib.rs:2409:10:
Tokio executor failed, was there a panic?: Any { .. }
stack backtrace:
   0:        0x105545e44 - __mh_execute_header
   1:        0x1051faaf0 - __mh_execute_header
   2:        0x105545684 - __mh_execute_header
   3:        0x105545ce4 - __mh_execute_header
   4:        0x10554526c - __mh_execute_header
   5:        0x10557835c - __mh_execute_header
   6:        0x1055782cc - __mh_execute_header
   7:        0x10557d4c0 - __mh_execute_header
   8:        0x106cb105c - __mh_execute_header
   9:        0x106cb144c - __mh_execute_header
  10:        0x105fa9d08 - __mh_execute_header
  11:        0x105cbe994 - __mh_execute_header
  12:        0x106026538 - __mh_execute_header
  13:        0x105cbecec - __mh_execute_header
</code></pre>
<h1>Other issues</h1>
<p>On Codex side: https://github.com/openai/codex/issues/1457</p>
<h3>Platform</h3>
<p>macOS 15.5 arm64</p>
<h3>Version</h3>
<p>uv 0.9.7 (0adb44480 2025-10-30)</p>
<h3>Python version</h3>
<p>Python 3.13.7</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @onutc on 2025-11-10 10:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tekumara">@tekumara</a> on 2025-11-10 11:29</div>
            <div class="timeline-body"><p>Network related things, like reqwest, need to be able to lookup <code>com.apple.SystemConfiguration.configd</code> which you've explicitly denied in Reproduction B.</p>
<p>For Reproduction A this looks like https://github.com/openai/codex/issues/5914 which is fixed in codex 0.56.0 see <a href="https://github.com/openai/codex/issues/5914#issuecomment-3505687500">here</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/onutc">@onutc</a> on 2025-11-10 12:55</div>
            <div class="timeline-body"><p>I just upgraded to Codex 0.57.0 and confirm that this is resolved.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @onutc on 2025-11-10 12:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:10 UTC
    </footer>
</body>
</html>
