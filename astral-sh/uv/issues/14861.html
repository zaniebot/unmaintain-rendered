<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inconsistent behavior with workspaces and folder names - astral-sh/uv #14861</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Inconsistent behavior with workspaces and folder names</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/14861">#14861</a>
        opened by <a href="https://github.com/anuraaga">@anuraaga</a>
        on 2025-07-24 01:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/anuraaga">@anuraaga</a> on 2025-07-24 01:26</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I currently have a workspace member in a folder called <code>example</code>, whose name I wanted to make less generic so named it <code>connecpy-example</code>.</p>
<p>https://github.com/i2y/connecpy/blob/a39928e99fdb7859c7557016db230408ad4ccde5/pyproject.toml#L56
https://github.com/i2y/connecpy/blob/a39928e99fdb7859c7557016db230408ad4ccde5/example/pyproject.toml#L2
https://github.com/i2y/connecpy/blob/a39928e99fdb7859c7557016db230408ad4ccde5/pyproject.toml#L23</p>
<p>This worked fine and I thought it meant there is decoupling between the name for the purposes of dependency declaration and the folder name. But when adding a new sibling to that project with a dependency on <code>connecpy-example</code>, it would not resolve.</p>
<pre><code>❯ uv lock
  × No solution found when resolving dependencies:
  ╰─▶ Because connnecpy-example was not found in the package registry and connecpy-noextras depends on connnecpy-example, we can conclude that connecpy-noextras's requirements are
      unsatisfiable.
      And because your workspace requires connecpy-noextras, we can conclude that your workspace's requirements are unsatisfiable.
</code></pre>
<p>I decided to try changing the name of the project to match the folder name and surprisingly it worked fine.</p>
<p>https://github.com/anuraaga/connecpy/commit/3314c6eed829a627c5438d8fa10232476600193a#diff-a67e6a454244e74b80a1e3267d3472c63d4cdfd3eb295089d55f68c9f081d19dR2
https://github.com/anuraaga/connecpy/commit/3314c6eed829a627c5438d8fa10232476600193a#diff-f01a14c1c812435193b85c0ab8d513c9ef763e57182f057d84be540b7ed96066R7</p>
<p>If the project name has to match the folder name, that's completely fine but it seems there is some inconsistent behavior, where it sometimes works to have them not match and sometimes not.</p>
<h3>Platform</h3>
<p>Darwin 24.5.0 arm64</p>
<h3>Version</h3>
<p>uv 0.8.2 (Homebrew 2025-07-22)</p>
<h3>Python version</h3>
<p>Python 3.12.6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @anuraaga on 2025-07-24 01:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../i2y/connecpy/pulls/61.html">i2y/connecpy#61</a> on 2025-07-24 01:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-24 01:30</div>
            <div class="timeline-body"><p><code>members</code> takes a list of paths, so <code>members</code> have to match the directory name.</p>
<p><code>[tool.uv.sources]</code> is keyed on package name.</p>
<p>So if the folder is <code>example</code> but the package name is <code>connecpy-example</code>, I'd expect that you'd need to put <code>example</code> (i.e., <code>./example</code>) in <code>members</code>, but <code>connecpy-example</code> in <code>dependencies</code> and <code>tool.uv.sources</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/anuraaga">@anuraaga</a> on 2025-07-24 01:39</div>
            <div class="timeline-body"><p>Yup that's what I was using and it was working fine with just two members. But now when I restore to the version that wasn't locking before, somehow it seems to be working now... Unfortunately I don't have a commit of the broken state but I'm pretty sure it's the same as it, and I'm not sure how I could come up with that error message otherwise. Is it possible to end up in a state where the contents of the lockfile can confuse resolution?</p>
<p>But without being to repro there probably isn't anything that can be done either way. Sorry for the noise.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @anuraaga on 2025-07-24 01:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:04 UTC
    </footer>
</body>
</html>
