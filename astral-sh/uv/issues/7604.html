<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interference with local python releases - astral-sh/uv #7604</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Interference with local python releases</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7604">#7604</a>
        opened by <a href="https://github.com/krstp">@krstp</a>
        on 2024-09-20 21:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 21:10</div>
            <div class="timeline-body"><p>First, thank you for a great tool which is <code>uv</code>. I am really enjoying it.</p>
<p>However, I am running into issue. Conflicts with existing python installations. It turns out:</p>
<ul>
<li>I have system wide python <code>3.12.6</code> version, probably installed with <code>brew</code></li>
<li>I have other python releases (multiple versions) installed with <code>pyenv</code></li>
</ul>
<p>Now a gist:</p>
<ul>
<li>I do have <code>3.12.4</code> installed with <code>uv</code>, no problem here; everything works as desired.</li>
<li>when specifying in <code>.python-version</code> version <code>3.12.6</code> regardless of what command I invoke with <code>uv</code> I get the following error:</li>
</ul>
<pre><code>pyenv: version `3.12.6' is not installed (set by /Users/&lt;user&gt;/&lt;dev_path&gt;/sample_git_project/.python-version)
</code></pre>
<p>I was trying to go through <code>~/.config/uv</code> and <code>~/.local/</code> but I am not finding any <code>json</code> or other conf file that would allow me to re/point to the right python release <code>~/.local/share/uv/python/cpython-3.x...</code></p>
<p>Any tips would be appreciated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-20 21:27</div>
            <div class="timeline-body"><p>Hm that looks like a pyenv error message not a uv error message. Can you share more of the error with the <code>-v</code> flag? If there's not more I presume this is some sort of pyenv shell hook?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-09-20 21:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 21:34</div>
            <div class="timeline-body"><p>This is also not clear to me. After running <code>uv venv</code> the <code>.venv</code> is created and looking inside it I see <code>uv</code> creates <code>pyvenv.cfg</code>, but despite even changing it to the install of my liking say <code>3.12.6</code> path instead of <code>3.12.4</code> it will still revert to <code>.4</code> ðŸ¤”</p>
<p>And indeed, weirdly <code>uv</code> picks up <code>pyenv</code> version not the <code>uv</code> installed version and I am having trouble finding where could this be defined in <code>uv</code> ðŸ¤”</p>
<p><code>uv -v venv</code> does not yield any additional input.</p>
<p>The solution here would be to force <code>uv</code> to use its own install.... and sorry, but I will not be uninstalling <code>pyenv</code>, this is what I used to rely on and still large part of my solution run on it, before I battle-test the <code>uv</code> ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 21:37</div>
            <div class="timeline-body"><p>Rather my main question is... where does the <code>uv</code> config live, where does it pick up given python version?</p>
<p>When I type <code>uv python list</code> it will show me what version are installed where, but even if <code>3.12.6</code> is the one from <code>uv</code> it will still somehow pick up previously installed version with <code>brew</code>; BTW: <code>pyenv</code> does not have <code>3.12.6</code> in its repository (or I haven't updated mine), so this is also weird that it reference <code>pyenv</code> ðŸ¤”</p>
<p>Ref from <code>uv python list</code>:</p>
<pre><code>cpython-3.13.0rc2-macos-aarch64-none    &lt;download available&gt;
cpython-3.12.6-macos-aarch64-none       /Users/&lt;user&gt;/.local/share/uv/python/cpython-3.12.6-macos-aarch64-none/bin/python3 -&gt; python3.12
[...]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 21:46</div>
            <div class="timeline-body"><p>Some more insight (notice instantiation of 3.12.6 but cfg set with 3.12.4):</p>
<pre><code>~/&lt;path&gt;/sample_git_project&gt; uv python --python-preference managed install 3.12.6
Searching for Python versions matching: Python 3.12.6
Found existing installation for Python 3.12.6: cpython-3.12.6-macos-aarch64-none

~/&lt;path&gt;/sample_git_project &gt; uv venv 3.12.6 
Using Python 3.12.4
Creating virtual environment at: 3.12.6
Activate with: source 3.12.6/bin/activate

~/&lt;path&gt;/sample_git_project&gt; cat 3.12.6/pyvenv.cfg                                                                                                                                                                                                                                                                                                                                                                                                                                                               
       â”‚ File: 3.12.6/pyvenv.cfg
   1   â”‚ home = /Users/&lt;user&gt;/.local/share/uv/python/cpython-3.12.4-macos-aarch64-none/bin
   2   â”‚ implementation = CPython
   3   â”‚ uv = 0.4.13
   4   â”‚ version_info = 3.12.4
   5   â”‚ include-system-site-packages = false

~/&lt;path&gt;/sample_git_project&gt; source 3.12.6/bin/activate

~/&lt;path&gt;/sample_git_project&gt; python -version
Python 3.12.4
</code></pre>
<p>ðŸ˜©
But...</p>
<pre><code>~/&lt;path&gt;/sample_git_project&gt; ~/.local/share/uv/python/cpython-3.12.6-macos-aarch64-none/bin/python3.12 --version

Python 3.12.6
</code></pre>
<p>So all there seems is to change some underlying cfg pointer, but changing the <code>.venv/pyvenv.cfg</code> value does not work...  as soon as I run <code>uv venv</code> it somehow gets overwritten with <code>3.12.4</code> version :/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-20 21:55</div>
            <div class="timeline-body"><p>Sounds like you want to create a <code>uv.toml</code> for your user (https://docs.astral.sh/uv/configuration/files/)</p>
<p>Then change the <code>python-preference</code> to <code>only-managed</code> (https://docs.astral.sh/uv/reference/settings/#python-preference)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-20 21:55</div>
            <div class="timeline-body"><p><code>uv venv 3.12.6</code> creates a directory called <code>3.12.6</code>. You want <code>uv venv --python 3.12.6</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 22:08</div>
            <div class="timeline-body"><p>So...</p>
<ul>
<li>created <code>~/.config/uv/uv.toml</code> so it will be used globally, the content of the file is:</li>
</ul>
<pre><code>python-preference = &quot;managed&quot;
</code></pre>
<ul>
<li>I also copied the same file into project directory</li>
</ul>
<p>Then I run <code>python --version</code> as well as <code>uv venv --python 3.12.6</code> and in each case I get:</p>
<pre><code>pyenv: version `3.12.6' is not installed (set by /Users/&lt;path&gt;/sample_git_project/.python-version)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 22:24</div>
            <div class="timeline-body"><p>Update:</p>
<p>I have manually disabled <code>pyenv</code> from the whole env: <code>PATH=$(echo $PATH | tr ':' '\n' | grep -v pyenv | tr '\n' ':' | sed 's/:$//')</code>
then <code>uv venv --verbose</code>
This way I get feedback on 3.12.6 avaibility:</p>
<pre><code>Using Python 3.12.6
Creating virtual environment at: .venv
DEBUG Removing existing directory
Activate with: source .venv/bin/activate
</code></pre>
<p>but <code>source .venv/bin/activate</code> doesn't do a thing, such as:</p>
<pre><code>&gt; python --version                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
zsh: command not found: python
</code></pre>
<p>on the other hand:</p>
<pre><code>&gt; .venv/bin/python --version                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
Python 3.12.6
</code></pre>
<p>checking <code>python</code> installation path more:</p>
<pre><code>&gt; which python
python not found

&gt; which python3
/opt/homebrew/bin/python3  (btw: this is brew install with 3.12.5)
</code></pre>
<p>but</p>
<pre><code>&gt; uv python find                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
/Users/&lt;path&gt;/sample_git_project/.venv/bin/python3
</code></pre>
<p>So in summary, now <code>.venv</code> carries right python version, but global aliases to <code>python</code> and <code>python3</code> will not recognize it ðŸ¤”</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-20 22:41</div>
            <div class="timeline-body"><p>OK, never mind. I opened a fresh terminal and reloaded <code>.zshrc</code> ... whatever I have setup up upon <code>deactivation</code> it still seems to stay into somehow initialized under the hood pyenv (this is my global setup), but at least now everything works. I will close it for how. If this comes back I will reopen.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @krstp on 2024-09-20 22:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krstp">@krstp</a> on 2024-09-29 01:17</div>
            <div class="timeline-body"><p>One detail should be added here for reference, the folder I was tested it in was nested in the other folder that already had <code>uv init</code>; this means it was double nested <code>.venv</code> without activation and I believe this was party the reason why it was referencing external (one level up) <code>.venv</code>.</p>
<p>I hope this helps to pin point the exact <code>uv</code> behavior.</p>
<p>Otherwise https://github.com/astral-sh/uv/issues/7562 catches the behavior quite well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SwatGetmann">@SwatGetmann</a> on 2025-11-07 07:24</div>
            <div class="timeline-body"><p>I don't know if that helps, but I had the same issue on Ubuntu, right after <code>uv init</code>. What helped me is removing <code>.python-version</code> file (with a single line <code>3.13</code> in it) and then run <code>uv sync</code> - it worked and initialized venv with CPython 3.13.3 (which is the latest I have downloaded).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:17:11 UTC
    </footer>
</body>
</html>
