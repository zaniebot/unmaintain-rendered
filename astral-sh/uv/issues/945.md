```yaml
number: 945
title: "Support refreshing cached data during `pip compile`"
type: issue
state: closed
author: charliermarsh
labels:
  - enhancement
assignees: []
created_at: 2024-01-16T23:22:43Z
updated_at: 2024-01-23T23:30:27Z
url: https://github.com/astral-sh/uv/issues/945
synced_at: 2026-01-10T01:57:01Z
```

# Support refreshing cached data during `pip compile`

---

_Issue opened by @charliermarsh on 2024-01-16 23:22_

Right now, we support `pip sync --reinstall` and `pip sync --reinstall-package`, which (1) purges all cached data for the packages and (2) reinstalls them into the environment.

We don't have any way to force `pip compile` to refresh cached data, though. This issue will track support for that behavior. I need to think through the various options and the ideal user-facing API and behavior.

---

_Label `enhancement` added by @charliermarsh on 2024-01-16 23:22_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-01-16 23:22_

---

_Comment by @charliermarsh on 2024-01-17 00:33_

My current thinking...

`--refresh` and `--refresh-package [package]`:
- Ignore cached data for all packages or for an individual package.
- Available on `sync`, `compile`, and `install`.
- In practice, the way this would work is: track the packages we need to refresh. When reading from the cache, check if it's a package that needs to be refreshed, and whether it's already been refreshed. If we haven't refreshed, purge all cache entries for that package.
- (So, in short, we lazily purge the cache for all relevant packages. We can't purge them all upfront, since we don't know all relevant packages upfront.)

`--reinstall` and `--reinstall-package [package]`:
- When developing the install plan, mark relevant packages for uninstallation, and force them to be reinstalled.
- `--reinstall` will imply `--refresh`, and `--reinstall-package` will imply `--refresh-package`.


---

_Comment by @charliermarsh on 2024-01-17 00:33_

\cc @zanieb @konstin 

---

_Referenced in [astral-sh/uv#949](../../astral-sh/uv/pulls/949.md) on 2024-01-17 15:12_

---

_Referenced in [astral-sh/uv#1057](../../astral-sh/uv/pulls/1057.md) on 2024-01-23 05:53_

---

_Closed by @charliermarsh on 2024-01-23 23:30_

---
