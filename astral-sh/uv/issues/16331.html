<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ability to reduce duplicated build between &quot;sync&quot; and &quot;build&quot; commands - astral-sh/uv #16331</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ability to reduce duplicated build between &quot;sync&quot; and &quot;build&quot; commands</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16331">#16331</a>
        opened by <a href="https://github.com/f3flight">@f3flight</a>
        on 2025-10-16 22:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/f3flight">@f3flight</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Suppose there's a Python project which has platform-dependent extensions, like some Rust code.
Suppose we want to build and publish wheels for it for all supported platforms and python versions. But we also do tests so we want to have a venv with this package installed.</p>
<p>Currently this is achieved via 2 commands, for each python version and on each OS:</p>
<pre><code class="language-shell">uv sync ...
# tests here
uv build --wheel
# auditwheel call to add manylinux tags
</code></pre>
<p>Unfortunately, <code>uv sync</code> will build the package, and then <code>uv build</code> will also build the same package again, so the build time is doubled. The build time of this Rust code is significant (many minutes), so reducing duplicated build is important. I was not able to find a command to fetch the wheel built by <code>uv sync</code> from uv cache to skip <code>uv build</code>.</p>
<p>We also cannot workaround by building the wheel first because we want an &quot;editable&quot; install for the tests to make coverage work correctly, as opposed to the &quot;production&quot; wheel for publication.</p>
<p>Is there anything which could be improved here to avoid double building Rust extensions from source (which is done by <code>maturin</code>) while preserving editable state of the package installed during uv sync and having a normal wheel available as a file in the end?</p>
<p>I would envision a &quot;uv cache get package==version&quot; or similar to extract artifacts from cache, and then some command like &quot;uv wheel-convert --to-normal&quot; to convert an editable wheel into a normal wheel.</p>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @f3flight on 2025-10-16 22:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Ability to reduce duplicated wheel build between "sync" and "build" commands" to "Ability to reduce duplicated build between "sync" and "build" commands" by @f3flight on 2025-10-16 22:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-17 08:24</div>
            <div class="timeline-body"><p>You can use <code>uv sync --no-install-project</code> and <code>uv pip install</code> the built wheel. You can also checkout this example for a different workflow with <code>uv venv</code>, <code>uv build</code> and <code>uv pip install</code> for publishing with a smoke test: https://docs.astral.sh/uv/guides/integration/github/#publishing-to-pypi</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @konstin on 2025-10-17 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @konstin on 2025-10-17 08:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/f3flight">@f3flight</a> on 2025-10-17 16:57</div>
            <div class="timeline-body"><p>Thanks @konstin ! I don't think this solves the &quot;editable&quot; part though, right? If I need the install to be editable, I cannot install from a built wheel, or am I missing something?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-19 09:10</div>
            <div class="timeline-body"><p>No, editables only have a transient format (which is technically a wheel but that should not be exposed). Can you use a shared <code>CARGO_TARGET_DIR</code> or something similar to use caching across both builds?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-11-08 03:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:33:11 UTC
    </footer>
</body>
</html>
