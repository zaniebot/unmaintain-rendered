<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip compile` does not respect `tool.setuptools.dynamic` dependencies - astral-sh/uv #1644</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv pip compile</code> does not respect <code>tool.setuptools.dynamic</code> dependencies</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1644">#1644</a>
        opened by <a href="https://github.com/adamtheturtle">@adamtheturtle</a>
        on 2024-02-18 13:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/adamtheturtle">@adamtheturtle</a></div>
            <div class="timeline-body"><p>With the following files, <code>pip-compile</code> output includes the <code>ruff</code> dependency, <code>uv pip compile</code> does not:</p>
<p><code>pyproject.toml</code>:</p>
<pre><code>[project]
name = &quot;demo-project&quot;
version = &quot;0.1&quot;
dynamic = [&quot;dependencies&quot;]

[tool.setuptools.dynamic]
dependencies = { file = &quot;requirements.txt&quot; }
</code></pre>
<p><code>requirements.txt</code>:</p>
<pre><code>ruff
</code></pre>
<p><code>pip-compile</code> includes <code>ruff</code>:</p>
<pre><code>&gt; pip-compile pyproject.toml
WARNING: --strip-extras is becoming the default in version 8.0.0. To silence this warning, either use --strip-extras to opt into the new default or use --no-strip-extras to retain the existing behavior.
#
# This file is autogenerated by pip-compile with Python 3.12
# by the following command:
#
#    pip-compile pyproject.toml
#
ruff==0.2.2
</code></pre>
<p><code>uv</code> does not:</p>
<pre><code>&gt; uv pip compile pyproject.toml 
Resolved 0 packages in 174ms
# This file was autogenerated by uv v0.1.4 via the following command:
#    uv pip compile pyproject.toml
</code></pre>
<p>I expect <code>uv</code>&#x27;s behaviour to match <code>pip-compile</code>&#x27;s, or for the difference to be documented.</p>
<pre><code>&gt; pip-compile --version
pip-compile, version 7.4.0
&gt; uv --version
uv 0.1.4
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-18 21:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbidoul">@sbidoul</a> on 2024-03-10 13:25</div>
            <div class="timeline-body"><p>Related: #1624</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/albertotb">@albertotb</a> on 2024-03-15 14:55</div>
            <div class="timeline-body"><p>I&#x27;ve also run into this issue and I just wanted to +1 this feature. In my case I have something like:</p>
<pre><code>[tool.setuptools.dynamic]
dependencies = { file = [&quot;requirements.in&quot;] }
</code></pre>
<p>and then all the dependencies in <code>requirements.in</code>, which produces an empty <code>requirements.txt</code> file with uv but works with pip-compile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-15 14:57</div>
            <div class="timeline-body"><p>We will address this as discussed in <a href="https://github.com/astral-sh/uv/issues/1624">astral-sh/uv#1624</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-15 14:59</div>
            <div class="timeline-body"><p>For what it&#x27;s worth, if you treat the project as a dependency, we should respect it. E.g. <code>echo &quot;-e .&quot; | uv pip compile -</code> or <code>echo &quot;poetry-editable @ .&quot; | uv pip compile -</code>. But yes, we should fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/albertotb">@albertotb</a> on 2024-03-15 15:01</div>
            <div class="timeline-body"><p>I&#x27;ve temporarily fixed this just by using directly (which is not a big deal)</p>
<pre><code>uv pip compile -o requirements.txt requirements.in
</code></pre>
<p>It is a little less convenient for extras, i.e.</p>
<pre><code>uv pip compile -o requirements-dev.txt -c requirements.txt requirements.in requirements-dev.in
</code></pre>
<p>instead of (this does not work)</p>
<pre><code>uv pip compile --extra dev -c requirements.txt pyproject.toml
</code></pre>
<p>(assuming you also have <code>optional-dependencies.dev = { file = [&quot;requirements-dev.in&quot;] }</code> in <code>pyproject.toml</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-22 04:31</div>
            <div class="timeline-body"><p>I&#x27;ll be looking into this tomorrow.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-22 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-23 02:36</div>
            <div class="timeline-body"><p>Now in review here: <a href="https://github.com/astral-sh/uv/pull/2633">astral-sh/uv#2633</a>. Expect it to be supported in the next release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-25 20:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:29:43 UTC
    </footer>
</body>
</html>
