<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV compile does not discover binary correctly for targeting macOS even though macOS binaries exist - astral-sh/uv #10696</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>UV compile does not discover binary correctly for targeting macOS even though macOS binaries exist</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/10696">#10696</a>
        opened by <a href="https://github.com/nmichlo">@nmichlo</a>
        on 2025-01-16 22:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/nmichlo">@nmichlo</a> on 2025-01-16 22:20</div>
            <div class="timeline-body"><p><strong>1. setup</strong></p>
<pre><code class="language-bash">echo &quot;mlx&quot; &gt; r.txt
</code></pre>
<p><strong>2.a compile (on macos)</strong></p>
<pre><code class="language-bash">uv pip compile r.txt
</code></pre>
<details><summary>Success</summary>

<pre><code class="language-bash">&gt;&gt;&gt; uv pip compile r.txt
Resolved 1 package in 8ms
# This file was autogenerated by uv via the following command:
#    uv pip compile r.txt
mlx==0.22.0
    # via -r r.txt
</code></pre>
</details>

<p><strong>2.b compile (on macos) to target macos</strong></p>
<pre><code class="language-bash">uv pip compile --python-platform=macos r.txt
</code></pre>
<details><summary>Failure</summary>

<pre><code class="language-bash">&gt;&gt;&gt; uv pip compile --python-platform=macos r.txt
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of mlx are available:
          mlx==0.0.2
          mlx==0.0.3
          mlx==0.0.4
          mlx==0.0.5
          mlx==0.0.6
          mlx==0.0.7
          mlx==0.0.9
          mlx==0.0.10
          mlx==0.0.11
          mlx==0.1.0
          mlx==0.2.0
          mlx==0.3.0
          mlx==0.4.0
          mlx==0.5.1
          mlx==0.6.0
          mlx==0.7.0
          mlx==0.8.1
          mlx==0.9.1
          mlx==0.10.0
          mlx==0.11.1
          mlx==0.12.2
          mlx==0.13.0
          mlx==0.13.1
          mlx==0.14.0
          mlx==0.14.1
          mlx==0.15.0
          mlx==0.15.1
          mlx==0.15.2
          mlx==0.16.0
          mlx==0.16.1
          mlx==0.16.2
          mlx==0.16.3
          mlx==0.17.1
          mlx==0.17.2
          mlx==0.17.3
          mlx==0.18.0
          mlx==0.18.1
          mlx==0.19.0
          mlx==0.19.3
          mlx==0.20.0
          mlx==0.21.0
          mlx==0.21.1
          mlx==0.22.0
      and mlx&lt;=0.0.3 has no wheels with a matching Python ABI tag, we can conclude that mlx&lt;0.0.3 cannot be used.
      And because mlx&gt;=0.0.4 has no wheels with a matching Python implementation tag and you require mlx, we can conclude that your requirements are unsatisfiable.
</code></pre>
</details>

<p><strong>HOWEVER:</strong>
checking the binaries available you see that macOS binaries exist. And if you just <code>pip install mlx</code> on macOS, then it works.</p>
<pre><code class="language-bash">&gt;&gt;&gt; pip install --no-cache mlx

Collecting mlx
  Downloading mlx-0.22.0-cp311-cp311-macosx_14_0_arm64.whl.metadata (5.3 kB)
Downloading mlx-0.22.0-cp311-cp311-macosx_14_0_arm64.whl (26.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 26.9/26.9 MB 35.7 MB/s eta 0:00:00
Installing collected packages: mlx
Successfully installed mlx-0.22.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "UV does not discover binary correctly for macos" to "UV compile does not discover binary correctly for targeting macOS even though macOS binaries exist" by @nmichlo on 2025-01-16 22:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-16 22:34</div>
            <div class="timeline-body"><p>The latest version displays more here</p>
<pre><code>❯ echo &quot;mlx&quot; | uv pip compile - -p 3.12 --python-platform=macos
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of mlx are available:
          mlx==0.0.2
          mlx==0.0.3
          mlx==0.0.4
          mlx==0.0.5
          mlx==0.0.6
          mlx==0.0.7
          mlx==0.0.9
          mlx==0.0.10
          mlx==0.0.11
          mlx==0.1.0
          mlx==0.2.0
          mlx==0.3.0
          mlx==0.4.0
          mlx==0.5.1
          mlx==0.6.0
          mlx==0.7.0
          mlx==0.8.1
          mlx==0.9.1
          mlx==0.10.0
          mlx==0.11.1
          mlx==0.12.2
          mlx==0.13.0
          mlx==0.13.1
          mlx==0.14.0
          mlx==0.14.1
          mlx==0.15.0
          mlx==0.15.1
          mlx==0.15.2
          mlx==0.16.0
          mlx==0.16.1
          mlx==0.16.2
          mlx==0.16.3
          mlx==0.17.1
          mlx==0.17.2
          mlx==0.17.3
          mlx==0.18.0
          mlx==0.18.1
          mlx==0.19.0
          mlx==0.19.3
          mlx==0.20.0
          mlx==0.21.0
          mlx==0.21.1
          mlx==0.22.0
      and mlx&lt;=0.0.3 has no wheels with a matching Python ABI tag (e.g., `cp312`), we can conclude that mlx&lt;=0.0.3 cannot be used.
      And because mlx&gt;=0.0.4 has no wheels with a matching platform tag (e.g., `macosx_12_0_arm64`) and you require mlx, we can conclude that your requirements are unsatisfiable.

      hint: You require CPython 3.12 (`cp312`), but we only found wheels for `mlx` (v0.0.3) with the following Python ABI tags: `cp38`, `cp39`, `cp310`, `cp311`

      hint: Wheels are available for `mlx` (v0.22.0) on the following platforms: `macosx_13_0_arm64`, `macosx_14_0_arm64`
</code></pre>
<p><code>--python-platform macos</code> defaults to support for macOS 12. You can change the deployment target, e.g.:</p>
<pre><code>❯ echo &quot;mlx&quot; | MACOSX_DEPLOYMENT_TARGET=&quot;13&quot; uv pip compile - -p 3.12 --python-platform=macos
Resolved 1 package in 102ms
# This file was autogenerated by uv via the following command:
#    uv pip compile - -p 3.12 --python-platform=macos
mlx==0.22.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-01-16 22:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nmichlo">@nmichlo</a> on 2025-01-16 22:38</div>
            <div class="timeline-body"><p>Thank you for the fast response!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @nmichlo on 2025-01-16 22:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nmichlo">@nmichlo</a> on 2025-01-16 22:40</div>
            <div class="timeline-body"><p>@zanieb Should this not be documented as part of the command? Or The Env variable not be printed as part of the output &quot;try setting <code>MACOSX_DEPLOYMENT_TARGET=13</code>&quot;?</p>
<p>It seems like I should be able to pass <code>macosx_13_0_arm64 </code> into <code>--python-platform</code> but this is invalid</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-16 22:50</div>
            <div class="timeline-body"><p>It's hard to show that kind of thing in error messages, though I'm supportive of it. Those hints are brand new.</p>
<p>Here's the documentation https://github.com/astral-sh/uv/pull/10698</p>
<p>I'm not sure why we don't support <code>macosx_13_0_arm64</code> — that's a wheel platform tag though and the CLI takes target triples which don't have a OS version component like that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/10699.html">astral-sh/uv#10699</a> on 2025-01-16 22:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nmichlo">@nmichlo</a> on 2025-01-20 15:11</div>
            <div class="timeline-body"><p>Thank you for the fast patch!</p>
<p>And for the new issue opened, #10699</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
