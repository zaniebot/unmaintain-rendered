<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Should `uv run` always create a virtual environment? - astral-sh/uv #5839</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Should <code>uv run</code> always create a virtual environment?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/5839">#5839</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-08-06 22:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>I think yes, if one cannot be found. Otherwise, a command can mutate the system environment (e.g. <code>uv run pip install anyio</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-06 22:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-06 22:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-06 22:27</div>
            <div class="timeline-body"><p>Interesting, so like, never run in the base env?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-06 22:43</div>
            <div class="timeline-body"><p>Maybe? It seems okay to run in virtual or project environments, but weird for non-virtual environments.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chrisrodrigue">@chrisrodrigue</a> on 2024-08-07 21:41</div>
            <div class="timeline-body"><p>I feel like <code>uv</code> creates virtual environments so quickly that it might not be a big deal to always create a virtual environment.</p>
<p>Does that seem like a good default behavior? Lately the python dev community has shifted in the direction of isolating as much as possible, whenever possible.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ketozhang">@ketozhang</a> on 2024-08-22 02:07</div>
            <div class="timeline-body"><p>Not entirely sure about this. I see it as whether or not the <em>base env</em> (I call it <em>global env</em>) is still necessary.</p>
<p><code>uv tool</code>[^1] has remove a lot of the need for base env, but I think there are a few key use cases that pipx historically do not support.</p>
<p>A motivating example would be Jupyter where many users treat it as a global tool not belonging to any particular environment. How does <code>uv run jupyter</code> work here?</p>
<p>[^1]:  huh, I just learned about <code>uvx</code>. What&#x27;s the difference? Both seems like <code>pipx</code> replacement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-22 03:58</div>
            <div class="timeline-body"><p><code>uv run jupyter</code> will fail unless you&#x27;re in a project that requires <code>jupyter</code> or it is otherwise installed on your system, e.g., in the environment of the interpreter that uv finds. <code>uvx jupyter</code> will install and run <code>jupyter</code> in an isolated environment. There&#x27;s some <a href="https://docs.astral.sh/uv/concepts/tools/#relationship-to-uv-run">documentation on this</a>.</p>
<p>We can&#x27;t really get around the base environment. It can be immutable, but we&#x27;re a Python package tool and we need a Python interpreter for most operations. <code>uv run</code> will probably <em>always</em> find a Python interpreter. The question is if we should force you to be isolated from that base environment by creating an empty virtual environment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ketozhang">@ketozhang</a> on 2024-08-23 01:22</div>
            <div class="timeline-body"><p>Sounds good to me.</p>
<p>Is the venv created at some temporary directory  (current behavior for <code>uv run example.py</code>)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-23 12:56</div>
            <div class="timeline-body"><p>That would be the idea, yeah. Though for <code>uv run example.py</code> I think we&#x27;ll re-use a cached environment.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:32:32 UTC
    </footer>
</body>
</html>
