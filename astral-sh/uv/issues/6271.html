<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clarify the benefits of `uv.lock` over `requirements.txt` - astral-sh/uv #6271</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Clarify the benefits of `uv.lock` over `requirements.txt`</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/6271">#6271</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-08-20 19:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-20 19:55</div>
            <div class="timeline-body"><p>e.g. as discussed in <a href="https://discord.com/channels/1039017663004942429/1039017663512449056/1275540373971800116">Discord</a></p>
<blockquote>
<p>Yes, but there are a couple caveats. (1) requirements.txt is not automatically used — you need to manually construct the environment and remember to do so every time you change branches. In contrast, uv run automatically ensures that uv.lock is up-to-date and that all commands are run in a consistent environment. (2) uv.lock uses cross-platform resolution by default, requirements.txt only targets a single platform (though you can use the --universal flag to generate a cross-platform file). The uv.lock format is has more information about requirements in it and is designed to be performant and auditable.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @zanieb on 2024-08-20 19:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danielkelshaw">@danielkelshaw</a> on 2024-08-21 00:17</div>
            <div class="timeline-body"><p>I was just reading over the new docs for uv (which are great by the way!) and am just wondering about the use case for the <code>uv.lock</code> vs. <code>requirements.txt</code>? I understand that the <code>uv.lock</code> captures the current environment, is it not also the job for the <code>requirements.txt</code> to capture this? If so, would it make sense to have something like:</p>
<pre><code class="language-bash">$ uv pip compile uv.lock -o requirements.txt
</code></pre>
<p>in order to capture the exact state of the environment, rather than relying on the <code>pyproject.toml</code> for instance? Perhaps I have misunderstood - but a small section in the docs to clarify may be helpful!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-21 03:25</div>
            <div class="timeline-body"><p><code>uv.lock</code> resolves the dependencies declared in the <code>pyproject.toml</code> — it doesn't capture the current environment. Instead, the project's environment is constructed <em>from</em> the lockfile.</p>
<p>Similarly,<code>requirements.txt</code> can be generated from a <code>pyproject.toml</code> — but it also supports other sources, like a <code>requirements.in</code> file.</p>
<p>In both cases, you'd sync an environment with the lockfile. It's a matter of format. Unfortunately <code>requirements.txt</code> is an unspecified and complex format, which makes it hard to extend. In contrast, <code>uv.lock</code> has a bunch of information that lets us improve the performance of subsequent resolutions andensure that the environment is up-to-date before running commands. We also designed it to precisely track package sources for easy auditing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astronautas">@astronautas</a> on 2024-08-21 12:23</div>
            <div class="timeline-body"><blockquote>
<p><code>uv.lock</code> resolves the dependencies declared in the <code>pyproject.toml</code> — it doesn't capture the current environment. Instead, the project's environment is constructed <em>from</em> the lockfile.</p>
<p>Similarly,<code>requirements.txt</code> can be generated from a <code>pyproject.toml</code> — but it also supports other sources, like a <code>requirements.in</code> file.</p>
<p>In both cases, you'd sync an environment with the lockfile. It's a matter of format. Unfortunately <code>requirements.txt</code> is an unspecified and complex format, which makes it hard to extend. In contrast, <code>uv.lock</code> has a bunch of information that lets us improve the performance of subsequent resolutions andensure that the environment is up-to-date before running commands. We also designed it to precisely track package sources for easy auditing.</p>
</blockquote>
<p>Hmm, yet another lockfile format. Not a biggie though, it's just a matter of regenerating it and using uv within your CI/CD instead of pip. But still.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-21 12:47</div>
            <div class="timeline-body"><p>We are engaging heavily in PEP 751 — which defines a standard for lockfiles. Once there's a standard, we plan to use it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/keatingw">@keatingw</a> on 2024-08-22 15:07</div>
            <div class="timeline-body"><p>Let me know if this should go into a separate issue, but the one missing link for me with <code>uv.lock</code> is an ability to install from it independent of the project. The main use case on my mind is caching dependency installs with Docker (I note the docs <a href="https://docs.astral.sh/uv/guides/integration/docker/#installing-a-project_1">highlight the way to do this with the pip interface</a>, but I can't think of a way to do so with the lockfile at present).</p>
<p>I'm currently just duplicating the workflow by using <code>uv pip compile</code> to create a <code>requirements.txt</code> in addition to the lockfile, but would love to avoid this since it's hard to make sure that this is actually in sync with <code>uv.lock</code>, rather than a new resolution for the dependencies declared. (Plus removing the duplication is a side benefit, though not a huge deal)</p>
<p>Thanks for the fantastic work on uv!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-22 16:09</div>
            <div class="timeline-body"><p>@keatingw thank you! Extensive discussion about that at https://github.com/astral-sh/uv/issues/4028 — we should provide a way to do that soon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bjornasm">@bjornasm</a> on 2024-10-24 09:16</div>
            <div class="timeline-body"><blockquote>
<p>In both cases, you'd sync an environment with the lockfile.</p>
</blockquote>
<p>How?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-24 12:39</div>
            <div class="timeline-body"><p>@bjornasm</p>
<p>I'm not quite sure what you're looking for, but <code>uv venv &amp;&amp; uv pip sync requirements.txt</code> or <code>uv sync</code> (for <code>uv.lock</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bjornasm">@bjornasm</a> on 2024-10-26 22:26</div>
            <div class="timeline-body"><p>Thanks for the answer @zanieb , I think then it warrants an bugreport from me, because uv sync seemed to overwrite the lockfile with what was in pyproj toml, not the other way as I expected. Will do another test to see if I can reproduce. (In either case I should also propose that this is added explicitly to the documentation, I cant seem to find the exact workflow of this stated anywhere).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-27 18:52</div>
            <div class="timeline-body"><p><code>uv sync</code> will always re-lock the project, unless you pass <code>--frozen</code>. It's not a bug and it's well-documented.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-28 14:09</div>
            <div class="timeline-body"><p>The lockfile will never be used to update the <code>pyproject.toml</code>, the <code>pyproject.toml</code> is the source of truth of your dependencies. The <code>uv.lock</code> captures exactly which versions of your dependencies will be installed, within their constraints.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bjornasm">@bjornasm</a> on 2024-10-30 11:30</div>
            <div class="timeline-body"><p>Thank you @zanieb and @charliermarsh , sorry for taking over this issue as it is clearly a separate (and individual?) issue with documentation. Since the lockfile was proposed to be added to source control, I inferred that it is the lockfile that should be used when setting up an existing (remote) project locally. But I guess that both the lockfile and pyproject.toml has to be added to source?</p>
<p>It would be great to have some workflow/use case based examples, for us who have not worked with .toml and lockfiles before, I would be glad to open up a separate issue for it, with some suggestions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../tattle-made/feluda/issues/430.html">tattle-made/feluda#430</a> on 2024-11-05 11:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../fandango-fuzzer/fandango/issues/731.html">fandango-fuzzer/fandango#731</a> on 2025-12-01 10:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:21 UTC
    </footer>
</body>
</html>
