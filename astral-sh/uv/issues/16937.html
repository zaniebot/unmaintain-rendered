<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv sync` hangs on 0.9.14 with PyPI proxy - astral-sh/uv #16937</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv sync</code> hangs on 0.9.14 with PyPI proxy</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16937">#16937</a>
        opened by <a href="https://github.com/georgeflug">@georgeflug</a>
        on 2025-12-02 18:39
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/georgeflug">@georgeflug</a></div>
            <div class="timeline-body">Summary
<p>This issue started happening on 0.9.14. It works OK on 0.9.13 or earlier.</p>
<p>When running <code>uv sync</code>, the command hangs indefinitely. This occurs when connecting to a PyPI proxy on Sonatype Nexus - it does not occur when using the PyPI index directly.</p>
<p>Repro steps:</p>
<ol>
<li>Install uv 0.9.14</li>
<li>Clear caches and sync against PyPI (works OK): <code>rm -rf .venv ~/.cache/uv &amp;&amp; uv sync -vv</code></li>
<li>Clear caches and sync against Nexus (hangs): <code>rm -rf .venv ~/.cache/uv &amp;&amp; uv sync --index=&quot;https://nexus.mycompany.com/repository/PyPI/simple/&quot; -vv</code></li>
</ol>
<p>From the logs (see attached), it looks like it&#x27;s waiting for a response for the <code>hatchling</code> metadata because I don&#x27;t see the following entry when it hangs: <code>TRACE Received package metadata for: hatchling</code></p>
<p><a href="https://github.com/user-attachments/files/23888358/uv_sync_0.9.13.txt">uv_sync_0.9.13.txt</a>
<a href="https://github.com/user-attachments/files/23888357/uv_sync_0.9.14.txt">uv_sync_0.9.14.txt</a></p>
Platform
<p>macOs and Ubuntu</p>
Version
<p>0.9.14</p>
Python version
<p>3.11.14</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/georgeflug">@georgeflug</a> on 2025-12-02 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-12-02 18:47</div>
            <div class="timeline-body"><p>Thanks for the report. Would you be willing to test a branch with a fix?</p>
<p>The changes between 13 and 14 are https://github.com/astral-sh/uv/compare/0.9.13...0.9.14</p>
<p>Only #16887 looks suspicious but even that&#x27;s a stretch.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/georgeflug">@georgeflug</a> on 2025-12-02 23:47</div>
            <div class="timeline-body"><p>The branch fixes it!</p>
<p>Interestingly, the branch and even the older 0.9.13 still have the problem if I run the build as <code>cargo build -p uv</code>. But when I run the build as <code>cargo build --release</code>, then 0.9.13, the branch, and everything leading up to f2c33b4 are good, and f2c33b4 through 0.9.14 are bad.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-12-02 23:50</div>
            <div class="timeline-body"><p>Interesting. Thanks for giving it a try!</p>
<p>A revert will go out in the next release and we can investigate.</p>
<p>Would you be able to share the html response from the index? I&#x27;m not quite sure how we&#x27;re going to reproduce the problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/georgeflug">@georgeflug</a> on 2025-12-02 23:53</div>
            <div class="timeline-body"><p>Thanks for reverting! Yes I can. What URL do you want to see?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-12-03 00:06</div>
            <div class="timeline-body"><p>I believe the https://pypi.org/simple/hatchling/ equivalent is what we need. Does this happen for arbitrary packages?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-12-03 05:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-12-05 03:45</div>
            <div class="timeline-body"><p>When possible, can you please follow-up with a response that we can use to reproduce this? Otherwise, we risk breaking you again in a subsequent PR, since we&#x27;ll have no way of knowing if we&#x27;ve actually fixed your issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/georgeflug">@georgeflug</a> on 2025-12-06 00:56</div>
            <div class="timeline-body"><p>Sorry for the delay. See the attached request/response pulled from mitmproxy while uv sync ran. I was able to reproduce this with other packages besides hatchling, in this case, pyt.</p>
<p><a href="https://github.com/user-attachments/files/23973007/pyt.log">pyt.log</a></p>
<p>The <code>&lt;script&gt;</code> tag at the bottom seems like a likely culprit since that&#x27;s not present on pypi.org.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-12-06 00:59</div>
            <div class="timeline-body"><p>Amazing, thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-12-06 01:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:41:11 UTC
    </footer>
</body>
</html>
