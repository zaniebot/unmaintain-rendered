```yaml
number: 6760
title: "uv tries to read `project.name` whenever the `project` table is present"
type: issue
state: closed
author: edgarrmondragon
labels:
  - compatibility
assignees: []
created_at: 2024-08-28T15:42:37Z
updated_at: 2024-09-14T20:03:49Z
url: https://github.com/astral-sh/uv/issues/6760
synced_at: 2026-01-10T01:57:15Z
```

# uv tries to read `project.name` whenever the `project` table is present

---

_Issue opened by @edgarrmondragon on 2024-08-28 15:42_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

Here the package metadata may be at fault (https://github.com/quantile-development/dagster-ext/issues/12), but both pypa/build and Poetry are able to build the project without any issues (even if with missing metadata).

---

_Comment by @zanieb on 2024-08-28 16:34_

Thanks for the report!

Technically, I think it's a violation of the specification to exclude the `name` field when a `[project]` table exists. 

From the relevant [document](https://packaging.python.org/en/latest/specifications/pyproject-toml/#declaring-project-metadata-the-project-table):

> The lack of a [project] table implicitly means the [build backend](https://packaging.python.org/en/latest/glossary/#term-Build-Backend) will dynamically provide all keys.
>
> The only keys required to be statically defined are: ... `name`

I believe the problem is that we see a `[project]` table so we attempt to extract _static_ metadata from the project without calling into a build backend. I guess the argument here is that `[project.urls]` doesn't explicitly define a `[project]` table? That seems weird though.

I see a few options:

1. We fallback to dynamic metadata retrieval with the build-backend if the static metadata retrieval fails
2. We special-case implicit `[project]` table declarations
3. We continue to be strict here and pursue a clarification in the specification

---

_Label `compatibility` added by @zanieb on 2024-08-28 16:35_

---

_Comment by @zanieb on 2024-08-28 16:37_

I'm also reading a bit into the linked issue regarding the implicit table definition — please let me know if you think it's wrong to fail if `name` is missing even when the project table (`[project]`) is explicitly defined.

---

_Comment by @henryiii on 2024-08-28 18:00_

It's invalid. Tools are supposed to error out. I really dislike that it's required, but not up to me. :) See https://github.com/pypa/cibuildwheel/issues/1064.

---

_Referenced in [python-poetry/poetry-core#708](../../python-poetry/poetry-core/pulls/708.md) on 2024-08-28 20:49_

---

_Referenced in [astral-sh/uv#6803](../../astral-sh/uv/pulls/6803.md) on 2024-08-29 10:54_

---

_Comment by @FFY00 on 2024-09-05 04:15_

> I'm also reading a bit into the linked issue regarding the implicit table definition — please let me know if you think it's wrong to fail if `name` is missing even when the project table (`[project]`) is explicitly defined.

If there's a `project` table, the `project.name` field must be present, but the `project` table is not required to be present.
If a `project` table is not present, it means the project is not using PEP 621 metadata, which is perfectly valid.

In this case, it seems the project was mixing the `project` (PEP 621) and `tool.poetry` tables when specifying the metadata, which shouldn't really be allowed. I consider this a bug in the build backend.

With this in mind, UV's behavior is correct, however, to achieve better compatibility, I would suggest issuing a warning instead of erroring out in such scenarios.

PS: Feel free to ping me if you have any more issues, or questions, regarding the project metadata, and other issues regarding packaging.

---

_Comment by @edgarrmondragon on 2024-09-05 20:47_

> In this case, it seems the project was mixing the `project` (PEP 621) and `tool.poetry` tables when specifying the metadata, which shouldn't really be allowed. I consider this a bug in the build backend.

I agree, though I wonder if it's worth reporting to the Poetry folks, specially since https://github.com/python-poetry/poetry-core/pull/708 is just waiting to be released, and the frontend is WIP (https://github.com/python-poetry/poetry/pull/9135).

---

_Closed by @charliermarsh on 2024-09-14 20:03_

---

_Closed by @charliermarsh on 2024-09-14 20:03_

---
