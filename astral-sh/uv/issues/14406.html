<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>contradicting info in the docs about the default build backend - astral-sh/uv #14406</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>contradicting info in the docs about the default build backend</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/14406">#14406</a>
        opened by <a href="https://github.com/DetachHead">@DetachHead</a>
        on 2025-07-02 04:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/DetachHead">@DetachHead</a> on 2025-07-02 04:03</div>
            <div class="timeline-body"><h3>Question</h3>
<p>in <a href="https://docs.astral.sh/uv/concepts/build-backend/#the-uv-build-backend">the build backend docs</a> it says:</p>
<blockquote>
<p>When preview mode is not enabled, uv uses <a href="https://pypi.org/project/hatchling/">hatchling</a> as the default build backend.</p>
</blockquote>
<p>this contradicts <a href="https://docs.astral.sh/uv/concepts/projects/config/#project-packaging">the config docs</a> which says that the default build backend is setuptools:</p>
<blockquote>
<p>Setting <code>tool.uv.package = true</code> will force a project to be built and installed into the project environment. If no build system is defined, uv will use the setuptools legacy backend.</p>
</blockquote>
<p>it also implies that if preview mode is enabled, then <code>uv_build</code> is the default build backend, but that does not seem to be the case either. when i put the following in my <code>pyproject.toml</code> and run <code>uv build</code> without specifying a build backend, it still falls back to setuptools:</p>
<pre><code class="language-toml">[tool.uv]
preview = true
</code></pre>
<pre><code>&gt; uv build
Building source distribution...
error: Multiple top-level packages discovered in a flat-layout: ['foo', 'bar'].

To avoid accidental inclusion of unwanted files or directories,
setuptools will not proceed with this build.

If you are trying to create a single distribution with multiple packages
on purpose, you should not rely on automatic discovery.
Instead, consider the following options:

1. set up custom discovery (`find` directive with `include` or `exclude`)
2. use a `src-layout`
3. explicitly set `py_modules` or `packages` with a list of names

To find more information, look for &quot;package discovery&quot; on setuptools docs.
  × Failed to build `C:\Users\user\project`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_sdist` failed (exit code: 1)
      hint: This usually indicates a problem with the package or the build environment.
</code></pre>
<h3>Platform</h3>
<p>windows 11</p>
<h3>Version</h3>
<p>uv 0.7.17 (41c218a89 2025-06-29)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @DetachHead on 2025-07-02 04:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 20:44</div>
            <div class="timeline-body"><p>The former is about <code>uv init</code>, the latter is the standards-compliant behavior for building Python packages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-02 20:45</div>
            <div class="timeline-body"><p>We've actually just fixed this, so you should see it updated once we release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">build-backend</span> added by @konstin on 2025-07-02 20:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @konstin by @konstin on 2025-07-03 17:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @konstin by @konstin on 2025-07-04 12:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-07-04 12:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:04 UTC
    </footer>
</body>
</html>
