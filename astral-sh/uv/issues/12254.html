<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inconsistent version for wheel in lockfile updated by Dependabot - astral-sh/uv #12254</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Inconsistent version for wheel in lockfile updated by Dependabot</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12254">#12254</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-03-17 23:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-17 23:52</div>
            <div class="timeline-body"><p>Dependabot recently launched support for updating versions in <code>uv.lock</code> files (see https://github.com/dependabot/dependabot-core/issues/10478). However, the latest version of Dependabot:</p>
<ul>
<li>Edits the lockfile directly instead of using uv to resolve new metadata</li>
<li>Updates the <code>&lt;package&gt;.version</code> field (but not the associated distributions</li>
</ul>
<p>(see the <a href="https://github.com/dependabot/dependabot-core/blob/1cd6fc59d7dae25d46255550528dd056c97c46d8/uv/lib/dependabot/uv/file_updater/lock_file_updater.rb#L102-L143">implementation</a>)</p>
<p>Previously, we've assumed we are the only writer of the lockfile and that the metadata inside it was consistent. Since the distribution files were not updated by Dependabot, uv would continue to use the old package version despite the Dependabot change. This means that Dependabot pull requests updating the versions of packages in the <code>uv.lock</code> had no effect.</p>
<p>It looks like this may be a Dependabot regression introduced by https://github.com/dependabot/dependabot-core/pull/11810. It's not clear if the change in behavior was intentional.</p>
<p>In https://github.com/astral-sh/uv/pull/12235, we've added validation that the package version in a lockfile matches its associated wheels. In uv 0.6.7, an error will be raised if this is detected. This will prevent invalid changes to the lockfile. Unfortunately, this means that some existing lockfiles will be invalidated. If a lockfile has been updated by the latest version of Dependabot, it will need to be reverted.</p>
<p>Note the validation is currently only scoped to distributions with <em>wheels</em>. If there are not wheels published for the package, the described problem is still present. We are exploring validation of source distribution versions in https://github.com/astral-sh/uv/pull/12237 — but we are worried this may disrupt other workflows.</p>
<p>We continue to be excited about Dependabot support for uv. If you're working on a fix for this issue in Dependabot, feel free to ping me for review.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-20 15:24</div>
            <div class="timeline-body"><p>I'm not seeing much activity here — so unpinning this and closing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-03-20 15:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:44:25 UTC
    </footer>
</body>
</html>
