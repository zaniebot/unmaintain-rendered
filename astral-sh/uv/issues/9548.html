<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resolving `toga-gtk` attempts to build `pygobject` on MacOS - astral-sh/uv #9548</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Resolving <code>toga-gtk</code> attempts to build <code>pygobject</code> on MacOS</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9548">#9548</a>
        opened by <a href="https://github.com/ncoghlan">@ncoghlan</a>
        on 2024-12-01 08:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ncoghlan">@ncoghlan</a></div>
            <div class="timeline-body"><p><code>toga-gtk</code> fails to generate a valid cross-platform lock file when added as a dependency on platforms other than Linux, as <code>pygobject</code> can only be published as an sdist: <a href="https://github.com/beeware/toga/issues/2995">beeware/toga#2995</a></p>
<p>(statically linking the GObject bindings is not desirable, and a valid manylinux wheel can&#x27;t just assume those libraries exist)</p>
<p>Setting <code>tool.uv.dependency.metadata</code> doesn&#x27;t solve the problem, since that&#x27;s only effective for application locks - the tool table metadata doesn&#x27;t make it into the <code>toga-gtk</code> <code>.dist-info</code> folder,  so <code>uv add</code> doesn&#x27;t have access to it when the dependency on <code>toga-gtk</code> is resolved.</p>
<p>Searching the code for <code>build_wheel</code> and <code>prepare_metadata_for_build_wheel</code>, it isn&#x27;t clear to me if the problem is that <code>uv</code> simply isn&#x27;t trying the latter option before progressing to the full wheel build, or if the latter isn&#x27;t working with meson-build, so <code>uv</code> is falling back to the former, which than fails due to the platform incompatibility.</p>
<p>Potentially related:</p>
<ul>
<li>architecture mismatch issue: <a href="https://github.com/astral-sh/uv/issues/3308">astral-sh/uv#3308</a></li>
<li>meson-build issue: <a href="https://github.com/astral-sh/uv/issues/8966">astral-sh/uv#8966</a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`uv` attempts to build `pygobject` on MacOS when resolving `toga-gtk` dependencies&quot; to &quot;`uv` attempts to build `pygobject` on MacOS when resolving `toga-gtk`&quot; by <a href="https://github.com/ncoghlan">@ncoghlan</a> on 2024-12-01 08:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;`uv` attempts to build `pygobject` on MacOS when resolving `toga-gtk`&quot; to &quot;Resolving `toga-gtk` attempts to build `pygobject` on MacOS&quot; by <a href="https://github.com/ncoghlan">@ncoghlan</a> on 2024-12-01 08:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/konstin">@konstin</a> on 2024-12-04 11:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2024-12-04 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2024-12-04 11:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:35:52 UTC
    </footer>
</body>
</html>
