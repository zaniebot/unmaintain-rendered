<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resolving `toga-gtk` attempts to build `pygobject` on MacOS - astral-sh/uv #9548</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Resolving <code>toga-gtk</code> attempts to build <code>pygobject</code> on MacOS</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9548">#9548</a>
        opened by <a href="https://github.com/ncoghlan">@ncoghlan</a>
        on 2024-12-01 08:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ncoghlan">@ncoghlan</a> on 2024-12-01 08:16</div>
            <div class="timeline-body"><p><code>toga-gtk</code> fails to generate a valid cross-platform lock file when added as a dependency on platforms other than Linux, as <code>pygobject</code> can only be published as an sdist: https://github.com/beeware/toga/issues/2995</p>
<p>(statically linking the GObject bindings is not desirable, and a valid manylinux wheel can't just assume those libraries exist)</p>
<p>Setting <code>tool.uv.dependency.metadata</code> doesn't solve the problem, since that's only effective for application locks - the tool table metadata doesn't make it into the <code>toga-gtk</code> <code>.dist-info</code> folder,  so <code>uv add</code> doesn't have access to it when the dependency on <code>toga-gtk</code> is resolved.</p>
<p>Searching the code for <code>build_wheel</code> and <code>prepare_metadata_for_build_wheel</code>, it isn't clear to me if the problem is that <code>uv</code> simply isn't trying the latter option before progressing to the full wheel build, or if the latter isn't working with meson-build, so <code>uv</code> is falling back to the former, which than fails due to the platform incompatibility.</p>
<p>Potentially related:</p>
<ul>
<li>architecture mismatch issue: https://github.com/astral-sh/uv/issues/3308</li>
<li>meson-build issue: https://github.com/astral-sh/uv/issues/8966</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv` attempts to build `pygobject` on MacOS when resolving `toga-gtk` dependencies" to "`uv` attempts to build `pygobject` on MacOS when resolving `toga-gtk`" by @ncoghlan on 2024-12-01 08:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv` attempts to build `pygobject` on MacOS when resolving `toga-gtk`" to "Resolving `toga-gtk` attempts to build `pygobject` on MacOS" by @ncoghlan on 2024-12-01 08:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2024-12-04 11:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-12-04 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-12-04 11:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:50 UTC
    </footer>
</body>
</html>
