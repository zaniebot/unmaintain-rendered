<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support searching multiple indexes with one or more offline - astral-sh/uv #12100</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support searching multiple indexes with one or more offline</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/12100">#12100</a>
        opened by <a href="https://github.com/kimotorc">@kimotorc</a>
        on 2025-03-10 17:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kimotorc">@kimotorc</a> on 2025-03-10 17:31</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>With multiple indexes, it seems that if an index is offline before the dependency is found, there will be a 'client error (Connect)' failure.  It would be nice if the search continued to the following indexes.</p>
<p>The context is that I'd like uv to manage my project that can run in 3 different environments each with a different pypi index.  From each, all dependencies can be found. Of the 3 specified in the pyproject.toml, only one will be online.</p>
<p>I know I can pin each package to the right index with environment markers.  However, two of the 3 environments are very similar and I'm not sure I can disambiguate between them with the available PEP508 variables.  Also, it seems like replicating the pinning for all 3 environments to all dependencies is a lot.</p>
<h3>Example</h3>
<p>If I had two indexes like below, the current behavior is for uv to try to connect until the timeout is elapsed, then raise a network error.  It would be nice if instead of an error, the search continues on to the online index.</p>
<pre><code>[[tool.uv.index]]
url = &quot;https://example.offline.pypi.com/simple&quot;

[[tool.uv.index]]
url = &quot;https://pypi.org/simple&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @kimotorc on 2025-03-10 17:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seifertm">@seifertm</a> on 2025-08-12 07:02</div>
            <div class="timeline-body"><p>I would like to second the use case of having multiple environments, each of which with their own package index.</p>
<p>Uv currently supports handling HTTP status codes for responses from indexes, but it completely stops the resolution process if any of the indexes are offline or DNS resolution fails. It would be great if the failure handling was extended beyond HTTP errors.</p>
<p>I think this is related to or a duplicate of #10462.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/seifertm">@seifertm</a> on 2025-08-14 13:41</div>
            <div class="timeline-body"><p>Depending on the effort, I'm cautiously optimistic that I could contribute a PR for this functionality. That is, if the maintainers consider the proposed idea valuable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/larstalian">@larstalian</a> on 2025-09-02 16:31</div>
            <div class="timeline-body"><p>This feature would be very helpful as i am trying to cache dependencies in a local devpi server, and when it is not available on my network, i want to fallback to other indexes.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:02 UTC
    </footer>
</body>
</html>
