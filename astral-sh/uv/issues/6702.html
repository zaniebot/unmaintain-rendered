<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Package not found in index ~Package with thousand of versions cannot be found~ - astral-sh/uv #6702</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Package not found in index ~Package with thousand of versions cannot be found~</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6702">#6702</a>
        opened by <a href="https://github.com/mina-asham">@mina-asham</a>
        on 2024-08-27 17:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mina-asham">@mina-asham</a> on 2024-08-27 17:00</div>
            <div class="timeline-body"><p>Hi, we have an internal registry, a package we use is setup for automated releases, and thus we have over 11K versions released!
If I try to add that package (<code>xyz&gt;=1.2.3</code> for obfuscation), I get this error:</p>
<pre><code>&gt; uv pip install &quot;xyz&gt;=1.2.3&quot;
  × No solution found when resolving dependencies:
  ╰─▶ Because there are no versions of xyz and you require xyz&gt;=1.2.3, we can conclude that your requirements are
      unsatisfiable.
</code></pre>
<p>I am trying to switch away from pip/pip-tools for the obvious benefits but hitting this issue, for reference I used to get this issue with <code>pip</code> and <code>pip cache purge</code> used to fix the issue for that package.</p>
<p>This package for us have &gt;11K releases, specifically:</p>
<pre><code>&gt; pip index versions xyz | sed &quot;s/,/\n/g&quot; | wc -l
  11039
</code></pre>
<p>Using latest <code>uv</code> version: <code>0.3.4</code></p>
<p>I realise that I am not sharing a ton of details to get you to solve this, but I am more than happy to run debug commands, obfuscate them and share results here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-27 17:01</div>
            <div class="timeline-body"><p>Do you have the index configured somewhere, like in <code>pip.conf</code>? If so, you'll need to add a <code>uv.toml</code> with something like:</p>
<pre><code class="language-toml">index-url = &quot;...&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-08-27 17:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mina-asham">@mina-asham</a> on 2024-08-27 17:03</div>
            <div class="timeline-body"><p>Yes, the index is stored in <code>~/.config/uv/uv.toml</code>:</p>
<pre><code>&gt; cat ~/.config/uv/uv.toml
index-url = &quot;OBFUSCATED&quot;
extra-index-url = [&quot;https://pypi.python.org/simple&quot;]
</code></pre>
<p>I can also confirm that ALL our other private packages work fine, but that's the only one releasing a TON of packages and reaching thousands.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-27 17:04</div>
            <div class="timeline-body"><p>Ohh interesting, I see... Can you run with <code>--verbose</code> and see if there are any warnings or similar? I know you can't share the full logs, but the more of <code>--verbose</code> you can share, the more we can help.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mina-asham">@mina-asham</a> on 2024-08-27 17:10</div>
            <div class="timeline-body"><p>The verbose output:</p>
<pre><code>&gt; uv pip install --verbose &quot;xyz&gt;=1.2.3&quot;
DEBUG uv 0.3.4 (Homebrew 2024-08-26)
DEBUG Searching for Python interpreter in system path
DEBUG Found `cpython-3.9.7-macos-aarch64-none` at `/Users/minaasham/miniconda3/bin/python3` (conda prefix)
DEBUG Using Python 3.9.7 environment at miniconda3/bin/python3
DEBUG Acquired lock for `miniconda3`
DEBUG At least one requirement is not satisfied: xyz&gt;=1.2.3
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.9.7
DEBUG Adding direct dependency: xyz&gt;=1.2.3
DEBUG Found stale response for: https://pypi.python.org/simple/xyz/
DEBUG Sending revalidation request for: https://pypi.python.org/simple/xyz/
DEBUG Found not-modified response for: https://pypi.python.org/simple/xyz/
DEBUG Searching for a compatible version of xyz (&gt;=1.2.3)
DEBUG No compatible version found for: xyz
  × No solution found when resolving dependencies:
  ╰─▶ Because there are no versions of xyz and you require xyz&gt;=1.2.3, we can conclude that your requirements are
      unsatisfiable.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-27 17:11</div>
            <div class="timeline-body"><p>Ok, so I'd suggest switch PyPI and your index -- like:</p>
<pre><code class="language-toml">index-url = &quot;https://pypi.python.org/simple&quot;
extra-index-url = [&quot;OBFUSCATED&quot;]
</code></pre>
<p>We search in the extra index <em>first</em>, and if a package exists on that index, we stop looking, to prevent dependency confusion attacks (this behavior is configurable -- you can opt-out).</p>
<p>Does the package <em>also</em> exist on PyPI? I don't know if <code>xyz</code> was literal but it does: https://pypi.org/project/xyz/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mina-asham">@mina-asham</a> on 2024-08-27 17:55</div>
            <div class="timeline-body"><p><code>xyz</code> is just obfuscation, but yes the real package has a pypi version, so the name is shadowed, I would have thought that the index-url is looked up first liked pip does?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-27 17:56</div>
            <div class="timeline-body"><p>We use the extra index first, since it's very common for users to use PyTorch as the extra index, for example. There's more on it here: https://docs.astral.sh/uv/pip/compatibility/#packages-that-exist-on-multiple-indexes.</p>
<p>(In the future, we're going to introduce a better API for this entirely.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mina-asham">@mina-asham</a> on 2024-08-27 17:57</div>
            <div class="timeline-body"><p>I was able to make it work with <code>--index-strategy=unsafe-first-match</code> and <code>--index-strategy=unsafe-best-match</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-27 17:57</div>
            <div class="timeline-body"><p>Yeah, either of those would work. <code>--index-strategy=unsafe-best-match</code> is the closest to pip.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mina-asham">@mina-asham</a> on 2024-08-27 18:00</div>
            <div class="timeline-body"><p>Thank you! I think we can resolve this for now, there is no actual issue, I thought it was due to the massive number of versions but that was a red herring.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @mina-asham on 2024-08-27 18:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-27 18:16</div>
            <div class="timeline-body"><p>Sorry for the confusion around index ordering. I think we would've gotten issues like this regardless of the default we chose, just because we opted for a different model (we stop as soon as we find a package on the first matching registry, by default).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Package with thousand of versions cannot be found" to "~Package with thousand of versions cannot be found~" by @mina-asham on 2024-08-27 19:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "~Package with thousand of versions cannot be found~" to "Package not found in index ~Package with thousand of versions cannot be found~" by @mina-asham on 2024-08-27 19:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:34 UTC
    </footer>
</body>
</html>
