```yaml
number: 3612
title: Cache on CI gets broken whenever UV updates
type: issue
state: closed
author: haarisr
labels:
  - question
  - cache
assignees: []
created_at: 2024-05-15T16:52:35Z
updated_at: 2024-05-15T17:31:00Z
url: https://github.com/astral-sh/uv/issues/3612
synced_at: 2026-01-10T01:57:08Z
```

# Cache on CI gets broken whenever UV updates

---

_Issue opened by @haarisr on 2024-05-15 16:52_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

Using Github CI and Github actions cache, we save the cache dir.

When there is no update to uv, `uv pip install -r requirements.txt` uses the cached files and our CI takes about a minute.

Whenever there is an update to uv, the install time goes upto 8 minutes. On checking, uv reinstalls all our packages and seems to not use the cache anymore.

---

_Comment by @charliermarsh on 2024-05-15 16:54_

How are you installing uv? How are you saving and restoring the cache? (uv itself does not invalidate the cache across updates.)

---

_Comment by @zanieb on 2024-05-15 16:55_

On some versions, we need to make changes to the cache. This shouldn't happen on every release though, do you have examples of this occurring?

---

_Label `cache` added by @zanieb on 2024-05-15 16:55_

---

_Comment by @haarisr on 2024-05-15 17:02_

> How are you installing uv? How are you saving and restoring the cache? (uv itself does not invalidate the cache across updates.)

curl -LsSf https://astral.sh/uv/install.sh | sh

Restoring the cache using github/cache action restore and save

> On some versions, we need to make changes to the cache. This shouldn't happen on every release though, do you have examples of this occurring?

It happened from 0.1.23 to 0.1.24 and from 0.1.24 to 0.1.26. We never had any PR's on 0.1.25.



---

_Comment by @zanieb on 2024-05-15 17:14_

We _did_ bump the cache in v0.1.26 https://github.com/astral-sh/uv/commit/7b685a8158f0e444526732d25667aa6a7bc418cf

It seems likely you just encountered some cache changes.

---

_Comment by @zanieb on 2024-05-15 17:30_

Let us know if you encounter more problems. The cache has been more stable in recently releases, but still might change need to change for us to improve the data model.

---

_Closed by @zanieb on 2024-05-15 17:30_

---

_Label `question` added by @zanieb on 2024-05-15 17:31_

---
