```yaml
number: 10940
title: Editable install incorrectly passes config settings to compiled dependencies
type: issue
state: closed
author: cpburnz
labels:
  - compatibility
assignees: []
created_at: 2025-01-24T16:49:49Z
updated_at: 2025-07-18T01:27:56Z
url: https://github.com/astral-sh/uv/issues/10940
synced_at: 2026-01-10T01:57:25Z
```

# Editable install incorrectly passes config settings to compiled dependencies

---

_Issue opened by @cpburnz on 2025-01-24 16:49_

### Summary

When installing a local package as an editable install, config settings are incorrectly passed along to any compiled dependencies. That is, using `uv pip install -e . -C CONFIG_SETTING` can fail because `CONFIG_SETTING` is passed along to all dependencies that have to be compiled.

---

To reproduce this, create a simple *pyproject.toml* with a dependency on *numpy* which we'll force to compile:

```toml
[build-system]
requires = ["setuptools"]
build-backend = "setuptools.build_meta"

[project]
name = "test"
version = "0.1"
description = "test"
dependencies = ["numpy >=1.25, <2"]
requires-python = ">=3.10"
```

Then create a venv and attempt an editable install.

```
python3.10 -m venv ./venv
. venv/bin/activate
pip install --upgrade pip uv
uv pip install -e . -C editable_mode=compat --no-binary=numpy
```

The editable install fails with the confusing message:

```
Using Python 3.10.15 environment at: venv
Resolved 2 packages in 42ms
  × Failed to build `numpy==1.26.4`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `mesonpy.build_wheel` failed (exit status: 1)

      [stdout]

      ('\x1b[31m',)meson-python: error: Unknown option "editable_mode". Did you mean "editable-verbose"?

      hint: This usually indicates a problem with the package or the build environment.
  help: `numpy` (v1.26.4) was included because `test` (v0.1) depends on `numpy`
```

This is failing because the "editable_mode=compat" config setting appears to be wrongly propagated to numpy's build backend which doesn't support the option. I don't want numpy to be an editable install. I do not get this failure when installing directly through pip:

```
pip install -e . -C editable_mode=compat --no-binary=numpy
```

Results in the output:

```
Obtaining file:///home/caleb/Downloads/test  Installing build dependencies ... done
  Checking if build backend supports build_editable ... done
  Getting requirements to build editable ... done
  Preparing editable metadata (pyproject.toml) ... done
Collecting numpy<2,>=1.25 (from test==0.1)
  Using cached numpy-1.26.4.tar.gz (15.8 MB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Installing backend dependencies ... done
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: test, numpy
  Building editable for test (pyproject.toml) ... done
  Created wheel for test: filename=test-0.1-0.editable-py3-none-any.whl size=1133 sha256=eb6b338452a8d9522af448dcf6b4dabaf899dbdf84f486f6b66187ddce19acbc
  Stored in directory: /tmp/pip-ephem-wheel-cache-ob0cl04m/wheels/01/f9/32/da240fac8a3729d073c705f8e82ffb39bbe52bcc1ce84babb2
  Building wheel for numpy (pyproject.toml) ... done
  Created wheel for numpy: filename=numpy-1.26.4-cp310-cp310-linux_x86_64.whl size=7138403 sha256=dc3aed8dfcfd7ce4f9db38820c9c4a9472911bdfff98204097df792d4a78d5e9
  Stored in directory: /home/caleb/.cache/pip/wheels/34/95/4f/687abd92b993af994c95aebed5739363f0e735f23ccbc691a7
Successfully built test numpy
Installing collected packages: numpy, test
Successfully installed numpy-1.26.4 test-0.1
```

### Platform

Ubuntu 20.04 (Linux 5.15.0-130-generic x86_64 GNU/Linux)

### Version

uv 0.5.24

### Python version

Python 3.10.15

---

_Label `bug` added by @cpburnz on 2025-01-24 16:49_

---

_Label `bug` removed by @charliermarsh on 2025-01-24 17:18_

---

_Label `compatibility` added by @charliermarsh on 2025-01-24 17:18_

---

_Comment by @charliermarsh on 2025-01-24 17:19_

Looks like pip only passes these to arguments provided directly on the CLI: https://pip.pypa.io/en/stable/reference/build-system/pyproject-toml/#backend-configuration. Unsure if we should change our behavior.

---

_Comment by @charliermarsh on 2025-01-24 17:21_

I find it a not-great behavior that meson-python [errors out on unknown options](https://github.com/mesonbuild/meson-python/blob/077e3bcfb1649157c9f9220309dc494be956c43a/mesonpy/__init__.py#L608), given that (in general) there isn't strict control for configuring which packages receive which options.

---

_Comment by @zanieb on 2025-01-24 18:14_

I would rather add a package-specific `config-settings` option than change our broader behavior, I think.

---

_Comment by @charliermarsh on 2025-01-24 18:16_

Same.

---

_Comment by @charliermarsh on 2025-01-24 19:42_

It could be reasonable to change this in the `uv pip` interface though, for compatibility.

---

_Comment by @zanieb on 2025-01-24 19:44_

It's hard to say that their behavior is strictly correct though. It's not possible to pass config settings to transitive builds?

---

_Comment by @charliermarsh on 2025-01-24 19:47_

You would need to pass the package name on the command-line.

---

_Comment by @charliermarsh on 2025-01-25 21:20_

@zanieb -- What do you think of allowing, e.g., `-C numpy:editable_mode=compat`, to apply only to NumPy? It is not fully compatible with the existing argument, but I'd be fairly surprised if it had any conflicts in practice.

---

_Comment by @eli-schwartz on 2025-01-26 06:36_

> I find it a not-great behavior that meson-python [errors out on unknown options](https://github.com/mesonbuild/meson-python/blob/077e3bcfb1649157c9f9220309dc494be956c43a/mesonpy/__init__.py#L608), given that (in general) there isn't strict control for configuring which packages receive which options.

meson-python has a very much *known* `setup-args=XXXX` option which will be forwarded to meson. Meson errors out on unknown options for reasons which should be well understandable, since cargo errors on unknown features too. :)

Really, the only sane approach here is to actually specify where you want your options to apply. The current config-settings interface is completely ad hoc and unspecified, as the only standards-based definition of config settings is the `config_settings` parameter to PEP 517 build hooks. By definition, when you invoke a build hook you know what package it is for. The actual UX that pip exposes here was never rigorously defined before implementing it, so it feels a bit inevitable that existing practice would stabilize around ill-defined expectations of ill-defined semantics.

I think that `wheelname:*` namespacing is a reasonable approach to take. Although meson does internally use : and therefore by extension meson-python does too, that will be in the form: `-C setup-args=XXX:optname=true` so shouldn't clash.

---

_Comment by @zanieb on 2025-01-28 17:52_

@charliermarsh I'm fine with that. Do we want to use a different flag name to avoid ambiguity / compatibility issues? Like `--config-settings-package <name>:<...>`?

---

_Referenced in [astral-sh/uv#3898](../../astral-sh/uv/issues/3898.md) on 2025-02-20 16:11_

---

_Comment by @kyamagu on 2025-03-06 00:42_

I met a similar situation with `uv build` when trying to build a local sub-package specified as a path dependency. My code layout was the following:

```
├── packages
│   └── subpackage
│       ├── src
│       ├── pyproject.toml
│       ├── setup.py
├── pyproject.toml
├── src
```

I have a custom config in `packages/subpackage/pyproject.toml` like the following, but this config is ignored when running `uv build --wheel package/subpackage` in the root. However, this config takes effect when `cd package/subpackage && uv build --wheel`.

```
[tool.uv]
config-settings = { "--build-option" = ["--cpp_ext"] }
```

If I move this config to the root `pyproject.toml`, this option is passed to the `uv build packages/subpackage`, but this also applies the same config to every package in the project, which is not what I want.

---

_Comment by @yilinjuang on 2025-06-30 11:09_

Would love to see this. This will be helpful when several dependencies have to be built from source with different extra build configs. 

---

_Assigned to @charliermarsh by @charliermarsh on 2025-07-11 16:16_

---

_Referenced in [astral-sh/uv#14573](../../astral-sh/uv/pulls/14573.md) on 2025-07-11 23:51_

---

_Closed by @charliermarsh on 2025-07-18 01:27_

---
