<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sometimes uv cannot update itself inside a virtual env (Windows) - astral-sh/uv #3239</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Sometimes uv cannot update itself inside a virtual env (Windows)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/3239">#3239</a>
        opened by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a>
        on 2024-04-24 14:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a> on 2024-04-24 14:33</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>There are some circunstances where uv cannot update itself. I believe I've seen this work before, but currently I am unable to perform the command from inside an env.</p>
<ul>
<li>OS: Windows 11</li>
<li>uv installed 0.1.35, upgrading to 0.1.37</li>
<li>The env was created by <code>python -m uv venv</code></li>
<li>I dont have a system <code>uv</code> in my PATH outside the env</li>
</ul>
<p>Virtual env was enabled and the executable is the one running on the virtualenv which means it is replacing the same file that is running.
It is not an issue with admin file permission since <code>pip install uv</code> does work on the same shell.</p>
<pre><code>uv pip install uv --upgrade
Resolved 1 package in 1.82s
Downloaded 1 package in 2.24s
error: failed to remove file `C:\Data\pproject\env\Lib\site-packages\../../Scripts/uv.exe`
  Caused by: Access is denied. (os error 5)
</code></pre>
<p>If it is related to the file being open by the process, it would be possible to name it <code>uv.exe.tmp</code> and then trigger a new process to rename it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-24 15:03</div>
            <div class="timeline-body"><p>I think this is a duplicate of https://github.com/astral-sh/uv/issues/1368.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-04-24 15:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-24 15:03</div>
            <div class="timeline-body"><p>But yeah definitely a bug related to trying to replace the currently-running executable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by @zanieb on 2024-04-24 15:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1368.html">astral-sh/uv#1368</a> on 2024-04-24 17:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:26 UTC
    </footer>
</body>
</html>
