<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv installs and uninstalls tink==1.10.0 during each sync - astral-sh/uv #16581</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv installs and uninstalls tink==1.10.0 during each sync</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16581">#16581</a>
        opened by <a href="https://github.com/chadac">@chadac</a>
        on 2025-11-03 15:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/chadac">@chadac</a></div>
            <div class="timeline-body">Summary
<p>Currently in a uv-managed project, I&#x27;m seeing that whenever it syncs, it continually uninstalls and then reinstalls <code>tink==1.10.0</code>. This can be reproduced with the following:</p>
<pre><code>uv init
uv add tink==1.10.0
uv sync # tink should be removed and re-added, similar for subsequent `uv sync` calls
</code></pre>
<p>The issue appears to be that <code>uv</code> finds no compatible macos version of tink upstream, so it uninstalls it -- and then reinstalls it whenever it still can&#x27;t find a proper matching platform specifier. Including some logs below:</p>
<pre><code>DEBUG uv 0.9.7 (0adb44480 2025-10-30)
TRACE Checking shared lock for `/Users/chad.crawford/.cache/uv` at `/Users/chad.crawford/.cache/uv/.lock`
DEBUG Acquired shared lock for `/Users/chad.crawford/.cache/uv`
DEBUG Found project root: `/Users/chad.crawford/code/test-project`
DEBUG No workspace root found, using project root
TRACE Checking lock for `/Users/chad.crawford/code/test-project` at `/var/folders/tb/04bsctp95yj8j1r9g92grnhw0000gn/T/uv-7f637a9264c3ff85.lock`
DEBUG Acquired lock for `/Users/chad.crawford/code/test-project`
DEBUG Reading Python requests from version file at `/Users/chad.crawford/code/test-project/.python-version`
DEBUG Using Python request `3.12` from version file at `.python-version`
DEBUG Checking for Python environment at: `.venv`
TRACE Found cached interpreter info for Python 3.12.10, skipping query of: .venv/bin/python3
DEBUG The project environment&#x27;s Python version satisfies the request: `Python 3.12`
TRACE The project environment&#x27;s Python version meets the Python requirement: `&gt;=3.12`
TRACE The virtual environment&#x27;s Python interpreter meets the Python preference: `prefer managed`
DEBUG Released lock at `/var/folders/tb/04bsctp95yj8j1r9g92grnhw0000gn/T/uv-7f637a9264c3ff85.lock`
TRACE Checking lock for `.venv` at `.venv/.lock`
DEBUG Acquired lock for `.venv`
DEBUG Using request timeout of 30s
DEBUG Found static `pyproject.toml` for: test-project @ file:///Users/chad.crawford/code/test-project
DEBUG No workspace root found, using project root
DEBUG Existing `uv.lock` satisfies workspace requirements
Resolved 4 packages in 4ms
DEBUG Using request timeout of 30s
TRACE Comparing installed with source: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;tink&quot;), version: &quot;1.10.0&quot;, path: &quot;/Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/tink-1.10.0.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(&lt;uninit&gt;) } Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;1.10.0&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Platform tags mismatch for tink==1.10.0: The distribution is compatible with macOS (`macosx_10_9_x86_64`), but you&#x27;re on macOS (`macosx_26_0_arm64`)
DEBUG Requirement installed, but mismatched:
  Installed: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;tink&quot;), version: &quot;1.10.0&quot;, path: &quot;/Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/tink-1.10.0.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(Some(ExpandedTags([Small { small: WheelTagSmall { python_tag: CPython { python_version: (3, 12) }, abi_tag: CPython { gil_disabled: false, python_version: (3, 12) }, platform_tag: Macos { major: 10, minor: 9, binary_format: X86_64 } } }]))) }
  Requested: Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;1.10.0&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Registry requirement already cached: tink==1.10.0
TRACE Comparing installed with source: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;absl-py&quot;), version: &quot;2.3.1&quot;, path: &quot;/Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/absl_py-2.3.1.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(&lt;uninit&gt;) } Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;2.3.1&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Requirement already installed: absl-py==2.3.1
TRACE Comparing installed with source: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;protobuf&quot;), version: &quot;4.25.8&quot;, path: &quot;/Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/protobuf-4.25.8.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(&lt;uninit&gt;) } Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;4.25.8&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Requirement already installed: protobuf==4.25.8
DEBUG Uninstalled tink (200 files, 20 directories)
Uninstalled 1 package in 31ms
TRACE Extracting file name=PackageName(&quot;tink&quot;)
TRACE Cloning /Users/chad.crawford/.cache/uv/archive-v0/oHWfPp1klEhoOP737Vd_Z/tink-1.10.0.dist-info to /Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/tink-1.10.0.dist-info
TRACE Cloning /Users/chad.crawford/.cache/uv/archive-v0/oHWfPp1klEhoOP737Vd_Z/tink to /Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/tink
TRACE Extracted 2 files name=PackageName(&quot;tink&quot;)
TRACE No entrypoints name=PackageName(&quot;tink&quot;)
TRACE No data name=PackageName(&quot;tink&quot;)
TRACE Writing installer metadata name=PackageName(&quot;tink&quot;)
TRACE Writing record name=PackageName(&quot;tink&quot;)
Installed 1 package in 3ms
 ~ tink==1.10.0
DEBUG Released lock at `/Users/chad.crawford/code/test-project/.venv/.lock`
DEBUG Released lock at `/Users/chad.crawford/.cache/uv/.lock`
</code></pre>
<p>This appears to be an issue with newer versions of <code>uv</code> -- I can see with uv <code>0.6.20</code> that this doesn&#x27;t seem to be happening.</p>
Platform
<p>macosx 26.0 arm64</p>
Version
<p>uv 0.9.7 (0adb44480 2025-10-30)</p>
Python version
<p>Python 3.12.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/chadac">@chadac</a> on 2025-11-03 15:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-03 15:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-03 15:57</div>
            <div class="timeline-body"><p>Hmm, that&#x27;s strange... It looks like the wheel is being built for x86, but uv thinks you&#x27;re on an ARM machine. I assume you <em>are</em> in fact on an ARM machine?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chadac">@chadac</a> on 2025-11-03 16:03</div>
            <div class="timeline-body"><p>It is definitely an ARM machine -- so yeah not sure why it&#x27;s getting that indicator. Lemme clear my cache and see if I can get it to rebuild as well... <a href="https://github.com/tink-crypto/tink-py/blob/main/setup.py">the upstream setup.py</a> does seem to use bazel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chadac">@chadac</a> on 2025-11-03 16:11</div>
            <div class="timeline-body"><p>It looks like it isn&#x27;t actually building it from the source archive, but using the <code>tink-1.10.0-cp312-cp312-macosx_11_0_universl2.whl</code> archive instead:</p>
<pre><code>DEBUG Identified uncached distribution: tink==1.10.0
TRACE Comparing installed with source: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;absl-py&quot;), version: &quot;2.3.1&quot;, path: &quot;/Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/absl_py-2.3.1.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(&lt;uninit&gt;) } Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;2.3.1&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Requirement already installed: absl-py==2.3.1
TRACE Comparing installed with source: InstalledDist { kind: Registry(InstalledRegistryDist { name: PackageName(&quot;protobuf&quot;), version: &quot;4.25.8&quot;, path: &quot;/Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/protobuf-4.25.8.dist-info&quot;, cache_info: None, build_info: None }), metadata_cache: OnceLock(&lt;uninit&gt;), tags_cache: OnceLock(&lt;uninit&gt;) } Registry { specifier: VersionSpecifiers([VersionSpecifier { operator: Equal, version: &quot;4.25.8&quot; }]), index: Some(IndexMetadata { url: Pypi(VerbatimUrl { url: DisplaySafeUrl { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }), format: Simple }), conflict: None }
DEBUG Requirement already installed: protobuf==4.25.8
TRACE No cache entry exists for /Users/chad.crawford/.cache/uv/wheels-v5/pypi/tink/1.10.0-cp312-cp312-macosx_11_0_universal2.http
DEBUG No cache entry for: https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl
TRACE Sending fresh GET request for https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl
TRACE Handling request for https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl with authentication policy auto
TRACE Request for https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl is unauthenticated, checking cache
TRACE No credentials in cache for URL https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl
TRACE Attempting unauthenticated request for https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl
TRACE Response from https://files.pythonhosted.org/packages/42/09/baf723b9ebc45135e1d547add7d72b70f0efc957610a72e19110e48b227e/tink-1.10.0-cp312-cp312-macosx_11_0_universal2.whl is storable because it has a &#x27;public&#x27; cache-control directive
</code></pre>
<p>However, just realized I should check their dist-info too... it looks like they&#x27;re self-reporting it as an x86_64 wheel:</p>
<pre><code>$ cat /Users/chad.crawford/code/test-project/.venv/lib/python3.12/site-packages/tink-1.10.0.dist-info/WHEEL
Wheel-Version: 1.0
Generator: bdist_wheel (0.41.3)
Root-Is-Purelib: false
Tag: cp312-cp312-macosx_10_9_x86_64
</code></pre>
<p>I&#x27;m guessing in this case I probably should report this to them? Not sure if a mismatch between what is downloaded and what is reported in the WHEEL</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-11-03 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-11-03 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-11-03 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">external</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-11-03 16:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-11-03 16:17</div>
            <div class="timeline-body"><p>Yes this is a problem with the tink build system, the tag in the WHEEL file must match the tag on the wheel. The reinstalling happens because uv sees the installed tag in the WHEEL file and the tag in the lockfile and thinks that the installed file is outdated.</p>
<p>This has been fixed in the latest version, you can solve this by updating the package: https://inspector.pypi.io/project/tink/1.12.0/packages/82/f5/6e20ade036eebbfe075a72184513c8303de176fe093cf232a0895e9f9e33/tink-1.12.0-cp312-cp312-macosx_11_0_universal2.whl/tink-1.12.0.dist-info/WHEEL#line.5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chadac">@chadac</a> on 2025-11-03 16:48</div>
            <div class="timeline-body"><p>Thanks! looks like that fixes it -- sorry for bothering y&#x27;all</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/chadac">@chadac</a> on 2025-11-03 16:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-11-03 16:53</div>
            <div class="timeline-body"><p>No problem, thanks for following up!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:40:53 UTC
    </footer>
</body>
</html>
