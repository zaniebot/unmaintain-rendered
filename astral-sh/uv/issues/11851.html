<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Naming conflict grand-child package - UV uses wrong index - astral-sh/uv #11851</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Naming conflict grand-child package - UV uses wrong index</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/11851">#11851</a>
        opened by <a href="https://github.com/PedroMTQ">@PedroMTQ</a>
        on 2025-02-28 13:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/PedroMTQ">@PedroMTQ</a> on 2025-02-28 13:07</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I'm trying to install an internal package (pkg1) that depends on another internal package (pkg2), which I can do so by adding the respective azure uv.index.
However, I'm having an issue where pkg2 depends on a package (pkg3) that is available internally and publicly (naming conflict).
This then causes issues when installing pkg1, since UV refers to the publicly available package, instead of the one defined in the pkg2 pyproject.toml. If I don't define the pkg3 index in the pkg1 pyproject, then UV will install the pkg3 from the wrong index (public package), for example:</p>
<p><img src="https://github.com/user-attachments/assets/57469c50-1f4c-4e94-9e6f-67fcdcba8f03" alt="Image" /></p>
<p>If I define the pkg3 as a dependency of pkg1, then the installation works correctly, for example:</p>
<p><img src="https://github.com/user-attachments/assets/501baa88-f616-4ee8-aee8-c33db2a05e0a" alt="Image" /></p>
<p>However, for obvious reasons, I would prefer not to have this grand-child dependency explicitly managed, and would prefer if pkg2 manages it (to avoid having to update pkg3 dependency on both pkg1 and pkg2)</p>
<h3>Platform</h3>
<p>Ubuntu 20.04.6 LTS</p>
<h3>Version</h3>
<p>0.6.2</p>
<h3>Python version</h3>
<p>3.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @PedroMTQ on 2025-02-28 13:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-02-28 13:31</div>
            <div class="timeline-body"><p>Would it work for uv if you define the azure index as the default index and pypi as second index? This way, all packages available on the internal index would use the internal index, and only packages not available there would use pypi.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-28 14:11</div>
            <div class="timeline-body"><p>Yeah I think your only options here (IIUC) are: (1) define <code>pkg3</code> as a dependency so that you can set the <code>tool.uv.sources</code> on it; or (2) remove <code>explicit = true</code> so that uv prioritizes the Azure index over PyPI.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-02-28 14:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-02-28 14:11</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:02 UTC
    </footer>
</body>
</html>
