```yaml
number: 11842
title: uv sync does not respect keyring
type: issue
state: closed
author: davidshen84
labels:
  - question
assignees: []
created_at: 2025-02-27T22:32:20Z
updated_at: 2025-02-28T20:46:25Z
url: https://github.com/astral-sh/uv/issues/11842
synced_at: 2026-01-10T01:57:27Z
```

# uv sync does not respect keyring

---

_Issue opened by @davidshen84 on 2025-02-27 22:32_

### Summary

After I have keyring setup with `uvx keyring set ...`, I can use `uv add` to add a private package from my private repo. But if I clone the project to another folder/machine and do `uv sync`, I got a 401 error regarding my private repo.

Adding environment variables or a `.netrc` file can circumvent this issue. But I'd prefer not to store credentials in plaintext on my disk.

### Platform

Windows 10

### Version

uv 0.6.1 (c91ee82a8 2025-02-17)

### Python version

Python 3.12.9

---

_Label `bug` added by @davidshen84 on 2025-02-27 22:32_

---

_Comment by @zanieb on 2025-02-27 22:54_

Are you using `--keyring-provider subprocess` on sync or `keyring-provider = subprocess` in your project?

Can you share more details for a reproduction? per #9452

---

_Label `needs-mre` added by @zanieb on 2025-02-27 22:55_

---

_Comment by @davidshen84 on 2025-02-27 23:31_

[uv.log](https://github.com/user-attachments/files/19017772/uv.log)

Above is the `uv sync --force-reinstall --verbose` output with

```
[tool.uv]
keyring-provider = "subprocess"
```

I also tried setting `--keyring-process subprocess` on the command line but got the same result.

Also, in my first try, I did not specify any keyring configuration. I thought uv would pick up an available keyring automatically.

---

_Comment by @zanieb on 2025-02-28 03:13_

Thanks for the additional details.

Would you mind providing logs with `RUST_LOG=uv=trace` set? That should get me the relevant logs from our authentication handler.

---

_Comment by @zanieb on 2025-02-28 03:15_

Do you have a username set in your index URL? That's also required for keyring, unfortunately.

For example https://docs.astral.sh/uv/guides/integration/alternative-indexes/#using-keyring

This isn't the case for `pip` because they can just call into the Python keyring implementation directly which exposes a method for fetching both a username and password, but the keyring CLI only supported fetching a password given a username until recently (and we can't assume people are on that new version).

---

_Comment by @davidshen84 on 2025-02-28 07:22_

Well, if I have to put Username in the index url, it is not portable. I'd
rather use ".netrc" or environment variables.

Thanks

On Fri, 28 Feb 2025, 14:15 Zanie Blue, ***@***.***> wrote:

> Do you have a username set in your index URL? That's also required for
> keyring, unfortunately.
>
> For example
> https://docs.astral.sh/uv/guides/integration/alternative-indexes/#using-keyring
>
> This isn't the case for pip because they can just call into the Python
> keyring implementation directly which exposes a method for fetching both a
> username and password, but the keyring CLI only supported fetching a
> password given a username until recently (and we can't assume people are on
> that new version).
>
> —
> Reply to this email directly, view it on GitHub
> <https://github.com/astral-sh/uv/issues/11842#issuecomment-2689619801>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AAAQBTOQR5WMDL2FQAJETBL2R7IF7AVCNFSM6AAAAABYA6LWCSVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDMOBZGYYTSOBQGE>
> .
> You are receiving this because you authored the thread.Message ID:
> ***@***.***>
> [image: zanieb]*zanieb* left a comment (astral-sh/uv#11842)
> <https://github.com/astral-sh/uv/issues/11842#issuecomment-2689619801>
>
> Do you have a username set in your index URL? That's also required for
> keyring, unfortunately.
>
> For example
> https://docs.astral.sh/uv/guides/integration/alternative-indexes/#using-keyring
>
> This isn't the case for pip because they can just call into the Python
> keyring implementation directly which exposes a method for fetching both a
> username and password, but the keyring CLI only supported fetching a
> password given a username until recently (and we can't assume people are on
> that new version).
>
> —
> Reply to this email directly, view it on GitHub
> <https://github.com/astral-sh/uv/issues/11842#issuecomment-2689619801>,
> or unsubscribe
> <https://github.com/notifications/unsubscribe-auth/AAAQBTOQR5WMDL2FQAJETBL2R7IF7AVCNFSM6AAAAABYA6LWCSVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDMOBZGYYTSOBQGE>
> .
> You are receiving this because you authored the thread.Message ID:
> ***@***.***>
>


---

_Comment by @zanieb on 2025-02-28 15:24_

That's the state of keyring support. We'll add native keyring support that does not rely on the "keyring" Python package and then we can do what you want.

---

_Label `bug` removed by @zanieb on 2025-02-28 15:25_

---

_Label `needs-mre` removed by @zanieb on 2025-02-28 15:25_

---

_Label `question` added by @zanieb on 2025-02-28 15:25_

---

_Comment by @davidshen84 on 2025-02-28 20:46_

Thanks for the explanation.

---

_Closed by @davidshen84 on 2025-02-28 20:46_

---
