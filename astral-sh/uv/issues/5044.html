<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simplify union of marker expression and negation - astral-sh/uv #5044</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Simplify union of marker expression and negation</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5044">#5044</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-07-14 14:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/konstin">@konstin</a> on 2024-07-14 14:11</div>
            <div class="timeline-body"><p>We currently don't simplify the union of marker expression and its negation, e.g. <code>sys_platform == 'darwin' or sys_platform != 'darwin'</code>.</p>
<p>As an example, for <code>echo &quot;colabfold==1.5.5&quot; | cargo run pip compile -p 3.12 --universal -</code>, we get:</p>
<pre><code>[...]
tensorflow-macos==2.13.1 ; sys_platform == 'darwin'
    # via colabfold
[...]
werkzeug==3.0.3 ; sys_platform == 'darwin' or sys_platform != 'darwin'
    # via tensorboard
wheel==0.43.0 ; sys_platform == 'darwin' or sys_platform != 'darwin'
    # via
    #   astunparse
    #   tensorboard
wrapt==1.16.0 ; sys_platform == 'darwin' or sys_platform != 'darwin'
    # via
    #   tensorflow-cpu
    #   tensorflow-macos
zipp==3.19.2
    # via importlib-metadata
</code></pre>
<p>The above <code>sys_platform == 'darwin' or sys_platform != 'darwin'</code> markers should be elided, these package aren't fork dependent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2024-07-14 14:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-14 14:56</div>
            <div class="timeline-body"><p>Good call.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-14 16:32</div>
            <div class="timeline-body"><p>\cc @ibraheemdev</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-07-14 23:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-14 23:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 05:34:22 UTC
    </footer>
</body>
</html>
