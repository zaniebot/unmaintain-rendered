<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv build backend doesn't support PEP420 implicit namespace packages without __init__.py - astral-sh/uv #14451</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv build backend doesn&#x27;t support PEP420 implicit namespace packages without <strong>init</strong>.py</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/14451">#14451</a>
        opened by <a href="https://github.com/karlicoss">@karlicoss</a>
        on 2025-07-03 23:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/karlicoss">@karlicoss</a></div>
            <div class="timeline-body">Summary
<p>Here&#x27;s a simple reproducer https://github.com/karlicoss/uv_build_pep420</p>
<p>The package structure is just</p>
<pre><code>pyproject.toml
src/
src/uv_build_pep420/
src/uv_build_pep420/module.py
</code></pre>
What happens with <code>uv build</code>
<pre><code>$ uv build
Building source distribution (uv build backend)...
  × Failed to build `/path/to/uv_build_pep420`
  ╰─▶ Expected a Python module at: `src/uv_build_pep420/__init__.py`
</code></pre>
Expecteed result:
<p><code>uv_build</code> should be able to build the package.</p>
<p>According to <a href="https://peps.python.org/pep-0420/#specification">PEP 420</a>, this is a valid implicit namespace package; e.g. something like this works when using setuptools/hatchling build backends (there are examples of configuration commented out <code>pyproject.toml</code>).</p>
<p>E.g. hatchling results in the following wheel:</p>
<pre><code>$ unzip -l uv_build_pep420-0.1.0-py3-none-any.whl
Archive:  uv_build_pep420-0.1.0-py3-none-any.whl
  Length      Date    Time    Name
---------  ---------- -----   ----
        0  02-02-2020 00:00   uv_build_pep420/module.py
       83  02-02-2020 00:00   uv_build_pep420-0.1.0.dist-info/METADATA
       87  02-02-2020 00:00   uv_build_pep420-0.1.0.dist-info/WHEEL
      307  02-02-2020 00:00   uv_build_pep420-0.1.0.dist-info/RECORD
---------                     -------
      477                     4 files
</code></pre>
<p>It also works as expected in runtime:</p>
<pre><code>uv run python3 -c &#x27;import uv_build_pep420 as P; print(P.__path__)&#x27;
_NamespacePath([&#x27;/path/to/uv_build_pep420/src/uv_build_pep420&#x27;])
</code></pre>
<p>I also tried using <a href="https://docs.astral.sh/uv/reference/settings/#build-backend_namespace"><code>namespace</code></a> option, but it doesn&#x27;t see to make any difference.</p>
<p>The documentation says <code>Build a PEP 420 implicit namespace package, allowing more than one root __init__.py</code> -- however in this case there aren&#x27;t any <code>__init__.py</code> at all, so I wonder if it&#x27;s just been an unhandled/forgotten case?</p>
Related issues
<ul>
<li>https://github.com/astral-sh/uv/issues/12832</li>
<li>https://github.com/astral-sh/uv/pull/13833</li>
</ul>
Platform
<p>Darwin 24.3.0 arm64</p>
Version
<p>uv 0.7.19 (38ee6ec80 2025-07-02)</p>
Python version
<p>3.12.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/karlicoss">@karlicoss</a> on 2025-07-03 23:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-07-04 02:05</div>
            <div class="timeline-body"><p>\cc @konstin</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">build-backend</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-07-04 08:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/konstin">@konstin</a> on 2025-07-04 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-07-04 14:40</div>
            <div class="timeline-body"><p>This works for me by setting:</p>
<pre><code>[tool.uv.build-backend]
namespace = true
</code></pre>
<hr>
<p>We could extend the search namespace package to support single-file module in addition to directory modules, but this seems to be a rare enough case that <code>namespace = true</code> is fine here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/konstin">@konstin</a> on 2025-07-04 14:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-07-04 14:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-07-04 14:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/karlicoss">@karlicoss</a> on 2025-07-04 14:47</div>
            <div class="timeline-body"><p>Sorry, I&#x27;m an idiot, I&#x27;ve been putting <code>namespace = true</code> in the wrong section like this:</p>
<pre><code>[build-system]
requires = [&quot;uv_build&gt;=0.7.19,&lt;0.8&quot;]
build-backend = &quot;uv_build&quot;
namespace = true
</code></pre>
<p>After using</p>
<pre><code>[tool.uv.build-backend]
namespace = true
</code></pre>
<p>, it works as expected!</p>
<p>Not sure if <code>uv</code> should complain about wrong attribute name in the <code>[build-system]</code> section (not sure if this section has a fixed schema?), but irrelevant to the issue here.
Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/karlicoss">@karlicoss</a> on 2025-07-04 14:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:39:17 UTC
    </footer>
</body>
</html>
