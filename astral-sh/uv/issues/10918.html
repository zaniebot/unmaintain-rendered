<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PEP 723 inline metadata tag not found when there's trailing whitespace - astral-sh/uv #10918</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>PEP 723 inline metadata tag not found when there's trailing whitespace</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/10918">#10918</a>
        opened by <a href="https://github.com/snat-s">@snat-s</a>
        on 2025-01-23 22:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/snat-s">@snat-s</a> on 2025-01-23 22:27</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>i have an issue with PEP 723, when you have a blank space at the end of the <code># ///</code> <code>uv</code> doesn't properly parse the closing tag. it tells you that there is an error:</p>
<pre><code>error: An opening tag (`# /// script`) was found without a closing tag (`# ///`). Ensure that every line between the opening and closing tags (including empty lines) starts with a leading `#`.
</code></pre>
<p>all the script had was an extra blank space at the end, it can be a bit annoying if this happens.</p>
<pre><code># /// script
# requires-python = &quot;&gt;=3.11&quot;
# dependencies = [
#   &quot;requests-oauthlib&quot;,
#   &quot;requests&quot;
#   &quot;rich&quot;,
# ]
# /// 
</code></pre>
<p>but not that it is simply that there is an extra blank space at the end.</p>
<p>i'm not sure if it already solved but just letting you know!</p>
<h3>Platform</h3>
<p>Linux 6.12.9-200.fc41.x86_64 x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.5.1</p>
<h3>Python version</h3>
<p>Python 3.11.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @snat-s on 2025-01-23 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-23 22:32</div>
            <div class="timeline-body"><p>I think we &quot;must&quot; do this per the specification (https://peps.python.org/pep-0723/#specification)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-23 22:32</div>
            <div class="timeline-body"><p>cc @ofek perhaps that's an oversight?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snat-s">@snat-s</a> on 2025-01-23 22:42</div>
            <div class="timeline-body"><p>maybe an error would help? like to see that you had an extra space and you have to fix it might help</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2025-01-23 22:48</div>
            <div class="timeline-body"><p>I think using an exact match is preferable but I don't have a strong preference. What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-23 22:51</div>
            <div class="timeline-body"><p>We could definitely hint on a similar ending tag to what we're looking for.</p>
<p>I think trailing whitespace is <em>fairly</em> reasonable to allow, but does complicate things. I don't have strong feelings.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "issues with PEP 723 â€“ Inline script metadata" to "PEP 723 inline metadata tag not found when there's trailing whitespace" by @zanieb on 2025-01-23 23:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @zanieb on 2025-01-23 23:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-24 14:44</div>
            <div class="timeline-body"><p>I suppose I'm fine to allow trailing whitespace.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-01-24 16:05</div>
            <div class="timeline-body"><p>While I think it would be a UX improvement, a trailing whitespace would not be matched by the reference implementation: https://peps.python.org/pep-0723/#reference-implementation</p>
<p>Someone implementing themselves would find the reference implementation doesn't work <em>some</em> of the time even though it works when they use other tools, and they would need to figure out why.</p>
<p>That is to say, if trailing whitespace is allowed, I would like the PEP (or just spec page? I don't know how these kind of corrections flow to which documents) updated, including the reference implementation (which would then make clear what type of whitespaces would be allowed (vertical tabs?)).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-24 16:34</div>
            <div class="timeline-body"><p>Hmm yeah. I think you're right. We should continue to reject this. We can add a better error message if anyone is motivated to do so, though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-01-24 16:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @charliermarsh on 2025-01-24 16:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @charliermarsh on 2025-01-24 16:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hugovk">@hugovk</a> on 2025-01-24 20:14</div>
            <div class="timeline-body"><blockquote>
<p>That is to say, if trailing whitespace is allowed, I would like the PEP (or just spec page? I don't know how these kind of corrections flow to which documents) updated, including the reference implementation (which would then make clear what type of whitespaces would be allowed (vertical tabs?)).</p>
</blockquote>
<p>PEP editor hat:</p>
<p>Just the spec. The PEP has a banner saying:</p>
<blockquote>
<p>This PEP is a historical document. The up-to-date, canonical spec, <a href="https://packaging.python.org/en/latest/specifications/inline-script-metadata/#inline-script-metadata">Inline script metadata</a>, is maintained on the <a href="https://packaging.python.org/en/latest/specifications/">PyPA specs page</a>.</p>
<p>See the <a href="https://www.pypa.io/en/latest/specifications/#handling-fixes-and-other-minor-updates">PyPA specification update process</a> for how to propose changes.</p>
</blockquote>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:30:32 UTC
    </footer>
</body>
</html>
