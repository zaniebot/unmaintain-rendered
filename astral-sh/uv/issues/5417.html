<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support a list of python platforms - astral-sh/uv #5417</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support a list of python platforms</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/5417">#5417</a>
        opened by <a href="https://github.com/JonZeolla">@JonZeolla</a>
        on 2024-07-24 16:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/JonZeolla">@JonZeolla</a> on 2024-07-24 16:51</div>
            <div class="timeline-body"><p>To fit the space between <code>--python-platform</code> supporting a single platform at a time, and <code>--universal</code> which supports all platforms, I suggest allowing a list of platforms (perhaps a rename to <code>--python-platforms</code>) so lockfiles can be created that support only the supported/required runtime platforms. This would also reduce the surface area of issues, and speed up dependency resolution.</p>
<p>Examples (modifications to what I see in the docs today):</p>
<ul>
<li><code>uv pip compile --python-platforms macos,linux requirements.in</code></li>
<li><pre><code class="language-toml">[tool.uv.pip]
python-platforms = &quot;x86_64-unknown-linux-gnu,aaarch64-apple-darwin&quot;
</code></pre>
</li>
</ul>
<p>Sorry if some of the <code>uv</code> details above aren't accurate; I am a <code>rye</code> user but this appears to be a <code>uv</code> feature that <code>rye</code> could then adopt.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 16:54</div>
            <div class="timeline-body"><p>@konstin - I wonder if there's a way that we could leverage the &quot;record fork markers&quot; to support something like this (e.g., a list of markers as input, resolve both, reconcile...). Wishlist though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-07-24 16:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @charliermarsh on 2024-07-24 16:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-24 17:26</div>
            <div class="timeline-body"><p>With the branch i'm working on atm we get the ability to feed to markers we want to resolve for in manually. We'd need to wire it up to <code>pyproject.toml</code> configuration, deactivate any full-universe checks, add a new check when installing that we're in one of the supported envs and write docs explaining how solving for a subset of environments works.</p>
<blockquote>
<p>This would also reduce the surface area of issues, and speed up dependency resolution.</p>
</blockquote>
<p>Are you having a case where the universal resolution is noticeable slower than a single-platform one? If so and you have an example you can share it would be great, then we can optimize the universal resolver better.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonZeolla">@JonZeolla</a> on 2024-07-25 10:58</div>
            <div class="timeline-body"><p>@konstin we currently are running into some issues which we believe are at least somewhat due to the version of <code>uv</code> bundled in <code>rye</code> so we're patiently waiting for https://github.com/astral-sh/rye/pull/1269 and then a <code>rye</code> release before further testing.</p>
<p>But we are using <code>universal = true</code> because our devs use Linux and Mac, and have a current issue with being unable to lock, and the error points to an issue with the Windows platform.</p>
<p>Some snippets from our <code>pyproject.toml</code>:</p>
<pre><code class="language-toml">[project]
...
dependencies = [
    &quot;langchain-text-splitters&quot;,
    &quot;psycopg2-binary&quot;,
    &quot;pypandoc&quot;,
    &quot;pyyaml&quot;,
    &quot;sqlalchemy&quot;,
    &quot;&lt;A private package&gt;&quot;
]
requires-python = &quot;&gt;= 3.12&quot;

[tool.rye]
universal = true
managed = true
generate-hashes = true
dev-dependencies = [
    &quot;coverage&quot;,
    &quot;pytest&quot;,
    &quot;pytest-cov&quot;,
    &quot;pytest-mock&quot;,
    &quot;refurb&quot;,
    &quot;&lt;A private package&gt;&quot;
]
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:31 UTC
    </footer>
</body>
</html>
