<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use async zip streaming for non-range-request supporting registries - astral-sh/uv #1596</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use async zip streaming for non-range-request supporting registries</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1596">#1596</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-02-17 15:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-17 15:27</div>
            <div class="timeline-body"><p>For registries that support range requests, we grab the wheel metadata using range requests, which is much faster than downloading the wheel.</p>
<p>For registries that don’t, we fall back to downloading the wheel, and reading the metadata from disk.</p>
<p>Instead, we should be able to stream the wheel in-memory until we get to the METADATA entry, then return it without writing to disk (and without downloading the entire wheel). I don’t know where the METDATA is typically located (e.g., if it’s at the front of the archive, this will be significantly faster; if it’s at the end, it won’t be that different).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-02-17 15:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-17 16:32</div>
            <div class="timeline-body"><p>Is this a wish or something we think we should do soon?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-17 18:35</div>
            <div class="timeline-body"><p>I'd like to do it soon since it does affect a lot of registries. I think I know how, I just need to find time to test it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-02-18 02:38</div>
            <div class="timeline-body"><p>btw, I think this is somewhat related work on Pip side: https://github.com/pypa/pip/pull/12208, or at least I think it's related.</p>
<p>I think the author has seen examples of metadata at both the front and back of the zip file.</p>
<p>Sorry if it's not actually that closely related, my mind was triggered from reading this and remembering that PR, but I only have time to skim over things.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">index</span> added by @zanieb on 2024-02-18 07:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-02-20 14:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1792.html">astral-sh/uv#1792</a> on 2024-02-21 03:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-21 03:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:56 UTC
    </footer>
</body>
</html>
