<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV updates one repository for each dependency - astral-sh/uv #11949</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>UV updates one repository for each dependency</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/11949">#11949</a>
        opened by <a href="https://github.com/Wintreist">@Wintreist</a>
        on 2025-03-04 14:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Wintreist">@Wintreist</a> on 2025-03-04 14:49</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>pyproject.toml:</p>
<pre><code>...
[tool.uv.sources]
lib_1 = { git = &quot;ssh://git@repo_1.git&quot;, branch = &quot;branch_1&quot; }
lib_2 = { git = &quot;ssh://git@repo_3.git&quot;, subdirectory = &quot;lib_2&quot;, branch = &quot;branch_2&quot; }
lib_3 = { git = &quot;ssh://git@repo_2.git&quot; }
lib_4 = { git = &quot;ssh://git@repo_3.git&quot;, subdirectory = &quot;lib_4&quot;, branch = &quot;branch_2&quot; }
lib_5 = { git = &quot;ssh://git@repo_3.git&quot;, subdirectory = &quot;lib_5&quot;, branch = &quot;branch_2&quot; }
lib_6 = { git = &quot;ssh://git@repo_3.git&quot;, subdirectory = &quot;lib_6&quot;, branch = &quot;branch_2&quot; }
lib_7 = { git = &quot;ssh://git@repo_3.git&quot;, subdirectory = &quot;lib_7&quot;, branch = &quot;branch_2&quot; }
</code></pre>
<p>Terminal:</p>
<pre><code>PS E:\my_repo&gt; uv sync -U --compile-bytecode
    Updated ssh://git@repo_1.git (eb3962c2f787c2b3720249e6d74dfe06f335fa4c)
    Updated ssh://git@repo_2.git (3a6fc4660888eb1a04ea85d9d03fd0c956685ec4)
    Updated ssh://git@repo_3.git (4844f61c4546abdd08abb624037c4948c2740c20)
    Updated ssh://git@repo_3.git (4844f61c4546abdd08abb624037c4948c2740c20)
    Updated ssh://git@repo_3.git (4844f61c4546abdd08abb624037c4948c2740c20)
    Updated ssh://git@repo_3.git (4844f61c4546abdd08abb624037c4948c2740c20)
    Updated ssh://git@repo_3.git (4844f61c4546abdd08abb624037c4948c2740c20)
    Updated ssh://git@repo_4.git (f6c189b3a5e7ddedb7fafc6093ceedfec9abc5c9)
Resolved 183 packages in 14.43s
</code></pre>
<p>After updating UV 0.6.2 to a higher version, an error occurred.
UV started updating repository &quot;repo_3&quot; for all dependencies in pyproject.toml, which are taken from &quot;repo_3&quot;
I have 5 libraries from &quot;repo_3&quot; and during the update, UV receives the latest commit from &quot;repo_3&quot; several times</p>
<h3>Platform</h3>
<p>Windows 10 x86_64</p>
<h3>Version</h3>
<p>uv 0.6.4</p>
<h3>Python version</h3>
<p>Python 3.12.2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @Wintreist on 2025-03-04 14:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-04 14:51</div>
            <div class="timeline-body"><p>What is the error?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wintreist">@Wintreist</a> on 2025-03-04 14:53</div>
            <div class="timeline-body"><blockquote>
<p>What is the error?</p>
</blockquote>
<p>UV updates the same git repository several times
It makes unnecessary updates because it has already received the last commit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-04 15:01</div>
            <div class="timeline-body"><p>That might be fine / correct. It doesn't mean it's pulling the repository. It just means it's ensuring that the commit is checked out locally.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Wintreist">@Wintreist</a> on 2025-03-04 15:03</div>
            <div class="timeline-body"><p>Understood, then I'm sorry. It wasn't obvious to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Wintreist on 2025-03-04 15:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-04 15:07</div>
            <div class="timeline-body"><p>No worries! Maybe think of it this way: we use a single clone of the repository under the hood. And in theory, you <em>could</em> have multiple dependencies that use that repository, but with different commits. So when we go to build each dependency, we need to double-check that we have the right commit checked out. If it's already checked out, it's very cheap.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:26 UTC
    </footer>
</body>
</html>
