<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv-build: add a config setting to control compression level - astral-sh/uv #13090</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv-build: add a config setting to control compression level</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13090">#13090</a>
        opened by <a href="https://github.com/mgorny">@mgorny</a>
        on 2025-04-24 14:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mgorny">@mgorny</a></div>
            <div class="timeline-body">Summary
<p>While the primary use case for PEP517 build backends is publishing packages for publishing, downstream maintainers are also forced to use them as part of distribution package build process. In this workflow, the built wheels are almost immediately unpacked/installed and discarded. Therefore, compression is not really necessary â€” usually it is just a waste of energy to compress something only to have to decompress it back.</p>
<p>In Gentoo, we usually work around the problem by patching the <code>zipfile</code> module to disable compression. However, that obviously works only for pure Python backends. Would you consider adding a <code>config_settings</code> option to override the compression level, so that we could disable compression on built wheels in order to save energy?</p>
Example
<p>I imagine we&#x27;d use it like:</p>
<pre><code>gpep517 build-wheel --output-fd 3 --wheel-dir dist --config-json &#x27;{ &quot;compression_level&quot;: 0 }&#x27;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/mgorny">@mgorny</a> on 2025-04-24 14:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-24 14:23</div>
            <div class="timeline-body"><p>Has compressing/decompressing are noticeable performance impact for you, what relative and absolute performance difference do you see?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mgorny">@mgorny</a> on 2025-04-24 15:02</div>
            <div class="timeline-body"><p>I don&#x27;t know because I haven&#x27;t seen any package use <code>uv-build</code> yet :-). I&#x27;m a perfectionist, though. I suppose I could try checking other Python backends (I suppose <code>zlib</code> would give close enough results) with some big Python packages like Django or ansible, but I&#x27;d have to find time when my CPUs aren&#x27;t all busy.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-24 15:06</div>
            <div class="timeline-body"><p>In this case I&#x27;d say we wait until we see adoption and get some real world numbers, if we see a noticeable overhead, we can add the option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-04 12:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:20 UTC
    </footer>
</body>
</html>
