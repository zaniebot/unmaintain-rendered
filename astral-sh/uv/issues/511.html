<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow override of dependencies - astral-sh/uv #511</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow override of dependencies</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/511">#511</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2023-11-28 21:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2023-11-28 21:47</div>
            <div class="timeline-body"><p>A user should be able to override the constraints of a package, ignoring transitive requirements that conflict.</p>
<p>This would, for example, allow &quot;force&quot; installation of a certain package version that the user <em>knows</em> works even if a dependency does not allow it.</p>
<p>Related https://github.com/mitsuhiko/rye/issues/505
Discussion at https://discord.com/channels/1039017663004942429/1148719284013510676/1164668058644795453</p>
<p>At its simplest, for a <code>pip-compile</code> interface, this could just be another file with package version specifiers e.g. <code>overrides.txt</code> that you can pass via an <code>--overrides</code> flag. An override for a package would be specified as in <code>requirements.txt</code> and <code>constraints.txt</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-28 21:52</div>
            <div class="timeline-body"><p>My intuition is that this isn't too hard to implement (it's very similar to constraints), with the hardest part being... how should it be expressed by the user?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-11-29 09:22</div>
            <div class="timeline-body"><h2>Prior Art</h2>
<p>Prior art in the JS ecosystem for overrides:</p>
<ul>
<li>Resolutions in yarn: https://classic.yarnpkg.com/lang/en/docs/selective-version-resolutions/</li>
<li>Overrides in pnpm: https://pnpm.io/package_json#pnpmoverrides</li>
<li>Rust: https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html</li>
</ul>
<p>Prior art in the JS ecosystem for patched dependencies:</p>
<ul>
<li>https://pnpm.io/package_json#pnpmpatcheddependencies</li>
<li>https://yarnpkg.com/cli/patch</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-11-29 09:28</div>
            <div class="timeline-body"><p>There are two options we should consider for overrides:</p>
<ul>
<li>Resolves this package at this version, ignore all requirements that say otherwise. This is easy to use, but dangerous because it doesn't consider changing requirements in dependencies</li>
<li>Replace the requirement on <code>foo==1.2.3</code> in <code>bar</code> with <code>foo==4.5.6</code>. With this, you say &quot;While <code>bar</code> wants <code>foo</code> <code>1.2.3</code>, i have confirmed that it is actually compatible with <code>foo</code> <code>4.5.6</code>, too&quot;. It requires more effort on the user side, but is less risky and gives good errors messages when new requirements on <code>foo</code> are added outside of <code>bar</code>.</li>
</ul>
<p>I believe both have their users.</p>
<p>Open question: Do we need to support overriding with multiple requirements (for different environments), or is a single requirement per package enough?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-29 14:48</div>
            <div class="timeline-body"><p>I think the second option is impossible without a more flexible dependency syntax.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-11-29 14:51</div>
            <div class="timeline-body"><p>I imagine something like the following for option 1:</p>
<pre><code class="language-toml">[tool.puffin.overrides-type-1]
foo = &quot;4.5.6&quot;
</code></pre>
<p>and for option 2:</p>
<pre><code class="language-toml">[tool.puffin.overrides-type-2]
bar = [&quot;foo==4.5.6&quot;]
</code></pre>
<p>This would take the set of bar's requirements, remove all with the name <code>foo</code> and add <code>foo==4.5.6</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-29 14:52</div>
            <div class="timeline-body"><p>Yeah, I more mean: we can't do that until we have our own <code>pyproject.toml</code>-based requirements syntax, whereas (1) we can do with just an <code>overrides.txt</code> that uses<code> requirements.txt</code>-like syntax.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2023-11-30 01:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Initial release" by @charliermarsh on 2023-11-30 01:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-12-13 03:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-13 03:52</div>
            <div class="timeline-body"><p>Gonna do a pass on this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/631.html">astral-sh/uv#631</a> on 2023-12-13 05:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2023-12-13 15:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2686.html">astral-sh/uv#2686</a> on 2024-03-27 05:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aidando73">@aidando73</a> on 2025-03-31 10:05</div>
            <div class="timeline-body"><p>Hello all. Thanks for implementing this.</p>
<p>It just came in handy today. I needed a specific pytorch version to leverage special networking hardware for LLM training but one of my packages wanted a different version.</p>
<p>Thanks üôè</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:20 UTC
    </footer>
</body>
</html>
