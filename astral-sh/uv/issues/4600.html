<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fails to install detectron2 package from git - astral-sh/uv #4600</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Fails to install detectron2 package from git</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/4600">#4600</a>
        opened by <a href="https://github.com/alfa07">@alfa07</a>
        on 2024-06-27 19:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/alfa07">@alfa07</a> on 2024-06-27 19:51</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<pre><code> ❯ uv pip install -r requirements-2.txt
 Updated https://github.com/facebookresearch/detectron2.git (e2ce8dc)
error: Failed to download and build: `detectron2 @ git+https://github.com/facebookresearch/detectron2.git@e2ce8dc#egg=detectron2`
  Caused by: Failed to build: `detectron2 @ git+https://github.com/facebookresearch/detectron2.git@e2ce8dc#egg=detectron2`
  Caused by: Build backend failed to determine extra requires with `build_wheel()` with exit status: 1
--- stdout:

--- stderr:
Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 14, in &lt;module&gt;
  File &quot;/Users/maxim/Library/Caches/uv/environments-v0/.tmpOkCWJn/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 327, in get_requires_for_build_wheel
    return self._get_build_requires(config_settings, requirements=[])
  File &quot;/Users/maxim/Library/Caches/uv/environments-v0/.tmpOkCWJn/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 297, in _get_build_requires
    self.run_setup()
  File &quot;/Users/maxim/Library/Caches/uv/environments-v0/.tmpOkCWJn/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 497, in run_setup
    super().run_setup(setup_script=setup_script)
  File &quot;/Users/maxim/Library/Caches/uv/environments-v0/.tmpOkCWJn/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 313, in run_setup
    exec(code, locals())
  File &quot;&lt;string&gt;&quot;, line 10, in &lt;module&gt;
ModuleNotFoundError: No module named 'torch'
</code></pre>
<p>torch is already installed:</p>
<pre><code> ❯ uv pip list | rg torch
torch                      2.3.1
torchvision                0.18.1
</code></pre>
<p>uv version:</p>
<pre><code> ❯ uv --version
uv 0.2.17
</code></pre>
<p>python version:</p>
<pre><code>❯ python --version
Python 3.10.11
</code></pre>
<p>requirements-2.txt:</p>
<pre><code>detectron2@git+https://github.com/facebookresearch/detectron2.git@e2ce8dc#egg=detectron2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-27 19:55</div>
            <div class="timeline-body"><p>It looks like you need to run with <code>--no-build-isolation</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-06-27 19:56</div>
            <div class="timeline-body"><p>(<code>detectron2</code> doesn't declare <code>torch</code> as a build-time dependency, so you're responsible for installing it ahead-of-time and then disabling build dependencies entirely.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-27 19:59</div>
            <div class="timeline-body"><p>See also #2252</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alfa07">@alfa07</a> on 2024-06-28 03:48</div>
            <div class="timeline-body"><p>Thank you! The project is amazing - I do hope we will get rust like experience in python - that would be awesome. The <code>--no-build-isolation</code> flag works!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alfa07">@alfa07</a> on 2024-06-28 03:49</div>
            <div class="timeline-body"><p>It looks like it is an issue with detectron2 as mentioned in #2252 - closing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @alfa07 on 2024-06-28 03:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/4685.html">astral-sh/uv#4685</a> on 2024-07-01 09:59</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:20 UTC
    </footer>
</body>
</html>
