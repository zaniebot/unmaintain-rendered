```yaml
number: 15878
title: "Set `UV_CACHE_DIR` for different drives"
type: issue
state: open
author: 5hayanB
labels:
  - enhancement
  - needs-design
assignees: []
created_at: 2025-09-15T16:33:17Z
updated_at: 2025-09-15T16:46:14Z
url: https://github.com/astral-sh/uv/issues/15878
synced_at: 2026-01-10T01:57:35Z
```

# Set `UV_CACHE_DIR` for different drives

---

_Issue opened by @5hayanB on 2025-09-15 16:33_

### Summary

I have a drive mounted at `/mnt` while the default `uv` cache directory is at `~/.cache/uv`. I was installing `pytest` at the `/mnt` mounted drive but was met with the following warning.
```
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
```
I stumbled on [this issue](https://github.com/astral-sh/uv/issues/7285) and saw the [recommended approach](https://github.com/astral-sh/uv/issues/7285#issuecomment-2910917037). It would be a convenient feature to set individual `uv` cache directory for each mounted drive without having to export the `UV_CACHE_DIR` env variable or passing the `--cache-dir` option to an invocation command every time. I think it could be implemented by adding entries of the cache directories for each drive in the user or system level configuration files (i.e. `~/.config/uv/uv.toml` or `/etc/uv/uv.toml`).

### Example

Invoking a `uv pip install pytest` on a different drive will not show the following error.
```
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
```
`uv` would search the user or system level configuration file for an entry of a cache directory for the drive it is being invoked in and use that directory for its cache related usage.

### Before
```
❯ uv pip install pytest
Resolved 5 packages in 119ms
░░░░░░░░░░░░░░░░░░░░ [0/5] Installing wheels...                                                                                                                                                                      warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 5 packages in 52ms
 + iniconfig==2.1.0
 + packaging==25.0
 + pluggy==1.6.0
 + pygments==2.19.2
 + pytest==8.4.2
```

### After
```
❯ uv pip install pytest
Resolved 5 packages in 250ms
Prepared 5 packages in 282ms
Installed 5 packages in 8ms
 + iniconfig==2.1.0
 + packaging==25.0
 + pluggy==1.6.0
 + pygments==2.19.2
 + pytest==8.4.2
```

---

_Label `enhancement` added by @5hayanB on 2025-09-15 16:33_

---

_Comment by @zanieb on 2025-09-15 16:46_

The trick will be coming up with a reasonable scheme for configuring this. I think we want to map some prefix path to a cache path, e.g., `UV_CACHE_DIR=/mnt/foo=/mnt/foo/.cache,/mnt/bar=/mnt/bar/.cache`.

---

_Label `needs-design` added by @zanieb on 2025-09-15 16:46_

---
