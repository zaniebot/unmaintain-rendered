<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip compile: include package name prefix in URL dependencies - astral-sh/uv #15988</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>uv pip compile: include package name prefix in URL dependencies</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/15988">#15988</a>
        opened by <a href="https://github.com/tboddyspargo">@tboddyspargo</a>
        on 2025-09-22 16:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/tboddyspargo">@tboddyspargo</a> on 2025-09-22 16:48</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I'm hoping it might be reasonable to ensure that if my input requirements contain:</p>
<pre><code># requirements.in
my_package @ file://../my_package
</code></pre>
<p>That <code>uv</code> supports the corresponding output <code>.txt</code> file entry to look like:</p>
<pre><code># requirements.txt
my_package @ ../my_package
</code></pre>
<p>The current behavior omits the <code>my_package @ </code> prefix producing a result that includes an &quot;unnamed&quot; URL dependency (which is something that will be rejected when used as a constraints file, for example: <code>error: Unnamed requirements are not allowed as constraints</code>).</p>
<h3>Example</h3>
<p>My specific use-case involves wanting to use my <code>requirements.txt</code> file output from <code>uv pip compile</code> as a constraints file.</p>
<pre><code>UV_CONSTRAINTS=requirements.txt uv pip compile dev-requirements.in -o dev-requirements.txt
</code></pre>
<p>But the current behavior of <code>uv pip compile</code> produces a <code>.txt</code> file that, when used as a constraints file, results in:</p>
<pre><code>error: Unnamed requirements are not allowed as constraints
</code></pre>
<p>Currently, I have to work around this behavior either by making post-hoc modifications to the requirements.txt file to ensure that the <code>my_package @ </code> part is included before trying to use it as a constraint file OR to separate out my input files so that my constraint requirements file can be created from a subset that doesn't include the URL (local file) dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @tboddyspargo on 2025-09-22 16:48</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-22 17:05</div>
            <div class="timeline-body"><p>This seems reasonable to me. I want to double check with @charliermarsh though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-09-22 17:56</div>
            <div class="timeline-body"><p>I believe this exists for <code>pip</code> compatibility -- pip does not support relative paths like that (<code>my_package @ ../my_package</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-22 18:28</div>
            <div class="timeline-body"><p>Ah, that'd be a blocker then. I could get behind an opt-in <code>--emit-...</code> flag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/carl-mastrangelo">@carl-mastrangelo</a> on 2025-10-01 23:43</div>
            <div class="timeline-body"><p>Our team also has this issue (but without the url <code>file://</code> portion).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mattjreynolds">@mattjreynolds</a> on 2025-11-03 15:21</div>
            <div class="timeline-body"><p>We ran into this same issue using relative paths to another <code>pyproject.toml</code>:</p>
<p>In case it's helpful for others, the workaround solution I came up with was to exclude the relative package from the output when creating the constraints file. If you're using a relative path, then usually you have other system in place to ensure that the versions match (like version control via git etc), so it's ok if that package is missing from the constraints file.</p>
<p>e.g <code>extra/pyproject.toml</code> with a relative path to a dependency that's installed using <code>core/pyproject.toml</code>:</p>
<pre><code>[project]
name = &quot;extra-project&quot;
version = &quot;0.1.0&quot;
dependencies = [
    &quot;other-dependency==1.2.3&quot;,
    &quot;core-project&quot;,
]

[tool.uv.sources]
core-project = { path = &quot;../core&quot; }
</code></pre>
<p><code>uv pip compile extra/pyproject.toml -o extra/constraints.txt --no-emit-package core-project</code></p>
<p>This will generate a <code>constraints.txt</code> with all dependencies (and dependencies of dependencies) for both <code>extra-project</code> and <code>core-project</code>, but it won't include the offending line for <code>core-project</code> that would break <code>uv pip install ./extra -c extra/constraints.txt</code>. This works because the <code>extra/pyproject.toml</code> is used to resolve <code>core-project</code> and it's dependencies, so it still gets installed, it's just not constrained to a specific version because it's not included in the <code>constraints.txt</code></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:29 UTC
    </footer>
</body>
</html>
