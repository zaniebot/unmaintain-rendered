<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dependency resolution failure: `numba` on `scikit-gstat` + `numpy&gt;=2` - astral-sh/uv #17338</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Dependency resolution failure: <code>numba</code> on <code>scikit-gstat</code> + <code>numpy&gt;=2</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/17338">#17338</a>
        opened by <a href="https://github.com/phistep">@phistep</a>
        on 2026-01-06 17:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/phistep">@phistep</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Given the following <code>pyproject.toml</code></p>
<pre><code class="language-toml">[build-system]
requires = [&quot;setuptools &gt;= 65&quot;, &quot;wheel&quot;]
build-backend = &quot;setuptools.build_meta&quot;

[project]
name = &quot;uv-resolution-bug-demo&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.13&quot;
description = &quot;Minimal example demonstrating uv dependency resolution issue&quot;
dependencies = [
    &quot;numpy&gt;=2&quot;,
    &quot;scikit-gstat&quot;,
]

# [tool.uv]
# constraint-dependencies = [&quot;numba&gt;=0.63.1&quot;]
</code></pre>
<p><code>uv</code> will fail to rsolve the dependencies:</p>
<pre><code>⁂  uv sync
Using CPython 3.13.11 interpreter at: /usr/bin/python3
Creating virtual environment at: .venv
Resolved 26 packages in 1.47s
  × Failed to build `llvmlite==0.36.0`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_wheel` failed (exit
      status: 1)

      [stderr]
      Traceback (most recent call last):
        File &quot;&lt;string&gt;&quot;, line 14, in &lt;module&gt;
          requires = get_requires_for_build({})
        File
      &quot;/home/philippstephan/.cache/uv/builds-v0/.tmp1XaIjO/lib64/python3.13/site-packages/setuptools/build_meta.py&quot;,
      line 331, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[])
                 ~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File
      &quot;/home/philippstephan/.cache/uv/builds-v0/.tmp1XaIjO/lib64/python3.13/site-packages/setuptools/build_meta.py&quot;,
      line 301, in _get_build_requires
          self.run_setup()
          ~~~~~~~~~~~~~~^^
        File
      &quot;/home/philippstephan/.cache/uv/builds-v0/.tmp1XaIjO/lib64/python3.13/site-packages/setuptools/build_meta.py&quot;,
      line 512, in run_setup
          super().run_setup(setup_script=setup_script)
          ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File
      &quot;/home/philippstephan/.cache/uv/builds-v0/.tmp1XaIjO/lib64/python3.13/site-packages/setuptools/build_meta.py&quot;,
      line 317, in run_setup
          exec(code, locals())
          ~~~~^^^^^^^^^^^^^^^^
        File &quot;&lt;string&gt;&quot;, line 55, in &lt;module&gt;
        File &quot;&lt;string&gt;&quot;, line 52, in _guard_py_ver
      RuntimeError: Cannot install on Python version 3.13.11; only versions
      &gt;=3.6,&lt;3.10 are supported.

      hint: This usually indicates a problem with the package or the build
      environment.
  help: `llvmlite` (v0.36.0) was included because `uv-resolution-bug-demo`
        (v0.1.0) depends on `scikit-gstat` (v1.0.22) which depends on `numba`
        (v0.53.1) which depends on `llvmlite`
zsh: exit 1     uv sync
</code></pre>
<p>But first installing <code>numba</code> manually without constraint or uncommenting the constraint will lead to a successful resoution</p>
<pre><code>⁂  uv sync
Using CPython 3.13.11 interpreter at: /usr/bin/python3
Creating virtual environment at: .venv
Resolved 26 packages in 19ms
      Built uv-resolution-bug-demo @ file:///tmp/uv-resolution-bug
Prepared 25 packages in 774ms
░░░░░░░░░░░░░░░░░░░░ [0/25] Installing wheels...                                warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 25 packages in 125ms
 + contourpy==1.3.3
 + cycler==0.12.1
 + fonttools==4.61.1
 + imageio==2.37.2
 + joblib==1.5.3
 + kiwisolver==1.4.9
 + llvmlite==0.46.0
 + matplotlib==3.10.8
 + numba==0.63.1
 + numpy==2.3.5
 + packaging==25.0
 + pandas==2.3.3
 + pillow==12.1.0
 + pyparsing==3.3.1
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + scikit-gstat==1.0.22
 + scikit-learn==1.8.0
 + scipy==1.16.3
 + setuptools==80.9.0
 + six==1.17.0
 + threadpoolctl==3.6.0
 + tqdm==4.67.1
 + tzdata==2025.3
 + uv-resolution-bug-demo==0.1.0 (from file:///tmp/uv-resolution-bug)
</code></pre>
<p>Since <code>scikit-gstat</code> does not impose any version requirements on <code>numpy</code> or <code>numba</code>, I believe this to be a bug.</p>
<pre><code>⁂  uv pip show scikit-gstat
Name: scikit-gstat
Version: 1.0.22
Location: /tmp/uv-resolution-bug/.venv/lib/python3.13/site-packages
Requires: imageio, matplotlib, numba, numpy, pandas, scikit-learn, scipy, setuptools, tqdm
Required-by: uv-resolution-bug-demo
</code></pre>
<p>https://github.com/mmaelicke/scikit-gstat/blob/v1.0.22/requirements.txt</p>
<h3>Platform</h3>
<p><code>Linux 6.17.13-200.fc42.x86_64 x86_64 GNU/Linux</code></p>
<h3>Version</h3>
<p><code>uv 0.9.21</code></p>
<h3>Python version</h3>
<p><code>Python 3.13.11</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @phistep on 2026-01-06 17:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2026-01-06 18:28</div>
            <div class="timeline-body"><p>This is a duplicate of https://github.com/astral-sh/uv/issues/12060#issuecomment-2710047557.</p>
<p>The best solution would be scikit-gstat adding lower bounds to its dependencies, which prevents catastrophic backtracking as we see here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2026-01-06 18:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:33:48 UTC
    </footer>
</body>
</html>
