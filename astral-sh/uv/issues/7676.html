<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request - uv publish recognizes .pypirc file - astral-sh/uv #7676</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request - uv publish recognizes .pypirc file</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/7676">#7676</a>
        opened by <a href="https://github.com/geozeke">@geozeke</a>
        on 2024-09-24 21:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/geozeke">@geozeke</a> on 2024-09-24 21:44</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>Thanks soooooooo much for the work on this amazing tool! I'm in the process of migrating the toolchain for all my Python projects to uv &amp; ruff!</p>
<p>The recently-released <code>publish</code> command is a really welcome addition. When I run it, it's listed as &quot;experimental&quot;, so I'm hoping there's still an opportunity for input on the feature. Definitely not an urgent feature need, but It would be great if <code>publish</code> recognized the <code>.pypirc</code> toml file, as specified in the <a href="https://packaging.python.org/en/latest/specifications/pypirc/">Python Packaging User Guide</a>. Namely:</p>
<pre><code class="language-toml">[distutils]
index-servers =
    pypi
    testpypi
    private-repository

[pypi]
username = __token__
password = &lt;PyPI token&gt;

[testpypi]
username = __token__
password = &lt;TestPyPI token&gt;

[private-repository]
repository = &lt;private-repository URL&gt;
username = &lt;private-repository username&gt;
password = &lt;private-repository password&gt;
</code></pre>
<p>This would be like <code>twine</code>, but maybe add a new <code>-r, --repository</code> option that takes the shorthand name from the index servers listed in <code>.pypirc</code>. In that case, with a properly-configured <code>.pypirc</code> file like the one above in the user's home directory, publishing would be handled something like this:</p>
<p>To publish to <code>pypi</code> (the default), enter:</p>
<pre><code class="language-shell">uv publish
</code></pre>
<p>To publish to <code>test.pypi</code>, enter:</p>
<pre><code class="language-shell">uv publish -r testpypi
</code></pre>
<p>Private repos/others look like this:</p>
<pre><code class="language-shell">uv publish -r private-repository
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-24 22:03</div>
            <div class="timeline-body"><p>I guess we probably should since it's a standardized file though it seems a bit behind-the-times as there are several warnings suggesting alternative methods for authentication. It's also weird that it has a <code>[distutils]</code> section. We're generally very hesitant to read from other tool's configuration i.e. https://github.com/astral-sh/uv/issues/1404</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geozeke">@geozeke</a> on 2024-09-24 22:07</div>
            <div class="timeline-body"><p>Fair points. Definitely an only-if-it-makes-sense feature request ðŸ˜Š</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-24 22:09</div>
            <div class="timeline-body"><p>I'm actually not sure this is a standard it might just be recommended by the PyPA? I'll follow up on that.</p>
<p>Added to the guide in https://github.com/pypa/packaging.python.org/pull/734 and it looks like twine just used distutils to parse it originally per https://github.com/pypa/twine/pull/15</p>
<p>There's an open pull request from 2017 that updates the guide to discourage use of pypirc? https://github.com/pypa/packaging.python.org/issues/297</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geozeke">@geozeke</a> on 2024-09-24 22:31</div>
            <div class="timeline-body"><p>Thanks for the link. Interesting conversation in the PR from 2017. Some talk of keyring support being a little &quot;flaky&quot; on linux [at that time], so maybe <code>.pypirc</code> use was kept around. Much has changed since then, so maybe its use is considered legacy at this point.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @zanieb on 2024-09-24 22:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @zanieb on 2024-09-24 22:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/raayu83">@raayu83</a> on 2024-09-25 07:09</div>
            <div class="timeline-body"><p>I think support for <code>.pypirc</code> would still be useful.
There are people who work in environments where <code>.pypirc</code> is set up automatically in the CI/CD environment and changing that to support new authentication methods would take some time and need to be prioritized first.
Therefore I believe supporting <code>.pypirc</code> would help increase adoption of uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bulletmark">@bulletmark</a> on 2024-09-25 10:42</div>
            <div class="timeline-body"><p>I created a wrapper for this: https://github.com/bulletmark/uv-publish.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../langflow-ai/langflow/pulls/3919.html">langflow-ai/langflow#3919</a> on 2024-09-26 23:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cthoyt">@cthoyt</a> on 2024-09-27 07:15</div>
            <div class="timeline-body"><p>Big agree on this! My workflow uses <code>twine upload --skip-existing dist/*</code> locally and relies on the <code>.pypirc</code> file. I'm very excited to replace this with <code>uv publish</code> if it doesn't require me having to reengineer my local environment.</p>
<p>The other benefit of the config file is it lets you keep track of multiple indexâ€™s credentials</p>
<p>(yes, I know that everyone is moving over to using trusted publishing, but I'm not ready for that yet)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/7963.html">astral-sh/uv#7963</a> on 2024-10-07 09:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8352.html">astral-sh/uv#8352</a> on 2024-10-19 07:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Feature Request - vu publish recognizes .pypirc file" to "Feature Request - uv publish recognizes .pypirc file" by @konstin on 2024-11-03 17:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/8806.html">astral-sh/uv#8806</a> on 2024-11-04 20:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spapanik">@spapanik</a> on 2025-01-15 14:54</div>
            <div class="timeline-body"><p>My 2p: The .pypirc is extremely annoying that uses the distutils name, and the format is outdated, as [pypi] doesn't even accept a username anymore. But copying and pasting the token is not great, and also having tokens in env vars is not generally recommended (for example the Postgres documentation has this about the PGPASSWORD variable: PGPASSWORD behaves the same as the <a href="https://www.postgresql.org/docs/17/libpq-connect.html#LIBPQ-CONNECT-PASSWORD">password</a> connection parameter. Use of this environment variable is not recommended for security reasons, as some operating systems allow non-root users to see process environment variables via ps; instead consider using a password file)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eriktaubeneck">@eriktaubeneck</a> on 2025-03-25 19:16</div>
            <div class="timeline-body"><p>The hesitation to rely on the <code>.pypirc</code> is reasonable. In the meantime, would it be possible to allow these to be included in the <code>uv.toml</code> config file?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jhadida">@jhadida</a> on 2025-04-09 03:42</div>
            <div class="timeline-body"><p>An equivalent of <code>.pypirc</code> would be very useful, I agree with @cthoyt.</p>
<p>It doesn't have to follow the exact same format, but IMO it should not be a <code>uv.toml</code> setting unless it could keep track of multiple indexes. Even then it would still feel clumsy because credentials for these different indexes would need to be stored somewhere else.</p>
<p>The change of authentication for publishing over time is not an issue I think. The <code>username</code> and <code>password</code> properties will become obsolete over time, and they can simply be replaced by new properties like <code>token</code> or whatever else is needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hemna">@hemna</a> on 2025-08-13 01:35</div>
            <div class="timeline-body"><p>Just ran into this problem trying to publish for the first time with uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/frobnitzem">@frobnitzem</a> on 2025-10-29 13:15</div>
            <div class="timeline-body"><p>I worked around this with a custom make rule:</p>
<pre><code>publish: build ## Publish to pypi
    @echo &quot;ðŸš€ Publishing project&quot;
    $(eval user := $(shell sed -ne 's/username *= *//p' $(HOME)/.pypirc))
    $(eval pass := $(shell sed -ne 's/password *= *//p' $(HOME)/.pypirc))
    uv run --isolated --no-project --with dist/*.whl tests/smoke_test.py
    uv run --isolated --no-project --with dist/*.tar.gz tests/smoke_test.py
    uv publish -u $(user) -p $(pass)

.PHONY: build
build: clean-build ## Build wheel file
    @echo &quot;ðŸš€ Creating wheel file&quot;
    uv build

.PHONY: clean-build
clean-build: ## Clean build artifacts
    @echo &quot;ðŸš€ Removing build artifacts&quot;
    uv run python -c &quot;import shutil; import os; shutil.rmtree('dist') if os.path.exists('dist') else None&quot;
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:55 UTC
    </footer>
</body>
</html>
