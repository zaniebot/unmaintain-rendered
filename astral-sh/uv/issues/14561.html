<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build/Metadata Hook - astral-sh/uv #14561</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Build/Metadata Hook</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/14561">#14561</a>
        opened by <a href="https://github.com/ninoseki">@ninoseki</a>
        on 2025-07-11 10:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ninoseki">@ninoseki</a> on 2025-07-11 10:00</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I think it would be better if uv's build backend had the same hooks as Hatch. The build hook and the metadata hook.
Could you consider support them in the build backend, please?</p>
<h3>Example</h3>
<ul>
<li>Build hook: https://hatch.pypa.io/1.1/plugins/build-hook/</li>
<li>Metadata hook: https://hatch.pypa.io/1.1/plugins/metadata-hook/</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @ninoseki on 2025-07-11 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-11 13:05</div>
            <div class="timeline-body"><p>Plugins and dynamic metadata aren't in scope for the build backend yet, they add a lot of complexity.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @zanieb on 2025-07-11 13:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-11 13:05</div>
            <div class="timeline-body"><p>Can you share more about your use-case?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ninoseki">@ninoseki</a> on 2025-07-11 23:02</div>
            <div class="timeline-body"><blockquote>
<p>Can you share more about your use-case?</p>
</blockquote>
<ul>
<li>Build hook use-cases:<ul>
<li>Setting a version based on VCS:<ul>
<li>https://github.com/ofek/hatch-vcs?#build-hook (<a href="https://github.com/search?q=%22tool.hatch.build.hooks.vcs%22%20path%3Apyproject.toml&amp;type=code">2.3k files</a>)</li>
<li>https://github.com/ninoseki/uv-dynamic-versioning/blob/main/docs/version_source.md  (<a href="https://github.com/search?q=%22uv-dynamic-versioning%22+AND+%22tool.hatch.version%22+path%3Apyproject.toml&amp;type=code">0.5k files</a>)</li>
</ul>
</li>
</ul>
</li>
<li>Metadata hook use-cases:<ul>
<li>Setting dependencies based on requirements.txt:<ul>
<li>https://github.com/repo-helper/hatch-requirements-txt (<a href="https://github.com/search?q=%22tool.hatch.metadata.hooks.requirements_txt%22++path%3Apyproject.toml&amp;type=code">0.5k files</a>)</li>
</ul>
</li>
<li>Setting dependencies dynamically based on VCS:<ul>
<li>https://github.com/ninoseki/uv-dynamic-versioning/blob/main/docs/metadata_hook.md:<ul>
<li>It's used by a very few projects. But a popular project like <a href="https://github.com/pydantic/pydantic-ai/blob/2b7899b6af5fb420a7988941df52a6f4f65788c8/clai/pyproject.toml#L48-L51">Pydantic AI uses this</a>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matdibu">@matdibu</a> on 2025-07-23 09:24</div>
            <div class="timeline-body"><p>I'm currently using Hatch in a lot of projects exclusively for codegen (grpcio-tools) via <code>tool.hatch.build.hooks.custom</code></p>
<p>is this something that the <code>uv_build</code> backend is going to provide at some point in the future? thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../marimo-team/marimo/pulls/5778.html">marimo-team/marimo#5778</a> on 2025-07-28 03:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gwdekker">@gwdekker</a> on 2025-08-19 06:57</div>
            <div class="timeline-body"><p>Another usecase is for <code>polylith</code> - a monorepo tool for python. The <code>hatch</code> based build backend allows for letting it hook into the build process, while not having hooks available makes it need the workaround doucmented in the polylith docs for <code>maturin</code>: https://github.com/DavidVujic/python-polylith/discussions/353</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brant-qai">@brant-qai</a> on 2025-08-25 15:33</div>
            <div class="timeline-body"><p>The dynamic versioning in particular is a very common use case. I have to either use hatch+uv-dynamic-versioning or setuptools+setuptools_scm and the only reason I'm still making use of those backends at all is dynamic versioning.</p>
<p>The most <strong>fire</strong> would be for dynamic versioning from VCS to be builtin to UV; that would really give it that one-stop-shop feel (the same way <code>uv format</code> utilizing ruff under the hood does. I prefer not to manage a big suite of extra tools.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/twsl">@twsl</a> on 2025-08-27 13:02</div>
            <div class="timeline-body"><p>Missing support for dynamic versioning is the only reason preventing me from switching away from poetry. Would love to see a build hook</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ninoseki">@ninoseki</a> on 2025-08-28 02:06</div>
            <div class="timeline-body"><blockquote>
<p>Missing support for dynamic versioning is the only reason preventing me from switching away from poetry.</p>
</blockquote>
<p>ICYMI uv can handle it already along with Hatchling build backend.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pygarap">@pygarap</a> on 2025-08-28 02:11</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Missing support for dynamic versioning is the only reason preventing me from switching away from poetry.</p>
</blockquote>
<p>ICYMI uv can handle it already along with Hatchling build backend.</p>
</blockquote>
<p>@ninoseki People want to use dynamic-versioning, together with the <a href="https://docs.astral.sh/uv/concepts/build-backend">uv build backend</a>, not with any other build backend.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/16011.html">astral-sh/uv#16011</a> on 2025-09-24 09:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/etienne-monier">@etienne-monier</a> on 2025-10-20 11:44</div>
            <div class="timeline-body"><p>Hi,
Another use case: I need to build a javascript bundle to be served by my fastapi application. This is done at build time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aaron-siegel">@aaron-siegel</a> on 2025-10-26 17:09</div>
            <div class="timeline-body"><p>Just chiming in here, we're currently using uv/hatch with dynamic versioning and it's hard to imagine life without it. (Thanks @ninoseki ; it made the move away from poetry a lot more palatable!)</p>
<p>I'd consider dynamic versioning support to be &quot;table stakes&quot; for us to consider any new build system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/villapx-path">@villapx-path</a> on 2025-11-14 17:00</div>
            <div class="timeline-body"><p>Our use case is that we have protobuf files (<code>*.proto</code>) that we want to compile into Python modules during the build, so that when clients install the package or during editable installs within a <code>uv</code> workspace, there is not an extra, manual step required to call <code>grpc_tools.protoc</code>. We needed to switch to hatchling for all of these packages within our workspace containing protobuf messages (we still use <code>uv_build</code> for all other packages in the workspace).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../IndicoDataSolutions/indico-client-python/pulls/412.html">IndicoDataSolutions/indico-client-python#412</a> on 2025-12-09 18:53</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:28 UTC
    </footer>
</body>
</html>
