```yaml
number: 3011
title: "`uv install -r …` fails with comment in `-e ./local_package   # via other_package`"
type: issue
state: closed
author: PeterW-LWL
labels:
  - bug
assignees: []
created_at: 2024-04-12T08:12:52Z
updated_at: 2024-04-12T19:56:59Z
url: https://github.com/astral-sh/uv/issues/3011
synced_at: 2026-01-10T05:40:32Z
```

# `uv install -r …` fails with comment in `-e ./local_package   # via other_package`

---

_Issue opened by @PeterW-LWL on 2024-04-12 08:12_

## The Problem

Running `uv pip install -r requirements.txt -v` failes with error code 2 and the following output:

```
INFO Found a virtualenv through VIRTUAL_ENV at: [workspace]/.venv
DEBUG Cached interpreter info for Python 3.12.2, skipping probing: .venv/bin/python
DEBUG Using Python 3.12.2 environment at .venv/bin/python
DEBUG Trying to lock if free: .venv/.lock
DEBUG Using registry request timeout of 300s
DEBUG Building (editable) file://[workspace]/lwl_inclusive_plugins
DEBUG Solving with target Python version 3.12.2
DEBUG Adding direct dependency: setuptools>=40.8.0
DEBUG Building (editable) file://[workspace]/local_package_2%20%20%20%20%20%20#%20via%20local_package_1
error: Failed to build editables
  Caused by: Source distribution not found at: [workspace]/local_package_2
```

The `requirements.txt` looks like this:

```
# This file was autogenerated by uv via the following command:
#    uv pip compile --annotation-style=line --output-file=requirements.txt requirements.in
-e ./local_package_1
-e ./local_package_2      # via local_package_1
```

## The possible solution

Removing the comment in the last line of the `requirements.txt` fixes the problem.

```
# This file was autogenerated by uv via the following command:
#    uv pip compile --annotation-style=line --output-file=requirements.txt requirements.in
-e ./local_package_1
-e ./local_package_2
```
The `uv pip compile` command will regenerate this comment (as there is a dependency from `local_package_1` to `local_package_2`.

`uv pip install -r …` should ignore the comment not just for normal lines like
```
django==5.0.3             # via django-cms
```
but also for lines starting the `-e`

## Global information

Platform
- macOS 13.4.1
- Chip Apple M2 Pro (arm64)

```sh
> uv --version
uv 0.1.31 (7bcca28b1 2024-04-09)
```

---

_Renamed from "`uv install -r req….txt` fails with comment in `-e .local_package   # via other_package`" to "`uv install -r …` fails with comment in `-e ./local_package   # via other_package`" by @PeterW-LWL on 2024-04-12 08:13_

---

_Comment by @charliermarsh on 2024-04-12 14:06_

Oh interesting, will take a look...

---

_Assigned to @charliermarsh by @charliermarsh on 2024-04-12 14:06_

---

_Label `bug` added by @charliermarsh on 2024-04-12 14:31_

---

_Closed by @charliermarsh on 2024-04-12 19:56_

---
