<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Build backend failed to build wheel through `build_wheel()` - wrong architecture - astral-sh/uv #3308</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Build backend failed to build wheel through <code>build_wheel()</code> - wrong architecture</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/3308">#3308</a>
        opened by <a href="https://github.com/CatamountJack">@CatamountJack</a>
        on 2024-04-29 13:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/CatamountJack">@CatamountJack</a></div>
            <div class="timeline-body"><p>Using <code>uv</code> (via <code>rye</code>), it can&#x27;t create x86 wheels for (some) dependencies on my x64 machine.</p>
<p>I created my project with Python 3.12.2 x64 and all worked well, but I wanted to build a 32-bit executable.  In rye, I set my <code>.python-version</code> to <code>cpython-x86@3.12.2</code> and then ran <code>rye sync</code>.  This worked great on a different project, but the current project depends on <code>pandas</code> and it&#x27;s choking while trying to build a wheel for that.</p>
<p>uv version:  <code>uv 0.1.37 (645d0399f 2024-04-23)</code></p>
<p>rye version:</p>
<pre><code>commit: 0.33.0 (58523f69f 2024-04-24)
platform: windows (x86_64)
self-python: cpython@3.12.2
symlink support: true
uv enabled: true
</code></pre>
<p>Platform:  <code>Windows 11 Pro 23H2 on x64</code></p>
<p>Traceback:</p>
<pre><code>error: Failed to download distributions
  Caused by: Failed to fetch wheel: pandas==2.2.1
  Caused by: Failed to build: `pandas==2.2.1`
  Caused by: Build backend failed to build wheel through `build_wheel()` with exit code: 1
--- stdout:
+ meson setup C:\Users\abcdefg\AppData\Local\uv\cache\built-wheels-v3\index\b2a7eb67d4c26b82\pandas\2.2.1\mKNob4WeHbOZ108PaIHLq\pandas-2.2.1.tar.gz C:\Users\abcdefg\AppData\Local\uv\cach
e\built-wheels-v3\index\b2a7eb67d4c26b82\pandas\2.2.1\mKNob4WeHbOZ108PaIHLq\pandas-2.2.1.tar.gz\.mesonpy-jm3uwz41\build -Dbuildtype=release -Db_ndebug=if-release -Db_vscrt=md --vsenv
 --native-file=C:\Users\abcdefg\AppData\Local\uv\cache\built-wheels-v3\index\b2a7eb67d4c26b82\pandas\2.2.1\mKNob4WeHbOZ108PaIHLq\pandas-2.2.1.tar.gz\.mesonpy-jm3uwz41\build\meson-python-native-file.ini
The Meson build system
Version: 1.2.1
Source dir: C:\Users\abcdefg\AppData\Local\uv\cache\built-wheels-v3\index\b2a7eb67d4c26b82\pandas\2.2.1\mKNob4WeHbOZ108PaIHLq\pandas-2.2.1.tar.gz
Build dir: C:\Users\abcdefg\AppData\Local\uv\cache\built-wheels-v3\index\b2a7eb67d4c26b82\pandas\2.2.1\mKNob4WeHbOZ108PaIHLq\pandas-2.2.1.tar.gz\.mesonpy-jm3uwz41\build
Build type: native build
Project name: pandas
Project version: 2.2.1
Activating VS 17.4.4
C compiler for the host machine: cl (msvc 19.34.31937 &quot;Microsoft (R) C/C++ Optimizing Compiler Version 19.34.31937 for x64&quot;)
C linker for the host machine: link link 14.34.31937.0
C++ compiler for the host machine: cl (msvc 19.34.31937 &quot;Microsoft (R) C/C++ Optimizing Compiler Version 19.34.31937 for x64&quot;)
C++ linker for the host machine: link link 14.34.31937.0
Cython compiler for the host machine: cython (cython 3.0.5)
Host machine cpu family: x86_64
Host machine cpu: x86_64
Program python found: YES (C:\Users\abcdefg\AppData\Local\uv\cache\.tmpDIdfXM\.venv\Scripts\python.exe)
Need python for x86_64, but found x86
Run-time dependency python found: NO (tried sysconfig)

..\..\pandas\_libs\tslibs\meson.build:32:7: ERROR: Python dependency not found

A full log can be found at C:\Users\abcdefg\AppData\Local\uv\cache\built-wheels-v3\index\b2a7eb67d4c26b82\pandas\2.2.1\mKNob4WeHbOZ108PaIHLq\pandas-2.2.1.tar.gz\.mesonpy-jm3uwz41\build\meson-logs\meson-log.txt
--- stderr:

---
error: Installation of dependencies failed in venv at C:\dev\source\tools\EvaluateWeights\.venv. uv exited with status: exit code: 2
</code></pre>
<p>Looks like maybe it&#x27;s trying to use the x64 compiler instead of a 32-bit one?  (is there anything additional I would need to do, like install a separate x86 compiler on my machine?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/suryavirkapur">@suryavirkapur</a> on 2024-05-06 14:08</div>
            <div class="timeline-body"><p><strong>Same Error</strong></p>
<p>uv version: <code>uv 0.1.18 (43dc9c87a 2024-03-13)</code>
platform: <code>Windows 11 Pro 23H2 on x64</code>
tracelog:</p>
<pre><code>Resolved 41 packages in 11ms
error: Failed to download distributions
  Caused by: Failed to fetch wheel: scikit-learn==1.0.2
  Caused by: Failed to build: scikit-learn==1.0.2
  Caused by: Build backend failed to build wheel through `build_wheel()` with exit code: 1
--- stdout:
INFO: No module named &#x27;numpy.distutils._msvccompiler&#x27; in numpy.distutils; trying from distutils
INFO: C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.39.33519\bin\HostX86\x64\cl.exe /c /nologo /Ox /W3 /GL /DNDEBUG /MD -IC:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.39.33519\include -IC:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.39.33519\ATLMFC\include -IC:\Program Files\Microsoft Visual Studio\2022\Community\VC\Auxiliary\VS\include -IC:\Program Files (x86)\Windows Kits\10\include\10.0.22000.0\ucrt -IC:\Program Files (x86)\Windows Kits\10\\include\10.0.22000.0\\um -IC:\Program Files (x86)\Windows Kits\10\\include\10.0.22000.0\\shared -IC:\Program Files (x86)\Windows Kits\10\\include\10.0.22000.0\\winrt -IC:\Program Files (x86)\Windows Kits\10\\include\10.0.22000.0\\cppwinrt -IC:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\include\um /Tctest_program.c /Foobjects\test_program.obj
INFO: C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.39.33519\bin\HostX86\x64\link.exe /nologo /INCREMENTAL:NO /LTCG /MANIFEST:EMBED,ID=1 /LIBPATH:C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.39.33519\ATLMFC\lib\x64 /LIBPATH:C:\Program Files\Microsoft Visual Studio\2022\Community\VC\Tools\MSVC\14.39.33519\lib\x64 /LIBPATH:C:\Program Files (x86)\Windows Kits\NETFXSDK\4.8\lib\um\x64 /LIBPATH:C:\Program Files (x86)\Windows Kits\10\lib\10.0.22000.0\ucrt\x64 /LIBPATH:C:\Program Files (x86)\Windows Kits\10\\lib\10.0.22000.0\\um\x64 objects\test_program.obj /OUT:test_program.exe
INFO: No module named &#x27;numpy.distutils._msvccompiler&#x27; in numpy.distutils; trying from distutils\

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-05-06 14:26</div>
            <div class="timeline-body"><p>Could you run with <code>-v</code> and share the log as <a href="https://gist.github.com/">gist</a>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/CatamountJack">@CatamountJack</a> on 2024-05-06 17:04</div>
            <div class="timeline-body"><p>Log (of <code>rye sync -v</code>) <a href="https://gist.github.com/CatamountJack/0d1cdc316b426d16613354f771ffef62">here</a>.  Not sure if rye is passing <code>-v</code> to uv or not, I&#x27;m not using uv directly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vfilter">@vfilter</a> on 2024-09-01 18:16</div>
            <div class="timeline-body"><p>Having the same issue with pandas 2.1.0. 2.2.2 works just fine. However, my architecture is not x86 but AARCH64</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IndrajeetPatil">@IndrajeetPatil</a> on 2024-10-24 20:25</div>
            <div class="timeline-body"><p>I am seeing the same issue while building a Docker image on a Windows machine:</p>
<p>The relevant part Dockerfile:</p>
<pre><code>FROM python:3.13-slim-bookworm
COPY --from=ghcr.io/astral-sh/uv:latest /uv /bin/uv

WORKDIR /app
COPY . /app/

RUN uv sync --frozen
</code></pre>
<p>Error log:</p>
<pre><code> =&gt; ERROR [backend stage-0 5/6] RUN uv sync --frozen                                                                                                                                                                                                                            9.0s 
------
 &gt; [backend stage-0 5/6] RUN uv sync --frozen:
0.800 Using CPython 3.13.0 interpreter at: /usr/local/bin/python
0.800 Creating virtual environment at: .venv
8.674 error: Failed to prepare distributions
8.674   Caused by: Failed to download and build `geventhttpclient==2.3.1`
8.674   Caused by: Build backend failed to build wheel through `build_wheel` (exit status: 1)
8.675
8.675 [stderr]
8.675 warning: no previously-included files matching &#x27;*&#x27; found under directory &#x27;tests&#x27;
8.675 warning: no previously-included files matching &#x27;__pycache__&#x27; found anywhere in distribution
8.675 warning: no previously-included files matching &#x27;*.py[co]&#x27; found anywhere in distribution
8.675 error: command &#x27;gcc&#x27; failed: No such file or directory
------
failed to solve: process &quot;/bin/sh -c uv sync --frozen&quot; did not complete successfully: exit code: 2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-24 20:27</div>
            <div class="timeline-body"><p>That just looks like you&#x27;re missing <code>gcc</code>. Maybe one of your dependencies doesn&#x27;t ship Python 3.13 wheels yet? You can either install <code>gcc</code> to enable building from source, or try using a version like Python 3.12.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/brunolnetto">@brunolnetto</a> on 2024-11-23 15:02</div>
            <div class="timeline-body"><p>Hi, @charliermarsh. I just got the same error for specifically for library <a href="https://pypi.org/project/Factory/"><code>factory</code></a>, logs below., after running <code>uv sync</code> Do you have any idea solving this issue? My python version on command run <code>python3 --version</code> is <code>Python 3.10.12</code>.</p>
<pre><code>  × Failed to download and build `factory==1.2`
  ╰─▶ Build backend failed to determine requirements with `build_wheel()` (exit status: 1)

      [stderr]
      Traceback (most recent call last):
        File &quot;&lt;string&gt;&quot;, line 14, in &lt;module&gt;
        File &quot;/home/brunolnetto/.cache/uv/builds-v0/.tmpanGVjU/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 334, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[])
        File &quot;/home/brunolnetto/.cache/uv/builds-v0/.tmpanGVjU/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 304, in _get_build_requires
          self.run_setup()
        File &quot;/home/brunolnetto/.cache/uv/builds-v0/.tmpanGVjU/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 522, in run_setup
          super().run_setup(setup_script=setup_script)
        File &quot;/home/brunolnetto/.cache/uv/builds-v0/.tmpanGVjU/lib/python3.10/site-packages/setuptools/build_meta.py&quot;, line 320, in run_setup
          exec(code, locals())
        File &quot;&lt;string&gt;&quot;, line 11, in &lt;module&gt;
      NameError: name &#x27;file&#x27; is not defined. Did you mean: &#x27;filter&#x27;?
```
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-26 00:10</div>
            <div class="timeline-body"><p>@brunolnetto that&#x27;s a different issue than being discussed here and doesn&#x27;t look related to uv (it&#x27;s a build failure when invoking the setup script for that package)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mike-hearn">@mike-hearn</a> on 2024-12-02 13:59</div>
            <div class="timeline-body"><p>I&#x27;m encountering the same issue when trying to <code>uv sync</code> a project with the <code>uwsgi</code> package.</p>
<p>The one detail I can offer is that using two different tools that self-install Python have different results:</p>
<p><code>uv venv --python 3.9.12 --seed</code> downloads Python 3.9, installs it in the .venv, and gives me a build error:</p>
<pre><code>  × Failed to download and build `uwsgi==2.0.28`
  ╰─▶ Build backend failed to build wheel through `build_wheel` (exit status: 1)

      [stdout]
      running bdist_wheel
      running build
      running build_py
      copying uwsgidecorators.py -&gt; build/lib
      installing to build/bdist.linux-x86_64/wheel
......
</code></pre>
<p>Using <code>mise</code> to create the venv with a mise.toml that looks like this:</p>
<pre><code>[tools]
python = &quot;3.9&quot;

[env]
_.python.venv = { path = &quot;.venv&quot;, create = &quot;true&quot; }
</code></pre>
<p>This downloads Python 3.9, installs it in .venv, and successfully builds uwsgi.</p>
<p>I don&#x27;t know the differences between the two variations of Python 3.9 that these two tools install, but the <code>mise</code> version works and the <code>uv</code> version does not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-02 23:16</div>
            <div class="timeline-body"><p>@mike-hearn I can&#x27;t really diagnose the difference between mise and uv, but you can resolve that failure by adding the Python version&#x27;s library to <code>LDFLAGS</code>, e.g.: <code>LDFLAGS=-L/root/.local/share/uv/python/cpython-3.9.20-linux-x86_64-gnu/lib</code>. I tested that with:</p>
<pre><code>docker run --platform linux/x86_64 -e LDFLAGS=-L/root/.local/share/uv/python/cpython-3.9.20-linux-x86_64-gnu/lib --rm -it ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt update &amp;&amp; apt install clang -y &amp;&amp; uv venv -p 3.9 &amp;&amp; uv pip install uwsgi==2.0.28&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gmaOCR">@gmaOCR</a> on 2024-12-05 18:30</div>
            <div class="timeline-body"><p>Got the same in a docker during a build in armv7. Dependecies installed with uv pip install</p>
<pre><code>Using Python 3.11.10 environment at: /venv
39.23   × Failed to download and build `run==0.2`
39.23   ╰─▶ Build backend failed to determine requirements with `build_wheel()`
39.23       (exit status: 1)
39.23 
39.23       [stderr]
39.23       Traceback (most recent call last):
39.23         File &quot;&lt;string&gt;&quot;, line 14, in &lt;module&gt;
39.23         File
39.23       &quot;/root/.cache/uv/builds-v0/.tmpofEZnh/lib/python3.11/site-packages/setuptools/build_meta.py&quot;,
39.23       line 334, in get_requires_for_build_wheel
39.23           return self._get_build_requires(config_settings, requirements=[])
39.23                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
39.23         File
39.23       &quot;/root/.cache/uv/builds-v0/.tmpofEZnh/lib/python3.11/site-packages/setuptools/build_meta.py&quot;,
39.23       line 304, in _get_build_requires
39.23           self.run_setup()
39.23         File
39.23       &quot;/root/.cache/uv/builds-v0/.tmpofEZnh/lib/python3.11/site-packages/setuptools/build_meta.py&quot;,
39.23       line 522, in run_setup
39.23           super().run_setup(setup_script=setup_script)
39.23         File
39.23       &quot;/root/.cache/uv/builds-v0/.tmpofEZnh/lib/python3.11/site-packages/setuptools/build_meta.py&quot;,
39.23       line 320, in run_setup
39.23           exec(code, locals())
39.23         File &quot;&lt;string&gt;&quot;, line 12, in &lt;module&gt;
39.23       NameError: name &#x27;file&#x27; is not defined. Did you mean: &#x27;filter&#x27;?
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-05 18:49</div>
            <div class="timeline-body"><p>@gmaOCR Please open a new issue, that is not the same error as the OP encountered. See #9452. The <a href="https://docs.astral.sh/uv/reference/build_failures/">build failure</a> guide might be helpful.</p>
<p>I&#x27;m going to close this issue because we keep getting unrelated reports.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-05 18:49</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:30:57 UTC
    </footer>
</body>
</html>
