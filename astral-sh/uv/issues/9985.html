<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conforming to the XDG specification - astral-sh/uv #9985</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Conforming to the XDG specification</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9985">#9985</a>
        opened by <a href="https://github.com/NellyWhads">@NellyWhads</a>
        on 2024-12-17 23:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/NellyWhads">@NellyWhads</a> on 2024-12-17 23:18</div>
            <div class="timeline-body"><p>Currently, <code>uv</code> prioritizes <code>$HOME/...</code> paths over <code>$XDG_*</code> paths in most cases. This behavior is contradictory to the <a href="https://specifications.freedesktop.org/basedir-spec/latest/#variables">XDG specification</a>.</p>
<p>This means when setting <code>XDG_*</code> variables in a docker image, for example, <code>UV_*</code> variables also must be set.</p>
<p>Examples of variables which do not automatically use the <code>XDG_*</code> specification:</p>
<pre><code class="language-Dockerfile">ENV UV_TOOL_DIR=&quot;${XDG_STATE_HOME}/uv/tools&quot;
ENV UV_PYTHON_INSTALL_DIR=&quot;${XDG_STATE_HOME}/uv/python&quot;
ENV UV_CACHE_DIR=&quot;${XDG_CACHE_HOME}/uv&quot;
</code></pre>
<p>Example of a <code>UV_*</code> variable mapping to multiple potential <code>XDG_*</code> locations: https://docs.astral.sh/uv/configuration/installer/#changing-the-install-path</p>
<p>Consistent environment inheritance would make <code>uv</code> easier to configure according to the XDG specification.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 23:32</div>
            <div class="timeline-body"><p>I think these all respect XDG... The uv cache at least respects <code>XDG_CACHE_HOME</code>. I believe the tool dir also respects <code>XDG_BIN_HOME</code>. And Python respects <code>XDG_DATA_HOME</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-12-17 23:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NellyWhads">@NellyWhads</a> on 2024-12-17 23:46</div>
            <div class="timeline-body"><p>I'll try again but was running into path errors unless I explicitly set them in the Dockerfile.</p>
<p>I presume this isn't a recent change - they've been respected for quite some time?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-18 02:11</div>
            <div class="timeline-body"><p>Yeah I think we've respected XDG-first for quite some time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NellyWhads">@NellyWhads</a> on 2024-12-18 17:23</div>
            <div class="timeline-body"><p>Here's the outcome of my testing:</p>
<pre><code class="language-shell">$ env | grep -E &quot;^(XDG|UV)_&quot; &amp;&amp; uv cache dir &amp;&amp; uv python dir &amp;&amp; uv tool dir
XDG_BIN_HOME=/opt/bin
XDG_DATA_HOME=/opt/share
XDG_CONFIG_HOME=/opt/config
XDG_CACHE_HOME=/opt/cache
XDG_STATE_HOME=/opt/state
/opt/cache/uv
/opt/share/uv/python
/opt/share/uv/tools
</code></pre>
<p>I tried searching through the uv docs for either a config print-out which can tell the user where each of the UV_* directories are expected to be mapped, or consistent documentation regarding which XDG_* directories will be used for but wasn't able to track something consistent down.</p>
<p>Manually executing tool and python installs leads to these inferred locations:</p>
<p>Tools:</p>
<pre><code class="language-shell">$ uv tool install tldr &amp;&amp; whereis tldr
Resolved 4 packages in 49ms
Prepared 4 packages in 15ms
Installed 4 packages in 4ms
 + colorama==0.4.6
 + shtab==1.7.1
 + termcolor==2.5.0
 + tldr==3.3.0
Installed 1 executable: tldr
tldr: /opt/bin/tldr
</code></pre>
<p>Python versions:</p>
<pre><code class="language-shell">$ uv python install 3.8 &amp;&amp; whereis python3.8
Installed Python 3.8.20 in 1.10s
 + cpython-3.8.20-linux-x86_64-gnu
python3.8:

$ export UV_PYTHON_BIN_DIR=${XDG_BIN_HOME}

$ uv python install 3.10 &amp;&amp; whereis python3.10
Installed Python 3.10.16 in 1.14s
 + cpython-3.10.16-linux-x86_64-gnu
python3.10:

$ env | grep -E &quot;^(XDG|UV)_&quot;
UV_PYTHON_BIN_DIR=/opt/bin
XDG_BIN_HOME=/opt/bin
XDG_DATA_HOME=/opt/share
XDG_CONFIG_HOME=/opt/config
XDG_CACHE_HOME=/opt/cache
XDG_STATE_HOME=/opt/state
</code></pre>
<p>Could I get some help with the python bin dir configuration? If so, I'd be happy to make a small PR which adds the appropriate references to the environment variables page.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-18 17:24</div>
            <div class="timeline-body"><p>I think these are all documented in the help? Like <code>uv help python dir</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-18 17:27</div>
            <div class="timeline-body"><p>We don't install Python binaries into the bin directory without <code>--preview</code>, ref https://github.com/astral-sh/uv/pull/8458</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NellyWhads">@NellyWhads</a> on 2024-12-18 17:36</div>
            <div class="timeline-body"><p>Ah, okay. I have been reading the web documentation here: https://docs.astral.sh/uv/configuration/environment/</p>
<p>The references aren't easily traced in those links.</p>
<p><code>--preview</code> did indeed fix the python linking - I'll enable that in my docker setup!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NellyWhads">@NellyWhads</a> on 2024-12-18 18:18</div>
            <div class="timeline-body"><p>Is python bin-linking the only current <code>--preview</code> feature (seems to be the only mention in web docs)? Can we expect more / where can we learn about all <code>--preview</code> features?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-18 18:21</div>
            <div class="timeline-body"><p>The other preview feature is a build backend. We'll probably talk more about preview features in the documentation in the future, yeah. They're mentioned in the changelog.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @NellyWhads on 2024-12-18 18:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13307.html">astral-sh/uv#13307</a> on 2025-05-06 00:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:52 UTC
    </footer>
</body>
</html>
