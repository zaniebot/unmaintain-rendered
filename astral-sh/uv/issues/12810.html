<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How do I install package through docker so the container can run in an offline environment? - astral-sh/uv #12810</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>How do I install package through docker so the container can run in an offline environment?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12810">#12810</a>
        opened by <a href="https://github.com/MSameerAbbas">@MSameerAbbas</a>
        on 2025-04-10 15:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MSameerAbbas">@MSameerAbbas</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p>Here's my dockerfile:</p>
<pre><code>FROM python:3.12-slim
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

# Keeps Python from generating .pyc files in the container
ENV PYTHONDONTWRITEBYTECODE=1

# Turns off buffering for easier container logging
ENV PYTHONUNBUFFERED=1

RUN apt-get update &amp;&amp; apt-get install -y --no-install-recommends \
    make \
    &amp;&amp; apt-get clean \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# Install the project's dependencies using the lockfile and settings
RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --frozen --no-install-project --no-dev


# Then, add the rest of the project source code and install it
# Installing separately from its dependencies allows optimal layer caching
WORKDIR /app
COPY . .
RUN --mount=type=cache,target=/root/.cache/uv \
    uv sync --frozen --no-dev

ENV PATH=&quot;/app/.venv/bin:$PATH&quot;

# Creates a non-root user with an explicit UID and adds permission to access the /app folder
# For more info, please refer to https://aka.ms/vscode-docker-python-configure-containers
RUN adduser -u 5678 --disabled-password --gecos &quot;&quot; appuser &amp;&amp; chown -R appuser /app
USER appuser

ENTRYPOINT [&quot;tail&quot;, &quot;-f&quot;, &quot;/dev/null&quot;]
</code></pre>
<p>I thought that calling uv sync would install everything in the lock file, but for some reason when I exec into the container to run <code>uv run main.py</code>, one of the packages still needs to install.</p>
<p>Here are the logs:</p>
<pre><code> ⚡sam ❯❯ docker exec -it python-model bash
appuser@85e7dcbe0822:/app$ uv run main.py
  × Failed to build `unsupervised-model @ file:///app`
  ├─▶ Failed to resolve requirements from `build-system.requires`
  ├─▶ No solution found when resolving: `flit-core&gt;=3.2, &lt;4`
  ├─▶ Failed to fetch: `https://pypi.org/simple/flit-core/`
  ├─▶ Could not connect, are you offline?
  ├─▶ Request failed after 3 retries
  ├─▶ error sending request for url (https://pypi.org/simple/flit-core/)
  ├─▶ client error (Connect)
  ├─▶ dns error: failed to lookup address information: Name does not resolve
  ╰─▶ failed to lookup address information: Name does not resolve
appuser@85e7dcbe0822:/app$ 
</code></pre>
<p>I tried <code>uv add flit-core</code> followed by a rebuilding of the docker image but got the same output.</p>
<h3>Platform</h3>
<p>Ubuntu 22.04</p>
<h3>Version</h3>
<p>uv 0.6.14</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @MSameerAbbas on 2025-04-10 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-10 15:24</div>
            <div class="timeline-body"><p>I think you want to set <code>UV_NO_SYNC</code> so we use the existing environment without trying to ensure it is up-to-date.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MSameerAbbas">@MSameerAbbas</a> on 2025-04-10 15:27</div>
            <div class="timeline-body"><p>Yup. That was it. Thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @MSameerAbbas on 2025-04-10 15:27</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:30:54 UTC
    </footer>
</body>
</html>
