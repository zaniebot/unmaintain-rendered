```yaml
number: 15665
title: "Add a hint on `uv tool update <name>` when the package is pinned to a version"
type: issue
state: closed
author: zanieb
labels:
  - help wanted
  - error messages
assignees: []
created_at: 2025-09-03T15:04:51Z
updated_at: 2025-10-07T16:18:41Z
url: https://github.com/astral-sh/uv/issues/15665
synced_at: 2026-01-10T01:57:35Z
```

# Add a hint on `uv tool update <name>` when the package is pinned to a version

---

_Issue opened by @zanieb on 2025-09-03 15:04_

e.g., in https://github.com/astral-sh/uv/issues/15662#issuecomment-3249450531 we should hint that the tool isn't going to be updated because it was installed with a specific version.

---

_Label `error messages` added by @zanieb on 2025-09-03 15:04_

---

_Label `help wanted` added by @zanieb on 2025-09-03 15:04_

---

_Comment by @mdevino on 2025-09-03 20:46_

Hello. I just started using `uv` and would like to make my first contribution. Could I work on this one, or do we already have an assignee?

---

_Comment by @zanieb on 2025-09-03 20:52_

Feel free!

---

_Comment by @mdevino on 2025-09-04 12:14_

Hi @zanieb, I have a first version of this [here](https://github.com/astral-sh/uv/compare/4162005df8017ab30461e174ffb846a6ae01f0d5...mdevino:uv:warn-of-fixed-versions?expand=1). I've included a new test, which passes, but now four existing tests are failing.

```
failures:
    tool_upgrade::test_tool_upgrade_additional_entrypoints
    tool_upgrade::tool_upgrade_python
    tool_upgrade::tool_upgrade_python_with_all
    tool_upgrade::tool_upgrade_with
```

Before I go ahead and make any further changes, could you take a look and let me know if 1) these failing tests should be edited or 2) there's a flaw in my logic?

Also, let me know if it's easier to open a PR instead of discussing further changes here in the issue.

---

_Comment by @zanieb on 2025-09-04 12:27_

What are the tests failing with?

---

_Comment by @mdevino on 2025-09-04 12:36_

Here are the test logs. On a first glance, it seems to me that I need to change my logic to account for the scenario in `tool_upgrade_python`. I gotta look at other scenarios further, though.

```
mdevino:uv$ cargo test tool_upgrade
    Finished `test` profile [unoptimized + debuginfo] target(s) in 0.30s
     Running unittests src/lib.rs (/home/mdevino/dev/projects/uv/target/debug/deps/uv-e698e1d53fb5c0d8)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s

     Running unittests src/bin/uv.rs (/home/mdevino/dev/projects/uv/target/debug/deps/uv-89f68e70ba278f83)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src/bin/uvx.rs (/home/mdevino/dev/projects/uv/target/debug/deps/uvx-14ff50dba34e8caa)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests/it/main.rs (/home/mdevino/dev/projects/uv/target/debug/deps/it-0093f24abfb9f169)

running 14 tests
test tool_upgrade::tool_upgrade_non_existing_package ... ok
test tool_upgrade::tool_upgrade_name_pinned ... ok
test tool_upgrade::tool_upgrade_python ... FAILED
test tool_upgrade::tool_upgrade_settings ... ok
test tool_upgrade::test_tool_upgrade_additional_entrypoints ... FAILED
test tool_upgrade::tool_upgrade_python_with_all ... FAILED
test tool_upgrade::tool_upgrade_empty ... ok
test tool_upgrade::tool_upgrade_not_stop_if_upgrade_fails ... ok
test tool_upgrade::tool_upgrade_with ... FAILED
test tool_upgrade::tool_upgrade_respect_constraints ... ok
test tool_upgrade::tool_upgrade_constraint ... ok
test tool_upgrade::tool_upgrade_all ... ok
test tool_upgrade::tool_upgrade_multiple_names ... ok
test tool_upgrade::tool_upgrade_name ... ok

failures:

---- tool_upgrade::tool_upgrade_python stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 2 packages in 1.21s
Prepared 2 packages in 4.35s
Installed 2 packages in 26ms
 + babel==2.6.0
 + pytz==2018.5
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Nothing to upgrade

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_python-2
Source: crates/uv/tests/it/tool_upgrade.rs:765
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5       │-Prepared [N] packages in [TIME]
    6       │-Installed [N] packages in [TIME]
    7       │- + babel==2.6.0
    8       │- + pytz==2018.5
    9       │-Installed 1 executable: pybabel
   10       │-Upgraded tool environment for `babel` to Python 3.12
          6 │+Nothing to upgrade
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread 'tool_upgrade::tool_upgrade_python' panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for 'tool_upgrade_python-2' failed in line 765
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

---- tool_upgrade::test_tool_upgrade_additional_entrypoints stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 7 packages in 1.52s
Prepared 7 packages in 5.67s
Installed 7 packages in 33ms
 + babel==2.14.0
 + black==24.3.0
 + click==8.1.7
 + mypy-extensions==1.0.0
 + packaging==24.0
 + pathspec==0.12.1
 + platformdirs==4.2.0
Installed 2 executables from `black`: black, blackd
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Nothing to upgrade

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_additional_entrypoints-2
Source: crates/uv/tests/it/tool_upgrade.rs:927
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5       │-Prepared [N] packages in [TIME]
    6       │-Installed [N] packages in [TIME]
    7       │- + babel==2.14.0
    8       │- + black==24.3.0
    9       │- + click==8.1.7
   10       │- + mypy-extensions==1.0.0
   11       │- + packaging==24.0
   12       │- + pathspec==0.12.1
   13       │- + platformdirs==4.2.0
   14       │-Installed 2 executables from `black`: black, blackd
   15       │-Installed 1 executable: pybabel
   16       │-Upgraded tool environment for `babel` to Python 3.12
          6 │+Nothing to upgrade
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread 'tool_upgrade::test_tool_upgrade_additional_entrypoints' panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for 'tool_upgrade_additional_entrypoints-2' failed in line 927

---- tool_upgrade::tool_upgrade_python_with_all stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 2 packages in 1.20s
Prepared 2 packages in 3.68s
Installed 2 packages in 35ms
 + babel==2.6.0
 + pytz==2018.5
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 1 package in 1.12s
Prepared 1 package in 483ms
Installed 1 package in 21ms
 + python-dotenv==0.10.2.post2
Installed 1 executable: dotenv

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Prepared 1 package in 1ms
Installed 1 package in 15ms
 + python-dotenv==0.10.2.post2
Installed 1 executable: dotenv
Upgraded tool environment for `python-dotenv` to Python 3.12

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_python_with_all-3
Source: crates/uv/tests/it/tool_upgrade.rs:844
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5     6 │ Prepared [N] packages in [TIME]
    6     7 │ Installed [N] packages in [TIME]
    7       │- + babel==2.6.0
    8       │- + pytz==2018.5
    9       │-Installed 1 executable: pybabel
   10       │-Prepared [N] packages in [TIME]
   11       │-Installed [N] packages in [TIME]
   12     8 │  + python-dotenv==0.10.2.post2
   13     9 │ Installed 1 executable: dotenv
   14       │-Upgraded tool environments for `babel` and `python-dotenv` to Python 3.12
         10 │+Upgraded tool environment for `python-dotenv` to Python 3.12
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread 'tool_upgrade::tool_upgrade_python_with_all' panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for 'tool_upgrade_python_with_all-3' failed in line 844

---- tool_upgrade::tool_upgrade_with stdout ----

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----

----- stderr -----
Resolved 2 packages in 1.23s
Prepared 2 packages in 2.79s
Installed 2 packages in 24ms
 + babel==2.6.0
 + pytz==2018.5
Installed 1 executable: pybabel

────────────────────────────────────────────────────────────────────────────────


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Unfiltered output ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
----- stdout -----
babel version is pinned and will not be upgraded

----- stderr -----
Nothing to upgrade

────────────────────────────────────────────────────────────────────────────────

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ Snapshot Summary ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
Snapshot: tool_upgrade_with-2
Source: crates/uv/tests/it/tool_upgrade.rs:718
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Expression: snapshot
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
-old snapshot
+new results
────────────┬───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
    0     0 │ success: true
    1     1 │ exit_code: 0
    2     2 │ ----- stdout -----
          3 │+babel version is pinned and will not be upgraded
    3     4 │
    4     5 │ ----- stderr -----
    5       │-Modified babel environment
    6       │- - pytz==2018.5
    7       │- + pytz==2024.1
          6 │+Nothing to upgrade
────────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
To update snapshots run `cargo insta review`
Stopped on the first failure. Run `cargo insta test` to run all snapshots.

thread 'tool_upgrade::tool_upgrade_with' panicked at /home/mdevino/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/insta-1.43.1/src/runtime.rs:679:13:
snapshot assertion for 'tool_upgrade_with-2' failed in line 718


failures:
    tool_upgrade::test_tool_upgrade_additional_entrypoints
    tool_upgrade::tool_upgrade_python
    tool_upgrade::tool_upgrade_python_with_all
    tool_upgrade::tool_upgrade_with

test result: FAILED. 10 passed; 4 failed; 0 ignored; 0 measured; 2266 filtered out; finished in 33.11s

error: test failed, to rerun pass `--test it`
```

---

_Comment by @zanieb on 2025-09-04 13:05_

Yeah it looks like you're exiting early when you shouldn't be.

I'd maybe update the `Noop` variant to have a `NoopReason` enum which has variants for reasons it was a noop? Then return from the same place it's currently being returned. The print should be implemented in the CLI.

---

_Comment by @mdevino on 2025-09-04 13:21_

Sounds good. I'll give it a try until tomorrow and let you know. Thansk for the suggestion!

---

_Comment by @mdevino on 2025-09-08 12:10_

Hello. Just wanted to say that I couldn't get a working version of this yet, but I'm still looking into it.

---

_Referenced in [astral-sh/uv#16081](../../astral-sh/uv/pulls/16081.md) on 2025-10-01 01:26_

---

_Closed by @zanieb on 2025-10-07 16:18_

---
