<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv has problems with pyspark depennding on whether it comes via a private feed or not - astral-sh/uv #5066</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv has problems with pyspark depennding on whether it comes via a private feed or not</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5066">#5066</a>
        opened by <a href="https://github.com/fralik">@fralik</a>
        on 2024-07-15 08:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/fralik">@fralik</a> on 2024-07-15 08:27</div>
            <div class="timeline-body"><p>Hi!
I observed an interesting bevavior that uv fails to install pyspark depending on whether distribution comes directly from pip or from our private feed. Both downloaded packages are identical (I checked by manually downloading them from both indices and comparing).
Perhaps the problem is in pyspark itself as it is distributed in sources rather than a wheel.</p>
<p>Attached are two log files obtained like this:</p>
<pre><code>C:\Users\fralik\AppData\Local\miniconda3\envs\myvenv-39-uv\python.exe -m uv pip install &quot;pyspark==3.5.1&quot; --verbose --no-cache &gt; log_succcess.txt 2&gt;&amp;1
</code></pre>
<p>The failed command is similar, but is executed from a folder containing <code>uv.toml</code>:</p>
<pre><code>[pip]
keyring-provider = &quot;subprocess&quot;
index-url = &quot;https://VssSessionToken@myorg.pkgs.visualstudio.com/_packaging/MyPrivateFeed/pypi/simple/&quot;
</code></pre>
<p>Logs:
<a href="https://github.com/user-attachments/files/16231822/log.txt">log.txt</a>
<a href="https://github.com/user-attachments/files/16231828/log_succcess.txt">log_succcess.txt</a></p>
<p>Looking at the log files, I could not spot an obvious reason for the failure.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fralik">@fralik</a> on 2024-07-16 15:03</div>
            <div class="timeline-body"><p>I identified the issue, which was neither with <code>uv</code> nor <code>pyspark</code>, but rather with Windows.</p>
<p>After spending an evening debugging, I discovered that the problem was due to Windows' long path limitation. When <code>uv</code> was installed from a private feed, the path to the package included more subfolders and characters compared to when it was downloaded via pip.</p>
<p>This issue arose because I was using conda to manage my Python distributions instead of downloading them natively from python.org. Installers from python.org include an option to enable long path support, but conda's installer does not have this option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @fralik on 2024-07-16 15:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:30 UTC
    </footer>
</body>
</html>
