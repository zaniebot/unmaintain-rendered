<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv 0.8.12 panics with internal error: entered unreachable code: Installed distribution could not be found in site-packages - astral-sh/uv #15386</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>uv 0.8.12 panics with internal error: entered unreachable code: Installed distribution could not be found in site-packages</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/15386">#15386</a>
        opened by <a href="https://github.com/alex">@alex</a>
        on 2025-08-20 00:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/alex">@alex</a> on 2025-08-20 00:29</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Full logs here: https://github.com/pyca/cryptography/actions/runs/17084993363/job/48447256454 (from https://github.com/pyca/cryptography/pull/13322)</p>
<p>Relevant bit:</p>
<pre><code>DEBUG Build info mismatch for cryptography-vectors: Url(InstalledDirectUrlDist { name: PackageName(&quot;cryptography-vectors&quot;), version: &quot;46.0.0.dev1&quot;, direct_url: LocalDirectory { url: &quot;file:///home/runner/work/cryptography/cryptography/vectors&quot;, dir_info: DirInfo { editable: Some(true) }, subdirectory: None }, url: DisplaySafeUrl { scheme: &quot;file&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: None, port: None, path: &quot;/home/runner/work/cryptography/cryptography/vectors&quot;, query: None, fragment: None }, editable: true, path: &quot;/home/runner/work/cryptography/cryptography/.nox/tests-rust-debug/lib/python3.13/site-packages/cryptography_vectors-46.0.0.dev1.dist-info&quot;, cache_info: Some(CacheInfo { timestamp: Some(Timestamp(SystemTime { tv_sec: 1755649240, tv_nsec: 464897504 })), commit: None, tags: None, env: {}, directories: {&quot;src&quot;: None} }), build_info: Some(BuildInfo { config_settings: ConfigSettings({}), extra_build_requires: [], extra_build_variables: {} }) })
DEBUG Requirement installed, but not fresh: cryptography-vectors==46.0.0.dev1 (from file:///home/runner/work/cryptography/cryptography/vectors)

thread 'main2' panicked at crates/uv-installer/src/plan.rs:159:17:
internal error: entered unreachable code: Installed distribution could not be found in site-packages: cryptography-vectors==46.0.0.dev1 (from file:///home/runner/work/cryptography/cryptography/vectors)
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre>
<p>The invocation is https://github.com/pyca/cryptography/blob/main/noxfile.py#L73-L78</p>
<h3>Platform</h3>
<p>Ubuntu 24.04</p>
<h3>Version</h3>
<p>0.8.12</p>
<h3>Python version</h3>
<p>3.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @alex on 2025-08-20 00:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pyca/cryptography/pulls/13322.html">pyca/cryptography#13322</a> on 2025-08-20 00:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woodruffw">@woodruffw</a> on 2025-08-20 00:38</div>
            <div class="timeline-body"><p>Just doing some triage:</p>
<p>Failure point is here:</p>
<p>https://github.com/astral-sh/uv/blob/249154ee087ce6a86f1fc35c339fb25d13d1fa10/crates/uv-installer/src/plan.rs#L158-L160</p>
<p>Most recent proximate change is #15289</p>
<p>Edit: This looks like the assumption that changed:</p>
<p>https://github.com/astral-sh/uv/blob/59f4598b5869a80a9fd951bcda9b6af6eb8e55d4/crates/uv-installer/src/plan.rs#L92-L97</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-20 02:34</div>
            <div class="timeline-body"><p>Thank you for the report! (and for the triage William!)</p>
<p>cc @charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-20 08:45</div>
            <div class="timeline-body"><p>Iâ€™ll take a look today, thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-08-20 09:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-20 10:09</div>
            <div class="timeline-body"><p>Thanks, I was able to reproduce this. I understand what's going on -- I think it's actually the same &quot;odd&quot; panic that showed up in #15234. It's actually kind of hard to fix, I'll look for a simple patch for now to unblock.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/15389.html">astral-sh/uv#15389</a> on 2025-08-20 10:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-20 10:34</div>
            <div class="timeline-body"><p>Ok, https://github.com/astral-sh/uv/pull/15389 should restore the existing behavior in these cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-20 10:36</div>
            <div class="timeline-body"><p>As an aside, in that noxfile, you might want to use <code>--config-settings-package cryptography:build-args=--profile=dev</code> instead, to scope the configuration to <code>cryptography</code>. In the future, adding <code>--config-settings=build-args=--profile=dev</code> may cause us to rebuild other already-installed source distributions with those new settings, since they aren't scoped to a specific package.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alex">@alex</a> on 2025-08-20 11:30</div>
            <div class="timeline-body"><p>Cool, thanks, will do!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pyca/cryptography/pulls/13328.html">pyca/cryptography#13328</a> on 2025-08-20 11:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-08-20 14:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:29 UTC
    </footer>
</body>
</html>
