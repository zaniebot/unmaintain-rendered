<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebuild C Extensions only on change - astral-sh/uv #12399</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Rebuild C Extensions only on change</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/12399">#12399</a>
        opened by <a href="https://github.com/imanoid">@imanoid</a>
        on 2025-03-23 01:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/imanoid">@imanoid</a> on 2025-03-23 01:15</div>
            <div class="timeline-body"><p>I have a workspace with several python projects containing c++ extensions. Setuptools is configured as the build system.</p>
<p>When working with <code>uv sync</code>, I need to supply the <code>--reinstall</code> or <code>--refresh</code> option (together with <code>--all-packages</code>) so that the C extensions are built.</p>
<p>When using <code>--reinstall</code>, the C extensions are rebuilt every time, even if the c code did not change between executions.
When using <code>--refresh</code>, the C extensions are only built on the first call. Further calls don't trigger a rebuild, even if the c code changed.
When using none of these flags, the C extensions are not built.</p>
<p>The behaviour of <code>uv sync --reinstall</code> also seems to be consistent with <code>uv pip install --editable .</code></p>
<p>Now when using <code>python setup.py build_ext -i</code>, the build is executed if the extension has not been built or if the source code changed. If the c source code is still the same, it won't trigger a rebuild.</p>
<p>I wanted to ask, if you could add the option to use <code>uv sync</code> in a similar way? Only rebuild the c extensions whose source code has changed since the last build call.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @imanoid on 2025-03-23 01:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-23 13:09</div>
            <div class="timeline-body"><p>You can achieve a similar effect with cache keys: https://docs.astral.sh/uv/reference/settings/#cache-keys</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/imanoid">@imanoid</a> on 2025-03-23 17:34</div>
            <div class="timeline-body"><p>This solved the problem. Thanks for the hint!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/imanoid">@imanoid</a> on 2025-04-01 11:39</div>
            <div class="timeline-body"><p>Are there any plans for <code>uv sync</code> to automatically watch the input files defined in the <code>setuptools</code> build steps?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-01 20:24</div>
            <div class="timeline-body"><p>@imanoid no, I don't think we'll special case anything build-backend specific.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by @zanieb on 2025-04-01 20:24</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-04-01 20:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/imanoid">@imanoid</a> on 2025-04-01 20:26</div>
            <div class="timeline-body"><p>ok. then i'll close the request.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @imanoid on 2025-04-01 20:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
