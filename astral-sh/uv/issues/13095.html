<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can I make a script accessible across all directories within a python monorepo using uv? - astral-sh/uv #13095</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Can I make a script accessible across all directories within a python monorepo using uv?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13095">#13095</a>
        opened by <a href="https://github.com/jbcoe">@jbcoe</a>
        on 2025-04-25 00:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jbcoe">@jbcoe</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p>I have a python monorepo with a top-level <code>pyproject.toml</code>. The monorepo contains a projects directory each with its own python package and <code>pyproject.toml</code> file. Some of these projects define scripts:</p>
<pre><code>[project.script]
aaa = &quot;aaa.something:main&quot;
</code></pre>
<p>Within the given project directory, I can run the script with <code>uv run aaa</code>. Outside of the project directory the script cannot be found.</p>
<p>What can I do to make the project script accessible with <code>uv run</code> across the workspace?</p>
<h3>Platform</h3>
<p>Mac but reproducible on Linux and presumably Windows too.</p>
<h3>Version</h3>
<p>uv 0.7.2 (Homebrew 2025-04-30)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @jbcoe on 2025-04-25 00:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-25 07:11</div>
            <div class="timeline-body"><p>What is the content of the top level <code>pyproject.toml</code>? For a script to be accessible, the package containing it must be installed, which seems to be missing here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jbcoe">@jbcoe</a> on 2025-04-25 07:56</div>
            <div class="timeline-body"><p>I've tried to follow https://docs.astral.sh/uv/concepts/projects/workspaces/ which suggests a top-level non-installable pyproject.toml. This pyproject.toml file is used to add workspace members and store common config for tools like ruff and mypy.</p>
<p>I can run a script that's defined in a project directory with:</p>
<p><code>uv run --project project/aaa_project aaa</code></p>
<p>but that's unpleasantly verbose and I'd rather do something like: <code>uv run aaa</code>.</p>
<p>Maybe we could set an entry in the top level (workspace) project file to define workspace scripts?</p>
<pre><code>[tool.uv.workspace.scripts]
scripts = [...]
</code></pre>
<p>That's not currently supported and I am hoping there's an easier way to concisely run a script defined in a workspace project.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-28 10:16</div>
            <div class="timeline-body"><p>When you run <code>uv sync</code>, does the project defining <code>aaa</code> get installed, and if not, what is installed?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jbcoe">@jbcoe</a> on 2025-05-05 09:38</div>
            <div class="timeline-body"><blockquote>
<p>When you run <code>uv sync</code>, does the project defining <code>aaa</code> get installed, and if not, what is installed?</p>
</blockquote>
<p>That depends on which project I'm in when I run <code>uv sync</code>. Running <code>uv sync</code> will install dependencies and scripts for the package I'm in. Running <code>uv sync --all-packages</code> will install every script so that's a working solution but I'm conscious that it might be a bit heavyweight if some of the packages need compilation steps.</p>
<p>Ideally I'd like a workspace-level scripts or tools solution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-05 10:12</div>
            <div class="timeline-body"><p>Does placing the package with the script in the <a href="https://docs.astral.sh/uv/reference/settings/#default-groups">default-groups</a> of the workspace root work for you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jbcoe">@jbcoe</a> on 2025-05-05 10:30</div>
            <div class="timeline-body"><p>The script is defined in another <code>pyproject.toml</code> file rather than as part of a dependency group in the workspace root. I'm not sure how I'd go about adding a project to default-groups.</p>
<p>Workspace root project file:</p>
<pre><code>[project]
name = &quot;xyz-workspace&quot;
version = &quot;0.1.0&quot;
description = &quot;A simple command line chat application to test a monorepo with uv and uv-workspaces&quot;
readme = &quot;README.md&quot;
requires-python = &quot;==3.12.*&quot;

[dependency-groups]
dev = [&quot;mypy&gt;=1.15.0&quot;, &quot;pytest&gt;=8.3.5&quot;, &quot;ruff&gt;=0.11.2&quot;]

[tool.uv]
package = false
default-groups = [&quot;command-line&quot;]

[tool.uv.workspace]
members = [&quot;core&quot;, &quot;command-line&quot;, &quot;api&quot;]

[tool.uv.sources]
xyz-core = { workspace = true }
command-line = { workspace = true }
xyz-api = { workspace = true }
</code></pre>
<p>Sub-project project file</p>
<pre><code>[project]
name = &quot;xyz-command-line&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
dependencies = [
    &quot;types-requests&gt;=2.31.0&quot;,
    &quot;requests&gt;=2.31.0&quot;,
    &quot;xyz-core&quot;,
]

[project.scripts]
greet = &quot;xyz.command_line.client:main&quot;

[build-system]
requires = [&quot;setuptools&quot;]
build-backend = &quot;setuptools.build_meta&quot;

[tool.setuptools]
package-dir = {&quot;&quot; = &quot;src&quot;}

[tool.pytest.ini_options]
python_files = &quot;*_test.py&quot;

[project.optional-dependencies]
dev = [
    &quot;pytest&gt;=8.0.0&quot;,
    &quot;pytest-cov&gt;=4.1.0&quot;,
]
</code></pre>
<p>Error using default-groups</p>
<pre><code>error: Default group `command-line` (from `tool.uv.default-groups`) is not defined in the project's `dependency-groups` table
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-05 10:43</div>
            <div class="timeline-body"><p>This is an example structure that uses dependency groups to make a workspace member be installed by default:</p>
<pre><code>tree
.
├── packages
│   └── script_provider
│       ├── pyproject.toml
│       ├── README.md
│       └── src
│           └── script_provider
│               ├── __init__.py
│               └── py.typed
├── pyproject.toml
└── uv.lock
</code></pre>
<p>Top-level <code>pyproject.toml</code>:</p>
<pre><code class="language-toml">[project]
name = &quot;xyz-workspace&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.12&quot;

[tool.uv.workspace]
members = [&quot;packages/*&quot;]

[tool.uv.sources]
script_provider = { workspace = true }

[tool.uv]
default-groups = [&quot;scripts&quot;]

[dependency-groups]
scripts = [&quot;script_provider&quot;]
</code></pre>
<p>script_provider <code>pyproject.toml</code>:</p>
<pre><code class="language-toml">[project]
name = &quot;script-provider&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.13&quot;

[project.scripts]
aaa = &quot;script_provider:say_hi&quot;

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;
</code></pre>
<p>Running <code>uv sync</code> in the root installs the script provider package and the script:</p>
<pre><code>$ uv sync
Resolved 2 packages in 2ms
Installed 1 package in 12ms
 + script-provider==0.1.0 (from file:///.../packages/script_provider)
$ aaa
Hello from script-provider!
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jbcoe">@jbcoe</a> on 2025-05-05 11:49</div>
            <div class="timeline-body"><p>Nice, that works well in the root but won't apply to other packages. If <code>uv sync</code> is run from fresh in a workspace member package then <code>aaa</code> won't be found.</p>
<p>I <em>could</em> repeat the above for all workspace packages where I might want to run the script, but I'd rather define scripts to be run on a workspace level. I appreciate that this might not be possible.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:31:05 UTC
    </footer>
</body>
</html>
