<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv run --script -` does not parse inline script metadata - astral-sh/uv #10021</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv run --script -</code> does not parse inline script metadata</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10021">#10021</a>
        opened by <a href="https://github.com/BarrensZeppelin">@BarrensZeppelin</a>
        on 2024-12-19 09:07
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BarrensZeppelin">@BarrensZeppelin</a></div>
            <div class="timeline-body"><p>I would expect that adding the <code>--script</code> flag didn&#x27;t disable reading of inline script metadata from stdin, but it seems to be the case.</p>
<pre><code>$ xsel -b
# /// script
# requires-python = &quot;&gt;=3.10&quot;
# dependencies = [
#     &quot;urllib3&quot;,
# ]
# ///

import urllib3
$ xsel -b | uv run -v -
DEBUG uv 0.5.10
Reading inline script metadata from `stdin`
DEBUG Using Python request Python &gt;=3.10 from `requires-python` metadata
DEBUG Searching for Python &gt;=3.10 in virtual environments, managed installations, or search path
DEBUG Searching for managed installations at `.local/share/uv/python`
DEBUG Found managed installation `cpython-3.11.9-linux-x86_64-gnu`
DEBUG Found `cpython-3.11.9-linux-x86_64-gnu` at `/home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11` (managed installations)
DEBUG Caching via interpreter: `/home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11`
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.11.9
DEBUG Solving with target Python version: &gt;=3.11.9
DEBUG Adding direct dependency: urllib3*
DEBUG Found stale response for: https://pypi.org/simple/urllib3/
DEBUG Sending revalidation request for: https://pypi.org/simple/urllib3/
DEBUG Found not-modified response for: https://pypi.org/simple/urllib3/
DEBUG Searching for a compatible version of urllib3 (*)
DEBUG Selecting: urllib3==2.2.3 [compatible] (urllib3-2.2.3-py3-none-any.whl)
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/ce/d9/5f4c13cecde62396b0d3fe530a50ccea91e7dfc1ccf0e09c228841bb5ba8/urllib3-2.2.3-py3-none-any.whl.metadata
DEBUG Tried 1 versions: urllib3 1
DEBUG marker environment resolution took 0.043s
Resolved 1 package in 43ms
DEBUG Assessing Python executable as base candidate: /home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11
DEBUG Using base executable for virtual environment: /home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11
DEBUG Ignoring empty directory
DEBUG Using request timeout of 30s
DEBUG Requirement already cached: urllib3==2.2.3
Installed 1 package in 7ms
 + urllib3==2.2.3
DEBUG Using Python 3.11.9 interpreter at: /home/zii/.cache/uv/archive-v0/BKxFXOwvV9ggZUwFrS0mg/bin/python3
DEBUG Running `python -c`
DEBUG Command exited with code: 0
$ xsel -b | uv run -v --script --isolated -
DEBUG uv 0.5.10
DEBUG No project found; searching for Python interpreter
DEBUG Searching for default Python interpreter in virtual environments, managed installations, or search path
DEBUG Searching for managed installations at `.local/share/uv/python`
DEBUG Found managed installation `cpython-3.11.9-linux-x86_64-gnu`
DEBUG Found `cpython-3.11.9-linux-x86_64-gnu` at `/home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11` (managed installations)
DEBUG Creating isolated virtual environment
DEBUG Assessing Python executable as base candidate: /home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11
DEBUG Using base executable for virtual environment: /home/zii/.local/share/uv/python/cpython-3.11.9-linux-x86_64-gnu/bin/python3.11
DEBUG Ignoring empty directory
DEBUG Using Python 3.11.9 interpreter at: /home/zii/.cache/uv/builds-v0/.tmp7lfpM3/bin/python
DEBUG Running `python -`
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 9, in &lt;module&gt;
ModuleNotFoundError: No module named &#x27;urllib3&#x27;
DEBUG Command exited with code: 1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BarrensZeppelin">@BarrensZeppelin</a> on 2024-12-19 09:37</div>
            <div class="timeline-body"><p>Also, is it not supported to read a script from stdin and pass along command line arguments at the same time?</p>
<p>I can&#x27;t get this to work:</p>
<pre><code>$ echo &#x27;# /// script
     # requires-python = &quot;&gt;=3.10&quot;
     # dependencies = [
     #     &quot;urllib3&quot;,
     # ]
     # ///

     import sys; print(sys.argv)&#x27; | uv run - 1 2 3
Reading inline script metadata from `stdin`
[&#x27;-c&#x27;]
</code></pre>
<p>Placing a <code>--</code> before or after <code>-</code> doesn&#x27;t help either.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 13:55</div>
            <div class="timeline-body"><p>I&#x27;m guessing these are bugs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 13:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 17:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 17:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BarrensZeppelin">@BarrensZeppelin</a> on 2024-12-19 18:09</div>
            <div class="timeline-body"><p>Thanks! ðŸŽ‰</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:36:18 UTC
    </footer>
</body>
</html>
