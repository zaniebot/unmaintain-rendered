<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal: remove default-groups option - astral-sh/uv #12067</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Proposal: remove default-groups option</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12067">#12067</a>
        opened by <a href="https://github.com/rsyring">@rsyring</a>
        on 2025-03-08 15:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rsyring">@rsyring</a></div>
            <div class="timeline-body"><p>refs: https://github.com/astral-sh/uv/issues/11691
refs: https://github.com/astral-sh/uv/issues/10934
refs: https://github.com/astral-sh/uv/pull/11690</p>
<p>I think uv should consider deprecating and then removing <a href="https://docs.astral.sh/uv/concepts/projects/dependencies/#default-groups">default-groups</a> in favor of promoting, through best practices and documentation, the use of include groups instead:</p>
<pre><code class="language-toml">dev = [
    {include-group = &quot;tests&quot;},
    {include-group = &quot;pre-commit&quot;},
    {include-group = &quot;nox&quot;},
    &quot;hatch&gt;=1.14.0&quot;,
    &quot;ruff&gt;=0.9.6&quot;,
]
# Used by nox
pre-commit = [
    'pre-commit&gt;=4.1.0',
    'pre-commit-uv&gt;=4.1.4',
]
# Used by nox
tests = [
    'pytest&gt;=8.3.4',
]
# Used by CI
nox = [
    'nox&gt;=2025.2.9',
]
</code></pre>
<p>This would remove a couple CLI options related to default groups, the possible related <a href="https://github.com/astral-sh/uv/issues/10934#issuecomment-2708355378">confusion/surprise</a> between default groups and the dev group as the default, and presumably simplify the code base.</p>
<p>Unless otherwise called for by cli options, the <code>dev</code> group is always installed by default.  If you want other groups installed by default, then use <code>include-group</code> with the dev group as demonstrated above.</p>
<p>If moving forward with this proposal, I'd also suggest that the template that is generated by <code>project init</code> use a <code>include-group</code> in the <code>pyproject.toml</code> that is generated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-08 17:46</div>
            <div class="timeline-body"><p>I think I'm a -1 on this. Group inclusions are different than defining a default set of groups to sync, and I'm pretty hesitant to special case the dev group <em>further</em>. Curious what others think though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @zanieb on 2025-03-08 17:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rsyring">@rsyring</a> on 2025-03-08 19:04</div>
            <div class="timeline-body"><p>Fair enough.</p>
<blockquote>
<p>Group inclusions are different than defining a default set of groups to sync</p>
</blockquote>
<p>I agree.  But doesn't promoting <code>include-group</code> for <code>dev</code> solve the same problem as <code>default-groups</code>?  Or, maybe the better question is, what is the scenario where the use of <code>default-groups</code> can't be solved well by <code>include-group</code>?  And, is that scenario common enough and/or important enough to justify the default groups concept?</p>
<blockquote>
<p>I'm pretty hesitant to special case the dev group further.</p>
</blockquote>
<p>I don't know that this increases the special casing further.  All this would do is remove ambiguity around the potential for <code>dev</code> or <em>something else</em> to be the default group(s).  It would just always be <code>dev</code> by default, which is a simpler mental model, config, and CLI interface.</p>
<p>I admit the one place you lose flexibility is if your default groups don't map well mentally to a &quot;dev&quot; environment.  I just wonder how often that is.  Everywhere else I use <code>uv sync</code> besides a local dev environment is all scripted (nox, CI, etc.).  In that case, I don't care about the default b/c it's easy to specify on the CLI what group(s) is/are desired.  I would assume usage patterns that differ are the exception rather than the rule.</p>
<p>You could try and un-special-case dev and promote a &quot;default group&quot; mental model and lose the <code>--dev</code> special case and have the dev group dependency default move from <code>dev</code> to <code>default</code> .  The shorthand CLI option for adding then doesn't feel right: <code>uv add --default</code> is confusing b/c it's not obvious the default means default dependency group and not the default as you'd get without a group, i.e. a plain <code>uv add</code>.</p>
<hr />
<p>My main reason for this proposal is to simplify the mental model, config, and CLI interface while not losing any real flexibility (b/c of the availability of <code>include-group</code>).  When I was reworking the docs for #11690, it took longer than I felt it should to understand all the different incantations of dependency groups.  uv has seven different CLI options for dealing with dependency groups.  That seems like a lot to me especially with the way using a group works (see discussion in #11691).</p>
<p>The main thing I came away from in that effort was that the combination of default dependency groups and the special cased dev group seemed technically sound but, potentially, practically unnecessary.  Hence this discussion.  But if my concern for the mental complexity around groups and the numerous CLI options isn't shared, then I'm probably just wasting our collective time with this proposal.  In which case, please close this issue as there are plenty of others that need attention. :)</p>
<p>Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/senthil10">@senthil10</a> on 2025-08-14 14:28</div>
            <div class="timeline-body"><p>I came across this issue/thread randomly and would like to share my opinion (as an user). I agree with @zanieb, <code>include-group</code> and <code>default-groups</code> are intended to do different things.</p>
<p>Of course one can achieve what <code>default-groups</code> does by using <code>include-group</code> within <code>dev</code> dependancy group, but this is only suitable and works as longs as the <code>dev</code> stays as a default dependency group and the user also wishes it to be.</p>
<p>In the current project I am working on, we prefer <code>dev</code> <strong>not</strong> to be a default dependancy group but instead an optional one. With <code>default-groups</code> setting this can be done easily or otherwise we will have to remember and always add <code>--no-dev</code> or <code>--no-default-groups</code> option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-14 14:47</div>
            <div class="timeline-body"><p>(Thanks for being understanding @rsyring)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-08-14 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rsyring">@rsyring</a> on 2025-08-14 15:55</div>
            <div class="timeline-body"><p>Np.  In hindsight, it wasn't a good proposal for the reasons described here.  :)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:30:21 UTC
    </footer>
</body>
</html>
