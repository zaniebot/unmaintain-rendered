<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trying to install torch fails - astral-sh/uv #1884</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Trying to install torch fails</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1884">#1884</a>
        opened by <a href="https://github.com/sachit-menon">@sachit-menon</a>
        on 2024-02-22 22:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sachit-menon">@sachit-menon</a> on 2024-02-22 22:11</div>
            <div class="timeline-body"><p>Thanks for the great project! First time using uv, trying out my typical first install in a fresh conda environment. The same command nominally works with pip.</p>
<pre><code>conda create -n test python=3.10
</code></pre>
<p>Command run:</p>
<pre><code>uv pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
</code></pre>
<p>Error message:</p>
<pre><code>error: Failed to download and build: lit==15.0.7
  Caused by: Failed to build: lit==15.0.7
  Caused by: Failed to install requirements from setup.py build (resolve)
  Caused by: No solution found when resolving: wheel, setuptools &gt;=40.8.0
  Caused by: Because wheel was not found in the package registry and you require wheel, we can conclude that the requirements are unsatisfiable.
</code></pre>
<p>Platform: Linux
uv version: 0.1.8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-22 22:24</div>
            <div class="timeline-body"><p>Hi! Can you make sure this isn't a duplicate of one of the existing issues for torch?</p>
<p>https://github.com/astral-sh/uv/issues?q=is%3Aissue+is%3Aopen+torch</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sachit-menon">@sachit-menon</a> on 2024-02-22 22:26</div>
            <div class="timeline-body"><p>I searched for different keywords for the error that this is getting and it doesn't appear in any of the other issues :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-22 22:33</div>
            <div class="timeline-body"><p>It looks like you might have meant to use <code>--extra-index-url</code> or, instead, run <code>uv pip install wheel setuptools</code> first. They normally comes pre-installed in virtual environments, but we do not seed environments by default (#865). Since something needs <code>wheel</code> but it is not provided by the torch index, installation fails.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-02-22 22:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sachit-menon">@sachit-menon</a> on 2024-02-22 22:36</div>
            <div class="timeline-body"><p>I copied the install command from the pytorch website with <code>--index-url</code>.
Just tried installing those first and:</p>
<pre><code>&gt; uv pip install wheel setuptools                                       
Resolved 2 packages in 539ms
Downloaded 1 package in 10.68s
Installed 1 package in 3.35s
 + setuptools==69.1.0
&gt; uv pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
error: Failed to download and build: lit==15.0.7
  Caused by: Failed to build: lit==15.0.7
  Caused by: Failed to install requirements from setup.py build (resolve)
  Caused by: No solution found when resolving: wheel, setuptools &gt;=40.8.0
  Caused by: Because wheel was not found in the package registry and you require wheel, we can conclude that the requirements are unsatisfiable.
</code></pre>
<p><code>conda list</code> also confirms that <code>wheel</code> is already installed.</p>
<p>Does that help narrow it down? I created the environment with <code>conda</code> (full command is in the first post) so some things were already pre-installed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-22 22:40</div>
            <div class="timeline-body"><p>Interesting, I presumed we'd use your local builds for these if they were around but it doesn't look like we do. This is basically a limitation of specifying index urls, you've requested <code>https://download.pytorch.org/whl/cu118</code> as your sole index URL but we cannot build the <code>lit</code> package without dependencies from the normal index. You could also pre-install <code>lit</code>.</p>
<p>I'm surprised this would work on <code>pip</code> as described (without caching).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sachit-menon">@sachit-menon</a> on 2024-02-22 22:56</div>
            <div class="timeline-body"><p>Interesting. I just tried with <code>--extra-index-url</code> instead and, unsurprisingly, it nominally succeeds but installs with CUDA 12 instead of 11 (because that's what's in the normal index).
This might be a separate source of error, but after I tried</p>
<pre><code>uv pip uninstall torch torchvision torchaudio
uv pip install lit
uv pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
</code></pre>
<p>I get</p>
<pre><code>error: Failed to read metadata for: torchaudio==2.2.1
  Caused by: failed to open file `/proj/vondrick4/sachit/miniconda3/envs/test/lib/python3.10/site-packages/torchaudio-2.2.1.dist-info/METADATA`
  Caused by: No such file or directory (os error 2)
</code></pre>
<p>which seems like it doesn't like that I'm trying to install a package I uninstalled? (I wanted to try pre-installing <code>lit</code> like you recommended, which I'll still try in a fresh environment.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sachit-menon">@sachit-menon</a> on 2024-02-23 03:28</div>
            <div class="timeline-body"><p>Manually installing the correct version of lit first in a fresh environment results in the same error.</p>
<pre><code>error: Failed to download and build: lit==15.0.7
  Caused by: Failed to build: lit==15.0.7
  Caused by: Failed to install requirements from setup.py build (resolve)
  Caused by: No solution found when resolving: wheel, setuptools &gt;=40.8.0
  Caused by: Because wheel was not found in the package registry and you require wheel, we can conclude that the requirements are unsatisfiable.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sachit-menon">@sachit-menon</a> on 2024-03-04 17:04</div>
            <div class="timeline-body"><p>Is there any way to install PyTorch with CUDA 11.8 using uv? This is one of my main use cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-08 00:06</div>
            <div class="timeline-body"><p>Hi @sachit-menon</p>
<p>We now support <code>--no-build-isolation</code> so you can install <code>wheel</code> and <code>setuptools</code> beforehand which should unblock you here. See https://github.com/astral-sh/uv/issues/2251#issuecomment-1984797316 for example.</p>
<p>We also changed the order <code>--extra-index-url</code> and <code>--index-url</code> are prioritized in https://github.com/astral-sh/uv/pull/2083 so just using <code>--extra-index-url</code> should work now?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-07 00:15</div>
            <div class="timeline-body"><p>I think everything here has been resolved, but let me know if you have any outstanding questions and happy to walk through them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-04-07 00:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:57 UTC
    </footer>
</body>
</html>
