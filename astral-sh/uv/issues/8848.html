<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv build` does not work if UV_PROJECT_ENVIRONMENT is a sub path of `.venv` - astral-sh/uv #8848</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv build` does not work if UV_PROJECT_ENVIRONMENT is a sub path of `.venv`</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/8848">#8848</a>
        opened by <a href="https://github.com/zwing99">@zwing99</a>
        on 2024-11-06 00:34
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zwing99">@zwing99</a> on 2024-11-06 00:34</div>
            <div class="timeline-body"><h2>uv version</h2>
<p>uv version = 0.4.29</p>
<h2>steps to replicate</h2>
<pre><code class="language-bash"># create dir
mkdir uv-test-build; cd uv-test-build
# init and add click as dependancy so that .venv/.docker get initialized
uv init --lib --name test-uv-build; UV_PROJECT_ENVIRONMENT=.venv/.docker uv add click
# run uv build
UV_PROJECT_ENVIRONMENT=.venv/.docker uv build
</code></pre>
<p>error:</p>
<pre><code class="language-bash">error: Broken virtual environment `/path/to/dir/test-uv-build/.venv`: `pyvenv.cfg` is missing
</code></pre>
<p>This does not happen if i change to <code>UV_PROJECT_ENVIRONMENT=.venv.docker</code></p>
<p>The main motivation for this is to seperate the virtualenv in docker vs out of docker during local dev in case there are package difference between MacOS and Linux container. By making it a .subfolder of .venv i can lean on standard gitignore from <a href="https://www.toptal.com/developers/gitignore/">toptal gitignoreio</a> without having to customize. I can successfully do this trick in other package managers like poetry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2024-11-06 01:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-11-07 13:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:24 UTC
    </footer>
</body>
</html>
