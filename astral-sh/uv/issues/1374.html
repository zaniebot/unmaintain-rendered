<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannot `uv pip install` without virtualenv - astral-sh/uv #1374</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cannot `uv pip install` without virtualenv</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1374">#1374</a>
        opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a>
        on 2024-02-15 22:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-02-15 22:37</div>
            <div class="timeline-body"><p>It's common to not use virtual environments in containers, e.g. see discussion around PEP 704. I don't mind the default being to prevent installation into a base environment, but it would be nice to have some low level flag to override it.</p>
<pre><code>error: Failed to locate a virtualenv or Conda environment (checked: `VIRTUAL_ENV`, `CONDA_PREFIX`, and `.venv`). Run `uv venv` to create a virtualenv.
</code></pre>
<p>(Maybe I can lie about <code>VIRTUAL_ENV</code> to work around...)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Cannot `uv pip install` in container without virtualenv" to "Cannot `uv pip install` without virtualenv" by @hauntsaninja on 2024-02-15 22:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1372.html">astral-sh/uv#1372</a> on 2024-02-15 22:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-15 22:46</div>
            <div class="timeline-body"><p>üëç Agreed, we need some solution to this. I believe setting <code>VIRTUAL_ENV</code> would work, but it should be a first-class feature.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-02-15 22:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1386.html">astral-sh/uv#1386</a> on 2024-02-16 04:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../mesa/mesa/pulls/2038.html">mesa/mesa#2038</a> on 2024-02-16 08:01</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1480.html">astral-sh/uv#1480</a> on 2024-02-16 12:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1501.html">astral-sh/uv#1501</a> on 2024-02-16 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/batazor">@batazor</a> on 2024-02-16 23:11</div>
            <div class="timeline-body"><p>It would also be cool to do a couple of examples on how to create a Dockerfile</p>
<p>especially with multi-stage builds, as I don't want to carry all the dependencies (c-library) that are needed when building, previously I used <code>--wheel-dir /app/wheels</code> to do this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1526.html">astral-sh/uv#1526</a> on 2024-02-17 00:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dmwyatt">@dmwyatt</a> on 2024-02-17 17:42</div>
            <div class="timeline-body"><p>Here's how I setup my Dockerfile to work until we get a feature in <code>uv</code> to specifically support this:</p>
<pre><code>ENV VIRTUAL_ENV /usr/local/

RUN curl -LsSf https://astral.sh/uv/install.sh | sh \
    &amp;&amp; . $HOME/.cargo/env \
    &amp;&amp; uv pip compile requirements.in -o requirements.txt \
    &amp;&amp; uv pip sync requirements.txt
</code></pre>
<p><code>/usr/local/</code> is correct on <code>slim-bullseye</code> images, you'll have to modify for whatever you image uses.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1604.html">astral-sh/uv#1604</a> on 2024-02-17 17:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-02-17 21:56</div>
            <div class="timeline-body"><p>Since this issue is somewhat popular, just noting that I've been doing <code>VIRTUAL_ENV=$(python -c &quot;import sys; print(sys.prefix)&quot;) uv pip ...</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ofek">@ofek</a> on 2024-02-18 23:21</div>
            <div class="timeline-body"><p>This probably would be the ultimate fix https://github.com/astral-sh/uv/issues/1396</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1396.html">astral-sh/uv#1396</a> on 2024-02-19 00:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ericbn">@ericbn</a> on 2024-02-19 14:58</div>
            <div class="timeline-body"><p>pip has the --require-virtualenv option which makes it behave like uv:</p>
<pre><code>$ pip install --require-virtualenv attrs
ERROR: Could not find an activated virtualenv (required).
</code></pre>
<p>but --no-require-virtualenv seems too long of a name for an option in uv. And sure the default uv behavior is much saner default!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-19 15:46</div>
            <div class="timeline-body"><p>I think we can track this in #1396 and #1526 since those are concrete solutions.</p>
<p>Thanks everyone!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-02-19 15:46</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1705.html">astral-sh/uv#1705</a> on 2024-02-19 16:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SzilvasiPeter">@SzilvasiPeter</a> on 2024-07-09 15:56</div>
            <div class="timeline-body"><p>I will mention the simplest solution, the <code>--system</code> option since other comments do not mention it. Also, the <a href="https://github.com/astral-sh/uv/?tab=readme-ov-file#installing-into-arbitrary-python-environments">documentation </a> highlights this option for containerized environments:</p>
<pre><code class="language-bash">uv pip install --system
</code></pre>
<blockquote>
<p>WARNING: <code>--system</code> is intended for use in continuous integration (CI) environments and should be used with caution, as it can modify the system Python installation.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../bentoml/BentoML/issues/4936.html">bentoml/BentoML#4936</a> on 2024-08-23 07:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../MichaIng/DietPi/issues/7231.html">MichaIng/DietPi#7231</a> on 2024-10-03 17:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/7907.html">astral-sh/uv#7907</a> on 2024-10-03 19:14</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:56 UTC
    </footer>
</body>
</html>
