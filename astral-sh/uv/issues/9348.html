<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv run` fails to run binaries from `~/Library/Application Support` on macOS - astral-sh/uv #9348</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv run` fails to run binaries from `~/Library/Application Support` on macOS</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9348">#9348</a>
        opened by <a href="https://github.com/gusutabopb">@gusutabopb</a>
        on 2024-11-22 05:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gusutabopb">@gusutabopb</a> on 2024-11-22 05:51</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>When executing <code>uv run</code>, a list of available commands is shown. <code>python</code> and <code>python3</code> work fine, but other commands list do not. I don't think <code>uv</code> should be shipping with <code>pip</code>, etc so the provided command list seems wrong.</p>
<p>I tried using different Python version (e.g. <code>-p 3.12</code>) but the results were the same.</p>
<h3>Listing commands</h3>
<pre><code class="language-fish">⋊&gt; ~&gt; uv -v run
DEBUG uv 0.5.4 (c62c83c37 2024-11-20)
DEBUG No project found; searching for Python interpreter
DEBUG Searching for default Python interpreter in virtual environments or managed installations
DEBUG Searching for managed installations at `Library/Application Support/uv/python`
DEBUG Found managed installation `cpython-3.13.0-macos-aarch64-none`
DEBUG Found `cpython-3.13.0-macos-aarch64-none` at `/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13` (managed installations)
DEBUG Using Python 3.13.0 interpreter at: /Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13
Provide a command or script to invoke with `uv run &lt;command&gt;` or `uv run &lt;script&gt;.py`.

The following commands are available in the environment:

- idle3
- idle3.13
- pip
- pip3
- pip3.13
- pydoc3
- pydoc3.13
- python
- python3
- python3-config
- python3.13
- python3.13-config

See `uv run --help` for more information.
</code></pre>
<h3>Running <code>python</code> - OK</h3>
<p><code>python3</code> works as well.</p>
<pre><code>⋊&gt; ~&gt; uv -v run python
DEBUG uv 0.5.4 (c62c83c37 2024-11-20)
DEBUG No project found; searching for Python interpreter
DEBUG Searching for default Python interpreter in virtual environments or managed installations
DEBUG Searching for managed installations at `Library/Application Support/uv/python`
DEBUG Found managed installation `cpython-3.13.0-macos-aarch64-none`
DEBUG Found `cpython-3.13.0-macos-aarch64-none` at `/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13` (managed installations)
DEBUG Using Python 3.13.0 interpreter at: /Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13
DEBUG Running `python`
Python 3.13.0 (main, Oct  7 2024, 23:47:22) [Clang 18.1.8 ] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt;
</code></pre>
<h3>Running <code>pydoc3</code> - FAIL</h3>
<p><code>pip</code>, <code>pip3</code>, <code>idle3</code>, etc fail as well.</p>
<pre><code>⋊&gt; ~&gt; uv -v run pydoc3
DEBUG uv 0.5.4 (c62c83c37 2024-11-20)
DEBUG No project found; searching for Python interpreter
DEBUG Searching for default Python interpreter in virtual environments or managed installations
DEBUG Searching for managed installations at `Library/Application Support/uv/python`
DEBUG Found managed installation `cpython-3.13.0-macos-aarch64-none`
DEBUG Found `cpython-3.13.0-macos-aarch64-none` at `/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13` (managed installations)
DEBUG Using Python 3.13.0 interpreter at: /Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13
DEBUG Running `pydoc3`
/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/pydoc3: line 2: /Users/gustavo/Library
Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13: No such file or directory
/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/pydoc3: line 2: exec: /Users/gustavo/Library
Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13: cannot execute: No such file or directory
DEBUG Command exited with code: 126
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Wrong list of commands when running `uv run python`" to "`uv run` displays an incorrect list of commands" by @gusutabopb on 2024-11-22 05:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-11-22 13:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-22 15:20</div>
            <div class="timeline-body"><p>Hm I can't reproduce this</p>
<pre><code>❯ uv run -v
DEBUG uv 0.5.3 (56d362208 2024-11-19)
DEBUG No project found; searching for Python interpreter
DEBUG Searching for default Python interpreter in virtual environments, managed installations, or search path
DEBUG Searching for managed installations at `/Users/zb/.local/share/uv/python`
DEBUG Found managed installation `cpython-3.13.0-macos-aarch64-none`
DEBUG Found `cpython-3.13.0-macos-aarch64-none` at `/Users/zb/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13` (managed installations)
DEBUG Using Python 3.13.0 interpreter at: /Users/zb/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13
Provide a command or script to invoke with `uv run &lt;command&gt;` or `uv run &lt;script&gt;.py`.

The following commands are available in the environment:

- idle3
- idle3.13
- pip
- pip3
- pip3.13
- pydoc3
- pydoc3.13
- python
- python3
- python3-config
- python3.13
- python3.13-config

See `uv run --help` for more information.
❯ uv run python3.13
Python 3.13.0 (main, Oct 16 2024, 08:05:40) [Clang 18.1.8 ] on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; 
KeyboardInterrupt
&gt;&gt;&gt; 
❯ uv run pydoc3
pydoc - the Python documentation tool

pydoc3 &lt;name&gt; ...
    Show text documentation on something.  &lt;name&gt; may be the name of a
    Python keyword, topic, function, module, or package, or a dotted
    reference to a class or function within a module or module in a
    package.  If &lt;name&gt; contains a '/', it is used as the path to a
    Python source file to document. If name is 'keywords', 'topics',
    or 'modules', a listing of these things is displayed.

pydoc3 -k &lt;keyword&gt;
    Search for a keyword in the synopsis lines of all available modules.

pydoc3 -n &lt;hostname&gt;
    Start an HTTP server with the given hostname (default: localhost).

pydoc3 -p &lt;port&gt;
    Start an HTTP server on the given port on the local machine.  Port
    number 0 can be used to get an arbitrary unused port.

pydoc3 -b
    Start an HTTP server on an arbitrary unused port and open a web browser
    to interactively browse documentation.  This option can be used in
    combination with -n and/or -p.

pydoc3 -w &lt;name&gt; ...
    Write out the HTML documentation for a module to a file in the current
    directory.  If &lt;name&gt; contains a '/', it is treated as a filename; if
    it names a directory, documentation is written for all the contents.


 /                                                                                                                     
❯ uv run pip3 --version
pip 24.1.2 from /Users/zb/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/site-packages/pip (python 3.13)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @zanieb on 2024-11-22 20:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv run` displays an incorrect list of commands" to "`uv run` fails to run binaries from `~/Library/Application Support` on macOS" by @gusutabopb on 2024-11-23 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gusutabopb">@gusutabopb</a> on 2024-11-23 12:35</div>
            <div class="timeline-body"><p>The binaries (<code>pydoc3</code>, etc) were present in the installation directory (<code>~/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/</code>) but uv failed to find them. I updated the issue description to clarify that.</p>
<p>I believe this is somewhat related to #5806 and perhaps with the whitespace in <code>Application Support</code> not being properly escaped somehow.</p>
<p>I can reproduce this consistently on macOS using this:</p>
<pre><code>&gt; rm -rf ~/.local/share/uv
&gt; rm -rf ~/Library/Application\ Support/uv/
&gt; mkdir -p ~/Library/Application\ Support/uv
&gt; uv -v --python-preference only-managed run --python 3.13.0 pydoc3
</code></pre>
<p>Output:</p>
<pre><code>DEBUG uv 0.5.4 (c62c83c37 2024-11-20)
DEBUG No project found; searching for Python interpreter
DEBUG Searching for Python 3.13.0 in virtual environments or managed installations
DEBUG Searching for managed installations at `Library/Application Support/uv/python`
DEBUG Requested Python not found, checking for available download...
DEBUG Acquired lock for `Library/Application Support/uv/python`
DEBUG Using request timeout of 30s
INFO Fetching requested Python...
DEBUG Downloading https://github.com/indygreg/python-build-standalone/releases/download/20241016/cpython-3.13.0%2B20241016-aarch64-apple-darwin-install_only_stripped.tar.gz to temporary location: /Users/gustavo/Library/Application Support/uv/python/.cache/.tmptaZksd
DEBUG Extracting cpython-3.13.0%2B20241016-aarch64-apple-darwin-install_only_stripped.tar.gz
DEBUG Moving /Users/gustavo/Library/Application Support/uv/python/.cache/.tmptaZksd/python to Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none
DEBUG Released lock at `/Users/gustavo/Library/Application Support/uv/python/.lock`
DEBUG Using Python 3.13.0 interpreter at: /Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13
DEBUG Running `pydoc3`
/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/pydoc3: line 2: /Users/gustavo/Library
Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13: No such file or directory
/Users/gustavo/Library/Application Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/pydoc3: line 2: exec: /Users/gustavo/Library
Support/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13: cannot execute: No such file or directory
DEBUG Command exited with code: 126
</code></pre>
<p>Note that if <code>~/Library/Application\ Support/uv/</code> doesn't exist, the issue goes away:</p>
<pre><code>&gt; rm -rf ~/Library/Application\ Support/uv/
&gt; uv -v --python-preference only-managed run --python 3.13.0 pydoc3
</code></pre>
<pre><code>DEBUG uv 0.5.4 (c62c83c37 2024-11-20)
DEBUG No project found; searching for Python interpreter
DEBUG Searching for Python 3.13.0 in virtual environments or managed installations
DEBUG Searching for managed installations at `.local/share/uv/python`
DEBUG Requested Python not found, checking for available download...
DEBUG Acquired lock for `.local/share/uv/python`
DEBUG Using request timeout of 30s
INFO Fetching requested Python...
DEBUG Downloading https://github.com/indygreg/python-build-standalone/releases/download/20241016/cpython-3.13.0%2B20241016-aarch64-apple-darwin-install_only_stripped.tar.gz to temporary location: /Users/gustavo/.local/share/uv/python/.cache/.tmp2Z3nJ4
DEBUG Extracting cpython-3.13.0%2B20241016-aarch64-apple-darwin-install_only_stripped.tar.gz
DEBUG Moving /Users/gustavo/.local/share/uv/python/.cache/.tmp2Z3nJ4/python to .local/share/uv/python/cpython-3.13.0-macos-aarch64-none
DEBUG Released lock at `/Users/gustavo/.local/share/uv/python/.lock`
DEBUG Using Python 3.13.0 interpreter at: /Users/gustavo/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/bin/python3.13
DEBUG Running `pydoc3`
pydoc - the Python documentation tool

pydoc3 &lt;name&gt; ...
    Show text documentation on something.  &lt;name&gt; may be the name of a
    Python keyword, topic, function, module, or package, or a dotted
    reference to a class or function within a module or module in a
    package.  If &lt;name&gt; contains a '/', it is used as the path to a
    Python source file to document. If name is 'keywords', 'topics',
    or 'modules', a listing of these things is displayed.

pydoc3 -k &lt;keyword&gt;
    Search for a keyword in the synopsis lines of all available modules.

pydoc3 -n &lt;hostname&gt;
    Start an HTTP server with the given hostname (default: localhost).

pydoc3 -p &lt;port&gt;
    Start an HTTP server on the given port on the local machine.  Port
    number 0 can be used to get an arbitrary unused port.

pydoc3 -b
    Start an HTTP server on an arbitrary unused port and open a web browser
    to interactively browse documentation.  This option can be used in
    combination with -n and/or -p.

pydoc3 -w &lt;name&gt; ...
    Write out the HTML documentation for a module to a file in the current
    directory.  If &lt;name&gt; contains a '/', it is treated as a filename; if
    it names a directory, documentation is written for all the contents.

DEBUG Command exited with code: 0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-23 13:01</div>
            <div class="timeline-body"><p>Interesting, thanks. (We no longer write there by default IIRC but it's preserved for backwards compatibility.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-24 03:22</div>
            <div class="timeline-body"><p>I think it must be an issue with the shebang that's being used in python-build-standalone (upstream)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-24 03:25</div>
            <div class="timeline-body"><p>Filed: https://github.com/indygreg/python-build-standalone/issues/394. Should be an easy fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> removed by @charliermarsh on 2024-11-24 03:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @charliermarsh on 2024-11-24 03:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-11-24 03:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-24 03:30</div>
            <div class="timeline-body"><p>And now a PR here: https://github.com/indygreg/python-build-standalone/pull/395. I think that's right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gusutabopb">@gusutabopb</a> on 2024-11-24 08:19</div>
            <div class="timeline-body"><p>Thanks!</p>
<p>If anyone else hits this until it's fixed upstream, the quick fix is to simply delete your <code>~/Library/Application Support</code> and reinstall any necessary Python versions in the new default location (<code>~/.local/share/uv</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-12-03 20:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-12-03 20:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-03 21:11</div>
            <div class="timeline-body"><p>This is fixed upstream, but we need to release it there and here still.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:39:09 UTC
    </footer>
</body>
</html>
