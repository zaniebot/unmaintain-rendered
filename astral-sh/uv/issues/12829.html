<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow the lock file to be based on solely one platform - astral-sh/uv #12829</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow the lock file to be based on solely one platform</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12829">#12829</a>
        opened by <a href="https://github.com/JerBouma">@JerBouma</a>
        on 2025-04-11 08:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/JerBouma">@JerBouma</a></div>
            <div class="timeline-body">Summary
<p>Currently, within my company we are using <code>poetry</code> but it has never worked as well as we wanted it to do given that the lockfile registers versions for <em>all</em> platforms. While the registration is not a problem by itself, using internal package feeds (Azure Artifacts) can be a culprit to that approach. Given that everything is Linux based, this feed does not include any Windows-specific packages. However, some packages we place in the lockfile can require Windows-packages <em>for the Windows build</em> of that specific library. This results in failures when trying to install the dependencies on Linux terminal where it tries to download the .whl of the Windows-related package but can&#x27;t find it and thus fails. It won&#x27;t do anything with the .whl, it just downloads it.</p>
<p>See below an example that is looking for <code>pywin32</code> while working entirely on Linux:</p>
<p><img src="https://github.com/user-attachments/assets/56aac315-9f04-4153-884a-524b7b1d4cfc" alt="Image"></p>
<p>Poetry offers a solution: https://python-poetry.org/docs/dependency-specification/#using-environment-markers but this does not take into account that a library could simply not exist in an internal package feed. I&#x27;ve seen the same implementation in <code>uv</code> but unfortunately this will also fail as long as packages from different platforms exist in the lockfile: <a href="https://github.com/astral-sh/uv/issues/6758">astral-sh/uv#6758</a>#issuecomment-2315679258</p>
<p>I read that the uv lockfile is &quot;<em>is a universal or cross-platform lockfile that captures the packages that would be installed across all possible Python markers such as operating system, architecture, and Python version.</em>&quot; (https://docs.astral.sh/uv/concepts/projects/layout/#the-lockfile)</p>
<p>I would like the option it not to be.</p>
Example
<p>Something like <code>uv lock --platforms linux</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/JerBouma">@JerBouma</a> on 2025-04-11 08:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-04-11 08:56</div>
            <div class="timeline-body"><p>You can set <code>tool.uv.environments</code> to limit the resolution to specific target(s) (https://docs.astral.sh/uv/concepts/projects/config/#limited-resolution-environments).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-04-11 08:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-04-11 08:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JerBouma">@JerBouma</a> on 2025-04-11 08:58</div>
            <div class="timeline-body"><p>That&#x27;s perfect, thank you. Issue resolved!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/JerBouma">@JerBouma</a> on 2025-04-11 08:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:13 UTC
    </footer>
</body>
</html>
