<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No .dist-info directory found - uv vs. pip - astral-sh/uv #2106</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>No .dist-info directory found - uv vs. pip</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/2106">#2106</a>
        opened by <a href="https://github.com/TheoBabilon">@TheoBabilon</a>
        on 2024-03-01 10:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/TheoBabilon">@TheoBabilon</a> on 2024-03-01 10:08</div>
            <div class="timeline-body"><p>I noticed a difference in behavior between <code>uv</code> and <code>pip</code> (<code>uv</code> fails where <code>pip</code> succeeds)
Note that because the underlying reason might be an incorrectly-built wheel, please feel free to close as &quot;won't fixed&quot;; I just thought it would be great to report here in case it is something you want to handle the same way as <code>pip</code> does currently.</p>
<p>uv version used is <code>0.1.13</code>.</p>
<p>I was given a company-internal package wheel file (I'm not aware of how it was built); let's call it <code>mypackage-0.10.3-cp311-cp311-linux_x86_64.whl</code>
when trying to install it using
<code>uv pip install &quot;mypackage @ mypackage-0.10.3-cp311-cp311-linux_x86_64.whl&quot;</code>
I get</p>
<pre><code>error: Failed to read: mypackage @ file:///path/to/my/wheel/mypackage-0.10.3-cp311-cp311-linux_x86_64.whl
  Caused by: No .dist-info directory found
</code></pre>
<p>Note that it's working fine when using pip:
<code>pip install mypackage-0.10.3-cp311-cp311-linux_x86_64.whl</code>
package gets installed without errors.</p>
<p>The underlying reason seems to be coming from this strict version check, which also depends on the filename: https://github.com/astral-sh/uv/blob/d0ffabd1f2aaa7788d40f1f3b9d253cc9cacdb2e/crates/install-wheel-rs/src/lib.rs#L166</p>
<p>I came to this conclusion doing the following:
I extracted the wheel (<code>unzip mypackage-0.10.3-cp311-cp311-linux_x86_64.whl</code>); omitting non-dist-info files</p>
<pre><code>...
  inflating: mypackage-0.10.3+123.ab1cd2e.dist-info/LICENSE
  inflating: mypackage-0.10.3+123.ab1cd2e.dist-info/METADATA
  inflating: mypackage-0.10.3+123.ab1cd2e.dist-info/WHEEL
  inflating: mypackage-0.10.3+123.ab1cd2e.dist-info/top_level.txt
  inflating: mypackage-0.10.3+123.ab1cd2e.dist-info/RECORD
</code></pre>
<p>I noticed the added <code>+123.ab1cd2e</code> - not sure what it is, but this is why I initially said that this might be &quot;an incorrectly-built wheel&quot;, so I simply changed the wheel filename</p>
<p>From <code>mypackage-0.10.3-cp311-cp311-linux_x86_64.whl</code> to <code>mypackage-0.10.3+123.ab1cd2e-cp311-cp311-linux_x86_64.whl</code></p>
<p>and it fixes the issue (the above version check passes, so I don't get any error), the package gets installed without any problem using <code>uv pip install &quot;mypackage @ mypackage-0.10.3+123.ab1cd2e-cp311-cp311-linux_x86_64.whl&quot;</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @konstin on 2024-03-01 10:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-01 10:35</div>
            <div class="timeline-body"><p>This is a bug in the tool used to create <code>mypackage</code>, according to <a href="https://peps.python.org/pep-0491/#the-dist-info-directory">PEP 491</a> the wheel filename is <code>{distribution}-{version}(-{build tag})?-{python tag}-{abi tag}-{platform tag}.whl</code> while the dist info directory is <code>{distribution}-{version}.dist-info/</code>. I suspect this accidentally passes with pip because versions the only differ in the local segments (the part after the <code>+</code>) are considered equal in most circumstances.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-02 03:56</div>
            <div class="timeline-body"><p>@konstin - What do you think is the right course of action here?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-03 17:44</div>
            <div class="timeline-body"><p>I think this needs to be fixed on this side of the package authors; I wouldn't add a fixup unless it affects a bigger number of packages</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TheoBabilon">@TheoBabilon</a> on 2024-03-03 17:53</div>
            <div class="timeline-body"><blockquote>
<p>I think this needs to be fixed on this side of the package authors; I wouldn't add a fixup unless it affects a bigger number of packages</p>
</blockquote>
<p>As mentioned in my original post, I knew already that it was potentially an incorrectly-built package; I was merely reporting the issue as a &quot;heads up&quot; considering it was working fine using pip, and that you might (or might not) have the same exact thing reported in the near of far future; but if it's indeed just &quot;incorrectly&quot; working &quot;by chance&quot; in pip, then better to just close the issue! I'm just surprised (in principle) that a simple filename for a wheel is that important for correct or failing installation; but that makes sense considering the PEP you linked ðŸ™‚</p>
<p>Maybe an alternative error message might save some (investigation) time to the next person facing the exact same issue when the solution is simply related to the filename; but that might not be that easy to do in practice.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-03 17:55</div>
            <div class="timeline-body"><p>(To be clear: thanks @TheoBabilon, I appreciate you filing the issue regardless of whether we add handling for it or not!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TheoBabilon">@TheoBabilon</a> on 2024-03-04 09:00</div>
            <div class="timeline-body"><p>Thanks guys, closing the issue as it served its &quot;heads up&quot; purpose, thanks for the explanations!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @TheoBabilon on 2024-03-04 09:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:57 UTC
    </footer>
</body>
</html>
