<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fails to install JAX TPU - astral-sh/uv #2010</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Fails to install JAX TPU</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2010">#2010</a>
        opened by <a href="https://github.com/sayakpaul">@sayakpaul</a>
        on 2024-02-27 10:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/sayakpaul">@sayakpaul</a> on 2024-02-27 10:49</div>
            <div class="timeline-body"><pre><code>python3 -m uv pip install --no-cache-dir \
        &quot;jax[tpu]&gt;=0.2.16,!=0.3.2&quot; \
        -f https://storage.googleapis.com/jax-releases/libtpu_releases.html
</code></pre>
<p>Fails with:</p>
<pre><code class="language-bash">...
      Because there is no version of libtpu-nightly==0.1.dev20231204 and jax[tpu]==0.4.21 depends on libtpu-nightly==0.1.dev20231204,
      we can conclude that jax[tpu]==0.4.21 cannot be used.
      And because we know from (36) that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.21
       cannot be used, we can conclude that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.22
       cannot be used. (37)

      Because there is no version of libtpu-nightly==0.1.dev20231213 and jax[tpu]&gt;=0.4.22,&lt;=0.4.23 depends on
      libtpu-nightly==0.1.dev20231213, we can conclude that jax[tpu]&gt;=0.4.22,&lt;=0.4.23 cannot be used.
      And because we know from (37) that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.22
       cannot be used, we can conclude that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.24
       cannot be used. (38)

      Because there is no version of libtpu-nightly==0.1.dev20240205 and jax[tpu]==0.4.24 depends on libtpu-nightly==0.1.dev20240205,
      we can conclude that jax[tpu]==0.4.24 cannot be used.
      And because we know from (38) that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.24
       cannot be used, we can conclude that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.25
       cannot be used. (39)

      Because there is no version of libtpu-nightly==0.1.dev20240224 and jax[tpu]==0.4.25 depends on libtpu-nightly==0.1.dev20240224,
      we can conclude that jax[tpu]==0.4.25 cannot be used.
      And because we know from (39) that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2,&lt;0.4.25
       cannot be used, we can conclude that any of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2
       cannot be used.
      And because you require one of:
          jax[tpu]&gt;=0.2.16,&lt;0.3.2
          jax[tpu]&gt;0.3.2
      we can conclude that the requirements are unsatisfiable.

      hint: libtpu-nightly was requested with a pre-release marker (e.g., libtpu-nightly==0.1.dev20230207), but pre-releases weren't
      enabled (try: `--prerelease=allow`)
</code></pre>
<p>(Full output removed for brevity)</p>
<p>While</p>
<pre><code class="language-bash">python3 -m pip install --no-cache-dir \
        &quot;jax[tpu]&gt;=0.2.16,!=0.3.2&quot; \
        -f https://storage.googleapis.com/jax-releases/libtpu_releases.html
</code></pre>
<p>passes.</p>
<p>I am on uv 0.1.11.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../huggingface/diffusers/pulls/7115.html">huggingface/diffusers#7115</a> on 2024-02-27 10:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-02-27 16:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-27 16:16</div>
            <div class="timeline-body"><p>Thanks, will take a look!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sayakpaul">@sayakpaul</a> on 2024-03-01 01:56</div>
            <div class="timeline-body"><p>Same happens for:</p>
<pre><code class="language-bash">uv pip install --no-cache-dir         torch==2.1.2         torchvision==0.16.2         torchaudio==2.1.2         onnxruntime         --extra-index-url https://download.pytorch.org/whl/cpu &amp;&amp;     python3 -m uv pip install --no-cache-dir         accelerate         datasets         hf-doc-builder         huggingface-hub         Jinja2         librosa         numpy         scipy         tensorboard         transformers
</code></pre>
<p>Passes if I omit <code>uv</code>. However, it passes with an older version of <code>uv</code> (0.1.11). But fails with 0.1.13.</p>
<p>I am on standard Ubuntu machine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../huggingface/diffusers/pulls/7155.html">huggingface/diffusers#7155</a> on 2024-03-01 02:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-01 03:52</div>
            <div class="timeline-body"><p>Does it get any further if you pass <code>--prerelease=allow</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-01 03:53</div>
            <div class="timeline-body"><p>(Our Torch-related resolutions have some issues right now due to their use of local versions segments, e.g., the <code>+cpu</code> stuff. But that may not be relevant here -- can't tell from the above trace yet.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sayakpaul">@sayakpaul</a> on 2024-03-01 04:04</div>
            <div class="timeline-body"><blockquote>
<p>Does it get any further if you pass <code>--prerelease=allow</code>?</p>
</blockquote>
<p>Tried with:</p>
<pre><code class="language-bash">uv pip install --no-cache-dir         torch==2.1.2         torchvision==0.16.2         torchaudio==2.1.2         onnxruntime         --extra-index-url https://download.pytorch.org/whl/cpu &amp;&amp;     python3 -m uv pip install --no-cache-dir         accelerate         datasets         hf-doc-builder         huggingface-hub         Jinja2         librosa         numpy         scipy         tensorboard         transformers --prerelease=allow
</code></pre>
<p>Leads to:</p>
<pre><code class="language-bash">  √ó No solution found when resolving dependencies:
  ‚ï∞‚îÄ‚ñ∂ Because torch==2.1.2 is unusable because no wheels are available with a matching platform and you require torch==2.1.2, we can
      conclude that the requirements are unsatisfiable.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ncoop57">@ncoop57</a> on 2024-03-14 19:49</div>
            <div class="timeline-body"><p>Facing similar issue</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-18 20:53</div>
            <div class="timeline-body"><p>Torch installs should now work as expected if you include the local tag, e.g., <code>uv pip install torch==2.1.2+cpu torchvision==0.16.2+cpu</code> and so on.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sayakpaul">@sayakpaul</a> on 2024-03-19 02:33</div>
            <div class="timeline-body"><p>How about the GPU variants? <code>pip</code> variant:</p>
<pre><code class="language-bash">pip3 install torch --index-url https://download.pytorch.org/whl/cu118
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-19 02:43</div>
            <div class="timeline-body"><p>Yeah, that should all work. The only difference from <code>pip</code> is that if you want one of the non-standard versions with a <code>+</code> at the end, you need to make that explicit, like: <code>uv pip install torch==2.2.1+cu118 --index-url https://download.pytorch.org/whl/cu118</code>. If you see otherwise, let me know.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sayakpaul">@sayakpaul</a> on 2024-03-19 02:54</div>
            <div class="timeline-body"><p>Good to know! Maybe worth adding this to the docs or somewhere relevant when you think the behaviour has gotten a little more stable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-19 03:06</div>
            <div class="timeline-body"><p>üëç It's explained in more detail here: https://github.com/astral-sh/uv/blob/main/PIP_COMPATIBILITY.md#local-version-identifiers</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-01 14:43</div>
            <div class="timeline-body"><p>Closing this since we've implemented and documented how to use uv with the local version identifiers and <code>uv pip install --no-cache-dir &quot;jax[tpu]&gt;=0.2.16,!=0.3.2&quot; -f https://storage.googleapis.com/jax-releases/libtpu_releases.html --prerelease allow</code> works, feel free to reopen if jax still doesn't install for your accelerator.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-07-01 14:43</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/7616.html">astral-sh/uv#7616</a> on 2024-09-21 20:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:24 UTC
    </footer>
</body>
</html>
