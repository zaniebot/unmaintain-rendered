<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv add onnxruntime` currently fails on MacOS - astral-sh/uv #9228</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv add onnxruntime` currently fails on MacOS</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9228">#9228</a>
        opened by <a href="https://github.com/reyammer">@reyammer</a>
        on 2024-11-19 14:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/reyammer">@reyammer</a> on 2024-11-19 14:56</div>
            <div class="timeline-body"><p>Hello,</p>
<p>Running <code>uv add onnxruntime</code> in a new <code>uv</code> repo currently fails on MacOS. The installation works with <code>pip</code>.</p>
<p>Commands:
<code>$ uv init</code>
<code>$ uv add onnxruntime</code></p>
<p>Output:</p>
<pre><code>error: Distribution `onnxruntime==1.20.0 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform
</code></pre>
<p>Platform: MacOS, 12.5</p>
<p>uv version: 0.5.2.</p>
<p>More context, which hopefully helps debugging:</p>
<ul>
<li><code>pip install onnxruntime</code> works; the catch seems to be that it installs onnxruntime 1.19.2.</li>
<li>I came across this problem while preparing a new release for magika (https://pypi.org/project/magika/0.6.0rc2/), see <a href="https://github.com/google/magika/blob/main/python/pyproject.toml">pyproject.toml</a>; on MacOS, <code>uv add magika==0.6.0rc2</code> fails (referencing &quot;can't find a proper wheel for onnxruntime 1.20.0&quot;). On the same platform <code>pip install magika==0.6.0rc2</code> works (by picking onnxruntime 1.19.2). Another way to make it work is: <code>uv add onnxruntime==1.19.2; uv add magika==0.6.2rc2</code>).</li>
<li>I don't encounter these issues when testing on an ubuntu VM.</li>
</ul>
<p>The gist of the problem seems to be that onnxruntime 1.20.0 is not compatible with the MacOS, but uv quits instead of trying with 1.19.2, which is compatible.</p>
<p>Happy to help debugging this, I'm a massive uv fan!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../google/magika/issues/798.html">google/magika#798</a> on 2024-11-19 14:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-19 15:10</div>
            <div class="timeline-body"><p>Ah yeah. This is working as intended right now. <code>uv add</code> will resolve for all platforms. But if a package is published without a source distribution, and the set of wheels doesn't cover all platforms, we won't know that when resolving. (In general, the set of wheels will <em>never</em> cover all platforms, since the set of platforms isn't fixed, so we basically assume that the wheels cover all platforms as long as they include the Python versions we care about.) I suggest adding a constraint for now, though the most relevant issue to track would be #5182.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-19 15:12</div>
            <div class="timeline-body"><p>(I'm going to combine with https://github.com/astral-sh/uv/issues/5182 since it's ultimately the same problem as with PyTorch.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-19 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-11-19 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/reyammer">@reyammer</a> on 2024-11-19 17:14</div>
            <div class="timeline-body"><p>Thanks for the very fast reply, I now understand the challenge. I will track the other gh issue and add a constraint for now. Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../google/magika/issues/801.html">google/magika#801</a> on 2024-11-19 17:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-19 18:47</div>
            <div class="timeline-body"><p>Thanks @reyammer. I promise it's a hard problem :joy: But I'd like to make the situation better here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../crewAIInc/crewAI/issues/1599.html">crewAIInc/crewAI#1599</a> on 2024-11-20 09:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/reyammer">@reyammer</a> on 2024-11-20 10:03</div>
            <div class="timeline-body"><p>oh I fully believe you ðŸ˜‚  what confused me is that pip worked well this time, but given your note it seems there are cons in doing whatever pip is doing. Anyways, no big deal, added an upper bound for onnxruntime and everything now works as expected. Thanks again!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/msmygit">@msmygit</a> on 2024-12-05 22:01</div>
            <div class="timeline-body"><p>I've the same problem as well with python 3.12,</p>
<pre><code>error: Distribution `onnxruntime==1.20.1 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform
</code></pre>
<p>@reyammer I've kept the version at <code>onnxruntime==1.19.2</code> to fix my problem. FWIW, I'm using python <code>3.12</code> in my app.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/9711.html">astral-sh/uv#9711</a> on 2024-12-07 20:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../crewAIInc/crewAI-tools/issues/136.html">crewAIInc/crewAI-tools#136</a> on 2025-01-01 03:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../google/magika/issues/922.html">google/magika#922</a> on 2025-01-24 10:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../google/magika/issues/928.html">google/magika#928</a> on 2025-01-24 12:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:33 UTC
    </footer>
</body>
</html>
