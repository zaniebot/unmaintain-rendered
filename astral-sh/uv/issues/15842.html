<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Question] Do I have to copy every workspace member in my Dockerfile? - astral-sh/uv #15842</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Question] Do I have to copy every workspace member in my Dockerfile?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15842">#15842</a>
        opened by <a href="https://github.com/vaibhavmano">@vaibhavmano</a>
        on 2025-09-14 16:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/vaibhavmano">@vaibhavmano</a> on 2025-09-14 16:55</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I'm currently in the process of migrating an existing codebase in my org to use uv as a package manager. It's a monorepo and having the ability to setup workspaces within a single repo was amazing. I'm still running into an issue for building a Docker image with the <code>uv.lock</code> file.</p>
<p>Below is my folder structure.</p>
<pre><code>org-backend 
└── src
    └── base
        └── ..
        └── pyproject.toml
    └── bo
        └── ..
        └── pyproject.toml
└── application
   └── ..
   └── pyproject.toml
└── pyproject.toml
</code></pre>
<p>Here's the root <code>pyproject.toml</code></p>
<pre><code>[project]
name = &quot;org-backend&quot;
version = &quot;0.1.0&quot;
description = &quot;..&quot;
readme = &quot;README.md&quot;
requires-python = &quot;==3.12.*&quot;

[tool.uv.workspace]
members = [&quot;src/base&quot;, &quot;src/bo&quot;, &quot;application&quot;]

[tool.uv.sources]
base = { workspace = true }
bo = { workspace = true }
application = { workspace = true }
</code></pre>
<p>The root <code>pyproject.toml</code> contains <code>base</code>, <code>bo</code> and <code>application</code> as a workspace member. While building the Docker image for <code>application</code> service, I only copy the following <code>/src/base</code> and <code>/application</code>.</p>
<pre><code># Dockerfile for application
RUN pip install uv==0.8.17

COPY ./src/base /org-backend/src/base

COPY application /org-backend/application

COPY pyproject.toml /org-backend/
COPY uv.lock /org-backend/


WORKDIR /org-backend
RUN uv sync --locked --active --no-group dev --package application
</code></pre>
<p>Here's the error message when building with above docker file, <code> The lockfile at 'uv.lock' needs to be updated, but '--locked' was provided. To update the lockfile, run 'uv lock'.</code></p>
<p>I have not copied the <code>/bo</code>. Even though it's a workspace member, <code>application</code> service has no need of this package. I assumed <code>--package</code> flag will resolve this but since <code>bo</code> is mentioned in the root pyproject.toml, the docker image build keeps failing because it wants to regenerate the lock file.</p>
<p>My question is do I have to copy every workspace member? If not, what would be the best approach to build an image?</p>
<p>If yes, this is going to be a hassle since I have 4-5 packages and over 15 services. Everything will be defined as a workspace member and the 15 services will not even be related to each other. Having to copy them is going to wreak havoc and also contain unnecessary code!</p>
<h3>Platform</h3>
<p>macOS 15.6.1</p>
<h3>Version</h3>
<p>uv 0.8.17 (10960bc13 2025-09-10)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @vaibhavmano on 2025-09-14 16:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vaibhavmano">@vaibhavmano</a> on 2025-09-25 02:45</div>
            <div class="timeline-body"><p>Follow up: I can run <code>uv sync</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @vaibhavmano on 2025-09-25 02:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:12 UTC
    </footer>
</body>
</html>
