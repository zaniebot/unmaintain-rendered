<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip` ignores `.python-version` file - astral-sh/uv #9581</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv pip</code> ignores <code>.python-version</code> file</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/9581">#9581</a>
        opened by <a href="https://github.com/oliversen">@oliversen</a>
        on 2024-12-02 19:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/oliversen">@oliversen</a></div>
            <div class="timeline-body"><p>Currently, for any <code>uv pip</code> commands, you must explicitly specify the <code>--python-version</code> option. The <code>.python-version</code> file is ignored. Why?</p>
<p>uv 0.5.4
Windows 10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-02 20:12</div>
            <div class="timeline-body"><p>Can you share the specific <code>uv pip</code> command you&#x27;re using? We might want different behavior per <code>uv pip</code> command.</p>
<p>Regardless, the goal of the <code>uv pip</code> interface is compatibility with <code>pip</code> which does not read these files. We need a strong justification to differ from the upstream.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-12-03 02:13</div>
            <div class="timeline-body"><p>Agreed, I believe this would be a breaking change</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-06 00:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-06 00:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/oliversen">@oliversen</a> on 2024-12-06 19:28</div>
            <div class="timeline-body"><blockquote>
<p>Can you share the specific <code>uv pip</code> command you&#x27;re using?</p>
</blockquote>
<p>I am using uv in the build of an extension. First, I use the command <code>uv export --only-group bundle -o ./tmp/bundle-reqs.txt</code>. And this command uses the <code>.python-version</code> file. Then I use <code>uv pip install -r ./tmp/bundle-reqs.txt --target ./bundled/libs --python-version 3.9</code>. Here I have to add <code>--python-version 3.9</code>. When I need to change the python version, I will have to change it in two places, which I need to keep in mind. It seems to me that this is not predictable and confusing. Also the fact that <code>uv pip</code> ignores the <code>.python-version</code> file is not mentioned anywhere in the documentation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ollie-bell">@ollie-bell</a> on 2024-12-30 14:23</div>
            <div class="timeline-body"><p>Having a &quot;single source of truth&quot; for the python version in either <code>pyproject.toml</code> or <code>.python-version</code> file isn&#x27;t currently straightforwardly achievable when using <code>uv pip ...</code> as it is when using native <code>uv ...</code> commands.</p>
<p>It would be nice if for example <code>uv pip compile</code> defaults <code>--python-version</code> if not explicitly given to the value in <code>.python-version</code> file or the <code>requires-python</code> in <code>pyproject.toml</code>.</p>
<p>If it is too tricky or undesirable to untangle with the current default / pip compatibility for the version of the Python interpreter used, then perhaps a new option could be added like <code>--python-version-file</code> similar to how the <a href="https://github.com/actions/setup-python/blob/main/docs/advanced-usage.md#using-the-python-version-file-input"><code>setup-python</code> action allows</a>? Or perhaps <code>--python-version</code> could accept a filename of <code>pyproject.toml</code> or <code>.python-version</code> as an argument?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/staticf0x">@staticf0x</a> on 2025-02-12 13:32</div>
            <div class="timeline-body"><p>I can reproduce this issue.</p>
<p><strong>.python-version</strong>:</p>
<pre><code>3.12
</code></pre>
<p><strong>pyproject.toml</strong></p>
<pre><code>requires-python = &quot;&gt;=3.12&quot;
</code></pre>
<p>Result of <code>$ uv python find</code>: <code>/usr/bin/python3.12</code></p>
<p>The default system python, though, is 3.9: <code>$ command -v python3</code> -&gt; <code>/usr/bin/python3</code> and <code>$ python3 --version</code> -&gt; <code>Python 3.9.21</code>.</p>
<p>So <code>uv</code> can definitely find the 3.12 if I ask it to, but here&#x27;s what&#x27;s happen with <code>uv pip compile</code>:</p>
<pre><code>$ uv -v pip compile requirements.in
[...]
DEBUG Starting Python discovery for a default Python
DEBUG Looking for exact match for request a default Python
DEBUG Searching for default Python interpreter in virtual environments, managed installations, or search path
DEBUG Searching for managed installations at `/home/renovate/.local/share/uv/python`
DEBUG Found `cpython-3.9.21-linux-x86_64-gnu` at `/usr/bin/python` (first executable in the search path)
DEBUG Using Python 3.9.21 interpreter at /usr/bin/python for builds
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.9.21
DEBUG Solving with target Python version: &gt;=3.9.21
</code></pre>
<p>The same happens with <code>UV_PYTHON=3.12</code>.</p>
<p>However, if I specify <code>-p</code> directly:</p>
<pre><code>$ uv -v pip compile -p 3.12 requirements.in
[...]
DEBUG Starting Python discovery for Python 3.12
DEBUG Looking for exact match for request Python 3.12
DEBUG Searching for Python 3.12 in virtual environments, managed installations, or search path
DEBUG Searching for managed installations at `/home/renovate/.local/share/uv/python`
DEBUG Found `cpython-3.12.5-linux-x86_64-gnu` at `/usr/bin/python3.12` (first executable in the search path)
DEBUG Using Python 3.12.5 interpreter at /usr/bin/python3.12 for builds
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.12.5
DEBUG Solving with target Python version: &gt;=3.12
</code></pre>
<p>So not only it ignores <code>.python-version</code>, but also <code>UV_PYTHON</code>.</p>
<p>Edit: using <code>uv 0.5.30</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-13 19:41</div>
            <div class="timeline-body"><p>With #11486 we&#x27;ll respect <code>UV_PYTHON</code> in <code>uv pip compile</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/staticf0x">@staticf0x</a> on 2025-02-17 08:42</div>
            <div class="timeline-body"><p>Can confirm with 0.6.0 that <code>UV_PYTHON</code> is honored, but <code>.python-version</code> still isn&#x27;t.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:35:54 UTC
    </footer>
</body>
</html>
