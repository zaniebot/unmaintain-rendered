```yaml
number: 16495
title: uv build errors on exception, uv sync does not
type: issue
state: closed
author: Timoses
labels:
  - great writeup
  - external
assignees: []
created_at: 2025-10-29T14:06:30Z
updated_at: 2025-11-09T03:13:42Z
url: https://github.com/astral-sh/uv/issues/16495
synced_at: 2026-01-10T01:57:36Z
```

# uv build errors on exception, uv sync does not

---

_Issue opened by @Timoses on 2025-10-29 14:06_

### Summary

When raising an exception in `setup.py` using `cmdclass` *uv build* will fail, however *uv sync* will simply ignore the raised exception.

```
> uv build &> /dev/null ; echo $?
2
> uv sync --reinstall &> /dev/null ; echo $?
0
```

`uv sync -v --reinstall` will also show the Exception in the log, however it just ignores it and successfully syncs.

setup.py:
```
from setuptools import setup
from setuptools.command.build_py import build_py as _build_py

class CustomBuildPy(_build_py):
    def run(self):
        raise Exception
        super().run()

setup(cmdclass={ "build_py": CustomBuildPy, })
```

pyproject.toml
```
[project]
name = "test"
version = "0.0.0"


[build-system]
requires = [
    "setuptools",
]
build-backend = "setuptools.build_meta"

[tool.setuptools.package-dir]
"test" = "test"
```

test/__init__.py:
```
print('test')
```

### Platform

Linux 6.1.0-40-amd64 x86_64 GNU/Linux

### Version

uv 0.9.5

### Python version

Python 3.13.7

---

_Label `bug` added by @Timoses on 2025-10-29 14:06_

---

_Label `bug` removed by @konstin on 2025-10-29 14:51_

---

_Label `great writeup` added by @konstin on 2025-10-29 14:51_

---

_Label `external` added by @konstin on 2025-10-29 14:51_

---

_Comment by @konstin on 2025-10-29 14:52_

This is a problem in setuptools: With a regular build (`uv build`), setuptools errors, but with an editable build (the `uv sync` default), setuptools finishes successfully and returns and editable wheel for uv to install. You can make `uv sync` fail the same way as`uv build` by switching to a non-editable build with `uv sync --no-editable`.

Setuptools shows a matching warning:

```
DEBUG 
DEBUG                         If you are seeing this warning it is very likely that a setuptools
DEBUG                         plugin or customization overrides the `build_py` command, without
DEBUG                         taking into consideration how editable installs run build steps
DEBUG                         starting from setuptools v64.0.0.
DEBUG 
DEBUG                         Plugin authors and developers relying on custom build steps are
DEBUG                         encouraged to update their `build_py` implementation considering the
DEBUG                         information about editable installs in
DEBUG                         https://setuptools.pypa.io/en/latest/userguide/extension.html.
DEBUG 
DEBUG                         For the time being `setuptools` will silence this error and ignore
DEBUG                         the faulty command, but this behavior will change in future versions.
```

---

_Closed by @zanieb on 2025-11-09 03:13_

---
