<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV ignore pypi index-url when extra-index-url set. - astral-sh/uv #5096</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UV ignore pypi index-url when extra-index-url set.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5096">#5096</a>
        opened by <a href="https://github.com/kimdwkimdw">@kimdwkimdw</a>
        on 2024-07-16 06:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kimdwkimdw">@kimdwkimdw</a> on 2024-07-16 06:01</div>
            <div class="timeline-body"><p>uv's index-url didn't work in ENVVAR or command args. https://github.com/astral-sh/uv?tab=readme-ov-file#environment-variables</p>
<h2>it should work, but didn't work - (1)</h2>
<ul>
<li>pip's default index-url is &quot;https://pypi.org/simple&quot;.</li>
</ul>
<pre><code>[tool.uv.pip]
extra-index-url = [&quot;https://pypi.custom.ai/&quot;]
</code></pre>
<h2>it should work, but didn't work - (2)</h2>
<pre><code>[tool.uv.pip]
index-url= &quot;https://pypi.org/simple&quot;
extra-index-url = [&quot;https://pypi.custom.ai/&quot;]
</code></pre>
<h2>current workaround</h2>
<pre><code>[tool.uv.pip]
extra-index-url = [&quot;https://pypi.org/simple&quot;, &quot;https://pypi.custom.ai/&quot;]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/j178">@j178</a> on 2024-07-16 06:32</div>
            <div class="timeline-body"><p>Please check https://github.com/astral-sh/uv/blob/main/PIP_COMPATIBILITY.md#packages-that-exist-on-multiple-indexes and <code>uv help pip compile</code>:</p>
<pre><code>   --extra-index-url &lt;EXTRA_INDEX_URL&gt;
          Extra URLs of package indexes to use, in addition to `--index-url`.

          Accepts either a repository compliant with PEP 503 (the simple repository
          API), or a local directory laid out in the same format.

          All indexes given via this flag take priority over the index in
          `--index-url` (which defaults to PyPI). And when multiple
          `--extra-index-url` flags are given, earlier values take priority.

          [env: UV_EXTRA_INDEX_URL=]    

   --index-strategy &lt;INDEX_STRATEGY&gt;
          The strategy to use when resolving against multiple index URLs.

          By default, `uv` will stop at the first index on which a given package is
          available, and limit resolutions to those present on that first index
          (`first-match`). This prevents &quot;dependency confusion&quot; attacks, whereby an
          attack can upload a malicious package under the same name to a secondary.

          [env: UV_INDEX_STRATEGY=]

          Possible values:
          - first-index:        Only use results from the first index that returns a
            match for a given package name
          - unsafe-first-match: Search for every package name across all indexes,
            exhausting the versions from the first index before moving on to the
            next
          - unsafe-best-match:  Search for every package name across all indexes,
            preferring the &quot;best&quot; version found. If a package version is in multiple
            indexes, only look at the entry for the first index
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kimdwkimdw">@kimdwkimdw</a> on 2024-07-16 08:00</div>
            <div class="timeline-body"><p>@j178</p>
<p>Sorry, I didnâ€™t thoroughly review the documentation. It would be better if it supports the same functionality as pip in the future.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @kimdwkimdw on 2024-07-16 08:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-07-16 14:17</div>
            <div class="timeline-body"><blockquote>
<p>It would be better if it supports the same functionality as pip in the future.</p>
</blockquote>
<p>FYI uv's default behavior is more secure than pip's and should mitigate real world attacks:  https://pytorch.org/blog/compromised-nightly-dependency/</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shoang22">@shoang22</a> on 2024-11-04 16:05</div>
            <div class="timeline-body"><p>Hi, I'm running into this same issue. I'm not sure what I'm supposed to do to get UV to fall back to the default index.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Sairam90">@Sairam90</a> on 2024-11-25 15:39</div>
            <div class="timeline-body"><p>If --extra-index-url and --index-url are both specified which url will be searched first ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-25 18:42</div>
            <div class="timeline-body"><p><code>--extra-index-url</code> takes priority over <code>--index-url</code>. Please see https://docs.astral.sh/uv/pip/compatibility/#packages-that-exist-on-multiple-indexes.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:38:38 UTC
    </footer>
</body>
</html>
