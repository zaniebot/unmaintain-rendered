<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `--no-deps` support when installing via `uv run --with &lt;pkg&gt;`? - astral-sh/uv #13029</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>--no-deps</code> support when installing via <code>uv run --with &lt;pkg&gt;</code>?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13029">#13029</a>
        opened by <a href="https://github.com/LewisGaul">@LewisGaul</a>
        on 2025-04-21 22:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/LewisGaul">@LewisGaul</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Currently <code>uv run</code> supports installing specified packages under <code>--with</code>, but does not support <code>--no-deps</code> to prevent installing their dependencies.</p>
<h3>Example</h3>
<p>This is probably quite a niche use-case, but here it is:</p>
<pre><code class="language-bash">PACKAGE=python_on_whales
uv run --with $PACKAGE --reinstall -- python3 -c &quot;import importlib.metadata; print('Package $PACKAGE:', importlib.metadata.version('$PACKAGE'))&quot;
</code></pre>
<p>That is, I was hoping to use <code>uv run</code> as a one-liner to get a package's metadata (and for this there's no need to install the package's dependencies).</p>
<p>I realise this information is available at <code>&lt;download_url&gt;.metadata</code> for pypi.org, e.g. <code>https://files.pythonhosted.org/packages/&lt;XX&gt;/&lt;XX&gt;/&lt;XXX...&gt;/&lt;pkg&gt;-&lt;version&gt;-py3-none-any.whl.metadata</code>, however other PyPI instances such as Artifactory may not implement this, and packages may be installed from other sources.</p>
<p>My current workaround is to do it in three steps, something like this:</p>
<pre><code class="language-bash">cd &quot;$MY_TEMP_DIR&quot;
uv venv --quiet
uv pip install $PACKAGE -p .venv/bin/python3 --no-deps
.venv/bin/python3 -c &quot;import importlib.metadata; print('Package $PACKAGE:', importlib.metadata.version('$PACKAGE'))&quot;
rm -r &quot;$MY_TEMP_DIR&quot;
</code></pre>
<p>Of course this could alternatively be supported via a dedicated new command such as <code>uv search $PACKAGE --metadata</code>, <code>uv package metadata $PACKAGE --json</code>, ...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @LewisGaul on 2025-04-21 22:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-22 01:37</div>
            <div class="timeline-body"><p>Yeah, I think we'll just want to expose other ways to get package metadata â€” I'm not comfortable with the pattern of installing packages without their dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/LewisGaul">@LewisGaul</a> on 2025-04-22 08:48</div>
            <div class="timeline-body"><p>I guess the <code>--no-deps</code> flag was mainly added for pip compatibility, and I can understand not wanting it on all commands.</p>
<p>Shall I rephrase the issue to be around exposing package metadata, or close and open a new one?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:31:01 UTC
    </footer>
</body>
</html>
