```yaml
number: 16122
title: "uv does not use system site packages like `tree-sitter-*`"
type: issue
state: closed
author: NSPC911
labels:
  - bug
assignees: []
created_at: 2025-10-04T05:00:30Z
updated_at: 2025-10-06T10:34:52Z
url: https://github.com/astral-sh/uv/issues/16122
synced_at: 2026-01-12T16:02:24Z
```

# uv does not use system site packages like `tree-sitter-*`

---

_@NSPC911_

### Summary

On [termux](https://github.com/termux/termux-app), the mirror does not provide some tree-sitter packages, but one of it that it provides is `tree-sitter-markdown`.
```sh
~/test $ pkg install tree-sitter-markdown
```
is successful
Attempting to install it via `pip` into the environment is successful
```sh
~/test $ python -m venv --system-site-packages
~/test $ source .venv/bin/activate
((.venv) ) ~/test $ pip install tree-sitter-markdown
Requirement already satisfied: tree-sitter-markdown in /data/data/com.termux/files/usr/lib/python3.12/site-packages (0.5.1)
```
but if the same thing with uv is attempted
```sh
~/test $ uv venv --system-site-packages
Using CPython 3.12.11 interpreter at: /data/data/com.termux/files/usr/bin/python3
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
~/test $ source .venv/bin/activate
(test) ~/test $ uv pip install setuptools
Resolved 1 package in 114ms
Installed 1 package in 44ms
 + setuptools==80.9.0
(test) ~/test $ uv pip install tree-sitter-markdown
```
it gives me a massive error message
<details>
<summary>error</summary>
<p>

```
(test) ~/test $ uv pip install tree-sitter-markdown
Resolved 1 package in 15ms
  × Failed to build `tree-sitter-markdown==0.5.1`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta.build_wheel` failed (exit status: 1)

      [stdout]
      running bdist_wheel
      running build
      running build_py
      copying bindings/python/tree_sitter_markdown/__init__.py ->
      build/lib.linux-aarch64-cpython-312/tree_sitter_markdown
      running egg_info
      writing bindings/python/tree_sitter_markdown.egg-info/PKG-INFO
      writing dependency_links to
      bindings/python/tree_sitter_markdown.egg-info/dependency_links.txt
      writing requirements to
      bindings/python/tree_sitter_markdown.egg-info/requires.txt
      writing top-level names to
      bindings/python/tree_sitter_markdown.egg-info/top_level.txt
      reading manifest file
      'bindings/python/tree_sitter_markdown.egg-info/SOURCES.txt'
      adding license file 'LICENSE'
      writing manifest file
      'bindings/python/tree_sitter_markdown.egg-info/SOURCES.txt'
      copying bindings/python/tree_sitter_markdown/__init__.pyi ->
      build/lib.linux-aarch64-cpython-312/tree_sitter_markdown
      copying bindings/python/tree_sitter_markdown/binding.c ->
      build/lib.linux-aarch64-cpython-312/tree_sitter_markdown
      copying bindings/python/tree_sitter_markdown/py.typed ->
      build/lib.linux-aarch64-cpython-312/tree_sitter_markdown
      running build_ext
      building '_binding' extension
      aarch64-linux-android-clang -fno-strict-overflow -Wsign-compare
      -Wunreachable-code -DNDEBUG -g -O3 -Wall -fstack-protector-strong
      -O3 -fstack-protector-strong -O3 -fPIC -DPy_LIMITED_API=0x03090000
      -DPY_SSIZE_T_CLEAN -Itree-sitter-markdown/src
      -I/data/data/com.termux/files/home/.cache/uv/builds-v0/.tmpy93Vol/include
      -I/data/data/com.termux/files/usr/include/python3.12
      -c bindings/python/tree_sitter_markdown/binding.c -o
      build/temp.linux-aarch64-cpython-312/bindings/python/tree_sitter_markdown/binding.o
      -std=c11
      aarch64-linux-android-clang -fno-strict-overflow -Wsign-compare
      -Wunreachable-code -DNDEBUG -g -O3 -Wall -fstack-protector-strong
      -O3 -fstack-protector-strong -O3 -fPIC -DPy_LIMITED_API=0x03090000
      -DPY_SSIZE_T_CLEAN -Itree-sitter-markdown/src
      -I/data/data/com.termux/files/home/.cache/uv/builds-v0/.tmpy93Vol/include
      -I/data/data/com.termux/files/usr/include/python3.12
      -c tree-sitter-markdown-inline/src/parser.c -o
      build/temp.linux-aarch64-cpython-312/tree-sitter-markdown-inline/src/parser.o
      -std=c11

      [stderr]
      /data/data/com.termux/files/home/.cache/uv/builds-v0/.tmpy93Vol/lib/python3.12/site-packages/setuptools/config/_apply_pyprojecttoml.py:82:
      SetuptoolsDeprecationWarning: `project.license` as a TOML table is
      deprecated
      !!


      ********************************************************************************
              Please use a simple string containing a SPDX expression for
      `project.license`. You can also use `project.license-files`. (Both
      options available on setuptools>=77.0.0).

              By 2026-Feb-18, you need to update your project and remove
      deprecated calls
              or your builds will no longer be supported.

              See
      https://packaging.python.org/en/latest/guides/writing-pyproject-toml/#license
      for details.

      ********************************************************************************

      !!
        corresp(dist, value, root_dir)
      /data/data/com.termux/files/home/.cache/uv/builds-v0/.tmpy93Vol/lib/python3.12/site-packages/setuptools/config/_apply_pyprojecttoml.py:61:
      SetuptoolsDeprecationWarning: License classifiers are deprecated.
      !!


      ********************************************************************************
              Please consider removing the following classifiers in favor
      of a SPDX license expression:

              License :: OSI Approved :: MIT License

              See
      https://packaging.python.org/en/latest/guides/writing-pyproject-toml/#license
      for details.

      ********************************************************************************

      !!
        dist._finalize_license_expression()
      /data/data/com.termux/files/home/.cache/uv/builds-v0/.tmpy93Vol/lib/python3.12/site-packages/setuptools/dist.py:759:
      SetuptoolsDeprecationWarning: License classifiers are deprecated.
      !!


      ********************************************************************************
              Please consider removing the following classifiers in favor
      of a SPDX license expression:

              License :: OSI Approved :: MIT License

              See
      https://packaging.python.org/en/latest/guides/writing-pyproject-toml/#license
      for details.

      ********************************************************************************

      !!
        self._finalize_license_expression()
      tree-sitter-markdown-inline/src/parser.c:3:10: fatal error:
      'tree_sitter/parser.h' file not found
          3 | #include "tree_sitter/parser.h"
            |          ^~~~~~~~~~~~~~~~~~~~~~
      1 error generated.
      error: command
      '/data/data/com.termux/files/usr/bin/aarch64-linux-android-clang'
      failed with exit code 1

      hint: This error likely indicates that you need to install a library
      that provides "tree_sitter/parser.h" for `tree-sitter-markdown@0.5.1`
```

</p>
</details>

### Platform

Linux 6.1.118-android14-11-og52b3868cccc0 aarch64 android

### Version

0.8.22

### Python version

Python 3.12.11

---

_Label `bug` added by @NSPC911 on 2025-10-04 05:00_

---

_Comment by @robertkirkman on 2025-10-04 05:07_

Don't forget to add that these additional commands are currently necessary for the reproduction steps in between the `pkg install tree-sitter-markdown` command and the `python -m venv --system-site-packages` command:

```bash
git clone https://github.com/tree-sitter-grammars/tree-sitter-markdown.git
cd tree-sitter-markdown
pip install .
```

(I noticed that those commands weren't given here as part of the reproduction steps, I assumed that you might have forgotten to add them)

---

_Comment by @konstin on 2025-10-06 08:48_

uv currently can't read system site packages, this is mainly tracked in https://github.com/astral-sh/uv/issues/2500

---

_Comment by @NSPC911 on 2025-10-06 10:34_

ah okay, thanks for the follow up!


---

_Closed by @NSPC911 on 2025-10-06 10:34_

---
