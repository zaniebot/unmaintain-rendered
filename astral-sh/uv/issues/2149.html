<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invalid wheel: pip OK but uv KO - astral-sh/uv #2149</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Invalid wheel: pip OK but uv KO</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2149">#2149</a>
        opened by <a href="https://github.com/AntoineD">@AntoineD</a>
        on 2024-03-04 09:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AntoineD">@AntoineD</a> on 2024-03-04 09:50</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>Hello,</p>
<p>when trying to install the package <code>openturns</code>, which is installable with <code>pip</code>, I get the following error</p>
<pre><code class="language-shell">‚ùØ uv pip install openturns   
Resolved 3 packages in 351ms
error: Failed to install: openturns-1.22-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (openturns==1.22)
  Caused by: The wheel is invalid: Line 3 of the WHEEL file is invalid
</code></pre>
<p>This is the contents of <code>WHEEL</code>:</p>
<pre><code class="language-shell">‚ùØ cat openturns-1.22.dist-info/WHEEL
Wheel-Version: 1.0
Generator: custom
Root-Is-Purelib: false
Tag: 
Tag: -manylinux_2_17_x86_64
Tag: -manylinux2014_x86_64
</code></pre>
<p>Is this issue on <code>uv</code>'s side?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pfmoore">@pfmoore</a> on 2024-03-04 11:10</div>
            <div class="timeline-body"><p>Pip doesn't check the <code>WHEEL</code> file as far as I'm aware, so it looks like <code>uv</code> is being more strict here. But line <em>three</em> (which is what the error points to) is <code>Root-Is-Purelib: false</code>, which is fine. The <code>Tag</code> lines, though, <em>are</em> invalid - an empty <code>Tag</code> isn't valid, and the other two tags seem incomplete (should be <code>cp312-cp312-manylinux2014_x86_64</code> and <code>cp312-cp312-manylinux_2_17_x86_64</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2151.html">astral-sh/uv#2151</a> on 2024-03-04 11:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-04 11:51</div>
            <div class="timeline-body"><p>Sorry that's just an off-by-one error separate from this issue, fixed in #2151.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-03-04 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-03-04 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../openturns/build-wheels/issues/2.html">openturns/build-wheels#2</a> on 2024-03-04 16:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-04 17:07</div>
            <div class="timeline-body"><p>Is the alternative here that we ignore all invalid tag entries?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pfmoore">@pfmoore</a> on 2024-03-04 18:37</div>
            <div class="timeline-body"><p>Pip just uses the tags from the wheel filename. The <code>WHEEL</code> file is[^1] simply duplicating that information, so we just don't bother reading it. If you're using what's in the <code>WHEEL</code> file rather than what's in the filename, then you're going to have to deal with the fact that there might be garbage in there that's never been noticed before, precisely because pip never cared and nobody else bothered validating the data.</p>
<p>[^1]: Or at least <em>should</em> be üôÅ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-04 18:38</div>
            <div class="timeline-body"><p>Thanks for the context! I think we should only warn about invalid <code>WHEEL</code> files then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 18:49</div>
            <div class="timeline-body"><p>Yeah I don't think we <em>use</em> the information, but we do seem to validate it. I actually don't think we even validate the tags, we just choke if the value is empty AFAICT.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by @charliermarsh on 2024-03-04 19:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-03-04 19:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-03-04 19:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 19:21</div>
            <div class="timeline-body"><p>I'll fix this real quick.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2170.html">astral-sh/uv#2170</a> on 2024-03-04 19:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-04 19:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../justin-yan/pybin/issues/13.html">justin-yan/pybin#13</a> on 2024-03-27 22:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:24 UTC
    </footer>
</body>
</html>
