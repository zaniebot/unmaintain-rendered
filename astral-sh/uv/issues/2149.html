<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invalid wheel: pip OK but uv KO - astral-sh/uv #2149</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Invalid wheel: pip OK but uv KO</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2149">#2149</a>
        opened by <a href="https://github.com/AntoineD">@AntoineD</a>
        on 2024-03-04 09:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AntoineD">@AntoineD</a></div>
            <div class="timeline-body">

<p>Hello,</p>
<p>when trying to install the package <code>openturns</code>, which is installable with <code>pip</code>, I get the following error</p>
<pre><code>‚ùØ uv pip install openturns   
Resolved 3 packages in 351ms
error: Failed to install: openturns-1.22-cp312-cp312-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (openturns==1.22)
  Caused by: The wheel is invalid: Line 3 of the WHEEL file is invalid
</code></pre>
<p>This is the contents of <code>WHEEL</code>:</p>
<pre><code>‚ùØ cat openturns-1.22.dist-info/WHEEL
Wheel-Version: 1.0
Generator: custom
Root-Is-Purelib: false
Tag: 
Tag: -manylinux_2_17_x86_64
Tag: -manylinux2014_x86_64
</code></pre>
<p>Is this issue on <code>uv</code>&#x27;s side?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pfmoore">@pfmoore</a> on 2024-03-04 11:10</div>
            <div class="timeline-body"><p>Pip doesn&#x27;t check the <code>WHEEL</code> file as far as I&#x27;m aware, so it looks like <code>uv</code> is being more strict here. But line <em>three</em> (which is what the error points to) is <code>Root-Is-Purelib: false</code>, which is fine. The <code>Tag</code> lines, though, <em>are</em> invalid - an empty <code>Tag</code> isn&#x27;t valid, and the other two tags seem incomplete (should be <code>cp312-cp312-manylinux2014_x86_64</code> and <code>cp312-cp312-manylinux_2_17_x86_64</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-04 11:51</div>
            <div class="timeline-body"><p>Sorry that&#x27;s just an off-by-one error separate from this issue, fixed in #2151.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 14:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-04 17:07</div>
            <div class="timeline-body"><p>Is the alternative here that we ignore all invalid tag entries?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pfmoore">@pfmoore</a> on 2024-03-04 18:37</div>
            <div class="timeline-body"><p>Pip just uses the tags from the wheel filename. The <code>WHEEL</code> file is[^1] simply duplicating that information, so we just don&#x27;t bother reading it. If you&#x27;re using what&#x27;s in the <code>WHEEL</code> file rather than what&#x27;s in the filename, then you&#x27;re going to have to deal with the fact that there might be garbage in there that&#x27;s never been noticed before, precisely because pip never cared and nobody else bothered validating the data.</p>
<p>[^1]: Or at least <em>should</em> be üôÅ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-04 18:38</div>
            <div class="timeline-body"><p>Thanks for the context! I think we should only warn about invalid <code>WHEEL</code> files then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 18:49</div>
            <div class="timeline-body"><p>Yeah I don&#x27;t think we <em>use</em> the information, but we do seem to validate it. I actually don&#x27;t think we even validate the tags, we just choke if the value is empty AFAICT.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 19:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 19:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 19:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 19:21</div>
            <div class="timeline-body"><p>I&#x27;ll fix this real quick.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 19:39</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:30:13 UTC
    </footer>
</body>
</html>
