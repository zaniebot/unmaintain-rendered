```yaml
number: 7250
title: Respect $CARGO_HOME
type: issue
state: closed
author: yochem
labels:
  - releases
assignees: []
created_at: 2024-09-10T09:58:54Z
updated_at: 2024-09-30T10:44:36Z
url: https://github.com/astral-sh/uv/issues/7250
synced_at: 2026-01-10T01:57:16Z
```

# Respect $CARGO_HOME

---

_Issue opened by @yochem on 2024-09-10 09:58_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

- Minimal code: -
- Platform: MacOS
- Version: uv 0.3.1 (be17d132a 2024-08-21)

uv does not respect [`$CARGO_HOME`](https://doc.rust-lang.org/stable/cargo/guide/cargo-home.html#cargo-home), used to change the location of the the default `$HOME/.cargo` folder.

For example, I use the fish shell, and uv creates a file `$XDG_CONFIG_HOME/fish/conf.d/uv.env.fish` with the following content:

```fish

source "$HOME/.cargo/env.fish"
```

Changing this to 

```fish
set -q CARGO_HOME; or set CARGO_HOME "$HOME/.cargo"

source "$CARGO_HOME/env.fish"
```

fixes this.

For bash/zsh it's even simpler:

```bash
source "${CARGO_HOME:-"$HOME/.cargo"}/env"
```

Context: My `$CARGO_HOME` is set to `"$XDG_DATA_HOME/cargo"` to respect the [XDG base directory spec](https://wiki.archlinux.org/title/XDG_Base_Directory).

---

_Label `releases` added by @zanieb on 2024-09-10 12:56_

---

_Comment by @Gankra on 2024-09-19 18:24_

Hello there from cargo-dist, the project that generates this installer.

[We *should* be respecting CARGO_HOME on install](https://github.com/axodotdev/cargo-dist/blob/81ca476c43ca4016ca0a50cc03c32892ec0e63b4/cargo-dist/templates/installer/installer.sh.j2#L473-L478), but we actually replicate the behaviour of rustup here: we assume that anyone who is setting CARGO_HOME was doing so on a temporary basis for the duration of the install, and then resolve its value so that things will keep working even if it becomes unset.

See the equivalent issue in rustup: https://github.com/rust-lang/rustup/issues/3020

---

_Comment by @yochem on 2024-09-22 06:51_

Thank you for your explanation. I'm not vey familiar with the rust ecosystem, so this explanation certainly helps! 

When I read the linked issue thread, it seems that my best way to resolve the issue is to reinstall Rust and friends, and setting the cargo home env variable during rust installation.

---

_Closed by @yochem on 2024-09-30 10:44_

---
