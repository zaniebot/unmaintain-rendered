<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Failed to fetch ssh+git dependencies when host is not known - astral-sh/uv #13356</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Failed to fetch ssh+git dependencies when host is not known</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/13356">#13356</a>
        opened by <a href="https://github.com/mia-trilo">@mia-trilo</a>
        on 2025-05-08 23:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mia-trilo">@mia-trilo</a> on 2025-05-08 23:45</div>
            <div class="timeline-body"><h3>Summary</h3>
<p><code>uv sync</code> seems to fail to install dependencies from an git link with SSH when the host isn't known. Based on the log it seems to be stuck on the &quot;yes/no/fingerprint&quot; prompt when ssh into a new host for the first time. Interestingly, cancelling and re-running <code>uv sync</code> again solves this problem, but it can be consistently reproduced with the <code>--no-cache</code> flag</p>
<p>To reproduce this issue:</p>
<ol>
<li>Create an empty project with the following <code>pyproject.toml</code></li>
</ol>
<pre><code class="language-toml">[project]
name = &quot;test&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [&quot;uv&quot;]

[tool.uv.sources]
uv = {git = &quot;ssh://git@github.com/astral-sh/uv.git&quot;}
</code></pre>
<ol start="2">
<li>Run <code>ssh-keygen -R github.com</code>. You can also manually delete all sources of <code>github.com</code> in <code>.ssh/known_hosts</code></li>
<li>Run <code>uv sync --no-cache</code>, observe that this process hangs</li>
</ol>
<h3>Platform</h3>
<p>macOS 15, M3. Also encountered on Raspberry Pi 4B</p>
<h3>Version</h3>
<p>0.7.3</p>
<h3>Python version</h3>
<p>3.12.4</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @mia-trilo on 2025-05-08 23:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @jtfmumm on 2025-05-09 08:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-05-09 08:40</div>
            <div class="timeline-body"><p>Thank your for filing this. Following your reproduction, I get the <code>yes/no/[fingerprint]</code> prompt since the host is unknown. If I enter <code>yes</code> then things continue as expected. If I run <code>uv clean</code> (clearing the cache), then <code>uv sync</code> will always hit the prompt after entering <code>no</code> and running again.</p>
<p>Just to be clear, when you say uv fails to fetch git dependencies, do you mean that you see the prompt and would need to manually enter <code>yes</code> to continue? Or are you seeing something else?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mia-trilo">@mia-trilo</a> on 2025-05-09 17:59</div>
            <div class="timeline-body"><p>So there are two issues here: first is, without running it in verbose mode I don't even see the prompt (looks like it got erased by the progress animation?), which made the impression that uv hangs without an apparent reason. I have not tried whether I could type yes to have it continue. See below screenshot for what it looks like in my actual repository and how there isn't  a prompt.</p>
<p><img width="569" alt="Image" src="https://github.com/user-attachments/assets/6b6b4f66-fe4a-43a2-b053-ec93e9ff3f47" /></p>
<p>Second, I encountered this as part of a package installation script. Having to manually intervene makes it more difficult to make the script work (presumably I would have to run <code>yes | uv sync</code> for every installation) without knowing the condition on the host machine</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-05-09 21:04</div>
            <div class="timeline-body"><p>Thanks for clarifying. Weâ€™ll investigate this.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:27 UTC
    </footer>
</body>
</html>
