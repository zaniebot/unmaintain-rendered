<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMake stub crashes when executed by VS Code - astral-sh/uv #6866</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>CMake stub crashes when executed by VS Code</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6866">#6866</a>
        opened by <a href="https://github.com/petermbauer">@petermbauer</a>
        on 2024-08-30 13:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/petermbauer">@petermbauer</a></div>
            <div class="timeline-body"><p>When installing CMake via <code>uv pip install</code> instead of <code>pip install</code>, the stub created by uv crashes with a segfault when executed by the <a href="https://github.com/microsoft/vscode-cmake-tools">CMake Tools</a> extension.</p>
<p><img src="https://github.com/user-attachments/assets/f8272e33-9d30-4607-a540-ee8dc2aa70e3" alt="image"></p>
<p>How to reproduce:</p>
<ul>
<li>make sure to have VS Code with the CMake Tools extension installed and some <a href="https://github.com/user-attachments/files/16817335/CMakeLists.txt">CMakeLists.txt</a> file in the current directory which is to be picked up by VS Code automatically.</li>
<li>run the following commands:</li>
</ul>
<pre><code>λ bin\uv.exe --version
uv 0.4.0 (d9bd3bc7a 2024-08-28)

λ bin\uv.exe venv myvenv
Using Python 3.10.9 interpreter at: ...
Creating virtualenv at: myvenv
Activate with: myvenv\Scripts\activate

λ bin\uv.exe pip install --python myvenv cmake==3.27.0
Resolved 1 package in 208ms
Installed 1 package in 1.97s
 + cmake==3.27.0

λ myvenv\Scripts\activate.bat

(myvenv) λ code .
</code></pre>
<ul>
<li>just select &quot;Unspecified kit&quot; to let CMake select one or any other installed kit that works for you</li>
<li>check the CMake/Build output</li>
</ul>
<p>When executed from the command line, <code>cmake</code> works as expected, same also from any terminal inside VS Code so i guess this is caused by VS Code executing the <code>cmake.exe</code> directly without a shell in between.</p>
<p>Most likely related to #6464.</p>
<p>Windows 10, Python 3.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/petermbauer">@petermbauer</a> on 2024-08-31 05:53</div>
            <div class="timeline-body"><p>No idea why it did not work when testing with the binary from #6792 but i can confirm that it works now with uv 0.4.1 so thanks a lot for the fix!
However, the same error output as mentioned in <a href="https://github.com/astral-sh/uv/issues/6699">astral-sh/uv#6699</a>#issuecomment-2322515962 also appears in VS Code.</p>
<pre><code>[build] Failed to close child file descriptors at 1
[build] Failed to close child file descriptors at 2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/petermbauer">@petermbauer</a> on 2024-08-31 05:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-09-04 22:45</div>
            <div class="timeline-body"><p>@petermbauer Would you be able to confirm 0.4.5 fixes the fd issue for you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/petermbauer">@petermbauer</a> on 2024-09-05 06:13</div>
            <div class="timeline-body"><blockquote>
<p>@petermbauer Would you be able to confirm 0.4.5 fixes the fd issue for you?</p>
</blockquote>
<p>yes, i can confirm. Thanks a lot!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:33:29 UTC
    </footer>
</body>
</html>
