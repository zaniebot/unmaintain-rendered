<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wheels built by uv with git+https dependencies wrongly installs a package from PyPI with the same name - astral-sh/uv #13405</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>wheels built by uv with git+https dependencies wrongly installs a package from PyPI with the same name</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13405">#13405</a>
        opened by <a href="https://github.com/soof-golan">@soof-golan</a>
        on 2025-05-12 10:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/soof-golan">@soof-golan</a> on 2025-05-12 10:37</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Evil twin of #13404</p>
<p>Hi!
For some reason I have not figured out yet, git+https dependency information is lost when consuming wheels or sdist assets produced by <code>uv build</code> (by default with hatchling as the build system)</p>
<h1>Reproduction</h1>
<pre><code class="language-bash">cd $(mktemp -d)
mkdir uv-build-repro &amp;&amp; cd uv-build-repro
uv init --lib
# The consumer of the wheel gets the results from PyPI, not the fork!
uv add git+https://github.com/soof-golan/uv-build-repro-more-itertools.git
uv build
export WHL_LOCATION=&quot;$(realpath dist/*.whl)&quot;

cd $(mktemp -d)
mkdir uv-build-whl-consumer &amp;&amp; cd uv-build-whl-consumer
uv init --lib
uv add &quot;$WHL_LOCATION&quot;
uv export
</code></pre>
<h2>Results</h2>
<pre><code class="language-plaintext">cd $(mktemp -d)
mkdir uv-build-repro &amp;&amp; cd uv-build-repro
uv init --lib
# The consumer of the wheel gets the results from PyPI, not the fork!
uv add git+https://github.com/soof-golan/uv-build-repro-more-itertools.git
uv build
export WHL_LOCATION=&quot;$(realpath dist/*.whl)&quot;

cd $(mktemp -d)
mkdir uv-build-whl-consumer &amp;&amp; cd uv-build-whl-consumer
uv init --lib
uv add &quot;$WHL_LOCATION&quot;
uv export
Initialized project `uv-build-repro`
Using CPython 3.10.17
Creating virtual environment at: .venv
Resolved 2 packages in 245ms
      Built uv-build-repro @ file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.h1FVDJdtYR/uv-build-repro
Prepared 1 package in 444ms
Installed 2 packages in 1ms
 + more-itertools==10.7.0 (from git+https://github.com/soof-golan/uv-build-repro-more-itertools.git@e922b86d1629b38610e2db6748574be543c34115)
 + uv-build-repro==0.1.0 (from file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.h1FVDJdtYR/uv-build-repro)
Building source distribution...
Building wheel from source distribution...
Successfully built dist/uv_build_repro-0.1.0.tar.gz
Successfully built dist/uv_build_repro-0.1.0-py3-none-any.whl
Initialized project `uv-build-whl-consumer`
Using CPython 3.10.17
Creating virtual environment at: .venv
Resolved 3 packages in 2ms
      Built uv-build-whl-consumer @ file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.RCQJIP9Kgd/uv-build-whl-consumer
Prepared 1 package in 128ms
Installed 3 packages in 1ms
 + more-itertools==10.7.0
 + uv-build-repro==0.1.0 (from file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.h1FVDJdtYR/uv-build-repro/dist/uv_build_repro-0.1.0-py3-none-any.whl)
 + uv-build-whl-consumer==0.1.0 (from file:///private/var/folders/hg/00n7d3zd42df09kn6k68y0640000gn/T/tmp.RCQJIP9Kgd/uv-build-whl-consumer)
Resolved 3 packages in 1ms
# This file was autogenerated by uv via the following command:
#    uv export
-e .
../../tmp.h1FVDJdtYR/uv-build-repro/dist/uv_build_repro-0.1.0-py3-none-any.whl \
    --hash=sha256:2ba6438d239fb36b04a340fb3b2cefb2b4ef1b2ca3c6a23ceab5938cfdfa690f
    # via uv-build-whl-consumer
more-itertools==10.7.0 \
    --hash=sha256:9fddd5403be01a94b204faadcff459ec3568cf110265d3c54323e1e866ad29d3 \
    --hash=sha256:d43980384673cb07d2f7d2d918c616b30c659c089ee23953f601d6609c67510e
    # via uv-build-repro
</code></pre>
<h3>Platform</h3>
<p>Darwin 24.3.0 arm64</p>
<h3>Version</h3>
<p>uv 0.7.3 (3c413f74b 2025-05-07)</p>
<h3>Python version</h3>
<p>Python 3.10.17</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @soof-golan on 2025-05-12 10:37</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "git+https://dependency information is lost when using uv build with hatchling" to "wheels built by uv with git+https dependencies wrongly installs a package from PyPI with the same name" by @soof-golan on 2025-05-12 11:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-12 14:02</div>
            <div class="timeline-body"><p><code>tool.uv.sources</code> are not applicable when building a wheel or installing from a pre-built wheel: https://docs.astral.sh/uv/concepts/projects/dependencies/#dependency-sources. <code>uv add</code> by default uses <code>tool.uv.sources</code>; you can use <code>uv add --raw-sources</code> to instead use PEP 508 syntax where possible</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-05-12 14:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-05-12 14:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-05-13 13:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13404.html">astral-sh/uv#13404</a> on 2025-05-13 19:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tsvikas">@tsvikas</a> on 2025-05-14 16:38</div>
            <div class="timeline-body"><blockquote>
<p><code>tool.uv.sources</code> are not applicable when building a wheel or installing from a pre-built wheel: https://docs.astral.sh/uv/concepts/projects/dependencies/#dependency-sources. <code>uv add</code> by default uses <code>tool.uv.sources</code>; you can use <code>uv add --raw-sources</code> to instead use PEP 508 syntax where possible</p>
</blockquote>
<p>Shouldn't the program fail to build or to publish if there is a non-applicable source? or at least show a warning to the user?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:06 UTC
    </footer>
</body>
</html>
