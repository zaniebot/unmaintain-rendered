<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using git versioning with a workspace module yields unwanted changes to uv.lock - astral-sh/uv #10054</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Using git versioning with a workspace module yields unwanted changes to uv.lock</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/10054">#10054</a>
        opened by <a href="https://github.com/wlach">@wlach</a>
        on 2024-12-20 11:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/wlach">@wlach</a> on 2024-12-20 11:58</div>
            <div class="timeline-body"><p>I'm maintaining various libraries inside a monorepo using uv's wonderful <a href="https://docs.astral.sh/uv/concepts/projects/workspaces/">workspaces feature</a>.</p>
<p>Our pyproject.toml looks something like this:</p>
<pre><code>[project]
name = &quot;monorepo&quot;
version = &quot;0.1.0&quot;
dependencies = [&quot;mymodule[tests]&quot;]

[tool.uv.workspace]
members = [&quot;src/*&quot;]

[tool.uv.sources]
mymodule = { workspace = true }
</code></pre>
<p><code>mymodule</code> uses git-based versioning using <a href="https://pypi.org/project/setuptools-git-versioning">setuptools-git-versioning</a>. This gives it a new version like <code>0.1.post31+git.fc7087bf</code> which we want for various internal reasons which I won't go into here. Unfortunately since that version is linked to the repository, making <em>any</em> change will result in its <code>uv sync</code> thinking it needs to update version of the module. The relevant section in <code>uv.lock</code> which continuously gets updated is:</p>
<pre><code>[[package]]
name = &quot;mymodule&quot;
version = &quot;0.1.post31+git.fc7087bf&quot;
source = { editable = &quot;src/mymodule&quot; }
dependencies = [ ... ]
</code></pre>
<p>It would be great if we could somehow just skip writing the version for editable modules inside <code>uv.lock</code>, since it really shouldn't matter (they're just going to get installed via the filesystem anyway).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wlach">@wlach</a> on 2024-12-20 12:20</div>
            <div class="timeline-body"><p>I thought this might be related, but appears not to be (I get the same issue with the latest version of uv, 0.5.11 as of this writing): https://github.com/astral-sh/uv/pull/9549</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/my1e5">@my1e5</a> on 2024-12-20 13:47</div>
            <div class="timeline-body"><ul>
<li>Duplicate of https://github.com/astral-sh/uv/issues/7533</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @wlach on 2024-12-20 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wlach">@wlach</a> on 2024-12-20 14:07</div>
            <div class="timeline-body"><p>ah yep, you're totally right</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:24 UTC
    </footer>
</body>
</html>
