<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cache on CI gets broken whenever UV updates - astral-sh/uv #3612</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cache on CI gets broken whenever UV updates</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/3612">#3612</a>
        opened by <a href="https://github.com/haarisr">@haarisr</a>
        on 2024-05-15 16:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/haarisr">@haarisr</a> on 2024-05-15 16:52</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>Using Github CI and Github actions cache, we save the cache dir.</p>
<p>When there is no update to uv, <code>uv pip install -r requirements.txt</code> uses the cached files and our CI takes about a minute.</p>
<p>Whenever there is an update to uv, the install time goes upto 8 minutes. On checking, uv reinstalls all our packages and seems to not use the cache anymore.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-15 16:54</div>
            <div class="timeline-body"><p>How are you installing uv? How are you saving and restoring the cache? (uv itself does not invalidate the cache across updates.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-15 16:55</div>
            <div class="timeline-body"><p>On some versions, we need to make changes to the cache. This shouldn't happen on every release though, do you have examples of this occurring?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cache</span> added by @zanieb on 2024-05-15 16:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/haarisr">@haarisr</a> on 2024-05-15 17:02</div>
            <div class="timeline-body"><blockquote>
<p>How are you installing uv? How are you saving and restoring the cache? (uv itself does not invalidate the cache across updates.)</p>
</blockquote>
<p>curl -LsSf https://astral.sh/uv/install.sh | sh</p>
<p>Restoring the cache using github/cache action restore and save</p>
<blockquote>
<p>On some versions, we need to make changes to the cache. This shouldn't happen on every release though, do you have examples of this occurring?</p>
</blockquote>
<p>It happened from 0.1.23 to 0.1.24 and from 0.1.24 to 0.1.26. We never had any PR's on 0.1.25.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-15 17:14</div>
            <div class="timeline-body"><p>We <em>did</em> bump the cache in v0.1.26 https://github.com/astral-sh/uv/commit/7b685a8158f0e444526732d25667aa6a7bc418cf</p>
<p>It seems likely you just encountered some cache changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-15 17:30</div>
            <div class="timeline-body"><p>Let us know if you encounter more problems. The cache has been more stable in recently releases, but still might change need to change for us to improve the data model.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-05-15 17:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-05-15 17:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:27 UTC
    </footer>
</body>
</html>
