<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to correctly automatically version bump - astral-sh/uv #7672</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>How to correctly automatically version bump</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/7672">#7672</a>
        opened by <a href="https://github.com/yannsartori">@yannsartori</a>
        on 2024-09-24 20:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/yannsartori">@yannsartori</a> on 2024-09-24 20:22</div>
            <div class="timeline-body"><p>Hello,</p>
<p>I currently use <a href="https://github.com/mbarkhau/bumpver">bumpver</a> to automatically version bump my project in CI (realistically, all this tool does from a &quot;versioning&quot; perspective is search and replacing). In particular, it updates the <code>version</code> key in my <code>pyproject.toml</code> file.</p>
<p>The flow is thus merge new feature into main as its own commit -&gt; automatically change these files with version specifiers (just <code>pyproject.toml</code>) -&gt; commit the changes as a version bump change.</p>
<p>However, I noticed by manually inspecting my <code>uv.lock</code> that it also maintains a <code>version</code> key for my project. I try to run all my commands with <code>--frozen</code> to keep my <code>uv.lock</code> file as unchanged as possible, so this <code>version</code> key can be quite out of date from the one present in <code>pyproject.toml</code> after a series of version bumps.</p>
<p>My question for you all is how to best manage this? A couple of solutions I have thought of:</p>
<ol>
<li>Just ignore this problem out right, and let the version in the <code>uv.lock</code> be out of date. I'm guessing this can lead to complications down the road</li>
<li>Also make <code>bumpver</code> update the <code>uv.lock</code> file manually. Since there  is a big disclaimer about not editing the lock file manually, I am hesitant to do this</li>
<li>Regenerate the lock file after I bump the version. This seems to defeat the purpose of using a lock file at all, if I am updating it in CI.</li>
<li>I looked into <code>uv lock --upgrade-package NAME_OF_PROJECT</code>. My hope is it would just update the package information in the lock file, and NOT its dependencies, but I couldn't find any exact information on its behavior.</li>
</ol>
<p>I know there is an issue to add capabilities for uv to manage versions for you automatically (https://github.com/astral-sh/uv/issues/6298) but my question is how to manage updating versions in general without this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-24 20:25</div>
            <div class="timeline-body"><p>Yeah, I think you're looking for <code>uv lock --upgrade-package &lt;project&gt;</code>.</p>
<p>I think @charliermarsh recently fielded a similar question to this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-25 17:38</div>
            <div class="timeline-body"><p>We can probably add some docs for this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-09-25 17:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @charliermarsh on 2024-09-25 17:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yannsartori">@yannsartori</a> on 2024-09-25 18:23</div>
            <div class="timeline-body"><p>Awesome, thanks for the quick reply @zanieb! I'll pursue that solution then. I'll leave this open if you guys want to create the documentation PR off this issue, but my question was answered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-25 18:24</div>
            <div class="timeline-body"><p>üëç Thanks for following up. I'll improve the docs a bit and will use this issue to track that work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/7694.html">astral-sh/uv#7694</a> on 2024-09-25 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-09-25 22:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-09-25 22:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zkurtz">@zkurtz</a> on 2025-01-15 02:45</div>
            <div class="timeline-body"><p>For @yannsartori's particular use case, where the <code>uv.lock</code> is out of sync with <code>pyproject.toml</code> due to an update of the project version, isn't <code>uv sync</code> sufficient and equivalent to <code>uv lock --upgrade-package &lt;project&gt;</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trallnag">@trallnag</a> on 2025-01-24 19:32</div>
            <div class="timeline-body"><p>@zkurtz indeed it seems to be sufficient now. It happened somewhere between in &gt; 0.5.20 and &lt;= 0.5.24. Before that I had to run <code>uv lock --upgrade-package &lt;project&gt;</code></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:22 UTC
    </footer>
</body>
</html>
