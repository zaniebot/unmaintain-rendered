<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue installing HTML-escaped local version - astral-sh/uv #1338</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Issue installing HTML-escaped local version</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1338">#1338</a>
        opened by <a href="https://github.com/stefanvanburen">@stefanvanburen</a>
        on 2024-02-15 20:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/stefanvanburen">@stefanvanburen</a> on 2024-02-15 20:57</div>
            <div class="timeline-body"><p>Hey! <code>uv</code> looks great; nice work. Not sure if this issue is on my end or yours:</p>
<pre><code>$ uv pip install connectrpc-eliza-grpc-python --extra-index-url https://buf.build/gen/python
error: Received some unexpected HTML from https://buf.build/gen/python/connectrpc-eliza-grpc-python
  Caused by: Unexpected fragment (expected `#sha256=...`) on URL: 43;edc8ae343b96-py3-none-any.whl
</code></pre>
<p>I'm <em>assuming</em> this is because we're serving local versions with a <code>+</code> delimiter, which is then URL-escaped. The HTML looks something like:</p>
<pre><code>    &lt;a
      href=&quot;https://buf.build/gen/python/connectrpc-eliza-grpc-python/connectrpc_eliza_grpc_python-1.61.0.1.20230913231627&amp;#43;233fca715f49-py3-none-any.whl&quot;
      data-requires-python=&quot;&amp;gt;=3.7&quot;
      &gt;connectrpc_eliza_grpc_python-1.61.0.1.20230913231627&amp;#43;233fca715f49-py3-none-any.whl&lt;/a&gt;
</code></pre>
<p>I haven't seen this as an issue with <code>pip</code>; it seems like something our repository should fix, but thought I'd mention in case the parsing should handle these escaped values.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-15 20:58</div>
            <div class="timeline-body"><p>Thanks, I'll take a look!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-02-15 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-02-15 20:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/davidszotten">@davidszotten</a> on 2024-02-15 22:22</div>
            <div class="timeline-body"><p>i'm running devpi and don't have fragments at all which results in</p>
<pre><code> uv pip install --extra-index-url &lt;devpi&gt; &lt;package&gt;
error: Received some unexpected HTML from &lt;devpi&gt;/&lt;package&gt;
  Caused by: Unexpected fragment (expected `#sha256=...`) on URL:
</code></pre>
<p>(not truncated, there is nothing after <code>URL:</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-15 22:24</div>
            <div class="timeline-body"><p>Thanks! That should be an easy fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/davidszotten">@davidszotten</a> on 2024-02-15 22:32</div>
            <div class="timeline-body"><p>happy to give it a go if you have some pointers?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-15 22:56</div>
            <div class="timeline-body"><p>@davidszotten - I haven't tried it yet, but I'd start in <code>crates/uv-client/src/html.rs</code> which has a <code>parse_hash</code>. I think the SHA256 <em>used</em> to be required but we relaxed it and didn't update that code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @charliermarsh by @charliermarsh on 2024-02-16 05:06</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1440.html">astral-sh/uv#1440</a> on 2024-02-16 06:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1441.html">astral-sh/uv#1441</a> on 2024-02-16 06:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 06:15</div>
            <div class="timeline-body"><p>@davidszotten - I moved that out to a separate issue: https://github.com/astral-sh/uv/issues/1441</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-16 06:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
