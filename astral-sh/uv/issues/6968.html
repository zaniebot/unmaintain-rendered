<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv interprets url as local file - astral-sh/uv #6968</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv interprets url as local file</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6968">#6968</a>
        opened by <a href="https://github.com/bqback">@bqback</a>
        on 2024-09-03 12:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bqback">@bqback</a></div>
            <div class="timeline-body"><p>I used the following command:</p>
<p><code>uv pip install &quot;git+git@server.com:path/to/lib.git#egg=lib&quot;</code></p>
<p>and I get an error that hints at it being interpreted as a local file for some reason? Verbose output:</p>
<pre><code>DEBUG uv 0.2.32
DEBUG Searching for Python interpreter in system path or `py` launcher
DEBUG Found `cpython-3.12.4-windows-x86_64-none` at `C:\work\.venv\Scripts\python.exe` (active virtual environment)   
DEBUG Using Python 3.12.4 environment at .venv\Scripts\python.exe
DEBUG Acquired lock for `.venv`
DEBUG At least one requirement is not satisfied: file:///C:/work/git+git@server.com:path/to/lib.git#egg=lib
DEBUG Using request timeout of 30s
DEBUG Acquired lock for `\\?\%LocalAppData%\uv\cache\built-wheels-v3\path\6c86e883763f6cc5`
error: Distribution not found at: file:///work/git+git@server.com:path/to/lib.git#egg=lib
</code></pre>
<p>Platform is Windows 10, uv version is 0.2.32.</p>
<p>I've also tried doing this without quotes around the url, and running the installation with <code>-e</code> explicitly gives me an error message that the url is interpreted as a local file:</p>
<pre><code>DEBUG uv 0.2.32
error: Unsupported editable requirement in `requirements_dev.txt`
  Caused by: Editable must refer to a local directory, not an archive: file:///C:/work/file:///work/git+git@server.com:path/to/lib.git#egg=lib`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-03 12:49</div>
            <div class="timeline-body"><p>I think you need a protocol there? Like <code>git+https://git@server.com:path/to/lib.git#egg=lib&quot;</code> or <code>git+ssh://...</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-09-03 12:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @charliermarsh on 2024-09-03 12:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bqback">@bqback</a> on 2024-09-03 12:56</div>
            <div class="timeline-body"><p>https://pip.pypa.io/en/stable/topics/vcs-support/ lists git+git as a supported schema, albeit one that's not recommended.
I've also had a hard time finding a public git+git url to try to rule out issues with formatting and the repository not being available (although I'm not sure why the repository being available would lead to it being interpreted as a local file).</p>
<p>I've tried specifying it as
<code>uv pip install -e git+git://git@server.com:path/to/lib.git#egg=lib</code>
but it just wouldn't parse at all with the message</p>
<pre><code>error: Failed to parse: `git+git://git@server.com:path/to/lib.git#egg=lib`
Caused by: Expected one of `@`, `(`, `&lt;`, `=`, `&gt;`, `~`, `!`, `;`, found `+`
git+git://git
   ^
</code></pre>
<p>Running <code>pip install -r requirements.txt</code> directly fails with the error</p>
<pre><code>ERROR: git+git@server.com:path/to/lib.git#egg=lib is not a valid editable requirement. It should either be a path to a local project or a VCS URL (beginning with bzr+http, bzr+https, bzr+ssh, bzr+sftp, bzr+ftp, bzr+lp, bzr+file, git+http, git+https, git+ssh, git+git, git+file, hg+file, hg+http, hg+https, hg+ssh, hg+static-http, svn+ssh, svn+http, svn+https, svn+svn, svn+file).
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-03 12:59</div>
            <div class="timeline-body"><p>Ah right, we knowingly don't support <code>git+git</code>, just like we don't support <code>git+file</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2024-09-03 12:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-03 12:59</div>
            <div class="timeline-body"><p>We should improve the error message but it's expected to fail.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bqback">@bqback</a> on 2024-09-03 13:00</div>
            <div class="timeline-body"><p>Understandable! Should I reformat the link to <code>git+https://</code>/try installing this one package via pip directly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-03 13:00</div>
            <div class="timeline-body"><p>It should work just fine with uv if you use either <code>git+ssh</code> or <code>git+https</code>!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @charliermarsh on 2024-09-03 14:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @charliermarsh on 2024-09-03 14:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jakubkunert">@jakubkunert</a> on 2024-09-03 21:00</div>
            <div class="timeline-body"><p>I can take this issue and try to update error message accordingly :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-04 20:38</div>
            <div class="timeline-body"><p>Great!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-08 18:32</div>
            <div class="timeline-body"><p>@jakubkunert -- Just let me know if you're not able or don't plan to get to it (or need some pointers!), so we can prioritize accordingly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jakubkunert">@jakubkunert</a> on 2024-09-08 21:54</div>
            <div class="timeline-body"><p>@charliermarsh thank you! Will try to solve it tomorrow.</p>
<p>I've already checked it yesterday and on current version I have different error message than posted above.
Will spend with this some more time tomorrow.
But if you have any quick poiters it will be wonderful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-16 02:25</div>
            <div class="timeline-body"><p>So:</p>
<pre><code>$ uv pip install -e git+git://git@server.com:path/to/lib.git#egg=lib
error: Failed to parse: `git+git://git@server.com:path/to/lib.git#egg=lib`
  Caused by: invalid port number
git+git://git@server.com:path/to/lib.git#egg=lib
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</code></pre>
<p>That looks reasonable to me. It's a URL with an invalid port.</p>
<p>On the other hand:</p>
<pre><code>$ cargo run pip install -e git+git://git@server.com/path/to/lib.git#egg=lib
error: Editable must refer to a local directory, not a Git URL: `git+git://git@server.com/path/to/lib.git#egg=lib`
</code></pre>
<p>That looks right too.</p>
<p>Then:</p>
<pre><code>$ cargo run pip install git+git://git@server.com/path/to/lib.git#egg=lib
error: Git operation failed
  Caused by: failed to clone into: /Users/crmarsh/Library/Caches/uv/git-v0/db/44ab598169957ad2
  Caused by: process didn't exit successfully: `git fetch --force --update-head-ok 'git://git@server.com/path/to/lib.git' '+HEAD:refs/remotes/origin/HEAD'` (exit status: 128)
--- stderr
fatal: unable to look up git@server.com (port 9418) (nodename nor servname provided, or not known)
</code></pre>
<p>So these all look correct to me on main.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-09-16 02:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:26:48 UTC
    </footer>
</body>
</html>
