```yaml
number: 5328
title: "Support a \"flat\" package layout in `uv init`"
type: issue
state: closed
author: mgaitan
labels:
  - enhancement
assignees: []
created_at: 2024-07-23T03:38:27Z
updated_at: 2024-12-26T18:51:57Z
url: https://github.com/astral-sh/uv/issues/5328
synced_at: 2026-01-10T01:57:11Z
```

# Support a "flat" package layout in `uv init`

---

_Issue opened by @mgaitan on 2024-07-23 03:38_

`uv init mypackage` currently generates a "src" layout:

```
.
├── pyproject.toml
├── README.md
└── src
    └── mypackage
        └── __init__.py
```

That's okay as the default because this layout has some [known](https://packaging.python.org/en/latest/discussions/src-layout-vs-flat-layout/#src-layout-vs-flat-layout) [advantages](https://hynek.me/articles/testing-packaging/).

However, it isn't a widely used convention, especially for simple, pure Python packages. 

So I propose to allow creating a flat layout with `uv init --flat`:

```
.
├── pyproject.toml
├── README.md
└── mypackage
    └── __init__.py
```

Paraphrasing [The Hitchhiker's Guide to Python](https://docs.python-guide.org/writing/style/#we-are-all-responsible-users):

> Python allows many tricks, and some of them are potentially dangerous. [Python's] philosophy, very different from highly defensive languages like Java, which provide many mechanisms to prevent misuse, is expressed by the saying: “We are all responsible users.”

and (abusing) the [Zen of Python](https://peps.python.org/pep-0020/):

> Flat is better than nested.



---

_Comment by @zanieb on 2024-07-23 15:34_

Thanks for the writeup!

I'm pretty hesitant, honestly. This results in confusing behavior for users due to the module search path including the package by default. I think we may be better off taking an opinionated stance here.

---

_Comment by @danielgafni on 2024-08-22 07:14_

The lack of flat layout support makes migrating large monorepos (https://github.com/dagster-io/dagster) with dozens of packages much harder. 

I agree with your point about the potential confusion with automatic package discovery when using the flat layourt, but there are already thousands of Python projects using it. 

I think `uv` should prefer the `src` layout and use it by default, but at the same time adding support for flat layout seems reasonable to me. The opposite decision will slow down `uv` adoption. 

---

_Referenced in [dagster-io/dagster#23816](../../dagster-io/dagster/pulls/23816.md) on 2024-08-22 08:47_

---

_Comment by @zanieb on 2024-08-22 14:18_

@danielgafni Sorry if I'm missing something here, but we just don't create a flat layout in `uv init` — as far as I know, uv itself should fully support flat layouts otherwise?

---

_Comment by @danielgafni on 2024-08-22 14:26_

Hey, I first tried using the flat layout and got import errors for our packages. 

For example, with the [following](https://github.com/dagster-io/dagster/blob/uv-migration/python_modules/dagster-pipes/pyproject.toml) `pyproject.toml`, running

```shell
uv pip install -e python_modules/dagster-pipes
```

passes with both flat and src layout, but only the src layout makes the package available for importing. I'm not sure what can cause this behavior. Moving `dagster_pipes` to `/src` and re-running `uv pip install` solves the problem, that's why I assumed flat layout wasn't supported. 


---

_Comment by @danielgafni on 2024-08-22 15:18_

Actually, I can't reproduce this issue anymore :open_mouth: 
Everything seems to be working, probably something was wrong on my side, sorry about that!

---

_Comment by @mgaitan on 2024-08-30 17:31_

@zanieb I guess my original request have been implemented via `uv init --app`  right? . We could close this. 

---

_Comment by @charliermarsh on 2024-08-30 17:34_

Correct! Thanks @mgaitan.

---

_Closed by @charliermarsh on 2024-08-30 17:34_

---

_Assigned to @zanieb by @charliermarsh on 2024-08-30 17:34_

---

_Label `enhancement` added by @charliermarsh on 2024-08-30 17:34_

---

_Comment by @Winand on 2024-12-26 15:36_

When we use `--lib` uv creates a folder `src/<NAME>` and adds hatchling build system.

In hatchling docs i read that by default [it searches for a package](https://hatch.pypa.io/latest/plugins/builder/wheel/#default-file-selection) in `<NAME>`, `src/<NAME>`, `<NAME>.py` and `<NAMESPACE>/<NAME>`.

So do I understand correctly that i can place my package in project's root dir? So the "flat" layout is already supported, right?

---
Update: also an example for [Packaged applications](https://docs.astral.sh/uv/concepts/projects/init/#packaged-applications) won't work as described in docs, because `src/example_packaged_app` differs from project name "example-pkg" so _hatchling_ won't find that package.

---

_Referenced in [DavidVujic/python-polylith#343](../../DavidVujic/python-polylith/issues/343.md) on 2025-06-15 13:59_

---
