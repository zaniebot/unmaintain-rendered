```yaml
number: 15736
title: "Can't install package that depends from package from Gitlab package registry"
type: issue
state: closed
author: JustGevorg
labels:
  - question
assignees: []
created_at: 2025-09-08T14:16:44Z
updated_at: 2025-09-09T15:13:01Z
url: https://github.com/astral-sh/uv/issues/15736
synced_at: 2026-01-10T01:57:35Z
```

# Can't install package that depends from package from Gitlab package registry

---

_Issue opened by @JustGevorg on 2025-09-08 14:16_

- The command you invoked (e.g., uv pip sync requirements.txt), ideally including the --verbose flag.
```bash
sagiian-g@thinkpad:~/code/test-flow$ uv add ../mypackage/dist/mypackage-0.1.0.tar.gz  --verbose
DEBUG uv 0.7.20
DEBUG Found project root: `/home/sagiian-g/code/test-flow`
DEBUG No workspace root found, using project root
DEBUG Acquired lock for `/home/sagiian-g/code/test-flow`
DEBUG Reading Python requests from version file at `/home/sagiian-g/code/test-flow/.python-version`
DEBUG Using Python request `3.13` from version file at `.python-version`
DEBUG Checking for Python environment at `.venv`
DEBUG Searching for Python 3.13 in managed installations or search path
DEBUG Searching for managed installations at `/home/sagiian-g/.local/share/uv/python`
DEBUG Found `cpython-3.13.5-linux-x86_64-gnu` at `/home/sagiian-g/.pyenv/shims/python3.13` (first executable in the search path)
Using CPython 3.13.5 interpreter at: /home/sagiian-g/.pyenv/versions/3.13.5/bin/python3.13
Creating virtual environment at: .venv
DEBUG Using base executable for virtual environment: /home/sagiian-g/.pyenv/versions/3.13.5/bin/python3.13
DEBUG Released lock at `/tmp/uv-e25fb5475bd1fee3.lock`
DEBUG Acquired lock for `.venv`
DEBUG Using request timeout of 30s
DEBUG Using request timeout of 30s
DEBUG Found static `pyproject.toml` for: test-flow @ file:///home/sagiian-g/code/test-flow
DEBUG No workspace root found, using project root
DEBUG Acquired lock for `/home/sagiian-g/.cache/uv/sdists-v9/path/987abff02ec0ba39`
DEBUG Unpacking source distribution: mypackage @ file:///home/sagiian-g/code/mypackage/dist/mypackage-0.1.0.tar.gz
DEBUG Unpacking for build: /home/sagiian-g/code/mypackage/dist/mypackage-0.1.0.tar.gz
DEBUG Found static `pyproject.toml` for: mypackage @ file:///home/sagiian-g/code/mypackage/dist/mypackage-0.1.0.tar.gz
DEBUG Released lock at `/home/sagiian-g/.cache/uv/sdists-v9/path/987abff02ec0ba39/.lock`
DEBUG Solving with installed Python version: 3.13.5
DEBUG Solving with target Python version: >=3.13
DEBUG Adding direct dependency: test-flow*
DEBUG Searching for a compatible version of test-flow @ file:///home/sagiian-g/code/test-flow (*)
DEBUG Adding direct dependency: mypackage*
DEBUG Searching for a compatible version of mypackage @ file:///home/sagiian-g/code/mypackage/dist/mypackage-0.1.0.tar.gz (*)
DEBUG Adding transitive dependency for mypackage==0.1.0: click>=8.2.1, <8.2.1+
DEBUG Adding transitive dependency for mypackage==0.1.0: google-api-python-client>=2.176.0
DEBUG Adding transitive dependency for mypackage==0.1.0: google-auth-httplib2>=0.2.0
DEBUG Adding transitive dependency for mypackage==0.1.0: google-auth-oauthlib>=1.2.2
DEBUG Adding transitive dependency for mypackage==0.1.0: httpx>=0.28.1
DEBUG Adding transitive dependency for mypackage==0.1.0: kc-adapter-py>=1.8.0
DEBUG Adding transitive dependency for mypackage==0.1.0: pydantic>=2.11.7, <2.11.7+
DEBUG Adding transitive dependency for mypackage==0.1.0: pyyaml>=6.0.2, <6.0.2+
DEBUG Found fresh response for: https://pypi.org/simple/click/
DEBUG Found fresh response for: https://pypi.org/simple/google-auth-oauthlib/
DEBUG Searching for a compatible version of click (>=8.2.1, <8.2.1+)
DEBUG Selecting: click==8.2.1 [compatible] (click-8.2.1-py3-none-any.whl)
DEBUG Found fresh response for: https://pypi.org/simple/httpx/
DEBUG Found fresh response for: https://pypi.org/simple/google-auth-httplib2/
DEBUG No cache entry for: https://pypi.org/simple/kc-adapter-py/
DEBUG Found fresh response for: https://pypi.org/simple/google-api-python-client/
DEBUG Found fresh response for: https://pypi.org/simple/pyyaml/
DEBUG Found fresh response for: https://pypi.org/simple/pydantic/
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/85/32/10bb5764d90a8eee674e9dc6f4db6a0ab47c8c4d0d83c27f7c39ac415a4d/click-8.2.1-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/2a/39/e50c7c3a983047577ee07d2a9e53faf5a69493943ec3f6a384bdc792deb2/httpx-0.28.1-py3-none-any.whl.metadata
DEBUG Adding transitive dependency for click==8.2.1: colorama{sys_platform == 'win32'}*
DEBUG Searching for a compatible version of pydantic (>=2.11.7, <2.11.7+)
DEBUG Selecting: pydantic==2.11.7 [compatible] (pydantic-2.11.7-py3-none-any.whl)
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/be/8a/fe34d2f3f9470a27b01c9e76226965863f153d5fbe276f83608562e49c04/google_auth_httplib2-0.2.0-py2.py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/ac/84/40ee070be95771acd2f4418981edb834979424565c3eec3cd88b6aa09d24/google_auth_oauthlib-1.2.2-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/be/03/72b7acf374a2cde9255df161686f00d8370117ac33e2bdd8fdadfe30272a/google_api_python_client-2.181.0-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/ef/e3/3af305b830494fa85d95f6d95ef7fa73f2ee1cc8ef5b495c7c3269fb835f/PyYAML-6.0.2-cp313-cp313-macosx_10_13_x86_64.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/6a/c0/ec2b1c8712ca690e5d61979dee872603e92b8a32f94cc1b72d53beab008a/pydantic-2.11.7-py3-none-any.whl.metadata
DEBUG Adding transitive dependency for pydantic==2.11.7: annotated-types>=0.6.0
DEBUG Adding transitive dependency for pydantic==2.11.7: pydantic-core>=2.33.2, <2.33.2+
DEBUG Adding transitive dependency for pydantic==2.11.7: typing-extensions>=4.12.2
DEBUG Adding transitive dependency for pydantic==2.11.7: typing-inspection>=0.4.0
DEBUG Searching for a compatible version of pyyaml (>=6.0.2, <6.0.2+)
DEBUG Selecting: pyyaml==6.0.2 [compatible] (PyYAML-6.0.2-cp313-cp313-macosx_10_13_x86_64.whl)
DEBUG Found fresh response for: https://pypi.org/simple/annotated-types/
DEBUG Found fresh response for: https://pypi.org/simple/typing-inspection/
DEBUG Found fresh response for: https://pypi.org/simple/typing-extensions/
DEBUG Found stale response for: https://pypi.org/simple/colorama/
DEBUG Sending revalidation request for: https://pypi.org/simple/colorama/
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/78/b6/6307fbef88d9b5ee7421e68d78a9f162e0da4900bc5f5793f6d3d0e34fb8/annotated_types-0.7.0-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/18/67/36e9267722cc04a6b9f15c7f3441c2363321a3ea07da7ae0c0707beb2a9c/typing_extensions-4.15.0-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/17/69/cd203477f944c353c31bade965f880aa1061fd6bf05ded0726ca845b6ff7/typing_inspection-0.4.1-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://pypi.org/simple/pydantic-core/
DEBUG Searching for a compatible version of pydantic-core (>=2.33.2, <2.33.2+)
DEBUG Selecting: pydantic-core==2.33.2 [compatible] (pydantic_core-2.33.2-cp313-cp313-macosx_10_12_x86_64.whl)
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/46/8c/99040727b41f56616573a28771b1bfa08a3d3fe74d3d513f01251f79f172/pydantic_core-2.33.2-cp313-cp313-macosx_10_12_x86_64.whl.metadata
DEBUG Adding transitive dependency for pydantic-core==2.33.2: typing-extensions>=4.6.0, <4.7.0 | >=4.7.0+
DEBUG Searching for a compatible version of google-api-python-client (>=2.176.0)
DEBUG Selecting: google-api-python-client==2.181.0 [compatible] (google_api_python_client-2.181.0-py3-none-any.whl)
DEBUG Adding transitive dependency for google-api-python-client==2.181.0: google-api-core>=1.31.5, <2.0.dev0 | >=2.3.dev0, <2.3.0 | >=2.3.0+, <3.0.0
DEBUG Adding transitive dependency for google-api-python-client==2.181.0: google-auth>=1.32.0, <2.24.0 | >=2.24.0+, <2.25.0 | >=2.25.0+, <3.0.0
DEBUG Adding transitive dependency for google-api-python-client==2.181.0: google-auth-httplib2>=0.2.0, <1.0.0
DEBUG Adding transitive dependency for google-api-python-client==2.181.0: httplib2>=0.19.0, <1.0.0
DEBUG Adding transitive dependency for google-api-python-client==2.181.0: uritemplate>=3.0.1, <5
DEBUG Searching for a compatible version of google-auth-httplib2 (>=0.2.0, <1.0.0)
DEBUG Selecting: google-auth-httplib2==0.2.0 [compatible] (google_auth_httplib2-0.2.0-py2.py3-none-any.whl)
DEBUG Adding transitive dependency for google-auth-httplib2==0.2.0: google-auth*
DEBUG Adding transitive dependency for google-auth-httplib2==0.2.0: httplib2>=0.19.0
DEBUG Searching for a compatible version of google-auth-oauthlib (>=1.2.2)
DEBUG Selecting: google-auth-oauthlib==1.2.2 [compatible] (google_auth_oauthlib-1.2.2-py3-none-any.whl)
DEBUG Adding transitive dependency for google-auth-oauthlib==1.2.2: google-auth>=2.15.0
DEBUG Adding transitive dependency for google-auth-oauthlib==1.2.2: requests-oauthlib>=0.7.0
DEBUG Searching for a compatible version of httpx (>=0.28.1)
DEBUG Selecting: httpx==0.28.1 [compatible] (httpx-0.28.1-py3-none-any.whl)
DEBUG Adding transitive dependency for httpx==0.28.1: anyio*
DEBUG Adding transitive dependency for httpx==0.28.1: certifi*
DEBUG Adding transitive dependency for httpx==0.28.1: httpcore>=1.dev0, <2.dev0
DEBUG Adding transitive dependency for httpx==0.28.1: idna*
DEBUG Found fresh response for: https://pypi.org/simple/uritemplate/
DEBUG Found fresh response for: https://pypi.org/simple/requests-oauthlib/
DEBUG Found fresh response for: https://pypi.org/simple/httplib2/
DEBUG Found fresh response for: https://pypi.org/simple/certifi/
DEBUG Found fresh response for: https://pypi.org/simple/anyio/
DEBUG Found fresh response for: https://pypi.org/simple/idna/
DEBUG Found fresh response for: https://pypi.org/simple/google-api-core/
DEBUG Found fresh response for: https://pypi.org/simple/google-auth/
DEBUG Found fresh response for: https://pypi.org/simple/httpcore/
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/87/7c/f35bd530a35654ef3ff81f5e102572b8b620361659e090beb85a73a3bcc9/httplib2-0.30.0-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/a9/99/3ae339466c9183ea5b8ae87b34c0b897eda475d2aec2307cae60e5cd4f29/uritemplate-4.2.0-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/76/c6/c88e154df9c4e1a2a66ccf0005a88dfb2650c1dffb6f5ce603dfbd452ce3/idna-3.10-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/17/63/b19553b658a1692443c62bd07e5868adaa0ad746a0751ba62c59568cd45b/google_auth-2.40.3-py2.py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/6f/12/e5e0282d673bb9746bacfb6e2dba8719989d3660cdb2ea79aee9a9651afb/anyio-4.10.0-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/e5/48/1549795ba7742c948d2ad169c1c8cdbae65bc450d6cd753d124b17c8cd32/certifi-2025.8.3-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/7e/f5/f66802a942d491edb555dd61e3a9961140fd64c90bce1eafd741609d334d/httpcore-1.0.9-py3-none-any.whl.metadata
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/14/4b/ead00905132820b623732b175d66354e9d3e69fcf2a5dcdab780664e7896/google_api_core-2.25.1-py3-none-any.whl.metadata
DEBUG Found not-modified response for: https://pypi.org/simple/colorama/
DEBUG No netrc file found
DEBUG Searching for a compatible version of kc-adapter-py (>=1.8.0)
DEBUG No compatible version found for: kc-adapter-py
DEBUG Recording unit propagation conflict of kc-adapter-py from incompatibility of (mypackage)
DEBUG Searching for a compatible version of mypackage @ file:///home/sagiian-g/code/mypackage/dist/mypackage-0.1.0.tar.gz (<0.1.0 | >0.1.0)
DEBUG No compatible version found for: mypackage
DEBUG Recording unit propagation conflict of mypackage from incompatibility of (test-flow)
DEBUG Searching for a compatible version of test-flow @ file:///home/sagiian-g/code/test-flow (<0.1.0 | >0.1.0)
DEBUG No compatible version found for: test-flow
DEBUG Reverting changes to `pyproject.toml`
DEBUG Removing `uv.lock`
  × No solution found when resolving dependencies:
  ╰─▶ Because kc-adapter-py was not found in the package registry and mypackage==0.1.0 depends on kc-adapter-py>=1.8.0, we can conclude that mypackage==0.1.0 cannot be used.
      And because only mypackage==0.1.0 is available and your project depends on mypackage, we can conclude that your project's requirements are unsatisfiable.
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
DEBUG Released lock at `/home/sagiian-g/code/test-flow/.venv/.lock`
```
- uv version 0.7.20, platform Ubuntu 24.04

I have package named `mypackage` with dependency named `kc-adapter-py` that placed in registry gitlab. Package `mypackage` placed in registry gitlab too.
Part of `pyproject.toml` for `mypackage`:
```toml
dependencies = [  
    "click==8.2.1",  
    "google-api-python-client>=2.176.0",  
    "google-auth-httplib2>=0.2.0",  
    "google-auth-oauthlib>=1.2.2",  
    "httpx>=0.28.1",  
    "kc-adapter-py>=1.8.0",  
    "pydantic==2.11.7",  
    "pyyaml==6.0.2",  
]  
  
[tool.uv.sources]  
kc-adapter-py = { index = "git-company" }  
  
[[tool.uv.index]]  
name = "git-company"  
url = "https://git.company.org/api/v4/projects/4792/packages/pypi/simple"  
explicit = true
```
Trying install package from registry via uv
```bash
uv add mypackage --index-url https://__token__:MyValidAccessToken@git.company.org/api/v4/projects/7855/packages/pypi/simple
```
I have output (same result if i do local `uv build` and will try install result `.tar.gz` or `.whl`)
```bash
No solution found when resolving dependencies:
  ╰─▶ Because kc-adapter-py was not found in the package registry and mypackage==0.1.0 depends on kc-adapter-py>=1.8.0, we can conclude that mypackage==0.1.0 cannot be used.
      And because only mypackage==0.1.0 is available and your project depends on inside2workspace, we can conclude that your project's requirements are unsatisfiable.
```

I can install `mypackage` with  uv or pip if i explicit pass --index-url and --extra-index-url for `mypackage` and `kc-adapter-py` both but this address already in `pyproject.toml` i don't wand repeat it. How i can install `mypackage` just passing --index-url only for `mypackage`, not for it's dependency `kc-adapter-py`? 

Thank you in advance!

---

_Renamed from "Can't install my package with dependency from different registry" to "Can't install my package with dependency from Gitlab package registry" by @JustGevorg on 2025-09-08 14:26_

---

_Renamed from "Can't install my package with dependency from Gitlab package registry" to "Can't install package that depends from Gitlab package registry" by @JustGevorg on 2025-09-08 15:17_

---

_Renamed from "Can't install package that depends from Gitlab package registry" to "Can't install package that depends from package from Gitlab package registry" by @JustGevorg on 2025-09-08 15:18_

---

_Comment by @JustGevorg on 2025-09-09 07:45_

Add command output with `--verbose` flag with uv version and platform. Can someone point on my mistake uv using?

---

_Comment by @zanieb on 2025-09-09 11:30_

We don't respect index definitions in dependencies, just first-party packages. This is required for compliance with Python packaging specifications and prevents arbitrary packages from adding indexes to your resolution unexpectedly.

---

_Label `question` added by @zanieb on 2025-09-09 11:30_

---

_Comment by @JustGevorg on 2025-09-09 15:13_

Thank you!

---

_Closed by @JustGevorg on 2025-09-09 15:13_

---
