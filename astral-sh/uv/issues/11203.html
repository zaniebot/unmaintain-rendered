<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Include origin of requested Python version in Python discovery errors - astral-sh/uv #11203</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Include origin of requested Python version in Python discovery errors</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/11203">#11203</a>
        opened by <a href="https://github.com/edmorley">@edmorley</a>
        on 2025-02-03 22:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/edmorley">@edmorley</a> on 2025-02-03 22:48</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Currently with uv <code>0.5.26</code>, if the Python version requested via the <code>.python-version</code> file cannot be found during Python discovery and uv isn't allowed to download it's own Python version, the error message is of form:</p>
<pre><code>$ uv sync --python-preference only-system
error: No interpreter found for Python 3.11 in search path
</code></pre>
<p>Similarly, if there was no <code>.python-version</code> file and the non-existent Python version instead originated from the <code>requires-python</code> field, the error message is:</p>
<pre><code>$ uv sync --python-preference only-system
error: No interpreter found for Python ==3.11.* in search path
</code></pre>
<p>I think it might be worth including references to <code>.python-version</code> / <code>requires-python</code> or similar in those error messages, to make it clearer where should be updated if the end-user instead wanted to use a different version of Python.</p>
<p>The current error wording is set here:
https://github.com/astral-sh/uv/blob/f54979f2bc8b0124cffb40db057ae1acd58fe337/crates/uv-python/src/discovery.rs#L2576</p>
<p>(The context where I ran into this, was testing the scenario where one of our end-users doesn't have a <code>.python-version</code> file or worse has our legacy <code>runtime.txt</code> file, our buildpack then picks/installs an incompatible Python version from that declared in <code>requires-python</code>, and then the user gets a confusing error message since we set <code>UV_PYTHON_PREFERENCE=only-system</code> in the env. In the end I've decided to resolve this on our side by making the <code>.python-version</code> file mandatory instead, ensuring the buildpack and uv both agree on a canonical Python version - so this won't affect us.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @edmorley on 2025-02-03 22:48</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2025-02-03 22:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-02-03 22:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-03 22:55</div>
            <div class="timeline-body"><p>I'll see if it's hard</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:52:48 UTC
    </footer>
</body>
</html>
