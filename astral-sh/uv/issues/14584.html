<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv errors if the `pyproject.toml` is a directory - astral-sh/uv #14584</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv errors if the <code>pyproject.toml</code> is a directory</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/14584">#14584</a>
        opened by <a href="https://github.com/bsraya">@bsraya</a>
        on 2025-07-13 03:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bsraya">@bsraya</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Any <code>uv</code> commands that I executed always return:</p>
<pre><code>error: failed to read from file `/pyproject.toml`: Is a directory (os error 21)
</code></pre>
<p>Adding <code>-v</code> to all commands does not return other helpful error messages.</p>
<p>What I have tried:</p>
<ol>
<li>Remove cache</li>
<li>Uninstall (includes removing python and tool dirs) and reinstall</li>
<li>Remove cache, uninstall (including removing python and tool dirs), and reinstall</li>
</ol>
<p>Could this be a duplicate issue? If yes, could you provide me the link? Appreciate the help.</p>
<p><img src="https://github.com/user-attachments/assets/762ab176-4bea-40e2-a233-e295c8e5ef98" alt="Image" /></p>
<h3>Platform</h3>
<p>Pop!_OS jammy 22.04 x86_64</p>
<h3>Version</h3>
<p>uv 0.7.20</p>
<h3>Python version</h3>
<p>Python 3.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @bsraya on 2025-07-13 03:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-07-13 07:58</div>
            <div class="timeline-body"><p>The error message explicitly states that <code>pyproject.toml</code> is a directory. Normally, <code>pyproject.toml</code> is a TOML-formatted text file.
So you need to check if <code>pyproject.toml</code> is a file. On a Linux system, if you run <code>ls</code> in the terminal and see that its type is <code>d</code>, then it's a directory.
e.g. <strong>d</strong>rwxrwxr-x   2 shengyu shengyu 4.0K Oct 27 22:00 myfolder</p>
<hr />
<p>However, I believe <code>uv</code> should check if <code>pyproject.toml</code> is a file. Otherwise, encountering an error prevents subsequent actions from executing, such as autocompletion. Autocompletion should ignore <code>pyproject.toml</code> errors because it doesn't need it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bsraya">@bsraya</a> on 2025-07-13 09:45</div>
            <div class="timeline-body"><p>This is what I got after running <code>ls -la</code>:</p>
<pre><code>-rw-rw-r--  1 user user      496 Jul 12 11:32 pyproject.toml
</code></pre>
<p>However, this issue persists in my entire system.</p>
<p><img width="733" height="176" alt="Image" src="https://github.com/user-attachments/assets/663cf16f-37db-4ee7-9783-af5c9086e1b7" /></p>
<p>I have already checked the type of my <code>pyproject.toml</code>, and it shows it a text file.</p>
<p><img width="622" height="590" alt="Image" src="https://github.com/user-attachments/assets/db0b2c1a-bcd2-4050-a79f-144827c169dc" /></p>
<p>Any idea which is possibly the root cause?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-07-13 09:56</div>
            <div class="timeline-body"><p>https://docs.astral.sh/uv/concepts/configuration-files/#configuration-files</p>
<blockquote>
<p>uv will search for a pyproject.toml or uv.toml file in the current directory, or in the nearest parent directory.</p>
</blockquote>
<p>Could you please check the working directory where you're running <code>uv</code> and its parent directories for any <code>pyproject.toml</code> directory?</p>
<p>And let's not forget the user-level Configuration file</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-07-13 10:07</div>
            <div class="timeline-body"><p>It's pretty much as I said in https://github.com/astral-sh/uv/issues/14584#issuecomment-3066834258. I just tested a Linux distribution, and its error message showed the path it was trying to access. So, uv found pyproject.toml at that location(<code>/pyproject.toml</code>), but failed when trying to access it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bsraya">@bsraya</a> on 2025-07-13 13:48</div>
            <div class="timeline-body"><p>I noticed that one of my Docker compose YAML files created that folder. I just deleted that, and it worked fine now. It was a rookie mistake. Thanks for the help! Cheers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @bsraya on 2025-07-13 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @zanieb on 2025-07-13 13:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-13 13:51</div>
            <div class="timeline-body"><p>Thanks for the help @FishAlchemist!</p>
<p>We should probably make this non-fatal.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "uv commands would return `os error 21`" to "uv errors if the `pyproject.toml` is a directory" by @zanieb on 2025-07-13 13:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-13 13:52</div>
            <div class="timeline-body"><p>I think if it's in the working directory, we should error and explain why? If it's in a parent directory, erroring seems too aggressive and we should probably just warn.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-07-13 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2025-07-13 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @zanieb on 2025-07-13 13:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dhth">@dhth</a> on 2025-08-06 07:35</div>
            <div class="timeline-body"><p>Hi! I took a stab at this issue, but wanted to confirm a few things before sending in a PR. Is the following expected behaviour?</p>
<pre><code>uv    = production uv
uvdev = my changes
</code></pre>
<pre><code class="language-text">$ tree --gitignore
.
├── pyproject.toml                   &lt;- directory
├── pyproject.toml.bak
├── README.md
├── src
│   └── main.py
└── uv.lock

3 directories, 4 files
</code></pre>
<pre><code class="language-bash"># from project root

$ uv run src/main.py
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev run src/main.py
# error: Failed to read `pyproject.toml` as it's a directory, not a file

$ uv sync
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev sync
# error: Failed to read `pyproject.toml` as it's a directory, not a file
</code></pre>
<pre><code class="language-bash"># from src

$ uv run main.py
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev run main.py
# warning: Found a directory at `/private/var/tmp/uvtests/test1/pyproject.toml`, which is normally expected to be a TOML file.
# Hello from test1!

$ uv sync
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev sync
# warning: Found a directory at `/private/var/tmp/uvtests/test1/pyproject.toml`, which is normally expected to be a TOML file.
# error: No `pyproject.toml` found in current directory or any parent directory
</code></pre>
<h2>Questions</h2>
<ul>
<li>If we ignore <code>pyproject.toml</code> being a directory in a parent directory, some commands (like <code>run</code>) might work (if the project has been synced before), but others might not (like <code>sync</code>). Is warning the user in this case still appropriate?</li>
</ul>
<p>Thanks!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:32:06 UTC
    </footer>
</body>
</html>
