```yaml
number: 12896
title: Should I run uv lock or uv sync before uv build?
type: issue
state: closed
author: Gabriel-p
labels:
  - question
assignees: []
created_at: 2025-04-15T12:19:27Z
updated_at: 2025-04-15T12:58:55Z
url: https://github.com/astral-sh/uv/issues/12896
synced_at: 2026-01-12T16:01:14Z
```

# Should I run uv lock or uv sync before uv build?

---

_@Gabriel-p_

### Question

I have a project that I work on on different systems. My workflow for setting up a new environment is:

1. Copy `pyproject.toml` and `.python-version` files from a previous system
2. Generate the environment and install the required packages via:
```
$ uv venv
$ uv sync
```

This handles creating the `uv.lock` file that looks like:

```
version = 1
revision = 1
requires-python = ">=3.11.11"

[[package]]
name = "asteca"
version = "0.5.7.dev0"
source = { editable = "." }
dependencies = [
    { name = "astropy" },
    { name = "fast-histogram" },
    { name = "numpy" },
    { name = "scipy" },
]
...
```


 The issue is that the version in the `uv.lock` file is inherited from the  `pyproject.toml` file, and that version usually looks like `0.5.7-dev` (a `0` is added in the `uv.lock` file version by `uv sync` I guess?). The `dev` is there to indicate that this is a version "in development".

When I want to publish the finished version, I update the version in the `pyproject.toml` file to e.g. `0.5.7`, i.e. removing the `dev`. Here's what I don't understand because if I then go directly to `uv build` and `uv publish`, the `uv.lock` file will still show the `0.5.7-dev` inside because it was never updated.

Should I run `uv sync` or `uv lock` before building, to update the `uv.lock` file? How should I properly handle this?

### Platform

elementary OS 8

### Version

0.6.6

---

_Label `question` added by @Gabriel-p on 2025-04-15 12:19_

---

_Comment by @konstin on 2025-04-15 12:44_

Package building with `uv build` and project syncing with `uv sync` are currently independent of each other. `uv build` builds the package in isolation and does not consider `uv.lock` (this is something that is expected to change in the future, where we want to lock the build dependencies, too). `uv publish` also does not read `uv.lock`, but only the built files, so `uv build && uv publish` works even with an outdated lockfile; you can even use `uv build` on a project that otherwise doesn't uv at all and doesn't have a `uv.lock`.

---

_Comment by @charliermarsh on 2025-04-15 12:47_

üëç Yeah it's not necessary. `uv build` doesn't actually know anything about the lockfile, since it's just building your own code and then including a list of the dependencies (as defined in your `pyproject.toml` or elsewhere), following the Python standards.

---

_Closed by @charliermarsh on 2025-04-15 12:47_

---

_Comment by @Gabriel-p on 2025-04-15 12:54_

Bau the `.tar.gz` file generated by `uv build` includes the `uv.lock` file. Does this not mess with `uv publish` later on? Will it not mess up the version in Pypi?

---

_Comment by @charliermarsh on 2025-04-15 12:57_

No, it won't be used in either of those places. It's just like another file in the source code. You could even configure your build backend (setuptools or similar) to omit it.

---

_Comment by @Gabriel-p on 2025-04-15 12:58_

(Last question and I won't bother you anymore I swear)

So does the version number of my package in the `uv.lock` file serve any purpose or is it completely useless?

---
