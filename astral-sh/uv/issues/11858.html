<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv add and uv add -r fail with misleading 'No pyproject.toml...' error, while uv pip install works - astral-sh/uv #11858</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv add and uv add -r fail with misleading 'No pyproject.toml...' error, while uv pip install works</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/11858">#11858</a>
        opened by <a href="https://github.com/MohammedElHamraoui">@MohammedElHamraoui</a>
        on 2025-02-28 15:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/MohammedElHamraoui">@MohammedElHamraoui</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>mkdir uv-add-test-project
cd uv-add-test-project
uv venv .venv
source .venv/bin/activate
echo &quot;fastapi[standard]&quot; &gt; requirements.txt # Minimal example
uv add -r requirements.txt       # Fails with error
uv add fastapi[standard]         # Fails with error
uv pip install -r requirements.txt # Works correctly
uv pip install fastapi[standard]   # Works correctly</p>
<p>$ uv -v add -r requirements.txt
DEBUG uv 0.6.3
error: No <code>pyproject.toml</code> found in current directory or any parent directory</p>
<p>$ uv -v add fastapi[standard]
DEBUG uv 0.6.3
error: No <code>pyproject.toml</code> found in current directory or any parent directory</p>
<h3>Platform</h3>
<p>Linux  Fedora 6.13.4-200.fc41.x86_64 #1 SMP PREEMPT_DYNAMIC Sat Feb 22 16:09:10 UTC 2025 x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.6.3</p>
<h3>Python version</h3>
<p>CPython 3.13.2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @MohammedElHamraoui on 2025-02-28 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-28 15:26</div>
            <div class="timeline-body"><p>Can you expand on what's misleading here? This looks correct to me. You must have a <code>pyproject.toml</code> in order to use the Project APIs (<code>uv sync</code>, <code>uv add</code>, <code>uv run</code>, etc.).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MohammedElHamraoui">@MohammedElHamraoui</a> on 2025-02-28 15:47</div>
            <div class="timeline-body"><blockquote>
<p>Thank you for the quick response and clarification! I understand now that <code>uv add</code>, <code>uv run</code>, and <code>uv sync</code> are designed as &quot;Project APIs&quot; and are intended to be used within the context of a project defined by <code>pyproject.toml</code>. That's helpful to know about the intended design.</p>
</blockquote>
<blockquote>
<p>However, from a user perspective, especially for those coming from <code>venv</code>/<code>pip</code>, the error message &quot;No <code>pyproject.toml</code> found...&quot; can still be misleading in the following scenarios:</p>
</blockquote>
<blockquote>
<ol>
<li><strong>Initial Expectation of <code>uv add</code> as a general package installer:</strong>  Many users (like myself initially) might naturally assume that <code>uv add</code> is the primary command for adding packages in a virtual environment, intending it as a faster replacement for <code>pip install</code> for general use cases, especially given <code>uv</code>'s focus on speed.  The &quot;Project API&quot; distinction might not be immediately obvious.</li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li><strong><code>uv add -r requirements.txt</code> implies <code>pip install -r</code> equivalence:</strong> The <code>-r requirements.txt</code> flag is a standard idiom from <code>pip</code> for installing from requirements files, which users are very familiar with and expect to work without <code>pyproject.toml</code>.  Seeing <code>uv add -r requirements.txt</code> and then getting a <code>pyproject.toml</code> error is unexpected because <code>pip install -r</code> works perfectly fine without it.</li>
</ol>
</blockquote>
<blockquote>
<ol start="3">
<li><strong><code>uv pip install</code> works without <code>pyproject.toml</code>:</strong>  The fact that <code>uv pip install fastapi[standard]</code> <em>does</em> work in the same virtual environment reinforces the confusion. It shows that <code>uv</code> <em>can</em> install packages in a venv without <code>pyproject.toml</code>, but <code>uv add</code> seemingly cannot, even for basic installation tasks. This creates an apparent inconsistency from a user's standpoint.</li>
</ol>
</blockquote>
<blockquote>
<ol start="4">
<li><strong>Error message directs user to the wrong solution (for basic installation):</strong> The error message strongly suggests creating a <code>pyproject.toml</code> file.  However, for users who simply want to install packages into a virtual environment (e.g., for a quick script, tutorial, or simple project not yet structured with <code>pyproject.toml</code>), creating a <code>pyproject.toml</code> is an unnecessary step.  They are looking for a way to just install packages, not necessarily to define a full project build system at that moment.  It makes the user think they are doing something fundamentally wrong or missing a crucial project configuration file for a basic installation task.</li>
</ol>
</blockquote>
<blockquote>
<p><strong>Suggestion for improvement (optional):</strong></p>
</blockquote>
<blockquote>
<p>Perhaps the error message for <code>uv add</code> (and related Project APIs) could be made more explicit about the <em>intended use case</em> and the <code>pyproject.toml</code> requirement.  For example, instead of &quot;No <code>pyproject.toml</code> found...&quot;, a more informative message might be something like:</p>
</blockquote>
<blockquote>
<p>&quot;<strong>Error: <code>uv add</code> is intended for use within Python projects defined by <code>pyproject.toml</code>. To use <code>uv add</code>, please ensure you are in a project directory containing a <code>pyproject.toml</code> file that defines your project's dependencies and build system.</strong>  For basic package installation in a virtual environment without a <code>pyproject.toml</code>-defined project, use <code>uv pip install &lt;package_name&gt;</code> or <code>uv pip install -r requirements.txt</code> instead.&quot;</p>
</blockquote>
<blockquote>
<p>Or, if <code>uv add</code> is <em>always</em> intended to require <code>pyproject.toml</code>, even for installing from <code>requirements.txt</code>, then clarifying this in the documentation and perhaps in the error message itself would be very helpful to avoid user confusion and set the right expectations.</p>
</blockquote>
<blockquote>
<p>Thank you again for clarifying the intended behavior. I appreciate the fast response!</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-02-28 20:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @charliermarsh on 2025-02-28 20:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-28 20:57</div>
            <div class="timeline-body"><p>Seems reasonable to make this error clearer and more actionable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/leelasaivoonna">@leelasaivoonna</a> on 2025-06-26 09:53</div>
            <div class="timeline-body"><p>@MohammedElHamraoui Well said, in docs they could have mentioned it clearly,</p>
<p>But those commands works in <strong>Powershell</strong> without issues, you must have ran it in <strong>command prompt</strong></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Deejaythenobody">@Deejaythenobody</a> on 2025-09-16 22:12</div>
            <div class="timeline-body"><p>im having this issue running uv sync after creating the env.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:30:11 UTC
    </footer>
</body>
</html>
