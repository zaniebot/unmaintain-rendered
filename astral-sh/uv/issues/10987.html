<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv export` does not generate hashes for `--find-links` - astral-sh/uv #10987</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv export</code> does not generate hashes for <code>--find-links</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10987">#10987</a>
        opened by <a href="https://github.com/apaleyes">@apaleyes</a>
        on 2025-01-27 15:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/apaleyes">@apaleyes</a></div>
            <div class="timeline-body">Summary
<p>Probably related to other similar entries, some of which are closed and some are open: <a href="https://github.com/astral-sh/uv/issues/3874">astral-sh/uv#3874</a>, <a href="https://github.com/astral-sh/uv/pull/5544">astral-sh/uv#5544</a>, <a href="https://github.com/astral-sh/uv/issues/7064">astral-sh/uv#7064</a></p>
<p>When generating requirements.txt file from the uv environment, it does not add hashes for dependencies supplied via <code>find-links</code>. This means that resulting requirements.txt file is not usable - <code>pip install</code> <a href="https://pip.pypa.io/en/stable/cli/pip_download/#cmdoption-require-hashes">cannot work</a> with a file where some dependencies have hashes and some don&#x27;t.</p>
Minimal example to reproduce
<p>Create a new directory with the following <code>pyproject.toml</code>:</p>
<pre><code>[project]
name = &quot;uv-hash-repro&quot;
version = &quot;0.1&quot;
requires-python = &quot;&gt;=3.10,&lt;3.13&quot;
dependencies = [
    &quot;torch&quot;,
    &quot;torch-geometric&quot;,
    &quot;torch-cluster&quot;,
    &quot;torch-scatter&quot;,
]

[tool.uv]
find-links = [
    &quot;https://data.pyg.org/whl/torch-2.5.1+cpu.html&quot;,
]

[[tool.uv.index]]
name = &quot;pytorch-cpu&quot;
url = &quot;https://download.pytorch.org/whl/cpu&quot;
explicit = true
</code></pre>
<p>Now run</p>
<pre><code>uv venv
uv sync
</code></pre>
<p>And now generate requirements with export, and observe absence of hashes:</p>
<pre><code>uv export --frozen --no-emit-project | grep -A 1 torch
</code></pre>
<p>On my machine this gives following output, where hashes for <code>torch-scatter</code> and <code>torch-cluster</code> are clearly missing:</p>
<pre><code>torch==2.5.1 \
    --hash=sha256:23d062bf70776a3d04dbe74db950db2a5245e1ba4f27208a87f0d743b0d06e86 \
--
torch-cluster==1.6.3 ; (platform_machine != &#x27;x86_64&#x27; and sys_platform == &#x27;linux&#x27;) or (platform_machine != &#x27;x86_64&#x27; and sys_platform == &#x27;win32&#x27;) or (sys_platform != &#x27;linux&#x27; and sys_platform != &#x27;win32&#x27;)
torch-cluster==1.6.3+pt25cpu ; (platform_machine == &#x27;x86_64&#x27; and sys_platform == &#x27;linux&#x27;) or (platform_machine == &#x27;x86_64&#x27; and sys_platform == &#x27;win32&#x27;)
torch-geometric==2.6.1 \
    --hash=sha256:1f18f9d0fc4d2239d526221e4f22606a4a3895b5d965a9856d27610a3df662c6 \
--
torch-scatter==2.1.2 ; (platform_machine != &#x27;x86_64&#x27; and sys_platform == &#x27;linux&#x27;) or (platform_machine != &#x27;x86_64&#x27; and sys_platform == &#x27;win32&#x27;) or (sys_platform != &#x27;linux&#x27; and sys_platform != &#x27;win32&#x27;)
torch-scatter==2.1.2+pt25cpu ; (platform_machine == &#x27;x86_64&#x27; and sys_platform == &#x27;linux&#x27;) or (platform_machine == &#x27;x86_64&#x27; and sys_platform == &#x27;win32&#x27;)
tqdm==4.67.1 \
</code></pre>
Platform
<p>macos (Darwin 23.2.0 arm64)</p>
Version
<p>uv 0.5.23</p>
Python version
<p>3.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/apaleyes">@apaleyes</a> on 2025-01-27 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-27 15:12</div>
            <div class="timeline-body"><p>Yeah, this is a duplicate of <a href="https://github.com/astral-sh/uv/issues/7064">astral-sh/uv#7064</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-27 15:15</div>
            <div class="timeline-body"><p>For what it&#x27;s worth, we may not change it. Adding hashes for <code>--find-links</code> would require downloading and hashing <em>all</em> distributions for a matching version in the index. For PyTorch, for example, this would be <em>incredibly</em> slow.</p>
<p>You can run with <code>--no-hashes</code> to omit hashes entirely (or use uv to install the file (which accepts partial hashes)).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-27 15:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/apaleyes">@apaleyes</a> on 2025-01-27 15:17</div>
            <div class="timeline-body"><p>that was lightning fast, thanks for the response @charliermarsh !</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:36:55 UTC
    </footer>
</body>
</html>
