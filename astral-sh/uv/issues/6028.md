```yaml
number: 6028
title: "`uv pip install` fails when install from files with `-r`, but passes \"regularly\""
type: issue
state: closed
author: MarcoGorelli
labels:
  - question
assignees: []
created_at: 2024-08-12T08:40:22Z
updated_at: 2024-08-13T22:17:26Z
url: https://github.com/astral-sh/uv/issues/6028
synced_at: 2026-01-10T01:57:13Z
```

# `uv pip install` fails when install from files with `-r`, but passes "regularly"

---

_Issue opened by @MarcoGorelli on 2024-08-12 08:40_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

Here's a minimal repro of what fails:

I have:
- `requirements-dev.txt`
  ```
  altair>=5.4.0
  ```
- `requirements-ci.txt`
  ```
  --extra-index-url https://download.pytorch.org/whl/cpu
  torch
  ```


Then:

âœ… the following passes:
```
python3.11 -m venv .venv
. .venv/bin/activate
uv pip install altair --extra-index-url https://download.pytorch.org/whl/cpu torch
```

ðŸ”´ the following fails:
```
python3.11 -m venv .venv
. .venv/bin/activate
uv pip install -r requirements-dev.txt -r requirements-ci.txt
```

Output from the one that fails:
```
  Ã— No solution found when resolving dependencies:
  â•°â”€â–¶ Because only typing-extensions{python_version < '3.13'}<4.10.0 is available and altair==5.4.0 depends on
      typing-extensions{python_version < '3.13'}>=4.10.0, we can conclude that altair==5.4.0 cannot be used.
      And because only altair<=5.4.0 is available and you require altair>=5.4.0, we can conclude that the requirements
      are unsatisfiable.
```

âœ… the following also passes:
```
python3.11 -m venv .venv
. .venv/bin/activate
pip install -r requirements-dev.txt -r requirements-ci.txt
```

---

_Referenced in [astral-sh/uv#6034](../../astral-sh/uv/issues/6034.md) on 2024-08-12 12:23_

---

_Comment by @zanieb on 2024-08-12 12:25_

```
uv pip install altair --extra-index-url https://download.pytorch.org/whl/cpu torch
```

This one probably passes because you're not including the `altair>=5.4.0`, just `altair` (and from the error, it's clear that's important)

```
pip install -r requirements-dev.txt -r requirements-ci.txt
```

This one probably passes because pip looks in multiple index URLs but we do not, you're probably looking for `--index-strategy unsafe-best-match`. See [the pip compatibility guide](https://github.com/astral-sh/uv/blob/main/PIP_COMPATIBILITY.md#packages-that-exist-on-multiple-indexes) for details.

---

_Label `question` added by @zanieb on 2024-08-12 12:26_

---

_Comment by @MarcoGorelli on 2024-08-13 22:14_

Ah, thanks @zanieb ! https://download.pytorch.org/whl/typing-extensions/ only goes up to 4.9

So, installing `typing-extensions` separately and _before_ all the other requirements worked ðŸ¥³ 
```
python3.11 -m venv .venv
. .venv/bin/activate
pip install -U uv
uv pip install typing-extensions>=4.10
uv pip install -r requirements-dev.txt -r requirements-ci.txt
```

---

_Comment by @zanieb on 2024-08-13 22:17_

That'll do it too! Glad you found a solution.

---

_Closed by @zanieb on 2024-08-13 22:17_

---

_Referenced in [pola-rs/polars#17995](../../pola-rs/polars/pulls/17995.md) on 2024-08-14 08:05_

---
