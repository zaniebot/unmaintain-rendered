<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uvx does not invalidate cache when source code changes with --from flag - astral-sh/uv #16196</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uvx does not invalidate cache when source code changes with --from flag</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16196">#16196</a>
        opened by <a href="https://github.com/oxysoft">@oxysoft</a>
        on 2025-10-09 01:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/oxysoft">@oxysoft</a></div>
            <div class="timeline-body"><p>uvx --from <local-path> aggressively caches installed packages and does NOT invalidate the cache when source files change, leading to developers running stale code even after making edits. This makes uvx completely unreliable for
local development workflows.</p>
<p>Steps to Reproduce</p>
<ol>
<li>Create a Python package with an entry point (e.g., MCP server)</li>
<li>Install and run it with: uvx --from /path/to/package my-command</li>
<li>Observe initial output</li>
<li>Edit the source code in /path/to/package/src/</li>
<li>Run the same command again: uvx --from /path/to/package my-command</li>
<li>BUG: The output is unchanged - the old cached version runs despite source code changes</li>
</ol>
<p>Expected Behavior</p>
<p>When using --from with a local file path, uvx should:</p>
<ul>
<li>Detect that the source is a local directory</li>
<li>Check if source files have been modified (via mtime or hash)</li>
<li>Invalidate the cache and reinstall if changes are detected</li>
<li>OR at minimum, provide a --no-cache or --reload flag</li>
</ul>
<p>Actual Behavior</p>
<p>uvx caches the package installation and never checks if the source has changed. Developers must:</p>
<ul>
<li>Manually find and delete cache directories</li>
<li>Use uv run instead (which defeats the purpose of uvx)</li>
<li>Restart their entire development environment</li>
<li>Waste hours debugging &quot;phantom&quot; bugs where their code changes don't appear</li>
</ul>
<p>Workaround</p>
<p>Use uv run from within the package directory instead:
cd /path/to/package &amp;&amp; uv run my-command</p>
<p>This is slower and more cumbersome but actually picks up source changes.</p>
<p>Impact</p>
<p>Critical for local development. This behavior makes uvx completely unusable for:</p>
<ul>
<li>Developing CLI tools</li>
<li>Testing MCP servers during development</li>
<li>Any iterative development workflow where you need to test changes quickly</li>
</ul>
<p>The --from flag strongly implies &quot;use this specific source location,&quot; but it actually means &quot;install from here once, then ignore it forever.&quot;</p>
<p>Environment</p>
<ul>
<li>uv version: (check with uv --version)</li>
<li>Platform: Linux (but likely affects all platforms)</li>
<li>Use case: MCP server development with FastMCP</li>
</ul>
<p>Suggested Fix</p>
<ol>
<li>Option A (Best): Detect local paths and always check modification time</li>
<li>Option B: Add --no-cache / --force-reinstall flag to uvx</li>
<li>Option C: Document this behavior prominently in --from documentation</li>
<li>Option D: Make uvx detect when --from points to a local path and emit a warning about caching</li>
</ol>
<p>Related Documentation Gaps</p>
<p>The uvx documentation does not mention:</p>
<ul>
<li>That it caches installations from local paths</li>
<li>How to clear the cache</li>
<li>When/why you should use uv run vs uvx --from</li>
<li>That code changes won't be reflected without cache invalidation</li>
</ul>
<p>This led to multiple hours wasted debugging &quot;why aren't my changes working&quot; when the code was fine - the tool was just lying about what it was running.</p>
<p>Reproduction Context</p>
<p>We were developing a Unity Profiler MCP server. Made changes to add a new tool (get_frames_overview), confirmed it existed in source, ran with uvx --from, tool didn't appear. Spent significant time debugging the MCP protocol,
FastMCP internals, tool registration, etc. - all of which were working correctly. The only issue was uvx running stale cached code.</p>
<p>Extremely frustrating user experience. The tool provided no indication it was using cached code.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-09 07:30</div>
            <div class="timeline-body"><p>There are several ways to solve this with uvx:</p>
<ul>
<li>Use an editable install instead of a regular install (<code>--with-editable</code>). This links Python code instead of copying it, so changes are instant</li>
<li>Use <code>--reinstall-package</code> (https://docs.astral.sh/uv/reference/cli/#uv-tool-run--reinstall-package)</li>
<li>Set <code>cache-keys</code> in the project itself</li>
<li>Use <code>--no-cache</code></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @konstin on 2025-10-09 07:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-09 07:33</div>
            <div class="timeline-body"><blockquote>
<p>Suggested Fix</p>
<pre><code>1. Option A (Best): Detect local paths and always check modification time

2. Option B: Add --no-cache / --force-reinstall flag to uvx

3. Option C: Document this behavior prominently in --from documentation

4. Option D: Make uvx detect when --from points to a local path and emit a warning about caching</code></pre>
<p>Related Documentation Gaps</p>
<p>The uvx documentation does not mention:</p>
<pre><code>* That it caches installations from local paths

* How to clear the cache

* When/why you should use uv run vs uvx --from

* That code changes won't be reflected without cache invalidation</code></pre>
<p>This led to multiple hours wasted debugging &quot;why aren't my changes working&quot; when the code was fine - the tool was just lying about what it was running.</p>
</blockquote>
<p>Please consult the uv documentation - These statements don't reflect what is actually implemented in <code>uvx</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-11-01 20:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:33:06 UTC
    </footer>
</body>
</html>
