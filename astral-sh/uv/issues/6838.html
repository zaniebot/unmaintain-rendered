<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv run fails if project table is missing - astral-sh/uv #6838</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv run fails if project table is missing</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6838">#6838</a>
        opened by <a href="https://github.com/jooon">@jooon</a>
        on 2024-08-29 22:35
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jooon">@jooon</a></div>
            <div class="timeline-body">

<p>I often interact with repositories with python code that has a pyproject.toml for tool configuration only. Unlike <a href="https://github.com/astral-sh/uv/issues/6419">astral-sh/uv#6419</a>, I can&#x27;t really tell if this is compliant or not, but it became common when black was released. It was one of the first really popular tools that required configuration to be in pyproject.toml.</p>
<p>Steps to reproduce.</p>
<pre><code>$ uv --version
uv 0.4.0
$ mkdir /tmp/test-pyproject
$ cd /tmp/test-pyproject
$ touch pyproject.toml
$ uv run python
error: No `project` table found in: `/tmp/test-pyproject/pyproject.toml`
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-30 00:20</div>
            <div class="timeline-body"><p>I think we&#x27;re unlikely to support projects with a <code>name</code>. It just simplifies a lot of things and enables us to have better error messages, etc. We should give a better error message here though!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-30 00:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-14 22:13</div>
            <div class="timeline-body"><p>I think #7399 is sufficient to close; we have a dedicated error now!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-14 22:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-14 22:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DeinAlptraum">@DeinAlptraum</a> on 2024-12-06 06:56</div>
            <div class="timeline-body"><p>Hello, I am still getting the exact same error here. This is on uv 0.5.6.
The original author&#x27;s reproducer still works exactly as is. The error message hasn&#x27;t changed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-06 12:03</div>
            <div class="timeline-body"><p>I think I misunderstood the initial report and fixed a slightly different case (the case wherein <code>[project]</code> is present but <code>project.name</code> is absent). I think it&#x27;s correct for us to be erroring here -- is there a real use-case for this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DeinAlptraum">@DeinAlptraum</a> on 2024-12-06 12:24</div>
            <div class="timeline-body"><p>I&#x27;m not familiar with what a pyproject.toml is supposed to do and not to do, and I don&#x27;t really care tbh. If I can&#x27;t even query my python version through uv anymore just because this file is present, I think that&#x27;s problematic. I&#x27;m also not sure why this file affects the <code>uv run python [...]</code> command in the first place: afaic this should act the same as if I did <code>source &lt;path to venv&gt;/bin/activate &amp;&amp; python [...]</code>, which doesn&#x27;t care about the pyproject.toml at all.
Perhaps throwing a warning about an ill-formed pyproject.toml and then continuing normally would be better?</p>
<p>Whether there&#x27;s a use-case for this, I don&#x27;t know. I can only tell you that people seem to be using it that way, because I&#x27;ve already run into that error on another 2 repos since I posted that comment a couple hours ago.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DeinAlptraum">@DeinAlptraum</a> on 2024-12-06 12:33</div>
            <div class="timeline-body"><p>I just looked at https://docs.astral.sh/uv/configuration/files/, which says:
&quot;If a <code>pyproject.toml</code> file is found, uv will read configuration from the <code>[tool.uv]</code> table.
[...]
(If there is no such table, the <code>pyproject.toml</code> file will be ignored, and uv will continue searching in the directory hierarchy.)&quot;
which is not the case at the moment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jooon">@jooon</a> on 2024-12-09 11:53</div>
            <div class="timeline-body"><p>The main intention of <code>pyproject.toml</code> (created long before uv was conceived) was to define a python project. It declares its name, version, author, dependencies, etc and also declare how it is built. Basically replace <code>setup.py</code>, <code>setup.cfg</code> etc. as well as be a common configuration file format for python project tools. However, just like <code>setup.cfg</code>, it can also store configuration for different tools that you might use in your project, like isort, black, ruff, pytest, mypy, as well as uv. @DeinAlptraum The page you are linking to only refers to uv using <code>pyproject.toml</code> as ONE way to configure it. I agree it is very confusing though and it should probably be rewritten to highlight that better. There is more documentation about the project specific parts of <code>pyproject.toml</code> starting at https://docs.astral.sh/uv/concepts/projects/layout/</p>
<p>Tools that store its config in <code>pyproject.toml</code> will only read that file for its own configuration and then ignore everything else. It might check that the file is valid toml, but that&#x27;s it.</p>
<p>Most tools that read <code>pyproject.toml</code> can also read other configuration files like <code>setup.cfg</code>, <code>tox.ini</code>, their own format.</p>
<p>Except black. It only reads <code>pyproject.toml</code>. Black was adopted by many projects. Even projects that had not yet moved to using <code>pyproject.toml</code> for the project metadata. This means that there are a lot of <code>pyproject.toml</code> files out there without a <code>[project]</code> table. (We are likely outliers, but I found 1291 <code>pyproject.toml</code> files at the company where I work, of which only 374 have a <code>[project]</code> table).</p>
<p>uv is not like most tools. It has many different use cases. Since 0.4 you can run it as a project tool. You can also use it as a pip and/or pip-compile replacement.</p>
<p>However, what makes things everything extra confusing is that you CAN ALSO use project specific commands like <code>run</code> outside of a project, where there is no <code>pyproject.toml</code>. What seems to happen here is that a special implicit project is created on the fly.</p>
<p>Because that works, it is very confusing when it doesn&#x27;t work if you are in a directory of a python project that has a <code>pyproject.toml</code> without a <code>[project]</code> table.</p>
<p>Personally I am ok if requires a project table in <code>pyproject.toml</code> files. I am teaching all my colleagues how to migrate to <code>pyproject.toml</code> files anyway. But I would also be totally ok if uv would treat a missing project table the same as a missing <code>pyproject.toml</code> file. I think this will make the transition to uv smoother.</p>
<p>There would of course have to be some corner cases that I can&#x27;t figure out now. What if you find two <code>pyproject.toml</code> files. One in the root of a project with a <code>[project]</code> and another in a subdirectory without a <code>[project]</code>. Both files have <code>[tool.uv...]</code> sections. Will one <code>[tool.uv...]</code> section still override the other? Or can the validation rule be changed to only require a <code>[project]</code> table if there is also a <code>[tool.uv...]</code> section?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DeinAlptraum">@DeinAlptraum</a> on 2024-12-11 16:02</div>
            <div class="timeline-body"><p>@jooon wow, thanks a lot for taking the time to explain!</p>
<p>I see that the docs you linked also mention that &quot;uv requires this file&quot; so I guess that&#x27;s fair. Makes me wonder why it works even without it then, but I&#x27;m not complaining :D
Like you said, uv would at least benefit from a clearer documentation &amp; communication of how running it with and without a project file present differs, because at the moment it&#x27;s quite confusing - especially when you&#x27;re not familiar with <code>pyproject.toml</code>s and you&#x27;re just using uv to manage your venv and dependencies</p>
<blockquote>
<p>But I would also be totally ok if uv would treat a missing project table the same as a missing pyproject.toml file</p>
</blockquote>
<p>I would prefer this, but just improving the error message would also be sufficient to resolve this issue imo. Perhaps a link to the docs that explains how uv expects <code>pyproject.toml</code> to be used, or some sort of flag that could be set to ignore this error or similar.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/frankh">@frankh</a> on 2025-02-19 09:41</div>
            <div class="timeline-body"><p>I think this should be reopened</p>
<p>it&#x27;s frustrating at the moment that trying to use uv with certain projects fails, e.g. if pyproject.yaml exists but only contains settings for <code>black</code>, which is pretty common, uv simply won&#x27;t work at all unless you migrate everything over to pyproject.yaml</p>
<p>imo if [project] is missing from pyproject.yaml uv should behave as if pyproject.yaml doesn&#x27;t exist at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/caner-cetin">@caner-cetin</a> on 2025-02-25 20:51</div>
            <div class="timeline-body"><p>agreed with @frankh  pyproject toml only exists for pyright and black for me, I dont need any metadata :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ylluminate">@ylluminate</a> on 2025-03-21 22:02</div>
            <div class="timeline-body"><p>It would be nice to be able to use this with projects that we don&#x27;t have control over and may not be precisely as expected. An example might be trying to work with a project like this (simple example, but there are tons of similar scenarios): https://github.com/rohitg00/s3-file-share-for-free</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Teut2711">@Teut2711</a> on 2025-06-15 18:29</div>
            <div class="timeline-body"><p>I deleted the pyproject.toml and used <code>uv init</code> and then it worked</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alexeydubinin">@alexeydubinin</a> on 2025-06-25 14:09</div>
            <div class="timeline-body"><p>+1 for reopen</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/acdha">@acdha</a> on 2025-07-01 15:25</div>
            <div class="timeline-body"><p>I just ran into this as a friction point on a project which is mostly not Python but has a couple of utility scripts. It had a <code>pyproject.toml</code> file which existed only to hold Ruff&#x27;s settings (migrated from Black) so the fix ended up being renaming the file to <code>.ruff.toml</code> but it was an annoying bit of friction since <code>uv run --script</code> is otherwise so painless for single-file programs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/silverwind">@silverwind</a> on 2025-07-15 16:35</div>
            <div class="timeline-body"><p>I think the <code>[project]</code> section could be made optional. Use case is running a python tool like <code>yamllint</code> in a non-python project, so ideally my <code>pyproject.toml</code> would only hold the dependency declarations, not a useless <code>project.name</code> or <code>project.version</code> because those are declared in other files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-15 17:05</div>
            <div class="timeline-body"><p>I believe this is being addressed in <a href="https://github.com/astral-sh/uv/pull/14113">astral-sh/uv#14113</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-15 17:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/silverwind">@silverwind</a> on 2025-07-15 17:22</div>
            <div class="timeline-body"><p>That one looks promising. Personally I only use <code>uv run</code> and <code>uv sync</code> in such projects and I think those commands are covered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-15 17:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-15 17:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hsunner">@hsunner</a> on 2025-07-16 11:57</div>
            <div class="timeline-body"><p>As far as I can tell the issue also creates a Catch-22 that prevents you from using uv to run tools (ini2toml, pdm) to migrate from setup.cfg to pyproject.toml.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-17 15:48</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:33:28 UTC
    </footer>
</body>
</html>
