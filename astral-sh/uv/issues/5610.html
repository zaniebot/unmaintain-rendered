<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publish variants of Docker image - astral-sh/uv #5610</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Publish variants of Docker image</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5610">#5610</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-07-30 16:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>Instead of only supplying a bare image, we should publish an alpine variant and a variant with Python so people can use our image without creating a custom derivative.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-30 16:44</div>
            <div class="timeline-body"><p>For example, this is important for GitLab CI which requires <code>sh</code>.</p>
<p>This applies to Ruff as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by @zanieb on 2024-07-30 16:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-30 21:14</div>
            <div class="timeline-body"><p>This should basically be trivial, we just need to setup a folder with a few variants, copy in the executable from the scratch image, and publish them each release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @zanieb on 2024-07-30 21:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-07-31 07:42</div>
            <div class="timeline-body"><p>When building an optimized production image, i'd need two base images: A builder with uv, my python version and ideally a bunch of dev libraries (curl, git, gcc, dev headers), and a runner image that has python in the same location as the builder, in which i only copy the venv and call <code>python</code> as entrypoint.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-31 13:16</div>
            <div class="timeline-body"><p>I think we can describe a few goals here:</p>
<ol>
<li>Allow uv to be used in GitLab CI, i.e. provide a image with a shell</li>
<li>Allow uv to be used as a Python image, i.e. provide an image for each Python version with development tools</li>
<li>Document best practices for deriving a minimal production image from (2)</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mayuresh-quartic">@mayuresh-quartic</a> on 2024-07-31 17:18</div>
            <div class="timeline-body"><p>I can suggest few approach to this:</p>
<ul>
<li>Pull latest python slim images</li>
<li>Install uv latest version in global system</li>
</ul>
<p>I can create Dockerfiles quickly for this</p>
<p>This will be minimal with no extra apt or system packages</p>
<p>@zanieb</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mayuresh-quartic">@mayuresh-quartic</a> on 2024-07-31 17:21</div>
            <div class="timeline-body"><p>Later I can think of some CI to automate this:</p>
<p>On official release publish these Python version images with UV installed:
Python3.8
Python3.9
Python3.10
Python3.11
Python3.12</p>
<p>or as per UV support matrix</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-31 17:26</div>
            <div class="timeline-body"><p>Sure, a couple notes:</p>
<ul>
<li>I think I'd use a single Dockerfile parameterized on Python version.</li>
<li>We should copy the <code>uv</code> executable from our scratch Docker image instead of installing from, e.g., curl</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mayuresh-quartic">@mayuresh-quartic</a> on 2024-07-31 17:30</div>
            <div class="timeline-body"><p>For example here is the uv image i created based on Python3.9 version: mayuresh14/uv-python39-slim</p>
<p>Dockerfile looks like this</p>
<pre><code>FROM --platform=linux/amd64 python:3.9-slim

RUN pip install uv
</code></pre>
<p>I will keep in mind your mentioned notes and create a PR soon</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-09-03 13:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:25:52 UTC
    </footer>
</body>
</html>
