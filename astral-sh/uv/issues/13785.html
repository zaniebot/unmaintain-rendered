<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv sync` updates `uv` itself away from the pinned version - astral-sh/uv #13785</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv sync</code> updates <code>uv</code> itself away from the pinned version</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13785">#13785</a>
        opened by <a href="https://github.com/gboeing">@gboeing</a>
        on 2025-06-02 16:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gboeing">@gboeing</a> on 2025-06-02 16:27</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>In my pyproject.toml I have:</p>
<pre><code>[tool.uv]
required-version = &quot;==0.7.8&quot;
</code></pre>
<p>When I run <code>astral-sh/setup-uv@v6</code> in a <a href="https://github.com/gboeing/osmnx/actions/runs/15384021106/job/43279296468">Github workflow</a> it correctly installs the right version:</p>
<pre><code>Found required-version for uv in /home/runner/work/osmnx/osmnx/pyproject.toml: 0.7.8
Downloading uv from &quot;https://github.com/astral-sh/uv/releases/download/0.7.8/uv-x86_64-unknown-linux-gnu.tar.gz&quot; ...
/usr/bin/tar xz --warning=no-unknown-keyword --overwrite -C /home/runner/work/_temp/e9690fd8-35b4-4344-8eec-29b9d7864b84 -f /home/runner/work/_temp/6c50bff7-e036-46ae-9dcd-701c4b46c29a
Added /home/runner/.local/bin to the path
Added /opt/hostedtoolcache/uv/0.7.8/x86_64 to the path
Activating python venv...
/opt/hostedtoolcache/uv/0.7.8/x86_64/uv venv .venv --directory /home/runner/work/osmnx/osmnx
Using CPython 3.12.3 interpreter at: /usr/bin/python3
Creating virtual environment at: .venv
Set UV_CACHE_DIR to /home/runner/work/_temp/setup-uv-cache
Successfully installed uv version 0.7.8
</code></pre>
<p>But when I run <code>uv sync</code> it upgrades <code>uv</code> itself to the latest 0.7.9. This means that when I subsequently run <code>uv run something</code>, it gives an error:</p>
<pre><code>error: Required uv version `==0.7.8` does not match the running version `0.7.9`. Update `uv` by running `uv self update 0.7.8`.
Error: Process completed with exit code 2.
</code></pre>
<p>Why would <code>uv sync</code> upgrade uv away from its pinned version in pyproject.toml? How do I prevent this incompatibility?</p>
<h3>Platform</h3>
<p>ubuntu</p>
<h3>Version</h3>
<p>0.7.8</p>
<h3>Python version</h3>
<p>3.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @gboeing on 2025-06-02 16:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-02 16:40</div>
            <div class="timeline-body"><p>It sounds like you are using both <code>required-version</code> and another <code>uv</code> dependency declaration? Can you share the output of <code>uv tree</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-06-02 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-06-02 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gboeing">@gboeing</a> on 2025-06-02 21:12</div>
            <div class="timeline-body"><p>Thanks @zanieb. Sure, here's the results for running <code>uv tree</code> then <code>uv sync --all-extras --dev</code> to set up my CI environment. My project uses <code>hatch</code> which in turn seems to pull in <code>uv</code> 0.7.9. Shouldn't <code>uv</code> remain pinned to the 'required-version' from pyproject.toml (0.7.8)? Is there some way to prevent it from updating to a non-pinned version?</p>
<pre><code>Resolved 139 packages in 796ms
osmnx
├── geopandas v1.1.0
│   ├── numpy v2.2.6
│   ├── packaging v25.0
│   ├── pandas v2.2.3
│   │   ├── numpy v2.2.6
│   │   ├── python-dateutil v2.9.0.post0
│   │   │   └── six v1.17.0
│   │   ├── pytz v2025.2
│   │   └── tzdata v2025.2
│   ├── pyogrio v0.11.0
│   │   ├── certifi v2025.4.26
│   │   ├── numpy v2.2.6
│   │   └── packaging v25.0
│   ├── pyproj v3.7.1
│   │   └── certifi v2025.4.26
│   └── shapely v2.1.1
│       └── numpy v2.2.6
├── networkx v3.5
├── numpy v2.2.6
├── pandas v2.2.3 (*)
├── requests v2.32.3
│   ├── certifi v2025.4.26
│   ├── charset-normalizer v3.4.2
│   ├── idna v3.10
│   └── urllib3 v2.4.0
├── shapely v2.1.1 (*)
├── scipy v1.15.3 (extra: entropy)
│   └── numpy v2.2.6
├── scikit-learn v1.6.1 (extra: neighbors)
│   ├── joblib v1.5.1
│   ├── numpy v2.2.6
│   ├── scipy v1.15.3 (*)
│   └── threadpoolctl v3.6.0
├── scipy v1.15.3 (extra: neighbors) (*)
├── rasterio v1.4.3 (extra: raster)
│   ├── affine v2.4.0
│   ├── attrs v25.3.0
│   ├── certifi v2025.4.26
│   ├── click v8.2.1
│   ├── click-plugins v1.1.1
│   │   └── click v8.2.1
│   ├── cligj v0.7.2
│   │   └── click v8.2.1
│   ├── numpy v2.2.6
│   └── pyparsing v3.2.3
├── rio-vrt v0.3.1 (extra: raster)
│   └── rasterio v1.4.3 (*)
├── matplotlib v3.10.3 (extra: visualization)
│   ├── contourpy v1.3.2
│   │   └── numpy v2.2.6
│   ├── cycler v0.12.1
│   ├── fonttools v4.58.1
│   ├── kiwisolver v1.4.8
│   ├── numpy v2.2.6
│   ├── packaging v25.0
│   ├── pillow v11.2.1
│   ├── pyparsing v3.2.3
│   └── python-dateutil v2.9.0.post0 (*)
├── furo v2024.8.6 (group: dev)
│   ├── beautifulsoup4 v4.13.4
│   │   ├── soupsieve v2.7
│   │   └── typing-extensions v4.14.0
│   ├── pygments v2.19.1
│   ├── sphinx v8.2.3
│   │   ├── alabaster v1.0.0
│   │   ├── babel v2.17.0
│   │   ├── docutils v0.21.2
│   │   ├── imagesize v1.4.1
│   │   ├── jinja2 v3.1.6
│   │   │   └── markupsafe v3.0.2
│   │   ├── packaging v25.0
│   │   ├── pygments v2.19.1
│   │   ├── requests v2.32.3 (*)
│   │   ├── roman-numerals-py v3.1.0
│   │   ├── snowballstemmer v3.0.1
│   │   ├── sphinxcontrib-applehelp v2.0.0
│   │   ├── sphinxcontrib-devhelp v2.0.0
│   │   ├── sphinxcontrib-htmlhelp v2.1.0
│   │   ├── sphinxcontrib-jsmath v1.0.1
│   │   ├── sphinxcontrib-qthelp v2.0.0
│   │   └── sphinxcontrib-serializinghtml v2.0.0
│   └── sphinx-basic-ng v1.0.0b2
│       └── sphinx v8.2.3 (*)
├── hatch v1.14.1 (group: dev)
│   ├── click v8.2.1
│   ├── hatchling v1.27.0
│   │   ├── packaging v25.0
│   │   ├── pathspec v0.12.1
│   │   ├── pluggy v1.6.0
│   │   └── trove-classifiers v2025.5.9.12
│   ├── httpx v0.28.1
│   │   ├── anyio v4.9.0
│   │   │   ├── idna v3.10
│   │   │   └── sniffio v1.3.1
│   │   ├── certifi v2025.4.26
│   │   ├── httpcore v1.0.9
│   │   │   ├── certifi v2025.4.26
│   │   │   └── h11 v0.16.0
│   │   └── idna v3.10
│   ├── hyperlink v21.0.0
│   │   └── idna v3.10
│   ├── keyring v25.6.0
│   │   ├── jaraco-classes v3.4.0
│   │   │   └── more-itertools v10.7.0
│   │   ├── jaraco-context v6.0.1
│   │   ├── jaraco-functools v4.1.0
│   │   │   └── more-itertools v10.7.0
│   │   ├── jeepney v0.9.0
│   │   └── secretstorage v3.3.3
│   │       ├── cryptography v45.0.3
│   │       │   └── cffi v1.17.1
│   │       │       └── pycparser v2.22
│   │       └── jeepney v0.9.0
│   ├── packaging v25.0
│   ├── pexpect v4.9.0
│   │   └── ptyprocess v0.7.0
│   ├── platformdirs v4.3.8
│   ├── rich v14.0.0
│   │   ├── markdown-it-py v3.0.0
│   │   │   └── mdurl v0.1.2
│   │   └── pygments v2.19.1
│   ├── shellingham v1.5.4
│   ├── tomli-w v1.2.0
│   ├── tomlkit v0.13.2
│   ├── userpath v1.9.2
│   │   └── click v8.2.1
│   ├── uv v0.7.9
│   ├── virtualenv v20.31.2
│   │   ├── distlib v0.3.9
│   │   ├── filelock v3.18.0
│   │   └── platformdirs v4.3.8
│   └── zstandard v0.23.0
├── lxml v5.4.0 (group: dev)
├── pre-commit v4.2.0 (group: dev)
│   ├── cfgv v3.4.0
│   ├── identify v2.6.12
│   ├── nodeenv v1.9.1
│   ├── pyyaml v6.0.2
│   └── virtualenv v20.31.2 (*)
├── pytest v8.4.0 (group: dev)
│   ├── iniconfig v2.1.0
│   ├── packaging v25.0
│   ├── pluggy v1.6.0
│   └── pygments v2.19.1
├── pytest-cov v6.1.1 (group: dev)
│   ├── coverage[toml] v7.8.2
│   └── pytest v8.4.0 (*)
├── pytest-xdist v3.7.0 (group: dev)
│   ├── execnet v2.1.1
│   └── pytest v8.4.0 (*)
├── sphinx v8.2.3 (group: dev) (*)
├── sphinx-autodoc-typehints v3.2.0 (group: dev)
│   └── sphinx v8.2.3 (*)
├── twine v6.1.0 (group: dev)
│   ├── id v1.5.0
│   │   └── requests v2.32.3 (*)
│   ├── keyring v25.6.0 (*)
│   ├── packaging v25.0
│   ├── readme-renderer v44.0
│   │   ├── docutils v0.21.2
│   │   ├── nh3 v0.2.21
│   │   └── pygments v2.19.1
│   ├── requests v2.32.3 (*)
│   ├── requests-toolbelt v1.0.0
│   │   └── requests v2.32.3 (*)
│   ├── rfc3986 v2.0.0
│   ├── rich v14.0.0 (*)
│   └── urllib3 v2.4.0
├── typeguard v4.4.2 (group: dev)
│   └── typing-extensions v4.14.0
└── validate-pyproject v0.24.1 (group: dev)
    └── fastjsonschema v2.21.1
(*) Package tree already displayed
Resolved 139 packages in 0.81ms
   Building osmnx @ file:///home/runner/work/osmnx/osmnx
Downloading lxml (4.7MiB)
Downloading numpy (15.8MiB)
Downloading cryptography (4.3MiB)
Downloading sphinx (3.4MiB)
Downloading kiwisolver (1.4MiB)
Downloading scikit-learn (12.6MiB)
Downloading fonttools (4.6MiB)
Downloading uv (16.6MiB)
Downloading pygments (1.2MiB)
Downloading matplotlib (8.2MiB)
Downloading shapely (2.9MiB)
Downloading virtualenv (5.8MiB)
Downloading pandas (12.1MiB)
Downloading scipy (35.5MiB)
Downloading babel (9.7MiB)
Downloading pyogrio (26.4MiB)
Downloading networkx (1.9MiB)
Downloading zstandard (5.2MiB)
Downloading pillow (4.4MiB)
Downloading pyproj (9.1MiB)
Downloading rasterio (21.2MiB)
      Built osmnx @ file:///home/runner/work/osmnx/osmnx
 Downloading kiwisolver
 Downloading pygments
 Downloading shapely
 Downloading networkx
 Downloading zstandard
 Downloading sphinx
 Downloading pillow
 Downloading cryptography
 Downloading virtualenv
 Downloading fonttools
 Downloading lxml
 Downloading pyproj
 Downloading matplotlib
 Downloading uv
 Downloading numpy
 Downloading babel
 Downloading scikit-learn
 Downloading pyogrio
 Downloading rasterio
 Downloading pandas
 Downloading scipy
Prepared 115 packages in 2.88s
Installed 115 packages in 155ms
 + affine==2.4.0
 + alabaster==1.0.0
 + anyio==4.9.0
 + attrs==25.3.0
 + babel==2.17.0
 + beautifulsoup4==4.13.4
 + certifi==2025.4.26
 + cffi==1.17.1
 + cfgv==3.4.0
 + charset-normalizer==3.4.2
 + click==8.2.1
 + click-plugins==1.1.1
 + cligj==0.7.2
 + contourpy==1.3.2
 + coverage==7.8.2
 + cryptography==45.0.3
 + cycler==0.12.1
 + distlib==0.3.9
 + docutils==0.21.2
 + execnet==2.1.1
 + fastjsonschema==2.21.1
 + filelock==3.18.0
 + fonttools==4.58.1
 + furo==2024.8.6
 + geopandas==1.1.0
 + h11==0.16.0
 + hatch==1.14.1
 + hatchling==1.27.0
 + httpcore==1.0.9
 + httpx==0.28.1
 + hyperlink==21.0.0
 + id==1.5.0
 + identify==2.6.12
 + idna==3.10
 + imagesize==1.4.1
 + iniconfig==2.1.0
 + jaraco-classes==3.4.0
 + jaraco-context==6.0.1
 + jaraco-functools==4.1.0
 + jeepney==0.9.0
 + jinja2==3.1.6
 + joblib==1.5.1
 + keyring==25.6.0
 + kiwisolver==1.4.8
 + lxml==5.4.0
 + markdown-it-py==3.0.0
 + markupsafe==3.0.2
 + matplotlib==3.10.3
 + mdurl==0.1.2
 + more-itertools==10.7.0
 + networkx==3.5
 + nh3==0.2.21
 + nodeenv==1.9.1
 + numpy==2.2.6
 + osmnx==2.0.3 (from file:///home/runner/work/osmnx/osmnx)
 + packaging==25.0
 + pandas==2.2.3
 + pathspec==0.12.1
 + pexpect==4.9.0
 + pillow==11.2.1
 + platformdirs==4.3.8
 + pluggy==1.6.0
 + pre-commit==4.2.0
 + ptyprocess==0.7.0
 + pycparser==2.22
 + pygments==2.19.1
 + pyogrio==0.11.0
 + pyparsing==3.2.3
 + pyproj==3.7.1
 + pytest==8.4.0
 + pytest-cov==6.1.1
 + pytest-xdist==3.7.0
 + python-dateutil==2.9.0.post0
 + pytz==2025.2
 + pyyaml==6.0.2
 + rasterio==1.4.3
 + readme-renderer==44.0
 + requests==2.32.3
 + requests-toolbelt==1.0.0
 + rfc3986==2.0.0
 + rich==14.0.0
 + rio-vrt==0.3.1
 + roman-numerals-py==3.1.0
 + scikit-learn==1.6.1
 + scipy==1.15.3
 + secretstorage==3.3.3
 + shapely==2.1.1
 + shellingham==1.5.4
 + six==1.17.0
 + sniffio==1.3.1
 + snowballstemmer==3.0.1
 + soupsieve==2.7
 + sphinx==8.2.3
 + sphinx-autodoc-typehints==3.2.0
 + sphinx-basic-ng==1.0.0b2
 + sphinxcontrib-applehelp==2.0.0
 + sphinxcontrib-devhelp==2.0.0
 + sphinxcontrib-htmlhelp==2.1.0
 + sphinxcontrib-jsmath==1.0.1
 + sphinxcontrib-qthelp==2.0.0
 + sphinxcontrib-serializinghtml==2.0.0
 + threadpoolctl==3.6.0
 + tomli-w==1.2.0
 + tomlkit==0.13.2
 + trove-classifiers==2025.5.9.12
 + twine==6.1.0
 + typeguard==4.4.2
 + typing-extensions==4.14.0
 + tzdata==2025.2
 + urllib3==2.4.0
 + userpath==1.9.2
 + uv==0.7.9
 + validate-pyproject==0.24.1
 + virtualenv==20.31.2
 + zstandard==0.23.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-02 21:39</div>
            <div class="timeline-body"><blockquote>
<p>Shouldn't uv remain pinned to the 'required-version' from pyproject.toml (0.7.8)? Is there some way to prevent it from updating to a non-pinned version?</p>
</blockquote>
<p>The <code>required-version</code> just enforces that the version of uv you're invoking matches the given value. It does not affect package resolution, locking, or installation.</p>
<p>I'm not quite sure what to suggest here. We don't intend for people to install uv inside their projects. And, even if it is installed by a transitive dependency, we don't expect people to be using the uv from <em>inside</em> a virtual environment to manage their project. Instead, we'd expect you to use <code>uv run ...</code> to run commands in the environment and <code>uv</code> outside the environment would use what's on your system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gboeing">@gboeing</a> on 2025-06-02 23:22</div>
            <div class="timeline-body"><blockquote>
<p>The required-version just enforces that the version of uv you're invoking matches the given value. It does not affect package resolution, locking, or installation.</p>
</blockquote>
<p>But <code>astral-sh/setup-uv@v6</code> <em>does</em> pull it from pyproject.toml to choose which version to install, right?</p>
<blockquote>
<p>And, even if it is installed by a transitive dependency, we don't expect people to be using the uv from inside a virtual environment to manage their project.</p>
</blockquote>
<p>I think this was the clue I needed to solve my problem! I had <code>astral-sh/setup-uv@v6</code> set up like this:</p>
<pre><code>      - name: Install uv
        uses: astral-sh/setup-uv@v6
        with:
          activate-environment: true
          cache-dependency-glob: pyproject.toml
          enable-cache: true
          python-version: ${{ matrix.python-version }}
</code></pre>
<p>Removing <code>activate-environment: true</code> seems to fix it so that I'm no longer using the arbitrary version of <code>uv</code> pulled in when I install the hatch dependency.</p>
<p>So, what then is the use case for <code>activate-environment: true</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-02 23:25</div>
            <div class="timeline-body"><p>I see</p>
<p>The use-case is for people who want all of their environment to be on their <code>PATH</code>, which is nice sometimes so you can avoid <code>uv run</code> and have other <code>python</code> invocations &quot;work&quot;. I don't recommend it generally though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-02 23:28</div>
            <div class="timeline-body"><p>I'll add a note to the docs there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-06-28 13:25</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:02 UTC
    </footer>
</body>
</html>
