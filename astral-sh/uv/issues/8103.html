<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Broken handling of `python-requires` with a `!=` version specification - astral-sh/uv #8103</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Broken handling of <code>python-requires</code> with a <code>!=</code> version specification</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/8103">#8103</a>
        opened by <a href="https://github.com/scolby33">@scolby33</a>
        on 2024-10-10 18:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/scolby33">@scolby33</a> on 2024-10-10 18:27</div>
            <div class="timeline-body"><p>If you create a directory containing only the following <code>pyproject.toml</code>:</p>
<pre><code class="language-toml">[project]
name = &quot;broken_requires&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;!=3.11&quot;
</code></pre>
<p>And then run <code>uv build</code>, you receive the following error:</p>
<pre><code class="language-console">$ uv build --verbose
DEBUG uv 0.4.20 (Homebrew 2024-10-08)
DEBUG Found workspace root: `/Users/scott/src/broken_requires`
DEBUG Adding current workspace member: `/Users/scott/src/broken_requires`
DEBUG Searching for Python &lt;3.11, &gt;3.11 in managed installations or system path
DEBUG Searching for managed installations at `/Users/scott/.local/share/uv/python`
DEBUG Found `cpython-3.13.0-macos-aarch64-none` at `/opt/homebrew/bin/python3` (search path)
DEBUG Found `cpython-3.9.6-macos-aarch64-none` at `/usr/bin/python3` (search path)
DEBUG Requested Python not found, checking for available download...
DEBUG Acquired lock for `/Users/scott/.local/share/uv/python`
DEBUG Released lock at `/Users/scott/.local/share/uv/python/.lock`
error: No interpreter found for Python &lt;3.11, &gt;3.11 in virtual environments, managed installations, or system path
</code></pre>
<p>It seems to me that uv is expanding the <code>!=3.11</code> version specification to <code>&lt;3.11, &gt;3.11</code>, which is unfortunately impossible to satisfy. (See <a href="https://packaging.python.org/en/latest/specifications/version-specifiers/#id5">here</a>: 'The comma (“,”) is equivalent to a logical <strong>and</strong> operator')</p>
<p>I think uv should have an internal representation of a logical <strong>or</strong> operator (which is not part of the version specifiers scheme) or should not perform the improper expansion of a <strong>not equal</strong> to a logical <strong>and</strong>.</p>
<p>I am running uv installed from Homebrew on macOS 14.6.1.</p>
<pre><code class="language-console">$ uv --version
uv 0.4.20 (Homebrew 2024-10-08)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-10 18:34</div>
            <div class="timeline-body"><p>Is this a duplicate of #7862 which was recently resolved by https://github.com/astral-sh/uv/pull/7897 (not yet released)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 18:45</div>
            <div class="timeline-body"><p>Yeah it is</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/scolby33">@scolby33</a> on 2024-10-10 18:51</div>
            <div class="timeline-body"><p>Oh thanks for finding that! I tried to search but I guess GitHub didn't like the <code>!=</code> string in the search query.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @scolby33 on 2024-10-10 18:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 19:03</div>
            <div class="timeline-body"><p>No problem, that's a brutal search query :D</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:45 UTC
    </footer>
</body>
</html>
