<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv.lock` revision and upload time - astral-sh/uv #13738</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv.lock</code> revision and upload time</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13738">#13738</a>
        opened by <a href="https://github.com/mattyoungberg">@mattyoungberg</a>
        on 2025-05-30 17:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mattyoungberg">@mattyoungberg</a> on 2025-05-30 17:54</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I'm trying to understand the difference in lock output between mine and a coworker's computer that clutters our VCS whenever we bump dependencies in our project.</p>
<p>When <code>uv</code> locks and produces the <code>uv.lock</code> file, there are two things my uv will do differently compared to my coworker:</p>
<ol>
<li>The top-level lockfile key <code>revision</code> is set to 1.</li>
<li>Every node describing an artifact from a PyPI doesn't include the <code>upload-time</code> key.</li>
</ol>
<p>I'm on uv 0.7.8, running on Ubuntu LTS 24.04 x86_64. This seems to be the &quot;normal&quot; thing many of the boxes I'm working with produce.</p>
<p>My coworker will lock the same exact <code>pyproject.toml</code>, but his will uniquely do the following:</p>
<ol>
<li>The top-level lockfile key <code>revision</code> is set to 2.</li>
<li>Every node describing an artifact from a PyPI includes the <code>upload-time</code> key.</li>
</ol>
<p>He's running uv 0.7.2 (481d05d8d 2025-04-30) on MacOS's Darwin 23.2.0 arm64.</p>
<p>We have a project that's highly sensitive to dependency changes, and so we manually review the lockfile. For some reason, my coworker's commits generate a bunch of noise in the diff from having a seemingly later lockfile type despite being on an earlier version of <code>uv</code>.</p>
<p>I'm struggling to find a description of the contents of a <code>uv</code> lockfile such that I can perhaps figure out where these differences are coming from. Can anyone explain it to me?</p>
<h3>Platform</h3>
<p>Darwin 23.2.0 arm64</p>
<h3>Version</h3>
<p>uv 0.7.2 (481d05d8d 2025-04-30)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @mattyoungberg on 2025-05-30 17:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-30 17:57</div>
            <div class="timeline-body"><p>The <code>upload-time</code> field was added in v0.6.15. Are you certain that you're on uv v0.7.8?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-30 17:59</div>
            <div class="timeline-body"><p>You're on different uv versions, in which a latter version added a new field to the file. The revision number is used to detect such changes at deserialization time. As Charlie said, it sounds like you're not actually on the later version? See https://github.com/astral-sh/uv/pull/12968</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mattyoungberg">@mattyoungberg</a> on 2025-05-30 18:02</div>
            <div class="timeline-body"><p>Yep! User error, as always. I had <em>just</em> upgraded to the latest version before making sure this really was a problem; I was on 0.6.2 before. I didn't have anything to bump for my test, though, and so I'm guessing when I ran <code>uv lock</code>, it elected to leave the lockfile alone? Or some other user-error thing I'm not accounting for.</p>
<p>I just provided it a library to bump, and all of a sudden I'm getting  the #2 revision and the upload-time keys.</p>
<p>Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-30 18:05</div>
            <div class="timeline-body"><p>Yeah if we don't detect project changes I don't think we'll even attempt to update the lockfile, though maybe we should when the revision changes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @mattyoungberg on 2025-05-30 18:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:02 UTC
    </footer>
</body>
</html>
