```yaml
number: 10895
title: Detect if project directory was moved for venv reconstruction
type: issue
state: open
author: jonaslb
labels:
  - enhancement
  - help wanted
assignees: []
created_at: 2025-01-23T13:08:04Z
updated_at: 2025-02-26T10:02:49Z
url: https://github.com/astral-sh/uv/issues/10895
synced_at: 2026-01-10T01:57:25Z
```

# Detect if project directory was moved for venv reconstruction

---

_Issue opened by @jonaslb on 2025-01-23 13:08_

### Summary

I just had an issue with pytest รก la #7260. Turned out that because I had moved the project directory, the shebang in the "pytest" script in the venv was wrong, and apparently this meant that the command would fallthrough to the system-installed pytest which couldn't find my project or any of its dependencies, of course. `uv sync` would not detect this, but deleting `.venv` did the trick.

So I thought, since the location of the venv is hardcoded in the entrypoint scripts, it would be appropriate for uv to keep track of whether the venv location has changed. For example, it could go into the `pyvenv.cfg` file under a `uv-venv-path` variable or such. Then, if the actual path of the venv does not match this value, it would indicate to uv that the venv (or at least the entrypoints) should be reconstructed.

### Example

_No response_

---

_Label `enhancement` added by @jonaslb on 2025-01-23 13:08_

---

_Comment by @zanieb on 2025-01-23 14:05_

Yeah it makes sense to detect and invalidate the `.venv` in this case, if we can.

---

_Label `help wanted` added by @zanieb on 2025-01-23 14:06_

---

_Referenced in [astral-sh/uv#11168](../../astral-sh/uv/pulls/11168.md) on 2025-02-02 17:39_

---

_Comment by @eabase on 2025-02-25 07:53_

Please see my .venv management proposal in #11773 

---

_Comment by @jonaslb on 2025-02-25 13:01_

@eabase could you spell out how you think that is relevant?

---

_Comment by @zanieb on 2025-02-25 15:24_

We're also considering using `--relocatable` by default for project environments (which would make the entrypoints transportable)

---

_Comment by @eabase on 2025-02-26 10:02_

Hi Jonas, @jonaslb 

> could you spell out how you think that is relevant?

Maybe it's not, but it sounded highly relevant, unless I'm missing out on some other functionality of uv.

> So I thought, since the location of the venv is hardcoded in the entrypoint scripts, it would be appropriate for uv to keep track of whether the venv location has changed. For example, it could go into the pyvenv.cfg file under a uv-venv-path variable or such. 

This is really not wanted. There is absolutely no sane reason to hard-code the venv environment name into a project file. 

---

_Referenced in [astral-sh/uv#13989](../../astral-sh/uv/issues/13989.md) on 2025-06-12 13:30_

---

_Referenced in [astral-sh/uv#13994](../../astral-sh/uv/issues/13994.md) on 2025-06-12 13:38_

---
