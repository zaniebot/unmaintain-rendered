<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>cp27 wheels selected for psutil on windows - astral-sh/uv #7873</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>cp27 wheels selected for psutil on windows</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7873">#7873</a>
        opened by <a href="https://github.com/bluss">@bluss</a>
        on 2024-10-02 16:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bluss">@bluss</a> on 2024-10-02 16:33</div>
            <div class="timeline-body"><p>See wheel <code>psutil-6.0.0-cp27-none-win32.whl</code> in lockfile.</p>
<pre><code class="language-console">uv init -p 3.12 test-psutil
cd test-psutil/
uv add psutil
# Using CPython 3.12.5
# Creating virtual environment at: .venv
# Resolved 2 packages in 1ms
# Installed 1 package in 0.59ms
#  + psutil==6.0.0
rg -u cp27
</code></pre>
<pre><code>uv.lock
10:    { url = &quot;https://files.pythonhosted.org/packages/c5/66/78c9c3020f573c58101dc43a44f6855d01bbbd747e24da2f0c4491200ea3/psutil-6.0.0-cp27-none-win32.whl&quot;, hash = &quot;sha256:02b69001f44cc73c1c5279d02b30a817e339ceb258ad75997325e0e6169d8b35&quot;, size = 249766 },
11:    { url = &quot;https://files.pythonhosted.org/packages/e1/3f/2403aa9558bea4d3854b0e5e567bc3dd8e9fbc1fc4453c0aa9aafeb75467/psutil-6.0.0-cp27-none-win_amd64.whl&quot;, hash = &quot;sha256:21f1fb635deccd510f69f485b87433460a603919b45e2a324ad65b0cc74f8fb1&quot;, size = 253024 },
</code></pre>
<p>uv 0.4.18</p>
<p>For the record, the wheel is selected for install on gh actions platform Microsoft Windows Server 2022 (?)</p>
<p><code>2024-10-02T16:53:24.1443510Z DEBUG Selecting: psutil==6.0.0 [preference] (psutil-6.0.0-cp27-none-win32.whl)</code></p>
<p>And the functionality of psutil which my test required <a href="https://github.com/bluss/pyproject-local-kernel/actions/runs/11148088268/job/30983917110">worked</a> without problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2024-10-02 23:44</div>
            <div class="timeline-body"><p>Interesting, I would expect <code>psutil-6.0.0-cp37-abi3-win_amd64.whl</code> to be the one selected given this lock file</p>
<pre><code class="language-toml">version = 1
requires-python = &quot;&gt;=3.12&quot;

[[package]]
name = &quot;psutil&quot;
version = &quot;6.0.0&quot;
source = { registry = &quot;https://pypi.org/simple&quot; }
sdist = { url = &quot;https://files.pythonhosted.org/packages/18/c7/8c6872f7372eb6a6b2e4708b88419fb46b857f7a2e1892966b851cc79fc9/psutil-6.0.0.tar.gz&quot;, hash = &quot;sha256:8faae4f310b6d969fa26ca0545338b21f73c6b15db7c4a8d934a5482faa818f2&quot;, size = 508067 }
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/c5/66/78c9c3020f573c58101dc43a44f6855d01bbbd747e24da2f0c4491200ea3/psutil-6.0.0-cp27-none-win32.whl&quot;, hash = &quot;sha256:02b69001f44cc73c1c5279d02b30a817e339ceb258ad75997325e0e6169d8b35&quot;, size = 249766 },
    { url = &quot;https://files.pythonhosted.org/packages/e1/3f/2403aa9558bea4d3854b0e5e567bc3dd8e9fbc1fc4453c0aa9aafeb75467/psutil-6.0.0-cp27-none-win_amd64.whl&quot;, hash = &quot;sha256:21f1fb635deccd510f69f485b87433460a603919b45e2a324ad65b0cc74f8fb1&quot;, size = 253024 },
    { url = &quot;https://files.pythonhosted.org/packages/0b/37/f8da2fbd29690b3557cca414c1949f92162981920699cd62095a984983bf/psutil-6.0.0-cp36-abi3-macosx_10_9_x86_64.whl&quot;, hash = &quot;sha256:c588a7e9b1173b6e866756dde596fd4cad94f9399daf99ad8c3258b3cb2b47a0&quot;, size = 250961 },
    { url = &quot;https://files.pythonhosted.org/packages/35/56/72f86175e81c656a01c4401cd3b1c923f891b31fbcebe98985894176d7c9/psutil-6.0.0-cp36-abi3-manylinux_2_12_i686.manylinux2010_i686.manylinux_2_17_i686.manylinux2014_i686.whl&quot;, hash = &quot;sha256:6ed2440ada7ef7d0d608f20ad89a04ec47d2d3ab7190896cd62ca5fc4fe08bf0&quot;, size = 287478 },
    { url = &quot;https://files.pythonhosted.org/packages/19/74/f59e7e0d392bc1070e9a70e2f9190d652487ac115bb16e2eff6b22ad1d24/psutil-6.0.0-cp36-abi3-manylinux_2_12_x86_64.manylinux2010_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl&quot;, hash = &quot;sha256:5fd9a97c8e94059b0ef54a7d4baf13b405011176c3b6ff257c247cae0d560ecd&quot;, size = 290455 },
    { url = &quot;https://files.pythonhosted.org/packages/cd/5f/60038e277ff0a9cc8f0c9ea3d0c5eb6ee1d2470ea3f9389d776432888e47/psutil-6.0.0-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.whl&quot;, hash = &quot;sha256:e2e8d0054fc88153ca0544f5c4d554d42e33df2e009c4ff42284ac9ebdef4132&quot;, size = 292046 },
    { url = &quot;https://files.pythonhosted.org/packages/8b/20/2ff69ad9c35c3df1858ac4e094f20bd2374d33c8643cf41da8fd7cdcb78b/psutil-6.0.0-cp37-abi3-win32.whl&quot;, hash = &quot;sha256:a495580d6bae27291324fe60cea0b5a7c23fa36a7cd35035a16d93bdcf076b9d&quot;, size = 253560 },
    { url = &quot;https://files.pythonhosted.org/packages/73/44/561092313ae925f3acfaace6f9ddc4f6a9c748704317bad9c8c8f8a36a79/psutil-6.0.0-cp37-abi3-win_amd64.whl&quot;, hash = &quot;sha256:33ea5e1c975250a720b3a6609c490db40dae5d83a4eb315170c4fe0d8b1f34b3&quot;, size = 257399 },
    { url = &quot;https://files.pythonhosted.org/packages/7c/06/63872a64c312a24fb9b4af123ee7007a306617da63ff13bcc1432386ead7/psutil-6.0.0-cp38-abi3-macosx_11_0_arm64.whl&quot;, hash = &quot;sha256:ffe7fc9b6b36beadc8c322f84e1caff51e8703b88eee1da46d1e3a6ae11b4fd0&quot;, size = 251988 },
]

[[package]]
name = &quot;test-psutil&quot;
version = &quot;0.1.0&quot;
source = { virtual = &quot;.&quot; }
dependencies = [
    { name = &quot;psutil&quot; },
]

[package.metadata]
requires-dist = [{ name = &quot;psutil&quot;, specifier = &quot;&gt;=6.0.0&quot; }]
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-03 02:12</div>
            <div class="timeline-body"><p>I see logs for both the cp37 and cp27 wheels getting selected,  e.g.</p>
<pre><code>2024-10-02T16:53:42.6934365Z DEBUG Selecting: psutil==6.0.0 [compatible] (psutil-6.0.0-cp37-abi3-win_amd64.whl)
</code></pre>
<p>I'm confused about what's going on here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-10-03 02:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 10:58</div>
            <div class="timeline-body"><p>@zanieb - That message is just from the resolver. The choice of wheel there is arbitrary.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 13:09</div>
            <div class="timeline-body"><p>Are you sure that we're actually using that wheel @bluss? Those <code>Selecting:</code> logs are all from the resolver where we choose an arbitrary wheel to determine the version metadata.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2024-10-03 15:09</div>
            <div class="timeline-body"><p>Not sure, I was just misunderstanding the logs, then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2024-10-03 15:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-10-03 15:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 16:35</div>
            <div class="timeline-body"><p>How can we make this logging clearer? It's not the first time we've had this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">tracing</span> added by @zanieb on 2024-10-03 16:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-03 16:37</div>
            <div class="timeline-body"><p>Would it be a challenge to stop reading cp27 wheels entirely? I feel like their metadata shouldn't be relevant anymore.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 16:38</div>
            <div class="timeline-body"><p>Probably not but it admittedly doesn't solve the root problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 16:40</div>
            <div class="timeline-body"><p>I think we can omit them though, yes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 16:41</div>
            <div class="timeline-body"><p>#7381 also makes this way better, because we'll prefer compatible wheels here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-03 16:41</div>
            <div class="timeline-body"><p>I guess what's a little confusing to me is we use the &quot;for installation&quot; dist for display</p>
<p>https://github.com/astral-sh/uv/blob/14507a1793f12bf884786be49d716ca8f8322340/crates/uv-resolver/src/resolver/mod.rs#L1094-L1110</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-10-03 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 16:41</div>
            <div class="timeline-body"><p>Yeah I can explain why that's the case but I understand why it's confusing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-03 16:42</div>
            <div class="timeline-body"><p>It sort of looks like we should be using the sdist name there?</p>
<p>https://github.com/astral-sh/uv/blob/14507a1793f12bf884786be49d716ca8f8322340/crates/uv-distribution-types/src/prioritized_distribution.rs#L465-L467</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-03 16:44</div>
            <div class="timeline-body"><p>We would do that after https://github.com/astral-sh/uv/pull/7381. Right now we don't match on tags <em>at all</em> in the universal resolver. All wheels are considered compatible.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-10-03 17:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-10-03 17:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2024-10-03 17:45</div>
            <div class="timeline-body"><p>You could log explicitly when wheels are installed, that's one way to make it more clear?</p>
<blockquote>
<p>DEBUG: Installing <code>psutil</code> from <code>foo.whl</code></p>
</blockquote>
<p>I guess the strongest signal for bug here though was the presence of python 2.7 wheels in a python &gt;= 3.8 resolution?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:47:55 UTC
    </footer>
</body>
</html>
