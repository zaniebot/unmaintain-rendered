<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Issue with installing `fasttext` Using `uv` despite Fix #1446 - astral-sh/uv #12437</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Issue with installing <code>fasttext</code> Using <code>uv</code> despite Fix #1446</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12437">#12437</a>
        opened by <a href="https://github.com/ThomasFaria">@ThomasFaria</a>
        on 2025-03-24 16:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ThomasFaria">@ThomasFaria</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<h3>Issue with Installing <code>fasttext</code> Using <code>uv</code> Despite Fix #1446</h3>
<p>I encountered an issue when attempting to install <code>fasttext</code> using <code>uv</code>, which appears identical to the previously reported (and closed) issue #1469. Although it was indicated in #1469 that this was resolved by the fix described in issue #1446, the problem persists in my case.</p>
<p>Thanks a lot for your support and your work on this excellent tool!</p>
<p><strong>Environment:</strong></p>
<ul>
<li>OS: Ubuntu 22.04</li>
<li>Python Version: 3.12.6</li>
<li><code>uv</code> Version: 0.6.9</li>
</ul>
<h3>Platform</h3>
<p>Ubuntu 22.04 amd64</p>
<h3>Version</h3>
<p>0.6.9</p>
<h3>Python version</h3>
<p>3.12.6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ThomasFaria on 2025-03-24 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-24 16:25</div>
            <div class="timeline-body"><p>Are you installing from the GitHub directly? I don't think they released to PyPI since fixing this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-03-24 16:42</div>
            <div class="timeline-body"><p>Actually the error is quite different:</p>
<pre><code>Resolved 4 packages in 5ms
  × Failed to build `fasttext==0.9.3`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_wheel` failed (exit status: 1)

      [stderr]
      Traceback (most recent call last):
        File &quot;&lt;string&gt;&quot;, line 14, in &lt;module&gt;
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/build_meta.py&quot;, line 334, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/build_meta.py&quot;, line 304, in _get_build_requires
          self.run_setup()
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/build_meta.py&quot;, line 522, in run_setup
          super().run_setup(setup_script=setup_script)
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/build_meta.py&quot;, line 320, in run_setup
          exec(code, locals())
        File &quot;&lt;string&gt;&quot;, line 171, in &lt;module&gt;
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/__init__.py&quot;, line 116, in setup
          _install_setup_requires(attrs)
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/__init__.py&quot;, line 87, in _install_setup_requires
          dist.parse_config_files(ignore_option_errors=True)
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/_virtualenv.py&quot;, line 20, in parse_config_files
          result = old_parse_config_files(self, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/dist.py&quot;, line 730, in parse_config_files
          self._parse_config_files(filenames=inifiles)
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/dist.py&quot;, line 599, in _parse_config_files
          opt = self._enforce_underscore(opt, section)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File &quot;/home/dshaw/.cache/uv/builds-v0/.tmp3zLwhL/lib/python3.12/site-packages/setuptools/dist.py&quot;, line 629, in _enforce_underscore
          raise InvalidConfigError(
      setuptools.errors.InvalidConfigError: Invalid dash-separated key 'description-file' in 'metadata' (setup.cfg), please use the underscore name 'description_file' instead.

      hint: This usually indicates a problem with the package or the build environment.
</code></pre>
<p>The error is coming from setuptools, it is complaining that <a href="https://github.com/facebookresearch/fastText/blob/main/setup.cfg#L2">setup.cfg</a> is using an invalid key format.</p>
<p>This is a new requirement by setuptools, you need to report this to fasttext and check the release notes / issues page of setuptools if you think this requirement is wrong (although it's their config file format so it's up to them how they define it).</p>
<p>To use an old version of setuptools to install the package do the following:</p>
<ol>
<li>Create a <code>build-constraints.txt</code> with the following contents:</li>
</ol>
<pre><code>setuptools&lt;78
</code></pre>
<ol start="2">
<li>Install with the build-constraints defined <code>uv pip  install fasttext --build-constraints build-constraints.txt</code>:</li>
</ol>
<pre><code>Resolved 4 packages in 285ms
      Built fasttext==0.9.3
Prepared 4 packages in 30.88s
Installed 4 packages in 493ms
 + fasttext==0.9.3
 + numpy==2.2.4
 + pybind11==2.13.6
 + setuptools==78.0.1
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-24 16:43</div>
            <div class="timeline-body"><p>See https://github.com/astral-sh/uv/issues/12434</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThomasFaria">@ThomasFaria</a> on 2025-03-24 17:42</div>
            <div class="timeline-body"><p>Thank you for the quick fix. 2 comments :</p>
<ul>
<li>Actually, I would prefer use the 0.9.2 version if possible and it that case I get the error described in #1469.</li>
<li>I managed to install fasttext 0.9.3 with your command <code>uv pip  install fasttext --build-constraints build-constraints.txt</code>, however, when I try to re-sync with <code>uv sync</code> I still get the same error.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-03-24 17:53</div>
            <div class="timeline-body"><blockquote>
<p>Actually, I would prefer use the 0.9.2 version if possible and it that case I get the error described in https://github.com/astral-sh/uv/issues/1469.</p>
</blockquote>
<p>Then you will have to install the build dependencies yourself and use no-build-isolation: https://docs.astral.sh/uv/reference/settings/#no-build-isolation</p>
<blockquote>
<p>I managed to install fasttext 0.9.3 with your command <code>uv pip install fasttext --build-constraints build-constraints.txt</code>, however, when I try to re-sync with <code>uv sync</code> I still get the same error.</p>
</blockquote>
<p>See https://github.com/astral-sh/uv/issues/12441</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-03-25 01:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:30:36 UTC
    </footer>
</body>
</html>
