```yaml
number: 5045
title: Non-universal resolver should ignore requires-python upper bound
type: issue
state: closed
author: konstin
labels:
  - bug
assignees: []
created_at: 2024-07-14T14:23:35Z
updated_at: 2024-09-02T18:23:44Z
url: https://github.com/astral-sh/uv/issues/5045
synced_at: 2026-01-10T01:57:10Z
```

# Non-universal resolver should ignore requires-python upper bound

---

_Issue opened by @konstin on 2024-07-14 14:23_

Without universal resolution, we fail to resolve colabfold 1.5.5 on python 3.12, since it [only supports python 3.9 to 3.11](https://inspector.pypi.io/project/colabfold/1.5.5/packages/8e/74/52a6580a05c4f85980d449fbf71ead514bef0d0548c218abb808106f1a41/colabfold-1.5.5-py3-none-any.whl/colabfold-1.5.5.dist-info/METADATA#line.9):

```
$ echo "colabfold==1.5.5" | uv pip compile -p 3.12 -
    × No solution found when resolving dependencies:
    ╰─▶ Because the requested Python version (3.12.0) does not satisfy Python>=3.9,<3.12 and colabfold==1.5.5 depends on
        Python>=3.9,<3.12, we can conclude that colabfold==1.5.5 cannot be used.
        And because you require colabfold==1.5.5, we can conclude that the requirements are unsatisfiable.
```

We generally ignore upper version bounds (#4022), the universal resolver also resolves succesfully:

```
$ echo "colabfold==1.5.5" | uv pip compile -p 3.12 --universal -
Resolved 62 packages in 23ms
[...]
colabfold==1.5.5
[...]
```

We should change the regular resolver to ignore this requires-python upper bound, too, and make it clear in the docs that we ignore all requires-python upper bounds.


---

_Label `bug` added by @konstin on 2024-07-14 14:23_

---

_Label `preview` added by @konstin on 2024-07-14 14:23_

---

_Referenced in [astral-sh/uv#5046](../../astral-sh/uv/issues/5046.md) on 2024-07-14 14:42_

---

_Comment by @charliermarsh on 2024-07-14 14:47_

Why is the extra relevant?

---

_Comment by @konstin on 2024-07-14 14:52_

We should error both with and without extra due to the mismatch in the python requirement, after finding uv behaves different depending on whether an extra is present (#5043), i'm just testing both cases. Fwiw without the extra the resolution is simple (it's a stub, functionality-wise), with the extra it's a complex machine learning tree.

---

_Comment by @charliermarsh on 2024-07-14 14:53_

This is correct though. We do _not_ respect upper-bounds on `requires-python`.

---

_Comment by @charliermarsh on 2024-07-14 14:54_

`uv pip compile -p 3.12 -` is resolving for Python 3.12, while `uv pip compile -p 3.12 --universal -` is treated as `requires-python: ">=3.12"`. This is mentioned in the documentation.

---

_Renamed from "Universal resolver ignore require-python and writes invalid resolution" to "Inconsistent requires-python handling between regular and universal resolver  " by @konstin on 2024-07-14 15:16_

---

_Renamed from "Inconsistent requires-python handling between regular and universal resolver  " to "Non-universal resolver should ignore requires-python upper bound" by @konstin on 2024-07-14 15:53_

---

_Label `preview` removed by @konstin on 2024-07-14 15:54_

---

_Comment by @konstin on 2024-07-14 15:56_

I've changed the issue to changing the regular resolver instead of the universal resolver. We should also make it clearer in the docs that we ignore all upper bounds on requires-python, at least i couldn't find that information when looking for it.

---

_Referenced in [astral-sh/uv#6859](../../astral-sh/uv/issues/6859.md) on 2024-08-30 13:23_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-08-30 17:48_

---

_Referenced in [astral-sh/uv#6882](../../astral-sh/uv/pulls/6882.md) on 2024-08-30 18:27_

---

_Closed by @charliermarsh on 2024-09-02 18:23_

---

_Closed by @charliermarsh on 2024-09-02 18:23_

---
