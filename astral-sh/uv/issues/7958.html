<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Incorrect documentation for aws code-artifact publication - astral-sh/uv #7958</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Incorrect documentation for aws code-artifact publication</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7958">#7958</a>
        opened by <a href="https://github.com/david-waterworth">@david-waterworth</a>
        on 2024-10-07 04:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/david-waterworth">@david-waterworth</a></div>
            <div class="timeline-body"><p>Following the documentation (https://docs.astral.sh/uv/guides/integration/alternative-indexes/#aws-codeartifact) for <code>uv publish</code> to aws code-artifact fails with</p>
<pre><code>error: Failed to publish
Caused by: The request was redirected, but redirects are not allowed when publishing, please use the canonical URL: `https://${AWS_DOMAIN}-${AWS_ACCOUNT_ID}.d.codeartifact.${AWS_REGION}.amazonaws.com/pypi/${AWS_CODEARTIFACT_REPOSITORY}/`
</code></pre>
<p>What works is:</p>
<pre><code># Configure uv to use AWS CodeArtifact
export UV_PUBLISH_URL=&quot;https://${AWS_DOMAIN}-${AWS_ACCOUNT_ID}.d.codeartifact.${AWS_REGION}.amazonaws.com/pypi/${AWS_CODEARTIFACT_REPOSITORY}/&quot;
export UV_PUBLISH_USERNAME=aws
export UV_PUBLISH_PASSWORD=&quot;$AWS_CODEARTIFACT_TOKEN&quot;

# Publish the package
uv publish
</code></pre>
<p>i.e. <code>UV_PUBLISH_URL</code> should NOT include the AWS_CODEARTIFACT_TOKEN</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-08 22:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-08 22:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/konstin">@konstin</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-08 22:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2024-10-15 16:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:34:31 UTC
    </footer>
</body>
</html>
