<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installing multiple projects in a single command issue - astral-sh/uv #9519</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Installing multiple projects in a single command issue</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9519">#9519</a>
        opened by <a href="https://github.com/wkarwacki">@wkarwacki</a>
        on 2024-11-29 10:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/wkarwacki">@wkarwacki</a></div>
            <div class="timeline-body"><pre><code>$ uv --version
uv 0.5.4
</code></pre>
<p>Hey uv team! It&#x27;s my first issue here, so firstly I would like to say that I love the work you&#x27;re doing.</p>
<p>In my current project we start migrating our build system to <code>uv</code>. We&#x27;ve encountered rather unexpected issue related to installing multiple projects dependencies at once like so:</p>
<pre><code>uv pip install project_a project_b
</code></pre>
<p>or</p>
<pre><code>uv pip install -r project_a/pyproject.toml -r project_b/pyproject.toml
</code></pre>
<p>Apparently, when doing so, <code>uv</code> picks up project&#x27;s configuration from cwd. It may be the case however, that in order to install one of the projects&#x27; (<code>project_a</code> or <code>project_b</code>) dependencies, it has to refer to some specific <code>[uv.tool]</code> configurations, like defined source or index, lack of which (when installing like above) would lead to an error during installation.</p>
<p>Currently we work around this issue by installing the dependencies twice, but I would imagine, that by default all configuration options should be picked up from relevant projects without need to provide any of:</p>
<pre><code>--directory &lt;DIRECTORY&gt;                      Change to the given directory prior to running the command
--project &lt;PROJECT&gt;                          Run the command within the given project directory
--config-file &lt;CONFIG_FILE&gt;                  The path to a `uv.toml` file to use for configuration [env: UV_CONFIG_FILE=]
</code></pre>
<p>on the command-line explicitly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-29 16:58</div>
            <div class="timeline-body"><p>In the <code>uv pip</code> CLI, we don&#x27;t read configuration from the target &quot;projects&quot; -- it&#x27;s as if you passed <code>-r project_a/requirements.txt -r project_b/requirements.txt</code>. The configuration is instead from the current working directory. Have you tried using <code>--no-config</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-29 16:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wkarwacki">@wkarwacki</a> on 2024-11-29 17:29</div>
            <div class="timeline-body"><p>@charliermarsh Thank you for quick answer.</p>
<blockquote>
<p>The configuration is instead from the current working directory.</p>
</blockquote>
<p>Could you explain the reason it&#x27;s done this way? I find it inconvenient, as for instance, when installing dependencies in Dockerfile I need to set WORKDIR to project&#x27;s dir, or <code>cd</code> to the python project in order to <code>uv pip install</code>. Also, there is a problem of installing multiple projects at once, as I&#x27;ve described above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-29 17:30</div>
            <div class="timeline-body"><p>What would be the alternative?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wkarwacki">@wkarwacki</a> on 2024-11-29 17:34</div>
            <div class="timeline-body"><blockquote>
<p>What would be the alternative?</p>
</blockquote>
<p>I would imagine that <code>uv</code> could just use configuration from the respective <code>pyproject.toml</code>, for instance:</p>
<pre><code>uv pip install -r project_a/pyproject.toml -r project_b/pyproject.toml
</code></pre>
<p>would be equivalent to</p>
<pre><code>uv pip install --project project_a -r project_a/pyproject.toml
uv pip install --project project_b -r project_b/pyproject.toml
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-29 17:39</div>
            <div class="timeline-body"><p>Those commands aren&#x27;t actually &quot;the same&quot;, though. The former will resolve all the dependencies together; the latter will resolve and install the dependencies for <code>project_a</code>, then separately resolve and install all the dependencies for <code>project_b</code>. If we discover the configuration from both projects, we need some semantics for merging them. For example, what if they specify conflicting values for certain fields?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wkarwacki">@wkarwacki</a> on 2024-11-29 20:32</div>
            <div class="timeline-body"><blockquote>
<p>Those commands aren&#x27;t actually &quot;the same&quot;, though. The former will resolve all the dependencies together; the latter will resolve and install the dependencies for project_a, then separately resolve and install all the dependencies for project_b.</p>
</blockquote>
<p>I understand, thank you. I guess it&#x27;s a different semantics and as you pointed out I was actually thinking about slightly different use-case.</p>
<blockquote>
<p>If we discover the configuration from both projects, we need some semantics for merging them. For example, what if they specify conflicting values for certain fields?</p>
</blockquote>
<p>I understand it&#x27;s not a straight forward task and perhaps there needs to be some trade-off to be done to satisfy this.</p>
<p>I would like to close this question with a suggestion to perhaps consider our use-case in a future, by providing separate interface or some flag perhaps.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-03 15:40</div>
            <div class="timeline-body"><p>We&#x27;re unlikely to introduce <code>pyproject.toml</code> configuration awareness into the <code>uv pip</code> interface as the upstream (pip itself) is very opposed to doing so. It&#x27;s possible we&#x27;ll break from that in the future, but it would require a strong motivation.</p>
<p>Thanks for sharing your use-case &lt;3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-03 15:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:35:51 UTC
    </footer>
</body>
</html>
