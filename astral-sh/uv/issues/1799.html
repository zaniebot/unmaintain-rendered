<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warn when registry doesn't support range requests for wheels - astral-sh/uv #1799</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Warn when registry doesn't support range requests for wheels</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1799">#1799</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-02-21 09:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/konstin">@konstin</a> on 2024-02-21 09:29</div>
            <div class="timeline-body"><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests">Range requests</a> are very important for uv's performance, especially with large wheels. They are the difference between downloading entire wheels and just some slices in the bytes to KB range. They have been part of the HTTP/1.1 and are supported by all major webserver and blob storages. We should warn users if their registry is misconfigured and doesn't support range requests. Without a warning, it is otherwise inexplicable to users why uv is slower than advertised.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @konstin on 2024-02-21 09:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @konstin on 2024-02-21 09:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-21 12:41</div>
            <div class="timeline-body"><p>I don’t think these should be user-facing, since users typically have no control over this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-21 12:44</div>
            <div class="timeline-body"><p>I expect they'll need to forward this to whoever is managing their server, but i tend towards making it user visible as otherwise nobody will see this is missing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-21 12:45</div>
            <div class="timeline-body"><p>But like, Artifactory doesn’t support this at all. Making these user-visible means Artifactory users will see these on every invocation with no recourse.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MichaReiser">@MichaReiser</a> on 2024-02-21 12:47</div>
            <div class="timeline-body"><p>It's a difficult one. Making it visible to users could motivate artifactory to add support for it but showing it on every invocation sounds annoying. I wonder if there are other ways we could achieve the same. Maybe with a --profile flag that tells you where uv spends time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Eh2406">@Eh2406</a> on 2024-04-10 22:21</div>
            <div class="timeline-body"><p>Perhaps only display the message if the just run command spent more than 1 second downloading wheels from a registry that does not support range queries. Something like:</p>
<pre><code>This took longer than expected because registry (url) does not support Http 1.1 range queries.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hmc-cs-mdrissi">@hmc-cs-mdrissi</a> on 2024-04-11 01:24</div>
            <div class="timeline-body"><p><code>more than 1 second downloading wheels </code></p>
<p>So every time for large pytorch (or other ml/data ecosystem libraries) wheels on registries that don't support range requests? I'd still lean to call it noise that's not usually not actionable for most users.</p>
<p>edit: If verbose mode shows this that's fine. If some flag related to performance shows this that's also reasonable. On every request sounds like a lot of corporate indices are likely to be noisy and fun time trying to find registry owner/asking them to work on it.</p>
<p>edit 2: Aggressive/smart caching uv has is very nice on a non-first run regardless of index having range requests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-23 03:32</div>
            <div class="timeline-body"><p>I think I'm gonna close this. We do show this in verbose logging, but I just don't love showing non-actionable user-facing warnings like this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-23 03:32</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:23 UTC
    </footer>
</body>
</html>
