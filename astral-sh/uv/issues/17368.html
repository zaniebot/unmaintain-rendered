<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv venv --relocatable contains absolute paths in csh activate script - astral-sh/uv #17368</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv venv --relocatable contains absolute paths in csh activate script</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/17368">#17368</a>
        opened by <a href="https://github.com/alastair">@alastair</a>
        on 2026-01-08 21:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/alastair">@alastair</a> on 2026-01-08 21:58</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>when running <code>uv venv --relocatable</code> I expect to see no absolute paths to the location of the venv inside itself, however I see that the csh script still contains <code>VIRTUAL_ENV</code> pointing to the path.</p>
<p>I don't use csh, just thought it was curious and that maybe it was a bug.</p>
<pre><code>alastair@apmini:~/venv-test$ uv venv
Using CPython 3.12.0
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
alastair@apmini:~/venv-test$ ack alastair .venv/bin
.venv/bin/activate.bat
29:@for %%i in (&quot;/Users/alastair/venv-test/.venv&quot;) do @set &quot;VIRTUAL_ENV=%%~fi&quot;

.venv/bin/activate.fish
82:set -gx VIRTUAL_ENV '/Users/alastair/venv-test/.venv'

.venv/bin/activate
81:VIRTUAL_ENV='/Users/alastair/venv-test/.venv'

.venv/bin/activate.nu
71:    let virtual_env = '/Users/alastair/venv-test/.venv'

.venv/bin/activate.csh
34:setenv VIRTUAL_ENV '/Users/alastair/venv-test/.venv'
alastair@apmini:~/venv-test$ rm -rf .venv/
alastair@apmini:~/venv-test$ uv venv --relocatable
Using CPython 3.12.0
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
alastair@apmini:~/venv-test$ ack alastair .venv/bin
.venv/bin/activate.csh
34:setenv VIRTUAL_ENV '/Users/alastair/venv-test/.venv'
</code></pre>
<h3>Platform</h3>
<p>Darwin 24.6.0 arm64</p>
<h3>Version</h3>
<p>uv 0.9.21 (Homebrew 2025-12-30)</p>
<h3>Python version</h3>
<p>Python 3.12.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @alastair on 2026-01-08 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2026-01-08 22:06</div>
            <div class="timeline-body"><p>Related https://github.com/astral-sh/uv/issues/16973</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2026-01-08 22:06</div>
            <div class="timeline-body"><p>(I'm not sure it's possible to fix this in csh?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EliteTK">@EliteTK</a> on 2026-01-09 17:57</div>
            <div class="timeline-body"><p>I had a look at this yesterday on tcsh (has more features than plain csh, but do we actually support real csh?) and I genuinely couldn't find any way to do this.</p>
<p>We could &quot;support&quot; relocatable csh by checking if the user passed an argument when sourcing which itself would be the path to the script. And if not, we could tell them to do so.</p>
<p>So to activate a relocatable venv from csh you would do <code>source path/to/venv/activate.csh path/to/venv</code>...</p>
<p>Probably easier to just not create the script in that circumstance instead though...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2026-01-09 18:14</div>
            <div class="timeline-body"><p>Can we detect if we have tcsh instead of csh and just hard-fail when we don't have tcsh under relocatable mode?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/EliteTK">@EliteTK</a> on 2026-01-09 18:19</div>
            <div class="timeline-body"><p>We can detect tcsh[^1]. But I meant that there is no automated way to do this on tcsh and also probably csh. I didn't bother trying to find a copy of the original csh, but since tcsh is more or less just an extended version of csh, it seems unlikely that it has some way to do this anyway.</p>
<p>[^1]: It sets a <code>tcsh</code> variable with its version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2026-01-09 18:20</div>
            <div class="timeline-body"><p>Oh I thought you were saying it <em>was</em> possible in tcsh.</p>
<p>I guess we can just omit this file when <code>--relocatable</code> is used as a breaking change in 0.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @zanieb on 2026-01-09 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.10.0" by @zanieb on 2026-01-09 18:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:18:13 UTC
    </footer>
</body>
</html>
