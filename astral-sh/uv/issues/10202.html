<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client did not publish a checksum value when using uv publish - astral-sh/uv #10202</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Client did not publish a checksum value when using uv publish</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10202">#10202</a>
        opened by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a>
        on 2024-12-27 17:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2024-12-27 17:17</div>
            <div class="timeline-body"><p>When using uv publish to publish a python package to pypi on artifactory, I get a warning that the client did not publish a checksum value.</p>
<p>uv version: 0.5.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @charliermarsh on 2024-12-27 17:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @konstin by @charliermarsh on 2024-12-27 17:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-27 17:47</div>
            <div class="timeline-body"><p>\cc @konstin when you're back</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-07 11:10</div>
            <div class="timeline-body"><p>Can you share the command that you ran (with urls redacted) and the error you got?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @konstin by @konstin on 2025-01-07 11:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2025-01-07 11:54</div>
            <div class="timeline-body"><p>I was going to replace</p>
<pre><code>TWINE_REPOSITORY_URL: https://artifactory.xyz.com/artifactory/api/pypi/xyz-pypi-local
twine upload dist/* --username ${{ secrets.JFROG_USER }} --password ${{ secrets.JFROG_TOKEN }}
</code></pre>
<p>with
<code>uv publish --publish-url $TWINE_REPOSITORY_URL --username ${{ secrets.JFROG_USER }} --password ${{ secrets.JFROG_TOKEN }} </code></p>
<p>which publishes the package onto private PyPI on artifactory.
Both commands work fine with respect to that the packages arrive.</p>
<p>However, when I go to the UI of artifactory where my package is located, I see in the package metadata the md5 and some SHA of the package, and artifactory tells me for the packages I published with uv that &quot;client did not publish a checksum value&quot; and I manually need to checkmark the package to make it trusted whereas this is not the case for twine.</p>
<p>see also <a href="https://jfrog.com/help/r/what-are-client-checksum-server-checksum-and-checksum-policy-in-local-repositories/what-are-client-checksum-server-checksum-and-checksum-policy-in-local-repositories">https://jfrog.com/help/r/what-are-client-checksum-server-checksum-and-checksum-policy-in-local-repositories/what-are-client-checksum-server-checksum-and-checksum-policy-in-local-repositories</a> and <a href="https://jfrog.com/help/r/why-am-i-getting-client-did-not-publish-a-checksum-value-for-npm-packages/why-am-i-getting-client-did-not-publish-a-checksum-value...-for-npm-packages">https://jfrog.com/help/r/why-am-i-getting-client-did-not-publish-a-checksum-value-for-npm-packages/why-am-i-getting-client-did-not-publish-a-checksum-value...-for-npm-packages</a></p>
<p>The same problem I had some time back when I was using REST API, which I found could be solved by:
<a href="https://stackoverflow.com/questions/46703183/fix-checksum-in-artifactory-when-uploading-file-through-rest-api">https://stackoverflow.com/questions/46703183/fix-checksum-in-artifactory-when-uploading-file-through-rest-api</a></p>
<p>Twine may solve the problem with that HashManager code:
<a href="https://github.com/pypa/twine/blob/2386ca5300cd7bde59432834d362c07de61e9a53/twine/package.py#L377">https://github.com/pypa/twine/blob/2386ca5300cd7bde59432834d362c07de61e9a53/twine/package.py#L377</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @konstin by @konstin on 2025-01-07 11:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-08 12:25</div>
            <div class="timeline-body"><p>Do you know which header and which hash algorithm artifactory reads? We are sending <code>sha256_digest</code> as part of the form-data as twine does. The help article mentions <code>X-Checksum</code>, though I don't see twine setting that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2025-01-08 12:33</div>
            <div class="timeline-body"><p>I just checked - this is what it says, and indeed the 256 one is in but it seems to expect all checksums not only one:</p>
<p><strong>Checksums</strong></p>
<pre><code>SHA-256:	b5d69b2543ecf56d4d74e236fa9482eb43aa174f9b176d12a0d6cbfe9abdd211 (Uploaded: Identical)
SHA-1: abede45dd45673b9523b58bb1e7b20b5a8c3390c (Uploaded: None)
MD5: 3ec27736db428b55897f8344ca7ce718 (Uploaded: None)

Client did not publish a checksum value. If you trust the uploaded artifact you can accept the actual checksum by clicking the 'Fix Checksum' button.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-08 12:36</div>
            <div class="timeline-body"><p>I'm hesitant to add MD5 and SHA-1 hashes, both have been broken (https://en.wikipedia.org/wiki/MD5#Security, https://shattered.io/) and cannot be relied on for security. Is there a reason artifactory doesn't use the SHA-256 alone?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @konstin on 2025-01-08 12:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2025-01-08 12:56</div>
            <div class="timeline-body"><blockquote>
<p>I'm hesitant to add MD5 and SHA-1 hashes, both have been broken (https://en.wikipedia.org/wiki/MD5#Security, https://shattered.io/) and cannot be relied on for security. Is there a reason artifactory doesn't use the SHA-256 alone?</p>
</blockquote>
<p>Good question, I found some FAQ in this case for npm but same problem
https://jfrog.com/help/r/why-am-i-getting-client-did-not-publish-a-checksum-value-for-npm-packages/why-am-i-getting-client-did-not-publish-a-checksum-value...-for-npm-packages</p>
<p>which says</p>
<pre><code>If binaries are being deployed using a CI server, the CI server needs to be configured to pass the checksums using the following headers in PUT request:

X-Checksum-Sha1: sha1Value, X-Checksum-Sha256: sha256Value, X-Checksum: checksum value
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @konstin by @konstin on 2025-01-08 13:32</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geoffrey-g-delhomme">@geoffrey-g-delhomme</a> on 2025-02-25 12:30</div>
            <div class="timeline-body"><p>Any update on this issue? Indeed, using Artifactory it raises a warning: Client did not publish a checksum value. If you trust the uploaded artifact you can accept the actual checksum by clicking the 'Fix Checksum' button.
Thank you</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-02-25 12:58</div>
            <div class="timeline-body"><p>@geoffrey-g-delhomme As far as I can tell this needs to be fixed on the artifactory side, uv is sending <code>sha256_digest</code> as part of the form_data.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2025-02-25 13:22</div>
            <div class="timeline-body"><p>I would kind of agree that in the end it is some kind of issue on artifactory side - which is known there since ages.
I don't expect this to be solved anytime soon if ever in artifactory, while other publish tools like twine seem to send all 3 hashes.</p>
<p>Hence, even though maybe redundant, it would be great if uv offers that functionality, maybe optional, as otherwise it blocks our enterprise from adopting uv publlish.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-25 15:13</div>
            <div class="timeline-body"><p>I'm vaguely okay with the idea of opt-in to insecure hashes? Like <code>--insecure-checksums</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geoffrey-g-delhomme">@geoffrey-g-delhomme</a> on 2025-02-26 12:58</div>
            <div class="timeline-body"><p>Thank you @konstin for reminding the root cause. However, I am in the exact situation depicted by @OliverKleinBST. @zanieb 's suggestion would be enough waiting for a fix on Artifactory side (if ever). Moreover, adding a specifc paragraph in the documentation in order to publish on Artifactory (highlighting the issue on artifactory's side) would also help to ground <code>uv</code> in already set up development environments, as Artifactory is a widely used solution in the industry (at least mine).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/janaroj">@janaroj</a> on 2025-04-04 17:21</div>
            <div class="timeline-body"><p>having the same issue</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2025-07-24 09:07</div>
            <div class="timeline-body"><p>Will there be any progress on that topic, like with the idea of optional parameter?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kohlrabi">@kohlrabi</a> on 2025-07-25 07:21</div>
            <div class="timeline-body"><p>@OliverKleinBST I just noticed this as well, does it prohibit you from using the published package or is it just an annoyance in the artifactory browser?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pypa/twine/issues/1258.html">pypa/twine#1258</a> on 2025-08-08 19:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woodruffw">@woodruffw</a> on 2025-08-11 14:52</div>
            <div class="timeline-body"><p>I'm looking into this now, and I'm pretty convinced that Artifactory's behavior here is bugged:</p>
<ul>
<li><code>uv publish</code> provides a SHA-256 digest, which is sufficient for a cryptographic integrity check on the index side against the uploaded data.</li>
<li>There's no intelligible security benefit to requiring both a SHA-256 <em>and</em> a MD5 digest.</li>
<li>The <code>md5_digest</code> form field is considered optional by PyPI itself, and has been for a long time. Uploadable indices should <em>not</em> reject uploads just because it isn't present.</li>
</ul>
<p>Given all of these, I think the right course of action here is actually to have <code>twine</code> stop sending an <code>md5_digest</code>, at which point <code>twine</code> and <code>uv publish</code> would be more consistent about what they send to uploadable indices. I think that's preferable over having uv add MD5 hashing here, since doing so papers over a real bug on JFrog's side that is (IMO) worth fixing on their end.</p>
<p>As part of the above, I think it'd be great if users who have support contracts with JFrog would ping them on this -- I think they'd benefit from hearing from their users on poor UX/DX here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woodruffw">@woodruffw</a> on 2025-08-12 16:32</div>
            <div class="timeline-body"><p>The next release of <code>twine</code> will also stop sending <code>md5_digest</code> to indices, meaning that uv and twine will behave consistently (and compatibly) in this regard.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> removed by @konstin on 2025-08-18 09:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/OliverKleinBST">@OliverKleinBST</a> on 2025-08-21 11:43</div>
            <div class="timeline-body"><p>I did some checks of downloading / installing packages with pip and uv pip, with and without --require-hashes and on CLI I cannot see any problems or (verbose level) warnings when I point to a package that only has the SHA256 but no SHA1 and MD5. So, eventually this is only a GUI issue in JFROG as otherwise they should send a 404:
<em>If a checksum is not provided, and you do not address the problem by using &quot;Fix Checksum,&quot; then when a client attempts to send a get request to access that checksum file, Artifactory will return a 404 (not found) error</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/woodruffw">@woodruffw</a> on 2025-09-04 15:47</div>
            <div class="timeline-body"><p>Updating: the latest release of twine (6.2.0) has also dropped <code>md5_digest</code> support, so I believe there's no longer a useful feature parity target for <code>uv publish</code> to match here.</p>
<p>Given that, I think this is safe to close.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @woodruffw on 2025-09-04 15:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:57 UTC
    </footer>
</body>
</html>
