<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uv Python install breaks plt.show() when used in wsl - astral-sh/uv #10342</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Uv Python install breaks plt.show() when used in wsl</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10342">#10342</a>
        opened by <a href="https://github.com/Matt-Ord">@Matt-Ord</a>
        on 2025-01-07 09:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Matt-Ord">@Matt-Ord</a> on 2025-01-07 09:14</div>
            <div class="timeline-body"><p>Working in a dev container, I had previously relied on the python feature to install python</p>
<pre><code>{
	&quot;name&quot;: &quot;Debian&quot;,
	&quot;image&quot;: &quot;mcr.microsoft.com/devcontainers/base:bullseye&quot;,
	&quot;features&quot;: {
                &quot;ghcr.io/devcontainers/features/python:1&quot;: {
			&quot;version&quot;: &quot;3.13&quot;
		},
		&quot;ghcr.io/va-h/devcontainers-features/uv:1&quot;: {
			&quot;shellautocompletion&quot;: true,
			&quot;version&quot;: &quot;latest&quot;
		},
		&quot;ghcr.io/devcontainers/features/rust:1&quot;: {
			&quot;version&quot;: &quot;latest&quot;,
			&quot;profile&quot;: &quot;minimal&quot;
		}
	},
	&quot;onCreateCommand&quot;: &quot;uv sync --all-extras&quot;
}
</code></pre>
<p>however I swapped to using uv pyhton install</p>
<pre><code>{
	&quot;name&quot;: &quot;Debian&quot;,
	&quot;image&quot;: &quot;mcr.microsoft.com/devcontainers/base:bullseye&quot;,
	&quot;features&quot;: {
		&quot;ghcr.io/va-h/devcontainers-features/uv:1&quot;: {
			&quot;shellautocompletion&quot;: true,
			&quot;version&quot;: &quot;latest&quot;
		},
		&quot;ghcr.io/devcontainers/features/rust:1&quot;: {
			&quot;version&quot;: &quot;latest&quot;,
			&quot;profile&quot;: &quot;minimal&quot;
		}
	},
	&quot;onCreateCommand&quot;: &quot;uv python install &amp;&amp; uv sync --all-extras&quot;
}
</code></pre>
<p>with this configuration I get this error when attempting fig.show() on a matplotlib figure</p>
<pre><code>from __future__ import annotations

from matplotlib import pyplot as plt

plt.plot([1, 2, 3, 4])
plt.show()
input()
</code></pre>
<pre><code>UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
</code></pre>
<p>How do I get uv to install a compatible python environment in this case?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-07 10:12</div>
            <div class="timeline-body"><p>I think this is another case of #6893</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2025-01-07 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tacaswell">@tacaswell</a> on 2025-01-10 17:18</div>
            <div class="timeline-body"><p>I agree this is a duplicate.  To be sure add <code>plt.switch_backend('tkagg')</code> before calling <code>plt.plot()</code> and if it is a duplicate you will get an exception raised.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ncoghlan">@ncoghlan</a> on 2025-06-09 02:20</div>
            <div class="timeline-body"><p>I ran into this while trying to use a couple of the <code>sklearn</code> demos as a demo for <code>venvstacks</code> based deployment. Initial symptom was the warning reported here, while adding <code>plt.switch_backend('tkagg')</code> changed the outcome to (confirming the &quot;duplicate of #6893&quot; assessment):</p>
<pre><code>AttributeError: module '_tkinter' has no attribute '__file__'. Did you mean: '__name__'?

The above exception was the direct cause of the following exception:

ImportError: failed to load tkinter functions

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;&lt;frozen runpy&gt;&quot;, line 198, in _run_module_as_main
  File &quot;&lt;frozen runpy&gt;&quot;, line 88, in _run_code
  File &quot;/home/acoghlan/devel/venvstacks/examples/sklearn/_build/app-clustering-demo/lib/python3.11/site-packages/sklearn_clustering.py&quot;, line 139, in &lt;module&gt;
    plt.switch_backend('tkagg')
  File &quot;/home/acoghlan/devel/venvstacks/examples/sklearn/_build/cpython-3.11/lib/python3.11/site-packages/matplotlib/pyplot.py&quot;, line 425, in switch_backend
    module = backend_registry.load_backend_module(newbackend)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/acoghlan/devel/venvstacks/examples/sklearn/_build/cpython-3.11/lib/python3.11/site-packages/matplotlib/backends/registry.py&quot;, line 317, in load_backend_module
    return importlib.import_module(module_name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/home/acoghlan/devel/venvstacks/examples/sklearn/_build/cpython-3.11/lib/python3.11/importlib/__init__.py&quot;, line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 1204, in _gcd_import
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 1176, in _find_and_load
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 1147, in _find_and_load_unlocked
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 690, in _load_unlocked
  File &quot;&lt;frozen importlib._bootstrap_external&gt;&quot;, line 940, in exec_module
  File &quot;&lt;frozen importlib._bootstrap&gt;&quot;, line 241, in _call_with_frames_removed
  File &quot;/home/acoghlan/devel/venvstacks/examples/sklearn/_build/cpython-3.11/lib/python3.11/site-packages/matplotlib/backends/backend_tkagg.py&quot;, line 1, in &lt;module&gt;
    from . import _backend_tk
  File &quot;/home/acoghlan/devel/venvstacks/examples/sklearn/_build/cpython-3.11/lib/python3.11/site-packages/matplotlib/backends/_backend_tk.py&quot;, line 25, in &lt;module&gt;
    from . import _tkagg
ImportError: initialization failed
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ncoghlan">@ncoghlan</a> on 2025-06-09 02:31</div>
            <div class="timeline-body"><p>Further confirmation: adding <code>pyside6</code> to the stack demo (and taking the explicit use of the TkAgg backend out again) gave a passing result.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-06-10 10:43</div>
            <div class="timeline-body"><p>I'll close this issue in favor of #6893.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-06-10 10:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geofft">@geofft</a> on 2025-08-08 22:11</div>
            <div class="timeline-body"><p>Copying my note from #6893 - I believe this should be resolved in uv 0.8.7, released just now. Please make sure you've updated both uv and your local Python versions:</p>
<pre><code>uv self update
uv python install --reinstall --no-bin 3.13.6
</code></pre>
<p>If you're using another Python version, use 3.9.23, 3.10.18, 3.11.13, 3.12.11, and/or 3.14.0rc1 in that command. (This ensures that you're on the latest patch release and you pick up the new build in case you were on an older build of that same patch release.)</p>
<p>Please try it out and let me know if there are remaining issues.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:32:00 UTC
    </footer>
</body>
</html>
