<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature: more graceful handling of `uv run` when CLIs aren't well exposed. - astral-sh/uv #6403</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature: more graceful handling of `uv run` when CLIs aren't well exposed.</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/6403">#6403</a>
        opened by <a href="https://github.com/strangemonad">@strangemonad</a>
        on 2024-08-22 03:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/strangemonad">@strangemonad</a> on 2024-08-22 03:14</div>
            <div class="timeline-body"><p>I don't have a great solution but wanted to call out some uvx rough edges. Some popular python packages don't expose conventionally named CLI entrypoints or rely on entrypoints from a transitive dependency.</p>
<p>Some examples:</p>
<p><code>jupyterlab</code> doesn't provide meaningful info of how to get to a solution.</p>
<pre><code>‚ùØ uvx jupyterlab
Installed 91 packages in 226ms
The executable `jupyterlab` was not found.
warning: An executable named `jupyterlab` is not provided by package `jupyterlab`.
The following executables are provided by `jupyterlab`:
- jlpm
- jupyter-lab
- jupyter-labextension
- jupyter-labhub

~ 3s
</code></pre>
<p><code>jupyter</code> does seem to work but gives a confusing warning</p>
<pre><code>‚ùØ uvx jupyter
Installed 99 packages in 254ms
warning: An executable named `jupyter` is not provided by package `jupyter` but is available via the dependency `jupyter-core`. Consider using `uvx --from jupyter-core jupyter` instead.
... # Successful run otherwise
</code></pre>
<p><code>dbt</code> You sort of have to know that the warning means use <code>--from</code></p>
<pre><code>‚ùØ uvx dbt-core
The executable `dbt-core` was not found.
warning: An executable named `dbt-core` is not provided by package `dbt-core`.
The following executables are provided by `dbt-core`:
- dbt

~
‚ùØ uvx --from dbt-core dbt
... # Successful run otherwise
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-22 03:34</div>
            <div class="timeline-body"><p>Thanks, these are great examples!</p>
<p>The last one seems easiest to fix (we can recommend <code>--from</code> there with a command you can copy-paste).</p>
<p>The Jupyter one is somewhat rough. I think the correct invocation is: <code>uvx --with jupyter --from jupyter-core jupyter notebook</code>. Because <code>jupyter-core</code> ships the executable, and then dynamically figures out which commands are enabled -- so you <em>do</em> need to install <code>jupyter</code> in that environment, but it doesn't contain the executable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-22 03:34</div>
            <div class="timeline-body"><p>\cc @zanieb</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by @charliermarsh on 2024-08-22 03:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-22 04:01</div>
            <div class="timeline-body"><p>Thank you!</p>
<p>I wonder what the <code>pipx</code> invocation for Jupyter is?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2024-08-22 04:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">uv tool</span> added by @zanieb on 2024-08-22 04:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/strangemonad">@strangemonad</a> on 2024-08-22 15:13</div>
            <div class="timeline-body"><p>@zanieb it's equally convoluted for pipx, which I know really comes down to how the package authors choose to expose things. What I've done in the past is something like</p>
<pre><code>pipx install --include-deps jupyter # to grap `jupyter` from `jupyter-core`
pipx inject jupyter --include-apps --include-deps jupyter-lab
</code></pre>
<p>That ends up installing too many entrypoints but at least it's been reliable across the last few versions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-22 16:07</div>
            <div class="timeline-body"><p>üò¨ Yeah that's pretty wild too. Thanks for sharing!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-08-22 16:08</div>
            <div class="timeline-body"><p>Seems like Jupyter should ship a CLI package that does something reasonable.. haha</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/6922.html">astral-sh/uv#6922</a> on 2024-09-02 18:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/johalnes">@johalnes</a> on 2025-03-23 06:05</div>
            <div class="timeline-body"><p>@zanieb I'm struggling a bit with this now regarding dbt-core, and is thinking about contributing to the project. Could you please write some lines on what one have to do to defined what you would call a reasonable CLI, and what to avoid? Any guides or sources I could read up on? üòÑ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/strangemonad">@strangemonad</a> on 2025-03-27 02:14</div>
            <div class="timeline-body"><p>@johalnes I solve dbt-core differently for my data eng teams / practitioners. I haven't seen this widely adopted but it's very fool proof.</p>
<ol>
<li>You need some way to bootstrap installing uv (eg a readme doc or whatever tooling you use to bootstrap a dev env)</li>
<li>make the dbt project also be a uv project with a pyproject.toml</li>
<li>add things like the pinned version of dbt and sql fluff as dev dependencies.</li>
</ol>
<p>Optionally, you can expose shortcuts for familiar commands like run, build, docs, test as script entrypoints (or in our case we use <code>just</code> as a task runner). This also means it you want to have any dbt python models that depend on python code elsewhere in your codebase, you can add that as a pyproject dep and <code>uv sync</code> takes care of things.</p>
<p><code>pyproject.toml</code> (sibling to <code>dbt_project.yml</code>)</p>
<pre><code class="language-toml">[project]
name = &quot;dbt&quot;
version = &quot;0.1.0&quot;
description = &quot;Dev env dependencies for the instance dbt project&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.11&quot;

[tool.sqlfluff.core]
dialect = &quot;snowflake&quot;

dependencies = []

[dependency-groups]
dev = [
    # Pinning DBT related versions. Upgrades require coordination.
    &quot;dbt-core==1.9.1&quot;,
    &quot;dbt-snowflake&gt;=1.8.4&quot;,
    &quot;snowflake-connector-python[secure-local-storage]&quot;,
    &quot;sqlfluff&quot;,
]
</code></pre>
<p><code>justfile</code></p>
<pre><code class="language-just">import '../../../../tools/common_python_uv_tasks.just'

set allow-duplicate-recipes

run *args: sync
  uv run dbt {{args}}

alias dbt := run

fmt: sync
  uv run sqlfluff format

# Note: generate-sources still needs some love
generate-sources: sync
  poetry run dbt --quiet run-operation generate_source --args '{ \
            &quot;database_name&quot;: &quot;instance_raw&quot;, \
            &quot;schema_name&quot;: &quot;firestore&quot;, \
            &quot;generate_columns&quot;: true, \
            &quot;include_data_types&quot;: true, \
            &quot;table_names&quot;: [ \
                &quot;accounts_raw_latest&quot;, \
                &quot;customer_orders_raw_latest&quot;, \
                &quot;dna_pool_orders_raw_latest&quot;, \
                &quot;groups_raw_latest&quot;, \
                &quot;oligo_libraries_raw_latest&quot;, \
                &quot;runs_raw_latest&quot;, \
                &quot;sub_pool_run_plans__subpools__encoded_genes_raw_latest&quot;, \
                &quot;sub_pool_run_plans__subpools_raw_latest&quot;, \
                &quot;sub_pool_run_plans_raw_latest&quot;, \
                &quot;sub_pool_runs__subpool_seq_oa_test_data_raw_latest&quot;, \
                &quot;sub_pool_runs_raw_latest&quot;, \
                &quot;task_attempts_raw_latest&quot; \
            ] \
         }' &gt; models/sources/firestore.yml.gen &amp;&amp; \
         mv models/sources/firestore.yml.gen models/sources/firestore.yml
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/johalnes">@johalnes</a> on 2025-03-27 11:49</div>
            <div class="timeline-body"><p>Thanks for sharing @strangemonad! Really appreciate it, and will try something similar üòÑ For now I've used the old <code>uv pip install dbt-databricks</code> which makes dbt cli works as usual.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:33 UTC
    </footer>
</body>
</html>
