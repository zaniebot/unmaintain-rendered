```yaml
number: 1479
title: "Extras specifiers in `project.scripts` cause a spurious \"failed to install\" error"
type: issue
state: closed
author: akx
labels:
  - bug
assignees: []
created_at: 2024-02-16T11:41:54Z
updated_at: 2024-02-16T14:25:33Z
url: https://github.com/astral-sh/uv/issues/1479
synced_at: 2026-01-10T01:57:02Z
```

# Extras specifiers in `project.scripts` cause a spurious "failed to install" error

---

_Issue opened by @akx on 2024-02-16 11:41_

The [`pylutron_caseta` package has interesting `package.scripts` with extras specifiers](
https://github.com/gurumitts/pylutron-caseta/blob/79ca8edf96b86708a00f06225fa73a9445d1e635/pyproject.toml#L30-L33
):

```toml
[project.optional-dependencies]
cli = [
    "click~=8.1.2",
    "xdg~=5.1.1",
    "zeroconf~=0.38.4",
]

[project.scripts]
lap-pair = "pylutron_caseta.cli:lap_pair[cli]"
leap = "pylutron_caseta.cli:leap[cli]"
leap-scan = "pylutron_caseta.cli:leap_scan[cli]"
```

According [to the spec](https://packaging.python.org/en/latest/specifications/entry-points/), these are a thing but no longer recommended:

> Using extras for an entry point is no longer recommended. Consumers should support parsing them from existing distributions, but may then ignore them. New publishing tools need not support specifying extras. The functionality of handling extras was tied to setuptools’ model of managing ‘egg’ packages, but newer tools such as pip and virtualenv use a different model.

This causes an error when installing with `uv pip install`, but surprisingly, the install succeeds despite the error:

```
(home-assistant-core) ~/b/home-assistant-core (uv-ci) $ uv pip install pylutron_caseta
Resolved 4 packages in 3ms
error: Failed to install: pylutron_caseta-0.19.0-py3-none-any.whl (pylutron-caseta==0.19.0)
  Caused by: The wheel is invalid: invalid console script: 'pylutron_caseta.cli:lap_pair[cli]'
(home-assistant-core) ~/b/home-assistant-core (uv-ci) $ uv pip uninstall pylutron_caseta
Uninstalled 1 package in 5ms
 - pylutron-caseta==0.19.0
(home-assistant-core) ~/b/home-assistant-core (uv-ci) $ uv pip uninstall pylutron_caseta
warning: Skipping pylutron-caseta as it is not installed.
warning: No packages to uninstall.
(home-assistant-core) ~/b/home-assistant-core (uv-ci) $
```

---

_Comment by @akx on 2024-02-16 11:57_

Ah, never mind, I see the bug! PR incoming~!


---

_Label `bug` added by @MichaReiser on 2024-02-16 12:03_

---

_Assigned to @MichaReiser by @MichaReiser on 2024-02-16 12:03_

---

_Assigned to @akx by @MichaReiser on 2024-02-16 12:03_

---

_Unassigned @MichaReiser by @MichaReiser on 2024-02-16 12:03_

---

_Referenced in [astral-sh/uv#1482](../../astral-sh/uv/pulls/1482.md) on 2024-02-16 12:03_

---

_Comment by @akx on 2024-02-16 12:05_

The PR doesn't fix that the install succeeds despite the scripts being invalid – I think the error message should be clearer (I guess it's really "failed to install console scripts"..?)

---

_Closed by @BurntSushi on 2024-02-16 14:25_

---
