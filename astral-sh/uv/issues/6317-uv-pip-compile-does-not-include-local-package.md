```yaml
number: 6317
title: "`uv pip compile` does not include local package"
type: issue
state: closed
author: joellidin
labels:
  - question
assignees: []
created_at: 2024-08-21T10:55:50Z
updated_at: 2024-08-23T18:02:56Z
url: https://github.com/astral-sh/uv/issues/6317
synced_at: 2026-01-12T15:59:03Z
```

# `uv pip compile` does not include local package

---

_@joellidin_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

I am playing around a bit with `uv` and its features and got interested in the `uv pip compile` for platform agnostic lock files. I set up a very basic project with this `pyproject.toml`:

```toml
[project]
name = "test-uv"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.12.4"
dependencies = [
    "ruff>=0.6.1",
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"
```

Later I ran `uv pip compile --universal pyproject.toml -o requirements.lock` which resulted in:
```lock
# This file was autogenerated by uv via the following command:
#    uv pip compile --universal pyproject.toml -o requirements.lock
ruff==0.6.1
    # via test-uv (pyproject.toml)
```
However, my local package is not included in this lockfile which is a bit weird to me. For example if I run `rye sync` instead I get the following:

```lock
# generated by rye
# use `rye lock` or `rye sync` to update this lockfile
#
# last locked with the following flags:
#   pre: false
#   features: []
#   all-features: false
#   with-sources: false
#   generate-hashes: false
#   universal: false

-e file:.
ruff==0.6.1
    # via test-uv
```

Moreover, when doing `uv sync` it actually installs my `test-uv` package in editable mode. But, I want to explore an option where you can just use normal `pip install -r requirements.lock` and not forced to use `uv`.

Am I missing something from the documentation or is this intended behavior?

I am on Ubuntu 22.04 with the latest version of `uv 0.3.0`.

---

_Comment by @charliermarsh on 2024-08-21 13:25_

So, if you pass a `pyproject.toml`, we lock the _dependencies_ but not the project itself.

But if you pass a _source tree_, we'll lock the project.

In other words, you can put `./test-uv` (or `./` if in the same directory) in a `requirements.in`, then run `uv pip compile --universal requirements.in`, and you should see the result you're looking for.


---

_Comment by @charliermarsh on 2024-08-21 13:26_

For example:

```
‚ùØ uv pip compile req.in
Resolved 4 packages in 62ms
# This file was autogenerated by uv via the following command:
#    uv pip compile req.in
anyio==4.4.0
    # via black
./
    # via -r req.in
idna==3.7
    # via anyio
sniffio==1.3.1
    # via anyio
```

---

_Label `question` added by @charliermarsh on 2024-08-21 13:26_

---

_Comment by @joellidin on 2024-08-21 13:52_

How can I lock dependencies with extras? I'm encountering the following error:
```bash
error: Requesting extras requires a `pyproject.toml`, `setup.cfg`, or `setup.py` file.
```
I'd prefer not to specify dependencies in multiple files.

`rye sync --features test --universal` works perfectly for me, creating both `requirements.lock` and `requirements-dev.lock`. I was just curious if this is possible with `uv` as well, but it seems like it doesn't work the same way.

---

_Comment by @charliermarsh on 2024-08-21 13:58_

Yeah totally -- you can add the following `requirements.in` to include the `dev` extra:

```
.[dev]
```

Is the main issue with `uv sync` just that you don't want the project to be installed as editable?


---

_Comment by @joellidin on 2024-08-21 14:15_

Okay! I understand better how it works then. I would want to have a lock file that is not only usable with uv. If I have the output from the compile I get a file I can install with the normal pip? For example if someone is not using `uv`. If that makes sense.

---

_Comment by @charliermarsh on 2024-08-23 18:02_

Makes sense. We will probably add support for _exporting_ `uv.lock` to `requirements.txt`, which could be useful for you in the future.

---

_Closed by @charliermarsh on 2024-08-23 18:02_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-08-23 18:02_

---
