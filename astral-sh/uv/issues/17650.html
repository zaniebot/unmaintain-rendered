<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`cffi` installed via uv is missing core attributes (`__version__` and `FFI`) - astral-sh/uv #17650</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>cffi</code> installed via uv is missing core attributes (<code>__version__</code> and <code>FFI</code>)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/17650">#17650</a>
        opened by <a href="https://github.com/map0logo">@map0logo</a>
        on 2026-01-21 23:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/map0logo">@map0logo</a></div>
            <div class="timeline-body">Problem Description
<p>When installing <code>cffi</code> using <code>uv</code>, the resulting package is incomplete or corrupted, missing essential attributes. This causes <code>AttributeError</code> when trying to access <code>cffi.__version__</code> or <code>cffi.FFI()</code>. The same package installed via <code>pip</code> works correctly.</p>
Steps to Reproduce
<ol>
<li><p>Create a new project directory and initialize with uv:</p>
<pre><code>uv init test-cffi &amp;&amp; cd test-cffi
</code></pre>
</li>
<li><p>Install <code>cffi</code> using uv:</p>
<pre><code>uv add cffi # or uv pip install cffi
</code></pre>
</li>
<li><p>Activate the virtual environment and test:</p>
<pre><code>source .venv/bin/activate
python -c &quot;import cffi; print(cffi.__version__); print(cffi.FFI())&quot;
</code></pre>
</li>
</ol>
<p><strong>Actual Result:</strong> <code>AttributeError</code> for both <code>__version__</code> and <code>FFI</code>.</p>
<pre><code>&gt;&gt;&gt; import cffi
&gt;&gt;&gt; cffi.__version__
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: module &#x27;cffi&#x27; has no attribute &#x27;__version__&#x27;
&gt;&gt;&gt; cffi.FFI()
Traceback (most recent call last):
  File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: module &#x27;cffi&#x27; has no attribute &#x27;FFI&#x27;
</code></pre>
<p><strong>Expected Result:</strong> Version string printed and FFI object created successfully (as happens when installed with <code>pip</code>).</p>
Workaround
<pre><code>python -m venv .venv
source .venv/bin/activate
pip install cffi
</code></pre>
<pre><code>&gt;&gt;&gt; import cffi
&gt;&gt;&gt; cffi.__version__
&#x27;2.0.0&#x27;
&gt;&gt;&gt; cffi.FFI()
&lt;cffi.api.FFI object at 0x7f38075cc6e0&gt;
</code></pre>
Additional Information
<p>This appears to be a packaging/installation issue specific to <code>uv</code>, as the standard <code>pip</code> installation works correctly. The problem may be related to how <code>uv</code> handles the package&#x27;s C extensions or metadata.</p>
Platform
<p>Linux 6.6.119-1-MANJARO x86_64 GNU/Linux</p>
Version
<p>0.9.26</p>
Python version
<p>3.12.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/map0logo">@map0logo</a> on 2026-01-21 23:14</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/map0logo">@map0logo</a> on 2026-01-22 02:25</div>
            <div class="timeline-body"><p>This is not the case at least in Manjaro Linux and Python 3.12</p>
<p>Trying your script:</p>
<pre><code>uv init test-cffi &amp;&amp; cd test-cffi
uv add cffi
echo &quot;# shadow&quot; &gt; cffi.py
uv run python -c &quot;import cffi; print(cffi.__version__)&quot;
</code></pre>
<pre><code>Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: module &#x27;cffi&#x27; has no attribute &#x27;__version__&#x27;
</code></pre>
<p>Without shadowing</p>
<pre><code>rm cffi.py
uv run python -c &quot;import cffi; print(cffi.__version__)&quot;
</code></pre>
<p>I got, again</p>
<pre><code>Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
AttributeError: module &#x27;cffi&#x27; has no attribute &#x27;__version__&#x27;
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-22 03:13:08 UTC
    </footer>
</body>
</html>
