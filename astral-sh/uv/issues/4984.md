```yaml
number: 4984
title: "uv venv's activate command cannot work on MSYS2"
type: issue
state: closed
author: pplmx
labels:
  - bug
  - good first issue
assignees: []
created_at: 2024-07-11T01:42:50Z
updated_at: 2024-08-20T18:29:22Z
url: https://github.com/astral-sh/uv/issues/4984
synced_at: 2026-01-10T01:57:10Z
```

# uv venv's activate command cannot work on MSYS2

---

_Issue opened by @pplmx on 2024-07-11 01:42_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

## Steps to Reproduce

At MSYS2, run the following command:

```bash
❯ uv venv
Using Python 3.12.4 interpreter at: C:\Users\xxx\AppData\Local\Programs\Python\Python312\python.exe
Creating virtualenv at: .venv
Activate with: source .venv\Scripts\activate
❯ source .venv\Scripts\activate
source: no such file or directory: .venvScriptsactivate

```

## Suggested Fix

Use the correct path to activate the virtual environment:

```bash
source .venv/Scripts/activate

```

## Environment Details

```bash
cat /etc/os-release
NAME=MSYS2
ID=msys2
PRETTY_NAME="MSYS2"
ID_LIKE="cygwin arch"
HOME_URL="https://www.msys2.org"
BUG_REPORT_URL="https://github.com/msys2/MSYS2-packages/issues"

uv version
uv 0.2.24 (527b711bc 2024-07-10)
```


---

_Comment by @zanieb on 2024-07-11 04:08_

Thanks! Looks like we need to display a posix style path here, it should be relatively easy to fix?

---

_Label `bug` added by @zanieb on 2024-07-11 04:08_

---

_Label `good first issue` added by @zanieb on 2024-07-11 04:08_

---

_Comment by @zanieb on 2024-07-11 04:18_

Considering something like

```diff
diff --git a/crates/uv/src/commands/venv.rs b/crates/uv/src/commands/venv.rs
index cb906898..7e669ead 100644
--- a/crates/uv/src/commands/venv.rs
+++ b/crates/uv/src/commands/venv.rs
@@ -312,7 +312,7 @@ async fn venv_impl(
 /// Quote a path, if necessary, for safe use in a POSIX-compatible shell command.
 fn shlex_posix(executable: impl AsRef<Path>) -> String {
     // Convert to a display path.
-    let executable = executable.as_ref().user_display().to_string();
+    let executable = executable.as_ref().portable_display().to_string();
 
     // Like Python's `shlex.quote`:
     // > Use single quotes, and put single quotes into double quotes
```

but I'm a little confused that `portable_display()` only uses portable slashes for relative paths? We might need another helper method that always uses the portable path? We'll want to add some tests if we can.

---

_Comment by @pplmx on 2024-07-11 05:30_

> Thanks! Looks like we need to display a posix style path here, it should be relatively easy to fix?

Yes, if msys2 is found, directly printing a POSIX-style path is fine.

---

_Comment by @MathiasAugustesen on 2024-08-20 18:24_

Is this one still up for grabs? If so I'd like to take a stab at it

---

_Comment by @zanieb on 2024-08-20 18:27_

I think I might have fixed this

---

_Comment by @zanieb on 2024-08-20 18:27_

Yeah, https://github.com/astral-sh/uv/pull/5956 — sorry.

---

_Closed by @zanieb on 2024-08-20 18:27_

---

_Comment by @MathiasAugustesen on 2024-08-20 18:29_

No problem, I'll look around for something else to tackle

---
