<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add tool bin dir to PATH in uv's docker images - astral-sh/uv #13057</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add tool bin dir to PATH in uv&#x27;s docker images</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13057">#13057</a>
        opened by <a href="https://github.com/RazerM">@RazerM</a>
        on 2025-04-22 17:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/RazerM">@RazerM</a></div>
            <div class="timeline-body">Summary
<p>If using a uv docker image such as <code>ghcr.io/astral-sh/uv:python3.13-bookworm</code>, installed tools are not on the <code>PATH</code>, which means tools cannot be used out of the box. E.g. in a GitLab CI job:</p>
<pre><code>job:
  stage: deploy
  image: ghcr.io/astral-sh/uv:python3.13-bookworm
  before_script:
    - uv tool install ...
    - &lt;try to use tool&gt;
</code></pre>
<pre><code>warning: `/root/.local/bin` is not on your PATH. To use installed tools, add the directory to your PATH.
</code></pre>
<p>It would be nice if the docker images included <code>ENV PATH=/root/.local/bin:$PATH</code> so that this worked.</p>
Example
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/RazerM">@RazerM</a> on 2025-04-22 17:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/zanieb">@zanieb</a> by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-25 02:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-04-26 02:28</div>
            <div class="timeline-body"><p>@RazerM this is generally a nice shortcut, although it comes with risks given this is a breaking change which may effectively break downstream consumers.</p>
<p>Few immediate examples of this:</p>
<ol>
<li>There is no easy way to opt-out if this behavior on builds that inherit from this image besides re-overriding PATH at build time or patching it at runtime each time.</li>
<li>Putting root in the path can be problematic for anyone that inherits from this image and uses a different user, likely causing permission issues. Using a different user will change what the tool path should be ultimately be. This is something that should be determined by the consumer not producer in our case.</li>
<li>You&#x27;d introduce different behaviors across images as  /root is not portable. There may be no equivalent across all images. Since Docker does not expand env vars dynamically from a runtime shell-specific output, you&#x27;d still have a build limitation on achieving the proposed behavior.</li>
</ol>
<p>On your example, I would instead prefix PATH which what you need to accomplish the desired behavior.</p>
<pre><code>before_script:
    - uv tool install ...
    - PATH=/root/.local/bin:$PATH  &lt;try to use tool&gt;
</code></pre>
<p>edit: changed <code>permanently</code> to <code>effectively</code> to clarify intent and fixed wording on example 3 which was confusing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RazerM">@RazerM</a> on 2025-04-26 21:28</div>
            <div class="timeline-body"><p>@samypr100</p>
<blockquote>
<p>this is a breaking change which may permanently break downstream consumers.</p>
</blockquote>
<p>I think that may be a bit dramatic ðŸ˜…</p>
<p>To answer your examples point by point:</p>
<ol>
<li><p>I&#x27;m not sure why anyone would need an opt-out here. A user of the image is in control of what gets installed. Anyone running the image as root can do whatever they want, and anyone running as non-root isn&#x27;t affected by it.</p>
</li>
<li><p>Inaccessible directories on PATH are ignored, they wouldn&#x27;t cause &quot;permission issues&quot;.</p>
<p>If I build on top of these images and use a different user, it&#x27;s also on me to set up <code>PATH</code> if I want <code>uv tool install</code> to work for that user.</p>
</li>
<li><p>Obviously the correct directory would be used for each image that is built...</p>
</li>
<li><p>I&#x27;m not sure what you&#x27;re trying to say here. <code>ENV</code> does expand <code>$PATH</code> at build time. You can have a look at <code>docker image inspect</code> on built images if you want to check this.</p>
</li>
</ol>
<blockquote>
<p>On your example, I would instead prefix PATH which what you need to accomplish the desired behavior.</p>
</blockquote>
<p>I&#x27;m using <code>UV_TOOL_BIN_DIR</code>, since I can set it globally:</p>
<pre><code>variables:
  UV_TOOL_BIN_DIR: /usr/local/bin

job:
  stage: deploy
  image: ghcr.io/astral-sh/uv:python3.13-bookworm
  before_script:
    - uv tool install ...
    - &lt;try to use tool&gt;
</code></pre>
<p>I just thought it would be nice if <code>uv tool install</code> worked out of the box...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-04-26 21:59</div>
            <div class="timeline-body"><blockquote>
<p>I&#x27;m using UV_TOOL_BIN_DIR, since I can set it globally</p>
</blockquote>
<p>Indeed, that&#x27;s a good approach and something that seems quite reasonable to do on uv images by default over modifying PATH.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/RazerM">@RazerM</a> on 2025-06-23 22:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:19 UTC
    </footer>
</body>
</html>
