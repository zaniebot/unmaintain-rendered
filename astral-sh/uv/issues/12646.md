```yaml
number: 12646
title: "`uv pip compile` generates an invalid `pyproject.toml` (uses requirements.txt format instead of TOML)"
type: issue
state: closed
author: cpprhtn
labels:
  - error messages
assignees: []
created_at: 2025-04-03T08:37:50Z
updated_at: 2025-04-05T01:03:27Z
url: https://github.com/astral-sh/uv/issues/12646
synced_at: 2026-01-10T01:57:29Z
```

# `uv pip compile` generates an invalid `pyproject.toml` (uses requirements.txt format instead of TOML)

---

_Issue opened by @cpprhtn on 2025-04-03 08:37_

### Summary

### Description
When running `uv pip compile -o pyproject.toml requirements.txt`, the generated pyproject.toml is not in valid TOML format. Instead, it follows the requirements.txt format, which causes parsing errors when trying to use uv for dependency management.

### Steps to Reproduce
Prepare a requirements.txt file with the following content:
```
aiohappyeyeballs==2.6.1
aiohttp==3.11.16
aiosignal==1.3.2
```

Run the uv command to generate pyproject.toml:
```
uv pip compile -o pyproject.toml requirements.txt
```

Open the generated pyproject.toml file. Instead of a proper TOML structure, it contains:
```
# This file was autogenerated by uv via the following command:
#    uv pip compile -o pyproject.toml requirements.txt
aiohappyeyeballs==2.6.1
    # via aiohttp
aiohttp==3.11.16
    # via py-cord
aiosignal==1.3.2
    # via aiohttp
```

Try to install dependencies using uv pip install -r pyproject.toml. It results in the following error:
```
TOML parse error at line 3, column 18
invalid string
expected `"`, `'`
```

### Expected Behavior
The generated pyproject.toml should follow the proper TOML format, like this:
```
[project]
name = "my_project"
version = "0.1.0"
description = "My Project Description"
dependencies = [
    "aiohappyeyeballs==2.6.1",
    "aiohttp==3.11.16",
    "aiosignal==1.3.2",
]
```

Is there another way to generate a proper pyproject.toml using uv pip compile? If this is indeed a bug, I would be contributing this issue

### Platform

macOS M1

### Version

0.6.12 (Homebrew 2025-04-02)

### Python version

Python 3.12.9

---

_Label `bug` added by @cpprhtn on 2025-04-03 08:37_

---

_Comment by @charliermarsh on 2025-04-03 12:56_

This API doesn't generate TOML. That's just not a supported format here. It only supports requirements.txt. You can just copy the output dependencies into a `project.dependencies` field in a `pyproject.toml`.

---

_Label `bug` removed by @charliermarsh on 2025-04-03 12:56_

---

_Label `question` added by @charliermarsh on 2025-04-03 12:56_

---

_Comment by @zanieb on 2025-04-03 13:18_

We could add a warning if the output file has a `.toml` file extension

---

_Comment by @cpprhtn on 2025-04-04 04:03_

How about add Support for Generating requirements.txt to pyproject.toml with uv

uv supports dependency resolution and management via requirements.txt, but it does not provide a built-in way to generate a pyproject.toml file. Many modern Python projects follow the PEP 621 standard and prefer pyproject.toml over requirements.txt for dependency management.

Having uv generate pyproject.toml automatically from requirements.txt would improve developer experience and simplify the transition to TOML-based workflows.

Many tools (such as poetry and pdm) rely on pyproject.toml, making seamless integration with uv beneficial.

It's just my thoughts and opinions haha.

---

_Assigned to @charliermarsh by @charliermarsh on 2025-04-04 12:59_

---

_Label `question` removed by @charliermarsh on 2025-04-04 13:01_

---

_Label `error messages` added by @charliermarsh on 2025-04-04 13:01_

---

_Referenced in [astral-sh/uv#12673](../../astral-sh/uv/pulls/12673.md) on 2025-04-04 13:12_

---

_Comment by @zanieb on 2025-04-04 14:02_

@cpprhtn we allow `uv init && uv add -r requirements.txt` already?

---

_Closed by @zanieb on 2025-04-04 14:09_

---

_Closed by @zanieb on 2025-04-04 14:09_

---

_Comment by @cpprhtn on 2025-04-05 01:03_

yes. I understand. Thankyou

---
