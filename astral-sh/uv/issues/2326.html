<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv should use arch of python, not of uv - astral-sh/uv #2326</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv should use arch of python, not of uv</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2326">#2326</a>
        opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a>
        on 2024-03-10 05:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 05:04</div>
            <div class="timeline-body"><pre><code>~/tmp/vnvmypy λ /Users/shantanu/.pyenv/versions/3.12.2/bin/python -m venv .venv
~/tmp/vnvmypy λ source .venv/bin/activate                                   

(.venv) ~/tmp/vnvmypy λ python -c 'import platform; print(platform.machine())'
arm64

(.venv) ~/tmp/vnvmypy λ uv pip install mypy -v
    0.004130s DEBUG uv_client::registry_client Using registry request timeout of 300s
 uv::requirements::from_source source=mypy
    0.260724s DEBUG uv_interpreter::python_environment Found a virtualenv through VIRTUAL_ENV at: /Users/shantanu/tmp/vnvmypy/.venv
    0.262698s DEBUG uv_interpreter::interpreter Probing interpreter info for: /Users/shantanu/tmp/vnvmypy/.venv/bin/python
    0.301961s DEBUG uv_interpreter::interpreter Found Python 3.12.2 for: /Users/shantanu/tmp/vnvmypy/.venv/bin/python
    0.303255s DEBUG uv::commands::pip_install Using Python 3.12.2 environment at /Users/shantanu/tmp/vnvmypy/.venv/bin/python
 uv_client::flat_index::from_entries 
 uv_resolver::resolver::solve 
      0.308513s   0ms DEBUG uv_resolver::resolver Solving with target Python version 3.12.2
   uv_resolver::resolver::choose_version package=root
   uv_resolver::resolver::get_dependencies package=root, version=0a0.dev0
        0.309534s   0ms DEBUG uv_resolver::resolver Adding direct dependency: mypy*
   uv_resolver::resolver::choose_version package=mypy
     uv_resolver::resolver::package_wait package_name=mypy
 uv_resolver::resolver::process_request request=Versions mypy
   uv_client::registry_client::simple_api package=mypy
     uv_client::cached_client::get_cacheable 
       uv_client::cached_client::read_and_parse_cache file=/Users/shantanu/Library/Caches/uv/simple-v3/pypi/mypy.rkyv
 uv_resolver::resolver::process_request request=Prefetch mypy *
 uv_client::cached_client::from_path_sync path=&quot;/Users/shantanu/Library/Caches/uv/simple-v3/pypi/mypy.rkyv&quot;
          0.313603s   2ms DEBUG uv_client::cached_client Found fresh response for: https://pypi.org/simple/mypy/
   uv_resolver::version_map::from_metadata 
   uv_distribution::distribution_database::get_or_build_wheel_metadata dist=mypy==1.9.0
     uv_client::registry_client::wheel_metadata built_dist=mypy==1.9.0
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/Users/shantanu/Library/Caches/uv/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.msgpack
 uv_client::cached_client::from_path_sync path=&quot;/Users/shantanu/Library/Caches/uv/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.msgpack&quot;
        0.315482s   5ms DEBUG uv_resolver::resolver Searching for a compatible version of mypy (*)
        0.315495s   5ms DEBUG uv_resolver::resolver Selecting: mypy==1.9.0 (mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl)
   uv_resolver::resolver::get_dependencies package=mypy, version=1.9.0
     uv_resolver::resolver::distributions_wait package_id=mypy-1.9.0
              0.315775s   0ms DEBUG uv_client::cached_client Found fresh response for: https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl.metadata
        0.317034s   1ms DEBUG uv_resolver::resolver Adding transitive dependency: typing-extensions&gt;=4.1.0
        0.317044s   1ms DEBUG uv_resolver::resolver Adding transitive dependency: mypy-extensions&gt;=1.0.0
   uv_resolver::resolver::choose_version package=typing-extensions
     uv_resolver::resolver::package_wait package_name=typing-extensions
 uv_resolver::resolver::process_request request=Versions typing-extensions
   uv_client::registry_client::simple_api package=typing-extensions
     uv_client::cached_client::get_cacheable 
       uv_client::cached_client::read_and_parse_cache file=/Users/shantanu/Library/Caches/uv/simple-v3/pypi/typing-extensions.rkyv
 uv_resolver::resolver::process_request request=Versions mypy-extensions
   uv_client::registry_client::simple_api package=mypy-extensions
     uv_client::cached_client::get_cacheable 
       uv_client::cached_client::read_and_parse_cache file=/Users/shantanu/Library/Caches/uv/simple-v3/pypi/mypy-extensions.rkyv
 uv_client::cached_client::from_path_sync path=&quot;/Users/shantanu/Library/Caches/uv/simple-v3/pypi/typing-extensions.rkyv&quot;
 uv_resolver::resolver::process_request request=Prefetch mypy-extensions &gt;=1.0.0
 uv_resolver::resolver::process_request request=Prefetch typing-extensions &gt;=4.1.0
 uv_client::cached_client::from_path_sync path=&quot;/Users/shantanu/Library/Caches/uv/simple-v3/pypi/mypy-extensions.rkyv&quot;
          0.317661s   0ms DEBUG uv_client::cached_client Found fresh response for: https://pypi.org/simple/typing-extensions/
   uv_resolver::version_map::from_metadata 
   uv_distribution::distribution_database::get_or_build_wheel_metadata dist=typing-extensions==4.10.0
     uv_client::registry_client::wheel_metadata built_dist=typing-extensions==4.10.0
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/Users/shantanu/Library/Caches/uv/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.msgpack
          0.317769s   0ms DEBUG uv_client::cached_client Found fresh response for: https://pypi.org/simple/mypy-extensions/
   uv_resolver::version_map::from_metadata 
 uv_client::cached_client::from_path_sync path=&quot;/Users/shantanu/Library/Caches/uv/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.msgpack&quot;
   uv_distribution::distribution_database::get_or_build_wheel_metadata dist=mypy-extensions==1.0.0
     uv_client::registry_client::wheel_metadata built_dist=mypy-extensions==1.0.0
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/Users/shantanu/Library/Caches/uv/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.msgpack
        0.317877s   0ms DEBUG uv_resolver::resolver Searching for a compatible version of typing-extensions (&gt;=4.1.0)
 uv_client::cached_client::from_path_sync path=&quot;/Users/shantanu/Library/Caches/uv/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.msgpack&quot;
        0.317890s   0ms DEBUG uv_resolver::resolver Selecting: typing-extensions==4.10.0 (typing_extensions-4.10.0-py3-none-any.whl)
   uv_resolver::resolver::get_dependencies package=typing-extensions, version=4.10.0
     uv_resolver::resolver::distributions_wait package_id=typing-extensions-4.10.0
              0.318167s   0ms DEBUG uv_client::cached_client Found fresh response for: https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl.metadata
              0.318194s   0ms DEBUG uv_client::cached_client Found fresh response for: https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl.metadata
   uv_resolver::resolver::choose_version package=mypy-extensions
     uv_resolver::resolver::package_wait package_name=mypy-extensions
        0.318223s   0ms DEBUG uv_resolver::resolver Searching for a compatible version of mypy-extensions (&gt;=1.0.0)
        0.318228s   0ms DEBUG uv_resolver::resolver Selecting: mypy-extensions==1.0.0 (mypy_extensions-1.0.0-py3-none-any.whl)
   uv_resolver::resolver::get_dependencies package=mypy-extensions, version=1.0.0
     uv_resolver::resolver::distributions_wait package_id=mypy-extensions-1.0.0
Resolved 3 packages in 12ms
    0.322115s DEBUG uv_installer::plan Requirement already cached: mypy==1.9.0
    0.323310s DEBUG uv_installer::plan Requirement already cached: mypy-extensions==1.0.0
    0.324451s DEBUG uv_installer::plan Requirement already cached: typing-extensions==4.10.0
    0.324833s DEBUG uv_installer::plan Preserving seed package: pip==24.0
 uv_installer::installer::install num_wheels=3
Installed 3 packages in 27ms
 + mypy==1.9.0
 + mypy-extensions==1.0.0
 + typing-extensions==4.10.0

(.venv) ~/tmp/vnvmypy λ python -m mypy --version                              
/Users/shantanu/tmp/vnvmypy/.venv/bin/python: Error while finding module specification for 'mypy.__main__' (ImportError: dlopen(/Users/shantanu/tmp/vnvmypy/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so, 0x0002): tried: '/Users/shantanu/tmp/vnvmypy/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64')), '/System/Volumes/Preboot/Cryptexes/OS/Users/shantanu/tmp/vnvmypy/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so' (no such file), '/Users/shantanu/tmp/vnvmypy/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64')))

(.venv) ~/tmp/vnvmypy λ uv --version
uv 0.1.16 (9f1452cb7 2024-03-07)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 05:07</div>
            <div class="timeline-body"><p>I guess ^that run is with a cache, but it repros with <code>uv cache clean</code> + <code>uv pip install --no-cache-dir</code> as well</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 05:08</div>
            <div class="timeline-body"><p>Previous similar issue: https://github.com/astral-sh/uv/issues/1840#issuecomment-1958344404</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-03-10 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 12:49</div>
            <div class="timeline-body"><p>Dang, I successfully get <code>mypy-1.9.0-cp312-cp312-macosx_11_0_arm64.whl</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 12:53</div>
            <div class="timeline-body"><p>When you reproduced, you created a new virtual environment too, right? In addition to clearing the cache?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2024-03-10 12:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 13:47</div>
            <div class="timeline-body"><p>Can you share the output of <code>get_interpreter_info.py</code>?</p>
<p>https://github.com/astral-sh/uv/blob/73b30ba8ed681a3c8e66746534f9c678851cbd68/crates/uv-interpreter/src/get_interpreter_info.py#L4</p>
<p>At least the markers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 20:44</div>
            <div class="timeline-body"><p>Here you go:</p>
<pre><code>~/tmp λ rm -rf uvrepro                                                   
~/tmp λ mkdir uvrepro; cd uvrepro                                        
~/tmp/uvrepro λ /Users/shantanu/.pyenv/versions/3.12.2/bin/python -m venv .venv
~/tmp/uvrepro λ source .venv/bin/activate
(.venv) ~/tmp/uvrepro λ python --version                                                                        
Python 3.12.2
(.venv) ~/tmp/uvrepro λ python -c 'import platform; print(platform.machine())'
arm64
(.venv) ~/tmp/uvrepro λ python /Users/shantanu/dev/uv/crates/uv-interpreter/src/get_interpreter_info.py
{&quot;markers&quot;: {&quot;implementation_name&quot;: &quot;cpython&quot;, &quot;implementation_version&quot;: &quot;3.12.2&quot;, &quot;os_name&quot;: &quot;posix&quot;, &quot;platform_machine&quot;: &quot;arm64&quot;, &quot;platform_python_implementation&quot;: &quot;CPython&quot;, &quot;platform_release&quot;: &quot;23.3.0&quot;, &quot;platform_system&quot;: &quot;Darwin&quot;, &quot;platform_version&quot;: &quot;Darwin Kernel Version 23.3.0: Wed Dec 20 21:30:44 PST 2023; root:xnu-10002.81.5~7/RELEASE_ARM64_T6000&quot;, &quot;python_full_version&quot;: &quot;3.12.2&quot;, &quot;python_version&quot;: &quot;3.12&quot;, &quot;sys_platform&quot;: &quot;darwin&quot;}, &quot;base_prefix&quot;: &quot;/Users/shantanu/.pyenv/versions/3.12.2&quot;, &quot;base_exec_prefix&quot;: &quot;/Users/shantanu/.pyenv/versions/3.12.2&quot;, &quot;prefix&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv&quot;, &quot;base_executable&quot;: &quot;/Users/shantanu/.pyenv/versions/3.12.2/bin/python3.12&quot;, &quot;sys_executable&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv/bin/python&quot;, &quot;stdlib&quot;: &quot;/Users/shantanu/.pyenv/versions/3.12.2/lib/python3.12&quot;, &quot;scheme&quot;: {&quot;platlib&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv/lib/python3.12/site-packages&quot;, &quot;purelib&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv/lib/python3.12/site-packages&quot;, &quot;include&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv/include/site/python3.12&quot;, &quot;scripts&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv/bin&quot;, &quot;data&quot;: &quot;/Users/shantanu/tmp/uvrepro/.venv&quot;}, &quot;virtualenv&quot;: {&quot;purelib&quot;: &quot;lib/python3.12/site-packages&quot;, &quot;platlib&quot;: &quot;lib/python3.12/site-packages&quot;, &quot;include&quot;: &quot;include/site/python3.12&quot;, &quot;scripts&quot;: &quot;bin&quot;, &quot;data&quot;: &quot;&quot;}}
(.venv) ~/tmp/uvrepro λ uv cache clean           
Clearing cache at: /Users/shantanu/Library/Caches/uv
Removed 1119 files (14.5MiB)
(.venv) ~/tmp/uvrepro λ uv pip install mypy --no-cache-dir -v
    0.003785s DEBUG uv_client::registry_client Using registry request timeout of 300s
 uv::requirements::from_source source=mypy
    0.231848s DEBUG uv_interpreter::python_environment Found a virtualenv through VIRTUAL_ENV at: /Users/shantanu/tmp/uvrepro/.venv
    0.233757s DEBUG uv_interpreter::interpreter Probing interpreter info for: /Users/shantanu/tmp/uvrepro/.venv/bin/python
    0.272762s DEBUG uv_interpreter::interpreter Found Python 3.12.2 for: /Users/shantanu/tmp/uvrepro/.venv/bin/python
    0.274381s DEBUG uv::commands::pip_install Using Python 3.12.2 environment at /Users/shantanu/tmp/uvrepro/.venv/bin/python
 uv_client::flat_index::from_entries 
 uv_resolver::resolver::solve 
      0.280049s   0ms DEBUG uv_resolver::resolver Solving with target Python version 3.12.2
   uv_resolver::resolver::choose_version package=root
   uv_resolver::resolver::get_dependencies package=root, version=0a0.dev0
        0.281207s   0ms DEBUG uv_resolver::resolver Adding direct dependency: mypy*
   uv_resolver::resolver::choose_version package=mypy
     uv_resolver::resolver::package_wait package_name=mypy
 uv_resolver::resolver::process_request request=Versions mypy
   uv_client::registry_client::simple_api package=mypy
     uv_client::cached_client::get_cacheable 
       uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/mypy.rkyv
 uv_resolver::resolver::process_request request=Prefetch mypy *
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/mypy.rkyv&quot;
          0.284290s   1ms DEBUG uv_client::cached_client No cache entry for: https://pypi.org/simple/mypy/
       uv_client::cached_client::fresh_request url=&quot;https://pypi.org/simple/mypy/&quot;
       uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/mypy.rkyv
       uv_client::registry_client::parse_simple_api package=mypy
   uv_resolver::version_map::from_metadata 
   uv_distribution::distribution_database::get_or_build_wheel_metadata dist=mypy==1.9.0
     uv_client::registry_client::wheel_metadata built_dist=mypy==1.9.0
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.msgpack
        0.369299s  87ms DEBUG uv_resolver::resolver Searching for a compatible version of mypy (*)
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.msgpack&quot;
        0.369328s  87ms DEBUG uv_resolver::resolver Selecting: mypy==1.9.0 (mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl)
   uv_resolver::resolver::get_dependencies package=mypy, version=1.9.0
     uv_resolver::resolver::distributions_wait package_id=mypy-1.9.0
              0.369402s   0ms DEBUG uv_client::cached_client No cache entry for: https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl.metadata
           uv_client::cached_client::fresh_request url=&quot;https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl.metadata&quot;
           uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.msgpack
           uv_client::registry_client::parse_metadata21 
        0.429932s  60ms DEBUG uv_resolver::resolver Adding transitive dependency: typing-extensions&gt;=4.1.0
        0.429951s  60ms DEBUG uv_resolver::resolver Adding transitive dependency: mypy-extensions&gt;=1.0.0
   uv_resolver::resolver::choose_version package=typing-extensions
     uv_resolver::resolver::package_wait package_name=typing-extensions
 uv_resolver::resolver::process_request request=Versions typing-extensions
   uv_client::registry_client::simple_api package=typing-extensions
     uv_client::cached_client::get_cacheable 
       uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/typing-extensions.rkyv
 uv_resolver::resolver::process_request request=Versions mypy-extensions
   uv_client::registry_client::simple_api package=mypy-extensions
     uv_client::cached_client::get_cacheable 
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/typing-extensions.rkyv&quot;
       uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/mypy-extensions.rkyv
 uv_resolver::resolver::process_request request=Prefetch mypy-extensions &gt;=1.0.0
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/mypy-extensions.rkyv&quot;
 uv_resolver::resolver::process_request request=Prefetch typing-extensions &gt;=4.1.0
          0.430156s   0ms DEBUG uv_client::cached_client No cache entry for: https://pypi.org/simple/typing-extensions/
       uv_client::cached_client::fresh_request url=&quot;https://pypi.org/simple/typing-extensions/&quot;
          0.430195s   0ms DEBUG uv_client::cached_client No cache entry for: https://pypi.org/simple/mypy-extensions/
       uv_client::cached_client::fresh_request url=&quot;https://pypi.org/simple/mypy-extensions/&quot;
       uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/mypy-extensions.rkyv
       uv_client::registry_client::parse_simple_api package=mypy-extensions
       uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/simple-v3/pypi/typing-extensions.rkyv
       uv_client::registry_client::parse_simple_api package=typing-extensions
   uv_resolver::version_map::from_metadata 
   uv_resolver::version_map::from_metadata 
   uv_distribution::distribution_database::get_or_build_wheel_metadata dist=mypy-extensions==1.0.0
     uv_client::registry_client::wheel_metadata built_dist=mypy-extensions==1.0.0
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.msgpack
   uv_distribution::distribution_database::get_or_build_wheel_metadata dist=typing-extensions==4.10.0
     uv_client::registry_client::wheel_metadata built_dist=typing-extensions==4.10.0
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.msgpack&quot;
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.msgpack
        0.444764s  14ms DEBUG uv_resolver::resolver Searching for a compatible version of typing-extensions (&gt;=4.1.0)
        0.444786s  14ms DEBUG uv_resolver::resolver Selecting: typing-extensions==4.10.0 (typing_extensions-4.10.0-py3-none-any.whl)
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.msgpack&quot;
   uv_resolver::resolver::get_dependencies package=typing-extensions, version=4.10.0
     uv_resolver::resolver::distributions_wait package_id=typing-extensions-4.10.0
              0.444860s   0ms DEBUG uv_client::cached_client No cache entry for: https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl.metadata
           uv_client::cached_client::fresh_request url=&quot;https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl.metadata&quot;
              0.444892s   0ms DEBUG uv_client::cached_client No cache entry for: https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl.metadata
           uv_client::cached_client::fresh_request url=&quot;https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl.metadata&quot;
           uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.msgpack
           uv_client::registry_client::parse_metadata21 
           uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.msgpack
           uv_client::registry_client::parse_metadata21 
   uv_resolver::resolver::choose_version package=mypy-extensions
     uv_resolver::resolver::package_wait package_name=mypy-extensions
        0.458422s   0ms DEBUG uv_resolver::resolver Searching for a compatible version of mypy-extensions (&gt;=1.0.0)
        0.458429s   0ms DEBUG uv_resolver::resolver Selecting: mypy-extensions==1.0.0 (mypy_extensions-1.0.0-py3-none-any.whl)
   uv_resolver::resolver::get_dependencies package=mypy-extensions, version=1.0.0
     uv_resolver::resolver::distributions_wait package_id=mypy-extensions-1.0.0
Resolved 3 packages in 181ms
    0.459908s DEBUG uv_installer::plan Identified uncached requirement: mypy ==1.9.0
    0.460110s DEBUG uv_installer::plan Identified uncached requirement: mypy-extensions ==1.0.0
    0.460288s DEBUG uv_installer::plan Identified uncached requirement: typing-extensions ==4.10.0
    0.460841s DEBUG uv_installer::plan Preserving seed package: pip==24.0
 uv_installer::downloader::download total=3
   uv_installer::downloader::get_wheel name=mypy==1.9.0, size=Some(10725390), url=&quot;https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl&quot;
     uv_distribution::distribution_database::get_or_build_wheel dist=Built(Registry(RegistryBuiltDist { filename: WheelFilename { name: PackageName(&quot;mypy&quot;), version: &quot;1.9.0&quot;, python_tag: [&quot;cp312&quot;], abi_tag: [&quot;cp312&quot;], platform_tag: [&quot;macosx_10_9_x86_64&quot;] }, file: File { dist_info_metadata: Some(Hashes(Hashes { md5: None, sha256: Some(&quot;2842400ab2d66cc18e6838edc4ea958845f9b8db5fa958ffd043a2c26f20f1ca&quot;) })), filename: &quot;mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl&quot;, hashes: Hashes { md5: None, sha256: Some(&quot;aceb1db093b04db5cd390821464504111b8ec3e351eb85afd1433490163d60cd&quot;) }, requires_python: Some(VersionSpecifiers([VersionSpecifier { operator: GreaterThanEqual, version: &quot;3.8&quot; }])), size: Some(10725390), upload_time_utc_ms: Some(1709914201099), url: AbsoluteUrl(&quot;https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl&quot;), yanked: Some(Bool(false)) }, index: Pypi(VerbatimUrl { url: Url { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }) }))
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.http
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.http&quot;
   uv_installer::downloader::get_wheel name=typing-extensions==4.10.0, size=Some(33926), url=&quot;https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl&quot;
     uv_distribution::distribution_database::get_or_build_wheel dist=Built(Registry(RegistryBuiltDist { filename: WheelFilename { name: PackageName(&quot;typing-extensions&quot;), version: &quot;4.10.0&quot;, python_tag: [&quot;py3&quot;], abi_tag: [&quot;none&quot;], platform_tag: [&quot;any&quot;] }, file: File { dist_info_metadata: Some(Hashes(Hashes { md5: None, sha256: Some(&quot;6ce7f9d063dc08ad3338ff2708359238004dc021225fad944210d45a734e6b15&quot;) })), filename: &quot;typing_extensions-4.10.0-py3-none-any.whl&quot;, hashes: Hashes { md5: None, sha256: Some(&quot;69b1a937c3a517342112fb4c6df7e72fc39a38e7891a5730ed4985b5214b5475&quot;) }, requires_python: Some(VersionSpecifiers([VersionSpecifier { operator: GreaterThanEqual, version: &quot;3.8&quot; }])), size: Some(33926), upload_time_utc_ms: Some(1708899167720), url: AbsoluteUrl(&quot;https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl&quot;), yanked: Some(Bool(false)) }, index: Pypi(VerbatimUrl { url: Url { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }) }))
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.http
   uv_installer::downloader::get_wheel name=mypy-extensions==1.0.0, size=Some(4695), url=&quot;https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl&quot;
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.http&quot;
     uv_distribution::distribution_database::get_or_build_wheel dist=Built(Registry(RegistryBuiltDist { filename: WheelFilename { name: PackageName(&quot;mypy-extensions&quot;), version: &quot;1.0.0&quot;, python_tag: [&quot;py3&quot;], abi_tag: [&quot;none&quot;], platform_tag: [&quot;any&quot;] }, file: File { dist_info_metadata: Some(Hashes(Hashes { md5: None, sha256: Some(&quot;617d60dffb00826a22f5662114d8111d02fa29ffb1ec67e39d6814084ef75486&quot;) })), filename: &quot;mypy_extensions-1.0.0-py3-none-any.whl&quot;, hashes: Hashes { md5: None, sha256: Some(&quot;4392f6c0eb8a5668a69e23d168ffa70f0be9ccfd32b5cc2d26a34ae5b844552d&quot;) }, requires_python: Some(VersionSpecifiers([VersionSpecifier { operator: GreaterThanEqual, version: &quot;3.5&quot; }])), size: Some(4695), upload_time_utc_ms: Some(1675512685002), url: AbsoluteUrl(&quot;https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl&quot;), yanked: Some(Bool(false)) }, index: Pypi(VerbatimUrl { url: Url { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;pypi.org&quot;)), port: None, path: &quot;/simple&quot;, query: None, fragment: None }, given: None }) }))
       uv_client::cached_client::get_serde 
         uv_client::cached_client::get_cacheable 
           uv_client::cached_client::read_and_parse_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.http
 uv_client::cached_client::from_path_sync path=&quot;/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.http&quot;
              0.461380s   0ms DEBUG uv_client::cached_client No cache entry for: https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl
           uv_client::cached_client::fresh_request url=&quot;https://files.pythonhosted.org/packages/6e/96/40f0f605b1d4e2ad1fb11d21988ce3a3e205886c0fcbd35c9789a214de9a/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.whl&quot;
              0.461415s   0ms DEBUG uv_client::cached_client No cache entry for: https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl
           uv_client::cached_client::fresh_request url=&quot;https://files.pythonhosted.org/packages/f9/de/dc04a3ea60b22624b51c703a84bbe0184abcd1d0b9bc8074b5d6b7ab90bb/typing_extensions-4.10.0-py3-none-any.whl&quot;
              0.461441s   0ms DEBUG uv_client::cached_client No cache entry for: https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl
           uv_client::cached_client::fresh_request url=&quot;https://files.pythonhosted.org/packages/2a/e2/5d3f6ada4297caebe1a2add3b126fe800c96f56dbe5d1988a2cbe0b267aa/mypy_extensions-1.0.0-py3-none-any.whl&quot;
           uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy-extensions/mypy_extensions-1.0.0-py3-none-any.http
           uv_distribution::distribution_database::download wheel=mypy-extensions==1.0.0
           uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/typing-extensions/typing_extensions-4.10.0-py3-none-any.http
           uv_distribution::distribution_database::download wheel=typing-extensions==4.10.0
           uv_client::cached_client::new_cache file=/private/var/folders/0y/wt5dx2vj6t16wq97pglrkynm0000gp/T/.tmpwZtuWS/wheels-v0/pypi/mypy/mypy-1.9.0-cp312-cp312-macosx_10_9_x86_64.http
           uv_distribution::distribution_database::download wheel=mypy==1.9.0
Downloaded 3 packages in 859ms
 uv_installer::installer::install num_wheels=3
Installed 3 packages in 32ms
 + mypy==1.9.0
 + mypy-extensions==1.0.0
 + typing-extensions==4.10.0
(.venv) ~/tmp/uvrepro λ python -m mypy --version                                                        
/Users/shantanu/tmp/uvrepro/.venv/bin/python: Error while finding module specification for 'mypy.__main__' (ImportError: dlopen(/Users/shantanu/tmp/uvrepro/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so, 0x0002): tried: '/Users/shantanu/tmp/uvrepro/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64')), '/System/Volumes/Preboot/Cryptexes/OS/Users/shantanu/tmp/uvrepro/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so' (no such file), '/Users/shantanu/tmp/uvrepro/.venv/lib/python3.12/site-packages/mypy/__init__.cpython-312-darwin.so' (mach-o file, but is an incompatible architecture (have 'x86_64', need 'arm64')))
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 20:46</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 20:48</div>
            <div class="timeline-body"><p>Let me know if you still can't reproduce and I can try to share how to reproduce my Python build. I believe it's a genuine arm64 build not one of those confusing universal builds</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 21:17</div>
            <div class="timeline-body"><p>The only remaining thing I can think of is, what's your macOS version? Like in &quot;About this Mac&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 21:19</div>
            <div class="timeline-body"><img width="392" alt="Screenshot 2024-03-10 at 2 19 34 PM" src="https://github.com/astral-sh/uv/assets/12621235/e951b171-4229-4e08-af3e-f03f18c05a1c">

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 21:20</div>
            <div class="timeline-body"><p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 21:23</div>
            <div class="timeline-body"><p>Is there a chance... that you have https://files.pythonhosted.org/packages/24/33/467582ded32ac0a14af005337e341cd55b066a2a96785e851e1df7bf1eb2/uv-0.1.17-py3-none-macosx_10_12_x86_64.whl installed? Like the x86 <em>wheel</em>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 21:24</div>
            <div class="timeline-body"><p>That's the only way <em>I</em> can reproduce, by downloading and running that wheel -- then it starts serving me x86 wheels, I think because some data is compiled into the wheel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-03-10 21:24</div>
            <div class="timeline-body"><p>Oh great hypothesis, that might be the case. I think I got uv through pipx and my pipx Python might be x86_64...</p>
<pre><code>~/tmp λ which uv
/Users/shantanu/.local/bin/uv
~/tmp λ file /Users/shantanu/.local/bin/uv
/Users/shantanu/.local/bin/uv: Mach-O 64-bit executable x86_64
~/tmp λ file /Users/shantanu/.pyenv/versions/3.12.2/bin/python
/Users/shantanu/.pyenv/versions/3.12.2/bin/python: Mach-O 64-bit executable arm64
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-10 21:25</div>
            <div class="timeline-body"><p>I think it's incorrect that we're doing this, but I need to look into it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-11 02:03</div>
            <div class="timeline-body"><p>\cc @konstin</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-11 07:31</div>
            <div class="timeline-body"><p>We should use the python arch over the uv arch. As a bonus, this makes uv a &quot;cross-installer&quot; for cross compiling use cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "uv handling of architecture on macOS isn't correct" to "uv should use arch of python, not of uv" by @konstin on 2024-03-11 07:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-03-11 07:56</div>
            <div class="timeline-body"><p>Reproduction instructions on ubuntu:</p>
<pre><code class="language-bash">sudo apt install qemu-user qemu-user-static gcc-aarch64-linux-gnu binutils-aarch64-linux-gnu binutils-aarch64-linux-gnu-dbg build-essential
wget &quot;https://files.pythonhosted.org/packages/9c/e6/407a4256f2433ab54907b514434623340a5bf79a277486143af3d1ecb29f/uv-0.1.17-py3-none-musllinux_1_2_aarch64.whl&quot;
unzip -j uv-0.1.17-py3-none-musllinux_1_2_aarch64.whl &quot;uv-0.1.17.data/scripts/uv&quot; -d . # ./uv: ELF 64-bit LSB executable, ARM aarch64, version 1 (SYSV), statically linked, stripped
./uv venv # Or any uv
./uv pip install numpy
.venv/bin/python -c &quot;import numpy&quot;
</code></pre>
<p>The numpy import fails because we installed the aarch64 wheel</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> removed by @konstin on 2024-03-11 07:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @konstin on 2024-03-11 07:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @konstin by @charliermarsh on 2024-03-11 13:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @charliermarsh by @charliermarsh on 2024-03-11 13:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2380.html">astral-sh/uv#2380</a> on 2024-03-12 09:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/2381.html">astral-sh/uv#2381</a> on 2024-03-12 12:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-13 11:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/2637.html">astral-sh/uv#2637</a> on 2024-03-24 03:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13378.html">astral-sh/uv#13378</a> on 2025-05-10 12:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:25 UTC
    </footer>
</body>
</html>
