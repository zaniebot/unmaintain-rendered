<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`Did you mean [...]?` + `ctr-c` =&gt; `thread 'main2' panicked` - astral-sh/uv #11704</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>Did you mean [...]?</code> + <code>ctr-c</code> =&gt; <code>thread 'main2' panicked</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11704">#11704</a>
        opened by <a href="https://github.com/TApplencourt">@TApplencourt</a>
        on 2025-02-22 02:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TApplencourt">@TApplencourt</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hi,</p>
<p>Nothing major, but  when the prompt ask for <code>are you sure?</code> if  you <code>ctr+c</code>  (I'm too lazy to type <code>n</code>)make the rust panick:</p>
<pre><code>(h2yaml) adowa@pop-os:~/h2yaml$ uv pip install h2yaml pyproject.toml 
? `pyproject.toml` looks like a local metadata file but was passed as a package name. Did you mean `-r pyproject.toml`? [y/n] â€º yesthread 'main2' panicked at crates/uv-requirements/src/sources.rs:115:78:
called `Result::unwrap()` on an `Err` value: Custom { kind: Interrupted, error: &quot;read interrupted&quot; }
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
</code></pre>
<p>Please feel free to close, nothing important,</p>
<p>Thanks a lot for <code>uv</code>!</p>
<p>Regards,
Thomas</p>
<h3>Platform</h3>
<p>Linux 6.9.3-76060903-generic x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.5.27</p>
<h3>Python version</h3>
<p>Python 3.10.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @TApplencourt on 2025-02-22 02:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`Did you mean` + `ctr-c` => `thread 'main2' panicked`" to "`Did you mean [...]?` + `ctr-c` => `thread 'main2' panicked`" by @TApplencourt on 2025-02-22 02:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ericmarkmartin">@ericmarkmartin</a> on 2025-02-22 07:16</div>
            <div class="timeline-body"><p>I think what's going on here is that we call <code>console</code>'s <code>read_key</code> in <code>uv-console</code>'s <code>confirm</code> will, upon receiving Ctrl-C</p>
<ol>
<li>raise SIGINT</li>
<li>return an <code>io::ErrorKind::Interrupted</code> error (this is actually just forwarded from console's read under-the-hood)</li>
</ol>
<p>At the beginning of <code>confirm</code> we register a Ctrl-C handler which calls <code>process::exit</code>, which runs in a background thread. Due to (1), this handler is run, which in turn calls <code>process::exit</code>. This forces the main thread to unwind, and hence the interrupted error gets returned and then <code>unwrap</code>d at crates/uv-requirements/src/sources.rs:115:78 (as given by the error message).</p>
<p>I have a fix that looks like it works, so I'll PR it shortly</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-02-26 10:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:30:04 UTC
    </footer>
</body>
</html>
