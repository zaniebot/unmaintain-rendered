<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Request] Allow defining named indexes in the user-level configuration file - astral-sh/uv #8299</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Request] Allow defining named indexes in the user-level configuration file</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/8299">#8299</a>
        opened by <a href="https://github.com/jonasdeyson">@jonasdeyson</a>
        on 2024-10-17 17:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jonasdeyson">@jonasdeyson</a></div>
            <div class="timeline-body"><p>It would be nice to be able to define named private indexes (including the credentials) in the user-level configuration file, and use them in a project.</p>
<p>Ex:</p>
<p>In the user-level config file (<code>~/.config/uv/uv.toml</code>):</p>
<pre><code class="language-toml">[[index]] 
name = &quot;myindex&quot; 
url = &quot;https://__token__:&lt;token&gt;@&lt;myindex domain&gt;/simple&quot; 
explicit = true
</code></pre>
<p>In a project's <code>pyproject.toml</code> file:</p>
<pre><code class="language-toml">[tool.uv.sources]
mypackage = { index = &quot;myindex&quot; }
</code></pre>
<p>Currently, if I try this it gives the error:</p>
<pre><code class="language-text">error: Failed to generate package metadata for `proj==0.1.0 @ virtual+.`
  Caused by: Failed to parse entry for: `mypackage`
  Caused by: Package `mypackage` references an undeclared index: `myindex`
</code></pre>
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-10-17 18:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-18 12:59</div>
            <div class="timeline-body"><p>I can understand why it would be helpful, but just a note that this was an intentional decision in the implementation -- we didn't want to allow references to global indexes that don't exist within the project and so may not exist on other machines.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lucas-labs">@lucas-labs</a> on 2024-10-23 20:59</div>
            <div class="timeline-body"><p>We're facing a similar situation. We use an internal gitea repository + package index for some of our internal libraries.</p>
<p>If we want to use keyring for credentials, we still need set the username in the url.
Each developer has their own username and password, so we can't commit the <code>pyproject.toml</code> like this:</p>
<pre><code class="language-toml"># pyproject.toml

[tool.uv.sources]
lib1 = { index = &quot;private-repo&quot; }

[[index]]
name = &quot;private-repo&quot;
url = &quot;http://my.own.username@host/api/packages/org/pypi/simple/&quot;
explicit = true
</code></pre>
<p>We ended up creating a shared user with read privileges, but that's suboptimal imo.</p>
<p>Is there a workaround we haven't think of?</p>
<p>Cheers!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-23 23:39</div>
            <div class="timeline-body"><p>@lucas-labs -- You could set <code>UV_INDEX_PRIVATE_REPO_USERNAME=</code> to whatever each user's username is (and omit the credentials from the <code>pyproject.toml</code>. Does that work?</p>
<p>See: https://docs.astral.sh/uv/configuration/indexes/#providing-credentials</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lucas-labs">@lucas-labs</a> on 2024-10-24 14:51</div>
            <div class="timeline-body"><p>@charliermarsh YES! that worked. I don't know how I missed that one! Thanks!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:27:46 UTC
    </footer>
</body>
</html>
