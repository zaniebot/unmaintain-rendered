<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV Fails to install with Docker - astral-sh/uv #3782</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>UV Fails to install with Docker</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/3782">#3782</a>
        opened by <a href="https://github.com/Nneji123">@Nneji123</a>
        on 2024-05-23 00:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Nneji123">@Nneji123</a> on 2024-05-23 00:55</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>I've been using uv with my docker builds for the past few months. I just encountered the following error when trying to install requirements in my container. Here's the error:</p>
<pre><code class="language-bash"> =&gt; ERROR [celery-beat stage-0  8/12] RUN --mount=type=cache,target=/root/.cache/pip /root/.cargo/bin/uv pip install --no-cache -r requirements.txt      0.8s
------
 &gt; [celery-beat stage-0  8/12] RUN --mount=type=cache,target=/root/.cache/pip /root/.cargo/bin/uv pip install --no-cache -r requirements.txt:
0.675 error: No Python interpreters found in virtual environments
</code></pre>
<p>Here's the Dockerfile:</p>
<pre><code class="language-Dockerfile">FROM python:3.8.13-slim-bullseye

WORKDIR /app

# Set environment variables
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

RUN apt-get update &amp;&amp; \
    apt-get install -y --no-install-recommends \
    netcat \
    wget \
    unzip \
    dpkg &amp;&amp; \
    rm -rf /var/lib/apt/lists/*

RUN pip install --upgrade setuptools

ENV VIRTUAL_ENV=/usr/local
ADD --chmod=655 https://astral.sh/uv/install.sh /install.sh
RUN /install.sh &amp;&amp; rm /install.sh

ADD requirements.txt /app/requirements.txt

RUN --mount=type=cache,target=/root/.cache/pip /root/.cargo/bin/uv pip install --no-cache -r requirements.txt # the build fails at this stage

# Copy project files into container
ADD . /app

RUN sed -i &quot;s/raise RuntimeError(\&quot;populate() isn't reentrant\&quot;)/self.app_configs = {}/g&quot; /usr/local/lib/python3.8/site-packages/django/apps/registry.py

# Copy the entrypoint script
COPY entrypoint.sh /app/entrypoint.sh
RUN chmod +x /app/entrypoint.sh

EXPOSE 8000

ENTRYPOINT [&quot;/app/entrypoint.sh&quot;]
</code></pre>
<p>In the Dockerfile I am using the latest version of uv.</p>
<p>How do I go about resolving this issue?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-05-23 00:58</div>
            <div class="timeline-body"><p>Can you try removing <code>ENV VIRTUAL_ENV=/usr/local</code>, and instead passing <code>--system</code> to your <code>uv pip install</code> invocation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-05-23 01:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Nneji123">@Nneji123</a> on 2024-05-23 01:07</div>
            <div class="timeline-body"><p>Thank you very much for the quick response. The suggestion you offered fixed the issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Nneji123 on 2024-05-23 01:07</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-05-23 01:47</div>
            <div class="timeline-body"><p>Thanks for reporting and checking back in! For additional reference, this is a duplicate of https://github.com/astral-sh/uv/issues/3765 which has a bit more discussion.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3787.html">astral-sh/uv#3787</a> on 2024-05-23 12:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:19 UTC
    </footer>
</body>
</html>
