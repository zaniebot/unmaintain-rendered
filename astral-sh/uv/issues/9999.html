<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Request: Ability to Assign Index to Dependency Groups with Priority Management - astral-sh/uv #9999</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Feature Request: Ability to Assign Index to Dependency Groups with Priority Management</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/9999">#9999</a>
        opened by <a href="https://github.com/andy-zmn">@andy-zmn</a>
        on 2024-12-18 14:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/andy-zmn">@andy-zmn</a> on 2024-12-18 14:23</div>
            <div class="timeline-body"><p>Description:
I propose a new feature for uv that allows assigning an index to entire dependency groups in the pyproject.toml file. Additionally, I suggest introducing a priority system to resolve conflicts between individual package index assignments and group-based index assignments.</p>
<p>Currently, there is no way to specify an index for a group of dependencies. Instead, each package's index must be defined individually, which can be cumbersome for projects with large configurations. This proposal addresses that limitation while ensuring predictable behavior through explicit or implicit priority rules.</p>
<p>preliminary parameters:</p>
<pre><code class="language-toml">[dependency-groups]
main-libs = [
    &quot;mysqlclient==2.*&quot;,
    &quot;requests==2.*&quot;,
]

helper-libs = [
    &quot;first-popular-lib-name==1.0.0&quot;,
    &quot;other-popular-lib-name==0.3.0&quot;,
]

[tool.uv]
default-groups = [&quot;main-libs&quot;, &quot;helper-libs&quot;]

[[tool.uv.index]]
name = &quot;local-development&quot;
url = &quot;https://nexus.local/repository/pip-proxy/simple&quot;
default = true

[[tool.uv.index]]
name = &quot;helpers&quot;
url = &quot;https://nexus.local/repository/pip-helpers/simple&quot;
explicit = true
</code></pre>
<p>Current Alternative:
Currently, the index must be specified for each package individually:</p>
<pre><code class="language-toml">[tool.uv.sources]  
first-popular-lib-name = { index = &quot;helpers&quot; }  
other-popular-lib-name = { index = &quot;helpers&quot; }
</code></pre>
<p>Assigning an index to a dependency group
proposed syntax</p>
<pre><code class="language-toml">[tool.uv.sources.groups]  
helper-libs = { index = &quot;helpers&quot;, priority = 2 } 
</code></pre>
<p>Assigning an index to an individual package with priority
proposed syntax</p>
<pre><code class="language-toml">[tool.uv.sources]  
first-popular-lib-name = { index = &quot;local-development&quot;, priority = 1 }  
</code></pre>
<p>Behavior and Priority Rules</p>
<ul>
<li>Default Priority (Implicit): If priority is not specified, the configuration is parsed top to bottom. Earlier definitions take precedence over later ones.</li>
<li>Explicit Priority: A lower priority value indicates a higher precedence.</li>
<li>Tie-Breaking: If two sources or groups have the same priority, the order of their definitions in the file determines precedence.</li>
</ul>
<p>Examples</p>
<ol>
<li>Explicit Priority Resolution</li>
</ol>
<pre><code class="language-toml">[dependency-groups]  
helper-libs = [  
    &quot;first-popular-lib-name==1.0.0&quot;,  
    &quot;other-popular-lib-name==0.3.0&quot;,
]  

[tool.uv.sources]  
first-popular-lib-name = { index = &quot;local-development&quot;, priority = 1 }  

[tool.uv.sources.groups]  
helper-libs = { index = &quot;helpers&quot;, priority = 2 }  
</code></pre>
<p><code>first-popular-lib-name</code> will use the <code>local-development</code> index, as it has a higher priority (<code>priority = 1</code>) than the group it belongs to (<code>priority = 2</code>).
Other packages in <code>helper-libs</code> will use the <code>helpers</code> index.</p>
<ol start="2">
<li>Default Parsing Order</li>
</ol>
<pre><code class="language-toml">[tool.uv.sources.groups]  
helper-libs = { index = &quot;helpers&quot; }  

[tool.uv.sources]  
first-popular-lib-name = { index = &quot;local-development&quot; }  
</code></pre>
<p>In this case, <code>first-popular-lib-name</code> will use the <code>helpers</code> index because the group assignment appears earlier in the file.</p>
<p>Benefits:</p>
<ul>
<li>Simplified Configuration: Group-level index assignments reduce redundancy in large projects.</li>
<li>Predictable Behavior: Explicit and implicit priority rules provide clarity in conflict resolution.</li>
<li>Backward Compatibility: The feature does not alter the behavior of existing configurations.</li>
</ul>
<p>Edge Cases and Solutions</p>
<ol>
<li><p>Overriding Behavior:
The feature relies on clear rules for resolving conflicts. Both implicit (order-based) and explicit (priority-based) mechanisms ensure flexibility and control.</p>
</li>
<li><p>Documentation and Tooling
Detailed documentation and clear error/warning messages during parsing would help users understand and debug complex configurations.</p>
</li>
</ol>
<p>Thank you for considering this feature!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by @zanieb on 2025-01-06 20:45</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:52 UTC
    </footer>
</body>
</html>
