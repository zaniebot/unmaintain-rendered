```yaml
number: 5835
title: cannot resolve package in arm Mac Docker container when specifying platform
type: issue
state: closed
author: jbcpollak
labels:
  - question
assignees: []
created_at: 2024-08-06T21:43:47Z
updated_at: 2024-08-07T03:03:09Z
url: https://github.com/astral-sh/uv/issues/5835
synced_at: 2026-01-10T01:57:12Z
```

# cannot resolve package in arm Mac Docker container when specifying platform

---

_Issue opened by @jbcpollak on 2024-08-06 21:43_

The below example is with a `uv pip install` but my actual usecase is trying to compile a cross-platform requirements.txt  file using `uv pip compile` and a custom python script (from https://github.com/astral-sh/uv/issues/2679#issuecomment-2068208602) which runs the same compile three times, once for each platform, then normalizes them into a single file.

Anyway, here is what I am experiencing:

M3 Macbook Pro
Python 3.11
UV 0.2.33

I am running a Linux devcontainer in Docker Desktop. At the command line I get this output when I ask Linux about its platform:

```
vscode ➜ /workspaces/firefly/vision (feat/tach-detection) $ uname -a
Linux de575a211720 6.10.0-linuxkit #1 SMP Wed Jul 17 10:51:09 UTC 2024 aarch64 GNU/Linux
vscode ➜ /workspaces/firefly/vision (feat/tach-detection) $ uname -m
aarch64
vscode ➜ /workspaces/firefly/vision (feat/tach-detection) $ uname -p
unknown
```

If I specify the `--python-platform` I get this:

```
vscode ➜ /workspaces/firefly/vision (feat/tach-detection) $ uv pip install open3d==0.18.0 --python-platform linux
  × No solution found when resolving dependencies:
  ╰─▶ Because open3d==0.18.0 has no wheels with a matching Python ABI tag and you require open3d==0.18.0, we can conclude that the requirements are unsatisfiable.
```

But if I don't specify the platform the install works ok:

```
vscode ➜ /workspaces/firefly/vision (feat/tach-detection) $ uv pip install open3d==0.18.0
Resolved 39 packages in 11ms
░░░░░░░░░░░░░░░░░░░░ [0/39] Installing wheels...                                                                                                                                                                                                                     warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance. If this is intentional, use `--link-mode=copy` to suppress this warning.

hint: If the cache and target directories are on different filesystems, hardlinking may not be supported.
Installed 39 packages in 4.21s
 + attrs==24.2.0
 + blinker==1.8.2
 + certifi==2024.7.4
 + charset-normalizer==3.3.2
 + click==8.1.7
 + configargparse==1.7
 + dash==2.17.1
 + dash-core-components==2.0.0
 + dash-html-components==2.0.0
 + dash-table==5.0.0
 + fastjsonschema==2.20.0
 + flask==3.0.3
 + idna==3.7
 + importlib-metadata==8.2.0
 + itsdangerous==2.2.0
 + jinja2==3.1.4
 + jsonschema==4.23.0
 + jsonschema-specifications==2023.12.1
 + jupyter-core==5.7.2
 + markupsafe==2.1.5
 + nbformat==5.10.4
 + nest-asyncio==1.6.0
 + numpy==2.0.1
 + open3d==0.18.0
 + packaging==24.1
 + platformdirs==4.2.2
 + plotly==5.23.0
 + referencing==0.35.1
 + requests==2.32.3
 + retrying==1.3.4
 + rpds-py==0.20.0
 + setuptools==72.1.0
 + six==1.16.0
 + tenacity==9.0.0
 + traitlets==5.14.3
 + typing-extensions==4.12.2
 + urllib3==2.2.2
 + werkzeug==3.0.3
 + zipp==3.19.2
```

Maybe I'm missing something, but I would expect the behavior to be the same regardless of the command-line switch since I'm running in a Linux container on Docker.

---

_Comment by @charliermarsh on 2024-08-06 21:46_

Can you try `--python-platform x86_64-manylinux_2_28` instead?

---

_Comment by @charliermarsh on 2024-08-06 21:47_

If you check https://pypi.org/project/open3d/#files, the oldest manylinux version they support is `manylinux_2_27`. By default we try to solve for `manylinux_2_17`, so you just need to bump your "minimum-supported manylinux version".

---

_Comment by @charliermarsh on 2024-08-06 23:06_

I've confirmed that this resolves: `uv pip install open3d==0.18.0 --python-platform x86_64-manylinux_2_28 --python-version 3.11`

---

_Closed by @charliermarsh on 2024-08-06 23:06_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-08-06 23:06_

---

_Label `question` added by @charliermarsh on 2024-08-06 23:06_

---

_Comment by @jbcpollak on 2024-08-07 00:39_

Thanks for this diagnosis.

For my understanding, what is the difference between specifying the platform as just "linux" vs one of the manylinux options?

And why does this work correctly when I don't specify a platform at all? That's the most unexpected thing to me since without specifying a platform it's already on "linux"

---

_Comment by @charliermarsh on 2024-08-07 00:47_

Totally, happy to explain. For background (and apologies if you're already familiar), manylinux tries to capture the version of glibc installed on a given Linux machine, so `x86_64-manylinux_2_28` is saying that you need at least glibc 2.28.

If you run with just `linux`, that's an alias for `x86_64-manylinux_2_17`. `linux` alone is under-specified, so we have to pick some default, and we decided to use `x86_64-manylinux_2_17` as the default. So, if you pass `linux`, you're requiring that all the things you depend on support glibc 2.17 and later.

(If you run with `x86_64-manylinux_2_28`, you're raising that requirement, i.e., being more relaxed about the versions of glibc that you care about supporting.)

If you omit `--python-platform` at all, then we detect your _current_ Python platform and use that. My guess is that your machine has a version of glibc that's newer than 2.17, so it's inferring that it's fine for your dependencies to all require newer glibc versions too.


---

_Comment by @jbcpollak on 2024-08-07 02:54_

got it, that's very helpful, thanks. 

Is there a way to infer what the current Python platform will be when `--python-platform` is omitted?

This may end up being moot since `--universal` may solve my use-case with less complexity, but it sounds like I want to replace `linux` with `x86_64-manylinux_2_28` (or `aarch64...` in my case).

---

_Comment by @charliermarsh on 2024-08-07 03:03_

If you run `ldd --version`:

```
root@2010ac4b3c01:/# ldd --version
ldd (Ubuntu GLIBC 2.39-0ubuntu8.2) 2.39
```

That'll tell you the glibc version. And then you would round down -- we only support a few cutoffs:

- `x86_64-manylinux_2_17`
- `x86_64-manylinux_2_28`
- `x86_64-manylinux_2_31`

I'd recommend just using `x86_64-manylinux_2_28` though. It's a common cutoff. Anything that works on `x86_64-manylinux_2_28` should also work on a machine with glibc 2.2.8 or later.


---
