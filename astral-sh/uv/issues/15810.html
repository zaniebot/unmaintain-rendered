<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv lock --dry-run` reports &quot;No lockfile changes&quot; to VCS-sourced packages - astral-sh/uv #15810</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv lock --dry-run</code> reports &quot;No lockfile changes&quot; to VCS-sourced packages</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15810">#15810</a>
        opened by <a href="https://github.com/tehunter">@tehunter</a>
        on 2025-09-12 13:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/tehunter">@tehunter</a></div>
            <div class="timeline-body">Summary
Summary
<p>When using VCS-based dependency specifications, <code>uv lock --dry-run -P [package]</code> reports a misleading &quot;No lockfile changes detected&quot; while <code>uv lock -P [package]</code> does change the lockfile to reference the latest commit hash.</p>
Details
<p>I have a project dependency which is a git-based package, e.g.:</p>
<pre><code>[project]
dependencies = [
    &quot;mypackage @ git+https://github.com/username/mypackage&quot;
]
</code></pre>
<p>The lock file is currently locked to a old commit, e.g.:</p>
<pre><code>[[package]]
name = &quot;mypackage&quot;
version = &quot;0.0.1&quot;
source = { git = &quot;https://github.com/username/mypackage#123456&quot; }
</code></pre>
<p>I want to run <code>uv lock --dry-run -P mypackage</code> to verify that it will pull in the latest commit. When I do, I receive the following output:</p>
<pre><code>uv lock --dry-run -P mypackage
    Updated https://github.com/username/mypackage (abcdef...)
Resolved X packages in Ys
No lockfile changes detected
</code></pre>
<p>However, when I run without <code>--dry-run</code>, the lock file does in fact update and reference the new commit.</p>
<p>It should be noted that I haven&#x27;t done anything to change the version of &quot;mypackage&quot; between these two commits. However, I would expect that VCS-based dependencies are locked based on a commit hash rather than version number.</p>
<p>The message that &quot;No lockfile changes detected&quot; is misleading here. I would interpret that to mean the lock file would not change at all with a regular run.</p>
Expected Output
<pre><code>$ uv lock --dry-run -P mypackage
    Updated https://github.com/username/mypackage (abcdef...)
Resolved X packages in Ys
Update mypackage v0.0.1 (123456) -&gt; v0.0.1 (abcdef)
</code></pre>
Platform
<p>Windows 11 x64</p>
Version
<p>uv 0.8.17 (10960bc13 2025-09-10)</p>
Python version
<p>Python 3.12.7</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/tehunter">@tehunter</a> on 2025-09-12 13:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-09-12 15:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-09-12 16:20</div>
            <div class="timeline-body"><p>I think this is because the <code>--dry-run</code> changelog only logs based on package version (and the actual package version didn&#x27;t change). We can add a commit SHA to it, I think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-09-12 17:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:40:21 UTC
    </footer>
</body>
</html>
