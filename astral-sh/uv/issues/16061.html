<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv installs abi3 packages for versions outside of what is specified in requires-python - astral-sh/uv #16061</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv installs abi3 packages for versions outside of what is specified in requires-python</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16061">#16061</a>
        opened by <a href="https://github.com/IljaManakov">@IljaManakov</a>
        on 2025-09-29 07:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/IljaManakov">@IljaManakov</a></div>
            <div class="timeline-body">Summary
<p>I was recently dealing with a segfault when working PySide6, when I noticed that uv had installed the package for an my 3.12 interpreter despite the require-python listing  &quot;&lt;3.12, &gt;3.7&quot;.
In the end this also was the source of the segfault. Switching to a 3.11 interpreter worked just fine.</p>
<p>Steps to reproduce:</p>
<ol>
<li>Create a new venv with Python 3.12</li>
<li>Install &quot;PySide6==6.4.2&quot;</li>
<li><code>cat ${VIRTUAL_ENV}/lib/python3.12/site-packages/PySide6-6.4.2.dist-info/METADATA</code> shows &quot;Requires-Python: &lt;3.12,&gt;=3.7&quot;</li>
<li><code>import PySide6</code> -&gt; KABOOM</li>
</ol>
<p>For comparison, doing the same process with <code>pip</code>, it will not allow the package to be installed, correctly stating the supported versions:</p>
<pre><code>ERROR: Ignored the following versions that require a different python version: 6.0.0 Requires-Python &gt;=3.6, &lt;3.10; 6.0.0a1.dev1606911628 Requires-Python &gt;=3.6, &lt;3.10; 6.0.1 Requires-Python &gt;=3.6, &lt;3.10; 6.0.2 Requires-Python &gt;=3.6, &lt;3.10; 6.0.3 Requires-Python &gt;=3.6, &lt;3.10; 6.0.4 Requires-Python &gt;=3.6, &lt;3.10; 6.1.0 Requires-Python &gt;=3.6, &lt;3.10; 6.1.1 Requires-Python &gt;=3.6, &lt;3.10; 6.1.2 Requires-Python &gt;=3.6, &lt;3.10; 6.1.3 Requires-Python &gt;=3.6, &lt;3.10; 6.2.0 Requires-Python &gt;=3.6, &lt;3.11; 6.2.1 Requires-Python &gt;=3.6, &lt;3.11; 6.2.2 Requires-Python &gt;=3.6, &lt;3.11; 6.2.2.1 Requires-Python &gt;=3.6, &lt;3.11; 6.2.3 Requires-Python &gt;=3.6, &lt;3.11; 6.2.4 Requires-Python &gt;=3.6, &lt;3.11; 6.3.0 Requires-Python &lt;3.11,&gt;=3.6; 6.3.1 Requires-Python &lt;3.11,&gt;=3.6; 6.3.2 Requires-Python &lt;3.11,&gt;=3.6; 6.4.0.1 Requires-Python &lt;3.12,&gt;=3.7; 6.4.1 Requires-Python &lt;3.12,&gt;=3.7; 6.4.2 Requires-Python &lt;3.12,&gt;=3.7; 6.4.3 Requires-Python &lt;3.12,&gt;=3.7; 6.5.0 Requires-Python &lt;3.12,&gt;=3.7; 6.5.1 Requires-Python &lt;3.12,&gt;=3.7; 6.5.1.1 Requires-Python &lt;3.12,&gt;=3.7; 6.5.2 Requires-Python &lt;3.12,&gt;=3.7; 6.5.3 Requires-Python &lt;3.12,&gt;=3.7                                                                                                                                  
ERROR: Could not find a version that satisfies the requirement PySide6==6.4.2 (from versions: 6.6.0, 6.6.1, 6.6.2, 6.6.3, 6.6.3.1, 6.7.0, 6.7.1, 6.7.2, 6.7.3, 6.8.0, 6.8.0.1, 6.8.0.2, 6.8.1, 6.8.1.1, 6.8.2, 6.8.2.1, 6.8.3, 6.9.0, 6.9.1, 6.9.2)                                                                                                           
ERROR: No matching distribution found for PySide6==6.4.2 
</code></pre>
<p>Although a different issue than <a href="https://github.com/astral-sh/uv/issues/16012">#16012</a>, it might be related.</p>
Platform
<p>Ubuntu 24.04</p>
Version
<p>uv 0.8.5</p>
Python version
<p>Python 3.12.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/IljaManakov">@IljaManakov</a> on 2025-09-29 07:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-09-29 09:53</div>
            <div class="timeline-body"><p>Please see <a href="https://github.com/astral-sh/uv/pull/15927">astral-sh/uv#15927</a> on why we ignore upper bounds on <code>requires-python</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-09-29 09:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-09-29 09:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-30 00:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/IljaManakov">@IljaManakov</a> on 2025-10-02 11:36</div>
            <div class="timeline-body"><p>So do I understand correctly that there is no intention to fix this for packages with binary extenstion, even though it creates a situation where you segfault on package import?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-06 10:15</div>
            <div class="timeline-body"><p>For this package specifically, it is tagged as <code>cp39-abi3-&lt;platform&gt;</code>, which means that it is only using abi3 interface and thereby  forward compatible with all Python 3.x versions, the package must be using other APIs too, otherwise it would not crash, i.e. the package is tagged incorrectly. For the general discussion, please see <a href="https://github.com/astral-sh/uv/pull/15927">astral-sh/uv#15927</a> and the linked threads for extensive discussion of the trade-offs and why <code>requires-python</code> can&#x27;t be properly used as upper bound as it stand, and what the alternatives are. This is usually only a problem with source distributions, which can use build time checks, a wheel crash as we see here only happens when misusing abi3.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:40:30 UTC
    </footer>
</body>
</html>
