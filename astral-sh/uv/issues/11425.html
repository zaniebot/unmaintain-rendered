<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reject `git+file` paths in requirement definitions - astral-sh/uv #11425</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Reject `git+file` paths in requirement definitions</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/11425">#11425</a>
        opened by <a href="https://github.com/T-256">@T-256</a>
        on 2025-02-11 17:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/T-256">@T-256</a> on 2025-02-11 17:40</div>
            <div class="timeline-body"><h3>Summary</h3>
<ul>
<li><code>uv add C:\path\to\repo</code></li>
</ul>
<pre><code>[tool.uv.sources]
repo = { path = &quot;../../../to/repo&quot; }
</code></pre>
<ul>
<li><code>uv add git+C:\path\to\repo --rev xxxxx</code></li>
</ul>
<pre><code>[tool.uv.sources]
repo = { git = 'c:\path\to\repo', rev = &quot;xxxxx&quot; }
</code></pre>
<h3>Platform</h3>
<p>Win11 24H2</p>
<h3>Version</h3>
<p>0.5.30</p>
<h3>Python version</h3>
<p>3.7</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @T-256 on 2025-02-11 17:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 17:46</div>
            <div class="timeline-body"><p>We don't support &quot;local&quot; Git dependencies like this. Does that even work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2025-02-11 17:54</div>
            <div class="timeline-body"><p>Yes, I can verify it works well...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2025-02-11 17:59</div>
            <div class="timeline-body"><p>When I try to explicitly pass &quot;relative&quot; path:</p>
<pre><code class="language-sh">&gt;uv add --dev git+file:///..\..\..\to\repo --rev xxxxxxx

   Updating file:///to/repo (ad575d7b7d4176fbc6017cf0fb6560eda0ea2480)
error: Git operation failed
  Caused by: failed to clone into: C:\Users\User\AppData\Local\uv\cache\git-v0\db\5332d8279ede0cc1
  Caused by: failed to fetch branch, tag, or commit `xxxxxxx`
  Caused by: process didn't exit successfully: `C:\Program Files\Git\cmd\git.exe fetch --tags --force --update-head-ok file:///to/repo +refs/heads/*:refs/remotes/origin/* +HEAD:refs/remotes/origin/HEAD` (exit code: 128)
--- stderr
fatal: 'C:/Program Files/Git/to/repo' does not appear to be a git repository
fatal: Could not read from remote repository.

Please make sure you have the correct access rights and the repository exists.
</code></pre>
<p>it seems relative paths resolves to <code>git.exe</code> executable path.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 18:25</div>
            <div class="timeline-body"><p>Hmm, we should may need to explicitly reject <code>git+file</code> (I thought we did?), I don't think it's supported, e.g.: https://github.com/astral-sh/uv/issues/3121</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 18:25</div>
            <div class="timeline-body"><p>We could add support, but that would be a different issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/T-256">@T-256</a> on 2025-02-11 18:53</div>
            <div class="timeline-body"><blockquote>
<p>(I thought we did?)</p>
</blockquote>
<p>see c22c7cad4c3e9b6464173df51fc154df6e88a156 which removed rejection.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-02-13 01:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Exposed absolute path when add local repository" to "Reject `git+file` paths in requirement definitions" by @charliermarsh on 2025-02-13 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-02-13 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @charliermarsh on 2025-02-13 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @charliermarsh by @charliermarsh on 2025-02-13 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11514.html">astral-sh/uv#11514</a> on 2025-02-14 16:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-02-18 20:08</div>
            <div class="timeline-body"><p>We should handle this through #11514 now. It's not exactly as described above, as we still require <code>git</code> to be a URL. That means <code>git = 'c:\path\to\repo'</code> gets rejected (with the error that <code>c:</code> is not a supported protocol - not ideal but we hint towards <code>file:</code>), but you can instead use the <code>file://</code> protocol with an absolute path. This does however not include relative file support.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nickolay">@nickolay</a> on 2025-04-04 14:17</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/uv/pull/11514 was merged, keeping git <code>file://</code> support (but only absolute), so this should probably be renamed back to be about relative paths support in git dependencies.</p>
<p>My use-case for this is low-friction way to deploy scripts along with a versioned (private) library: I'm deploying the scripts via <code>git pull</code> and if I were able to specify the library version via <code>rev</code> in the same clone:</p>
<pre><code># [tool.uv.sources]
# commonlib = { git = &quot;file://../..&quot;, subdirectory=&quot;libs/commonlib&quot;, rev = &quot;526451a&quot; }
</code></pre>
<p>...I wouldn't need any additional deployment steps when making changes to the common code. <code>uv run --script</code> would magically pick up the correct version.</p>
<p>Currently I either have to build and put the wheel alongside the repo (or commit it to git), or rely on relative source <code>path</code>s meaning all scripts must always be compatible with the latest version of the library.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:02 UTC
    </footer>
</body>
</html>
