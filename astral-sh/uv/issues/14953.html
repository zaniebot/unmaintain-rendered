<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>specify python version on uv export command output - astral-sh/uv #14953</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>specify python version on uv export command output</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/14953">#14953</a>
        opened by <a href="https://github.com/Vitalii-Kh95">@Vitalii-Kh95</a>
        on 2025-07-29 13:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Vitalii-Kh95">@Vitalii-Kh95</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p>Sorry if the question is noob. But can I specify python version in requirements.txt. file? Scenario is next: I want to <strong>not</strong> include uv.lock in my git repo and use requirements.txt instead, so that I shouldn't have install uv on deploying. Shouldn't I enforce python version constraint then? I used poetry before transitioning to uv and with poetry I got exported requirements.txt file looking like this:</p>
<pre><code>asgiref==3.8.1 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
django-cors-headers==4.7.0 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
django-taggit==6.1.0 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
django==5.2.1 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
djangorestframework==3.16.0 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
gunicorn==23.0.0 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
packaging==25.0 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
pillow==11.2.1 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
sqlparse==0.5.3 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot;
tzdata==2025.2 ; python_version &gt;= &quot;3.12&quot; and python_version &lt; &quot;4.0&quot; and sys_platform == &quot;win32&quot;
</code></pre>
<p>Now I think it's reasonable I should be able to do the same with uv export but it seems it's impossible or I miss something.</p>
<h3>Platform</h3>
<p><em>No response</em></p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @Vitalii-Kh95 on 2025-07-29 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-29 16:26</div>
            <div class="timeline-body"><p>We should export the file with markers for the Python version. I don't know what the question is?</p>
<pre><code>❯ uv init example
Initialized project `example` at ...
❯ cd example
❯ uv add &quot;anyio; python_version &lt; '3.14'&quot;
Using CPython 3.13.2
Creating virtual environment at: .venv
Resolved 4 packages in 88ms
Prepared 3 packages in 99ms
Installed 3 packages in 4ms
 + anyio==4.9.0
 + idna==3.10
 + sniffio==1.3.1
❯ uv export
Resolved 4 packages in 0.98ms
# This file was autogenerated by uv via the following command:
#    uv export
anyio==4.9.0 ; python_full_version &lt; '3.14' \
    --hash=sha256:673c0c244e15788651a4ff38710fea9675823028a6f08a5eda409e0c9840a028 \
    --hash=sha256:9f76d541cad6e36af7beb62e978876f3b41e3e04f2c1fbf0884604c0a9c4d93c
    # via example
idna==3.10 ; python_full_version &lt; '3.14' \
    --hash=sha256:12f65c9b470abda6dc35cf8e63cc574b1c52b11df2c86030af0ac09b01b13ea9 \
    --hash=sha256:946d195a0d259cbba61165e88e65941f16e9b36ea6ddb97f00452bae8b1287d3
    # via anyio
sniffio==1.3.1 ; python_full_version &lt; '3.14' \
    --hash=sha256:2f6da418d1f1e0fddd844478f41680e794e6051915791a034ff65e5f100525a2 \
    --hash=sha256:f4324edc670a0f49750a81b895f35c3adb843cca46f0530f79fc1babb23789dc
    # via anyio

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Vitalii-Kh95">@Vitalii-Kh95</a> on 2025-07-30 05:16</div>
            <div class="timeline-body"><p>Honestly, I don't know what you talking about either:</p>
<pre><code>$ uv export --no-hashes --no-dev
Resolved 52 packages in 2ms
# This file was autogenerated by uv via the following command:
#    uv export --no-hashes --no-dev
asgiref==3.9.1
    # via
    #   django
    #   django-cors-headers
django==5.2.4
    # via
    #   django-cors-headers
    #   django-taggit
    #   djangorestframework
    #   portfolio
django-cors-headers==4.7.0
    # via portfolio
django-taggit==6.1.0
    # via portfolio
djangorestframework==3.16.0
    # via portfolio
gunicorn==23.0.0
    # via portfolio
packaging==25.0
    # via gunicorn
pillow==11.3.0
    # via portfolio
sqlparse==0.5.3
    # via django
tzdata==2025.2 ; sys_platform == 'win32'
    # via django
</code></pre>
<p>Wild guess. It depends on how packages are added?. I don't think I need to specify python version when I use uv add, to get python constraint in uv export, that is, it doesn't make sense to me. Shouldn't it be resolved automatically?
Btw I though didn't use uv add at all. I migrated to uv using https://github.com/mkniewallner/migrate-to-uv I think. But I can say for sure I got python resolved for me when I used poetry's export command, that's probably why I expected the same behavior with uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-30 12:00</div>
            <div class="timeline-body"><p>Why don't you share your <code>pyproject.toml</code>?</p>
<p>I don't think we propagate your <code>requires-python</code> range to each requirement in the <code>requirements.txt</code>, if that's what you're asking about? We propagate Python versions markers when they matter for a single dependency, but don't apply a blanket marker to all of them?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Vitalii-Kh95">@Vitalii-Kh95</a> on 2025-07-30 15:36</div>
            <div class="timeline-body"><p>Sorry I didn't provide it before. I am not well familiar with the tool. Here's the pyproject.toml. As you see there's some specification about which python version to use, but it might be a leftover from when pyproject.toml was used by poetry and is currently ignored by uv, right?
<code>pyproject.toml</code></p>
<pre><code>[project]
name = &quot;portfolio&quot;
version = &quot;0.1.0&quot;
description = &quot;&quot;
authors = [{ name = &quot;***&quot;, email = &quot;***&quot; }]
requires-python = &quot;~=3.12&quot;
readme = &quot;README.md&quot;
dependencies = [
    &quot;django&gt;=5,&lt;6&quot;,
    &quot;djangorestframework&quot;,
    &quot;django-cors-headers&quot;,
    &quot;django-taggit&gt;=6.1.0,&lt;7&quot;,
    &quot;pillow&gt;=11.0.0,&lt;12&quot;,
    &quot;gunicorn&gt;=23.0.0,&lt;24&quot;,
]

[dependency-groups]
dev = [
    &quot;faker&gt;=30.8.1,&lt;31&quot;,
    &quot;pytest&gt;=8.3.4,&lt;9&quot;,
    &quot;httpx&gt;=0.28.1,&lt;0.29&quot;,
    &quot;pandas&gt;=2.2.3,&lt;3&quot;,
    &quot;django-extensions&gt;=4.1&quot;,
    &quot;werkzeug&gt;=3.1.3&quot;,
    &quot;pyopenssl&gt;=25.1.0&quot;,
    &quot;ipython&gt;=9.4.0&quot;,
]

[tool.uv]
package = false
default-groups = [
    &quot;dev&quot;,
]

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-30 15:40</div>
            <div class="timeline-body"><p>We will respect the <code>requires-python</code> lower bound, e.g., when we solve we require that packages support Python 3.12. However, we don't emit that in the <code>requirements.txt</code> because you <em>could</em> install those requirements on a different Python version. The <code>requires-python</code> is a property of  the <code>portfolio</code> package, not those child dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Vitalii-Kh95">@Vitalii-Kh95</a> on 2025-07-30 15:56</div>
            <div class="timeline-body"><p>Thank you for your answer. If it's possible, could you give me more thorough explanation, as I am not that experienced developer and I didn't understand your reasoning. You said: &quot;we don't emit that in the requirements.txt because you could install those requirements on a different Python version&quot; but isn't it the purpose to put as much constraints as possible to make sure everything will work correctly on different device? What if my codebase has code incompatible with lesser python version. And it would work as expected on developer device but will not at client. Why the different approach with uv.lock/pyproject and requirements.txt? Don't they serve basically the same purpose?
And also if you have spare time, could you tell me shortly how you'd managed such scenario? I can explain why I decided to stick with requirements.txt on &quot;production&quot;: no need to install additional tools and simplicity.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-30 16:10</div>
            <div class="timeline-body"><p>I'm sorry I don't really have the time to go through all of that, we have too many pressing issues to work on. Briefly...</p>
<p>With those markers emitted by Poetry, if the Python version is not in the range at install time, the install command will succeed, but no packages will be installed. That's not what you want. If those dependencies can't be used with the given Python version, you want the command to fail. That's what happens if the markers are not emitted.</p>
<p>The <code>requirements.txt</code> format has no way to specify the required Python version. You can only <em>omit</em> dependencies depending on the Python version. That's why you shouldn't use it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:32:24 UTC
    </footer>
</body>
</html>
