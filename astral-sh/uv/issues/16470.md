```yaml
number: 16470
title: "RuntimeError: TensorRT currently only builds wheels for Linux and Windows"
type: issue
state: closed
author: mikel-brostrom
labels:
  - question
assignees: []
created_at: 2025-10-27T11:57:20Z
updated_at: 2025-10-28T23:40:38Z
url: https://github.com/astral-sh/uv/issues/16470
synced_at: 2026-01-10T01:57:36Z
```

# RuntimeError: TensorRT currently only builds wheels for Linux and Windows

---

_Issue opened by @mikel-brostrom on 2025-10-27 11:57_

### Question

My project.toml looks like this:

```toml
# =====================================================
# pyproject.toml for BoxMOT ← UV with GPU by default
# =====================================================

#######################
# Alternative Indexes #
#######################

[[tool.uv.index]]
name     = "torch-cpu"
url      = "https://download.pytorch.org/whl/cpu"
explicit = true

[[tool.uv.index]]
name     = "torch-gpu"
url      = "https://download.pytorch.org/whl/cu121"
explicit = true

##################################
# Pin torch/vision to *an* index #
##################################

[tool.uv.sources]
torch = [
  { index = "torch-cpu", marker = "sys_platform == 'darwin'" },
  { index = "torch-gpu", marker = "sys_platform == 'linux' or sys_platform == 'win32'" },
]
torchvision = [
  { index = "torch-cpu", marker = "sys_platform == 'darwin'" },
  { index = "torch-gpu", marker = "sys_platform == 'linux' or sys_platform == 'win32'" },
]

#########################
# UV-specific Overrides #
#########################

# Override yolox's outated dependecies
[[tool.uv.dependency-metadata]]
name          = "yolox"
version       = "0.3.0"
requires-dist = ["onnx>=1.17.0", "onnxsim<1.0.0,>=0.4.36"]

# Ensure yolox builds with setuptools present in the isolated build env
[tool.uv.extra-build-dependencies]
yolox = ["setuptools", "torch<3.0.0,>=2.2.1",]

############
# Flake8   #
############

[tool.flake8]
max-line-length = 120
exclude         = [".tox", "*.egg", "build", "temp"]
select          = ["E", "W", "F"]
doctests        = true
verbose         = 2
format          = "pylint"
ignore          = ["E731", "F405", "E402", "W504", "W605", "E741"]

##############
# Build System #
##############

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

###########
# Project #
###########

[project]
name            = "boxmot"
version         = "15.0.9"
description     = "BoxMOT: pluggable SOTA tracking modules for segmentation, object detection and pose estimation models"
readme          = "README.md"
requires-python = ">=3.9,<=3.13"
license         = { text = "AGPL-3.0" }

authors = [
  { name = "Mikel Broström" },
]

classifiers = [
  "Development Status :: 4 - Beta",
  "Intended Audience :: Developers",
  "Intended Audience :: Education",
  "Intended Audience :: Science/Research",
  "License :: OSI Approved :: GNU Affero General Public License v3 or later (AGPLv3+)",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Topic :: Software Development",
  "Topic :: Scientific/Engineering",
  "Topic :: Scientific/Engineering :: Artificial Intelligence",
  "Topic :: Scientific/Engineering :: Image Recognition",
  "Topic :: Scientific/Engineering :: Image Processing",
]

keywords = [
  "tracking",
  "tracking-by-detection",
  "machine-learning",
  "deep-learning",
  "vision",
  "ML",
  "DL",
  "AI",
  "YOLO",
]

dependencies = [
  # Kalman filters for motion models (SORT/OCSort/HybridSort)
  "filterpy<2.0.0,>=1.4.5",
  # Download pretrained weights/checkpoints from Google Drive
  "gdown<6.0.0,>=5.1.0",
  # Fast LAP/Hungarian solver for data association
  "lapx<1.0.0,>=0.5.5",
  "loguru<1.0.0,>=0.7.2",
  "numpy",
  "regex<2025.0.0,>=2024.0.0",

  "scikit-learn<2.0.0,>=1.3.0",
  "pandas<3.0.0,>=2.0.0",
  "opencv-python<5.0.0,>=4.7.0",

  "torch>=2.2.1,<3.0.0",
  "torchvision>=0.17.1,<1.0.0",
  "click>=8.1.8",

  # clip reid needs
  "ftfy<7.0.0,>=6.1.3",
  "yacs<1.0.0,>=0.1.8",
]

[project.scripts]
boxmot = "boxmot.engine.cli:main"

########################################
# local-only “dev/test/docs/ci” stacks #
########################################

[dependency-groups]
dev  = ["ipykernel>=6.29.5,<7.0.0"]
test = ["pytest>=8.0.2,<9.0.0", "pytest-cov>=6.0.0,<7.0.0", "isort>=5.13.2,<6.0.0"]
docs = [
  "mkdocs>=1.6.1", "mkdocs-click>=0.9.0",
  "mkdocs-include-markdown-plugin>=7.1.6",
  "mkdocs-material>=9.6.15",
  "mkdocstrings>=0.30.0", "mkdocstrings-python>=1.16.12",
]

#############################
# runtime / feature toggles #
#############################

[project.optional-dependencies]
yolo = ["ultralytics>=3.8.200"]

evolve = [
  "ray>=2.35.0,<3.0.0",
  "ray[tune]>=2.35.0,<3.0.0",
  "plotly>=5.19.0,<6.0.0",
  "bayesian-optimization>=2.0.4",
  "optuna"
]

onnx = [
  "onnx>=1.16.1,<1.19",
  "onnxruntime>=1.20.0",
  "onnxslim>=0.1.67"
]

openvino = ["openvino>=2025.2.0"]

tflite = [
  "onnx2tf>=1.18.0",
  "onnx>=1.16.1",
  "tensorflow==2.17.0",
  "tf_keras",
  "sng4onnx>=1.0.1",
  "onnx_graphsurgeon>=0.3.26",
  "onnxslim>=0.1.31",
  "onnxruntime",
  "flatbuffers>=23.5.26",
  "onnxsim==0.4.33",
  "psutil==5.9.5",
  "ml_dtypes==0.3.2",
  "ai_edge_litert>=1.2.0",
]
```

I would like to add this

```toml
tensorrt = [
  "tensorrt>7.0.0 ; (sys_platform == 'linux' or sys_platform == 'win32')"
]
```

under optional-dependencies. But I keep getting:

```
➜  boxmot git:(update-uv-lock) ✗ uv sync
warning: The `extra-build-dependencies` option is experimental and may change without warning. Pass `--preview-features extra-build-dependencies` to disable this warning.
  × Failed to build `tensorrt-cu13==10.13.3.9`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_wheel` failed (exit status: 1)

      [stderr]
      Traceback (most recent call last):
        File "<string>", line 14, in <module>
        File "/Users/mikel.brostrom/.cache/uv/builds-v0/.tmpGsQ0qn/lib/python3.12/site-packages/setuptools/build_meta.py", line 331, in get_requires_for_build_wheel
          return self._get_build_requires(config_settings, requirements=[])
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        File "/Users/mikel.brostrom/.cache/uv/builds-v0/.tmpGsQ0qn/lib/python3.12/site-packages/setuptools/build_meta.py", line 301, in _get_build_requires
          self.run_setup()
        File "/Users/mikel.brostrom/.cache/uv/builds-v0/.tmpGsQ0qn/lib/python3.12/site-packages/setuptools/build_meta.py", line 512, in run_setup
          super().run_setup(setup_script=setup_script)
        File "/Users/mikel.brostrom/.cache/uv/builds-v0/.tmpGsQ0qn/lib/python3.12/site-packages/setuptools/build_meta.py", line 317, in run_setup
          exec(code, locals())
        File "<string>", line 65, in <module>
      RuntimeError: TensorRT currently only builds wheels for Linux and Windows

      hint: This usually indicates a problem with the package or the build environment.
  help: `tensorrt-cu13` (v10.13.3.9) was included because `boxmot[tensorrt]` (v15.0.9) depends on `tensorrt>7.0.0` (v10.13.3.9) which depends on `tensorrt-cu13==10.13.3.9`
```

As you can see "TensorRT currently only builds wheels for Linux and Windows". How can I create a single toml that resolves for all systems given that some builds only exist for certain platforms?

### Platform

macOS Tahoe 26.0.1

### Version

0.9.5 (d5f39331a 2025-10-21)

---

_Label `question` added by @mikel-brostrom on 2025-10-27 11:57_

---

_Comment by @mikel-brostrom on 2025-10-28 18:59_

I have no idea if this is the way UV is mean to be used in this case. Would appreciate any feedback. But this works:

```toml
# =====================================================
# pyproject.toml for BoxMOT ← UV
# =====================================================

#######################
# Alternative Indexes #
#######################

[[tool.uv.index]]
name     = "torch-cpu"
url      = "https://download.pytorch.org/whl/cpu"
explicit = true

[[tool.uv.index]]
name     = "torch-gpu"
url      = "https://download.pytorch.org/whl/cu121"
explicit = true

# NVIDIA packages (TensorRT, etc.) live here
[[tool.uv.index]]
name     = "nvidia"
url      = "https://pypi.nvidia.com"
explicit = true

##################################
# Pin torch/vision to *an* index #
##################################

[tool.uv.sources]
torch = [
  { index = "torch-cpu", marker = "sys_platform == 'darwin'" },
  { index = "torch-gpu", marker = "sys_platform == 'linux' or sys_platform == 'win32'" },
]
torchvision = [
  { index = "torch-cpu", marker = "sys_platform == 'darwin'" },
  { index = "torch-gpu", marker = "sys_platform == 'linux' or sys_platform == 'win32'" },
]

# Route TensorRT packages to NVIDIA’s index (and never on Darwin)
tensorrt = [
  { index = "nvidia", marker = "sys_platform != 'darwin'" },
]
"tensorrt-cu13" = [
  { index = "nvidia", marker = "sys_platform != 'darwin'" },
]
"tensorrt-cu13-libs" = [
  { index = "nvidia", marker = "sys_platform != 'darwin'" },
]

#########################
# UV-specific Overrides #
#########################

# Override yolox's outdated dependencies
[[tool.uv.dependency-metadata]]
name          = "yolox"
version       = "0.3.0"
requires-dist = ["onnx>=1.17.0", "onnxsim<1.0.0,>=0.4.36"]

# Ensure yolox builds with setuptools present in the isolated build env
[tool.uv.extra-build-dependencies]
yolox = ["setuptools", "torch<3.0.0,>=2.2.1"]

# Prevent uv from building TensorRT sdists on macOS during resolution.
[[tool.uv.dependency-metadata]]
name = "tensorrt"
requires-dist = [
  "tensorrt-cu13 ; (sys_platform == 'linux' or sys_platform == 'win32')",
]

[[tool.uv.dependency-metadata]]
name = "tensorrt-cu13"
requires-dist = [
  "tensorrt-cu13-libs==10.13.3.9 ; (sys_platform == 'linux' or sys_platform == 'win32')",
]

# Terminal package; provide empty deps to avoid wheel-stub build on Darwin.
[[tool.uv.dependency-metadata]]
name = "tensorrt-cu13-libs"
requires-dist = []

############
# Flake8   #
############

[tool.flake8]
max-line-length = 120
exclude         = [".tox", "*.egg", "build", "temp"]
select          = ["E", "W", "F"]
doctests        = true
verbose         = 2
format          = "pylint"
ignore          = ["E731", "F405", "E402", "W504", "W605", "E741"]

##############
# Build System #
##############

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

###########
# Project #
###########

[project]
name            = "boxmot"
version         = "15.0.9"
description     = "BoxMOT: pluggable SOTA tracking modules for segmentation, object detection and pose estimation models"
readme          = "README.md"
requires-python = ">=3.9,<=3.13"
license         = { text = "AGPL-3.0" }

authors = [
  { name = "Mikel Broström" },
]

classifiers = [
  "Development Status :: 4 - Beta",
  "Intended Audience :: Developers",
  "Intended Audience :: Education",
  "Intended Audience :: Science/Research",
  "License :: OSI Approved :: GNU Affero General Public License v3 or later (AGPLv3+)",
  "Programming Language :: Python :: 3",
  "Programming Language :: Python :: 3.9",
  "Programming Language :: Python :: 3.10",
  "Programming Language :: Python :: 3.11",
  "Programming Language :: Python :: 3.12",
  "Topic :: Software Development",
  "Topic :: Scientific/Engineering",
  "Topic :: Scientific/Engineering :: Artificial Intelligence",
  "Topic :: Scientific/Engineering :: Image Recognition",
  "Topic :: Scientific/Engineering :: Image Processing",
]

keywords = [
  "tracking",
  "tracking-by-detection",
  "machine-learning",
  "deep-learning",
  "vision",
  "ML",
  "DL",
  "AI",
  "YOLO",
]

dependencies = [
  # Kalman filters for motion models (SORT/OCSort/HybridSort)
  "filterpy<2.0.0,>=1.4.5",
  # Download pretrained weights/checkpoints from Google Drive
  "gdown<6.0.0,>=5.1.0",
  # Fast LAP/Hungarian solver for data association
  "lapx<1.0.0,>=0.5.5",
  "loguru<1.0.0,>=0.7.2",
  "numpy",
  "regex<2025.0.0,>=2024.0.0",

  "scikit-learn<2.0.0,>=1.3.0",
  "pandas<3.0.0,>=2.0.0",
  "opencv-python<5.0.0,>=4.7.0",

  "torch>=2.2.1,<3.0.0",
  "torchvision>=0.17.1,<1.0.0",
  "click>=8.1.8",

  # clip reid needs
  "ftfy<7.0.0,>=6.1.3",
  "yacs<1.0.0,>=0.1.8",
]

[project.scripts]
boxmot = "boxmot.engine.cli:main"

########################################
# local-only “dev/test/docs/ci” stacks #
########################################

[dependency-groups]
dev  = ["ipykernel>=6.29.5,<7.0.0"]
test = ["pytest>=8.0.2,<9.0.0", "pytest-cov>=6.0.0,<7.0.0", "isort>=5.13.2,<6.0.0"]
docs = [
  "mkdocs>=1.6.1", "mkdocs-click>=0.9.0",
  "mkdocs-include-markdown-plugin>=7.1.6",
  "mkdocs-material>=9.6.15",
  "mkdocstrings>=0.30.0", "mkdocstrings-python>=1.16.12",
]

#############################
# runtime / feature toggles #
#############################

[project.optional-dependencies]
yolo = ["ultralytics>=3.8.200"]

evolve = [
  "ray>=2.35.0,<3.0.0",
  "ray[tune]>=2.35.0,<3.0.0",
  "plotly>=5.19.0,<6.0.0",
  "bayesian-optimization>=2.0.4",
  "optuna"
]

onnx = [
  "onnx>=1.16.1,<1.19",
  "onnxruntime>=1.20.0",
  "onnxslim>=0.1.67"
]

openvino = ["openvino>=2025.2.0"]

tflite = [
  "onnx2tf>=1.18.0",
  "onnx>=1.16.1",
  "tensorflow==2.17.0",
  "tf_keras",
  "sng4onnx>=1.0.1",
  "onnx_graphsurgeon>=0.3.26",
  "onnxslim>=0.1.31",
  "onnxruntime",
  "flatbuffers>=23.5.26",
  "onnxsim==0.4.33",
  "psutil==5.9.5",
  "ml_dtypes==0.3.2",
  # Windows lacks wheels — exclude on win32
  "ai_edge_litert>=1.2.0 ; sys_platform != 'win32'",
]

tensorrt = [
  # Only install on Linux/Windows
  "tensorrt>7.0.0 ; (sys_platform == 'linux' or sys_platform == 'win32')",
]

```

---

_Renamed from "Conditional package installation on Windows/Linux and Mac" to "RuntimeError: TensorRT currently only builds wheels for Linux and Windows" by @mikel-brostrom on 2025-10-28 19:00_

---

_Comment by @charliermarsh on 2025-10-28 23:40_

I think you basically have to use `tool.uv.dependency-metadata` right now, unfortunately, because they don't seem to ship static metadata for `tensorrt` nor do they let us query for the metadata on macOS. Sorry about that!

---

_Closed by @charliermarsh on 2025-10-28 23:40_

---
