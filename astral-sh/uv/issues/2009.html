<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use Metadata 2.2+ for source distributions - astral-sh/uv #2009</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use Metadata 2.2+ for source distributions</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2009">#2009</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2024-02-27 10:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/konstin">@konstin</a></div>
            <div class="timeline-body"><p>When a source distribution contains a PKG-INFO file at the top level with <code>Metadata-Version: 2.2</code> or <code>Metadata-Version: 2.3</code> and neither <code>Dynamic: Requires-Dist</code> nor <code>Dynamic: Provides-Extra</code>, we can use the information in PKG-INFO as reliable metadata without calling any PEP 517 hooks or even setting up the build env. While the PEP has been accepted for some time, this is now supported by at pypi (<a href="https://github.com/pypi/warehouse/pull/13606">pypi/warehouse#13606</a>).</p>
<p>After downloading and unpacking[^1], we can read <code>PKG-INFO</code> with the same utils as <code>METADATA</code> and given the preconditions perform no build in <code>uv pip compile</code>. This should provide a significant speedup as more package are published with metadata 2.2+.</p>
<p><a href="https://inspector.pypi.io/project/pyo3-mixed/2.1.5/packages/2b/b8/e04b783d3569d5b61b1dcdfda683ac2e3617340539aecd0f099fbade0b4a/pyo3_mixed-2.1.5.tar.gz/pyo3_mixed-2.1.5/PKG-INFO">pyo3-mixed 2.1.5</a></p>
<p>[^1]: I don&#x27;t think .tar.gz has a central directory we could use for the same remote partial reading trick as for zips, but i can&#x27;t find a good source.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/konstin">@konstin</a> on 2024-02-27 10:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-27 15:05</div>
            <div class="timeline-body"><p>Yes!!!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sbidoul">@sbidoul</a> on 2024-02-27 16:11</div>
            <div class="timeline-body"><p>~Note <code>Version</code> can be dynamic too.~</p>
<p>Update: no sorry, version can be dynamic in <code>pyproject.toml</code> (PEP 621). but not in PKG-INFO 2.2+. PEP 643 says &quot;The fields Name and Version MUST NOT be marked as Dynamic.&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-07 23:01</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-08 01:52</div>
            <div class="timeline-body"><p>I might do this because it looks fun.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-08 02:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-08 16:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:30:02 UTC
    </footer>
</body>
</html>
