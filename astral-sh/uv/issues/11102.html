<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>401 Unauthorized for artifactory repo when running uv pip install - astral-sh/uv #11102</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>401 Unauthorized for artifactory repo when running uv pip install</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11102">#11102</a>
        opened by <a href="https://github.com/edeustace">@edeustace</a>
        on 2025-01-30 17:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/edeustace">@edeustace</a> on 2025-01-30 17:06</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Hi,
I'm trying to call a private index and I'm getting a 401.</p>
<p>I've see the other issues related to this here: #1709, #1393 etc, but I'm still seeing the issue even though it's been marked as resolved for #1709.</p>
<p>I'm using a virtual env - could that be the issue?</p>
<p>The same index url works fine w/ a vanilla <code>python -m pip install ...</code>.</p>
<p>Command:
<code>uv --verbose pip install requests-mock --index-url &quot;https://ed.eustace:PASSWORD_HERE@artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple</code></p>
<pre><code class="language-shell">DEBUG uv 0.5.25 (9c07c3fc5 2025-01-28)
DEBUG Searching for default Python interpreter in virtual environments
TRACE Cached interpreter info for Python 3.10.16, skipping probing: .my-env/bin/python3
DEBUG Found `cpython-3.10.16-macos-aarch64-none` at `/Users/ed.eustace/dev/code/my-project/.my-env/bin/python3` (active virtual environment)
Using Python 3.10.16 environment at: .my-env
TRACE Checking lock for `.my-env` at `.my-env/.lock`
DEBUG Acquired lock for `.my-env`
DEBUG At least one requirement is not satisfied: requests-mock
TRACE Caching credentials for https://ed.eustace:PASSWORD_HERE@artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.10.16
DEBUG Solving with target Python version: &gt;=3.10.16
TRACE assigned packages:
TRACE Chose package for decision: root. remaining choices:
DEBUG Adding direct dependency: requests-mock*
TRACE Fetching metadata for requests-mock from https://ed.eustace:PASSWORD_HERE@artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple/requests-mock/
TRACE assigned packages: root==0a0.dev0
TRACE Chose package for decision: requests-mock. remaining choices:
TRACE No cache entry exists for /Users/ed.eustace/.cache/uv/simple-v15/index/9651e5c67f3509dd/requests-mock.rkyv
DEBUG No cache entry for: https://artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple/requests-mock/
TRACE Sending fresh GET request for https://artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple/requests-mock/
TRACE Handling request for https://ed.eustace:****@artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple/requests-mock/
TRACE Request for https://ed.eustace:****@artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple/requests-mock/ is already fully authenticated
TRACE Attempting to retry error: Error { kind: WrappedReqwestError(Url { scheme: &quot;https&quot;, cannot_be_a_base: false, username: &quot;&quot;, password: None, host: Some(Domain(&quot;artifactory.foobar.com&quot;)), port: None, path: &quot;/artifactory/api/pypi/python-virtual/simple/requests-mock/&quot;, query: None, fragment: None }, WrappedReqwestError(Reqwest(reqwest::Error { kind: Status(401), url: &quot;https://artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple/requests-mock/&quot; }))) }
TRACE Cannot retry error: not an IO error
TRACE Received package metadata for: requests-mock
DEBUG Searching for a compatible version of requests-mock (*)
TRACE Selecting candidate for requests-mock with range * with 0 remote versions
DEBUG No compatible version found for: requests-mock
TRACE Resolver derivation tree before reduction
term root==0a0.dev0
  root==0a0.dev0 depends on requests-mock*
  requests-mock not found in the package registry
TRACE Resolver derivation tree after reduction
term root==0a0.dev0
  root==0a0.dev0 depends on requests-mock*
  requests-mock not found in the package registry
  × No solution found when resolving dependencies:
  ╰─▶ Because requests-mock was not found in the package registry and you require requests-mock, we
      can conclude that your requirements are unsatisfiable.

      hint: An index URL (https://artifactory.foobar.com/artifactory/api/pypi/python-virtual/simple)
      could not be queried due to a lack of valid authentication credentials (401 Unauthorized).
DEBUG Released lock at `/Users/ed.eustace/dev/code/my-project/.my-env/.lock`

</code></pre>
<h3>Platform</h3>
<p>macOS Darwin 24.2.0 arm64</p>
<h3>Version</h3>
<p>0.5.25</p>
<h3>Python version</h3>
<p>Python 3.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @edeustace on 2025-01-30 17:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-30 17:11</div>
            <div class="timeline-body"><p>Hm.. I'm not sure what to think of this. We say the request is fully authenticated, so we are sending the username and password. Are you <em>certain</em> the same credentials are being used in pip?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-01-30 17:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @zanieb on 2025-01-30 17:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-30 17:12</div>
            <div class="timeline-body"><p>(bonked the button there)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edeustace">@edeustace</a> on 2025-01-30 20:47</div>
            <div class="timeline-body"><p>Let me double-double check and report back</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edeustace">@edeustace</a> on 2025-01-31 09:54</div>
            <div class="timeline-body"><p>Ok - I found out what the issue was - I had to use my 'api key' for the password field, not my encrypted password. so : <code>https://$USER:$API_KEY@artifactory.foobar.com/....</code>. All good. Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @edeustace on 2025-01-31 09:54</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/11130.html">astral-sh/uv#11130</a> on 2025-01-31 10:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:32:59 UTC
    </footer>
</body>
</html>
