<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use zopfli for packaging `uv` itself? - astral-sh/uv #9972</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use zopfli for packaging <code>uv</code> itself?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/9972">#9972</a>
        opened by <a href="https://github.com/akx">@akx</a>
        on 2024-12-17 13:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/akx">@akx</a> on 2024-12-17 13:52</div>
            <div class="timeline-body"><p>It might be worth it to look at using <code>zopfli</code> when creating the tarballs that are uploaded as actual version releases.</p>
<p>It takes significantly longer to compress, of course:</p>
<pre><code>$ time zopfli -v --i30 uv-x86_64-unknown-linux-gnu.tar
...
Executed in  107.17 secs
</code></pre>
<p>and the savings don't seem <em>very</em> great on their own:</p>
<pre><code>14983657 Dec 17 15:30 uv-x86_64-unknown-linux-gnu.tar.orig.gz
14405866 Dec 17 15:37 uv-x86_64-unknown-linux-gnu.tar.zopfli.gz
</code></pre>
<p>– that is, 3.85 %, or 578 KiB – but in the grand scale of things (I'd guess <code>uv</code> is downloaded a couple of times every now and then) it could make a dent in time/energy/bandwidth usage.</p>
<p>The extraction time is unaffected (other than that there's less data to read) – they're both just gzip bitstreams afterwards:</p>
<pre><code>$ hyperfine --warmup 10 'tar xf uv-x86_64-unknown-linux-gnu.tar.gz.zopfli.gz' 'tar xf uv-x86_64-unknown-linux-gnu.tar.gz.orig.gz'
Benchmark 1: tar xf uv-x86_64-unknown-linux-gnu.tar.gz.zopfli.gz
  Time (mean ± σ):      66.5 ms ±   2.4 ms    [User: 51.6 ms, System: 13.3 ms]
  Range (min … max):    62.0 ms …  76.1 ms    43 runs

Benchmark 2: tar xf uv-x86_64-unknown-linux-gnu.tar.gz.orig.gz
  Time (mean ± σ):      68.1 ms ±   2.9 ms    [User: 52.7 ms, System: 13.7 ms]
  Range (min … max):    63.9 ms …  81.4 ms    42 runs

Summary
  tar xf uv-x86_64-unknown-linux-gnu.tar.gz.zopfli.gz ran
    1.02 ± 0.06 times faster than tar xf uv-x86_64-unknown-linux-gnu.tar.gz.orig.gz
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">releases</span> added by @zanieb on 2024-12-17 14:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:51 UTC
    </footer>
</body>
</html>
