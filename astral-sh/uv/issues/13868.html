<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv sync` twice tries to install to /usr/local/lib the second time - astral-sh/uv #13868</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv sync</code> twice tries to install to /usr/local/lib the second time</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13868">#13868</a>
        opened by <a href="https://github.com/c0g">@c0g</a>
        on 2025-06-05 17:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/c0g">@c0g</a></div>
            <div class="timeline-body">Summary
<p>We have a fairly complex workspace repo so I&#x27;m struggling to find a minimal reproduce - doesn&#x27;t reproduce with two sub-projects with cross-dependencies, also doesn&#x27;t reproduce if I just copy the pyproject.toml skeleton from my project (e.g. remove all our code ðŸ˜“). Will keep plugging away at re-producing in something I can share.</p>
<p>The very short is if I run <code>uv sync</code> once, it creates a .venv and works fine. If I run it again with a .venv in the directory, it tries to install into /usr and fails because I don&#x27;t have write access into /usr.</p>
<p>I&#x27;ve attached log files of the first and second run.</p>
<p>I ran a bisection and the problem seems to have been introduced in 0.6.4 -- it works fine on 0.6.0 - 0.6.3. I have logs from all installs during the bisection if those might be helpful. Also happy to run any other diagnosis commands.</p>
<p><a href="https://github.com/user-attachments/files/20615027/first.log">first.log</a>
<a href="https://github.com/user-attachments/files/20615028/second.log">second.log</a></p>
Platform
<p>Ubuntu 22.04 amd64</p>
Version
<p>uv 0.6.4 onward</p>
Python version
<p>3.10.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/c0g">@c0g</a> on 2025-06-05 17:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-06-06 15:37</div>
            <div class="timeline-body"><p>Can you share the output of the following with the venv activated?</p>
<pre><code>python -m sysconfig 2&gt;/dev/null | head -14
</code></pre>
<p>How did you install the system Python interpreter?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/c0g">@c0g</a> on 2025-06-15 01:19</div>
            <div class="timeline-body"><p>Unfortunately I no longer have access to this system so canâ€™t run the command. It was just the standard 3.10 python on Ubuntu 22.04.</p>
<p>Iâ€™ll close this since I canâ€™t provide any more info. Sorry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/c0g">@c0g</a> on 2025-06-15 01:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:56 UTC
    </footer>
</body>
</html>
