<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation of uv fails when $HOME variable is not set - astral-sh/uv #6965</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Installation of uv fails when $HOME variable is not set</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/6965">#6965</a>
        opened by <a href="https://github.com/kishaningithub">@kishaningithub</a>
        on 2024-09-03 10:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/kishaningithub">@kishaningithub</a> on 2024-09-03 10:22</div>
            <div class="timeline-body"><p>When I Tried running the following command (mentioned in the docs) to install uv in amazon linux box where $HOME directory is unset for reasons unknown i get a failure saying $HOME is unset</p>
<pre><code class="language-bash">curl -LsSf https://astral.sh/uv/install.sh | sh
</code></pre>
<p>Example - https://github.com/kishaningithub/setup-python-amazon-linux/issues/14#issuecomment-2325627058</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Installation of uv when $HOME variable is not set" to "Installation of uv fails when $HOME variable is not set" by @kishaningithub on 2024-09-03 10:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">release</span> added by @zanieb on 2024-09-03 17:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @zanieb on 2024-09-03 17:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-03 17:42</div>
            <div class="timeline-body"><p>Thanks for the report. We'll raise this with the upstream dependency that generates the installer.</p>
<p>What do you expect to happen? We install the binary in a directory in <code>$HOME</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kishaningithub">@kishaningithub</a> on 2024-09-04 07:21</div>
            <div class="timeline-body"><p>I think it would be great if we can pass in an argument to the shell script to explicitly state in which directory the installation should happen. That way the $HOME dependency can disappear.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jooon">@jooon</a> on 2024-09-04 11:01</div>
            <div class="timeline-body"><p>uv itself seems to default to /root when $HOME is missing, for its cache, managed python and tools, if I install to /bin in an otherwise empty docker container.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/janosh">@janosh</a> on 2024-09-04 21:55</div>
            <div class="timeline-body"><p>same problem here. working with <code>uv</code> on multiple HPC clusters where users are instructed to create large files under <code>/scratch/&lt;user&gt;</code> (which is on a faster FS), not <code>/home/&lt;user&gt;</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zsimic">@zsimic</a> on 2024-09-06 16:52</div>
            <div class="timeline-body"><p>I ran into this as well, and ended up defining a HOME env var. My use case is auto installing <code>uv</code> in a specific folder, using <code>CARGO_DIST_FORCE_INSTALL_DIR</code>, and <code>HOME</code> in my case ideally shouldn't be involved at all. I see it's used to generate a receipt file (which is also not needed in this case).</p>
<p>What would be nice for automations like this is if the installer script simply dropped the correct <code>uv</code> binary in the specified target folder, and that's it (no PATH modifications, no HOME involved etc)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../axodotdev/cargo-dist/issues/1400.html">axodotdev/cargo-dist#1400</a> on 2024-09-07 19:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kishaningithub">@kishaningithub</a> on 2024-09-09 06:02</div>
            <div class="timeline-body"><p>An example proposal of how the installation api can look like ( inspired from <a href="https://golangci-lint.run/welcome/install/#other-ci">go-releaser installation</a> )</p>
<pre><code class="language-bash">## Put uv binary in the /bin folder under current directory (defaults to current implementation if not specified)
curl -LsSf https://astral.sh/uv/install.sh | sh -s -- -b $(pwd)/bin

## Reproducible builds by specifying exact version (defaults to latest if not specified)
curl -LsSf https://astral.sh/uv/install.sh | sh -s -- -b $(pwd)/bin v0.4.7
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jooon">@jooon</a> on 2024-09-09 12:21</div>
            <div class="timeline-body"><p>Just noticed that this incantation works to install version 0.4.7 of uv and uvx to /usr/bin without writing any env files.</p>
<pre><code>curl -LsSf https://astral.sh/uv/0.4.7/install.sh | UV_INSTALL_DIR=/usr sh
</code></pre>
<p>Setting UV_INSTALL_DIR=/ so it writes to /bin sort of works, but it appends a slash, so it becomes //bin which is not in $PATH, which makes the installer write /env and /env.fish as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashleygwilliams">@ashleygwilliams</a> on 2024-09-09 14:39</div>
            <div class="timeline-body"><p>hey folks! I work on cargo-dist which is what the astral team uses to distribute <code>uv</code>, really appreciate the discussion on this article and i've opened up an issue on our tracker to fully gather requirements for the install mode ya'll are discussing here.</p>
<p>https://github.com/axodotdev/cargo-dist/issues/1400</p>
<p>would love for you to share ideas there (i'll also continue monitoring this issue for ideas!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-30 20:24</div>
            <div class="timeline-body"><p>You can now set <code>UV_UNMANAGED_INSTALL</code> to define a standalone installation directory, e.g.:</p>
<pre><code>export UV_UNMANAGED_INSTALL=/foo/bar
curl -LsSf https://astral.sh/uv/install.sh | sh -s -- -v --no-modify-path
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-10-30 20:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kishaningithub">@kishaningithub</a> on 2024-10-31 17:07</div>
            <div class="timeline-body"><p>@charliermarsh Can this also be updated in the main documentation site?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ashleygwilliams">@ashleygwilliams</a> on 2024-10-31 17:25</div>
            <div class="timeline-body"><p>@charliermarsh with <code>UV_UNMANAGED_INSTALL</code> you won't need to pass <code>--no-modify-path</code> as that's behavior rolled into the env var</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-31 17:44</div>
            <div class="timeline-body"><p>@kishaningithub see https://docs.astral.sh/uv/configuration/installer/#unmanaged-installations</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/parthshyara">@parthshyara</a> on 2024-12-17 10:04</div>
            <div class="timeline-body"><p>@charliermarsh The issue is not yet resolved. Getting the following error.</p>
<pre><code>&gt; curl -LsSf https://astral.sh/uv/install.sh | sh

sh: line 53: HOME: unbound variable
</code></pre>
<p>This is present in the latest install script. The failing code line is <code>RECEIPT_HOME=&quot;${HOME}/.config/uv&quot;</code> which is unconditionally trying to resolve <code>$HOME</code> always.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-17 13:11</div>
            <div class="timeline-body"><p>@parthshyara -- I believe you need to set <code>UV_UNMANAGED_INSTALL</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mil-ad">@mil-ad</a> on 2025-03-25 15:55</div>
            <div class="timeline-body"><p>@charliermarsh @zanieb  Even if you set <code>UV_UNMANAGED_INSTALL</code> the script still chokes on line 53 because <code>$HOME</code> is not defined:</p>
<pre><code>RECEIPT_HOME=&quot;${XDG_CONFIG_HOME:-$HOME/.config}/uv&quot;
</code></pre>
<p>Here's the output of the installer with <code>set -x</code>:</p>
<pre><code>+ [  = Version JM 93t+ 2010-03-05 ]
+ set -u
+ APP_NAME=uv
+ APP_VERSION=0.6.9
+ [ -n  ]
+ INSTALLER_BASE_URL=https://github.com
+ [ -n  ]
+ ARTIFACT_DOWNLOAD_URL=https://github.com/astral-sh/uv/releases/download/0.6.9
+ PRINT_VERBOSE=0
+ PRINT_QUIET=0
+ [ -n  ]
+ NO_MODIFY_PATH=0
+ [ 0 = 1 ]
+ INSTALL_UPDATER=1
+ UNMANAGED_INSTALL=/usr/local/bin
+ [ -n /usr/local/bin ]
+ NO_MODIFY_PATH=1
+ INSTALL_UPDATER=0
+ read -r RECEIPT
/tmp/i.sh: 55: HOME: parameter not set
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mo18">@mo18</a> on 2025-03-26 03:45</div>
            <div class="timeline-body"><p>@mil-ad - I'm trying to install into <code>/usr/local/bin</code>, so I created the following environment variables to get it to install properly:</p>
<pre><code>XDG_CONFIG_HOME=/usr/local/.uvconfig
UV_INSTALL_DIR=/usr/local/bin
</code></pre>
<p>This gets the installer to complete successfully. I haven't tested uv yet, but I'm thinking the <code>XDG_CONFIG_HOME</code> directory will need to persist for the app to work properly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mil-ad">@mil-ad</a> on 2025-03-26 08:41</div>
            <div class="timeline-body"><p>Same, I just defined a dummy <code>HOME=&quot;foobar&quot;</code> along with <code>UV_UNMANAGED_INSTALL</code> and it runs fine. The only problem is that one line.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cr3ative">@cr3ative</a> on 2025-05-28 10:24</div>
            <div class="timeline-body"><p>@charliermarsh Just to confirm, this is still an issue - I've applied the fix @mil-ad suggested to get this working, but yeah, on Amazon Linux 2023 (or another OS where $HOME isn't set), the installer cannot run, even in <code>UV_UNMANAGED_INSTALL</code> set. Latest version.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @konstin on 2025-05-28 10:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../astral-sh/cargo-dist/pulls/38.html">astral-sh/cargo-dist#38</a> on 2025-05-28 11:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../kishaningithub/setup-python-amazon-linux/pulls/24.html">kishaningithub/setup-python-amazon-linux#24</a> on 2025-06-04 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-06-09 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-06-09 15:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/14156.html">astral-sh/uv#14156</a> on 2025-06-20 18:06</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:59 UTC
    </footer>
</body>
</html>
