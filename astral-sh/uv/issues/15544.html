<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`--bounds` has no effect for `--script` - astral-sh/uv #15544</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`--bounds` has no effect for `--script`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15544">#15544</a>
        opened by <a href="https://github.com/nik-sm">@nik-sm</a>
        on 2025-08-27 06:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/nik-sm">@nik-sm</a> on 2025-08-27 06:03</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>It seems that <code>uv add --bounds exact</code> has no effect when adding dependencies to a script. See example below. If this is intended behavior, I believe the CLI should warn about this.</p>
<pre><code class="language-shell">$ uv init --script example.py                      
Initialized script at `example.py`
$ uv add --script example.py --bounds exact ipython
warning: The `bounds` option is in preview and may change in any future release. Pass `--preview-features add-bounds` to disable this warning.
Updated `example.py`

$ cat example.py 
───────┬─────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;ipython&quot;,
   5   │ # ]
   6   │ # ///
   7   │ 
   8   │ 
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │ 
  12   │ 
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────



$ uv init --script example2.py                     
Initialized script at `example2.py`

$ uv add --script example2.py --bounds major ipython
warning: The `bounds` option is in preview and may change in any future release. Pass `--preview-features add-bounds` to disable this warning.
Updated `example2.py`
$ cat example2  
[bat error]: 'example2': No such file or directory (os error 2)

$ cat example2.py 
───────┬──────────────────────────────────────
       │ File: example2.py
───────┼──────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;ipython&quot;,
   5   │ # ]
   6   │ # ///
   7   │ 
   8   │ 
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example2.py!&quot;)
  11   │ 
  12   │ 
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴──────────────────────────────────────
</code></pre>
<p>P.S. loving the <code>--script</code> workflow - keep up the great work!</p>
<h3>Platform</h3>
<p>Darwin 24.5.0 arm64</p>
<h3>Version</h3>
<p>uv 0.8.13 (ede75fe62 2025-08-21)</p>
<h3>Python version</h3>
<p>Python 3.12.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @nik-sm on 2025-08-27 06:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-28 00:47</div>
            <div class="timeline-body"><p>I suspect this works if you run <code>uv lock --script example.py</code> first. Without a lockfile, <code>uv add --script</code> just adds the verbatim dependency. Agree we should warn.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-08-28 00:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @charliermarsh on 2025-08-28 00:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-08-28 11:21</div>
            <div class="timeline-body"><p>For my use cases, I'd like to have e.g. <code>uv add httpx --script foo.py --bounds major</code> add numpy with bounds. There are cases where you don't want or can't use a lockfile, but you still want some bounds to avoid sudden breakage. It feels odd to ignore an explicit option depending on whether a lockfile exists. The same applies to <code>uv add pandas --bounds major --frozen</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-28 14:48</div>
            <div class="timeline-body"><p>Huh why aren't we using bounds by default in scripts unless there's a lockfile? That seems surprising.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-28 14:57</div>
            <div class="timeline-body"><p>Because it would require performing a resolution, and we don't perform any resolution if there isn't a lockfile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-28 14:59</div>
            <div class="timeline-body"><p>I think that's probably wrong in general, e.g., we allow you to add conflicting dependencies? (or am I missing something here?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nik-sm">@nik-sm</a> on 2025-08-28 22:16</div>
            <div class="timeline-body"><p>For me, the single-file simplicity is part of the appeal of the <code>--script</code> workflow. That being said, I don't know how much of a challenge it is to resolve versions without a lockfile or whether it leads to other problems.</p>
<p>Just testing a bit more, is seems this feature may not be working either way. All I changed below is doing <code>uv lock --script file.py</code> before <code>uv add --bounds exact numpy --script file.py</code> but it still doesn't seem to work. Maybe there is another option I'm supposed to pass to ensure lockfile is discovered/used?</p>
<details>

<summary> Example using 0.8.13 </summary>

<pre><code class="language-shell">✓ Desktop % uv init --script example.py
Initialized script at `example.py`
✓ Desktop % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = []
   4   │ # ///
   5   │
   6   │
   7   │ def main() -&gt; None:
   8   │     print(&quot;Hello from example.py!&quot;)
   9   │
  10   │
  11   │ if __name__ == &quot;__main__&quot;:
  12   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ Desktop % uv add --bounds exact numpy --script example.py
warning: The `bounds` option is in preview and may change in any future release. Pass `--preview-features add-bounds` to disable this warning.
Updated `example.py`
✓ Desktop % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;numpy&quot;,
   5   │ # ]
   6   │ # ///
   7   │
   8   │
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │
  12   │
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ Desktop % uv lock --script example.py
Resolved 1 package in 6ms
✓ Desktop % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;numpy&quot;,
   5   │ # ]
   6   │ # ///
   7   │
   8   │
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │
  12   │
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ Desktop % wc -l example.py.lock
      69 example.py.lock
✓ Desktop % uv add --bounds exact numpy --script example.py
warning: The `bounds` option is in preview and may change in any future release. Pass `--preview-features add-bounds` to disable this warning.
Resolved 1 package in 2ms
✓ Desktop % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;numpy&quot;,
   5   │ # ]
   6   │ # ///
   7   │
   8   │
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │
  12   │
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ Desktop %
</code></pre>
</details>

<details>

<summary>
Example using 0.8.14
</summary>

<pre><code class="language-shell">✓ tmp % uv init --script example.py
Initialized script at `example.py`
✓ tmp % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = []
   4   │ # ///
   5   │
   6   │
   7   │ def main() -&gt; None:
   8   │     print(&quot;Hello from example.py!&quot;)
   9   │
  10   │
  11   │ if __name__ == &quot;__main__&quot;:
  12   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ tmp % uv add --bounds exact numpy --script example.py
warning: The `bounds` option is in preview and may change in any future release. Pass `--preview-features add-bounds` to disable this warning.
Updated `example.py`
✓ tmp % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;numpy&quot;,
   5   │ # ]
   6   │ # ///
   7   │
   8   │
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │
  12   │
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ tmp % uv lock --script example.py
Resolved 1 package in 4ms
✓ tmp % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;numpy&quot;,
   5   │ # ]
   6   │ # ///
   7   │
   8   │
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │
  12   │
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────────────────────────────
✓ tmp % wc -l example.py.lock
      69 example.py.lock
✓ tmp % uv add --bounds exact numpy --script example.py
warning: The `bounds` option is in preview and may change in any future release. Pass `--preview-features add-bounds` to disable this warning.
Resolved 1 package in 2ms
✓ tmp % cat example.py
───────┬─────────────────────────────────────────────────────────────
       │ File: example.py
───────┼─────────────────────────────────────────────────────────────
   1   │ # /// script
   2   │ # requires-python = &quot;&gt;=3.12&quot;
   3   │ # dependencies = [
   4   │ #     &quot;numpy&quot;,
   5   │ # ]
   6   │ # ///
   7   │
   8   │
   9   │ def main() -&gt; None:
  10   │     print(&quot;Hello from example.py!&quot;)
  11   │
  12   │
  13   │ if __name__ == &quot;__main__&quot;:
  14   │     main()
───────┴─────────────────────────────────────────────────────────────
</code></pre>
</details>

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nik-sm">@nik-sm</a> on 2025-09-10 23:35</div>
            <div class="timeline-body"><p>Just a ping with more info about <code>--bounds</code>. In version 0.8.14 and in latest (0.8.17), the behavior is like this:</p>
<pre><code class="language-shell">uv init --script file.py
uv add --script file.py --bounds exact numpy    # does not include bounds
uv lock --script file.py
uv add --script file.py --bounds exact loguru   # this works (add NEW package with bounds)
uv add --script file.py --bounds exact numpy    # this does nothing (add EXISTING package with bounds)
</code></pre>
<p>The behavior seems to be the same for <code>--script</code> and for regular uv projects (i.e. the result of plain <code>uv init</code>).</p>
<p>In both situations (a <code>uv init</code> project, or a <code>uv init --script; uv lock --script</code>), uv does resolve dependencies, but then exits 0 without making changes.</p>
<p>Not sure whether this is intentional vs bug, but I think it's unintuitive. (<code>uv add numpy==2.3.3</code> will always try to apply the requested version logic as you expect, but <code>uv add numpy --bounds exact</code> sometimes does NOT try to apply the requested version logic...)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-12-03 04:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-12-03 13:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:17:43 UTC
    </footer>
</body>
</html>
