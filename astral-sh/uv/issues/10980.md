```yaml
number: 10980
title: "Avoid corrupt pyproject.toml when aborting `uv add xxx`"
type: issue
state: open
author: perapp
labels:
  - enhancement
assignees: []
created_at: 2025-01-27T10:05:35Z
updated_at: 2025-01-27T14:06:07Z
url: https://github.com/astral-sh/uv/issues/10980
synced_at: 2026-01-10T01:57:25Z
```

# Avoid corrupt pyproject.toml when aborting `uv add xxx`

---

_Issue opened by @perapp on 2025-01-27 10:05_

### Summary

Hello!

Not sure if I was extremely unlucky. But I hit ctrl-c during `uv add xxx` due to typo of the package name. This resulted in an empty pyproject.toml file. I had uncommitted changes in it making me rework those changes.

A nice feature would be to have uv write the new pyproject.toml file using a temporary file and at then end do a atomic file rename operation to avoid this situation.


### Example

_No response_

---

_Label `enhancement` added by @perapp on 2025-01-27 10:05_

---

_Comment by @charliermarsh on 2025-01-27 14:06_

Hm, we already have a Ctrl-C handler that reverts changes here. I'm not sure what else we can do.

---
