<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uninstalling then reinstalling a package produces METADATA error - astral-sh/uv #1525</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Uninstalling then reinstalling a package produces METADATA error</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1525">#1525</a>
        opened by <a href="https://github.com/RafailFridman">@RafailFridman</a>
        on 2024-02-16 18:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/RafailFridman">@RafailFridman</a> on 2024-02-16 18:47</div>
            <div class="timeline-body"><p>Steps to reproduce:</p>
<ul>
<li>Installing some package, let's say <code>pandas</code></li>
</ul>
<pre><code>uv venv env1 -p 3.10
source env1/bin/activate
uv pip install pandas
</code></pre>
<ul>
<li>Uninstalling it and installing it again:</li>
</ul>
<pre><code>uv pip uninstall pandas
uv pip install pandas
</code></pre>
<ul>
<li>Produces the following error:</li>
</ul>
<pre><code>error: Failed to read metadata for: pandas==2.2.0
  Caused by: failed to open file `~/env1/lib/python3.10/site-packages/pandas-2.2.0.dist-info/METADATA`
  Caused by: No such file or directory (os error 2)
</code></pre>
<p>Am I doing something wrong?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-16 18:48</div>
            <div class="timeline-body"><p>Hm interesting, I can't reproduce this:</p>
<pre><code>❯ source .venv/bin/activate
❯ uv pip install pandas
Resolved 6 packages in 96ms
Downloaded 2 packages in 499ms
Installed 2 packages in 26ms
 + numpy==1.26.4
 + pandas==2.2.0
 
❯ uv pip uninstall pandas
Uninstalled 1 package in 87ms
 - pandas==2.2.0
 
❯ uv pip install pandas
Resolved 6 packages in 3ms
Installed 1 package in 16ms
 + pandas==2.2.0
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-02-16 18:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-reproduction</span> added by @zanieb on 2024-02-16 18:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RafailFridman">@RafailFridman</a> on 2024-02-16 19:00</div>
            <div class="timeline-body"><p>Hm, I tried it with different python versions, and still get this.
I tried it on centos 7.9 and RHEL 9.1.
What information could be useful for reproducing this?
I tried running with <code>-v</code> flag, but it does not show anything useful for this issue</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 19:04</div>
            <div class="timeline-body"><p>It might be useful to see the contents of <code>~/env1/lib/python3.10/site-packages/pandas-2.2.0.dist-info</code> or similar after the uninstall, and then after the second install.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RafailFridman">@RafailFridman</a> on 2024-02-16 19:28</div>
            <div class="timeline-body"><p>After the uninstall the folder <code>~/env1/lib/python3.10/site-packages/pandas-2.2.0.dist-info</code> is empty, but it still exists
After the second install attempt it remains empty.</p>
<p>I tried to manually remove the <code>pandas-2.2.0.dist-info</code> before the second installation attempt, and then the installation succeeded!
So it seems that this folder was not removed during the uninstall, which causes this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 19:54</div>
            <div class="timeline-body"><p>Great, that's really helpful! Just confirming: it's <em>totally</em> empty, no dotfiles or anything, right? Will review.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RafailFridman">@RafailFridman</a> on 2024-02-16 20:03</div>
            <div class="timeline-body"><p>Yes, it is totally empty - nothing shows up with <code>ls -a</code></p>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 20:18</div>
            <div class="timeline-body"><p>Thanks! I have at least one idea here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RafailFridman">@RafailFridman</a> on 2024-03-04 15:52</div>
            <div class="timeline-body"><p>I checked it in version 0.1.13, and I don't get this issue anymore. Closing, I guess :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @RafailFridman on 2024-03-04 15:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/akozlu">@akozlu</a> on 2024-10-29 14:37</div>
            <div class="timeline-body"><p>having similar problems on 0.4.27 on linux I think, whenever i do a <code>uv pip uninstall</code> and then <code>uv pip install</code> I end up in the following situation. Wondering if there's an argument/command I can utilize to get out of this state instead of manually deleting the dist-info file or re-creating the <code>.venv</code></p>
<pre><code>warning: Failed to uninstall package at .venv/lib/python3.8/site-packages/aiobotocore-2.13.3.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
</code></pre>
<p>edit: the problem presents itself when index-url is pointed towards a self hosted registry like Nexus I think, so something might be problematic with me running <code>uv pip uninstall xxx</code> commands against packages downloaded from Nexus</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/8690.html">astral-sh/uv#8690</a> on 2024-10-29 22:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Cogito">@Cogito</a> on 2025-01-03 05:11</div>
            <div class="timeline-body"><p>Just adding, I ran into a similar issue on Windows trying to <code>uv sync --reinstall</code> as there were some ghost python processes with some libraries open. This caused a permissions error, leaving an empty <code>.dist-info</code> folder, which then caused errors like above.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/akozlu">@akozlu</a> on 2025-01-13 06:51</div>
            <div class="timeline-body"><p>Its definitely the failure to delete <code>.dist-info</code> folder, even though the contents of them are deleted. Was curious what you meant by  <em>ghost python processes with some libraries</em>, were those UV related operations? thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Cogito">@Cogito</a> on 2025-01-14 02:11</div>
            <div class="timeline-body"><p>Unfortunately I'm unsure as to what exactly was going on.</p>
<p>I was using intellij and thought maybe it was indexing the venv, but that seems unlikely.
I had run a few tools with uv (dagster, dbt, jupyter, etc) and of the ones I had I most suspected dagster (as it has long running daemon and webserver). In any case, I could see python processes running (spawned by uv as far as I could tell) that didn't match up to anything I was actively using. killing them and fixing the empty folders seemed to resolve the issue.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:18 UTC
    </footer>
</body>
</html>
