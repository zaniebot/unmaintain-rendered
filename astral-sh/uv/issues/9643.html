<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv export --output-file` doesn't create missing directories - astral-sh/uv #9643</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv export --output-file` doesn't create missing directories</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9643">#9643</a>
        opened by <a href="https://github.com/quantike">@quantike</a>
        on 2024-12-04 17:36
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/quantike">@quantike</a> on 2024-12-04 17:36</div>
            <div class="timeline-body"><h2>The Issue</h2>
<p>I am refactoring a repo to migrate it from <code>poetry</code> to <code>uv</code>, as part of that, I needed to update some <code>requirements.txt</code> scripts we have that expect an output-file that sits within a <code>requirements/</code> directory (where we store the various requirement groups (test, lint, dev, etc). I noticed that when running <code>uv export ... --output-file=/requirements/requirements.txt</code> I always get an error that <code>No such file or directory (os error 2) at path &quot;/requirements/.tmpYUAKgT&quot;</code>.  Interestingly, when I remove the <code>requirements/</code> (<code>--output-file=requirements.txt</code>), the command works perfectly fine.</p>
<p>For reference here is the same command in <code>poetry</code> parlance:</p>
<pre><code class="language-sh">poetry export --without-hashes -f requirements.txt -o requirements/requirements.txt --without dev --without test
</code></pre>
<p>The current workaround is an additional step in the script to <code>mv</code> the outputs to the <code>requirements/</code> directory, but I feel like being able to specify an output directory would be within scope of <code>uv export</code>.</p>
<p>Please let me know if</p>
<ol>
<li>I am not using <code>uv export</code> as intended</li>
<li>not using <code>--output-file</code> as intend</li>
<li>if a better option would be to support <code>--output-path</code> or <code>--output-dir</code> in the <code>uv-export</code> command</li>
</ol>
<h2>System and Error Information</h2>
<ul>
<li>The version of <code>uv</code></li>
</ul>
<pre><code class="language-sh">$ uv --version
uv 0.5.6 (b70c4f30e 2024-12-03)
</code></pre>
<ul>
<li>The operating system: MacOS Sequoia 15.1.1</li>
<li>The command that I ran</li>
</ul>
<pre><code class="language-sh">uv export --no-dev --no-hashes --frozen --output-file=/requirements/requirements.txt
</code></pre>
<ul>
<li>The output of the command with the <code>--verbose</code> flag</li>
</ul>
<pre><code class="language-sh">DEBUG uv 0.5.6 (b70c4f30e 2024-12-03)
DEBUG Found project root: `/Users/...&lt;anonymized&gt;.../event_horizon`
DEBUG No workspace root found, using project root
# This file was autogenerated by uv via the following command:
#    uv export --no-dev --no-hashes --frozen --output-file=/requirements/requirements.txt
aiohappyeyeballs==2.4.4
aiohttp==3.11.9
aiosignal==1.3.1
annotated-types==0.7.0
anyio==4.6.2.post1
asyncpg==0.30.0
attrs==24.2.0
boto3==1.35.74
botocore==1.35.74
certifi==2024.8.30
charset-normalizer==3.4.0
colorama==0.4.6 ; platform_system == 'Windows'
debugpy==1.8.9
filelock==3.16.1
frozenlist==1.5.0
fsspec==2024.10.0
h11==0.14.0
httpcore==1.0.7
httpx==0.28.0
huggingface-hub==0.26.3
idna==3.10
jmespath==1.0.1
jsonpatch==1.33
jsonpointer==3.0.0
langchain-core==0.3.21
langchain-text-splitters==0.3.2
langsmith==0.1.147
multidict==6.1.0
numpy==2.1.3
orjson==3.10.12
packaging==24.2
pgvector==0.3.6
propcache==0.2.1
pydantic==2.10.3
pydantic-core==2.27.1
python-dateutil==2.9.0.post0
python-dotenv==1.0.1
pyyaml==6.0.2
regex==2024.11.6
requests==2.32.3
requests-toolbelt==1.0.0
s3transfer==0.10.4
safetensors==0.4.5
six==1.16.0
sniffio==1.3.1
tenacity==9.0.0
tokenizers==0.20.3
tqdm==4.67.1
transformers==4.46.3
typing-extensions==4.12.2
urllib3==2.2.3
uvloop==0.21.0
yarl==1.18.3
error: No such file or directory (os error 2) at path &quot;/requirements/.tmpYUAKgT&quot;
</code></pre>
<h2>Simple Steps to Reproduce</h2>
<p>You can replicate this issue quite easily like so:</p>
<pre><code class="language-sh">uv init output-file-issue &amp;&amp; cd output-file-issue
uv add pydantic 
uv sync
source .venv/bin/activate

# Won't work
uv export --no-dev --no-hashes --frozen --output-file=/requirements/requirements.txt

# Will work
uv export --no-dev --no-hashes --frozen --output-file=requirements.txt
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-04 17:40</div>
            <div class="timeline-body"><p>I think we're just not creating the directory before writing, is my guess?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-12-04 17:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @charliermarsh on 2024-12-04 17:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/quantike">@quantike</a> on 2024-12-04 17:42</div>
            <div class="timeline-body"><p>Actually, the directory already exists:</p>
<pre><code class="language-sh">➜  event_horizon git:(refactor-uv) ✗ tree requirements 
requirements
├── requirements.dev.txt
├── requirements.test.txt
└── requirements.txt

1 directory, 3 files
</code></pre>
<p>Based on my understanding, this should work?</p>
<p>In the &quot;Steps to Reproduce&quot; you can add <code>mkdir requirements</code> and still get the same issue as I get in my repo.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/quantike">@quantike</a> on 2024-12-04 17:46</div>
            <div class="timeline-body"><p>But, if your suggestion is that <code>uv</code> should make that directory if it doesn't exist, I agree. I might be able to open a PR to solve, but I am unfamiliar with the codebase. Happy to contribute though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-04 18:24</div>
            <div class="timeline-body"><p>I presume it's because you're using <code>/</code>?</p>
<pre><code>❯ uv export --no-dev --no-hashes --frozen --output-file=./requirements/requirements.txt
# This file was autogenerated by uv via the following command:
#    uv export --no-dev --no-hashes --frozen --output-file=./requirements/requirements.txt
anyio==4.6.2.post1
certifi==2024.8.30
h11==0.14.0
httpcore==1.0.7
httpx==0.28.0
idna==3.10
sniffio==1.3.1
error: No such file or directory (os error 2) at path &quot;/Users/zb/workspace/uv/example/./requirements/.tmproppgD&quot;
❯ mkdir requirements
❯ uv export --no-dev --no-hashes --frozen --output-file=./requirements/requirements.txt
# This file was autogenerated by uv via the following command:
#    uv export --no-dev --no-hashes --frozen --output-file=./requirements/requirements.txt
anyio==4.6.2.post1
certifi==2024.8.30
h11==0.14.0
httpcore==1.0.7
httpx==0.28.0
idna==3.10
sniffio==1.3.1
❯ uv export --no-dev --no-hashes --frozen --output-file=/requirements/requirements.txt
# This file was autogenerated by uv via the following command:
#    uv export --no-dev --no-hashes --frozen --output-file=/requirements/requirements.txt
anyio==4.6.2.post1
certifi==2024.8.30
h11==0.14.0
httpcore==1.0.7
httpx==0.28.0
idna==3.10
sniffio==1.3.1
error: No such file or directory (os error 2) at path &quot;/requirements/.tmpbhiktA&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-04 18:29</div>
            <div class="timeline-body"><p>Oh, yeah, that part seems like a user error?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/quantike">@quantike</a> on 2024-12-04 19:30</div>
            <div class="timeline-body"><p>Yup that fixes it--user error.</p>
<p>Thank you for the help.</p>
<h2>Solve</h2>
<pre><code class="language-sh"># Add `./` to output-file
uv export --no-dev --no-hashes --frozen --output-file=./requirements/requirements.txt
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv export --output-file` doesn't support file paths with a local directory to the project" to "`uv export --output-file` doesn't create missing directories" by @zanieb on 2024-12-04 19:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/9648.html">astral-sh/uv#9648</a> on 2024-12-04 20:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-12-04 21:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-12-04 21:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:44 UTC
    </footer>
</body>
</html>
