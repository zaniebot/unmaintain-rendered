<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip compile` adds setuptools (and pip) to requirements.txt - astral-sh/uv #1353</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv pip compile</code> adds setuptools (and pip) to requirements.txt</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1353">#1353</a>
        opened by <a href="https://github.com/ThiefMaster">@ThiefMaster</a>
        on 2024-02-15 21:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ThiefMaster">@ThiefMaster</a> on 2024-02-15 21:22</div>
            <div class="timeline-body"><p><code>pip-compile</code> considers dependencies on <code>setuptools</code> (and <code>pip</code>) unsafe and mentions this at the end of the generated file:</p>
<pre><code class="language-py"># The following packages are considered to be unsafe in a requirements file:
# pip
# setuptools
</code></pre>
<p>or</p>
<pre><code class="language-py"># The following packages are considered to be unsafe in a requirements file:
# setuptools
</code></pre>
<p>When using <code>uv pip compile</code>, this is not the case and I get <code>pip</code> added to the requirements.txt (the <code>pip</code> dep is coming from <code>pip-tools</code> and <code>setuptools</code> from packages like <code>babel</code>, <code>pycountry</code> and <code>pip-tools</code>). But both are packages that you generally never want in a requirements.txt (except maybe in VERY specific circumstances - and in those case you probably want to vendor the versions you require instead of having them as package dependencies).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "`uv pip compile` adds setuptools to requirements.txt" to "`uv pip compile` adds setuptools (and pip) to requirements.txt" by @ThiefMaster on 2024-02-15 21:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-02-15 21:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/juftin">@juftin</a> on 2024-02-21 19:27</div>
            <div class="timeline-body"><p>FWIW, <code>--allow-unsafe</code> is becoming the default in the next major release of <code>pip-compile</code>: https://pip-tools.readthedocs.io/en/stable/#deprecations</p>
<blockquote>
<p>In the next major release, the --allow-unsafe behavior will be enabled by default (https://github.com/jazzband/pip-tools/issues/989). Use --no-allow-unsafe to keep the old behavior. It is recommended to pass --allow-unsafe now to adapt to the upcoming change.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-21 20:14</div>
            <div class="timeline-body"><p>Thanks for the additional context. If <code>pip-compile</code> is moving towards just including these by default perhaps we should continue to do so? It's <em>more</em> safe for us since we don't rely on these packages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-21 20:18</div>
            <div class="timeline-body"><p>(We do already &quot;include&quot; these by default, unless I'm misunderstanding your comment.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-21 20:41</div>
            <div class="timeline-body"><p>(edited to clarify)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hauntsaninja">@hauntsaninja</a> on 2024-02-21 21:34</div>
            <div class="timeline-body"><p>In my opinion, <code>uv</code> has the right default behaviour, and soon pip-compile will have the right default behaviour too. If I were uv, I would implement https://github.com/astral-sh/uv/issues/1415 to let people do what they need to, and not change this. (Especially since if you are using uv, I think you have less of a need to mark pip and setuptools as unsafe)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-21 21:36</div>
            <div class="timeline-body"><p>Yeah, agreed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @zanieb on 2024-02-21 21:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-04 01:50</div>
            <div class="timeline-body"><p>Closing as &quot;working as intended&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-04 01:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:26 UTC
    </footer>
</body>
</html>
