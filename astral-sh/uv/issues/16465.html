<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linking project extras to maturin features - astral-sh/uv #16465</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Linking project extras to maturin features</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16465">#16465</a>
        opened by <a href="https://github.com/chitralverma">@chitralverma</a>
        on 2025-10-27 06:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/chitralverma">@chitralverma</a> on 2025-10-27 06:17</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have python rust mixed pyo3 project (<code>mypackage</code>) which is built using maturin build-backend and I want to make certain Rust features compile only when optional Python dependencies (or “extras”) are installed.</p>
<p>I know what the dependencies and optional-dependencies section a pyproject.toml are to manipulate the included python packages. but I was wondering if there is a known pattern to use these to manipulate a feature gated (maturin) build itself.</p>
<p>Any help would be greatly appreciated, let me know if i need to raise this as a github issue.
thanks</p>
<h3>Example</h3>
<p>It'll be awesome for the end users to do something like :</p>
<pre><code># base build with default features
uv pip install mypackage           

# enables &quot;fast&quot; Rust feature + includes any other py dependencies in fast extra
uv pip install mypackage[fast]     

# enables &quot;something&quot; and &quot;fast&quot; Rust feature + includes any other py dependencies in &quot;something&quot; and &quot;fast&quot; extra
uv pip install mypackage[fast, something]    
</code></pre>
<p>and have those optional extras map to Cargo features in your Cargo.toml so that maturin knows to build with those features.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @chitralverma on 2025-10-27 06:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../apache/opendal/pulls/6729.html">apache/opendal#6729</a> on 2025-10-27 09:02</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-27 19:05</div>
            <div class="timeline-body"><p>Unfortunately, this is not supported by extras. All wheels have the same extras, so we can't make compilation or wheel selection dependent on the activated extras. Extras are purely additive (you can select dependencies when a specific extra is active, but not really depend on another extra being inactive), so you couldn't have <code>mypackage[fast, something]</code> deselect something you'd use with <code>mypackage[fast]</code> either.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../apache/opendal/issues/6748.html">apache/opendal#6748</a> on 2025-11-04 03:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-12-18 16:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:14 UTC
    </footer>
</body>
</html>
