```yaml
number: 2487
title: Errors when querying infos for Python interpreter on OpenBSD
type: issue
state: closed
author: lcheylus
labels:
  - bug
assignees: []
created_at: 2024-03-16T14:03:27Z
updated_at: 2024-03-18T16:31:09Z
url: https://github.com/astral-sh/uv/issues/2487
synced_at: 2026-01-10T01:57:05Z
```

# Errors when querying infos for Python interpreter on OpenBSD

---

_Issue opened by @lcheylus on 2024-03-16 14:03_

I'm trying to package `uv` on OpenBSD current/amd64 (future version 7.5).

uv version 0.1.21 built with Rust 1.76.0 via `cargo build --release` : **build OK**
```shell
$ uv version
uv 0.1.21

$ rustc --version
rustc 1.76.0 (07dca489a 2024-02-04) (built from a source tarball)
```

When I try to run `uv pip <command>` or `uv venv <venv>`, I have errors when trying to get infos for Python interpreter:
```shell
$ uv -v pip list
DEBUG Starting interpreter discovery for default Python
DEBUG Probing interpreter info for: /usr/local/bin/python3
error: Querying Python at `/usr/local/bin/python3` did not return the expected data: invalid type: sequence, expected a string with exit status: 0
--- stdout:
{"result": "success", "markers": {"implementation_name": "cpython", "implementation_version": "3.10.13", "os_name": "posix", "platform_machine": "amd64", "platform_python_implementation": "CPython", "platform_release": "7.5", "platform_system": "OpenBSD", "platform_version": "GENERIC.MP#73", "python_full_version": "3.10.13", "python_version": "3.10", "sys_platform": "openbsd7"}, "base_prefix": "/usr/local", "base_exec_prefix": "/usr/local", "prefix": "/usr/local", "base_executable": "/usr/local/bin/python3", "sys_executable": "/usr/local/bin/python3", "stdlib": "/usr/local/lib/python3.10", "scheme": {"platlib": "/usr/local/lib/python3.10/site-packages", "purelib": "/usr/local/lib/python3.10/site-packages", "include": "/usr/local/include/python3.10", "scripts": "/usr/local/bin", "data": "/usr/local"}, "virtualenv": {"purelib": "lib/python3.10/site-packages", "platlib": "lib/python3.10/site-packages", "include": "include/site/python3.10", "scripts": "bin", "data": ""}, "platform": {"os": {"name": "openbsd", "release": [""]}, "arch": "amd64"}}
--- stderr:

---
```

These errors seem to come from this commit/PR https://github.com/astral-sh/uv/pull/2381 ("Move architecture and operating system probing to Python") => get Python infos from `crates/uv-interpreter/python/get_interpreter_info.py` infos.

Before uv version 0.1.19, I have not these errors when running `uv pip` command.



---

_Comment by @lcheylus on 2024-03-16 14:06_

JSON outputs for Python interpreter with `crates/uv-interpreter/python/get_interpreter_info.py` script:
```json
{
  "result": "success",
  "markers": {
    "implementation_name": "cpython",
    "implementation_version": "3.10.13",
    "os_name": "posix",
    "platform_machine": "amd64",
    "platform_python_implementation": "CPython",
    "platform_release": "7.5",
    "platform_system": "OpenBSD",
    "platform_version": "GENERIC.MP#73",
    "python_full_version": "3.10.13",
    "python_version": "3.10",
    "sys_platform": "openbsd7"
  },
  "base_prefix": "/usr/local",
  "base_exec_prefix": "/usr/local",
  "prefix": "/usr/local",
  "base_executable": "/usr/local/bin/python3",
  "sys_executable": "/usr/local/bin/python3",
  "stdlib": "/usr/local/lib/python3.10",
  "scheme": {
    "platlib": "/usr/local/lib/python3.10/site-packages",
    "purelib": "/usr/local/lib/python3.10/site-packages",
    "include": "/usr/local/include/python3.10",
    "scripts": "/usr/local/bin",
    "data": "/usr/local"
  },
  "virtualenv": {
    "purelib": "lib/python3.10/site-packages",
    "platlib": "lib/python3.10/site-packages",
    "include": "include/site/python3.10",
    "scripts": "bin",
    "data": ""
  },
  "platform": {
    "os": {
      "name": "openbsd",
      "release": [
        ""
      ]
    },
    "arch": "amd64"
  }
}
```

---

_Label `compatibility` added by @charliermarsh on 2024-03-16 14:07_

---

_Comment by @charliermarsh on 2024-03-16 14:08_

Thanks. Will need to look at how platform tags are treated in this case, since AFAIK there is no BSD standard for wheels and BSD-specific wheels aren't supported on PyPI.

---

_Comment by @charliermarsh on 2024-03-16 14:12_

@konstin - Can you take a look at this?

---

_Assigned to @konstin by @charliermarsh on 2024-03-16 14:12_

---

_Unassigned @konstin by @charliermarsh on 2024-03-18 03:16_

---

_Referenced in [astral-sh/uv#2505](../../astral-sh/uv/pulls/2505.md) on 2024-03-18 10:44_

---

_Comment by @konstin on 2024-03-18 10:44_

Could you try again with #2505 merged? I unfortunately don't have an openbsd machine around to test

---

_Label `compatibility` removed by @konstin on 2024-03-18 10:45_

---

_Label `bug` added by @konstin on 2024-03-18 10:45_

---

_Comment by @lcheylus on 2024-03-18 16:31_

OK, rebuild uv version 0.1.21 with this fix on OpenBSD => `uv pip` commands work as expected :)
```
$ uv pip show pytest
Name: pytest
Version: 7.1.3
Location: /usr/local/lib/python3.10/site-packages
Requires: attrs, iniconfig, packaging, pluggy, py, tomli
```

Thanks for your quick fix.

---

_Closed by @lcheylus on 2024-03-18 16:31_

---
