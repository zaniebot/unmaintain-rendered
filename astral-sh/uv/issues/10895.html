<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detect if project directory was moved for venv reconstruction - astral-sh/uv #10895</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Detect if project directory was moved for venv reconstruction</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/10895">#10895</a>
        opened by <a href="https://github.com/jonaslb">@jonaslb</a>
        on 2025-01-23 13:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jonaslb">@jonaslb</a></div>
            <div class="timeline-body">Summary
<p>I just had an issue with pytest รก la #7260. Turned out that because I had moved the project directory, the shebang in the &quot;pytest&quot; script in the venv was wrong, and apparently this meant that the command would fallthrough to the system-installed pytest which couldn&#x27;t find my project or any of its dependencies, of course. <code>uv sync</code> would not detect this, but deleting <code>.venv</code> did the trick.</p>
<p>So I thought, since the location of the venv is hardcoded in the entrypoint scripts, it would be appropriate for uv to keep track of whether the venv location has changed. For example, it could go into the <code>pyvenv.cfg</code> file under a <code>uv-venv-path</code> variable or such. Then, if the actual path of the venv does not match this value, it would indicate to uv that the venv (or at least the entrypoints) should be reconstructed.</p>
Example
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/jonaslb">@jonaslb</a> on 2025-01-23 13:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-23 14:05</div>
            <div class="timeline-body"><p>Yeah it makes sense to detect and invalidate the <code>.venv</code> in this case, if we can.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-23 14:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eabase">@eabase</a> on 2025-02-25 07:53</div>
            <div class="timeline-body"><p>Please see my .venv management proposal in #11773</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jonaslb">@jonaslb</a> on 2025-02-25 13:01</div>
            <div class="timeline-body"><p>@eabase could you spell out how you think that is relevant?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-25 15:24</div>
            <div class="timeline-body"><p>We&#x27;re also considering using <code>--relocatable</code> by default for project environments (which would make the entrypoints transportable)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/eabase">@eabase</a> on 2025-02-26 10:02</div>
            <div class="timeline-body"><p>Hi Jonas, @jonaslb</p>
<blockquote>
<p>could you spell out how you think that is relevant?</p>
</blockquote>
<p>Maybe it&#x27;s not, but it sounded highly relevant, unless I&#x27;m missing out on some other functionality of uv.</p>
<blockquote>
<p>So I thought, since the location of the venv is hardcoded in the entrypoint scripts, it would be appropriate for uv to keep track of whether the venv location has changed. For example, it could go into the pyvenv.cfg file under a uv-venv-path variable or such.</p>
</blockquote>
<p>This is really not wanted. There is absolutely no sane reason to hard-code the venv environment name into a project file.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:36:51 UTC
    </footer>
</body>
</html>
