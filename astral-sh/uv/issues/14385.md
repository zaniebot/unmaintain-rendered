```yaml
number: 14385
title: Leaves lock file in tmp when installing zip file
type: issue
state: closed
author: nijel
labels:
  - duplicate
  - question
assignees: []
created_at: 2025-07-01T05:58:57Z
updated_at: 2025-07-02T01:18:13Z
url: https://github.com/astral-sh/uv/issues/14385
synced_at: 2026-01-10T01:57:32Z
```

# Leaves lock file in tmp when installing zip file

---

_Issue opened by @nijel on 2025-07-01 05:58_

### Summary

When installing a remote zip file, the `uv` leaves lock file in `/tmp` after run:

```console
(tools) root@0221c9e7ed4c:/# ls -la /tmp/
total 8
drwxrwxrwt 1 root root 4096 Jul  1 07:53 .
drwxr-xr-x 1 root root 4096 Jul  1 07:44 ..
(tools) root@0221c9e7ed4c:/# uv pip install https://github.com/nijel/supervisor-stdout/archive/c909c1a1ddabaf679dc2eaecb3b8f5ad6bef467a.zip 
Using Python 3.13.3 environment at: /opt/tools
Resolved 1 package in 1.27s
      Built supervisor-stdout @ https://github.com/nijel/supervisor-stdout/archive/c909c1a1ddabaf679dc2eaecb3b8f5ad6bef467a.zip
Prepared 1 package in 669ms
Installed 1 package in 1ms
 + supervisor-stdout==0.1.1 (from https://github.com/nijel/supervisor-stdout/archive/c909c1a1ddabaf679dc2eaecb3b8f5ad6bef467a.zip)
(tools) root@0221c9e7ed4c:/# ls -la /tmp/
total 8
drwxrwxrwt 1 root root 4096 Jul  1 07:54 .
drwxr-xr-x 1 root root 4096 Jul  1 07:44 ..
-rwxrwxrwx 1 root root    0 Jul  1 07:54 uv-setuptools-8c2cb3e75405ff4e.lock
```

This started to happen with uv 0.7.16, 0.7.15 did not behave like this.

Originally found in a Docker build:

https://github.com/WeblateOrg/docker-base/blob/cc25a4d0a961f434827e1cf96931be411a7e04b8/Dockerfile

### Platform

Ubuntu 25.04

### Version

0.7.17

### Python version

Python 3.13

---

_Label `bug` added by @nijel on 2025-07-01 05:58_

---

_Comment by @zanieb on 2025-07-01 13:06_

We added more file locks for concurrency safety. There's no safe way to delete the file locks, so they remain in the directory.

---

_Label `bug` removed by @zanieb on 2025-07-01 13:06_

---

_Label `question` added by @zanieb on 2025-07-01 13:06_

---

_Comment by @zanieb on 2025-07-01 13:07_

See https://github.com/astral-sh/uv/issues/10773

---

_Label `duplicate` added by @zanieb on 2025-07-01 13:07_

---

_Comment by @oconnor663 on 2025-07-01 16:23_

@zanieb it might be worth resurrecting part of https://github.com/astral-sh/uv/pull/14225 to put these tempfile locks under a shared directory? What do you think?

---

_Comment by @zanieb on 2025-07-01 16:45_

It seems fine to expose configuration for that (and open an issue to track the idea), but I don't think it really solves the complaint here as you'd still need a tmpfs in Docker.

---

_Closed by @charliermarsh on 2025-07-02 01:18_

---
