```yaml
number: 12954
title: "`run --script --no-project --no-sync --isolated` still synchronizes the project unless the script contains inline metadata"
type: issue
state: closed
author: InSyncWithFoo
labels:
  - question
assignees: []
created_at: 2025-04-18T00:08:39Z
updated_at: 2025-11-08T19:34:50Z
url: https://github.com/astral-sh/uv/issues/12954
synced_at: 2026-01-10T01:57:29Z
```

# `run --script --no-project --no-sync --isolated` still synchronizes the project unless the script contains inline metadata

---

_Issue opened by @InSyncWithFoo on 2025-04-18 00:08_

### Summary

Minimal reproducible example:

```shell
$ uv init .
Initialized project `test` at `/workspaces/test`

$ sed -i "s/\[\]/['bs4']/" pyproject.toml

$ cat >foo.py <<EOF
import sys; print(sys.executable); import bs4; print(bs4)
EOF

$ uv run --script foo.py --no-project --no-sync --isolated
Using CPython 3.12.1 interpreter at: /usr/local/python/current/bin/python3.12
Creating virtual environment at: .venv
░░░░░░░░░░░░░░░░░░░░ [0/4] Installing wheels...
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 4 packages in 8ms
/workspaces/test/.venv/bin/python
<module 'bs4' from '/workspaces/test/.venv/lib/python3.12/site-packages/bs4/__init__.py'>
```

`--no-project` should have prevented project discovery, `--no-sync` prevented environment synchronization and `--isolated` ensured environment isolation. Yet:

* A virtual environment is created.
* It is then synchronized; the script has access to the installed packages.
* The Python executable in use is that of the newly created environment.

Adding inline metadata helps:

```shell
$ cat >foo.py <<EOF
# /// script
#
# ///

import sys; print(sys.executable); import bs4; print(bs4)
EOF

$ uv run --script foo.py --no-project --no-sync --isolated
/home/codespace/.cache/uv/builds-v0/.tmpqx3yR2/bin/python
Traceback (most recent call last):
  File "/workspaces/test/foo.py", line 5, in <module>
    import sys; print(sys.executable); import bs4; print(bs4)
                                       ^^^^^^^^^^
ModuleNotFoundError: No module named 'bs4'
```


### Other information

* Platform: Ubuntu
* uv: 0.6.14
* Python: 3.12

---

_Label `bug` added by @InSyncWithFoo on 2025-04-18 00:08_

---

_Comment by @zanieb on 2025-11-08 19:34_

`uv run --script foo.py --no-project --no-sync --isolated`

Everything following `foo.py` is considered an option to `foo.py`. `--script` is a boolean flag, it doesn't take a positional argument.

---

_Label `bug` removed by @zanieb on 2025-11-08 19:34_

---

_Label `question` added by @zanieb on 2025-11-08 19:34_

---

_Closed by @zanieb on 2025-11-08 19:34_

---
