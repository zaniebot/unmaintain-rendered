<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv --no-dev --group dev does not install dev group - astral-sh/uv #11205</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>uv --no-dev --group dev does not install dev group</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/11205">#11205</a>
        opened by <a href="https://github.com/gaborbernat">@gaborbernat</a>
        on 2025-02-03 23:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-03 23:12</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Reproducible:</p>
<p>https://github.com/koxudaxi/datamodel-code-generator/actions/runs/13119193488/job/36600851153
https://github.com/koxudaxi/datamodel-code-generator/blob/main/pyproject.toml#L59-L77</p>
<p>does not install pytest:</p>
<pre><code>dev: uv-sync&gt; uv sync --frozen --python-preference system --no-dev --group dev -p \
/home/runner/.local/share/uv/tools/tox/bin/python
</code></pre>
<h3>Platform</h3>
<p>any</p>
<h3>Version</h3>
<p>0.5.26</p>
<h3>Python version</h3>
<p>any</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @gaborbernat on 2025-02-03 23:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @Gankra by @Gankra on 2025-02-03 23:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-03 23:17</div>
            <div class="timeline-body"><pre><code>‚ùØ uv init example
Initialized project `example` at `/Users/zb/workspace/uv/example`
‚ùØ cd example
‚ùØ uv add --dev anyio
Using CPython 3.12.6
Creating virtual environment at: .venv
Resolved 5 packages in 100ms
Installed 4 packages in 4ms
 + anyio==4.8.0
 + idna==3.10
 + sniffio==1.3.1
 + typing-extensions==4.12.2
‚ùØ uv sync --no-dev --group dev
Resolved 5 packages in 0.79ms
Uninstalled 4 packages in 7ms
 - anyio==4.8.0
 - idna==3.10
 - sniffio==1.3.1
 - typing-extensions==4.12.2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-03 23:57</div>
            <div class="timeline-body"><p>I thought this was the intended behavior -- my understanding was that &quot;excludes&quot; always beat &quot;includes&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-03 23:59</div>
            <div class="timeline-body"><p>I'm not sure that makes sense as a general behavior, like <code>--no-default-groups --group dev</code> should include <code>dev</code>, right?</p>
<p>I'm guessing it's painful to implement this as &quot;last wins&quot;, unfortunately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-04 00:02</div>
            <div class="timeline-body"><p>No, but if a group is explicitly excluded, it seems odd to ever include it IMO?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 00:02</div>
            <div class="timeline-body"><p>My understanding was the <code>--no-dev</code> only was related to the old uv dependency groups, not PEP-735. It's how it was working. If we want to change this, we should raise invalid flags when discovering this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-04 00:03</div>
            <div class="timeline-body"><p>No, <code>--no-dev</code> has always applied equally to the non-PEP 735 group and a PEP 735 group named &quot;dev&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-04 00:04</div>
            <div class="timeline-body"><p>Conceptually, <code>--no-dev</code> is just an alias for <code>--no-group dev</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-04 00:04</div>
            <div class="timeline-body"><p>(At least, as far as I know. Maybe it changed accidentally at some point? But I don't believe so.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-04 00:04</div>
            <div class="timeline-body"><blockquote>
<p>No, but if a group is explicitly excluded, it seems odd to ever include it IMO?</p>
</blockquote>
<p>I agree with this, yeah. Unless we go the route of https://github.com/astral-sh/uv/pull/3259</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 00:09</div>
            <div class="timeline-body"><blockquote>
<p>No, <code>--no-dev</code> has always applied equally to the non-PEP 735 group and a PEP 735 group named &quot;dev&quot;.</p>
</blockquote>
<p>So when both is present how does one choose to only install PEP or only non PEP?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-04 00:10</div>
            <div class="timeline-body"><blockquote>
<p>only install PEP or only non PEP?</p>
</blockquote>
<p>These groups are combined ‚Äî they're not intended to be mixed or partially selected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 00:14</div>
            <div class="timeline-body"><p>That is the two lists are concatanated, no matter what?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 00:19</div>
            <div class="timeline-body"><p>Help me understand then what this flag is supposed to do. <code>--no-dev</code> that is. Does it remove dev from the dependency group? That is if one extends the default, here https://docs.astral.sh/uv/concepts/projects/dependencies/#default-groups? Does only remove dev but keeps rest? Is it a flag to disable the default group, but oddly named?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-04 00:43</div>
            <div class="timeline-body"><p>--no-dev is Extremely hardcoded to <em>just</em> exclude a group called &quot;dev&quot;, it doesn't effect the other default groups.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 01:04</div>
            <div class="timeline-body"><p>Perhaps then we need a flag of <code>--no-default-groups</code> üòÜ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-04 01:10</div>
            <div class="timeline-body"><p>Good news for you: <code>--no-default-groups</code> already exists, it's just not surfaced as well in the high-level config docs as <code>--no-dev</code> is. It only shows up in the generated full CLI docs (e.g. <a href="https://docs.astral.sh/uv/reference/cli/#uv-run">here</a>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 01:12</div>
            <div class="timeline-body"><p>I am ok with this behaviour, however I still think if the CLI would hard fail when seeing <code>--no-dev</code> with <code>--group dev</code> would be a better behaviour than silently picking a winner.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2025-02-04 01:55</div>
            <div class="timeline-body"><blockquote>
<p>--no-default-groups</p>
</blockquote>
<p>So question:</p>
<pre><code>uv sync --no-default-groups --group dev
</code></pre>
<p>Will it install dev?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-04 02:00</div>
            <div class="timeline-body"><p>Yes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../tox-dev/tox-uv/pulls/165.html">tox-dev/tox-uv#165</a> on 2025-02-04 02:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-05 20:45</div>
            <div class="timeline-body"><p>Now that I've properly overhauled this subsystem (in #11224), I can give some more concrete insight on how this is extra fun/weird.</p>
<p>We actually special-case <code>--no-dev</code> and <code>--dev</code> to positionally override eachother, so <code>--no-dev --dev</code> enables dev while <code>--dev --no-dev</code> disables it. This is almost certainly legacy behaviour from when these were the only flags. Meanwhile <code>--group dev</code> does not participate in this overriding (and I don't think it should, if anything I'd want to drop the special case for <code>--dev</code>, but that's a breaking change).</p>
<p>In the new impl we could definitely warn if you enable something only to disable it, but I'm not confident that this won't be yelling at people for doing something we explicitly support. At a minimum I'm going to open a PR to improve the docs a bit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11284.html">astral-sh/uv#11284</a> on 2025-02-06 16:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-02-07 15:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-02-07 15:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/3248.html">astral-sh/uv#3248</a> on 2025-03-03 03:26</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
