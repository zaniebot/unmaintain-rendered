<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv 7.0 introduces 401 errors with developing private package projects - astral-sh/uv #13856</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv 7.0 introduces 401 errors with developing private package projects</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13856">#13856</a>
        opened by <a href="https://github.com/ketozhang">@ketozhang</a>
        on 2025-06-05 07:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ketozhang">@ketozhang</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>This feature was introduced by https://github.com/astral-sh/uv/pull/12805 where ...</p>
<blockquote>
<p>When using the <a href="https://docs.astral.sh/uv/configuration/indexes/#searching-across-multiple-indexes">first-index strategy</a>, uv will stop searching across indexes if an HTTP 401 Unauthorized or HTTP 403 Forbidden status code is encountered. The one exception is that uv will ignore 403s when searching the pytorch index (since this index returns a 403 when a package is not present).
— https://docs.astral.sh/uv/configuration/indexes/#ignoring-error-codes-when-searching-across-indexes</p>
</blockquote>
<p>The implementation however forces any project that is intended to be uploaded to a private package index to either always be authenticated while developing (e.g., during editable installs) or to add a <code>ignore-error-codes = [401]</code> to your <code>[[tool.uv.index]]</code> array. The first choice is inconvenient and the second choice opts out of this security feature: to avoid installing similarly named private packages from pypi.org.</p>
<p>Here's an example. Notice there are no dependencies and this package is intended to be published to <code>private-index</code>. I expected to still be able to develop this project since I have the source code.</p>
<pre><code class="language-toml">[project]
name = &quot;my-private-package&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = []

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;

[[tool.uv.index]]
name = &quot;private-index&quot;
url = &quot;https://my.private.pypi.com/simple/&quot;  
publish-url = &quot;https://my.private.pypi.com&quot;  
</code></pre>
<pre><code># Reproduced if the index url exists and return 401
$ uv sync
  × No solution found when resolving dependencies:
  ╰─▶ Because my-private-package was not found in the package registry and your project depends on mypackage, we can conclude that your project's requirements are
      unsatisfiable.

      hint: An index URL (https://my.private.pypi.com/simple/) could not be queried due to
      a lack of valid authentication credentials (401 Unauthorized).
</code></pre>
<h3>Platform</h3>
<p>Darwin 24.4.0 x86_64</p>
<h3>Version</h3>
<p>uv 0.7.10 (Homebrew 2025-06-03)</p>
<h3>Python version</h3>
<p>Python 3.12.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ketozhang on 2025-06-05 07:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-06-06 15:31</div>
            <div class="timeline-body"><p>Does <code>explicit = true</code> on the index solve the problem?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-06 16:58</div>
            <div class="timeline-body"><p>Sorry, but where is <code>mypackage</code> in the error coming from in that example? The name of the package is <code>my-private-package</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ketozhang">@ketozhang</a> on 2025-06-06 22:10</div>
            <div class="timeline-body"><p>@zanieb
Oops sorry those aren't real outputs since I can't reproduce after obfuscating. Edited to be <code>my-private-package</code> on the output.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ketozhang">@ketozhang</a> on 2025-06-06 22:18</div>
            <div class="timeline-body"><p>@konstin That does work! The DX is much better, just gotta remember to add <code>explicit = true</code> (can't be done with <code>uv add --index ...</code>)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-06-09 00:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rafalkrupinski">@rafalkrupinski</a> on 2025-09-22 11:56</div>
            <div class="timeline-body"><p>without <code>explicit</code>, uv tries to fetch hatchling from your private index</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ketozhang">@ketozhang</a> on 2025-09-22 19:58</div>
            <div class="timeline-body"><p>@rafalkrupinski I didn't think much of this through, but we could add a feature request to make <code>explicit = true</code> be the default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rafalkrupinski">@rafalkrupinski</a> on 2025-09-22 20:07</div>
            <div class="timeline-body"><p>@ketozhang I think it makes perfect sense. Wasn't it the case from the start?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:31:40 UTC
    </footer>
</body>
</html>
