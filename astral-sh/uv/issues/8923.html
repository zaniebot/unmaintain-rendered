<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docs for generate-shell-autocompletion do not work with some existing profiles - astral-sh/uv #8923</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Docs for generate-shell-autocompletion do not work with some existing profiles</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/8923">#8923</a>
        opened by <a href="https://github.com/mtnpke">@mtnpke</a>
        on 2024-11-08 07:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mtnpke">@mtnpke</a></div>
            <div class="timeline-body"><p>The docs on generate-shell-autocompletion at https://docs.astral.sh/uv/getting-started/installation/#shell-autocompletion list this command for powershell:</p>
<pre><code>Add-Content -Path $PROFILE -Value '(&amp; uv generate-shell-completion powershell) | Out-String | Invoke-Expression'
</code></pre>
<p>This fails if</p>
<ul>
<li>$PROFILE already exists and</li>
<li>does not end with a newline.</li>
</ul>
<p>In this case, the line will be added to the end of the last line, resulting in a broken profile file.</p>
<p>A more reliable replacement could be:</p>
<pre><code>Add-Content -Path $PROFILE -Value &quot;`r`n&quot;, '(&amp; uv generate-shell-completion powershell) | Out-String | Invoke-Expression'
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @charliermarsh on 2024-11-09 02:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">windows</span> added by @charliermarsh on 2024-11-09 02:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-09 02:27</div>
            <div class="timeline-body"><p>One downside of the above, I think, is that we'd add a <em>leading</em> newline if the file didn't exist already?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mtnpke">@mtnpke</a> on 2024-11-11 07:57</div>
            <div class="timeline-body"><p>That is correct. Unfortunately, I haven't found a better solution that does not add the leading newline and is a reasonably compact one-liner.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JonasR">@JonasR</a> on 2024-12-09 08:56</div>
            <div class="timeline-body"><p>Ran into this today and had no idea what was going on. Took me a bit to google this issue as well, but thanks for pointing me at the underlying cause and providing a fix.</p>
<p>The error I got was
<code>uv completion Cannot convert 'System.Object[]' to the type 'System.String' required by parameter 'Command'. Specified method is not supported.</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SnowFox4004">@SnowFox4004</a> on 2025-06-05 13:27</div>
            <div class="timeline-body"><p>Found the same problem today. And adding a newline does fix the problem. Thanks for giving solutions</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:28:12 UTC
    </footer>
</body>
</html>
