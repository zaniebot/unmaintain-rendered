<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Respect $CARGO_HOME - astral-sh/uv #7250</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Respect $CARGO_HOME</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7250">#7250</a>
        opened by <a href="https://github.com/yochem">@yochem</a>
        on 2024-09-10 09:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/yochem">@yochem</a></div>
            <div class="timeline-body">

<ul>
<li>Minimal code: -</li>
<li>Platform: MacOS</li>
<li>Version: uv 0.3.1 (be17d132a 2024-08-21)</li>
</ul>
<p>uv does not respect <a href="https://doc.rust-lang.org/stable/cargo/guide/cargo-home.html#cargo-home"><code>$CARGO_HOME</code></a>, used to change the location of the the default <code>$HOME/.cargo</code> folder.</p>
<p>For example, I use the fish shell, and uv creates a file <code>$XDG_CONFIG_HOME/fish/conf.d/uv.env.fish</code> with the following content:</p>
<pre><code>
source &quot;$HOME/.cargo/env.fish&quot;
</code></pre>
<p>Changing this to</p>
<pre><code>set -q CARGO_HOME; or set CARGO_HOME &quot;$HOME/.cargo&quot;

source &quot;$CARGO_HOME/env.fish&quot;
</code></pre>
<p>fixes this.</p>
<p>For bash/zsh it&#x27;s even simpler:</p>
<pre><code>source &quot;${CARGO_HOME:-&quot;$HOME/.cargo&quot;}/env&quot;
</code></pre>
<p>Context: My <code>$CARGO_HOME</code> is set to <code>&quot;$XDG_DATA_HOME/cargo&quot;</code> to respect the <a href="https://wiki.archlinux.org/title/XDG_Base_Directory">XDG base directory spec</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">releases</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-10 12:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2024-09-19 18:24</div>
            <div class="timeline-body"><p>Hello there from cargo-dist, the project that generates this installer.</p>
<p><a href="https://github.com/axodotdev/cargo-dist/blob/81ca476c43ca4016ca0a50cc03c32892ec0e63b4/cargo-dist/templates/installer/installer.sh.j2#L473-L478">We <em>should</em> be respecting CARGO_HOME on install</a>, but we actually replicate the behaviour of rustup here: we assume that anyone who is setting CARGO_HOME was doing so on a temporary basis for the duration of the install, and then resolve its value so that things will keep working even if it becomes unset.</p>
<p>See the equivalent issue in rustup: <a href="https://github.com/rust-lang/rustup/issues/3020">rust-lang/rustup#3020</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yochem">@yochem</a> on 2024-09-22 06:51</div>
            <div class="timeline-body"><p>Thank you for your explanation. I&#x27;m not vey familiar with the rust ecosystem, so this explanation certainly helps!</p>
<p>When I read the linked issue thread, it seems that my best way to resolve the issue is to reinstall Rust and friends, and setting the cargo home env variable during rust installation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/yochem">@yochem</a> on 2024-09-30 10:44</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:33:52 UTC
    </footer>
</body>
</html>
