<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Failed to install python-pcre - astral-sh/uv #11707</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Failed to install python-pcre</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11707">#11707</a>
        opened by <a href="https://github.com/bojanz">@bojanz</a>
        on 2025-02-22 09:09
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bojanz">@bojanz</a> on 2025-02-22 09:09</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>On a project that just switched from Poetry, I am getting an error while building python-pcre:</p>
<pre><code> × Failed to build `python-pcre==0.7`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta:__legacy__.build_wheel` failed (exit status: 1)

      [stderr]
      cc: error: unrecognized command-line option ‘-fdebug-default-version=4’
      error: command '/usr/bin/cc' failed with exit code 1

      hint: This usually indicates a problem with the package or the build environment.
</code></pre>
<p>The same install works with just pip (<code>pip install python-pcre</code>).</p>
<p>cc is <code>cc (GCC) 14.2.1 20250110 (Red Hat 14.2.1-7)</code>.</p>
<p>I'd appreciate any hints towards what I could do to debug this.</p>
<h3>Platform</h3>
<p>Fedora 41</p>
<h3>Version</h3>
<p>0.6.2</p>
<h3>Python version</h3>
<p>3.11.6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @bojanz on 2025-02-22 09:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bojanz">@bojanz</a> on 2025-02-22 14:34</div>
            <div class="timeline-body"><p>Some researching shows that fdebug-default-version is a clang-only flag, and that it is supposed to be stripped in <a href="https://github.com/astral-sh/python-build-standalone">astral-sh/python-build-standalone</a>. Perhaps that didn't reach my Python version?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-22 17:26</div>
            <div class="timeline-body"><p>Hmm, I was able to build without issue on my machine. Did you install Python with uv?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-02-22 17:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2025-02-22 17:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bojanz">@bojanz</a> on 2025-02-22 18:00</div>
            <div class="timeline-body"><p>I did not use <code>uv python install</code>, I have Fedora's pre-installed Python 3.13, and uv pulled down the Python 3.11.6 as specified in <code>.python-version</code> so I'm not expecting the 3.13 to have been used.</p>
<p>Once I understood that the problem is in clang-specific flags, I ran <code>CC=clang uv sync</code> and it worked fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bojanz">@bojanz</a> on 2025-02-22 18:18</div>
            <div class="timeline-body"><p>I see that the fix for clang-specific flags was released in https://github.com/astral-sh/python-build-standalone/releases/tag/20240107, which bumped the 3.11 version to 3.11.7.</p>
<p>So when I request 3.11.6 I should get the build that used the <a href="https://github.com/astral-sh/python-build-standalone/releases/tag/20231002">previous</a>, still-buggy version, right? That would explain it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-24 00:07</div>
            <div class="timeline-body"><p>That seems plausible, yeah.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bojanz">@bojanz</a> on 2025-02-24 08:28</div>
            <div class="timeline-body"><p>Mystery solved.</p>
<p>Closing this issue cause there's no bug anymore. Leaving it to you to decide if you want to communicate somewhere that these older Python versions don't build properly with GCC.</p>
<p>Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @bojanz on 2025-02-24 08:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/arielnmz">@arielnmz</a> on 2025-10-23 19:41</div>
            <div class="timeline-body"><p>Can someone please elaborate on what is the problem and why does the Python version and the way it was built affect how the packages are built?
I'm currently dealing with an issue in pycharm not being able to build the cython extensions for debugging and the error message is exactly the same.
In my case I'm using asdf to build and install python (3.12.12) and I also happen to use uv (0.7.12) to handle my env but NOT to build python.
I do see that Pycharm is using the python bin from my .venv to build these extensions:</p>
<pre><code>2025-10-23 12:51:24,544 [ 131627]   INFO - #c.j.p.d.PyCythonExtensionWarning - Compile Cython Extensions /home/ben/project/.venv/bin/python /home/ben/.local/share/JetBrains/Toolbox/apps/pycharm/plugins/python-ce/helpers/pydev/setup_cython.py build_ext --build-lib /home/ben/.cache/JetBrains/PyCharm2025.2/cythonExtensions --build-temp /home/ben/.cache/JetBrains/PyCharm2025.2/cythonExtensions/build
</code></pre>
<p>For now, switching the python version used in my project to my system's python build (python 3.13, Fedora 42) seems to affect the python version used for the build and this time it succeeds:</p>
<pre><code>2025-10-23 13:10:38,149 [1285232]   INFO - #c.j.p.d.PyCythonExtensionWarning - Compile Cython Extensions /usr/bin/python3 /home/ben/.local/share/JetBrains/Toolbox/apps/pycharm/plugins/python-ce/helpers/pydev/setup_cython.py build_ext --build-lib /home/ben/.cache/JetBrains/PyCharm2025.2/cythonExtensions --build-temp /home/ben/.cache/JetBrains/PyCharm2025.2/cythonExtensions/build
</code></pre>
<p>What is going on here? I tried running <code>CC=clang asdf install python 3.12.12</code> but I don't have it installed but WHY does this have to be built in a certain way using a different cc to be able to take in different flags?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/arielnmz">@arielnmz</a> on 2025-10-23 20:37</div>
            <div class="timeline-body"><p>Okay Claude 4 helped me figure this one out:</p>
<ul>
<li>The python binary &quot;inherits&quot; the flags that were used to build it and passes them to setuptools.</li>
<li>Turns out I wasn't using asdf's build but uv's build (possibly from a while ago) because I had .python-version in my project.</li>
<li>After rebuilding the .venv and specifying what python binary to use with <code>--python $(asdf which python)</code> it works now.</li>
</ul>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:01 UTC
    </footer>
</body>
</html>
