```yaml
number: 13104
title: uv does not support --platform flag
type: issue
state: closed
author: rotimi-ajayi
labels:
  - question
assignees: []
created_at: 2025-04-25T11:04:53Z
updated_at: 2025-04-26T14:08:53Z
url: https://github.com/astral-sh/uv/issues/13104
synced_at: 2026-01-10T01:57:30Z
```

# uv does not support --platform flag

---

_Issue opened by @rotimi-ajayi on 2025-04-25 11:04_

### Summary

Trying to pass a `--platform` flag to a uv command:
```
$ uv add faster-whisper --platform=macosx_13_0_universal2 --only-binary=:all: --extra-index-url https://pypi.org/simple

error: unexpected argument '--platform' found
```

### Platform

macOS 12 x86_64

### Version

uv 0.6.12 (e4e03833f 2025-04-02)

### Python version

Python 3.13.0

---

_Label `bug` added by @rotimi-ajayi on 2025-04-25 11:04_

---

_Comment by @konstin on 2025-04-25 11:30_

`uv add` always performs a universal resolution, are you looking for https://docs.astral.sh/uv/concepts/projects/config/#limited-resolution-environments?

---

_Label `bug` removed by @konstin on 2025-04-25 11:30_

---

_Label `question` added by @konstin on 2025-04-25 11:30_

---

_Comment by @rotimi-ajayi on 2025-04-25 12:33_

I'm not sure it does for this
Here is the terminal output for `uv add faster-whisper`
```
$ uv add faster-whisper          
Resolved 64 packages in 5.85s
error: Distribution `onnxruntime==1.21.1 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform

hint: You're on macOS (`macosx_12_0_x86_64`), but `onnxruntime` (v1.21.1) only has wheels for the following platforms: `manylinux_2_27_aarch64`, `manylinux_2_27_x86_64`, `manylinux_2_28_aarch64`, `manylinux_2_28_x86_64`, `macosx_13_0_universal2`, `win_amd64`
```

---

_Comment by @charliermarsh on 2025-04-25 12:33_

You should read this if you're having trouble with packages that _only_ ship built distributions: https://docs.astral.sh/uv/concepts/resolution/#required-environments

---

_Comment by @rotimi-ajayi on 2025-04-25 12:58_

My fear is, won't using the `environments` or `required-environments` code block in `pyproject.toml` affect all other regular packages(that have all the right stuff - Built/source distributions)  I might want to add?
For example, like `uv` adding only packages compatible with my machine only

---

_Comment by @charliermarsh on 2025-04-25 13:28_

No, `required-environments` will just tell uv to backtrack and ensure it includes versions that are compatible with the given environment (for users running on that environment), even if they're older. But if you're trying to support macOS x86, you don't have much of a choice -- you _need_ to use older versions of `onnxruntime`, since they don't seem to publish for Intel macOS anymore.

---

_Comment by @rotimi-ajayi on 2025-04-25 14:25_

Could I use a marker for "platform tags"([here](https://packaging.python.org/en/latest/specifications/platform-compatibility-tags/#:~:text=Basic-,platform,-tags%C2%B6)) for the required-environments like `sys_platform` and set the platform explicitly, as hinted here in `uv` terminal error: "hint: You're on macOS (`macosx_12_0_x86_64`)". `platform_tags` is throwing marker error and can't find any reference of platform tags in docs.

```
[tool.uv]
required-environments = [
    "sys_platform == 'darwin' and platform_tags == 'macosx_12_0_x86_64'",
]
```

---

_Comment by @charliermarsh on 2025-04-26 14:08_

Unfortunately no, but that's not a uv limitation -- that's just how the standard works. The "platform tag" is part of the wheel filename and specification, but environment markers use a different schema: https://peps.python.org/pep-0508/#environment-markers. You probably want:

```toml
[tool.uv]
required-environments = [
    "sys_platform == 'darwin' and platform_machine == 'x86_64'"
]
```

---

_Closed by @charliermarsh on 2025-04-26 14:08_

---
