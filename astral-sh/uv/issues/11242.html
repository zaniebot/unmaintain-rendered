<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invalid checkout setting ``fetch-depth`` in ``publish-docs`` action - astral-sh/uv #11242</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Invalid checkout setting ``fetch-depth`` in ``publish-docs`` action</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/11242">#11242</a>
        opened by <a href="https://github.com/FishAlchemist">@FishAlchemist</a>
        on 2025-02-05 12:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-02-05 12:24</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>This is actually part of #11148, but I don't know how to fix this issue, so I'm opening an issue to let you know.
<code>git-revision-date-localized-plugin</code> requires fetch-depth to be set to 0, and it is written in the configuration file, but the actual operation is set to fail.
https://github.com/timvink/mkdocs-git-revision-date-localized-plugin?tab=readme-ov-file#note-when-using-build-systems-like-github-actions</p>
<ul>
<li><strong>Settings location</strong>
https://github.com/astral-sh/uv/blob/49b85d2e65f82411b76d6ef3a68b3c20fad197f6/.github/workflows/publish-docs.yml#L26-L29</li>
<li><strong>The current running results</strong>
<img src="https://github.com/user-attachments/assets/02735072-9cba-4104-ba35-cb8e646626ee" alt="Image" />
<img src="https://github.com/user-attachments/assets/3921e973-69e0-4e8f-9534-b9bdcb71917c" alt="Image" /></li>
</ul>
<h3>Platform</h3>
<p>Based on the current <code>Github Actions</code> configuration.</p>
<h3>Version</h3>
<p>Unrelated</p>
<h3>Python version</h3>
<p>Based on the current <code>Github Actions</code> configuration.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @FishAlchemist on 2025-02-05 12:24</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-05 14:29</div>
            <div class="timeline-body"><p>What is the net effect here? Are the revision dates wrong?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-02-05 14:36</div>
            <div class="timeline-body"><p>Due to shallow fetching, it is not possible to retrieve the commit history for every file, which results in the inability to read the dates.
The deployed document website currently lacks the 'last updated' timestamp.
<img src="https://github.com/user-attachments/assets/62c2a880-ab3d-4672-8207-1956f44247d2" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-05 15:02</div>
            <div class="timeline-body"><p>Huh thanks for following up on that. It looks correct in the release though</p>
<p><img width="1741" alt="Image" src="https://github.com/user-attachments/assets/e8b369b3-a220-4b04-9323-e8814aa89333" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-02-05 15:35</div>
            <div class="timeline-body"><p>@zanieb The issue is likely that the <code>mkdocs.template.yml</code>  is missing the <code>git-revision-date-localized-plugin</code> plugin.</p>
<p><img src="https://github.com/user-attachments/assets/2982e1c3-93ae-4f93-a166-3975947cc872" alt="Image" /></p>
<p>https://github.com/astral-sh/uv/blob/6f8d9b85d8cdd41b03669dda9374f76ab7b2c7e4/mkdocs.insiders.yml#L1
I previously considered putting the <code>git-revision-date-localized-plugin</code> in <code>mkdocs.template.yml</code>, but unfortunately it didn't work when placed there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-05 15:39</div>
            <div class="timeline-body"><p>Oh, you only put it in the non-insiders file? :D that explains that</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/11246.html">astral-sh/uv#11246</a> on 2025-02-05 15:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-02-05 15:44</div>
            <div class="timeline-body"><p>That seems to be a problem for insiders only. I don't have the permissions to install and update dependencies, so there's no way for me to test and modify them.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-05 15:46</div>
            <div class="timeline-body"><p>Yeah no problem â€” we use insiders for our production docs so those need to be updated for things to take effect.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-02-05 15:56</div>
            <div class="timeline-body"><p><img src="https://github.com/user-attachments/assets/18c95e4b-0c56-4bba-bddd-36fcfc07a939" alt="Image" />
By the way, have you considered allowing non-release CI to also use <code>fetch-depth: 0</code>? Otherwise, these types of issues can only be tested successfully in releases</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-05 16:06</div>
            <div class="timeline-body"><p>You just didn't change it there https://github.com/astral-sh/uv/blob/c54dbcbcc250721e73c35a40e454b7205f90ec4d/.github/workflows/ci.yml#L399</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-05 16:06</div>
            <div class="timeline-body"><p>Adding in https://github.com/astral-sh/uv/pull/11246/commits/ea126ba120833ffcae9bd4873dd9c117f5b97206</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-02-05 16:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-02-05 16:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:25 UTC
    </footer>
</body>
</html>
