<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv lock --script example.py not working - astral-sh/uv #10979</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv lock --script example.py not working</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10979">#10979</a>
        opened by <a href="https://github.com/Kugeleis">@Kugeleis</a>
        on 2025-01-27 08:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Kugeleis">@Kugeleis</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I have a python project with various scripts I'd like to call from command line. The project is managed with uv and has a working venv in project/.venv. Calling a script if I'm in the folder with <code>uv run my_script.py</code> works fine.</p>
<p>Calling the script form somewhere else with <code>uv run /full/path/to/my/project/my_script.py</code> fails with missing dependencies.</p>
<p>I expected the following to cater for this.
According to<a href="https://docs.astral.sh/uv/guides/scripts/#locking-dependencies"> the docs of uv version 0.5.24</a> <code>uv lock --script example.py</code> should create a lock file <code>example.py.lock</code>. It does not. The command line informs with <em>Resolved 103 packages in 3ms</em> and returns without error.</p>
<h3>Platform</h3>
<p>Windows 11</p>
<h3>Version</h3>
<p>0.5.24</p>
<h3>Python version</h3>
<p>3.12.8</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @Kugeleis on 2025-01-27 08:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-27 14:08</div>
            <div class="timeline-body"><p>Sorry, I can't reproduce this with a basic <code>uv init --script example.py</code> and <code>uv lock --script example.py</code> (and the issue itself doesn't include sufficient instructions for a real reproduction of whatever you're doing). I would need more information to help you, like the exact <code>example.py</code> that's failing, the series of commands you're running, and the verbose logs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-01-27 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2025-01-27 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Kugeleis">@Kugeleis</a> on 2025-01-28 08:43</div>
            <div class="timeline-body"><p>@charliermarsh I edited the explanation: I hope it makes the case clearer.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-29 16:11</div>
            <div class="timeline-body"><p>Can you please include the script you're using? Does it have a PEP 723 metadata tag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Kugeleis">@Kugeleis</a> on 2025-01-30 07:43</div>
            <div class="timeline-body"><p>@charliermarsh No, it does not come with inline dependency declaration. I made a <a href="https://github.com/Kugeleis/hello-uv">minimal example</a>. Running <code>uv lock --script hello.py</code> does nothing. Form somewhere else I can call it with <code>uv --project /long/path/to/my/project /long/path/to/my/project/hello.py</code> but this is overly verbose. I should be <code>uv --take-the-project-you-live-in /long/path/to/my/project/hello.py</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-30 14:03</div>
            <div class="timeline-body"><p>It's because <code>hello.py</code> isn't a PEP 723 script. You should run <code>uv init --script hello.py</code> first, which gives you:</p>
<pre><code class="language-python"># /// script
# requires-python = &quot;&gt;=3.13&quot;
# dependencies = []
# ///

import numpy as np
import pandas as pd


def main() -&gt; None:
    print(&quot;Hello from hello-uv!&quot;)
    df = pd.DataFrame(np.random.rand(3, 3))
    print(df)


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p>But we should probably be erroring here or automatically initializing the script.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-01-30 14:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> removed by @charliermarsh on 2025-01-30 14:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2025-01-30 14:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-01-30 20:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:29:33 UTC
    </footer>
</body>
</html>
