<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dependency resolver says no version available, when there are - astral-sh/uv #13900</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Dependency resolver says no version available, when there are</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/13900">#13900</a>
        opened by <a href="https://github.com/signed-log">@signed-log</a>
        on 2025-06-08 17:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/signed-log">@signed-log</a> on 2025-06-08 17:37</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I setup the above pyproject to pull torch from pytorch rocm nightly</p>
<pre><code class="language-toml">[project]
name = &quot;comfyai&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.11&quot;
dependencies = []

[tool.uv.sources]
torch = { index = &quot;pytorch-nightly-6.4&quot; }
torchaudio = { index = &quot;pytorch-nightly-6.4&quot; }
torchvision = { index = &quot;pytorch-nightly-6.4&quot; }
pytorch-triton-rocm = { index = &quot;pytorch-nightly-6.4&quot; }

[[tool.uv.index]]
name = &quot;pytorch-nightly-6.4&quot;
url = &quot;https://download.pytorch.org/whl/nightly/rocm6.4&quot;
explicit = true

[[tool.uv.index]]
name = &quot;pytorch-stable-6.3&quot;
url = &quot;https://download.pytorch.org/whl/rocm6.3&quot;
explicit = true

[tool.uv]
index-strategy = &quot;unsafe-best-match&quot;
</code></pre>
<p>When I try running</p>
<pre><code class="language-bash">uv add --pre torch torchvision torchaudio
</code></pre>
<p>No solution found when resolving dependencies for split (python_full_version &gt;= '3.12'):
╰─▶ Because there is no version of pytorch-triton-rocm{platform_machine == 'x86_64' and sys_platform == 'linux'}==3.3.0+git96316ce5 and
torch&lt;=2.8.0.dev20250520+rocm6.4 depends on pytorch-triton-rocm{platform_machine == 'x86_64' and sys_platform == 'linux'}==3.3.0+git96316ce5, we can conclude
that torch&lt;=2.8.0.dev20250520+rocm6.4 cannot be used.
And because only the following versions of torch are available:
torch==2.8.0.dev20250418+rocm6.4
torch==2.8.0.dev20250419+rocm6.4
torch==2.8.0.dev20250420+rocm6.4
torch==2.8.0.dev20250421+rocm6.4
torch==2.8.0.dev20250422+rocm6.4
torch==2.8.0.dev20250423+rocm6.4
torch==2.8.0.dev20250424+rocm6.4
torch==2.8.0.dev20250425+rocm6.4
torch==2.8.0.dev20250426+rocm6.4
torch==2.8.0.dev20250427+rocm6.4
torch==2.8.0.dev20250428+rocm6.4
torch==2.8.0.dev20250430+rocm6.4
torch==2.8.0.dev20250501+rocm6.4
torch==2.8.0.dev20250502+rocm6.4
torch==2.8.0.dev20250511+rocm6.4
torch==2.8.0.dev20250512+rocm6.4
torch==2.8.0.dev20250513+rocm6.4
torch==2.8.0.dev20250514+rocm6.4
torch==2.8.0.dev20250515+rocm6.4
torch==2.8.0.dev20250516+rocm6.4
torch==2.8.0.dev20250517+rocm6.4
torch==2.8.0.dev20250518+rocm6.4
torch==2.8.0.dev20250519+rocm6.4
torch==2.8.0.dev20250520+rocm6.4
torch==2.8.0.dev20250521+rocm6.4
torch==2.8.0.dev20250522+rocm6.4
torch==2.8.0.dev20250523+rocm6.4
torch==2.8.0.dev20250524+rocm6.4
torch==2.8.0.dev20250525+rocm6.4
torch==2.8.0.dev20250526+rocm6.4
torch==2.8.0.dev20250527+rocm6.4
torch==2.8.0.dev20250528+rocm6.4
torch==2.8.0.dev20250529+rocm6.4
torch==2.8.0.dev20250530+rocm6.4
torch==2.8.0.dev20250531+rocm6.4
torch==2.8.0.dev20250601+rocm6.4
torch==2.8.0.dev20250602+rocm6.4
torch==2.8.0.dev20250603+rocm6.4
torch==2.8.0.dev20250604+rocm6.4
torch==2.8.0.dev20250605+rocm6.4
torch==2.8.0.dev20250606+rocm6.4
torch==2.8.0.dev20250608+rocm6.4
we can conclude that torch&lt;2.8.0.dev20250521+rocm6.4 cannot be used. (1)</p>
<pre><code>  Because there is no version of pytorch-triton-rocm{platform_machine == 'x86_64' and sys_platform == 'linux'}==3.3.1+gitc8757738 and
  torch&gt;=2.8.0.dev20250521+rocm6.4 depends on pytorch-triton-rocm{platform_machine == 'x86_64' and sys_platform == 'linux'}==3.3.1+gitc8757738, we can conclude
  that torch&gt;=2.8.0.dev20250521+rocm6.4 cannot be used.
  And because we know from (1) that torch&lt;2.8.0.dev20250521+rocm6.4 cannot be used, we can conclude that all versions of torch cannot be used.
  And because your project depends on torch, we can conclude that your project's requirements are unsatisfiable.</code></pre>
<p>help: If you want to add the package regardless of the failed resolution, provide the <code>--frozen</code> flag to skip locking and syncing.</p>
<pre><code>
[`pytorch-triton-rocm{platform_machine == 'x86_64' and sys_platform == 'linux'}==3.3.0+git96316ce5`](https://download.pytorch.org/whl/nightly/pytorch_triton_rocm-3.2.0%2Bgitf9cdf582-cp313-cp313-linux_x86_64.whl) did exist at time of posting that issue.

Running

</code></pre>
<p>uv add pytorch-triton-rocm==3.3.0+git96316ce5</p>
<pre><code>
then 

</code></pre>
<p>uv add --pre torch torchvision torchaudio</p>
<pre><code>
makes pytorch install just fine

### Platform

Ubuntu 24.04

### Version

uv 0.7.10 (1e5120e15 2025-06-03)

### Python version

Python 3.13.3
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @signed-log on 2025-06-08 17:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-06-08 18:04</div>
            <div class="timeline-body"><p>I think this is correct given how sources work. Sources are only applied to direct dependencies. If your dependency list is empty, and you run <code>uv add --pre torch torchvision torchaudio</code>, we won't use the <code>pytorch-triton-rocm = { index = &quot;pytorch-nightly-6.4&quot; }</code> source.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-06-08 18:04</div>
            <div class="timeline-body"><p>We're planning to add some warnings for this (see #13829).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-06-09 00:22</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:04 UTC
    </footer>
</body>
</html>
