<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow sparse checkouts/path exclusion for git dependencies - astral-sh/uv #1620</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow sparse checkouts/path exclusion for git dependencies</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/1620">#1620</a>
        opened by <a href="https://github.com/mjclarke94">@mjclarke94</a>
        on 2024-02-18 01:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mjclarke94">@mjclarke94</a></div>
            <div class="timeline-body"><p>We currently have a number of binary files in a <code>tests/data</code> directory which account for 99.9% of the disk usage for a shallow clone (which I believe is already used?), and zero percent of the actual functionality.</p>
<p>If you're installing the contents of this repo into another repo as a git dependency, being able to specify that these paths could be excluded would be really useful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2024-02-18 07:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-design</span> added by @zanieb on 2024-07-01 21:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-01 21:50</div>
            <div class="timeline-body"><p>I think we're blocked on a design for specifying this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/astrojuanlu">@astrojuanlu</a> on 2024-07-03 11:03</div>
            <div class="timeline-body"><p>Doesn't this already work?</p>
<pre><code>$ uv pip install &quot;kedro-airflow @ git+https://github.com/kedro-org/kedro-plugins.git@main#subdirectory=kedro-airflow&quot;
 Updated https://github.com/kedro-org/kedro-plugins.git (92bf6eb)
Resolved 50 packages in 1.50s
Installed 50 packages in 151ms
...
 + kedro-airflow==0.9.0 (from git+https://github.com/kedro-org/kedro-plugins.git@92bf6ebaa249c9e144fc6fee18a83b76973c13f2#subdirectory=kedro-airflow)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mjclarke94">@mjclarke94</a> on 2024-07-04 12:35</div>
            <div class="timeline-body"><p>I think that's more targeted at monorepos containing multiple packages. You might want to have a monorepo in a workspace with packages, in development have a sparse checkout of the repo, then install a subset of them somewhere else later.</p>
<p>Say you had the following structure:</p>
<pre><code>.
├── otherpackage
│  ├── pyproject.toml
│  ├── src
│  └── tests
└── package
   ├── pyproject.toml
   ├── src
   └── tests
</code></pre>
<p>Pointing at the <code>otherpackage</code> subdirectory might (I'm not actually sure if it does?) do a sparse checkout to only grab <code>./otherpackage</code>, but you still inherit a nice chunky tests folder in the process.</p>
<p>There's also something to consider here with how you cache this. Let's say you depend on both packages. You'd potentially only want the repo in the cache once with only the required paths checked out (excluding the two test dirs).</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:23:43 UTC
    </footer>
</body>
</html>
