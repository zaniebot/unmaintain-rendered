<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Improve incompatible `.python-version` error message suggestion - astral-sh/uv #11199</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Improve incompatible `.python-version` error message suggestion</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/11199">#11199</a>
        opened by <a href="https://github.com/edmorley">@edmorley</a>
        on 2025-02-03 22:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/edmorley">@edmorley</a> on 2025-02-03 22:14</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Currently with uv <code>0.5.26</code>, if the Python version in <code>.python-version</code> is incompatible with the <code>requires-python</code> in <code>pyproject.toml</code> an error like the the following is shown (added by #9590):</p>
<pre><code>$ uv init --python 3.13 testcase-uv &amp;&amp; cd $_
Initialized project `testcase-uv` at `/Users/emorley/src/testcase-uv`
$ echo '3.12' &gt; .python-version
$ uv sync
Using CPython 3.12.8 interpreter at: /opt/homebrew/opt/python@3.12/bin/python3.12
error: The Python request from `.python-version` resolved to Python 3.12.8, which is incompatible with the
project's Python requirement: `&gt;=3.13`. Use `uv python pin` to update the `.python-version` file to a
compatible version.
</code></pre>
<p>However, if I take the error message literally, and run just <code>uv python pin</code>, I then am shown this:</p>
<pre><code>$ uv python pin
3.12
warning: The pinned Python version `3.12` is incompatible with the project `requires-python` value of `&gt;=3.13`.
</code></pre>
<p>Instead I need to have either:</p>
<ol>
<li>Run <code>uv python pin 3.13</code></li>
<li>Or, have updated <code>requires-python</code> in <code>pyproject.toml</code> instead</li>
</ol>
<h3>Example</h3>
<p>I think what would help, is some/all of:</p>
<ol>
<li>The original error message to instead say: <code>Use `uv python pin VERSION` ...</code> - where for bonus points <code>VERSION</code> is the actual compatible version number rather than just a static placeholder.</li>
<li>For <code>uv python pin</code> to either have an update option (eg <code>uv python pin --update</code> or <code>uv python pin --compatible</code>) which is then mentioned in both of the error/warning messages output above. Or else for the bare <code>uv python pin</code> command to update the <code>.python-version</code> file automatically/after prompting.</li>
<li>(For bonus points) The original <code>uv sync</code> error message to explain where the <code>&gt;=3.13</code> version came from (ie: <code>requires-python</code> in <code>pyproject.toml</code>) - since I imagine there will be users who used <code>uv init</code> and have no idea that it's set there.</li>
</ol>
<p>Origin of the current wordings:
https://github.com/astral-sh/uv/blob/efbc77bc3743d8cccf07d7a169cd19239638a59b/crates/uv/src/commands/project/mod.rs#L97
https://github.com/astral-sh/uv/blob/dd7cd2e86a6d26f6efacd64de4201a5d43a028de/crates/uv/src/commands/python/pin.rs#L288</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @edmorley on 2025-02-03 22:14</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2025-02-03 22:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-03 22:19</div>
            <div class="timeline-body"><p>Agree these should be better.</p>
<p>As a minor note, I was thinking of using <code>--update</code> for updating a discovered file (which may be in a parent directory) rather than creating a new one: https://github.com/astral-sh/uv/blob/434706389b0a03bed30bfe25dbe5a1b478ee5695/crates/uv/src/commands/python/pin.rs#L129</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edmorley">@edmorley</a> on 2025-02-03 22:21</div>
            <div class="timeline-body"><p>(Btw feel free to treat this and the next few error message UX type issues I'll be filing as low priority - they are for random things I ran into whilst writing integration tests / trying to break things etc, rather than blockers)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-03 22:23</div>
            <div class="timeline-body"><p>It's so hard to extract a suggestible value from an arbitrary <code>requires-python</code> value. We may need to do something like... only suggest when it's a simple lower bound expression? Probably doable if someone digs into it â€” I presume that's why we're not doing it now though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2025-02-03 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @zanieb by @zanieb on 2025-02-03 22:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edmorley">@edmorley</a> on 2025-02-03 22:25</div>
            <div class="timeline-body"><p>Maybe static <code>&lt;VERSION&gt;</code> type placeholder it is then ðŸ˜†</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:32:59 UTC
    </footer>
</body>
</html>
