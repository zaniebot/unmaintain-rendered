<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unable to run tool without &quot;installing&quot; - astral-sh/uv #11413</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Unable to run tool without &quot;installing&quot;</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11413">#11413</a>
        opened by <a href="https://github.com/ecpost">@ecpost</a>
        on 2025-02-11 05:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 05:18</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I recently found out you could run a tool with <code>uvx</code> without &quot;installing&quot; the tool.  So I gave it a try and it didn't work.  So I tried the <code>pycowsay</code> example <a href="https://docs.astral.sh/uv/guides/tools/#running-tools">here</a>, and had the same problem.  It works fine though if I do a regular install of the tool.</p>
<p>If this is a bug, I can try to help track it down.  But I want to make sure I'm not just misundertstanding this feature or making a mistake somewhere.</p>
<p>This is what happens (verbose output further down):</p>
<pre><code>$ cd /private/var/tmp ; mkdir empty ; cd empty
$ uvx pycowsay hello from uv
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay: line 2: /private/var/tmp/empty/--
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python: No such file or directory
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay: line 2: exec: /private/var/tmp/empty/--
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python: cannot execute: No such file or directory
</code></pre>
<p>The <code>uvx pycowsay hello from uv</code> line is the example from the docs.</p>
<p>But a regular install, and then using that same command, is fine:</p>
<pre><code>$ uv tool install pycowsay                              
Resolved 1 package in 1ms
Installed 1 package in 9ms
 + pycowsay==0.0.0.2
Installed 1 executable: pycowsay
$ uvx pycowsay hello from uv
/Users/ecpost/.local/share/uv/tools/pycowsay/lib/python3.13/site-packages/pycowsay/main.py:23: SyntaxWarning: invalid escape sequence '\ '
  &quot;&quot;&quot;

  -------------
&lt; hello from uv &gt;
  -------------
   \   ^__^
    \  (oo)\_______
       (__)\       )\/\
           ||----w |
           ||     ||

</code></pre>
<p>And uninstalling reverts back to the original problem:</p>
<pre><code>$ uv tool uninstall pycowsay
Uninstalled 1 executable: pycowsay
$ uvx pycowsay hello from uv
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay: line 2: /private/var/tmp/empty/--
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python: No such file or directory
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay: line 2: exec: /private/var/tmp/empty/--
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python: cannot execute: No such file or directory
</code></pre>
<p>I've re-installed uv/uvx, following the instructions <a href="https://docs.astral.sh/uv/getting-started/installation/#uninstallation">here</a>, and then installed fresh using the first curl command in the install instructions.</p>
<p>I did have a pre 0.5.0 version before (0.4.26), if that matters.  But I removed uv/uvx from <code>~/.cargo/bin</code>, as instructed before reinstalling.</p>
<p>Verbose output:</p>
<pre><code>$ uvx --verbose pycowsay hello from uv
DEBUG uv 0.5.30 (ddbc6e315 2025-02-10)
DEBUG Searching for default Python interpreter in managed installations or search path
DEBUG Searching for managed installations at `/Users/ecpost/.local/share/uv/python`
DEBUG Found `cpython-3.13.1-macos-x86_64-none` at `/usr/local/bin/python3` (first executable in the search path)
DEBUG Acquired lock for `/Users/ecpost/.local/share/uv/tools`
DEBUG Checking for Python environment at `/Users/ecpost/.local/share/uv/tools/pycowsay`
DEBUG Released lock at `/Users/ecpost/.local/share/uv/tools/.lock`
DEBUG Assessing Python executable as base candidate: /usr/local/opt/python@3.13/bin/python3.13
DEBUG Assessing Python executable as base candidate: /usr/local/opt/python@3.13/Frameworks/Python.framework/Versions/3.13/bin/python3.13
DEBUG Caching via base interpreter: `/usr/local/opt/python@3.13/bin/python3.13`
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.13.1
DEBUG Solving with target Python version: &gt;=3.13.1
DEBUG Adding direct dependency: pycowsay*
DEBUG Found fresh response for: https://pypi.org/simple/pycowsay/
DEBUG Searching for a compatible version of pycowsay (*)
DEBUG Selecting: pycowsay==0.0.0.2 [compatible] (pycowsay-0.0.0.2-py3-none-any.whl)
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/eb/bd/17f894b13037499e615048a6daeb9cae28142ee85ce6eb8d24d10504860b/pycowsay-0.0.0.2-py3-none-any.whl.metadata
DEBUG Tried 1 versions: pycowsay 1
DEBUG marker environment resolution took 0.002s
Resolved 1 package in 2ms
DEBUG Checking for Python environment at `/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq`
DEBUG Running `pycowsay hello from uv`
DEBUG Looking at `.dist-info` at: /Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/lib/python3.13/site-packages/pycowsay-0.0.0.2.dist-info
DEBUG Spawned child 24642 in process group 24641
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay: line 2: /private/var/tmp/empty/--
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python: No such file or directory
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay: line 2: exec: /private/var/tmp/empty/--
/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python: cannot execute: No such file or directory
DEBUG Command exited with code: 126
</code></pre>
<h3>Platform</h3>
<p>macOS Sequoia 15.3, Intel (Darwin 24.3.0 x86_64)</p>
<h3>Version</h3>
<p>uv 0.5.30 (installed via curl)</p>
<h3>Python version</h3>
<p>Python 3.13.1 (installed via brew)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @ecpost on 2025-02-11 05:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-02-11 10:56</div>
            <div class="timeline-body"><p>Can you try <code>uv cache clean</code>?</p>
<p>Otherwise, can you share</p>
<pre><code>cat /Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/pycowsay
ls -lah /Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python
</code></pre>
<p>and check whether the file <code>/Users/ecpost/.cache/uv/archive-v0/axtle42DcQM1MtsnlU4uq/bin/python</code> points to exists?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 19:19</div>
            <div class="timeline-body"><p>Ah, I see what's making it fail it, at least.  That script has some &quot;--&quot; arguments that look like they shoudn't be there.  I went in and deleted them to see what would happen, and it worked.  Do you know anything about those?  Anyway, to answer your questions...</p>
<p>Yeah, I tried <code>uv cache clean</code> before, but I just tried it again, same result.</p>
<p>Here's the output of the cat/ls you asked for (I updated the paths since the cache was cleared).  Notice the &quot;--&quot; arguments for dirname (which just ignores it) and realpath (which adds an extra filename to the output, for a file named &quot;--&quot; in the current directory&quot;).</p>
<pre><code>$ cat /Users/ecpost/.cache/uv/archive-v0/1fsTANBwCeEPKeelIL-te/bin/pycowsay
#!/bin/sh
'''exec' &quot;$(dirname -- &quot;$(realpath -- &quot;$0&quot;)&quot;)&quot;/'python' &quot;$0&quot; &quot;$@&quot;
' '''
# -*- coding: utf-8 -*-
import sys
from pycowsay.main import main
if __name__ == &quot;__main__&quot;:
    if sys.argv[0].endswith(&quot;-script.pyw&quot;):
        sys.argv[0] = sys.argv[0][:-11]
    elif sys.argv[0].endswith(&quot;.exe&quot;):
        sys.argv[0] = sys.argv[0][:-4]
    sys.exit(main())
$ ls -lah /Users/ecpost/.cache/uv/archive-v0/1fsTANBwCeEPKeelIL-te/bin/python
lrwxr-xr-x  1 ecpost  staff    41B Feb 11 10:28 /Users/ecpost/.cache/uv/archive-v0/1fsTANBwCeEPKeelIL-te/bin/python -&gt; /usr/local/opt/python@3.13/bin/python3.13
</code></pre>
<p>And then here's what the python link points to:</p>
<pre><code>$ ls -lah /usr/local/opt/python@3.13/bin/python3.13
lrwxr-xr-x  1 ecpost  admin    59B Dec  3 09:59 /usr/local/opt/python@3.13/bin/python3.13 -&gt; ../Frameworks/Python.framework/Versions/3.13/bin/python3.13
</code></pre>
<p>And what that points to:</p>
<pre><code>$ ls -lah /usr/local/opt/python@3.13/Frameworks/Python.framework/Versions/3.13/bin/python3.13 
-rwxr-xr-x  1 ecpost  admin    13K Dec 27 15:22 /usr/local/opt/python@3.13/Frameworks/Python.framework/Versions/3.13/bin/python3.13
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 19:26</div>
            <div class="timeline-body"><p>I think the shebang there is... correct? The <code>--</code> parts are intentional.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 19:39</div>
            <div class="timeline-body"><p>The shebang makes sense.  But what's the purpose of the <code>--</code> args, though?  I just did a quick search for <code>realpath</code> in the code, and it looks like there's several places scripts like this are generated (with dirname and realpath), and some have the <code>--</code>, and some don't.</p>
<p>Are there systems where <code>--</code> is a valid/meaningful arg for dirname and/or realpath?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 19:44</div>
            <div class="timeline-body"><p>From MacOS (bash or zsh or csh):</p>
<pre><code>$ realpath something
/private/var/tmp/empty/something
$ realpath -- something
/private/var/tmp/empty/--
/private/var/tmp/empty/something
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 19:45</div>
            <div class="timeline-body"><p>I'm also on macOS:</p>
<pre><code>‚ùØ realpath -- something
/Users/crmarsh/workspace/uv/something
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 19:45</div>
            <div class="timeline-body"><p><code>--</code> is used to ensure that the following argument is a positional argument, in the event that it starts with a dash.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 19:57</div>
            <div class="timeline-body"><p>Interesting.  Are you on a very recent MacOS version?  (I updated a few days ago.)  I'm going to try this in some other places...</p>
<p>I know <code>--</code> can mean that for some programs, but I didn't think it was a universal thing, like by the shell.  BTW, if ultimately it turns out that this needs to be removed, I think a possible workaround, if there's a legit concern for a filename starting with a dash, would be to do something like <code>realpath ./&quot;$0&quot;</code> instead of <code>realpath -- &quot;$0&quot;</code>.</p>
<p>And maybe I'm missing something, but if realpath always returns an absolute path, does dirname need <code>--</code>.  (Funnily enough, after taking a closer look at dirname, it's actually working as intended there, for me.  <code>dirname --something</code> gives me an error, <code>dirname -- --something</code> works.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 20:06</div>
            <div class="timeline-body"><p>I also get Charlie's behaviour on an apple silicon mac with macOS 15.3 (24D60).</p>
<p>My ancient intel macbook stuck on 11.7.10 (20G1427) also has Charlie's realpath behaviour.</p>
<p>Mysterious...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-11 20:10</div>
            <div class="timeline-body"><p>I'm not sure what's up, but I really think this would've come up before if it was a pervasive or standard behavior on macOS. We've had this behavior for a long time.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 20:15</div>
            <div class="timeline-body"><p>Yeah, I'm trying to search for any recent comments online about realpath losing <code>--</code> support.  I do see it working on other systems, in linux, etc.  Although I haven't seen it explicitly documented in any man pages.  It's tough to search for &quot;--&quot; üòÄ</p>
<p>I'm going to try updating a macbook I haven't touched lately...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geofft">@geofft</a> on 2025-02-11 20:18</div>
            <div class="timeline-body"><p>What is the output of <code>which realpath</code> or <code>type realpath</code>? (Like do you have an unusual one from Homebrew or something that's first on $PATH?)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 20:27</div>
            <div class="timeline-body"><p>I was just thinking the same thing.  On the macbook I'm updating right now (and it works), it's in /bin.  The mac with the problem is getting it from <code>/usr/local/bin</code>, and is dated 2019.  I have another realpath on the same mac in /bin that works fine with <code>--</code>.</p>
<p>Sorry if I'm wasting people's time here, obviously something's screwed up with my system.  I'll try to track down the source.  (Might be brew.)  Maybe it's not a total waste if anyone else out there has the same issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-02-11 20:36</div>
            <div class="timeline-body"><p>My sincerest condolences for getting Package Managered.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ecpost">@ecpost</a> on 2025-02-11 20:37</div>
            <div class="timeline-body"><p>Considering how old the file is, I doubt this is a common/real problem worth worrying about or someone else would have hit it by now.  Something's messed up on my system that I need to clean up.  Sorry for wasting your time!!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ecpost on 2025-02-11 20:37</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jasongorski">@jasongorski</a> on 2025-07-04 13:52</div>
            <div class="timeline-body"><p><code>uvx run https://‚Ä¶/foo.git</code> in the uv alpine container runs afoul of <code>realpath -- ‚Ä¶</code></p>
<p><code>apk add coreutils</code> as a workaround.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aswild">@aswild</a> on 2025-08-19 16:22</div>
            <div class="timeline-body"><p>As jasongorski mentioned, this is seen issue on standard Alpine Linux containers (including the Alpine-based <code>uv</code> containers)</p>
<pre><code>/ # cd /usr/local/bin
/usr/local/bin # realpath ..
/usr/local
/usr/local/bin # realpath -- ..
realpath: --: No such file or directory
/usr/local
/usr/local/bin # dirname -- $PWD
/usr/local
/usr/local/bin #
</code></pre>
<p>Commands like <code>dirname</code> appear to accept <code>--</code> as an argument separator, but busybox's <code>realpath</code> doesn't.</p>
<p>It's only a cosmetic issue because the error is just printed to stderr and then the subsequent actual argument gets processed normally. Perhaps a strategically placed <code>2&gt;/dev/null</code> in the generated launcher scripts could help?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:00 UTC
    </footer>
</body>
</html>
