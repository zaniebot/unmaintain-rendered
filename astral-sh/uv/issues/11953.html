<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv sync removes `[project.dependencies]` when using scikit-build-core as the build backend - astral-sh/uv #11953</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv sync removes `[project.dependencies]` when using scikit-build-core as the build backend</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11953">#11953</a>
        opened by <a href="https://github.com/mann-patwa">@mann-patwa</a>
        on 2025-03-04 15:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mann-patwa">@mann-patwa</a> on 2025-03-04 15:23</div>
            <div class="timeline-body"><h3>Question</h3>
<h3><strong>Description</strong></h3>
<p>When running <code>uv sync</code>, it installs the dependencies from the <code>[dependency-groups.dev]</code> section correctly but removes all dependencies listed in <code>[project.dependencies]</code>.</p>
<p>However, when I remove scikit-build-core as the build backend from <code>pyproject.toml</code> and then run <code>uv sync</code>, it correctly installs all dependencies, including <code>[project.dependencies]</code>.</p>
<p>This suggests that <code>uv sync</code> might not be handling <code>[project.dependencies]</code> properly when a build backend like scikit-build-core is specified.</p>
<h3><strong>Fixes Tried:</strong></h3>
<p>Installed the <code>[project.dependencies]</code> by using <code>uv pip install -r pyproject.toml</code> which installs the dependencies in the .venv correctly, then ran <code>uv sync</code>, which uninstalled them from <code>.venv</code>.</p>
<p>added dependencies to the <code>[project.dependencies]</code> using <code>uv add some_package</code> which correctly added the dependencies to the <code>[project.dependencies]</code> entry in <code>pyprojoect.toml</code> but does not install it to <code>.venv</code>.
Is there a scenario where:</p>
<h3><strong>Suspected Problem</strong></h3>
<ul>
<li><code>uv sync</code> be prioritizing --group dev and ignoring [project.dependencies] when a build backend is specified?</li>
<li>There is an issue with how scikit-build-core interacts with uv?</li>
</ul>
<h3>Platform</h3>
<p>macOs 15 arm64</p>
<h3>Version</h3>
<p>uv 0.6.3</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @mann-patwa on 2025-03-04 15:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-05 18:54</div>
            <div class="timeline-body"><blockquote>
<p>When running uv sync, it installs the dependencies from the [dependency-groups.dev] section correctly but removes all dependencies listed in [project.dependencies].</p>
</blockquote>
<p>This sounds like the expected behavior if you don't have a <code>[build-system]</code> defined https://docs.astral.sh/uv/concepts/projects/config/#build-systems but you have <code>scikit-buid-core</code> setup?</p>
<p>Can you share your <code>pyproject.toml</code>? See https://docs.astral.sh/uv/reference/troubleshooting/reproducible-examples/ for more guidance.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mann-patwa">@mann-patwa</a> on 2025-03-06 12:15</div>
            <div class="timeline-body"><p>I did have the [build-system] set to <code>scikit-build-core</code>.</p>
<p>I tried to replicate the issue, and I noticed that when I added version = [&quot;dynamic&quot;] to the [project] section, the behavior was reproduced. However, when I removed version = [&quot;dynamic&quot;] and used a static version instead, uv sync worked as expected.
That was the only change I made, but I have no idea why it worked.</p>
<p>This was essentially my old <code>pyproject.toml</code> file for reference:</p>
<pre><code class="language-python">[project]
name = &quot;my-project&quot;
#version = &quot;0.1.0&quot;
description = &quot;3D medical imaging reconstruction software&quot;
license = { file = &quot;LICENSE.txt&quot; }
dependencies = [
    &quot;wxpython&gt;=4.2.1&quot;,
    &quot;pyopengl&gt;=3.1.7&quot;,
    &quot;pyopengl-accelerate&gt;=3.1.7&quot;,
    &quot;numpy&gt;=1.26.4&quot;,
    &quot;scipy&gt;=1.13.0&quot;,
    &quot;matplotlib&gt;=3.8.4&quot;,
    &quot;pillow&gt;=10.3.0&quot;,
    &quot;imageio&gt;=2.34.1&quot;,
    &quot;nibabel&gt;=5.2.1&quot;,
    &quot;scikit-image&gt;=0.23.2&quot;,
    &quot;python-gdcm&gt;=3.0.24.1&quot;,
    &quot;vtk&gt;=9.3.0&quot;,
    &quot;torch&gt;=2.3.0&quot;,
    &quot;cython&gt;=3.0.10&quot;,
    &quot;pypubsub&gt;=4.0.3&quot;,
    &quot;h5py&gt;=3.11.0&quot;,
    &quot;psutil&gt;=5.9.8&quot;,
    &quot;pyserial&gt;=3.5&quot;,
    &quot;pyacvd&gt;=0.2.11&quot;,
    &quot;setuptools&gt;=69.5.1&quot;,
    &quot;aioconsole&gt;=0.7.1&quot;,
    &quot;mido&gt;=1.3.2&quot;,
    &quot;nest-asyncio&gt;=1.6.0&quot;,
    &quot;python-rtmidi&gt;=1.5.8&quot;,
    &quot;python-socketio[client]&gt;=5.11.2&quot;,
    &quot;requests&gt;=2.32.2&quot;,
    &quot;uvicorn[standard]&gt;=0.30.0&quot;,
    &quot;scikit-learn&gt;=1.5.0&quot;,
]
readme = &quot;README.md&quot;
requires-python = &quot;&gt;= 3.10&quot;
dynamic = [&quot;version&quot;]


[build-system]
requires = [&quot;scikit-build-core&quot;, &quot;cython &gt;= 3.0.2&quot;, &quot;numpy &gt;= 1.26.4&quot;]
build-backend = &quot;scikit_build_core.build&quot;

[tool.scikit-build]
experimental = true
metadata.version.provider = &quot;scikit_build_core.metadata.setuptools_scm&quot;
sdist.include = [&quot;invesalius/version.py&quot;]

[tool.setuptools_scm]  # Section required
write_to = &quot;invesalius/version.py&quot;



</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-17 02:07</div>
            <div class="timeline-body"><p>I think it's going to be hard to help without a complete reproduction (like, a Git repo we can clone plus the steps we should run). It's just a lot of work to go from the above to reproducing the behavior, and we may not even be able to do so.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @charliermarsh on 2025-03-17 02:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @charliermarsh on 2025-03-17 02:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @mann-patwa on 2025-03-17 10:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:01 UTC
    </footer>
</body>
</html>
