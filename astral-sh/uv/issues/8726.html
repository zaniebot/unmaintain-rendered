<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv add with constraints gives unexpected result - astral-sh/uv #8726</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>uv add with constraints gives unexpected result</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/8726">#8726</a>
        opened by <a href="https://github.com/itrase">@itrase</a>
        on 2024-10-31 14:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/itrase">@itrase</a> on 2024-10-31 14:12</div>
            <div class="timeline-body"><p>To reproduce (on uv 0.4.29)</p>
<pre><code>mkdir project_a
cd project_a
uv init
uv add torch&gt;=2.4.0
</code></pre>
<p>This results in the toml file:</p>
<pre><code>[project]
name = &quot;project-a&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.11&quot;
dependencies = [
    &quot;torch&gt;=2.5.1&quot;,
]
</code></pre>
<p>Why is the constraint different than what I asked for? Is this the intended behavior, and if so, what is the right way to specify a lower bound using uv add?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-31 14:38</div>
            <div class="timeline-body"><p>Hm interesting. I can't reproduce with a similar example</p>
<pre><code>❯ uv init
Initialized project `example`
❯ uv add 'anyio&gt;0.1'
Resolved 4 packages in 91ms
Installed 3 packages in 6ms
 + anyio==4.6.2.post1
 + idna==3.10
 + sniffio==1.3.1
❯ cat pyproject.toml
[project]
name = &quot;example&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.11&quot;
dependencies = [
    &quot;anyio&gt;0.1&quot;,
]
</code></pre>
<p>or with the example you provided:</p>
<pre><code>❯ uv add 'torch&gt;=2.4.0'
Resolved 24 packages in 480ms
Prepared 9 packages in 3.08s
Installed 10 packages in 132ms
 + filelock==3.16.1
 + fsspec==2024.10.0
 + jinja2==3.1.4
 + markupsafe==3.0.2
 + mpmath==1.3.0
 + networkx==3.4.2
 + setuptools==75.3.0
 + sympy==1.13.1
 + torch==2.5.1
 + typing-extensions==4.12.2
❯ cat pyproject.toml
[project]
name = &quot;project-a&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [
    &quot;torch&gt;=2.4.0&quot;,
]
</code></pre>
<p>Can you share verbose logs for <code>uv add</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/itrase">@itrase</a> on 2024-10-31 15:20</div>
            <div class="timeline-body"><p>Figured it out - I was missing quotes.
<code>uv add torch&gt;=2.4.0</code> doesn't work, and silently drops the requirement
<code>uv add &quot;torch&gt;=2.4.0&quot;</code> works totally fine
So that solves the problem, but I wonder if uv should maybe give a warning when a user gives a constraint that isn't used?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-31 15:21</div>
            <div class="timeline-body"><p>That's a shell problem, uv doesn't even see the <code>&gt;=2.40</code>, your shell removes that before it gets to us, e.g., for <code>echo &quot;test&quot; &gt; file</code> syntax.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-10-31 15:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/itrase">@itrase</a> on 2024-10-31 15:34</div>
            <div class="timeline-body"><p>ah got it - thanks! This can definitely be closed then</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-10-31 15:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:23 UTC
    </footer>
</body>
</html>
