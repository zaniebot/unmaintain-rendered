<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>failed to copy file from /home/runstone/.cache/uv/archive-v0/xxx/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12) - astral-sh/uv #13481</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>failed to copy file from /home/runstone/.cache/uv/archive-v0/xxx/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13481">#13481</a>
        opened by <a href="https://github.com/Abeautifulsnow">@Abeautifulsnow</a>
        on 2025-05-16 02:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Abeautifulsnow">@Abeautifulsnow</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>when I use uv to add some package or uv sync my project, I frequently encouter an error like this: Cannot allocate memory (os error 12)</p>
<pre><code class="language-bash">‚ï∞‚îÄÓäÖÓäÖ uv sync
Resolved 117 packages in 2ms
Uninstalled 21 packages in 32ms
error: Failed to install: urllib3-2.3.0-py3-none-any.whl (urllib3==2.3.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/1AKRcdkKZzDz8LMvn-ZG7/urllib3-2.3.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/urllib3-2.3.0.dist-info/RECORD: Cannot allocate memory (os error 12)

‚ï∞‚îÄÓäÖÓäÖ uv add urllib3
Resolved 117 packages in 1.41s
warning: `aiohttp==3.11.13` is yanked (reason: &quot;Regression: https://github.com/aio-libs/aiohttp/issues/10617&quot;)
warning: `aiohttp==3.11.13` is yanked (reason: &quot;Regression: https://github.com/aio-libs/aiohttp/issues/10617&quot;)
      Built deer-flow @ file:///home/runstone/work/git/deer-flow
Prepared 1 package in 416ms
Uninstalled 17 packages in 26ms
error: Failed to install: h11-0.14.0-py3-none-any.whl (h11==0.14.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)


‚ï∞‚îÄÓäÖÓäÖ uv add uvicorn
Resolved 117 packages in 1ms
      Built deer-flow @ file:///home/runstone/work/git/deer-flow
Prepared 1 package in 1.15s
Uninstalled 17 packages in 35ms
error: Failed to install: urllib3-2.3.0-py3-none-any.whl (urllib3==2.3.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/1AKRcdkKZzDz8LMvn-ZG7/urllib3-2.3.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/urllib3-2.3.0.dist-info/RECORD: Cannot allocate memory (os error 12)

‚ï∞‚îÄÓäÖÓäÖ uv run server.py
      Built deer-flow @ file:///home/runstone/work/git/deer-flow
Uninstalled 17 packages in 36ms
error: Failed to install: h11-0.14.0-py3-none-any.whl (h11==0.14.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)

‚ï∞‚îÄÓäÖÓäÖ uv run python --version
Uninstalled 16 packages in 34ms
error: Failed to install: h11-0.14.0-py3-none-any.whl (h11==0.14.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)
</code></pre>
<h3>Platform</h3>
<p>wsl1(Ubuntu-22.04) Linux 4.4.0-26100-Microsoft x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.7.3</p>
<h3>Python version</h3>
<p>Python 3.12.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @Abeautifulsnow on 2025-05-16 02:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)" to "failed to copy file from /home/runstone/.cache/uv/archive-v0/xxx/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)" by @Abeautifulsnow on 2025-05-16 02:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-16 08:08</div>
            <div class="timeline-body"><p>How much RAM does the machine have, and are there any limits set on WSL1? Do you have any other processes running allocating a lot of memory?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @konstin on 2025-05-16 08:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by @konstin on 2025-05-16 08:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Abeautifulsnow">@Abeautifulsnow</a> on 2025-05-16 09:09</div>
            <div class="timeline-body"><blockquote>
<p>How much RAM does the machine have, and are there any limits set on WSL1? Do you have any other processes running allocating a lot of memory?</p>
</blockquote>
<p><img src="https://github.com/user-attachments/assets/6713cd5c-7dca-4bde-8923-778cbf9ef0d6" alt="Image" /></p>
<p>As you can see from the above, there is still several GB of RAM space available.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-16 09:36</div>
            <div class="timeline-body"><p>Can you share a <code>pyproject.toml</code> that reproduces the problem? Does this happen with any package installation or only with specific packages?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Abeautifulsnow">@Abeautifulsnow</a> on 2025-05-16 15:05</div>
            <div class="timeline-body"><blockquote>
<p>Can you share a <code>pyproject.toml</code> that reproduces the problem? Does this happen with any package installation or only with specific packages?</p>
</blockquote>
<p>Yes, here are the packages in <code>pyproject.toml</code> file.</p>
<pre><code class="language-toml">[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;

[project]
name = &quot;deer-flow&quot;
version = &quot;0.1.0&quot;
description = &quot;DeerFlow project&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [
    &quot;httpx&gt;=0.28.1&quot;,
    &quot;langchain-community&gt;=0.3.19&quot;,
    &quot;langchain-experimental&gt;=0.3.4&quot;,
    &quot;langchain-openai&gt;=0.3.8&quot;,
    &quot;langgraph&gt;=0.3.5&quot;,
    &quot;readabilipy&gt;=0.3.0&quot;,
    &quot;python-dotenv&gt;=1.0.1&quot;,
    &quot;socksio&gt;=1.0.0&quot;,
    &quot;markdownify&gt;=1.1.0&quot;,
    &quot;fastapi&gt;=0.110.0&quot;,
    &quot;uvicorn&gt;=0.27.1&quot;,
    &quot;sse-starlette&gt;=1.6.5&quot;,
    &quot;pandas&gt;=2.2.3&quot;,
    &quot;numpy&gt;=2.2.3&quot;,
    &quot;yfinance&gt;=0.2.54&quot;,
    &quot;litellm&gt;=1.63.11&quot;,
    &quot;json-repair&gt;=0.7.0&quot;,
    &quot;jinja2&gt;=3.1.3&quot;,
    &quot;duckduckgo-search&gt;=8.0.0&quot;,
    &quot;inquirerpy&gt;=0.3.4&quot;,
    &quot;arxiv&gt;=2.2.0&quot;,
    &quot;mcp&gt;=1.6.0&quot;,
    &quot;langchain-mcp-adapters&gt;=0.0.9&quot;,
]
</code></pre>
<blockquote>
<p>Does this happen with any package installation or only with specific packages?</p>
</blockquote>
<p>No, I think it is almost random and unpredictable.</p>
<p>I believe the situation is quite complex. When I have the following configurations in place, installation consistently fails.</p>
<pre><code class="language-toml">[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;
</code></pre>
<p>However, in the absence of these configurations, some packages can be installed successfully. Yet, with certain other packages added to the mix, the installation fails again.</p>
<blockquote>
<p>may success</p>
</blockquote>
<pre><code class="language-toml">[project]
name = &quot;demo&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
    &quot;pandas&gt;=2.2.3&quot;,
    &quot;sqlalchemy&gt;=2.0.38&quot;,
    &quot;jinja2&quot;,
    &quot;pydantic&quot;
]
</code></pre>
<blockquote>
<p>may fail</p>
</blockquote>
<pre><code class="language-toml">readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
    &quot;pandas&gt;=2.2.3&quot;,
    &quot;sqlalchemy&gt;=2.0.38&quot;,
    &quot;jinja2&quot;,
    &quot;pydantic&quot;,
    &quot;langchain&quot;
]
</code></pre>
<p>Error msg:</p>
<pre><code class="language-text">‚ï∞‚îÄÓäÖÓäÖ uv sync
Resolved 42 packages in 1.41s
Uninstalled 21 packages in 2ms
error: Failed to install: pyyaml-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (pyyaml==6.0.2)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/faPVSNCp4ed1tazaCCLvN/PyYAML-6.0.2.dist-info/RECORD to /home/runstone/work/test/demo/.venv/lib/python3.10/site-packages/PyYAML-6.0.2.dist-info/RECORD: Cannot allocate memory (os error 12)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-16 15:08</div>
            <div class="timeline-body"><p>Does reducing the number of concurrent installs, concurrent downloads and concurrent builds help (https://docs.astral.sh/uv/reference/settings/#concurrent-installs)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-05-16 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @konstin on 2025-05-16 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Abeautifulsnow">@Abeautifulsnow</a> on 2025-05-17 07:35</div>
            <div class="timeline-body"><blockquote>
<p>Does reducing the number of concurrent installs, concurrent downloads and concurrent builds help (https://docs.astral.sh/uv/reference/settings/#concurrent-installs)?</p>
</blockquote>
<p>Thank you for your response. I have now set the concurrency level to <code>4</code>, and the builds are mostly successful. I also tried setting it to <code>8, 10, and 20</code>, but in those cases, failures became much more frequent. My machine has 20 CPU cores as reported by <code>nproc</code>. This behavior does seem quite strange. üòÇ</p>
<p>PS: <em>By the way, on my Windows host machine, everything behaves normally ‚Äî there's no need to manually set the concurrency level.</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> removed by @konstin on 2025-05-19 08:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @konstin on 2025-05-19 08:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-19 08:16</div>
            <div class="timeline-body"><p>That means it's a limitation by the platform (WSL1), not by uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-05-19 08:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vuljormp">@vuljormp</a> on 2025-10-07 07:18</div>
            <div class="timeline-body"><p>I ran into the same ‚ÄúCannot allocate memory (os error 12)‚Äù issue when installing the github-specify tool with uv on WSL1.</p>
<p>Just leaving this here in case it helps anyone ‚Äî following @konstin suggestion to limit concurrent installs fixed it for me:</p>
<p>UV_CONCURRENT_INSTALLS=1 uv tool install specify-cli --from git+https://github.com/github/spec-kit.git</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bangbao">@bangbao</a> on 2025-11-12 05:31</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/uv/issues/13481#issuecomment-3375527015
this is useful for me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssbarnea">@ssbarnea</a> on 2025-11-26 12:19</div>
            <div class="timeline-body"><p>To be honest, I think that is is still a valid uv bug because while <code>free -g</code> reports 3 GB of free memory the tools still crashes with OOM. Some code should be added to disable concurrent installs on systems that seem to not have enough memory for such a simple operation.</p>
<p>If we would be talking about having less than 1GB a RAM, it would make sense but for this...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-11-26 15:21</div>
            <div class="timeline-body"><p>Without more data, I don't think there's a good heuristic here. There's some builds that are just a Python process with a few imports and some files, and then there's builds such as uv's own build that take &gt;4GB for a single project (linking with optimizations is the main culprit).</p>
<p>For problems occuring on WSL1 specifically, is there a specific reason why not to upgrade to WSL2 which doesn't have this problem?</p>
<blockquote>
<p>To be honest, I think that is is still a valid uv bug because while <code>free -g</code> reports 3 GB of free memory the tools still crashes with OOM.</p>
</blockquote>
<p>Do you have a reproducible example for this, an the specs (architecture and free RAM pre-build) of the machine where this occurs?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:31:21 UTC
    </footer>
</body>
</html>
