<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can't use django binary that is located in the virtual environment - astral-sh/uv #2027</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Can't use django binary that is located in the virtual environment</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/2027">#2027</a>
        opened by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a>
        on 2024-02-27 22:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-27 22:26</div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>so I created a virtual environment, sourced it, and installed Django. the version that is installed globally is <code>4.2.10</code> but the version I installed in the virtual environment is the latest one <code>5.0.2</code> and this is what I want to share with you</p>
<pre><code>(python-tests) âžœ  python-tests  uv pip install django
â ¦ Resolving dependencies...                                                                                  Resolved 4 packages in 10.64s
Installed 4 packages in 812ms
 + asgiref==3.7.2
 + django==5.0.2
 + sqlparse==0.4.4
 + typing-extensions==4.10.0
(python-tests) âžœ  python-tests  django-admin --version
4.2.10
</code></pre>
<p>and when I typed <code>django-admin startproject myproject .</code> it used django <code>4.2.10</code> not <code>5.0.2</code>
this is uv version</p>
<pre><code>uv --version
uv 0.1.11
</code></pre>
<p>What I think might be the problem is the way you are creating the virtual environment. as when I use <code>pip</code> it uses the global pip not the one in the virtual environment.</p>
<p>What is think about the solution is to provide a way like <code>uv exec some-command</code> like other tools that will use the binaries in the virtual environment, not the global ones.</p>
<p>And in the end, I am sorry that I can't help to solve this problem as the only thing I know about rust is how to type <code>Hello world</code> ðŸ™‚</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-27 22:44</div>
            <div class="timeline-body"><p>Hey there. <code>uv</code> always installs into the virtual environment -- have you tried activating the virtual environment before running <code>django-admin</code>, with something like <code>source .venv/bin/activate</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-02-27 22:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-27 23:34</div>
            <div class="timeline-body"><p>Yes I activated it.</p>
<p>and btw I know that uv installs the packages into the virtual environment and it installs Django successfully. but the problem is when I execute the django binary <code>django-admin</code> (it's like <code>uv</code> binary we get when we install it using pip) even if I sourced the virtual environment <code>source .venv/bin/activate</code> and then runs <code>django-admin</code> the actual <code>django-admin</code> that runs is the global one that is installed outside the virtual environment.</p>
<p>and to give you a better prespective run these commands so you can know what I am facing</p>
<pre><code>pip install &quot;django==4.2.10&quot; # install django &quot;4.2.10&quot; globally
uv venv &amp;&amp; source .venv/bin/activate &amp;&amp; uv pip install &quot;django==5.0.2&quot;

django-admin --version
</code></pre>
<p>the output of the last command should be &quot;5.0.2&quot; but what I am getting is &quot;4.2.10&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-28 02:10</div>
            <div class="timeline-body"><p>@charliermarsh Something else I want you to keep in mind. if I created a virtual environment, activated it, and then ran <code>pip freeze</code> I would get the packages that are installed globally. which as I said earlier might be related to the way you are creating the virtual environment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-28 02:55</div>
            <div class="timeline-body"><blockquote>
<p>if I created a virtual environment, activated it, and then ran pip freeze I would get the packages that are installed globally. which as I said earlier might be related to the way you are creating the virtual environment.</p>
</blockquote>
<p>We don't install <code>pip</code> in virtual environments by default, so you're probably getting the <code>pip</code> from your global installation. What does <code>uv pip freeze</code> show? What happens if you do <code>uv pip install pip</code> then <code>pip freeze</code>?</p>
<p>After activating the virtual environment, is its <code>bin</code> folder earlier than your global Python in the <code>PATH</code> variable? Is there a <code>django-admin</code> binary present in <code>.venv/bin/</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-28 02:56</div>
            <div class="timeline-body"><p>Also the feature you requested is being tracked in #1207</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-28 12:29</div>
            <div class="timeline-body"><p>@zanieb if I installed pip using uv, <code>pip freeze</code> will still give me all packages installed globally. But not a problem as <code>uv pip freeze</code> works in the virtual environment it will be fine.</p>
<p>and yes this <code>bin</code> of the virtual environment is earlier than the global python path. This is the <code>PATH</code> variable if you want to take a look</p>
<pre><code>/tmp/python-tests/.venv/bin:/home/zeyad/.bun/bin:/home/zeyad/.local/bin:/home/zeyad/.modular/pkg/packages.modular.com_mojo/bin:/home/zeyad/.cargo/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/wsl/lib:/mnt/c/Program Files (x86)/Common Files/Oracle/Java/javapath:/mnt/c/Windows/system32:/mnt/c/Windows:/mnt/c/Windows/System32/Wbem:/mnt/c/Windows/System32/WindowsPowerShell/v1.0/:/mnt/c/Windows/System32/OpenSSH/:/mnt/c/Program Files (x86)/NVIDIA Corporation/PhysX/Common:/mnt/c/Program Files/NVIDIA Corporation/NVIDIA NvDLISR:/mnt/c/WINDOWS/system32:/mnt/c/WINDOWS:/mnt/c/WINDOWS/System32/Wbem:/mnt/c/WINDOWS/System32/WindowsPowerShell/v1.0/:/mnt/c/WINDOWS/System32/OpenSSH/:/mnt/c/Program Files/Git/cmd:/mnt/c/Program Files/nodejs/:/mnt/c/Users/Moaz-Mostafa/AppData/Local/Programs/Python/Python311/Scripts:/mnt/c/Program Files/Microsoft VS Code/bin/code:/mnt/c/Users/Moaz-Mostafa/AppData/Local/Microsoft/WindowsApps:/mnt/c/ProgramData/chocolatey/bin:/Docker/host/bin:/mnt/c/Users/Moaz-Mostafa/AppData/Local/Programs/Python/Launcher/:/mnt/c/Users/Moaz-Mostafa/.cargo/bin:/mnt/c/Users/Moaz-Mostafa/AppData/Local/Programs/Microsoft VS Code/bin:/mnt/d/Temp:/mnt/c/Users/Moaz-Mostafa/AppData/Local/Programs/oh-my-posh/bin:/mnt/c/Users/Moaz-Mostafa/AppData/Local/Programs/Hyper/resources/bin:/mnt/c/tools/neovim/nvim-win64/bin:/home/zeyad/Android/Sdk/tools:/home/zeyad/Android/Sdk/platform-tools#:/home/zeyad/.fzf/bin
</code></pre>
<p>the first one is the <code>bin</code> directory of my virtual environment.</p>
<p>and <code>django-admin</code> is also present in the <code>bin</code> directory which is strange btw. it should be executed correctly. What it might be related to??</p>
<p>can you please try to do this yourself. I am using <code>WSL</code>, so this might be the problem.</p>
<p>just run these commands and see what is going on</p>
<pre><code>pip install &quot;django==4.2.10&quot; # install django &quot;4.2.10&quot; globally
uv venv &amp;&amp; source .venv/bin/activate &amp;&amp; uv pip install &quot;django==5.0.2&quot;

django-admin --version
</code></pre>
<p>what the last line gives you?? <code>4.2.10</code> or <code>5.0.2</code> ??</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-28 12:54</div>
            <div class="timeline-body"><p>Unfortunately i can't reproduce the problem on WSL:</p>
<pre><code>~/gh2027$ pip install &quot;django==4.2.10&quot; # install django &quot;4.2.10&quot; globally
Defaulting to user installation because normal site-packages is not writeable
Collecting django==4.2.10
  Using cached Django-4.2.10-py3-none-any.whl (8.0 MB)
Collecting asgiref&lt;4,&gt;=3.6.0
  Using cached asgiref-3.7.2-py3-none-any.whl (24 kB)
Collecting sqlparse&gt;=0.3.1
  Using cached sqlparse-0.4.4-py3-none-any.whl (41 kB)
Collecting typing-extensions&gt;=4
  Using cached typing_extensions-4.10.0-py3-none-any.whl (33 kB)
Installing collected packages: typing-extensions, sqlparse, asgiref, django
Successfully installed asgiref-3.7.2 django-4.2.10 sqlparse-0.4.4 typing-extensions-4.10.0
~/gh2027$ uv venv &amp;&amp; source .venv/bin/activate &amp;&amp; uv pip install &quot;django==5.0.2&quot;
Using Python 3.10.12 interpreter at /usr/bin/python3
Creating virtualenv at: .venv
Activate with: source .venv/bin/activate
Resolved 4 packages in 2ms
Installed 4 packages in 174ms
 + asgiref==3.7.2
 + django==5.0.2
 + sqlparse==0.4.4
 + typing-extensions==4.10.0
(gh2027) ~/gh2027$ django-admin --version
5.0.2
</code></pre>
<ul>
<li><code>python --version</code>: 3.10.2</li>
<li><code>python -c &quot;import sys; print(sys.path)&quot;</code>: <code>['', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/home/konsti/gh2027/.venv/lib/python3.10/site-packages']</code></li>
<li>OS: Ubuntu 22.04.4</li>
<li><code>python -m sysconfig</code>:</li>
</ul>
<pre><code>Platform: &quot;linux-x86_64&quot;
Python version: &quot;3.10&quot;
Current installation scheme: &quot;posix_prefix&quot;

Paths:
        data = &quot;/home/konsti/gh2027/.venv&quot;
        include = &quot;/usr/include/python3.10&quot;
        platinclude = &quot;/usr/include/python3.10&quot;
        platlib = &quot;/home/konsti/gh2027/.venv/lib/python3.10/site-packages&quot;
        platstdlib = &quot;/home/konsti/gh2027/.venv/lib/python3.10&quot;
        purelib = &quot;/home/konsti/gh2027/.venv/lib/python3.10/site-packages&quot;
        scripts = &quot;/home/konsti/gh2027/.venv/bin&quot;
        stdlib = &quot;/usr/lib/python3.10&quot;`
</code></pre>
<p><code>PATH</code> starts with <code>/home/konsti/gh2027/.venv/bin:</code> and <code>VIRTUAL_ENV</code> is <code>/home/konsti/gh2027/.venv</code>.</p>
<p>How did you install python, and what do <code>python -c &quot;import sys; print(sys.path)&quot;</code> and <code>python -m sysconfig</code> say for you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-28 14:21</div>
            <div class="timeline-body"><p>@konstin I can't remember how I installed Python but I think it was using the <code>apt</code> package manager</p>
<p>when I activate the virtual environment the <code>python -c &quot;import sys; print(sys.path)&quot;</code> gives me <code>['', '/usr/lib/python310.zip', '/usr/lib/python3.10', '/usr/lib/python3.10/lib-dynload', '/tmp/python-tests/.venv/lib/python3.10/site-packages']</code></p>
<p>and the <code>python -m sysconfig</code> gives me</p>
<pre><code class="language-Paths:">        data = &quot;/tmp/python-tests/.venv&quot;
        include = &quot;/usr/include/python3.10&quot;
        platinclude = &quot;/usr/include/python3.10&quot;
        platlib = &quot;/tmp/python-tests/.venv/lib/python3.10/site-packages&quot;
        platstdlib = &quot;/tmp/python-tests/.venv/lib/python3.10&quot;
        purelib = &quot;/tmp/python-tests/.venv/lib/python3.10/site-packages&quot;
        scripts = &quot;/tmp/python-tests/.venv/bin&quot;
        stdlib = &quot;/usr/lib/python3.10&quot;
</code></pre>
<p>this is strange btw if you look at the scripts you will notice that it uses the <code>bin</code> of the virtual environment which should make be able to use <code>django-admin</code> without any problem. I will ask you to see this and tell me if I did something wrong.<a href="https://asciinema.org/a/Px6IRN6VDRgyBAVQpsSoerAph"><img src="https://asciinema.org/a/Px6IRN6VDRgyBAVQpsSoerAph.svg" alt="asciicast" /></a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-28 14:46</div>
            <div class="timeline-body"><p>Can you try cleaning the uv cache (<code>uv clean</code>) and after reinstalling, try running <code>.venv/bin/django-admin</code> directly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-28 15:25</div>
            <div class="timeline-body"><p>@konstin I tried to clear the cache but I still have the same problem. I tried to use <code>.venv/bin/django-admin</code> and it worked successfully but the problem I am afraid of is this may affect some other components of <code>uv</code>.</p>
<p>And btw I tried to delete uv bin from <code>~/.cargo/bin/uv</code> and re-install it but I still had the same problem. I will use <code>.venv/bin/django-admin</code> but I hope that this be fixed in some way. I am going to leave this issue opened but if you want to close it that's ok.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-28 23:31</div>
            <div class="timeline-body"><p>@konstin I just want to ask you about something. when I activate the virtual environment, I get this <code>(python-tests) âžœ  python-tests</code> shouldn't it be like <code>(.venv) âžœ  python-tests</code> or you have changed it??</p>
<p>And btw I tried to run <code>uv</code> on my Windows machine and everything worked ok so I believe that there is something wrong with my <code>uv</code>. As I said earlier I removed <code>uv</code> from <code>~/.cargo/bin/uv</code> and installed it again. Should I delete something else so I can make sure that I have completely uninstalled <code>uv</code> from my WSL?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-29 00:09</div>
            <div class="timeline-body"><p>@konstin I am sorry for calling you several times but I just finally fixed the problem and I have no idea how it was fixed.</p>
<p>in the <code>.venv/bin/activate</code> in line 80 I saw <code>VIRTUAL_ENV_PROMPT=&quot;dummy&quot;</code> as <code>dummy</code> is the parent directory of the virtual environment. and I just changed <code>dummy</code> to <code>.venv</code> and then deactivated the virtual environment and activated it again and everything worked just fine. I just hope to know why it gives me &quot;dummy&quot; when it should give me &quot;.venv&quot; automatically??</p>
<p>See this if you want <a href="https://asciinema.org/a/sj9PZ6c9kkNaRRVSwIkUisH5q"><img src="https://asciinema.org/a/sj9PZ6c9kkNaRRVSwIkUisH5q.svg" alt="asciicast" /></a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-02-29 09:04</div>
            <div class="timeline-body"><p>Sorry, no idea why this makes a difference</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-02-29 15:49</div>
            <div class="timeline-body"><p>I have no idea also. But the question is do you know why it's &quot;dummy&quot; not &quot;.venv&quot; ?? if we just solved this, then everything will be OK.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-02 14:51</div>
            <div class="timeline-body"><p>The prompt should only be cosmetic i.e. it's just the text that's displayed to identify the virtual environment. I also could not reproduce this on macOS â€” I'm not sure what's going on but it does seem specific to something in your environment. If there's something that relies on <code>VIRTUAL_ENV_PROMPT</code> to determine binaries in your path, that sounds like a bug with their software.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-02 17:39</div>
            <div class="timeline-body"><p>I'm going to close this so we can keep the issue tracker actionable, thanks for all your investigation let us know if you find out more.</p>
<p>#1570 has more details on the default prompt value.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-03-02 17:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ZeyadMoustafaKamal">@ZeyadMoustafaKamal</a> on 2024-03-03 23:24</div>
            <div class="timeline-body"><p>For anyone having the same problem I just noticed that the problem isn't with the <code>VIRTUAL_ENV_PROMPT</code> it's all that after installing <code>Django</code> you will just have to deactivate and activate the virtual environment again.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:18 UTC
    </footer>
</body>
</html>
