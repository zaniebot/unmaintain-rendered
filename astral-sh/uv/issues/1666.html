<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support alternative requirements file encodings - astral-sh/uv #1666</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support alternative requirements file encodings</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1666">#1666</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2024-02-18 21:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><p>e.g. <code>UTF16-LE</code></p>
<blockquote>
<p>This works, but <code>poetry export &gt; requirements.txt</code> creates UTF16-LE file, while <code>uv pip install -r requirements.txt</code> expects UTF-8, so I manually need to re-save it in UTF8. It is not a problem, but would be cool if <code>uv</code> would detect input file encoding...</p>
<pre><code>uv pip install -r .\requirements.txt
error: failed to read from file `.\requirements.txt`
  Caused by: stream did not contain valid UTF-8
</code></pre>
</blockquote>
<p><em>Originally posted by @Warchant in https://github.com/astral-sh/uv/issues/1634#issuecomment-1951402367</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2024-02-18 21:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @zanieb on 2024-02-18 21:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mitsuhiko">@mitsuhiko</a> on 2024-02-18 22:46</div>
            <div class="timeline-body"><p>For sake of not making an even bigger mess in the ecosystem it would be ideal if this stays as UTF-8. I'm perplexed that poetry would generate a UTF-16 file and I can only assume this is because it picks up some weird default encoding by accident.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-19 00:03</div>
            <div class="timeline-body"><p>That's a fair point, it'd be nice to use a consistent encoding.</p>
<p>cc @Secrus</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dimbleby">@dimbleby</a> on 2024-02-19 00:14</div>
            <div class="timeline-body"><p>Poetry does not generate a utf-16 file.</p>
<p>If told a filename to write to, it writes utf-8.  However OP is redirecting stdout, presumably the encoding is whatever the python interpreter says it is in that environment</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Secrus">@Secrus</a> on 2024-02-19 00:14</div>
            <div class="timeline-body"><p>The UTF-16 encoding was most likely picked up from the environment. As I stated in <a href="https://github.com/astral-sh/uv/issues/1634#issuecomment-1951496960">here</a>, stream redirection is not the way to export to requirements file. We use UTF-8 when writing to files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-19 00:16</div>
            <div class="timeline-body"><p>Great thanks for the background! It seems safe to close this. Happy to hear more use-cases if they exist though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-02-19 00:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @zanieb on 2024-02-19 00:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2024-03-08 14:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> removed by @zanieb on 2024-03-08 14:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:23:46 UTC
    </footer>
</body>
</html>
