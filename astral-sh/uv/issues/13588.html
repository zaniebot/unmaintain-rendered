<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom Index timeout error - astral-sh/uv #13588</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Custom Index timeout error</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13588">#13588</a>
        opened by <a href="https://github.com/shiftysheep">@shiftysheep</a>
        on 2025-05-21 23:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/shiftysheep">@shiftysheep</a></div>
            <div class="timeline-body"><h3>Question</h3>
<p>Is there a way to suppress timeout errors for a custom index and default back to pypi? I have specified a custom index in <code>/etc/uv/uv.toml</code> without the default setting. This works great when I'm connected to the VPN and have access to the index. Unfortunately, when I'm not on the VPN UV continues to try the index and errors out without trying to check against pypi. I have even manually added a second index configuration for pypi with the default flag, but it errors out on the timeout.</p>
<h3>Platform</h3>
<p>Linux 5.15.167.4-microsoft-standard-WSL2 x86_64 GNU/Linux</p>
<h3>Version</h3>
<p>uv 0.7.6</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @shiftysheep on 2025-05-21 23:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hutchisr">@hutchisr</a> on 2025-05-23 00:03</div>
            <div class="timeline-body"><p>Ran into the same issue today on 0.7.7. It exclusively tries to use the custom index, even when the lockfile specifies the default pypi index for a package.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-23 08:18</div>
            <div class="timeline-body"><p>There is <code>UV_HTTP_TIMEOUT</code> to configure this.</p>
<p>@hutchisr That sounds different, can you double check that this doesn't match the documented behavior (uv is different here than pip), and open a new issue if not?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shiftysheep">@shiftysheep</a> on 2025-05-23 16:37</div>
            <div class="timeline-body"><p>@konstin I tried playing with the environment variable but it just errors out quickly and stops processing. Even if it could successfully get to pypi it just errors out. See the screenshot.</p>
<p>Error:
<img src="https://github.com/user-attachments/assets/1d4cdf7d-6cc9-4957-b2bf-0d3920e0ca4a" alt="Image" /></p>
<p>Config:
<img src="https://github.com/user-attachments/assets/f70bf7fc-34fa-450f-9190-3d2816a1ed51" alt="Image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-23 16:38</div>
            <div class="timeline-body"><p>Connection refused means there's not a timeout, it means that you can't connect all, either the URL is wrong or there is some firewall blocking this out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shiftysheep">@shiftysheep</a> on 2025-05-23 16:46</div>
            <div class="timeline-body"><p>The timeout timer is definitely being hit as if I run <code>UV_HTTP_TIMEOUT=2 uv sync</code> it will reduce the time from 30s to 2s for each retry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-26 13:15</div>
            <div class="timeline-body"><p>To clarify, does uv fail after hitting the timeout no matter what timeout you set?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shiftysheep">@shiftysheep</a> on 2025-05-26 16:41</div>
            <div class="timeline-body"><p>Yeah. The timeout value just affects how quickly the process will error out completely if an index is unavailable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-26 22:13</div>
            <div class="timeline-body"><p>Does <code>--offline</code> work you? Generally, uv expects all declared indexes to be available, that flags makes uv the cache which should still exist from the time you were in the VPN.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-07-16 13:54</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:31:28 UTC
    </footer>
</body>
</html>
