<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing libssh.h headers cause silent hang - astral-sh/uv #16079</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Missing libssh.h headers cause silent hang</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16079">#16079</a>
        opened by <a href="https://github.com/nedbat">@nedbat</a>
        on 2025-09-30 19:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/nedbat">@nedbat</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>On my Mac (15.7.1), I run:</p>
<pre><code>% uv pip install ansible-pylibssh
Resolved 1 package in 328ms
   Building ansible-pylibssh==1.2.2
â ‡ Preparing packages... (0/1)
</code></pre>
<p>and it stops, never finishing.</p>
<p>Adding <code>-v</code>, I see:</p>
<pre><code>DEBUG Tried 5 versions: cython 1, expandvars 1, packaging 1, setuptools 1, setuptools-scm 1
DEBUG marker environment resolution took 0.039s
DEBUG Installing in packaging==25.0, expandvars==1.1.2, setuptools-scm==9.2.0, cython==3.1.4, setuptools==80.9.0 in /Users/nbatchelder/.cache/uv/builds-v0/.tmpjdiNy3
DEBUG Requirement already installed: packaging==25.0
DEBUG Requirement already installed: expandvars==1.1.2
DEBUG Requirement already installed: setuptools-scm==9.2.0
DEBUG Registry requirement already cached: cython==3.1.4
DEBUG Requirement already installed: setuptools==80.9.0
DEBUG Installing build requirement: cython==3.1.4
DEBUG Calling `pep517_backend.hooks.build_wheel(&quot;/Users/nbatchelder/.cache/uv/builds-v0/.tmpGJIDGB&quot;, {}, None)`
DEBUG [1/1] Cythonizing /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/_libssh_version.pyx
DEBUG [1/1] Cythonizing /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/errors.pyx
DEBUG [1/1] Cythonizing /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/sftp.pyx
DEBUG [1/1] Cythonizing /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/session.pyx
DEBUG [1/1] Cythonizing /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/channel.pyx
DEBUG [1/1] Cythonizing /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/scp.pyx
DEBUG /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/sftp.c:1138:10: fatal error: 'libssh/libssh.h' file not found
DEBUG  1138 | #include &quot;libssh/libssh.h&quot;
DEBUG       |          ^~~~~~~~~~~~~~~~~
DEBUG /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/errors.c/private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/channel.c::11371138::1010::  fatal error: fatal error: 'libssh/libssh.h' file not found'libssh/libssh.h' file not found
DEBUG
DEBUG /private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/session.c :11371138 | :#10i:n cfatal error: l'libssh/libssh.h' file not foundu
DEBUG de/private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/scp.c: 1138:10:  fatal error: 1138'libssh/libssh.h' file not found |
DEBUG #/private/var/folders/26/r96mj7hd38s7_2djcsd9qqp80000gn/T/.tmp-ansible-pylibssh-pep517-6g3n_u3e/src/src/pylibsshext/_libssh_version.cin:c1135l:u10&quot; li1138b | s# i1138d | #ei ns:nhc/lluidbes &quot;&quot;lliibbscslhsssh/hu.dhe&quot;
DEBUG &quot;      l fatal error: l'libssh/libssh.h' file not foundi
DEBUG b| s         ^~~~~~~~~~~~~~~~~s
DEBUG h/ /liilbis1135s | h.h&quot;
DEBUG       #inclubbdses &quot;slsh.h&quot;
DEBUG       |          ^~~~~~~~~~~~~~~~~
DEBUG h| .h         ^~~~~~~~~~~~~~~~~
DEBUG &quot;
DEBUG       |          ^~~~~~~~~~~~~~~~~
DEBUG ibssh/libssh.h&quot;
DEBUG       |          ^~~~~~~~~~~~~~~~~
DEBUG 1 error generated.
DEBUG error: command '/usr/bin/gcc' failed with exit code 1
DEBUG 1 error generated.
DEBUG 1 error generated.
DEBUG error: command '/usr/bin/gcc' failed with exit code 1
DEBUG error: command '/usr/bin/gcc' failed with exit code 1
DEBUG 1 error generated.
DEBUG 1 error generated.
DEBUG error: command '/usr/bin/gcc' failed with exit code 1
DEBUG error: command '/usr/bin/gcc' failed with exit code 1
DEBUG 1 error generated.
DEBUG error: command '/usr/bin/gcc' failed with exit code 1
</code></pre>
<p>(sometimes the errors are interleaved as here, sometimes not.)</p>
<h3>Platform</h3>
<p>Mac 15.7.1</p>
<h3>Version</h3>
<p>uv 0.8.22 (ade2bdbd2 2025-09-23)</p>
<h3>Python version</h3>
<p>Python 3.11.13</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @nedbat on 2025-09-30 19:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-30 19:59</div>
            <div class="timeline-body"><p>This is a <code>ansible-pylibssh</code> build problem. I'm not sure why they don't exit on failure. I don't think we can time out builds, since they sometimes do legitimately take a long time. I think you'll need to take this up with <code>cython</code> and / or <code>ansible-pylibssh</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">external</span> added by @zanieb on 2025-09-30 19:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @konstin on 2025-10-01 09:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-10-01 09:54</div>
            <div class="timeline-body"><p>I can reproduce the same hang with <code>python -m build</code> after cloning their repository.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nedbat">@nedbat</a> on 2025-10-01 11:26</div>
            <div class="timeline-body"><p>OK, thanks.  Maybe uv could  try to not interleave the error messages, but I guess that's a separate issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @nedbat on 2025-10-01 11:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/webknjaz">@webknjaz</a> on 2025-10-22 02:05</div>
            <div class="timeline-body"><p>The upstream fix is in (https://github.com/cython/cython/pull/7183 / https://github.com/cython/cython/commit/440b19a36e3c145f6ba6a7b84199c246c1902184). It is supposed to become a part of Cython 3.2b1.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/webknjaz">@webknjaz</a> on 2025-10-24 12:45</div>
            <div class="timeline-body"><p><em>UPD:</em> it was also backported into Cython 3.1.6.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:33:02 UTC
    </footer>
</body>
</html>
