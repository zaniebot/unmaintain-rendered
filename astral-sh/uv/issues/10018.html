<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pip install of uv can fail for Python &lt; 3.10 with certain Debian Python distributions - astral-sh/uv #10018</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>pip install of uv can fail for Python &lt; 3.10 with certain Debian Python distributions</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/10018">#10018</a>
        opened by <a href="https://github.com/mason3k">@mason3k</a>
        on 2024-12-19 02:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mason3k">@mason3k</a></div>
            <div class="timeline-body"><p>I love the project and am grateful for all the work!</p>
<p>I noticed an issue that arose due to a confluence of bad user behaviors. For Python &lt; 3.10 (bad) when using the Debian-based distribution of Python (bad) and not using a venv or pipx (bad), the pip installation of uv can install <code>uv</code> to a scripts location that <code>find_uv_bin()</code> then fails to find.</p>
<pre><code class="language-repl">root:/# python3.9 -m pip install uv
Collecting uv
  Using cached uv-0.5.10-py3-none-manylinux_2_28_aarch64.whl.metadata (11 kB)
Using cached uv-0.5.10-py3-none-manylinux_2_28_aarch64.whl (13.9 MB)
Installing collected packages: uv
Successfully installed uv-0.5.10
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.

root:/# python3.9 -m uv            
Traceback (most recent call last):
  File &quot;/usr/lib/python3.9/runpy.py&quot;, line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File &quot;/usr/lib/python3.9/runpy.py&quot;, line 87, in _run_code
    exec(code, run_globals)
  File &quot;/usr/local/lib/python3.9/dist-packages/uv/__main__.py&quot;, line 47, in &lt;module&gt;
    _run()
  File &quot;/usr/local/lib/python3.9/dist-packages/uv/__main__.py&quot;, line 27, in _run
    uv = os.fsdecode(find_uv_bin())
  File &quot;/usr/local/lib/python3.9/dist-packages/uv/_find_uv.py&quot;, line 36, in find_uv_bin
    raise FileNotFoundError(path)
FileNotFoundError: /root/.local/bin/uv
</code></pre>
<p>I believe what's happening here is actually a known irritation with the Debian distribution of Python: it is patched s.t. scripts are installed to <code>/usr/local</code> (https://wiki.debian.org/Python#Deviations_from_upstream), but there is not the appropriate corresponding adjustment in <code>sysconfig</code>, which still points to <code>/usr/bin</code> for the scripts location. So, in this case, we have:</p>
<pre><code class="language-repl">root:/# python3.9
Python 3.9.5 (default, Nov 23 2021, 15:27:38) 
[GCC 9.3.0] on linux
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import sysconfig
&gt;&gt;&gt; sysconfig.get_path(&quot;scripts&quot;)
'/usr/bin'
</code></pre>
<p>vs.</p>
<pre><code class="language-repl">root:/# whereis uv
uv: /usr/local/bin/uv
</code></pre>
<p><code>find_uv_bin()</code> starts by checking <code>os.path.join(sysconfig.get_path(&quot;scripts&quot;), uv_exe)</code></p>
<p>There is a cri de c≈ìur on this topic (along with some unsatisfying solutions) here: https://ffy00.github.io/blog/02-python-debian-and-the-install-locations/</p>
<p>Not sure if this is something you want to address or not, but considering the size of the project I thought someone else might run into it. I switched to the standalone installer in this Docker image and that works well.</p>
<hr />
<p>Details:</p>
<p>This is a Docker container</p>
<p>Distributor ID:	Ubuntu
Description:	Ubuntu 20.04.6 LTS
Release:	20.04
Codename:	focal
6.10.11-linuxkit
Python 3.9.5
Python installed via <code>apt-get install python3.9</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 02:59</div>
            <div class="timeline-body"><p>Thank you!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-12-19 03:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-12-19 03:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 03:13</div>
            <div class="timeline-body"><p>Which container should I use to reproduce this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 03:17</div>
            <div class="timeline-body"><p>Nevermind, I reproduced with <code>debian:bullseye</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 03:18</div>
            <div class="timeline-body"><p>This honestly might not be fixable hah.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 03:40</div>
            <div class="timeline-body"><p>I guess we could sniff for debian and check <code>import distutils.dist</code>, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-12-19 03:41</div>
            <div class="timeline-body"><p>I'm curious if you have <code>python3.9-disutils</code> installed in your example?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mason3k">@mason3k</a> on 2024-12-19 16:37</div>
            <div class="timeline-body"><p>Thanks for the quick reply! I do have <code>python3-distutils</code> preinstalled but not <code>python3.9-distutils</code>
<code>python3-distutils 3.8.10-0ubuntu1~20.04  all  distutils package for Python 3.x</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mason3k">@mason3k</a> on 2024-12-19 16:37</div>
            <div class="timeline-body"><p>Per this <a href="https://github.com/pypa/pip/blob/3b91f42e461de3f23e9bed46a8c5695435f930fb/src/pip/_internal/locations/__init__.py#L328">code</a>, it appears this might affect Red Hat as well? And along the lines you suggest, it looks like pip uses <code>distutils</code> for scheme logic <a href="https://github.com/pypa/pip/blob/3b91f42e461de3f23e9bed46a8c5695435f930fb/src/pip/_internal/locations/__init__.py#L46">for versions &lt;= 3.9</a>. But it looks kind of nasty.</p>
<p>The more I look at this, there more I'm starting to think this is a whole can of worms to accommodate an upstream problem, and for Python versions that are almost all EOL. At the end of the day...users probably <em>should</em> be using <code>pipx</code> or a virtual environment, and in a container, the docs already point to a lot of good ways to install uv that don't run into this. So I could definitely see the argument to defer on this and see if anyone else runs into it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:28:58 UTC
    </footer>
</body>
</html>
