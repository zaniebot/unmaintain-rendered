<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>build backend - issue with license metadata element - astral-sh/uv #9947</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>build backend - issue with license metadata element</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9947">#9947</a>
        opened by <a href="https://github.com/cthoyt">@cthoyt</a>
        on 2024-12-16 22:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/cthoyt">@cthoyt</a></div>
            <div class="timeline-body"><p>I'm on uv 0.5.8 (80d41671b 2024-12-11). Update: I also tried this on uv 0.5.9 (0652800cb 2024-12-13) and got the same results.</p>
<p>I created an example project and added a dummy license file to it with:</p>
<pre><code class="language-console">$ uv --preview init xyz --build-backend uv
$ touch xyz/LICENSE
</code></pre>
<p>I'm not sure if there's an interface through uv to add metadata to pyproject.toml, but I added the following license declaration under the <code>[project]</code> section:</p>
<pre><code>license = { file = &quot;LICENSE&quot; }
</code></pre>
<p>Then, I got the following error with builds:</p>
<pre><code class="language-console">$ uv --preview build
Building source distribution (uv build backend)...
Building wheel from source distribution (uv build backend)...
  × Failed to build `/Users/cthoyt/Desktop/xyz`
  ╰─▶ failed to open file
      `/Users/cthoyt/Library/Caches/uv/sdists-v6/.tmp5tXXVU/xyz-0.1.0/LICENSE`: No such
      file or directory (os error 2)
</code></pre>
<p>Interestingly, the following works, which doesn't try building the wheel from the sdist:</p>
<pre><code class="language-console">$ uv --preview build --sdist --wheel
Building source distribution (uv build backend)...
Building wheel (uv build backend)...
Successfully built dist/xyz-0.1.0.tar.gz
Successfully built dist/xyz-0.1.0-py3-none-any.whl
</code></pre>
<p>If I trade the license declaration for the following, it works.</p>
<pre><code>license-files = [
    &quot;LICENSE&quot;
]
</code></pre>
<p>However, it's not clear if this is because the <code>license</code> element of the metadata is deprecated, or if there's a bug in handling it. I am aware that the metadata versions and the license declarations are currently a sore spot, so thanks for any advice :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @konstin by @zanieb on 2024-12-16 22:26</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @konstin on 2024-12-17 10:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-12-17 11:05</div>
            <div class="timeline-body"><p>We recommend using the PEP 639 <code>license = &quot;&lt;SPDX expression&gt;&quot;</code> and <code>license-files = [&quot;LICENSE&quot;]</code> declarations, however the old behavior is definitely a bug (#9965)!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2024-12-17 14:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:28:55 UTC
    </footer>
</body>
</html>
