```yaml
number: 15917
title: "Support `tool.hatch.build.dev-mode-dirs` without requiring project dependencies to be installed"
type: issue
state: open
author: NellyWhads
labels:
  - enhancement
assignees: []
created_at: 2025-09-17T18:28:07Z
updated_at: 2025-09-19T13:50:40Z
url: https://github.com/astral-sh/uv/issues/15917
synced_at: 2026-01-10T01:57:35Z
```

# Support `tool.hatch.build.dev-mode-dirs` without requiring project dependencies to be installed

---

_Issue opened by @NellyWhads on 2025-09-17 18:28_

### Summary

I would like to prepare a project's environment such that:
1. A specific optional dependency group's dependencies are installed
2. The project's source code is accessible in the python interpreter
3. The project's `dev-mode-dirs` are available in the python interpreter
4. All other dependencies, including the core `project` dependencies are not installed

The immediate use case is to reference a custom commit parser module for `python-semantic-release` when versioning, building, and releasing the wheel.

Though the example below is simple, various default and non-default groups include dependencies that cannot be installed on the CI runner instance where the package release processes needs to be executed.

### Example

<details><summary>`pyproject.toml`</summary>
<p>

```toml
[build-system]
requires = ["hatchling", "hatch-polylith-bricks"]
build-backend = "hatchling.build"

# Enable the polylith-bricks plugin
[tool.hatch.build.hooks.polylith-bricks]

# Define the required bricks' source and destination locations
# Including this should not be required when working locally in editable mode due to the setting below
[tool.polylith.bricks]
# "../../components/my_custom_module/component_directory" = "my_custom_module/component_directory"

# Install these directories in editable mode when syncing the project
[tool.hatch.build]
dev-mode-dirs = ["../../components", "."] # The first directory contains the my_custom_module directory

# Include the source code and bricks in the wheel
[tool.hatch.build.targets.wheel]
packages = ["my_package", "my_custom_module"]

[project]
name = "my-package"
version = "0.0.0"
description = "Super useful package. I promise."
requires-python = ">=3.11, <3.13"
dependencies = [
  "numpy>=1.26.4",
  "pandas>=2.3.1",
  "torch>=2.4",
  "loguru>=0.7",
]

[dependency-groups]
dev = [
  "poethepoet",
  "ipykernel",
  "pytest",
  "coverage[toml]",
]
release = ["tomlkit>=0.13", "python-semantic-release~=10.0"]
```

</p>
</details>

`uv run --isolated --group release python -c "import my_custom_module; print(my_custom_module)"` works but installs package, `dev` and `release` deps.

`uv run --isolated --no-default-groups --group release python -c "import my_custom_module; print(my_custom_module)"` works but installs package and `release` deps.

`uv run --isolated --no-default-groups --group release --no-editable python -c "import my_custom_module; print(my_custom_module)"` works but installs package and `release` deps. Surprised by this one, but I guess this is because `editable` probably does not cover `dev-mode-dirs`.

`uv run --isolated --only-group release python -c "import my_custom_module; print(my_custom_module)"` installs only `release` deps but does not install the `dev-mode-dirs`, and therefore doesn't work.



---

_Label `enhancement` added by @NellyWhads on 2025-09-17 18:28_

---

_Comment by @zanieb on 2025-09-17 19:52_

I don't think we can respect build-backend-level configuration without installing the project. I think you'll need to further customize hatch to get what you want here.

---

_Comment by @NellyWhads on 2025-09-19 13:50_

I see - that's fair.

Can this be supported with the uv build backend? Or is it already supported?

If so, I can consider switching ðŸ‘€ 

---

_Referenced in [DavidVujic/python-polylith#376](../../DavidVujic/python-polylith/issues/376.md) on 2025-09-22 21:57_

---
