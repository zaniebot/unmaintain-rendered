<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unnecessary `VIRTUAL_ENV` warning displayed during `add --no-sync` - astral-sh/uv #7073</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Unnecessary <code>VIRTUAL_ENV</code> warning displayed during <code>add --no-sync</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/7073">#7073</a>
        opened by <a href="https://github.com/RomainBrault">@RomainBrault</a>
        on 2024-09-05 08:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/RomainBrault">@RomainBrault</a></div>
            <div class="timeline-body"><p>Currently using <code>uv add --no-sync</code>  (as well as remove) emits the warning:</p>
<pre><code>warning: `VIRTUAL_ENV=...` does not match the project environment path `.venv` and will be ignored
</code></pre>
<p>when <code>VIRTUAL_ENV</code> is set. I was wondering if it was strictly necessary in this case since the .venv is not updated when using the <code>--no-sync</code> flag?</p>
<p>Anyway is is easily suppressed with the <code>--quiet</code> flag.</p>
<p>System info:</p>
<ul>
<li><code>uv add --no-sync</code> [any dep]</li>
<li>Linux</li>
<li>uv 0.4.5</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Unnecessary warning ?&quot; to &quot;Unnecessary `VIRTUAL_ENV` warning displayed during `add --no-sync`&quot; by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-05 12:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-05 12:31</div>
            <div class="timeline-body"><p>We throw this warning when the project venv path is retrieved. We could move it, but it&#x27;d be a kind of a pain :) I&#x27;ll leave this open though, it&#x27;s a reasonable point.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">cli</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-05 12:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Veng97">@Veng97</a> on 2025-01-02 12:07</div>
            <div class="timeline-body"><p>Why is it thrown?
I just changed the name of my project from XXX to YYY and now i&#x27;m getting this warning all the time, how should it be addressed? When i do uv sync in a project folder would we not expect uv to redeclare the virtual env?</p>
<p>Anyway its easy to fix by resetting the environment variable:
unset VIRTUAL_ENV</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jj3ny">@jj3ny</a> on 2025-01-10 06:00</div>
            <div class="timeline-body"><p>This was driving me crazy as well! Here&#x27;s what fixed it for me:</p>
<ol>
<li><p><strong>Deactivate</strong> current virtual environment:</p>
<pre><code>deactivate
</code></pre>
</li>
<li><p><strong>Remove</strong> existing virtual environment:</p>
<pre><code>rm -rf .venv
</code></pre>
</li>
<li><p><strong>Create</strong> fresh environment with <code>uv</code>:</p>
<pre><code>uv venv
</code></pre>
</li>
<li><p><strong>Activate</strong> new environment:</p>
<pre><code>source .venv/bin/activate
</code></pre>
</li>
<li><p>Run <code>uv sync</code>:</p>
<pre><code>uv sync
</code></pre>
</li>
</ol>
<p>The issue seems to be related to <code>VIRTUAL_ENV</code> being set with an absolute path while <code>uv</code> expects a relative path. Creating a fresh environment resolves the path mismatch.</p>
<p>I hope this works for you too! üéâ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RomainBrault">@RomainBrault</a> on 2025-01-10 10:52</div>
            <div class="timeline-body"><blockquote>
<p>This was driving me crazy as well! Here&#x27;s what fixed it for me:</p>
<ol>
<li><strong>Deactivate</strong> current virtual environment:
deactivate</li>
<li><strong>Remove</strong> existing virtual environment:
rm -rf .venv</li>
<li><strong>Create</strong> fresh environment with <code>uv</code>:
uv venv</li>
<li><strong>Activate</strong> new environment:
source .venv/bin/activate</li>
<li>Run <code>uv sync</code>:
uv sync</li>
</ol>
<p>The issue seems to be related to <code>VIRTUAL_ENV</code> being set with an absolute path while <code>uv</code> expects a relative path. Creating a fresh environment resolves the path mismatch.</p>
<p>I hope this works for you too! üéâ</p>
</blockquote>
<p>I think this is a separate issue. A new one should be opened.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/imonem">@imonem</a> on 2025-03-12 20:16</div>
            <div class="timeline-body"><blockquote>
<p>This was driving me crazy as well! Here&#x27;s what fixed it for me:</p>
<pre><code>1. **Deactivate** current virtual environment:
   deactivate

2. **Remove** existing virtual environment:
   rm -rf .venv

3. **Create** fresh environment with `uv`:
   uv venv

4. **Activate** new environment:
   source .venv/bin/activate

5. Run `uv sync`:
   uv sync</code></pre>
<p>The issue seems to be related to <code>VIRTUAL_ENV</code> being set with an absolute path while <code>uv</code> expects a relative path. Creating a fresh environment resolves the path mismatch.</p>
<p>I hope this works for you too! üéâ</p>
</blockquote>
<p>Thanks for the suggestion. This works so far. The size of the download while running <code>uv sync</code> however is a bit of a turn off due to some libs like <code>torch</code>, <code>cuda</code> and <code>triton</code> being excessive in size.</p>
<p>Is there another way to change the absolute path to relative?.</p>
<p>I faced this issue while porting the code from work Windows 11 laptop to home Linux workstation</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nv6">@nv6</a> on 2025-04-30 21:21</div>
            <div class="timeline-body"><blockquote>
<p>This was driving me crazy as well! Here&#x27;s what fixed it for me:</p>
<ol>
<li><strong>Deactivate</strong> current virtual environment:
deactivate</li>
<li><strong>Remove</strong> existing virtual environment:
rm -rf .venv</li>
<li><strong>Create</strong> fresh environment with <code>uv</code>:
uv venv</li>
<li><strong>Activate</strong> new environment:
source .venv/bin/activate</li>
<li>Run <code>uv sync</code>:
uv sync</li>
</ol>
<p>The issue seems to be related to <code>VIRTUAL_ENV</code> being set with an absolute path while <code>uv</code> expects a relative path. Creating a fresh environment resolves the path mismatch.</p>
<p>I hope this works for you too! üéâ</p>
</blockquote>
<p>Thanks for this. In my case it was due to moving <code>.venv</code> originally created in a child folder up to the project root folder.</p>
<p>Also I was able to skip steps 3 and 4 entirely (on v0.6.17 and 0.7.1), so in all:</p>
<pre><code>deactivate
rm -rf .venv
uv sync
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/GreeneShell">@GreeneShell</a> on 2025-05-28 00:56</div>
            <div class="timeline-body"><p>thanks you guys, now I can use <code>uv add --active</code> to avoid this warning.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rcghpge">@rcghpge</a> on 2025-07-05 11:56</div>
            <div class="timeline-body"><p>hey group, I am developing a Python-based project for the FreeBSD operating system. Running into the same pain points. I think <code>uv install</code> and <code>uv add</code> should run in 1 go as opposed to <code>uv pip install</code> or <code>uv sync --active</code> where you have to pass a flag. The venv should be an abstraction resolve. But anyway this thread helped me. I invite you to build in FreeBSD for the Python ecosystem <a href="https://rcghpge.github.io/freebsd/">FreeBSD Community Hub</a></p>
<p><img alt="Image" src="https://github.com/user-attachments/assets/093b1d2a-b87b-485b-a6f7-90cf39dbfe6b"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-07-07 10:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lmihalkovic">@lmihalkovic</a> on 2025-07-14 09:29</div>
            <div class="timeline-body"><p>this thing <strong>SUCKS</strong> ... the inability to decide where you want the <strong>venv</strong> to be installed and having uv to consider by default that the user in an imbecile is ... a major annoyance</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ixenion">@ixenion</a> on 2025-09-26 17:23</div>
            <div class="timeline-body"><blockquote>
<p>this thing <strong>SUCKS</strong> ... the inability to decide where you want the <strong>venv</strong> to be installed and having uv to consider by default that the user in an imbecile is ... a major annoyance</p>
</blockquote>
<p>Agreed. Thinking to move from <code>pdm</code> but may be think one more time)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rcghpge">@rcghpge</a> on 2025-09-26 20:08</div>
            <div class="timeline-body"><blockquote>
<p>this thing <strong>SUCKS</strong> ... the inability to decide where you want the <strong>venv</strong> to be installed and having uv to consider by default that the user in an imbecile is ... a major annoyance</p>
</blockquote>
<p>Revisiting uv development. To be fair I don‚Äôt believe this is a standard for Python package managers. A few I can think of <code>pip</code>, <code>pixi</code>, <code>pdm</code>.</p>
<p>I think the <code>uv</code> team is building a standard to mitigate a lot of fragmentation for the Python ecosystem. And that is something I believe in üëç</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:33:43 UTC
    </footer>
</body>
</html>
