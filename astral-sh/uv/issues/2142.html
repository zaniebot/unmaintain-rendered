<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Per-platform overrides - astral-sh/uv #2142</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Per-platform overrides</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/2142">#2142</a>
        opened by <a href="https://github.com/mjclarke94">@mjclarke94</a>
        on 2024-03-03 21:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mjclarke94">@mjclarke94</a></div>
            <div class="timeline-body"><p>Generally speaking, version resolution is platform independent for the majority of dependencies, with only a subset (torch...and others...mostly torch) needing a nudge in the right direction.  Cross-platform support is probably the main thing preventing us from adopting uv/rye at the moment, as we build on MacOS but deploy on Linux. There's already an open issue for cross platform support (#2079), but I imagine implementing that is a fairly involved process.</p>
<p>As a short term solution to unblock the adoption of uv until cross-platform version resolution is implemented, <code>overrides.txt</code> could allow the pinning of versions on a per-platform basis.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-03 23:21</div>
            <div class="timeline-body"><p>So in some sense, I think that overrides already <em>do</em> allow this, because you can provide multiple overrides for a single package, like:</p>
<pre><code class="language-txt">pywin32 &gt; 1.0 : sys.platform == 'win32'
pywin32 &lt; 1.0 : sys.platform != 'win32'
</code></pre>
<p>With this, whenever we see <code>pywin32</code>, we'll replace it with both of these, so only the one that applies to the given platform will end up being activated.</p>
<p>Would this work for what you're describing?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-03-03 23:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mjclarke94">@mjclarke94</a> on 2024-03-04 10:19</div>
            <div class="timeline-body"><p>Ah, maybe. I'm dealing with torch specifically, so have to deal with the issue of changing the pypi index url on a per-platform basis.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pamelafox">@pamelafox</a> on 2024-03-05 23:15</div>
            <div class="timeline-body"><p>I'm not sure if my question is the same question or a different one, but it seems related. Does uv already support the functionality of https://pypi.org/project/pip-compile-cross-platform/ ? Can we compile once, and have it keep the markers for different OSes in the resulting requirements.txt file?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-06 00:05</div>
            <div class="timeline-body"><p>@pamelafox -- We don't quite support that yet. That tool looks like a wrapper around Poetry which does a platform-agnostic resolution. We're going to support that in the future, but right now we only lock for a single platform (like <code>pip-compile</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/danieleades">@danieleades</a> on 2024-03-30 09:19</div>
            <div class="timeline-body"><blockquote>
<p>@pamelafox -- We don't quite support that yet. That tool looks like a wrapper around Poetry which does a platform-agnostic resolution. We're going to support that in the future, but right now we only lock for a single platform (like <code>pip-compile</code>).</p>
</blockquote>
<p>is there somewhere we can track progress towards platform-agnostic resolution?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/inoa-jboliveira">@inoa-jboliveira</a> on 2024-04-15 18:05</div>
            <div class="timeline-body"><p>Hi @charliermarsh We would like to be able to <code>uv pip compile</code> on requirementes.in file cross platform, i.e. from a same uv install create different txt files for windows, linux, mac. Is this the right issue or should I create a separated one?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-04-15 18:31</div>
            <div class="timeline-body"><p>@inoa-jboliveira -- I think that's best tracked as part of https://github.com/astral-sh/uv/issues/2679. (We're building some prototypes for it now.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-19 00:43</div>
            <div class="timeline-body"><p>See also https://github.com/astral-sh/uv/issues/3347 for cross-platform lock files.</p>
<p>I don't know if there's a clear todo here regarding per-platform overrides so I'm going to close this. Let me know if we're missing something.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-06-19 00:43</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:24:10 UTC
    </footer>
</body>
</html>
