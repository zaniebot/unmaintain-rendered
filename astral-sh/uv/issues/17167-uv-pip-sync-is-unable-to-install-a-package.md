```yaml
number: 17167
title: "`uv pip sync` is unable to install a package present in explicit custom index defined in pyproject.toml"
type: issue
state: open
author: pstrzelczak
labels:
  - question
assignees: []
created_at: 2025-12-18T07:30:54Z
updated_at: 2025-12-19T12:42:09Z
url: https://github.com/astral-sh/uv/issues/17167
synced_at: 2026-01-12T16:02:45Z
```

# `uv pip sync` is unable to install a package present in explicit custom index defined in pyproject.toml

---

_@pstrzelczak_

### Summary

I maintain requirements.txt file generated via `uv pip compile -o requirements.txt pyproject.toml` and use `uv pip sync requirements.txt` later on. However, seems like the `uv pip sync`  is unable to install a package present in explicit custom index defined in pyproject.toml

```
$ cat pyproject.toml 
[project]
name = "a"
version = "0.1.0"
requires-python = ">=3.12"
dependencies = [
    "test007test",
]

# 1. Define the custom index
[[tool.uv.index]]
name = "testpypi"
url = "https://test.pypi.org/simple/"
explicit = true

# 2. Pin the specific package to that index
[tool.uv.sources]
test007test = { index = "testpypi" }

$ uv pip compile pyproject.toml > requirements.txt
Resolved 1 package in 2ms

$ cat requirements.txt 
# This file was autogenerated by uv via the following command:
#    uv pip compile pyproject.toml
test007test==0.0.1
    # via a (pyproject.toml)

$ uv pip sync requirements.txt 
Using Python 3.12.3 environment at: /tmp/uv-py12
  × No solution found when resolving dependencies:
  ╰─▶ Because there is no version of test007test==0.0.1 and you require test007test==0.0.1, we can conclude that your requirements are unsatisfiable.
```


### Platform

Ubuntu 24.04

### Version

0.9.18

### Python version

3.12.3

---

_Label `bug` added by @pstrzelczak on 2025-12-18 07:30_

---

_Comment by @konstin on 2025-12-18 17:24_

`requirements.txt` can't represent a specific package using a specific index, and `uv pip sync` can't tell that those sources apply to it installing from `requirements.txt`, can you use the more modern and standardized `pylock.toml` instead?

---

_Label `bug` removed by @konstin on 2025-12-18 17:25_

---

_Label `question` added by @konstin on 2025-12-18 17:25_

---

_Comment by @pstrzelczak on 2025-12-19 07:18_

Please note that with "explicit = true" flag removed `uv pip sync` is able to find a package and succeeds. Therefore, I would expect it can work with "explicit = true" marker too.

---

_Comment by @konstin on 2025-12-19 12:29_

The `explicit = true` exists only in the uv project interface, it doesn't exist for `requirements.txt` or `pip`/`uv pip`. The reason is that we need to match each source to a `project.[optional-]dependencies` or `dependency-groups` entry, and that doesn't work with `requirements.txt`. One of the main motivations for building `uv.lock` was to not have the limitations of `requirementst.txt`.

It happens to work without `explicit = true` through a different mechanism: All uv commands read 
the closest `pyproject.toml` or `uv.toml` as configuration files, and use the index settings from them. I know it's confusing that we read some parts of it and ignore others, specifically, we're reading only the [configuration](https://docs.astral.sh/uv/reference/settings/#configuration) and dependencies fields for `uv pip compile`.

---

_Comment by @pstrzelczak on 2025-12-19 12:42_

@konstin thank you for your response. I understand that explicit indices is `uv` specific concept and I am just advocating for `uv pip sync requirements.txt` to just read package -> index mapping and from `tool.uv.sources` section of `pyproject.toml` considering  `tool.uv.sources` section is already used as in particular there is `--no-sources` command line switch.

Using `uv.lock` or `pylock.toml` is obviously the target solution but may be currently infeasible in our use case considering we heavily really on local Pypi mirrors that would leak to `uv.lock` or `pylock.toml` files if `--default-index` is used. Using old style requirements files is just more compact and enough, modulo the issue being discussed here.

---
