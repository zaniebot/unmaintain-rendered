<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[discussion] Will uv consider to add groups information in uv.lock for dependencies? - astral-sh/uv #8801</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[discussion] Will uv consider to add groups information in uv.lock for dependencies?</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/8801">#8801</a>
        opened by <a href="https://github.com/monchin">@monchin</a>
        on 2024-11-04 08:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/monchin">@monchin</a> on 2024-11-04 08:48</div>
            <div class="timeline-body"><p>Hello, as PEP 735 is already supported by uv, I'm curious whether there is a plan to add groups information in <code>uv.lock</code> for dependencies? I think it would be great if we can realize which groups the packages belong to directly in <code>uv.lock</code> by just adding for example</p>
<pre><code>[[package]]
name = &quot;python-dotenv&quot;
version = &quot;1.0.1&quot;
groups = [&quot;Default&quot;]
source = { registry = &quot;https://pypi.org/simple&quot; }
sdist = { url = &quot;https://files.pythonhosted.org/packages/bc/57/e84d88dfe0aec03b7a2d4327012c1627ab5f03652216c63d49846d7a6c58/python-dotenv-1.0.1.tar.gz&quot;, hash = &quot;sha256:e324ee90a023d808f1959c46bcbc04446a10ced277783dc6ee09987c37ec10ca&quot;, size = 39115 }
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/6a/3e/b68c118422ec867fa7ab88444e1274aa40681c606d59ac27de5a5588f082/python_dotenv-1.0.1-py3-none-any.whl&quot;, hash = &quot;sha256:f7b63ef50f1b690dddf550d03497b66d609393b40b564ed0d674909a68ebf16a&quot;, size = 19863 },
]

[[package]]
name = &quot;mypy&quot;
version = &quot;1.13.0&quot;
groups = [&quot;lint&quot;]
source = { registry = &quot;https://pypi.org/simple&quot; }
dependencies = [
    { name = &quot;mypy-extensions&quot; },
    { name = &quot;tomli&quot;, marker = &quot;python_full_version &lt; '3.11'&quot; },
    { name = &quot;typing-extensions&quot; },
]
</code></pre>
<p>Of course I know that there is <code>package.dev-dependencies</code> information in <code>uv.lock</code>, but maybe <code>groups</code> in <code>package</code> would be more intuitive. And for example, <code>mypy</code> depends on <code>mypy-extensions</code>, so <code>mypy-extensions</code> should also be in <code>lint</code> group, which cannot be expressed just by <code>package.dev-dependencies</code>.</p>
<p>Actually, <a href="https://peps.python.org/pep-0751/#packages-groups">PEP 751</a> also supports groups in package info, <a href="https://peps.python.org/pep-0751/#examples">for example</a></p>
<pre><code>[[packages]]
name = 'numpy'
version = '2.1.2'
groups = ['Default']
index_url = 'https://pypi.org/simple/numpy'
direct = false
requires_python = '&gt;=3.10'
dependencies = [

]
editable = false
wheels = [
  { tags = ['cp312-cp312-manylinux2014_x86_64', 'cp312-cp312-manylinux_2_17_x86_64'], url = 'https://files.pythonhosted.org/packages/9b/b4/e3c7e6fab0f77fff6194afa173d1f2342073d91b1d3b4b30b17c3fb4407a/numpy-2.1.2-cp312-cp312-manylinux_2_17_x86_64.manylinux2014_x86_64.whl', hash = '6d95f286b8244b3649b477ac066c6906fbb2905f8ac19b170e2175d3d799f4df', upload_time = 2024-10-05T18:36:20.729642+00:00, size = 16041825 },
  { tags = ['cp312-cp312-win_amd64'], url = 'https://files.pythonhosted.org/packages/4c/79/73735a6a5dad6059c085f240a4e74c9270feccd2bc66e4d31b5ca01d329c/numpy-2.1.2-cp312-cp312-win_amd64.whl', hash = '456e3b11cb79ac9946c822a56346ec80275eaf2950314b249b512896c0d2505e', upload_time = 2024-10-05T18:37:38.159022+00:00, size = 12568254 }
]
</code></pre>
<p>Although it is just in draft, I think it's quite reasonable. Even though it would be rejected finally, I still believe groups info would be helpful, for example installing packages in certain groups or collecting licenses of packages in  certain groups would be easy. So maybe it's a good idea to add this feature?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-04 13:45</div>
            <div class="timeline-body"><p>We track all this information in the lockfile already via <code>package.dev-dependencies</code> and <code>package.metadata.requires-dev</code> -- they just have that &quot;dev&quot; naming for backwards compatibility, to avoid breaking older uv clients. The PEP uses <code>groups</code> to achieve something slightly different, and it doesn't really make sense in our schema today. We can already do all the things you describe with the current format: <code>uv sync --group lint</code> or <code>uv sync --only-group lint</code>, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2024-11-04 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-04 13:45</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-04 14:34</div>
            <div class="timeline-body"><p>(See #8599 and https://docs.astral.sh/uv/concepts/dependencies/#development-dependencies)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/monchin">@monchin</a> on 2024-11-05 02:04</div>
            <div class="timeline-body"><blockquote>
<p>We can already do all the things you describe with the current format: <code>uv sync --group lint</code> or <code>uv sync --only-group lint</code>, etc.</p>
</blockquote>
<p>@charliermarsh Thank you for your reply, but sorry to bother you again.</p>
<p>Actually, my motivation is that I'm developping a program by python, and I need to include all the licenses of dependencies I'm using. But I'd like to exclude licenses of pytest in test group, licenses of mypy (and  mypy's dependencies, e.g., mypy-extensions) and types-pstuils in lint group, black (and black's dependencies, e.g., click) in format group, etc.</p>
<p>I mean, if like PEP751, there is <code>groups</code> in package, I can just iterate all the packages in the lock file and read each package's groups. If the package is in the groups I need to include, I'll read its dist-info and find its license and copy it to the License dir.  now I need to read <code>package.dev-dependencies</code>, and read their dependencies. And I need to be careful that if one dependency is both in default and in for example format group, I still need to include its license, this means that I need to create the whole dependency-graph myself, that's the only way I can think of for this requirement.  Would you please give me some hint for this requirement?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-05 02:07</div>
            <div class="timeline-body"><p>Yeah, you'll need to walk the dependency graph, or use <code>uv tree --only-group lint</code> and try to parse that. (We should have programmatic output, like JSON, for <code>uv tree</code>, but we don't currently.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/monchin">@monchin</a> on 2024-11-05 03:00</div>
            <div class="timeline-body"><blockquote>
<p>Yeah, you'll need to walk the dependency graph, or use <code>uv tree --only-group lint</code> and try to parse that. (We should have programmatic output, like JSON, for <code>uv tree</code>, but we don't currently.)</p>
</blockquote>
<p>Thank you! got it!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:01 UTC
    </footer>
</body>
</html>
