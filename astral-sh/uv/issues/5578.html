<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Requires-python conflicts inside a workspace - astral-sh/uv #5578</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Requires-python conflicts inside a workspace</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5578">#5578</a>
        opened by <a href="https://github.com/bluss">@bluss</a>
        on 2024-07-29 22:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bluss">@bluss</a> on 2024-07-29 22:52</div>
            <div class="timeline-body"><p>Workspaces seem to require that all members use the same requires-python. Maybe this can be relaxed, or a dedicated error can explain it.</p>
<p>Steps to reproduce</p>
<pre><code class="language-shell">uv init --virtual root
cd root
uv init -p 3.11 a
uv init -p 3.12 b
uv sync
</code></pre>
<p>It should have set up two projects a, b in the same workspace with conflicting requires-python of &gt;= 3.11 and &gt;= 3.12.</p>
<h3>Actual Behaviour</h3>
<pre><code>  × No solution found when resolving dependencies:
  ╰─▶ Because the requested Python version (&gt;=3.11) does not satisfy Python&gt;=3.12 and
      b==0.1.0 depends on Python&gt;=3.12, we can conclude that b==0.1.0 cannot be used.
      And because only b==0.1.0 is available and you require b, we can conclude that the
      requirements are unsatisfiable.

      hint: The `requires-python` value (&gt;=3.11) includes Python versions that are not
      supported by your dependencies (e.g., b==0.1.0 only supports &gt;=3.12). Consider using
      a more restrictive `requires-python` value (like &gt;=3.12).
</code></pre>
<h3>Expected Behaviour</h3>
<p>Logically, the combination of a and b is fine to use with any python &gt;= 3.12. There would be a reason to emit error is if <strong>a</strong> depends directly on <strong>b</strong>.</p>
<p>This situation seems to happen quite easily. Not sure what's the best way to improve.</p>
<p>uv 0.2.31
platform: linux (x86_64)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-29 23:12</div>
            <div class="timeline-body"><p>Right now we take the union of the versions. I think what you're suggesting is we could take the intersection...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-30 02:44</div>
            <div class="timeline-body"><p>Thinking on this more, I think intersection is probably right here (as long as we reject trying to install at a lower version).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/5594.html">astral-sh/uv#5594</a> on 2024-07-30 11:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2024-07-30 12:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">preview</span> added by @charliermarsh on 2024-07-30 12:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-07-30 16:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/5644.html">astral-sh/uv#5644</a> on 2024-07-31 00:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-31 16:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-31 16:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:31 UTC
    </footer>
</body>
</html>
