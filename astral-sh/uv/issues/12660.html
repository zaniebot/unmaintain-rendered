<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Can I install a project's `optional-dependencies` without its `dependencies` with `uv`? - astral-sh/uv #12660</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Can I install a project's <code>optional-dependencies</code> without its <code>dependencies</code> with <code>uv</code>?</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/12660">#12660</a>
        opened by <a href="https://github.com/alph0n5e">@alph0n5e</a>
        on 2025-04-03 20:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/alph0n5e">@alph0n5e</a> on 2025-04-03 20:51</div>
            <div class="timeline-body"><h3>Question</h3>
<p>Hi!</p>
<p>Is it possible to only install a project's specific extra, or <code>optional-dependencies</code>, without installing the project itself or its direct dependencies?</p>
<p>I am able to do it for a group defined in <code>dependency-groups</code>, using <code>uv sync --freeze --only-group &lt;my-group&gt;</code>, but is it something we can do for <code>optional-dependencies</code> groups as well (something akin to <code>uv sync --only-extra &lt;my-group&gt;</code>)?</p>
<p>Thanks for the amazing work, I've been really enjoying working with <code>uv</code> over the last few months.</p>
<h3>Platform</h3>
<p><em>No response</em></p>
<h3>Version</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @alph0n5e on 2025-04-03 20:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-03 21:29</div>
            <div class="timeline-body"><p>Thanks for the kind words.</p>
<p>No, this isn't supported, the <code>optional-dependencies</code> are always intended to include the project (per the specification). Can you share your use-case?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alph0n5e">@alph0n5e</a> on 2025-04-04 06:22</div>
            <div class="timeline-body"><p>Thank you for your response. The use-case was the following:</p>
<p>My team is working with GPU-specific optional dependencies which are heavy but less likely to change than the mandatory dependencies, and we would like to front-load their installation in an upstream intermediate Docker layer or image as part of our builds.</p>
<pre><code class="language-toml"># pyproject.toml
[project]
name = &quot;my-project&quot;
dependencies = [
    # standard deps, including local libs with relative paths
]
...
[project.optional-dependencies]
gpu = [
    # GPU-specific deps
]
...
</code></pre>
<p>We were hoping to be able to leverage the existing <code>pyproject.toml</code> or <code>uv.lock</code> dependencies specification to do such an &quot;extra-only&quot; install, without having to re-specify the extras in the Docker layer, if that makes sense.</p>
<pre><code class="language-dockerfile"># GPU build
...
# Install extra-specific optional dependencies, possibly even in an intermediate image
RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --frozen --only-extra gpu  # this is where it gets fuzzy
...
# Install &quot;standard&quot; dependencies
RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --frozen --no-install-project
...
# Sync the project
RUN --mount=type=cache,target=/root/.cache/uv \
    uv sync --frozen
</code></pre>
<p>There are probably other (and better?) ways to address this use-case, but I was curious if such a thing was possible &quot;as-is&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-04 13:59</div>
            <div class="timeline-body"><p>Ah, I see. That's interesting. It was <em>considered</em> to allow referring to dependency groups from optional dependencies but ultimately left out of the standard, I guess this is a use-case for that.</p>
<p>I can't think of a particularly clean way to do this yet. I'm hesitant to add that interface more broadly, because I think it will be confusing to others.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @zanieb on 2025-04-04 14:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2025-04-04 14:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alph0n5e">@alph0n5e</a> on 2025-04-04 16:04</div>
            <div class="timeline-body"><p>I understand, it may be too specific of a use-case for a broader implementation. Thanks for considering it anyway!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:59 UTC
    </footer>
</body>
</html>
