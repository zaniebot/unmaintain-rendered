<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv tool run` fails when using `prefect` because it can't find modules, despite working when run in activated venv. - astral-sh/uv #9477</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv tool run</code> fails when using <code>prefect</code> because it can't find modules, despite working when run in activated venv.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9477">#9477</a>
        opened by <a href="https://github.com/NicholasPini">@NicholasPini</a>
        on 2024-11-27 17:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/NicholasPini">@NicholasPini</a></div>
            <div class="timeline-body"><p>I have a uv package that has <code>prefect</code> and a bunch of other dependencies installed.
<code>prefect</code> provides the command <code>prefect worker start --pool 'process-pool-test'</code>: this commands starts a worker process. If I go into my project, activate the venv, and run <code>prefect worker start --pool 'process-pool-test'</code>, I can start another script which runs the process deployed to this worker, and everything works correctly.
If, however, I use <code>uv tool run prefect worker start --pool 'process-pool-test'</code>, the worker starts, but as soon as I try to run the process deployed, I get errors about dependencies not found. This issue can be solved by passing all dependencies of the project to the <code>--with</code> flag, but this is tedious and not easily maintainable.
I don't understand what is the problem, given that the dependencies are all present in <code>pyproject.toml</code> and installed in the venv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-27 17:02</div>
            <div class="timeline-body"><p><code>uv tool run</code> doesn't run in your project's environment. You'll want to use <code>uv run</code> instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-27 17:03</div>
            <div class="timeline-body"><p>Documentation at https://docs.astral.sh/uv/concepts/tools/#relationship-to-uv-run</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2024-11-27 17:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NicholasPini">@NicholasPini</a> on 2024-11-27 17:26</div>
            <div class="timeline-body"><p>I was under the impression that <code>uv run</code> is used only to run my own scripts. Well, that solved the issue, thank you very much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @NicholasPini on 2024-11-27 17:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Happily-Coding">@Happily-Coding</a> on 2024-12-25 09:16</div>
            <div class="timeline-body"><p>In case anyone else stumbles upon this post and still has an issue, because the command prefect is not recognized, i had to run uv lock --upgrade and that allowed me to execute prefect with uv run.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:28:36 UTC
    </footer>
</body>
</html>
