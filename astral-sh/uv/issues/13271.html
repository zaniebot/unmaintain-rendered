<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv pip compile --format pylock.toml with github based dependencies leave the github token in the resultant pylock.toml - astral-sh/uv #13271</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv pip compile --format pylock.toml with github based dependencies leave the github token in the resultant pylock.toml</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13271">#13271</a>
        opened by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a>
        on 2025-05-02 18:00
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a></div>
            <div class="timeline-body">Summary
<p>Example requirements.in
somemodule@https://${GITHUB_TOKEN}@github.com/someorg/somemodule/archive/somesha.zip</p>
<p>Expected output: resultant pylock.toml has ${GITHUB_TOKEN} rather than the actual substituted in github token.</p>
<p>Actual output: pylock.toml format has the github token in the URL in the resultant file. requirements.txt format correctly has ${GITHUB_TOKEN} in the resultant file rather than the actual github token.</p>
<p>Implication: anyone with a secret scanner cannot commit a pylock.toml if it has a gh hosted module dependency that requires authentication and thus authorization to access.</p>
Platform
<p>debian 12</p>
Version
<p>uv 0.6.17</p>
Python version
<p>3.12.10</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-05-02 18:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-02 18:07</div>
            <div class="timeline-body"><p>Thanks, but I don&#x27;t think writing out the environment variable is an option here. That wouldn&#x27;t abide by the spec. The alternative is we redact all credentials, like for <code>uv.lock</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-05-02 18:12</div>
            <div class="timeline-body"><p>requirements.txt format is doing this correctly -- if PEP 751 infers you must expose secrets in the pylock.toml then the standard is DOA, no?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-02 18:23</div>
            <div class="timeline-body"><p>I think putting an environment variable in the URL output like that is kind of a hack -- it means the thing you write there is no longer a valid URL on its own. I don&#x27;t think any ecosystem does this? Personally, I think the right solution is to omit credentials from the output entirely and give the user the ability to provide credentials out-of-band from the lockfile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-05-02 18:37</div>
            <div class="timeline-body"><p>I respect the position -- just offering, this is something pip and uv support with requirements.txt format.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-05-02 18:56</div>
            <div class="timeline-body"><p>For the record, &quot;pip lock&quot; pylock.toml output file presently has this issue too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-05-02 19:51</div>
            <div class="timeline-body"><p>PEP751 specifically calls out not supporting environment variables, making this moot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/gary-wall-hpe">@gary-wall-hpe</a> on 2025-05-02 19:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:28 UTC
    </footer>
</body>
</html>
