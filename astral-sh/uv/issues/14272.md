```yaml
number: 14272
title: Staging mode for uv lock preserving (binary) wheels
type: issue
state: open
author: detlefla
labels:
  - enhancement
assignees: []
created_at: 2025-06-26T12:31:39Z
updated_at: 2025-07-03T21:36:34Z
url: https://github.com/astral-sh/uv/issues/14272
synced_at: 2026-01-10T01:57:32Z
```

# Staging mode for uv lock preserving (binary) wheels

---

_Issue opened by @detlefla on 2025-06-26 12:31_

### Summary

Problem: I want to install an app with a bunch of requirements on a server that is connected to the internet but has no development tools (C / C++ / Rust compilers, dev libraries etc.) installed. The primary reason for this is the server's security policy (that should make exploits harder); there could be other conceivable reasons though.

Maybe I'm overlooking something (too) obvious, but the “best” solution I can think of is

-  install the app in a staging environment
-  install original pip there
-  read uv.lock and identify all binary packages
-  create wheels for these packages with `pip wheel -w wheels PACKAGE`
-  rsync the wheels dir to the production server
-  manipulate uv.lock pointing the package source to the wheels dir and copy this lockfile to the server
-  `uv sync --frozen` on the server, pulling any Python-only wheels from PyPI and all binary wheels from the local dir

Which is error-prone and not very comfortable. (A direct `pip wheel -r …` can't read uv's lockfile and might choose the wrong dependencies.)

Therefore I suggest a “staging mode” for `uv lock` that would copy all installed wheels (which normally wouldn't be kept anywhere) – or just binary wheels – to a given output directory and write the relative path to this directory as package source into the lockfile which could be used for uv-syncing on a (dumb) server.


### Example

_No response_

---

_Label `enhancement` added by @detlefla on 2025-06-26 12:31_

---

_Comment by @detlefla on 2025-07-03 21:36_

I found out that for step 4, the generation of wheels, pip is not needed, it could actually be done by uv if you download the sdist archive (from the location found in uv.lock) and apply `uv build --python PYVER --wheel PKG-VERSION.tar.gz`.

This is a nice feature of uv which is not too obvious from the docs.

It doesn't make the whole process _much_ easier, though. But probably faster.

---

_Referenced in [LabAutomationAndScreening/copier-cloud-courier-infrastructure#10](../../LabAutomationAndScreening/copier-cloud-courier-infrastructure/pulls/10.md) on 2025-08-02 20:06_

---
