<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> Failed to hardlink files: Issue with ruff cache - astral-sh/uv #7285</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Failed to hardlink files: Issue with ruff cache</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7285">#7285</a>
        opened by <a href="https://github.com/PhantomSpike">@PhantomSpike</a>
        on 2024-09-11 09:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/PhantomSpike">@PhantomSpike</a></div>
            <div class="timeline-body"><p>When I run <code>uv add</code> or <code>uv pip install</code> I get this warning:</p>
<pre><code>░░░░░░░░░░░░░░░░░░░░ [0/6] Installing wheels...                                                                                                                                            warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
</code></pre>
<p>and uv is very slow. What could be causing this?</p>
<p>Could it be that the uv cache is somewhere different from my current directory? If so, how do I move/link it properly?</p>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-11 13:18</div>
            <div class="timeline-body"><p>You can set <code>UV_CACHE_DIR</code> to some directory on the same drive as your project. You can run <code>uv cache dir</code> to view the current cache location too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-11 13:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw-gts">@notatallshaw-gts</a> on 2024-09-11 16:27</div>
            <div class="timeline-body"><p>FYI, I need to set my cache to a different drive than my Python environment (for reasons), I use <code>UV_LINK_MODE=symlink</code> and it works great for me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-09-14 00:43</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Quba1">@Quba1</a> on 2024-11-08 12:20</div>
            <div class="timeline-body"><p>Sorry for reviving this issue. Does <code>This may lead to degraded performance</code> part of the warning message refer to the uv performance or installed package performance?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-11-08 12:21</div>
            <div class="timeline-body"><p>This only affects uv&#x27;s performance, not the installed packages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pplmx">@pplmx</a> on 2025-02-27 08:33</div>
            <div class="timeline-body"><p>Hi @konstin,</p>
<p>I noticed the use of <code>$env:UV_LINK_MODE=&quot;symlink&quot;</code>. Is this the configuration officially recommended by uv on Windows? If so, could you explain why it isn’t enabled by default?</p>
<p>Thanks for your insights!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-27 13:50</div>
            <div class="timeline-body"><p>No, symlinks aren’t recommended. We recommend hard links, which is the default.</p>
<p>The issue with symlinks is that if you remove files from the cache or clear the cache, your environment will break. Hard links don’t have that problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kamiertop">@kamiertop</a> on 2025-03-14 13:24</div>
            <div class="timeline-body"><p>On windows, I had the same problem, I used <code>uv cache dir</code> and found that the cache was in <code>C:Users\xxx\AppDataloca\pip</code>, and then I set the environment variables <code>UV_CACHE_DIR</code>, putting the cache directory and the project directory in a <strong>same disk partition</strong>. Also, I use <code>zsh</code> on windows, so I write env to <code>~/.vimrc</code>, hope it helps.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rsconsuegra">@rsconsuegra</a> on 2025-04-14 00:50</div>
            <div class="timeline-body"><p>Sorry to open again this thread, but I am using uv in windows and, for reasons, I have multiple projects in different locations (E:, F: and G:, and cache is currently in C:\Users\xxx\AppData\Local\uv\cache), so right now I get the warning <code> Failed to hardlink files;</code> in all the projects, and certainly I don&#x27;t think having a cache in each disk would be the intended solution... or is it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pengyou200902">@pengyou200902</a> on 2025-05-27 01:51</div>
            <div class="timeline-body"><blockquote>
<p>Sorry to open again this thread, but I am using uv in windows and, for reasons, I have multiple projects in different locations (E:, F: and G:, and cache is currently in C:\Users\xxx\AppData\Local\uv\cache), so right now I get the warning <code> Failed to hardlink files;</code> in all the projects, and certainly I don&#x27;t think having a cache in each disk would be the intended solution... or is it?</p>
</blockquote>
<p>same situation here</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-27 02:16</div>
            <div class="timeline-body"><p>Yeah, if you want to use hardlinks, you&#x27;d need a separate cache for each drive, since you can&#x27;t hardlink across drives. Alternatively, if you want to use a single cache, you can set <code>UV_LINK_MODE=copy</code>. This <em>could</em> be better depending on your use-case, since you can avoid re-downloading shared dependencies; however, it will be <em>less</em> space efficient than using a separate cache per-disk with hardlinks, since the hardlink solution only requires one copy of each file per disk, while <code>UV_LINK_MODE=copy</code> will require one copy for every installation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-27 02:17</div>
            <div class="timeline-body"><p>(If you have further questions, please redirect them to Discord or open a new issue; we prefer that folks don&#x27;t comment on closed issues.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dima333750">@dima333750</a> on 2025-12-04 07:03</div>
            <div class="timeline-body"><p>I fixed one warning by moving to disk C:</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:33:54 UTC
    </footer>
</body>
</html>
