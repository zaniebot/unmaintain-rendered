<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interpreter discovery requires `provided path` but it is not selected when running unit tests - astral-sh/uv #4023</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Interpreter discovery requires `provided path` but it is not selected when running unit tests</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/4023">#4023</a>
        opened by <a href="https://github.com/ottaviohartman">@ottaviohartman</a>
        on 2024-06-04 21:10
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on 2024-06-04 21:10</div>
            <div class="timeline-body"><p>Hi folks, while trying to run the tests with</p>
<pre><code class="language-sh">cargo test prune_no_op
</code></pre>
<p>I get:</p>
<pre><code class="language-sh">command=`cd &quot;/var/folders/cc/jmqhx8k92wz9j0dsxnnyl0x80000gn/T/.tmpJHdeNR&quot; &amp;&amp; &quot;/Users/ohartman/git/uv/target/debug/uv&quot; &quot;venv&quot; &quot;/var/folders/cc/jmqhx8k92wz9j0dsxnnyl0x80000gn/T/.tmpJHdeNR/.venv&quot; &quot;--cache-dir&quot; &quot;/var/folders/cc/jmqhx8k92wz9j0dsxnnyl0x80000gn/T/.tmpI0Rsjf&quot; &quot;--python&quot; &quot;/Users/ohartman/Library/Application Support/uv/toolchains/cpython-3.12.1-macos-aarch64-none/install/bin/python3&quot;`
code=1
stdout=&quot;&quot;
stderr=```
  √ó Interpreter discovery for `path `/Users/ohartman/Library/Application
  ‚îÇ Support/uv/toolchains/cpython-3.12.1-macos-aarch64-none/install/bin/python3``
  ‚îÇ requires `provided path` but it is not selected
</code></pre>
<p>It's reproducible as of latest commit https://github.com/astral-sh/uv/commit/1b3200b2af9cebc86a78f30d585b0f65be0c3091</p>
<p>This happens on several tests, but not all of them. Any ideas how to fix this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Unable to find Python interpreters in search path" to "Interpreter discovery requires `provided path` but it is not selected when running unit tests" by @ottaviohartman on 2024-06-04 21:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on 2024-06-04 21:16</div>
            <div class="timeline-body"><p>Seems like user error, fixed by enabling <code>pyenv</code> shell.</p>
<p>This occurred despite <code>python</code> being in my <code>$PATH</code>. ü§∑üèª</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @ottaviohartman on 2024-06-04 21:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @zanieb on 2024-06-04 21:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-04 21:47</div>
            <div class="timeline-body"><p>We shouldn't raise this error, seems indicative of a problem in the test harness. Will investigate :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @zanieb by @zanieb on 2024-06-04 21:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4026.html">astral-sh/uv#4026</a> on 2024-06-04 22:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-04 22:10</div>
            <div class="timeline-body"><p>@ottaviohartman if you could reproduce with https://github.com/astral-sh/uv/pull/4026/commits/f92b691c7d633f57ce3fe89c806fd58000b4d646 that'd be helpful for narrowing down the selected sources</p>
<p>I think https://github.com/astral-sh/uv/pull/4027/commits/5475d1012e7674cfbc138b957648d2c196bc6ef4 might resolve it as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/4027.html">astral-sh/uv#4027</a> on 2024-06-04 22:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on 2024-06-04 22:52</div>
            <div class="timeline-body"><p>Thanks for checking this out @zanieb. Unfortunately, I can no longer reproduce this, even after disabling (&amp; uninstalling) pyenv, restarting zsh a bunch of times, messing with $PATH, etc.</p>
<p>If you have any ideas for <em>how</em> exactly I messed up my environment, I can try to recreate it! üòÖ  Sorry to not be more helpful here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-04 23:15</div>
            <div class="timeline-body"><p>Uh weird haha not sure what to think then. What if you set the <code>UV_TEST_PYTHON_PATH</code> variable to some random directory?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ottaviohartman">@ottaviohartman</a> on 2024-06-05 14:50</div>
            <div class="timeline-body"><p>Yes! Able to repro with</p>
<pre><code class="language-sh">UV_TEST_PYTHON_PATH=/foo cargo test prune_no_op
</code></pre>
<p>https://github.com/astral-sh/uv/commit/f92b691c7d633f57ce3fe89c806fd58000b4d646 does not fix it, but https://github.com/astral-sh/uv/commit/5475d1012e7674cfbc138b957648d2c196bc6ef4 does.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2024-06-05 14:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-06-05 14:52</div>
            <div class="timeline-body"><p>Thanks!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:30:28 UTC
    </footer>
</body>
</html>
