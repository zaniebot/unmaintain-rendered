```yaml
number: 6960
title: "Feature:  have 'uv export' support --only-deps"
type: issue
state: closed
author: RomainBrault
labels:
  - question
assignees: []
created_at: 2024-09-03T08:33:55Z
updated_at: 2024-09-06T01:01:48Z
url: https://github.com/astral-sh/uv/issues/6960
synced_at: 2026-01-10T01:57:15Z
```

# Feature:  have 'uv export' support --only-deps

---

_Issue opened by @RomainBrault on 2024-09-03 08:33_

Have `uv export` support `--only-deps`

This would be useful to support building `requirements.txt` from `uv.lock` without including build dependencies.

Example: in a `Dockerfile` with a custom hatch build the following fails:

```dockerfile
COPY pyproject.toml ./
RUN set -ex && \
    ${UV_BIN}/uv export \
        --format="requirements-txt" \
        --all-extras \
        --no-dev
```

So I must do

```dockerfile
COPY pyproject.toml hatch.toml hatch_build.py ./
RUN set -ex && \
    ${UV_BIN}/uv export \
        --format="requirements-txt" \
        --all-extras \
        --no-dev
```

It would be nice to be able to have

```dockerfile
COPY pyproject.toml ./
RUN set -ex && \
    ${UV_BIN}/uv export \
        --format="requirements-txt" \
        --all-extras \
        --no-dev \
        --only-deps
```
working.

This would also enable doing

```shell
uv pip install --require-hashes
```

without `uv` complaining about

```bash
error: In `--require-hashes` mode, all requirement must have a hash, but none were provided for: file:///src
```

---

_Renamed from "Feature:  have 'uv export' support --no-install-project and --no-install-workspace" to "Feature:  have 'uv export' support --no-install-project" by @RomainBrault on 2024-09-03 08:35_

---

_Comment by @RomainBrault on 2024-09-03 20:35_

Related: #6573 

If I was unclear, I think it would be nice to convert the uv.lock to a requirements.txt trough uv export with only the dependencies (not the project). I guess I would be really useful if in that case uv would ignore the project's build configuration (otherwise I could just "sed" out the line corresponding to the project in the requirements.txt).

E.g. in my example the project's build use hatch-vcs (with dynamic field + a custom build script) that are not useful to convert the dependencies in uv.lock to requirements.txt.

---

_Renamed from "Feature:  have 'uv export' support --no-install-project" to "Feature:  have 'uv export' support --only-deps" by @RomainBrault on 2024-09-03 20:46_

---

_Comment by @charliermarsh on 2024-09-03 23:19_

Do you need `--frozen` for these commands, so that you don't resolve?

---

_Label `question` added by @charliermarsh on 2024-09-04 02:22_

---

_Comment by @charliermarsh on 2024-09-04 02:22_

In other words: if you add `--frozen` to the above examples, do the commands execute without error?

---

_Comment by @RomainBrault on 2024-09-04 08:49_

Thanks, this solve the build problem; with `--frozen` I am able to generate the `requirements.txt` from the `uv.lock`. 

However I am unable to `pip install --require-hashes` due to the line `-e .` in the `requirements.txt`.

So the final solution is to use `--frozen` as suggested and to remove the line in a post-processing step. 

A flag to avoid this line would still be useful as well as a flag to save the result to a file. (This would avoid post-processing and stream redirections).

I don't mind closing the issue now.

---

_Comment by @RomainBrault on 2024-09-04 08:59_

Related: #6995 #7058 

---

_Comment by @RomainBrault on 2024-09-04 10:03_

I think the feature could be seen another way:

Be able to do `uv pip compile uv.lock`.

---

_Referenced in [astral-sh/uv#7110](../../astral-sh/uv/pulls/7110.md) on 2024-09-06 00:44_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-09-06 00:45_

---

_Closed by @charliermarsh on 2024-09-06 01:01_

---

_Closed by @charliermarsh on 2024-09-06 01:01_

---
