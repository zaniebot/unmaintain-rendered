<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannot install local dependency via `pyproject.toml`: &quot;URL dependencies must be expressed as direct requirements or constraints.&quot; - astral-sh/uv #1603</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cannot install local dependency via `pyproject.toml`: &quot;URL dependencies must be expressed as direct requirements or constraints.&quot;</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/1603">#1603</a>
        opened by <a href="https://github.com/bersbersbers">@bersbersbers</a>
        on 2024-02-17 17:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bersbersbers">@bersbersbers</a> on 2024-02-17 17:33</div>
            <div class="timeline-body"><p>Thanks for this! I have been putting off moving from <code>pip</code> to <code>poetry</code> (in order to circumvent <code>pip</code>s many limitations) due to <code>poetry</code>s many limitations. <code>uv</code> looks like my journey may finally come to an end. One issue, though:</p>
<p><code>C:\Code\TestParent\pyproject.toml</code></p>
<pre><code class="language-toml">[project]
name = &quot;TestParent&quot;
version = &quot;0&quot;
description = &quot;&quot;
authors = []
dependencies = [&quot;TestChild @ file:///${PROJECT_ROOT}/TestChild&quot;]
</code></pre>
<p><code>C:\Code\TestParent\TestChild\pyproject.toml</code></p>
<pre><code class="language-toml">[project]
name = &quot;TestChild&quot;
version = &quot;0&quot;
description = &quot;&quot;
authors = []
</code></pre>
<pre><code>(.venv) C:\Code\TestParent&gt;uv --version
uv 0.1.3

(.venv) C:\Code\TestParent&gt;uv pip install -e .
   Built file:///C:/Code/TestParent                                                                                                                                                                 Built 1 editable in 2.06s
error: Package `testchild` attempted to resolve via URL: file:///C:/Code/TestParent/TestChild. URL dependencies must be expressed as direct requirements or constraints. Consider adding `testchild @ file:///C:/Code/TestParent/TestChild` to your dependencies or constraints file.
</code></pre>
<p>Maybe I misunderstand &quot;dependencies or constraints file&quot;, but I thought <code>pyproject.toml</code> was that file, and it includes (not exactly, but semantically) what is requested. The test case which issues the</p>
<blockquote>
<p>URL dependencies must be expressed as direct requirements or constraints</p>
</blockquote>
<p>error has a transitive URL dependency (URL package depending on another URL package), in which case I understand the warning; I do not understand it in my case.
https://github.com/astral-sh/uv/blob/bc14ed1613c51296167876c5ae31726faa8af968/crates/uv/tests/pip_compile.rs#L1211-L1232</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-17 18:22</div>
            <div class="timeline-body"><p>I think what you're doing should be allowed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-02-17 18:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-17 18:22</div>
            <div class="timeline-body"><p>Like, dependencies of editable installs should be considered &quot;direct requirements&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/matharman">@matharman</a> on 2024-02-17 19:24</div>
            <div class="timeline-body"><p>Hi,</p>
<p>I think this problem extends to <code>git+ssh</code> dependencies as well, even if expressed properly as <code>{package} @ git+ssh://{url}.git@{sha1}</code> like suggested in #313.</p>
<p>I can create a separate issue, or cross-post to #313 if you wish.</p>
<p>However, if I install it on the CLI like so, it installs successfully. I am using version 0.1.3</p>
<p><code>uv pip install &quot;package @ git+ssh://git@url.com/path/to/repo.git@cb389afdc89931f7a66ca964cbe7db1a0f50c4c9&quot;</code></p>
<p>Here is a redacted, minimal <code>pyproject.toml</code> that exhibits the same error message as OP for me.</p>
<pre><code class="language-toml">[project]
name = &quot;project&quot;
version = &quot;0.5.15&quot;
description = &quot;description&quot;
requires-python = &quot;&gt;=3.10&quot;
dependencies = [
    &quot;package @ git+ssh://git@path/to/repo.git@cb389afdc89931f7a66ca964cbe7db1a0f50c4c9&quot;,
]

[project.optional-dependencies]
dev = [&quot;ruff&quot;]

[tool.ruff]
target-version = &quot;py310&quot;

[build-system]
requires = [&quot;setuptools&gt;=43.0.0&quot;, &quot;wheel&quot;]
build-backend = &quot;setuptools.build_meta&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-17 19:29</div>
            <div class="timeline-body"><p>üëç It‚Äôs the same issue ‚Äî all good to track it here! I‚Äôll fix it soon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-02-17 19:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1614.html">astral-sh/uv#1614</a> on 2024-02-17 20:11</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-02-17 20:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/1808.html">astral-sh/uv#1808</a> on 2024-02-21 13:48</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:34:56 UTC
    </footer>
</body>
</html>
