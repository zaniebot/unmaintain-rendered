<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Including another file with `-r other.txt` should resolve relative to the containing file - astral-sh/uv #1367</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Including another file with <code>-r other.txt</code> should resolve relative to the containing file</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1367">#1367</a>
        opened by <a href="https://github.com/carta-luc-ritchie">@carta-luc-ritchie</a>
        on 2024-02-15 21:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/carta-luc-ritchie">@carta-luc-ritchie</a></div>
            <div class="timeline-body"><p>We have a dev requirements file <code>lib/requirements/dev.txt</code> that starts with this:</p>
<pre><code>-r requirements.txt
-r ../client/requirements/requirements.txt
-r ../interfaces/requirements/requirements.txt
</code></pre>
<p>Relative to the repo root, the mentioned files are at <code>lib/requirements/requirements.txt</code>, <code>lib/client/requirements/requirements.txt</code>, and <code>lib/interfaces/requirements/requirements.txt</code>. We invoke pip with <code>pip install -r /full/path/to/repo/lib/requirements/dev.txt</code>, and it&#x27;s able to find and recursively include these files. If we invoke <code>uv pip install</code> the same way, it fails with</p>
<pre><code>error: Error parsing included file in `/full/path/to/repo/lib/requirements/dev.txt` at position 0
  Caused by: failed to open file `/full/path/to/repo/requirements.txt`
  Caused by: No such file or directory (os error 2)
</code></pre>
<p>If I change directory, it becomes clear that the file is being resolved relative to the current working directory, whereas pip resolves it relative to the file containing the <code>-r</code> instruction.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-15 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-15 21:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-15 22:00</div>
            <div class="timeline-body"><p>Thanks for the report! I agree.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-15 22:03</div>
            <div class="timeline-body"><p>I need to do a bit of research on this -- I can&#x27;t quite remember why we did it this way, but I thought it was intentional. Will take a look!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edwardpeek-crown-public">@edwardpeek-crown-public</a> on 2024-02-15 23:41</div>
            <div class="timeline-body"><p>Note that pip-compile also matches pip behaviour, resolving relative to the file defining the path.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 02:57</div>
            <div class="timeline-body"><p>Okay, I think the reason I was confused is that relative directories (like <code>-e ../..</code>) are interpreted relative to the current working directory. But it looks like requirements and constraints files are interpreted relative to the containing file.</p>
<p>https://github.com/pypa/pip/issues/8765</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/charliermarsh">@charliermarsh</a> by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 02:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 02:58</div>
            <div class="timeline-body"><p>Will fix tonight.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 04:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:29:15 UTC
    </footer>
</body>
</html>
