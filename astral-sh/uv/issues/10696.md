```yaml
number: 10696
title: UV compile does not discover binary correctly for targeting macOS even though macOS binaries exist
type: issue
state: closed
author: nmichlo
labels:
  - question
assignees: []
created_at: 2025-01-16T22:20:43Z
updated_at: 2025-01-20T15:11:47Z
url: https://github.com/astral-sh/uv/issues/10696
synced_at: 2026-01-10T04:27:58Z
```

# UV compile does not discover binary correctly for targeting macOS even though macOS binaries exist

---

_Issue opened by @nmichlo on 2025-01-16 22:20_

**1. setup**
```bash
echo "mlx" > r.txt
```

**2.a compile (on macos)**
```bash
uv pip compile r.txt
```

<details><summary>Success</summary>

```bash
>>> uv pip compile r.txt
Resolved 1 package in 8ms
# This file was autogenerated by uv via the following command:
#    uv pip compile r.txt
mlx==0.22.0
    # via -r r.txt
```

</details>

**2.b compile (on macos) to target macos**
```bash
uv pip compile --python-platform=macos r.txt
```

<details><summary>Failure</summary>

```bash
>>> uv pip compile --python-platform=macos r.txt
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of mlx are available:
          mlx==0.0.2
          mlx==0.0.3
          mlx==0.0.4
          mlx==0.0.5
          mlx==0.0.6
          mlx==0.0.7
          mlx==0.0.9
          mlx==0.0.10
          mlx==0.0.11
          mlx==0.1.0
          mlx==0.2.0
          mlx==0.3.0
          mlx==0.4.0
          mlx==0.5.1
          mlx==0.6.0
          mlx==0.7.0
          mlx==0.8.1
          mlx==0.9.1
          mlx==0.10.0
          mlx==0.11.1
          mlx==0.12.2
          mlx==0.13.0
          mlx==0.13.1
          mlx==0.14.0
          mlx==0.14.1
          mlx==0.15.0
          mlx==0.15.1
          mlx==0.15.2
          mlx==0.16.0
          mlx==0.16.1
          mlx==0.16.2
          mlx==0.16.3
          mlx==0.17.1
          mlx==0.17.2
          mlx==0.17.3
          mlx==0.18.0
          mlx==0.18.1
          mlx==0.19.0
          mlx==0.19.3
          mlx==0.20.0
          mlx==0.21.0
          mlx==0.21.1
          mlx==0.22.0
      and mlx<=0.0.3 has no wheels with a matching Python ABI tag, we can conclude that mlx<0.0.3 cannot be used.
      And because mlx>=0.0.4 has no wheels with a matching Python implementation tag and you require mlx, we can conclude that your requirements are unsatisfiable.
```

</details>

**HOWEVER:**
checking the binaries available you see that macOS binaries exist. And if you just `pip install mlx` on macOS, then it works.

```bash
>>> pip install --no-cache mlx

Collecting mlx
  Downloading mlx-0.22.0-cp311-cp311-macosx_14_0_arm64.whl.metadata (5.3 kB)
Downloading mlx-0.22.0-cp311-cp311-macosx_14_0_arm64.whl (26.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 26.9/26.9 MB 35.7 MB/s eta 0:00:00
Installing collected packages: mlx
Successfully installed mlx-0.22.0
```

---

_Renamed from "UV does not discover binary correctly for macos" to "UV compile does not discover binary correctly for targeting macOS even though macOS binaries exist" by @nmichlo on 2025-01-16 22:21_

---

_Comment by @zanieb on 2025-01-16 22:34_

The latest version displays more here

```
❯ echo "mlx" | uv pip compile - -p 3.12 --python-platform=macos
  × No solution found when resolving dependencies:
  ╰─▶ Because only the following versions of mlx are available:
          mlx==0.0.2
          mlx==0.0.3
          mlx==0.0.4
          mlx==0.0.5
          mlx==0.0.6
          mlx==0.0.7
          mlx==0.0.9
          mlx==0.0.10
          mlx==0.0.11
          mlx==0.1.0
          mlx==0.2.0
          mlx==0.3.0
          mlx==0.4.0
          mlx==0.5.1
          mlx==0.6.0
          mlx==0.7.0
          mlx==0.8.1
          mlx==0.9.1
          mlx==0.10.0
          mlx==0.11.1
          mlx==0.12.2
          mlx==0.13.0
          mlx==0.13.1
          mlx==0.14.0
          mlx==0.14.1
          mlx==0.15.0
          mlx==0.15.1
          mlx==0.15.2
          mlx==0.16.0
          mlx==0.16.1
          mlx==0.16.2
          mlx==0.16.3
          mlx==0.17.1
          mlx==0.17.2
          mlx==0.17.3
          mlx==0.18.0
          mlx==0.18.1
          mlx==0.19.0
          mlx==0.19.3
          mlx==0.20.0
          mlx==0.21.0
          mlx==0.21.1
          mlx==0.22.0
      and mlx<=0.0.3 has no wheels with a matching Python ABI tag (e.g., `cp312`), we can conclude that mlx<=0.0.3 cannot be used.
      And because mlx>=0.0.4 has no wheels with a matching platform tag (e.g., `macosx_12_0_arm64`) and you require mlx, we can conclude that your requirements are unsatisfiable.

      hint: You require CPython 3.12 (`cp312`), but we only found wheels for `mlx` (v0.0.3) with the following Python ABI tags: `cp38`, `cp39`, `cp310`, `cp311`

      hint: Wheels are available for `mlx` (v0.22.0) on the following platforms: `macosx_13_0_arm64`, `macosx_14_0_arm64`
```

`--python-platform macos` defaults to support for macOS 12. You can change the deployment target, e.g.:

```
❯ echo "mlx" | MACOSX_DEPLOYMENT_TARGET="13" uv pip compile - -p 3.12 --python-platform=macos
Resolved 1 package in 102ms
# This file was autogenerated by uv via the following command:
#    uv pip compile - -p 3.12 --python-platform=macos
mlx==0.22.0
```

---

_Label `question` added by @zanieb on 2025-01-16 22:34_

---

_Comment by @nmichlo on 2025-01-16 22:38_

Thank you for the fast response!

---

_Closed by @nmichlo on 2025-01-16 22:38_

---

_Comment by @nmichlo on 2025-01-16 22:40_

@zanieb Should this not be documented as part of the command? Or The Env variable not be printed as part of the output "try setting `MACOSX_DEPLOYMENT_TARGET=13`"?

It seems like I should be able to pass `macosx_13_0_arm64 ` into `--python-platform` but this is invalid

---

_Comment by @zanieb on 2025-01-16 22:50_

It's hard to show that kind of thing in error messages, though I'm supportive of it. Those hints are brand new.

Here's the documentation https://github.com/astral-sh/uv/pull/10698

I'm not sure why we don't support `macosx_13_0_arm64` — that's a wheel platform tag though and the CLI takes target triples which don't have a OS version component like that.

---

_Comment by @nmichlo on 2025-01-20 15:11_

Thank you for the fast patch!

And for the new issue opened, #10699 

---
