<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to configure uv to use two azure package registry? - astral-sh/uv #13044</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>How to configure uv to use two azure package registry?</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/13044">#13044</a>
        opened by <a href="https://github.com/krasnikau-andrei">@krasnikau-andrei</a>
        on 2025-04-22 07:29
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/krasnikau-andrei">@krasnikau-andrei</a> on 2025-04-22 07:29</div>
            <div class="timeline-body"><h3>Question</h3>
<p>My current .netrc</p>
<pre><code class="language-netrc">machine pkgs.dev.azure.com
    login repo1
    password &lt;PAT1&gt;
machine pkgs.dev.azure.com
    login repo2
    password &lt;PAT2&gt;
</code></pre>
<p>Part of pyproject.toml</p>
<pre><code class="language-toml">...

[[tool.uv.index]]
name = &quot;repository1&quot;
url = &quot;https://pkgs.dev.azure.com/repo1/Project1/_packaging/some-other-repo/pypi/simple/&quot;
explicit = true

[[tool.uv.index]]
name = &quot;repository2&quot;
url = &quot;https://pkgs.dev.azure.com/repo2/Project2/_packaging/some-repo/pypi/simple/&quot;
explicit = true
...
</code></pre>
<p><code>repo2</code> works, but <code>repo1</code> shows an authorization error. Suppose I remove the <code>repo2</code> credential from .netrc, the <code>repo1</code> starts to work. I assume the current .netrc just overrides the previous record. How to make it work together?</p>
<p>Also, I tried a config like this, but no result</p>
<pre><code class="language-toml">...
[[tool.uv.index]]
name = &quot;repository2&quot;
url = &quot;https://repo2@pkgs.dev.azure.com/repo2/Project2/_packaging/some-repo/pypi/simple/&quot;
explicit = true
...
</code></pre>
<h3>Platform</h3>
<p>Windows 11</p>
<h3>Version</h3>
<p>uv 0.6.14 (a4cec56dc 2025-04-09)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @krasnikau-andrei on 2025-04-22 07:29</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krasnikau-andrei">@krasnikau-andrei</a> on 2025-04-22 17:31</div>
            <div class="timeline-body"><p>I can't use .netrc
I can't use .env
Keyring somehow also doesn't work :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @konstin on 2025-04-23 11:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-04-23 15:26</div>
            <div class="timeline-body"><p>This is probably the same issue as seen in #13059, where I <a href="https://github.com/astral-sh/uv/issues/13059#issuecomment-2824667055">describe a workaround</a> for the time being. Let me know if that works for you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krasnikau-andrei">@krasnikau-andrei</a> on 2025-04-25 13:08</div>
            <div class="timeline-body"><p>Thanks for the help. We decided not to move to UV right now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jtfmumm">@jtfmumm</a> on 2025-04-25 14:03</div>
            <div class="timeline-body"><blockquote>
<p>Thanks for the help. We decided not to move to UV right now.</p>
</blockquote>
<p>Do you mind sharing the reasons? It can be helpful for us if you're comfortable with it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krasnikau-andrei">@krasnikau-andrei</a> on 2025-04-26 12:35</div>
            <div class="timeline-body"><p>We use Azure private registries, and there are several ways to configure authorization for them:</p>
<ol>
<li>.netrc - doesn't work for 2 registries</li>
<li>env - #13059 also didn't work. And it is not very useful to write envs for 3 repos. .env file couldn't be loaded automatically and could be specified only for the <code>uv run</code> command</li>
<li>keyring - also didn't work. Probably because same reasons as in #13059</li>
<li>pat in toml - we can't do that for security reasons</li>
</ol>
<p>We will wait until the tool is more stable for such tasks. Currently, I can't create a frictionless way to use it. It works great for public projects, but it's an unnecessary risk for commercial development.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:27 UTC
    </footer>
</body>
</html>
