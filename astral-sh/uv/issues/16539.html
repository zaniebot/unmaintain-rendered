<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Git LFS Smudge Errors When Installing Dependencies from Git Sources with LFS Files - astral-sh/uv #16539</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Git LFS Smudge Errors When Installing Dependencies from Git Sources with LFS Files</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16539">#16539</a>
        opened by <a href="https://github.com/ekzhu">@ekzhu</a>
        on 2025-10-31 17:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ekzhu">@ekzhu</a></div>
            <div class="timeline-body">Summary
<p>When installing a Python package from a Git repository that contains Git LFS tracked files using <code>uv sync</code> or <code>uv add</code>, the installation fails with Git LFS smudge errors, even when the LFS objects exist on the remote. Regular <code>git clone</code> works fine for the same repository.</p>
Related Issue
<p>This issue was discovered while investigating: <a href="https://github.com/microsoft/agent-framework/issues/1832">microsoft/agent-framework#1832</a></p>
Steps to Reproduce
<ol>
<li>Create a minimal <code>pyproject.toml</code> with a git dependency from a repository containing LFS files:</li>
</ol>
<pre><code>[project]
name = &quot;test-project&quot;
version = &quot;0.1.0&quot;
dependencies = [
    &quot;agent-framework-mem0 @ git+https://github.com/microsoft/agent-framework.git#subdirectory=python/packages/mem0&quot;
]

[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;
</code></pre>
<ol>
<li>Run <code>uv sync</code></li>
</ol>
Expected Behavior
<p>The repository should be cloned successfully with all Git LFS files downloaded, similar to how <code>git clone https://github.com/microsoft/agent-framework.git</code> works.</p>
Actual Behavior
<p>The installation fails with a Git LFS smudge error:</p>
<pre><code>Error downloading object: python/packages/lab/lightning/assets/train_math_agent.png (ab35a2b):
Smudge error: Error downloading python/packages/lab/lightning/assets/train_math_agent.png
(ab35a2bd18794a32b76437671ae7e5749992c8aa781030b51eca2e56acfb362d):
error transferring &quot;ab35a2bd18794a32b76437671ae7e5749992c8aa781030b51eca2e56acfb362d&quot;:
[0] remote missing object ab35a2bd18794a32b76437671ae7e5749992c8aa781030b51eca2e56acfb362d

error: external filter &#x27;git-lfs filter-process&#x27; failed
fatal: python/packages/lab/lightning/assets/train_math_agent.png: smudge filter lfs failed
</code></pre>
<p>This error persists even after:</p>
<ul>
<li>Clearing uv cache (<code>uv cache clean</code>)</li>
<li>Verifying the LFS object exists on GitHub (regular <code>git clone</code> works fine)</li>
<li>Confirming the SHA256 hash matches in successful clones</li>
</ul>
Platform
<p>Ubuntu 22.04.5 LTS (WSL2)</p>
Version
<p>0.8.19</p>
Python version
<p>3.13.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/ekzhu">@ekzhu</a> on 2025-10-31 17:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-11-01 03:17</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/uv/pull/16143 should resolve this (confirmed) as it behaves well regardless of filters.</p>
<p>I believe this is a case that even with setting <code>UV_GIT_LFS=1</code> it would not be resolved (with current uv).</p>
<p>In the mean time, the issue could also likely be the Git LFS filters configuration.
Make sure you run <code>git lfs install</code> or that your <code>~/.gitconfig</code> at least has filters properly configured.
You may also want to double check your system Git LFS config (in case it has conflicts) under <code>/etc/gitconfig</code>.</p>
<pre><code>[filter &quot;lfs&quot;]
        clean = git-lfs clean -- %f
        smudge = git-lfs smudge -- %f
        process = git-lfs filter-process
...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/konstin">@konstin</a> on 2025-12-16 13:34</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:40:52 UTC
    </footer>
</body>
</html>
