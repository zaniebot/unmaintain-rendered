<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>--offline is not offline for &quot;git+https&quot; sources. - astral-sh/uv #12234</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>--offline is not offline for &quot;git+https&quot; sources.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12234">#12234</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2025-03-17 09:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/konstin">@konstin</a> on 2025-03-17 09:53</div>
            <div class="timeline-body"><p><em>Originally posted by @andrei-korshikov in <a href="https://github.com/astral-sh/uv/issues/942#issuecomment-2728480835">#942</a></em></p>
<p>I'm on uv 0.6.6 (c1a0bb85e 2025-03-12). Some of my dependencies are <code>git+https</code>, e.g. I have</p>
<pre><code class="language-python"># /// script
# dependencies = [
#   &quot;pycurl @ git+https://github.com/pycurl/pycurl.git&quot;,
#   ]
# ///
</code></pre>
<p>On every run of <code>uv run --offline my_script.py</code> I see <code>Resolving dependencies...</code> message and get these messages on <code>stderr</code> (and see corresponding traffic in Wireshark):</p>
<pre><code>Updating https://github.com/pycurl/pycurl.git (HEAD)
Updated https://github.com/pycurl/pycurl.git (d92395d9fe1e18365c4e4812f4351bd6985872e1)
</code></pre>
<p>If this behaviour is intended, I think it should be documented. Documentation for <code>--offline</code> reads: &quot;Disable network access. When disabled, uv will only use locally cached data and locally available files.&quot;, and as we see for &quot;git+https&quot; it is definitely not so.</p>
<hr />
<p>Off-topic: and huge thank you for <code>uv</code>!:)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @konstin on 2025-03-17 09:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-17 13:15</div>
            <div class="timeline-body"><p>Yeah this seems like an oversight.</p>
<p>(As an aside, <code>Updated https://github.com/pycurl/pycurl.git (d92395d9fe1e18365c4e4812f4351bd6985872e1)</code> on its own does not always mean that we've made a network request. We show that even when checking out an already-available commit locally. But if the user is seeing Wireshark traffic then it does sound like a bug.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/andrei-korshikov">@andrei-korshikov</a> on 2025-03-17 14:22</div>
            <div class="timeline-body"><blockquote>
<p>But if the user is seeing Wireshark traffic then it does sound like a bug.</p>
</blockquote>
<p>Just for clarification. <code>--offline</code> without Internet access:</p>
<pre><code>% uv run --offline --script sync.py
   Updating https://github.com/pycurl/pycurl.git (HEAD)
  × Failed to download and build `pycurl @ git+https://github.com/pycurl/pycurl.git`
  ├─▶ Git operation failed
  ├─▶ failed to fetch into: /home/korshikov/.cache/uv/git-v0/db/9a596e5213c3162d
  ╰─▶ process didn't exit successfully: `/usr/bin/git fetch --force --update-head-ok 'https://github.com/pycurl/pycurl.git' '+HEAD:refs/remotes/origin/HEAD'` (exit status: 128)
      --- stderr
      fatal: unable to access 'https://github.com/pycurl/pycurl.git/': Could not resolve host: github.com
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-03-17 18:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @charliermarsh by @charliermarsh on 2025-03-17 18:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-17 18:19</div>
            <div class="timeline-body"><p>I think we can set <code>GIT_ALLOW_PROTOCOL=file</code> (https://git-scm.com/docs/git)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @charliermarsh on 2025-03-17 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @charliermarsh on 2025-03-17 18:20</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thejchap">@thejchap</a> on 2025-03-18 02:39</div>
            <div class="timeline-body"><p>I'll take a look at this one</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-04-04 16:02</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-04-04 16:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:44:25 UTC
    </footer>
</body>
</html>
