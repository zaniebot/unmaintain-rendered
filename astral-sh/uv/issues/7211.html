<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>False positive warning: &lt;dep&gt; doesn't have extra &lt;smth&gt; - astral-sh/uv #7211</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>False positive warning: &lt;dep&gt; doesn't have extra &lt;smth&gt;</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/7211">#7211</a>
        opened by <a href="https://github.com/dimaqq">@dimaqq</a>
        on 2024-09-09 07:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dimaqq">@dimaqq</a> on 2024-09-09 07:41</div>
            <div class="timeline-body"><p>Check out https://github.com/canonical/charmcraft</p>
<pre><code>ü¶ê/c/charmcraft (main)&gt; uv venv .host-venv
Using Python 3.11.9
Creating virtualenv at: .host-venv
Activate with: source .host-venv/bin/activate.fish
ü¶ê/c/charmcraft (main)&gt; . .host-venv/bin/activate.fish
(.host-venv) ü¶ê/c/charmcraft (main)&gt; uv pip install -e .
Resolved 67 packages in 627ms
Prepared 15 packages in 1.35s
‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë [0/67] Installing wheels...                                                                                                                                                                                                             warning: Failed to clone files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, reflinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 67 packages in 463ms
 + annotated-types==0.7.0
...
 + pydantic==2.9.0
 + pydantic-core==2.23.2
 + pydantic-yaml==1.3.0
...
 + pyyaml==6.0.2
...
 + zipp==3.20.1
warning: The package `pydantic-yaml==1.3.0` does not have an extra named `pyyaml`
</code></pre>
<p>Where did that warning come from?</p>
<p>The project specifies <code>pydantic-yaml</code> and <code>pyyaml</code> dependencies, but completely independently.</p>
<p>Very view extras are used in general and no extras are used in dependencies.</p>
<p>I'm happy to debug this further, though I'm not sure how.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/smheidrich">@smheidrich</a> on 2024-09-09 11:14</div>
            <div class="timeline-body"><pre><code>$ cd .venv
$ rg --no-ignore-parent '\[pyyaml'
craft_parts-2.0.0.dist-info/METADATA
22:Requires-Dist: pydantic-yaml[pyyaml]&gt;=1.0.0
</code></pre>
<p>^ That package (craft-parts) is where it comes from in your specific case, but I agree that it would make sense for uv to report the package in whose dependencies the wrong extra was requested (perhaps even the whole chain of dependencies leading up the one with the wrong extra).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dimaqq">@dimaqq</a> on 2024-09-10 04:32</div>
            <div class="timeline-body"><p>Thank you @smheidrich I've added a bug report to that repo.</p>
<p>P.S. that's a handy ag/rg/grep to help diagnose problems like this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @charliermarsh on 2024-09-16 01:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 04:47:48 UTC
    </footer>
</body>
</html>
