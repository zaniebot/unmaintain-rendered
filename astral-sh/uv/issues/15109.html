<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Respect `GH_HOST` in GitHub Gist resolution - astral-sh/uv #15109</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Respect <code>GH_HOST</code> in GitHub Gist resolution</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/15109">#15109</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-08-06 14:23
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-06 14:23</div>
            <div class="timeline-body"><p>Would also be nice if this would work with GitHub enterprise gists as well, maybe by environment variables like <code>gh</code> does (<code>GH_HOST</code>).</p>
<p><em>Originally posted by @jakeswenson in https://github.com/astral-sh/uv/issues/15058#issuecomment-3160356231</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2025-08-06 14:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">good first issue</span> added by @zanieb on 2025-08-06 14:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-08-08 09:22</div>
            <div class="timeline-body"><p>With GHE, can we know if the URL is <code>https:// &lt;hostname&gt;/gist</code> or <code>https:// gist.&lt;hostname&gt;</code>? It seems like that's configurable?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-08 11:28</div>
            <div class="timeline-body"><p>I don't know. We'll probably need feedback from some GHE users. I guess we could just try both.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jorgehermo9">@jorgehermo9</a> on 2025-08-21 16:54</div>
            <div class="timeline-body"><p>In Github Enterprise Server, not only the hostname changes for the rest API, but the rest api path. This documentation is very descriptive: https://docs.github.com/en/enterprise-cloud@latest/apps/sharing-github-apps/making-your-github-app-available-for-github-enterprise-server#the-app-code-must-use-the-correct-urls</p>
<p>We can take a look to how <code>gh</code> cli does this in https://github.com/cli/cli/blob/5eddf8d52369df321693c5f5131fdd138cd237a6/internal/ghinstance/host.go#L59</p>
<p>We should use <code>https://api.github.com/gists/{gist_id}</code> or <code>https://my.company.com/api/v3/gists/{gist_id}</code> if <code>GH_HOST</code> is not <code>github.com</code></p>
<p>Gist url: https://github.com/cli/cli/blob/5eddf8d52369df321693c5f5131fdd138cd237a6/internal/ghinstance/host.go#L80</p>
<p>However, supporting those differences would make the gist detection of uv more complicated, as right now uv only checks <code> if url.host_str() == Some(&quot;gist.github.com&quot;)</code>. In Github Enterprise server, the gist web url could be <code>https://github.my.company.com/gists/</code> instead. We should check  <code>url.host_str() == Some(&quot;gist.github.com&quot;) || url.path().starts_with(&quot;/gists&quot;)</code>
https://github.com/astral-sh/uv/blob/11633549fd39a7493154705f108e91c51ef590e3/crates/uv/src/commands/project/run.rs#L1749</p>
<p>Also, if the user inputs an Github Enterprise Server gist such as <code>https://github.my.company.com/gists/...</code>, should we use the <code>GH_HOST</code>? To me, we should use instead  <code>https://github.my.company.com</code> as the api's host if the gist web url comes from that host. <code>GH_HOST</code> in <code>gh</code> cli is for use cases where we do not have an url and instead, a gist id such as <code>3d90c4e5594ddcdf6dd023a80959c107</code>. If the input to <code>uv run</code> is an url, we should use that url's hosts instead of <code>GH_HOST</code>. If we allow both GH_HOST and gist web url, we can end up in inconsistencies such as <code>GH_HOST=https://github.another.company.com uv run https://github.my.company.com/gists/...</code>, where the gist is from <code>github.my.company.com</code> but the <code>GH_HOST</code> specifies another host</p>
<p><code>GH_HOST</code> would be useful if we had something like <code>GH_HOST=github.com uv run --gist 3d90c4e5594ddcdf6dd023a80959c107</code>, but requires a new cli option for <code>uv run</code> and specifying the gist id instead of the gist web url.</p>
<p>Should we use this issue to support Github Enterprise Server gists for commands such as <code>uv run https://github.my.company.com/gists/...</code>  and create another issue for the gist id use case  <code>GH_HOST=github.com uv run --gist  3d90c4e5594ddcdf6dd023a80959c107</code>?</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:06 UTC
    </footer>
</body>
</html>
