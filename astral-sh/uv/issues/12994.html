<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add `--torch-backend=auto` Flag to `uv add torch` - astral-sh/uv #12994</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add <code>--torch-backend=auto</code> Flag to <code>uv add torch</code></h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/12994">#12994</a>
        opened by <a href="https://github.com/NourEldin-Osama">@NourEldin-Osama</a>
        on 2025-04-21 01:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/NourEldin-Osama">@NourEldin-Osama</a> on 2025-04-21 01:51</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Currently, <code>uv pip</code> can automatically install the latest compatible CUDA version of PyTorch via:</p>
<p>1- CLI
<code>uv pip install &quot;torch&quot; --torch-backend=auto --preview</code></p>
<p>2- <a href="https://docs.astral.sh/uv/reference/settings/#__tabbed_96_1">pyproject.toml</a></p>
<pre><code class="language-pyproject.toml">[tool.uv.pip]
torch-backend = &quot;auto&quot;
</code></pre>
<p>It would be great if the same “auto” option were available when adding the <code>torch</code> package directly with <code>uv add</code>.</p>
<p>Proposal:
1- CLI
<code>uv add torch --torch-backend=auto</code></p>
<p>2- pyproject.toml</p>
<pre><code class="language-pyproject.toml">[tool.uv]
torch-backend = &quot;auto&quot;
</code></pre>
<p>Thanks for this amazing tool!</p>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @NourEldin-Osama on 2025-04-21 01:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-04-21 03:06</div>
            <div class="timeline-body"><p>This is the PR that initially implemented <code>torch-backend=auto</code> in <code>uv pip install</code>.</p>
<ul>
<li>https://github.com/astral-sh/uv/pull/12070</li>
</ul>
<blockquote>
<p>Right now, this is only implemented in the uv pip CLI, since it doesn't quite fit into the lockfile APIs given that it relies on feature detection on the currently-running machine.</p>
</blockquote>
<p>So, I think the biggest issue with implementing this feature you're proposing is probably how to represent it in the lockfile, as lockfiles typically don't include dynamic detection content.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NourEldin-Osama">@NourEldin-Osama</a> on 2025-04-21 15:41</div>
            <div class="timeline-body"><p>@FishAlchemist</p>
<p>Any ideas on how to add this feature and address the challenge of representing dynamic, machine-specific detection (like <code>--torch-backend=auto</code>) in a static lockfile?</p>
<p>Has anyone considered possible approaches or workarounds for this limitation?</p>
<p>I’d like to use <code>uv add</code> with <code>torch-backend=auto</code> so that anyone installing my project gets the appropriate torch version for their CUDA setup.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/peacefulotter">@peacefulotter</a> on 2025-08-06 06:31</div>
            <div class="timeline-body"><p>This would be great!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/intexcor">@intexcor</a> on 2025-10-22 08:58</div>
            <div class="timeline-body"><p>You can use wheelnext</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/muhammad-fiaz">@muhammad-fiaz</a> on 2025-10-30 13:27</div>
            <div class="timeline-body"><p>this feature throwing me an error, when i add<a href="https://docs.astral.sh/uv/reference/settings/#pip_torch-backend"> this feature</a> to <code>[tool.uv.pip]</code></p>
<pre><code>{&quot;torch-backend&quot;:&quot;auto&quot;,&quot;generate-hashes&quot;:true,&quot;no-strip-markers&quot;:true,&quot;output-file&quot;:&quot;requirements.txt&quot;,&quot;prerelease&quot;:&quot;allow&quot;,&quot;universal&quot;:true,&quot;upgrade&quot;:true,&quot;verify-hashes&quot;:true} is not valid under any of the schemas listed in the 'anyOf' keywordEven Better TOML
</code></pre>
<p>this is actually what vscode's warning shows!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2025-11-03 13:28</div>
            <div class="timeline-body"><p>@muhammad-fiaz
I think you can open a separate issue to handle it, as it can easily be overlooked in the comments. As for your question, I have opened an issue (https://github.com/astral-sh/uv/issues/16545) for you, and I think you can test whether it is working correctly.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:00 UTC
    </footer>
</body>
</html>
