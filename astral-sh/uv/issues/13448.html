<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No solution found when resolving dependencies for split (sys_platform != 'linux') - astral-sh/uv #13448</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>No solution found when resolving dependencies for split (sys_platform != 'linux')</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/13448">#13448</a>
        opened by <a href="https://github.com/menouarazib">@menouarazib</a>
        on 2025-05-14 10:56
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/menouarazib">@menouarazib</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>When I'm combining the local index and the remote one, on a Linux machine, uv is looking for sys_platform != 'linux'.</p>
<p>My pyproject.toml:</p>
<pre><code>[project]
dependencies = [
    &quot;abc&quot;
]

[tool.uv.sources]
abc = [
    { index = &quot;index&quot;, marker = &quot;sys_platform == 'linux'&quot; },
    { index = &quot;local&quot;, marker = &quot;sys_platform != 'linux'&quot; }
]

[[tool.uv.index]]
name = &quot;index&quot;
url = &quot;https://index.com&quot;

[[tool.uv.index]]
name = &quot;local&quot;
url = &quot;./lib/&quot;
format = &quot;flat&quot;
</code></pre>
<h3>Platform</h3>
<p>Linux</p>
<h3>Version</h3>
<p>uv 0.6.14</p>
<h3>Python version</h3>
<p>Python 3.11, 3.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @menouarazib on 2025-05-14 10:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-14 11:51</div>
            <div class="timeline-body"><p>We need a complete reproduction in order to help out here. What‚Äôs the error, exactly? Note that uv performs a global resolution for all environments, so if your dependencies reference a directory like that, it does need to be available on all machines so that we can create a lockfile. If you already have a lockfile and are just looking to install from it without resolving, use the frozen flag, which would remove the need to include the local directory on your Linux machine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2025-05-14 11:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-05-14 11:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/menouarazib">@menouarazib</a> on 2025-05-14 14:47</div>
            <div class="timeline-body"><p>Thanks for your response. Here is a concrete example: by using the <code>pyproject.toml</code> below and running <code>uv sync</code> on a Windows machine, I got this error:</p>
<h2>Error</h2>
<pre><code>error: Failed to read `--find-links` directory: C:\Users\..\PycharmProjects\UvLocalIndex\lib
 Caused by: The system cannot find the path specified. (os error 3)
</code></pre>
<h2>pyproject.toml</h2>
<pre><code>[build-system]
requires = [&quot;hatchling&quot;]
build-backend = &quot;hatchling.build&quot;

[project]
name = &quot;uvlocalindex&quot;
dynamic = [&quot;version&quot;]
requires-python = &quot;&gt;=3.11, !=3.12.0&quot;
dependencies = [
    &quot;numpy&quot;
]

[tool.uv.sources]
numpy = [
    { index = &quot;pypi&quot;, marker = &quot;sys_platform == 'win32'&quot; },
    { index = &quot;local&quot;, marker = &quot;sys_platform == 'linux'&quot; },
]

[[tool.uv.index]]
name = &quot;pypi&quot;
url = &quot;https://pypi.org/simple&quot;

[[tool.uv.index]]
name = &quot;local&quot;
url = &quot;./lib/&quot;
format = &quot;flat&quot;

[tool.hatch.version]
path = &quot;UvLocalIndex/__version__.py&quot;

[tool.uv]
native-tls = true
allow-insecure-host = [&quot;https://pypi.org/simple&quot;]
link-mode = &quot;copy&quot;
</code></pre>
<h2>Bug</h2>
<p>It is true that the <code>lib</code> folder does not exist in <code>UvLocalIndex</code> in Windows machine, but I specified to use this folder only for Linux machine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-05-14 14:56</div>
            <div class="timeline-body"><p>We require all sources to exist at resolution time, regardless of the target platform. As Charlie said, we perform a <a href="https://docs.astral.sh/uv/concepts/resolution/#universal-resolution">platform-independent resolution</a>. The platform markers only affect which packages are <em>installed</em>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-05-14 18:41</div>
            <div class="timeline-body"><p>üëç This is working as intended! Try <code>uv sync --frozen</code> if you want to install-without-resolving from an existing lockfile.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-05-14 18:41</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:31:21 UTC
    </footer>
</body>
</html>
