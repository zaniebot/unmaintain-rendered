<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using project as script dependency - astral-sh/uv #9495</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using project as script dependency</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/9495">#9495</a>
        opened by <a href="https://github.com/areleu">@areleu</a>
        on 2024-11-28 10:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/areleu">@areleu</a></div>
            <div class="timeline-body"><p>Hello,</p>
<p>Sorry if this is a dumb question but I already spent like an hour trying to figure this out, I have a project folder with the following structure</p>
<pre><code>project
  __init__.py
  module
    __init__.py
    somemodule.py
scripts
  script.py
pyproject.toml
README.md
etc...
</code></pre>
<p>And the script.py has the following content</p>
<pre><code>from project.module.somemodule import some_function

if __name__==&quot;__main__&quot;:
    some_function()
</code></pre>
<p>If I run</p>
<pre><code>uv run .\scripts\script.py
</code></pre>
<p>I get</p>
<pre><code>File &quot;.scripts\script.py&quot;, line 1, in &lt;module&gt;
    from project.module.somemodule import some_function
ModuleNotFoundError: No module named &#x27;project&#x27;
</code></pre>
<p>At https://docs.astral.sh/uv/guides/scripts/#running-a-script-without-dependencies one can read:</p>
<blockquote>
<p>Note that if you use uv run in a project, i.e. a directory with a pyproject.toml, it will install the current project before running the script. If your script does not depend on the project, use the --no-project flag to skip this:</p>
</blockquote>
<p>But it seems that the module is not being installed, so I am at lost. If I place them in the main directory it works.I could place my scripts there, but I would rather not since I think they can just pile up and they can convolute the project folder. Am I missing something or doing something wrong?</p>
<p>Edit: I can always to the good ol&#x27; sys.path append, but it is hacky and it is the kind of thing I want to avoid when using a package manager.</p>
<p>Edit 2: Added <strong>init</strong>.py to example.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/areleu">@areleu</a> on 2024-11-28 12:25</div>
            <div class="timeline-body"><p>Unfortunately I get your comments as emails but I can&#x27;t seem to read them from here. I probably missunderstand then the usage of this manager. From my experience when someone develops a python library the code lives in a folder with the library name within the project folder which may have the same name.</p>
<p>For example: https://github.com/pandas-dev/pandas</p>
<p>The scripts folder I have are some tasks that I need to do that do not need to be delivered with the final package but need the tools defined in such package, I may be wrong but other solutions like hatch and poetry install whatever is delivered in the build files into the working environment.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/areleu">@areleu</a> on 2024-11-28 12:34</div>
            <div class="timeline-body"><blockquote>
<p>uv run scripts/script.py should work?</p>
</blockquote>
<p>I don&#x27;t know, I would argue that it should work and it works with other tools. But is not up to me to decide. If I have 2 or 3 scripts in a project that is not so crazy but the second I get a big project with 10 scripts the base directory can start to be hard to manage and is when a script folder can be handy.</p>
<blockquote>
<p>Your project folder, script folder, and pyproject.toml are located in the same directory.
But if you want to import from the project folder, shouldn&#x27;t your script folder be inside the project folder?</p>
</blockquote>
<p>Both scripts/ and project/ are inside the &quot;project&quot; folder (lets rename it to library if that is confusing). The latter is the deliverable and the scripts are support tools, I expect that anything that is defined in library which is what goes into the dist/package-x.x.x,tar.gz to be considered when running anything within the project when I don&#x27;t use the --no-project flag, a work around would be to actually install it with pip install -e . but then I would have to do it with every python version I am working with isn&#x27;t it?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/FishAlchemist">@FishAlchemist</a> on 2024-11-28 12:58</div>
            <div class="timeline-body"><p>@areleu I just deleted my comment because I realized I might have misunderstood something. Could you provide a compressed file containing the directory structure that can reproduce your issue?
I&#x27;m unsure if uv can make modules search from the same directory as pyproject.toml, but if we install the project into the environment, we should be able to import them directly</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/areleu">@areleu</a> on 2024-11-28 13:28</div>
            <div class="timeline-body"><p>There you go: <a href="https://github.com/user-attachments/files/17948666/hello_project.zip">hello_project.zip</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-28 14:08</div>
            <div class="timeline-body"><p>Since your module is in a different working directory than the script, I presume you need to install your module into the environment as a package for it to be available. See https://docs.astral.sh/uv/concepts/projects/config/#project-packaging for details.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2024-11-28 14:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/areleu">@areleu</a> on 2024-11-28 14:28</div>
            <div class="timeline-body"><p>I figured out a hack, that seems to be working, so I can tell uv to package it for me:</p>
<p>script/script.py:</p>
<pre><code># /// script
# requires-python = &quot;&gt;=3.13&quot;
# dependencies = [
#     &quot;hello_project @ file:///${PROJECT_ROOT}/&quot;
# ]
# ///


from hello_project.hello import say_hello

print(&quot;This does work!&quot;)
say_hello()
</code></pre>
<p>But idk if it is the intended usage, maybe is the best way to go, specially because it seems to be doing some caching, if I change the folder structure a bit it will be try to use the older version, is there a command to force reinstallation?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-28 14:28</div>
            <div class="timeline-body"><p>You can always add <code>--reinstall-package hello-project</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-07 19:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:35:49 UTC
    </footer>
</body>
</html>
