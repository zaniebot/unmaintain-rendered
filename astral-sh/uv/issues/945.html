<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support refreshing cached data during `pip compile` - astral-sh/uv #945</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Support refreshing cached data during `pip compile`</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/945">#945</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2024-01-16 23:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-16 23:22</div>
            <div class="timeline-body"><p>Right now, we support <code>pip sync --reinstall</code> and <code>pip sync --reinstall-package</code>, which (1) purges all cached data for the packages and (2) reinstalls them into the environment.</p>
<p>We don't have any way to force <code>pip compile</code> to refresh cached data, though. This issue will track support for that behavior. I need to think through the various options and the ideal user-facing API and behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2024-01-16 23:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-01-16 23:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-17 00:33</div>
            <div class="timeline-body"><p>My current thinking...</p>
<p><code>--refresh</code> and <code>--refresh-package [package]</code>:</p>
<ul>
<li>Ignore cached data for all packages or for an individual package.</li>
<li>Available on <code>sync</code>, <code>compile</code>, and <code>install</code>.</li>
<li>In practice, the way this would work is: track the packages we need to refresh. When reading from the cache, check if it's a package that needs to be refreshed, and whether it's already been refreshed. If we haven't refreshed, purge all cache entries for that package.</li>
<li>(So, in short, we lazily purge the cache for all relevant packages. We can't purge them all upfront, since we don't know all relevant packages upfront.)</li>
</ul>
<p><code>--reinstall</code> and <code>--reinstall-package [package]</code>:</p>
<ul>
<li>When developing the install plan, mark relevant packages for uninstallation, and force them to be reinstalled.</li>
<li><code>--reinstall</code> will imply <code>--refresh</code>, and <code>--reinstall-package</code> will imply <code>--refresh-package</code>.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-01-17 00:33</div>
            <div class="timeline-body"><p>\cc @zanieb @konstin</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/949.html">astral-sh/uv#949</a> on 2024-01-17 15:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/1057.html">astral-sh/uv#1057</a> on 2024-01-23 05:53</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-01-23 23:30</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:17 UTC
    </footer>
</body>
</html>
