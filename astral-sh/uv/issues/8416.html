<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pyproject validation messages are ambiguous - astral-sh/uv #8416</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>pyproject validation messages are ambiguous</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/8416">#8416</a>
        opened by <a href="https://github.com/lskbr">@lskbr</a>
        on 2024-10-21 12:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/lskbr">@lskbr</a> on 2024-10-21 12:42</div>
            <div class="timeline-body"><p>uv --version
0.4.45</p>
<p>also tested with version 0.4.22</p>
<p>OS: Windows 11 - WSL</p>
<p>pyproject.toml:</p>
<pre><code>[project]
name = &quot;x&quot;
version = &quot;0.1.0&quot;
description = &quot;Add your description here&quot;
readme = &quot;README.md&quot;
requires-python = &quot;&gt;=3.11&quot;
dependencies = [
]
 
[project.optional-dependencies]
dev = [
    &quot;rich&gt;=13.9.2&quot;,
]
</code></pre>
<p>This pyproject.toml was created with <code>uv init</code>. The rich dependency was added with:</p>
<pre><code>uv add rich --optional dev
</code></pre>
<p>The problem:</p>
<pre><code>uv pip install --extra dev . -vvvv
    0.002785s DEBUG uv uv 0.4.25
error: Requesting extras requires a `pyproject.toml`, `setup.cfg`, or `setup.py` file.
</code></pre>
<p>The message implies that pyproject.toml file does not exist, but it is there.</p>
<p>Installing with</p>
<pre><code>uv pip install .[dev]
</code></pre>
<p>works without any problem. Same directory, same venv.</p>
<p>The problem is: if pyptoject.toml exists and is valid, why the error message tells extra requires a pyproject.toml?</p>
<p>This also happens when a [project] section is not present in the pyproject, for example, when it is created with poetry. The error message is the same, even if the pyproject.toml is there and is used by other uv options.</p>
<p>In the first case RUST_TRACE and RUST_LOG do not help, the output is the same.
In the second case, missing project header, RUST_TRACE and RUST_LOG can be used to have a hint of the problem.</p>
<p>Can you please have a look if there is an error in <code>uv pip install --help</code>?
Can you please consider changing the error message to clearly indicate when a file does not exist and when it exists but is invalid or missing something?
Can you please confirm uv should be compatible with the pyproject.toml generated by poetry? (and when poetry is the specified builder).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-21 13:30</div>
            <div class="timeline-body"><p>I believe <code>uv pip install --extra dev -r pyproject.toml</code> is the expected usage there.</p>
<p>I see how this is confusing though, we can improve this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">error messages</span> added by @zanieb on 2024-10-21 13:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lskbr">@lskbr</a> on 2024-10-21 15:35</div>
            <div class="timeline-body"><p>So the -r is missing when I use --extra. By the message I thought it wasn't finding the pyproject file itself.
It is also strange that pip install .[dev] works without the -r.
So we have two settings:
If I use the uv pip install .[dev] notation, I don't have to pass a -r and I should not use --extra.
If I use uv pip install -extra dev I have to pass the -r pyproject.toml.
Is this correct?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-21 15:55</div>
            <div class="timeline-body"><p><code>.[dev]</code> and <code>-r pyproject.toml</code> aren't quite the same. The former installs the project itself; the latter installs the project's <em>requirements</em>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-21 21:25</div>
            <div class="timeline-body"><p>Same problem</p>
<ul>
<li>https://github.com/astral-sh/uv/issues/4762</li>
<li>https://github.com/astral-sh/uv/issues/7845</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../pypa/pip/issues/12963.html">pypa/pip#12963</a> on 2024-10-26 16:03</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:14 UTC
    </footer>
</body>
</html>
