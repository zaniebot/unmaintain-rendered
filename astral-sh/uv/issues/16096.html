<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>keyring test test_simultaneous_multiple_create_delete_single_thread can fail - astral-sh/uv #16096</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>keyring test test_simultaneous_multiple_create_delete_single_thread can fail</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/16096">#16096</a>
        opened by <a href="https://github.com/konstin">@konstin</a>
        on 2025-10-02 07:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/konstin">@konstin</a> on 2025-10-02 07:30</div>
            <div class="timeline-body"><p>https://github.com/astral-sh/uv/actions/runs/18175581890/job/51740717744?pr=16092</p>
<pre><code>        FAIL [   0.187s] uv-keyring::threading test_simultaneous_multiple_create_delete_single_thread
  stdout ───

    running 1 test
    test test_simultaneous_multiple_create_delete_single_thread ... FAILED

    failures:

    failures:
        test_simultaneous_multiple_create_delete_single_thread

    test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 4 filtered out; finished in 0.17s
    
  stderr ───

    thread 'test_simultaneous_multiple_create_delete_single_thread' panicked at crates\uv-keyring\tests\threading.rs:259:22:
    Can't get ascii password: NoEntry
    stack backtrace:
       0: std::panicking::begin_panic_handler
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588/library\std\src\panicking.rs:697
       1: core::panicking::panic_fmt
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588/library\core\src\panicking.rs:75
       2: core::result::unwrap_failed
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588/library\core\src\result.rs:1765
       3: enum2$&lt;core::result::Result&lt;alloc::string::String,enum2$&lt;uv_keyring::error::Error&gt; &gt; &gt;::expect&lt;alloc::string::String,enum2$&lt;uv_keyring::error::Error&gt; &gt;
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\core\src\result.rs:1119
       4: threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block$0
                 at .\tests\threading.rs:259
       5: tokio::runtime::task::core::impl$6::poll::closure$0&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\core.rs:365
       6: tokio::loom::std::unsafe_cell::UnsafeCell&lt;enum2$&lt;tokio::runtime::task::core::Stage&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt; &gt; &gt; &gt;::with_mut
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\loom\std\unsafe_cell.rs:16
       7: tokio::runtime::task::core::Core&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;::poll&lt;enum2$&lt;threading::
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\core.rs:354
       8: tokio::runtime::task::harness::poll_future::closure$0&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\harness.rs:535
       9: core::panic::unwind_safe::impl$25::call_once&lt;enum2$&lt;core::task::poll::Poll&lt;tuple$&lt;&gt; &gt; &gt;,tokio::runtime::task::harness::poll_future::closure_env$0&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,al
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\core\src\panic\unwind_safe.rs:272
      10: std::panicking::catch_unwind::do_call&lt;core::panic::unwind_safe::AssertUnwindSafe&lt;tokio::runtime::task::harness::poll_future::closure_env$0&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sy
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\std\src\panicking.rs:589
      11: core::iter::adapters::take::impl$9::spec_for_each::check::closure$0&lt;char,alloc::string::impl$13::extend::closure_env$0&lt;core::iter::adapters::take::Take&lt;core::iter::sources::repeat_with::RepeatWith&lt;char (*)()&gt; &gt; &gt; &gt;
      12: std::panicking::catch_unwind
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\std\src\panicking.rs:552
      13: std::panic::catch_unwind&lt;core::panic::unwind_safe::AssertUnwindSafe&lt;tokio::runtime::task::harness::poll_future::closure_env$0&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\std\src\panic.rs:359
      14: tokio::runtime::task::harness::poll_future&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\harness.rs:523
      15: tokio::runtime::task::harness::Harness&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;::poll_inner&lt;enum2$
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\harness.rs:210
      16: tokio::runtime::task::harness::Harness&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;::poll&lt;enum2$&lt;threa
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\harness.rs:155
      17: tokio::runtime::task::raw::poll&lt;enum2$&lt;threading::test_simultaneous_multiple_create_delete_single_thread::async_block$0::async_block_env$0&gt;,alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\raw.rs:325
      18: tokio::runtime::task::raw::RawTask::poll
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\raw.rs:255
      19: tokio::runtime::task::LocalNotified&lt;alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;::run&lt;alloc::sync::Arc&lt;tokio::runtime::scheduler::current_thread::Handle,alloc::alloc::Global&gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\task\mod.rs:509
      20: tokio::runtime::scheduler::current_thread::impl$8::block_on::closure$0::closure$1&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:789
      21: tokio::task::coop::with_budget
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\task\coop\mod.rs:167
      22: tokio::task::coop::budget
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\task\coop\mod.rs:133
      23: tokio::runtime::scheduler::current_thread::impl$3::run_task::closure$0&lt;tuple$&lt;&gt;,tokio::runtime::scheduler::current_thread::impl$8::block_on::closure$0::closure_env$1&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;O
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:368
      24: tokio::runtime::scheduler::current_thread::Context::enter&lt;tuple$&lt;&gt;,tokio::runtime::scheduler::current_thread::impl$3::run_task::closure_env$0&lt;tuple$&lt;&gt;,tokio::runtime::scheduler::current_thread::impl$8::block_on::closure$0::closure_env$1&lt;core::pin::Pin&lt;ref_
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:432
      25: tokio::runtime::scheduler::current_thread::Context::run_task&lt;tuple$&lt;&gt;,tokio::runtime::scheduler::current_thread::impl$8::block_on::closure$0::closure_env$1&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tupl
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:368
      26: tokio::runtime::scheduler::current_thread::impl$8::block_on::closure$0&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:785
      27: tokio::runtime::scheduler::current_thread::impl$8::enter::closure$0&lt;tokio::runtime::scheduler::current_thread::impl$8::block_on::closure_env$0&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; 
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:829
      28: tokio::runtime::context::scoped::Scoped&lt;enum2$&lt;tokio::runtime::scheduler::Context&gt; &gt;::set&lt;enum2$&lt;tokio::runtime::scheduler::Context&gt;,tokio::runtime::scheduler::current_thread::impl$8::enter::closure_env$0&lt;tokio::runtime::scheduler::current_thread::impl$8::
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\context\scoped.rs:40
      29: tokio::runtime::context::set_scheduler::closure$0&lt;tuple$&lt;alloc::boxed::Box&lt;tokio::runtime::scheduler::current_thread::Core,alloc::alloc::Global&gt;,enum2$&lt;core::option::Option&lt;tuple$&lt;&gt; &gt; &gt; &gt;,tokio::runtime::scheduler::current_thread::impl$8::enter::closure_en
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\context.rs:176
      30: std::thread::local::LocalKey&lt;tokio::runtime::context::Context&gt;::try_with&lt;tokio::runtime::context::Context,tokio::runtime::context::set_scheduler::closure_env$0&lt;tuple$&lt;alloc::boxed::Box&lt;tokio::runtime::scheduler::current_thread::Core,alloc::alloc::Global&gt;,e
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\std\src\thread\local.rs:315
      31: std::thread::local::LocalKey&lt;tokio::runtime::context::Context&gt;::with&lt;tokio::runtime::context::Context,tokio::runtime::context::set_scheduler::closure_env$0&lt;tuple$&lt;alloc::boxed::Box&lt;tokio::runtime::scheduler::current_thread::Core,alloc::alloc::Global&gt;,enum2
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\std\src\thread\local.rs:279
      32: tokio::runtime::context::set_scheduler&lt;tuple$&lt;alloc::boxed::Box&lt;tokio::runtime::scheduler::current_thread::Core,alloc::alloc::Global&gt;,enum2$&lt;core::option::Option&lt;tuple$&lt;&gt; &gt; &gt; &gt;,tokio::runtime::scheduler::current_thread::impl$8::enter::closure_env$0&lt;tokio::
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\context.rs:176
      33: tokio::runtime::scheduler::current_thread::CoreGuard::enter&lt;tokio::runtime::scheduler::current_thread::impl$8::block_on::closure_env$0&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;,
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:829
      34: tokio::runtime::scheduler::current_thread::CoreGuard::block_on&lt;core::pin::Pin&lt;ref_mut$&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:729
      35: tokio::runtime::scheduler::current_thread::impl$0::block_on::closure$0&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:200
      36: tokio::runtime::context::runtime::enter_runtime&lt;tokio::runtime::scheduler::current_thread::impl$0::block_on::closure_env$0&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt;,tuple$&lt;&gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\context\runtime.rs:65
      37: tokio::runtime::scheduler::current_thread::CurrentThread::block_on&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\scheduler\current_thread\mod.rs:188
      38: tokio::runtime::runtime::Runtime::block_on_inner&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\runtime.rs:356
      39: tokio::runtime::runtime::Runtime::block_on&lt;core::pin::Pin&lt;ref_mut$&lt;dyn$&lt;core::future::future::Future&lt;assoc$&lt;Output,tuple$&lt;&gt; &gt; &gt; &gt; &gt; &gt; &gt;
                 at V:\.cargo\registry\src\index.crates.io-1949cf8c6b5b557f\tokio-1.47.1\src\runtime\runtime.rs:330
      40: threading::test_simultaneous_multiple_create_delete_single_thread
                 at .\tests\threading.rs:277
      41: threading::test_simultaneous_multiple_create_delete_single_thread::closure$0
                 at .\tests\threading.rs:241
      42: core::ops::function::FnOnce::call_once&lt;threading::test_simultaneous_multiple_create_delete_single_thread::closure_env$0,tuple$&lt;&gt; &gt;
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588\library\core\src\ops\function.rs:253
      43: core::ops::function::FnOnce::call_once
                 at /rustc/1159e78c4747b02ef996e55082b704c09b970588/library\core\src\ops\function.rs:253
    note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.

    thread 'test_simultaneous_multiple_create_delete_single_thread' panicked at crates\uv-keyring\tests\threading.rs:278:22:
    Task failed: JoinError::Panic(Id(1), &quot;Can't get ascii password: NoEntry&quot;, ...)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">ci-flake</span> added by @konstin on 2025-10-02 07:30</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-08 15:02</div>
            <div class="timeline-body"><p>This appears to be Windows-specific</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-08 16:03</div>
            <div class="timeline-body"><p>Claude tells me that Windows just isn't robust to write-read patterns like this?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-11-24 10:12</div>
            <div class="timeline-body"><p>Another one: https://github.com/astral-sh/uv/actions/runs/19628968183/job/56203994140</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/16834.html">astral-sh/uv#16834</a> on 2025-11-24 14:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-11-24 15:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:05 UTC
    </footer>
</body>
</html>
