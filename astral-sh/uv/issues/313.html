<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Support URL and path dependencies without a package name - astral-sh/uv #313</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Support URL and path dependencies without a package name</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/313">#313</a>
        opened by <a href="https://github.com/charliermarsh">@charliermarsh</a>
        on 2023-11-03 18:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/charliermarsh">@charliermarsh</a></div>
            <div class="timeline-body"><p>Apparently this works with pip?</p>
<pre><code>git+https://github.com/pallets/flask.git@refs/pull/5313/head
</code></pre>
<p>As opposed to:</p>
<pre><code>flask @ git+https://github.com/pallets/flask.git@refs/pull/5313/head
</code></pre>
<p>We could decide not to support these. I don't know if they're spec-compliant.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @charliermarsh on 2023-11-03 18:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-03 18:38</div>
            <div class="timeline-body"><p>\cc @konstin - do you know if these are spec-compliant? Or legacy?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-11-03 18:44</div>
            <div class="timeline-body"><p>They are iirc not part of PEP 621 and PEP 508, but they are supported in many places (<code>pip install https://...</code> makes sense)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-03 18:47</div>
            <div class="timeline-body"><p>Sadly, adds a lot of complexity.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2023-11-04 04:07</div>
            <div class="timeline-body"><p>Oh this is the syntax I use every time I install a package from <code>git</code> using <code>pip</code> üò¨</p>
<p>I'm not sure if we really need to support it in a requirements file? Unless it's common in the wild. Generally it seems reasonable to have a nice error suggesting inclusion of the package name.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-04 13:04</div>
            <div class="timeline-body"><p>If we support it <em>at all</em>, then it‚Äôs not too hard to support it in a requirements file too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-04 13:23</div>
            <div class="timeline-body"><p>Although, I guess it lets us skip supporting it in the <em>parser</em>. Anyway, we probably do need to support this long-term if it‚Äôs allowed in pyproject.toml.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2023-11-04 13:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "Feature complete" by @charliermarsh on 2023-11-04 13:33</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-04 13:42</div>
            <div class="timeline-body"><p>But yeah we should support them :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Support (or decide not to support) URL dependencies without a package name" to "Support URL dependencies without a package name" by @charliermarsh on 2023-11-04 13:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-11-05 15:02</div>
            <div class="timeline-body"><p>@konstin - Do you think we should make <code>name</code> optional on <code>Requirement</code>, or convert <code>Requirement</code> to an enum? Names can only be omitted when the version specific is a URL. Similarly, you can't have extras without a name. Feels like all of this could be encoded in the type system.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-11-06 09:20</div>
            <div class="timeline-body"><p>We should add a <code>RequirementsTxtRequirement</code> which allows not having a name (or where name can be a url), i'd keep PEP 508 <code>Requirement</code> as-is.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned @charliermarsh by @charliermarsh on 2023-11-06 21:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-13 06:32</div>
            <div class="timeline-body"><p>I'll give this another try.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2023-12-13 14:16</div>
            <div class="timeline-body"><p>Would you mind waiting until #587 is merged? Editables will profit from this, but doing it now would clash badly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2023-12-13 14:43</div>
            <div class="timeline-body"><p>Will do!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sfc-gh-jcarroll">@sfc-gh-jcarroll</a> on 2024-02-16 21:10</div>
            <div class="timeline-body"><p>It seems like this is also an issue for installing a local whl file?</p>
<pre><code class="language-sh">% uv pip install ./streamlit-1.31.1-py2.py3-none-any.whl 
error: Failed to parse `./streamlit-1.31.1-py2.py3-none-any.whl`
  Caused by: Expected package name starting with an alphanumeric character, found '.'
./streamlit-1.31.1-py2.py3-none-any.whl
^

% uv pip install &quot;streamlit @ ./streamlit-1.31.1-py2.py3-none-any.whl&quot;
Resolved 40 packages in 680ms
Downloaded 40 packages in 1.74s
Installed 40 packages in 97ms
...
</code></pre>
<p>BTW <code>uv</code> seems awesome!! Thank you!!!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-16 21:12</div>
            <div class="timeline-body"><p>Yup, all the same issue! Although we can probably support local wheels &quot;trivially&quot; since the file name is required to be encoded in the wheel.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edgarrmondragon">@edgarrmondragon</a> on 2024-02-17 05:43</div>
            <div class="timeline-body"><p>This is probably the biggest blocker to experimenting with uv <a href="https://github.com/meltano/meltano/blob/c47653b75be5be03441285f64a8d23d7fddd7a41/src/meltano/core/venv_service.py">in Meltano</a> since dependencies of the type <code>git+https://...</code> are very widely used by plugins.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Support URL dependencies without a package name" to "Support URL and path dependencies without a package name" by @charliermarsh on 2024-02-17 14:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-17 14:23</div>
            <div class="timeline-body"><p>üëç I want to support this, requires a bunch of internal refactors but definitely doable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/yyolk">@yyolk</a> on 2024-02-21 01:30</div>
            <div class="timeline-body"><p>Hopefully not to add to the confusion - I've been running scenarios against integrating with <a href="https://github.com/pdm-project/pdm"><code>pdm</code></a>.</p>
<p>While investigating my own feature request, pdm-project/pdm#2641 I discovered <code>pdm</code> is handling <code>requirements.txt</code>-style exports in a way that falls back to pip's behavior...and works with <code>uv</code> if I remove the <code>#egg=</code> fragments.</p>
<p>Here's some quirks I was able to discover. Being able to do <code>uv v --seed</code> for running through was very helpful, I use the <code>.venv/bin/pip</code> for wherever <code>pip install</code> is used. I believe these quirks would be universal, anywhere there's a python package with a <code>pyproject.toml</code>.</p>
<p>I'm using the <a href="https://github.com/pdm-project/pdm-example-monorepo">pdm-example-monorepo</a> below in the latest Python Docker image under a freshly made user in their home directory.</p>
<p><strong>When in a git directory:</strong></p>
<p><code>pip</code> will end up resolving an editable install (<code>pip install -e 'file://'$PWD'relative/path'</code>) of a local path that's inside a git directory differently than one that is not.</p>
<p>When inside a git directory, pip will include an <code>#egg=</code> fragment along with another fragment param for its relative directory, <code>subdirectory</code>.</p>
<p>e.g.;</p>
<pre><code class="language-bash"># replace .venv
$ uv v --seed
# install the package as editable with relative path
$ .venv/bin/pip install -e 'file://'$PWD'packages/pkg-second'

# ...

# show pip installation
$ .venv/bin/pip freeze | grep pkg-core

-e git+https://github.com/pdm-project/pdm-example-monorepo@b85261555ea063e68eaf744e225804149c27e64f#egg=pkg_core&amp;subdirectory=packages/pkg-core
</code></pre>
<p><strong>When it's not a git directory, and it's still an editable install:</strong></p>
<pre><code class="language-bash"># replace .venv
$ uv v --seed
# get rid of .git, so it's not detected as a git repository
$ mv .git .gitold
# install the package as editable with relative installation, again
$ .venv/bin/pip install -e 'file://'$PWD'/packages/pkg-core'

# ...

# show pip installation
$ .venv/bin/pip freeze | grep pkg-core

# Editable install with no version control (pkg-core==0.1.0+editable)
-e /home/python/pdm-example-monorepo/packages/pkg-core
</code></pre>
<hr />
<p><strong>Non-editable installs for comparison</strong></p>
<p>There's also this way that will lend itself to the next example - <code>pkg-name @ file:///...</code>, which cannot be installed as editable, regardless of git directory or not:</p>
<pre><code class="language-bash"># replace .venv
$ uv v --seed
# install relative package, non-editable, pkg @ file://... way
$ .venv/bin/pip install 'pkg-core @ file://'$PWD'/packages/pkg-core'

# ...

# freezes the same way whether in a git repository or not
$ venv/bin/pip freeze | grep pkg-core

pkg-core @ file:///home/python/pdm-example-monorepo/packages/pkg-core
</code></pre>
<p>And lastly - <code>pip install 'file://...</code> will result in the same <code>package-name @ file://...</code> expansion regardless if it's in a git directory or not üòÖ</p>
<pre><code class="language-bash"># replace .venv
$ uv v --seed
# install non-editable, just 'file://...' 
$ .venv/bin/pip install 'file://'$PWD'/packages/pkg-core'

# ...

# freezes the same way whether in git repository or not
$ .venv/bin/pip freeze | grep pkg-core
pkg-core @ file:///home/python/pdm-example-monorepo/packages/pkg-core
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kkpattern">@kkpattern</a> on 2024-02-22 07:30</div>
            <div class="timeline-body"><p>We have a similar use case; we want to install a package in a local directory without <code>editable.</code></p>
<p>We have several Python packages in a mono repo. Sometimes we need to create a python <code>venv</code>, install those packages into the <code>venv</code>, then pack the <code>venv</code> and distribute it to CI or production environment.</p>
<p>So we want to be able to install a local package like this:</p>
<pre><code class="language-bash">uv pip install ./path/to/package/dir
</code></pre>
<p>We don't want to use <code>-e</code> here because the venv will be redistributed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-22 13:35</div>
            <div class="timeline-body"><p>@kkpattern - that <em>is</em> supported, but you need to include the package name, like ‚Äú uv pip install ‚Äòfoo @ ./path/to/package/dir‚Äô‚Äù. We‚Äôll lift this restriction in time, I‚Äôm mostly focused on correctness issues right now.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kkpattern">@kkpattern</a> on 2024-02-22 13:41</div>
            <div class="timeline-body"><p>@charliermarsh  Yes. We figured that out. We have already switched to uv on our main branch. Massive speed up. Thanks for this awesome tool. (And ruff too!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/shekharidentv">@shekharidentv</a> on 2024-02-22 15:40</div>
            <div class="timeline-body"><p>I could able to install the package as mentioned above ways. but
<code>uv pip sync requirements.txt</code> is failing.  I am running <code>uv pip freeze &gt; requirements.txt </code> to generate the txt file.</p>
<pre><code>error: Couldn't parse requirement in `requirements.txt` at position 384
  Caused by: Trailing `(from https://&lt;url&gt;/&lt;package&gt;-0.7.1-py3-none-any.whl)` is not allowed
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-02-22 16:12</div>
            <div class="timeline-body"><p>@shekharidentv - do you mind opening a new issue for this? We may want to strip those URLs from freeze.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jkgenser">@jkgenser</a> on 2024-03-09 18:29</div>
            <div class="timeline-body"><p>üëç  for this feature. I'm liking UV so much that I'm using <code>pip install path/to/my.whl</code> (which is slow) and then <code>uv pip install</code> after.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-03-09 19:06</div>
            <div class="timeline-body"><p>@jkgenser note you <em>can</em> just provide a package name e.g. <code>uv pip install &quot;foo@path/to/my.whl&quot;</code> in the meantime.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jkgenser">@jkgenser</a> on 2024-03-10 14:46</div>
            <div class="timeline-body"><blockquote>
<p>@jkgenser note you <em>can</em> just provide a package name e.g. <code>uv pip install &quot;foo@path/to/my.whl&quot;</code> in the meantime.</p>
</blockquote>
<p>Wow amazing thank you that worked! I was having trouble because I saw other examples in github issues that referred to <code>&quot;package @ path/to/my.whl&quot;</code> and it wasn't working me. However removing the spaces was what was needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/aliencaocao">@aliencaocao</a> on 2024-03-10 16:44</div>
            <div class="timeline-body"><p>How to install optional deps?
<code>uv pip install xxx@./xxx[yy]</code> dont work and says Distribution not found</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/akx">@akx</a> on 2024-03-10 16:45</div>
            <div class="timeline-body"><blockquote>
<p>How to install optional deps?
<code>uv pip install xxx@./xxx[yy]</code> dont work</p>
</blockquote>
<p>I'd guess <code>uv pip install package[extra]@location</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jeremander">@jeremander</a> on 2024-03-15 21:46</div>
            <div class="timeline-body"><p>Loving <code>uv</code> so far!</p>
<p>Will supporting this also allow the very basic <code>uv pip install .</code> (non-editable) to work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-16 13:17</div>
            <div class="timeline-body"><p>Yup!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-18 18:16</div>
            <div class="timeline-body"><p>Publicly committing to this one.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-03-18 18:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dadokkio">@dadokkio</a> on 2024-03-18 18:21</div>
            <div class="timeline-body"><p>I've a similar issue with a requirements.txt file that contains a package installed as:</p>
<p><code>-e git+https://github.com/xxx/package.git@commit_id#egg=package package</code></p>
<p>at the moment <code>uv pip install</code> fails because -e seems to work only for local files
<code>error: Unsupported URL (expected a `file://` scheme) in requirements.txt </code></p>
<p>Will this syntax be supported? There is an alternative way to install a specific package in requirements in current folder from a github repo?</p>
<p>Thanks</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-18 18:27</div>
            <div class="timeline-body"><p>You can do <code>package @ git+https://github.com/xxx/package.git@commit_id</code>, right?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dadokkio">@dadokkio</a> on 2024-03-18 19:05</div>
            <div class="timeline-body"><p>Yes, but in that case it'll be installed under python path and not under current folder.. also with standard pip the behavior is different</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-18 19:08</div>
            <div class="timeline-body"><p>We don't support editable installs for Git and URL dependencies. I'd suggest just cloning the repo and installing it as a file-based editable install (<code>-e ./package</code>).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-20 23:44</div>
            <div class="timeline-body"><p>Okay, this is now in review.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-03-22 03:10</div>
            <div class="timeline-body"><p>These have all merged. Will be supported in the next release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-03-22 03:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/franciscoafonsoo">@franciscoafonsoo</a> on 2024-03-22 11:58</div>
            <div class="timeline-body"><p>Thank you so much for making this, makes a world of a difference !</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:23:06 UTC
    </footer>
</body>
</html>
