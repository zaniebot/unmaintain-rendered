<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>exclude-newer: overrides for private registries - astral-sh/uv #16813</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>exclude-newer: overrides for private registries</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16813">#16813</a>
        opened by <a href="https://github.com/acdha">@acdha</a>
        on 2025-11-21 21:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/acdha">@acdha</a></div>
            <div class="timeline-body">Summary
<p><code>--exclude-newer</code> is a very useful feature for implementing dependency cooldown policies but it requires package registries to support the JSON view with the PEP 700 <code>upload-time</code> attribute. This currently prevents usage on projects which use <a href="https://github.com/astral-sh/uv/issues/10394">Azure</a> or <a href="https://gitlab.com/gitlab-org/gitlab/-/issues/581770">GitLab</a> to host any dependencies.</p>
<p>It would be useful if there was a way to disable the exclude-newer mechanism for a single registry or package so it could be used for PyPI packages, which are usually the highest concern for the kind of attacks which a minimum age policy is designed to mitigate, while still allowing private registries to be used.</p>
Example
<p>Using the documentation example for a custom index, one option would be something like this:</p>
<pre><code>[tool.uv]
exclude-newer = &quot;‚Ä¶&quot;
skip-exclude-newer-for-indexes = [&quot;pytorch&quot;]

[[tool.uv.index]]
name = &quot;pytorch&quot;
url = &quot;https://download.pytorch.org/whl/cpu&quot;
</code></pre>
<p>‚Ä¶ or perhaps to avoid that somewhat ugly name:</p>
<pre><code>[tool.uv]
exclude-newer = &quot;‚Ä¶&quot;

[[tool.uv.index]]
name = &quot;pytorch&quot;
url = &quot;https://download.pytorch.org/whl/cpu&quot;
skip-exclude-newer-check = true
</code></pre>
<p>‚Ä¶ or perhaps this would be best as a per-package override requiring you to manually opt-in for each package:</p>
<pre><code>[tool.uv]
exclude-newer = &quot;‚Ä¶&quot;
exclude-newer-package = { pytorch = &quot;ALLOW_ANY&quot; } # This magic value can&#x27;t conflict with an existing date
# or, to make it more explicit that you only want to trust one source:
exclude-newer-package = { pytorch = { allow-latest-from-registry = &quot;pytorch&quot; } }
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/acdha">@acdha</a> on 2025-11-21 21:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-21 21:33</div>
            <div class="timeline-body"><p>I think it makes more sense for <code>exclude-newer</code> to be attachable to a <code>tool.uv.index</code> definition rather than define a list of exclusions? wdyt?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/acdha">@acdha</a> on 2025-11-21 22:00</div>
            <div class="timeline-body"><blockquote>
<p>I think it makes more sense for <code>exclude-newer</code> to be attachable to a <code>tool.uv.index</code> definition rather than define a list of exclusions? wdyt?</p>
</blockquote>
<p>That‚Äôs my inclination as well - I liked the middle proposed syntax the most when I was thinking about this but wanted to at least think about alternatives since every packaging discussion I have ever been in seems to involve someone bringing up a use-case wildly outside of what I do üòÅ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-21 22:20</div>
            <div class="timeline-body"><p>I&#x27;d also encourage you to let these private registries know you want this basic, standardized functionality :D</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/acdha">@acdha</a> on 2025-11-21 22:23</div>
            <div class="timeline-body"><blockquote>
<p>I&#x27;d also encourage you to let these private registries know you want this basic, standardized functionality :D</p>
</blockquote>
<p>For completeness, I opened this ticket for GitLab for that exact reason and will be escalating with our sales rep: https://gitlab.com/gitlab-org/gitlab/-/issues/581770</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/javiertejero">@javiertejero</a> on 2025-12-12 14:06</div>
            <div class="timeline-body"><p>we observed the same problem with AWS CodeArtifact, which does not support JSON API  - it would be great to have this <code>uv</code> setting  to skip validation for some additional private indexes</p>
<p>UPDATE: I opened a ticket with AWS support and they will consider implementing JSON API but unfortunately there is not ETA yet</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sumkincpp">@sumkincpp</a> on 2026-01-13 19:25</div>
            <div class="timeline-body"><p>As of #16854 specific packages can be excluded with following syntax -</p>
<pre><code>[tool.uv]
exclude-newer-package = { pytorch = false } 
</code></pre>
<p>**corrected</p>
<p>It&#x27;s of course really usefull for packages stored in private registries, which should not normally require version/dependency cooldown.</p>
<p>Good question if it really works with Gitlab, gonna test it with the next uv release!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fellhorn">@fellhorn</a> on 2026-01-14 10:35</div>
            <div class="timeline-body"><blockquote>
<p>As of <a href="https://github.com/astral-sh/uv/pull/16854">#16854</a> specific packages can be excluded with following syntax -</p>
<p>[tool.uv]
exclude-newer-package = { pytorch = true }</p>
</blockquote>
<p>Nit: One needs to set the value to <code>false</code> instead of <code>true</code> to disable <code>exclude-newer</code> for a specific package:</p>
<pre><code>[tool.uv]
exclude-newer-package = { pytorch = false } 
</code></pre>
<p>From what I can tell with GAR it works like a charm for registries that do not provide the <code>upload-time</code> metadata.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/acdha">@acdha</a> on 2026-01-14 16:12</div>
            <div class="timeline-body"><p>I just tested <a href="https://github.com/astral-sh/uv/pull/16854">astral-sh/uv#16854</a> with uv 0.9.25 and it&#x27;s working great. Thank you!</p>
<p>In case this helps anyone else, in my global configuration, I had an exclusion for two tools which Homebrew manages so there&#x27;s never the case where a tool like <code>prek</code> thinks the latest version of <code>uv</code> doesn&#x27;t exist because it was just released:</p>
<pre><code>exclude-newer = &quot;P8D&quot;
exclude-newer-package = { uv = false, ruff = false }
</code></pre>
<p>In projects, I have something like this:</p>
<pre><code>[tool.uv]
exclude-newer = &quot;P8D&quot;
exclude-newer-package = { internal-shared-library-hosted-on-gitlab = false }
</code></pre>
<p>The resulting lock file shows that uv is correctly combining the global and per-project settings to avoid locking incompatible versions.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:41:06 UTC
    </footer>
</body>
</html>
