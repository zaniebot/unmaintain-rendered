```yaml
number: 14584
title: "uv errors if the `pyproject.toml` is a directory"
type: issue
state: open
author: bsraya
labels:
  - help wanted
  - error messages
assignees: []
created_at: 2025-07-13T03:22:38Z
updated_at: 2025-08-06T07:35:12Z
url: https://github.com/astral-sh/uv/issues/14584
synced_at: 2026-01-10T01:57:33Z
```

# uv errors if the `pyproject.toml` is a directory

---

_Issue opened by @bsraya on 2025-07-13 03:22_

### Summary

Any `uv` commands that I executed always return:

```
error: failed to read from file `/pyproject.toml`: Is a directory (os error 21)
```

Adding `-v` to all commands does not return other helpful error messages.

What I have tried:
1. Remove cache
2. Uninstall (includes removing python and tool dirs) and reinstall
3. Remove cache, uninstall (including removing python and tool dirs), and reinstall

Could this be a duplicate issue? If yes, could you provide me the link? Appreciate the help.

![Image](https://github.com/user-attachments/assets/762ab176-4bea-40e2-a233-e295c8e5ef98)

### Platform

Pop!_OS jammy 22.04 x86_64

### Version

uv 0.7.20

### Python version

Python 3.12

---

_Label `bug` added by @bsraya on 2025-07-13 03:22_

---

_Comment by @FishAlchemist on 2025-07-13 07:58_

The error message explicitly states that `pyproject.toml` is a directory. Normally, `pyproject.toml` is a TOML-formatted text file.
So you need to check if `pyproject.toml` is a file. On a Linux system, if you run `ls` in the terminal and see that its type is `d`, then it's a directory.
e.g. **d**rwxrwxr-x   2 shengyu shengyu 4.0K Oct 27 22:00 myfolder

------------------------------------------

However, I believe `uv` should check if `pyproject.toml` is a file. Otherwise, encountering an error prevents subsequent actions from executing, such as autocompletion. Autocompletion should ignore `pyproject.toml` errors because it doesn't need it.

---

_Comment by @bsraya on 2025-07-13 09:45_

This is what I got after running `ls -la`:

```
-rw-rw-r--  1 user user      496 Jul 12 11:32 pyproject.toml
```

However, this issue persists in my entire system.

<img width="733" height="176" alt="Image" src="https://github.com/user-attachments/assets/663cf16f-37db-4ee7-9783-af5c9086e1b7" />

I have already checked the type of my `pyproject.toml`, and it shows it a text file.

<img width="622" height="590" alt="Image" src="https://github.com/user-attachments/assets/db0b2c1a-bcd2-4050-a79f-144827c169dc" />

Any idea which is possibly the root cause?

---

_Comment by @FishAlchemist on 2025-07-13 09:56_

https://docs.astral.sh/uv/concepts/configuration-files/#configuration-files
> uv will search for a pyproject.toml or uv.toml file in the current directory, or in the nearest parent directory.

Could you please check the working directory where you're running `uv` and its parent directories for any `pyproject.toml` directory?

And let's not forget the user-level Configuration file

---

_Comment by @FishAlchemist on 2025-07-13 10:07_

It's pretty much as I said in https://github.com/astral-sh/uv/issues/14584#issuecomment-3066834258. I just tested a Linux distribution, and its error message showed the path it was trying to access. So, uv found pyproject.toml at that location(`/pyproject.toml`), but failed when trying to access it.

---

_Comment by @bsraya on 2025-07-13 13:48_

I noticed that one of my Docker compose YAML files created that folder. I just deleted that, and it worked fine now. It was a rookie mistake. Thanks for the help! Cheers.

---

_Closed by @bsraya on 2025-07-13 13:49_

---

_Reopened by @zanieb on 2025-07-13 13:51_

---

_Comment by @zanieb on 2025-07-13 13:51_

Thanks for the help @FishAlchemist!

We should probably make this non-fatal.

---

_Renamed from "uv commands would return `os error 21`" to "uv errors if the `pyproject.toml` is a directory" by @zanieb on 2025-07-13 13:51_

---

_Comment by @zanieb on 2025-07-13 13:52_

I think if it's in the working directory, we should error and explain why? If it's in a parent directory, erroring seems too aggressive and we should probably just warn.

---

_Label `bug` removed by @zanieb on 2025-07-13 13:52_

---

_Label `error messages` added by @zanieb on 2025-07-13 13:52_

---

_Label `help wanted` added by @zanieb on 2025-07-13 13:52_

---

_Comment by @dhth on 2025-08-06 07:35_

Hi! I took a stab at this issue, but wanted to confirm a few things before sending in a PR. Is the following expected behaviour?

```
uv    = production uv
uvdev = my changes
```

```text
$ tree --gitignore
.
├── pyproject.toml                   <- directory
├── pyproject.toml.bak
├── README.md
├── src
│   └── main.py
└── uv.lock

3 directories, 4 files
```

```bash
# from project root

$ uv run src/main.py
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev run src/main.py
# error: Failed to read `pyproject.toml` as it's a directory, not a file

$ uv sync
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev sync
# error: Failed to read `pyproject.toml` as it's a directory, not a file
```

```bash
# from src

$ uv run main.py
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev run main.py
# warning: Found a directory at `/private/var/tmp/uvtests/test1/pyproject.toml`, which is normally expected to be a TOML file.
# Hello from test1!

$ uv sync
# error: failed to read from file `/private/var/tmp/uvtests/test1/pyproject.toml`: Is a directory (os error 21)

$ uvdev sync
# warning: Found a directory at `/private/var/tmp/uvtests/test1/pyproject.toml`, which is normally expected to be a TOML file.
# error: No `pyproject.toml` found in current directory or any parent directory
```

Questions
---

- If we ignore `pyproject.toml` being a directory in a parent directory, some commands (like `run`) might work (if the project has been synced before), but others might not (like `sync`). Is warning the user in this case still appropriate?

Thanks!

---
