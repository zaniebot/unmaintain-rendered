```yaml
number: 15928
title: pyqt5安装问题
type: issue
state: open
author: Y-ASLant
labels:
  - bug
  - needs-mre
assignees: []
created_at: 2025-09-18T09:13:02Z
updated_at: 2025-12-11T17:38:06Z
url: https://github.com/astral-sh/uv/issues/15928
synced_at: 2026-01-12T16:02:19Z
```

# pyqt5安装问题

---

_@Y-ASLant_

### Summary

我在用0.8.15之前时，在pyproject.toml中加入
```bash
[tool.uv]
required-environments = [ "sys_platform == 'win32'" ]
```
是可以在Windows下安装Pyqt5的，但是最近升级后，却发现无法使用uv add或者uv sync自动安装pyqt5了，这对我来说 非常不方便。只能多执行一步uv pip install pyqt5才可以安装，有什么好的解决方法吗？只需要客户执行一下uv sync就可以自动安装依赖。

### Platform

Windows

### Version

0.8.18

### Python version

Python3.12

---

_Label `bug` added by @Y-ASLant on 2025-09-18 09:13_

---

_Comment by @Y-ASLant on 2025-09-18 09:15_

我需要的场景是，客户拿到我的项目，在相同平台、系统架构下，只需要执行uv sync就可以直接自动安装好所有的依赖。

---

_Comment by @konstin on 2025-09-18 09:31_

What error message do you get? Can you share a minimal example and the output of `uv sync -v`?

---

_Comment by @Y-ASLant on 2025-09-18 10:19_

> What error message do you get? Can you share a minimal example and the output of `uv sync -v`?

(yolov5) PS L:\yolov5\label> uv add pyqt5
warning: `VIRTUAL_ENV=.venv` does not match the project environment path `L:\莱芜职业\Yolo模型训练\yolov5\.venv` and will be ignored; use `--active` to target the active environment instead
Resolved 64 packages in 653ms
error: Distribution `pyqt5-qt5==5.15.17 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform

hint: You're on Windows (`win_amd64`), but `pyqt5-qt5` (v5.15.17) only has wheels for the following platforms: `manylinux2014_x86_64`, `macosx_10_13_x86_64`, `macosx_11_0_arm64`; consider adding your platform to `tool.uv.required-environments` to ensure uv resolves to a version with compatible wheels


---

_Comment by @Y-ASLant on 2025-09-18 10:21_

> What error message do you get? Can you share a minimal example and the output of `uv sync -v`?

(yolov5) PS L:\yolov5\label> uv sync -v
DEBUG uv 0.8.18 (c4c47814a 2025-09-17)
DEBUG Found project root: `L:\yolov5\label`
DEBUG Found workspace root: `L:\yolov5`
DEBUG Adding root workspace member: `L:\yolov5`
DEBUG Adding discovered workspace member: `L:\yolov5\label`
DEBUG Acquired lock for `L:\yolov5`
DEBUG Reading Python requests from version file at `L:\yolov5\.python-version`
DEBUG Using Python request `3.12` from version file at `L:\yolov5\.python-version`
warning: `VIRTUAL_ENV=.venv` does not match the project environment path `L:\yolov5\.venv` and will be ignored; use `--active` to target the active environment instead
DEBUG Checking for Python environment at: `L:\yolov5\.venv`
DEBUG The project environment's Python version satisfies the request: `Python 3.12`
DEBUG Released lock at `C:\Users\ASLan\AppData\Local\Temp\uv-85941e05af523b41.lock`
DEBUG Acquired lock for `L:\yolov5\.venv`
DEBUG Using request timeout of 30s
DEBUG Found static `pyproject.toml` for: label @ file:///L:/%E8%8E%B1%E8%8A%9C%E8%81%8C%E4%B8%9A/Yolo%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/yolov5/label
DEBUG Found workspace root: `L:\yolov5`
DEBUG Found static `pyproject.toml` for: yolov5 @ file:///L:/%E8%8E%B1%E8%8A%9C%E8%81%8C%E4%B8%9A/Yolo%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/yolov5
DEBUG Found workspace root: `L:\yolov5`
DEBUG Existing `uv.lock` satisfies workspace requirements
Resolved 61 packages in 4ms
DEBUG Using request timeout of 30s
DEBUG Unnecessary package: pandas==2.3.2
DEBUG Unnecessary package: sympy==1.14.0
DEBUG Unnecessary package: torch==2.8.0
warning: Failed to uninstall package at L:\yolov5\.venv\Lib\site-packages\pandas-2.3.2.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at L:\yolov5\.venv\Lib\site-packages\sympy-1.14.0.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
warning: Failed to uninstall package at L:\yolov5\.venv\Lib\site-packages\torch-2.8.0.dist-info due to missing `RECORD` file. Installation may result in an incomplete environment.
Uninstalled 3 packages in 3ms
 - pandas==2.3.2
 - sympy==1.14.0
 - torch==2.8.0
DEBUG Released lock at `L:\yolov5\.venv\.lock`

---

_Comment by @Y-ASLant on 2025-09-18 10:33_

我换到别的文件夹，直接拷贝pyproject.toml和.python-version文件重新`uv sync`，他正常工作了
我认为不是中文路径问题，下面是我的一些测试（均为label目录下两个相同的pyproject.toml和.python-version文件）
#### 英文路径
PS L:\English\label> uv sync
Using CPython 3.9.22
Creating virtual environment at: .venv
Resolved 8 packages in 28ms
Installed 6 packages in 3.05s
 + labelimg==1.8.6
 + lxml==6.0.1
 + pyqt5==5.15.11
 + pyqt5-qt5==5.15.2
 + pyqt5-sip==12.17.0
 + setuptools==80.9.0
PS L:\English\label>

#### 中文路径
PS L:\这是中文路径\label> uv sync
Using CPython 3.9.22
Creating virtual environment at: .venv
Resolved 8 packages in 26ms
Installed 6 packages in 2.97s
 + labelimg==1.8.6
 + lxml==6.0.1
 + pyqt5==5.15.11
 + pyqt5-qt5==5.15.2
 + pyqt5-sip==12.17.0
 + setuptools==80.9.0
PS L:\这是中文路径\label>


#### 报错路径
PS L:\莱\Yolo模型训练\yolov5\label> uv sync
Resolved 66 packages in 2ms
error: Distribution `pyqt5-qt5==5.15.17 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform

hint: You're on Windows (`win_amd64`), but `pyqt5-qt5` (v5.15.17) only has wheels for the following platforms: `manylinux2014_x86_64`, `macosx_10_13_x86_64`, `macosx_11_0_arm64`; consider adding your platform to `tool.uv.required-environments` to ensure uv resolves to a version with compatible wheels
PS L:\莱\Yolo模型训练\yolov5\label>


---

_Comment by @Y-ASLant on 2025-09-18 10:51_

PS L:\莱\Yolo模型训练\yolov5\alabel> uv sync
Using CPython 3.9.22
Creating virtual environment at: .venv
Resolved 8 packages in 25ms
Installed 6 packages in 3.03s
 + labelimg==1.8.6
 + lxml==6.0.1
 + pyqt5==5.15.11
 + pyqt5-qt5==5.15.2
 + pyqt5-sip==12.17.0
 + setuptools==80.9.0
PS L:\莱\Yolo模型训练\yolov5\alabel>

我把`L:\莱\Yolo模型训练\yolov5\label`中的`label`改成了`alabel`它工作正常了。可是我没有与label同名的依赖呀，而且`L:\这是中文路径\label> uv sync`和`L:\English\label> uv sync`都是正常的。他们用的是同一个`pyproject.toml`和`.python-version`

```bash
[tool.uv]
required-environments = [ "sys_platform == 'win32'" ]

[project]
name = "testt"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.9"
dependencies = [
    "labelimg>=1.8.6",
    "pyqt5>=5.15.11",
    "setuptools>=80.9.0",
]
```

我在yolov5目录下一旦将`alabel`改回`label`就会出现以上问题pyqt5无法安装

---

_Comment by @konstin on 2025-09-19 08:47_

We support UTF-8, so chinese paths are supported.

In your log, it seems that `required-environments = [ "sys_platform == 'win32'" ]` worked and that `pyqt5` was successfully installed?

---

_Comment by @knowaywood on 2025-09-19 12:37_

好奇怪的问题

---

_Comment by @Y-ASLant on 2025-09-20 05:18_

> 好奇怪的问题

是的 我拉取的https://github.com/ultralytics/yolov5仓库 使用uv创建了一个虚拟环境，然后取消激活当前的虚拟环境，新建了一个label文件夹，然后在label文件夹里创建一个虚拟环境 安装pyqt5 就会出现这种问题，试了两台电脑 都是这样 一台win11一台win10

---

_Comment by @jusway on 2025-10-04 05:30_

> > 好奇怪的问题
> 
> 是的 我拉取的[https://github.com/ultralytics/yolov5仓库](https://github.com/ultralytics/yolov5%E4%BB%93%E5%BA%93) 使用uv创建了一个虚拟环境，然后取消激活当前的虚拟环境，新建了一个label文件夹，然后在label文件夹里创建一个虚拟环境 安装pyqt5 就会出现这种问题，试了两台电脑 都是这样 一台win11一台win10

我也是，而我也在标注yolo，哈哈哈

---

_Label `needs-mre` added by @konstin on 2025-10-06 08:49_

---

_Comment by @konstin on 2025-10-06 08:50_

Can you share a minimal reproducible example (https://github.com/astral-sh/uv/issues/9452)?

---

_Comment by @cute-omega on 2025-11-28 18:17_

> Can you share a minimal reproducible example ([#9452](https://github.com/astral-sh/uv/issues/9452))?

on my Windows 11 25H2 machine with uv 0.9.13 (7ca92dcf6 2025-11-26):
```batch
mkdir foo
cd foo
uv init .
uv add pyqt5
```
the last command shows:
```
Resolved 4 packages in 19ms                                                                                                 
error: Distribution `pyqt5-qt5==5.15.18 @ registry+https://pypi.tuna.tsinghua.edu.cn/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform

hint: You're on Windows (`win_amd64`), but `pyqt5-qt5` (v5.15.18) only has wheels for the following platforms: `manylinux2014_x86_64`, `macosx_10_13_x86_64`, `macosx_11_0_arm64`; consider adding "sys_platform == 'win32' and platform_machine == 'AMD64'" to `tool.uv.required-environments` to ensure uv resolves to a version with compatible wheels
```
and when I add `required-environments = [ "sys_platform == 'win32'" ]`, it worked and pyqt5 can be installed.

Some points:
1. the command is so easy to reproduce, and the `-vvv` output is too much long. So I choose not to show them here
2. I use pypi mirror built by TUNA in Tsinghua Univ. It's a common choice for China mainland users. I believe this problem is unrelated to it (although I haven't test it)
3. of course `uv pip install pyqt5` is ok

---

_Comment by @charliermarsh on 2025-11-28 18:58_

I haven't read the whole thread, but isn't this as-expected? The write-up here would be useful reading: https://docs.astral.sh/uv/concepts/resolution/#required-environments. The [latest `pyqt5-qt5` release](https://pypi.org/project/PyQt5-Qt5/#files) doesn't include wheels for Windows, so you have to tell uv that Windows wheels are required so that it backtracks.

---

_Comment by @DingerBtn on 2025-12-06 05:53_

dependencies = [
    "pynput>=1.8.1",
    "pyqt5",
    "win10toast>=0.9",
]

[[tool.uv.index]]
url = "https://pypi.tuna.tsinghua.edu.cn/simple"
default = true
required-environments = [ "sys_platform == 'win32'" ]

<img width="1062" height="171" alt="Image" src="https://github.com/user-attachments/assets/d5fd3a10-3fd3-4f1d-b412-6b21c2ac6b40" />

<img width="1920" height="1080" alt="Image" src="https://github.com/user-attachments/assets/e644ad3c-cfec-409c-aa07-aa11617f70c9" />

I have restricted the platform, but uv still tries to use the latest version without a Windows wheel, which should be a bug.

---

_Comment by @charliermarsh on 2025-12-06 14:59_

The `required-environments` should be under `[tool.uv]`, not `[[tool.uv.index]]`:

```toml
[project]
name = "foo"
version = "0.1.0"
requires-python = ">=3.14.0"
dependencies = [
"pynput>=1.8.1",
"pyqt5",
"win10toast>=0.9",
]

[tool.uv]
required-environments = [ "sys_platform == 'win32'" ]

[[tool.uv.index]]
url = "https://pypi.tuna.tsinghua.edu.cn/simple"
default = true
```

---

_Comment by @Y-ASLant on 2025-12-09 05:27_

> 应在 ，而不是 ：`required-environments``[tool.uv]``[[tool.uv.index]]`
> 
> [project]
> name = "foo"
> version = "0.1.0"
> requires-python = ">=3.14.0"
> dependencies = [
> "pynput>=1.8.1",
> "pyqt5",
> "win10toast>=0.9",
> ]
> 
> [tool.uv]
> required-environments = [ "sys_platform == 'win32'" ]
> 
> [[tool.uv.index]]
> url = "https://pypi.tuna.tsinghua.edu.cn/simple"
> default = true

您好，请问关于arm64设备，pyqt5怎么解决？conda的话，是包含预编译好的pyqt5 arm64架构的，使用uv安装时，是从pypi官方拉去源码编译pqyt5，无法编译，安装失败。

---

_Comment by @konstin on 2025-12-11 17:38_

To require arm64 wheels, you need to include a marker for arm64 + your operating system in `required-environments`. Note that the latest version of PyQT5 does provide an arm64 wheel for macOS: `PyQt5-5.15.11-cp38-abi3-macosx_11_0_arm64.whl`.

---
