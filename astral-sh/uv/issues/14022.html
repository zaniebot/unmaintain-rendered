<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip` does not respect $UV_PROJECT_ENVIRONMENT - astral-sh/uv #14022</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv pip` does not respect $UV_PROJECT_ENVIRONMENT</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/14022">#14022</a>
        opened by <a href="https://github.com/xoolive">@xoolive</a>
        on 2025-06-13 12:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/xoolive">@xoolive</a> on 2025-06-13 12:47</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Not sure whether this behaviour is by design, but it looks confusing to me.</p>
<p>It happens that I just want to quickly add a package to virtualenv for a specific use case, and I am perfectly fine with it being trashed during the next <code>uv sync</code></p>
<pre><code class="language-shell">$Â cd foo
$ export UV_PROJECT_ENVIRONMENT=$HOME/foo/.venv2
$ uv sync  # creates a .venv2 folder for the environment
$ uv run python  # uses the .venv2 environment
$Â uv pip install numpy  # this one basically expects the .venv folder
error: No virtual environment found; run `uv venv` to create an environment, or pass `--system` to install into a non-virtual environment
</code></pre>
<h3>Platform</h3>
<p>not platform specific</p>
<h3>Version</h3>
<p>uv 0.5.21</p>
<h3>Python version</h3>
<p>Python 3.13.0</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @xoolive on 2025-06-13 12:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-06-13 12:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-06-13 12:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-06-13 12:52</div>
            <div class="timeline-body"><p>This is intentional at the moment, <code>uv pip</code> is entirely agnostic of the project settings. I understand why it'd be nice for it to respect it here, but I worry it'd be confusing too.</p>
<p>We could consider respecting <code>UV_PROJECT_ENVIRONMENT</code> if <code>VIRTUAL_ENV</code> is unset ðŸ¤” hm</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @zanieb on 2025-06-13 12:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/xoolive">@xoolive</a> on 2025-06-13 12:55</div>
            <div class="timeline-body"><p>Thanks for quick head-up, and good luck for taking the better decision :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshdunnlime">@joshdunnlime</a> on 2025-06-13 15:10</div>
            <div class="timeline-body"><p>I have found this for <code>UV_SYSTEM_PYTHON</code> also.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chuckn246">@chuckn246</a> on 2025-07-17 20:34</div>
            <div class="timeline-body"><p>Somewhat related, I don't think <code>uv python find</code> respects <code>UV_PROJECT_ENVIRONMENT</code> either:</p>
<pre><code class="language-bash"># Set the variable
$ export UV_PROJECT_ENVIRONMENT=&quot;$HOME/Projects/uv_testing/venv&quot;

# Create project
$ uv init my_project
Initialized project `my-project` at `/Users/chuckn246/Projects/uv_testing/my_project`

# Change directories
$ cd my_project

# Create venv at UV_PROJECT_ENVIRONMENT
$ uv venv
Using CPython 3.13.3
Creating virtual environment at: /Users/chuckn246/Projects/uv_testing/venv
Activate with: source /Users/chuckn246/Projects/uv_testing/venv/bin/activate

# Prints incorrect location
$ uv python find
/Users/chuckn246/.local/share/uv/python/cpython-3.13.3-macos-aarch64-none/bin/python3.13

# Unset the variable
$ unset UV_PROJECT_ENVIRONMENT

# Create venv in project root
$ uv venv
Using CPython 3.13.3
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate

# Prints correct location
$ uv python find
/Users/chuckn246/Projects/uv_testing/my_project/.venv/bin/python3

# List of directories
$ ls -l ../
total 0
drwx------ 9 chuckn246 staff 288 Jul 17 16:27 my_project
drwx------ 7 chuckn246 staff 224 Jul 17 16:27 venv
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:07 UTC
    </footer>
</body>
</html>
