<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow `uv version` to use a non-PEP440-compliant version - astral-sh/uv #16497</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow <code>uv version</code> to use a non-PEP440-compliant version</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16497">#16497</a>
        opened by <a href="https://github.com/AgentK9">@AgentK9</a>
        on 2025-10-29 14:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/AgentK9">@AgentK9</a> on 2025-10-29 14:55</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>While it makes sense for <code>uv version</code> to be PEP440-compliant by default, allowing for non-compliant versions would help for cases where the version comes from another source (in my case, a <code>version.txt</code> generated by <code>git describe --tags</code>, which can result in a version like <code>1.2.3-1-gabcdefgh</code>).</p>
<p>This should be a config option and not the default, but would also be a potential step towards #14037.</p>
<p>Currently, using a version like this results in an error like: <code>error: after parsing 1.2.3-1, found -gabcdefgh, which is not part of a valid version</code></p>
<h3>Example</h3>
<p>Add a <code>--ignore-pep440</code> option to <code>uv version</code>, usable like so: <code>uv version --ignore-pep440 1.2.3-1-gabcdefgh</code>.
Ideally, also allow it to be configured as an env var: <code>UV_VERSION_IGNORE_PEP440</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @AgentK9 on 2025-10-29 14:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-29 15:00</div>
            <div class="timeline-body"><p>The argument here is that we should be able to write a non-PEP 440 compliant version to the <code>project.version</code> field?</p>
<p>Why not process your git-derived version to be PEP 440 compliant? e.g., I've written a utility for this before https://github.com/zanieb/poetry-relax/blob/main/scripts/version</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-30 14:23</div>
            <div class="timeline-body"><p>This is related to</p>
<ul>
<li>https://github.com/astral-sh/uv/issues/14353</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AgentK9">@AgentK9</a> on 2025-12-02 15:27</div>
            <div class="timeline-body"><p>for anyone else looking for a solution, this is how I fixed:</p>
<p><code>uv version $(git describe --tags | sed -E 's/-([0-9]+)-g([0-9a-f]+)$/+\1.\2/')</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/AgentK9">@AgentK9</a> on 2025-12-02 15:35</div>
            <div class="timeline-body"><p>I think that my actual ask for this ticket is for uv to do this sort of thing out of the box - like <code>uv version --from-git</code> or something.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:31:09 UTC
    </footer>
</body>
</html>
