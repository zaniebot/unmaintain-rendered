<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&quot;import setuptools&quot; fails due to missing distutils - astral-sh/uv #15233</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>&quot;import setuptools&quot; fails due to missing distutils</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/15233">#15233</a>
        opened by <a href="https://github.com/Rick-McCoy">@Rick-McCoy</a>
        on 2025-08-12 09:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Rick-McCoy">@Rick-McCoy</a></div>
            <div class="timeline-body">Summary
<p>This issue occurs on a Kubernetes pod in which I do not have admin privileges.</p>
<pre><code>&lt;snip&gt;$ mkdir temp
&lt;snip&gt;$ cd temp
&lt;snip&gt;/temp$ uv init
Initialized project `temp`
&lt;snip&gt;/temp$ uv venv .venv
Using CPython 3.13.5
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate
&lt;snip&gt;/temp$ uv add setuptools
Resolved 2 packages in 5ms
░░░░░░░░░░░░░░░░░░░░ [0/1] Installing wheels...
warning: Failed to hardlink files; falling back to full copy. This may lead to degraded performance.
         If the cache and target directories are on different filesystems, hardlinking may not be supported.
         If this is intentional, set `export UV_LINK_MODE=copy` or use `--link-mode=copy` to suppress this warning.
Installed 1 package in 2.94s
 + setuptools==80.9.0
&lt;snip&gt;/temp$ uv run -q python -c &quot;import setuptools&quot;
&lt;snip&gt;/temp/.venv/lib/python3.13/site-packages/_distutils_hack/__init__.py:53: UserWarning: Reliance on distutils from stdlib is deprecated. Users must rely on setuptools to provide the distutils module. Avoid importing distutils or import setuptools first, and avoid setting SETUPTOOLS_USE_DISTUTILS=stdlib. Register concerns at https://github.com/pypa/setuptools/issues/new?template=distutils-deprecation.yml
  warnings.warn(
Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
    import setuptools
  File &quot;&lt;snip&gt;/temp/.venv/lib/python3.13/site-packages/setuptools/__init__.py&quot;, line 23, in &lt;module&gt;
    from . import logging, monkey
  File &quot;&lt;snip&gt;/temp/.venv/lib/python3.13/site-packages/setuptools/logging.py&quot;, line 5, in &lt;module&gt;
    from . import monkey
  File &quot;&lt;snip&gt;/temp/.venv/lib/python3.13/site-packages/setuptools/monkey.py&quot;, line 13, in &lt;module&gt;
    import distutils.filelist
ModuleNotFoundError: No module named &#x27;distutils&#x27;
</code></pre>
<p>When I search online on how to mitigate <code>distutils</code> deprecation issues, I always get told to install <code>setuptools</code>. But simply installing and importing setuptools leads to an error due to missing <code>distutils</code>, which seems paradoxical.</p>
<p>I have tried to replicate this on a local Macbook, but despite having the same <code>uv</code> version (0.8.9) and Python version (3.13.5), no such errors occur, and <code>setuptools</code> imports without a hitch.</p>
Platform
<p>Linux 4.18.0-372.9.1.el8.x86_64 x86_64 GNU/Linux</p>
Version
<p>uv 0.8.9</p>
Python version
<p>Python 3.13.5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/Rick-McCoy">@Rick-McCoy</a> on 2025-08-12 09:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Rick-McCoy">@Rick-McCoy</a> on 2025-08-12 09:05</div>
            <div class="timeline-body"><p>This also fails with Python 3.12.11 with the same error.
As a sanity check, no problems occur with Python 3.11.13.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-12 13:38</div>
            <div class="timeline-body"><p><code>distutils</code> was removed from the standard library https://docs.python.org/3/library/distutils.html</p>
<p>Hence the warnings etc.</p>
<p>I don&#x27;t actually see an obvious reason why this would fail on your Kubernetes cluster and not your local machine. I&#x27;d recommend reporting this to setuptools, not sure what we can do here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Rick-McCoy">@Rick-McCoy</a> on 2025-08-12 13:58</div>
            <div class="timeline-body"><p>It seems you&#x27;re right. The issue was with my machine, not <code>uv</code>.
For future reference, unsetting <code>SETUPTOOLS_USE_DISTUTILS</code> worked as a fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/Rick-McCoy">@Rick-McCoy</a> on 2025-08-12 13:58</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:39:58 UTC
    </footer>
</body>
</html>
