<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tkagg is not compatible with uv-managed Python installs - astral-sh/uv #6893</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>tkagg is not compatible with uv-managed Python installs</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/6893">#6893</a>
        opened by <a href="https://github.com/bluthej">@bluthej</a>
        on 2024-08-31 16:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/bluthej">@bluthej</a></div>
            <div class="timeline-body"><p>From the <a href="https://github.com/matplotlib/matplotlib/issues/25944#issuecomment-1557105621">matplot lib issue tracker (comment)</a>, apparently:</p>
<blockquote>
<p>python-build-standalone is not compatible with tkagg</p>
</blockquote>
<p>I am on Linux and it seems like tkagg is the default interactive backend (not sure about other platforms):</p>
<pre><code class="language-shell">‚ùØ python -c &quot;import matplotlib.pyplot as plt; print(plt.get_backend())&quot;
tkagg
</code></pre>
<p>Since uv <a href="https://docs.astral.sh/uv/concepts/python-versions/#cpython-distributions">relies on python-build-standalone</a> for managed installs, this has the unfortunate consequence that I have to use my system Python whenever I need to plot something in interactive mode.</p>
<p>This is related to <a href="https://github.com/matplotlib/matplotlib/issues/23074#issuecomment-1132368413">this matplotlib issue</a> and <a href="https://github.com/indygreg/python-build-standalone/issues/129">this python-build-standalone issue</a>, at which point things were even worse because people couldn't even <code>import matplotlib</code> successfully!</p>
<p>It sounds like python-build-standalone and tkagg will not be compatible anytime soon. I don't necessarily mind, but in any case I think it would be nice if we could either:</p>
<ul>
<li>document this issue and recommend a different interactive backend that works with python-build-standalone, along with the steps to take to make that work</li>
<li>take some steps on the python-build-standalone side so that there is some functioning interactive backend by default</li>
</ul>
<p>Hardly a day goes by that I don't need to plot something with matplotlib and I assume I am not alone, so this should benefit a lot of people!</p>
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceman-cb">@spaceman-cb</a> on 2024-09-01 07:10</div>
            <div class="timeline-body"><p>This is a big issue for me as well. Any help would be appreciated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceman-cb">@spaceman-cb</a> on 2024-09-01 19:11</div>
            <div class="timeline-body"><p>For people coming here and needing immediate help, setting your backend as described here may solve your problem:
https://matplotlib.org/stable/users/explain/figure/backends.html</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-09-02 11:22</div>
            <div class="timeline-body"><p>What operating system and Python version do you use, and do you set and custom matplotlib settings? For me, with Ubuntu 24.04 and <code>cpython-3.12.1-linux-x86_64-gnu</code>:</p>
<p><code>pyproject.toml</code></p>
<pre><code class="language-toml">[project]
name = &quot;mpl-basic&quot;
version = &quot;0.1.0&quot;
requires-python = &quot;&gt;=3.12&quot;
dependencies = [
    &quot;matplotlib&gt;=3.9.2&quot;,
]
</code></pre>
<p><code>main.py</code></p>
<pre><code class="language-python">import matplotlib.pyplot as plt

if __name__ == '__main__':
    print(plt.get_backend())

    plt.plot([0, 1], [0, 1])
    plt.savefig(&quot;hello.png&quot;)
</code></pre>
<p>With <code>uv run main.py</code>, I get <code>agg</code> as backend and a <code>hello.png</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tpgillam">@tpgillam</a> on 2024-09-02 15:09</div>
            <div class="timeline-body"><p>Running into this too. <code>savefig</code> works fine with the standalone builds; the problem is when trying to bring up an interactive window.</p>
<p>For example, when running:</p>
<pre><code class="language-python">from matplotlib import pyplot

pyplot.plot([0, 1], [0, 1])
pyplot.show()
</code></pre>
<p>gives the warning on the call to <code>pyplot.show()</code> (and nothing else of interest happens besides the program terminating)</p>
<pre><code>UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
</code></pre>
<p>I'm running with cpython-3.11.9-linux-x86_64-gnu on WSL (ubuntu 22.04) right now.</p>
<p><strong>edit</strong>: my current workaround is to have <code>PyQt6</code> installed in whichever environment I'm working, as matplotlib will then pick that up as the default interactive backend without any further intervention (I haven't set additional environment variables or call <code>matplotlib.use</code> explicitly).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/spaceman-cb">@spaceman-cb</a> on 2024-09-02 16:36</div>
            <div class="timeline-body"><p>I am on a mac and was running matplotlib 3.9.1 and 3.9.0.
<code>savefig('foo.pdf')</code> was causing issues.
Not sure why it was trying to use tk when nothing about it was interactive.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluthej">@bluthej</a> on 2024-09-02 16:56</div>
            <div class="timeline-body"><p>@konstin as I said in the issue, the problems I'm having are with the interactive backend, the static backend indeed works just fine out of the box (just like what @tpgillam said).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/MalekWahidi">@MalekWahidi</a> on 2024-10-25 11:44</div>
            <div class="timeline-body"><blockquote>
<p>Running into this too. <code>savefig</code> works fine with the standalone builds; the problem is when trying to bring up an interactive window.</p>
<p>For example, when running:</p>
<pre><code class="language-python">from matplotlib import pyplot

pyplot.plot([0, 1], [0, 1])
pyplot.show()
</code></pre>
<p>gives the warning on the call to <code>pyplot.show()</code> (and nothing else of interest happens besides the program terminating)</p>
<pre><code>UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
</code></pre>
<p>I'm running with cpython-3.11.9-linux-x86_64-gnu on WSL (ubuntu 22.04) right now.</p>
<p><strong>edit</strong>: my current workaround is to have <code>PyQt6</code> installed in whichever environment I'm working, as matplotlib will then pick that up as the default interactive backend without any further intervention (I haven't set additional environment variables or call <code>matplotlib.use</code> explicitly).</p>
</blockquote>
<p>After lots of trouble, <code>uv pip install PyQt6</code> is the only thing that got matplotlib interactive backend to work inside my venv!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fjsuarez">@fjsuarez</a> on 2024-11-13 21:27</div>
            <div class="timeline-body"><blockquote>
<p>After lots of trouble, <code>uv pip install PyQt6</code> is the only thing that got matplotlib interactive backend to work inside my venv!</p>
</blockquote>
<p>I'm afraid this does not solve it for me. I've gone down the rabbit hole trying to fix this. It should not be this complicated.</p>
<pre><code>Failed to create wl_display (No such file or directory)
qt.qpa.plugin: Could not load the Qt platform plugin &quot;wayland&quot; in &quot;&quot; even though it was found.
qt.qpa.plugin: From 6.5.0, xcb-cursor0 or libxcb-cursor0 is needed to load the Qt xcb platform plugin.
qt.qpa.plugin: Could not load the Qt platform plugin &quot;xcb&quot; in &quot;&quot; even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: minimalegl, eglfs, offscreen, wayland, linuxfb, vkkhrdisplay, wayland-egl, vnc, minimal, xcb.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tpgillam">@tpgillam</a> on 2024-11-13 21:49</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>After lots of trouble, <code>uv pip install PyQt6</code> is the only thing that got matplotlib interactive backend to work inside my venv!</p>
</blockquote>
<p>I'm afraid this does not solve it for me. I've gone down the rabbit hole trying to fix this. It should not be this complicated.</p>
<pre><code>Failed to create wl_display (No such file or directory)
qt.qpa.plugin: Could not load the Qt platform plugin &quot;wayland&quot; in &quot;&quot; even though it was found.
qt.qpa.plugin: From 6.5.0, xcb-cursor0 or libxcb-cursor0 is needed to load the Qt xcb platform plugin.
qt.qpa.plugin: Could not load the Qt platform plugin &quot;xcb&quot; in &quot;&quot; even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: minimalegl, eglfs, offscreen, wayland, linuxfb, vkkhrdisplay, wayland-egl, vnc, minimal, xcb.
</code></pre>
</blockquote>
<p>I have a vague recollection that installing libxcb-cursor0 from the operating system's package manager helped me with a similar issue once (but it was a while ago so can't remember the details I'm afraid!)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fjsuarez">@fjsuarez</a> on 2024-11-13 22:08</div>
            <div class="timeline-body"><blockquote>
<p>I have a vague recollection that installing libxcb-cursor0 from the operating system's package manager helped me with a similar issue once (but it was a while ago so can't remember the details I'm afraid!)</p>
</blockquote>
<p>Thanks for pointing it out. I already tried it out to no avail. Also tried doing <code>export QT_QPA_PLATFORM = offscreen</code> and I get something along the lines of <code>raise() not supported by plugin</code>. Tried with PyQt5, PyQt6, the whole nine yards. Just can't get it to work.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">compatibility</span> added by @charliermarsh on 2024-12-27 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @charliermarsh on 2024-12-27 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @charliermarsh on 2024-12-27 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2024-12-27 14:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tacaswell">@tacaswell</a> on 2024-12-30 22:18</div>
            <div class="timeline-body"><p>I stand by my comment in https://github.com/matplotlib/matplotlib/issues/23074#issuecomment-1134052145 that this is an issue that needs to be handled, if at all, on the python-build-standalone/astral side.</p>
<p>Matplotlib has been using this method of loading the tk binding from 2016 (via https://github.com/matplotlib/matplotlib/pull/6442) in mpl 1.5.  The motivation for doing this and the dlopen was to make the built wheels independent of the version of tk/x11 that was in the multibuild (predecessor to cibuildwheel) and now cibuildwheel container where we build the wheels.  Without doing this, if that version did not exactly match the version that the users' Python was built with we would expect crashes.  A lot of this pain is inherent to wheels (see https://pypackaging-native.github.io for more details) and we don't, to my knowledge, have these issues with any of the other packaging ecosystems (linux packages, brew, conda, ...).</p>
<hr />
<p>With I the matrix of compatibility for python-build-stand-alone after the symbols got hidden:</p>
<ul>
<li>Matplotlib &lt;3.6 will fail hard when doing backend discovery with python-build-standalone if no other GUI toolkits are installed for Matplotlib &gt;3. tk is at the end, so if the user has a qt, wx, or gtk binding installed or is on OSX we will never look at tk.</li>
<li>Matplotlib &gt;3.6 will gracefully detects that we can not get the tk bindings and falls back to Agg.</li>
</ul>
<p>For version of python-build-standalone from before the symbols were hidden for Matplotlib &gt;3.4 I am seeing segfaults locally (I only tested back to 3.5, but what I suspect is the source of the problem is in mpl3.4).  I suspect the issue is that we use <code>dlopen(&quot;libX11.so.6&quot;, RTLD_LAZY)</code> to see if libX11 is available.  We use libX11 as part of detecting if we are running in a graphical environment as part of detecting if the user has already imported an GUI framework or even have an available display.  Setting <code>$DISPLAY</code> to an empty string (which skips the check) avoids the segfault but of course will force mpl back to only non-interactive backends.  This seems consistent with the quirk note about pyqt + x11.  It may be the case that my local X11 too new and/or just built differently and other systems may not see the segfault.  I'm also not sure if on pure wayland systems there is an <code>libX11.so</code> to find.</p>
<p>This is what I have been using for testing:</p>
<details>
```toml
[project]
name = "scratch"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.5,<3.13"
dependencies = [
    "matplotlib",
]

<pre><code>
```shell
uv run --python 3.10.3 python -X faulthandler -c 'import sys;import matplotlib; print(sys.executable); print(matplotlib.__version__); print(matplotlib.get_backend()); import matplotlib.pyplot as plt; plt.plot(range(5)); plt.show()'
</code></pre>
<p>setting whatever Python version.</p>
</details>

<p>I don't have a Windows system setup to test at the moment, but we use a different method of finding the symbols (by inspecting dlls loaded to the current process) so I suspect we side-step this problem, but I'm not sure.</p>
<p>With mpl &gt;3.6 the auto-backend selection no longer raises, but if the user explicitly asks for <code>tkagg</code> it will fail but I think this is OK as there are not any usable tk libraries available. By analogy, if the user asks for tk with a Python build that does not include tk at all, failing is the correct behavior.</p>
<hr />
<p>I think the long term paths out of this are:</p>
<ul>
<li>Just document the issue.  I see the case to hide extra symbols in python-build-standalone.  On the Matplotlib side we can change the note in https://matplotlib.org/stable/install/index.html that says &quot;Python is typically shipped with tk bindings which are used by TkAgg.&quot;, we could change that add &quot;Notably, python-build-standalone -- used by uv -- does not include tk bindings that are usable by Matplotlib.&quot;.  A similar section could be added to the &quot;quirks&quot; page of python-build-standalone explaining under what conditions Matplotlib will/won't work with uv managed environments.</li>
<li>special case to expose the symbols Matplotlib needs in python-build-standalone (or all of the tk ones).  GUIs are always a bit special (due to being more-or-less obligitory process singletons) so if there were any other c-extensions that are exporting conflicting symbols I strongly suspect they would be broken in other ways with python-build-standalone.  However, I'm not sure what else would have to be done to fix the segfault issue.</li>
<li>adapt how Matplotlib finds these symbols.  I do not think it is technically possible to do what we do on windows on unix-like platform, but if it is that might be a solution.  I would be happy to review any PRs to improve this, but this is not a priority for me on Matplotlib as it works with every other packaging ecosystem.</li>
<li>astral publishes a tk wheel to pypi that Matplotlib can depend on to source the needed symbols + PPs the updates to mpl to do so.  However I suspect that would be super brittle as we would be back to the initial problem (different versions of tk floating around in a process) that drove Matplotlib to this dynamic loading and to my understanding there is not enough metadata available to make sure that uv/pip pull a version of tk compatible with what ever Python is (or is not) built with.  Tk is an outlier in terms of the GUI toolkits because it is frequently shipped as part of Python, where as the bindings to all of the other toolkits are free to bring their own underlying libraries.  A much (much) bigger lift would be to get the <code>tkinter</code> module pulled out of the standard library all together and only live on pypi.  I think this is technically possible as debian has already done this split but I have no idea how politically possible it is.  This is again assuming the segfault can be fixed.</li>
</ul>
<p>An (I assume off the table) option is for astral to build custom Matplotlib wheels to work with python-build-standalone (you could revert our runtime logic to instead statically link to the correct tk and x11 libraries at your build time, that code is pretty static so keeping a local patch up-to-date should not be onerous) and then swap them in for users instead of the ones from pypi when using <code>uv</code>.  Doing this would mean the Matplotlib wheels could be kept in exact sync with the build details of python-build-standalone (you could also do PyQt, PySides, and the rest of the GUI toolkits for the same reason), but would open up a whole bunch of other cans of worms ü¶ã .</p>
<hr />
<p>For users that need a fix <em>now</em> rather than when we have solved Python packaging I suggest:</p>
<ul>
<li>if you are committed to working in the wheel packaging ecosystem and python-build-standalone and can use a different gui toolkit: install the dependencies for a different GUI toolkit of your choice.  I <em>think</em> these invocations will work, but<ul>
<li>for Qt6 (pyqt) <code>uv add pyqt6</code> for pyqt (although, per https://github.com/astral-sh/python-build-standalone/blob/main/docs/quirks.rst#static-linking-of-libx11--incompatibility-with-pyqt-on-linux there is a chance this won't actually work),</li>
<li>wx requires adding an extra index from https://extras.wxpython.org/wxPython4/extras/linux/gtk3/ to match your platform but it looks like you can thread that through <code>uv</code>.</li>
<li>I'm not sure if you can get gtk buildings without falling through to system packages and I could not get uv to install pyside6 (I assume user error on my part).</li>
</ul>
</li>
<li>if you not need userspace Python but still need to use wheels for userspace package management, make sure you fall through to your system Python (which is likely dynamically linked to tk and x11 so things will work), see https://docs.astral.sh/uv/guides/install-python/#using-an-existing-python-installation</li>
<li>if you need userspace packaging and Python, but do not need to use wheels (at the risk committing a faux pas in <code>uv</code>'s issues tracker) use <code>pixi</code> (https://prefix.dev) which primarily pulls its built artifacts from conda-forge (so they are all built consistently which avoids all of theses problems) and for anything that is not packaged on conda-forge will also add pypi / local dependencies.  pixi is built around a similar project-based-venv workflow as uv.</li>
<li>if you don't need userspace package management, (again risking a faux pas) consider using your system package manager (yum, apt, brew, pacman, ...) as it will also be built in a consistent way and things will work.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ShaiAvr">@ShaiAvr</a> on 2025-02-18 18:09</div>
            <div class="timeline-body"><p>I just encountered this issue too, and I find this a deal breaker for me. I use matplotlib all the time and I don't want to switch to another backend. Until this is fixed, I'll configure <code>uv</code> to <a href="https://docs.astral.sh/uv/reference/settings/#python-preference">only use system Python installations</a> and use <code>pyenv</code> to manage my Python installations instead of <code>uv</code>.</p>
<p>I read the docs about <a href="https://docs.astral.sh/uv/concepts/python-versions/#cpython-distributions">why <code>uv</code> doesn't build Python from source</a>, and honestly I am not convinced. Most people have the required dependencies to build Python (Especially people who want to move from <code>pyenv</code> to <code>uv</code> like me) and those dependencies can easily be installed on most systems. About the fact that it could be slow to create an optimized build of Python: most people don't install tens or hundreds of different versions of Python and they don't install Python every day. Usually, only a few versions are installed and then virtual environments are created based on them. For example, I only really need Python 3.12 and maybe 3.13, so I don't install Python a lot. That being said, since Python installation doesn't happen very frequently anyway, I think that it's fine that building Python from source will be slower than using <code>python-build-standalone</code>. The only inconvenience it creates is when <code>uv</code> has to download Python dynamically (for example, if I request to run a command with a Python version that's not on my system), and this only happens once, since subsequential calls will use the previously installed Python download.</p>
<p>I personally disable automatic Python downloads, so <code>uv</code> downloads Python only when I tell it to, so I wouldn't care if downloading Python and building it from source will be slightly slower. As mentioned, I don't download new versions of Python frequently and I think most people don't either.</p>
<p>I would prefer if <code>uv</code> acted like <code>pyenv</code> and built Python from source since it would solve this issue and all the other quirks of <code>python-build-standalone</code>. At the very least, I think that we should be able to configure <code>uv</code> to build Python from source instead of using <code>python-build-standalone</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-02-18 18:13</div>
            <div class="timeline-body"><p>I appreciate your perspective but I think we're extremely unlikely to move towards requiring users to build Python from source. It does a huge disservice to users by pushing the complexity onto them. The solution here is to fix the issue in the matplotlib integration :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ShaiAvr">@ShaiAvr</a> on 2025-02-18 18:49</div>
            <div class="timeline-body"><p>@charliermarsh I agree the matplotlib integration issue should be fixed, but I still believe it would be better to build Python from the source. As I said, if we're not ready to completely move to this option, we should at least allow the user to configure whether he wants that or not. We could slowly transition to building from source as the default option and recommend it over <code>python-build-standalone</code>.</p>
<p>Despite that, I still find <code>uv</code> an extremely useful and efficient tool, and I am certainly going to use it for projects, tools, and scripts management. I am still not ready to use it for Python management at this state :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 19:47</div>
            <div class="timeline-body"><blockquote>
<p>I still believe it would be better to build Python from the source. As I said, if we're not ready to completely move to this option, we should at least allow the user to configure whether he wants that or not.</p>
</blockquote>
<p>I'm sorry, but as Charlie said, this is extremely unlikely for us. We make it easy to disable our Python versions and use system interpreters for this reason. There are other tools that focus on building Python from source.</p>
<p>Please let's keep discussion here focused on the interaction between tkagg, matplotlib, and python-build-standalone.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pautric">@pautric</a> on 2025-02-20 09:28</div>
            <div class="timeline-body"><p>I have this code and this issue (it seems that there is a work around but not able to put it place)</p>
<pre><code>from os import environ
from pathlib import Path
from sys import base_prefix

environ[&quot;TCL_LIBRARY&quot;] = str(Path(base_prefix) / &quot;lib&quot; / &quot;tcl8.6&quot;)
environ[&quot;TK_LIBRARY&quot;] = str(Path(base_prefix) / &quot;lib&quot; / &quot;tk8.6&quot;)

print(environ[&quot;TCL_LIBRARY&quot;])
print(environ[&quot;TK_LIBRARY&quot;])

from tkinter import *
from tkinter import ttk
root = Tk()
frm = ttk.Frame(root, padding=10)
frm.grid()
ttk.Label(frm, text=&quot;Hello World!&quot;).grid(column=0, row=0)
ttk.Button(frm, text=&quot;Quit&quot;, command=root.destroy).grid(column=1, row=0)
root.mainloop()
</code></pre>
<p>here is the issue .</p>
<pre><code>UX_tkinter_opalka % /Users/user/Documents/UX_tkinter_opalka/.venv/bin/python &quot;/Users/user/Documen
ts/UX_tkinter_opalka/test Tkinter.py&quot;
/Users/user/.pyenv/versions/3.11.9/lib/tcl8.6
/Users/user/.pyenv/versions/3.11.9/lib/tk8.6
Traceback (most recent call last):
  File &quot;/Users/user/Documents/UX_tkinter_opalka/test Tkinter.py&quot;, line 11, in &lt;module&gt;
    from tkinter import *
  File &quot;/Users/user/.pyenv/versions/3.11.9/lib/python3.11/tkinter/__init__.py&quot;, line 38, in &lt;module&gt;
    import _tkinter # If this fails your Python may not be configured for Tk
    ^^^^^^^^^^^^^^^
ModuleNotFoundError: No module named '_tkinter'
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-20 14:20</div>
            <div class="timeline-body"><p>@pautric looks like you're using <code>pyenv</code>? That's a separate problem from this issue ‚Äî and unrelated to uv as far as I can tell. <code>pyenv</code> builds Python on your machine, perhaps it did so without Tk available.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nippotam">@nippotam</a> on 2025-02-20 15:31</div>
            <div class="timeline-body"><p>I should this https://dev.to/xshapira/using-tkinter-with-pyenv-a-simple-two-step-guide-hh5</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nippotam">@nippotam</a> on 2025-02-20 17:31</div>
            <div class="timeline-body"><blockquote>
<p>I should this https://dev.to/xshapira/using-tkinter-with-pyenv-a-simple-two-step-guide-hh5</p>
</blockquote>
<p>But it does not work ü§®</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nippotam">@nippotam</a> on 2025-02-20 21:18</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I should this https://dev.to/xshapira/using-tkinter-with-pyenv-a-simple-two-step-guide-hh5</p>
</blockquote>
<p>But it does not work ü§®</p>
</blockquote>
<p>At the end I use qt instead and it works perfectly well with pyenv and uv.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/villares">@villares</a> on 2025-03-16 15:46</div>
            <div class="timeline-body"><blockquote>
<p>Please let's keep discussion here focused on the interaction between tkagg, matplotlib, and python-build-standalone.</p>
</blockquote>
<p>Makes sense. I would just like to add a link to https://github.com/astral-sh/uv/issues/11942 &amp; https://github.com/astral-sh/python-build-standalone/issues/146 , to make it clear to other thread readers, that there are a lot of other projects that depend on tkinter that are potentially breaking, and not only tkagg/matplotlib, such as FreeSimpleGUI etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/pautric">@pautric</a> on 2025-03-16 16:19</div>
            <div class="timeline-body"><p>I changed for qt which is modern and works with uv. Then for me question solved.¬†Le 16 mars 2025 √† 16:46, Alexandre B A Villares <em><strong>@</strong></em>.***&gt; a √©crit¬†:Ôªø</p>
<p>Please let's keep discussion here focused on the interaction between tkagg, matplotlib, and python-build-standalone.</p>
<p>Makes sense. I would just like to add a link to #11942 , to make it clear to other thread readers, that there are a lot of other projects that depend on tkinter that are potentially breaking, and not only tkagg/matplotlib, such as FreeSimpleGUI etc.‚ÄîReply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you were mentioned.Message ID: <em><strong>@</strong></em>.***&gt;</p>
<p>villares left a comment (astral-sh/uv#6893)</p>
<p>Please let's keep discussion here focused on the interaction between tkagg, matplotlib, and python-build-standalone.</p>
<p>Makes sense. I would just like to add a link to #11942 , to make it clear to other thread readers, that there are a lot of other projects that depend on tkinter that are potentially breaking, and not only tkagg/matplotlib, such as FreeSimpleGUI etc.</p>
<p>‚ÄîReply to this email directly, view it on GitHub, or unsubscribe.You are receiving this because you were mentioned.Message ID: <em><strong>@</strong></em>.***&gt;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/r-bt">@r-bt</a> on 2025-03-18 02:01</div>
            <div class="timeline-body"><p>This is also an issue for me, I just tried to run</p>
<pre><code class="language-python">from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
</code></pre>
<p>and I'm getting the error:</p>
<pre><code>AttributeError: module '_tkinter' has no attribute '__file__'. Did you mean: '__name__'?

The above exception was the direct cause of the following exception:

ImportError: failed to load tkinter functions

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/Users/richard/Documents/SwarmUROP/crazyflie-firmware/examples/swarmalator_swarm/GUI/towergui.py&quot;, line 9, in &lt;module&gt;
    from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
  File &quot;/Users/richard/Documents/SwarmUROP/crazyflie-firmware/.venv/lib/python3.10/site-packages/matplotlib/backends/backend_tkagg.py&quot;, line 1, in &lt;module&gt;
    from . import _backend_tk
  File &quot;/Users/richard/Documents/SwarmUROP/crazyflie-firmware/.venv/lib/python3.10/site-packages/matplotlib/backends/_backend_tk.py&quot;, line 25, in &lt;module&gt;
    from . import _tkagg
ImportError: initialization failed
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Razlaw">@Razlaw</a> on 2025-05-16 10:02</div>
            <div class="timeline-body"><p>Update to python version 3.13.3 solved the issue for me</p>
<blockquote>
<p>This is also an issue for me, I just tried to run</p>
<p>from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg</p>
<p>and I'm getting the error:</p>
<pre><code>AttributeError: module '_tkinter' has no attribute '__file__'. Did you mean: '__name__'?

The above exception was the direct cause of the following exception:

ImportError: failed to load tkinter functions

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;/Users/richard/Documents/SwarmUROP/crazyflie-firmware/examples/swarmalator_swarm/GUI/towergui.py&quot;, line 9, in &lt;module&gt;
    from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
  File &quot;/Users/richard/Documents/SwarmUROP/crazyflie-firmware/.venv/lib/python3.10/site-packages/matplotlib/backends/backend_tkagg.py&quot;, line 1, in &lt;module&gt;
    from . import _backend_tk
  File &quot;/Users/richard/Documents/SwarmUROP/crazyflie-firmware/.venv/lib/python3.10/site-packages/matplotlib/backends/_backend_tk.py&quot;, line 25, in &lt;module&gt;
    from . import _tkagg
ImportError: initialization failed
</code></pre>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluthej">@bluthej</a> on 2025-05-20 20:25</div>
            <div class="timeline-body"><p>I just tried it again with a managed Python 3.13.3 install and nothing has changed on my side</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nippotam">@nippotam</a> on 2025-05-20 20:45</div>
            <div class="timeline-body"><p>Use qt instead ü§ì</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/t0k4rt">@t0k4rt</a> on 2025-05-21 09:41</div>
            <div class="timeline-body"><p>On osx 14.7.2
Was failing with python 3;10
still failing with python 3.13</p>
<pre><code>python -c &quot;from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg&quot;

AttributeError: module '_tkinter' has no attribute '__file__'. Did you mean: '__name__'?

The above exception was the direct cause of the following exception:

ImportError: failed to load tkinter functions

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
    from matplotlib.backends.backend_tkagg import FigureCanvasTkAgg
  File &quot;/Users/alexandre/Code/python/scoring-mobile-v2/.venv/lib/python3.13/site-packages/matplotlib/backends/backend_tkagg.py&quot;, line 1, in &lt;module&gt;
    from . import _backend_tk
  File &quot;/Users/alexandre/Code/python/scoring-mobile-v2/.venv/lib/python3.13/site-packages/matplotlib/backends/_backend_tk.py&quot;, line 25, in &lt;module&gt;
    from . import _tkagg
ImportError: initialization failed
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ThomasMiconi">@ThomasMiconi</a> on 2025-05-22 20:35</div>
            <div class="timeline-body"><p>Just to state something that may be obvious to advanced users, but not to everyone:</p>
<p>It may work if you force uv to use non-managed, system python.</p>
<p><code>uv run --python /usr/bin/python3.10 ipython</code>  (or wherever your system python is installed)</p>
<p>(You may need to use <code>uv pip install</code> or something to reinstall matplotlib, ipython, etc.)</p>
<p>Then <code>%matplotlib</code> automatically and successfully uses the tkagg package, and <code>plt.plot</code> will display plots in interactive mode.</p>
<p>Unfortunately after you do that the specified python interpreter will be used by default (which is weird). If you want to switch back to previous/managed python you should run the same thing with the path of whichever version you want to use. Type <code>uv python list</code> to see all available python interpreters.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jkseppan">@jkseppan</a> on 2025-06-28 04:54</div>
            <div class="timeline-body"><p>I tried to investigate a possible workaround on the matplotlib side, but I think I'm running into astral-sh/python-build-standalone#533. More at</p>
<p>https://github.com/astral-sh/python-build-standalone/issues/129#issuecomment-3014950387</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @geofft by @geofft on 2025-06-29 03:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geofft">@geofft</a> on 2025-06-29 03:39</div>
            <div class="timeline-body"><p>Thanks! Replied to your comment over there but tl;dr I think we're going to have to move to building libtcl, libtk, and <code>_tkinter</code> as dynamic libraries so that uv's managed Python build acts enough like every other Python build for things to work as expected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/31CFDC30">@31CFDC30</a> on 2025-08-04 08:17</div>
            <div class="timeline-body"><p>After reading the matplotlib documentation at https://matplotlib.org/stable/users/explain/figure/backends.html, I discovered that:</p>
<p>Using uv to manually install the backend and then adding &quot;matplotlib.use(QtAgg, force=True) # or WebAgg, etc.&quot; to your code, or setting the system environment variable MPLBACKEND=QtAgg, you can use it normally.</p>
<p>I tried QtAgg (uv add pyside6) and WebAgg (uv add tornado) on Ubuntu 22.04 desktop, and both worked successfully.</p>
<p>However, I should note that when using QtAgg, I was prompted with a missing dependency, xcb. Following the prompt from chatgpt, I solved the problem by running &quot;apt install libxcb-cursor0&quot;</p>
<p>I'm not sure if this is a good approach, but it's a temporary fix.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cameron-simpson">@cameron-simpson</a> on 2025-08-04 21:40</div>
            <div class="timeline-body"><p>Just a little more data and small commentary. I'm on MacOS 14.7.3 (23H417) with a uv supplied Python 3.13.5.</p>
<p>I can reproduce with as little as this:</p>
<pre><code>&gt;&gt;&gt; import matplotlib.pyplot as plt; plt.subplots()</code></pre>
<p>and my example programme isn't doing anything interactive at all (though yes, it's the <code>_tkagg</code> import triggering this).</p>
<p>I'm off to read the backends doc, and probably to obtain a Python from elsewhere than <code>uv</code>, but at the least <code>_backend_tk.py</code> needs to handle this gracefully, and ideally emit a nice warning and maybe even some reference to this issue or some FAQ summary of this issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @geofft on 2025-08-08 19:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/geofft">@geofft</a> on 2025-08-08 21:09</div>
            <div class="timeline-body"><p>Hi all - I believe this should be resolved in uv 0.8.7, released just now. Please make sure you've updated both uv and your local Python versions:</p>
<pre><code>uv self update
uv python install --reinstall --no-bin 3.13.6
</code></pre>
<p>If you're using another Python version, use <code>3.9.23</code>, <code>3.10.18</code>, <code>3.11.13</code>, <code>3.12.11</code>, and/or <code>3.14.0rc1</code> in that command. (This ensures that you're on the latest patch release <em>and</em> you pick up the new build in case you were on an older build of that same patch release.)</p>
<p>Please try it out and let me know if there are remaining issues.</p>
<p>(By the way, if anyone sees <em>new</em> bugs from this, please first open a new issue and at-mention me, and then use <code>uvx uv@0.8.6 python install --reinstall --no-bin 3.13.6</code> etc. to roll back to yesterday's builds of Python. I don't expect this to break anything, but it is a pretty significant change in what's in the Python distributions and how things are linked, so it might have some unexpected side effects.)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:26:44 UTC
    </footer>
</body>
</html>
