<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>running `uv pip install .` should systematically reinstall the package - astral-sh/uv #12038</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>running `uv pip install .` should systematically reinstall the package</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12038">#12038</a>
        opened by <a href="https://github.com/12rambau">@12rambau</a>
        on 2025-03-07 10:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/12rambau">@12rambau</a> on 2025-03-07 10:52</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>When dealin with local packages, uv is also caching the installation parameter making it very dificult when I work on package to run my tox or nox session with a uv backend as everytime I make a modification my local package in the venv are not updated. I fail to see a configuration where people would install a local package without wanting to update it as usually when the package is locally installed it means that you are currently working on it.</p>
<p>I quote @henryiii from https://github.com/astral-sh/uv/issues/2844:</p>
<blockquote>
<p>Running -e. (or even .) again is a common way to rebuild binary packages, and it's a lot less convenient if it doesn't actually do anything. I don't think local packages should be cached. Local packages tend to have changes without releasing versions (since you are developing on the package).</p>
</blockquote>
<p>Is there any rational to go against this statement that I'm missing ? It makes maintenance of development environment tedious and I know the more option I add (metadata in my pyproject included like in https://github.com/astral-sh/uv/issues/7282 will eventually be forgotten by maintainers and create build issues when things (were/should) be simple.</p>
<p>Note that <code>-e</code> is not an option in the following example as I want to test it as close as when user will install it from pypi. I already had some issues in ipywidget related packages that are not reproducible with <code>-e</code> installation and it took me forever to find them.</p>
<h3>Example</h3>
<p>I'm using nox to build my environment for test suits as such using a &quot;uv&quot; backend:</p>
<pre><code class="language-python">@nox.session(reuse_venv=True, venv_backend=&quot;uv&quot;)
def test(session):
    &quot;&quot;&quot;Run the selected tests and report coverage in html.&quot;&quot;&quot;
    session.install(&quot;.[test]&quot;) # this is equivalent to uv pip install .[test] in a nox siloted context
    test_files = session.posargs or [&quot;tests&quot;]
    session.run(&quot;pytest&quot;, &quot;--cov&quot;, &quot;--cov-report=html&quot;, *test_files)
</code></pre>
<p>and run it via:</p>
<pre><code>nox -s test
</code></pre>
<p>The problem is also mentioned directly in the nox documentation:</p>
<blockquote>
<p>The uv backend does not reinstall, even for local packages, so you need to include --reinstall-package <pkg-name> (uv-only) if reusing the environment.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @12rambau on 2025-03-07 10:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/henryiii">@henryiii</a> on 2025-03-07 15:28</div>
            <div class="timeline-body"><p>I can speak for the reasoning: while making <code>uv pip install .</code> a no-op is likely not what anyone wants, <code>uv run</code> shouldn't re-install the package every time. I think these two should be treated differently (<code>uv run</code> is triggering an install as a by-product, while <code>uv pip install .</code> is a user request to do an install, and nothing else), that's why it is this way. It's not ideal, but you can specify <code>tool.uv.pip.reinstall-package = [&quot;name-of-local-package&quot;] (I wonder if </code>&quot;.&quot;` is valid here?) to help for a specific project.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-07 15:50</div>
            <div class="timeline-body"><p>I think using different behaviors for <code>uv pip install .</code> vs. <code>uv run</code> is fairly reasonable, if we view the former as an &quot;explicit&quot; request vs. an &quot;implicit&quot; request for <code>uv run</code>. What do you think, @zanieb?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-decision</span> added by @charliermarsh on 2025-03-07 15:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-07 16:33</div>
            <div class="timeline-body"><p>Yeah that's fine with me. My concern is that this would then differ from our behavior for other packages? Are we specializing source trees?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-07 17:32</div>
            <div class="timeline-body"><p>@zanieb -- Yeah, I think we would say that any source tree passed on the CLI would be run with <code>--reinstall</code> or equivalent.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-07 17:35</div>
            <div class="timeline-body"><p>That makes sense, I think I've wanted this before.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2025-03-07 20:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/12176.html">astral-sh/uv#12176</a> on 2025-03-14 20:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-03-17 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-03-17 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13388.html">astral-sh/uv#13388</a> on 2025-05-11 19:27</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../issues/13876.html">astral-sh/uv#13876</a> on 2025-06-06 00:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:02 UTC
    </footer>
</body>
</html>
