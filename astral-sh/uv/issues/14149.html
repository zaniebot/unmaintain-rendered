<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv behavior does not match pip - astral-sh/uv #14149</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv behavior does not match pip</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/14149">#14149</a>
        opened by <a href="https://github.com/DataSailor">@DataSailor</a>
        on 2025-06-20 10:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/DataSailor">@DataSailor</a> on 2025-06-20 10:50</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I tried using uv to install <a href="https://github.com/OPHoperHPO/image-background-remove-tool">CarveKit</a>, following their instructions to
<code>pip install carvekit --extra-index-url https://download.pytorch.org/whl/cu121</code>
Therefore, I tried to rewrite it as
<code>uv add carvekit --index https://download.pytorch.org/whl/cu121</code>
But uv thinks there is a conflict in the package version. The error message is</p>
<pre><code>× No solution found when resolving dependencies for split (python_full_version &gt;= '3.12' and sys_platform == 'darwin'):
  ╰─▶ Because only the following versions of numpy are available:
          numpy&lt;1.22.4
          numpy&gt;1.23.dev0
      and carvekit&lt;=4.1.0 depends on numpy&gt;=1.22.4,&lt;1.23.dev0, we can conclude that carvekit&lt;=4.1.0 cannot be used.
      And because only the following versions of carvekit are available:
          carvekit==4.0.1
          carvekit==4.0.2
          carvekit==4.0.3
          carvekit==4.0.4
          carvekit==4.0.5
          carvekit==4.0.6
          carvekit==4.0.7
          carvekit==4.0.8
          carvekit==4.1.0
          carvekit==4.1.1
          carvekit==4.1.2
      we can conclude that carvekit&lt;4.1.1 cannot be used. (1)

      Because only requests==2.28.1 is available and carvekit==4.1.1 depends on requests&gt;=2.31.0,&lt;2.32.dev0, we can conclude that carvekit==4.1.1 cannot be used.
      And because we know from (1) that carvekit&lt;4.1.1 cannot be used, we can conclude that carvekit&lt;4.1.2 cannot be used. (2)

      Because only requests==2.28.1 is available and carvekit==4.1.2 depends on requests&gt;=2.31.0, we can conclude that carvekit==4.1.2 cannot be used.
      And because we know from (2) that carvekit&lt;4.1.2 cannot be used, we can conclude that all versions of carvekit cannot be used.
      And because your project depends on carvekit, we can conclude that your project's requirements are unsatisfiable.

      hint: `numpy` was requested with a pre-release marker (e.g., numpy&gt;=1.22.4,&lt;1.23.dev0), but pre-releases weren't enabled (try: `--prerelease=allow`)

      hint: `numpy` was found on https://download.pytorch.org/whl/cu121, but not at the requested version (numpy&gt;=1.22.4,&lt;1.23.dev0). A compatible version may be
      available on a subsequent index (e.g., https://mirrors.bfsu.edu.cn/pypi/web/simple). By default, uv will only consider versions that are published on the first
      index that contains a given package, to avoid dependency confusion attacks. If all indexes are equally trusted, use `--index-strategy unsafe-best-match` to
      consider all versions from all indexes, regardless of the order in which they were defined.

      hint: `requests` was found on https://download.pytorch.org/whl/cu121, but not at the requested version (requests&gt;=2.31.0). A compatible version may be available
      on a subsequent index (e.g., https://mirrors.bfsu.edu.cn/pypi/web/simple). By default, uv will only consider versions that are published on the first index that
      contains a given package, to avoid dependency confusion attacks. If all indexes are equally trusted, use `--index-strategy unsafe-best-match` to consider all
      versions from all indexes, regardless of the order in which they were defined.

      hint: While the active Python version is 3.11, the resolution failed for other Python versions supported by your project. Consider limiting your project's
      supported Python versions using `requires-python`.
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
</code></pre>
<p>I switched to installing via pip and finally found a suitable version.
<code>pip install torch==2.2.2 torchvision==0.17.2 torchaudio==2.2.2 carvekit --extra-index-url https://download.pytorch.org/whl/cu121</code>
I run the same command through uv.
<code>uv add torch==2.2.2 torchvision==0.17.2 torchaudio==2.2.2 carvekit --index https://download.pytorch.org/whl/cu121</code>
But still getting an error:</p>
<pre><code>× No solution found when resolving dependencies for split (python_full_version &gt;= '3.12' and sys_platform == 'darwin'):
  ╰─▶ Because only the following versions of carvekit are available:
          carvekit==4.0.1
          carvekit==4.0.2
          carvekit==4.0.3
          carvekit==4.0.4
          carvekit==4.0.5
          carvekit==4.0.6
          carvekit==4.0.7
          carvekit==4.0.8
          carvekit==4.1.0
          carvekit==4.1.1
          carvekit==4.1.2
      and carvekit&lt;=4.1.0 depends on torchvision&gt;=0.12.0,&lt;0.13.dev0, we can conclude that carvekit&lt;4.1.1 depends on torchvision&gt;=0.12.0,&lt;0.13.dev0.
      And because carvekit==4.1.1 depends on torchvision&gt;=0.16.2,&lt;0.17.dev0, we can conclude that carvekit&lt;4.1.2 depends on one of:
          torchvision&gt;=0.12.0,&lt;0.13.dev0
          torchvision&gt;=0.16.2,&lt;0.17.dev0
       (1)

      Because only requests==2.28.1 is available and carvekit==4.1.2 depends on requests&gt;=2.31.0, we can conclude that carvekit==4.1.2 cannot be used.
      And because we know from (1) that carvekit&lt;4.1.2 depends on one of:
          torchvision&gt;=0.12.0,&lt;0.13.dev0
          torchvision&gt;=0.16.2,&lt;0.17.dev0
      we can conclude that all versions of carvekit depend on one of:
          torchvision&gt;=0.12.0,&lt;0.13.dev0
          torchvision&gt;=0.16.2,&lt;0.17.dev0

      And because your project depends on carvekit and torchvision==0.17.2, we can conclude that your project's requirements are unsatisfiable.

      hint: `requests` was found on https://download.pytorch.org/whl/cu121, but not at the requested version (requests&gt;=2.31.0). A compatible version may be available
      on a subsequent index (e.g., https://mirrors.bfsu.edu.cn/pypi/web/simple). By default, uv will only consider versions that are published on the first index that
      contains a given package, to avoid dependency confusion attacks. If all indexes are equally trusted, use `--index-strategy unsafe-best-match` to consider all
      versions from all indexes, regardless of the order in which they were defined.

      hint: While the active Python version is 3.11, the resolution failed for other Python versions supported by your project. Consider limiting your project's
      supported Python versions using `requires-python`.
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
</code></pre>
<p>I'm not sure if this is due to my incorrect usage or an issue with the version parsing of uv or pip.</p>
<h3>Platform</h3>
<p>Ubuntu 24.04</p>
<h3>Version</h3>
<p>uv 0.7.13</p>
<h3>Python version</h3>
<p>Python 3.11.12</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @DataSailor on 2025-06-20 10:50</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-06-20 13:21</div>
            <div class="timeline-body"><p>Can you try running with <code>--index-strategy unsafe-best-match</code>? There's extensive documentation on this general behavior, e.g., https://docs.astral.sh/uv/pip/compatibility/#packages-that-exist-on-multiple-indexes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-06-20 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-06-20 13:23</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[Bud] uv behavior does not match pip" to "uv behavior does not match pip" by @konstin on 2025-06-20 13:25</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-07-04 02:09</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:04 UTC
    </footer>
</body>
</html>
