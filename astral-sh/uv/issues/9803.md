```yaml
number: 9803
title: override-dependencies with different environment markers leads to error
type: issue
state: closed
author: mcschempp
labels:
  - bug
assignees: []
created_at: 2024-12-11T10:05:36Z
updated_at: 2024-12-14T02:12:45Z
url: https://github.com/astral-sh/uv/issues/9803
synced_at: 2026-01-10T01:57:22Z
```

# override-dependencies with different environment markers leads to error

---

_Issue opened by @mcschempp on 2024-12-11 10:05_

Environment Info:
```
uv: 0.5.7
os: Ubuntu 22.04.5 LTS
```

Using the following paragraph in `pyproject.toml` ...

```toml
[tool.uv]
override-dependencies = [
    "some-lib @ file:///${PROJECT_ROOT}/libs/some-lib-1.4.1-cp311.cp312-none-linux_x86_64.whl; platform_machine == 'x86_64'",
    "some-lib @ file:///${PROJECT_ROOT}/libs/some-lib-1.4.1-cp311.cp312-none-linux_aarch64.whl; platform_machine == 'aarch64'",
]
```

... leads to the following error:
`uv sync`
```
error: Overrides contain conflicting URLs for package `some-lib`:
- file:///${PROJECT_ROOT}/libs/some-lib-1.4.1-cp311.cp312-none-linux_x86_64.whl
- file:///${PROJECT_ROOT}/libs/some-lib-1.4.1-cp311.cp312-none-linux_aarch64.whl
```

Not sure if I'm doing something wrong here, but imho this should work since the URLs are for different platforms.


EDIT:

I got it to work with

```toml
[tool.uv.sources]
some-lib = [
    { path = "libs/some-lib-1.4.1-cp311.cp312-none-linux_x86_64.whl", marker = "platform_machine == 'x86_64'" },
    { path = "libs/some-lib-1.4.1-cp311.cp312-none-linux_aarch64.whl", marker = "platform_machine == 'aarch64'" },
    { path = "", marker = "platform_machine != 'x86_64' and platform_machine != 'aarch64'" }
```

So this ticket can (probably) be closed

---

_Label `bug` added by @charliermarsh on 2024-12-11 13:45_

---

_Comment by @charliermarsh on 2024-12-11 13:45_

Thanks. I think what you have above should probably still work so I'll leave this open.

---

_Assigned to @charliermarsh by @charliermarsh on 2024-12-14 01:55_

---

_Referenced in [astral-sh/uv#9893](../../astral-sh/uv/pulls/9893.md) on 2024-12-14 02:00_

---

_Closed by @charliermarsh on 2024-12-14 02:12_

---

_Closed by @charliermarsh on 2024-12-14 02:12_

---
