<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv pip install gdal` fails to build, with workaround (Windows) - astral-sh/uv #11466</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv pip install gdal</code> fails to build, with workaround (Windows)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/11466">#11466</a>
        opened by <a href="https://github.com/maphew">@maphew</a>
        on 2025-02-12 23:44
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/maphew">@maphew</a> on 2025-02-12 23:44</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>I'm not sure this is actually a uv problem, but I didn't find it documented in one place anywhere so I'm doing that here. Close if there isn't anything uv should do about this scenario; the workaround will still be here for future searchers to build on.</p>
<p>Problem:</p>
<pre><code>D:\test&gt; uv venv --python 3.11
D:\test&gt; uv pip install gdal

Resolved 1 package in 230ms
  x Failed to build `gdal==3.10.1`
  |-&gt; The build backend returned an error
  `-&gt; Call to `setuptools.build_meta.build_wheel` failed (exit code: 1)

      [stdout]
      Using numpy 2.2.2
      running bdist_wheel
      running build
      running build_py
      creating build\lib.win-amd64-cpython-311\osgeo
      copying osgeo\gdal.py -&gt; build\lib.win-amd64-cpython-311\osgeo
[...]
      building 'osgeo._gnm' extension
      building 'osgeo._osr' extension

      [stderr]
      C:\Users\mhwilkie\AppData\Local\uv\cache\builds-v0\.tmpuXEvrM\Lib\site-packages\setuptools\config\_apply_pyprojecttoml.py:81: SetuptoolsWarning:
      `extras_require` overwritten in `pyproject.toml` (optional-dependencies)
        corresp(dist, value, root_dir)
      error: Microsoft Visual C++ 14.0 or greater is required. Get it with &quot;Microsoft C++ Build Tools&quot;:
      https://visualstudio.microsoft.com/visual-cpp-build-tools/

      hint: This usually indicates a problem with the package or the build environment.
</code></pre>
<p><strong>Workaround solution</strong> - install a binary prebuilt wheel instead of pypi package:</p>
<ol>
<li>Open <strong>geospatial-wheels</strong> binary release page https://github.com/cgohlke/geospatial-wheels/releases/latest and copy url for:</li>
<li>Find the binary matching your python version, <code>cp311</code> is python 3.11, <code>cp313</code> is py 3.13, etc.</li>
<li>...and matching hardware, <code>win32</code>, <code>arm64</code>, <code>amd64</code></li>
<li>feed the matching url to uv pip install</li>
</ol>
<pre><code>uv run python -m pip install https://github.com/cgohlke/geospatial-wheels/releases/download/v2025.1.20/GDAL-3.10.1-cp311-cp311-win_amd64.whl

Collecting GDAL==3.10.1
  Downloading https://github.com/cgohlke/geospatial-wheels/releases/download/v2025.1.20/GDAL-3.10.1-cp311-cp311-win_amd64.whl (43.9 MB)
     ---------------------------------------- 43.9/43.9 MB 17.2 MB/s eta 0:00:00
Installing collected packages: GDAL
Successfully installed GDAL-3.10.1
</code></pre>
<p>What could/should uv do for this scenario?</p>
<ul>
<li>don't attempt to build on Windows where there isn't a tool chain (?)</li>
<li>and/or offer an info message about what to do (but maybe the setuptools message with <em>Get it with &quot;Microsoft C++ Build Tools&quot;</em> serves that well enough)</li>
<li>cache pip installs so that downloads aren't repeated</li>
</ul>
<p>Sources:</p>
<ul>
<li>https://www.reddit.com/r/gis/comments/1hojo4t/whats_the_point_of_pip_install_gdal_eli5/</li>
<li>https://github.com/astral-sh/uv/issues/1703</li>
</ul>
<h3>Platform</h3>
<p>MSYS_NT-10.0-19045 3.4.10-2e2ef940.x86_64 x86_64 Msy</p>
<h3>Version</h3>
<p>uv 0.5.30 (ddbc6e315 2025-02-10)</p>
<h3>Python version</h3>
<p>Python 3.11.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @maphew on 2025-02-12 23:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-13 01:53</div>
            <div class="timeline-body"><p>Can you share verbose logs? e.g., <code>uv pip install -v ...</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-13 02:02</div>
            <div class="timeline-body"><p>Oh I see, they don't publish wheels to PyPi there are just prebuilt ones elsewhere?</p>
<p>You can add a platform specific source URL source if you want this to work with <code>uv sync</code>:</p>
<ul>
<li>https://docs.astral.sh/uv/concepts/projects/dependencies/#url</li>
<li>https://docs.astral.sh/uv/concepts/projects/dependencies/#platform-specific-sources</li>
</ul>
<p>I think what you're doing for <code>uv pip install</code> is sort of &quot;the solution&quot; unless you want to install the prerequisites necessary to build from source. I don't think our error message there could really be any clearer.</p>
<p>Ideally the project would publish wheels to PyPi, or that other project would publish the wheels under a different name or static package index.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @zanieb on 2025-02-13 02:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @zanieb on 2025-02-13 02:03</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @zanieb on 2025-02-13 02:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maphew">@maphew</a> on 2025-02-13 17:56</div>
            <div class="timeline-body"><p>Thanks for the feedback! Can the dependency by url be used in a pep723 style script header? I love the <code>uv run</code> workflow, not having to build a .toml, resulting in single file tool scripts.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JacobJeppesen">@JacobJeppesen</a> on 2025-02-16 11:41</div>
            <div class="timeline-body"><p>Edit: Realized <code>https://girder.github.io/large_image_wheels</code> only hosts wheels for Linux, so it doesn't work on Windows.</p>
<hr />
<p>Generally, I think it's easier to install <code>gdal</code> from <code>https://girder.github.io/large_image_wheels</code>. I got it working with <code>uv add --find-links https://girder.github.io/large_image_wheels gdal</code>. However, it doesn't add the <code>--find-links https://girder.github.io/large_image_wheels</code> part to <code>pyproject.toml</code>, so it also has to be manually added when running <code>uv sync</code> (i.e., <code>uv sync --find-links https://girder.github.io/large_image_wheels</code>).</p>
<p>Would be great if there was a way to add the <code>find-links</code> part to script headers or <code>pyproject.toml</code>. I tried following the <a href="https://docs.astral.sh/uv/guides/integration/pytorch/">guide for using uv with PyTorch</a>, but that required me to hardcode the specific <code>.whl</code> url. I used to use <code>pip-tools</code>, where <code>find-links</code> could be added to <code>requirements.in</code> like this:</p>
<pre><code>--find-links=https://girder.github.io/large_image_wheels
GDAL
</code></pre>
<p>Would be great to see something similar with <code>uv</code>. Could of course also be that it's already added, and it's just me who didn't manage to get it to work üôÇ</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-16 18:37</div>
            <div class="timeline-body"><blockquote>
<p>Can the dependency by url be used in a pep723 style script header? I love the uv run workflow, not having to build a .toml, resulting in single file tool scripts.</p>
</blockquote>
<p>Yes we'll read <code>[tool.uv]</code> sections from those scripts too.</p>
<blockquote>
<p>Would be great if there was a way to add the find-links part to script headers or pyproject.toml</p>
</blockquote>
<p>https://docs.astral.sh/uv/reference/settings/#find-links</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsmariegaard">@jsmariegaard</a> on 2025-02-17 07:29</div>
            <div class="timeline-body"><p>We would like to move all our Python users to uv instead of conda-forge. The only thing missing on Windows is GDAL which is a requirement for a lot of our users. Would be great to find a solution!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsmariegaard">@jsmariegaard</a> on 2025-02-17 12:21</div>
            <div class="timeline-body"><blockquote>
<p>We would like to move all our Python users to uv instead of conda-forge. The only thing missing on Windows is GDAL which is a requirement for a lot of our users. Would be great to find a solution!</p>
</blockquote>
<p>GDAL binary wheels can be found on https://github.com/cgohlke/geospatial-wheels and you can use this low-level solution</p>
<pre><code>$ uv pip install https://github.com/cgohlke/geospatial-wheels/releases/download/v2025.1.20/GDAL-3.10.1-cp313-cp313-win_amd64.whl</code></pre>
<p>But how do you get a better uv-native solution using uv add/sync etc?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-17 14:51</div>
            <div class="timeline-body"><p>As mentioned above, it sounds like</p>
<pre><code>[tool.uv]
find-links = &quot;https://girder.github.io/large_image_wheels&quot;
</code></pre>
<p>should work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/JacobJeppesen">@JacobJeppesen</a> on 2025-02-17 15:13</div>
            <div class="timeline-body"><p>Sorry, that was my fault. They only host wheels for Linux on <code>https://girder.github.io/large_image_wheels</code>. I thought they hosted for more platforms. It does work really well on Linux when adding <code>find-links</code> to <code>pyproject.toml</code> though üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-17 15:18</div>
            <div class="timeline-body"><p>I see. I'm sorry to say this is a problem with the package ‚Äî there's not much we can do here.</p>
<p>See https://github.com/astral-sh/uv/issues/11466#issuecomment-2655264552 for adding the link to the wheel to your <code>pyproject.toml</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsmariegaard">@jsmariegaard</a> on 2025-02-17 15:34</div>
            <div class="timeline-body"><p>I wonder if <a href="https://github.com/cgohlke">@cgohike  </a> could create a flat list of links to package files as requires by https://docs.astral.sh/uv/reference/settings/#find-links ü§î Then I guess we would be good to go. @zanieb, the regular release assets in https://github.com/cgohlke/geospatial-wheels/releases cannot be used in find-links, right? (I could not get it to work)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maphew">@maphew</a> on 2025-02-17 19:50</div>
            <div class="timeline-body"><p>The 2nd script below will build the flat list of links from a Github assets list, <code>uv run list_github_assets.py &gt; asset-links.txt</code>, but I haven't figured out how to feed that to <code>uv run</code>.</p>
<p>re: https://github.com/astral-sh/uv/issues/11466#issuecomment-2661562869, what is the syntax using <code>[uv.tool]</code> in the script header? This is closest I've gotten is below, but it emits <em>&quot;expected struct ToolUv&quot;</em>. I get zero internet search results on that phrase and don't know what to do with it.</p>
<p><strong>test-gdal.py</strong>:</p>
<pre><code># /// script
# requires-python = &quot;&gt;=3.8&quot;
# dependencies = [
#   &quot;gdal&quot;,
# ]
# tool.uv = [
#    &quot;find-links = file://asset-links.txt&quot;
#    ]
# ///
print('hi!')
</code></pre>
<p>yields:</p>
<pre><code> uv run test-gdal.py
error: TOML parse error at line 5, column 11
  |
5 | tool.uv = &quot;find-links = file://asset-links.txt&quot;
  |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
invalid type: string &quot;find-links = file://asset-links.txt&quot;, expected struct ToolUv
</code></pre>
<p><strong>list_github_assets.py</strong>:</p>
<pre><code class="language-python"># /// script
# requires-python = &quot;&gt;=3.8&quot;
# dependencies = [
#     &quot;httpx&quot;,
# ]
# ///
import sys
import httpx

def fetch_assets(repo: str):
    &quot;&quot;&quot;Fetch asset URLs from the latest GitHub release.&quot;&quot;&quot;
    url = f&quot;https://api.github.com/repos/{repo}/releases/latest&quot;

    response = httpx.get(url, timeout=10)
    response.raise_for_status()
    assets = response.json().get(&quot;assets&quot;, [])

    for asset in assets:
        print(asset[&quot;browser_download_url&quot;])

if __name__ == &quot;__main__&quot;:
    if len(sys.argv) &lt; 2:
        print(&quot;Usage:  uv run list_github_assets.py &lt;PROJECT/REPO&gt;\n\t&quot;, file=sys.stderr)
        print(&quot;uv run list_github_assets.py cgohlke/geospatial-wheels&quot;, file=sys.stderr)
        sys.exit(1)

    fetch_assets(sys.argv[1])
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Huyston">@Huyston</a> on 2025-02-20 18:21</div>
            <div class="timeline-body"><blockquote>
<p>[tool.uv]
find-links = &quot;https://girder.github.io/large_image_wheels&quot;</p>
</blockquote>
<p>Actually, it should be a list</p>
<p>#pyproject.toml
[tool.uv]
find-links = [&quot;https://girder.github.io/large_image_wheels&quot;]</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/maphew">@maphew</a> on 2025-02-24 19:38</div>
            <div class="timeline-body"><p>@Huyston that's not working for me. Can you show a full example? Here's my latest attempt: https://gist.github.com/maphew/0cb4b65777732451895b490e61d7e236</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trungleduc">@trungleduc</a> on 2025-02-26 07:48</div>
            <div class="timeline-body"><blockquote>
<p>We would like to move all our Python users to uv instead of conda-forge.</p>
</blockquote>
<p>@jsmariegaard i'm curious, you are moving away of conda-forge because of conda slowness?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsmariegaard">@jsmariegaard</a> on 2025-02-26 07:59</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>We would like to move all our Python users to uv instead of conda-forge.</p>
</blockquote>
<p><a href="https://github.com/jsmariegaard">@jsmariegaard</a> i'm curious, you are moving away of conda-forge because of conda slowness?</p>
</blockquote>
<p>yes, and uv-niceness! uv offers a lot more in terms of package and project management and reproducibility</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trungleduc">@trungleduc</a> on 2025-02-26 08:05</div>
            <div class="timeline-body"><p>sorry for being off-topic, but did you take a look at <a href="https://pixi.sh/latest/">pixi</a>, it's basically the <code>uv</code> version of <code>conda</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jsmariegaard">@jsmariegaard</a> on 2025-02-26 08:11</div>
            <div class="timeline-body"><blockquote>
<p>sorry for being off-topic, but did you take a look at <a href="https://pixi.sh/latest/">pixi</a>, it's basically the <code>uv</code> version of <code>conda</code></p>
</blockquote>
<p>Yes, it is definitely and interesting project and some of my colleagues tested it out. uv just works, the experiences with pixi were a bit more mixed. Our recommendation in our company (300ish Python users) is to use uv as the primary solution, if that does not work for you and you need some conda packages, then use Miniforge3. In the future we may change that to pixi.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nathanjmcdougall">@nathanjmcdougall</a> on 2025-02-28 00:42</div>
            <div class="timeline-body"><p>I've created a proof-of-concept PEP503 index that just points to the released wheels at <a href="https://github.com/cgohlke/geospatial-wheels">https://github.com/cgohlke/geospatial-wheels</a>, and can be used together with the Linux wheels at <a href="https://gitlab.com/mentaljam/gdal-wheels">https://gitlab.com/mentaljam/gdal-wheels</a>.</p>
<p>You can find it here:
<a href="https://github.com/nathanjmcdougall/geospatial-wheels-index">https://github.com/nathanjmcdougall/geospatial-wheels-index</a>.</p>
<p>You can use it with this <code>pyproject.toml</code> config:</p>
<pre><code class="language-TOML">[tool.uv.sources]
gdal = [
  { index = &quot;gdal-wheels&quot;, marker = &quot;sys_platform == 'linux'&quot; },
  { index = &quot;geospatial_wheels&quot;, marker = &quot;sys_platform == 'win32'&quot; },
]

[[tool.uv.index]]
name = &quot;geospatial_wheels&quot;
url = &quot;https://nathanjmcdougall.github.io/geospatial-wheels-index/&quot;
explicit = true

[[tool.uv.index]]
name = &quot;gdal-wheels&quot;
url = &quot;https://gitlab.com/api/v4/projects/61637378/packages/pypi/simple&quot;
explicit = true
</code></pre>
<p>And then run <code>uv add gdal</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hectorpatino">@hectorpatino</a> on 2025-03-14 15:35</div>
            <div class="timeline-body"><p>This worked for me with python 3.10.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/giswqs">@giswqs</a> on 2025-07-13 22:46</div>
            <div class="timeline-body"><p>I tested it on Linux. It seems no longer working.</p>
<pre><code class="language-bash">uv venv
uv init
# Update the project.toml config
uv add gdal
</code></pre>
<blockquote>
<p>Resolved 5 packages in 2.96s
√ó Failed to build <code>gdal==3.11.1</code>
‚îú‚îÄ‚ñ∂ The build backend returned an error
‚ï∞‚îÄ‚ñ∂ Call to <code>setuptools.build_meta.build_wheel</code> failed (exit status: 1)</p>
</blockquote>
<pre><code>  [stdout]
  Using numpy 2.3.1
  running egg_info
  writing gdal-utils/GDAL.egg-info/PKG-INFO
  writing dependency_links to gdal-utils/GDAL.egg-info/dependency_links.txt
  writing entry points to gdal-utils/GDAL.egg-info/entry_points.txt
  writing requirements to gdal-utils/GDAL.egg-info/requires.txt
  writing top-level names to gdal-utils/GDAL.egg-info/top_level.txt
  gdal_config_error: Traceback (most recent call last):
    File &quot;&lt;string&gt;&quot;, line 92, in fetch_config
    File &quot;/usr/lib/python3.13/subprocess.py&quot;, line 1039, in __init__
      self._execute_child(args, executable, preexec_fn, close_fds,
      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                          pass_fds, cwd, env,
                          ^^^^^^^^^^^^^^^^^^^
      ...&lt;5 lines&gt;...
                          gid, gids, uid, umask,
                          ^^^^^^^^^^^^^^^^^^^^^^
                          start_new_session, process_group)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    File &quot;/usr/lib/python3.13/subprocess.py&quot;, line 1969, in _execute_child
      raise child_exception_type(errno_num, err_msg, err_filename)
  FileNotFoundError: [Errno 2] No such file or directory: 'gdal-config'

  During handling of the above exception, another exception occurred:

  Traceback (most recent call last):
    File &quot;&lt;string&gt;&quot;, line 244, in get_gdal_config
    File &quot;&lt;string&gt;&quot;, line 95, in fetch_config
  gdal_config_error: [Errno 2] No such file or directory: 'gdal-config'

  Could not find gdal-config. Make sure you have installed the GDAL native library and development headers.

  hint: This usually indicates a problem with the package or the build environment.</code></pre>
<p>help: If you want to add the package regardless of the failed resolution, provide the <code>--frozen</code> flag to skip locking</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nathanjmcdougall">@nathanjmcdougall</a> on 2025-07-13 23:12</div>
            <div class="timeline-body"><p>@giswqs the Linux wheels are maintained in this project: https://gitlab.com/mentaljam/gdal-wheels
I think you should open an issue there. I agree they seem to be broken for v3.11.1.</p>
<p>I would recommend using <code>uv add gdal!=3.11.1</code> until the issue is resolved.</p>
<p>I also note, that project is now building both Linux and Windows wheels, so potentially you could use it exclusively if you wished to do so (I haven't tested this thoroughly)</p>
<pre><code class="language-TOML">[tool.uv.sources]
gdal = [
  { index = &quot;gdal-wheels&quot; }
]

[[tool.uv.index]]
name = &quot;gdal-wheels&quot;
url = &quot;https://gitlab.com/api/v4/projects/61637378/packages/pypi/simple&quot;
explicit = true
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 12:30:55 UTC
    </footer>
</body>
</html>
