<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UV doesn't consider compatible version - astral-sh/uv #15547</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>UV doesn't consider compatible version</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/15547">#15547</a>
        opened by <a href="https://github.com/zivhadad24">@zivhadad24</a>
        on 2025-08-27 12:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zivhadad24">@zivhadad24</a> on 2025-08-27 12:03</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Have a project that configures a few private registries as sources and uses Python 3.10 as required for the venv
If one of the private sources will have a package that declared as dependency but not on the required Python version, UV will consider this source as the first match and not continue to search for the real package that compatible with the python version you aim to install</p>
<p>Once UV finish the resolution it raise and error and failed to build the venv</p>
<p>Example
uv run --index-strategy first-index
× No solution found when resolving dependencies:
╰─▶ Because crcmod==1.7 has no wheels with a matching Python version tag (e.g., <code>cp310</code>)
and your project depends on crcmod==1.7, we can conclude that your project's
requirements are unsatisfiable.</p>
<pre><code>  hint: `crcmod` was found on
  https://gitlab.com/api/v4/projects/*********/packages/pypi/simple,
  but not at the requested version (crcmod==1.7). A compatible
  version may be available on a subsequent index (e.g.,
  https://test.jfrog.io/artifactory/api/pypi/test-pypi/simple). By
  default, uv will only consider versions that are published on the first index that
  contains a given package, to avoid dependency confusion attacks. If all indexes are
  equally trusted, use `--index-strategy unsafe-best-match` to consider all versions from
  all indexes, regardless of the order in which they were defined.

  hint: Wheels are available for `crcmod` (v1.7) with the following Python ABI tags:
  `cp39`, `pypy39_pp73`</code></pre>
<p>Even when using --index-strategy unsafe-best-match it return the same error means that UV don't care about the python versions that compatible with the package it found and offer this package as the best one to use</p>
<h3>Platform</h3>
<p>macOS, ubuntu22.2</p>
<h3>Version</h3>
<p>uv 0.8.13</p>
<h3>Python version</h3>
<p>python 3.10.18</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zivhadad24 on 2025-08-27 12:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-27 15:55</div>
            <div class="timeline-body"><p>I think this is probably the same as #14836 and can be resolved by setting a required environment as described at https://github.com/astral-sh/uv/pull/14913 — we'll fix the default behavior at some point too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zivhadad24">@zivhadad24</a> on 2025-08-27 17:58</div>
            <div class="timeline-body"><p>@zanieb Does it mean I need to python_full_version == 3.10.* for each package dependency?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-27 18:04</div>
            <div class="timeline-body"><p>No, you'd set that in your <code>required-environments</code>. https://docs.astral.sh/uv/concepts/resolution/#required-environments</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zivhadad24">@zivhadad24</a> on 2025-08-27 19:14</div>
            <div class="timeline-body"><p>It's working but only when --index-strategy=unsafe-best-match
What about when we need UV to respect our private repository first? and only if our repository doesn't have compatible version it should continue to the next one</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-08-27 19:23</div>
            <div class="timeline-body"><p>That's what <code>--index-strategy=unsafe-best-match</code> is for.</p>
<p>The other relevant issue is https://github.com/astral-sh/uv/issues/15298</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:05 UTC
    </footer>
</body>
</html>
