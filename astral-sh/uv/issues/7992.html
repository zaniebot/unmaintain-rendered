<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installation of `pygraphviz` fails (but still updates uv.lock) - astral-sh/uv #7992</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Installation of `pygraphviz` fails (but still updates uv.lock)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7992">#7992</a>
        opened by <a href="https://github.com/david-waterworth">@david-waterworth</a>
        on 2024-10-07 23:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/david-waterworth">@david-waterworth</a> on 2024-10-07 23:51</div>
            <div class="timeline-body"><p>I'm not sure if this is a <code>uv</code> issue - but this works with pip / poetry but fails with <code>uv</code></p>
<p>I've followed https://pygraphviz.github.io/documentation/stable/install.html (specifically graghviz is installed)</p>
<p>I'm using py3.10 on Ubuntu 24.04
uv==0.4.18</p>
<p>If I install using pip</p>
<pre><code>$python -m venv .venv
$. .venv/bin/activate
$pip install pygraphviz

  Downloading https://.../simple/pygraphviz/1.14/pygraphviz-1.14.tar.gz (106 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 106.0/106.0 kB 2.2 MB/s eta 0:00:00
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: pygraphviz
  Building wheel for pygraphviz (pyproject.toml) ... done
  Created wheel for pygraphviz: filename=pygraphviz-1.14-cp310-cp310-linux_x86_64.whl size=210709 sha256=0e1d00dc911e52d201a8f9b8466d0569ec74f34a78bc243d358fc50c52987f15
  Stored in directory: /home/dave/.cache/pip/wheels/5c/47/fd/6960e1b155206881d2fe8bfcd96d6e71a7ef45a099f48ecf19
Successfully built pygraphviz
Installing collected packages: pygraphviz
Successfully installed pygraphviz-1.14
</code></pre>
<p>there's no issue, but under uv I get a build failure (log at end)</p>
<p>Also, despite <code>uv add pygraphviz</code> failing (so not updating <code>pyproject.toml</code>) - the <code>uv.lock</code> file is updated</p>
<pre><code>[[package]]
name = &quot;pygraphviz&quot;
version = &quot;1.14&quot;
source = { registry = &quot;https://xxx-xxx.d.codeartifact.xxx.amazonaws.com/pypi/xxx/simple/&quot; }
sdist = { url = &quot;https://xxx-xxx.d.codeartifact.xxx.amazonaws.com/pypi/xxx/simple/pygraphviz/1.14/pygraphviz-1.14.tar.gz&quot;, hash = &quot;sha256:c10df02377f4e39b00ae17c862f4ee7e5767317f1c6b2dfd04cea6acc7fc2bea&quot; }
</code></pre>
<p>Is this expected?</p>
<pre><code>$ uv add pygraphviz
Resolved 219 packages in 6.48s
error: Failed to prepare distributions
  Caused by: Failed to fetch wheel: pygraphviz==1.14
  Caused by: Build backend failed to build wheel through `build_wheel()` (exit status: 1)
--- stdout:
running bdist_wheel
running build
running build_py
creating build/lib.linux-x86_64-cpython-310/pygraphviz
copying pygraphviz/graphviz.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
copying pygraphviz/agraph.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
copying pygraphviz/__init__.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
copying pygraphviz/testing.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
copying pygraphviz/scraper.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
creating build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_readwrite.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_attribute_defaults.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_graph.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_string.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_clear.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_html.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_edge_attributes.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_layout.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_scraper.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_close.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/__init__.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_repr_mimebundle.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_unicode.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_drawing.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_node_attributes.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
copying pygraphviz/tests/test_subgraph.py -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz/tests
running egg_info
writing pygraphviz.egg-info/PKG-INFO
writing dependency_links to pygraphviz.egg-info/dependency_links.txt
writing top-level names to pygraphviz.egg-info/top_level.txt
reading manifest file 'pygraphviz.egg-info/SOURCES.txt'
reading manifest template 'MANIFEST.in'
adding license file 'LICENSE'
writing manifest file 'pygraphviz.egg-info/SOURCES.txt'
copying pygraphviz/graphviz.i -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
copying pygraphviz/graphviz_wrap.c -&gt; build/lib.linux-x86_64-cpython-310/pygraphviz
running build_ext
building 'pygraphviz._graphviz' extension
creating build/temp.linux-x86_64-cpython-310/pygraphviz
clang -pthread -Wno-unused-result -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -fPIC -DSWIG_PYTHON_STRICT_BYTE_CHAR -I/home/dave/.cache/uv/builds-v0/.tmpbqXggC/include -I/home/dave/.local/share/uv/python/cpython-3.10.15-linux-x86_64-gnu/include/python3.10 -c pygraphviz/graphviz_wrap.c -o build/temp.linux-x86_64-cpython-310/pygraphviz/graphviz_wrap.o
--- stderr:
warning: no files found matching '*.swg'
warning: no files found matching '*.png' under directory 'doc'
warning: no files found matching '*.html' under directory 'doc'
warning: no files found matching '*.txt' under directory 'doc'
warning: no files found matching '*.css' under directory 'doc'
warning: no previously-included files matching '*~' found anywhere in distribution
warning: no previously-included files matching '*.pyc' found anywhere in distribution
warning: no previously-included files matching '.svn' found anywhere in distribution
no previously-included directories found matching 'doc/build'
error: command 'clang' failed: No such file or directory
---
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Installation of `pygraphviz` fails" to "Installation of `pygraphviz` fails (but still updates uv.lock)" by @david-waterworth on 2024-10-08 00:03</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-08 02:09</div>
            <div class="timeline-body"><p>See https://github.com/astral-sh/uv/issues/7525 for discussion of similar build errors.</p>
<p>I'm surprised we update the lockfile, we can look into that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-10-08 02:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Aditya-PS-05">@Aditya-PS-05</a> on 2024-10-08 10:45</div>
            <div class="timeline-body"><p>@zanieb ,
Can you assign me this issue?
I would be great if you add the <code>hacktoberfest</code> label. As I am participating in hacktoberfest.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-23 00:00</div>
            <div class="timeline-body"><p>@zanieb -- I guess we should be resetting (or even removing, if it didn't exist) the <code>uv.lock</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @charliermarsh by @charliermarsh on 2024-11-11 21:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-11-11 21:07</div>
            <div class="timeline-body"><p>Fixed at https://github.com/astral-sh/uv/pull/9030.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-12 03:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-11-12 03:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tipanverella">@tipanverella</a> on 2025-04-14 22:04</div>
            <div class="timeline-body"><p>ps: something like the following should work:</p>
<pre><code class="language-zsh">uv add --config-settings=&quot;--global-option=build_ext&quot; \
              --config-settings=&quot;--global-option=-I/opt/local/include/&quot; \
              --config-settings=&quot;--global-option=-L/opt/local/lib/&quot; \
              pygraphviz
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:44:06 UTC
    </footer>
</body>
</html>
