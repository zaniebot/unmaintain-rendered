```yaml
number: 7958
title: Incorrect documentation for aws code-artifact publication
type: issue
state: closed
author: david-waterworth
labels:
  - bug
  - documentation
assignees: []
created_at: 2024-10-07T04:10:12Z
updated_at: 2024-10-15T16:08:20Z
url: https://github.com/astral-sh/uv/issues/7958
synced_at: 2026-01-10T01:57:18Z
```

# Incorrect documentation for aws code-artifact publication

---

_Issue opened by @david-waterworth on 2024-10-07 04:10_

Following the documentation (https://docs.astral.sh/uv/guides/integration/alternative-indexes/#aws-codeartifact) for `uv publish` to aws code-artifact fails with

```
error: Failed to publish
Caused by: The request was redirected, but redirects are not allowed when publishing, please use the canonical URL: `https://${AWS_DOMAIN}-${AWS_ACCOUNT_ID}.d.codeartifact.${AWS_REGION}.amazonaws.com/pypi/${AWS_CODEARTIFACT_REPOSITORY}/`
```

What works is:

```
# Configure uv to use AWS CodeArtifact
export UV_PUBLISH_URL="https://${AWS_DOMAIN}-${AWS_ACCOUNT_ID}.d.codeartifact.${AWS_REGION}.amazonaws.com/pypi/${AWS_CODEARTIFACT_REPOSITORY}/"
export UV_PUBLISH_USERNAME=aws
export UV_PUBLISH_PASSWORD="$AWS_CODEARTIFACT_TOKEN"

# Publish the package
uv publish
```

i.e. `UV_PUBLISH_URL` should NOT include the AWS_CODEARTIFACT_TOKEN

---

_Label `bug` added by @charliermarsh on 2024-10-08 22:34_

---

_Label `documentation` added by @charliermarsh on 2024-10-08 22:34_

---

_Assigned to @konstin by @charliermarsh on 2024-10-08 22:39_

---

_Referenced in [astral-sh/uv#8222](../../astral-sh/uv/pulls/8222.md) on 2024-10-15 15:42_

---

_Closed by @konstin on 2024-10-15 16:08_

---

_Referenced in [astral-sh/uv#7839](../../astral-sh/uv/issues/7839.md) on 2024-11-03 18:09_

---
