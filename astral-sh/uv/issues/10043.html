<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add bootstrap functionality for environments (python version, plus uv inside environment) - astral-sh/uv #10043</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add bootstrap functionality for environments (python version, plus uv inside environment)</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/10043">#10043</a>
        opened by <a href="https://github.com/paxsali">@paxsali</a>
        on 2024-12-19 21:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/paxsali">@paxsali</a> on 2024-12-19 21:48</div>
            <div class="timeline-body"><p>Hi all,</p>
<p>I'd like to propose a new cmdline target <code>bootstrap</code> that creates a new environment with <code>uv</code> installed in it, and with a specific python version.</p>
<p>So basically, in order to explain this feature request, I have to talk about my workflow.</p>
<p>I'm working a lot with different containers, where the underlying OS (and package manager) may be very different every time.
There may be no guarantee that the OS has a &quot;recent enough&quot; python version available from the default package manager, nor that <code>uv</code> itself is available as a package in the OS'es repository.
In fact, the the only true requirement is that there's a python &gt;= 3.3 installed (for <code>venv</code> - you'll see later why).</p>
<p>In order to explain my &quot;bootstrapping process&quot; I can show what commands I usually do, since that would be more easy:</p>
<pre><code class="language-bash">
# 1. start &amp; enter container

### PHASE 1

# 2. create a throw-away environment that's just for bootstrapping uv
python3 -m venv ~/.myenvs/bootstrap-uv

# 3. enter the new environment
source ~/.myenvs/bootstrap-uv/bin/activate

# 4. install uv inside &quot;bootstrapping environment&quot;
pip install uv

# 5. install one or more desired python versions
uv python install cpython-3.12.8-linux-x86_64-gnu

# 6. prepare a second throw-away environment that's based on the target python version you're interested in
mkdir ~/.myenvs/py312-env
uv venv --python 3.12.8 ~/.myenvs/py312-env

# 7. exit the &quot;bootstrapping environment&quot; and delete it. it will never be used again.
deactivate
rm -fr ~/.myenvs/bootstrap-uv

### PHASE 2

# 8. enter the new python version-specific environment (created by uv)
. ~/.myenvs/py312-env/bin/activate

# 9. create the true (final) target environment
python3 -m venv ~/.myenvs/myenv

# 10. exit the throw-away python environment now. it will never be used again.
deactivate
rm -fr ~/.myenvs/py312-env

### PHASE 3

# 11. enter the true target environment, based on the python version that was installed by uv
source ~/.myenvs/myenv/bin/activate

# 12. notice this environment HAS NO uv installed, yet! install uv in the proper python environment.
which uv  # empty output, exit status: 1
pip install uv

# FINISHED

# optional extra steps:
## upgrade pip itself
uv pip install --upgrade pip

## show installed packages
uv pip list

## create projects, work with uv, have fun ...
mkdir ~/projects
uv init --package ~/projects/sample_project

# when done:
deactivate

</code></pre>
<p>Now to explain in simple words, what <code>bootstrap</code> whould do is:</p>
<ul>
<li>create an environment with a specific version of python</li>
<li>but also one where the latest <code>uv</code> itself is also installed (and specifically NOT just a copy from the OS, but a &quot;fresh from the internet&quot; one)</li>
</ul>
<p>The <code>bootstrap</code> option should therefor be able to take as arguments at least <code>--python</code> (like from <code>uv venv</code>) and PATH at minimum.</p>
<p>Oppon activation of the &quot;bootstrapped&quot; environment there must be a guarantee that the active python version comes from <code>uv</code>'s own list (as opposed to coming from the OS) and the environment-specific <code>uv</code> version is a fresh, new install (as opposed to the versions from the OS, if any at all) - I can imagine using the command <code>curl -LsSf https://astral.sh/uv/install.sh | sh</code> for this process, if <code>curl</code> is available, else simply use <code>pip install uv</code> internally.</p>
<p>Obviously the details, like what other options to offer on top of that, must be fleshed out.</p>
<p>But the gist of the idea is to have something like a <code>uv venv ...</code>, but with a guarantee that the latest <code>uv</code> version will be contained inside the environment, essentially taking away the requirement that <code>uv</code> must be available from an OS repository.
Another way of thinking about it is this: you only need to somehow install <code>uv</code> once (no matter from where, OS-wide or env-specific), and then you'll use that to create your desired python environment, with the latest <code>uv</code> as a result (no matter any OS repository restrictions).</p>
<p>I admit the feature request may sound rather &quot;niche&quot;. Certainly I am totally content with my &quot;manual commands&quot; workaround for the moment, but still I'll leave this issue as an idea for discussion.</p>
<p>Thank you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jromal">@jromal</a> on 2024-12-24 11:38</div>
            <div class="timeline-body"><p>I see you speak about containers. But it would be great to have a bootstrap also for calls on the operative system:</p>
<ul>
<li>Check if uv is installed, if not, install uv from the download link (e.g. for windows: <strong>powershell -ExecutionPolicy ByPass -c &quot;irm https://astral.sh/uv/install.ps1 | iex&quot;</strong>)</li>
<li>Check the path is set and visible to the bootstrap and if not set it or use the &quot;./local/bin&quot; folder for calling uv or uvx.</li>
<li>execute the <strong><code>uv</code></strong> or <strong><code>uvx</code></strong> command that was requested. In case of uvx, already installs the tool if missing.</li>
</ul>
<p>Then you can pack a call to a program, module or tool with some parameters in a batch/sh file or whatever used on each OS, and there is no need to worry about <code>uv</code> being properly installed. <code>uv</code> could stay or be removed after processing depending on the needs and use cases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wish</span> added by @zanieb on 2025-01-06 20:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:31:53 UTC
    </footer>
</body>
</html>
