<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>0.2.28 broke Nox support by changing how local reinstallation works - astral-sh/uv #5790</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>0.2.28 broke Nox support by changing how local reinstallation works</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/5790">#5790</a>
        opened by <a href="https://github.com/hynek">@hynek</a>
        on 2024-08-05 08:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/hynek">@hynek</a> on 2024-08-05 08:08</div>
            <div class="timeline-body"><p>I've run into the weirdness that Nox paired with uv stopped re-installing the local package and the tests ran against old code.</p>
<p>I've bisected the behavior and it looks like the change was introduced with uv 0.2.28 because it works with 0.2.27. It doesn't seem to be cache related since deleting the cache didn't help.</p>
<p>I've seen mentions of <code>--reinstall-package</code> for uv, but it used to work recently and I'd rather not hard-couple my noxfile to uv if it can be helped.</p>
<p>I've ran into it while working on https://github.com/hynek/stamina so it could be a decent way to test. I've even added debug output out the package versions when running pytest. The number behind dev should increment after each commit.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-08-05 08:33</div>
            <div class="timeline-body"><p>Are you using dynamic metadata? In that case it's probably https://github.com/astral-sh/uv/pull/5206. We're trying to rebuild less often for better performance.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hynek">@hynek</a> on 2024-08-05 08:46</div>
            <div class="timeline-body"><p>I do! hatch-vcs (which is setuptools-scm under the hood).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2024-08-05 08:54</div>
            <div class="timeline-body"><p>Does this option help? https://docs.astral.sh/uv/reference/settings/#reinstall-package</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hynek">@hynek</a> on 2024-08-05 15:16</div>
            <div class="timeline-body"><p>Hm yes but since I didn't want to couple my noxfile to uv (they support graceful fallbacks), I've set it in pyproject.toml using <code>tool.uv.reinstall-package</code>. Is that how it's supposed to be used or will that have some weird side-effects?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-08-05 16:27</div>
            <div class="timeline-body"><p>@hynek -- That should be totally fine. If you want to &quot;always reinstall the package&quot; (the previous behavior), that's the right thing to do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hynek">@hynek</a> on 2024-08-06 15:05</div>
            <div class="timeline-body"><p>OK, I guess it's a documentation issue for Nox then â€“ thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @hynek on 2024-08-06 15:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../../wntrblm/nox/issues/840.html">wntrblm/nox#840</a> on 2024-08-06 15:12</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:20 UTC
    </footer>
</body>
</html>
