<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to automatically choose the available index to use for installing dependancies? - astral-sh/uv #12477</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>How to automatically choose the available index to use for installing dependancies?</h1>

    <div class="meta">
        <span class="state state-open">Open</span>
        <a href="https://github.com/astral-sh/uv/issues/12477">#12477</a>
        opened by <a href="https://github.com/codgas">@codgas</a>
        on 2025-03-26 03:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/codgas">@codgas</a> on 2025-03-26 03:58</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I have a single <code>pyproject.toml</code> that specifies multiple indexes and dependency groups, for example:</p>
<pre><code>dependencies = [ ... ]

[dependency-groups]
group_a = [...]
group_b = [...]

[tool.uv.sources]
 group_a = [{ index = &quot;index1&quot; }]
 group_b = [{ index = &quot;index2&quot; }]

[[tool.uv.index]]
name = &quot;index1&quot;
url = &quot;https://url1/&quot;

[[tool.uv.index]]
name = &quot;index2&quot;
url = &quot;https://url2/&quot;
</code></pre>
<p>I have different Docker builds targeting different environments (group_a vs. group_b). The group_a environment cannot access 'index2', while group_b cannot access the other ('index1').
However, when I run:
<code>uv sync  --group_b </code>
It chooses index1 to install dependencies (which group_b can’t access), and fails as a result.</p>
<p>I’d like uv to automatically pick the correct (accessible) index or gracefully ignore the one that’s unavailable—ideally without large code changes or fully splitting my pyproject.toml. While I could move dependencies into separate group-level dependency blocks, that would add redundant declarations, which I’d prefer to avoid.
Anyone have any idea how to do this ?</p>
<h3>Platform</h3>
<p>Debian</p>
<h3>Version</h3>
<p>0.6.9</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @codgas on 2025-03-26 03:58</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sanmai-NL">@sanmai-NL</a> on 2025-03-26 08:44</div>
            <div class="timeline-body"><ul>
<li>https://docs.astral.sh/uv/reference/settings/#pip_index-strategy</li>
<li>https://docs.astral.sh/uv/reference/settings/#index (<code>explicit</code> and <code>default</code>)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/codgas">@codgas</a> on 2025-03-26 09:10</div>
            <div class="timeline-body"><p>@sanmai-NL
Thanks for the advice, sadly the url is completely inaccessible so even with changing  the index strategy, it kept giving
<code>error: Failed to fetch:</code> url</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-04-01 19:00</div>
            <div class="timeline-body"><p>I think this is loosely a duplicate of https://github.com/astral-sh/uv/issues/6349</p>
<p>cc @jtfmumm</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @zanieb on 2025-04-01 19:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:03 UTC
    </footer>
</body>
</html>
