<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing files after uv pip install - astral-sh/uv #5315</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Missing files after uv pip install</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/5315">#5315</a>
        opened by <a href="https://github.com/rnarma321">@rnarma321</a>
        on 2024-07-22 21:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rnarma321">@rnarma321</a></div>
            <div class="timeline-body"><!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

<p>Command: <code>uv pip install kivymd==1.1.1</code>
This package should have .kv files inside of it, but when i use uv pip install vs pip install they are missing.
There are no issues popped up during the install, even in verbose mode</p>
<p>The tar.gz is pulls from has these files, I checked manually, Im not exactly sure what is causing this, but I tried across two version 0.2.27 and 0.2.0, along with two different OSs with mac and debian 12 bookworm and got the same results with every combination.</p>
<pre><code class="language-DEBUG">DEBUG Found fresh response for: https://pypi.org/simple/kivymd/
DEBUG Searching for a compatible version of kivymd (==1.1.1)
DEBUG Selecting: kivymd==1.1.1 (kivymd-1.1.1.tar.gz)
DEBUG Trying to lock if free: /Users/roshan/Library/Caches/uv/built-wheels-v3/pypi/kivymd/1.1.1/.lock
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/35/55/d979644cdc9070a9611ab023db986aa0d540fc8f5fdd2c0f49eaef558751/kivymd-1.1.1.tar.gz
DEBUG Using cached metadata for: kivymd==1.1.1
DEBUG Adding transitive dependency for kivymd==1.1.1: kivy&gt;=2.0.0
DEBUG Adding transitive dependency for kivymd==1.1.1: pillow* ````

</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-22 22:56</div>
            <div class="timeline-body"><p>Where are those files supposed to be exactly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rnarma321">@rnarma321</a> on 2024-07-22 23:16</div>
            <div class="timeline-body"><p>an example can be found under .venv/lib/python3.10/site-packages/kivymd/uix/button/button.kv. This file will exist under pip but never showed up with uv pip</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-07-22 23:46</div>
            <div class="timeline-body"><p>For reference, this is included in the <code>package_data</code>: https://github.com/kivymd/KivyMD/blob/b5bc79fb71312868be86580b7b32f676926ceb80/setup.py#L102</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rnarma321">@rnarma321</a> on 2024-07-23 00:32</div>
            <div class="timeline-body"><p>So actually that is interesting, it doesn't have the .pot files or the .po files. But it seems to have the .ttf files and the .pngs. Maybe something about the pathing it generates from the &quot;glob_paths&quot; function it calls breaks with uv but not with pip</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-23 02:57</div>
            <div class="timeline-body"><p>Do you see any more consistency when you run <code>pip install --use-pep517</code>, and compare that to uv?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/rnarma321">@rnarma321</a> on 2024-07-23 03:23</div>
            <div class="timeline-body"><p>Nope, the pip install using pep517 flag still gives the .kv files, unlike uv which is missing it</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 00:57</div>
            <div class="timeline-body"><p>Ok, I figured this out. Their <code>setup.py</code> assumes that there is no directory named <code>kivymd</code> in the path apart from the one at the top-level. But in our cache, we nest the build under a directory called <code>kivymd</code></p>
<p>E.g., here's one path in the cache: <code>Users/crmarsh/workspace/uv/foo/built-wheels-v3/pypi/kivymd/1.1.1/_kyEDLdSRqebDVYQM_lQA/kivymd-1.1.1.tar.gz/kivymd/uix/textfield/textfield.kv</code></p>
<p>So it's truncating at the first <code>kivymd</code>.</p>
<p>I consider this a bug in the package itself, it's effectively not relocatable. I think they need to change <code>out_files.append(filepath.split(f&quot;kivymd{os.sep}&quot;)[1])</code> to <code>out_files.append(filepath.split(f&quot;kivymd{os.sep}&quot;)[-1])</code> in the <code>setup.py</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-07-24 01:16</div>
            <div class="timeline-body"><p>I created an issue here: https://github.com/kivymd/KivyMD/issues/1722</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2024-07-24 01:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @charliermarsh on 2024-07-24 01:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:25:42 UTC
    </footer>
</body>
</html>
