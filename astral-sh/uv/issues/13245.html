<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv run` from multiple requirements - astral-sh/uv #13245</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv run</code> from multiple requirements</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/13245">#13245</a>
        opened by <a href="https://github.com/patrick-kidger">@patrick-kidger</a>
        on 2025-04-30 22:46
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/patrick-kidger">@patrick-kidger</a></div>
            <div class="timeline-body">Question
<p>I&#x27;ve done a search through the issue tracker and not found any good matches. Apologies if this has come up somewhere already but I couldn&#x27;t find it.</p>
<p>First the ask: is it possible to have <code>uv run</code> consume multiple requirements files as input to its locking+syncing? Analogous to how <code>uv pip compile pyproject.toml foo.txt -o requirements.txt</code> consumes both <code>pyproject.toml</code> and <code>foo.txt</code>, not just <code>pyproject.toml</code>.</p>
<p>Notably this is <em>not</em> the same as <code>uv run --with-requirements foo.txt</code>, as this creates and installs into an ephemeral venv. This breaks tooling (e.g. pytest can no longer find its plugins), and noticeably increases startup time. Although if you like this question could be reinterpeted as &#x27;can <code>--with</code> install into the current venv&#x27;, but I&#x27;m guessing that would be considered unsafe.</p>
<p>Nor is this the same as <code>uv sync --inexact; uv pip install -r foo.txt</code>, as this will not uninstall old dependencies.</p>
<p>Nor is this the same as <code>UV_PROJECT_ENVIRONMENT=.venv uv run --with foo.txt</code>, as unfortunately it seems that <code>--with</code> takes precedence and the environment variable goes ignored.</p>
<hr>
<p>With all of that out the way, to avoid an X-Y problem, here is the use-case: our team have a library which specifies its dependencies as a <code>pyproject.toml</code> file. We use the high-level <code>uv run ...</code> which works as normal. However each developer individually also has additional idiosyncratic developer tooling that they&#x27;d like installed into their environment: <code>jupyter</code>, custom debuggers like <code>pudb</code>, the LSP from <code>ruff</code>, this kind of thing. These can&#x27;t be expressed in the <code>pyproject.toml</code> file as they shouldn&#x27;t be shared with other developers and in fact may refer to local-only unpublished packages.</p>
<p>Ideally we&#x27;d be able to do something like <code>uv run pyproject.toml ~/.config/uv/requirements.txt &lt;actual python command here&gt;</code> (dressed up in a shell alias for a minimum of typing).</p>
<p>Many thanks in advance for any help :)</p>
Platform
<p>MacOS</p>
Version
<p>uv 0.7.2 (481d05d8d 2025-04-30)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/patrick-kidger">@patrick-kidger</a> on 2025-04-30 22:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-02 10:13</div>
            <div class="timeline-body"><p>The answer to your question depends on if those tools should be installed in the same venv (e.g., ruff doesn&#x27;t need to, but ipykernel does) and if you want those dependencies locked together with the project dependencies, potentially influencing the resolved version.</p>
<p>Some of these sound like cases for the task runner (<a href="https://github.com/astral-sh/uv/issues/5903">astral-sh/uv#5903</a>) or tool installations. For others, dependency groups may be the right solution: Dependency groups are not installed by default (expect <code>dev</code>) and are not published with a package, but can be selected with <code>--group</code>. They are resolved with the project dependencies though and may influence the resolved versions.</p>
<p>For jupyter specifically, we have a guide (https://docs.astral.sh/uv/guides/integration/jupyter/). There, the <code>ipykernel</code> package needs to be installed with the project, while jupyter can be installed and launched separately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/patrick-kidger">@patrick-kidger</a> on 2025-05-02 11:39</div>
            <div class="timeline-body"><p>Thanks for the response!</p>
<blockquote>
<p>The answer to your question depends on if those tools should be installed in the same venv</p>
</blockquote>
<p>Yup, in general this is important. (E.g. pytest plugins)</p>
<blockquote>
<p>if you want those dependencies locked together with the project dependencies, potentially influencing the resolved version.</p>
</blockquote>
<p>Ideally the extra dev dependencies would not influence resolution. But as a practical matter for us this isn&#x27;t super important, as CI ensures consistent good behaviour across all developers.</p>
<blockquote>
<p>groups</p>
</blockquote>
<p>These aren&#x27;t really practical for the reasons described in my original post. (&#x27;These can&#x27;t be expressed in the <code>pyproject.toml</code> file ...&#x27;)</p>
<hr>
<p>Anyway, since opening this issue I&#x27;ve actually found a different workaround:</p>
<pre><code>uv run fish -c &#x27;uv pip install foo bar &amp;&amp; actual command here&#x27;
</code></pre>
<p>This isn&#x27;t perfect as there&#x27;s no way to express a constraint against the existing <code>uv.lock</code> (I&#x27;ve commented on <a href="https://github.com/astral-sh/uv/issues/9774">astral-sh/uv#9774</a> that it&#x27;d be nice to have this), but as above probably good enough for practical use cases!</p>
<p>I hope the above trick helps anyone else looking to support the same feature of per-developer dependencies.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-05-02 12:52</div>
            <div class="timeline-body"><p>While there&#x27;s definitely room for improvement, in my workflows I made good experiences with a <code>uv sync</code> initially and then <code>uv pip install</code>ing additional dev packages, including jupyter. I can still use <code>uv run</code> afterwards since it doesn&#x27;t remove any of the packages, and <code>uv pip install</code> uses the installed packages as preferences.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:38:27 UTC
    </footer>
</body>
</html>
