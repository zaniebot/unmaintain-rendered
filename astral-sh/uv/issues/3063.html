<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Installing packages from custom pypi server fails on 0.1.32 - astral-sh/uv #3063</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Installing packages from custom pypi server fails on 0.1.32</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/3063">#3063</a>
        opened by <a href="https://github.com/bnaul">@bnaul</a>
        on 2024-04-16 15:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/bnaul">@bnaul</a> on 2024-04-16 15:11</div>
            <div class="timeline-body"><p>Highly likely that the root issue is on our end but figured it's still worth an issue since others might be facing the same issue soon: upon upgrading to <code>uv==0.1.32</code>, our docker builds started failing with</p>
<pre><code>error: HTTP status server error (502 Bad Gateway) for url
</code></pre>
<p>Rolling back to <code>0.1.31</code> fixed things.</p>
<p>We <code>UV_INDEX_URL=... pip install -r requirements.txt</code> with a couple (3?) of packages coming from a self-hosted <code>pypiserver</code> instance, and the rest (400?) are publicly available on PyPI. No obvious issues with the health of our server, CPU load is still extremely low, can't find anything noteworthy in the logs.</p>
<p>I <code>git bisect</code>ed my way to #2817 and found that any commits before this change succeed. That's about all I've been able to find but if there's any other <code>uv</code> or <code>pypiserver</code> output that would be of interest let me know and I'll post it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-04-22 19:18</div>
            <div class="timeline-body"><p>Hey Brett! Good to see you.</p>
<p>Sorry this issue fell through the cracks, are you still encountering this on the latest version? I think a lot changed in our network stack with #2817, seems possible we made a mistake or that there's a regression upstream.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-04-22 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">upstream</span> added by @zanieb on 2024-04-22 19:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bnaul">@bnaul</a> on 2024-04-22 21:05</div>
            <div class="timeline-body"><p>Hi @zanieb ðŸ‘‹ yes, I just checked and we still encounter this on 0.1.36. Don't have many other details to share but a couple other things:</p>
<ul>
<li><code>uv pip install &lt;a few packages&gt;</code> works fine, it's only installing our full set of requirements that triggers the issue</li>
<li><code>uv pip compile</code> also reliably triggers the issue for su</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-04-22 22:05</div>
            <div class="timeline-body"><p>FWIW we've used pypiserver for some testing and I've seen pretty consistent errors at high levels of parallelism. We may just need to let people turn down our network concurrency.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-11-08 19:28</div>
            <div class="timeline-body"><p>We now support configuring concurrent network requests: https://docs.astral.sh/uv/reference/environment/#uv_concurrent_downloads</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-11-08 19:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:19 UTC
    </footer>
</body>
</html>
