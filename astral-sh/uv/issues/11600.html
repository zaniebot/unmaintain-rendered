<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add an `authentication` mode to `[index]` configuration - astral-sh/uv #11600</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add an <code>authentication</code> mode to <code>[index]</code> configuration</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11600">#11600</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-02-18 15:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/zanieb">@zanieb</a></div>
            <div class="timeline-body"><h3>Summary</h3>
<p>There’s a bit of design work to be done here, but the rough problem is this:</p>
<ul>
<li>If we receive a package index without a username, we always try an unauthenticated request first</li>
<li>If that fails, we search for credentials (e.g., via keyring)</li>
</ul>
<p>However, some indexes don’t <em>fail</em> on unauthenticated requests, instead they just forward to the public PyPI and now the user is confused their package is missing. The current solution is to tell users to set a username in their index URL, as that will force us to fetch credentials. However, if the username varies per user (sometimes its just a constant), they can’t commit that to the <code>pyproject.toml</code>. So, the idea is: add an authentication “mode” to the <code>tool.uv.index</code> table which allows a user to explicitly say “never use authentication” or “always use authentication” for a given index.</p>
<p>See</p>
<ul>
<li>https://github.com/astral-sh/uv/issues/3923</li>
<li>https://github.com/astral-sh/uv/issues/9331#issuecomment-2499221075</li>
</ul>
<h3>Example</h3>
<p>Not a final design, but for example</p>
<pre><code class="language-toml">[[tool.uv.index]]
name = &quot;foo&quot;
url = &quot;https://...&quot;
authentication = &quot;auto | always | never&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2025-02-18 15:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/morotti">@morotti</a> on 2025-02-18 18:24</div>
            <div class="timeline-body"><p>thanks, it would be great if it can be set with an environment variable, like <code>UV_INDEX_AUTHENTICATION=always</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jdumas">@jdumas</a> on 2025-02-18 22:01</div>
            <div class="timeline-body"><p>I wonder if a simple boolean <code>force_auth = true</code> would be sufficient? I don't see a case where the current <code>auto</code> mode would fail and you'd want to force unauthenticated instead.</p>
<p>In any case I'm eagerly awaiting for this option. This is currently a blocker for me to use <code>uv</code> in downstream applications for internal projects.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 22:09</div>
            <div class="timeline-body"><blockquote>
<p>you'd want to force unauthenticated instead.</p>
</blockquote>
<p>I was thinking of cases where you don't want to accidentally leak credentials to another index</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @jtfmumm on 2025-02-26 15:07</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-03-10 17:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:29:59 UTC
    </footer>
</body>
</html>
