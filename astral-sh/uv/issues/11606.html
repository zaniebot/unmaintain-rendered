<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allow dependency groups to define a separate `requires-python` - astral-sh/uv #11606</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Allow dependency groups to define a separate `requires-python`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/11606">#11606</a>
        opened by <a href="https://github.com/zanieb">@zanieb</a>
        on 2025-02-18 22:40
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-18 22:40</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Right now, the <code>[dependency-groups]</code> have the same <code>requires-python</code> as the <code>[project]</code> defines, but this causes problems when a group is only intended to be used with a different Python version range, e.g., you could only care about 3.12+ for building your documentation but 3.9+ matters for publishing your library.</p>
<p>See</p>
<ul>
<li>#11605</li>
</ul>
<p>As a meta-note, I know this was discussed elsewhere but cannot find it.</p>
<h3>Example</h3>
<pre><code class="language-toml">[project]
name = &quot;example&quot;
version = &quot;0.0.0&quot;
requires-python = &quot;&gt;=3.10&quot;

[tool.uv.dependency-groups.foo]
requires-python = &quot;&gt;=3.12&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @zanieb on 2025-02-18 22:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-02-19 10:11</div>
            <div class="timeline-body"><p>To add a motivating example, users may have tooling such as building documentation, code generation or importing external data that requires a more recent Python version than the project itself. A common example is sphinx, which (as of master) requires Python 3.11, while libraries supporting all non-EOL Python versions support <code>&gt;=3.9</code>. The current workaround is <code>sphinx; python_version &gt;= &quot;3.11&quot;</code> in the dependency group, which allows selecting the group on an older Python version without actually installing sphinx.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-19 01:55</div>
            <div class="timeline-body"><p>I think this is fairly straightforward to implement by adding it to <code>lowering.rs</code> (just put <code>python_version &gt;= &quot;3.12&quot;</code> on each dependency; the resolver will do the rest). However, we probably also want to error (?) if users try to install these groups with a lower Python version? So we'll need to track it elsewhere too, and add error handling around it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-19 02:02</div>
            <div class="timeline-body"><p>I see this as fairly high priority given the workaround is to add a marker to every dependency in the group.</p>
<p>@Gankra perhaps you'd be interested in picking it up? (I know you <em>love</em> dependency groups)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-19 02:05</div>
            <div class="timeline-body"><p>(The only weirdness with the approach I described above is we'll then add <code>python_version &gt;= &quot;3.12&quot;</code> to each of the dependency entries in the lockfile <em>and</em> we'd have some annotation on the group itself, which is kind of ugly.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @Gankra by @Gankra on 2025-03-19 12:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Gankra">@Gankra</a> on 2025-03-19 12:46</div>
            <div class="timeline-body"><p>Sure I can give this a shot</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/a-reich">@a-reich</a> on 2025-06-09 00:00</div>
            <div class="timeline-body"><p>I’d love this feature too, it’s <a href="https://discuss.python.org/t/dependency-groups-extras-and-how-to-manage-environments-python-versions/69297">analogous</a> to one hatch has (for what it terms environments).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RobertCraigie">@RobertCraigie</a> on 2025-06-10 11:25</div>
            <div class="timeline-body"><p>We're running into this as well, as all of our libraries still support Python 3.8, we can't add an optional dependency that requires 3.9. From our perspective it's totally fine if users can only use some optional dependencies if they're on later Python versions.</p>
<p>Is there any workaround possible until this is fully supported?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-06-10 11:48</div>
            <div class="timeline-body"><p>Yeah the existing workaround is to add <code>; python_version &gt;= &quot;3.9&quot;</code> to each such dependency.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RobertCraigie">@RobertCraigie</a> on 2025-06-10 12:11</div>
            <div class="timeline-body"><p>ah thank you! sorry I missed that earlier in this thread.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @Gankra on 2025-06-13 22:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:35:23 UTC
    </footer>
</body>
</html>
