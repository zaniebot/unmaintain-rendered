<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workspace members are installed as editable during `uv tool install ./project` - astral-sh/uv #16306</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Workspace members are installed as editable during `uv tool install ./project`</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/16306">#16306</a>
        opened by <a href="https://github.com/krishmas">@krishmas</a>
        on 2025-10-15 01:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/krishmas">@krishmas</a> on 2025-10-15 01:53</div>
            <div class="timeline-body"><h3>Question</h3>
<p>I raised this as a related question in #12795 but figured this is a little different and deserved its own issue</p>
<p>I have a monorepo workspace structure with multiple projects that depend on shared libraries within the same workspace:</p>
<pre><code>  monorepo/
  ├── pyproject.toml (workspace root)
  ├── projects/
  │   └── project_a/
  │       ├── pyproject.toml
  │       └── src/project_a/
  └── shared_libs/
      └── shared_lib_a/
          ├── pyproject.toml
          └── src/shared_lib_a/
</code></pre>
<p><strong>Root <code>pyproject.toml</code>:</strong></p>
<pre><code class="language-toml">[tool.uv.workspace]
members = [
    &quot;projects/project_a&quot;,
    &quot;shared_libs/shared_lib_a&quot;
]

[tool.uv.sources]
project_a = { workspace = true }
shared_lib_a = { workspace = true }
</code></pre>
<p><code>projects/project_a/pyproject.toml:</code></p>
<pre><code class="language-toml">  [project]
  name = &quot;project_a&quot;
  dependencies = [
      &quot;shared_lib_a&quot;
  ]

  [project.scripts]
  project_a = &quot;project_a.main:app&quot;

  [build-system]
  requires = [&quot;hatchling&quot;]
  build-backend = &quot;hatchling.build&quot;
</code></pre>
<p>When I run <code>uv tool install project_a</code>, the installation creates a snapshot but only includes a .pth file linking back to <code>shared_lib_a</code>'s source code. This means if I modify or delete <code>shared_lib_a</code>
after installation, the installed tool breaks.</p>
<p>Is there a way to make <code>uv tool install</code> include/vendor the workspace dependencies (<code>shared_lib_a</code>) into the tool installation so it's fully self-contained?</p>
<p>I basically want the installed tool to be independent of the workspace source code state, similar to how compiled binaries work in Go/Rust/etc where dependencies are bundled into the final artifact.</p>
<h3>Platform</h3>
<p><em>No response</em></p>
<h3>Version</h3>
<p>uv 0.7.8 (0ddcc1905 2025-05-23)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @krishmas on 2025-10-15 01:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-10-15 13:49</div>
            <div class="timeline-body"><p>I could reproduce this with</p>
<pre><code>❯ uv init --package example
Initialized project `example` at `/private/tmp/example`
❯ cd example
❯ uv init child
Adding `child` as member of workspace `/private/tmp/example`
Initialized project `child` at `/private/tmp/example/child`
❯ uv add child
Using CPython 3.14.0
Creating virtual environment at: .venv
Resolved 2 packages in 24ms
      Built example @ file:///private/tmp/example
      Built child @ file:///private/tmp/example/child
Prepared 2 packages in 534ms
Installed 2 packages in 3ms
 + child==0.1.0 (from file:///private/tmp/example/child)
 + example==0.1.0 (from file:///private/tmp/example)
❯ cd ..

❯ uv tool install ./example
Resolved 2 packages in 1ms
      Built example @ file:///private/tmp/example
Prepared 1 package in 5ms
Installed 2 packages in 2ms
 + child==0.1.0 (from file:///private/tmp/example/child)
 + example==0.1.0 (from file:///private/tmp/example)
Installed 1 executable: example
                                                                                              
❯ ls $(uv_tool_dir)/example/lib/python3.14/site-packages/
__editable__.child-0.1.0.pth        child-0.1.0.dist-info/
__editable___child_0_1_0_finder.py  example/
_virtualenv.pth                     example-0.1.0.dist-info/
_virtualenv.py          
</code></pre>
<p>I'd expect us to use non-editable installs here by default. I think that's either a bug, or we should expose <code>--no-editable</code> to opt-out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @zanieb on 2025-10-15 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2025-10-15 13:49</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Can `uv tool install` include workspace dependencies in the installation?" to "Workspace members are installed as editable during `uv tool install ./project`" by @zanieb on 2025-10-15 13:50</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Referenced in <a href="../pulls/16335.html">astral-sh/uv#16335</a> on 2025-10-17 05:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/krishmas">@krishmas</a> on 2025-10-17 08:28</div>
            <div class="timeline-body"><p>Hi @zanieb ! I took a stab at this with <a href="https://github.com/astral-sh/uv/pull/16335">#16335</a>, apologies for starting work on an issue that wasn't labeled as appropriate for community contribution. Definitely agree with that perspective after reading the contribution guidelines. In my case I got too deep by the time I read that and figured it would at least be worth putting up a PR since (at least IMO) the solution in the PR seems fairly uncontroversial and solved my issues with <code>uv tool install</code>.</p>
<p>For this impl, rather than adding a <code>--no-editable</code> flag, I agree with you that that should just be the default behavior for tool installs, especially since <code>uv tool install</code> already supports an <code>--editable</code> flag.</p>
<p>Would appreciate a review if possible (some optional CI checks are failing due to 403 but besides that they're all passing), but definitely understand if you'd rather this be handled internally due to it not being explicitly tagged as <code>help wanted</code></p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:13 UTC
    </footer>
</body>
</html>
