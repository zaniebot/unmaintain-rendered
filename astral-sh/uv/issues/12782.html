<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`fork-strategy` `fewest` does not limit versions when combined with `required-environments` - astral-sh/uv #12782</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`fork-strategy` `fewest` does not limit versions when combined with `required-environments`</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/12782">#12782</a>
        opened by <a href="https://github.com/johnthagen">@johnthagen</a>
        on 2025-04-09 14:11
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/johnthagen">@johnthagen</a> on 2025-04-09 14:11</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>This <code>pyproject.toml</code></p>
<pre><code class="language-toml">[project]
name = &quot;test&quot;
version = &quot;1&quot;
requires-python = &quot;&gt;=3.11, &lt;3.12&quot;
dependencies = [
    &quot;open3d&quot;,
]

[tool.uv]
fork-strategy = &quot;fewest&quot;
required-environments = [
    &quot;sys_platform == 'linux' and platform_machine == 'aarch64'&quot;,
]
</code></pre>
<p>Locks <code>open3d</code> to</p>
<pre><code class="language-toml">[[package]]
name = &quot;open3d&quot;
version = &quot;0.18.0&quot;
source = { registry = &quot;https://pypi.org/simple&quot; }
resolution-markers = [
    &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot;,
]
dependencies = [
    { name = &quot;addict&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;configargparse&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;dash&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;matplotlib&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;nbformat&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;numpy&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;pandas&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;pillow&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;pyquaternion&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;pyyaml&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;scikit-learn&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;tqdm&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
    { name = &quot;werkzeug&quot;, marker = &quot;platform_machine == 'aarch64' and sys_platform == 'linux'&quot; },
]
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/c5/c7/97a2de0176cf9599aa76b3eb5c38943a4bc3e70ada824c8d5d6773108713/open3d-0.18.0-cp311-cp311-manylinux_2_27_aarch64.whl&quot;, hash = &quot;sha256:882f1e5039a3c1c5ec05183eb650537fd7431238b7ccb2b742ca5479f02f705b&quot;, size = 58431474 },
]

[[package]]
name = &quot;open3d&quot;
version = &quot;0.19.0&quot;
source = { registry = &quot;https://pypi.org/simple&quot; }
resolution-markers = [
    &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot;,
]
dependencies = [
    { name = &quot;addict&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;configargparse&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;dash&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;flask&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;matplotlib&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;nbformat&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;numpy&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;pandas&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;pillow&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;pyquaternion&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;pyyaml&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;scikit-learn&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;tqdm&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
    { name = &quot;werkzeug&quot;, marker = &quot;platform_machine != 'aarch64' or sys_platform != 'linux'&quot; },
]
wheels = [
    { url = &quot;https://files.pythonhosted.org/packages/a7/37/8d1746fcb58c37a9bd868fdca9a36c25b3c277bd764b7146419d11d2a58d/open3d-0.19.0-cp311-cp311-macosx_10_15_universal2.whl&quot;, hash = &quot;sha256:117702467bfb1602e9ae0ee5e2c7bcf573ebcd227b36a26f9f08425b52c89929&quot;, size = 103098641 },
    { url = &quot;https://files.pythonhosted.org/packages/bc/50/339bae21d0078cc3d3735e8eaf493a353a17dcc95d76bcefaa8edcf723d3/open3d-0.19.0-cp311-cp311-manylinux_2_31_x86_64.whl&quot;, hash = &quot;sha256:678017392f6cc64a19d83afeb5329ffe8196893de2432f4c258eaaa819421bb5&quot;, size = 447683616 },
    { url = &quot;https://files.pythonhosted.org/packages/a3/3c/358f1cc5b034dc6a785408b7aa7643e503229d890bcbc830cda9fce778b1/open3d-0.19.0-cp311-cp311-win_amd64.whl&quot;, hash = &quot;sha256:02091c309708f09da1167d2ea475e05d19f5e81dff025145f3afd9373cbba61f&quot;, size = 69151111 },
]
</code></pre>
<p>I was expecting that with <code>fork-strategy = &quot;fewest&quot;</code>, that <code>open3d</code> would be limited to the fewest numbers with the required Python (3.11) and required environments (Linux ARM64 included). Open3D 0.18.0 is the only single version that satisfies all the required python versions of platforms, but <code>uv</code> still locked both <code>0.18.0</code> and <code>0.19.0</code>.</p>
<p>What we'd like when using <code>&quot;fewest&quot;</code> is that the locked versions would minimize to only 0.18 for all platforms so that every environment is running/testing on the same version and that this version is compatible on all required platforms.</p>
<h3>Platform</h3>
<p>macOS 14 ARM64</p>
<h3>Version</h3>
<p>uv 0.6.13 (a0f5c7250 2025-04-07)</p>
<h3>Python version</h3>
<p>Python 3.11.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @johnthagen on 2025-04-09 14:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-04-10 14:04</div>
            <div class="timeline-body"><p>Yeah this makes sense. Thanks.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:33:04 UTC
    </footer>
</body>
</html>
