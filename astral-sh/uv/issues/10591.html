<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use versions from requirements.txt during `uv lock` - astral-sh/uv #10591</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use versions from requirements.txt during `uv lock`</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10591">#10591</a>
        opened by <a href="https://github.com/dionhaefner">@dionhaefner</a>
        on 2025-01-14 12:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/dionhaefner">@dionhaefner</a> on 2025-01-14 12:05</div>
            <div class="timeline-body"><p>Our current workflow looks like this:</p>
<ul>
<li>All direct dependencies are pinned in <code>requirements.txt</code> for reproducible installations (used during testing on CI and deployment).</li>
<li>Dependencies in <code>pyproject.toml</code> are unconstrained, so dev installations (via <code>pip install -e .</code>) always get the latest versions of all dependencies.</li>
<li>We have set up dependabot to bump versions in <code>requirements.txt</code> once per week to detect problems with new library releases and update deployment versions.</li>
</ul>
<p>How can we replicate the workflow above with uv, using lock files during CI and deployment for full reproducibility?</p>
<p>Since dependabot doesn't support uv lock files, I thought we'd likely want to keep <code>requirements.txt</code> as single-source truth for tried and tested versions of direct dependencies, then generate a lock file from that. But there seems to be no convenient way to go from <code>requirements.txt</code> -&gt; <code>uv.lock</code>?</p>
<p>Grateful for any input, including alternative solutions to implement something similar to what we currently have and general best practices.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-14 13:51</div>
            <div class="timeline-body"><p>Hmm, you would generally go the other way, and generate a <code>requirements.txt</code> from a <code>uv.lock</code> with <code>uv export</code>. I think what you could do is:</p>
<ul>
<li>Leave dependencies unconstrained in <code>pyproject.toml</code>.</li>
<li>Put the direct dependency pins in <code>tool.uv.constraint-dependencies</code> (in <code>pyproject.toml</code>).</li>
<li>Run <code>uv lock</code>, then <code>uv export</code>.</li>
</ul>
<p>But yeah, you'll lose some of the convenience of Dependabot until uv is supported.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @charliermarsh on 2025-01-14 13:51</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dionhaefner">@dionhaefner</a> on 2025-01-14 19:28</div>
            <div class="timeline-body"><p>Thanks for weighing in @charliermarsh. How do people typically implement similar patterns in a <code>uv</code>-native way? Would something like this make sense?</p>
<ol>
<li>Ditch the <code>requirements.txt</code> + dependabot entirely and just keep dependencies in <code>pyproject.toml</code> with loose constraints (for example, just a lenient lower bound) to get flexible dev setups.</li>
<li>Keep a <code>uv.lock</code> under version control that represents a fully reproducible environment that's known to be working (used for tests on CI and deployment).</li>
<li>Add a cron task that runs weekly and executes <code>uv sync</code> to bump <code>uv.lock</code>.</li>
<li>If there's an incompatibility discovered that way, exclude it from the supported versions in <code>pyproject.toml</code>.</li>
<li>~~Add <code>uv.lock</code> to <code>.gitignore</code> so devs don't accidentally push their local versions.~~</li>
<li>Optionally, also run <code>uv export</code> after (3) to create a <code>requirements.txt</code> for non-<code>uv</code> deployment.</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-14 19:33</div>
            <div class="timeline-body"><p>Until Dependabot support lands, you could switch to Renovate? We've been pretty happy with it here ü§∑‚Äç‚ôÄ</p>
<p>re. (3) You could run <code>uv lock --upgrade</code> to discover incompatible new versions, unless you are running tests against the versions (in which case you'll want <code>uv sync --upgrade</code>).
re. (5) I wouldn't add it to the <code>.gitignore</code>. The lockfile should be stable unless explicitly updated. In the Cargo/Rust ecosystem, it's not normal to need to ignore the <code>Cargo.lock</code> file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dionhaefner">@dionhaefner</a> on 2025-01-14 19:38</div>
            <div class="timeline-body"><p>Thanks, <code>uv sync --upgrade</code> is what I had in mind for (3) :)</p>
<p>Good pointer on (5), I guess the missing piece for me was that <code>uv sync</code> alone doesn't modify the lock file even if there have been new releases of deps in the meantime.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dionhaefner">@dionhaefner</a> on 2025-01-14 19:40</div>
            <div class="timeline-body"><p>Regarding (4) ‚Äì¬†would we exclude those versions from <code>[project.dependencies]</code> or from <code>[tool.uv.constraint-dependencies]</code>? I'm guessing the former if they are direct dependencies and the latter otherwise?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-14 19:55</div>
            <div class="timeline-body"><p>Yes that sounds correct re (4).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dionhaefner">@dionhaefner</a> on 2025-01-15 15:31</div>
            <div class="timeline-body"><p>Seems like that's going to work. Thanks all!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @dionhaefner on 2025-01-15 15:31</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/truonghm">@truonghm</a> on 2025-01-16 03:47</div>
            <div class="timeline-body"><p>Hi all, I have a similar question but with a different need: we were using uv but will the pip-tools interface (i.e. uv pip compile and uv pip sync) via a <code>requirements.txt</code> / <code>requirements-dev.txt</code> combination. We would like to move to using uv.lock instead, however we want to keep all package versions the same as in <code>requirements.txt</code>. I have try running <code>uv lock</code> and some of the packages would be upgraded as expected since those packages are unconstrained in <code>pyproject.toml</code>.</p>
<p>I figure this might be a common use case for people looking to move from older uv versions to newer ones with a more uv-native way of package management but want to keep it safe regarding package versions. Appreciate any suggestions for this, thank you!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 01:32:06 UTC
    </footer>
</body>
</html>
