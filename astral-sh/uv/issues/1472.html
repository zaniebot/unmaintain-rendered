<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv venv` overwrites existing virtual environment on subsequent run - astral-sh/uv #1472</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>`uv venv` overwrites existing virtual environment on subsequent run</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/1472">#1472</a>
        opened by <a href="https://github.com/Slyfest">@Slyfest</a>
        on 2024-02-16 10:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/Slyfest">@Slyfest</a> on 2024-02-16 10:14</div>
            <div class="timeline-body"><p><strong>Current behaviour</strong>: subsequent runs of <code>uv venv</code> overwrite the existing virtual environment.</p>
<p><strong>Suggested behaviour</strong>: How about adding a prompt like &quot;the virtual env is already created, confirm to recreate from scratch&quot;.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-16 14:47</div>
            <div class="timeline-body"><p>Thanks for the report, related https://github.com/astral-sh/uv/issues/1274</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "uv venv overwrites existing virtual environment on subsequent run" to "`uv venv` overwrites existing virtual environment on subsequent run" by @zanieb on 2024-02-16 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @zanieb on 2024-02-16 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-02-17 04:14</div>
            <div class="timeline-body"><p>I don't think we should delete them by default cc @charliermarsh</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">virtualenv</span> added by @zanieb on 2024-02-18 20:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2024-02-20 02:13</div>
            <div class="timeline-body"><p>For reference, the upstream <code>virtualenv</code> has a <code>--clear</code> flag, and when that's not set it will update the virtual environment and the seeded packages, but without touching anything else. This way, running without a <code>--clear</code> is essentially a repair option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flyaroundme">@flyaroundme</a> on 2024-02-21 18:06</div>
            <div class="timeline-body"><p>So, what do you think on the UX of this command? For me it also seems unintuitive when I am using <code>uv venv</code> and the existing env is overwritten with an empty one.
I propose a simple thing, like adding a <code>--clear</code> flag for <code>uv venv</code> command. if there is an existing venv and the flag is not set, then we simply do nothing. In other cases we preserve the old behaviour. What do you think?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Slyfest">@Slyfest</a> on 2024-02-21 18:10</div>
            <div class="timeline-body"><p>@flyaroundme that would definitely be a much less surprising behavior. Good suggestion!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gaborbernat">@gaborbernat</a> on 2024-02-21 19:12</div>
            <div class="timeline-body"><blockquote>
<p>if there is an existing venv and the flag is not set, then we simply do nothing.</p>
</blockquote>
<p>I'd imagine a better UX would be to fail hard and loud.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by @charliermarsh on 2024-03-18 20:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Artalus">@Artalus</a> on 2024-04-30 10:19</div>
            <div class="timeline-body"><p>+1 on &quot;fail hard and loud&quot; to avoid ambiguity - but then I believe <code>uv venv</code> should support both &quot;force keep&quot; and &quot;force clean&quot; workflows. F.x. I have been happily using <code>python -m venv</code> for the last few years somewhat like this:</p>
<pre><code class="language-bash">#  run `source ./project.sh` to get the project and environment for it up and running
export SOMETHING=something
python -m venv
source ./venv/bin/activate
python -m pip install -e .[dev]
</code></pre>
<p>, keeping the project and its deps in sync - but not wiping any additional tools if I have put there for some experiments. Yet I can easily imagine that one would like to wipe the existing venv instead.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-04-30 13:39</div>
            <div class="timeline-body"><p>Lots of ux discussion in https://github.com/astral-sh/uv/pull/2548</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/verveguy">@verveguy</a> on 2024-08-23 14:29</div>
            <div class="timeline-body"><p><code>uv venv --allow-existing</code> provides the desired behavior - don't recreate the venv every time.</p>
<p>Perhaps the question is whether the sense of the default should be inverted i.e. update existing by default, only replace if <code>--clear</code> is specified.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/janimo">@janimo</a> on 2024-09-11 13:37</div>
            <div class="timeline-body"><p>I find it very unusual for a cli tool to overwrite and existing directory by default, without warning or prompting.</p>
<p>Now I have learned this is the intended behavior, but the number of people reporting being confused by this suggests that some UI change would be helpful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-09-11 13:39</div>
            <div class="timeline-body"><p>I don't love the existing behavior, but, for what it's worth, this issue has about three upvotes and we see an order of magnitude more than that on issues that many people encounter.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/usetheforce">@usetheforce</a> on 2024-09-28 11:28</div>
            <div class="timeline-body"><p>+100 on &quot;fail hard and loud&quot;. Just lost a bunch of files because of this.
uv mimics pip's behaviour in many places, but not here -- where damage can be done really easily? python -m venv leaves any existing files in place (which are not part of the venv-local python).</p>
<p>I mean: what's the win in the current behaviour? Spare one rm -rf *?</p>
<p>uv is no doubt a brilliant tool and I love it. But PLEASE change this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kmalinich">@kmalinich</a> on 2024-10-10 22:22</div>
            <div class="timeline-body"><p>+10000 on fail hard and loud.</p>
<p>Because of this I accidentally grenaded my entire home assistant installation. Now my smart home is borderline useless. No heat, no lights, nothing; I have my whole house in there.</p>
<p>Yes I have backups, but I have to retrieve them and restoring them isn't an immediate process - meanwhile my baby is crying, my wife's pissed, the list goes on.</p>
<p>I've been a Linux engineer for close to a decade, in some high caliber environments - and I think I can count on one hand the times where I used a tool, with only one or two arguments, copied and pasted from the --help usage message, that automatically assumed that I wanted to completely blow away everything in the current directory, and was so confident in it, that it didn't even give me a simple &quot;You sure? [y/N]&quot; .</p>
<p>Maybe I just wanted to share my story, or just vent.. but damn man this one hurt.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2024-10-10 22:36</div>
            <div class="timeline-body"><p>@kmalinich -- Hey -- regardless of what decision we make here, just wanted to say that I can feel your frustration coming through and I'm really sorry that you ran into this in such a critical path. A lot for us to consider in your message.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kmalinich">@kmalinich</a> on 2024-10-11 00:44</div>
            <div class="timeline-body"><p>@charliermarsh -- I want you to know that your words meant a lot to me. Thank you. I'm all back up and running here, and I've calmed down a fair bit. Sorry about that, that was some pretty explosive messaging on my part.</p>
<p><code>uv</code> is an awesome tool, and I totally understand that I'm not using it in a way that matches a majority of its users, and that's a big part of what led to my situation occurring. Totally my fault.</p>
<p>Anyways, thanks again for the kind words. It's nice to .. just be heard, sometimes.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-10-11 02:17</div>
            <div class="timeline-body"><p>I'm down to change this in 0.5.0 ‚Äî but we'll need to discuss this as a team and figure out if there's consensus on a new ux.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vishnucoder1">@vishnucoder1</a> on 2024-12-28 09:37</div>
            <div class="timeline-body"><p>Started using uv and this default behaviour of overwriting the venvs is confusing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.6.0" by @zanieb on 2024-12-28 17:16</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2024-12-28 17:16</div>
            <div class="timeline-body"><p>Adding this to the 0.6.0 milestone so we consider it in the next breaking release.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/knirch">@knirch</a> on 2025-02-12 22:45</div>
            <div class="timeline-body"><blockquote>
<p>I don't love the existing behavior, but, for what it's worth, this issue has about three upvotes and we see an order of magnitude more than that on issues that many people encounter.</p>
</blockquote>
<p>As someone coming back from a hiatus, who typed uv venv in wrong window, got that non uv managed .venv nuked, and not fluent in github jargon; where do I upvote?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-02-12 22:48</div>
            <div class="timeline-body"><p>There's a üëç  at <img width="1072" alt="Image" src="https://github.com/user-attachments/assets/e7890a6d-511e-430e-829d-1a38b91ca6b8" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "v0.6.0" by @zanieb on 2025-02-15 02:34</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.7.0" by @zanieb on 2025-02-15 02:34</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cagdemir">@cagdemir</a> on 2025-02-19 07:41</div>
            <div class="timeline-body"><p>just nuked a virtual environment I created, interesting choice of behavior for uv venv</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dakota-hawkins">@dakota-hawkins</a> on 2025-03-04 15:25</div>
            <div class="timeline-body"><p>Just commenting to voice my support for &quot;hard and loud&quot; failing, and definitely <strong>not</strong> overwrite be default. Thanks for the great tool! It's really been a breeze to work with other than this small hiccup :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/chschroeder">@chschroeder</a> on 2025-03-09 09:55</div>
            <div class="timeline-body"><p>Same here. Just lost a venv due to this. Please don't override by default.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Sora233">@Sora233</a> on 2025-03-31 07:27</div>
            <div class="timeline-body"><p>surprised and end up here. it is confuseing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">breaking</span> added by @zanieb on 2025-04-01 21:32</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Removed from milestone "v0.7.0" by @zanieb on 2025-04-21 19:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone "v0.8.0" by @zanieb on 2025-04-21 19:15</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stevenae">@stevenae</a> on 2025-05-23 18:53</div>
            <div class="timeline-body"><p>Let's at least fix the documentation, which says it will do the opposite:</p>
<p>https://github.com/astral-sh/uv/pull/13624</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gsimard">@gsimard</a> on 2025-06-18 21:40</div>
            <div class="timeline-body"><p>Still not resolved ? People here are being extremely polite about this issue. I just nuked my environment as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to @jtfmumm by @jtfmumm on 2025-06-24 08:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Stefan-Heimersheim">@Stefan-Heimersheim</a> on 2025-07-03 17:17</div>
            <div class="timeline-body"><p>The silent overwrite seems very unexpected, just happened to me as well.</p>
<p>I've read through a few of the linked issues but I'm confused what the status on this issue is:</p>
<ul>
<li>What are the arguments for overwriting existing environments? (in particular previously-created uv environments)</li>
<li>I've seen various arguments against in this thread and others, generally deleting files without checking seems risky</li>
<li>Is this a breaking backwards compatibility issue (scripts using <code>uv venv</code> assuming it will overwrite without asking)?</li>
</ul>
<p>Are you looking for help (someone to make a PR?), more user input, or something else? Can I help?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-03 17:38</div>
            <div class="timeline-body"><p>The primary argument for overwriting environments is that it's aligned with other behaviors in uv, e.g., <code>uv sync -p 3.11</code> followed by <code>uv sync -p 3.12</code> will delete the <code>.venv</code> and reconstruct it. Philosophically, the virtual environment shouldn't have manually curated packages via imperative commands, it should be constructed from a declarative file and therefore the deletion of it is inconsequential. Of course, that's not how everyone works, which is why we're considering changing the behavior ‚Äî especially when you're using <code>uv venv</code> explicitly rather than through our implicit project commands.</p>
<p>Additionally, we've already shipped the overwrite behavior so there's a breaking backwards compatibility concern for existing users that rely on this behavior which we have no way to measure ‚Äî the rough metric is the number of üëç here which is significantly lower than other popular issues (though still in the top 25). We are generally <em>very</em> wary of releasing breaking changes that will cause users' workflows to fail.</p>
<p>Anyway, that's just to answer your bullets. There's a draft approach at</p>
<ul>
<li>https://github.com/astral-sh/uv/pull/14309</li>
</ul>
<p>which we're considering for the next breaking release. You can provide feedback on that approach if you'd like to help!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/stevenae">@stevenae</a> on 2025-07-03 17:40</div>
            <div class="timeline-body"><p>I would like to advocate for prominently documenting this behavior as a
compromise.</p>
<p>On Thu, Jul 3, 2025, 1:38‚ÄØPM Zanie Blue <em><strong>@</strong></em>.***&gt; wrote:</p>
<blockquote>
<p><em>zanieb</em> left a comment (astral-sh/uv#1472)
<a href="https://github.com/astral-sh/uv/issues/1472#issuecomment-3033051920">https://github.com/astral-sh/uv/issues/1472#issuecomment-3033051920</a></p>
<p>The primary argument for overwriting environments is that it's aligned
with other behaviors in uv, e.g., uv sync -p 3.11 followed by uv sync -p
3.12 will delete the .venv and reconstruct it. Philosophically, the
virtual environment shouldn't have manually curated packages via imperative
commands, it should be constructed from a declarative file and therefore
the deletion of it is inconsequential. Of course, that's not how everyone
works, which is why we're considering changing the behavior ‚Äî especially
when you're using uv venv explicitly rather than through our implicit
project commands.</p>
<p>Additionally, we've already shipped the overwrite behavior so there's a
breaking backwards compatibility concern for existing users that rely on
this behavior which we have no way to measure ‚Äî the rough metric is the
number of üëç here which is significantly lower than other popular issues
(though still in the top 25). We are generally <em>very</em> wary of releasing
breaking changes that will cause user's workflows to fail.</p>
<p>Anyway, that's just to answer your bullets. There's a draft approach at</p>
<ul>
<li>#14309 <a href="https://github.com/astral-sh/uv/pull/14309">https://github.com/astral-sh/uv/pull/14309</a></li>
</ul>
<p>which we're considering for the next breaking release. You can provide
feedback on that approach if you'd like to help!</p>
<p>‚Äî
Reply to this email directly, view it on GitHub
<a href="https://github.com/astral-sh/uv/issues/1472#issuecomment-3033051920">https://github.com/astral-sh/uv/issues/1472#issuecomment-3033051920</a>, or
unsubscribe
<a href="https://github.com/notifications/unsubscribe-auth/AAFZOHLDUB2Q7F2NWFLYML33GVTBLAVCNFSM6AAAAABDLYS7OOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTAMZTGA2TCOJSGA">https://github.com/notifications/unsubscribe-auth/AAFZOHLDUB2Q7F2NWFLYML33GVTBLAVCNFSM6AAAAABDLYS7OOVHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZTAMZTGA2TCOJSGA</a>
.
You are receiving this because you are subscribed to this thread.Message
ID: <em><strong>@</strong></em>.***&gt;</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YodaEmbedding">@YodaEmbedding</a> on 2025-07-15 04:02</div>
            <div class="timeline-body"><p>The current <code>uv venv</code> is also inconsistent w.r.t. symlinks. Three separate behaviors depending on directory state:</p>
<hr />
<p>If symlinked directory does not exist:</p>
<pre><code class="language-bash">Œª rm -rf .venv
Œª ln -rs ~/.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot; .venv

Œª uv venv
Using CPython 3.8.20
Creating virtual environment at: .venv
uv::venv::creation

  √ó Failed to create virtualenv
  ‚ï∞‚îÄ‚ñ∂ failed to create directory `$PWD/.venv`: File exists (os error 17)
</code></pre>
<hr />
<p>If symlinked directory exists:</p>
<pre><code class="language-bash">Œª rm -rf .venv
Œª ln -rs ~/.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot; .venv
Œª mkdir ~/.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot;

Œª uv venv
Using CPython 3.8.20
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate

Œª ls -la .venv
lrwxr-xr-x 1 user group 54 2025-07-14 00:00:00 .venv -&gt; ../../../.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot;

# Yay!
</code></pre>
<hr />
<p>If symlinked directory exists, but <code>uv venv</code> is run <em>twice</em>:</p>
<pre><code class="language-bash">Œª rm -rf .venv
Œª ln -rs ~/.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot; .venv
Œª mkdir ~/.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot;

Œª uv venv
Using CPython 3.8.20
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate

Œª ls -la .venv
lrwxr-xr-x 1 user group 54 2025-07-14 00:00:00 .venv -&gt; ../../../.local/state/uv/virtualenvs/&quot;${PWD##*/}&quot;

Œª uv venv
Using CPython 3.8.20
Creating virtual environment at: .venv
Activate with: source .venv/bin/activate

Œª ls -la .venv
total 12K
drwxr-xr-x  7 user group  224 2025-07-14 20:56:17 .
drwxr-xr-x 35 user group 1.1K 2025-07-14 20:56:17 ..
drwxr-xr-x 14 user group  448 2025-07-14 20:56:17 bin
drwxr-xr-x  3 user group   96 2025-07-14 20:56:17 lib
-rw-r--r--  1 user group    1 2025-07-14 20:56:17 .gitignore
-rw-r--r--  1 user group   43 2025-07-14 20:56:17 CACHEDIR.TAG
-rw-r--r--  1 user group  211 2025-07-14 20:56:17 pyvenv.cfg

# Destroyed the symlink?!
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-07-16 17:39</div>
            <div class="timeline-body"><p>@YodaEmbedding please open a new issue so we can discuss it independently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-07-17 22:20</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-10 03:34:55 UTC
    </footer>
</body>
</html>
