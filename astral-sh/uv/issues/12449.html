<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>exclude-newer should have an extra flag to allow it to skip over packages that don't have publish date information. - astral-sh/uv #12449</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>exclude-newer should have an extra flag to allow it to skip over packages that don&#x27;t have publish date information.</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/astral-sh/uv/issues/12449">#12449</a>
        opened by <a href="https://github.com/anrooo">@anrooo</a>
        on 2025-03-24 19:57
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/anrooo">@anrooo</a></div>
            <div class="timeline-body">Summary
<p>Today the utility of this flag is greatly diminished as if any of your packages don&#x27;t have publish data it will fail to update requirements.</p>
Example
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/anrooo">@anrooo</a> on 2025-03-24 19:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-24 20:13</div>
            <div class="timeline-body"><p>The flag is intended for reproducible builds, and it does not accomplish its intent if it can install arbitrary packages.</p>
<p>We could definitely consider adding a flag for this, but that&#x27;s the reason it&#x27;s not that way today.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">configuration</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-03-24 20:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/herebebeasties">@herebebeasties</a> on 2025-03-24 21:07</div>
            <div class="timeline-body"><blockquote>
<p>The flag is intended for reproducible builds, and it does not accomplish its intent if it can install arbitrary packages.</p>
<p>We could definitely consider adding a flag for this, but that&#x27;s the reason it&#x27;s not that way today.</p>
</blockquote>
<p>Although I understand the rationale behind that, one typically (hopefully) only needs this to work around things for a single package or two in situations like today&#x27;s setuptools 78.0.1 fiasco, where you might reasonably expect the deps in question to be pinned / reproducible anyway (e.g. torch).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/anrooo">@anrooo</a> on 2025-03-25 02:12</div>
            <div class="timeline-body"><p>I&#x27;m on the fence after hearing your feedback. It seems if we fix the <code>build-constraint-dependencies</code> propagation for <code>uv sycn</code> we&#x27;ll have the right lever of control to fix issues like the <code>setuptools</code> regression and keep CI systems happy, which is what I&#x27;m really after here.</p>
<p>It&#x27;s unfortunate that packages don&#x27;t all have publish dates available. The vast majority do, but a single bad package spoils the entire process. <code>--exclude-newer-non-strict</code> is a mouthful but would do the job. I&#x27;ll leave it up to y&#x27;all if you feel this usability change would be in line with the direction you want the project to take!</p>
<p>Thanks for engaging!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2025-03-25 02:30</div>
            <div class="timeline-body"><blockquote>
<p>It&#x27;s unfortunate that packages don&#x27;t all have publish dates available. The vast majority do, but a single bad package spoils the entire process.</p>
</blockquote>
<p>All packages on PyPI have an upload date, the issue is most third party indexes (torch, internal artifactory indexes, Azure etc.) don&#x27;t support the required standards.</p>
<p>https://packaging.python.org/en/latest/specifications/simple-repository-api/#project-detail (the <code>upload-time</code> field).</p>
<p>It would be good if there would be people who reached out to the relevant indexes to request support, it would make a better Python ecosystem if such indexes would follow or interact with the standards process.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-25 13:18</div>
            <div class="timeline-body"><p>Yeah, the &quot;real&quot; fix here, I think, is to fix <code>uv sync</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sanmai-NL">@sanmai-NL</a> on 2025-03-26 08:38</div>
            <div class="timeline-body"><p>GitLab Package Registry also appears not to support it ... A single distribution package we depend on is published there. We need to publish it outside PyPI for it to remain private, which <a href="https://pypi.org/help/#private-indices">isn&#x27;t supported by PyPI</a>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-26 13:12</div>
            <div class="timeline-body"><p>One thing to note is that there is no support for upload times in the HTML API (IIRC). So if you&#x27;re trying to see if a registry supports it, you need to query via the JSON API.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bradbeattie">@bradbeattie</a> on 2025-09-18 14:28</div>
            <div class="timeline-body"><p>As an alternative, consider an <code>exclude-newer</code> flag that can be placed on <code>tool.uv.index</code> entries. That way you could exclude newer packages from public registries like pypi, while also permitting unrestricted packages from your private package registry.</p>
<p>I suspect that might satisfy most use cases here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-09-18 14:39</div>
            <div class="timeline-body"><p>That sounds nice to me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ncoghlan">@ncoghlan</a> on 2025-10-14 15:24</div>
            <div class="timeline-body"><p>I just ran into this with the custom <code>torch</code> registries. Since <code>torch</code> is explicitly pinned in my use case (and I use <code>sources</code>, so it&#x27;s the <em>only</em> package retrieved from the custom registry), a <code>supports-exclude-newer = false</code> option in the relevant <code>tool.uv.index</code> entries would definitely work as a resolution.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:37:57 UTC
    </footer>
</body>
</html>
