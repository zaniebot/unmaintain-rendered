<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv add --update-constraint flag or update current upgrade flag - astral-sh/uv #17029</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv add --update-constraint flag or update current upgrade flag</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/17029">#17029</a>
        opened by <a href="https://github.com/ThomasLamalle">@ThomasLamalle</a>
        on 2025-12-08 10:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/ThomasLamalle">@ThomasLamalle</a> on 2025-12-08 10:52</div>
            <div class="timeline-body"><h3>Summary</h3>
<p>Summary:
Add a flag to uv add that updates the version constraint in pyproject.toml when upgrading a package to the latest available version.</p>
<p>Current Behavior:
When using uv add --upgrade package, uv resolves and installs the latest compatible version and updates uv.lock, but does not update the version constraint in pyproject.toml. The declared constraint remains unchanged (e.g., package &gt;= 0.5.3 even though 0.6.3 is now installed).</p>
<p>This creates a mismatch between:</p>
<p>The declared constraint in pyproject.toml  (what developers see)
The actual version in uv.lock (what's being used)
Desired Behavior:
Option 1: Add a new flag like uv add --upgrade --update-constraint package that would:</p>
<p>Resolve to the latest version available
Update uv.lock with the new version
Update pyproject.toml to reflect the new constraint (e.g., &gt;= 0.6.3)</p>
<p>Option 2: Update the existing --upgrade flag behavior to also modify pyproject.toml by default:</p>
<p>When uv add --upgrade package is used, automatically update the version constraint in pyproject.toml to match the resolved version, not just uv.lock
This would make the behavior more intuitive and consistent with the user's intent to upgrade</p>
<p>Option 3: Add a new command like uv update package that does this by default, as a more explicit way to update both files.</p>
<p>Use Case:
When explicitly upgrading a dependency to its latest version, developers want pyproject.toml to reflect this intent, ensuring the constraint stays current and prevents accidental downgrades in future installations.</p>
<p>Current Workaround:
Manual editing of pyproject.toml or using uv add 'package&gt;=0.6.3' (requires knowing the exact version).</p>
<h3>Example</h3>
<p><em>No response</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @ThomasLamalle on 2025-12-08 10:52</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-12-13 03:04</div>
            <div class="timeline-body"><p>Ah yeah, unfortunately <code>uv add</code> doesn't upgrade existing bounds right now. I think it'd be best to track https://github.com/astral-sh/uv/issues/6794 -- we want to add a dedicated uv upgrade command or flow, it's on the near-term roadmap.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @charliermarsh on 2025-12-13 03:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-12-13 03:04</div>
            <div class="timeline-body"><p>(Agree we need this, just merging with https://github.com/astral-sh/uv/issues/6794.)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:35:06 UTC
    </footer>
</body>
</html>
