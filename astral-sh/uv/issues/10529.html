<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Failed to Build pyaudio - astral-sh/uv #10529</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Failed to Build pyaudio</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/10529">#10529</a>
        opened by <a href="https://github.com/Runelaron">@Runelaron</a>
        on 2025-01-12 00:03
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Runelaron">@Runelaron</a></div>
            <div class="timeline-body"><p>cc cmd not found when building pyaudio from source.</p>
<pre><code>
  × Failed to build `pyaudio==0.2.14`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta.build_wheel` failed (exit status: 1)

      [stdout]
      running bdist_wheel
      running build
      running build_py
      copying src/pyaudio/__init__.py -&gt; build/lib.linux-x86_64-cpython-312/pyaudio
      running build_ext
      building &#x27;pyaudio._portaudio&#x27; extension
      cc -pthread -fno-strict-overflow -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -I/usr/local/include -I/usr/include -I/home/.cache/uv/builds-v0/.tmp4odXqs/include
      -I/home/.local/share/uv/python/cpython-3.12.8-linux-x86_64-gnu/include/python3.12 -c src/pyaudio/device_api.c -o build/temp.linux-x86_64-cpython-312/src/pyaudio/device_api.o

      [stderr]
      error: command &#x27;cc&#x27; failed: No such file or directory

      hint: This usually indicates a problem with the package or the build environment.
  help: `pyaudio` (v0.2.14) was included because `realtimetts` (v0.1.0) depends on `pyaudio`
</code></pre>
<p>It seems pyaudio is unique and required portaudio.sh to be pulled in when build from source.</p>
<pre><code> pip install --use-pep517 &#x27;pyaudio==0.2.14&#x27;
Collecting pyaudio==0.2.14
  Downloading PyAudio-0.2.14.tar.gz (47 kB)
  Installing build dependencies ... done
  Getting requirements to build wheel ... done
  Preparing metadata (pyproject.toml) ... done
Building wheels for collected packages: pyaudio
  Building wheel for pyaudio (pyproject.toml) ... error
  error: subprocess-exited-with-error
  
  × Building wheel for pyaudio (pyproject.toml) did not run successfully.
  │ exit code: 1
  ╰─&gt; [14 lines of output]
      running bdist_wheel
      running build
      running build_py
      creating build/lib.linux-x86_64-cpython-312/pyaudio
      copying src/pyaudio/__init__.py -&gt; build/lib.linux-x86_64-cpython-312/pyaudio
      running build_ext
      building &#x27;pyaudio._portaudio&#x27; extension
      creating build/temp.linux-x86_64-cpython-312/src/pyaudio
      cc -pthread -fno-strict-overflow -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fPIC -fPIC -I/usr/local/include -I/usr/include -I/home/rune/code/packs/.venv/include -I/home/rune/.local/share/uv/python/cpython-3.12.8-linux-x86_64-gnu/include/python3.12 -c src/pyaudio/device_api.c -o build/temp.linux-x86_64-cpython-312/src/pyaudio/device_api.o
      src/pyaudio/device_api.c:9:10: fatal error: portaudio.h: No such file or directory
          9 | #include &quot;portaudio.h&quot;
            |          ^~~~~~~~~~~~~
      compilation terminated.
      error: command &#x27;/usr/bin/cc&#x27; failed with exit code 1
      [end of output]
  
  note: This error originates from a subprocess, and is likely not a problem with pip.
  ERROR: Failed building wheel for pyaudio
Failed to build pyaudio
ERROR: ERROR: Failed to build installable wheels for some pyproject.toml based projects (pyaudio)
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-01-12 00:59</div>
            <div class="timeline-body"><p>I&#x27;m slightly confused -- this is on the same machine? Why is <code>cc</code> not found?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Runelaron">@Runelaron</a> on 2025-01-12 01:10</div>
            <div class="timeline-body"><p>I investigated further using the UV build troubleshooting here.
https://docs.astral.sh/uv/reference/build_failures/#header-or-library-is-missing</p>
<p>For some reason it is not reporting the full callback saying that portaudio.h is missing which requires  portaudio19-dev.</p>
<p>I think the solution is to inform the user that this dependency does not exist if UV will always strict build from source.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-12 01:13</div>
            <div class="timeline-body"><p>These failures are different, i.e., in the first one it fails missing <code>cc</code> which is very surprising. We&#x27;ll need more details to determine why that happened.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-12 01:17</div>
            <div class="timeline-body"><p>My attempt to reproduce encounters the expected missing header error</p>
<pre><code>❯ docker run -it ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt-get update &amp;&amp; apt-get install -y python3-dev &amp;&amp; uv venv &amp;&amp; uv pip install pyaudio==0.2.14&quot;
...
  x Failed to build `pyaudio==0.2.14`
  |-&gt; The build backend returned an error
  `-&gt; Call to `setuptools.build_meta.build_wheel` failed (exit status: 1)

      [stdout]
      running bdist_wheel
      running build
      running build_py
      creating build/lib.linux-aarch64-cpython-311/pyaudio
      copying src/pyaudio/__init__.py -&gt; build/lib.linux-aarch64-cpython-311/pyaudio
      running build_ext
      building &#x27;pyaudio._portaudio&#x27; extension
      creating build/temp.linux-aarch64-cpython-311/src/pyaudio
      aarch64-linux-gnu-gcc -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong
      -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/usr/local/include -I/usr/include
      -I/root/.cache/uv/builds-v0/.tmpyeUlzO/include -I/usr/include/python3.11 -c src/pyaudio/device_api.c -o
      build/temp.linux-aarch64-cpython-311/src/pyaudio/device_api.o

      [stderr]
      src/pyaudio/device_api.c:9:10: fatal error: portaudio.h: No such file or directory
          9 | #include &quot;portaudio.h&quot;
            |          ^~~~~~~~~~~~~
      compilation terminated.
      error: command &#x27;/usr/bin/aarch64-linux-gnu-gcc&#x27; failed with exit code 1

      hint: This error likely indicates that you need to install a library that provides &quot;portaudio.h&quot; for `pyaudio@0.2.14`
</code></pre>
<p>We already have a hint for this error — and the error is from the downstream package not uv.</p>
<p>Please share a minimal reproduction as described in #9452</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-12 01:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">needs-mre</span> added by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-12 01:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Runelaron">@Runelaron</a> on 2025-01-12 01:55</div>
            <div class="timeline-body"><p>Reproduction in the initial fail.</p>
<pre><code>git clone https://github.com/KoljaB/RealtimeTTS.git
cd RealtimeTTS
uv init --python=3.12
source .venv/bin/activate
uv add -r requirements.txt
</code></pre>
<p>in the test</p>
<pre><code>uv venv -p 3.13 --seed
source .venv/bin/activate
pip install --use-pep517 &#x27;pyaudio=0.2.14&#x27;
</code></pre>
<p>The only major difference is the use of -r requirements.txt
It is quite odd, once I did the test I realized it was just a dependency error but of course at first I double checked if GCC was installed and it returned gcc is already the newest version (4:13.2.0-7ubuntu1)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-12 06:10</div>
            <div class="timeline-body"><p>If I try that..</p>
<pre><code>FROM ghcr.io/astral-sh/uv:bookworm

RUN git clone https://github.com/KoljaB/RealtimeTTS.git
WORKDIR RealtimeTTS
RUN uv init --python=3.12
RUN uv add -r requirements.txt
</code></pre>
<p>I get a different error</p>
<pre><code> &gt; [5/5] RUN uv add -r requirements.txt:                                                                                     
2.878 Using CPython 3.12.8                                                                                                   
2.879 Creating virtual environment at: .venv                                                                                 
7.039   × No solution found when resolving dependencies for split                                                            
7.039   │ (python_full_version == &#x27;3.13.*&#x27;):                                                                                 
7.044   ╰─▶ Because only the following versions of numpy{python_full_version ==
7.044       &#x27;3.13.*&#x27;} are available:
7.044           numpy{python_full_version == &#x27;3.13.*&#x27;}&lt;=2.1.3
7.044           numpy{python_full_version == &#x27;3.13.*&#x27;}==2.2.0
7.044           numpy{python_full_version == &#x27;3.13.*&#x27;}==2.2.1
7.044       and all versions of monotonic-alignment-search depend on
7.044       numpy{python_full_version == &#x27;3.13.*&#x27;}&gt;=2.1.3, we can conclude that all
7.044       versions of monotonic-alignment-search depend on numpy&gt;=2.1.3.
7.044       And because coqui-tts==0.25.1 depends on monotonic-alignment-search, we
7.044       can conclude that coqui-tts==0.25.1 depends on numpy&gt;=2.1.3.
7.044       And because coqui-tts==0.25.1 depends on numpy&gt;=1.25.2,&lt;2.0 and
7.044       your project depends on coqui-tts==0.25.1, we can conclude that your
7.044       project&#x27;s requirements are unsatisfiable.
7.044   help: If you want to add the package regardless of the failed resolution,
7.044         provide the `--frozen` flag to skip locking and syncing.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/samypr100">@samypr100</a> on 2025-01-12 23:30</div>
            <div class="timeline-body"><p>Assuming this is on ubuntu, this looks like missing portaudio headers on the host system. Using @zanieb&#x27;s command on Ubuntu as an example, you would need the <code>portaudio19-dev</code> system package.</p>
<p>e.g. <code>docker run -it ghcr.io/astral-sh/uv:bookworm /bin/bash -c &quot;apt-get update &amp;&amp; apt-get install -y python3-dev portaudio19-dev &amp;&amp; uv venv &amp;&amp; uv pip install pyaudio==0.2.14&quot;</code> should work.</p>
<p>Related to <code>CC</code> not found, that likely meant you didn&#x27;t have any build tooling packages installed on your first attempt such as <code>build-essential</code>.</p>
<p>The <a href="https://github.com/CristiFati/pyaudio/blob/master/setup.py">pyaudio/setup.py</a> looks in <code>/usr/local/include</code>, <code>/usr/include</code> for these headers on linux. It does not bundle them as part of the package.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Runelaron">@Runelaron</a> on 2025-01-14 02:51</div>
            <div class="timeline-body"><p>I thought the 3.13 error was due to pinning, and attempting to solve across multiple versions.</p>
<p>I will see if I can reproduce it, but if I can&#x27;t I will close it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/vladartym">@vladartym</a> on 2025-01-14 20:11</div>
            <div class="timeline-body"><p>I got the similar error on my m3 macbook.
I needed to run <code>brew install portaudio</code> and then <code>uv sync</code> worked.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanarlian">@evanarlian</a> on 2025-01-17 06:55</div>
            <div class="timeline-body"><p>I also got the similar problem, but it says <code>-fdebug-default-version=4</code> is not recognized by cc.</p>
<pre><code>uv add pyaudio
</code></pre>
<pre><code>Resolved 2 packages in 1ms
  × Failed to build `pyaudio==0.2.14`
  ├─▶ The build backend returned an error
  ╰─▶ Call to `setuptools.build_meta.build_wheel` failed (exit status: 1)

      [stdout]
      running bdist_wheel
      running build
      running build_py
      copying src/pyaudio/__init__.py -&gt; build/lib.linux-x86_64-cpython-312/pyaudio
      running build_ext
      building &#x27;pyaudio._portaudio&#x27; extension
      cc -pthread -fno-strict-overflow -Wsign-compare -Wunreachable-code -DNDEBUG -g -O3 -Wall -fdebug-default-version=4 -fPIC -I/tools/deps/include
      -I/tools/deps/include/ncursesw -I/tools/deps/libedit/include -fPIC -I/usr/local/include -I/usr/include -I/home/evan/.cache/uv/builds-v0/.tmptDANQm/include
      -I/home/evan/.local/share/uv/python/cpython-3.12.0-linux-x86_64-gnu/include/python3.12 -c src/pyaudio/device_api.c -o build/temp.linux-x86_64-cpython-312/src/pyaudio/device_api.o

      [stderr]
      cc: error: unrecognized command-line option ‘-fdebug-default-version=4’
      error: command &#x27;/usr/bin/cc&#x27; failed with exit code 1

      hint: This usually indicates a problem with the package or the build environment.
  help: `pyaudio` (v0.2.14) was included because `audiotest` (v0.1.0) depends on `pyaudio`
</code></pre>
<p>More info:</p>
<ul>
<li>Tried using pip and conda, they are both fine.</li>
<li>I have portaudio on my system using <code>sudo apt install portaudio19-dev</code>.</li>
<li>I have cc installed.</li>
</ul>
<hr>
<p><strong>Update:</strong> I managed to &quot;solve&quot; this by using python=3.11 instead of python=3.12</p>
<pre><code>uv init --python=3.11
uv add pyaudio
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-21 18:28</div>
            <div class="timeline-body"><p>@evanarlian What does <code>cc</code> refer to? With standard Python distributions, usually <code>gcc</code> is used, but for ours we use <code>cc</code> which could point to a different compiler backend. You might get past the error by setting <code>CC=gcc</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-01-21 18:43</div>
            <div class="timeline-body"><p>Does the error also fail when using <code>pip install</code>, or only with uv?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/evanarlian">@evanarlian</a> on 2025-01-22 16:32</div>
            <div class="timeline-body"><p>@zanieb <code>cc</code> refers to <code>/usr/bin/x86_64-linux-gnu-gcc-11</code>, which is also what <code>gcc</code> points to.</p>
<p>@konstin <code>pip</code> and <code>conda</code> install are fine, only with <code>uv</code>. The funny thing is I tried to replicate this issue on my local PC, and even on cloud VMs, but it seems to be fine now. I can&#x27;t reproduce this currently.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Runelaron">@Runelaron</a> on 2025-01-25 14:18</div>
            <div class="timeline-body"><p>I have not been able to reproduce it either on the system. The only rational I can find, is depending on what pyaudio is looking for/missing, the error returned for that specific misconfiguration.</p>
<p>Not sure if the error should be clearer to convey that UV is trying to build from wheel specifically and that the wheel is missing a dependency, or just refer to this thread.</p>
<p>For now:</p>
<p>&quot;UV builds from source , ensure missing dependencies in trace are resolved&quot;</p>
<p>CC &amp; GCC - Debian
<code>apt install build-essential </code></p>
<p>Port Audio
Mac:
<code>brew install portaudio</code></p>
<p>Debian:
<code>apt-get install portaudio19-dev python-all-dev </code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/Runelaron">@Runelaron</a> on 2025-01-25 14:18</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/zanieb">@zanieb</a> on 2025-01-25 16:53</div>
            <div class="timeline-body"><blockquote>
<p>Not sure if the error should be clearer to convey that UV is trying to build from wheel using CC specifically and that the wheel is missing a dependency, or just refer to this thread.</p>
</blockquote>
<p>This is specific to each package and depends how their build is configured — we do not control if they use <code>CC</code> or whatever. <em>Some</em> builds use the same compiler that CPython was built with, hence using <code>cc</code> when using one of our Python distributions.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:36:37 UTC
    </footer>
</body>
</html>
