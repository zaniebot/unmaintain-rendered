```yaml
number: 12548
title: Why all optional dependencies need exist when create lock file?
type: issue
state: closed
author: ryomahan
labels:
  - question
assignees: []
created_at: 2025-03-29T19:59:30Z
updated_at: 2025-03-30T15:00:46Z
url: https://github.com/astral-sh/uv/issues/12548
synced_at: 2026-01-10T01:57:28Z
```

# Why all optional dependencies need exist when create lock file?

---

_Issue opened by @ryomahan on 2025-03-29 19:59_

### Question

## case

1. use pdm
```toml
[project.optional-dependencies]
local = [
    "base @ file:///${PROJECT_ROOT}/../path/to/a/local/package1",
]
online = [
    "base @ file:///${PROJECT_ROOT}/../path/to/a/local/package2",
]
```
when I run `pdm install -dG local`, it can be installed successful even if `file:///${PROJECT_ROOT}/../path/to/a/local/package2` doesn't exist;

2. use uv
```toml
[dependency-groups]
local = [
    "base @ file:///path/to/a/local/package1",
]
online = [
    "base @ file:///path/to/a/local/package2",
]

[tool.uv]
conflicts = [
    [
      { group = "local" },
      { group = "online" },
    ],
]
```

when I run `uv sync --group local`, it can't be installed successful, if `file:///path/to/a/local/package2` doesn't exist. I will get a error like this:

```shell
error: Distribution not found at: file:///path/to/a/local/package2
```

## question

I saw both pdm and uv's source code, I find when pdm create lock file, it will pass `group` arg to the create lock file's method, but uv don't.

Whatâ€™s the reason for this difference? Why all optional dependencies need exist when create lock file?

## thinking 

Even if I have `file:///path/to/a/local/package2` and create lock file successful in my computer. But when I run `uv sync --group local` in another computer, `file:///path/to/a/local/package1` or `file:///path/to/a/local/package2` may also be missing. So what's the purpose of making sure all optional dependencies exist when create lock file.

### Platform

_No response_

### Version

_No response_

---

_Label `question` added by @ryomahan on 2025-03-29 19:59_

---

_Renamed from "Why all dependencies need exist when create lock file?" to "Why all optional dependencies need exist when create lock file?" by @ryomahan on 2025-03-29 20:02_

---

_Comment by @charliermarsh on 2025-03-30 15:00_

You can run with `--frozen` if you want to avoid validating the lockfile (and _just_ install from it). By default, we ensure that the lockfile is up-to-date with your stated dependencies.

---

_Closed by @charliermarsh on 2025-03-30 15:00_

---

_Assigned to @charliermarsh by @charliermarsh on 2025-03-30 15:00_

---
