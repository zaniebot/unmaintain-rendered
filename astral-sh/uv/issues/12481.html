<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`uv sync` remove custom installed packages - astral-sh/uv #12481</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>uv sync</code> remove custom installed packages</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/12481">#12481</a>
        opened by <a href="https://github.com/neolee">@neolee</a>
        on 2025-03-26 10:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/neolee">@neolee</a></div>
            <div class="timeline-body">Summary
<p>Sometime we will install custom packages (wheels) in our project. For example I&#x27;m trying <a href="https://github.com/explosion/spaCy">spacy</a> for text tokenization and splitting. This <code>spacy</code> requires installing language models (wheels from their repo). Something like:</p>
<pre><code>.venv ❯ uv run spacy download en_core_web_sm 
Collecting en-core-web-sm==3.8.0
  Downloading https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.8.0/en_core_web_sm-3.8.0-py3-none-any.whl (12.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.8/12.8 MB 15.0 MB/s eta 0:00:00
Installing collected packages: en-core-web-sm
Successfully installed en-core-web-sm-3.8.0
✔ Download and installation successful
You can now load the package via spacy.load(&#x27;en_core_web_sm&#x27;)

.venv ❯ uv run spacy download zh_core_web_sm 
Collecting zh-core-web-sm==3.8.0
  Downloading https://github.com/explosion/spacy-models/releases/download/zh_core_web_sm-3.8.0/zh_core_web_sm-3.8.0-py3-none-any.whl (48.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 48.5/48.5 MB 14.1 MB/s eta 0:00:00
Collecting spacy-pkuseg&lt;2.0.0,&gt;=1.0.0 (from zh-core-web-sm==3.8.0)
  Using cached spacy_pkuseg-1.0.0-cp311-cp311-macosx_15_0_arm64.whl
Requirement already satisfied: numpy&lt;3.0.0,&gt;=2.0.0 in ./.venv/lib/python3.11/site-packages (from spacy-pkuseg&lt;2.0.0,&gt;=1.0.0-&gt;zh-core-web-sm==3.8.0) (2.2.4)
Requirement already satisfied: srsly&lt;3.0.0,&gt;=2.3.0 in ./.venv/lib/python3.11/site-packages (from spacy-pkuseg&lt;2.0.0,&gt;=1.0.0-&gt;zh-core-web-sm==3.8.0) (2.5.1)
Requirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.3 in ./.venv/lib/python3.11/site-packages (from srsly&lt;3.0.0,&gt;=2.3.0-&gt;spacy-pkuseg&lt;2.0.0,&gt;=1.0.0-&gt;zh-core-web-sm==3.8.0) (2.0.10)
Installing collected packages: spacy-pkuseg, zh-core-web-sm
Successfully installed spacy-pkuseg-1.0.0 zh-core-web-sm-3.8.0
✔ Download and installation successful
You can now load the package via spacy.load(&#x27;zh_core_web_sm&#x27;)
</code></pre>
<p>As you can see in the above for English and Chinese language, <code>spacy</code> download three wheels and install them in my project virtual env.</p>
<p>Now the problem is, all these packages are not registered in the <code>pyproject.toml</code> file. Next time I run <code>uv sync</code> they will be removed automatically.</p>
<pre><code>.venv ❯ uv sync
Resolved 164 packages in 0.35ms
Uninstalled 3 packages in 9ms
 - en-core-web-sm==3.8.0 (from https://github.com/explosion/spacy-models/releases/download/en_core_web_sm-3.8.0/en_core_web_sm-3.8.0-py3-none-any.whl)
 - spacy-pkuseg==1.0.0
 - zh-core-web-sm==3.8.0 (from https://github.com/explosion/spacy-models/releases/download/zh_core_web_sm-3.8.0/zh_core_web_sm-3.8.0-py3-none-any.whl)
</code></pre>
<p>Any suggestion about this issue?</p>
<p>p.s. I know the <code>--inexact</code> opt can prevent <code>uv</code> from cleaning unknown packages but if I would like to choose specific extra packages to keep and still want the auto cleaning feature of &#x27;uv&#x27;, how can I do?</p>
Platform
<p>macOS 15.3.2 arm64</p>
Version
<p>uv 0.6.9 (Homebrew 2025-03-20)</p>
Python version
<p>Python 3.11.11</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/neolee">@neolee</a> on 2025-03-26 10:26</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-26 12:33</div>
            <div class="timeline-body"><p>Unfortunately there’s no support for this beyond the inexact flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-26 12:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/charliermarsh">@charliermarsh</a> on 2025-03-26 12:33</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/neolee">@neolee</a> on 2025-03-26 16:04</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ph34tur3">@ph34tur3</a> on 2025-05-09 10:46</div>
            <div class="timeline-body"><p>@charliermarsh :
Would it be possible to derive a feature request from this question?
I would really appreciate if uv could keep track of this or if it was possible to exclude specific packages from clean up while also still supporting automatic removal of unused dependencies.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:37:58 UTC
    </footer>
</body>
</html>
