```yaml
number: 11920
title: "how to add deps who only supports `setup.py`. e.g. nvidia/Megatron-LM"
type: issue
state: closed
author: pplmx
labels:
  - question
assignees: []
created_at: 2025-03-03T06:58:42Z
updated_at: 2025-07-24T01:38:34Z
url: https://github.com/astral-sh/uv/issues/11920
synced_at: 2026-01-10T01:57:27Z
```

# how to add deps who only supports `setup.py`. e.g. nvidia/Megatron-LM

---

_Issue opened by @pplmx on 2025-03-03 06:58_

### Question

As title

### Platform

_No response_

### Version

_No response_

---

_Label `question` added by @pplmx on 2025-03-03 06:58_

---

_Comment by @konstin on 2025-03-03 11:18_

Can you share a minimal example of what you did and the complete logs of the error, as explained in #9452?

---

_Comment by @pplmx on 2025-03-04 02:34_

The installation of [nvidia/Megatron-LM](https://github.com/NVIDIA/Megatron-LM) only supports `setup.py` (i.e., `python setup.py install`). I'm unsure how to add this dependency to my project using `uv`, so I don't even have a minimal exampleâ€”it's nonexistent.

---

_Comment by @pplmx on 2025-03-04 02:40_

> The installation of [nvidia/Megatron-LM](https://github.com/NVIDIA/Megatron-LM) only supports `setup.py` (i.e., `python setup.py install`). I'm unsure how to add this dependency to my project using `uv`, so I don't even have a minimal exampleâ€”it's nonexistent.

Of course, I can first create a virtual environment using `uv venv`, activate the shell, and then run `python setup.py install`. However, this only installs the dependency in the current virtual environment and does not integrate it with `pyproject.toml` for proper dependency management.


---

_Comment by @charliermarsh on 2025-03-04 02:44_

From your project, you want to run `uv add git+https://github.com/NVIDIA/Megatron-LM`.

---

_Comment by @pplmx on 2025-03-04 02:50_

> From your project, you want to run `uv add git+https://github.com/NVIDIA/Megatron-LM`.

That's exactly what I needed â€” thanks a lot, @charliermarsh! :)

---

_Closed by @pplmx on 2025-03-04 02:50_

---

_Comment by @zanieb on 2025-03-04 02:51_

`setup.py` is handled by `setuptools` which is the default build system if a package does not configure one. They do explicitly configure it though https://github.com/NVIDIA/Megatron-LM/blob/fdfcef87004205eca69ea462b375578185ea01f6/pyproject.toml#L5 â€” you should be able to install this package with any standards-compliant installer.

---

_Comment by @Kuzaiherba on 2025-04-23 22:22_

Hi, I hope you are well!

I'm facing a similar issue with installing a [repo](https://github.com/cbilodeau2/mixprop) that does not have a `.toml` file and can only be installed via git-copy followed by `python setup.py install`.

Is there a way to add & install this dependency with `uv add ...` + `uv sync`?

---

_Comment by @konstin on 2025-04-24 08:29_

If there is no `pyproject.toml` file, uv will fallback to `setup.py` automatically, you should be able to add that repo the regular way.

---

_Comment by @pjgao on 2025-07-23 15:56_

@konstin @zanieb Hi, `uv sync`  can only find `core` directory in `site-packages/megatron`, because in their pyproject.toml: https://github.com/NVIDIA/Megatron-LM/blob/main/pyproject.toml:
```toml
[tool.setuptools.packages.find]
include = ["megatron.core", "megatron.core.*"]
```
What can I do in my pyproject.toml if I want to import `megatron.training`?  Thanks for your kindly reply, I have testing this for daysðŸ˜­

---

_Comment by @konstin on 2025-07-23 16:40_

@pjgao Can you you open a new issue with commands that reproduce your problem, their logs and expected vs. actual?

---

_Comment by @pjgao on 2025-07-24 01:38_

> [@pjgao](https://github.com/pjgao) Can you you open a new issue with commands that reproduce your problem, their logs and expected vs. actual?

Thanks, Open here: https://github.com/astral-sh/uv/issues/14862

---
