<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uv build fails to retrieve correct version with setuptools-scm on a release tag - astral-sh/uv #16828</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>uv build fails to retrieve correct version with setuptools-scm on a release tag</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/16828">#16828</a>
        opened by <a href="https://github.com/greatvovan">@greatvovan</a>
        on 2025-11-24 10:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/greatvovan">@greatvovan</a></div>
            <div class="timeline-body">Summary
<p>The issue is affecting me in GitHub action, but it is reproducible locally as well.</p>
<p>So, for a <a href="https://github.com/greatvovan/ios-backup-browser">project</a> with</p>
<pre><code>[project]
...
dynamic = [&quot;version&quot;]

[build-system]
requires = [&quot;setuptools&gt;=80&quot;, &quot;setuptools_scm&gt;=8&quot;]
build-backend = &quot;setuptools.build_meta&quot;
</code></pre>
<p><em>setuptools-scm</em> module returns correct version:</p>
<pre><code>% python -m setuptools_scm
0.1.1
</code></pre>
<p>but result of the build is always one patch step ahead and generates &quot;dev&quot; suffix:</p>
<pre><code>creating ios_backup_browser-0.1.2.dev0
...
</code></pre>
<p>even despite the fact of using <code>SETUPTOOLS_SCM_OVERRIDES_FOR_${DIST_NAME}</code> to <a href="https://setuptools-scm.readthedocs.io/en/latest/integrations/#the-solution">prevent</a> dirty or dev versions.</p>
<p>I don&#x27;t know if <a href="https://github.com/astral-sh/uv/issues/6964">this issue</a> is related to mine, but the solution there was to use <code>reinstall-package = [&quot;my-package&quot;]</code> â€“ setting I tried with (<a href="https://github.com/greatvovan/ios-backup-browser/actions/runs/19630933388/job/56210305304">v0.1.4</a>) and without (<a href="https://github.com/greatvovan/ios-backup-browser/actions/runs/19631047444/job/56210669004">v0.1.5</a>) to no avail.</p>
<p>To reproduce it locally, we can checkout the tag and try <code>python -m setuptools_scm</code> and <code>uv build</code> with the same outcome.</p>
<p>Please kindly assist with the issue.</p>
Platform
<p>GitHub Actions (ubuntu-latest), astral-sh/setup-uv@v6</p>
Version
<p>0.9.11</p>
Python version
<p>3.14</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/greatvovan">@greatvovan</a> on 2025-11-24 10:53</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-11-27 16:35</div>
            <div class="timeline-body"><p>I can reproduce this with <code>python -m build</code>, so this is something about <code>setuptools_scm</code>, rather than specific to <code>uv build</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> removed by <a href="https://github.com/konstin">@konstin</a> on 2025-11-27 16:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-11-27 16:35</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/greatvovan">@greatvovan</a> on 2025-11-28 11:06</div>
            <div class="timeline-body"><p>Thanks @konstin, created an <a href="https://github.com/pypa/setuptools-scm/issues/1238">issue</a> in their project, let&#x27;s see if they suggest something.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">external</span> added by <a href="https://github.com/konstin">@konstin</a> on 2025-11-28 11:16</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/greatvovan">@greatvovan</a> on 2025-11-29 05:41</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/greatvovan">@greatvovan</a> on 2025-11-29 07:09</div>
            <div class="timeline-body"><p>The problem was combination of my error and counterintuitive behavior of the SCM module. Closing the issue.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 19:41:07 UTC
    </footer>
</body>
</html>
