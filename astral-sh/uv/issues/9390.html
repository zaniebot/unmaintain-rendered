<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doc: clarify &quot;virtual projects&quot; static version required[/-] - astral-sh/uv #9390</title>
    <link rel="stylesheet" href="../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../index.html">Back to index</a>
    </div>

    <h1>Doc: clarify &quot;virtual projects&quot; static version required[/-]</h1>

    <div class="meta">
        <span class="state state-closed">Closed</span>
        <a href="https://github.com/astral-sh/uv/issues/9390">#9390</a>
        opened by <a href="https://github.com/mlec1">@mlec1</a>
        on 2024-11-23 21:54
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header">Issue opened by <a href="https://github.com/mlec1">@mlec1</a> on 2024-11-23 21:54</div>
            <div class="timeline-body"><p>Hello,</p>
<p>first thank you for the awesome project.</p>
<p>I just wanted to report maybe an improvement in the doc. I am working on a &quot;virtual project&quot;, and wanted to lock, and sync my project without necessary install my project. Here was my <code>pyproject.toml</code>:</p>
<pre><code>[project]
name = &quot;foo&quot;
dynamic = [&quot;version&quot;]
requires-python = &quot;&gt;= 3.10&quot;
dependencies = [
    &quot;Django[argon2]==4.2.16&quot;,
    &quot;django-admin-sortable2==2.2.4&quot;,
    &quot;django-recaptcha==4.0.0&quot;,
    &quot;django-csp==3.8&quot;,
    &quot;elastic-apm==6.23.0&quot;,
    &quot;gunicorn==23.0.0&quot;,
    &quot;mailjet-rest==1.3.4&quot;,
    &quot;Pillow==11.0.0&quot;,
    &quot;psycopg==3.2.3&quot;,
    &quot;python-decouple==3.8&quot;,
    &quot;python-ipware==3.0.0&quot;,
    &quot;whitenoise==6.8.2&quot;,
]

[...]

[tool.uv]
package = false
</code></pre>
<p>I have added the <code>package = false</code> under <code>[tool.uv]</code>. But I was still getting the following error, showing that uv was still trying to build my project.</p>
<pre><code>error: Multiple top-level packages discovered in a flat-layout: ['foo1', 'bar', '...'].

To avoid accidental inclusion of unwanted files or directories,
setuptools will not proceed with this build.

If you are trying to create a single distribution with multiple packages
on purpose, you should not rely on automatic discovery.
Instead, consider the following options:

1. set up custom discovery (`find` directive with `include` or `exclude`)
2. use a `src-layout`
3. explicitly set `py_modules` or `packages` with a list of names

To find more information, look for &quot;package discovery&quot; on setuptools docs.
</code></pre>
<p>I found out that the issue was because I had <code>dynamic = [&quot;version&quot;]</code> and when I switched to a static version it worked perfectly. The version was not a something we care right now, therefore the <code>dynamic = [&quot;version&quot;]</code> was the easy solution. Now that I read the documentation of the pyproject.toml, it makes totally sense that uv was trying to build my project:</p>
<p>https://packaging.python.org/en/latest/guides/writing-pyproject-toml/#static-vs-dynamic-metadata</p>
<pre><code>When a field is dynamic, it is the build backend’s responsibility to fill it. Consult your build backend’s documentation to learn how it does it.
</code></pre>
<p>I just wanted to suggest adding this reminder in the documentation on the <code>package</code> setting, as it took me a while to figure out, that was the issue. That in order to <code>package</code> to work, the version needs to be static :
https://docs.astral.sh/uv/reference/settings/#package</p>
<p>uv lock --verbose:</p>
<pre><code>DEBUG uv 0.5.4
DEBUG Found workspace root: `/foo`
DEBUG Adding current workspace member: `/foo`
DEBUG Using Python request `&gt;=3.10` from `requires-python` metadata
DEBUG The virtual environment's Python version satisfies `&gt;=3.10`
DEBUG Using request timeout of 30s
DEBUG No static `pyproject.toml` available for: foo @ file:///foo (PyprojectToml(DynamicField(&quot;version&quot;)))
DEBUG Acquired lock for `/.cache/uv/sdists-v6/path/ba7e944cd76875a1`
DEBUG Preparing metadata for: foo @ file:///foo
DEBUG Ignoring empty directory
DEBUG Resolving build requirements
DEBUG Solving with installed Python version: 3.10.15
DEBUG Solving with target Python version: &gt;=3.10.15
DEBUG Adding direct dependency: setuptools&gt;=40.8.0
DEBUG No cache entry for: https://pypi.org/simple/setuptools/
WARN Skipping file for setuptools: setuptools-0.6b1-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6b1-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6b2-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6b2-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6b3-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6b3-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6b4-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6b4-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c1-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c1-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c10-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c10-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c10-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c10-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c10-py2.6.egg
WARN Skipping file for setuptools: setuptools-0.6c10.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c10.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c10.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c10.win32-py2.6.exe
WARN Skipping file for setuptools: setuptools-0.6c11-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c11-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c11-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c11-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c11-py2.6.egg
WARN Skipping file for setuptools: setuptools-0.6c11-py2.7.egg
WARN Skipping file for setuptools: setuptools-0.6c11.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c11.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c11.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c11.win32-py2.6.exe
WARN Skipping file for setuptools: setuptools-0.6c11.win32-py2.7.exe
WARN Skipping file for setuptools: setuptools-0.6c2-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c2-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c3-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c3-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c3-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c4-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c4-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c4-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c4-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c4.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c4.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c4.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c5-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c5-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c5-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c5-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c5.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c5.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c5.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c6-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c6-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c6-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c6-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c6.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c6.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c6.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c7-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c7-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c7-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c7-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c7.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c7.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c7.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c8-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c8-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c8-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c8-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c8.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c8.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c8.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-0.6c9-1.src.rpm
WARN Skipping file for setuptools: setuptools-0.6c9-py2.3.egg
WARN Skipping file for setuptools: setuptools-0.6c9-py2.4.egg
WARN Skipping file for setuptools: setuptools-0.6c9-py2.5.egg
WARN Skipping file for setuptools: setuptools-0.6c9-py2.6.egg
WARN Skipping file for setuptools: setuptools-0.6c9.win32-py2.3.exe
WARN Skipping file for setuptools: setuptools-0.6c9.win32-py2.4.exe
WARN Skipping file for setuptools: setuptools-0.6c9.win32-py2.5.exe
WARN Skipping file for setuptools: setuptools-18.3.1-py3.4.egg
DEBUG Searching for a compatible version of setuptools (&gt;=40.8.0)
DEBUG Selecting: setuptools==75.6.0 [compatible] (setuptools-75.6.0-py3-none-any.whl)
DEBUG No cache entry for: https://files.pythonhosted.org/packages/55/21/47d163f615df1d30c094f6c8bbb353619274edccf0327b185cc2493c2c33/setuptools-75.6.0-py3-none-any.whl.metadata
DEBUG Tried 1 versions: setuptools 1
DEBUG marker environment resolution took 0.118s
DEBUG Installing in setuptools==75.6.0 in /.cache/uv/builds-v0/.tmpAHoXjm
DEBUG Identified uncached distribution: setuptools==75.6.0
DEBUG Downloading and building requirement for build: setuptools==75.6.0
DEBUG No cache entry for: https://files.pythonhosted.org/packages/55/21/47d163f615df1d30c094f6c8bbb353619274edccf0327b185cc2493c2c33/setuptools-75.6.0-py3-none-any.whl
DEBUG Installing build requirement: setuptools==75.6.0
DEBUG Creating PEP 517 build environment
DEBUG Calling `setuptools.build_meta:__legacy__.get_requires_for_build_wheel()`
DEBUG error: Multiple top-level packages discovered in a flat-layout: ['foo1', 'bar', '...'].
DEBUG 
DEBUG To avoid accidental inclusion of unwanted files or directories,
DEBUG setuptools will not proceed with this build.
DEBUG 
DEBUG If you are trying to create a single distribution with multiple packages
DEBUG on purpose, you should not rely on automatic discovery.
DEBUG Instead, consider the following options:
DEBUG 
DEBUG 1. set up custom discovery (`find` directive with `include` or `exclude`)
DEBUG 2. use a `src-layout`
DEBUG 3. explicitly set `py_modules` or `packages` with a list of names
DEBUG 
DEBUG To find more information, look for &quot;package discovery&quot; on setuptools docs.
DEBUG Released lock at `/.cache/uv/sdists-v6/path/ba7e944cd76875a1/.lock`
error: Failed to generate package metadata for `foo==0.0.0 @ virtual+.`
  Caused by: Build backend failed to determine requirements with `build_wheel()` (exit status: 1)

[stderr]
error: Multiple top-level packages discovered in a flat-layout: ['foo1', 'bar', '...'].

To avoid accidental inclusion of unwanted files or directories,
setuptools will not proceed with this build.

If you are trying to create a single distribution with multiple packages
on purpose, you should not rely on automatic discovery.
Instead, consider the following options:

1. set up custom discovery (`find` directive with `include` or `exclude`)
2. use a `src-layout`
3. explicitly set `py_modules` or `packages` with a list of names

To find more information, look for &quot;package discovery&quot; on setuptools docs.
</code></pre>
<p>uv version: <code>uv 0.5.4</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> added by @charliermarsh on 2024-11-24 01:54</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/trymzet">@trymzet</a> on 2025-12-10 13:55</div>
            <div class="timeline-body"><p>I had this error and setting <code>package = false</code> didn't have any effect for me, but it turned out I was running <code>uv sync --frozen</code> and I needed to first re-create the lock file before running <code>uv sync</code> again.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Doc: clarify "virtual projects" static version required" to "Disallow `dynamic = ["version"]` with `package = false`" by @konstin on 2025-12-10 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">documentation</span> removed by @konstin on 2025-12-10 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @konstin on 2025-12-10 15:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Disallow `dynamic = ["version"]` with `package = false`" to "[-]Doc: clarify "virtual projects" static version required[/-]" by @konstin on 2025-12-10 15:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "[-]Doc: clarify "virtual projects" static version required[/-]" to "Doc: clarify "virtual projects" static version required[/-]" by @konstin on 2025-12-10 15:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/konstin">@konstin</a> on 2025-12-10 15:10</div>
            <div class="timeline-body"><p>The behavior reported has since been fixed. For <code>--frozen</code>, that's a very different case and should be discussed separately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @konstin on 2025-12-10 15:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-09 23:28:24 UTC
    </footer>
</body>
</html>
