<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pin to major versions for apps - astral-sh/uv #7810</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Pin to major versions for apps</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/astral-sh/uv/issues/7810">#7810</a>
        opened by <a href="https://github.com/vriesdemichael">@vriesdemichael</a>
        on 2024-09-30 14:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/vriesdemichael">@vriesdemichael</a></div>
            <div class="timeline-body"><p>With the project API we can now lock applications down to specific versions before invocations and during syncs. Which is great!</p>
<p>But when you add a dependency using <code>uv add somedep</code> it will add an entry in <code>pyproject.toml</code> pinned to a lower bound patch version (e.g. <code>somedep &gt;=1.2.3</code>).</p>
<p>I would like it if you could also add an upper bound to dependencies from the CLI.
Typically, we would use an upper bound for major versions, to prevent locking to new versions of dependencies with breaking changes (major version bumps indicate breaking changes to the API for projects with SemVer)</p>
<p>Given that the latest version of somedep is version <code>1.2.3</code> it would be nice to get <code>somedep &gt;=1.2.3, &lt;2</code> as entry in pyproject.toml.
The uv.lock file can then deal with the specific patch version to use together with the other dependencies.</p>
<p>Perhaps it could be a new resolution strategy to pass to uv add.
<code>uv add somedep --resolution pin-major</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benlindsay">@benlindsay</a> on 2024-10-15 14:37</div>
            <div class="timeline-body"><p>This is the default behavior in Poetry and it would be great to have it available in uv too. Loving uv so far, thanks for all the hard work!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/notatallshaw">@notatallshaw</a> on 2024-10-15 14:49</div>
            <div class="timeline-body"><p>FYI there was a long discussion towards the end of #1398 about why adding upper bounds by default would have a lot of negative consequences.</p>
<p>I do think there are valid cases, either because a users knows they are tightly coupled on specific dependencies, or they know their application will never ever be a dependency itself and they want to put barriers on unintentional upgrades.</p>
<p>But in both cases I would personally recommend pinning your dependencies, as very few libraries strictly follow semver, or they don't follow semver at all but users think they do e.g. pip which has a form of calver. And even if a library follows semver it is only meant to guarantee intentional behavior, users often get caught out that they are depending on unintentional behavior and that breaks, which semver doesn't protect against.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/benlindsay">@benlindsay</a> on 2024-10-15 15:22</div>
            <div class="timeline-body"><blockquote>
<p>adding upper bounds by default would have a lot of negative consequences.</p>
</blockquote>
<p>I'm fine with not having it on by default. Having a cli option to enable it would be great, enabling a config option to opt-in per-project would be fantastic, and enabling a similar config option to set in .bashrc/.zshrc would be superb.</p>
<blockquote>
<p>But in both cases I would personally recommend pinning your dependencies</p>
</blockquote>
<p>Isn't this what the lockfile is for? I prefer to leave the bounds relatively wide in pyproject.toml, then pin via the lockfile. This way, if I see a dependency pinned to a specific version in pyproject.toml, I'll know that I should be more wary of updating that one. If everything is pinned in pyproject.toml, updating project dependencies is a lot harder since you can't just run one update command.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/edmorley">@edmorley</a> on 2025-01-03 17:55</div>
            <div class="timeline-body"><p>This seems like a duplicate of #6783 (see also #10247).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @zanieb on 2025-01-03 18:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 17:27:25 UTC
    </footer>
</body>
</html>
