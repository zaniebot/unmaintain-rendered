---
number: 17037
title: Show progress bar when hashing large files for upload
type: pull_request
state: open
author: yumeminami
labels:
  - enhancement
assignees: []
base: main
head: feat/add_progress_bar_in_pulish_hash
created_at: 2025-12-08T19:50:41Z
updated_at: 2025-12-11T16:50:56Z
url: https://github.com/astral-sh/uv/pull/17037
synced_at: 2026-01-07T12:31:16-06:00
---

# Show progress bar when hashing large files for upload

---

_Pull request opened by @yumeminami on 2025-12-08 19:50_

<!--
Thank you for contributing to uv! To help us out with reviewing, please consider the following:

- Does this pull request include a summary of the change? (See below.)
- Does this pull request include a descriptive title?
- Does this pull request include references to any relevant issues?
-->

## Summary

<!-- What's the purpose of the change? What does it do, and why? -->

Hashing

```
uv-dev publish --index testpypi          
Publishing 2 files to https://test.pypi.org/legacy/
Uploading git_mcp_server-0.2.7-py3-none-any.whl (95.5MiB)
Hashing git_mcp_server-0.2.7-py3-none-any.whl ------------------------------ 84.77 MiB/95.48 MiB 
```

Uploading

```
Publishing 2 files to https://test.pypi.org/legacy/
Uploading git_mcp_server-0.2.7-py3-none-any.whl (95.5MiB)
Uploading git_mcp_server-0.2.7-py3-none-any.whl ------------------------------ 15.80 MiB/95.48 MiB   
```

Every progress bar all adds the operation name at the head.

close https://github.com/astral-sh/uv/issues/17034

## Test Plan

<!-- How was it tested? -->


---

_Review requested from @konstin by @zanieb on 2025-12-09 21:18_

---

_Renamed from "Feat/add progress bar in pulish hash" to "Show progress bar when hashing large files" by @konstin on 2025-12-11 15:43_

---

_Label `enhancement` added by @konstin on 2025-12-11 15:43_

---

_Renamed from "Show progress bar when hashing large files" to "Show progress bar when hashing large files for upload" by @konstin on 2025-12-11 15:43_

---

_Review comment by @konstin on `crates/uv-publish/src/lib.rs`:148 on 2025-12-11 15:44_

Why does this have a default implementation?

---

_Review comment by @konstin on `crates/uv-publish/src/lib.rs`:714 on 2025-12-11 15:51_

We don't need to convert to a string, we can pass `DistFilename` and only convert to a string when we need it.

---

_Review comment by @konstin on `crates/uv-publish/src/lib.rs`:719 on 2025-12-11 15:54_

We have some custom rendering for path that handles e.g. a Windows-specific prefix that we don't want to show.

```suggestion
    debug!("Hashing {}", path.user_display());
```

---

_Review comment by @konstin on `crates/uv/src/commands/reporters.rs`:214 on 2025-12-11 16:34_

Why do we need to allow this?

---

_Review comment by @konstin on `crates/uv/src/commands/reporters.rs`:226 on 2025-12-11 16:48_

This is a good addition for the upload progress bar, but it also changes the style for e.g. `uv pip install torch`, while we want to only change the publish style

---

_Review comment by @konstin on `crates/uv-publish/src/lib.rs`:716 on 2025-12-11 16:49_

This should use a reporter unconditionally, since all production code has a reporter.

---

_@konstin reviewed on 2025-12-11 16:50_

---
