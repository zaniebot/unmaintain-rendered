---
number: 12564
title: Setting of CLICOLOR_FORCE breaks build backends
type: issue
state: closed
author: jaraco
labels:
  - bug
assignees: []
created_at: 2025-03-30T21:03:13Z
updated_at: 2025-08-27T15:28:03Z
url: https://github.com/astral-sh/uv/issues/12564
synced_at: 2026-01-07T12:31:15-06:00
---

# Setting of CLICOLOR_FORCE breaks build backends

---

_Issue opened by @jaraco on 2025-03-30 21:03_

### Question

In https://github.com/coherent-oss/system/issues/20, I've root caused an issue when using `uv pip install` on a project using a [`coherent.build`](https://pypi.org/project/coherent.build) project.

To summarize, it seems that `uv` sets the environment variable `CLICOLOR_FORCE=1`, which when that is inherited by the build backend and its subprocess call to `gh repo view --json url,description`, the `gh` CLI emits colored output and the JSON can't be parsed.

What's the proper solution here? I can think of a few approaches.

1. Build backends should filter or override CLICOLOR_FORCE when invoking subprocesses.
2. `uv` should filter CLICOLOR_FORCE when invoking build backends.
3. Backends should expect and filter colored output.

### Platform

macOS 15.3

### Version

uv 0.6.10 (Homebrew 2025-03-26)

---

_Label `question` added by @jaraco on 2025-03-30 21:03_

---

_Comment by @zanieb on 2025-04-01 21:28_

It seems weird that `gh repo view` emits color codes in the JSON output? 

Anyway, I'm not sure why we set `CLICOLOR_FORCE` at all. cc @charliermarsh / @konstin 

---

_Label `bug` added by @zanieb on 2025-04-01 21:28_

---

_Label `question` removed by @zanieb on 2025-04-01 21:28_

---

_Comment by @charliermarsh on 2025-04-01 21:32_

I have no idea why we set that. I'd have to look in the Git history.

---

_Comment by @zanieb on 2025-04-01 21:38_

- https://github.com/astral-sh/uv/pull/3032

---

_Comment by @konstin on 2025-04-08 09:02_

We initially added this to improve the error output of build subprocess, this variable e.g. gets implicitly propagated from the maturin build backend to cargo (and the same should apply for C/C++ build backends). I consider it a bug in the `gh` CLI that the JSON output is colored, but OTOH the `CLICOLOR_FORCE` is only a cosmetic feature.

---

_Referenced in [astral-sh/uv#15415](../../astral-sh/uv/issues/15415.md) on 2025-08-22 19:13_

---

_Comment by @zanieb on 2025-08-22 19:14_

See also https://github.com/astral-sh/uv/issues/15415

---

_Referenced in [astral-sh/uv#15472](../../astral-sh/uv/pulls/15472.md) on 2025-08-23 16:08_

---

_Closed by @zsol on 2025-08-27 15:28_

---
