---
number: 14862
title: "uv sync fails to find megatron.training due to incomplete package inclusion in Megatron-LM's pyproject.toml"
type: issue
state: closed
author: pjgao
labels:
  - question
assignees: []
created_at: 2025-07-24T01:38:03Z
updated_at: 2025-08-22T23:25:44Z
url: https://github.com/astral-sh/uv/issues/14862
synced_at: 2026-01-07T12:31:16-06:00
---

# uv sync fails to find megatron.training due to incomplete package inclusion in Megatron-LM's pyproject.toml

---

_Issue opened by @pjgao on 2025-07-24 01:38_

### Question

Hi, `uv sync`  can only find `core` directory in `site-packages/megatron`, because in their pyproject.toml: https://github.com/NVIDIA/Megatron-LM/blob/main/pyproject.toml, they only include 'core' subdirectory:
```toml
[tool.setuptools.packages.find]
include = ["megatron.core", "megatron.core.*"]
```
What can I do in my pyproject.toml if my project want to import `megatron.training`?  Thanks for your kindly reply, I have testing this for daysðŸ˜­

### Platform

ubuntu20.04

### Version

uv 0.8.0


command to reproduce:
```bash
mkdir test
cd test/
uv init
uv venv
source .venv/bin/activate
uv add "megatron-core @ git+https://github.com/NVIDIA/Megatron-LM.git@core_r0.8.0"
#(test)[xxx@localhost test]# uv add "git+https://github.com/NVIDIA/Megatron-LM.git@core_r0.8.0"
#    Updated https://github.com/NVIDIA/Megatron-LM.git (baf94af3c667248865f23df73b9fb8e2395e6fd0)
#Resolved 18 packages in 1.07s
#Installed 1 package in 30ms
# + megatron-core==0.8.0 (from git+https://github.com/NVIDIA/Megatron-LM.git@baf94af3c667248865f23df73b9fb8e2395e6fd0)
uv run python -c "import megatron.training"
#Traceback (most recent call last):
#  File "<string>", line 1, in <module>
#ModuleNotFoundError: No module named 'megatron.training'
```

---

_Label `question` added by @pjgao on 2025-07-24 01:38_

---

_Referenced in [astral-sh/uv#11920](../../astral-sh/uv/issues/11920.md) on 2025-07-24 01:38_

---

_Comment by @zanieb on 2025-07-24 02:44_

Is there a reason this module should be available? This sounds like a question for the megatron folks.

This reproduces when just installing the PyPI wheel too.

---

_Comment by @pjgao on 2025-07-24 03:03_

In my current workflow, I git clone https://github.com/NVIDIA/Megatron-LM.git to local,  then copy `megatron` directory to my project (I need to use `megatron/training` for pretrain gpt model), which need manual copy.
Now I want to migrate this `copy` to `uv`

---

_Comment by @zanieb on 2025-07-24 04:29_

I think you're using that package in a way that it's not designed to support. There's not a uv-native way to override its build system, unless `setuptools` allows `config-settings` to override that metadata (which seems unlikely).

---

_Comment by @pjgao on 2025-07-24 04:50_

â€ŒDuring `uv sync`, can some additional commands be executed to perform a copy operation? This way, when users use it, they only need to run a single `uv sync` command to set up the environment. It's not must to install the `Megatron-LM`'s dependency, only it's source code is needed.

---

_Comment by @zanieb on 2025-07-24 04:53_

Not right now, no. We don't have a plugin / hook system like that.

---

_Referenced in [NVIDIA/Megatron-LM#1704](../../NVIDIA/Megatron-LM/issues/1704.md) on 2025-07-24 04:56_

---

_Comment by @charliermarsh on 2025-08-22 15:59_

Looks like the suggestion in https://github.com/NVIDIA/Megatron-LM/issues/1704 is to use a Git dependency, which seems reasonable.

---

_Closed by @charliermarsh on 2025-08-22 15:59_

---

_Comment by @pjgao on 2025-08-22 23:25_

> Looks like the suggestion in https://github.com/NVIDIA/Megatron-LM/issues/1704 is to use a Git dependency, which seems reasonable.

Nemo RL use 'git submodule' to add the dependency, then customize pyprpject.toml can include all megatron dorectory. One more problem is that 'git submodule' only support git 'branch', but not git 'commit id'

---
