---
number: 14147
title: "`uv sync --locked` broken when using `uv add` for ssh git dependency"
type: issue
state: closed
author: ultrabear
labels:
  - needs-mre
assignees: []
created_at: 2025-06-19T23:30:39Z
updated_at: 2025-06-20T16:38:13Z
url: https://github.com/astral-sh/uv/issues/14147
synced_at: 2026-01-07T12:31:16-06:00
---

# `uv sync --locked` broken when using `uv add` for ssh git dependency

---

_Issue opened by @ultrabear on 2025-06-19 23:30_

### Summary

after using uv add to add an ssh auth based private github repository (and specifying git as the login user in the string), `uv sync --locked` will assert that the lockfile must be changed, doing a `uv lock` will not update the lockfile nor will a `uv sync`, the problem it seems to face is the dependency is listed with the username obfuscated with `****` in uv.lock in one area, for some reason, and manually changing that to git makes things work again, either `uv sync --locked` behavior should accept the obfuscated name being generated by `uv add`, or uv add should stop obfuscating the name


Min repro:
```fish
uv init locked_error
cd locked_error
# a public python git repository I have ownership 
# over for example, this also happens for private git repos
uv add git+ssh://git@github.com/ultrabear/url_strip
# sanity
uv sync

uv sync --locked # ERROR: the heck?? we just did a uv sync and everything
```

Temporary fix (manually edit lockfile):
```diff
-requires-dist = [{ name = "url-strip", git = "ssh://****@github.com/ultrabear/url_strip" }]
+requires-dist = [{ name = "url-strip", git = "ssh://git@github.com/ultrabear/url_strip" }]
```

pictures:

![Image](https://github.com/user-attachments/assets/f525dce3-9734-4eb8-b602-0e295de65e52)


(this was also tested against pipx latest(0.7.13) and still had the same error)

### Platform

Linux 6.14.9-300.fc42.x86_64 x86_64 GNU/Linux

### Version

uv 0.7.9

### Python version

Python 3.11.12

---

_Label `bug` added by @ultrabear on 2025-06-19 23:30_

---

_Comment by @charliermarsh on 2025-06-20 13:23_

I don't think this error exists in newer versions. I just ran those commands without error:

```
❯ uv init locked_error
Initialized project `locked-error` at `/Users/crmarsh/workspace/locked_error`

❯ cd locked_error

❯ uv add git+ssh://git@github.com/ultrabear/url_strip
Using CPython 3.13.2
Creating virtual environment at: .venv
    Updated ssh://git@github.com/ultrabear/url_strip (9bc6bc205c947e7662fd44d83e9577
Resolved 3 packages in 157ms
      Built url-strip @ git+ssh://git@github.com/ultrabear/url_strip@9bc6bc205c947e7
Prepared 2 packages in 338ms
Installed 2 packages in 1ms
 + typing-extensions==4.14.0
 + url-strip==0.2.2b0 (from git+ssh://git@github.com/ultrabear/url_strip@9bc6bc205c947e7662fd44d83e95778f53d6a32f)

❯ uv sync
Resolved 3 packages in 0.46ms
Audited 2 packages in 0.01ms

❯ uv sync --locked
Resolved 3 packages in 0.40ms
Audited 2 packages in 0.01ms
```

---

_Label `bug` removed by @charliermarsh on 2025-06-20 13:23_

---

_Label `needs-mre` added by @charliermarsh on 2025-06-20 13:23_

---

_Comment by @ultrabear on 2025-06-20 16:32_

What version are you using?

---

_Comment by @ultrabear on 2025-06-20 16:34_

Ok, looks like uv add as of 0.7.13 does not add the `****` that was causing errors
but it still does error on `uv sync --locked` if the `****` are present in the lockfile

---

_Comment by @charliermarsh on 2025-06-20 16:35_

Latest (v0.7.13). Writing `****` was itself a bug in a prior version that we then fixed. I'd suggest removing it or regenerating the lock.

---

_Comment by @ultrabear on 2025-06-20 16:38_

Got it, will close for now as its at least not generating a broken state in newer releases, will have to wait on Fedora to fix this on my real setup though, boo hoo /lh

---

_Closed by @ultrabear on 2025-06-20 16:38_

---
