---
number: 8885
title: "Long Pandas compile time (>7 minutes)"
type: issue
state: closed
author: beoRich
labels:
  - question
assignees: []
created_at: 2024-11-07T10:57:40Z
updated_at: 2024-11-08T13:57:13Z
url: https://github.com/astral-sh/uv/issues/8885
synced_at: 2026-01-07T12:31:15-06:00
---

# Long Pandas compile time (>7 minutes)

---

_Issue opened by @beoRich on 2024-11-07 10:57_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->
We are trying uv as pip replacement and encounter an usual long compile time:
uv sync --reinstall -n --verbose

```
.....
DEBUG copying pandas\conftest.py -> build\lib.win-amd64-cpython-312\pandas
DEBUG copying pandas\testing.py -> build\lib.win-amd64-cpython-312\pandas
DEBUG copying pandas\_typing.py -> build\lib.win-amd64-cpython-312\pandas
DEBUG copying pandas\_version.py -> build\lib.win-amd64-cpython-312\pandas
DEBUG copying pandas\__init__.py -> build\lib.win-amd64-cpython-312\pandas
DEBUG creating build\lib.win-amd64-cpython-312\pandas\api
DEBUG copying pandas\api\__init__.py -> build\lib.win-amd64-cpython-312\pandas\api
DEBUG creating build\lib.win-amd64-cpython-312\pandas\arrays
DEBUG copying pandas\arrays\__init__.py -> build\lib.win-amd64-cpython-312\pandas\arrays
DEBUG creating build\lib.win-amd64-cpython-312\pandas\compat
DEBUG copying pandas\compat\chainmap.py -> build\lib.win-amd64-cpython-312\pandas\compat
DEBUG copying pandas\compat\pickle_compat.py -> build\lib.win-amd64-cpython-312\pandas\compat
DEBUG copying pandas\compat\pyarrow.py -> build\lib.win-amd64-cpython-312\pandas\compat
.....
```

and on via dockerimage:

```
# builder image
FROM ghcr.io/astral-sh/uv:python3.12-bookworm AS builder
COPY --from=ghcr.io/astral-sh/uv:latest /uv /uvx /bin/

WORKDIR /app

ENV UV_LINK_MODE=copy
ENV UV_COMPILE_BYTECODE=0
ENV UV_SYSTEM_PYTHON=1

RUN --mount=type=cache,target=/root/.cache/uv \
    --mount=type=bind,source=uv.lock,target=uv.lock \
    --mount=type=bind,source=pyproject.toml,target=pyproject.toml \
    uv sync --verbose --frozen --no-install-project --no-dev

ADD . /app
RUN --mount=type=cache,target=/root/.cache/uv \
    uv sync --frozen --no-dev

# final image
FROM python:3.12-slim-bookworm
COPY --from=builder --chown=app:app /app /app
WORKDIR /app

ENTRYPOINT ["python3"]
CMD ["-m", "application"]
```


Since we are using a CI/CD Pipeline with no cache this is too long to be useable.
Pipeline CD Step with uv, dockerbuildtime: 645.7s
Pipeline CD Step with pip, dockerbuildtime: around 90s

Is there any way to fix this? 


---

_Comment by @charliermarsh on 2024-11-07 13:23_

I don't think using pip vs. uv should have any impact on Pandas build times -- they both just call the relevant build backend, none of the build happens in pip or uv. I have two questions: (1) why is Pandas building from source in the first place? Are you on a really old version that doesn't ship wheels or something? And (2) are you sure that you're also building Pandas from source in the pip version of your pipeline?

---

_Label `question` added by @charliermarsh on 2024-11-07 13:23_

---

_Comment by @beoRich on 2024-11-07 15:20_

1) Don't think so, the version ist 1.5.3 which was released Jan 19, 2023. We have no idea why its building from source...it is added via transitive dependency via an own package with extra Index.
project -> own package -> own package (with pandas 1.5.3)
The own packages itself are published via pip, setup.py and twine:
```
python setup.py sdist bdist_wheel
twine upload --repository codeartifact dist/*
```
2) Yes we saw the same logs there. 

---

_Comment by @beoRich on 2024-11-07 15:28_

Ah I see it tries to access the private extra index for cache and wheel and doesn't find anything.
```
DEBUG Building: pandas==1.5.3
DEBUG Ignoring empty directory
DEBUG Resolving build requirements
DEBUG Solving with installed Python version: 3.12.0
DEBUG Solving with target Python version: >=3.12.0
DEBUG Adding direct dependency: setuptools>=51.0.0
DEBUG Adding direct dependency: wheel*
DEBUG Adding direct dependency: cython>=0.29.32, <3
DEBUG Adding direct dependency: oldest-supported-numpy>=2022.8.16
DEBUG Searching for a compatible version of setuptools (>=51.0.0)
DEBUG Selecting: setuptools==75.3.0 [compatible] (setuptools-75.3.0-py3-none-any.whl)
DEBUG No cache entry for: <PrivateRepo>/simple/wheel/
```
Do I need to explicitly add the https://pypi.org/project/pandas/ index?
This is how the pyproject.toml looks like:
```
[project]
name = "<project>"
version = "0.1.0"
description = "<desc>"
requires-python = "==3.12.*"
readme = "README.md"
dependencies = [
    "<ownPackage>==11.3.0",
    "pyhamcrest",
    "pre-commit",
    "ruff",
    "coverage",
    "pandas==1.5.3",
]
[[tool.uv.index]]
name = "internal"
url = "https://aws:$CODEARTIFACT_AUTH_TOKEN@<privateIndex>
```


Edit: 
Also saw in the uv.lock that pandas has no wheel entry..:
![image](https://github.com/user-attachments/assets/8d450cf6-0913-4050-974c-98adc9ba1aa0)


---

_Comment by @notatallshaw on 2024-11-07 17:15_

FWIW, pandas 1.5.3 only officially supported Python 3.8 to 3.11: https://pypi.org/project/pandas/1.5.3/#files

Using it with Python 3.12 has no guarantee of working.

---

_Comment by @beoRich on 2024-11-08 13:57_

Thanks, switching to 3.11.9 fixed it.

---

_Closed by @beoRich on 2024-11-08 13:57_

---
