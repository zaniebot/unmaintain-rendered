---
number: 9425
title: "`uv add onnxruntime` fails to fetch latest version of package compatible with my environment's Python"
type: issue
state: open
author: sebastian-correa
labels:
  - enhancement
assignees: []
created_at: 2024-11-25T19:50:16Z
updated_at: 2025-10-21T12:24:16Z
url: https://github.com/astral-sh/uv/issues/9425
synced_at: 2026-01-07T12:31:15-06:00
---

# `uv add onnxruntime` fails to fetch latest version of package compatible with my environment's Python

---

_Issue opened by @sebastian-correa on 2024-11-25 19:50_

When adding `onnxruntime` in Python 3.9, `uv` fails to resolve `1.19.2` and instead fails. `onnxruntime` `1.20.0` dropped support for Python 3.9. Could this be related to `onnxruntime` as `poetry add` also "fails" (it installs a wrong version and explodes in the process)?

To reproduce, do:

```bash
❯ mkdir onnxruntime-test
❯ cd onnxruntime-test
❯ uv init --python=3.9
Initialized project `onnxruntime-test`
❯ uv add --python=3.9 onnxruntime
Using CPython 3.9.20
Removed virtual environment at: .venv
Creating virtual environment at: .venv
Resolved 11 packages in 16ms
error: Distribution `onnxruntime==1.20.1 @ registry+https://pypi.org/simple` can't be installed because it doesn't have a source distribution or wheel for the current platform
```

Running `uv` in macOS 15.1 (24B83). `uv` version is:
```bash
❯ uv --version
uv 0.5.4 (c62c83c37 2024-11-20)
```



---

_Comment by @charliermarsh on 2024-11-25 21:38_

I think the problem is that they don't have `requires-python = ">=3.9"`, so from a metadata perspective, it "looks like" they still support Python 3.9. I could see us backtracking here, though, such that if there's no source distribution, we look for the next version with a matching wheel, if some Python versioning are missing.

In the meantime, you probably want to do something like:

```toml
[project]
...
dependencies = ["onnxruntime>=1.20.1 ; python_version > '3.9'", "onnxruntime<1.20.1 ; python_version <= '3.9'"]
```


---

_Comment by @charliermarsh on 2024-11-25 21:40_

This is roughly the same as #5182, but for Python version, not platform (which is more tractable).

---

_Label `enhancement` added by @charliermarsh on 2024-11-25 21:40_

---

_Comment by @sebastian-correa on 2024-11-26 00:51_

Thanks for the reply! I figured it had something to do with this, and I tried to find the spot where they defined compatible Python versions but couldn't.

Can I help somehow? I don't know a single thing about rust or `uv`'s inner workings but if I can be of help somehow, please let me know!

---

_Referenced in [google/magika#922](../../google/magika/issues/922.md) on 2025-01-24 10:57_

---

_Referenced in [google/magika#928](../../google/magika/issues/928.md) on 2025-01-24 12:12_

---

_Referenced in [emcie-co/parlant#530](../../emcie-co/parlant/issues/530.md) on 2025-09-02 04:54_

---

_Comment by @AbdealiLoKo on 2025-10-21 12:15_

Came across the same issue ... just wanted to say, `pip` doesn't seem to have an issue here
```
$ uv venv venv --python 3.9 --seed
$ source venv/bin/activate
$ python -V
Python 3.9.23
$ pip install onnxruntime
...
Installing collected packages: mpmath, flatbuffers, sympy, protobuf, packaging, numpy, humanfriendly, coloredlogs, onnxruntime
Successfully installed coloredlogs-15.0.1 flatbuffers-25.9.23 humanfriendly-10.0 mpmath-1.3.0 numpy-2.0.2 onnxruntime-1.19.2 packaging-25.0 protobuf-6.33.0 sympy-1.14.0
```


---

_Referenced in [microsoft/onnxruntime#26375](../../microsoft/onnxruntime/issues/26375.md) on 2025-10-21 12:21_

---

_Comment by @konstin on 2025-10-21 12:24_

Thanks for raising this upstream!

A workaround that we since added is setting requires environments (https://docs.astral.sh/uv/concepts/resolution/#required-environments):

```toml
[tool.uv]
required-environments = ["python_version == '3.9'"]
```

This workaround asserts that there are wheels for this Python version.

---

_Referenced in [google/magika#1205](../../google/magika/pulls/1205.md) on 2025-10-29 14:16_

---
