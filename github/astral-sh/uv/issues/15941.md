---
number: 15941
title: Strange issue with multltasking library on ubuntu
type: issue
state: open
author: quantitative-technologies
labels:
  - bug
  - needs-mre
assignees: []
created_at: 2025-09-19T05:16:31Z
updated_at: 2025-10-03T06:14:46Z
url: https://github.com/astral-sh/uv/issues/15941
synced_at: 2026-01-07T12:31:16-06:00
---

# Strange issue with multltasking library on ubuntu

---

_Issue opened by @quantitative-technologies on 2025-09-19 05:16_

### Summary

Alternative runs result in an error:

```console
james@ubuntu-8gb-data-store:~/perpetual-arbitrage$ uv run python
error: Unable to uninstall `multitasking==0.0.12`. distutils-installed distributions do not include the metadata required to uninstall safely.
james@ubuntu-8gb-data-store:~/perpetual-arbitrage$ uv run python
Installed 1 package in 3ms
Python 3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> quit()
james@ubuntu-8gb-data-store:~/perpetual-arbitrage$ uv run python
error: Unable to uninstall `multitasking==0.0.12`. distutils-installed distributions do not include the metadata required to uninstall safely.
```

### Notes

This is an "inherited" dependency:

```console
[project]
name = "perpetual-arbitrage"
version = "0.1.0"
description = "Perpetual Arbitrage Strategy"
readme = "README.md"
requires-python = ">=3.12,<3.13"
dependencies = [
    "data-store",
    "fastparquet>=2024.11.0",
    "pandas",
    "tqdm>=4.67.1",
]

[tool.uv]
# hack to remove from lockfile: https://github.com/astral-sh/uv/issues/15566#issuecomment-3233440761
#override-dependencies = ["multitask==0.0.12; sys_platform=='never'"]  # { sys_platform = 'never' }"]

[tool.uv.sources]
data-store = { path = "../data-store", editable = true }

[dependency-groups]
analysis = [
    "ipykernel>=6.30.1",
    "jupytext>=1.17.3",
]
dev = [
    "mypy>=1.18.1",
    "pytest>=8.4.2",
]

[tool.setuptools.packages.find]
where = ["src", "../data-store"]
include = ["perpetual_arbitrage*", "data_store*"]
```

Before it fails I notice that `uv pip list` shows a double entry:
```console
...
multitasking              0.0.12
multitasking              0.0.12
...
```

* This only happens in ubuntu. On macos/zsh, there is a single multitasking entry in pip list, and no such error. 
* `data-store` is a private repo which I cannot share and not managed by uv. 
*  I do not know how to make a MRE for this.
* debug logs attached

[log.2.txt](https://github.com/user-attachments/files/22419919/log.2.txt)
[log.1.txt](https://github.com/user-attachments/files/22419920/log.1.txt)

### Platform

Ubuntu server, and macos laptop

### Version

ubuntu: uv 0.8.18, macos: uv 0.8.12

### Python version

Python 3.12.3

---

_Label `bug` added by @quantitative-technologies on 2025-09-19 05:16_

---

_Referenced in [astral-sh/uv#15566](../../astral-sh/uv/issues/15566.md) on 2025-09-19 05:34_

---

_Comment by @konstin on 2025-09-19 08:18_

Does the problem go away with `uv venv`? I can't reproduce it in a debian bookworm container.

---

_Label `needs-mre` added by @konstin on 2025-09-19 08:18_

---

_Comment by @quantitative-technologies on 2025-09-20 04:41_

No:

```console
james@ubuntu-8gb-data-store:~/perpetual-arbitrage$ uv venv
Using CPython 3.12.3 interpreter at: /usr/bin/python3.12
Creating virtual environment at: .venv
✔ A virtual environment already exists at `.venv`. Do you want to replace it? · yes
Activate with: source .venv/bin/activate
james@ubuntu-8gb-data-store:~/perpetual-arbitrage$ uv run python
Installed 167 packages in 811ms
Python 3.12.3 (main, Aug 14 2025, 17:47:21) [GCC 13.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> quit()
james@ubuntu-8gb-data-store:~/perpetual-arbitrage$ uv run python
error: Unable to uninstall `multitasking==0.0.12`. distutils-installed distributions do not include the metadata required to uninstall safely.
```

But of course you do not have my `data-store` library. 

I don't know if there is any point in me trying it in a debian container?

This should still work on ubuntu.

---

_Comment by @konstin on 2025-09-23 12:08_

The duplicate entry in `uv pip list` is odd, can you check the contents of `.venv/lib/python3.13/site-packages`, what entries for `multitasking` are in there?

---

_Comment by @netoarmando on 2025-10-01 12:55_

I'm facing the same issue, on my local virtual machine running bookworm (arm) and on host running macos I see no error. 

On my remote VM (also bookwork) I get the error (not on multitasking but on an internal private package), when running `uv sync --verbose --no-dev`.

If I re-run it works, If run once more it fails. Output log is similar, it's just a different package.

---

_Comment by @konstin on 2025-10-01 13:44_

@netoarmando  can you check the contents of `.venv/lib/python3.13/site-packages`, what entries for `multitasking` are in there?



---

_Comment by @netoarmando on 2025-10-01 14:09_

I don't have it. In my case the issue is happening with a private package, installed from a local pypi server. 
Also, pip freeze lists that package only once, and it's a direct dependency of my app.

---

_Comment by @netoarmando on 2025-10-01 15:01_

I couldn’t create a reproducer, but I managed to fix it for me.

* I updated the problematic dependency with `uv add my_dep --upgrade-package my_dep`
* After that, `uv sync --verbose --no-dev` no longer complained.
* `git restore .` to return to the previous state

And now `uv sync --verbose --no-dev` runs without a problem!

Worth noting: before this, I had already tried deleting the `.venv` and clearing the uv cache, but that didn’t help.




---

_Comment by @quantitative-technologies on 2025-10-03 06:14_

> The duplicate entry in `uv pip list` is odd, can you check the contents of `.venv/lib/python3.13/site-packages`, what entries for `multitasking` are in there?

@konstin Sorry for taking so long.

I don't see anything unusual: Two subdirs: `multitasking` and `multitasking-0.0.12.dist-info`



---
