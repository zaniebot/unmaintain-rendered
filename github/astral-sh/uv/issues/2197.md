---
number: 2197
title: "Could `uv venv` detect whether source files are inside `src` directory (like Poetry does)?"
type: issue
state: closed
author: torarvid
labels:
  - question
assignees: []
created_at: 2024-03-05T07:50:31Z
updated_at: 2024-03-05T16:18:58Z
url: https://github.com/astral-sh/uv/issues/2197
synced_at: 2026-01-07T12:31:14-06:00
---

# Could `uv venv` detect whether source files are inside `src` directory (like Poetry does)?

---

_Issue opened by @torarvid on 2024-03-05 07:50_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->
Hi, and thanks for making `uv` ‚ù§Ô∏è

I experienced an issue converting an existing project at work from Poetry to uv, and tried making a minimal example to repro. Btw, I'm on macOS 14.3.1 using `uv 0.1.11 (32e5cacdd 2024-02-26)`.

## Part 1 ‚Äî Poetry

I tried a hello-example looking like this ‚Äî first using Poetry 1.7.1:

```bash
‚ùØ tree
.
‚îú‚îÄ‚îÄ pyproject.toml
‚îî‚îÄ‚îÄ src
    ‚îî‚îÄ‚îÄ hello.py

2 directories, 2 files
```
pyproject.toml contents:
```
[tool.poetry]
name = "hello"
version = "0.1.0"
description = ""
authors = ["Your Name <you@example.com>"]

[tool.poetry.dependencies]
python = "^3.12"

[build-system]
requires = ["poetry-core"]
build-backend = "poetry.core.masonry.api"
```
and hello.py contents:
```
print("Hello, world")
```
I then run:
```bash
‚ùØ poetry install
Creating virtualenv hello-sRlYik7q-py3.12 in /Users/torarvid/Library/Caches/pypoetry/virtualenvs
Installing dependencies from lock file

Installing the current project: hello (0.1.0)
‚ùØ poetry run python -m hello
Hello, world
```

If anybody wonders, `poetry run python` is a shim-like feature that will use the python interpreter defined in the poetry venv. All well and good. Now:

## Part 2 ‚Äî uv

I change pyproject.toml (in case it matters, I'm not sure whether it only does for `uv pip`?) to:
```
[project]
name = "hello"
version = "0.1.0"
requires-python = "~=3.12"
authors = [{ email = "Your Name <you@example.com>" }]
description = ""

[build-system]
requires = ["setuptools >= 69"]
build-backend = "setuptools.build_meta"
```
Same hello.py inside `src`. I run:
```bash
‚ùØ uv venv
Using Python 3.12.1 interpreter at /Users/torarvid/.local/share/mise/installs/python/3.12.1/bin/python3
Creating virtualenv at: .venv
Activate with: source .venv/bin/activate
‚ùØ source .venv/bin/activate.fish
‚ùØ python -m hello
/Users/torarvid/dev/hello/.venv/bin/python: No module named hello
```

## Part 3 ‚Äî what is wrong?

I don't know if there's possibly something I should add to pyproject.toml to inform `uv` about the `src` directory being "an entrypoint folder" or whatever it should be called üòä But I *did* figure out the reason why it works using poetry: If I look in the venv created by poetry, there's this:

```bash
‚ùØ ls /Users/torarvid/Library/Caches/pypoetry/virtualenvs/hello-sRlYik7q-py3.12/lib/python3.12/site-packages/
__pycache__  _virtualenv.pth  _virtualenv.py  hello-0.1.0.dist-info  hello.pth  pip  pip-23.3.1.dist-info  pip-23.3.1.virtualenv
```
The `hello.pth` file contains just `/Users/torarvid/dev/hello/src`. If I place a file like that in the `uv`-created venv, it also works just fine.

I have not investigated how poetry has implemented any logic that results in them creating this .pth file, so whether they look at all project folders containing .py files or have hard-coded support for some folders like "src", "tests" or whatever I don't know.

But in any case, it's probably not that uncommon to have a repo where the sources are inside a src sub-folder.

Would be a bit ironic if I wrote this long issue and it turns out to be a simple one-liner I need to fix in my pyproject.toml or something, but anyway ‚Äî might help somebody else who runs into this in the future üòÑ Have a nice day!

---

_Comment by @woutervh on 2024-03-05 12:25_

Poetry does not do auto-detection.

You are missing a packages in pyproject.toml:
```
[tool.poetry]
packages = [{ include = "hello", from = "src" }]

```

but a package is a subdirectory with an __init__.py.
Move  hello.py  into hello/__init__.py
Otherwise you get an error like this:
```
> poety install
   .../src/hello does not contain any element
```

---

_Comment by @torarvid on 2024-03-05 13:15_

@woutervh Thanks, but this issue isn't really about getting anything to work with Poetry (that already works just fine as I see it). It is about how to get things to work when transitioning from Poetry to uv.

---

_Comment by @woutervh on 2024-03-05 13:49_

```
 (that already works just fine as I see it)
```
I'm actually baffled that this works,  it shouldn't.
As far as I'm concerned, this works by accident. 
I really hate tools creating their own magic and their ows hardcoded conventions.
This only complicates teaching proper python-packaging.

---

_Comment by @zanieb on 2024-03-05 15:08_

It looks like you never installed your project into the virtual environment, have you tried `uv pip install -e .`? This is roughly equivalent to `poetry install`.

---

_Label `question` added by @zanieb on 2024-03-05 15:08_

---

_Comment by @torarvid on 2024-03-05 16:16_

@woutervh I recommend you make an issue in the poetry repo üëçüèª 

---

_Comment by @torarvid on 2024-03-05 16:18_

@zanieb Yes, thank you! This was it. So in conclusion: I'm a user somewhat familiar with Poetry and not familiar with pip (or the `uv pip ...` syntax) who's trying to convert a repo from Poetry to uv, and my lack of knowledge tripped me up üòÑ

Ok, so this seems to solve my problem completely, thanks a lot. Will close the issue.

---

_Closed by @torarvid on 2024-03-05 16:18_

---
