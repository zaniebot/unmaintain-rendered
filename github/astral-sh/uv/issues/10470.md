---
number: 10470
title: "Workspace members with a missing `build-system` are wrongly detected as `virtual` deps rather than `directory` ones"
type: issue
state: closed
author: P-E-Meunier
labels:
  - needs-mre
assignees: []
created_at: 2025-01-10T12:55:09Z
updated_at: 2025-01-25T02:54:01Z
url: https://github.com/astral-sh/uv/issues/10470
synced_at: 2026-01-07T12:31:15-06:00
---

# Workspace members with a missing `build-system` are wrongly detected as `virtual` deps rather than `directory` ones

---

_Issue opened by @P-E-Meunier on 2025-01-10 12:55_

A member of one of my workspaces has the following build-system section in its `pyproject.toml`:

```
[build-system]
requires = ["pdm-backend"]
build-backend = "pdm.backend"
```

When running `uv lock` from the workspace, the section for the global workspace reads:

```

[[package]]
name = "my-workspace"
version = "0.1.0"
source = { virtual = "." }
dependencies = [
    { name = "member" },
]

[package.metadata]
requires-dist = [
    { name = "member", virtual = "visualization" },
]
```

If I add the build system section, it is correctly detected as a `directory` dependency.

I would have expected an error or a warning from `uv lock`. I realise this can be used for recursive workspaces: in my case, I would have spotted the issue much faster if `uv lock` had printed a recap of the workspace structure at the end of its run.

---

_Comment by @charliermarsh on 2025-01-10 13:13_

Can you include a more complete example, like a Git repo that I can clone to understand the problem?

---

_Label `needs-mre` added by @charliermarsh on 2025-01-10 13:13_

---

_Comment by @charliermarsh on 2025-01-25 02:54_

Closing due to lack of follow-up.

---

_Closed by @charliermarsh on 2025-01-25 02:54_

---
