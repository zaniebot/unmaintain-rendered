---
number: 17332
title: "Eliminate dependency resolution for frequent `uvx` calls"
type: issue
state: closed
author: zmeir
labels:
  - question
assignees: []
created_at: 2026-01-06T09:48:33Z
updated_at: 2026-01-06T22:16:35Z
url: https://github.com/astral-sh/uv/issues/17332
synced_at: 2026-01-07T12:31:16-06:00
---

# Eliminate dependency resolution for frequent `uvx` calls

---

_Issue opened by @zmeir on 2026-01-06 09:48_

### Question

I have a use-case in which I am required to run `uvx` frequently with the same exact arguments.

For example:
```bash
uvx --index https://corporate.index.com/simple --index-strategy unsafe-best-match my-tool
```

I know the first run will take longer because it needs to build up the cache,
but I expected the next immediate run to take milliseconds because the cache is already there and nothing in the indices changed.

What actually happens is that the next call (even seconds after the first) still takes about 5 because it needs to complete the dependency resolution, while still eventually using the tool from the cache.

I assume this problem is less prevalent when using just the default pypi index.

I was wondering if there is some option to tell `uvx` to skip dependency resolution if the cache already provides the requested tool and it is not too stale?

I know I can roughly achieve the behavior I want by adding the `--offline` flag, but then I will need to run multiple commands:
1. Check if cache exists / last tool invocation
2. If too stale - run `uvx` without the `--offline` flag
3. If fresh enough - run `uvx --offline`

However, in my scenario I am constrained to use only a single command.

Additionally, I can't run `uv tool install` as a preliminary step.

### Platform

Darwin 23.6.0 arm64

### Version

uv 0.9.21 (0dc9556ad 2025-12-30)

---

_Label `question` added by @zmeir on 2026-01-06 09:48_

---

_Comment by @konstin on 2026-01-06 18:32_

> Additionally, I can't run `uv tool install` as a preliminary step.

What's the problem with `uv tool install`? `uvx` is intentionally built as an on-the-fly command, while the full `uv tool` offers the control to install once and then use installed tools.

---

_Comment by @zanieb on 2026-01-06 18:48_

It sounds like you want https://github.com/astral-sh/uv/issues/10380

---

_Comment by @zanieb on 2026-01-06 19:03_

Is your index not returning cache control headers?

---

_Comment by @zmeir on 2026-01-06 20:27_

@konstin

> What's the problem with `uv tool install`?

No problem at all :)

The problem is with the constraints of my system.  
I am working with a framework that only allows me to set up a single command for tool definitions.
 

---

_Comment by @zmeir on 2026-01-06 21:00_

@zanieb 

> It sounds like you want https://github.com/astral-sh/uv/issues/10380

I think I actually need it the other way around ðŸ˜… 

If I understand correctly, this PR is about "online first, and offline as fallback".  
I want "offline first, and online as fallback".

> Is your index not returning cache control headers?

Huh, that's a good catch. I wasn't aware of that at all. Thanks!

I see UV allows me to [customize cache-control headers](https://docs.astral.sh/uv/concepts/indexes/#customizing-cache-control-headers).  
Sounds promising :)

---

_Comment by @charliermarsh on 2026-01-06 21:02_

Yeah we typically recommend the headers in the docs, which match PyPI:
```toml
[[tool.uv.index]]
name = "example"
url = "https://example.com/simple"
cache-control = { api = "max-age=600", files = "max-age=365000000, immutable" }
```

---

_Comment by @zanieb on 2026-01-06 21:33_

That issue also includes the inversion, e.g., https://github.com/astral-sh/uv/issues/10380#issuecomment-3219843390

---

_Comment by @zmeir on 2026-01-06 22:16_

Thank you all for the quick responses.  
I think I have all I need to take it from here.

Keep up the good work!

---

_Closed by @zmeir on 2026-01-06 22:16_

---
