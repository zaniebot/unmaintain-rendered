---
number: 13481
title: "failed to copy file from /home/runstone/.cache/uv/archive-v0/xxx/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)"
type: issue
state: closed
author: Abeautifulsnow
labels:
  - question
assignees: []
created_at: 2025-05-16T02:42:21Z
updated_at: 2025-11-26T15:21:14Z
url: https://github.com/astral-sh/uv/issues/13481
synced_at: 2026-01-07T12:31:16-06:00
---

# failed to copy file from /home/runstone/.cache/uv/archive-v0/xxx/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)

---

_Issue opened by @Abeautifulsnow on 2025-05-16 02:42_

### Summary

when I use uv to add some package or uv sync my project, I frequently encouter an error like this: Cannot allocate memory (os error 12)

```bash
â•°â”€îŠ…îŠ… uv sync
Resolved 117 packages in 2ms
Uninstalled 21 packages in 32ms
error: Failed to install: urllib3-2.3.0-py3-none-any.whl (urllib3==2.3.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/1AKRcdkKZzDz8LMvn-ZG7/urllib3-2.3.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/urllib3-2.3.0.dist-info/RECORD: Cannot allocate memory (os error 12)

â•°â”€îŠ…îŠ… uv add urllib3
Resolved 117 packages in 1.41s
warning: `aiohttp==3.11.13` is yanked (reason: "Regression: https://github.com/aio-libs/aiohttp/issues/10617")
warning: `aiohttp==3.11.13` is yanked (reason: "Regression: https://github.com/aio-libs/aiohttp/issues/10617")
      Built deer-flow @ file:///home/runstone/work/git/deer-flow
Prepared 1 package in 416ms
Uninstalled 17 packages in 26ms
error: Failed to install: h11-0.14.0-py3-none-any.whl (h11==0.14.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)


â•°â”€îŠ…îŠ… uv add uvicorn
Resolved 117 packages in 1ms
      Built deer-flow @ file:///home/runstone/work/git/deer-flow
Prepared 1 package in 1.15s
Uninstalled 17 packages in 35ms
error: Failed to install: urllib3-2.3.0-py3-none-any.whl (urllib3==2.3.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/1AKRcdkKZzDz8LMvn-ZG7/urllib3-2.3.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/urllib3-2.3.0.dist-info/RECORD: Cannot allocate memory (os error 12)

â•°â”€îŠ…îŠ… uv run server.py
      Built deer-flow @ file:///home/runstone/work/git/deer-flow
Uninstalled 17 packages in 36ms
error: Failed to install: h11-0.14.0-py3-none-any.whl (h11==0.14.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)

â•°â”€îŠ…îŠ… uv run python --version
Uninstalled 16 packages in 34ms
error: Failed to install: h11-0.14.0-py3-none-any.whl (h11==0.14.0)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)
```




### Platform

wsl1(Ubuntu-22.04) Linux 4.4.0-26100-Microsoft x86_64 GNU/Linux

### Version

uv 0.7.3

### Python version

Python 3.12.10

---

_Label `bug` added by @Abeautifulsnow on 2025-05-16 02:42_

---

_Renamed from "failed to copy file from /home/runstone/.cache/uv/archive-v0/MgAPJACNb6eRs6YxwdROY/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)" to "failed to copy file from /home/runstone/.cache/uv/archive-v0/xxx/h11-0.14.0.dist-info/RECORD to /home/runstone/work/git/deer-flow/.venv/lib/python3.12/site-packages/h11-0.14.0.dist-info/RECORD: Cannot allocate memory (os error 12)" by @Abeautifulsnow on 2025-05-16 02:43_

---

_Comment by @konstin on 2025-05-16 08:08_

How much RAM does the machine have, and are there any limits set on WSL1? Do you have any other processes running allocating a lot of memory?

---

_Label `bug` removed by @konstin on 2025-05-16 08:08_

---

_Label `needs-mre` added by @konstin on 2025-05-16 08:08_

---

_Comment by @Abeautifulsnow on 2025-05-16 09:09_

> How much RAM does the machine have, and are there any limits set on WSL1? Do you have any other processes running allocating a lot of memory?

![Image](https://github.com/user-attachments/assets/6713cd5c-7dca-4bde-8923-778cbf9ef0d6)

As you can see from the above, there is still several GB of RAM space available.

---

_Comment by @konstin on 2025-05-16 09:36_

Can you share a `pyproject.toml` that reproduces the problem? Does this happen with any package installation or only with specific packages?

---

_Comment by @Abeautifulsnow on 2025-05-16 15:05_

> Can you share a `pyproject.toml` that reproduces the problem? Does this happen with any package installation or only with specific packages?

Yes, here are the packages in `pyproject.toml` file.

```toml
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project]
name = "deer-flow"
version = "0.1.0"
description = "DeerFlow project"
readme = "README.md"
requires-python = ">=3.12"
dependencies = [
    "httpx>=0.28.1",
    "langchain-community>=0.3.19",
    "langchain-experimental>=0.3.4",
    "langchain-openai>=0.3.8",
    "langgraph>=0.3.5",
    "readabilipy>=0.3.0",
    "python-dotenv>=1.0.1",
    "socksio>=1.0.0",
    "markdownify>=1.1.0",
    "fastapi>=0.110.0",
    "uvicorn>=0.27.1",
    "sse-starlette>=1.6.5",
    "pandas>=2.2.3",
    "numpy>=2.2.3",
    "yfinance>=0.2.54",
    "litellm>=1.63.11",
    "json-repair>=0.7.0",
    "jinja2>=3.1.3",
    "duckduckgo-search>=8.0.0",
    "inquirerpy>=0.3.4",
    "arxiv>=2.2.0",
    "mcp>=1.6.0",
    "langchain-mcp-adapters>=0.0.9",
]
```

> Does this happen with any package installation or only with specific packages?

No, I think it is almost random and unpredictable.

I believe the situation is quite complex. When I have the following configurations in place, installation consistently fails. 

```toml
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"
```

However, in the absence of these configurations, some packages can be installed successfully. Yet, with certain other packages added to the mix, the installation fails again.

> may success

```toml
[project]
name = "demo"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
    "pandas>=2.2.3",
    "sqlalchemy>=2.0.38",
    "jinja2",
    "pydantic"
]
```

> may fail

```toml
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
    "pandas>=2.2.3",
    "sqlalchemy>=2.0.38",
    "jinja2",
    "pydantic",
    "langchain"
]
```

Error msg:

```text
â•°â”€îŠ…îŠ… uv sync
Resolved 42 packages in 1.41s
Uninstalled 21 packages in 2ms
error: Failed to install: pyyaml-6.0.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (pyyaml==6.0.2)
  Caused by: failed to copy file from /home/runstone/.cache/uv/archive-v0/faPVSNCp4ed1tazaCCLvN/PyYAML-6.0.2.dist-info/RECORD to /home/runstone/work/test/demo/.venv/lib/python3.10/site-packages/PyYAML-6.0.2.dist-info/RECORD: Cannot allocate memory (os error 12)
```

---

_Comment by @konstin on 2025-05-16 15:08_

Does reducing the number of concurrent installs, concurrent downloads and concurrent builds help (https://docs.astral.sh/uv/reference/settings/#concurrent-installs)?

---

_Closed by @konstin on 2025-05-16 15:08_

---

_Reopened by @konstin on 2025-05-16 15:08_

---

_Comment by @Abeautifulsnow on 2025-05-17 07:35_

> Does reducing the number of concurrent installs, concurrent downloads and concurrent builds help (https://docs.astral.sh/uv/reference/settings/#concurrent-installs)?

Thank you for your response. I have now set the concurrency level to `4`, and the builds are mostly successful. I also tried setting it to `8, 10, and 20`, but in those cases, failures became much more frequent. My machine has 20 CPU cores as reported by `nproc`. This behavior does seem quite strange. ðŸ˜‚

PS: *By the way, on my Windows host machine, everything behaves normally â€” there's no need to manually set the concurrency level.*

---

_Label `needs-mre` removed by @konstin on 2025-05-19 08:16_

---

_Label `question` added by @konstin on 2025-05-19 08:16_

---

_Comment by @konstin on 2025-05-19 08:16_

That means it's a limitation by the platform (WSL1), not by uv.

---

_Closed by @konstin on 2025-05-19 08:16_

---

_Comment by @vuljormp on 2025-10-07 07:18_

I ran into the same â€œCannot allocate memory (os error 12)â€ issue when installing the github-specify tool with uv on WSL1.

Just leaving this here in case it helps anyone â€” following @konstin suggestion to limit concurrent installs fixed it for me:

UV_CONCURRENT_INSTALLS=1 uv tool install specify-cli --from git+https://github.com/github/spec-kit.git

---

_Comment by @bangbao on 2025-11-12 05:31_

https://github.com/astral-sh/uv/issues/13481#issuecomment-3375527015
this is useful for me.

---

_Comment by @ssbarnea on 2025-11-26 12:19_

To be honest, I think that is is still a valid uv bug because while `free -g` reports 3 GB of free memory the tools still crashes with OOM. Some code should be added to disable concurrent installs on systems that seem to not have enough memory for such a simple operation.

If we would be talking about having less than 1GB a RAM, it would make sense but for this...

---

_Comment by @konstin on 2025-11-26 15:21_

Without more data, I don't think there's a good heuristic here. There's some builds that are just a Python process with a few imports and some files, and then there's builds such as uv's own build that take >4GB for a single project (linking with optimizations is the main culprit). 

For problems occuring on WSL1 specifically, is there a specific reason why not to upgrade to WSL2 which doesn't have this problem?

> To be honest, I think that is is still a valid uv bug because while `free -g` reports 3 GB of free memory the tools still crashes with OOM.

Do you have a reproducible example for this, an the specs (architecture and free RAM pre-build) of the machine where this occurs?

---
