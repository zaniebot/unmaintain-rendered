---
number: 7389
title: "uv pip install: warn when different packages install the same toplevel module"
type: issue
state: open
author: woutervh
labels:
  - error messages
assignees: []
created_at: 2024-09-14T09:51:51Z
updated_at: 2024-09-14T19:15:13Z
url: https://github.com/astral-sh/uv/issues/7389
synced_at: 2026-01-07T12:31:15-06:00
---

# uv pip install: warn when different packages install the same toplevel module

---

_Issue opened by @woutervh on 2024-09-14 09:51_

### Problem

One of the most diabolical anti-patterns in the Python ecosystem are published python-packages that 
contain a top-level pythonmodule that is named very different than the name of the published package.

A *lot* of django-packages are called `django-foo`, 
but import a toplevel-module `foo` instead of `django_foo`, while a package `foo` might exists.
This diabolical practice was promoted even in the official Django tutorial until recent recently, 
see https://forum.djangoproject.com/t/change-reusable-apps-naming-recommendation/25233

The problem is that you can happily install `foo` and `django-foo` in your project.
In most cases the second package will *overwrite* (not just shadow) the code of the first package.

To my knowledge there is no python-installation tool (pip, poetry,...) that will prevent this or warn about this.



### Example with uv

- dotenv
  https://pypi.org/project/dotenv/
  https://github.com/pedroburon/dotenv

- python-dotenv
  https://pypi.org/project/python-dotenv/
  https://github.com/theskumar/python-dotenv

- django-dotenv
  https://pypi.org/project/django-dotenv/
  https://github.com/jpadilla/django-dotenv
  https://github.com/jpadilla/django-dotenv/issues/50


```
>uv --version
uv 0.4.10
```


```
> mkdir /tmp/demo-dotenv
> cd /tmp/demo-dotenv
> uv venv 
Using Python 3.12.0 interpreter at: /opt/tools/pyenv/var/repo/versions/3.12.0/bin/python3
Creating virtualenv at: .venv
Activate with: source .venv/bin/activate

> uv pip install django-dotenv
uv pip install django-dotenv
Resolved 1 package in 11ms
Installed 1 package in 0.77ms
 + django-dotenv==1.4.2

> .venv/bin/python
Python 3.12.0 (main, Oct 15 2023, 13:31:57) [GCC 11.3.1 20221121 (Red Hat 11.3.1-4)] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import dotenv
>>> dotenv.__file__
'/tmp/demo-dotenv/.venv/lib/python3.12/site-packages/dotenv.py'

> uv pip install python-dotenv
>>> import dotenv
>>> dotenv.__file__
'/tmp/demo-dotenv/.venv/lib/python3.12/site-packages/dotenv/__init__.py'
```


The first installed `django-dotenv` is now installed in your project, but completely unusable.


### Downstream problems

There exists code, that will check on the importability of a toplevel module and goes on to assume a specific package is installed,

For example in Flask, see https://github.com/pallets/flask/blob/2fec0b206c6e83ea813ab26597e15c96fab08be7/src/flask/cli.py#L714
![image](https://github.com/user-attachments/assets/5718cc41-65de-4a62-82c2-d991ca3244f1)

The ImportError will not fail when `dotenv` or `django-dotenv` is installed, but the applicaiton will fail at runtime


### Solutions

1) outside uv-scope:
 The structural fix is that those package fix their toplevel-module into ``django_dotenv`` and ``python_dotenv``,

the (quite undocumented) python community standard for naming toplevel modules has always been:
```
toplevel_module_name = package_name.lower().replace("-", _")
```

2) could we have a warning we installing such conflicting packages?








---

_Comment by @edmorley on 2024-09-14 11:10_

In case it helps, some pip discussions about this can be found here:
- https://github.com/pypa/pip/issues/4625
- https://github.com/pypa/pip/pull/8119

---

_Label `error messages` added by @charliermarsh on 2024-09-14 12:29_

---

_Comment by @charliermarsh on 2024-09-14 12:30_

We definitely have the ability to warn here. We'd need to decide how opinionated we want to be about it, i.e., whether we'd want to show it unconditionally or not.

---

_Comment by @Aditya-PS-05 on 2024-09-14 13:10_

Hey team, 
## Solution As earlier discusses:  
```
outside uv-scope: The structural fix is that those package fix their toplevel-module into django_dotenv and python_dotenv,

the (quite undocumented) python community standard for naming toplevel modules has always been:

toplevel_module_name = package_name.lower().replace("-", "-")
```
Can I try to work on it?

---

_Comment by @paveldikov on 2024-09-14 13:52_

I would go as far as calling this a security-impacting issue. Typosquatting packages are able to overwrite the importable namespaces of other (much more established) OSS packages such as `requests` and `yaml` (two examples from personal experience).

Being able to warn (I'd say even *fail* -- at a minimum I'd like to have the option to make it fail) upon conflict will give developers & security teams the ability to detect supply-chain anomalies _much_ earlier in the process. E.g. if I declare a dependency on `requests` and `requetss` simultaneously, I'd rather find out sooner rather than later.

---
