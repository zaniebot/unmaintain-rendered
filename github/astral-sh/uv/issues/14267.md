---
number: 14267
title: "Packages that `pip` can install but `uv pip` cannot install in a conda env"
type: issue
state: open
author: edschofield
labels:
  - bug
assignees: []
created_at: 2025-06-26T02:30:50Z
updated_at: 2025-11-21T18:08:16Z
url: https://github.com/astral-sh/uv/issues/14267
synced_at: 2026-01-07T12:31:16-06:00
---

# Packages that `pip` can install but `uv pip` cannot install in a conda env

---

_Issue opened by @edschofield on 2025-06-26 02:30_

[uv_install_logs.tar.gz](https://github.com/user-attachments/files/20915431/uv_install_logs.tar.gz)

### Summary

`uv` seems to fail to recognize some macOS Universal wheels when running in a `conda` environment on Darwin x86_64.

The following four packages install fine using `pip install` but fail with compile errors using `uv pip install` on Darwin x86_64 with a brand-new `conda` environment:

- `greenlet`
- `pyarrow`
- `duckdb`
- `tabmat`

The first two packages are dependencies for important packages (e.g. for `sqlalchemy` and `pandas` with the parquet and feather extras).

Steps to reproduce:

```
conda create -n minimal python=3.12
conda activate minimal
uv pip install greenlet    # compile error
# but this works:
# pip install greenlet
```

Using `pip` finds and installs the wheel (e.g. `greenlet-3.2.3-cp312-cp312-macosx_11_0_universal2.whl`) when run from the conda environment. Using `uv pip` finds and installs the wheel when run from a `venv`, but seems to want to build the packages instead (and fails) when run from a conda environment.

This only affects these four packages out of ~225 packages specified in a large meta-package [Python Charmers](https://pythoncharmers.com) uses for training courses. Manually installing the above four packages with `pip install ...` allows the remaining packages to install successfully using `uv pip`.

Log outputs attached from `uv pip install --verbose greenlet` and `uv pip install --verbose pyarrow`.

Note that I get the same compile errors with `uv` from a conda environment using either the latest [Miniconda3](https://repo.anaconda.com/miniconda/Miniconda3-py313_25.5.1-0-MacOSX-x86_64.sh) or an old Anaconda installation from August 2020.

It may also be relevant that that some other packages do successfully build from source on the same platform: `uv pip install bottleneck` and `pip install bottleneck` both compile and install from source, whether run from a `conda` environment or a `venv`.

### Platform

Darwin 24.5.0 x86_64: macOS Sequoia 15.5

### Version

uv 0.7.15 (Homebrew 2025-06-25)

### Python version

Python 3.12

[uv_install_logs.tar.gz](https://github.com/user-attachments/files/20915437/uv_install_logs.tar.gz)

---

_Label `bug` added by @edschofield on 2025-06-26 02:30_

---

_Comment by @zanieb on 2025-06-26 02:40_

Does setting `MACOSX_DEPLOYMENT_TARGET=11.0` resolve the issue? (see https://docs.astral.sh/uv/reference/environment/#macosx_deployment_target)

The virtual environment install logs show we use a cached distribution, can you share logs with `--vv` and `--no-cache`?

---

_Comment by @edschofield on 2025-06-26 03:20_

Thanks for the reply @zanieb .

Setting `MACOSX_DEPLOYMENT_TARGET=11.0` makes no difference.

I've attached the more verbose logs from running `uv pip install -vv --no-cache greenlet` etc.:

[uv_install_logs_vv.tar.gz](https://github.com/user-attachments/files/20916040/uv_install_logs_vv.tar.gz)

---

_Comment by @edschofield on 2025-06-26 03:42_

Interesting: passing `--python-platform macos` actually succeeds in installing one of the four packages, `greenlet`:

```
# Succeeds:
uv pip install -vv --no-cache --python-platform macos greenlet
```

But the other three packages (`pyarrow`, `duckdb`, `tabmat`) still fail to install despite this flag:

```
# These still fail:
# uv pip install -vv --no-cache --python-platform macos pyarrow
# uv pip install -vv --no-cache --python-platform macos duckdb
# uv pip install -vv --no-cache --python-platform macos tabmat
```

Output attached:

[uv_install_logs_vv_python_platform_macos.tar.gz](https://github.com/user-attachments/files/20916594/uv_install_logs_vv_python_platform_macos.tar.gz)

---

_Comment by @charliermarsh on 2025-06-26 03:53_

I think all the `build/lib.macosx-10.15-x86_64-cpython-312/greenlet` logs indicate that the Conda Python install is somehow building for macOS 10.15, which would indeed lead to this behavior, since the greenlet wheels require macOS 11 or later.

---

_Comment by @edschofield on 2025-06-26 04:38_

Thanks @charliermarsh. (Thanks too for making `uv`; it's an amazing tool! Its speed has changed our workflow for training courses at [Python Charmers](https://pythoncharmers.com) from needing 20GB Docker images with 200+ packages pre-installed to requiring a far smaller Docker image and a single `uv pip install` command...)

Your diagnosis seems correct: adding the `--no-build` flag actually installs these packages successfully from within the `conda` environment:

```
uv pip install --no-build pyarrow greenlet duckdb tabmat
```

However, this pulls in non-current versions:

```
greenlet                  3.0.1
pyarrow                   17.0.0
duckdb                    0.10.3
tabmat                    4.0.0
```

i.e. from versions just before the projects stopped releasing wheels for macOS 10.x.

I've attached the output of this (with the `-vv --no-cache` flags) too:

[uv_no_build_install_logs.tar.gz](https://github.com/user-attachments/files/20917152/uv_no_build_install_logs.tar.gz)

In case it's helpful, I've also attached the output of `pip debug --verbose`, which shows the list of compatible tags as recognized by `pip` (again, from within the `conda` env). This looks normal to me.

[pip_debug_verbose.log](https://github.com/user-attachments/files/20917000/pip_debug_verbose.log)

Is there a way to determine the equivalent tags that `uv` recognizes as compatible?

---

_Comment by @tompropst on 2025-11-21 18:08_

Trying to find a related issue to attach https://github.com/juftin/browsr/issues/56 to. In that issue...

- `uv tool install "browsr[all]"` will fail when trying to build `pyarrow` (system Python is 3.10)
- `uv tool install -p 3.10 "browsr[all]"` succeeds

---
