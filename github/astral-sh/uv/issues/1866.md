---
number: 1866
title: uv pip compile conflicting URLs error for the same URL dependency
type: issue
state: closed
author: blueraft
labels:
  - bug
assignees: []
created_at: 2024-02-22T13:43:44Z
updated_at: 2024-02-22T16:44:38Z
url: https://github.com/astral-sh/uv/issues/1866
synced_at: 2026-01-07T12:31:14-06:00
---

# uv pip compile conflicting URLs error for the same URL dependency

---

_Issue opened by @blueraft on 2024-02-22 13:43_

Thanks for working on this! 

As the title suggests, I'm getting a requirements contain conflicting URLs for a package even when the URLs are the same. 

Using uv:
```shell 
❯ uv pip compile m1/pyproject.toml m2/pyproject.toml
error: Requirements contain conflicting URLs for package `ruff`:
- git+https://github.com/astral-sh/ruff.git@main
- git+https://github.com/astral-sh/ruff.git@main
```

This works fine with pip-compile.
```shell
❯ pip-compile --resolver=backtracking m1/pyproject.toml m2/pyproject.toml
#
# This file is autogenerated by pip-compile with Python 3.9
# by the following command:
#
#    pip-compile --resolver=backtracking m1/pyproject.toml m2/pyproject.toml
#
ruff @ git+https://github.com/astral-sh/ruff.git@main
    # via
    #   m1 (m1/pyproject.toml)
    #   m1 (m2/pyproject.toml)
```


```shell
❯ uv --version
uv 0.1.7
```

I'm able to fix it locally by adding an `if &previous != url {` statement before returning the following error.
https://github.com/astral-sh/uv/blob/e97b094bc90ae6c23b2b465679d5d9eff4979e4d/crates/uv-resolver/src/resolver/urls.rs#L30-L36

---

_Label `bug` added by @charliermarsh on 2024-02-22 13:44_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-02-22 13:44_

---

_Comment by @charliermarsh on 2024-02-22 13:45_

Thanks for the clear issue — this is my bad. That fix is roughly correct (though we should wrap both imports in CanonicalUrl so that we allow URLs that are “the same”). I can get to it and get this out today.

---

_Referenced in [astral-sh/uv#1877](../../astral-sh/uv/pulls/1877.md) on 2024-02-22 16:34_

---

_Closed by @charliermarsh on 2024-02-22 16:44_

---

_Closed by @charliermarsh on 2024-02-22 16:44_

---
