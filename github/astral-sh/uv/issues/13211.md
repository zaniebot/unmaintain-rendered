---
number: 13211
title: cz bump fails due to uv lock in pre-commit updating uv.lock
type: issue
state: closed
author: waterworthd-cim
labels:
  - question
assignees: []
created_at: 2025-04-30T03:17:44Z
updated_at: 2025-05-04T12:50:23Z
url: https://github.com/astral-sh/uv/issues/13211
synced_at: 2026-01-07T12:31:16-06:00
---

# cz bump fails due to uv lock in pre-commit updating uv.lock

---

_Issue opened by @waterworthd-cim on 2025-04-30 03:17_

### Question

I figured this out before I posted, so in case anyone is using the same tooling and has the same issue I'll rephrase so it's might be helpful to others.

I'm using commitizen (i.e. `cz bump`) to update by project version. When you run `cz bump` it updates the version (you can also use --devrelease and --prerelease), creates a change log, commits and adds a tag.

I'm also using the uv pre-commit hook that runs `uv lock`

Problem is `cz bump` updates `pyproject.yml`, updates the changelog and stages all files it's changed, adds the version tag. It then commits the change which triggers pre-commit to run `uv lock` which then fails as the lock file is modified and unstaged.

Unfortunalty cz doesn't back out it's changes, so you end up with a staged `pyproject.yml` and change log where the version has been bumped, no corresponding tag, and an unstaged `uv.lock`

I eventually found that commitizen has hooks, so I added a "pre-bump" hook

```
#!/bin/bash

uv lock
git add uv.lock
```

and updated the project file

[tool.commitizen]
```
pre_bump_hooks = [
  "scripts/commitizen_pre_bump_hook.sh"
]
```

Hopefully this will help someone

### Platform

_No response_

### Version

_No response_

---

_Label `question` added by @waterworthd-cim on 2025-04-30 03:17_

---

_Comment by @charliermarsh on 2025-05-04 12:50_

Thanks!

---

_Closed by @charliermarsh on 2025-05-04 12:50_

---
