---
number: 1552
title: allow duplicates of the same version of the same package
type: issue
state: closed
author: raylu
labels:
  - compatibility
assignees: []
created_at: 2024-02-16T23:28:09Z
updated_at: 2024-02-17T01:33:41Z
url: https://github.com/astral-sh/uv/issues/1552
synced_at: 2026-01-07T13:12:16-06:00
---

# allow duplicates of the same version of the same package

---

_Issue opened by @raylu on 2024-02-16 23:28_

we have multiple requirements.txt files with the same package at the same version (thanks to `pip-sync -c requirements1.txt requirements2.in`)

```
$ uv pip sync <(echo packaging==23.1) <(echo packaging==23.1)
error: Failed to determine installation plan
  Caused by: Detected duplicate package in requirements: packaging
```

I think the check here is too strict https://github.com/astral-sh/uv/blob/4e0b6f8f849bdbc9e21ab302eb8c8dcb1e81fe6d/crates/uv-installer/src/plan.rs#L125-L130

---

_Referenced in [astral-sh/uv#1554](../../astral-sh/uv/issues/1554.md) on 2024-02-16 23:58_

---

_Comment by @ericbn on 2024-02-17 00:03_

pip-tools works as expected:
```
$ pip-sync <(echo packaging==23.1) <(echo packaging==23.1)
...
Installing collected packages: packaging
Successfully installed packaging-23.1
```

pip-tools will only fail if there are incompatible requirements found:
```
$ pip-sync <(echo packaging==23.1) <(echo packaging==23.2)
Incompatible requirements found: packaging==23.2 (from -r /dev/fd/12 (line 1)) and packaging==23.1 (from -r /dev/fd/11 (line 1))
```

I'd like to see both behaviors in uv too.

---

_Label `compatibility` added by @charliermarsh on 2024-02-17 00:07_

---

_Comment by @charliermarsh on 2024-02-17 00:08_

I think this makes sense, though I'm not sure what should happen if the requirements overlap? E.g., `packaging==23.2` and `packaging<=24` or something.

---

_Assigned to @charliermarsh by @charliermarsh on 2024-02-17 00:24_

---

_Comment by @ericbn on 2024-02-17 00:25_

pip-sync seems to work only when the duplicated requirements are exactly the same, otherwise it will fail with `Incompatible requirements found`. I guess it makes sense because it expects pinned versions generated by pip-compile (like `==23.2`), not ranges like `<=24` or anything else.

```
$ pip-sync <(echo 'packaging==23.2') <(echo 'packaging<=24')
Incompatible requirements found: packaging<=24 (from -r /dev/fd/12 (line 1)) and packaging==23.2 (from -r /dev/fd/11 (line 1))
```

---

_Comment by @ericbn on 2024-02-17 00:30_

See https://github.com/jazzband/pip-tools/issues/786

---

_Referenced in [astral-sh/uv#1558](../../astral-sh/uv/pulls/1558.md) on 2024-02-17 01:19_

---

_Comment by @charliermarsh on 2024-02-17 01:19_

Fixed in https://github.com/astral-sh/uv/pull/1558.

---

_Closed by @charliermarsh on 2024-02-17 01:33_

---
