---
number: 16684
title: bootstrapping problem with keyring in pyproject.toml to access internal index
type: issue
state: open
author: woutervh
labels:
  - enhancement
assignees: []
created_at: 2025-11-11T11:33:55Z
updated_at: 2025-11-13T13:56:17Z
url: https://github.com/astral-sh/uv/issues/16684
synced_at: 2026-01-07T12:31:16-06:00
---

# bootstrapping problem with keyring in pyproject.toml to access internal index

---

_Issue opened by @woutervh on 2025-11-11 11:33_

### Summary


```
> uv --version
 v0.9.8
```


From the docs
https://docs.astral.sh/uv/guides/integration/alternative-indexes/#authenticate-with-keyring-and-keyringsgoogle-artifactregistry-auth

> uv only supports using the keyring package in [subprocess mode](https://docs.astral.sh/uv/reference/settings/#keyring-provider). The keyring executable must be in the PATH, i.e., installed globally or **in the active environment**. The keyring CLI requires a username in the URL and it must be oauth2accesstoken.


I guess this use case is not yet supported:  
- I want to define an internal dependency + internal index in pyproject.toml
- I install keyring as a dev-dependency in pyproject.toml

then start new venv  from scratch with this pyproject.toml:

```
> uv sync --only-group dev
> uv sync
```
But uv does not find the executable need in .venv/bin?

You really need to source activate?   (which I want to avoid in my workflow)


### Example

in pyproject.toml
```
...
dependencies = [
    "<internal-package>"
]

[dependency-groups]
dev= [
     ....
    "keyring>=25.6.0",
    "keyrings-google-artifactregistry-auth>=1.1.2",
]

# Settings reference: https://docs.astral.sh/uv/reference/settings/#index
[[tool.uv.index]]
explicit = true
name = "<organisation>"
url = "https://oauth2accesstoken@<private-index-url>/simple"

```


uv sync installs keyring in the venv and then uses that to fetch internal packages

```
uv sync
````

---

_Label `enhancement` added by @woutervh on 2025-11-11 11:33_

---

_Referenced in [astral-sh/uv#16704](../../astral-sh/uv/issues/16704.md) on 2025-11-12 13:16_

---

_Comment by @zanieb on 2025-11-12 16:42_

We need to hit the index to lock your dependencies, which needs to happen before syncing, so in general we cannot discover the keyring inside the virtual environment because we can't construct the environment until after using it.

---

_Comment by @woutervh on 2025-11-13 09:55_

> We need to hit the index to lock your dependencies, which needs to happen before syncing,

This would apply to *all* dependencies even if you only execute this? 
> uv sync --only-group dev


---

_Comment by @zanieb on 2025-11-13 13:56_

Yes we resolve _all_ dependencies together to create a coherent `uv.lock`, even if you're only going to install a subset.

---
