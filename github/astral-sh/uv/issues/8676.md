---
number: 8676
title: "`uv pip compile --universal` outputs requirements with `python_version < '0'` marker"
type: issue
state: closed
author: notatallshaw-gts
labels:
  - bug
  - lock
assignees: []
created_at: 2024-10-29T18:10:55Z
updated_at: 2024-11-01T20:11:41Z
url: https://github.com/astral-sh/uv/issues/8676
synced_at: 2026-01-07T12:31:15-06:00
---

# `uv pip compile --universal` outputs requirements with `python_version < '0'` marker

---

_Issue opened by @notatallshaw-gts on 2024-10-29 18:10_

uv 0.4.28

requirements.in:
```
apache-airflow[microsoft.azure]==2.3.4
scikit-learn==1.2.2
ipython>=8.4.0
mypy
black
```

constraints.txt:
```
apache-airflow-providers-microsoft-azure==4.2.0
attrs==22.1.0
azure-identity==1.10.0
click==8.1.3
colorama==0.4.5
markdown-it-py==2.1.0
msal-extensions==1.0.0
msrestazure==0.6.4
numpy==1.22.4
packaging==21.3
portalocker==2.5.1
typing_extensions==4.3.0
```

Command:
```
$ uv pip compile requirements.in -c constraints.txt  --annotation-style line --python 3.10 --universal | grep "'0'"
Resolved 190 packages in 740ms
apache-airflow-providers-ftp==3.11.1 ; python_version < '0'  # via apache-airflow
apache-airflow-providers-http==4.13.1 ; python_version < '0'  # via apache-airflow
apache-airflow-providers-imap==3.7.0 ; python_version < '0'  # via apache-airflow
apache-airflow-providers-sqlite==3.9.0 ; python_version < '0'  # via apache-airflow
azure-core==1.31.0 ; python_version < '0'  # via azure-identity
azure-cosmos==4.7.0 ; python_version < '0'  # via apache-airflow-providers-microsoft-azure
azure-keyvault-secrets==4.9.0 ; python_version < '0'  # via apache-airflow-providers-microsoft-azure
azure-mgmt-resource==23.2.0 ; python_version < '0'  # via apache-airflow-providers-microsoft-azure
azure-servicebus==7.12.3 ; python_version < '0'  # via apache-airflow-providers-microsoft-azure
black==24.10.0 ; python_version < '0'  # via -r requirements.in
cattrs==24.1.2 ; python_version < '0'  # via apache-airflow
connexion==3.1.0 ; python_version < '0'  # via apache-airflow
jsonschema==4.23.0 ; python_version < '0'  # via apache-airflow, flask-appbuilder
mypy==1.13.0 ; python_version < '0'  # via -r requirements.in
rich==13.9.3 ; python_version < '0'  # via apache-airflow
scipy==1.14.1 ; python_version < '0'  # via scikit-learn
```

---

_Comment by @BurntSushi on 2024-10-29 18:18_

I'll take a closer look at this tomorrow. Do you have an expected result? Or just stumbled across the strange output?

---

_Assigned to @BurntSushi by @BurntSushi on 2024-10-29 18:18_

---

_Label `resolver` added by @BurntSushi on 2024-10-29 18:18_

---

_Comment by @notatallshaw-gts on 2024-10-29 18:20_

This is an MRE derived from a real requirements set. I think the output file still works, for every `python_version < '0'` marker there is a requirement above it (on a different version) without a marker, e.g.

```
rich==13.3.1              # via apache-airflow
rich==13.9.3 ; python_version < '0'  # via apache-airflow
```

I would expect the lines with the `python_version < '0' ` to not be in the output, appears to be some internal resolver state?

---

_Label `bug` added by @charliermarsh on 2024-10-29 18:20_

---

_Referenced in [astral-sh/uv#8759](../../astral-sh/uv/pulls/8759.md) on 2024-11-01 18:28_

---

_Label `resolver` removed by @BurntSushi on 2024-11-01 18:31_

---

_Label `lock` added by @BurntSushi on 2024-11-01 18:31_

---

_Comment by @BurntSushi on 2024-11-01 18:31_

@notatallshaw-gts Thanks for the excellent repro! This should be fixed by #8759.

---

_Closed by @BurntSushi on 2024-11-01 20:11_

---

_Closed by @BurntSushi on 2024-11-01 20:11_

---

_Referenced in [astral-sh/uv#8976](../../astral-sh/uv/pulls/8976.md) on 2024-11-11 13:36_

---
