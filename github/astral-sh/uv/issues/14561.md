---
number: 14561
title: Build/Metadata Hook
type: issue
state: open
author: ninoseki
labels:
  - enhancement
  - wish
assignees: []
created_at: 2025-07-11T10:00:16Z
updated_at: 2025-11-14T17:00:35Z
url: https://github.com/astral-sh/uv/issues/14561
synced_at: 2026-01-07T12:31:16-06:00
---

# Build/Metadata Hook

---

_Issue opened by @ninoseki on 2025-07-11 10:00_

### Summary

I think it would be better if uv's build backend had the same hooks as Hatch. The build hook and the metadata hook.
Could you consider support them in the build backend, please?

### Example

- Build hook: https://hatch.pypa.io/1.1/plugins/build-hook/
- Metadata hook: https://hatch.pypa.io/1.1/plugins/metadata-hook/

---

_Label `enhancement` added by @ninoseki on 2025-07-11 10:00_

---

_Comment by @zanieb on 2025-07-11 13:05_

Plugins and dynamic metadata aren't in scope for the build backend yet, they add a lot of complexity.

---

_Label `wish` added by @zanieb on 2025-07-11 13:05_

---

_Comment by @zanieb on 2025-07-11 13:05_

Can you share more about your use-case?

---

_Comment by @ninoseki on 2025-07-11 23:02_

> Can you share more about your use-case?

- Build hook use-cases:
  - Setting a version based on VCS:
    - https://github.com/ofek/hatch-vcs?#build-hook ([2.3k files](https://github.com/search?q=%22tool.hatch.build.hooks.vcs%22%20path%3Apyproject.toml&type=code))
    - https://github.com/ninoseki/uv-dynamic-versioning/blob/main/docs/version_source.md  ([0.5k files](https://github.com/search?q=%22uv-dynamic-versioning%22+AND+%22tool.hatch.version%22+path%3Apyproject.toml&type=code))
- Metadata hook use-cases:
  - Setting dependencies based on requirements.txt:
    - https://github.com/repo-helper/hatch-requirements-txt ([0.5k files](https://github.com/search?q=%22tool.hatch.metadata.hooks.requirements_txt%22++path%3Apyproject.toml&type=code))
  - Setting dependencies dynamically based on VCS:
    - https://github.com/ninoseki/uv-dynamic-versioning/blob/main/docs/metadata_hook.md:
      - It's used by a very few projects. But a popular project like [Pydantic AI uses this](https://github.com/pydantic/pydantic-ai/blob/2b7899b6af5fb420a7988941df52a6f4f65788c8/clai/pyproject.toml#L48-L51).

---

_Comment by @matdibu on 2025-07-23 09:24_

I'm currently using Hatch in a lot of projects exclusively for codegen (grpcio-tools) via `tool.hatch.build.hooks.custom`

is this something that the `uv_build` backend is going to provide at some point in the future? thanks

---

_Referenced in [marimo-team/marimo#5778](../../marimo-team/marimo/pulls/5778.md) on 2025-07-28 03:16_

---

_Comment by @gwdekker on 2025-08-19 06:57_

Another usecase is for `polylith` - a monorepo tool for python. The `hatch` based build backend allows for letting it hook into the build process, while not having hooks available makes it need the workaround doucmented in the polylith docs for `maturin`: https://github.com/DavidVujic/python-polylith/discussions/353

---

_Comment by @brant-qai on 2025-08-25 15:33_

The dynamic versioning in particular is a very common use case. I have to either use hatch+uv-dynamic-versioning or setuptools+setuptools_scm and the only reason I'm still making use of those backends at all is dynamic versioning. 

The most **fire** would be for dynamic versioning from VCS to be builtin to UV; that would really give it that one-stop-shop feel (the same way ``uv format`` utilizing ruff under the hood does. I prefer not to manage a big suite of extra tools.

---

_Comment by @twsl on 2025-08-27 13:02_

Missing support for dynamic versioning is the only reason preventing me from switching away from poetry. Would love to see a build hook

---

_Comment by @ninoseki on 2025-08-28 02:06_

> Missing support for dynamic versioning is the only reason preventing me from switching away from poetry. 

ICYMI uv can handle it already along with Hatchling build backend. 

---

_Comment by @pygarap on 2025-08-28 02:11_

> > Missing support for dynamic versioning is the only reason preventing me from switching away from poetry.
> 
> ICYMI uv can handle it already along with Hatchling build backend.

@ninoseki People want to use dynamic-versioning, together with the [uv build backend](https://docs.astral.sh/uv/concepts/build-backend), not with any other build backend.

---

_Referenced in [astral-sh/uv#16011](../../astral-sh/uv/issues/16011.md) on 2025-09-24 09:09_

---

_Comment by @etienne-monier on 2025-10-20 11:44_

Hi,
Another use case: I need to build a javascript bundle to be served by my fastapi application. This is done at build time.

---

_Comment by @aaron-siegel on 2025-10-26 17:09_

Just chiming in here, we're currently using uv/hatch with dynamic versioning and it's hard to imagine life without it. (Thanks @ninoseki ; it made the move away from poetry a lot more palatable!)

I'd consider dynamic versioning support to be "table stakes" for us to consider any new build system.

---

_Comment by @villapx-path on 2025-11-14 17:00_

Our use case is that we have protobuf files (`*.proto`) that we want to compile into Python modules during the build, so that when clients install the package or during editable installs within a `uv` workspace, there is not an extra, manual step required to call `grpc_tools.protoc`. We needed to switch to hatchling for all of these packages within our workspace containing protobuf messages (we still use `uv_build` for all other packages in the workspace).

---

_Referenced in [IndicoDataSolutions/indico-client-python#412](../../IndicoDataSolutions/indico-client-python/pulls/412.md) on 2025-12-09 18:53_

---
