---
number: 12812
title: environment variables priorities with .env
type: issue
state: closed
author: baggiponte
labels:
  - question
assignees: []
created_at: 2025-04-10T16:39:00Z
updated_at: 2025-04-16T14:37:54Z
url: https://github.com/astral-sh/uv/issues/12812
synced_at: 2026-01-07T12:31:15-06:00
---

# environment variables priorities with .env

---

_Issue opened by @baggiponte on 2025-04-10 16:39_

### Summary

If:

1. an environment variable is already present in my env (Ã  la `export FOO=baz`) 
2. and I have it defined in my `.env` file too

Then, when I run `uv run --env-file=.env`, the value in `.env` is not read, while the pre-existing value is used.

Repro:

```bash
uv init
echo "FOO=bar" > .env

uv run -- python -c "import os; print(os.getenv('FOO'))"
# prints None âœ…

uv run --env-file=.env -- python -c "import os; print(os.getenv('FOO'))"
# prints bar âœ…

FOO=baz uv run -- python -c "import os; print(os.getenv('FOO'))"
# prints baz âœ…

FOO=baz uv run --env-file=.env -- python -c "import os; print(os.getenv('FOO'))"
# prints baz âŒ

export FOO=baz
uv run --env-file=.env -- python -c "import os; print(os.getenv('FOO'))"
# prints baz âŒ
```

I think what should happen is `--env-file=.env` takes priority over the value in the env. As a plus, `FOO=baz` takes priority over everything.

### Platform

macOS ARM 14.4.1 (23E224)

### Version

uv 0.6.14

### Python version

3.12

---

_Label `bug` added by @baggiponte on 2025-04-10 16:39_

---

_Comment by @Gankra on 2025-04-10 20:19_

I'm afraid the current behaviour is intended. I believe the intent here is that any environment variables that are ambient on the system are likely temporary for the current invocation (i.e. `UV_WHATEVER=1 uv sync`).

https://docs.astral.sh/uv/configuration/files/#env

> If the same variable is defined in the environment and in a .env file, the value from the environment will take precedence.




---

_Label `question` added by @Gankra on 2025-04-10 20:19_

---

_Label `bug` removed by @Gankra on 2025-04-10 20:19_

---

_Comment by @zanieb on 2025-04-10 21:51_

I believe this matches most other tools. I'd be curious to see counterexamples.

---

_Comment by @baggiponte on 2025-04-10 22:10_

> I'm afraid the current behaviour is intended. I believe the intent here is that any environment variables that are ambient on the system are likely temporary for the current invocation (i.e. `UV_WHATEVER=1 uv sync`).
> 
> [docs.astral.sh/uv/configuration/files#env](https://docs.astral.sh/uv/configuration/files/#env)
> 
> > If the same variable is defined in the environment and in a .env file, the value from the environment will take precedence.

OMG I can't read.

My usecase is: I have a global `OPENAI_API_KEY` for tools like aider. Though in some project folders I use different API keys (say for billing, tracing too). So this felt kinda odd and I wouldn't be sure how to avoid this otherwise.

Will check how python-dotenv does this tomorrow ðŸ˜Š

---

_Comment by @andrewbolster on 2025-04-16 13:45_

Duplicate/replica of https://github.com/astral-sh/uv/issues/9465

I was also 'surprised' by this; my expectation was --envfile > shellenv > systemenv

---

_Comment by @baggiponte on 2025-04-16 14:37_

> Duplicate/replica of [#9465](https://github.com/astral-sh/uv/issues/9465)
> 
> I was also 'surprised' by this; my expectation was --envfile > shellenv > systemenv

Nice catch, need to improve my googling. Thank you, closing as duplicate.

---

_Closed by @baggiponte on 2025-04-16 14:37_

---
