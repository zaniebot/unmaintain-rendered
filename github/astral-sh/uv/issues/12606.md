---
number: 12606
title: Add dedicated error message for conda environment.yml files
type: issue
state: closed
author: zanieb
labels:
  - help wanted
  - error messages
assignees: []
created_at: 2025-04-01T20:22:52Z
updated_at: 2025-04-07T23:11:45Z
url: https://github.com/astral-sh/uv/issues/12606
synced_at: 2026-01-07T12:31:15-06:00
---

# Add dedicated error message for conda environment.yml files

---

_Issue opened by @zanieb on 2025-04-01 20:22_

If used via `-r`, we should say we don't support these?

See https://github.com/astral-sh/uv/issues/12596

---

_Label `error messages` added by @zanieb on 2025-04-01 20:22_

---

_Label `help wanted` added by @zanieb on 2025-04-01 20:23_

---

_Comment by @zanieb on 2025-04-01 20:23_

I'm not quite sure how we'd detect this, but we could start with an exact name match special case on parse error?

---

_Comment by @christeefy on 2025-04-02 00:52_

I can give this a shot, @zanieb. 

To confirm, is it correct to say that:
- the changes will happen somewhere within `src/lib.rs::run` of the `uv` crate?
- on parse error, raise a dedicated error message if the filename matches `environment.yml`? 


---

_Comment by @zanieb on 2025-04-02 01:12_

I don't think it'd be in `lib.rs::run`, I think there we just parse a `PathBuf` into a `RequirementsSource`.  It'd be downstream where we are actually reading the requirements files?

I suggested special-casing the parse error because it's the "safest" option, we only fail if we were going to fail anyway. However, it's possible it'd be better to skip that and instead add a `RequirementsSource` variant `EnvironmentYml` which we construct when the path matches `environment.yml`. We'd then error on later, e.g., in `RequirementsSpecification::from_source`? I'm not sure without trying though.

---

_Comment by @christeefy on 2025-04-02 12:42_

Got it! I assumed that `RequirementsSource.from_requirements_file` would be fallible, but I see now that validation is deferred until `RequirementsSpecification::from_source`, as you pointed out. 

I'll try to implement a fix based on your suggestions, and may circle back here if I need extra clarification. 

---

_Referenced in [astral-sh/uv#12669](../../astral-sh/uv/pulls/12669.md) on 2025-04-04 12:25_

---

_Closed by @zanieb on 2025-04-07 23:11_

---

_Closed by @zanieb on 2025-04-07 23:11_

---
