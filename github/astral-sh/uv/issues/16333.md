---
number: 16333
title: Specify Python Version Resolution Rules
type: issue
state: open
author: powercoconola
labels:
  - enhancement
assignees: []
created_at: 2025-10-17T00:24:13Z
updated_at: 2025-12-21T17:30:12Z
url: https://github.com/astral-sh/uv/issues/16333
synced_at: 2026-01-07T12:31:16-06:00
---

# Specify Python Version Resolution Rules

---

_Issue opened by @powercoconola on 2025-10-17 00:24_

### Summary

When using commands like `uv tool install` or `uv run`, we should be able to specify that we want to use the lowest major Python version as specified in the `pyproject.toml`.

Similar to the existing `--resolution` flag and `UV_RESOLUTION` environment variable, we should add:

- `--python-resolution` flag
- `UV_PYTHON_RESOLUTION` environment variable
-  two possible values for this flag and environment variable: `lowest` and `highest`

The reason for implementing this feature is similar as the reason for the `--resolution` flag from the docs:

> When publishing libraries, it is recommended to separately run tests with --resolution lowest or --resolution lowest-direct in continuous integration to ensure compatibility with the declared lower bounds.

### Example


If the `pyproject.toml` of the tool has:

```pyproject.toml
[project]
requires-python = ">=3.12"
```

Currently, `uv tool install <tool>` tries to use the latest available Python version (currently 3.14.0).

If we do `uv tool install <tool> --python-resolution lowest`, uv would use the latest patch version of Python 3.12. (I don't see a use-case to go to the lowest patch version)



---

_Label `enhancement` added by @powercoconola on 2025-10-17 00:24_

---

_Comment by @konstin on 2025-10-17 08:28_

In the resolver algorithm, the Python version influences the selected package version: If you do `uv tool install foo -p 3.11` and the latest version has `requires-python = ">=3.12"`, we select a previous versions instead.

Is your use case testing in CI? For that, we recommend pinning the earliest and latest Python versions you want to test manually.

---

_Comment by @powercoconola on 2025-10-17 20:19_

> In the resolver algorithm, the Python version influences the selected package version: If you do uv tool install foo -p 3.11 and the latest version has requires-python = ">=3.12", we select a previous versions instead.

I see, then we would have to specify the version of the selected package, right? `uv tool install foo@latest --python-resolution lowest`. This way the user doesn't need to know what the `requires-python` field is because uv can figure that part out. An alternative would be: Do you know an easy way for an end-user to figure out what a package's `requires-python` value is beforehand to do it manually?

> pinning the earliest and latest Python versions you want to test manually.

For automation's sake this would be and is tedious to do when working with many packages.

---

_Comment by @powercoconola on 2025-10-17 20:29_

> Is your use case testing in CI?

My usecase is that I want to install the latest version of many tools (>100) and test them all at their earliest major Python `requires-python` version to validate everything is working correctly in production. The difficulty is resolving what that earliest major Python version is.

---

_Comment by @konstin on 2025-10-19 09:29_

I don't think you can do this with uv, the easiest here is a small Python script that parse out `requires-python` from `pyproject.toml` and install that version.

---

_Comment by @drammock on 2025-12-19 15:59_

Strong agree that this would be a very useful feature. It was very surprising to me that, given this `pyproject.toml` file:

```toml
[build-system]
build-backend = "hatchling.build"
requires = ["hatchling"]

[project]
name = "foobar"
dependencies = [
  "numpy >= 2.0"
]
version = "0.1.0"
requires-python = ">= 3.10"  # â† this isn't carried through to the resulting lockfile
```

...the command:

```sh
uv pip compile pyproject.toml --resolution lowest-direct --output-file pylock.toml
```

results in a lockfile specifying Python >= 3.13.1 (the version that happened to be first on my path when `uv pip compile ...` was run):

```toml
# This file was autogenerated by uv via the following command:
#    uv pip compile pyproject.toml --resolution lowest-direct --output-file pylock.toml
lock-version = "1.0"
created-by = "uv"
requires-python = ">=3.13.1"

[[packages]]
name = "numpy"
version = "2.0.0"
sdist = { url = "https://files.pythonhosted.org/packages/05/35/fb1ada118002df3fe91b5c3b28bc0d90f879b881a5d8f68b1f9b79c44bfe/numpy-2.0.0.tar.gz", upload-time = 2024-06-16T13:24:44Z, size = 18326228, hashes = { sha256 = "cf5d1c9e6837f8af9f92b6bd3e86d513cdc11f60fd62185cc49ec7d1aba34864" } }
```

Personally I think `--resolution lowest(-direct)` should affect *both* python version and package version, but I'd settle for a separate flag/envvar to control Python resolution strategy. 

This advice:

> Is your use case testing in CI? For that, we recommend pinning the earliest and latest Python versions you want to test manually.

is not satisfactory, I'm afraid. It is desirable that the `pyproject.toml` be the single source of truth for what the minimum viable version of Python is --- otherwise, we risk a mismatch between what we tell our users is the min version and what our CIs are actually testing.

Worse yet, the duplicate manual specification of lowest-viable-Python isn't even in a `matrix` or other obvious-place-to-look in the CI YAML file; it's buried in the `--python-version` flag of the `uv pip compile ...` command (making it harder to notice/find that it needs updating whenever `requires-python` gets bumped). Sure, I could manufacture a way to make it more prominent within the CI yaml file, but that's extra work / potentially confusing for future maintainers who need to edit that CI file.


---

_Comment by @zanieb on 2025-12-21 14:30_

@drammock you should be using `uv export` for `pyproject.toml` sources rather than `uv pip compile`. We'll use the `requires-python` then. Though we're still going to emit a file with markers for Python versions, so it might not fulfill your use-case.

---

_Comment by @drammock on 2025-12-21 17:30_

> you should be using `uv export` for `pyproject.toml` sources rather than `uv pip compile`

Ah wonderful! The script had originally been working from a `requirements.txt` input, when we switched it to start from pyproject I didn't think to switch the command too 

---
