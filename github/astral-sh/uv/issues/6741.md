---
number: 6741
title: "Unable to parse `allow-insecure-host` in pyproject.toml"
type: issue
state: closed
author: frague59
labels:
  - bug
assignees: []
created_at: 2024-08-28T10:21:17Z
updated_at: 2024-08-28T12:53:45Z
url: https://github.com/astral-sh/uv/issues/6741
synced_at: 2026-01-07T12:31:14-06:00
---

# Unable to parse `allow-insecure-host` in pyproject.toml

---

_Issue opened by @frague59 on 2024-08-28 10:21_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->
# pyproject.toml file

```sh
$ cat pyproject.toml
...
[tool.uv]
allow-insecure-host = ["https://example.com"]  # I've tried "example.com" too...

[tool.uv.pip]
extra-index-url = [
    "https://pypi.org/simple/",
    "https://example.com/simple/",  
]
```
# `uv pip install`

```sh
$ uv pip install -r requirements.txt  # some packages are in the example.com server
warning: Failed to parse `pyproject.toml` during settings discovery:
  TOML parse error at line 109, column 1
      |
  109 | [tool.uv]
      | ^^^^^^^^^
  invalid type: string "https://example.com", expected struct TrustedHost
```

**It seams the config de-serializer does not read the `allow-insecure-host` parameter ["https://example.com"] (resp. ["example.com"]) correctly**

The `--trusted-host` parameter works fine (when removing the `[tool.uv]` section from `pyproject.toml`.


---

_Comment by @frague59 on 2024-08-28 10:28_

It works with :
```toml

[tool.uv]
allow-insecure-host = [{ host = "example.com" }]
```

Maybe the config de-serializer should use a regex to parse the entry ?

Thanks ! 

---

_Comment by @frague59 on 2024-08-28 10:37_

# BTW :

```sh
$ uv --version 
uv 0.3.5
```

---

_Comment by @charliermarsh on 2024-08-28 12:53_

Apologies, this was fixed in #6716 which isn't released yet (but will be out today).

---

_Closed by @charliermarsh on 2024-08-28 12:53_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-08-28 12:53_

---

_Label `bug` added by @charliermarsh on 2024-08-28 12:53_

---
