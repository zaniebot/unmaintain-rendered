---
number: 5651
title: "`uv venv` fails on Windows when using ramdisk"
type: issue
state: closed
author: Artalus
labels:
  - bug
  - windows
assignees: []
created_at: 2024-07-31T13:49:59Z
updated_at: 2025-02-03T15:39:45Z
url: https://github.com/astral-sh/uv/issues/5651
synced_at: 2026-01-07T12:31:14-06:00
---

# `uv venv` fails on Windows when using ramdisk

---

_Issue opened by @Artalus on 2024-07-31 13:49_

I have a ramdisk created via [ImDisk](https://sourceforge.net/projects/imdisk-toolkit/) that I use as a temporary directory. Apparently `uv` does not like such setup:

```powershell
# uv works alright on a regular disk
PS E:\1> uv venv
Using Python 3.11.3 interpreter at: C:\python\311\python3.exe
Creating virtualenv at: .venv
Activate with: .venv\Scripts\activate

# uv fails on ramdisk
PS E:\1> cd r:/1
PS R:\1> uv venv
thread 'main' panicked at crates\uv-fs\src\path.rs:17:10:
The current directory must be canonicalized: Os { code: 1, kind: Uncategorized, message: "Incorrect function." }
stack backtrace:
   0:     0x7ff780d71fdd - <unknown>
   1:     0x7ff780d99cb9 - <unknown>
   2:     0x7ff780d6bbe1 - <unknown>
   3:     0x7ff780d71db6 - <unknown>
   4:     0x7ff780d747b8 - <unknown>
   5:     0x7ff780d74466 - <unknown>
   6:     0x7ff780d74ce8 - <unknown>
   7:     0x7ff780d74ba7 - <unknown>
   8:     0x7ff780d7294f - <unknown>
   9:     0x7ff780d74858 - <unknown>
  10:     0x7ff780ed5e84 - <unknown>
  11:     0x7ff780ed6320 - <unknown>
  12:     0x7ff780c6605b - <unknown>
  13:     0x7ff7800a975e - <unknown>
  14:     0x7ff780ed50a4 - <unknown>
  15:     0x7ff7800abbde - <unknown>
  16:     0x7ff77fa82162 - <unknown>
  17:     0x7ff77fa1d797 - <unknown>
  18:     0x7ff77fb01ddd - <unknown>
  19:     0x7ff77fe282ed - <unknown>
  20:     0x7ff77fc95bb4 - <unknown>
  21:     0x7ff77fe28f8a - <unknown>
  22:     0x7ff77fdd28ff - <unknown>
  23:     0x7ff78010ea1a - <unknown>
  24:     0x7ff77fdd4056 - <unknown>
  25:     0x7ff780d62c9e - <unknown>
  26:     0x7ff78010ea5c - <unknown>
  27:     0x7ff780e466bc - <unknown>
  28:     0x7ffb3de47374 - BaseThreadInitThunk
  29:     0x7ffb3e71cc91 - RtlUserThreadStart
PS R:\1> uv version
uv 0.2.31 (48162de97 2024-07-29)

# python 3.11 works on ramdisk
PS R:\1> python -m venv venv
PS R:\1> ls venv/Scripts/activate
-a----        2024-07-31  05:35 PM           2049 activate
```
I am pretty sure that Python's own `python -m venv` used to have some issues with ramdisks as well - the "must be canonicalized" error message does ring some bells.

---

_Comment by @zanieb on 2024-07-31 13:52_

This comes from 

https://github.com/astral-sh/uv/blob/24859bd3eebfe8fe50b187391e72dab91afb7093/crates/uv-fs/src/path.rs#L13-L18

I'm not sure _why_ it must be canonicalized. Seems like we could allow that to fail... hm.

---

_Label `bug` added by @zanieb on 2024-07-31 13:52_

---

_Label `windows` added by @zanieb on 2024-07-31 13:52_

---

_Comment by @Artalus on 2025-02-03 15:33_

Reading through the release notes and [`0.5.0`](https://github.com/astral-sh/uv/releases/tag/0.5.0) got my attention with

> Previously, uv canonicalized the path to the Python executable when setting the Python path in created virtual environments. This behavior had several undesirable effects: it would bypass stabilized version directories (as constructed by Homebrew) and it was not consistent with the Python standard library's behavior. Now, uv uses the sys._base_executable path.

Whether it was #8481 or not, my issue now appears to be fixed with `uv 0.5.26` installed from Scoop; both `uv venv` & `uv pip install` behave as usual.
@zanieb feel free to close this issue and do with it what your workflows require.

Thank you for your work, I adore this little tool ðŸ’š 

---

_Comment by @zanieb on 2025-02-03 15:39_

Oh great! Thank you!

<3

---

_Closed by @zanieb on 2025-02-03 15:39_

---
