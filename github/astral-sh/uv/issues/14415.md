---
number: 14415
title: "How does `uv tool install azure-cli` expected to work?"
type: issue
state: closed
author: stdedos
labels:
  - question
  - external
assignees: []
created_at: 2025-07-02T10:20:39Z
updated_at: 2025-07-02T15:24:12Z
url: https://github.com/astral-sh/uv/issues/14415
synced_at: 2026-01-07T12:31:16-06:00
---

# How does `uv tool install azure-cli` expected to work?

---

_Issue opened by @stdedos on 2025-07-02 10:20_

### Question

While using `pipx`, `pipx install azure-cli` "just works" and gives a workable `az` executable on `PATH`.

However, with `uv`:

```console
$ uv tool install azure-cli
Resolved 187 packages in 1.73s
Installed 187 packages in 220ms
 + adal==1.2.7
...
warning: The package `urllib3==2.5.0` does not have an extra named `secure`
Installed 3 executables: az, az.bat, az.completion.sh
$ az
/home/u/.local/bin/az: line 13: python: command not found
```

I am on Ubuntu 24.04, and no `python-is-python3` (_or whatever its name is_) is installed.

Am I doing something wrong?

I have checked:

- https://github.com/astral-sh/uv/issues?q=sort%3Aupdated-desc%20is%3Aissue%20uv%20tool%20install%20azure-cli
- https://github.com/astral-sh/uv/issues/9510
- https://github.com/astral-sh/uv/issues/4685

and did a partial/cursory read of https://docs.astral.sh/uv/guides/tools/#installing-tools.

Apologies in advance if I have missed something totally obvious.

### Platform

Ubuntu 24.04.2 Linux 6.8.0-62-generic x86_64 GNU/Linux

### Version

uv 0.7.15

---

_Label `question` added by @stdedos on 2025-07-02 10:20_

---

_Comment by @zanieb on 2025-07-02 14:24_

Interesting, this sort of looks like a bug with the `az` CLI? I'll investigate.

---

_Comment by @zanieb on 2025-07-02 15:07_

This is indeed a bug with their implementation. Their entry point is hand-written and invokes `python` directly:

```
#!/usr/bin/env bash

SOURCE="${BASH_SOURCE[0]}"
while [ -h "$SOURCE" ]; do # resolve $SOURCE until the file is no longer a symlink
  DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"
  SOURCE="$(readlink "$SOURCE")"
  [[ $SOURCE != /* ]] && SOURCE="$DIR/$SOURCE" # if $SOURCE was a relative symlink, we need to resolve it relative to the path where the symlink file was located
done
DIR="$( cd -P "$( dirname "$SOURCE" )" && pwd )"

export PYTHONPATH="${DIR}/src:${PYTHONPATH}"

python -m azure.cli "$@"
```

You can see this with `cat $(which az)`.

In contrast, a typical entry point looks like this:

```
â¯ cat $(which black)
#!/Users/zb/.local/share/uv/tools/black/bin/python
# -*- coding: utf-8 -*-
import sys
from black import patched_main
if __name__ == "__main__":
    if sys.argv[0].endswith("-script.pyw"):
        sys.argv[0] = sys.argv[0][:-11]
    elif sys.argv[0].endswith(".exe"):
        sys.argv[0] = sys.argv[0][:-4]
    sys.exit(patched_main())
```

Note the shebang invokes the proper `python` executable.

---

_Comment by @stdedos on 2025-07-02 15:10_

> You can see this with `cat $(which az)`.

I _did_, but I thought "that's a uv-generated file" (in midst of chaos, I decided to start using uv too ðŸ˜…)

... so ... I guess "nothing uv can do here", and "use the `uv tool ... --from=azure-cli ... az` format"? ðŸ¥²

---

_Comment by @zanieb on 2025-07-02 15:16_

You could `uv python install --default` and it _might_ work, because it'll find the `python` command on your `PATH`. It's pretty dubious though, we should report this upstream and suggest they move it.

For reference, the `scripts` usage is at https://github.com/Azure/azure-cli/blob/595a64468f82663e837debc6931e9b5a4a98554e/src/azure-cli/setup.py#L176-L181

It looks like this has been a longstanding problem on their end though

- https://github.com/Azure/azure-cli/pull/1042
- https://github.com/Azure/azure-cli/issues/1043
- https://github.com/Azure/azure-cli/issues/7367
- https://github.com/Azure/azure-cli/issues/3989
- https://github.com/Azure/azure-cli/pull/8208
- https://github.com/Azure/azure-cli/pull/10516

---

_Comment by @zanieb on 2025-07-02 15:20_

It actually looks like they've fixed this, but uv won't install the latest version because they have weird dependencies on pre-releases?

```
uv tool install --prerelease=allow azure-cli@latest
```

will unblock you

---

_Comment by @stdedos on 2025-07-02 15:23_

I saw it on _so many tickets_, but they were <~1y old - and I didn't have faith ðŸ¥²

Sorry; thank you ðŸ˜€ 

---

_Closed by @stdedos on 2025-07-02 15:23_

---

_Label `external` added by @zanieb on 2025-07-02 15:24_

---

_Referenced in [astral-sh/uv#14424](../../astral-sh/uv/issues/14424.md) on 2025-07-02 15:44_

---

_Referenced in [Azure/azure-cli#32406](../../Azure/azure-cli/issues/32406.md) on 2025-11-10 10:05_

---
