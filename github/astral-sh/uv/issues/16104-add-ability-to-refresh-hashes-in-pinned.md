---
number: 16104
title: "Add ability to refresh hashes in pinned requirements file (`uv pip compile`)"
type: issue
state: open
author: thejcannon
labels:
  - enhancement
assignees: []
created_at: 2025-10-02T17:22:56Z
updated_at: 2025-10-15T17:35:56Z
url: https://github.com/astral-sh/uv/issues/16104
synced_at: 2026-01-07T13:12:19-06:00
---

# Add ability to refresh hashes in pinned requirements file (`uv pip compile`)

---

_Issue opened by @thejcannon on 2025-10-02 17:22_

### Summary

I ran into the issue that we uploaded wheels for an sdist in our private Cheeseshop but users were still seeing sdist compilation. I narrowed it down to the fact that the pinned requirements file didn't have the hash for the new wheels, however rerunning `uv pip compile` wasn't adding it.

In trying to see if this is a duplicate issue I found https://github.com/astral-sh/uv/issues/1530 which means this is a feature not a bug!

I'd love to be able to have a command that has the behavior pre-bug-fix, where the pinned version stays the same but the available hashes can change/grow (in this case including the hashes of the newly uploaded wheels).

I imagine the easiest way to do this is some new flag a la `--update-hashes` (but am not picky).

(I tried `--refresh` but that didn't work. `--upgrade` doesn't work because ideally I keep the existing pins if possible)


### Example

Given https://pypi.org/project/uv/0.8.22/#uv-0.8.22.tar.gz as an example...

(Note `e6e12...` is the hash of the `uv` sdist)

```console
me@computer:~$  cat reqs.txt
# This file was autogenerated by uv via the following command:
#    uv pip compile - --output-file reqs.txt --generate-hashes
uv==0.8.22 \
    --hash=sha256:e6e1289c411d43e0ca245f46e76457f3807de646d90b656591b6cf46348bed5c
me@computer:~$ echo "uv" | uv pip compile - --output-file reqs.txt --generate-hashes --refresh -q
me@computer:~$  cat reqs.txt
# This file was autogenerated by uv via the following command:
#    uv pip compile - --output-file reqs.txt --generate-hashes
uv==0.8.22 \
    --hash=sha256:e6e1289c411d43e0ca245f46e76457f3807de646d90b656591b6cf46348bed5c
```

---

_Label `enhancement` added by @thejcannon on 2025-10-02 17:22_

---

_Comment by @konstin on 2025-10-06 13:18_

Usually hashes do not change once a version was released, which iirc was the motivation for https://github.com/astral-sh/uv/pull/2532.

As a workaround, you can use the existing resolution as constraints and generate a new one:
```
uv pip compile requirements.in -c requirements.txt --generate-hashes --refresh
```
or
```
echo "uv" | uv pip compile - -c reqs.txt --generate-hashes --refresh
```

---

_Comment by @qbedard on 2025-10-15 17:35_

The current functionality poses an issue if you are updating a subset of pinned package. If uv has re-locked uv.lock with the upgraded packages and you run `uv pip compile --generate-hashes`, it will bump the versions for the upgraded packages, **but not the hashes**.

---
