---
number: 10957
title: "Different outputs from `pip compile` when output file already exists"
type: issue
state: closed
author: AbdealiLoKo
labels:
  - bug
assignees: []
created_at: 2025-01-25T13:53:59Z
updated_at: 2025-01-25T21:37:27Z
url: https://github.com/astral-sh/uv/issues/10957
synced_at: 2026-01-07T12:31:15-06:00
---

# Different outputs from `pip compile` when output file already exists

---

_Issue opened by @AbdealiLoKo on 2025-01-25 13:53_

### Summary

When I use `pip compile` for the first time - it resolves a package for all versions of python.
But the second time - it removes the packages for newer versions of python from the previously generated output file.

Reproducible steps:

```
$ cat /tmp/req.in
zipp
$ rm /tmp/req.out

$ uv pip compile /tmp/req.in --python-version 3.8 --universal --constraint apps/corridor-api/requirements/recommended.txt --output-file=/tmp/req.out
Resolved 2 packages in 7ms
# This file was autogenerated by uv via the following command:
#    uv pip compile /tmp/req.in --python-version 3.8 --universal --constraint apps/corridor-api/requirements/recommended.txt --output-file=/tmp/req.out
zipp==3.20.2 ; python_full_version < '3.9'
    # via -r /tmp/req.in
zipp==3.21.0 ; python_full_version >= '3.9'
    # via -r /tmp/req.in

$ uv pip compile /tmp/req.in --python-version 3.8 --universal --constraint apps/corridor-api/requirements/recommended.txt --output-file=/tmp/req.out
Resolved 1 package in 11ms
# This file was autogenerated by uv via the following command:
#    uv pip compile /tmp/req.in --python-version 3.8 --universal --constraint apps/corridor-api/requirements/recommended.txt --output-file=/tmp/req.out
zipp==3.20.2
    # via -r /tmp/req.in
```

Expected Behavior: I was expecitng to get the same file again as no changes were done in `req.in`
Actual Behavior: `uv` is removing the different resolution per python version

### Platform

Windows 11 with Ubuntu 24.04 LTS on WSL 2

### Version

uv 0.5.24

### Python version

Python 3.11.9

---

_Label `bug` added by @AbdealiLoKo on 2025-01-25 13:53_

---

_Comment by @zanieb on 2025-01-25 16:50_

Thanks for the report! cc @charliermarsh 

I can reproduce with

```
❯ echo "zipp" | uv pip compile - --python-version 3.8 --universal --output-file=/tmp/req.out
warning: The requested Python version 3.8 is not available; 3.13.1 will be used to build dependencies instead.
Resolved 2 packages in 144ms
# This file was autogenerated by uv via the following command:
#    uv pip compile - --python-version 3.8 --universal --output-file=/tmp/req.out
zipp==3.20.2 ; python_full_version < '3.9'
zipp==3.21.0 ; python_full_version >= '3.9'

❯ echo "zipp" | uv pip compile - --python-version 3.8 --universal --output-file=/tmp/req.out
warning: The requested Python version 3.8 is not available; 3.13.1 will be used to build dependencies instead.
Resolved 1 package in 0.72ms
# This file was autogenerated by uv via the following command:
#    uv pip compile - --python-version 3.8 --universal --output-file=/tmp/req.out
zipp==3.20.2
```

---

_Comment by @charliermarsh on 2025-01-25 16:51_

Yup makes sense. Thanks.

---

_Assigned to @charliermarsh by @charliermarsh on 2025-01-25 21:05_

---

_Referenced in [astral-sh/uv#10963](../../astral-sh/uv/pulls/10963.md) on 2025-01-25 21:17_

---

_Closed by @charliermarsh on 2025-01-25 21:37_

---

_Closed by @charliermarsh on 2025-01-25 21:37_

---
