---
number: 5443
title: Store index URLs in tool receipts
type: issue
state: closed
author: zanieb
labels:
  - preview
assignees: []
created_at: 2024-07-25T14:15:22Z
updated_at: 2024-08-10T01:01:06Z
url: https://github.com/astral-sh/uv/issues/5443
synced_at: 2026-01-07T12:31:14-06:00
---

# Store index URLs in tool receipts

---

_Issue opened by @zanieb on 2024-07-25 14:15_

per https://github.com/astral-sh/uv/pull/5197#issuecomment-2248419637 we need the index urls to be able to upgrade the tool when alternative indexes are used.

---

_Label `preview` added by @zanieb on 2024-07-25 14:15_

---

_Comment by @charliermarsh on 2024-07-25 14:19_

Do you think we need anything else? Like `no-binary`, `no-build`, `resolution-mode`, etc.?

---

_Comment by @zanieb on 2024-07-25 14:21_

We probably need all of the `ResolverInstallerSettings`, right? :/

---

_Comment by @charliermarsh on 2024-07-25 14:23_

I think the index URL is the only thing that would affect whether or not the resolution _succeeds_ (maybe `no-binary` and `no-build` in weird cases, like a package has a broken wheel or something that you want to avoid). So arguably it's in a slightly different class...

---

_Comment by @charliermarsh on 2024-07-25 14:24_

We store a subset of these in the lockfile now if and only if they differ from the defaults. Ideally we would consider this holistically with the lockfile.

---

_Comment by @charliermarsh on 2024-07-25 14:29_

The other problem with storing index URLs is that they could contain credentials, right?

---

_Comment by @zanieb on 2024-07-25 14:30_

Strong agree around consistency with the lockfile, which I think includes the credential problem.

---

_Comment by @charliermarsh on 2024-07-25 14:31_

(üëç We don't store index URLs in the lockfile right now, only `prerelease-mode`, `resolution-mode`, and `exclude-newer`.)

---

_Comment by @zanieb on 2024-07-25 14:31_

Although for tool receipts, it's "okay" if we store credentials that the user handed us since it's not checked into version control.

---

_Referenced in [astral-sh/uv#5197](../../astral-sh/uv/pulls/5197.md) on 2024-08-07 22:03_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-08-08 12:42_

---

_Comment by @charliermarsh on 2024-08-08 12:47_

I'll look into this today.

---

_Comment by @charliermarsh on 2024-08-10 01:01_

Done.

---

_Closed by @charliermarsh on 2024-08-10 01:01_

---
