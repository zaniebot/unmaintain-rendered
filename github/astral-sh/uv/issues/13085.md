---
number: 13085
title: "`uv pip compile` strips optional dependencies `package[optional-dep]`"
type: issue
state: closed
author: benjaoming
labels:
  - bug
assignees: []
created_at: 2025-04-24T09:59:32Z
updated_at: 2025-04-24T10:24:04Z
url: https://github.com/astral-sh/uv/issues/13085
synced_at: 2026-01-07T12:31:16-06:00
---

# `uv pip compile` strips optional dependencies `package[optional-dep]`

---

_Issue opened by @benjaoming on 2025-04-24 09:59_

### Summary

Hello!

Thanks for the amazing project!

I'm seeing an unexpected and breaking behavior in relation to `pip-compile` compatibility. In the example below, the optional dependency spec `phonenumberslite` from `test.in` isn't added to the final `test.txt` requirements file.

Reproducing:

```
❯ cat test.in
django-phonenumber-field[phonenumberslite]==4.0.0

❯ uv pip compile test.in --output-file test.txt
Resolved 6 packages in 5.23s
# This file was autogenerated by uv via the following command:
#    uv pip compile test.in --output-file test.txt
asgiref==3.8.1
    # via django
babel==2.17.0
    # via django-phonenumber-field
django==5.2
    # via django-phonenumber-field
django-phonenumber-field==4.0.0
    # via -r test.in
phonenumberslite==9.0.3
    # via django-phonenumber-field
sqlparse==0.5.3
    # via django
```

What happened here is that `django-phonenumber-field==4.0.0` was set as the dependency, so it will be missing the `phonenumberslite` optional dependency.

### Platform

Docker, Linux (tested on both)

### Version

Tested on 0.5.11 and 0.6.16

### Python version

Python 3.10

---

_Label `bug` added by @benjaoming on 2025-04-24 09:59_

---

_Comment by @benjaoming on 2025-04-24 10:19_

I just learned about `--extra optional` and will check if that solves my problem...

---

_Comment by @benjaoming on 2025-04-24 10:24_

This was a duplicate of https://github.com/astral-sh/uv/issues/1595

(used GitHub to search issues, ended up finding the duplicate via Google)

---

_Closed by @benjaoming on 2025-04-24 10:24_

---
