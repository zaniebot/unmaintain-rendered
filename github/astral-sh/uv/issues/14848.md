---
number: 14848
title: "incorrect extras conflict detection when using `uv sync` with `--package` and `--all-extras`"
type: issue
state: open
author: danielgafni
labels:
  - bug
assignees: []
created_at: 2025-07-23T15:18:16Z
updated_at: 2025-07-24T21:20:48Z
url: https://github.com/astral-sh/uv/issues/14848
synced_at: 2026-01-07T12:31:16-06:00
---

# incorrect extras conflict detection when using `uv sync` with `--package` and `--all-extras`

---

_Issue opened by @danielgafni on 2025-07-23 15:18_

### Summary

I have 2 packages in my `uv` workspace: `anam-data-utils` and `anam-training-data`, the latter depends on the former. 

`anam-training-data` declares conflicting extras: `torch-cpu` and `torch-gpu` according to the [docs](https://docs.astral.sh/uv/guides/integration/pytorch/#configuring-accelerators-with-optional-dependencies).

The following command fails: 

```shell
â€º uv sync --package anam-data-utils --all-extras
Resolved 353 packages in 1.64s
error: Extras `torch-cpu` and `torch-cuda` are incompatible with the declared conflicts: {`anam-training-data[torch-cpu]`, `anam-training-data[torch-cuda]`}
```

which looks lik ea bug since I'm not attempting to install `anam-training-data` at all (it would make sense if `--package anam-training-data` was used)

Basically, one package with conflicting extras breaks `--all-extras` usage in the entire workspace, which doesn't seem right to me. 

### Platform

NixOS 25.11 (Xantusia)

### Version

uv 0.6.14

### Python version

Python 3.11.11

---

_Label `bug` added by @danielgafni on 2025-07-23 15:18_

---

_Comment by @zanieb on 2025-07-23 15:20_

We solve for the entire workspace regardless of `--package`. Using `--package` just subsets the subsequent installation.

---

_Label `bug` removed by @zanieb on 2025-07-23 15:20_

---

_Label `question` added by @zanieb on 2025-07-23 15:20_

---

_Comment by @danielgafni on 2025-07-23 15:25_

Understandable, but I still find the behavior counter intuitive, I'd expect `--all-extras` selection to be scoped to the packages being installed with the `sync` command. 

Maybe that's a question of personal preference ðŸ¤” 

---

_Comment by @zanieb on 2025-07-23 15:30_

Ah, I see. Sorry, we've been getting similar questions about `--package` solving for the whole workspace and I missed the nuance of the `--all-extras` selection. We could consider subsetting `--all-extras` there, that's not unreasonable.

---

_Label `question` removed by @zanieb on 2025-07-23 15:30_

---

_Label `bug` added by @zanieb on 2025-07-23 15:30_

---

_Comment by @zanieb on 2025-07-23 15:30_

I think we'd need to ensure it's feasible though / doesn't have more complicated implications.

---

_Assigned to @zanieb by @zanieb on 2025-07-24 21:20_

---
