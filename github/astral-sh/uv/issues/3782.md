---
number: 3782
title: UV Fails to install with Docker
type: issue
state: closed
author: Nneji123
labels:
  - question
assignees: []
created_at: 2024-05-23T00:55:15Z
updated_at: 2024-05-23T01:47:41Z
url: https://github.com/astral-sh/uv/issues/3782
synced_at: 2026-01-07T12:31:14-06:00
---

# UV Fails to install with Docker

---

_Issue opened by @Nneji123 on 2024-05-23 00:55_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with uv.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `uv pip sync requirements.txt`), ideally including the `--verbose` flag.
* The current uv platform.
* The current uv version (`uv --version`).
-->

I've been using uv with my docker builds for the past few months. I just encountered the following error when trying to install requirements in my container. Here's the error:
```bash
 => ERROR [celery-beat stage-0  8/12] RUN --mount=type=cache,target=/root/.cache/pip /root/.cargo/bin/uv pip install --no-cache -r requirements.txt      0.8s
------
 > [celery-beat stage-0  8/12] RUN --mount=type=cache,target=/root/.cache/pip /root/.cargo/bin/uv pip install --no-cache -r requirements.txt:
0.675 error: No Python interpreters found in virtual environments
```

Here's the Dockerfile:
```Dockerfile
FROM python:3.8.13-slim-bullseye

WORKDIR /app

# Set environment variables
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    netcat \
    wget \
    unzip \
    dpkg && \
    rm -rf /var/lib/apt/lists/*

RUN pip install --upgrade setuptools

ENV VIRTUAL_ENV=/usr/local
ADD --chmod=655 https://astral.sh/uv/install.sh /install.sh
RUN /install.sh && rm /install.sh

ADD requirements.txt /app/requirements.txt

RUN --mount=type=cache,target=/root/.cache/pip /root/.cargo/bin/uv pip install --no-cache -r requirements.txt # the build fails at this stage

# Copy project files into container
ADD . /app

RUN sed -i "s/raise RuntimeError(\"populate() isn't reentrant\")/self.app_configs = {}/g" /usr/local/lib/python3.8/site-packages/django/apps/registry.py

# Copy the entrypoint script
COPY entrypoint.sh /app/entrypoint.sh
RUN chmod +x /app/entrypoint.sh

EXPOSE 8000

ENTRYPOINT ["/app/entrypoint.sh"]
```

In the Dockerfile I am using the latest version of uv.

How do I go about resolving this issue?

---

_Comment by @charliermarsh on 2024-05-23 00:58_

Can you try removing `ENV VIRTUAL_ENV=/usr/local`, and instead passing `--system` to your `uv pip install` invocation?

---

_Label `question` added by @charliermarsh on 2024-05-23 01:00_

---

_Comment by @Nneji123 on 2024-05-23 01:07_

Thank you very much for the quick response. The suggestion you offered fixed the issue. 

---

_Closed by @Nneji123 on 2024-05-23 01:07_

---

_Comment by @zanieb on 2024-05-23 01:47_

Thanks for reporting and checking back in! For additional reference, this is a duplicate of https://github.com/astral-sh/uv/issues/3765 which has a bit more discussion.

---

_Referenced in [astral-sh/uv#3787](../../astral-sh/uv/issues/3787.md) on 2024-05-23 12:45_

---
