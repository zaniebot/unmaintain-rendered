---
number: 12283
title: "uv managed python fails installing `sasl` dependency with python 3.9.18"
type: issue
state: open
author: ignacio-amaya-rovio
labels:
  - bug
assignees: []
created_at: 2025-03-18T14:46:00Z
updated_at: 2025-04-22T07:40:28Z
url: https://github.com/astral-sh/uv/issues/12283
synced_at: 2026-01-07T12:31:15-06:00
---

# uv managed python fails installing `sasl` dependency with python 3.9.18

---

_Issue opened by @ignacio-amaya-rovio on 2025-03-18 14:46_

### Summary

## How to reproduce

```
uvx --python 3.9.18 sasl
```

## Error

Error contains the following:

```
      [stderr]
      <string>:34: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      <string>:35: DeprecationWarning: distutils Version classes are deprecated. Use packaging.version instead.
      sasl/saslwrapper.cpp:624:10: fatal error: 'ios' file not found
        624 | #include "ios"
            |          ^~~~~
      1 error generated.
      error: command '/usr/bin/c++' failed with exit code 1

      hint: This usually indicates a problem with the package or the build environment.
```

## Impact

Installing the same library with pyenv python 3.9.18 works fine. This prevents me migrating some projects to use `uv`.

### Platform

macOS 15.3.2 arm64

### Version

uv 0.6.3 (a0b9f22a2 2025-02-24)

### Python version

Python 3.9.18

---

_Label `bug` added by @ignacio-amaya-rovio on 2025-03-18 14:46_

---

_Comment by @zanieb on 2025-03-18 14:58_

When you use pyenv, I presume the package is still built from source? Can you share logs for that?

---

_Comment by @ignacio-amaya-rovio on 2025-03-19 12:03_

With pyenv I set in `~/.config/uv/uv.toml` the following setting so that it would use pyenv python:

```
python-preference = "only-system"
```

Then running the same command `uvx --python 3.9.18 sasl` I get the following:

```
‚ùØ uvx --python 3.9.18 sasl
      Built sasl==0.3.1
Installed 2 packages in 18ms
The executable `sasl` was not found.
warning: Package `sasl` does not provide any executables.
```

Package was properly installed and a warning is printed as there is no executable as expected.

---

_Comment by @ignacio-amaya-rovio on 2025-03-26 15:58_

How can I try to fix these C++ issues with the uv managed python? With pyenv or brew python solution is usually to install additional packages using `brew`, but I am not sure how to fix these in `uv`.

---

_Comment by @zanieb on 2025-04-01 19:31_

We need more insight into the `sasl` build process, which I don't have the time to investigate. I'd recommend getting logs for the build with your pyenv Python and comparing them to the logs for the failing build. Determining if `/usr/bin/c++` is used would be a good place to start.

---

_Comment by @zanieb on 2025-04-01 19:32_

We're just calling the system compiler, in a similar way as builds with the pyenv or brew Python would. Sometimes, they set additional flags in `sysconfig` that are specific to your machine's libraries and such that we can't know about. You could also compare `python -m sysconfig` values.

---

_Comment by @ignacio-amaya-rovio on 2025-04-15 19:04_

I was having similar issues with `sasl` in CI/CD pipeline recently. It seems this was a dependency from `pyhive` that causes issues (and btw `pyhive` is out of maintenance). In that case the solution was to get rid of `sasl` and instead have in toml `pyhive[hive_pure_sasl]`.

The installation failed with poetry in a container using `python:3.9.21-slim-bookworm` due to lack of g++ (different error that in the case of `uv`), but in a container with `python:3.9-bookworm` the installation works. So my guess is that uv also uses its own _slim_ version that could explain why this failed.

---

_Comment by @ignacio-amaya-rovio on 2025-04-15 19:05_

Also on another note, I can not replicate the error anymore, not sure if something changed on `uv` side that would explain that, but I did not update my `uv` version so that is weird ü§∑‚Äç‚ôÇ 

---

_Comment by @ignacio-amaya-rovio on 2025-04-15 19:13_

I wonder if some recent releases in this repo might have fixed this: https://github.com/astral-sh/python-build-standalone

---

_Comment by @zanieb on 2025-04-17 13:58_

If you didn't update `uv`, you wouldn't have a new Python distribution from `python-build-standalone` (unless something else is managing those)

---

_Comment by @ignacio-amaya-rovio on 2025-04-22 07:40_

Right, I think I had some things cached, after running `uv cache clean` I could replicate the issue again.

Anyway, for fixing this issue I guess the simplest thing is to stop using `sasl`, I guess for other cases where system deps are missing in the uv python distribution it would be nice to have some easy way to be able to install system deps on top of the provided default.

---
