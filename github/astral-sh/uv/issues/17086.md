---
number: 17086
title: Add some local package failed
type: issue
state: open
author: imbear
labels:
  - question
assignees: []
created_at: 2025-12-11T14:20:31Z
updated_at: 2025-12-17T23:03:31Z
url: https://github.com/astral-sh/uv/issues/17086
synced_at: 2026-01-07T12:31:16-06:00
---

# Add some local package failed

---

_Issue opened by @imbear on 2025-12-11 14:20_

### Summary

First, I try a project with below configure:

pyproject.toml
```
[project]
name = "pypy"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.14"
dependencies = [
    "xlwings>=0.33.17",
]

[tool.uv]
cache-dir = "D:/pypy/cache"
find-links = ["d:/python-packages"]
no-index = true
```

Command execute failed:
```
❯ uv add xlwings
  × No solution found when resolving dependencies:
  ╰─▶ Because only appscript{sys_platform == 'darwin'}<1.0.1 is available and xlwings==0.33.17 depends on appscript{sys_platform == 'darwin'}>=1.0.1, we can conclude that xlwings==0.33.17 cannot be used.
      And because only xlwings==0.33.17 is available and your project depends on xlwings, we can conclude that your project's requirements are unsatisfiable.
  help: If you want to add the package regardless of the failed resolution, provide the `--frozen` flag to skip locking and syncing.
```

I change the configure:

```
...

[tool.uv]
index-url = "https://mirrors.aliyun.com/pypi/simple"
cache-dir = "D:/pypy/cache"
```

Command execute successfully:
```
❯ uv add xlwings
Resolved 6 packages in 648ms
Prepared 2 packages in 813ms
Installed 2 packages in 180ms
 + pywin32==311
 + xlwings==0.33.17
```

### Platform

windows11 x64

### Version

uv 0.9.17 (2b5d65e61 2025-12-09)

### Python version

_No response_

---

_Label `bug` added by @imbear on 2025-12-11 14:20_

---

_Comment by @charliermarsh on 2025-12-11 15:22_

Those configurations are different though. The former is only looking at your find-links directory, the latter includes the PyPI mirror. Does your `d:/python-packages` contain all of your dependencies? The error message suggests it does not.

---

_Label `bug` removed by @charliermarsh on 2025-12-11 15:22_

---

_Label `needs-mre` added by @charliermarsh on 2025-12-11 15:22_

---

_Comment by @imbear on 2025-12-11 22:50_

I download xlwings by `pip download`, so the dependencies is good.

METADATA of xlwings-0.33.17-cp314-cp314-win_amd64.whl:
```
...
Requires-Dist: pywin32>=224; platform_system == "Windows"
Requires-Dist: psutil>=2.0.0; platform_system == "Darwin"
Requires-Dist: appscript>=1.0.1; platform_system == "Darwin"
...
```

My system is Windows, but it seemed uv misuse the third Requires-Dist.

I delete this line, now `uv add` run ok.



---

_Comment by @konstin on 2025-12-16 14:50_

You shouldn't manually METADATA files, it will lead to broken installs. Instead, you can limit the environments to windows with `tool.uv.environments`. By default, uv will resolve for all platforms at the same time, for which it needs access to metadata from all platforms, including metadata for `appscript`, so it needs to have either an index with the package or the wheel for it.

---

_Label `needs-mre` removed by @konstin on 2025-12-16 14:50_

---

_Label `question` added by @konstin on 2025-12-16 14:50_

---

_Comment by @imbear on 2025-12-16 23:20_

> You shouldn't manually METADATA files, it will lead to broken installs. Instead, you can limit the environments to windows with `tool.uv.environments`. By default, uv will resolve for all platforms at the same time, for which it needs access to metadata from all platforms, including metadata for `appscript`, so it needs to have either an index with the package or the wheel for it.

Oh, I want to know why the requirement checks of `uv add` by online and local are different.
If I add by online, checking is ok，no other configure is needed. But add by local, checking is failed because of `Requires-Dist: appscript>=1.0.1; platform_system == "Darwin"`, although my system is Windows, and as you say, I need a extra configure`tool.uv.environments`.


---

_Comment by @konstin on 2025-12-17 09:33_

What's in the local directory, does it contain an appscript wheel?

---

_Comment by @imbear on 2025-12-17 11:54_

> What's in the local directory, does it contain an appscript wheel?

I have downloaded all necessary wheels by `pip download xlwings`(`xlwings` only requires `pywin32` on Windows), also I can install the `xlwings` by `pip --find-links d:/python-packages --no-index xlwings`.

I don't understand the error message `Because only appscript{sys_platform == 'darwin'}<1.0.1 is available and xlwings==0.33.17 depends on appscript{sys_platform == 'darwin'}>=1.0.1, we can conclude that xlwings==0.33.17 cannot be used.`, because my system is Windows.

---

_Comment by @konstin on 2025-12-17 12:09_

the uv project commands resolves for all platforms by default, independent of the host system, so the lockfile is usable universally. This means you can get errors for missing metadata/missing wheels for platforms that aren't the current one. This is different from pip (and `uv pip` without `--universal`), which can only use the current platform. That's why `tool.uv.environments` is the recommendation for limiting to only Windows.

---

_Comment by @imbear on 2025-12-17 23:03_

> the uv project commands resolves for all platforms by default, independent of the host system, so the lockfile is usable universally. This means you can get errors for missing metadata/missing wheels for platforms that aren't the current one. This is different from pip (and `uv pip` without `--universal`), which can only use the current platform. That's why `tool.uv.environments` is the recommendation for limiting to only Windows.

Thanks your reply! Now I know.

But why the requirement checking rules of `uv add` from internet and local are different?
Adding from internet and without configure `tool.uv.environments`, I also can add `xlwings` successfully. In this situation, uv will ignore the requirement of other than Windows?

---
