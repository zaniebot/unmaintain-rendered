---
number: 16189
title: "Caching issues with hatchling's `--force-include`"
type: issue
state: open
author: Mr-Pepe
labels:
  - bug
assignees: []
created_at: 2025-10-08T15:07:25Z
updated_at: 2025-10-21T21:09:14Z
url: https://github.com/astral-sh/uv/issues/16189
synced_at: 2026-01-07T12:31:16-06:00
---

# Caching issues with hatchling's `--force-include`

---

_Issue opened by @Mr-Pepe on 2025-10-08 15:07_

### Summary

**Summary**
When using hatchling's `--force-include` option to map sources from one package into another in a monorepo, the uv cache needs to be cleared after each change.

**To reproduce**
Follow the steps in: https://github.com/Mr-Pepe/uv-cache-bug

**Use case**
The use case is to make schemas from package-a available to other packages in the monorepo without having them pull in all of package-a's dependencies. Placing the schemas in a separate package is not desirable because package-a gets shipped as a standalone source distribution to people without access to the monorepo.

### Platform

Linux 6.16.10-arch1-1 x86_64 GNU/Linux

### Version

uv 0.8.23 (00d3aa378 2025-10-04)

### Python version

Python 3.13.7

---

_Label `bug` added by @Mr-Pepe on 2025-10-08 15:07_

---

_Comment by @zanieb on 2025-10-08 15:39_

Does adding these files to your cache keys resolve the issue? https://docs.astral.sh/uv/reference/settings/#cache-keys

---

_Comment by @Mr-Pepe on 2025-10-08 16:00_

I added 

```
[tool.uv]
cache-keys = [{ dir = "../package_a" }]
```

to the `pyproject.toml` of `package_a_schemas` and created new files in `packages/package_a`. However, that doesn't seem to help.

Verbose output shows the following:

```
DEBUG Computed cache info: None, None, None, {}, {"../package_a": Some(Timestamp(Timestamp(SystemTime { tv_sec: 1759897495, tv_nsec: 245819107 })))}
DEBUG Requirement already installed: package-a-schemas==0.1.0 (from file:///home/felipe/tmp/uv_bug/packages/package_a_schemas)
```

So it seems that changes in that folder don't invalidate the cache? 

---

_Comment by @Mr-Pepe on 2025-10-21 21:09_

We ended up symlinking `package_a/schemas` to `package_a_schemas` and using `uv_build` as the build backend. It's still not clear to me whether this is an issue with hatchling or uv.

---
