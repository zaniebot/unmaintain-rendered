---
number: 10968
title: Package resolution from Index URLs different for uv pip install and uv sync
type: issue
state: closed
author: Fabma
labels:
  - needs-mre
assignees: []
created_at: 2025-01-26T20:01:48Z
updated_at: 2025-01-27T13:32:28Z
url: https://github.com/astral-sh/uv/issues/10968
synced_at: 2026-01-07T12:31:15-06:00
---

# Package resolution from Index URLs different for uv pip install and uv sync

---

_Issue opened by @Fabma on 2025-01-26 20:01_

### Summary

When running `uv pip install` then the packages can be resolved for both of the following URLs:
```
uv pip install torch==2.3.1 --no-cache --index-url https://download.pytorch.org/whl/cpu/torch_stable.html
uv pip install torch==2.3.1 --no-cache --index-url https://download.pytorch.org/whl/cpu
```

In a `pyproject.toml` though and running `uv sync`, only the latter URL works though. The former URL (`torch_stable.html`) does not work.
```
[project]
name = "project"
version = "0.1.0"
requires-python = ">=3.12.0"
dependencies = []

[project.optional-dependencies]
cpu = [
  "torch>=2.5.1",
]
cu124 = [
  "torch>=2.5.1",
]

[tool.uv]
conflicts = [
  [
    { extra = "cpu" },
    { extra = "cu124" },
  ],
]

[tool.uv.sources]
torch = [
  { index = "pytorch-cpu", extra = "cpu" },
  { index = "pytorch-cu124", extra = "cu124" },
]

[[tool.uv.index]]
name = "pytorch-cpu"
url = "https://download.pytorch.org/whl/cpu/torch_stable.html"
# the following would work: url = "https://download.pytorch.org/whl/cpu/"
explicit = true

[[tool.uv.index]]
name = "pytorch-cu124"
url = "https://download.pytorch.org/whl/cu124"
explicit = true
```

When running `uv sync -vv`, the debug log looks like this.
```
...
 0.823578s   0ms DEBUG uv_client::cached_client No cache entry for: https://download.pytorch.org/whl/cpu/torch_stable.html/torch/
         uv_client::cached_client::fresh_request url="https://download.pytorch.org/whl/cpu/torch_stable.html/torch/"
...
Because torch was not found in the package registry and project[cpu] depends on torch>=2.5.1, we can conclude that project[cpu]'s requirements are unsatisfiable.
```
i.e., `torch` is added to the path `torch_stable.html/torch/` which does not resolve.

When running `uv pip install torch==2.3.1 --no-cache --index-url https://download.pytorch.org/whl/cpu/torch_stable.html`, the debug log looks like this:
```
...
      uv_client::html::parse url=https://download.pytorch.org/whl/cpu/torch_stable.html
    0.885202s DEBUG uv_client::flat_index Found 2766 packages in `--find-links` entry: https://download.pytorch.org/whl/cpu/torch_stable.html
...
```
i.e., packages are found via find-links first.


While for pytorch packages this is not an issue (since both kinds of URLs exist). For e.g. https://data.pyg.org/whl/torch-2.3.1+cpu.html it is a problem, since there is no URL such as `https://data.pyg.org/whl/torch-2.3.1+cpu` available.

### Platform

macOS 13 arm64

### Version

uv 0.5.24 (42fae925c 2025-01-23)

### Python version

Python 3.12.8

---

_Label `bug` added by @Fabma on 2025-01-26 20:01_

---

_Renamed from "Index URL resolution different for uv pip install and uv sync" to "Package resolution from Index URLs different for uv pip install and uv sync" by @Fabma on 2025-01-26 20:28_

---

_Comment by @charliermarsh on 2025-01-26 21:25_

The first one does not work for me:

```
❯ uv pip install torch==2.3.1 --no-cache --index-url https://download.pytorch.org/whl/cpu/torch_stable.html

  × No solution found when resolving dependencies:
  ╰─▶ Because torch was not found in the package registry and you
      require torch==2.3.1, we can conclude that your requirements are
      unsatisfiable.
```

---

_Label `bug` removed by @charliermarsh on 2025-01-26 21:25_

---

_Label `needs-mre` added by @charliermarsh on 2025-01-26 21:25_

---

_Comment by @charliermarsh on 2025-01-26 21:25_

(And it shouldn't.)

---

_Comment by @Fabma on 2025-01-27 07:07_

My bad, maybe I was first running 
`uv pip install torch==2.3.1 --no-cache --index-url https://download.pytorch.org/whl/cpu`
which successfully resolves, and then afterwards
`uv pip install torch==2.3.1 --no-cache --index-url https://download.pytorch.org/whl/cpu/torch_stable.html`
which doesnt have any effect since it is already installed.

> (And it shouldn't.)

Ok. For package repos such as https://data.pyg.org/whl/torch-2.3.1+cpu.html will need to find a different solution then.

---

_Closed by @Fabma on 2025-01-27 07:07_

---

_Comment by @charliermarsh on 2025-01-27 13:32_

That’s a find-links URL, not an index. Look at find-links.

---
