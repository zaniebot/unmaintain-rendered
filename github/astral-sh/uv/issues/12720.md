---
number: 12720
title: PyArrow Cannot Write ORC File After Building Venv with UV
type: issue
state: closed
author: kahemker
labels:
  - bug
assignees: []
created_at: 2025-04-07T16:03:04Z
updated_at: 2025-04-10T01:15:16Z
url: https://github.com/astral-sh/uv/issues/12720
synced_at: 2026-01-07T12:31:15-06:00
---

# PyArrow Cannot Write ORC File After Building Venv with UV

---

_Issue opened by @kahemker on 2025-04-07 16:03_

### Summary

I would like to migrate a project from conda to uv and it appears that when uv builds the environment, pyarrow can no longer write orc files that include datetimes with timezones.

[I created a minimum reproducible example here.](https://github.com/kahemker/pyarrow-orc-failure)

Steps to recreate the problem.

1. Clone the repo
2. Run uv sync to install polars and pyarrow using pyproject.toml
3. Run uv run main.py

The error message is

```
Traceback (most recent call last):
  File "W:\code\test_pyarrow\main.py", line 21, in <module>
    main()
  File "W:\code\test_pyarrow\main.py", line 17, in main
    writer.write(df.to_arrow().cast(table_schema))
  File "W:\code\test_pyarrow\.venv\Lib\site-packages\pyarrow\orc.py", line 289, in write
    self.writer.write(table)
  File "pyarrow\\_orc.pyx", line 439, in pyarrow._orc.ORCWriter.write
  File "pyarrow\\error.pxi", line 92, in pyarrow.lib.check_status
pyarrow.lib.ArrowException: Unknown error: Time zone file /usr/share/zoneinfo/GMT does not exist. Please install IANA time zone database and set TZDIR env.
```

You can build the working conda environment by following these steps (again starting from the minimum reproducible example)

1. conda env create -f environment.yml
2. conda activate test_pyarrow_conda
3. python main.py

The code will terminate successfully and the test.orc.snappy file will exist in the directory.


### Platform

Windows 10 Pro, Version 10.0.19045, 64-bit

### Version

uv 0.6.12 (e4e03833f 2025-04-02)

### Python version

Python 3.12.9

---

_Label `bug` added by @kahemker on 2025-04-07 16:03_

---

_Comment by @zanieb on 2025-04-07 20:00_

Thanks for the report. Does this work with `pip` instead of uv? / is it specific to uv-managed Python versions?

---

_Comment by @kahemker on 2025-04-09 14:54_

I don't know why I did not try that first.  I just tried to create the environment with venv and pip, same issue.

This must not be a UV issue.  I found some notes that pyarrow needs C++ redistributables installed on Windows and this PC appears to have out of date versions.  Maybe conda is installing that software within it's environment.  

I will try to recreate this problem on my personal computer where I have full admin rights to add/remove software.  Will try to report back tonight 

On Mon, Apr 7, 2025, at 4:01 PM, Zanie Blue wrote:
> Thanks for the report. Does this work with `pip` instead of uv? / is it specific to uv-managed Python versions?
> 
> 
> —
> Reply to this email directly, view it on GitHub <https://github.com/astral-sh/uv/issues/12720#issuecomment-2784489991>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/AIMELLANTIMUMYCTW33IAUD2YLKQPAVCNFSM6AAAAAB2UAGY22VHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDOOBUGQ4DSOJZGE>.
> You are receiving this because you authored the thread.Message ID: ***@***.***>
> 
> zanieb*zanieb* left a comment (astral-sh/uv#12720) <https://github.com/astral-sh/uv/issues/12720#issuecomment-2784489991>
> Thanks for the report. Does this work with `pip` instead of uv? / is it specific to uv-managed Python versions?
> 
> 
> —
> Reply to this email directly, view it on GitHub <https://github.com/astral-sh/uv/issues/12720#issuecomment-2784489991>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/AIMELLANTIMUMYCTW33IAUD2YLKQPAVCNFSM6AAAAAB2UAGY22VHI2DSMVQWIX3LMV43OSLTON2WKQ3PNVWWK3TUHMZDOOBUGQ4DSOJZGE>.
> You are receiving this because you authored the thread.Message ID: ***@***.***>
> 


---

_Comment by @kahemker on 2025-04-10 01:15_

I will report this issue to the pyarrow team, see what kinds of ideas they have.  Not really sure what is going on.  I will close this issue out now

---

_Closed by @kahemker on 2025-04-10 01:15_

---
