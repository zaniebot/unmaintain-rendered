---
number: 1367
title: "Including another file with `-r other.txt` should resolve relative to the containing file"
type: issue
state: closed
author: carta-luc-ritchie
labels:
  - bug
  - compatibility
assignees: []
created_at: 2024-02-15T21:58:45Z
updated_at: 2024-02-16T04:19:44Z
url: https://github.com/astral-sh/uv/issues/1367
synced_at: 2026-01-07T12:31:14-06:00
---

# Including another file with `-r other.txt` should resolve relative to the containing file

---

_Issue opened by @carta-luc-ritchie on 2024-02-15 21:58_

We have a dev requirements file `lib/requirements/dev.txt` that starts with this:

```dev.txt
-r requirements.txt
-r ../client/requirements/requirements.txt
-r ../interfaces/requirements/requirements.txt
```

Relative to the repo root, the mentioned files are at `lib/requirements/requirements.txt`, `lib/client/requirements/requirements.txt`, and `lib/interfaces/requirements/requirements.txt`. We invoke pip with `pip install -r /full/path/to/repo/lib/requirements/dev.txt`, and it's able to find and recursively include these files. If we invoke `uv pip install` the same way, it fails with

```
error: Error parsing included file in `/full/path/to/repo/lib/requirements/dev.txt` at position 0
  Caused by: failed to open file `/full/path/to/repo/requirements.txt`
  Caused by: No such file or directory (os error 2)
```

If I change directory, it becomes clear that the file is being resolved relative to the current working directory, whereas pip resolves it relative to the file containing the `-r` instruction.

---

_Label `bug` added by @zanieb on 2024-02-15 21:59_

---

_Label `compatibility` added by @zanieb on 2024-02-15 21:59_

---

_Comment by @zanieb on 2024-02-15 22:00_

Thanks for the report! I agree.

---

_Comment by @charliermarsh on 2024-02-15 22:03_

I need to do a bit of research on this -- I can't quite remember why we did it this way, but I thought it was intentional. Will take a look!

---

_Comment by @edwardpeek-crown-public on 2024-02-15 23:41_

Note that pip-compile also matches pip behaviour, resolving relative to the file defining the path.

---

_Referenced in [astral-sh/uv#1416](../../astral-sh/uv/issues/1416.md) on 2024-02-16 02:54_

---

_Comment by @charliermarsh on 2024-02-16 02:57_

Okay, I think the reason I was confused is that relative directories (like `-e ../..`) are interpreted relative to the current working directory. But it looks like requirements and constraints files are interpreted relative to the containing file.

https://github.com/pypa/pip/issues/8765

---

_Assigned to @charliermarsh by @charliermarsh on 2024-02-16 02:58_

---

_Comment by @charliermarsh on 2024-02-16 02:58_

Will fix tonight.

---

_Referenced in [astral-sh/uv#1421](../../astral-sh/uv/pulls/1421.md) on 2024-02-16 03:57_

---

_Closed by @charliermarsh on 2024-02-16 04:19_

---

_Referenced in [astral-sh/uv#1470](../../astral-sh/uv/issues/1470.md) on 2024-02-16 10:57_

---
