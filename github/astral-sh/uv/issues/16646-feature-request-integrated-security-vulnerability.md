---
number: 16646
title: "Feature Request: Integrated Security Vulnerability Scanning (`uv audit`)"
type: issue
state: closed
author: cherchyk
labels: []
assignees: []
created_at: 2025-11-09T02:33:57Z
updated_at: 2025-11-09T02:41:31Z
url: https://github.com/astral-sh/uv/issues/16646
synced_at: 2026-01-07T13:12:19-06:00
---

# Feature Request: Integrated Security Vulnerability Scanning (`uv audit`)

---

_Issue opened by @cherchyk on 2025-11-09 02:33_

# Feature Request: Integrated Security Vulnerability Scanning (`uv audit`)

## Summary

Add native security vulnerability scanning and auto-remediation capabilities to uv, leveraging uv's existing speed and resolver to provide instant security feedback during development.

## Motivation

### Current Pain Points

1. **Fragmented tooling**: Developers must use separate tools (`pip-audit`, `safety`, Snyk) for security scanning
2. **Performance bottleneck**: Existing Python security scanners are slow, making them impractical for local development
3. **Manual remediation**: When vulnerabilities are found, developers must manually research and test safe version upgrades
4. **CI-only scanning**: Slow tools are relegated to CI pipelines, catching issues late in the development cycle
5. **No resolver integration**: Current tools report issues but don't leverage dependency resolution to suggest fixes

### Why This Fits uv's Mission

- **Speed**: uv's Rust implementation and existing resolver can scan dependency trees in milliseconds
- **Comprehensive tooling**: Aligns with uv's goal to be a unified Python tool (replacing pip, poetry, pipx, etc.)
- **Developer experience**: Catch vulnerabilities at `uv add` time, not just in CI
- **Enterprise adoption**: Security is a critical requirement for enterprise Python adoption

## Proposed Solution

### Core Feature: `uv audit`

A new command that scans Python dependencies for known security vulnerabilities:

```bash
# Scan current project for vulnerabilities
uv audit

# Auto-fix by upgrading to safe versions
uv audit --fix

# Preview changes without modifying lockfile
uv audit --fix --dry-run

# Audit before adding a dependency
uv add requests --audit

# Filter by severity
uv audit --severity critical,high
```

### Example Output

```
Scanning 145 packages...

Found 3 vulnerabilities in 2 packages:

┌─────────────────────────────────────────────────────────┐
│ CRITICAL: Remote Code Execution in requests            │
├─────────────────────────────────────────────────────────┤
│ Package:    requests                                    │
│ Installed:  2.25.0                                      │
│ Fixed in:   2.31.0                                      │
│ Advisory:   GHSA-j8r2-6x86-q33q                        │
│ CVE:        CVE-2023-32681                             │
│ URL:        https://github.com/advisories/GHSA-...     │
└─────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────┐
│ HIGH: Denial of Service in werkzeug                    │
├─────────────────────────────────────────────────────────┤
│ Package:    werkzeug                                    │
│ Installed:  2.0.0                                       │
│ Fixed in:   2.2.3, 2.3.0                               │
│ Advisory:   GHSA-px8h-6qxv-m22q                        │
└─────────────────────────────────────────────────────────┘

Run `uv audit --fix` to automatically upgrade to safe versions.
```

### Key Capabilities

1. **Instant scanning**: Leverage uv's speed to scan entire dependency trees in <100ms
2. **Smart resolution**: Use uv's PubGrub resolver to automatically find safe version combinations
3. **Multiple data sources**:
   - GitHub Advisory Database (24,600+ Python advisories, free API)
   - OSV.dev API (comprehensive, free)
   - PyPA Advisory Database (can be mirrored locally)
4. **Auto-remediation**: Automatically update `uv.lock` to safe versions while maintaining compatibility
5. **Integration points**: Hook into `uv add`, `uv sync`, `uv lock` with `--audit` flag
6. **Caching**: Leverage uv's existing cache infrastructure for vulnerability data

### Integration with Existing Commands

```bash
# Audit during dependency addition (fail if vulnerable)
uv add requests --audit

# Audit during sync (warn about vulnerabilities)
uv sync --audit

# Lock with audit checks
uv lock --audit

# Enable audit checks globally
uv config set audit.enabled true
uv config set audit.severity high  # Only fail on high/critical
```

## Technical Approach

### Data Sources (All Free)

1. **GitHub Advisory Database**
   - REST API: `https://api.github.com/advisories?ecosystem=pip`
   - 24,600+ reviewed Python advisories
   - Free, no authentication required
   - CC-BY-4.0 license

2. **OSV.dev API**
   - `https://api.osv.dev/v1/query`
   - Free, comprehensive coverage
   - Used by pip-audit

3. **PyPA Advisory Database**
   - Git repo: `https://github.com/pypa/advisory-database`
   - Can be mirrored locally for offline support
   - OSV format

### Implementation Strategy

1. **New crate**: `uv-audit` for vulnerability scanning logic
2. **Cache integration**: Store advisory data in uv's existing cache (refresh daily)
3. **Resolver integration**: Use existing PubGrub resolver to find safe version upgrades
4. **CLI integration**: Add `audit` subcommand to `uv-cli`
5. **Async fetching**: Use existing `uv-client` for parallel advisory API requests

### Proposed Module Structure

```
crates/
  uv-audit/
    src/
      advisory.rs      # Advisory data structures
      client.rs        # Fetch from GitHub/OSV APIs
      scanner.rs       # Scan dependency tree for vulnerabilities
      resolver.rs      # Find safe version combinations
      cache.rs         # Cache advisory data
      report.rs        # Format vulnerability reports
```

## Benefits

### For Developers
- **Shift-left security**: Catch vulnerabilities during development, not in CI
- **Zero friction**: No additional tools to install or configure
- **Instant feedback**: Sub-second scanning thanks to uv's speed
- **Actionable fixes**: Auto-remediation instead of just warnings

### For Teams
- **Faster CI**: Lightning-fast audit checks don't slow down pipelines
- **Supply chain security**: Continuous monitoring of dependencies
- **Compliance**: Built-in security scanning for audit requirements

### For the Python Ecosystem
- **Democratize security**: Make enterprise-grade security accessible to all
- **Better defaults**: Security-by-default for new Python projects
- **Network effects**: More usage = more vulnerability awareness

## Differentiation

No other Python package manager offers this level of integration:

| Feature | uv audit | pip-audit | safety | Snyk |
|---------|----------|-----------|--------|------|
| Speed | <100ms | ~5-30s | ~10-60s | ~15-45s |
| Auto-fix | ✅ | ❌ | ❌ | ✅ (paid) |
| Free | ✅ | ✅ | ⚠️ (limited) | ⚠️ (limited) |
| Integrated resolver | ✅ | ❌ | ❌ | ❌ |
| Offline support | ✅ | ❌ | ❌ | ❌ |
| Add-time checking | ✅ | ❌ | ❌ | ❌ |

## Alternative: Interactive Conflict Resolution

If `uv audit` is not aligned with uv's roadmap, an alternative high-value feature would be **interactive dependency conflict resolution**. When resolution fails, use uv's speed to explore the solution space and suggest specific version combinations with explanations of conflicts.

## Implementation Effort

**Estimated scope**: Medium-large feature

- **Core scanning logic**: ~1-2 weeks
- **Resolver integration**: ~1 week (reuse existing resolver)
- **API client + caching**: ~1 week
- **CLI integration**: ~3-5 days
- **Testing + docs**: ~1 week

**Total**: ~4-6 weeks for MVP

## Open Questions

1. **Scope**: Should this be in uv core or a plugin/extension system?
2. **Default behavior**: Enable audit checks by default or opt-in?
3. **Offline support**: Bundle advisory database or fetch on-demand?
4. **Output format**: Support machine-readable output (JSON/SARIF) for CI integration?
5. **Exit codes**: Fail builds on any vulnerability or only critical/high?

## Prior Art

- **pip-audit**: Python tool using PyPA advisory database (~5-30s scan time)
- **cargo audit**: Rust equivalent (instant, integrated with cargo)
- **npm audit**: Node.js built-in (fast, integrated)
- **bundler-audit**: Ruby built-in

## Next Steps

If this proposal aligns with uv's vision, I'd be happy to:

1. Create a detailed technical design document
2. Prototype the core scanning functionality
3. Open a PR for initial implementation
4. Help with documentation and testing

## Additional Context

This feature would position uv not just as a faster package manager, but as a **safer, smarter foundation** for Python development. Given the increasing focus on supply chain security (SBOM requirements, SLSA frameworks, etc.), built-in security scanning could be a major differentiator for uv.

I'm excited about this opportunity and would love to contribute to making Python development more secure!

---

_Comment by @charliermarsh on 2025-11-09 02:36_

(This looks like a duplicate of https://github.com/astral-sh/uv/issues/9189.)

---

_Comment by @cherchyk on 2025-11-09 02:37_

To clarify: I'm eager to implement this feature myself and contribute it to uv. I'm not requesting the uv team to build it - I want to take ownership of the implementation.

If this aligns with uv's roadmap, I'll:
- Lead the development effort
- Create the detailed technical design
- Implement the core functionality
- Write comprehensive tests and documentation
- Iterate based on code review feedback

I'm ready to start working on this as soon as we have alignment on the approach.

---

_Comment by @cherchyk on 2025-11-09 02:41_

Thanks for pointing out the duplicate @charliermarsh! I should have searched more thoroughly before opening this.

I've read through #9189 and understand that the uv team isn't ready to accept external contributions for this feature yet due to bandwidth constraints around design work.

I'm very interested in contributing to this when the time is right, and I'll subscribe to #9189 to follow the discussion. In the meantime, I'll check out the existing community solutions like pysentry and uv-secure.

Closing this as a duplicate.

---

_Closed by @cherchyk on 2025-11-09 02:41_

---
