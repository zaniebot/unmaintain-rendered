---
number: 12558
title: "Even with `uv sync --no-dev`, development dependencies are still installed when workflow executes."
type: issue
state: closed
author: WitherZuo
labels:
  - question
assignees: []
created_at: 2025-03-30T14:28:03Z
updated_at: 2026-01-02T11:43:19Z
url: https://github.com/astral-sh/uv/issues/12558
synced_at: 2026-01-07T12:31:15-06:00
---

# Even with `uv sync --no-dev`, development dependencies are still installed when workflow executes.

---

_Issue opened by @WitherZuo on 2025-03-30 14:28_

With the documentation of uv, I used `uv sync --no-dev` in order to not install the development dependencies while the GitHub Actions workflow is running, however the switch `--no-dev` doesn't seem to work while the workflow is running, with this switch it still installs all of the dependencies including the development dependencies. using `uv sync --no-dev` locally works perfectly fine and does not install development dependencies when installing dependencies.

## GitHub Actions workflow and log:  

For my project, `Ruff` is the only dev dependency.  

- **`pyproject.toml` file:**  

```toml  
[project]
name = "newsphoto"
version = "1.0.0"
description = "NewsPhoto everyday."
readme = "README.md"
requires-python = ">=3.13"
dependencies = [
    "pangu>=4.0.6.1",
    "playwright>=1.51.0",
    "requests>=2.32.3",
]

[dependency-groups]
dev = [
    "ruff>=0.11.2",
]
```

- **GitHub Actions workflow file `main.yml`:**    

<details>
<summary>Click here to expand.</summary>  

```yaml  
name: Create NewsPhoto
on:
  workflow_dispatch:
    inputs:
      greeting:
        description: 'Greeting text:'
        required: false
        default: '……'
        type: string
      style:
        description: 'NewsPhoto style:'
        required: true
        default: 'light'
        type: choice
        options:
          - light
          - dark
          - springfestival

jobs:
  generate_newsphoto:
    name: Generate NewsPhoto
    runs-on: windows-latest
    steps:
    - name: Set timezone to Asia/Shanghai
      uses: WitherZuo/set-timezone@v1.0.0
      with:
        timezoneWindows: "China Standard Time"

    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        repository: WitherZuo/NewsPhoto

    - name: Install uv and Python.
      uses: astral-sh/setup-uv@v5
      with:
        version: "0.6.10"
        enable-cache: true
        cache-dependency-glob: "**/pyproject.toml"

    - name: Install dependencies
      run: uv sync --no-dev

    - name: Install Pandoc
      run: choco install -y pandoc

    - name: Create markdown sources and convert to HTML
      run: |
        uv run main.py --greeting "${{ inputs.greeting }}" --style ${{ inputs.style }}
        Get-ChildItem -Path .\sources\
        Get-ChildItem -Path .\outputs\

    - name: Generate screenshot
      run: |
        uv run save-as-image.py --browser chrome
        Get-ChildItem -Path .\outputs\

    - name: Upload NewsPhoto - Webpage
      uses: actions/upload-artifact@v4
      with:
        name: newsphoto-webpage
        path: outputs/NewsPhoto.html

    - name: Upload NewsPhoto - Image
      uses: actions/upload-artifact@v4
      with:
        name: newsphoto-image
        path: outputs/NewsPhoto.png
```

</details>  

- **Workflow log:**  

**For full log**, you can visit **[here](https://github.com/WitherZuo/NewsPhoto/actions/runs/14153678743/job/39650104473)**.  

<details>
<summary>Click here to expand.</summary>  

```
Sun, 30 Mar 2025 07:05:44 GMT
Run uv sync --no-dev
Sun, 30 Mar 2025 07:05:45 GMT Using CPython 3.13.2 interpreter at: C:\hostedtoolcache\windows\Python\3.13.2\x64\python.exe
Sun, 30 Mar 2025 07:05:45 GMT Creating virtual environment at: .venv
Sun, 30 Mar 2025 07:05:45 GMT Resolved 12 packages in 1ms
Sun, 30 Mar 2025 07:05:46 GMT Downloading playwright (33.2MiB)
Sun, 30 Mar 2025 07:05:52 GMT  Downloaded playwright
Sun, 30 Mar 2025 07:05:52 GMT Prepared 10 packages in 7.06s
Sun, 30 Mar 2025 07:05:52 GMT Installed 10 packages in 52ms
Sun, 30 Mar 2025 07:05:52 GMT  + certifi==2025.1.31
Sun, 30 Mar 2025 07:05:52 GMT  + charset-normalizer==3.4.1
Sun, 30 Mar 2025 07:05:52 GMT  + greenlet==3.1.1
Sun, 30 Mar 2025 07:05:52 GMT  + idna==3.10
Sun, 30 Mar 2025 07:05:52 GMT  + pangu==4.0.6.1
Sun, 30 Mar 2025 07:05:52 GMT  + playwright==1.51.0
Sun, 30 Mar 2025 07:05:52 GMT  + pyee==12.1.1
Sun, 30 Mar 2025 07:05:52 GMT  + requests==2.32.3
Sun, 30 Mar 2025 07:05:52 GMT  + typing-extensions==4.13.0
Sun, 30 Mar 2025 07:05:52 GMT  + urllib3==2.3.0

.......  

Sun, 30 Mar 2025 07:06:16 GMT
Run uv run main.py --greeting "……" --style dark
Sun, 30 Mar 2025 07:06:16 GMT Downloading ruff (10.8MiB)
Sun, 30 Mar 2025 07:06:19 GMT  Downloaded ruff
Sun, 30 Mar 2025 07:06:19 GMT Installed 1 package in 3ms
```

</details>

---

_Comment by @charliermarsh on 2025-03-30 15:21_

By default, `uv run` will ensure that your project environment and lockfile are up-to-date. By default, `dev` dependencies are enabled (see: `https://docs.astral.sh/uv/reference/settings/#default-groups`). So if you use `uv run`, we will install the `dev` dependencies if they're missing. `uv run` does not "remember" what you passed to `uv sync` -- it's not a stateful command.

A few options:

- Remove `dev` from `default-groups`, so `dev` dependencies always need to be enabled explicitly (`uv run --group dev`).
- Pass `--no-sync` to `uv run` (`uv run --no-sync`) so that `uv run` doesn't install new dependencies.

---

_Label `question` added by @charliermarsh on 2025-03-30 15:21_

---

_Assigned to @charliermarsh by @charliermarsh on 2025-03-30 15:21_

---

_Closed by @WitherZuo on 2025-04-07 08:38_

---

_Referenced in [microbiomedata/nmdc-runtime#1251](../../microbiomedata/nmdc-runtime/issues/1251.md) on 2025-10-03 01:45_

---

_Comment by @DimasInchidi on 2025-12-01 22:38_

> Remove `dev` from `default-groups`, so `dev` dependencies always need to be enabled explicitly (`uv run --group dev`).

\cc @charliermarsh 

is there any env var i can use for not passing `--no-sync` for each `uv run` after `uv sync`? it could be useful to make `uv sync` feels like stateful for this kind of use case.

---

_Comment by @zanieb on 2025-12-01 23:05_

You can use `UV_NO_SYNC`

---

_Comment by @zanieb on 2025-12-01 23:06_

You can also use `UV_NO_DEV` instead of `--no-dev`.

---

_Referenced in [astral-sh/uv#16994](../../astral-sh/uv/issues/16994.md) on 2025-12-05 05:18_

---

_Comment by @bartektrybala on 2026-01-02 11:43_

In your case you can just add this to the pyproject.toml:
```
[tool.uv]
# This prevents 'uv run' and 'uv sync' from including dev dependencies by default
default-groups = []
```

---
