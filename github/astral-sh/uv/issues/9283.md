---
number: 9283
title: Incorrect dependency version constraints, maybe due to wrong python verison
type: issue
state: closed
author: tigersoldier
labels:
  - bug
assignees: []
created_at: 2024-11-20T17:15:48Z
updated_at: 2024-11-26T14:51:34Z
url: https://github.com/astral-sh/uv/issues/9283
synced_at: 2026-01-07T12:31:15-06:00
---

# Incorrect dependency version constraints, maybe due to wrong python verison

---

_Issue opened by @tigersoldier on 2024-11-20 17:15_

gensim 3.8.3 should only [require numpy>=1.11.3 on Python 3.x](https://github.com/piskvorky/gensim/blob/e889fa3d45a406cabbc7e180fa9a8ee3f76ac6f0/setup.py#L335-L345). However uv is using the 2.x constraints (numpy <= 1.16.1)

```bash
$ uv --version
uv 0.5.2 (195f4b634 2024-11-14)
$ uv run python --version
Python 3.10.15
$ uv pip install gensim==3.8.3 numpy==1.22.0
  × No solution found when resolving dependencies:
  ╰─▶ Because gensim==3.8.3 depends on numpy<=1.16.1 and you require gensim==3.8.3, we can conclude that you require numpy<=1.16.1.
      And because you require numpy==1.22.0, we can conclude that your requirements are unsatisfiable.
```

---

_Comment by @zanieb on 2024-11-20 17:19_

I presume this is related to the lack of wheels with a compatible Python version? https://inspector.pypi.io/project/gensim/3.8.3/

Can you share verbose logs with `-v`?

---

_Comment by @tigersoldier on 2024-11-21 04:58_

Sure. Looks like it's resolving to a metadata for py 2.7 and macos x86 while I was on arm

```bash
uv pip install gensim==3.8.3 numpy==1.22.0 --no-binary gensim -v
DEBUG uv 0.5.2 (195f4b634 2024-11-14)
DEBUG Searching for default Python interpreter in virtual environments
DEBUG Found `cpython-3.10.15-macos-aarch64-none` at `/Users/caibin.chen/tmp/.venv/bin/python3` (active virtual environment)
Using Python 3.10.15 environment at /Users/caibin.chen/tmp/.venv
DEBUG Acquired lock for `/Users/caibin.chen/tmp/.venv`
DEBUG At least one requirement is not satisfied: numpy==1.22.0
DEBUG Using request timeout of 30s
DEBUG Solving with installed Python version: 3.10.15
DEBUG Solving with target Python version: >=3.10.15
DEBUG Adding direct dependency: gensim>=3.8.3, <3.8.3+
DEBUG Adding direct dependency: numpy>=1.22.0, <1.22.0+
DEBUG Found stale response for: https://pypi.org/simple/gensim/
DEBUG Sending revalidation request for: https://pypi.org/simple/gensim/
DEBUG Found stale response for: https://pypi.org/simple/numpy/
DEBUG Sending revalidation request for: https://pypi.org/simple/numpy/
DEBUG Found not-modified response for: https://pypi.org/simple/numpy/
DEBUG Found not-modified response for: https://pypi.org/simple/gensim/
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/0b/d8/98f051eb7b4c7b8837be3f062a2decb1e99467296603128211851f20c3b5/numpy-1.22.0-cp310-cp310-macosx_11_0_arm64.whl.metadata
DEBUG Searching for a compatible version of gensim (>=3.8.3, <3.8.3+)
DEBUG Selecting: gensim==3.8.3 [compatible] (gensim-3.8.3.tar.gz)
DEBUG Found fresh response for: https://files.pythonhosted.org/packages/e5/1c/eeea5353730937ab38259e057e5c99507bb7cf8ad96d29f8a947ea5e66a7/gensim-3.8.3-cp27-cp27m-macosx_10_9_x86_64.whl.metadata
DEBUG Adding transitive dependency for gensim==3.8.3: numpy<=1.16.1+
DEBUG Adding transitive dependency for gensim==3.8.3: scipy<=1.2.3+
DEBUG Adding transitive dependency for gensim==3.8.3: six>=1.5.0
DEBUG Adding transitive dependency for gensim==3.8.3: smart-open>=1.8.1, <1.11
DEBUG Searching for a compatible version of gensim (>3.8.3, <3.8.3+)
DEBUG No compatible version found for: gensim
DEBUG Found stale response for: https://pypi.org/simple/six/
DEBUG Sending revalidation request for: https://pypi.org/simple/six/
DEBUG Found stale response for: https://pypi.org/simple/smart-open/
DEBUG Sending revalidation request for: https://pypi.org/simple/smart-open/
DEBUG Found stale response for: https://pypi.org/simple/scipy/
DEBUG Sending revalidation request for: https://pypi.org/simple/scipy/
DEBUG Found not-modified response for: https://pypi.org/simple/six/
DEBUG Found not-modified response for: https://pypi.org/simple/scipy/
DEBUG Found not-modified response for: https://pypi.org/simple/smart-open/
  × No solution found when resolving dependencies:
  ╰─▶ Because gensim==3.8.3 depends on numpy<=1.16.1 and you require gensim==3.8.3, we can conclude that you require numpy<=1.16.1.
      And because you require numpy==1.22.0, we can conclude that your requirements are unsatisfiable.
DEBUG Released lock at `/Users/<...>/tmp/.venv/.lock`
```

---

_Comment by @charliermarsh on 2024-11-21 22:40_

I know what the problem is here (none of the wheels are compatible, but we're fetching the "least compatible" Python implementation due to the issue in https://github.com/astral-sh/uv/issues/7553).

I'd note though that this is at least in part a gensim problem: they publish inconsistent metadata across the wheels, which will generally cause problems for uv (and Poetry, and possibly other tools). The wheel that we fetched does indeed say `Requires-Dist: numpy (<=1.16.1)`.


---

_Label `bug` added by @charliermarsh on 2024-11-21 22:40_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-11-21 22:45_

---

_Referenced in [astral-sh/uv#9339](../../astral-sh/uv/pulls/9339.md) on 2024-11-21 22:47_

---

_Comment by @zanieb on 2024-11-22 14:58_

We read metadata from one of the wheels and assume it's consistent with the other ones — this makes resolution far more tractable.

We're considering improving the behavior around this https://github.com/astral-sh/uv/pull/7381, but there are trade-offs.

I did think we ignored py27 wheels regardless though, cc @charliermarsh 

---

_Comment by @zanieb on 2024-11-22 14:59_

Oh sorry this refreshed to show Charlie's comment _after_ I replied. What he said is more correct :)

---

_Closed by @charliermarsh on 2024-11-26 14:51_

---

_Closed by @charliermarsh on 2024-11-26 14:51_

---
