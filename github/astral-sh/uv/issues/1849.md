---
number: 1849
title: "PyPy: `sys.path` seems to be missing venv's `/site-packages`"
type: issue
state: closed
author: edgarrmondragon
labels:
  - bug
  - pypy
assignees: []
created_at: 2024-02-22T02:49:54Z
updated_at: 2024-03-01T04:02:26Z
url: https://github.com/astral-sh/uv/issues/1849
synced_at: 2026-01-07T12:31:14-06:00
---

# PyPy: `sys.path` seems to be missing venv's `/site-packages`

---

_Issue opened by @edgarrmondragon on 2024-02-22 02:49_

              > @edgarrmondragon Is pypy otherwise working for you as it should? I'm asking because we haven't put much focus on pypy so far.

Hey @konstin! I'm testing things out myself. For starters `sys.path` seems to be broken in pypy venvs:

<details><summary>CPython 3.10</summary>
<p>

```console
$ pyenv shell 3.10
$ uv venv venv --python 3.10
$ source venv/bin/activate
$ (venv) python --version
Python 3.10.13
$ (venv) uv pip install requests
Resolved 5 packages in 502ms
Installed 5 packages in 18ms
 + certifi==2024.2.2
 + charset-normalizer==3.3.2
 + idna==3.6
 + requests==2.31.0
 + urllib3==2.2.1
$ (venv) python -c 'import requests; print(requests.get("https://google.com").status_code)'
200
$ (venv) python -c 'import sys; [print(f"{p=}") for p in sys.path]'
p=''
p='/Users/me/.pyenv/versions/3.10.13/lib/python310.zip'
p='/Users/me/.pyenv/versions/3.10.13/lib/python3.10'
p='/Users/me/.pyenv/versions/3.10.13/lib/python3.10/lib-dynload'
p='/Users/me/Code/repro/repro-uv-pypy-hatchling/venv/lib/python3.10/site-packages'
```

</p>
</details>

<details><summary>PyPy 3.10</summary>
<p>

```console
$ pyenv shell pypy3.10
$ uv venv venv --python pypy3.10
$ source venv/bin/activate
$ (venv) python --version
Python 3.10.13 (fc59e61cfbff, Jan 14 2024, 13:00:21)
[PyPy 7.3.15 with GCC Apple LLVM 13.1.6 (clang-1316.0.21.2.5)]
$ (venv) uv pip install requests
Resolved 5 packages in 10ms
Installed 5 packages in 6ms
 + certifi==2024.2.2
 + charset-normalizer==3.3.2
 + idna==3.6
 + requests==2.31.0
 + urllib3==2.2.1
$ (venv) python -c 'import requests; print(requests.get("https://google.com").status_code)'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
ModuleNotFoundError: No module named 'requests'
$ (venv) python -c 'import sys; [print(f"{p=}") for p in sys.path]'
p=''
p='/Users/me/.pyenv/versions/pypy3.10-7.3.15/lib/pypy3.10'
p='/Users/me/.pyenv/versions/pypy3.10-7.3.15/lib/pypy3.10/plat-mac'
p='/Users/me/.pyenv/versions/pypy3.10-7.3.15/lib/pypy3.10/plat-mac/lib-scriptpackages'
```

</p>
</details> 

Notice the venv's `/site-packages` is missing in the PyPy case.

Happy to open a new issue too!

_Originally posted by @edgarrmondragon in https://github.com/astral-sh/uv/issues/1785#issuecomment-1958561905_
            
Related:

* #1488

---

_Label `bug` added by @charliermarsh on 2024-02-22 02:51_

---

_Label `pypy` added by @konstin on 2024-02-22 09:49_

---

_Comment by @konstin on 2024-02-22 09:50_

Thanks for checking and filing this!

---

_Comment by @edgarrmondragon on 2024-03-01 03:59_

Seems to be fixed in main!

```console
$ (venv) python -m site
sys.path = [
    '/Users/me/repro/uv-pypy-hatchling',
    '/Users/me/.pyenv/versions/pypy3.10-7.3.15/lib/pypy3.10',
    '/Users/me/.pyenv/versions/pypy3.10-7.3.15/lib/pypy3.10/plat-mac',
    '/Users/me/.pyenv/versions/pypy3.10-7.3.15/lib/pypy3.10/plat-mac/lib-scriptpackages',
    '/Users/me/repro/uv-pypy-hatchling/venv/lib/pypy3.10/site-packages',
]
USER_BASE: '/Users/me/.local' (exists)
USER_SITE: '/Users/me/.local/lib/pypy3.10/site-packages' (doesn't exist)
ENABLE_USER_SITE: False
```

---

_Comment by @charliermarsh on 2024-03-01 04:02_

Nice, thanks! We still have work to do to make PyPy fully-supported, but this is a start...

---

_Closed by @charliermarsh on 2024-03-01 04:02_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-03-01 04:02_

---
