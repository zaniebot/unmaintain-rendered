---
number: 5096
title: UV ignore pypi index-url when extra-index-url set.
type: issue
state: closed
author: kimdwkimdw
labels: []
assignees: []
created_at: 2024-07-16T06:01:17Z
updated_at: 2024-11-25T18:42:12Z
url: https://github.com/astral-sh/uv/issues/5096
synced_at: 2026-01-07T12:31:14-06:00
---

# UV ignore pypi index-url when extra-index-url set.

---

_Issue opened by @kimdwkimdw on 2024-07-16 06:01_

uv's index-url didn't work in ENVVAR or command args. https://github.com/astral-sh/uv?tab=readme-ov-file#environment-variables

## it should work, but didn't work - (1)
- pip's default index-url is "https://pypi.org/simple".

```
[tool.uv.pip]
extra-index-url = ["https://pypi.custom.ai/"]
```

## it should work, but didn't work - (2)
```
[tool.uv.pip]
index-url= "https://pypi.org/simple"
extra-index-url = ["https://pypi.custom.ai/"]
```

## current workaround

```
[tool.uv.pip]
extra-index-url = ["https://pypi.org/simple", "https://pypi.custom.ai/"]
```

---

_Comment by @j178 on 2024-07-16 06:32_

Please check https://github.com/astral-sh/uv/blob/main/PIP_COMPATIBILITY.md#packages-that-exist-on-multiple-indexes and `uv help pip compile`:
```   
   --extra-index-url <EXTRA_INDEX_URL>
          Extra URLs of package indexes to use, in addition to `--index-url`.

          Accepts either a repository compliant with PEP 503 (the simple repository
          API), or a local directory laid out in the same format.

          All indexes given via this flag take priority over the index in
          `--index-url` (which defaults to PyPI). And when multiple
          `--extra-index-url` flags are given, earlier values take priority.

          [env: UV_EXTRA_INDEX_URL=]    

   --index-strategy <INDEX_STRATEGY>
          The strategy to use when resolving against multiple index URLs.

          By default, `uv` will stop at the first index on which a given package is
          available, and limit resolutions to those present on that first index
          (`first-match`). This prevents "dependency confusion" attacks, whereby an
          attack can upload a malicious package under the same name to a secondary.

          [env: UV_INDEX_STRATEGY=]

          Possible values:
          - first-index:        Only use results from the first index that returns a
            match for a given package name
          - unsafe-first-match: Search for every package name across all indexes,
            exhausting the versions from the first index before moving on to the
            next
          - unsafe-best-match:  Search for every package name across all indexes,
            preferring the "best" version found. If a package version is in multiple
            indexes, only look at the entry for the first index
```

---

_Comment by @kimdwkimdw on 2024-07-16 08:00_

@j178 

Sorry, I didnâ€™t thoroughly review the documentation. It would be better if it supports the same functionality as pip in the future.


---

_Closed by @kimdwkimdw on 2024-07-16 08:00_

---

_Referenced in [astral-sh/uv#5095](../../astral-sh/uv/issues/5095.md) on 2024-07-16 13:23_

---

_Comment by @notatallshaw on 2024-07-16 14:17_

> It would be better if it supports the same functionality as pip in the future.

FYI uv's default behavior is more secure than pip's and should mitigate real world attacks:  https://pytorch.org/blog/compromised-nightly-dependency/

---

_Comment by @shoang22 on 2024-11-04 16:05_

Hi, I'm running into this same issue. I'm not sure what I'm supposed to do to get UV to fall back to the default index.

---

_Comment by @Sairam90 on 2024-11-25 15:39_

If --extra-index-url and --index-url are both specified which url will be searched first ?

---

_Comment by @charliermarsh on 2024-11-25 18:42_

`--extra-index-url` takes priority over `--index-url`. Please see https://docs.astral.sh/uv/pip/compatibility/#packages-that-exist-on-multiple-indexes.

---
