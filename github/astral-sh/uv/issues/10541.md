---
number: 10541
title: Uvx with index url does use the cache and fetches data from reporistory.
type: issue
state: open
author: matejsp
labels:
  - question
  - needs-decision
assignees: []
created_at: 2025-01-12T14:08:10Z
updated_at: 2025-01-13T07:29:17Z
url: https://github.com/astral-sh/uv/issues/10541
synced_at: 2026-01-07T12:31:15-06:00
---

# Uvx with index url does use the cache and fetches data from reporistory.

---

_Issue opened by @matejsp on 2025-01-12 14:08_

We have corporate Nexus as pypi proxy that we use instead pypi index. We really liked that you can have multiple versions of each tool.
However this only works with default index pypi.org and not with our Nexus: 

```
uvx --python 3.11.6 --default-index https://nexus.company.net/repostiory/pypi/simple --with poetry-dynamic-versioning==1.5.0 --with poetry-plugin-export==1.8.0 poetry@2.0.1 --help
```

Now when using our nexus proxy it seems that uvx is not able to cache it and instead tries to call nexus for each call.

```
➜  projects uvx --python 3.11.6 --default-index https://nexus.company.net/repostiory/pypi/simple --with poetry-dynamic-versioning==1.5.0 --with poetry-plugin-export==1.8.0 poetry@2.0.1 --help
⠼ poetry==2.0.1                                                                                                                                                                                                                                                                                 error: Failed to fetch: `https://nexus.company.net/repostiory/pypi/simple/keyring/`
  Caused by: Could not connect, are you offline?
  Caused by: Request failed after 3 retries
  Caused by: error sending request for url (https://nexus.company.nett/repository/pypi/simple/keyring/)
  Caused by: client error (Connect)
  Caused by: dns error: failed to lookup address information: nodename nor servname provided, or not known
  Caused by: failed to lookup address information: nodename nor servname provided, or not known
```

I would expect that when running uvx tool multiple times with the same version they would be cached offline and just work.


---

_Comment by @charliermarsh on 2025-01-13 02:40_

I believe we refresh the tool on each invocation (this is typically a no-op if run in succession due to the caching headers). If you want `uvx` to avoid doing that, I'd suggest running `uv tool install --with poetry-dynamic-versioning==1.5.0 --with poetry-plugin-export==1.8.0 poetry@2.0.1`. Then, subsequent `uvx poetry` invocations will use that installed tool.

I guess we could try to make uvx robust to these kinds of failures, though it's hard to know when they should or shouldn't be shown. Like, we'd probably at least want to show a user-facing warning? \cc @zanieb 

I'm a little confused though -- why does the authentication fail in the second invocation?


---

_Label `question` added by @charliermarsh on 2025-01-13 02:40_

---

_Label `needs-decision` added by @charliermarsh on 2025-01-13 02:40_

---

_Comment by @matejsp on 2025-01-13 07:29_

It fails at second invocation because I deliberately disconnected my computer from the internet to show the problem that caching does not work (or just disconnecting from my work VPN).

Yes without --default-index caching works but then it is not using our whitelisted packages in nexus.

We don't want to use install since it is installed globally and poetry 2.x introduced some breaking changes that's why we want to use it like this (without install) relying on caching behavior that currently only works with pypi.org.

We want to use 1.8.4 and 2.0.1 based on what each microservice is currently using.

---
