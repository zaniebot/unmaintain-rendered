---
number: 10201
title: "Workflow Headache: dev dependencies (private) are resolved when not included"
type: issue
state: closed
author: ayjayt
labels:
  - question
assignees: []
created_at: 2024-12-27T17:00:33Z
updated_at: 2025-01-22T18:15:43Z
url: https://github.com/astral-sh/uv/issues/10201
synced_at: 2026-01-07T12:31:15-06:00
---

# Workflow Headache: dev dependencies (private) are resolved when not included

---

_Issue opened by @ayjayt on 2024-12-27 17:00_

Hi!

Sometimes my dev dependencies come from private repos, and therefore they can't be resolved in all workflows:

* during normal usage
* during CI testing

for example

`uv` seems to try and resolve all dependency groups even if they're not included. :-)

Just posting this here to start a discussion!

Thanks

---

_Comment by @T-256 on 2024-12-27 17:58_

Dependencies in `dev` group get [resolved by default](https://docs.astral.sh/uv/concepts/projects/dependencies/#default-groups):

> By default, uv includes the dev dependency group in the environment (e.g., during uv run or uv sync). The default groups to include can be changed using the tool.uv.default-groups setting.
> 
> ```toml
> [tool.uv]
> default-groups = ["dev", "foo"]
> ```


---

_Comment by @ayjayt on 2024-12-27 18:10_

Hi @T-256, **all dependencies get _resolved_ ~by default~ everytime**, even if they are not actually downloaded and installed (ie _included_). This is not documented, but it is the actual implemented behavior.

You can test this by creating a nonsense group with a nonsense dependency and then explicitly telling it not to be installed.

```toml
# pyroject.toml

[dependency-groups]
foo = [
    "bar_does_not_exists"
]
```

`uv sync --no-group foo`

---

_Comment by @charliermarsh on 2024-12-27 22:15_

Yeah, it's intentional that we always resolve all groups. If you have workflows where you need to use your project without resolving those groups, you should be able to `uv run` without re-resolving, as long as you have a `uv.lock` checked in.

---

_Label `question` added by @charliermarsh on 2024-12-27 22:15_

---

_Comment by @ayjayt on 2024-12-27 23:59_

I feel I don't understand the implementation of `uv run` and `uv.lock` well enough to comment, but my understanding is that:

if there is an updated `uv.lock` checked in to the **git repo** , `uv run` will skip the resolving phase and use whatever is in `uv.lock`, even if the dependencies impossible to resolve were added after the `uv.lock` was checked in?

Is there some kind of contribution I could make to provide a solution by which certain dependency groups could be entirely ignored by `uv`?

Such as a 

```
[tool.uv]
ignore-groups = ["nickelback", "phish"]
```

~It would also roll into my other issue: https://github.com/astral-sh/uv/issues/10200#issuecomment-2564096152~

?

---

_Comment by @schloerke on 2025-01-22 16:28_

> it's intentional that we always resolve all groups

Maybe I'm missing something, but when calling `uv` command where I've explicitly asked for an extra group (`--group foo`) or to ignore a group (`--no-group foo`) then I'd expect it to only attempt to resolve those tangible groups. Only the groups required for execution should be used for dependency resolution.

My interpretation of the groups is that if I stated `uv sync --no-group foo` with the pyproject.toml above, I'd expect it to have the same behavior as `[dependency-group]` project file which has called `uv sync`.  

Crafting a `uv.lock` file manually doesn't seem like a long term solution.

---

_Comment by @zanieb on 2025-01-22 16:35_

We resolve all groups and use a shared resolution for the project (stored in `uv.lock`). Selecting groups only applies to which subset of the lockfile is synced. This is a fundamental behavior of uv — we're not likely to change it. I understand why it'd be nice to avoid resolving those groups in some cases, but it's not realistic for us to implement.

---

_Closed by @zanieb on 2025-01-22 16:35_

---

_Comment by @ayjayt on 2025-01-22 18:00_

Yeah I took a look at your source code and realized it would be difficult, so I switched to commenting them out.

I think there could be such a thing as "explicit groups" that would only ever been included if they were explicitly asked to be included. I think that would play nicely with the "fork" concepts that was recently implemented in the conflicts PR.

If you view your program as a pipeline from 

`specification (pyproject.toml)  --> lock file (uv.lock) --> environment (.venv)`

I think that model could incorporate this idea, and the "explicit groups" would be ignored between any edge unless explicitly included.

That said, I realize you have a lot to deal with, as do I, I wish I had time to make contribution, and I appreciate the work you've done on the project.

---

_Comment by @ayjayt on 2025-01-22 18:06_

@schloerke I agree with you, but consider this:

Some development dependencies **may be used by certain users or not** and therefore uv, in its effort to alert the developer of conflicts, should also execute the resolution algorithm against all dependencies in order to determine where conflicts would exist within the deployment.

Also, the `uv.lock` is also a cache for the results of this algorithm. So it should contain all possible states.

---

_Comment by @zanieb on 2025-01-22 18:15_

Yeah we'd need to resolve them in combination with the other groups and project because they _could_ be installed together. The main thing we could do is add support for _only_ using a group in isolation — so only `uv sync --only-group foo` would be allowed.

---

_Referenced in [astral-sh/uv#11104](../../astral-sh/uv/issues/11104.md) on 2025-01-30 21:44_

---
