---
number: 14711
title: uv seems to ignore python-requires upper-binding
type: issue
state: closed
author: potiuk
labels:
  - bug
assignees: []
created_at: 2025-07-18T10:35:38Z
updated_at: 2025-08-24T20:45:42Z
url: https://github.com/astral-sh/uv/issues/14711
synced_at: 2026-01-07T12:31:16-06:00
---

# uv seems to ignore python-requires upper-binding

---

_Issue opened by @potiuk on 2025-07-18 10:35_

### Summary

When installing a package that has upper-binding of Python version, it seems that this upper-binding is ignored.

We encountered it in Airflow when `uv` installed `snowflake-snowpark-python`  in our newly released Python 3.13 image, but `pip` refuses to install it. After some investigation it turned out that `uv` seems to ignore explicit upper-binding for Python < 3.13 tha `snowflake-snowpark-python` has.

In the metadata of the `snowflake-snowpark-python==1.34.0`  - all versions seem to have upper binding as well you can find this:

```
Requires-Python: >=3.9, <3.13
```

See: https://pypi.org/project/snowflake-snowpark-python/1.34.0/

When you attempt to install it in python 3.13.5 with `pip`, it correctly refuses to install it (both when we specify the version and when we do not):

```bash
root@10ca61626a43:/opt/airflow# pip install snowflake-snowpark-python==1.34.0
ERROR: Ignored the following versions that require a different python version: 0.10.0 Requires-Python ==3.8.*; 0.11.0 Requires-Python ==3.8.*; 0.12.0 Requires-Python ==3.8.*; 0.6.0 Requires-Python ==3.8.*; 0.7.0 Requires-Python ==3.8.*; 0.8.0 Requires-Python ==3.8.*; 0.9.0 Requires-Python ==3.8.*; 1.0.0 Requires-Python ==3.8.*; 1.1.0 Requires-Python ==3.8.*; 1.10.0 Requires-Python >=3.8, <3.12; 1.11.0 Requires-Python >=3.8, <3.12; 1.11.1 Requires-Python >=3.8, <3.12; 1.12.0 Requires-Python >=3.8, <3.12; 1.12.1 Requires-Python >=3.8, <3.12; 1.13.0 Requires-Python >=3.8, <3.12; 1.14.0 Requires-Python <3.12,>=3.8; 1.15.0 Requires-Python <3.12,>=3.8; 1.16.0 Requires-Python <3.12,>=3.8; 1.17.0 Requires-Python <3.12,>=3.8; 1.18.0 Requires-Python <3.12,>=3.8; 1.19.0 Requires-Python <3.12,>=3.8; 1.2.0 Requires-Python ==3.8.*; 1.20.0 Requires-Python <3.12,>=3.8; 1.21.0 Requires-Python <3.12,>=3.8; 1.21.1 Requires-Python <3.12,>=3.8; 1.22.0 Requires-Python <3.12,>=3.8; 1.22.1 Requires-Python <3.12,>=3.8; 1.23.0 Requires-Python <3.12,>=3.8; 1.24.0 Requires-Python <3.12,>=3.8; 1.25.0 Requires-Python <3.12,>=3.8; 1.26.0 Requires-Python <3.12,>=3.8; 1.27.0 Requires-Python <3.13,>=3.8; 1.28.0 Requires-Python <3.13,>=3.8; 1.29.0 Requires-Python <3.13,>=3.8; 1.29.1 Requires-Python <3.13,>=3.8; 1.3.0 Requires-Python ==3.8.*; 1.30.0 Requires-Python <3.13,>=3.8; 1.31.0 Requires-Python <3.13,>=3.9; 1.31.1 Requires-Python <3.13,>=3.9; 1.32.0 Requires-Python <3.13,>=3.9; 1.33.0 Requires-Python <3.13,>=3.9; 1.34.0 Requires-Python <3.13,>=3.9; 1.4.0 Requires-Python ==3.8.*; 1.5.0 Requires-Python >=3.8, <3.10; 1.5.1 Requires-Python >=3.8, <3.11; 1.6.0 Requires-Python >=3.8, <3.11; 1.6.1 Requires-Python >=3.8, <3.11; 1.7.0 Requires-Python >=3.8, <3.11; 1.8.0 Requires-Python >=3.8, <3.11; 1.9.0 Requires-Python >=3.8, <3.12
ERROR: Could not find a version that satisfies the requirement snowflake-snowpark-python==1.34.0 (from versions: none)
ERROR: No matching distribution found for snowflake-snowpark-python==1.34.0
root@10ca61626a43:/opt/airflow# pip install snowflake-snowpark-python
ERROR: Ignored the following versions that require a different python version: 0.10.0 Requires-Python ==3.8.*; 0.11.0 Requires-Python ==3.8.*; 0.12.0 Requires-Python ==3.8.*; 0.6.0 Requires-Python ==3.8.*; 0.7.0 Requires-Python ==3.8.*; 0.8.0 Requires-Python ==3.8.*; 0.9.0 Requires-Python ==3.8.*; 1.0.0 Requires-Python ==3.8.*; 1.1.0 Requires-Python ==3.8.*; 1.10.0 Requires-Python >=3.8, <3.12; 1.11.0 Requires-Python >=3.8, <3.12; 1.11.1 Requires-Python >=3.8, <3.12; 1.12.0 Requires-Python >=3.8, <3.12; 1.12.1 Requires-Python >=3.8, <3.12; 1.13.0 Requires-Python >=3.8, <3.12; 1.14.0 Requires-Python <3.12,>=3.8; 1.15.0 Requires-Python <3.12,>=3.8; 1.16.0 Requires-Python <3.12,>=3.8; 1.17.0 Requires-Python <3.12,>=3.8; 1.18.0 Requires-Python <3.12,>=3.8; 1.19.0 Requires-Python <3.12,>=3.8; 1.2.0 Requires-Python ==3.8.*; 1.20.0 Requires-Python <3.12,>=3.8; 1.21.0 Requires-Python <3.12,>=3.8; 1.21.1 Requires-Python <3.12,>=3.8; 1.22.0 Requires-Python <3.12,>=3.8; 1.22.1 Requires-Python <3.12,>=3.8; 1.23.0 Requires-Python <3.12,>=3.8; 1.24.0 Requires-Python <3.12,>=3.8; 1.25.0 Requires-Python <3.12,>=3.8; 1.26.0 Requires-Python <3.12,>=3.8; 1.27.0 Requires-Python <3.13,>=3.8; 1.28.0 Requires-Python <3.13,>=3.8; 1.29.0 Requires-Python <3.13,>=3.8; 1.29.1 Requires-Python <3.13,>=3.8; 1.3.0 Requires-Python ==3.8.*; 1.30.0 Requires-Python <3.13,>=3.8; 1.31.0 Requires-Python <3.13,>=3.9; 1.31.1 Requires-Python <3.13,>=3.9; 1.32.0 Requires-Python <3.13,>=3.9; 1.33.0 Requires-Python <3.13,>=3.9; 1.34.0 Requires-Python <3.13,>=3.9; 1.4.0 Requires-Python ==3.8.*; 1.5.0 Requires-Python >=3.8, <3.10; 1.5.1 Requires-Python >=3.8, <3.11; 1.6.0 Requires-Python >=3.8, <3.11; 1.6.1 Requires-Python >=3.8, <3.11; 1.7.0 Requires-Python >=3.8, <3.11; 1.8.0 Requires-Python >=3.8, <3.11; 1.9.0 Requires-Python >=3.8, <3.12
ERROR: Could not find a version that satisfies the requirement snowflake-snowpark-python (from versions: none)
ERROR: No matching distribution found for snowflake-snowpark-python
```

However `uv` will happily install it - both with and without specified version:

```
root@10ca61626a43:/opt/airflow# uv pip install snowflake-snowpark-python
Using Python 3.13.5 environment at: /usr/local
Resolved 32 packages in 8ms
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ [0/1] Installing wheels...                                                                                                                                                                                                                                                
Installed 1 package in 13ms
 + snowflake-snowpark-python==1.34.0
```

```
root@10ca61626a43:/opt/airflow# uv pip install snowflake-snowpark-python==1.34.0
Using Python 3.13.5 environment at: /usr/local
Resolved 32 packages in 119ms
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ [0/1] Installing wheels...                                                                                                                                                                                                                                                
Installed 1 package in 16ms
 + snowflake-snowpark-python==1.34.0
```

### Platform

Debian Bookworm with Python 3.13 installed

### Version

uv 0.7.21

### Python version

3.13.5

---

_Label `bug` added by @potiuk on 2025-07-18 10:35_

---

_Referenced in [apache/airflow#53489](../../apache/airflow/pulls/53489.md) on 2025-07-18 10:54_

---

_Comment by @konstin on 2025-07-18 12:03_

We intentionally ignore upper-bounds on `requires-python`, as considering it would lead to undesirable outcomes, see https://github.com/astral-sh/uv/issues/4022 and https://discuss.python.org/t/requires-python-upper-limits/12663 for details.

---

_Comment by @potiuk on 2025-07-18 14:45_

Sure - I see that this is kind of difficult problem, I recently started to understand complexity of this so I understand where it comes  from - the discussion and earlier issues : 

* https://github.com/astral-sh/uv/issues/14481
* https://github.com/astral-sh/uv/issues/14422

And yeah - I see https://docs.astral.sh/uv/pip/compatibility/#requires-python-enforcement where it is clearly described, so I do not complain about it.

But I would love to understand two things:

1)  Seems that `pip` behaviour here is different (it refuses to install the package) and the docs says:

> While this is not strictly compliant with [PEP 440](https://peps.python.org/pep-0440/), it is consistent with [pip](https://github.com/pypa/pip/blob/24.1.1/src/pip/_internal/resolution/resolvelib/candidates.py#L540).

Is there something you or `pip` missing here? I know you cannot respond for `pip` but seems that the behaviour is inconsistent. And this is actually led me to this issue - because we are using `uv` to resolve matching dependencies but then using constraints generated to install it using `pip` and - those two are inconsistent.

2) I guess (would love to clarify) that this does not include `!=` in Python Requires. In our case we would like to have an explicit way of stating that `airflow` does not support Python 3.14 when it gets released (because we know it won't work for 4-7 months because many of our dependencies will not work either). So far we were using < 3.14 - following earlier discussions but then it might actually mean that we should use `!=3.14` - though possibly it makes no sense as well because it means that someone will be able to install it on 3.15. Is there any other way to "hard" stop from installing on unsupported Python version? Or maybe the only "good" way is runtime check ?

What is your take and suggestion? 


---

_Comment by @charliermarsh on 2025-07-18 14:48_

> While this is not strictly compliant with [PEP 440](https://peps.python.org/pep-0440/), it is consistent with [pip](https://github.com/pypa/pip/blob/24.1.1/src/pip/_internal/resolution/resolvelib/candidates.py#L540).

That piece only applies to: "When evaluating Python versions against requires-python specifiers, uv truncates the candidate version to the major, minor, and patch components, ignoring (e.g.) pre-release and post-release identifiers." (as in the linked snippet to pip source). We can make that clearer.


---

_Comment by @potiuk on 2025-07-18 15:00_

> That piece only applies to: "When evaluating Python versions against requires-python specifiers, uv truncates the candidate version to the major, minor, and patch components, ignoring (e.g.) pre-release and post-release identifiers." (as in the linked snippet to pip source). We can make that clearer.

Makes sense, yeah, it would be great to clarify, because it's a separate paraghraph and it looks like conclusion on the whole "chapter". 

I understand now that `uv` behaves differently than `pip` then, because (despite all the discussions) pip has not decided to simply drop the "upper-bound" requirements. I understand why, but I think it should be quite clearly spelled out that it is different than `pip`. And yeah - in this case I think you are perfectly free to decide how your solver works for this, becaus this is indeed super ambiguous and the behaviour of upper-bining or != is not really what makes sense long term.

I think also (in relation to https://github.com/astral-sh/uv/issues/14422) - It might be worth to correct the message  that is printed now (and yes I was one of the reason for this message to be changed). I think it would be worth telling in the message not that `~` is ambiguous, but more because it introduced upper-binding which is considered as "bad" widely (and possibly linking to the discussion). That might have better educational effect. 

Coming back to the second question though - is there **any** portable way to say "please don't even try to install me on Python 3.14+" at the resolve time? It looks to me that there is no (and It's not a judgment of whethere it's good or bad, rather question that we need to find an answer to) ?

---

_Comment by @charliermarsh on 2025-07-18 16:56_

> Coming back to the second question though - is there any portable way to say "please don't even try to install me on Python 3.14+" at the resolve time? It looks to me that there is no (and It's not a judgment of whethere it's good or bad, rather question that we need to find an answer to) ?

No, I don't believe so. What some libraries will do is _not_ ship wheels for those versions, then error out during the build process if someone attempts to build with an unsupported Python version. But we can't make use of that during resolution; instead, the resolution would fail. But you could prompt users to add a lower or upper bound on their dependency declaration.

---

_Comment by @potiuk on 2025-07-18 19:16_

> But you could prompt users to add a lower or upper bound on their dependency declaration.

Yep, and I understand difficulty there. That would work for libraries, but not for apps lke airflow (you just **install** airflow not depend on airflow). 

But - it's not a big issue for now for us. I at least know the strategy we should take. That further stresses the "usage" that at least we in aifrlow have -  where for us uv is mostly a "developer" tool, and not "end user tool". Simply our recommendation is still "only use pip and best - also use --constraints` for installing airflow, rather than also recommending uv or other tools (and I do not see it changing any time soon).

So we can easily rely on pip actually not allowing to install airflow for upper-bound python in python requires and reject any issues of people who will use uv on not supported version and direct them to "use pip". That's fairly ok for us. We have experience with that - we have been alreahady communicating similarly to our users that for example installing with poetry or pipenv or other tools is not something we support nor recommend and using `pip` is the only thing that we support and help our users with. I guess it will have to stay like that for a while.

I know you are thinking (?) developing(?)  some uv.tool entry in pyproject.toml entry - which further underlines how uv  (at least in this case) is more a "development" than "end user" tool - and it will allow maintainers to locally limit their python versions - but this will not propagate to end users. Which is fine, I think the "development" story of uv is much stronger than "end user" story (and there are good reasons for that)

---

_Comment by @zanieb on 2025-07-18 20:26_

For installation of tools or "applications", I'm sort of interested in respecting first-party `requires-python` constraints, e.g., `uv tool install foo` would respect a `requires-python` upper bound in `foo` when selecting an interpreter to use but not during resolution.

I'm not sure how feasible it is though, and whether it would be more confusing.

---

_Comment by @potiuk on 2025-07-18 20:34_

> For installation of tools or "applications", I'm sort of interested in respecting first-party `requires-python` constraints, e.g., `uv tool install foo` would respect a `requires-python` upper bound in `foo` when selecting an interpreter to use but not during resolution.

Might be quite an idea actually. I don't think that would be too confusing if desribed well and failing with a proper error message  (and possibly an option to --override-upper-bound-python-limits flag - yeah I know ... far too long name ;) , Naming is hard :D

---

_Comment by @potiuk on 2025-07-18 20:39_

And yes. Actually I quite agree `uv tool install` is a fantastic "end-user" side of uv that probably can behave differently. I really like the idea ;) 

---

_Comment by @notatallshaw on 2025-07-18 22:05_

> When you attempt to install it in python 3.13.5 with pip, it correctly refuses to install it

Pip's behavior has lots of buggy edge cases, such as installing on Python `3.14.0b2` when you specify `Requires-Python: <= 3.14.0b1`. But as there is no standard to comply to here it's not possible to justify a fix in behavior, including with adding the "recommended" ignore upper bounds.

> > Coming back to the second question though - is there any portable way to say "please don't even try to install me on Python 3.14+" at the resolve time? It looks to me that there is no (and It's not a judgment of whethere it's good or bad, rather question that we need to find an answer to) ?
> 
> No, I don't believe so.

Well... you could write:

 ```toml
requires-python = ">=3.9,!=3.13,!=3.14,!=3.15,!=3.16,!=3.17,!=3.18,!=3.19,!=3.20,!=3.21,!=3.22,!=3.23,!=3.24,!=3.25,!=3.26,!=3.27,!=3.28,!=3.29,!=3.30,!=3.31,!=3.32"  # Hopefully no one is checking this package in Python 3.33+ ðŸ˜‰ 
```

> there something you or `pip` missing here? I know you cannot respond for `pip` but seems that the behaviour is inconsistent.

uv offers features pip does not, such as universal resolution, so there's no comparison there that can be made about consistency with those.

And  `requires-python` has no defined semantics in the standards, and it is useful to use different semantics in different contexts (resolution, library installation, tool installation, script in-line metadata, lock files, etc.). This came up again discussing a new possible standard just a couple of days ago: https://discuss.python.org/t/pre-pep-locking-a-pep-723-single-file-script/98034/54

---

_Comment by @potiuk on 2025-07-19 08:34_

> This came up again discussing a new possible standard just a couple of days ago: https://discuss.python.org/t/pre-pep-locking-a-pep-723-single-file-script/98034/54

Thanks for the pointer interesting discussions - indeed I am learning new things about requires-python every day it seems :)



---

_Referenced in [astral-sh/uv#14752](../../astral-sh/uv/pulls/14752.md) on 2025-07-20 13:39_

---

_Comment by @charliermarsh on 2025-07-20 22:34_

(I amended the docs in https://github.com/astral-sh/uv/pull/14752.)

---

_Comment by @potiuk on 2025-07-21 08:52_

> (I amended the docs in [#14752](https://github.com/astral-sh/uv/pull/14752).)

Nice! Thank you!

---

_Referenced in [astral-sh/uv#14958](../../astral-sh/uv/issues/14958.md) on 2025-07-29 18:36_

---

_Comment by @charliermarsh on 2025-08-22 17:32_

@potiuk -- Okay to close this out for now?

---

_Comment by @potiuk on 2025-08-24 20:45_

Sure!

---

_Closed by @potiuk on 2025-08-24 20:45_

---

_Referenced in [astral-sh/uv#15666](../../astral-sh/uv/issues/15666.md) on 2025-09-03 16:44_

---

_Referenced in [apache/airflow#58653](../../apache/airflow/pulls/58653.md) on 2025-11-25 00:28_

---

_Referenced in [apache/airflow#58657](../../apache/airflow/pulls/58657.md) on 2025-11-25 00:30_

---
