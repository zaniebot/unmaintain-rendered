---
number: 14967
title: Multi-platform requirement.txt export
type: issue
state: closed
author: LatreviousYI
labels:
  - question
assignees: []
created_at: 2025-07-30T09:25:12Z
updated_at: 2025-07-31T02:03:13Z
url: https://github.com/astral-sh/uv/issues/14967
synced_at: 2026-01-07T12:31:16-06:00
---

# Multi-platform requirement.txt export

---

_Issue opened by @LatreviousYI on 2025-07-30 09:25_

### Question

sometimes,i need export a requirement.txt,this can be use by Multi-platform like window or linux ,some Third-party libraries can not install in linux like pywin32,but i develop in window ,like poetry can export public requirement.txt like this

<img width="742" height="159" alt="Image" src="https://github.com/user-attachments/assets/256ddd17-4f20-4326-9bb2-284b39d0be4d" />

### Platform

_No response_

### Version

_No response_

---

_Label `question` added by @LatreviousYI on 2025-07-30 09:25_

---

_Comment by @konstin on 2025-07-30 09:41_

You can use the `--universal` flag to export a multi-platform `requirements.txt`.

---

_Comment by @charliermarsh on 2025-07-31 01:20_

Can you please provide a complete reproduction? What are your input files? What commands are you running exactly? What do you expect to "depend on" `pywin32`?

---

_Comment by @LatreviousYI on 2025-07-31 01:28_

> You can use the `--universal` flag to export a multi-platform `requirements.txt`.
Ok, but I tried it, and the result was not what I wanted.

<img width="824" height="317" alt="Image" src="https://github.com/user-attachments/assets/1932bff6-e83b-4724-8d1a-43d82e8597bd" />
I think it's because  `--no-strip-markers`


---

_Comment by @LatreviousYI on 2025-07-31 01:35_

> Can you please provide a complete reproduction? What are your input files? What commands are you running exactly? What do you expect to "depend on" `pywin32`?

Since I’m developing on Windows, some libraries handle different platforms differently. Some libraries have underlying dependencies that include pywin32, but installing this library on Linux will result in an error. This is my command: 
`uv pip compile --universal .\pyproject.toml -o requirements.txt.`



---

_Comment by @charliermarsh on 2025-07-31 01:39_

We need the `pyproject.toml` file that you're using as an input. Without it, there's no way of knowing what the correct output is.

---

_Comment by @LatreviousYI on 2025-07-31 01:41_

> We need the `pyproject.toml` file that you're using as an input. Without it, there's no way of knowing what the correct output is.

ok This is my pyproject.toml 
```
[project]
name = "json-migration"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
    "aiomysql>=0.2.0",
    "pywin32>=311",
]
[tool.ruff]
line-length = 50
indent-width = 4
[tool.ruff.format]
# Like Black, use double quotes for strings.
quote-style = "double"
indent-style = "space"

```

---

_Comment by @charliermarsh on 2025-07-31 01:50_

The output looks correct, then. You've declared that your project depends on `pywin32>=311`, so it will always be included in the output. If you only want it on Windows, then you need to do something like `pywin32>=311 ; platform_system == "Windows"` in your `project.dependencies` list.

---

_Comment by @LatreviousYI on 2025-07-31 01:59_

> The output looks correct, then. You've declared that your project depends on `pywin32>=311`, so it will always be included in the output. If you only want it on Windows, then you need to do something like `pywin32>=311 ; platform_system == "Windows"` in your `project.dependencies` list.

I know that when pywin32 is a second- or third-level dependency, platform markers are automatically added. But if it is a first-level dependency, they won’t be. like this
by the way  thank all of you help me I appreciate
```
[project]
name = "json-migration"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
    "aiomysql>=0.2.0",
    "nb-log>=13.7",
]
[tool.ruff]
line-length = 50
indent-width = 4
[tool.ruff.format]
# Like Black, use double quotes for strings.
quote-style = "double"
indent-style = "space"
[[tool.uv.index]]
url="https://pypi.tuna.tsinghua.edu.cn/simple"
default=true
```
```
# This file was autogenerated by uv via the following command:
#    uv pip compile --universal .\pyproject.toml -o requirements.txt
aiomysql==0.2.0
    # via json-migration (./pyproject.toml)
attrs==25.3.0
    # via service-identity
certifi==2025.7.14
    # via requests
cffi==1.17.1 ; platform_python_implementation != 'PyPy'
    # via cryptography
chained-mode-time-tool==0.4
    # via nb-log
charset-normalizer==3.4.2
    # via requests
concurrent-log-handler==0.9.23
    # via nb-log
cryptography==45.0.5
    # via service-identity
deprecated==1.2.14
    # via nb-log
idna==3.10
    # via requests
logging-tree==1.10
    # via nb-log
nb-filelock==0.9
    # via nb-log
nb-libs==2.0
    # via nb-log
nb-log==13.7
    # via
    #   json-migration (./pyproject.toml)
    #   nb-libs
portalocker==2.3.2
    # via
    #   concurrent-log-handler
    #   nb-filelock
pyasn1==0.6.1
    # via
    #   pyasn1-modules
    #   service-identity
pyasn1-modules==0.4.2
    # via service-identity
pycparser==2.22 ; platform_python_implementation != 'PyPy'
    # via cffi
pymysql==1.1.1
    # via aiomysql
python-json-logger==0.1.10
    # via nb-log
pytz==2025.2
    # via
    #   chained-mode-time-tool
    #   nb-libs
pywin32==311 ; sys_platform == 'win32'
    # via portalocker
requests==2.32.4
    # via nb-log
service-identity==24.2.0
    # via nb-log
tomorrow3==1.1.0
    # via nb-log
tzdata==2025.2 ; sys_platform == 'win32'
    # via tzlocal
tzlocal==5.3.1
    # via nb-libs
urllib3==2.5.0
    # via requests
wrapt==1.17.2
    # via deprecated

```

---

_Comment by @charliermarsh on 2025-07-31 02:00_

That looks right to me.

If you define:
```toml
[project]
name = "json-migration"
version = "0.1.0"
description = "Add your description here"
readme = "README.md"
requires-python = ">=3.10"
dependencies = [
    "aiomysql>=0.2.0",
    "pywin32>=311",
]
```

Then it is correct to output `pywin32==311` without any markers, since you don't have any markers on your requirement definition. You're saying that you _always_ want `pywin32` to be installed.

---

_Closed by @charliermarsh on 2025-07-31 02:00_

---

_Comment by @LatreviousYI on 2025-07-31 02:02_

> That looks right to me.
> 
> If you define:
> 
> [project]
> name = "json-migration"
> version = "0.1.0"
> description = "Add your description here"
> readme = "README.md"
> requires-python = ">=3.10"
> dependencies = [
>     "aiomysql>=0.2.0",
>     "pywin32>=311",
> ]
> Then it is correct to output `pywin32==311` without any markers, since you don't have any markers on your requirement definition. You're saying that you _always_ want `pywin32` to be installed.

thank you so much and thank you for your patience

---
