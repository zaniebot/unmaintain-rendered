---
number: 17161
title: "Make settings from [uv.tool] section defined in pyproject.toml always effective when pyproject.toml is used in uv CLI commands."
type: issue
state: open
author: pstrzelczak
labels:
  - enhancement
assignees: []
created_at: 2025-12-17T10:45:19Z
updated_at: 2025-12-19T12:49:48Z
url: https://github.com/astral-sh/uv/issues/17161
synced_at: 2026-01-07T13:12:19-06:00
---

# Make settings from [uv.tool] section defined in pyproject.toml always effective when pyproject.toml is used in uv CLI commands.

---

_Issue opened by @pstrzelczak on 2025-12-17 10:45_

### Summary

I noticed that in some cases settings defined in `[uv.tool]` get lost when current directory differs from the location of `pyproject.toml` file. This is particularly painful for use cases when multiple `pyproject.toml` are involved. A notable example of this pain is a use case to compile dependencies of multiple projects via `uv pip compile` when each respective `pyproject.toml` has exclude-dependencies defined.

### Example

I have a project-a and project-b.

project-a pyproject.toml:
```
[project]
name = "project-a"
version = "0.1.0"
description = "A helpful local library"
requires-python = ">=3.12"
dependencies = ["python-dateutil"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["src/project_a"]

[tool.uv]
exclude-dependencies = ["six"]
```

project-b pyproject.toml (almost same):
```
[project]
name = "project-b"
version = "0.1.0"
description = "A helpful local library"
requires-python = ">=3.12"
dependencies = ["python-dateutil"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["src/project_b"]

[tool.uv]
exclude-dependencies = ["six"]
```

Now:
```
$ uv pip compile project-b/pyproject.toml project-a/pyproject.toml
Resolved 2 packages in 91ms
# This file was autogenerated by uv via the following command:
#    uv pip compile project-b/pyproject.toml project-a/pyproject.toml
python-dateutil==2.9.0.post0
    # via
    #   project-a (project-a/pyproject.toml)
    #   project-b (project-b/pyproject.toml)
six==1.17.0
    # via python-dateutil

$ uv pip compile project-b/pyproject.toml project-a/pyproject.toml --project project-a/
Resolved 2 packages in 2ms
# This file was autogenerated by uv via the following command:
#    uv pip compile project-b/pyproject.toml project-a/pyproject.toml --project project-a/
python-dateutil==2.9.0.post0
    # via
    #   project-a (project-a/pyproject.toml)
    #   project-b (project-b/pyproject.toml)
six==1.17.0
    # via python-dateutil
```

The only way to get rid of unwanted transitive dependency is to use --exclude:
```
$ cat excludes.txt 
six

$ uv pip compile project-b/pyproject.toml project-a/pyproject.toml --exclude excludes.txt 
Resolved 1 package in 2ms
# This file was autogenerated by uv via the following command:
#    uv pip compile project-b/pyproject.toml project-a/pyproject.toml --exclude excludes.txt
python-dateutil==2.9.0.post0
    # via
    #   project-a (project-a/pyproject.toml)
    #   project-b (project-b/pyproject.toml)
```

---

_Label `enhancement` added by @pstrzelczak on 2025-12-17 10:45_

---

_Label `enhancement` removed by @konstin on 2025-12-17 10:58_

---

_Label `question` added by @konstin on 2025-12-17 10:58_

---

_Label `question` removed by @konstin on 2025-12-17 11:00_

---

_Label `enhancement` added by @konstin on 2025-12-17 11:00_

---

_Comment by @konstin on 2025-12-17 11:19_

Currently, uv only loads the settings of the closest `pyproject.toml`, i.e. the one in the current directory, while ignoring the other configurations (there is no configuration merging across input files).

It also looks like in project-a pyproject.toml, the `[tool.uv]` header before `exclude-dependencies = ["six"]` is missing, though that's not the cause here.

---

_Comment by @pstrzelczak on 2025-12-17 11:33_

@konstin thanks for noticing the mistake. I edited my original report. I aware of the note [here](https://docs.astral.sh/uv/reference/settings/#exclude-dependencies) but I would like to have this limitation waived:
```
In uv lock, uv sync, and uv run, uv will only read exclude-dependencies from the pyproject.toml at the workspace root, and will ignore any declarations in other workspace members or uv.toml files.
```

---

_Renamed from "Make settings from [uv.tool] section defined in pyproject.toml always effective when that pyproject.toml is used in uv CLI commands." to "Make settings from [uv.tool] section defined in pyproject.toml always effective when pyproject.toml is used in uv CLI commands." by @pstrzelczak on 2025-12-19 12:49_

---
