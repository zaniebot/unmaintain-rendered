---
number: 4971
title: "`uv python pin` should find `.python-version` file in a workspace"
type: issue
state: open
author: zanieb
labels: []
assignees: []
created_at: 2024-07-10T17:06:59Z
updated_at: 2024-09-22T23:37:55Z
url: https://github.com/astral-sh/uv/issues/4971
synced_at: 2026-01-07T12:31:14-06:00
---

# `uv python pin` should find `.python-version` file in a workspace

---

_Issue opened by @zanieb on 2024-07-10 17:06_

If working in a child directory of a workspace, `uv python pin` should support finding the `.python-version` file in the workspace root.

Related #4970

---

_Label `good first issue` added by @zanieb on 2024-07-10 17:06_

---

_Label `preview` added by @zanieb on 2024-07-10 17:06_

---

_Comment by @silvanocerza on 2024-07-12 13:43_

I thought of changing [`version_files.rs`](https://github.com/astral-sh/uv/blob/main/crates/uv-python/src/version_files.rs) to use [`Workspace::discovery()`](https://github.com/astral-sh/uv/blob/8d6c49b36c5ac70729274e62fd9f09eb760ed4c0/crates/uv-distribution/src/workspace.rs#L70) internally to find the version files. Though `uv-distribution` can't be added as a dependency of `uv-python` as that would creation a cycle.

Should I instead change all functions in `version_files.rs` to accept a path as argument and search the version files there? Then I would be able to get the `Workspace` in the `pin` command logic and thus the workspace path too so I can pass it to `requests_from_version_file`. Or is there a simpler solution that I'm missing cause of lack of context?

---

_Comment by @zanieb on 2024-07-12 14:18_

Yeah based on that description I'd probably add `requests_from_version_file_in(root: PathBuf)` and keep the workspace discovery over in the `uv` crate.

Thanks for looking into it!

---

_Comment by @j178 on 2024-07-13 07:52_

Should `uv python pin 3.12` also only write to the project root or the workspace root? At present, it writes to the current directory, but this means it won't be picked up by other commands like `uv python install` and `uv venv` unless they're run in that specific directory.

---

_Referenced in [astral-sh/uv#5035](../../astral-sh/uv/pulls/5035.md) on 2024-07-13 09:23_

---

_Comment by @zanieb on 2024-07-13 15:31_

This is a good (and open) question. Do users opt-in to operating on the project or operating on the workspace? When working in the workspace root, we require `--project <name>` to affect a project. When in a project directory, we should probably require `--workspace` to mutate the workspace?

More thoughts at https://github.com/astral-sh/uv/pull/5035#issuecomment-2226960463

---

_Comment by @silvanocerza on 2024-07-13 17:44_

I'm assuming that a workspace can contain more projects, correct me if I'm wrong. Given that I would image this behaviour.

If called in a project subfolder it would pin for the first closest project.
If called in a workspace folder it would pin for the workspace only.
If you want to change this behaviour you'd use the `--project <name>` or `--workspace` options as you propose.
The `--isolate` option ignores all the above and pins in the current working directory as you said in https://github.com/astral-sh/uv/pull/5035#issuecomment-2226960463.

It makes sense in my head but maybe it could be confusing to some? ðŸ¤” 

---

_Referenced in [astral-sh/uv#5592](../../astral-sh/uv/pulls/5592.md) on 2024-07-30 14:17_

---

_Label `preview` removed by @zanieb on 2024-08-20 18:22_

---

_Label `good first issue` removed by @zanieb on 2024-09-22 23:37_

---
