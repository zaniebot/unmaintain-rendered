---
number: 511
title: Allow override of dependencies
type: issue
state: closed
author: zanieb
labels:
  - enhancement
assignees: []
created_at: 2023-11-28T21:47:42Z
updated_at: 2025-03-31T10:09:10Z
url: https://github.com/astral-sh/uv/issues/511
synced_at: 2026-01-07T12:31:14-06:00
---

# Allow override of dependencies

---

_Issue opened by @zanieb on 2023-11-28 21:47_

A user should be able to override the constraints of a package, ignoring transitive requirements that conflict.

This would, for example, allow "force" installation of a certain package version that the user _knows_ works even if a dependency does not allow it.

Related https://github.com/mitsuhiko/rye/issues/505
Discussion at https://discord.com/channels/1039017663004942429/1148719284013510676/1164668058644795453

At its simplest, for a `pip-compile` interface, this could just be another file with package version specifiers e.g. `overrides.txt` that you can pass via an `--overrides` flag. An override for a package would be specified as in `requirements.txt` and `constraints.txt`.

---

_Comment by @charliermarsh on 2023-11-28 21:52_

My intuition is that this isn't too hard to implement (it's very similar to constraints), with the hardest part being... how should it be expressed by the user?

---

_Comment by @konstin on 2023-11-29 09:22_

## Prior Art

Prior art in the JS ecosystem for overrides:
* Resolutions in yarn: https://classic.yarnpkg.com/lang/en/docs/selective-version-resolutions/
* Overrides in pnpm: https://pnpm.io/package_json#pnpmoverrides
* Rust: https://doc.rust-lang.org/cargo/reference/overriding-dependencies.html

Prior art in the JS ecosystem for patched dependencies:
* https://pnpm.io/package_json#pnpmpatcheddependencies
* https://yarnpkg.com/cli/patch

---

_Comment by @konstin on 2023-11-29 09:28_

There are two options we should consider for overrides:
* Resolves this package at this version, ignore all requirements that say otherwise. This is easy to use, but dangerous because it doesn't consider changing requirements in dependencies
* Replace the requirement on `foo==1.2.3` in `bar` with `foo==4.5.6`. With this, you say "While `bar` wants `foo` `1.2.3`, i have confirmed that it is actually compatible with `foo` `4.5.6`, too". It requires more effort on the user side, but is less risky and gives good errors messages when new requirements on `foo` are added outside of `bar`.

I believe both have their users.

Open question: Do we need to support overriding with multiple requirements (for different environments), or is a single requirement per package enough?

---

_Comment by @charliermarsh on 2023-11-29 14:48_

I think the second option is impossible without a more flexible dependency syntax.

---

_Comment by @konstin on 2023-11-29 14:51_

I imagine something like the following for option 1:

```toml
[tool.puffin.overrides-type-1]
foo = "4.5.6"
```

and for option 2:

```toml
[tool.puffin.overrides-type-2]
bar = ["foo==4.5.6"]
```

This would take the set of bar's requirements, remove all with the name `foo` and add `foo==4.5.6`.

---

_Comment by @charliermarsh on 2023-11-29 14:52_

Yeah, I more mean: we can't do that until we have our own `pyproject.toml`-based requirements syntax, whereas (1) we can do with just an `overrides.txt` that uses` requirements.txt`-like syntax.

---

_Label `enhancement` added by @charliermarsh on 2023-11-30 01:54_

---

_Added to milestone `Initial release` by @charliermarsh on 2023-11-30 01:54_

---

_Assigned to @charliermarsh by @charliermarsh on 2023-12-13 03:47_

---

_Comment by @charliermarsh on 2023-12-13 03:52_

Gonna do a pass on this.

---

_Referenced in [astral-sh/uv#631](../../astral-sh/uv/pulls/631.md) on 2023-12-13 05:18_

---

_Closed by @charliermarsh on 2023-12-13 15:03_

---

_Referenced in [astral-sh/uv#2686](../../astral-sh/uv/issues/2686.md) on 2024-03-27 05:07_

---

_Comment by @aidando73 on 2025-03-31 10:05_

Hello all. Thanks for implementing this.

It just came in handy today. I needed a specific pytorch version to leverage special networking hardware for LLM training but one of my packages wanted a different version.

Thanks üôè 

---
