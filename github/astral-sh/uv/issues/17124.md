---
number: 17124
title: "ModuleNotFoundError when running with `uv run`, but works fine with activated virtual environment"
type: issue
state: open
author: Priate-cat
labels:
  - question
assignees: []
created_at: 2025-12-13T13:01:27Z
updated_at: 2025-12-16T10:20:22Z
url: https://github.com/astral-sh/uv/issues/17124
synced_at: 2026-01-07T12:31:16-06:00
---

# ModuleNotFoundError when running with `uv run`, but works fine with activated virtual environment

---

_Issue opened by @Priate-cat on 2025-12-13 13:01_

### Summary

I'm encountering a `ModuleNotFoundError `when executing my script using `uv run`, while the same script runs without issues when I activate the virtual environment and run it directly with `python test.py`.

Environment details:

Python version: 3.10
uv version: uv 0.9.17 (2b5d65e61 2025-12-09)
Dependencies installed via: `uv pip install -r requirements.txt`
Steps to reproduce:

Install dependencies: `uv pip install -r requirements.txt`
Run the script using uv: uv run python test.py → Results in ModuleNotFoundError for one or more modules listed in requirements.txt.
Activate the virtual environment manually and run: python test.py → Script executes successfully with no import errors.
Expected behavior:
uv run python test.py should be able to locate and import all modules installed via uv pip install -r requirements.txt, just as it does when the environment is activated manually.

`requirements.txt`:
```bash
pydantic
python-dotenv
langgraph
langchain-core
langchain-deepseek
langchain-tavily
langsmith
langchain-openai
langchain-text-splitters
langchain-community
faiss-cpu
langgraph_supervisor
graphrag
```

`test.py`:
```bash
from langchain_openai import OpenAIEmbeddings
print("Import successful")
```



### Platform

Windows 11 x86_64

### Version

uv 0.9.17 (2b5d65e61 2025-12-09)

### Python version

Python 3.10

---

_Label `bug` added by @Priate-cat on 2025-12-13 13:01_

---

_Comment by @FishAlchemist on 2025-12-13 14:55_

To facilitate resolution when submitting a BUG, please provide the result with the `--verbose` option enabled.

Regarding this issue, I can reproduce the same result locally, though I cannot guarantee the underlying cause is the same.

The steps to reproduce are as follows:
1. Run `uv venv -p 3.10`
2. Run `uv pip install langchain_openai`
3. Use `uv python pin` to pin a Python version that is incompatible with the virtual environment.
4. Run `uv run test.py`

The reason on my machine is that since `uv run` is a project API, it consults `.python-version`. Consequently, on Windows, because the virtual environment (`.venv`) version did not match the required version, it ignored the virtual environment. It then somehow  to executing with the  managed Python, but since the Python lacked the necessary dependencies, the result was a `ModuleNotFoundError`.

So, the temporary solution is to run `uv python pin 3.10` in your project's root directory. This will prevent `uv` from skipping the `.venv` folder when searching for the virtual environment.

A slightly more cumbersome temporary solution is to explicitly specify using the virtual environment's Python when running `uv run`.

---

_Label `bug` removed by @zanieb on 2025-12-13 15:43_

---

_Label `question` added by @zanieb on 2025-12-13 15:43_

---

_Comment by @zanieb on 2025-12-13 15:43_

Please do share more reproduction details and verbose logs.

---

_Comment by @FishAlchemist on 2025-12-13 16:21_

Let me provide the detailed log of my scenario(https://github.com/astral-sh/uv/issues/17124#issuecomment-3649507720).
command: `uv run --verbose .\test.py`
```
DEBUG uv 0.9.17 (2b5d65e61 2025-12-09)
DEBUG Acquired shared lock for `C:\Users\user\AppData\Local\uv\cache`
DEBUG No project found; searching for Python interpreter
DEBUG Reading Python requests from version file at `C:\Users\user\path_a\.python-version`
DEBUG Using request timeout of 30s
DEBUG Searching for Python 3.12 in virtual environments, managed installations, search path, or registry
DEBUG Found `cpython-3.10.19-windows-x86_64-none` at `C:\Users\user\path_a\.venv\Scripts\python.exe` (virtual environment)
DEBUG Skipping interpreter at `.venv\Scripts\python.exe` from virtual environment: does not satisfy request `3.12`
DEBUG Searching for managed installations at `C:\Users\user\AppData\Roaming\uv\data\python`
WARN Ignoring malformed managed Python entry:
    failed to open file `C:\Users\user\AppData\Roaming\uv\data\python\cpython-3.10.14-windows-x86_64-none\BUILD`: Access denied. (os error 5)
DEBUG Skipping managed installation `cpython-3.14.0-windows-x86_64-none`: does not satisfy `3.12`
DEBUG Skipping managed installation `cpython-3.14.0+freethreaded-windows-x86_64-none`: does not satisfy `3.12`
DEBUG Skipping managed installation `cpython-3.14.0a6-windows-x86_64-none`: does not satisfy `3.12`
DEBUG Skipping managed installation `cpython-3.13.6-windows-x86_64-none`: does not satisfy `3.12`
DEBUG Skipping managed installation `cpython-3.13.1+freethreaded-windows-x86_64-none`: does not satisfy `3.12`
DEBUG Skipping managed installation `cpython-3.13.0-windows-x86_64-none`: does not satisfy `3.12`
DEBUG Found managed installation `cpython-3.12.10-windows-x86_64-none`
DEBUG Found `cpython-3.12.10-windows-x86_64-none` at `C:\Users\user\AppData\Roaming\uv\data\python\cpython-3.12.10-windows-x86_64-none\python.exe` (managed installations)
DEBUG Using Python 3.12.10 interpreter at: C:\Users\user\AppData\Roaming\uv\data\python\cpython-3.12.10-windows-x86_64-none\python.exe
DEBUG Running `python .\test.py`
Traceback (most recent call last):
  File "C:\Users\user\path_a\test.py", line 1, in <module>
    from langchain_openai import OpenAIEmbeddings
ModuleNotFoundError: No module named 'langchain_openai'
DEBUG Command exited with code: 1
DEBUG Released lock at `C:\Users\user\AppData\Local\uv\cache\.lock`
```

---

_Comment by @Priate-cat on 2025-12-16 06:29_

> To facilitate resolution when submitting a BUG, please provide the result with the `--verbose` option enabled.
> 
> Regarding this issue, I can reproduce the same result locally, though I cannot guarantee the underlying cause is the same.
> 
> The steps to reproduce are as follows:
> 
> 1. Run `uv venv -p 3.10`
> 2. Run `uv pip install langchain_openai`
> 3. Use `uv python pin` to pin a Python version that is incompatible with the virtual environment.
> 4. Run `uv run test.py`
> 
> The reason on my machine is that since `uv run` is a project API, it consults `.python-version`. Consequently, on Windows, because the virtual environment (`.venv`) version did not match the required version, it ignored the virtual environment. It then somehow to executing with the managed Python, but since the Python lacked the necessary dependencies, the result was a `ModuleNotFoundError`.
> 
> So, the temporary solution is to run `uv python pin 3.10` in your project's root directory. This will prevent `uv` from skipping the `.venv` folder when searching for the virtual environment.
> 
> A slightly more cumbersome temporary solution is to explicitly specify using the virtual environment's Python when running `uv run`.

Thanks for the quick response and the helpful workaround!
I can confirm I'm seeing the exact same issue as you described—I also reproduced it locally, and `uv python pin 3.10` resolves it cleanly. I also found that running `uv init -p 3.10 --bare` to generate a `pyproject.toml` (which includes the Python version specification) effectively avoids the issue, as it establishes a proper project context and ensures `uv run` uses the existing `.venv`.
Just out of curiosity: is this behavior expected long-term, or might future versions of `uv` improve virtual environment detection even in the absence of `.python-version` or `pyproject.toml`? And would you generally recommend using `uv init` to set up projects rather than starting with `uv venv` directly?
Thanks again!

---

_Comment by @konstin on 2025-12-16 10:20_

For `uv run`, you need to run `uv add -r requirements.txt`. `uv pip` and `uv run` don't mix well: `uv run` is a project-based, managed interface where uv can remove and recreate the venv, it has `pyproject.toml` and `uv.lock`. `requirements.txt` on the other hand is a pip-specific interface, and `uv pip` exist for compatibility with exiting pip workflows. Those pip workflows are rather manual, where you create the venv yourself with `uv venv` and each modification of it is a specific command.

We recommend using using the the project based interface with `uv init`, `uv add`, `uv sync`, `uv run`, etc. Those handle venv creation for you. For migration, uv has the `uv add -r requirements.txt` command that converts `requirements.txt` to the standard `pyproject.toml`.

---
