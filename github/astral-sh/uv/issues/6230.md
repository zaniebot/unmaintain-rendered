---
number: 6230
title: "Respect pyproject.toml defined index-url & keyring-provider in 1st level commands"
type: issue
state: closed
author: Eyal-Shalev
labels:
  - question
assignees: []
created_at: 2024-08-19T20:19:19Z
updated_at: 2024-08-19T20:49:11Z
url: https://github.com/astral-sh/uv/issues/6230
synced_at: 2026-01-07T12:31:14-06:00
---

# Respect pyproject.toml defined index-url & keyring-provider in 1st level commands

---

_Issue opened by @Eyal-Shalev on 2024-08-19 20:19_

1st level commands such as `uv lock`, `uv add` & `uv sync` do not respect the `index-url` & `keyring-provider` parameters as they are defined in `pyproject.toml`


### `pyproject.toml`

```
[build-system]
requires = ["setuptools"]
build-backend = "setuptools.build_meta"

[tool.setuptools_scm]

[tool.uv.pip]
python = "3.12"
index-url = "https://aws@foo-012345678901.d.codeartifact.us-east-1.amazonaws.com/pypi/bar/simple/"
keyring-provider = "subprocess"

[project]
name = "my-project"
version = "0.0.0-dev"
requires-python = "~=3.12.0"
dependencies = [ "my-private-package" ]
```

### Doesn't work
```sh
uv lock --no-cache
```

```
  Ã— No solution found when resolving dependencies for split (python_full_version < '4' and implementation_name == 'pypy'):
  â•°â”€â–¶ Because my-private-package was not found in the package registry and your project depends on my-private-package, we can
      conclude that your project's requirements are unsatisfiable.
      And because your project requires my-project, we can conclude that your projects's requirements are unsatisfiable.
```

### Works
```sh
uv lock --no-cache --index-url="https://aws@foo-012345678901.d.codeartifact.us-east-1.amazonaws.com/pypi/bar/simple/" --keyring-provider="subprocess"
```


### `uv --version`

`uv 0.2.37 (15dfb660a 2024-08-15)`


---

_Comment by @zanieb on 2024-08-19 20:21_

Hey @Eyal-Shalev â€” that's because they're in the `uv.pip` section â€” you'll need to move them to just a `uv` section. See #6225  

---

_Label `question` added by @zanieb on 2024-08-19 20:21_

---

_Comment by @Eyal-Shalev on 2024-08-19 20:49_

Indeed the following works.

@zanieb thank you very very much ðŸ˜„ 

```toml
[build-system]
requires = ["setuptools"]
build-backend = "setuptools.build_meta"

[tool.setuptools_scm]

[tool.uv]
index-url = "https://aws@foo-012345678901.d.codeartifact.us-east-1.amazonaws.com/pypi/bar/simple/"
keyring-provider = "subprocess"

[tool.uv.pip]
python = "3.12"

[project]
name = "my-project"
version = "0.0.0-dev"
requires-python = "~=3.12.0"
dependencies = [ "my-private-package" ]
```

---

_Closed by @Eyal-Shalev on 2024-08-19 20:49_

---
