---
number: 4417
title: Git references are not normalized in lockfile
type: issue
state: closed
author: ibraheemdev
labels:
  - preview
assignees: []
created_at: 2024-06-19T18:18:58Z
updated_at: 2024-07-28T00:42:01Z
url: https://github.com/astral-sh/uv/issues/4417
synced_at: 2026-01-07T12:31:14-06:00
---

# Git references are not normalized in lockfile

---

_Issue opened by @ibraheemdev on 2024-06-19 18:18_

The lockfile currently differentiates between identical Git references depending on how they are declared. For example:

```
[project]
name = "project"
version = "0.1.0"
requires-python = ">=3.12"
dependencies = [
    "uv-public-pypackage @ git+https://github.com/astral-test/uv-public-pypackage@0.0.1"
]
```
```
version = 1
requires-python = ">=3.12"

[[distribution]]
name = "project"
version = "0.1.0"
source = "editable+."
sdist = { path = "." }

[[distribution.dependencies]]
name = "uv-public-pypackage"
version = "0.1.0"
source = "git+https://github.com/astral-test/uv-public-pypackage?rev=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979"

[[distribution]]
name = "uv-public-pypackage"
version = "0.1.0"
source = "git+https://github.com/astral-test/uv-public-pypackage?rev=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979"
sdist = { url = "https://github.com/astral-test/uv-public-pypackage?rev=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979" }
```

Versus:

```
[project]
name = "project"
version = "0.1.0"
requires-python = ">=3.12"
dependencies = [
    "uv-public-pypackage",
]

[tool.uv.sources]
uv-public-pypackage = { git = "https://github.com/astral-test/uv-public-pypackage", tag = "0.0.1" }
```
```diff
version = 1
requires-python = ">=3.12"

[[distribution]]
name = "project"
version = "0.1.0"
source = "editable+."
sdist = { path = "." }

[[distribution.dependencies]]
name = "uv-public-pypackage"
version = "0.1.0"
- source = "git+https://github.com/astral-test/uv-public-pypackage?rev=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979"
+ source = "git+https://github.com/astral-test/uv-public-pypackage?tag=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979"

[[distribution]]
name = "uv-public-pypackage"
version = "0.1.0"
- source = "git+https://github.com/astral-test/uv-public-pypackage?rev=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979"
+ source = "git+https://github.com/astral-test/uv-public-pypackage?tag=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979"
- sdist = { url = "https://github.com/astral-test/uv-public-pypackage?rev=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979" }
+ sdist = { url = "https://github.com/astral-test/uv-public-pypackage?tag=0.0.1#0dacfd662c64cb4ceb16e6cf65a157a8b715b979" }
```

I'm not sure if we can normalize to the revision because the commit pointed to by a tag/branch can change, but we could disambiguate between references before locking.

---

_Label `preview` added by @ibraheemdev on 2024-06-19 18:19_

---

_Referenced in [astral-sh/uv#4406](../../astral-sh/uv/pulls/4406.md) on 2024-06-19 18:19_

---

_Comment by @charliermarsh on 2024-06-24 12:00_

I think it's correct that we write different values here. Is it getting in your way somewhere?

---

_Comment by @ibraheemdev on 2024-07-01 21:59_

Not getting in the way, @konstin pointed it out in https://github.com/astral-sh/uv/pull/4406.

---

_Comment by @charliermarsh on 2024-07-28 00:42_

I think this is as-intended.

---

_Closed by @charliermarsh on 2024-07-28 00:42_

---
