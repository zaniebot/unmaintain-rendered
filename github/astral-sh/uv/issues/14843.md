---
number: 14843
title: "Shadowed `install_name_tool` can break Python installation"
type: issue
state: open
author: zanieb
labels:
  - bug
assignees: []
created_at: 2025-07-23T12:33:24Z
updated_at: 2025-12-01T11:37:36Z
url: https://github.com/astral-sh/uv/issues/14843
synced_at: 2026-01-07T12:31:16-06:00
---

# Shadowed `install_name_tool` can break Python installation

---

_Issue opened by @zanieb on 2025-07-23 12:33_

### Summary

e.g., when shadowed by an x86-64 `install_name_tool` from Conda as described in https://github.com/ankitects/anki/issues/4216, the command fails, but corrupts the binary somehow so subsequent uses fail.

We could do a few things

- Reimplement `install_name_tool` in Rust
- Only use `install_name_tool` from `/usr/bin`
- Scan for an `install_name_tool` that matches the target architecture
- Create a backup copy of the executable and replace atomically on `install_name_tool` failure
- Add binary padding in PBS so we naively replace the target path in the executable

### Platform

macOS

### Version

main

### Python version

_No response_

---

_Label `bug` added by @zanieb on 2025-07-23 12:33_

---

_Referenced in [ankitects/anki#4216](../../ankitects/anki/issues/4216.md) on 2025-07-23 12:33_

---

_Referenced in [astral-sh/uv#14869](../../astral-sh/uv/pulls/14869.md) on 2025-07-24 11:44_

---

_Referenced in [astral-sh/uv#14893](../../astral-sh/uv/issues/14893.md) on 2025-07-25 12:53_

---

_Comment by @geofft on 2025-07-30 18:45_

I'm about 80% of the way to an `install_name_tool` reimplementation in Rust (including re-codesigning) but I probably need to deprioritize the second 80% in favor of other work at the moment. Hopefully can get back to it in the next couple of weeks.

---

_Assigned to @geofft by @geofft on 2025-07-30 18:45_

---

_Comment by @shuaib7860 on 2025-08-30 15:03_

Hi Guys,

Coming over from https://github.com/ankitects/anki/issues/4216, after many hours trying to solve my problem. This issue I believe captures my problem but mine is more about fixing my uv behaviour after a previous anaconda install which was uninstalled. How I go about resolving this, I'm not too sure but would really appreciate some help.

Basically I had an old MacBook with intel architecture which I recently replaced with a new MacBook on arm architecture. I had backed up all my files and transferred over to my new MacBook. So far so good. My old MacBook with the intel architecture had anaconda installed on it which transferred onto my new MacBook including the python install that came with anaconda.

But now I wanted to switch to uv on my new MacBook as I have become increasingly frustrated with anaconda and more accustomed to tools like uv. So I uninstalled my anaconda installation and deleted all the binaries and installed uv. But whenever I am outside of the default python environment in the terminal and try to create another venv, or if I run the uv run python command I am still running into the error:

```
Failed to patch the install name of the dynamic library for /Users/choudhryshuaib/.local/share/uv/python/cpython-3.9.23-macos-aarch64-none/bin/python3.9. This may cause issues when building Python native extensions.
error: Querying Python at `/Users/choudhryshuaib/.local/share/uv/python/cpython-3.9.23-macos-aarch64-none/bin/python3.9` failed with exit status signal: 9 (SIGKILL).
```

I amended the .bashrc and .zshrc files but to no avail. Additionally, whenever I run python in the terminal I get zsh: killed python. But if I run python3 in the terminal, it works.

What is the best way to fix this? After spending a couple of days on this, my only thought is just to reboot my Mac from a fresh install and only back up essential files I want to keep. Do let me know if I'm missing anything obvious about how to resolve this as I can't get uv working at all. 

---

_Comment by @geofft on 2025-09-02 18:30_

@shuaib7860 What is the output of `where install_name_tool`? I'm guessing that either
* you still have a version from conda that hasn't been removed
* you have an old, Intel version of Xcode's Developer Tools, and you should update your Xcode/Developer Tools to the latest version

---

_Comment by @shuaib7860 on 2025-09-02 18:50_

Just ran `where install_name_tool`. The output I got was `/usr/bin/install_name_tool`.

Should I uninstall Xcode's developer tools and then make sure I install the arm version? 


---

_Comment by @geofft on 2025-09-02 19:28_

I think that's worth trying!

---

_Comment by @shuaib7860 on 2025-09-02 19:43_

@geofft You're a legend. That did the trick. Many thanks. 

---

_Comment by @konstin on 2025-12-01 11:37_

<img width="1081" height="434" alt="Image" src="https://github.com/user-attachments/assets/546a374d-273c-4f7c-9494-fe0d355c0856" />

On a fresh macOS VM, the installation passes with a warning while simultaneously spawning the dev tools install dialog, I assume this will also be fixed by the reimplementation.

---
