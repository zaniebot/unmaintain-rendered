---
number: 15477
title: "New check: variable defined away from use"
type: issue
state: open
author: nickdrozd
labels:
  - rule
  - needs-decision
assignees: []
created_at: 2025-01-14T19:10:54Z
updated_at: 2025-01-29T18:17:13Z
url: https://github.com/astral-sh/ruff/issues/15477
synced_at: 2026-01-07T12:31:13-06:00
---

# New check: variable defined away from use

---

_Issue opened by @nickdrozd on 2025-01-14 19:10_

Sometimes a variable is defined away from its first use. If an early return comes between the definition and the use, then the definition is wasteful.

For example, this:

```python
def f():
    val = get_val()

    if condition():
        return

    do_something(val)
```

Should be changed to this:

```python
def f():
    if condition():
        return

    val = get_val()

    do_something(val)
```

Also applies to continues, etc:

```python
def f():
   for item in get_list():
       val = get_val(item)

       if condition(item):
           continue

       do_something(val)
```

Might be autofixable, but definitely unsafe.

---

_Label `rule` added by @dylwil3 on 2025-01-14 19:53_

---

_Label `needs-design` added by @dylwil3 on 2025-01-14 19:53_

---

_Label `needs-design` removed by @dylwil3 on 2025-01-14 19:54_

---

_Label `needs-decision` added by @dylwil3 on 2025-01-14 19:54_

---

_Comment by @dylwil3 on 2025-01-14 19:55_

This is an interesting idea for a rule! it will probably require better control flow analysis than is currently available, so it may have to wait a bit.

---

_Comment by @MichaReiser on 2025-01-14 20:16_

The other challenge that I see is that it has to know if the called method has any side effects or moving it isn't safe.

---

_Comment by @nickdrozd on 2025-01-15 15:13_

Could put check behind new flag `--experimental` or `--aggressive`, something like that. Some kind of extra opt-in.

I would be interested to see the results of this run against primer or whatever. I think this problem might turn out to be pretty common. False positives due to side effects would also interesting to see.

---

_Comment by @nickdrozd on 2025-01-29 18:17_

Somewhat related to https://github.com/astral-sh/ruff/issues/10108.

---
