---
number: 6841
title: "formatter bug: f-strings with triple quotes"
type: issue
state: closed
author: davidszotten
labels:
  - bug
  - formatter
assignees: []
created_at: 2023-08-24T06:57:18Z
updated_at: 2023-10-11T11:30:37Z
url: https://github.com/astral-sh/ruff/issues/6841
synced_at: 2026-01-07T12:31:12-06:00
---

# formatter bug: f-strings with triple quotes

---

_Issue opened by @davidszotten on 2023-08-24 06:57_

the formatter is too conservative when making sure it doesn't try to escape quotes inside formatted values, and doesn't take into account triple quotes

input: `f''' {""} '''`
output: `f''' {""} '''`
expected: `f""" {""} """`


i expect https://github.com/astral-sh/ruff/blob/7e9023b6f85c28bcfdc7fe82a507d7752e84edcf/crates/ruff_python_formatter/src/expression/string.rs#L36-L42 needs to be more sophisticated

---

_Label `bug` added by @MichaReiser on 2023-08-24 07:19_

---

_Label `formatter` added by @MichaReiser on 2023-08-24 07:19_

---

_Added to milestone `Formatter: Beta` by @MichaReiser on 2023-08-24 07:19_

---

_Assigned to @konstin by @konstin on 2023-09-12 07:48_

---

_Comment by @davidszotten on 2023-09-16 07:32_

it's been a while now (blocked on https://github.com/astral-sh/ruff/pull/6365 for a few weeks)
but iirc i made this slightly better in my "proper f-string formatting" poc https://github.com/davidszotten/ruff/pull/1/files#diff-9ae227f70699315433485961eb6bbeb9a45487857fbfebe473e926e71bc194f5R46

---

_Referenced in [astral-sh/ruff#7826](../../astral-sh/ruff/pulls/7826.md) on 2023-10-05 13:16_

---

_Closed by @konstin on 2023-10-11 11:30_

---
