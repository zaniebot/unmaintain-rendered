---
number: 9454
title: Also check comprehensions with B007
type: issue
state: open
author: hoxbro
labels:
  - rule
assignees: []
created_at: 2024-01-10T09:15:40Z
updated_at: 2024-01-11T09:00:46Z
url: https://github.com/astral-sh/ruff/issues/9454
synced_at: 2026-01-07T12:31:13-06:00
---

# Also check comprehensions with B007

---

_Issue opened by @hoxbro on 2024-01-10 09:15_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

[B007](https://docs.astral.sh/ruff/rules/unused-loop-control-variable/) (unused-loop-control-variable) right now only checks a normal for loops. I think this could be expanded so it also checks the different kinds of comprehension.

Example of code that should be safe to fix with `y` â†’ `_y` (correct me if I'm wrong):
``` python
(x for x, y in zip(xs, ys))
[x for x, y in zip(xs, ys)]
{x for x, y in zip(xs, ys)}
{x: x for x, y in zip(xs, ys)}
{x: "value" for x, y in zip(xs, ys)}
{"key": x for x, y in zip(xs, ys)}
```

No unused-variables examples
``` python
(x for x, y in zip(xs, ys) if y == 1)
[x for x, y in zip(xs, ys) if y == 1]
{x for x, y in zip(xs, ys) if y == 1}
{x: x for x, y in zip(xs, ys) if y == 1}
(x if y == 1 else 0 for x, y in zip(xs, ys))
[x if y == 1 else 0 for x, y in zip(xs, ys)]
{x if y == 1 else 0 for x, y in zip(xs, ys)}
{x: x if y == 1 else 0 for x, y in zip(xs, ys)}
```

Edge case of an unused variable which cannot be renamed:
``` python
(_y for _y, y in zip(xs, ys) if _y == 1)
```



---

_Comment by @zanieb on 2024-01-11 00:45_

In all those cases wouldn't we want to suggest _not_ zipping the variables together in the first place? If those are just trivial examples for iteration over some collection of tuples, I think I agree it'd make sense to suggest marking it as a `unused-loop-control-variable` although we may want a separate rule like `unused-comprehension-variable`?

---

_Label `rule` added by @zanieb on 2024-01-11 00:45_

---

_Comment by @hoxbro on 2024-01-11 09:00_

> If those are just trivial examples for iteration over some collection of tuples

They were meant as trivial examples. 

My example just did what B007 does for zip in a for loop ([playground](https://play.ruff.rs/7ef36098-459d-44f9-82f8-e63249be676f)). I agree; it would be much better to remove the zip in this case. 



---

_Referenced in [astral-sh/ruff#14113](../../astral-sh/ruff/issues/14113.md) on 2024-11-05 17:24_

---
