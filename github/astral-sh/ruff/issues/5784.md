---
number: 5784
title: "Getting \"error: Failed to converge after 100 iterations\", rule I002, required-imports with syntax from ... import ... as ..."
type: issue
state: closed
author: guillaumeLepape
labels:
  - bug
  - isort
assignees: []
created_at: 2023-07-15T18:56:51Z
updated_at: 2023-07-15T19:53:40Z
url: https://github.com/astral-sh/ruff/issues/5784
synced_at: 2026-01-07T12:31:12-06:00
---

# Getting "error: Failed to converge after 100 iterations", rule I002, required-imports with syntax from ... import ... as ...

---

_Issue opened by @guillaumeLepape on 2023-07-15 18:56_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->

Hello,

When I'm trying to autofix a I002 error with `required-imports = ["from __future__ import annotations as _annotations"]`, I'm getting an error which I believe is a bug.

To reproduce the isssue, I create the following files

### pyproject.toml
```toml
[tool.ruff]
select = ["I"]
fix = true

[tool.ruff.isort]
required-imports = ["from __future__ import annotations as _annotations"]

```
### main.py
```
x = 1

print(x)
```

If I run `ruff main.py` for the first time, I got 
```log

error: Failed to converge after 100 iterations.

This indicates a bug in `ruff`. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BInfinite%20loop%5D

...quoting the contents of `main.py`, the rule codes I002, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

main.py:1:1: I002 Missing required import: `from __future__ import annotations`
Found 101 errors (100 fixed, 1 remaining).
```
and ruff adds `from __future__ import annotations` at the beginning of the file. If I reruns it, I got the same error and no changes to the python file.



---

_Comment by @guillaumeLepape on 2023-07-15 19:00_

I did a bit of exploration in the code, seems kind easy to fix, I will raise a pr soon.

---

_Comment by @charliermarsh on 2023-07-15 19:36_

Sounds good, PR welcome.

---

_Comment by @guillaumeLepape on 2023-07-15 19:46_

https://github.com/astral-sh/ruff/pull/5786, please review.

---

_Label `bug` added by @charliermarsh on 2023-07-15 19:53_

---

_Label `isort` added by @charliermarsh on 2023-07-15 19:53_

---

_Comment by @charliermarsh on 2023-07-15 19:53_

Closed by https://github.com/astral-sh/ruff/pull/5786.

---

_Closed by @charliermarsh on 2023-07-15 19:53_

---
