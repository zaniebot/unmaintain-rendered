---
number: 4843
title: "UP007: autofix does not work for some examples"
type: issue
state: open
author: saippuakauppias
labels:
  - fixes
  - needs-decision
assignees: []
created_at: 2023-06-03T22:15:55Z
updated_at: 2024-04-12T12:12:26Z
url: https://github.com/astral-sh/ruff/issues/4843
synced_at: 2026-01-07T12:31:12-06:00
---

# UP007: autofix does not work for some examples

---

_Issue opened by @saippuakauppias on 2023-06-03 22:15_

Example:
```python
from typing import Any, Dict, Optional, Type, Union


# 1
DataType = Optional[Dict[str, Any]]


# 2
class StatusedModel:
    ACTIVE: str = 'active'
    BLOCKED: str = 'blocked'
    DELETED: str = 'deleted'


StatusType = Union[StatusedModel.ACTIVE, StatusedModel.BLOCKED, StatusedModel.DELETED]


# 3
BALANCE_ZERO = 'zero'
BALANCE_LOW = 'low'
ModeType = Union[BALANCE_LOW, BALANCE_ZERO]


# 4
Numeric = Union[int, float, str]


# 5
IdType = Union[int, Type[int]]
```

Run output:
```shell
$ ruff --fix --select UP007 ruff_errors/UP007.py
ruff_errors/UP007.py:5:12: UP007 Use `X | Y` for type annotations
ruff_errors/UP007.py:15:14: UP007 Use `X | Y` for type annotations
ruff_errors/UP007.py:21:12: UP007 Use `X | Y` for type annotations
ruff_errors/UP007.py:25:11: UP007 Use `X | Y` for type annotations
ruff_errors/UP007.py:29:10: UP007 Use `X | Y` for type annotations
Found 5 errors.
```

---

_Comment by @charliermarsh on 2023-06-03 23:07_

These are intentional, right now we don't autofix UP007 errors that are used outside of annotations (e.g., on the right-hand side of an assignment). (`pyupgrade` doesn't either.)

Its caused some subtle bugs in the past: https://github.com/charliermarsh/ruff/issues/3215, https://github.com/charliermarsh/ruff/issues/2981. It was also discussed here: https://github.com/charliermarsh/ruff/issues/4108.

It's possible that it's actually fine to fix these, with the exception that we can't rewrite `Union[new_types]` to `new_types`. I'm not certain.


---

_Label `question` added by @charliermarsh on 2023-06-03 23:07_

---

_Label `autofix` added by @charliermarsh on 2023-06-03 23:07_

---

_Referenced in [astral-sh/ruff#4831](../../astral-sh/ruff/pulls/4831.md) on 2023-06-05 13:51_

---

_Label `question` removed by @charliermarsh on 2023-07-10 01:12_

---

_Label `needs-decision` added by @charliermarsh on 2023-07-10 01:12_

---

_Referenced in [TheAlgorithms/Python#8868](../../TheAlgorithms/Python/pulls/8868.md) on 2023-07-29 12:41_

---

_Referenced in [astral-sh/ruff#8698](../../astral-sh/ruff/issues/8698.md) on 2023-11-15 17:36_

---

_Referenced in [tefra/xsdata#894](../../tefra/xsdata/issues/894.md) on 2023-12-26 07:44_

---

_Assigned to @AlexWaygood by @AlexWaygood on 2024-02-26 18:01_

---

_Unassigned @AlexWaygood by @AlexWaygood on 2024-03-01 16:33_

---

_Comment by @Hnasar on 2024-04-12 12:12_

It would be very helpful to autofix the PEP604 `|` unions, but have it gated behind an unsafe fix.
I'm using `--add-noqa` as a workaround for now.

---
