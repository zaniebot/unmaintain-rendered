---
number: 7675
title: Rule N806 and Django
type: issue
state: closed
author: aqeelat
labels:
  - rule
  - accepted
assignees: []
created_at: 2023-09-27T11:27:24Z
updated_at: 2023-12-09T03:52:02Z
url: https://github.com/astral-sh/ruff/issues/7675
synced_at: 2026-01-07T12:31:12-06:00
---

# Rule N806 and Django

---

_Issue opened by @aqeelat on 2023-09-27 11:27_

In django, you can access a model by importing it or by getting it from the registry (i.e. calling apps.get_model). The convention is to name the variable in title case to match the model's name.
Example from the docs: https://docs.djangoproject.com/en/4.2/ref/applications/#django.apps.AppConfig.ready

However, this clashes with rule N806.

Is there a way to make this work?

---

_Comment by @aqeelat on 2023-09-27 11:32_

I think this could a setting for N806 that allows`(\w*) = .*\.get_model\(.*,"(\w*)"\)` if $1 and $2 match.

---

_Comment by @charliermarsh on 2023-09-29 01:26_

I'm open to supporting this, although I think it should just be enabled and not behind a setting. I think we need to support both `apps.get_model("core", "Activation")` and (e.g.) the `MyModel = self.get_model("MyModel")` form.

---

_Label `rule` added by @charliermarsh on 2023-09-29 01:26_

---

_Label `accepted` added by @charliermarsh on 2023-09-29 01:26_

---

_Comment by @93578237 on 2023-10-04 15:51_

Also [`import_string`](https://docs.djangoproject.com/en/4.2/ref/utils/#django.utils.module_loading.import_string)

---

_Assigned to @charliermarsh by @charliermarsh on 2023-11-30 01:01_

---

_Referenced in [astral-sh/ruff#8917](../../astral-sh/ruff/pulls/8917.md) on 2023-11-30 01:29_

---

_Closed by @charliermarsh on 2023-11-30 01:43_

---

_Comment by @tylerlaprade on 2023-12-09 03:12_

This fix is great! We had previously turned this rule off in our `migrations/` folder for exactly this reason. However, if we remove that override, we have a few cases where we need to dynamically set the model, so `$1` and `$2` don't match:

<img width="633" alt="image" src="https://github.com/astral-sh/ruff/assets/5475199/6d44afbf-f86d-43a1-bb5c-de641654f131">

<img width="740" alt="image" src="https://github.com/astral-sh/ruff/assets/5475199/74c510f4-688a-4f1d-9dec-309637fe2750">

<img width="1019" alt="image" src="https://github.com/astral-sh/ruff/assets/5475199/fc056ecd-4dd1-42e0-a2ac-6dcad5863936">

---

_Comment by @charliermarsh on 2023-12-09 03:18_

I suppose we could extend this to allow any `apps.get_model`-like assignments, and not limit it to matches on the left- and right-hand side...

---

_Comment by @tylerlaprade on 2023-12-09 03:35_

After going through and renaming our violations, I don't feel as strongly that the rule should change. Perhaps the restriction should only be relaxed when the right-hand side is a variable? I know this would still cause my third screenshot to be broken, but I think there's more value in ensuring you didn't typo your model name than there is in allowing this one-off rare case.

---

_Referenced in [astral-sh/ruff#9065](../../astral-sh/ruff/pulls/9065.md) on 2023-12-09 03:51_

---

_Comment by @charliermarsh on 2023-12-09 03:52_

That seems reasonable to me. I added it in: https://github.com/astral-sh/ruff/pull/9065.

---
