---
number: 7025
title: "UP037: autofix removes quotes from Literal[\"value\"] typing when not imported"
type: issue
state: open
author: Prometheos2
labels:
  - needs-decision
assignees: []
created_at: 2023-08-31T15:36:50Z
updated_at: 2023-11-03T03:15:24Z
url: https://github.com/astral-sh/ruff/issues/7025
synced_at: 2026-01-07T12:31:12-06:00
---

# UP037: autofix removes quotes from Literal["value"] typing when not imported

---

_Issue opened by @Prometheos2 on 2023-08-31 15:36_

UP037's autofix removes quotes from typing.Literal["value"] when Literal is not imported, but it's supposed to have str values.

```python
_DTYPE_BACKEND: Literal["pyarrow", "numpy_nullable"]
``` 
turns into 
```python
_DTYPE_BACKEND: Literal[pyarrow, numpy_nullable]
```

## Details
* **Version:** 0.0.286
* **Relevant settings:** `select = ["UP"]`
* **Commands producing the bug:**
	* the VSC extension's autofix
	* `ruff . --fix`
	* `ruff . --fix --isolated --select UP`


---

_Comment by @charliermarsh on 2023-08-31 15:39_

Is it a mistake or intentional that `Literal` is not imported?

---

_Label `waiting-on-author` added by @charliermarsh on 2023-08-31 15:41_

---

_Comment by @Prometheos2 on 2023-08-31 16:24_

It was a mistake.

(Admittedly, it was a bit of both. I was trying out Ruff's autofix on save on VSC.)




---

_Comment by @zanieb on 2023-08-31 18:43_

The problem here is that we cannot identify `Literal` as `typing.Literal` if it's not imported. We could add an exception for this to avoid false positives but it could introduce false negatives. Perhaps we can just avoid applying this fix (or reduce the applicability) if there's not a binding for the name of the subscript?

---

_Comment by @charliermarsh on 2023-08-31 20:38_

Yeah this is largely "working as intended" in that if we can't resolve a symbol to `typing.Literal`, then we treat values within subscripts in type annotations as type annotations themselves (`typing.Literal` is an exception).

I suppose we could change the logic to avoid treating values within subscripts as annotations if the subscript itself is unbound, although it would do the wrong thing if the user has any wildcard imports.

---

_Label `waiting-on-author` removed by @charliermarsh on 2023-08-31 20:38_

---

_Label `needs-decision` added by @charliermarsh on 2023-08-31 20:38_

---

_Comment by @zanieb on 2023-09-01 02:05_

Perhaps we can downgrade from automatic to suggested fix if it's unbound. The wildcard imports are a good example, but hopefully not too common in this case?

---

_Referenced in [astral-sh/ruff#7769](../../astral-sh/ruff/pulls/7769.md) on 2023-10-03 17:37_

---

_Comment by @zanieb on 2023-10-06 15:38_

I'm not sure how to implement this with the way that we visit type definitions â€” do you have a suggestion @charliermarsh ?

---

_Comment by @charliermarsh on 2023-11-03 03:15_

@zanieb - What if we just treat "Literal" as `typing.Literal` if the symbol is unresolved...?

---
