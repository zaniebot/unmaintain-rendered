---
number: 7465
title: "Formatter instability: Leading clause header comments with preceding function"
type: issue
state: closed
author: MichaReiser
labels:
  - bug
  - formatter
assignees: []
created_at: 2023-09-17T15:15:16Z
updated_at: 2023-09-21T13:32:19Z
url: https://github.com/astral-sh/ruff/issues/7465
synced_at: 2026-01-07T12:31:12-06:00
---

# Formatter instability: Leading clause header comments with preceding function

---

_Issue opened by @MichaReiser on 2023-09-17 15:15_

## Input

```python
try:
    def test():
        pass
    #import chardet.constants
    #chardet.constants._debug = 1
except ImportError:
    pass
```

## Format 1
```python
try:

    def test():
        pass

    # import chardet.constants
    # chardet.constants._debug = 1
except ImportError:
    pass
```

## Format 2

```python
try:

    def test():
        pass

    # import chardet.constants
    # chardet.constants._debug = 1

except ImportError:
    pass

```

Sourced by #7455 

---

_Label `bug` added by @MichaReiser on 2023-09-17 15:15_

---

_Label `formatter` added by @MichaReiser on 2023-09-17 15:15_

---

_Added to milestone `Formatter: Beta` by @MichaReiser on 2023-09-17 15:15_

---

_Assigned to @charliermarsh by @charliermarsh on 2023-09-20 21:20_

---

_Comment by @charliermarsh on 2023-09-20 22:04_

Think I figured this one out, and also identified a related deviation.

---

_Referenced in [astral-sh/ruff#7556](../../astral-sh/ruff/pulls/7556.md) on 2023-09-20 23:40_

---

_Closed by @charliermarsh on 2023-09-21 13:32_

---
