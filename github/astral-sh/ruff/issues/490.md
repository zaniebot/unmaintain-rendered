---
number: 490
title: "Importing a function called `cast` leads to confusing F722 and F821 errors"
type: issue
state: closed
author: tgross35
labels:
  - bug
assignees: []
created_at: 2022-10-27T17:21:11Z
updated_at: 2022-11-01T20:47:57Z
url: https://github.com/astral-sh/ruff/issues/490
synced_at: 2026-01-07T12:31:12-06:00
---

# Importing a function called `cast` leads to confusing F722 and F821 errors

---

_Issue opened by @tgross35 on 2022-10-27 17:21_

Using a function named `cast` (shadows a newish builtin) leads to somewhat confusing errors. For the test file:

```python
from something import cast
# same with `def cast(s): pass`

abc = "123"
cast(f"tuv {abc} xyz")
```

We get the following unexpected results:

```
$ ruff tmp.py 
Found 2 error(s).
tmp.py:5:6: F722 Syntax error in forward annotation: ` xyz`
tmp.py:5:6: F821 Undefined name `tuv`
```

I'm not quite sure what the best resolution is, maybe a warning on imports/defs that shadow `cast`?

---

_Comment by @charliermarsh on 2022-10-27 17:27_

Ah yeah, it's assuming that `cast` is `typing.cast`. There's a TODO to ensure that we only treat those functions as `typing` features if they're _actually_ imported from typing. (It's hard to do this 100% reliably without actually executing code, but even a basic check would be helpful here.)

I could try to work on that soon. In the interim, maybe you could alias your function? Like `from something import cast as scast`.


---

_Comment by @charliermarsh on 2022-10-27 17:28_

(You'll run into this same problem for things like `NewType`, etc.)

---

_Comment by @tgross35 on 2022-10-27 17:46_

No need to work on it any time soon, there are more important things! Aliasing is very workable

---

_Label `bug` added by @charliermarsh on 2022-10-29 22:53_

---

_Comment by @cpcloud on 2022-11-01 16:07_

This would be a blocker for using `ruff` with [`ibis`](https://github.com/ibis-project/ibis).

We have [many calls to our `cast` method](https://github.com/ibis-project/ibis/search?q=%22.cast%22) in the codebase.

---

_Comment by @charliermarsh on 2022-11-01 16:09_

Ok cool, that's really helpful to hear, will fix this soon!

---

_Assigned to @charliermarsh by @charliermarsh on 2022-11-01 17:16_

---

_Referenced in [astral-sh/ruff#533](../../astral-sh/ruff/pulls/533.md) on 2022-11-01 18:00_

---

_Closed by @charliermarsh on 2022-11-01 18:02_

---

_Referenced in [astral-sh/ruff#534](../../astral-sh/ruff/pulls/534.md) on 2022-11-01 20:36_

---

_Comment by @charliermarsh on 2022-11-01 20:39_

This is going out in https://github.com/charliermarsh/ruff/releases/tag/v0.0.94 (building now). I tested it on `ibis`.

---

_Comment by @tgross35 on 2022-11-01 20:47_

Charlie, you are too amazing. I don’t know how you manage such a fast turnaround on this project’s issues

---
