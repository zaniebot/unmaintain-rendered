---
number: 10752
title: Refactor precedence parsing for the new parser
type: issue
state: closed
author: dhruvmanila
labels:
  - internal
  - parser
assignees: []
created_at: 2024-04-03T09:15:53Z
updated_at: 2024-04-23T04:55:04Z
url: https://github.com/astral-sh/ruff/issues/10752
synced_at: 2026-01-07T12:31:13-06:00
---

# Refactor precedence parsing for the new parser

---

_Issue opened by @dhruvmanila on 2024-04-03 09:15_

As suggested:
- [x] Compare expressions: https://github.com/astral-sh/ruff/pull/10730#discussion_r1547594779
- [x] Unary expressions: https://github.com/astral-sh/ruff/pull/10726#discussion_r154789344(https://github.com/astral-sh/ruff/pull/10726#discussion_r1547893446)
- [x] Boolean expressions: https://github.com/astral-sh/ruff/pull/10727#discussion_r1547623778
- [x] Binary expressions: https://github.com/astral-sh/ruff/pull/10731#discussion_r1547851504


---

_Label `internal` added by @dhruvmanila on 2024-04-03 09:15_

---

_Label `parser` added by @dhruvmanila on 2024-04-03 09:15_

---

_Assigned to @dhruvmanila by @dhruvmanila on 2024-04-03 10:02_

---

_Referenced in [astral-sh/ruff#11065](../../astral-sh/ruff/pulls/11065.md) on 2024-04-21 05:52_

---

_Referenced in [astral-sh/ruff#11066](../../astral-sh/ruff/pulls/11066.md) on 2024-04-21 06:03_

---

_Referenced in [astral-sh/ruff#11068](../../astral-sh/ruff/pulls/11068.md) on 2024-04-21 07:12_

---

_Referenced in [astral-sh/ruff#11069](../../astral-sh/ruff/pulls/11069.md) on 2024-04-21 07:17_

---

_Comment by @dhruvmanila on 2024-04-21 10:27_

I'll probably scratch the PRs as I've a better idea. Something like
```rs
enum OperatorType {
    Boolean(BoolOp),
    Comparison(CmpOp),
    Binary(Operator),
}

impl OperatorType {
    fn try_from_tokens(tokens: [TokenKind; 2]) -> Option<OperatorType> {}
    fn precedence(&self) -> OperatorPrecedence {}
}
```

---

_Referenced in [astral-sh/ruff#11073](../../astral-sh/ruff/pulls/11073.md) on 2024-04-21 16:03_

---

_Referenced in [astral-sh/ruff#11088](../../astral-sh/ruff/pulls/11088.md) on 2024-04-22 07:03_

---

_Closed by @dhruvmanila on 2024-04-23 04:55_

---
