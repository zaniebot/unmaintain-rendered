---
number: 22315
title: ANN201 Incorrect autofix return type for raise in loop
type: issue
state: open
author: spaceby
labels:
  - bug
assignees: []
created_at: 2025-12-31T10:47:23Z
updated_at: 2025-12-31T15:27:29Z
url: https://github.com/astral-sh/ruff/issues/22315
synced_at: 2026-01-07T12:31:14-06:00
---

# ANN201 Incorrect autofix return type for raise in loop

---

_Issue opened by @spaceby on 2025-12-31 10:47_

### Summary

https://play.ruff.rs/f2c7c8a3-1e38-425f-b1e5-0068e6f8b67b

```python
class Test:
    items_list = []

    def method(self):
        for item in self.items_list:
            raise Exception(item)


t = Test()
t.method()
```

This code returns None.
However, autofix substitutes in method NoReturn

```python
from typing import NoReturn
class Test:
    items_list = []

    def method(self) -> NoReturn:
        for item in self.items_list:
            raise Exception(item)


t = Test()
t.method()
```

### Version

0.14.10

---

_Renamed from "ANN201 Incorrect autofix" to "ANN201 Incorrect autofix return type for raise in loop" by @spaceby on 2025-12-31 10:49_

---

_Comment by @ntBre on 2025-12-31 15:27_

Thanks for the report!

This is related to the same code Micha mentions in https://github.com/astral-sh/ruff/issues/15975#issuecomment-2639121847. It looks like we treat loops as always being entered.

We do hope to have more general control-flow analysis at some point (https://github.com/astral-sh/ruff/issues/17065), but maybe there's something we can improve here in the meantime.

---

_Label `bug` added by @ntBre on 2025-12-31 15:27_

---
