---
number: 9998
title: "B006 --fix --unsafe-fixes does not fix type to become Optional ( | None) (fails type check)"
type: issue
state: open
author: ehiggs
labels:
  - bug
assignees: []
created_at: 2024-02-15T12:44:44Z
updated_at: 2024-02-16T06:46:49Z
url: https://github.com/astral-sh/ruff/issues/9998
synced_at: 2026-01-07T12:31:13-06:00
---

# B006 --fix --unsafe-fixes does not fix type to become Optional ( | None) (fails type check)

---

_Issue opened by @ehiggs on 2024-02-15 12:44_

Given the following file:

```python
def squares(x: list[int] = []) -> list[int]:
  return [i*i for i in x]
```
```
❯ ruff lint --select B006 ./b006.py
warning: Failed to lint lint: No such file or directory (os error 2)
b006.py:1:28: B006 Do not use mutable data structures for argument defaults
Found 1 error.
No fixes available (1 hidden fix can be enabled with the `--unsafe-fixes` option).
```

Let's fix it:

```
❯ ruff lint --select B006 --fix --unsafe-fixes ./b006.py
warning: Failed to lint lint: No such file or directory (os error 2)
Found 1 error (1 fixed, 0 remaining).
```

```python
def squares(x: list[int] = None) -> list[int]:
  if x is None:
    x = []
  return [i*i for i in x]
```

This code does not pass type check:

```
❯ mypy b006.py
b006.py:1: error: Incompatible default for argument "x" (default has type "None", argument has type "list[int]")  [assignment]
b006.py:1: note: PEP 484 prohibits implicit Optional. Accordingly, mypy has changed its default to no_implicit_optional=True
b006.py:1: note: Use https://github.com/hauntsaninja/no_implicit_optional to automatically upgrade your codebase
Found 1 error in 1 file (checked 1 source file)
```
<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->


---

_Renamed from "B006 --unsafe-fix does not fix type to become Optional ( | None) (fails type check)" to "B006 --fix --unsafe-fixes does not fix type to become Optional ( | None) (fails type check)" by @ehiggs on 2024-02-15 12:46_

---

_Label `bug` added by @charliermarsh on 2024-02-16 03:31_

---

_Comment by @charliermarsh on 2024-02-16 03:32_

We actually have a separate rule that can catch and fix this: [`implicit-optional`](https://docs.astral.sh/ruff/rules/implicit-optional/). But it would be nice if `B006` worked independently.

---

_Comment by @dhruvmanila on 2024-02-16 06:46_

Yeah, using `--select=B006,RUF013` should fix this although I agree that our fix infrastructure should be modular enough to be reused by other rules when relevant.

---
