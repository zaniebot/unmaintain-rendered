---
number: 12279
title: "`ruff server` QOL improvement: Make code action ordering more consistent"
type: issue
state: closed
author: ravibrock
labels:
  - question
  - server
assignees: []
created_at: 2024-07-10T16:25:00Z
updated_at: 2025-01-07T05:17:37Z
url: https://github.com/astral-sh/ruff/issues/12279
synced_at: 2026-01-07T12:31:13-06:00
---

# `ruff server` QOL improvement: Make code action ordering more consistent

---

_Issue opened by @ravibrock on 2024-07-10 16:25_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* List of keywords you searched for before creating this issue. Write them down here so that others can find this issue more easily and help provide feedback.
  e.g. "RUF001", "unused variable", "Jupyter notebook"
* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->
Hello,

I wanted to suggest that code action ordering be kept consistent. For example, in Neovim I have `<leader>ca` bound to toggling code actions, so it would be helpful if `<leader>ca 2` always selected "Organize imports":

*On line with no diagnostics:*
![Screenshot 2024-07-10 at 11 22 44](https://github.com/astral-sh/ruff/assets/66334356/a8ab6c5b-c548-4fd2-96df-667a5b9d2ece)
*On line with diagnostics:*
![Screenshot 2024-07-10 at 11 23 12](https://github.com/astral-sh/ruff/assets/66334356/2710174c-588c-4b1a-8530-ae5537c4b5ac)

Ideally, `1` and `2` would select the same thing in both cases since those options are always available.

Thank you!


---

_Comment by @dhruvmanila on 2024-07-11 04:43_

Thank you for the suggestion! For discussion around the current ordering, refer to https://github.com/astral-sh/ruff-lsp/issues/210.

The code actions that you've mentioned are the source level code actions i.e., they apply to an entire file. Currently, Ruff always provide the said code actions even if they're no-op but that could change in the future (https://github.com/astral-sh/ruff-lsp/issues/91). For example, the `Ruff: Organize imports` action won't be provided if there are no imports to organize.

I would instead suggest to use a keybinding if you always need to execute a specific source code action. For example, the following will apply the `Ruff: Organize imports` code actions:
```lua
local function ruff_organize_imports()
	vim.lsp.buf.code_action {
	  context = {
	    only = { 'source.organizeImports.ruff' },
	  },
	  apply = true,
	}
end

vim.keymap.set('n', '<leader>oi', ruff_organize_imports, {
	desc = 'ruff: [o]rganize [i]mports'
})
```

Does this help?

---

_Label `question` added by @dhruvmanila on 2024-07-11 04:43_

---

_Comment by @ravibrock on 2024-07-11 05:03_

Ah, that looks good thank you! I might even modify that for use as a `BufWritePre` autocommand so I don't have to worry about organizing them by hand. And yeah, I see the benefits of the other approach too given the example in https://github.com/astral-sh/ruff-lsp/issues/210.

---

_Closed by @MichaReiser on 2024-07-11 06:25_

---

_Label `server` added by @dhruvmanila on 2025-01-07 05:17_

---

_Referenced in [astral-sh/ruff-vscode#766](../../astral-sh/ruff-vscode/issues/766.md) on 2025-06-18 09:21_

---
