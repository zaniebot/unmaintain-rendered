---
number: 10423
title: "SIM300: fix and check are not aligned"
type: issue
state: closed
author: Borda
labels: []
assignees: []
created_at: 2024-03-15T16:24:07Z
updated_at: 2024-03-15T17:16:56Z
url: https://github.com/astral-sh/ruff/issues/10423
synced_at: 2026-01-07T12:31:13-06:00
---

# SIM300: fix and check are not aligned

---

_Issue opened by @Borda on 2024-03-15 16:24_

using the latest `0.3.2` together with precommit
```yaml
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.3.2
    hooks:
      - id: ruff
        args: ["--fix"]
      - id: ruff-format
      - id: ruff
        args: ["--preview"]
```
and the code 
```py
def test_cloud_compute_binding():
    cloud_compute.ENABLE_MULTIPLE_WORKS_IN_NON_DEFAULT_CONTAINER = True

    assert cloud_compute._CLOUD_COMPUTE_STORE == {}
    flow = FlowCC()
    assert len(cloud_compute._CLOUD_COMPUTE_STORE) == 2
```
fixed by the first run is not accepted by the last check
```
ruff.....................................................................Failed
- hook id: ruff
- files were modified by this hook

Found 1 error (1 fixed, 0 remaining).

ruff-format..............................................................Passed
ruff.....................................................................Failed
- hook id: ruff
- exit code: 1

tests/tests_app/core/test_lightning_app.py:1119:12: SIM300 [*] Yoda conditions are discouraged, use `cloud_compute._CLOUD_COMPUTE_STORE == {}` instead
     |
1117 |     cloud_compute.ENABLE_MULTIPLE_WORKS_IN_NON_DEFAULT_CONTAINER = True
1118 | 
1119 |     assert {} == cloud_compute._CLOUD_COMPUTE_STORE
     |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ SIM300
1120 |     flow = FlowCC()
1121 |     assert len(cloud_compute._CLOUD_COMPUTE_STORE) == 2
     |
     = help: Replace Yoda condition with `cloud_compute._CLOUD_COMPUTE_STORE == {}`

Found 1 error.
[*] 1 fixable with the `--fix` option.
```


---

_Referenced in [Lightning-AI/pytorch-lightning#19638](../../Lightning-AI/pytorch-lightning/pulls/19638.md) on 2024-03-15 16:25_

---

_Comment by @charliermarsh on 2024-03-15 16:45_

It looks like you're using `--preview` in one invocation but not the other, so this may be expected. Can you try using `--preview` in both?

---

_Comment by @Borda on 2024-03-15 17:13_

Ok, I was aware of preview for formatting to apply some future staff, but though that preview for check is just rich/verbose... 

---

_Closed by @Borda on 2024-03-15 17:16_

---
