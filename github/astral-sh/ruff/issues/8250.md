---
number: 8250
title: "Reference to `runtime-evaluated-base-classes` in the same file don't work"
type: issue
state: closed
author: iurisilvio
labels:
  - bug
assignees: []
created_at: 2023-10-26T12:03:59Z
updated_at: 2023-11-09T03:38:08Z
url: https://github.com/astral-sh/ruff/issues/8250
synced_at: 2026-01-07T12:31:12-06:00
---

# Reference to `runtime-evaluated-base-classes` in the same file don't work

---

_Issue opened by @iurisilvio on 2023-10-26 12:03_

For some reason, `semantic.resolve_call_path(map_subscript(base))` resolves to `None` when the reference is in the same file.

https://github.com/astral-sh/ruff/blob/f5e850745cc9bcaeb308a3a139b4e86db58096aa/crates/ruff_linter/src/rules/flake8_type_checking/helpers.rs#L43-L44

* A minimal code snippet that reproduces the bug.

In this example, `example1.MyBaseClass` is a runtime evaluated base class.

### example1.py

This triggers `TCH003` for `Sequence`.

```python
from __future__ import annotations

from collections.abc import Sequence  # TCH003


class MyBaseClass:
    pass


class Foo(MyBaseClass):
    foo: Sequence
```

### example2.py

This is `TCH` compliant.

```python
from __future__ import annotations

from collections.abc import Sequence

from example1 import MyBaseClass


class Foo(MyBaseClass):
    foo: Sequence
```

* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.

`ruff --select TCH example1.py example2.py`

* The current Ruff settings (any relevant sections from your `pyproject.toml`).

```
[tool.ruff.flake8-type-checking]
runtime-evaluated-base-classes = [
  "example1.MyBaseClass",
]
```

* The current Ruff version (`ruff --version`).

Main branch, currently 0.1.1.


---

_Label `bug` added by @charliermarsh on 2023-10-26 15:16_

---

_Comment by @charliermarsh on 2023-10-26 15:17_

Thanks! Similar to (or the same as) https://github.com/astral-sh/ruff/issues/5486.

---

_Comment by @charliermarsh on 2023-10-26 15:17_

I really appreciate that you dug into the code :)

---

_Comment by @evanrittenhouse on 2023-10-27 03:31_

Feel free to assign this to me

---

_Assigned to @evanrittenhouse by @MichaReiser on 2023-10-27 04:04_

---

_Referenced in [astral-sh/ruff#8504](../../astral-sh/ruff/pulls/8504.md) on 2023-11-06 16:17_

---

_Referenced in [astral-sh/ruff#8572](../../astral-sh/ruff/pulls/8572.md) on 2023-11-09 03:16_

---

_Closed by @charliermarsh on 2023-11-09 03:38_

---
