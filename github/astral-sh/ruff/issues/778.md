---
number: 778
title: pyupgrade typing rewrites should not rewrite runtime types
type: issue
state: closed
author: JonathanPlasse
labels:
  - bug
assignees: []
created_at: 2022-11-16T20:05:53Z
updated_at: 2022-11-17T06:51:46Z
url: https://github.com/astral-sh/ruff/issues/778
synced_at: 2026-01-07T12:31:12-06:00
---

# pyupgrade typing rewrites should not rewrite runtime types

---

_Issue opened by @JonathanPlasse on 2022-11-16 20:05_

This
```python
from __future__ import annotations
from typing import Optional, List

AnTypeAlias = List[Optional[float]]
```
should not be replaced by
```python
from __future__ import annotations

AnTypeAlias = list[float | None]
```
Python versions before 3.9 do not support type subscription, and 3.10 do not support pipe operator.

---

_Comment by @charliermarsh on 2022-11-16 21:21_

Thanks! Iâ€™ll have to review the rules here and see how pyupgrade handles.

---

_Label `bug` added by @charliermarsh on 2022-11-16 21:50_

---

_Comment by @andersk on 2022-11-16 23:22_

We correctly control this by the `target-version` setting.

```console
$ ruff --select=U --target-version=py38 test.py
$ ruff --select=U --target-version=py39 test.py
Found 1 error(s).
test.py:4:15: U006 Use `list` instead of `List` for type annotations
1 potentially fixable with the --fix option.
$ ruff --select=U --target-version=py310 test.py
Found 2 error(s).
test.py:4:15: U006 Use `list` instead of `List` for type annotations
test.py:4:20: U007 Use `X | Y` for type annotations
2 potentially fixable with the --fix option.
```


---

_Comment by @charliermarsh on 2022-11-16 23:47_

Oh right -- this looks correct to me. I thought the issue had to do with using the standard library type annotations for assignment (on the RHS), rather than as annotations.

---

_Comment by @charliermarsh on 2022-11-16 23:48_

Gonna close for now but feel free to ping if we're misinterpreting the problem!

---

_Closed by @charliermarsh on 2022-11-16 23:48_

---

_Comment by @JonathanPlasse on 2022-11-17 06:51_

Maybe the default version should be the minimum supported Python version like pyupgrade does.

---

_Referenced in [astral-sh/ruff#949](../../astral-sh/ruff/issues/949.md) on 2022-11-28 23:23_

---
