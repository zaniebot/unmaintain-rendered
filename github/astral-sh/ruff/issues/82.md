---
number: 82
title: ruff incorrectly flags imports included in __all__
type: issue
state: closed
author: john-dupuy
labels:
  - bug
assignees: []
created_at: 2022-09-01T22:20:09Z
updated_at: 2023-04-17T12:50:50Z
url: https://github.com/astral-sh/ruff/issues/82
synced_at: 2026-01-07T12:31:11-06:00
---

# ruff incorrectly flags imports included in __all__

---

_Issue opened by @john-dupuy on 2022-09-01 22:20_

**Steps to reproduce**

1. Create two files, `__init__.py` and `blah.py`.

`blah.py` 
```python
class MyBlahClass:
    pass
```

`__init__.py`
```python
from blah import MyBlahClass

__all__ = ["MyBlahClass"]
```

2. Run ruff

**Expected results**
2. ruff should not have an issue with the import in `MyBlahClass` as it's included in `__all__`. 

**Actual results**
2. ruff reports a F401, class imported but unused


**ruff output**:
```
ruff . -v  
[2022-09-01][15:17:28][ruff][DEBUG] Identified files to lint in: 25.778µs
[2022-09-01][15:17:28][ruff::linter][DEBUG] Cache hit for: ./blah.py
[2022-09-01][15:17:28][ruff::linter][DEBUG] Cache hit for: ./__init__.py
[2022-09-01][15:17:28][ruff][DEBUG] Checked files in: 588.674µs
Found 1 error(s).

./__init__.py:1:1: F401 `blah.MyBlahClass` imported but unused
```

**flake8 output**:
```
flake8 . -v
flake8.checker            MainProcess     53 INFO     Making checkers
flake8.checker            MainProcess     54 INFO     Checking 2 files
flake8.main.application   MainProcess     71 INFO     Finished running
flake8.main.application   MainProcess     71 INFO     Reporting errors
flake8.main.application   MainProcess     71 INFO     Found a total of 0 violations and reported 0
```


---

_Comment by @john-dupuy on 2022-09-01 22:23_

https://github.com/charliermarsh/ruff/pull/34 potentially related? 

---

_Label `enhancement` added by @charliermarsh on 2022-09-02 00:19_

---

_Assigned to @charliermarsh by @charliermarsh on 2022-09-02 00:19_

---

_Comment by @charliermarsh on 2022-09-02 00:20_

Thanks, that's a legitimate bug, will fix :)

---

_Label `enhancement` removed by @charliermarsh on 2022-09-02 12:43_

---

_Label `bug` added by @charliermarsh on 2022-09-02 12:43_

---

_Comment by @charliermarsh on 2022-09-02 14:17_

Fixed in #87.

---

_Closed by @charliermarsh on 2022-09-02 14:17_

---

_Comment by @john-dupuy on 2022-09-06 14:02_

Thanks for the quick fix @charliermarsh! :slightly_smiling_face:

---

_Comment by @phillipuniverse on 2022-12-05 15:46_

@charliermarsh I found a slight wrinkle in this fix, doesn't quite work with importing a module.

Consider:

```python
foo/
    __init__.py
bar/
    __init__.py
```

Then in foo/__init__.py:

```python
import bar

__all__ = ["bar"]
```

Ruff detects as an unused import. But if I give it an explicit name:

```python
import bar as bar

__all__ = ["bar"]
```

Ruff reports no issues. Shouldn't both be detected as no issues?

---

_Comment by @charliermarsh on 2022-12-05 15:50_

Yeah looks like that first case is a bug.

---

_Comment by @charliermarsh on 2022-12-05 15:51_

(The explicit re-export (`import bar as bar`) is always protected.)

---

_Referenced in [iris-hep/analysis-grand-challenge#158](../../iris-hep/analysis-grand-challenge/pulls/158.md) on 2023-06-12 14:03_

---
