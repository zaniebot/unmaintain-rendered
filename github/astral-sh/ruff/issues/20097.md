---
number: 20097
title: "`ParamSpec` suppresses the return type annotation in E731 fix"
type: issue
state: closed
author: dscorbett
labels:
  - fixes
assignees: []
created_at: 2025-08-26T12:37:22Z
updated_at: 2025-08-28T20:31:47Z
url: https://github.com/astral-sh/ruff/issues/20097
synced_at: 2026-01-07T12:31:13-06:00
---

# `ParamSpec` suppresses the return type annotation in E731 fix

---

_Issue opened by @dscorbett on 2025-08-26 12:37_

### Summary

If the first element of a `Callable` subscription is a `ParamSpec`, the fix for [`lambda-assignment` (E731)](https://docs.astral.sh/ruff/rules/lambda-assignment/) skips adding types to the function definition. It would be more helpful to preserve the return type annotation, as it does when the first element is `...`. [Example](https://play.ruff.rs/7015f63c-630a-4331-a27b-8bdd61712abc):
```console
$ cat >e731.py <<'# EOF'
from collections.abc import Callable
from typing import ParamSpec
P = ParamSpec("P")
f1: Callable[P, str] = lambda x: str(x)
f2: Callable[..., str] = lambda x: str(x)
# EOF

$ ruff --isolated check e731.py --select E731 --unsafe-fixes --fix 
Found 2 errors (2 fixed, 0 remaining).

$ cat e731.py
from collections.abc import Callable
from typing import ParamSpec
P = ParamSpec("P")
def f1(x):
    return str(x)
def f2(x) -> str:
    return str(x)
```

### Version

ruff 0.12.10 (c68ff8d90 2025-08-21)

---

_Label `fixes` added by @ntBre on 2025-08-26 13:56_

---

_Referenced in [astral-sh/ruff#20108](../../astral-sh/ruff/pulls/20108.md) on 2025-08-27 02:16_

---

_Closed by @ntBre on 2025-08-28 20:31_

---
