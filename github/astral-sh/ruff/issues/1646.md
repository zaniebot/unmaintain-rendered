---
number: 1646
title: "Implement `flake8-bandit`"
type: issue
state: closed
author: charliermarsh
labels:
  - plugin
assignees: []
created_at: 2023-01-05T00:09:24Z
updated_at: 2024-08-01T00:16:23Z
url: https://github.com/astral-sh/ruff/issues/1646
synced_at: 2026-01-07T12:31:12-06:00
---

# Implement `flake8-bandit`

---

_Issue opened by @charliermarsh on 2023-01-05 00:09_

- [x] `S101`: [`assert_used`](https://bandit.readthedocs.io/en/latest/plugins/b101_assert_used.html)
- [x] `S102`: [`exec_used`](https://bandit.readthedocs.io/en/latest/plugins/b102_exec_used.html)
- [x] `S103`: [`set_bad_file_permissions`](https://bandit.readthedocs.io/en/latest/plugins/b103_set_bad_file_permissions.html)
- [x] `S104`: [`hardcoded_bind_all_interfaces`](https://bandit.readthedocs.io/en/latest/plugins/b104_hardcoded_bind_all_interfaces.html)
- [x] `S105`: [`hardcoded_password_string`](https://bandit.readthedocs.io/en/latest/plugins/b105_hardcoded_password_string.html)
- [x] `S106`: [`hardcoded_password_funcarg`](https://bandit.readthedocs.io/en/latest/plugins/b106_hardcoded_password_funcarg.html)
- [x] `S107`: [`hardcoded_password_default`](https://bandit.readthedocs.io/en/latest/plugins/b107_hardcoded_password_default.html)
- [x] `S108`: [`hardcoded_tmp_directory`](https://bandit.readthedocs.io/en/latest/plugins/b108_hardcoded_tmp_directory.html)
- [x] ~`S109`: [`password_config_option_not_marked_secret`](https://bandit.readthedocs.io/en/latest/plugins/b109_password_config_option_not_marked_secret.html)~
- [x] `S110`: [`try_except_pass`](https://bandit.readthedocs.io/en/latest/plugins/b110_try_except_pass.html)
- [x] ~`S111`: [`execute_with_run_as_root_equals_true`](https://bandit.readthedocs.io/en/latest/plugins/b111_execute_with_run_as_root_equals_true.html)~
- [x] `S112`: [`try_except_continue`](https://bandit.readthedocs.io/en/latest/plugins/b112_try_except_continue.html)
- [x] `S113`: [`request_without_timeout`](https://bandit.readthedocs.io/en/latest/plugins/b113_request_without_timeout.html)
- [x] `S201`: [`flask_debug_true`](https://bandit.readthedocs.io/en/latest/plugins/b201_flask_debug_true.html)
- [x] `S202`: [`tarfile_unsafe_members`](https://bandit.readthedocs.io/en/latest/plugins/b202_tarfile_unsafe_members.html)
- [x] `S301`: [`pickle`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S302`: [`marshal`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S303`: [`md5`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S304`: [`ciphers`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S305`: [`cipher_modes`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S306`: [`mktemp_q`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S307`: [`eval`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S308`: [`mark_safe`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S311`: [`random`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S312`: [`telnetlib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S313`: [`xml_bad_cElementTree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S314`: [`xml_bad_ElementTree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S315`: [`xml_bad_expatreader`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S316`: [`xml_bad_expatbuilder`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S317`: [`xml_bad_sax`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S318`: [`xml_bad_minidom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S319`: [`xml_bad_pulldom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S320`: [`xml_bad_etree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S321`: [`ftplib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S323`: [`unverified_context`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html)
- [x] `S324`: [`hashlib`](https://bandit.readthedocs.io/en/latest/plugins/b324_hashlib.html)
- [x] `S310`: [`urllib_urlopen`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b310-urllib-urlopen)
- [x] `S401`: [`import_telnetlib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b401-import-telnetlib)
- [x] `S402`: [`import_ftplib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib)
- [x] `S403`: [`import_pickle`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b403-import-pickle)
- [x] `S404`: [`import_subprocess`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b404-import-subprocess)
- [x] `S405`: [`import_xml_etree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b405-import-xml-etree)
- [x] `S406`: [`import_xml_sax`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b406-import-xml-sax)
- [x] `S407`: [`import_xml_expat`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b407-import-xml-expat)
- [x] `S408`: [`import_xml_minidom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b408-import-xml-minidom)
- [x] `S409`: [`import_xml_pulldom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b409-import-xml-pulldom)
- [x] `S410`: [`import_lxml`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b410-import-lxml)
- [x] `S411`: [`import_xmlrpclib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b411-import-xmlrpclib)
- [x] `S412`: [`import_httpoxy`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b412-import-httpoxy)
- [x] `S413`: [`import_pycrypto`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto)
- [x] `S415`: [`import_pyghmi`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b415-import-pyghmi)
- [x] `S501`: [`request_with_no_cert_validation`](https://bandit.readthedocs.io/en/latest/plugins/b501_request_with_no_cert_validation.html)
- [x] `S502`: [`ssl_with_bad_version`](https://bandit.readthedocs.io/en/latest/plugins/b502_ssl_with_bad_version.html)
- [x] `S503`: [`ssl_with_bad_defaults`](https://bandit.readthedocs.io/en/latest/plugins/b503_ssl_with_bad_defaults.html)
- [x] `S504`: [`ssl_with_no_version`](https://bandit.readthedocs.io/en/latest/plugins/b504_ssl_with_no_version.html)
- [x] `S505`: [`weak_cryptographic_key`](https://bandit.readthedocs.io/en/latest/plugins/b505_weak_cryptographic_key.html)
- [x] `S506`: [`yaml_load`](https://bandit.readthedocs.io/en/latest/plugins/b506_yaml_load.html)
- [x] `S507`: [`ssh_no_host_key_verification`](https://bandit.readthedocs.io/en/latest/plugins/b507_ssh_no_host_key_verification.html)
- [x] `S508`: [`snmp_insecure_version`](https://bandit.readthedocs.io/en/latest/plugins/b508_snmp_insecure_version.html)
- [x] `S509`: [`snmp_weak_cryptography`](https://bandit.readthedocs.io/en/latest/plugins/b509_snmp_weak_cryptography.html)
- [x] `S601`: [`paramiko_calls`](https://bandit.readthedocs.io/en/latest/plugins/b601_paramiko_calls.html)
- [x] `S602`: [`subprocess_popen_with_shell_equals_true`](https://bandit.readthedocs.io/en/latest/plugins/b602_subprocess_popen_with_shell_equals_true.html)
- [x] `S603`: [`subprocess_without_shell_equals_true`](https://bandit.readthedocs.io/en/latest/plugins/b603_subprocess_without_shell_equals_true.html)
- [x] `S604`: [`any_other_function_with_shell_equals_true`](https://bandit.readthedocs.io/en/latest/plugins/b604_any_other_function_with_shell_equals_true.html)
- [x] `S605`: [`start_process_with_a_shell`](https://bandit.readthedocs.io/en/latest/plugins/b605_start_process_with_a_shell.html)
- [x] `S606`: [`start_process_with_no_shell`](https://bandit.readthedocs.io/en/latest/plugins/b606_start_process_with_no_shell.html)
- [x] `S607`: [`start_process_with_partial_path`](https://bandit.readthedocs.io/en/latest/plugins/b607_start_process_with_partial_path.html)
- [x] `S608`: [`hardcoded_sql_expressions`](https://bandit.readthedocs.io/en/latest/plugins/b608_hardcoded_sql_expressions.html)
- [x] `S609`: [`linux_commands_wildcard_injection`](https://bandit.readthedocs.io/en/latest/plugins/b609_linux_commands_wildcard_injection.html)
- [x] `S610`: [`django_extra_used`](https://bandit.readthedocs.io/en/latest/plugins/b610_django_extra_used.html)
- [x] `S611`: [`django_rawsql_used`](https://bandit.readthedocs.io/en/latest/plugins/b611_django_rawsql_used.html)
- [x] `S612`: [`logging_config_insecure_listen`](https://bandit.readthedocs.io/en/latest/plugins/b612_logging_config_insecure_listen.html)
- [x] `S701`: [`jinja2_autoescape_false`](https://bandit.readthedocs.io/en/latest/plugins/b701_jinja2_autoescape_false.html)
- [x] `S702`: [`use_of_mako_templates`](https://bandit.readthedocs.io/en/latest/plugins/b702_use_of_mako_templates.html)
- [ ] `S703`: [`django_mark_safe`](https://bandit.readthedocs.io/en/latest/plugins/b703_django_mark_safe.html)

---

_Comment by @charliermarsh on 2023-01-05 00:12_

\cc @edgarrmondragon - easier to track here than to keep incrementing the count in the README. I'll populate the checklist.

---

_Label `plugin` added by @charliermarsh on 2023-01-05 00:14_

---

_Comment by @edgarrmondragon on 2023-01-05 00:34_

thanks @charliermarsh!

---

_Comment by @charliermarsh on 2023-01-05 00:36_

By the way: the scripts are pretty bad right now, but it might save you some time (and would love help improving):

```
python scripts/add_check.py --name ConvertLoopToAll --code SIM111 --plugin flake8-simplify
```

The main limitations right now are:

1. Doesn't keep the members sorted in `registry.rs`, so has to be manually resorted (else checks appear out-of-order in the docs and elsewhere).
2. Assumes you're using a single `plugins.rs` file, instead of individual files for each check or a `checks.rs` file or whatever else, so that also requires manual tweaks.

---

_Referenced in [astral-sh/ruff#1644](../../astral-sh/ruff/pulls/1644.md) on 2023-01-05 00:38_

---

_Comment by @edgarrmondragon on 2023-01-05 00:40_

> By the way: the scripts are pretty bad right now, but it might save you some time (and would love help improving):
> 
> ```
> python scripts/add_check.py --name ConvertLoopToAll --code SIM111 --plugin flake8-simplify
> ```
> 
> The main limitations right now are:
> 
> 1. Doesn't keep the members sorted in `registry.rs`, so has to be manually resorted (else checks appear out-of-order in the docs and elsewhere).
> 2. Assumes you're using a single `plugins.rs` file, instead of individual files for each check or a `checks.rs` file or whatever else, so that also requires manual tweaks.

Thanks, I'll take a look at those. They might be really helpful for bandit's blacklist tests.

---

_Referenced in [astral-sh/ruff#1661](../../astral-sh/ruff/pulls/1661.md) on 2023-01-05 14:37_

---

_Referenced in [astral-sh/ruff#1664](../../astral-sh/ruff/pulls/1664.md) on 2023-01-05 18:34_

---

_Referenced in [astral-sh/ruff#1692](../../astral-sh/ruff/pulls/1692.md) on 2023-01-06 14:49_

---

_Referenced in [astral-sh/ruff#1695](../../astral-sh/ruff/pulls/1695.md) on 2023-01-06 16:32_

---

_Comment by @ahmedbilal on 2023-01-10 08:58_

Please implement the configurations for it as well e.g `exclude_dirs`.

https://bandit.readthedocs.io/en/latest/config.html#bandit-settings

---

_Comment by @charliermarsh on 2023-01-10 13:02_

@ahmedbilal - I think `exclude_dirs` can be accomplished with the `per-file-ignores` settings, like:

```toml
[tool.ruff.per-file-ignores]
"excluded_dir" = ["S"]
```

---

_Referenced in [astral-sh/ruff#1771](../../astral-sh/ruff/pulls/1771.md) on 2023-01-10 14:15_

---

_Referenced in [astral-sh/ruff#1815](../../astral-sh/ruff/pulls/1815.md) on 2023-01-12 12:49_

---

_Comment by @colin99d on 2023-01-12 18:29_

Not sure if this is the best place to ask, but do flake8-bandit and bandit have the same linters?

---

_Comment by @colin99d on 2023-01-12 18:30_

Also @charliermarsh do you think it would be helpful to pin all of the issues that are trackers for implementing a package to the top? It would make it easier for people to understand our progress, and to contribute to one.

---

_Comment by @charliermarsh on 2023-01-12 19:54_

> Not sure if this is the best place to ask, but do flake8-bandit and bandit have the same linters?

Yeah, I believe `flake8-bandit` is just a wrapper around `bandit` to make it compatible with Flake8: https://github.com/tylerwince/flake8-bandit/blob/3200f00bf34a8ff131139add500db3e62ee1e7fd/flake8_bandit.py#L9

---

_Referenced in [astral-sh/ruff#2108](../../astral-sh/ruff/pulls/2108.md) on 2023-01-23 13:30_

---

_Referenced in [astral-sh/ruff#2197](../../astral-sh/ruff/pulls/2197.md) on 2023-01-26 16:22_

---

_Referenced in [conda/conda#12279](../../conda/conda/pulls/12279.md) on 2023-01-30 16:28_

---

_Comment by @ngnpope on 2023-02-01 20:03_

@charliermarsh It looks like you've only added the rules from [here](https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing) to the list above, but missed those from [here](https://bandit.readthedocs.io/en/latest/blacklists/index.html#complete-plugin-listing)?

---

_Comment by @edgarrmondragon on 2023-02-01 20:06_

> @charliermarsh It looks like you've only added the rules from [here](https://bandit.readthedocs.io/en/latest/plugins/index.html#complete-test-plugin-listing) to the list above, but missed those from [here](https://bandit.readthedocs.io/en/latest/blacklists/index.html#complete-plugin-listing)?

@ngnpope I mentioned the blacklist plugins above, and yeah they wouldn't make the list much larger üëç 

---

_Comment by @ngnpope on 2023-02-01 20:13_

Thanks. I just came across this as a `# noqa: S301` was flagged as unknown by `RUF100`. Added to `external` for now.
Have checked existing issues and opened new ones as I've found gaps in coverage, bugs, etc.

---

_Comment by @colin99d on 2023-02-08 17:43_

It looks like B109 and B111 have been deprecated.

---

_Referenced in [astral-sh/ruff#2674](../../astral-sh/ruff/pulls/2674.md) on 2023-02-09 00:08_

---

_Referenced in [astral-sh/ruff#2698](../../astral-sh/ruff/pulls/2698.md) on 2023-02-09 23:43_

---

_Referenced in [materialsproject/pymatgen#2847](../../materialsproject/pymatgen/pulls/2847.md) on 2023-02-15 19:16_

---

_Comment by @colin99d on 2023-02-26 16:02_

I will tackle the blacklist_calls and blacklist_imports that @ngnpope mentioned.

---

_Comment by @charliermarsh on 2023-02-26 16:05_

Does that behavior not overlap with our existing banned-api rule?

---

_Comment by @colin99d on 2023-02-26 16:30_

Yes it does look like they perform the same operations, should I just add these to the default ones called?

---

_Comment by @charliermarsh on 2023-02-26 16:47_

My instinct is that we should just leave folks to adjust that configuration themselves rather than encode defaults (i.e. do nothing).

---

_Comment by @colin99d on 2023-02-26 16:53_

It seems like we should have some way of letting people know or giving them an easy way to add it. As someone who had been using the bandit package for years, I had no idea it checked this stuff specifically, and would have never thought to configure ruff to add it. Maybe I just need to know more about the packages I use, but this seems like a big loss in the value of bandit.

---

_Comment by @charliermarsh on 2023-02-26 17:04_

I think I misunderstood -- I thought this was something that was user-configured, but it's a list of built-in items to flag. I'm open to including those as regular rules similar to Bandit. I didn't want to have something that was yet-again user configurable for the same purpose.

---

_Comment by @colin99d on 2023-02-26 17:05_

I see, yeah I was not planning on making the user configurable either. I will make it a separate rule!

---

_Referenced in [astral-sh/ruff#3239](../../astral-sh/ruff/pulls/3239.md) on 2023-02-26 21:16_

---

_Comment by @martinlehoux on 2023-03-13 17:36_

I'd like to try S703: [django_mark_safe](https://bandit.readthedocs.io/en/latest/plugins/b703_django_mark_safe.html) , but is there the infrastructure to go check the risk of a variable across modules like bandit does?


---

_Referenced in [astral-sh/ruff#3924](../../astral-sh/ruff/pulls/3924.md) on 2023-04-09 20:59_

---

_Referenced in [pymodbus-dev/pymodbus#1477](../../pymodbus-dev/pymodbus/issues/1477.md) on 2023-04-11 18:59_

---

_Referenced in [treeverse/dvc#9325](../../treeverse/dvc/pulls/9325.md) on 2023-04-12 13:07_

---

_Comment by @ThunderKey on 2023-04-21 07:58_

I've compared the list of tests reported by `bandit --help` (version: 1.7.5) with the ones listed in this issue. The following seem to be missing:

* [x] `S310`: [`urllib_urlopen`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b310-urllib-urlopen) (already added by #3239)
* [ ] `S401`: [`import_telnetlib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b401-import-telnetlib)
* [ ] `S402`: [`import_ftplib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib)
* [ ] `S403`: [`import_pickle`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b403-import-pickle)
* [ ] `S404`: [`import_subprocess`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b404-import-subprocess)
* [ ] `S405`: [`import_xml_etree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b405-import-xml-etree)
* [ ] `S406`: [`import_xml_sax`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b406-import-xml-sax)
* [ ] `S407`: [`import_xml_expat`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b407-import-xml-expat)
* [ ] `S408`: [`import_xml_minidom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b408-import-xml-minidom)
* [ ] `S409`: [`import_xml_pulldom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b409-import-xml-pulldom)
* [ ] `S410`: [`import_lxml`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b410-import-lxml)
* [ ] `S411`: [`import_xmlrpclib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b411-import-xmlrpclib)
* [ ] `S412`: [`import_httpoxy`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b412-import-httpoxy)
* [ ] `S413`: [`import_pycrypto`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto)
* [ ] `S415`: [`import_pyghmi`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b415-import-pyghmi)

Are these omitted intentionally?

<details><summary>If you want a list to copy:</summary>
<p>

```
* [x] `S310`: [`urllib_urlopen`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b310-urllib-urlopen)
* [ ] `S401`: [`import_telnetlib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b401-import-telnetlib)
* [ ] `S402`: [`import_ftplib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b402-import-ftplib)
* [ ] `S403`: [`import_pickle`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b403-import-pickle)
* [ ] `S404`: [`import_subprocess`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b404-import-subprocess)
* [ ] `S405`: [`import_xml_etree`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b405-import-xml-etree)
* [ ] `S406`: [`import_xml_sax`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b406-import-xml-sax)
* [ ] `S407`: [`import_xml_expat`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b407-import-xml-expat)
* [ ] `S408`: [`import_xml_minidom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b408-import-xml-minidom)
* [ ] `S409`: [`import_xml_pulldom`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b409-import-xml-pulldom)
* [ ] `S410`: [`import_lxml`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b410-import-lxml)
* [ ] `S411`: [`import_xmlrpclib`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b411-import-xmlrpclib)
* [ ] `S412`: [`import_httpoxy`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b412-import-httpoxy)
* [ ] `S413`: [`import_pycrypto`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b413-import-pycrypto)
* [ ] `S415`: [`import_pyghmi`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html#b415-import-pyghmi)
```

</p>
</details>

---

_Referenced in [MicaelJarniac/crustypy#67](../../MicaelJarniac/crustypy/issues/67.md) on 2023-04-24 19:39_

---

_Comment by @charliermarsh on 2023-05-02 06:18_

@ThunderKey - No, I think we just missed them since they're listed under a [separate page](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html) in the docs -- adding now, thanks!

---

_Comment by @Daverball on 2023-05-02 08:47_

For interoperability between the reference implementation through direct use of bandit and ruff it would be nice to support `nosec` comments in addition to `noqa`. There is also an open issue for this on `flake8-bandit`: https://github.com/tylerwince/flake8-bandit/issues/20

Otherwise you need redundant comments to ignore the error both in ruff and bandit. (This would allow one to use ruff locally for speed but bandit on CI for correctness/completeness)

---

_Comment by @charliermarsh on 2023-05-02 15:56_

I think you're right that we should support `nosec` comments. It's similar to our support for isort's comment directives.

---

_Comment by @MichaReiser on 2023-05-03 06:50_

> I think you're right that we should support `nosec` comments. It's similar to our support for isort's comment directives.

I do see value in supporting `nosec` suppression comments to ease adoption but it has the disadvantage that Ruff suddenly supports multiple ways for suppressing a violation rather than just one. Having multiple ways to achieve the same can be confusing to users and it may not be clear to them when they should use which suppression comment format, resulting in them likely using all formats in their code base. 

Supporting multiple suppression comments also raises the question of what format ruff should use when running with `--add-noqa` or when adding suppression comments using the code actions in the IDE. 

I don't have good answers to this and we'll face the very same problem if we ever decide to introduce a ruff-specific suppression format. Would ruff continue to support other suppression comment formats or would we provide an automated migration tool?



---

_Comment by @ngnpope on 2023-05-03 07:56_

I have the same concerns. A migration tool would make a lot of sense. I can however see the value of supporting existing suppression comments from other tools to ease migration. Maybe this support should be behind a configuration flag?

---

_Comment by @Daverball on 2023-05-03 08:31_

While I do agree this is a commendable goal in most cases, in this specific case I would have to disagree, since bandit is a security linter, a lot of users would probably prefer to keep using the reference implementation on their CI, to rule out any issues in transposing the rules from Python to Rust. (I would definitely count myself among those)

The speed benefit is far more significant in local development, so you are willing to take the risk of some false negatives there, but on the CI the concerns flip and you want it to catch everything.

So if you force people to migrate to a different style of rules they either have to use them both redundantly or not use them at all locally and only use them on the CI or setup a separate flake8 config just so it can be ignored using the flake8-bandit rule names. None of which seem very appealing to me. I think it is folly to take flake8-bandit as the reference here, rather than bandit itself. I would treat bandit the same way as isort is treated.

I don't think the risk of confusion is as high if you treat the noqa comments as temporary and the nosec as solid. nosec is also honestly just better documentation than a code starting with S, that you will just skip over because you are only looking at the noqa part of it. I think it's fair to be more demanding of users in the case of potential security concerns.

---

_Comment by @scop on 2023-05-19 08:31_

Some updates:
- S310 is not in its sorted place in the list :)
- Could add [S325](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html#b325-tempnam) for completeness, even though it has been removed in bandit, so probably not worth implementing in ruff either
- S601 is done per #4500 
- S609 WIP per #4504

---

_Referenced in [astral-sh/ruff#7503](../../astral-sh/ruff/pulls/7503.md) on 2023-09-19 00:03_

---

_Referenced in [astral-sh/ruff#7528](../../astral-sh/ruff/pulls/7528.md) on 2023-09-19 23:47_

---

_Comment by @mkniewallner on 2023-09-23 14:32_

I'm open to work on all the `import_*` rules from [`blacklist_imports`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_imports.html), but I wonder if they all are that useful, given that some kind of overlap with [`blacklist_calls`](https://bandit.readthedocs.io/en/latest/blacklists/blacklist_calls.html) from `bandit`. Since the `blacklist_calls` rules check specific usages of modules attributes (or for `ftplib` and `telnetlib`, any attribute) known to be prone to security issues, I'm not sure that it is that useful to also report issues for the imports, which alone are not problematic, until we use specific attributes from those imports (which are checked by `blacklist_calls`). Note that some modules reported in `blacklist_imports` (like `pyghmi`) are not in `blacklist_calls`, so for those it might still make sense to implement the rules, but for the other ones, I'm not really sure.

Since Ruff does not handle the severity on reported issues, it probably makes even less sense right now, as in `bandit`, one could deactivate some specifics severity levels (for instance, `low` ones, ending up with only `blacklist_calls` and not `blacklist_imports`).

For reference, for the given file:
```python
# foo.py
from xml.etree import ElementTree

ElementTree.parse("")
```

In `bandit`, you would get:
```console
$ pipx run bandit==1.7.5 foo.py
[...]
Test results:
>> Issue: [B405:blacklist] Using ElementTree to parse untrusted XML data is known to be vulnerable to XML attacks. Replace ElementTree with the equivalent defusedxml package, or make sure defusedxml.defuse_stdlib() is called.
   Severity: Low   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/blacklists/blacklist_imports.html#b405-import-xml-etree
   Location: foo.py:1:0
1	from xml.etree import ElementTree
2
3	ElementTree.parse("")

--------------------------------------------------
>> Issue: [B314:blacklist] Using xml.etree.ElementTree.parse to parse untrusted XML data is known to be vulnerable to XML attacks. Replace xml.etree.ElementTree.parse with its defusedxml equivalent function or make sure defusedxml.defuse_stdlib() is called
   Severity: Medium   Confidence: High
   CWE: CWE-20 (https://cwe.mitre.org/data/definitions/20.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/blacklists/blacklist_calls.html#b313-b320-xml-bad-elementtree
   Location: foo.py:3:0
2
3	ElementTree.parse("")
```

By ignoring `low` severity issues, `bandit` users would only get reports for `blacklist_calls`. In Ruff, users would have to deactivate all `B3` rules.

What is the general stance on rules implementation? Do we prefer to implement rules from plugins as-is, and let users decide if the rules are useful (and disable them if they don't), or are some rules open to discussion depending on how useful or how close to existing rules they are?

---

_Referenced in [astral-sh/ruff#7703](../../astral-sh/ruff/pulls/7703.md) on 2023-09-28 21:13_

---

_Referenced in [freedomofpress/securedrop#6961](../../freedomofpress/securedrop/pulls/6961.md) on 2023-09-29 22:52_

---

_Comment by @qdegraaf on 2023-11-06 14:44_

I am also interested in picking up some of the leftover rules. Has any decision been made on the `S4XX` import rules yet? Also how does Ruff deal with Bandit's severities? E.g. if I wanted to implement `S202` ([source docs](https://github.com/PyCQA/bandit/blob/9a2884efe130cad0897586e58dcb33bdbb6fbd81/bandit/plugins/tarfile_unsafe_members.py#L6)) is there a default severity level that Ruff ports? Or do we split it into 3 separate smaller rules? 

Clicked through some ported rules and it looks like `S103` has a med and high version and Ruff just ports both in the same rule but for something like `S202` that might be a bit aggressive. 

---

_Referenced in [astral-sh/ruff#8533](../../astral-sh/ruff/pulls/8533.md) on 2023-11-07 03:31_

---

_Referenced in [apache/airflow#34247](../../apache/airflow/pulls/34247.md) on 2023-11-09 21:31_

---

_Referenced in [astral-sh/ruff#8651](../../astral-sh/ruff/pulls/8651.md) on 2023-11-13 10:48_

---

_Referenced in [astral-sh/ruff#8829](../../astral-sh/ruff/pulls/8829.md) on 2023-11-23 16:26_

---

_Referenced in [astral-sh/ruff#8831](../../astral-sh/ruff/pulls/8831.md) on 2023-11-24 11:22_

---

_Comment by @ischaojie on 2023-11-26 08:10_

These rules have already been implemented:
S201: [flask_debug_true](https://bandit.readthedocs.io/en/latest/plugins/b201_flask_debug_true.html)
S601: [paramiko_calls](https://bandit.readthedocs.io/en/latest/plugins/b601_paramiko_calls.html)
S609: [linux_commands_wildcard_injection](https://bandit.readthedocs.io/en/latest/plugins/b609_linux_commands_wildcard_injection.html)

---

_Comment by @moise-dev on 2023-12-14 23:18_

@charliermarsh I think is more a generic question rather than specific to this rule set, but are you implementing them with the exact same behaviour of the originals?

I am getting the same (odd) behaviour in ruff and flake8
```
‚ùØ ruff ruff_test.py
ruff_test.py:4:1: S311 Standard pseudo-random generators are not suitable for security/cryptographic purposes.
```

With this sample code:

```python
import random
import time

time.sleep(random.choice(range(1, 5)))
```

I was wondering if this behaviour is going to be reviewed or fixed in Ruff? Thanks!


---

_Comment by @Daverball on 2023-12-15 07:24_

@pygaiwan This is the intended behavior of that rule and not odd at all. The `random` module is not safe, if you care about security, since the random sequences are predictable. Whether or not you use `random` in a place where security matters is not the linters' job to figure out and also quite impossible to do reliably in a dynamic language like Python. There's a `secrets` module which contains some of the same functions as `random` but implemented in a more secure way.

Bandit is a security linter so its goal is to have essentially zero false negatives, at the cost of some false positives, so it's quite common that you will have to review bandit errors and decide whether or not it's an actual issue and put a `noqa`/`nosec` comment, when you decide it isn't a problem.

You can also globally disable rules you don't care about.

---

_Comment by @charliermarsh on 2024-01-03 18:19_

Five rules left :)

---

_Referenced in [astral-sh/ruff#9384](../../astral-sh/ruff/pulls/9384.md) on 2024-01-03 20:17_

---

_Referenced in [astral-sh/ruff#9390](../../astral-sh/ruff/pulls/9390.md) on 2024-01-04 11:52_

---

_Referenced in [astral-sh/ruff#9391](../../astral-sh/ruff/pulls/9391.md) on 2024-01-04 17:17_

---

_Referenced in [nautobot/nautobot-app-ssot#314](../../nautobot/nautobot-app-ssot/pulls/314.md) on 2024-01-08 14:43_

---

_Comment by @edgarrmondragon on 2024-01-13 00:20_

S503 was addressed by https://github.com/astral-sh/ruff/pull/9391 so there's only S610 and S703  left!

---

_Comment by @glennmatthews on 2024-01-16 15:15_

How is S703 different from S308, by the way? They seem redundant to me.

---

_Comment by @itdependsnetworks on 2024-01-23 21:30_

> How is S703 different from S308, by the way? They seem redundant to me.

Per https://github.com/PyCQA/bandit/issues/294#issue-320993934, it would seem so. Would seem like S308 was first and then S703 covered S308 but did not want to have a breaking change. 

---

_Referenced in [astral-sh/ruff#9780](../../astral-sh/ruff/issues/9780.md) on 2024-02-02 09:43_

---

_Referenced in [astral-sh/ruff#10316](../../astral-sh/ruff/pulls/10316.md) on 2024-03-09 18:14_

---

_Referenced in [JoseRZapata/data-science-project-template#45](../../JoseRZapata/data-science-project-template/pulls/45.md) on 2024-03-25 18:05_

---

_Referenced in [astral-sh/ruff#12463](../../astral-sh/ruff/issues/12463.md) on 2024-07-22 19:32_

---

_Closed by @charliermarsh on 2024-08-01 00:16_

---

_Referenced in [plugboard-dev/plugboard#96](../../plugboard-dev/plugboard/issues/96.md) on 2025-03-06 21:33_

---
