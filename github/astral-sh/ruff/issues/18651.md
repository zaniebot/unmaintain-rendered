---
number: 18651
title: "Unnecessary `crate::` prefixes in `crates/ruff_python_ast/generated.rs`"
type: issue
state: closed
author: chirizxc
labels:
  - internal
assignees: []
created_at: 2025-06-12T19:11:40Z
updated_at: 2025-06-24T12:25:17Z
url: https://github.com/astral-sh/ruff/issues/18651
synced_at: 2026-01-07T12:31:13-06:00
---

# Unnecessary `crate::` prefixes in `crates/ruff_python_ast/generated.rs`

---

_Issue opened by @chirizxc on 2025-06-12 19:11_

> there's also a question about [ruff_python_ast/src/generated.rs](https://github.com/astral-sh/ruff/blob/main/crates/ruff_python_ast/src/generated.rs) file ![Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ](https://private-user-images.githubusercontent.com/109767616/454415857-a3ba28ec-3ae2-4698-9037-dd322b33e162.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NDk3NDk4NDgsIm5iZiI6MTc0OTc0OTU0OCwicGF0aCI6Ii8xMDk3Njc2MTYvNDU0NDE1ODU3LWEzYmEyOGVjLTNhZTItNDY5OC05MDM3LWRkMzIyYjMzZTE2Mi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwNjEyJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDYxMlQxNzMyMjhaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zZjBjNzgyZjIyYzhlMjkwMTQxYmI5MzU2OTYwZjZjYzg3MDI0MDgwZDI1NjUxMzJiZjllMzgwNDYwM2FhNjYzJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.I_VCJxgt8BZUJ1xaFWKyVcgtMCxA-WCvp0LDwG6Kf1M)
> 
> rustrover writes that `crate::` is not needed in 834 places, should the `crates/ruff_python_ast/generate.py` itself be corrected?

This is interesting, I guess clippy doesn't warn about this. We could probably open a separate issue or PR for this, if you wanted!

_Originally posted by @ntBre in https://github.com/astral-sh/ruff/issues/18645#issuecomment-2967674061_
            

---

_Comment by @chirizxc on 2025-06-12 19:13_

![Image](https://github.com/user-attachments/assets/71d0750b-6026-42c3-be0e-31402f078a3e)

---

_Comment by @ntBre on 2025-06-12 19:39_

Thanks for opening the issue! I think it should definitely be safe to remove these, but I'm not immediately seeing where this prefix is added in the code generation script, which I think was changed to include at least some of these in https://github.com/astral-sh/ruff/pull/17180. For example, I don't think I see any of the types from the screenshots here:

https://github.com/astral-sh/ruff/blob/02394b8049b52836ae7daca7132fab93031d1162/crates/ruff_python_ast/generate.py#L17-L21

---

_Label `internal` added by @ntBre on 2025-06-12 19:39_

---

_Referenced in [astral-sh/ruff#18652](../../astral-sh/ruff/pulls/18652.md) on 2025-06-12 20:41_

---

_Comment by @dcreager on 2025-06-16 19:15_

As @chirizxc mentions https://github.com/astral-sh/ruff/pull/18652#issuecomment-2971652315, this is the [`unused_qualifications`](https://doc.rust-lang.org/rustc/lints/listing/allowed-by-default.html#unused-qualifications) lint from `rustc` (not `clippy`). That lint is marked as `allow` by default, because:

> it is somewhat pedantic, and doesn't indicate an actual problem, but rather a stylistic choice, and can be noisy when refactoring or moving around code

If we activate this lint, then we should do so for the whole repo (as suggested here https://github.com/astral-sh/ruff/pull/18652#issuecomment-2971787538) so that this will be checked as part of CI moving forward.

That said, I'm not convinced that we should activate this lint just because rustrover has a different default than `rustc`. If we do, it should be because we agree with its suggestions. I'm ambivalent to mildly against. @ntBre @MichaReiser, do you have strong feelings on this?

---

_Comment by @ntBre on 2025-06-16 19:23_

I don't have strong feelings. I thought it might be nice and low-impact just for the generated code, but I didn't think about enabling the lint or the churn that could cause elsewhere. I usually prefer the style from the lint and fix it in my code when I notice it, but I definitely don't feel strongly enough to impose it throughout the project. And I agree with you that that's what the decision boils down to!

---

_Comment by @chirizxc on 2025-06-16 19:28_

maybe just put `#![deny(unused_qualifications)]` at the beginning of the generated file?

---

_Comment by @dcreager on 2025-06-16 20:50_

> maybe just put `#![deny(unused_qualifications)]` at the beginning of the generated file?

I'm not in favor of that â€” I feel we should either enforce the lint for the whole repo or not at all.

---

_Comment by @MichaReiser on 2025-06-17 05:39_

I sometimes remove unnecessary prefixes if I come across them, but not always. For example, it has become an established pattern to use `ast::Node` in ty, and the prefix shouldn't be removed when the IDE imports a node directly. That's why I don't think we should enable this lint. 

However, I don't mind removing the unnecessary prefixes in the generated file if it doesn't introduce extra complexity. I don't think it's worth it even if it adds just one line of extra branching in the generation script because the prefix doesn't hurt anyone and it's a generated fiel that no one should edit anyway. 




---

_Comment by @chirizxc on 2025-06-24 11:47_

what are we supposed to do about it? close?

---

_Comment by @MichaReiser on 2025-06-24 12:25_

Yeah, I'm leaning towards closing unless the "cleanup" comes at no extra cost (which this discussion already shows, it does not ðŸ˜†)

---

_Closed by @MichaReiser on 2025-06-24 12:25_

---

_Closed by @MichaReiser on 2025-06-24 12:25_

---
