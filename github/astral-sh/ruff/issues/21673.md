---
number: 21673
title: "[`S506`] `unsafe-yaml-load` reports false positive when using non-standard `CSafeLoader` path"
type: issue
state: closed
author: alastair
labels:
  - rule
  - help wanted
assignees: []
created_at: 2025-11-28T09:57:33Z
updated_at: 2025-12-07T10:40:48Z
url: https://github.com/astral-sh/ruff/issues/21673
synced_at: 2026-01-07T12:31:14-06:00
---

# [`S506`] `unsafe-yaml-load` reports false positive when using non-standard `CSafeLoader` path

---

_Issue opened by @alastair on 2025-11-28 09:57_

### Summary

Hi,
We have some code which triggered the unsafe-yaml-load rule
```py
return yaml.load(f, Loader=yaml.cyaml.CSafeLoader)
```

```
S506 Probable use of unsafe loader `CSafeLoader` with `yaml.load`. Allows instantiation of arbitrary objects. Consider `yaml.safe_load`.
    --> sounds/models.py:2499:44
     |
2497 |         try:
2498 |             with open(analysis_filepath_base + ".yaml") as f:
2499 |                 return yaml.load(f, Loader=yaml.cyaml.CSafeLoader)
     |                                            ^^^^^^^^^^^^^^^^^^^^^^
2500 |         except Exception:
2501 |             pass
     |
```
Note that the warning is on the `Loader` parameter, not the call to `yaml.load`. I realise that this is because we use the path `yaml.cyaml.CSafeLoader` to specify the loader. If I update this to 

```py
return yaml.load(f, Loader=yaml.CSafeLoader)
```

Then there is no warning. I note that the pyyaml documentation doesn't mention the cyaml package, so I'm not sure why we originally wrote the code like this. In any case it's not a huge change for us to choose either `yaml.safe_load` or to specify the loader as `yaml.CSafeLoader`, but perhaps it makes sense for ruff to not trigger on the use of `yaml.cyaml` either.

Thanks

---

_Renamed from "[flake8-bandit/S506] unsafe-yaml-load reports false positive when using non-standard CSafeLoader path" to "[`S506`] unsafe-yaml-load reports false positive when using non-standard CSafeLoader path" by @MichaReiser on 2025-12-01 08:02_

---

_Renamed from "[`S506`] unsafe-yaml-load reports false positive when using non-standard CSafeLoader path" to "[`S506`] `unsafe-yaml-load` reports false positive when using non-standard `CSafeLoader` path" by @MichaReiser on 2025-12-01 08:02_

---

_Comment by @MichaReiser on 2025-12-01 10:23_

Thanks. 

Allowing `yaml.load(f, Loader=yaml.cyaml.CSafeLoader)` and ``yaml.load(f, Loader=yaml.SafeLoader)` does make sense to me, as the latter is exactly the same as `safe_load` does internally

---

_Label `rule` added by @MichaReiser on 2025-12-01 10:24_

---

_Label `help wanted` added by @MichaReiser on 2025-12-01 10:24_

---

_Comment by @prakhar1144 on 2025-12-06 15:24_

Working on a fix for this. Thanks!

---

_Assigned to @prakhar1144 by @ntBre on 2025-12-06 17:20_

---

_Referenced in [astral-sh/ruff#21830](../../astral-sh/ruff/pulls/21830.md) on 2025-12-07 09:58_

---

_Closed by @MichaReiser on 2025-12-07 10:40_

---
