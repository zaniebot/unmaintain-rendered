---
number: 8568
title: "`ARG002` false positive with `kwargs`-consuming decorators"
type: issue
state: open
author: rassie
labels:
  - bug
  - wish
assignees: []
created_at: 2023-11-08T17:13:54Z
updated_at: 2023-11-09T02:09:06Z
url: https://github.com/astral-sh/ruff/issues/8568
synced_at: 2026-01-07T12:31:12-06:00
---

# `ARG002` false positive with `kwargs`-consuming decorators

---

_Issue opened by @rassie on 2023-11-08 17:13_

My code goes something like this:

```py
@wrapt.decorator
def my_request(wrapped, instance, args, kwargs):
    filtered_kwargs = {key: value for key, value in kwargs.items() if value is not None}
    url = wrapped(*args, **filtered_kwargs)
    response = requests.get(url, filtered_kwargs)
    return response.content

class MyClass:
    @my_request
    def some_data(self, additional_data=None):
        return "https://myurl.example.com"
```

The idea is to define available query parameters through non-`None` keyword arguments, so if I call `obj.some_data()` I expect the contents of "https://myurl.example.com" to be returned and on `obj.some_data(additional_data="data")`, "https://myurl.example.com?additional_data=data" should be called.

Now the problem is that `ARG002` is triggered on `additional_data`, which is of course used, but only indirectly via the decorator. I don't know whether looking up what decorators are doing is in scope for `ruff` at all so I don't have high expectations that this is worth fixing, but would still appreciate it deeply.

---

_Label `bug` added by @charliermarsh on 2023-11-09 02:06_

---

_Label `wish` added by @charliermarsh on 2023-11-09 02:06_

---

_Comment by @charliermarsh on 2023-11-09 02:09_

This will be pretty tough to fix, my honest suggestion would be to try and restructure the code to avoid this kind of interception-via-decorator, but I know you didn't come here for those kinds of suggestions :)

---
