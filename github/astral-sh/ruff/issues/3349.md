---
number: 3349
title: SIM102 inconsistency
type: issue
state: closed
author: diceroll123
labels: []
assignees: []
created_at: 2023-03-04T22:53:58Z
updated_at: 2023-03-05T00:00:13Z
url: https://github.com/astral-sh/ruff/issues/3349
synced_at: 2026-01-07T12:31:12-06:00
---

# SIM102 inconsistency

---

_Issue opened by @diceroll123 on 2023-03-04 22:53_

_Ruff 0.0.254_

`SIM102` is what merges nested if-statements together.

I've annotated each test method with whether or not they get refactored, and marked changes from `test1`'s affected line using comments and carets.

Do note, all 4 lint issues are marked appropriately in CLI as well as in ruff-vscode.

Command used: `ruff check . --select=SIM102 --fix --isolated`

```py
import mock

fakectx = mock.Mock()
Faker = mock.Mock()
def test1() ->None:
    # this one gets refactored!
    if sum([1,2,3]) > 0:
        if f := Faker(fakectx.nest[str(fakectx)]).fake():
            print(f)
            return
    
    return None

def test2() ->None:
    # this one gets refactored!
    if sum([1,2,3]) > 0:
        if f := Faker(fakectx.nest.another[str(fakectx)]).fake():
            ######################^^^^^^^^
            print(f)
            return
    
    return None

def test3() ->None:
    # this one gets refactored!
    if sum([1,2,3]) > 0:
        if f := Faker(fakectx.nest[str(fakectx.nest)]).fake():
            ##################################^^^^^
            print(f)
            return
    
    return None

def test4() ->None:
    # this one does not get refactored!
    if sum([1,2,3]) > 0:
        if f := Faker(fakectx.nest.another[str(fakectx.nest)]).fake():
            ######################^^^^^^^^############^^^^^
            print(f)
            return
    
    return None
```

---

_Comment by @diceroll123 on 2023-03-04 23:18_

This doesn't affect my code anymore, because I moved the heavily-nested value into a variable since it's used multiple times (replaced here with the sum method), but thought I'd mention that this happens.

---

_Comment by @charliermarsh on 2023-03-04 23:53_

It might be the case that the fourth example leads to an overlong line? In which case we do avoid automatically refactoring.

---

_Comment by @diceroll123 on 2023-03-05 00:00_

Ah, interesting.

Also, wow! My test4 case was _exactly_ the length to make it not happen! ðŸ˜† Deleted one character and it went through.

Thanks for clarification!

---

_Closed by @diceroll123 on 2023-03-05 00:00_

---
