---
number: 9394
title: Invalid formatting of match statement
type: issue
state: closed
author: MSDehghan
labels:
  - bug
  - formatter
assignees: []
created_at: 2024-01-04T20:53:21Z
updated_at: 2024-01-09T14:39:14Z
url: https://github.com/astral-sh/ruff/issues/9394
synced_at: 2026-01-07T12:31:13-06:00
---

# Invalid formatting of match statement

---

_Issue opened by @MSDehghan on 2024-01-04 20:53_

formatting below code with `ruff format file.py` command leads to invalid python code:
```python
match {}:
    case {
        "long_long_long_key": str(long_long_long_key)
    } if value := "long long long long long long long long long long long value":
        pass

```

after formatting with ruff the file will look like this which is not a valid python code:
```python
match {}:
    case {"long_long_long_key": str(long_long_long_key)} if value
    := "long long long long long long long long long long long value":
        pass
```

ruff version:  0.1.11


---

_Label `bug` added by @zanieb on 2024-01-04 20:54_

---

_Label `formatter` added by @zanieb on 2024-01-04 20:54_

---

_Comment by @zanieb on 2024-01-04 20:54_

Can reproduce this with `ruff 0.1.11 (fefc7e819 2024-01-02)` with and without the `--preview` flag, thanks for the report!

---

_Comment by @charliermarsh on 2024-01-05 00:21_

I can take a look -- thanks for this.

---

_Referenced in [astral-sh/ruff#9396](../../astral-sh/ruff/pulls/9396.md) on 2024-01-05 00:38_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-01-05 04:38_

---

_Comment by @charliermarsh on 2024-01-09 14:39_

Fixed by https://github.com/astral-sh/ruff/pull/9396. Thanks!

---

_Closed by @charliermarsh on 2024-01-09 14:39_

---
