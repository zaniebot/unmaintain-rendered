---
number: 21101
title: Syntax error false positive on nested alternative patterns
type: issue
state: closed
author: ntBre
labels:
  - bug
assignees: []
created_at: 2025-10-27T19:37:00Z
updated_at: 2025-10-30T17:40:05Z
url: https://github.com/astral-sh/ruff/issues/21101
synced_at: 2026-01-07T12:31:13-06:00
---

# Syntax error false positive on nested alternative patterns

---

_Issue opened by @ntBre on 2025-10-27 19:37_

This change seems to now cause a SyntaxError on the following valid code that doesn't use different names:

```
invalid-syntax: alternative patterns bind different names
   --> src/sp_repo_review/checks/ruff.py:127:17
    |
125 |           match ruff:
126 |               case (
127 | /                 {"lint": {"select": x} | {"extend-select": x}}
128 | |                 | {"select": x}
129 | |                 | {"extend-select": x}
    | |______________________________________^
130 |               ):
131 |                   return cls.code in x or "ALL" in x
    |
```

See https://github.com/scientific-python/cookie/pull/663

_Originally posted by @henryiii in https://github.com/astral-sh/ruff/issues/20682#issuecomment-3452968119_

and here's a minimized [example](https://play.ruff.rs/f0eab842-e43c-4142-a764-df78b8c078ed):

```py
match ruff:
    case {"lint": {"select": x} | {"extend-select": x}} | {"select": x}:
        return cls.code in x or "ALL" in x
```
            

---

_Label `bug` added by @ntBre on 2025-10-27 19:37_

---

_Assigned to @ntBre by @ntBre on 2025-10-27 19:39_

---

_Referenced in [astral-sh/ruff#21104](../../astral-sh/ruff/pulls/21104.md) on 2025-10-27 21:03_

---

_Closed by @ntBre on 2025-10-30 17:40_

---
