---
number: 6651
title: "Bug: `F821` Error for complex import of `Literal`"
type: issue
state: closed
author: code-yeongyu
labels:
  - bug
assignees: []
created_at: 2023-08-17T13:10:46Z
updated_at: 2023-08-30T15:36:04Z
url: https://github.com/astral-sh/ruff/issues/6651
synced_at: 2026-01-07T12:31:12-06:00
---

# Bug: `F821` Error for complex import of `Literal`

---

_Issue opened by @code-yeongyu on 2023-08-17 13:10_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->


Hey there! ðŸ‘‹

First off, thank you for the ruff project. It's my second time to report an issue. I love your product and enjoy using it for everyday.

If i import of `Literal` in a complex way, it raises F821.

Here is the minimal code snippet to reproduce the bug.

The following code raises F821 of "Undefined name `greeting`" on `main.py`

`custom_types.py`:
```python
from typing import Literal as JustString
```

`main.py`:
```python
from custom_types import JustString

choice: JustString["greeting"]
```

Thank you.

---

_Comment by @charliermarsh on 2023-08-17 15:21_

Thanks for the kind words! Unfortunately this is a known issue. It'll be fixed at some point but it's not quite trivial...

If you consistently used the name `Literal` instead of aliasing to `JustString`, you could use [`typing-modules`](https://beta.ruff.rs/docs/settings/#typing-modules):

```toml
[tool.ruff]
typing-modules = ["custom_types"]
```

Then, when Ruff sees `from custom_types import Literal`, it would interpret that as equivalent to `typing.Literal`. But if the import is renamed in `custom_types`, we aren't able to trace that `JustString` is equivalent to `Literal` (yet).

---

_Label `bug` added by @charliermarsh on 2023-08-17 15:22_

---

_Comment by @charliermarsh on 2023-08-17 15:22_

(Note: this requires multi-file support, since we need to resolve `JustString` as equivalent to `Literal` across files.)

---

_Comment by @code-yeongyu on 2023-08-17 16:41_

Ah I see. Seems it's a very complex issue. Just like I have reported issue before, thank you for your speedy kind response, and for this awesome project. Have a good day!

---

_Comment by @charliermarsh on 2023-08-30 15:36_

I think this can be merged with #6014.

---

_Closed by @charliermarsh on 2023-08-30 15:36_

---
