---
number: 8221
title: "`SIM115 Use context handler` across a try/else block"
type: issue
state: open
author: smurfix
labels:
  - rule
  - wish
assignees: []
created_at: 2023-10-25T14:33:09Z
updated_at: 2024-10-20T11:36:48Z
url: https://github.com/astral-sh/ruff/issues/8221
synced_at: 2026-01-07T12:31:12-06:00
---

# `SIM115 Use context handler` across a try/else block

---

_Issue opened by @smurfix on 2023-10-25 14:33_

<!--
Thank you for taking the time to report an issue! We're glad to have you involved with Ruff.

If you're filing a bug report, please consider including the following information:

* A minimal code snippet that reproduces the bug.
* The command you invoked (e.g., `ruff /path/to/file.py --fix`), ideally including the `--isolated` flag.
* The current Ruff settings (any relevant sections from your `pyproject.toml`).
* The current Ruff version (`ruff --version`).
-->
``` python3
    try:
        f = open("foo.txt", "r")
    except OSError:
        pass
    else:
        with f:
            do_something_complicated(f)
```
This complains `SIM115 Use context handler for opening files`, except that I *am* doing that â€“ just not on the same line, because I don't want the exception handler to cover the `do_something_complicated` part.

It'd be nice if ruff recognized this pattern.

---

_Label `rule` added by @charliermarsh on 2023-10-30 23:39_

---

_Label `wish` added by @charliermarsh on 2023-10-30 23:39_

---

_Comment by @bartfeenstra on 2024-10-20 11:36_

I am experiencing similar issues, when using `open()` with an `ExitStack()`. It seems that the rule raises violations in cases where no `with` statement is detected, which is only one of the ways to enter and exit a context manager.

---

_Referenced in [astral-sh/ruff#20581](../../astral-sh/ruff/issues/20581.md) on 2025-09-25 18:33_

---
