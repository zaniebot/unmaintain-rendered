---
number: 1430
title: "[feature-request] Support dry run for --fix via --diff flag"
type: issue
state: closed
author: salmiakki
labels:
  - configuration
assignees: []
created_at: 2022-12-28T21:18:58Z
updated_at: 2022-12-29T00:46:46Z
url: https://github.com/astral-sh/ruff/issues/1430
synced_at: 2026-01-07T12:31:12-06:00
---

# [feature-request] Support dry run for --fix via --diff flag

---

_Issue opened by @salmiakki on 2022-12-28 21:18_

It's scary to apply automatic fixes before taking a look at them.

It would be nice to have a dry run option (`--dry-run`?) that outputs the patch to stdout.

---

_Comment by @charliermarsh on 2022-12-28 22:23_

Yeah that could be useful. I'm not sure what the right output format would be. Write the changed files to disk as `.bak` or `.tmp` variants? Just dump the patches to stdout?

As an aside: ESLint has [`--fix-dry-run`](https://eslint.org/docs/latest/user-guide/command-line-interface#--fix-dry-run), but it just disables writing the fixes to disk. If you want to get the fixes without writing them, you have to specify `--format json`, to get the fixes in JSON format. I find this a bit clearer than what we do today (always write to disk if `--fix` is set, but generate fixes if `--fix` is not set and `--format json` is set).


---

_Comment by @charliermarsh on 2022-12-28 22:27_

Can you think of other tools that implement this kind of thing, and how they handle it?

---

_Label `configuration` added by @charliermarsh on 2022-12-28 22:27_

---

_Comment by @salmiakki on 2022-12-28 22:47_

Definitely diff to stdout.

Maybe printing the whole file in addition to the diff could be useful as well. Other than that I can't really see myself using anything else.

***

For prior art:

`black` has 

```
  --diff                          Don't write the files back, just output a
                                  diff for each file on stdout.
```

`goftm` has

```
-d
	Do not print reformatted sources to standard output.
	If a file's formatting is different than gofmt's, print diffs
	to standard output.
```

---

_Comment by @rhkleijn on 2022-12-28 23:02_

`isort` also has `--diff`
See https://pycqa.github.io/isort/docs/configuration/options.html#show-diff

---

_Comment by @charliermarsh on 2022-12-28 23:10_

Ok cool, weâ€™ll call it diff and print to stdout (one diff per changed file).

---

_Renamed from "[feature-request] Support dry run for --fix" to "[feature-request] Support dry run for --fix via --diff flag" by @charliermarsh on 2022-12-28 23:16_

---

_Assigned to @charliermarsh by @charliermarsh on 2022-12-28 23:26_

---

_Referenced in [astral-sh/ruff#1431](../../astral-sh/ruff/pulls/1431.md) on 2022-12-29 00:08_

---

_Closed by @charliermarsh on 2022-12-29 00:21_

---

_Comment by @salmiakki on 2022-12-29 00:29_

@charliermarsh Are you for real? This is insane. Thanks!

---

_Comment by @charliermarsh on 2022-12-29 00:46_

Haha :) It's a good idea! You're welcome!

This'll go out in the next release, later tonight. Would love to hear if it works for you (or doesn't!).


---

_Referenced in [astral-sh/ruff#1439](../../astral-sh/ruff/issues/1439.md) on 2022-12-29 16:07_

---
