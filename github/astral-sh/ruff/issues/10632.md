---
number: 10632
title: "Bad fixes with E266: multiple-leading-hashes-for-block-comment"
type: issue
state: closed
author: Hnasar
labels:
  - documentation
assignees: []
created_at: 2024-03-27T17:36:25Z
updated_at: 2024-04-18T01:22:20Z
url: https://github.com/astral-sh/ruff/issues/10632
synced_at: 2026-01-07T12:31:13-06:00
---

# Bad fixes with E266: multiple-leading-hashes-for-block-comment

---

_Issue opened by @Hnasar on 2024-03-27 17:36_

I'm trying out `--preview` with ruff 0.3.4. [E266](https://docs.astral.sh/ruff/rules/multiple-leading-hashes-for-block-comment/) which is a pycodestyle --preview rule has some weird fixes:

1.  Probably should try to leave headers alone if the comment ends in one or more `#`
```diff
-##################################### FOO #############################################
+# FOO #############################################
```

2. Why is the space after the `:`?
```diff
-            #:::team.foo.bar.baz
+            #: ::team.foo.bar.baz
```

3. Weird example in https://docs.astral.sh/ruff/rules/multiple-leading-hashes-for-block-comment/#example
> Use instead:
```
# Block comments:
#  - Block comment list
# \xa0- Block comment list
```



---

_Comment by @MichaReiser on 2024-03-28 12:15_

1. I think flagging it (and the way its fixed) is in line with the intent of the rule. You might want to disable `E266` if you want to keep header comments with this specific format.

2. Pycodestyle both allows `:` or `!` directly after the `#`

```py
#: E265:2:1
m = 42
#! This is important
mx = 42 - 42
#: E266:3:5 E266:6:5
```

3. I assume what you find weird about it is the `\xa0`? Or is it something else

---

_Label `documentation` added by @MichaReiser on 2024-03-28 12:15_

---

_Comment by @charliermarsh on 2024-03-28 13:46_

Pycodestyle also allows this style for headers:

```python
#####
# Foo
#####
```

That is, lines that are _only_ `#` are allowed.

---

_Comment by @Hnasar on 2024-04-01 15:10_

Thanks for the clarifications!

> 1. Probably should try to leave headers alone

TIL about the pycodestyle suggested header style, thanks. IMO since PEP 8 doesn't specify a header style, tools should be more permissive (but I understand the desire for compatibility with pycodestyle)

> 2. Why is the space after the :?

> Pycodestyle both allows : or ! directly after the #

* TIL that `#:` is for [sphinx documentation](https://www.sphinx-doc.org/en/master/usage/extensions/autodoc.html#directive-autoproperty), but the fact that pycodestyle supports this is undocumented.
* FYI for `#!`: pycodestyle does **not** allow `#! comment` (except for shebangs on the first line) -- these comments result in `E265 block comment should start with '# '`

> 3. Weird example in https://docs.astral.sh/ruff/rules/multiple-leading-hashes-for-block-comment/#example

> I assume what you find weird about it is the \xa0? Or is it something else

* the `\xa0` is weird and
* the "use instead" doesn't seem to follow from the "example"
E.g. perhaps instead it should be

Example
```py
### Public API
def say_hi():
    ## This is a block comment.
    print("hi")
```

Use instead
```py
# Public API
def say_hi():
    # This is a block comment.
    print("hi")
```

or

Use instead
```py
#############
# Public API
#############
def say_hi():
    # This is a block comment.
    print("hi")
```

---

_Referenced in [astral-sh/ruff#11007](../../astral-sh/ruff/pulls/11007.md) on 2024-04-18 01:13_

---

_Assigned to @charliermarsh by @charliermarsh on 2024-04-18 01:14_

---

_Closed by @charliermarsh on 2024-04-18 01:22_

---
