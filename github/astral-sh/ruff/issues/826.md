---
number: 826
title: U007 Autofix on string type format
type: issue
state: closed
author: martinlehoux
labels:
  - bug
assignees: []
created_at: 2022-11-20T10:06:23Z
updated_at: 2022-11-21T02:41:56Z
url: https://github.com/astral-sh/ruff/issues/826
synced_at: 2026-01-07T12:31:12-06:00
---

# U007 Autofix on string type format

---

_Issue opened by @martinlehoux on 2022-11-20 10:06_

I have an issue with U007 autofix, but I can't really say if it's a bug or not.

I have this piece of code (the `if TYPE_CHECKING:` is required for cyclic imports issue)

```py
if TYPE_CHECKING:
    from app.models.model_a import ModelA
    from app.models.model_b import ModelB

ModelAOrB = Union["ModelA", "ModelB"]
```

and it gets fixed into

```py
if TYPE_CHECKING:
    from app.models.model_a import ModelA
    from app.models.model_b import ModelB

ModelAOrB = "ModelA" | "ModelB"
```

which is not the same type as before

---

_Comment by @martinlehoux on 2022-11-20 10:07_

That being said, maybe it's not the way to do types, and if it's just a workaround I need, I can simply ignore this check on this specific line

---

_Label `bug` added by @charliermarsh on 2022-11-20 15:05_

---

_Comment by @charliermarsh on 2022-11-20 15:10_

Ohh interesting, yeah that's a bug. According to [this issue](https://bugs.python.org/issue45857), you're expected to instead do `ModelAOrB = "ModelA | ModelB"`.

---

_Comment by @charliermarsh on 2022-11-20 20:57_

It looks like pyupgrade [skips those altogether](https://github.com/asottile/pyupgrade/blob/5b527acec11568ee095181a333adaaa1fec9fe27/pyupgrade/_plugins/typing_pep604.py#L147).

---

_Assigned to @charliermarsh by @charliermarsh on 2022-11-20 21:52_

---

_Comment by @hmc-cs-mdrissi on 2022-11-21 01:10_

If you want the whole string then whether it’s a string or a type alias becomes more ambiguous and behavior may vary by type checker. The recommendation there is to do,

ModelAorB: TypeAlias = “ModelA | ModelB”

This may require adding an import to TypeAlias with additional caveat the TypeAlias is only a thing since 3.10 or if you use typing extensions. It’s probably safest to just skip this case like pyupgrade unless you plan to add the correct import depending on python version/environment.

---

_Comment by @charliermarsh on 2022-11-21 02:10_

@hmc-cs-mdrissi - Yeah totally agree -- I think we need to just skip the upgrade in that case. (`"ModelA | ModelB"` is also much more confusing IMO than the same type expressed as a `Union`.)


---

_Referenced in [astral-sh/ruff#845](../../astral-sh/ruff/pulls/845.md) on 2022-11-21 02:41_

---

_Closed by @charliermarsh on 2022-11-21 02:41_

---

_Referenced in [astral-sh/ruff#3508](../../astral-sh/ruff/issues/3508.md) on 2023-03-14 20:46_

---
