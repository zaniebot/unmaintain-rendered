---
number: 13506
title: Conda installation of Ruff not running on aarch64
type: issue
state: closed
author: bcaddy
labels:
  - bug
  - release
assignees: []
created_at: 2024-09-24T15:36:32Z
updated_at: 2024-10-04T17:50:42Z
url: https://github.com/astral-sh/ruff/issues/13506
synced_at: 2026-01-07T12:31:13-06:00
---

# Conda installation of Ruff not running on aarch64

---

_Issue opened by @bcaddy on 2024-09-24 15:36_

I'm trying to run Ruff on an NVIDIA Grace (i.e. ARM Neoverse v2) CPU and getting the following error:

```
<jemalloc>: Unsupported system page size
<jemalloc>: Unsupported system page size
memory allocation of 5 bytes failed
Aborted
```

This appears to be a reappearance of the page size issue noted in #3791 and I'm not sure how to fix it. I've installed Ruff with Conda from the Conda-forge channel and I'm on the latest version. Any suggestions?

---

_Comment by @MichaReiser on 2024-09-24 16:12_

Do you know if Ruff installs a pre-built wheel or is it installed from source?

Do you know what page size your system uses?

---

_Renamed from "Ruff not running on aarch64" to "Conda installation of Ruff not running on aarch64" by @bcaddy on 2024-09-24 16:13_

---

_Comment by @bcaddy on 2024-09-24 16:15_

The page size is 64k and I'm just installing it with `conda install -c conda-forge ruff`.

I tried with the exact same version of Ruff installed via `pip` and it works just fine, so the issue is not actually with Ruff but with the version built/installed with Conda; I've updated the title accordingly.

---

_Comment by @zanieb on 2024-09-24 16:22_

Related:

- https://github.com/astral-sh/ruff/issues/3791
- https://github.com/astral-sh/ruff/issues/10073

---

_Comment by @zanieb on 2024-09-24 16:23_

Presumably we need to set this variable over in the conda-forge builds?

---

_Comment by @MichaReiser on 2024-09-25 07:10_

Yes, I can take a look. @zanieb do you know who has access to our conda forge recipe and how it can be changed?

For reference:

https://github.com/astral-sh/ruff/blob/be1d5e33680c3e2e71b452ad1ed651dcc6f37f55/.github/workflows/build-binaries.yml#L271-L287

https://github.com/astral-sh/ruff/blob/be1d5e33680c3e2e71b452ad1ed651dcc6f37f55/.github/workflows/build-binaries.yml#L412-L416

---

_Label `release` added by @MichaReiser on 2024-09-25 07:10_

---

_Comment by @zanieb on 2024-09-25 13:32_

Anyone can open a pull request https://github.com/conda-forge/ruff-feedstock

---

_Comment by @MichaReiser on 2024-09-26 08:29_

@bcaddy would you be interested in PRing a fix? It's on my todo list but it probably takes me a while before I get to and I have no prior conda forge knowledge

---

_Label `bug` added by @MichaReiser on 2024-09-26 08:29_

---

_Referenced in [conda-forge/ruff-feedstock#222](../../conda-forge/ruff-feedstock/issues/222.md) on 2024-09-26 14:12_

---

_Comment by @bcaddy on 2024-09-26 14:14_

I also have no experience with conda forge and don't see an obvious place to change the jemalloc setting so I opened an issue on the ruff feedstock, hopefully they can help out. 

https://github.com/conda-forge/ruff-feedstock/issues/222

---

_Referenced in [conda-forge/ruff-feedstock#224](../../conda-forge/ruff-feedstock/pulls/224.md) on 2024-09-27 16:35_

---

_Closed by @zanieb on 2024-10-04 17:50_

---
