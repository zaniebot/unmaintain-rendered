---
number: 6987
title: Rules ANN401,W605 cause autofix error
type: issue
state: closed
author: qarmin
labels:
  - bug
  - fuzzer
assignees: []
created_at: 2023-08-29T18:16:36Z
updated_at: 2024-01-30T07:03:10Z
url: https://github.com/astral-sh/ruff/issues/6987
synced_at: 2026-01-07T12:31:12-06:00
---

# Rules ANN401,W605 cause autofix error

---

_Issue opened by @qarmin on 2023-08-29 18:16_

Ruff 0.0.286 (latest changes from main branch)

```
ruff  *.py --select ANN401,W605 --no-cache
```

file content:
```
from currency.converter import CurrencyConverterMessageFactory as _
currencies = { 
        "DOP" : (_(u"Dominican Peso"), u"\RD$"),
        }
```

error:
```
error: Autofix introduced a syntax error. Reverting all changes.

This indicates a bug in `ruff`. If you could open an issue at:

    https://github.com/astral-sh/ruff/issues/new?title=%5BAutofix%20error%5D

...quoting the contents of `currencies922.py`, the rule codes E201, E203, I001, UP025, W291, W605, along with the `pyproject.toml` settings and executed command, we'd be very appreciative!

```

[currencies922.py.zip](https://github.com/astral-sh/ruff/files/12467936/currencies922.py.zip)


---

_Label `bug` added by @charliermarsh on 2023-08-29 21:35_

---

_Label `fuzzer` added by @charliermarsh on 2023-08-29 21:35_

---

_Renamed from "Rules E201, E203, I001, UP025, W291, W605 cause autofix error" to "Rules ANN401,W605 cause autofix error" by @qarmin on 2023-09-02 21:49_

---

_Comment by @dhruvmanila on 2023-09-25 04:56_

It must be adding the `r` prefix in `u"\RD$"` which makes it `ru"\RD$"` which is invalid. I guess the fix would be to either not add the `r` prefix if the string is unicode.

---

_Comment by @qarmin on 2024-01-30 07:03_

Cannot reproduce with latest version

---

_Closed by @qarmin on 2024-01-30 07:03_

---
