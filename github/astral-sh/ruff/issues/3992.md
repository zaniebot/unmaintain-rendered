---
number: 3992
title: RET504 off-by-1  line / bogus error when returning an argument
type: issue
state: closed
author: hynek
labels:
  - bug
assignees: []
created_at: 2023-04-17T06:37:39Z
updated_at: 2023-04-18T03:22:40Z
url: https://github.com/astral-sh/ruff/issues/3992
synced_at: 2026-01-07T12:31:12-06:00
---

# RET504 off-by-1  line / bogus error when returning an argument

---

_Issue opened by @hynek on 2023-04-17 06:37_

Consider the following file `t.py`:

```python
def str_to_bool(val):
    if isinstance(val, bool):
        return val
    val = val.strip().lower()
    if val in ("1", "true", "yes"):
        return True

    return False
```

Running `pipx run ruff check --isolated --select RET504 t.py` gives me:

```
t.py:3:16: RET504 Unnecessary variable assignment before `return` statement
```

So it points at the `return val` that hasn't assigned anything.

If I set val by hand instead of passing it in as an argument, there is no error.

---

```console
$ pipx run ruff --version
ruff 0.0.261
```

no `pyproject.toml`

---

_Label `bug` added by @charliermarsh on 2023-04-17 13:25_

---

_Comment by @charliermarsh on 2023-04-17 13:26_

üëç Definitely a bug.

---

_Assigned to @charliermarsh by @charliermarsh on 2023-04-18 02:36_

---

_Referenced in [astral-sh/ruff#4004](../../astral-sh/ruff/pulls/4004.md) on 2023-04-18 03:16_

---

_Closed by @charliermarsh on 2023-04-18 03:22_

---
