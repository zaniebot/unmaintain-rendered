---
number: 15128
title: "Expected Jupyter Notebook format 4, found: 5"
type: issue
state: closed
author: amotl
labels: []
assignees: []
created_at: 2024-12-23T21:44:54Z
updated_at: 2024-12-23T21:52:54Z
url: https://github.com/astral-sh/ruff/issues/15128
synced_at: 2026-01-07T12:31:13-06:00
---

# Expected Jupyter Notebook format 4, found: 5

---

_Issue opened by @amotl on 2024-12-23 21:44_

Dear lovely authors and maintainers of Ruff,

we are just adding a Jupyter Notebook per https://github.com/crate/langchain-cratedb/pull/12, which has been created using the most recent PyCharm 2024.3.1.1. When running most recent Ruff 0.8.4 on it, it trips, emitting this error message.
```
$ ruff check
docs/cache.ipynb:1:1: Expected Jupyter Notebook format 4, found: 5
Found 1 error.
```

With kind regards,
Andreas.

#### Observations
Indeed, contrary to the other notebooks in this folder, this one apparently uses version 5 of the Jupyter Notebook format, where even nbformat doesn't have a handler for? [^1]
```shell
$ cat docs/vectorstores.ipynb | jq .nbformat
4

$ cat docs/cache.ipynb | jq .nbformat
5
```

#### Thoughts
Because even the documentation about [the Notebook file format] does not mention anything about format v5.9, I guess my report might be totally bogus. As you can see at [docs/cache.ipynb @ 64dfe9e](https://github.com/crate/langchain-cratedb/blob/64dfe9e/docs/cache.ipynb), GitHub also rejects to render the notebook at all.
```
 "nbformat": 5,
 "nbformat_minor": 9
```

#### References
- https://github.com/jupyter/nbviewer/issues/545
- https://github.com/jupyter/nbformat/issues/170

[the Notebook file format]: https://nbformat.readthedocs.io/en/latest/format_description.html


[^1]: https://github.com/jupyter/nbformat/tree/main/nbformat


---

_Comment by @amotl on 2024-12-23 21:52_

Just fixing this per https://github.com/crate/langchain-cratedb/commit/2dc4c2560a, Ruff doesn't complain any longer, and GitHub also starts rendering the notebook properly, see [docs/cache.ipynb @ 2dc4c2560a](https://github.com/crate/langchain-cratedb/blob/2dc4c2560a/docs/cache.ipynb).

> I guess my report might be totally bogus.

Closing this. Sorry for the noise.

NB: This apparently might have happened because the notebook has _never_ been executed, so it also doesn't have any metadata information `"metadata": {}`.


---

_Closed by @amotl on 2024-12-23 21:52_

---
