---
number: 2592
title: "`D202`: Conflict with black's 2023 style"
type: issue
state: closed
author: ngnpope
labels:
  - bug
  - docstring
assignees: []
created_at: 2023-02-05T22:15:55Z
updated_at: 2023-02-05T23:48:30Z
url: https://github.com/astral-sh/ruff/issues/2592
synced_at: 2026-01-07T12:31:12-06:00
---

# `D202`: Conflict with black's 2023 style

---

_Issue opened by @ngnpope on 2023-02-05 22:15_

For the following code:
```python
def outer():
    """This is a docstring."""
    # This is a comment.
    def inner():
        return

    return inner
```
I see the following behaviour:
```console
‚ùØ ruff --version
ruff 0.0.240

‚ùØ ruff --select D202 bug.py
# ... no output ...

‚ùØ black --version
black, 23.1.0 (compiled: yes)
Python (CPython) 3.10.9

‚ùØ black --diff bug.py 
--- bug.py	2023-02-05 21:19:16.413892 +0000
+++ bug.py	2023-02-05 21:19:22.497046 +0000
@@ -1,7 +1,8 @@
 def outer():
     """This is a docstring."""
+
     # This is a comment.
     def inner():
         return
 
     return inner()
would reformat bug.py

All done! ‚ú® üç∞ ‚ú®
1 file would be reformatted.

‚ùØ black bug.py 
reformatted bug.py

All done! ‚ú® üç∞ ‚ú®
1 file reformatted.

‚ùØ ruff --select D202 bug.py 
bug.py:2:5: D202 No blank lines allowed after function docstring (found 1)
Found 1 error.
1 potentially fixable with the --fix option.
```
It seems that this works fine if the comment is removed. Black wants a blank line before and after a nested function. But black treats comment lines before the function as "attached" to the function. This doesn't happen with the `D202` rule in ruff which treats them as separate. We should follow black's lead here. 

---

_Comment by @ngnpope on 2023-02-05 22:55_

Related: https://github.com/PyCQA/pydocstyle/issues/627

---

_Label `bug` added by @charliermarsh on 2023-02-05 23:00_

---

_Label `docstring` added by @charliermarsh on 2023-02-05 23:00_

---

_Referenced in [astral-sh/ruff#2597](../../astral-sh/ruff/pulls/2597.md) on 2023-02-05 23:37_

---

_Closed by @charliermarsh on 2023-02-05 23:48_

---
