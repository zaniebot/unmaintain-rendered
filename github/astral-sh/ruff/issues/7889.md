---
number: 7889
title: "Consider respecting `avoid-escape` when enforcing other `flake8-quotes` rules"
type: issue
state: open
author: BT-rmartin
labels:
  - bug
assignees: []
created_at: 2023-10-10T09:23:22Z
updated_at: 2024-10-23T20:14:28Z
url: https://github.com/astral-sh/ruff/issues/7889
synced_at: 2026-01-07T12:31:12-06:00
---

# Consider respecting `avoid-escape` when enforcing other `flake8-quotes` rules

---

_Issue opened by @BT-rmartin on 2023-10-10 09:23_

My Ruff version is 0.0.292
My configuration of Ruff is 

```toml
[tool.ruff]
select = ["E", "F", "I", "PL", "B", "Q", "D", "N", "S", "G", "RUF", "W"]
ignore = ["D100", "D101", "D104", "D213", "D203", "RUF012"]
exclude = ["**/ext/"]

line-length = 115

[tool.ruff.per-file-ignores]
"__init__.py" = ["F401"]
"__manifest__.py" = ["B018"]
"**/tests/*.py" = ["S101"]

[tool.ruff.flake8-quotes]
docstring-quotes = "double"
inline-quotes = "single"
multiline-quotes = "double"
avoid-escape = false
```

I had a file like this

```python
{
    "name": "My module",
    "version": "16.0.1.0.0",
    "summary": "Strips newline from text's fields",
    "category": "Accounting",
    "installable": True,
}
```

When running _ruff . --fix_, it produces a file like this, which is mixing up single quote and double quote in the summary key due to the apostrophe it had there
```python
{
    'name': 'My module',
    'version': '16.0.1.0.0',
    'summary': "Strips newline from text's fields",
    'category': 'Accounting',
    'installable': True,
}
```

I would expect that it's able to escape the apostrophe as I have avoid-escape = false.
Could you please tell me what is wrong here?

Anothe working option for me would be to ignore the flake8-quotes for specific files. Is that possible?

Thanks in advance

---

_Label `bug` added by @charliermarsh on 2023-10-10 15:54_

---

_Comment by @charliermarsh on 2023-10-10 15:54_

I think this is a bug because we aren't respecting `avoid-escape = false` in all of the Q rules.

---

_Comment by @BT-rmartin on 2023-10-11 10:50_

@charliermarsh Thanks for the quick answer. 
When do you estimate this might be fixed?

---

_Comment by @charliermarsh on 2023-10-11 13:45_

I would guess in the next week or two?

---

_Comment by @dhruvmanila on 2023-10-12 04:57_

> I think this is a bug because we aren't respecting `avoid-escape = false` in all of the Q rules.

That's true although `flake8-quotes` has the same behavior:

```console
flake8 t.py --no-avoid-escape  
```

Maybe related https://github.com/astral-sh/ruff/issues/2400

---

_Renamed from "Bug with tool.ruff.flake8-quotes configuration" to "Consider respecting `avoid-escape` when enforcing other `flake8-quotes` rules" by @charliermarsh on 2023-10-14 18:57_

---

_Comment by @BT-rmartin on 2023-10-26 23:20_

@charliermarsh Any progress on this topic?

---

_Comment by @dhruvmanila on 2023-11-01 06:21_

I'm sorry there hasn't been any progress here but we might want to hold off until https://github.com/astral-sh/ruff/pull/7927 is finalized and merged as that could simplify the implementation of `flake8-quotes` rules.

---

_Comment by @BT-rmartin on 2023-11-02 22:59_

Ok thanks @dhruvmanila. When do you estimate this could be done?

---

_Comment by @BT-rmartin on 2023-11-19 17:54_

hi @dhruvmanila, @charliermarsh When do you estimate this might be fixed?

---

_Comment by @zanieb on 2023-11-19 18:24_

@BT-rmartin please do not bump issues repeatedly. #7927 is still in-progress. Updates will be posted here when progress is made on this issue.

---

_Comment by @BT-rmartin on 2024-10-23 20:14_

hi @dhruvmanila, @charliermarsh @zanieb Any news on this 1 year later?

---
