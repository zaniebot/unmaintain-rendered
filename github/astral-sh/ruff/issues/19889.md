---
number: 19889
title: Ruff crashes when pyproject.toml is being edited
type: issue
state: open
author: luluxxxlulu
labels:
  - bug
  - configuration
  - server
assignees: []
created_at: 2025-08-13T01:40:19Z
updated_at: 2025-08-13T07:09:23Z
url: https://github.com/astral-sh/ruff/issues/19889
synced_at: 2026-01-07T12:31:13-06:00
---

# Ruff crashes when pyproject.toml is being edited

---

_Issue opened by @luluxxxlulu on 2025-08-13 01:40_

While I was editing `pyproject.toml`, the Ruff extension crashed. I know why, because the syntax was temporarily invalid. However, I don't think this should cause a crash. Perhaps Ruff should keep its current configuration until the `pyproject.toml` file becomes parse-able again.

<img width="1355" height="427" alt="Image" src="https://github.com/user-attachments/assets/a4f9c633-337a-47b8-83b1-dbfadca40aac" />

---

_Comment by @dhruvmanila on 2025-08-13 04:47_

When you say it crashes, does it stop working? IIRC, it should mainly log the error and use the default settings, which is obviously not correct as it should use the last known valid settings instead.

Related: astral-sh/ruff-vscode#711 

---

_Label `bug` added by @dhruvmanila on 2025-08-13 04:47_

---

_Label `configuration` added by @dhruvmanila on 2025-08-13 04:47_

---

_Comment by @dhruvmanila on 2025-08-13 04:47_

(I'm going to move this to the Ruff repository as it's related to the language server and not the extension specifically.)

---

_Label `server` added by @dhruvmanila on 2025-08-13 04:48_

---

_Comment by @luluxxxlulu on 2025-08-13 05:56_

Hi @dhruvmanila thank you for the quick response. It shows an error pop-up in visual studio every time you type something, given that `pyproject.toml`'s syntax remains invalid. I think it is an issue because it is unnecessarily distracting. This is what the pop-up looks like:

<img width="475" height="164" alt="Image" src="https://github.com/user-attachments/assets/fea1ae9b-fb9d-4a70-8782-e7910a119921" />

---

_Comment by @dhruvmanila on 2025-08-13 06:21_

Ah, yes, it will also show a popup.

So, this must be coming from `workspace/didChangeWatchedFiles` notification. I think we would need to separately handle a fresh indexing of the project and the reload settings part and only show a notification on the fresh indexing.

---

_Comment by @MichaReiser on 2025-08-13 07:09_

I think showing the notification after changes were made is useful because a user might indeed have made an unintentional mistake. 

We could track internally if the settings are currently valid and only show the warning if it goes from valid -> invalid. That's probably still somewhat distracting. An alternative is to add a debounce or something. It's definetely tricky to find the right balance here between letting users know that Ruff isn't working as expected vs being noisy

---
