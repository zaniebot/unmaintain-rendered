---
number: 8673
title: Add python binding / support input text
type: issue
state: closed
author: ArthurZucker
labels: []
assignees: []
created_at: 2023-11-14T09:55:53Z
updated_at: 2023-11-20T07:29:15Z
url: https://github.com/astral-sh/ruff/issues/8673
synced_at: 2026-01-07T12:31:12-06:00
---

# Add python binding / support input text

---

_Issue opened by @ArthurZucker on 2023-11-14 09:55_

Hey! ü§ó `transformers` core maintainer here, great work everyone! üî• 

We are trying to switch from `black` to `ruff` for the formatter now! See this [PR](https://github.com/huggingface/transformers/pull/27144). 
I humbly have 2 feature requests! (This might be a bit selfish üòì )
- having some python bindings: allowing us to do something like `from ruff import format; formatted_code = format(code)` 
- support directly passing text as an input to avoid having to write it to files. So `ruff format "Class Blob:\n...."

ü§ó 

---

_Comment by @Wauplin on 2023-11-14 10:08_

Adding also a use case for the [huggingface_hub](https://github.com/huggingface/huggingface_hub) repo. We generate some Python code automatically and need to format it once generated.

What we do [here](https://github.com/huggingface/huggingface_hub/blob/b054006d7582914df458a3e5595414a97f1aedeb/utils/check_static_imports.py#L82C1-L84C84) is to spawn a process to run ruff (using `ruff.__main__.find_ruff_bin`):

```py
        ruff_bin = find_ruff_bin()
        os.spawnv(os.P_WAIT, ruff_bin, ["ruff", "format", str(filepath), "--quiet"])
        os.spawnv(os.P_WAIT, ruff_bin, ["ruff", str(filepath), "--fix", "--quiet"])
```

A Python-binding would seem less hacky than this current solution :smile: (but totally understand if not a priority, I already love the work you've done on `ruff`!)



---

_Comment by @charliermarsh on 2023-11-14 19:58_

Thank you for the kind words :)

There's been some discussion to expose a Python API in https://github.com/astral-sh/ruff/issues/659 -- I'm definitely interested in doing it, but it isn't something we're actively working on right now (just to set expectations around timeline). In the [ruff-lsp](https://github.com/charliermarsh/ruff-lsp) (which is written in Python right now), we also interop with Ruff via `subprocess`, so it _is_ the suggested way to use Ruff as a library right now, though we'd really like to have a first-class API.

Separately...

> support directly passing text as an input to avoid having to write it to files

This actually _should_ be supported -- the linter and the formatter both accept input from `stdin`:

```shell
‚ùØ echo "x=1" | ruff format -
x = 1
```

(You can also set a `--stdin-filename` there to ensure that we respect `.pyi` differences, etc.)

---

_Comment by @Wauplin on 2023-11-15 09:10_

Thanks for the context and confirming that using `subprocess` is the good strategy here!
And sorry for the duplicate with https://github.com/astral-sh/ruff/issues/659, I guess we can close this one?


---

_Comment by @ArthurZucker on 2023-11-15 09:10_

Yep thanks a lot for the tip, applying this to `transformers`! ü§ó 

---

_Closed by @ArthurZucker on 2023-11-15 09:10_

---

_Referenced in [cunarist/solie#95](../../cunarist/solie/issues/95.md) on 2023-11-19 13:18_

---

_Comment by @akx on 2023-11-20 07:29_

If it helps, I wrote a more full-fledged "format this bit" example for just the same usecase in https://github.com/astral-sh/ruff/issues/8401#issuecomment-1788806462

---
