---
number: 8437
title: "Formatter: Parenthesize long expressions in dicts"
type: issue
state: closed
author: zanieb
labels:
  - formatter
  - preview
  - style
assignees: []
created_at: 2023-11-02T05:10:40Z
updated_at: 2023-11-29T03:03:37Z
url: https://github.com/astral-sh/ruff/issues/8437
synced_at: 2026-01-07T12:31:12-06:00
---

# Formatter: Parenthesize long expressions in dicts

---

_Issue opened by @zanieb on 2023-11-02 05:10_

See https://github.com/astral-sh/ruff/issues/8436 for background.

Stable formatting of dicts with a long value results in a wrap that reduces readability

Unformatted:

```python
if True:
    ___ = {
        "x": "---",
        "y": "--------------------------------------------------------------" if True else None,
        "z": "---",
    }
```

Formatted (Ruff, Black stable):

```python
if True:
    ___ = {
        "x": "---",
        "y": "--------------------------------------------------------------"
        if True
        else None,
        "z": "---",
    }
```

Formatted (Black preview):

```python
if True:
    ___ = {
        "x": "---",
        "y": (
            "--------------------------------------------------------------"
            if True
            else None
        ),
        "z": "---",
    }

```

With a shorter line, Ruff retains parenthesis when the lines are collapsed:

```python
if True:
    ___ = {
        "x": "---",
        "y": ("----------------------------------------------------" if True else None),
        "z": "---",
    }
```

However, these parenthesis should be removed as they are superfluous.

Black's preview style **will** remove these parenthesis:

```python
if True:
    ___ = {
        "x": "---",
        "y": "----------------------------------------------------" if True else None,
        "z": "---",
    }
```

See https://github.com/psf/black/issues/620 https://github.com/psf/black/pull/3440

Note that Black does _not_ remove these parenthesis for calls or lists, see https://github.com/astral-sh/ruff/issues/8436 and #8438 

---

_Label `formatter` added by @zanieb on 2023-11-02 05:10_

---

_Label `preview` added by @zanieb on 2023-11-02 05:10_

---

_Label `style` added by @zanieb on 2023-11-02 05:10_

---

_Referenced in [astral-sh/ruff#8436](../../astral-sh/ruff/issues/8436.md) on 2023-11-02 05:11_

---

_Referenced in [astral-sh/ruff#8438](../../astral-sh/ruff/issues/8438.md) on 2023-11-02 05:15_

---

_Referenced in [astral-sh/ruff#6935](../../astral-sh/ruff/issues/6935.md) on 2023-11-02 05:17_

---

_Added to milestone `Formatter: Stable` by @zanieb on 2023-11-02 05:18_

---

_Comment by @MichaReiser on 2023-11-29 03:03_

I merged this into https://github.com/astral-sh/ruff/issues/8438 and create a new issue for parenthesizing long values. 

---

_Closed by @MichaReiser on 2023-11-29 03:03_

---

_Removed from milestone `Formatter: Stable` by @MichaReiser on 2023-11-29 03:03_

---

_Referenced in [astral-sh/ruff#9289](../../astral-sh/ruff/issues/9289.md) on 2023-12-27 13:53_

---
