---
number: 1659
title: PD013 UseOfDotStack triggered by np.stack
type: issue
state: closed
author: ManonMarchand
labels:
  - bug
assignees: []
created_at: 2023-01-05T10:42:46Z
updated_at: 2023-01-06T00:30:55Z
url: https://github.com/astral-sh/ruff/issues/1659
synced_at: 2026-01-07T12:31:12-06:00
---

# PD013 UseOfDotStack triggered by np.stack

---

_Issue opened by @ManonMarchand on 2023-01-05 10:42_

Hi, 

I think this is not intentional: using the numpy function `stack` with `np.stack` triggers the error PD013 `UseOfDotStack .melt is preferred to .stack; provides same functionality` even if this has nothing to do with a Pandas dataframe. 

---

_Label `bug` added by @charliermarsh on 2023-01-05 14:47_

---

_Comment by @charliermarsh on 2023-01-05 14:47_

Yeah we can probably guard against this.

---

_Comment by @charliermarsh on 2023-01-05 14:48_

(We could ensure that whatever’s referenced isn’t an in import. Maybe some other heuristics too.)

---

_Comment by @twoertwein on 2023-01-05 15:25_

(same for `torch.stack`)

---

_Comment by @ManonMarchand on 2023-01-05 15:38_

Is there a way to check the type of what's referenced? The issue might also occur in all the other `UseOfDot*` checks

---

_Comment by @edgarrmondragon on 2023-01-05 15:53_

> Is there a way to check the type of what's referenced?

Not really, since types would have to be tracked beyond the module being analyzed. The best we could do is check the imports, like Charlie said above.

---

_Comment by @charliermarsh on 2023-01-05 16:05_

Yeah, I think we can at least ensure that `np.stack` and `torch.stack` themselves don't trigger. What we can't guard against are things like:

```py
x = np.array([])
x.stack(...)
```

(That's not valid NumPy code anyway, more illustrating the point that this would be a false positive.)

---

_Assigned to @charliermarsh by @charliermarsh on 2023-01-05 19:36_

---

_Referenced in [astral-sh/ruff#1671](../../astral-sh/ruff/pulls/1671.md) on 2023-01-06 00:30_

---

_Closed by @charliermarsh on 2023-01-06 00:30_

---
