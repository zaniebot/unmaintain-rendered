---
number: 17391
title: "Support for `per-file-select` to simplify incremental rule adoption in monorepos"
type: issue
state: closed
author: mgaitan
labels:
  - configuration
assignees: []
created_at: 2025-04-14T12:01:27Z
updated_at: 2025-04-15T13:25:22Z
url: https://github.com/astral-sh/ruff/issues/17391
synced_at: 2026-01-07T12:31:13-06:00
---

# Support for `per-file-select` to simplify incremental rule adoption in monorepos

---

_Issue opened by @mgaitan on 2025-04-14 12:01_

We're currently running into a limitation related to `select` granularity. In our setup, we want to **enable all `B` (flake8-bugbear) rules only for a specific subdirectory**, e.g., `infrastructure/**/*.py`, while **keeping a small, curated subset of `B` rules for the rest of the codebase**.

Since `per-file-select` is not supported, the only way to do this today is to add `"B"` to the global `select` list, and then **manually disable every unwanted `B` rule for all other paths using `per-file-ignores`**.


```toml
[tool.ruff.lint]
select = ["E", "F", "B"]

[tool.ruff.lint.per-file-ignores]
"!infrastructure/**/*.py" = [
  "B011", "B012", "B013", "B014", "B015", "B017", "B019", "B020", "B024", "B028", ...
]
```

This approach has two major downsides:

1. It's hard to maintain and scales poorly with monorepos.
2. **If a new `B` rule is added in a Ruff update**, it will immediately start triggering errors in all non-`infrastructure` code â€” unless we explicitly add it to the `per-file-ignores`, which makes upgrades error-prone.

Instead, we'd love to see support for something like:

```toml
[tool.ruff.lint]
select = ["E", "F", "B006", "B007"]

[tool.ruff.lint.per-file-select]
"infrastructure/**/*.py" = ["B"]
```

This would allow teams to **adopt rules incrementally in targeted parts of the codebase**, without negatively affecting the rest of the project. It would significantly improve maintainability and unlock cleaner linting strategies in larger codebases.

This idea has already come up in a couple of discussions by @carljm:

- https://github.com/astral-sh/ruff/issues/11042#issuecomment-2067022376 
- https://github.com/astral-sh/ruff/pull/10863#discussion_r1561770000


PS: Thanks for your great work!


---

_Comment by @ntBre on 2025-04-14 12:37_

`per-file-select` may still be useful (thanks for the references to other comments!), but I think this specific example could also be handled by a separate, small `ruff.toml` in your `infrastructure` subdirectory with the `B` rules [`extend-select`](https://docs.astral.sh/ruff/settings/#lint_extend-select)ed. That might be a useful workaround for now.

---

_Label `configuration` added by @ntBre on 2025-04-14 12:38_

---

_Comment by @dhruvmanila on 2025-04-14 22:51_

I think this can be merged into https://github.com/astral-sh/ruff/issues/7696 which is a more general issue that asks support for per-file configuration that would include `select`.

---

_Closed by @ntBre on 2025-04-15 13:25_

---
