---
number: 9499
title: "`PLC2801` false positive when `__exit__` is not called"
type: issue
state: closed
author: DetachHead
labels: []
assignees: []
created_at: 2024-01-12T22:56:12Z
updated_at: 2025-02-17T07:46:30Z
url: https://github.com/astral-sh/ruff/issues/9499
synced_at: 2026-01-07T12:31:13-06:00
---

# `PLC2801` false positive when `__exit__` is not called

---

_Issue opened by @DetachHead on 2024-01-12 22:56_

i have a context manager that wraps another context manager, eg:
```py
from contextlib import AbstractContextManager

class Wrapped:
    def __init__(self, cm: AbstractContextManager[None]):
        self.cm = cm

    def __enter__(self):
        self.cm.__enter__() # PLC2801: Unnecessary dunder call to `__enter__`

    def __exit__(self):
        self.cm.__exit__(None, None, None)
```
[playground](https://play.ruff.rs/21829547-a469-480a-9335-e384a95ed6c2)

in this case, i can't replace the `__enter__` call with a `with` statement because `__exit__` is not called in the same place. ruff should be able to detect cases like this where `__enter__` is called on its own

---

_Comment by @charliermarsh on 2024-01-12 22:56_

I believe this is fixed by #9496

---

_Closed by @charliermarsh on 2024-01-12 22:56_

---

_Comment by @KotlinIsland on 2025-02-17 06:48_

@charliermarsh this is only resolved within dunder functions, i don't really understand why this is being reported for `__enter__` though:

```py
class A:
    def __enter__(self):
        print("i'm a side effect")

A().__enter__()  # Unnecessary dunder call to `__enter__`
```

i think it looks erroneous

i have a case where i have a unit test, and i need to `__enter__` an object, but not `__exit__` it, but ruff reports it as an unnecessary dunder call that should be removed

---

_Comment by @DetachHead on 2025-02-17 07:46_

i think in that case its still correct to report an error. you should never call `__enter__` without also calling `__exit__` in 99% of cases. i think the error message should be reworded though to something more like "call to `__enter__` is unsafe. use a `with` statement instead".

the current error message sounds like the call itself does nothing and should be removed, which is not the case.

---
