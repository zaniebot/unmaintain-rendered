---
number: 3511
title: "potential false positive with  `S107 Possible hardcoded password`"
type: issue
state: closed
author: Borda
labels: []
assignees: []
created_at: 2023-03-14T14:17:57Z
updated_at: 2023-05-11T02:54:29Z
url: https://github.com/astral-sh/ruff/issues/3511
synced_at: 2026-01-07T12:31:12-06:00
---

# potential false positive with  `S107 Possible hardcoded password`

---

_Issue opened by @Borda on 2023-03-14 14:17_

Hello, we were interested in enabling `S` (https://beta.ruff.rs/docs/rules/#flake8-bandit-s)
 check (https://beta.ruff.rs/docs/rules/#flake8-bandit-s) for our codebase https://github.com/Lightning-AI/metrics/pull/1616, but it seems it raises concerns about some simple hashes of `S107 Possible hardcoded password`, but `flake8-bandit` does not see them as issue so yeqa reoves them...

see output:
```
src/torchmetrics/functional/text/sacre_bleu.py:281:62: S107 Possible hardcoded password: "13a"
src/torchmetrics/functional/text/sacre_bleu.py:333:20: S105 Possible hardcoded password: "intl"
src/torchmetrics/text/sacre_bleu.py:89:66: S107 Possible hardcoded password: "13a"
src/torchmetrics/text/sacre_bleu.py:98:24: S105 Possible hardcoded password: "intl"
tests/unittests/text/test_bertscore.py:19:40: S105 Possible hardcoded password: "1"
```
ref: https://results.pre-commit.ci/run/github/323721661/1678802655.3OMtGaTPQ-a9cRvxN16V_A

---

_Comment by @Borda on 2023-03-14 14:18_

ok, issue was in `v0.0.252` and it seems it has been fixed with `v0.0.255`

---

_Closed by @Borda on 2023-03-14 14:18_

---

_Comment by @Borda on 2023-04-14 18:00_

using the latest 0.0.261 and have a few more cases:
- https://github.com/Lightning-AI/lightning/blob/cfab52af1c873b23564de8f150ce602e532d0d4f/tests/tests_app/cli/test_cmd_apps.py#L65
- https://github.com/Lightning-AI/lightning/blob/cfab52af1c873b23564de8f150ce602e532d0d4f/tests/tests_app/storage/test_path.py#L703
- https://github.com/Lightning-AI/lightning/blob/accd2b9e61063ba3c683764043030545ed87c71f/src/lightning/pytorch/profilers/profiler.py#L77
- https://github.com/Lightning-AI/lightning/blob/da883e73b941112aac7a538d71def6af2e83113b/tests/tests_app/runners/test_cloud.py#L525

---

_Reopened by @Borda on 2023-04-14 18:00_

---

_Referenced in [Lightning-AI/pytorch-lightning#17382](../../Lightning-AI/pytorch-lightning/pulls/17382.md) on 2023-04-14 18:12_

---

_Comment by @charliermarsh on 2023-04-14 18:36_

Ok cool, so those linked lines are raising `S107` with Ruff but not with Bandit?

---

_Comment by @Borda on 2023-04-14 21:21_

> Ok cool, so those linked lines are raising `S107` with Ruff but not with Bandit?

correct, in fact, they are raising three 105, 106 and 107

---

_Comment by @dhruvmanila on 2023-04-15 05:48_

I've copied the relevant code and tried running `bandit`. It gave me errors for all the listed code except for the second one. I used the default settings for running `bandit`:

<details>
<summary>Code used:</summary>

```python
ListLightningappInstancesResponse(
    next_page_token="page-2",
)

assert fs._mock_new_parent._mock_mock_calls[0].kwargs["secret"] == "d"


def _prepare_filename(
    self,
    action_name: Optional[str] = None,
    extension: str = ".txt",
    split_token: str = "-",
) -> str:
    pass


V1LightningBasicAuth(username="username", password="password")

```

</details>

<details>
<summary><code>bandit</code> output:</summary>

```
$ bandit ruff_test.py
[main]  INFO    profile include tests: None
[main]  INFO    profile exclude tests: None
[main]  INFO    cli include tests: None
[main]  INFO    cli exclude tests: None
[main]  INFO    running on Python 3.10.5
[node_visitor]  WARNING Unable to find qualified name for module: ruff_test.py
Run started:2023-04-15 05:45:59.374464

Test results:
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'page-2'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b106_hardcoded_password_funcarg.html
   Location: ruff_test.py:1:0
1       ListLightningappInstancesResponse(
2           next_page_token="page-2",
3       )
4
5       assert fs._mock_new_parent._mock_mock_calls[0].kwargs["secret"] == "d"

--------------------------------------------------
>> Issue: [B101:assert_used] Use of assert detected. The enclosed code will be removed when compiling to optimised byte code.
   Severity: Low   Confidence: High
   CWE: CWE-703 (https://cwe.mitre.org/data/definitions/703.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b101_assert_used.html
   Location: ruff_test.py:5:0
4
5       assert fs._mock_new_parent._mock_mock_calls[0].kwargs["secret"] == "d"
6

--------------------------------------------------
>> Issue: [B107:hardcoded_password_default] Possible hardcoded password: '-'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b107_hardcoded_password_default.html
   Location: ruff_test.py:8:0
7
8       def _prepare_filename(
9           self,
10          action_name: Optional[str] = None,
11          extension: str = ".txt",
12          split_token: str = "-",
13      ) -> str:
14          pass
15

--------------------------------------------------
>> Issue: [B106:hardcoded_password_funcarg] Possible hardcoded password: 'password'
   Severity: Low   Confidence: Medium
   CWE: CWE-259 (https://cwe.mitre.org/data/definitions/259.html)
   More Info: https://bandit.readthedocs.io/en/1.7.5/plugins/b106_hardcoded_password_funcarg.html
   Location: ruff_test.py:17:0
16
17      V1LightningBasicAuth(username="username", password="password")

--------------------------------------------------

Code scanned:
        Total lines of code: 12
        Total lines skipped (#nosec): 0

Run metrics:
        Total issues (by severity):
                Undefined: 0
                Low: 4
                Medium: 0
                High: 0
        Total issues (by confidence):
                Undefined: 0
                Low: 0
                Medium: 3
                High: 1
Files skipped (0):
```

</details>

So, I guess the bug is in the way detection happens for the second item. Please correct me if I'm wrong in any place :)

---

_Comment by @Borda on 2023-04-17 17:27_

I was running only ruff, and in my eyes, these are far from being password or any secret, so likely I would need to change the bandit setting, correct?

---

_Referenced in [astral-sh/ruff#4365](../../astral-sh/ruff/pulls/4365.md) on 2023-05-11 02:38_

---

_Closed by @charliermarsh on 2023-05-11 02:54_

---
