---
number: 1057
title: "[bug] ruff chokes when fixing invalid comparison (`F632`)"
type: issue
state: closed
author: smackesey
labels:
  - bug
assignees: []
created_at: 2022-12-05T13:13:33Z
updated_at: 2022-12-05T16:22:38Z
url: https://github.com/astral-sh/ruff/issues/1057
synced_at: 2026-01-07T12:31:12-06:00
---

# [bug] ruff chokes when fixing invalid comparison (`F632`)

---

_Issue opened by @smackesey on 2022-12-05 13:13_

This `F632`-triggering line (and several similar ones in our codebase) caused `ruff --fix` to choke:

```
type_check_fn=lambda _, value: isinstance(value, int) and value % 2 is 0,
```

Error message:

```
[2022-12-05][08:09:02][ruff::pyflakes::plugins::invalid_literal_comparisons][ERROR] Failed to fix invalid comparison: Failed to extract CST from source
```

Subsequent runs of `ruff --fix` print no error message but don't apply the fix either (though I think this is the cache? Running with `--no-cache` prints the error again).

---

_Renamed from "[bug] ruff chokes when fixing invalid comparison" to "[bug] ruff chokes when fixing invalid comparison (`F632`)" by @smackesey on 2022-12-05 13:14_

---

_Label `bug` added by @charliermarsh on 2022-12-05 14:05_

---

_Comment by @charliermarsh on 2022-12-05 14:09_

I wonder if the comma is being included in the lambda expression span, will check it out.

---

_Referenced in [astral-sh/ruff#1065](../../astral-sh/ruff/pulls/1065.md) on 2022-12-05 16:13_

---

_Closed by @charliermarsh on 2022-12-05 16:17_

---

_Comment by @charliermarsh on 2022-12-05 16:22_

This is going out in [v0.0.159](https://github.com/charliermarsh/ruff/releases/tag/v0.0.159) (building now).

---
