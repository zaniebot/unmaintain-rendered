---
number: 4230
title: Cascading per-file-ignores
type: issue
state: closed
author: nstarman
labels:
  - question
assignees: []
created_at: 2023-05-04T19:43:39Z
updated_at: 2023-05-19T16:17:02Z
url: https://github.com/astral-sh/ruff/issues/4230
synced_at: 2026-01-07T12:31:12-06:00
---

# Cascading per-file-ignores

---

_Issue opened by @nstarman on 2023-05-04 19:43_

In Astropy, for various reasons we want to separate our ruff config into `pyproject.toml`, where the "official" ruff config lives, and `.ruff.toml`, where we have our `ignore` list of things we intend to fix.
In the `.ruff.toml` we want to use `extend = "pyproject.toml"` to make this all work.
However, we've found that `per-file-ignores` don't seem to cascade, so only the config in `.ruff.toml` gets picked up.
I believe this is a bug, or I just haven't implemented `extend` correctly ðŸ˜†.

---

_Comment by @charliermarsh on 2023-05-04 19:45_

Two quick questions: Do you have different `per-file-ignores` defined in both, or only in the "parent" configuration? And are the configuration files in the same directory?

---

_Label `question` added by @charliermarsh on 2023-05-04 19:45_

---

_Comment by @nstarman on 2023-05-04 19:52_

We have it defined in both. In `pyproject.toml` are the permanent settings and in `.ruff.toml` we have the temporary settings related to the incremental nature of fixing an `ignore`. And yes, both config files are at the same directory level.

---

_Comment by @charliermarsh on 2023-05-04 20:07_

Ah okay, yeah we don't currently "merge" properties across configuration files, with the exception of the `extend-*` properties, like `extend-ignore`. So this is working as intended, though it'd be reasonable to suggest that it should be changed.


---

_Comment by @nstarman on 2023-05-04 20:12_

Ah, thanks for the clarification! Yes, some type of per-file-ignore merge would be excellent and very helpful to us!

---

_Comment by @aacunningham on 2023-05-04 22:21_

So would the idea be to create a new `extend-per-file-ignores` so that `per-file-ignore` still behaves as expected (like the rest of the non-merging settings)? Or maybe `per-file-ignores` makes sense to merge?

Out of curiosity, what's the benefit of the separate files as opposed to leaving it all in the `pyproject.toml` with a comment to differentiate the two sections of the `per-file-ignores` table (like `#Temporary ignores`)?

---

_Comment by @nstarman on 2023-05-04 22:46_

Either means is fine with us! Given that `extend-ignore` is deprecated, perhaps `per-file-ignores` should be allowed to cascade.

Separate files is useful for us ATM because of GH Codeowner auto PR review request settings while we work through the TODOs. Basically, we are working to move project configuration from setup.cfg to pyproject.toml and are looking to distinguish those PRs from ruff ones.

---

_Comment by @aacunningham on 2023-05-06 22:42_

Aight ya gotcha. Well I think implementing this seems pretty straightforward, I'd be down to give it a whirl. Making it cascade in the same way some of the other rules do makes sense, unless someone more knowledgeable of the project's has other ideas on this.

---

_Referenced in [astral-sh/ruff#4265](../../astral-sh/ruff/pulls/4265.md) on 2023-05-07 22:25_

---

_Closed by @charliermarsh on 2023-05-19 16:17_

---
