---
number: 1542
title: ERA001 skipping some lines
type: issue
state: closed
author: sbdchd
labels:
  - bug
assignees: []
created_at: 2023-01-02T00:39:26Z
updated_at: 2023-01-02T19:05:59Z
url: https://github.com/astral-sh/ruff/issues/1542
synced_at: 2026-01-07T12:31:12-06:00
---

# ERA001 skipping some lines

---

_Issue opened by @sbdchd on 2023-01-02 00:39_

I have the following code:


```python

def backfill(apps: Any, schema_editor: Any) -> None:
    """
    Create TimelineEvents for everything
    """
    db_alias = schema_editor.connection.alias

    Recipe = apps.get_model("recipeyak", "Recipe")
    TimelineEvent = apps.get_model("recipeyak", "TimelineEvent")

    # user_content_type, _ = TimelineEvent.objects.using(db_alias).get_or_create(
    #     app_label="core", model="user"
    # )
    timeline_events = []
    for recipe in Recipe.objects.using(db_alias).all():
        timeline_events.append(
            TimelineEvent(
                action="created", created_by=None, recipe=recipe, created=recipe.created
            )
        )
        if recipe.archived_at:
            timeline_events.append(
                TimelineEvent(
                    action="archived",
                    created_by=None,
                    recipe=recipe,
                    created=recipe.archived_at,
                )
            )
    TimelineEvent.objects.using(db_alias).bulk_create(timeline_events)
```

and the auto fix generates the following diff (which is missing a line):

```diff
diff --git a/backend/recipeyak/migrations/0089_backfill_timeline.py b/backend/recipeyak/migrations/0089_backfill_timeline.py
index 7c7bf670..4d99ae38 100644
--- a/backend/recipeyak/migrations/0089_backfill_timeline.py
+++ b/backend/recipeyak/migrations/0089_backfill_timeline.py
@@ -15,8 +15,6 @@ def backfill(apps: Any, schema_editor: Any) -> None:
     TimelineEvent = apps.get_model("recipeyak", "TimelineEvent")
 
     # user_content_type, _ = TimelineEvent.objects.using(db_alias).get_or_create(
-    #     app_label="core", model="user"
-    # )
     timeline_events = []
     for recipe in Recipe.objects.using(db_alias).all():
         timeline_events.append(
```

Edit: it's not the auto fix, I think the issue is it's not detecting the first line s commented out code

---

_Renamed from "ERA001 auto fix skipping some lines" to "ERA001 skipping some lines" by @sbdchd on 2023-01-02 00:49_

---

_Label `bug` added by @charliermarsh on 2023-01-02 02:21_

---

_Comment by @charliermarsh on 2023-01-02 02:25_

Does look like a bug. I have to look at the rules for detection to understand whatâ€™s going on. It might also be worth checking if the originating eradicate library catches those lines, but I can do that when I debug.

---

_Comment by @charliermarsh on 2023-01-02 18:55_

`eradicate` doesn't catch this either.

---

_Assigned to @charliermarsh by @charliermarsh on 2023-01-02 18:56_

---

_Referenced in [astral-sh/ruff#1559](../../astral-sh/ruff/pulls/1559.md) on 2023-01-02 19:05_

---

_Closed by @charliermarsh on 2023-01-02 19:05_

---
