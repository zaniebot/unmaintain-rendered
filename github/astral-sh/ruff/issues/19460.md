---
number: 19460
title: "FURB164 fix has two problems related to `Decimal.from_float`"
type: issue
state: closed
author: dscorbett
labels:
  - bug
  - fixes
assignees: []
created_at: 2025-07-21T12:40:34Z
updated_at: 2025-07-28T14:21:40Z
url: https://github.com/astral-sh/ruff/issues/19460
synced_at: 2026-01-07T12:31:13-06:00
---

# FURB164 fix has two problems related to `Decimal.from_float`

---

_Issue opened by @dscorbett on 2025-07-21 12:40_

### Summary

The fix for [unnecessary-from-float (FURB164)](https://docs.astral.sh/ruff/rules/unnecessary-from-float/) has two problems related to `Decimal.from_float`.

Fixing `Decimal.from_float` should be marked unsafe by default because `FloatOperation` could be trapped. It should only be marked safe when the argument to `Decimal.from_float` is known to be an `int` or `bool`, which never raise a signal. [Example](https://play.ruff.rs/fef2743d-cbf8-4960-8174-aca6c283ce65):
```console
$ cat >furb164_1.py <<'# EOF'
from decimal import Decimal, FloatOperation, getcontext
getcontext().traps[FloatOperation] = True
print(Decimal.from_float(0.1))
# EOF

$ python furb164_1.py
0.1000000000000000055511151231257827021181583404541015625

$ ruff --isolated check furb164_1.py --select FURB164 --preview --fix
Found 1 error (1 fixed, 0 remaining).

$ cat furb164_1.py
from decimal import Decimal, FloatOperation, getcontext
getcontext().traps[FloatOperation] = True
print(Decimal(0.1))

$ python furb164_1.py 2>&1 | tail -n 1
decimal.FloatOperation: [<class 'decimal.FloatOperation'>]
```

When the argument to `Decimal.from_float` is negative NaN, the fix should replace it with positive NaN to preserve the programâ€™s behavior. [Example](https://play.ruff.rs/9ac93a35-6395-4766-be06-26af9938879d):
```console
$ cat >furb164_2.py <<'# EOF'
from decimal import Decimal
print(Decimal.from_float(float(" -Nan\n")))
# EOF

$ python furb164_2.py
NaN

$ ruff --isolated check furb164_2.py --select FURB164 --preview --fix
Found 1 error (1 fixed, 0 remaining).

$ cat furb164_2.py
from decimal import Decimal
print(Decimal(" -Nan\n"))
# EOF

$ python furb164_2.py
-NaN
```

### Version

ruff 0.12.4 (ee2759b36 2025-07-17)

---

_Label `bug` added by @ntBre on 2025-07-21 13:15_

---

_Label `fixes` added by @ntBre on 2025-07-21 13:15_

---

_Referenced in [astral-sh/ruff#19468](../../astral-sh/ruff/pulls/19468.md) on 2025-07-21 15:57_

---

_Closed by @ntBre on 2025-07-28 14:21_

---

_Referenced in [astral-sh/ruff#19699](../../astral-sh/ruff/issues/19699.md) on 2025-08-01 21:52_

---
