---
number: 18354
title: Add exception to E501 for very long internal Sphinx references
type: issue
state: open
author: user27182
labels:
  - rule
  - needs-decision
assignees: []
created_at: 2025-05-28T15:49:22Z
updated_at: 2025-06-02T14:02:17Z
url: https://github.com/astral-sh/ruff/issues/18354
synced_at: 2026-01-07T12:31:13-06:00
---

# Add exception to E501 for very long internal Sphinx references

---

_Issue opened by @user27182 on 2025-05-28 15:49_

### Summary

Rule [E501](https://docs.astral.sh/ruff/rules/line-too-long/#line-too-long-e501) currently has exceptions for long URLs in docstrings (i.e. external references). I think this should also extend to internal references with Sphinx (docutils?).

E.g. this docstring should not be considered an E501 violation, but it currently is:
```
"""Sample docstring.

The following is a very long internal link that should be considered 
an exception to E501, similar to a URL:
:attr:`This is a very long custom title for an internal link <my_package.module1.module2.my_class.my_property>`
"""
```

---

_Comment by @user27182 on 2025-05-28 15:56_

For more context, here is a real-world use case using Numpydoc style which is an E501 violation (but IMO should not be):

https://github.com/pyvista/pyvista/blob/4286dcee002ad4ac88bb102a708b2fc8cc400040/pyvista/plotting/plotter.py#L2555-L2557
```
        edge_color : ColorLike, default: :attr:`pyvista.global_theme.edge_color <pyvista.plotting.themes.Theme.edge_color>`
            The solid color to give the edges when ``show_edges=True``.
            Either a string, RGB list, or hex color string.
```

---

_Label `rule` added by @ntBre on 2025-05-30 13:47_

---

_Comment by @MichaReiser on 2025-06-02 09:54_

I think this makes sense to support. For everyone else like me who's unfamiliar with sphinx's reference, this is the [documentation](https://docs.readthedocs.com/platform/latest/guides/cross-referencing-with-sphinx.html)

@user27182 I couldn't find any mention in the documentation but does sphinx allow line breaks inside the quoted part (the in-backticks ` part)

---

_Comment by @user27182 on 2025-06-02 13:58_

> I think this makes sense to support. For everyone else like me who's unfamiliar with sphinx's reference, this is the [documentation](https://docs.readthedocs.com/platform/latest/guides/cross-referencing-with-sphinx.html)
> 
> [@user27182](https://github.com/user27182) I couldn't find any mention in the documentation but does sphinx allow line breaks inside the quoted part (the in-backticks ` part)

I have seen this work with line breaks, yes, e.g. this should work and resolve properly as a link with Sphinx:

```
:attr:`This is a very long custom title for an internal link 
<my_package.module1.module2.my_class.my_property>`
```

So I guess if an exception to E501 is allowed for this,  the rule must check for either case, in case a link a a line break in it?

Also, I have found that using `\` to break a line is also supported by Sphinx for Numpydoc style docstrings to get around the line too long issue, e.g.:


``` diff
- render_points_as_spheres : bool, default: :attr:`pyvista.plotting.themes.Theme.render_points_as_spheres`
+ render_points_as_spheres : bool, \
+     default: :attr:`pyvista.plotting.themes.Theme.render_points_as_spheres`
```

This was successfully used (and the rendered HTML was confirmed to be correct) as part of this PR to enforce E501
https://github.com/pyvista/pyvista/pull/7551, though I could not find documentation about the use of `\` for this kind of line break


I think it would make sense to support either case as exceptions to E501, and not necessarily force users to add a line-break between the backticks or require adding a backslash.

---

_Label `needs-decision` added by @MichaReiser on 2025-06-02 14:02_

---
