---
number: 15857
title: RUF012 , not detecting the use of ClassVar
type: issue
state: closed
author: Sxderp
labels:
  - bug
assignees: []
created_at: 2025-01-31T17:22:59Z
updated_at: 2025-02-05T12:44:21Z
url: https://github.com/astral-sh/ruff/issues/15857
synced_at: 2026-01-07T12:31:13-06:00
---

# RUF012 , not detecting the use of ClassVar

---

_Issue opened by @Sxderp on 2025-01-31 17:22_

### Description

I'm running on Python3.9. I have the following code and RUFF spits out an error about RUF012. I think it may be related to #6267 and / or #12288 (since, I think, the future import makes all annotations strings?).

Ruff Version:  0.9.3

```python
"""ClassVar example."""

from __future__ import annotations

import typing


class Example():
    """Class that uses ClassVar."""

    options: ClassVar[dict[str, str]] = {}


if typing.TYPE_CHECKING:
    from typing import ClassVar
```

```
sample.py:11:41: RUF012 Mutable class attributes should be annotated with `typing.ClassVar`
   |
 9 |     """Class that uses ClassVar."""
10 |
11 |     options: ClassVar[dict[str, str]] = {}
   |                                         ^^ RUF012
   |

Found 1 error.
```

---

_Comment by @dylwil3 on 2025-01-31 18:08_

I think this is happening because the `if typing.TYPE_CHECKING: ...` block is _after_ the class definition, which is probably confusing the semantic model. The lint does not get emitted if you move that to the top after the imports. (Out of curiosity - is there any reason _not_ to put that at the top?)

---

_Label `bug` added by @dylwil3 on 2025-01-31 18:10_

---

_Comment by @Sxderp on 2025-01-31 19:28_

Coding style mostly. But we've also seen isort sometimes get confused with the typing block next to the other imports and we end up with strange things like:

```
import ..
import ..

if typing.TYPE_CHECKING:
  import ..

import ..
```

I'm not entirely sure why isort was recommending the above, but we decided the code looked overall cleaner by putting the block at the bottom and limiting the "from typing import x" statements to the block.

---

_Assigned to @dylwil3 by @dylwil3 on 2025-02-03 16:50_

---

_Referenced in [astral-sh/ruff#15921](../../astral-sh/ruff/pulls/15921.md) on 2025-02-04 01:46_

---

_Closed by @dylwil3 on 2025-02-05 12:44_

---
