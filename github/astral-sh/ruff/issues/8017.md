---
number: 8017
title: F401 false positive with PEP-695 upper bound specification
type: issue
state: closed
author: bryanforbes
labels:
  - bug
assignees: []
created_at: 2023-10-17T15:28:14Z
updated_at: 2023-10-18T01:50:27Z
url: https://github.com/astral-sh/ruff/issues/8017
synced_at: 2026-01-07T12:31:12-06:00
---

# F401 false positive with PEP-695 upper bound specification

---

_Issue opened by @bryanforbes on 2023-10-17 15:28_

Running the following command with Ruff `0.1.0`:

```
ruff --target-version py312 --select F401 --isolated --no-cache blah.py
```

Given the following code:

```python
from __future__ import annotations

from typing import TYPE_CHECKING

if TYPE_CHECKING:
    from collections.abc import Callable

    from .foo import Record

type RecordCallback[R: Record] = Callable[[R], None]


def process_record[R: Record](record: R) -> None:
    ...


class RecordContainer[R: Record]:
    def add_record(self, record: R) -> None:
        ...
```

`F401` is reported on line 8, but `Record` is being used in the upper bound specifications.

---

_Assigned to @charliermarsh by @charliermarsh on 2023-10-17 23:43_

---

_Label `bug` added by @charliermarsh on 2023-10-17 23:43_

---

_Comment by @charliermarsh on 2023-10-17 23:43_

Strange, will take a look.

---

_Comment by @charliermarsh on 2023-10-17 23:46_

This is a regression in the most recent release due to #7968.

---

_Referenced in [astral-sh/ruff#8033](../../astral-sh/ruff/pulls/8033.md) on 2023-10-18 01:23_

---

_Closed by @charliermarsh on 2023-10-18 01:50_

---
