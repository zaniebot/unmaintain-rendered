---
number: 14157
title: "[red-knot] Adapt the `fuzz-parser` script to fuzz red-knot too"
type: issue
state: closed
author: AlexWaygood
labels:
  - help wanted
  - testing
  - ty
assignees: []
created_at: 2024-11-07T15:08:22Z
updated_at: 2024-11-25T13:12:29Z
url: https://github.com/astral-sh/ruff/issues/14157
synced_at: 2026-01-07T12:31:13-06:00
---

# [red-knot] Adapt the `fuzz-parser` script to fuzz red-knot too

---

_Issue opened by @AlexWaygood on 2024-11-07 15:08_

We have a script here which proved very useful in discovering issues with our parser during the rewrite of the parser: https://github.com/astral-sh/ruff/tree/main/scripts/fuzz-parser. It generates random source-code snippets for Python that are guaranteed to be syntactically valid.

I think it wouldn't be too hard to adapt the script so that it can also run red-knot instead of just running the parser over the randomly generated source code. It might be quite useful for finding red-knot panics.

---

_Label `testing` added by @AlexWaygood on 2024-11-07 15:08_

---

_Label `red-knot` added by @AlexWaygood on 2024-11-07 15:08_

---

_Label `help wanted` added by @AlexWaygood on 2024-11-07 15:11_

---

_Referenced in [astral-sh/ruff#13778](../../astral-sh/ruff/issues/13778.md) on 2024-11-14 14:51_

---

_Comment by @connorskees on 2024-11-24 20:06_

As part of this work, would it make sense to add support to red-knot for type checking files read from stdin? Right now red-knot assumes that it's parsing workspaces from the file system, and doesn't seem to support ad hoc type checking of individual files. For fuzzing this would be helpful, as it avoids the overhead of reading and writing to the file system in a hot loop.

---

_Comment by @MichaReiser on 2024-11-24 20:47_

> As part of this work, would it make sense to add support to red-knot for type-checking files read from stdin? 

Possibly, although I would prefer waiting to add stdin support until we have a clearer picture on how red-knots CLI should look like (should it even support paths)

---

_Referenced in [astral-sh/ruff#14566](../../astral-sh/ruff/pulls/14566.md) on 2024-11-24 22:37_

---

_Closed by @AlexWaygood on 2024-11-25 13:12_

---
