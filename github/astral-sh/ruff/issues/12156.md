---
number: 12156
title: "[flake8-bugbear] Avoid false positive for usage `return None` (B901)"
type: issue
state: closed
author: f4rk4sh
labels:
  - question
  - rule
assignees: []
created_at: 2024-07-02T20:36:40Z
updated_at: 2024-07-04T18:13:28Z
url: https://github.com/astral-sh/ruff/issues/12156
synced_at: 2026-01-07T12:31:13-06:00
---

# [flake8-bugbear] Avoid false positive for usage `return None` (B901)

---

_Issue opened by @f4rk4sh on 2024-07-02 20:36_

A minimal code snippet that reproduces the bug is almost the same as [here](https://github.com/astral-sh/ruff/commit/312f6640b837eb1189748980707cfed70d1f5ffb#diff-3da9dc4c996fc465b80db3e323994049105aa08d73a56f50a4991481408f90e4R16) but with explicit `return None`:

```python
def not_broken():
        if True:
            return None

        yield 3
        yield 2
        yield 1
```

The false positive:

```sh
B901 Using `yield` and `return {value}` in a generator function can lead to confusing behavior
   |
64 |     def not_broken():
65 |         if True:
66 |             return None
   |             ^^^^^^^^^^^ B901
67 | 
68 |         yield 3
   |

Found 1 error.
```

The command invoked:

```yaml
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.5.0
    hooks:
      - id: ruff
        args: ["--fix", "--exit-non-zero-on-fix", "--preview"]
```


---

_Comment by @charliermarsh on 2024-07-02 20:37_

Can you remind me, why is this _not_ a problem?

---

_Comment by @f4rk4sh on 2024-07-02 20:57_


```python
def a():
    return
``` 
returns `None` implicitly.

```python
def b()
    return None
```

returns `None` explicitly.

Both `return` and `return None` will make the function return `None`. `return None` may be preferred for code clarity or if returned `None` is used later in the code.

Since using `return` (without `None`) is "marked" as [not_broken](https://github.com/astral-sh/ruff/commit/312f6640b837eb1189748980707cfed70d1f5ffb#diff-3da9dc4c996fc465b80db3e323994049105aa08d73a56f50a4991481408f90e4R16) I assume it would be good to cover `retrun None` too.

More details can be found [here](https://stackoverflow.com/a/15300671/17693820).

---

_Comment by @charliermarsh on 2024-07-02 20:58_

Thank you. I was mostly trying to remember why the implicit `return` is considered ok in the first place.

---

_Comment by @zanieb on 2024-07-02 21:31_

I think the idea is that `return` is a valid way to stop iteration

> In Python 3 return {value} can be used in a generator; however, the combination of yield and return can lead to confusing behavior, as the return statement will cause the generator to raise StopIteration with the value provided, rather than returning the value to the caller.

I actually think the rule is fine here, i.e.,`return None` doesn't feel like a false positive because it is misleading as the rule is intended to flag.

---

_Label `question` added by @zanieb on 2024-07-02 21:32_

---

_Label `rule` added by @zanieb on 2024-07-02 21:32_

---

_Comment by @charliermarsh on 2024-07-04 18:13_

Ah thank you. I think I agree -- this seems like a reasonable thing to flag.

---

_Closed by @charliermarsh on 2024-07-04 18:13_

---
