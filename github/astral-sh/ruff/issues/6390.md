---
number: 6390
title: Formatting of end-of-line comments in empty parentheses
type: issue
state: closed
author: konstin
labels:
  - formatter
assignees: []
created_at: 2023-08-07T14:14:07Z
updated_at: 2023-08-16T07:11:17Z
url: https://github.com/astral-sh/ruff/issues/6390
synced_at: 2026-01-07T12:31:12-06:00
---

# Formatting of end-of-line comments in empty parentheses

---

_Issue opened by @konstin on 2023-08-07 14:14_

A challenge we have wrt to black compatibility and formatter stability is the formatting of dangling end-of-line comments in empty parentheses such as `()` (empty tuple) `f()`, `[]`, `{}`, etc.

Given we have the following
```python
x = ( #
)
```

do we want this to be formatted 

as (1) keep it end-of-line (closest to the original)/ the non-invasive way 
```python
x = ( #
)
```
or as (2) make it an own line comment (because it's meant as a placeholder element, so treat it as an element) / the semantic way
```python
x = (
    #
)
```
or as (3) move it to the end of line out of all expressions / the black way
```python
x = () #
```

The case above is simple, it's more complex with nested expressions, e.g.
```python
x = f(  # a
        g( # b
        )
    )
```

which black formats as
```python
x = f(g())  # a  # b
```

and
```python
x = () - (#
)
```

The latter is important for formatter stability, because currently an end-of-line comment expands the parent which can lead to extraneous parentheses and unstable formatting (https://github.com/astral-sh/ruff/pull/6386) 


---

_Label `formatter` added by @konstin on 2023-08-07 14:14_

---

_Comment by @charliermarsh on 2023-08-07 14:21_

Relatedly: https://github.com/astral-sh/ruff/pull/6389.

---

_Comment by @konstin on 2023-08-07 14:37_

Prettier:
```js
a = { // hi
}

b = { // hi
    c: 1 
}
```
to 
```js
a = {
  // hi
};

b = {
  // hi
  c: 1,
};
```

Dart format:
```dart
void main() {
  int a = f(// 1
      );
  int b = f(
      // 2
      );

  int c = g(// 3
      1);
}
```

---

_Comment by @MichaReiser on 2023-08-08 07:35_

To use the same syntax nodes across formatters: 

### Prettier

```javascript
a = f(// 1
    );
b = f(
    // 2
    );

c = g(// 3
    1);

// Formatted to

a =
  f(); // 1
b =
  f();
  // 2

c = g(
  // 3
  1,
);
```

### Rust

```rust
let a = f(// 1
);
let b = f(
    // 2
);

c = g(// 3
      1);


// Formatted
let a = f(// 1
);
let b = f(
    // 2
);

let c = g(
    // 3
    1,
);
```

Moves the comment `// 3` to a new line. 

---

_Referenced in [astral-sh/ruff#6420](../../astral-sh/ruff/pulls/6420.md) on 2023-08-08 09:01_

---

_Referenced in [astral-sh/ruff#6485](../../astral-sh/ruff/pulls/6485.md) on 2023-08-14 18:55_

---

_Assigned to @charliermarsh by @charliermarsh on 2023-08-15 03:19_

---

_Closed by @charliermarsh on 2023-08-15 18:59_

---

_Added to milestone `Formatter: Alpha` by @MichaReiser on 2023-08-16 07:11_

---
