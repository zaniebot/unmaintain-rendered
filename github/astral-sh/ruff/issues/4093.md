---
number: 4093
title: Using ruff check diff suppresses errors
type: issue
state: closed
author: aminalaee
labels:
  - cli
assignees: []
created_at: 2023-04-25T11:05:20Z
updated_at: 2024-02-01T06:49:26Z
url: https://github.com/astral-sh/ruff/issues/4093
synced_at: 2026-01-07T12:31:12-06:00
---

# Using ruff check diff suppresses errors

---

_Issue opened by @aminalaee on 2023-04-25 11:05_

Hey, thanks for the great work.
I don't know if this is a bug or maybe unclear flag, but doing `ruff check --diff .` does not fail:

```py
try:
    pass
except:
    pass
```

But running `ruff check .` shows proper errors:

```
E722 Do not use bare `except`
```

Is this expected? I didn't expect `--diff` to have this side-effect, maybe the help is not clear?

---

_Referenced in [encode/httpx#2680](../../encode/httpx/pulls/2680.md) on 2023-04-25 11:09_

---

_Comment by @JonathanPlasse on 2023-04-25 11:58_

If the [help of the CLI](https://beta.ruff.rs/docs/configuration/#command-line-interface) you can find
> `--diff` Avoid writing any fixed files back; instead, output a diff for each changed file to stdout

`--diff` is to be used in conjunction with `--fix`.
Without `--fix`, it will always return nothing with exit code 0.

---

_Comment by @aminalaee on 2023-04-25 12:02_

Thanks for the clarification, that makes more sense now.
Maybe it might be a good idea to force this combination since without one it's not really doing much.

---

_Closed by @aminalaee on 2023-04-25 12:02_

---

_Comment by @dhruvmanila on 2023-04-25 13:11_

I think updating the `--help` text to include this would help. Better option would be to exit with an appropriate message stating the usage of the flag (`--diff` is to be used in conjunction with `--fix` flag).

---

_Reopened by @aminalaee on 2023-04-25 13:14_

---

_Comment by @aminalaee on 2023-04-25 13:14_

I just opened this so the maintainers can decide if it needs any action.
Thanks for the info.

---

_Comment by @charliermarsh on 2023-04-25 15:13_

@dhruvmanila - Agreed, would be nice if we could exit with a meaningful error there.

---

_Label `cli` added by @charliermarsh on 2023-04-25 15:13_

---

_Referenced in [astral-sh/ruff#4098](../../astral-sh/ruff/pulls/4098.md) on 2023-04-25 17:58_

---

_Closed by @charliermarsh on 2023-04-26 03:19_

---

_Comment by @odie5533 on 2024-02-01 06:23_

Is there an option to output both diffs it could make as well as errors that don't have fixes? It would be useful for me to output all errors + all fixes and return code 1 if there are any.

---

_Comment by @zanieb on 2024-02-01 06:49_

Hey @odie5533 that should become the default `ruff check` behavior after #7352 â€” it's on our roadmap!

---

_Referenced in [astral-sh/ruff#7352](../../astral-sh/ruff/issues/7352.md) on 2024-03-30 10:18_

---

_Referenced in [apple/pfl-research#111](../../apple/pfl-research/pulls/111.md) on 2025-02-05 15:48_

---
