---
number: 5960
title: "`PGH003` doesn't detect violation if another suppression on that line does include a code"
type: issue
state: closed
author: tylerlaprade
labels: []
assignees: []
created_at: 2023-07-22T00:28:49Z
updated_at: 2023-07-23T17:18:27Z
url: https://github.com/astral-sh/ruff/issues/5960
synced_at: 2026-01-07T12:31:12-06:00
---

# `PGH003` doesn't detect violation if another suppression on that line does include a code

---

_Issue opened by @tylerlaprade on 2023-07-22 00:28_

The following code should be considered invalid because `# pyright: ignore` does not have a code. However, because `# noqa` has a code, the line doesn't get flagged.
```
secret_cache_item = self.cache_secrets_manager._get_cached_secret(self.secret_id)  # pyright: ignore # noqa[SLF001]
```
If I change it to
```
secret_cache_item = self.cache_secrets_manager._get_cached_secret(self.secret_id)  # pyright: ignore
```
then `PGH003` does fire (as well as `SLF001`, of course.

The correct behavior is that only
```
secret_cache_item = self.cache_secrets_manager._get_cached_secret(self.secret_id) # pyright: ignore[reportPrivateUsage] # noqa[SLF001]
```
should be considered valid.

It's worth noting that `# noqa` is _not_ recognized by Pyright, as it's a linter directing, not a type-checking one.

---

_Comment by @charliermarsh on 2023-07-22 13:45_

I think the issue here is that you have an invalid `noqa` code, so the PGH003 error is getting suppressed.

This works as expected:

```python
secret_cache_item = self.cache_secrets_manager._get_cached_secret(self.secret_id)  # pyright: ignore # noqa: SLF001
```

---

_Comment by @charliermarsh on 2023-07-22 13:46_

`# noqa[SLF001]` is treated as equivalent to `# noqa` (blanket ignore). We can probably warn on that.

---

_Referenced in [astral-sh/ruff#5982](../../astral-sh/ruff/pulls/5982.md) on 2023-07-22 14:02_

---

_Closed by @charliermarsh on 2023-07-22 14:16_

---

_Comment by @tylerlaprade on 2023-07-23 17:18_

Incidentally, I confirmed that both halves of this problem are fixed in the preview version:
<img width="920" alt="image" src="https://github.com/astral-sh/ruff/assets/5475199/cccaf024-55ab-444e-9d10-2e84ae7502b8">


---
