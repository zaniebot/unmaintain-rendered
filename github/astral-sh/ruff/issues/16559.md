---
number: 16559
title: FURB164 fix does not consistently simplify expressions containing non-finite float strings
type: issue
state: open
author: dscorbett
labels:
  - rule
  - wish
assignees: []
created_at: 2025-03-07T20:39:04Z
updated_at: 2025-03-14T08:26:34Z
url: https://github.com/astral-sh/ruff/issues/16559
synced_at: 2026-01-07T12:31:13-06:00
---

# FURB164 fix does not consistently simplify expressions containing non-finite float strings

---

_Issue opened by @dscorbett on 2025-03-07 20:39_

### Summary

[unnecessary-from-float (FURB164)](https://docs.astral.sh/ruff/rules/unnecessary-from-float/) does not consistently simplify expressions containing non-finite float strings. This is similar to #14587. A non-finite float string can having leading or trailing white space. It can also have an otiose sign: `+inf`, `+nan`, or `-nan`. FURB164 only recognizes strings without these extras. It should treat them the same and fix all or none of them.

```console
$ cat >furb164.py <<'# EOF'
from decimal import Decimal
Decimal.from_float(float("\n+nan\n"))
Decimal.from_float(float("\xa0-nan\u3000"))
Decimal.from_float(float(" +inf "))
# cf.:
Decimal.from_float(float("nan"))
Decimal.from_float(float("-inf"))
# EOF

$ ruff --isolated check --preview --select FURB164 furb164.py --fix
Found 5 errors (5 fixed, 0 remaining).

$ cat furb164.py
from decimal import Decimal
Decimal(float("\n+nan\n"))
Decimal(float("\xa0-nan\u3000"))
Decimal(float(" +inf "))
# cf.:
Decimal("nan")
Decimal("-inf")
```

For those first three examples, the fix should produce:
```python
Decimal("\n+nan\n")
Decimal("\xa0nan\u3000")
Decimal(" +inf ")
```
Note that the sign should be removed from `-nan`. Otherwise, the strings stay the same.

Alternatively, the removal of the `float` call could be considered out of scope for this rule because [verbose-decimal-constructor (FURB157)](https://docs.astral.sh/ruff/rules/verbose-decimal-constructor/) already handles it. In that case, FURB164 should convert `Decimal.from_float(float("nan"))` (for example) to `Decimal(float("nan"))` instead of simplifying it to `Decimal("nan")`.

### Version

ruff 0.9.10 (0dfa810e9 2025-03-07)

---

_Label `bug` added by @ntBre on 2025-03-07 21:16_

---

_Label `bug` removed by @MichaReiser on 2025-03-14 08:26_

---

_Label `rule` added by @MichaReiser on 2025-03-14 08:26_

---

_Label `wish` added by @MichaReiser on 2025-03-14 08:26_

---
