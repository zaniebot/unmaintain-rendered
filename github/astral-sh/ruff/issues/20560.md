---
number: 20560
title: "`ruff check --show-settings` does not adhere to `.ruff.toml` schema"
type: issue
state: closed
author: topoinix
labels: []
assignees: []
created_at: 2025-09-24T20:26:01Z
updated_at: 2025-09-25T08:06:36Z
url: https://github.com/astral-sh/ruff/issues/20560
synced_at: 2026-01-07T12:31:13-06:00
---

# `ruff check --show-settings` does not adhere to `.ruff.toml` schema

---

_Issue opened by @topoinix on 2025-09-24 20:26_

[.ruff.toml.txt](https://github.com/user-attachments/files/22522407/default.ruff.toml.txt)
[ruff-check-show-settings.txt](https://github.com/user-attachments/files/22522406/ruff-check-show-settings.txt)

## Summary

The output of the command `ruff check --show-settings` resembles a `.ruff.toml` file (when reformatted using bare keys). Despite the close resemblance, it does not form a valid `TOML` file, and it cannot be used to configure `Ruff`. This could be confusing if one tries to rely on this output when modifying `Ruff`'s configuration file, e.g. if they want to start with a full template with default (or resolved) configuration settings.

[#9464][9464] has improved the output of the above command a lot. Still, given this [comment][9464-comment], it seems that producing a valid `.ruff.toml` file was not its aim. Subject to minor modifications, mentioned below, most of the reported settings could be adjusted to adhere to the `.ruff.toml` schema. A few would require more involved restructuring.

I was wondering whether there are some intentional reasons for this disparity, and whether you would be open to change or consider a proposal to address (some of) these inconsistencies that make it difficult to effectively use the output of the command.

## Version

ruff 0.13.1

## Details

This disparity seems to stem from the fact that `ruff check --show-settings` displays the resolved [`settings::Settings`][settings-struct], whereas the configuration files are deserialised into [`options::Options`][options-struct], and both structures have different fields, and so do some of their field types.

There are a few distinct issues that lead to this disparity:

1. `settings::Settings` displays settings using `snake_case`, but `options::Options` errors when `snake_case` is used. It requires `kebab-case`. 

2. `settings::Settings` uses `formatter` and `linter`, whereas `options::Options` uses `format` and `lint`, respectively.

3. `settings::Settings` is displayed using dotted keys, whereas the configuration file requires bare or quoted [keys][toml-keys] in [tables][toml-tables]. 

Addressing these first three issues results in ~68% of the configuration keys (~75% of reported keys) adhering to the schema.

4. Inconsistent field names. For instance:

- [`rules::flake8_gettext::settings::Settings`][flake8_gettext_settings] and [`options::Flake8GetTextOptions`][flake8_gettext_options] use  inconsitent  names for corresponding fields:

| `Settings`           | `Flake8GetTextOptions`    |
|----------------------|---------------------------|
| `functions_names`    | `function_names`   |

- and so does [`rules::flake8_type_checking::settings::Settings`][flake8_type_checking_settings] and [`options::Flake8TypeCheckingOptions`][flake8_type_checking_options]:

| `Settings`                       | `Flake8TypeCheckingOptions`       |
|----------------------------------|-----------------------------------|
| `runtime_required_base_classes`  | `runtime_evaluated_base_classes`  |
| `runtime_required_decorators`    | `runtime_evaluated_decorators`    |

5. Some configuration fields are nested differently in the two structures. For instance, some fields of `options::Options` are included in `settings::Settings` through a substructure. For instance,
   - `exclude` appears as `file_resolver.exclude`
   - `builtins` appears as `lint.builtins`
   - `target-version` appears as `analyze.target_version`

6. Some configuration fields accepted by `.ruff.toml` are not reported by `ruff check --show-settings`. For instance, the section
   `[lint.pylint]` accepts the key `max-nested-blocks`, which is not reported.

7. Also, values need to be formatted to result in valid `TOML`, e.g. [strings][toml-string] should be quoted and regular expression patterns escaped.

## Discussion

In terms of quantity, most of the inconsistencies seem straightforward to fix. On the other hand, issues listed under points 5 and 6 seem to require restructuring, flattening the `settings::Settings` structure or modifying the configuration API (possibly allowing for backward compatibility). It would be good to know if the maintainers have any preference.

I am attaching the keys reported by the above command and those accepted by `.ruff.toml` (both renamed in line with the first three points and presented in dotted key format to simplify comparison).

Thank you for your consideration!

## Related issues and pull requests

- [![GitHub issue/pull request detail](https://img.shields.io/github/issues/detail/title/astral-sh/ruff/8334?logo=github)](https://github.com/astral-sh/ruff/issues/8334)

- [![GitHub issue/pull request detail](https://img.shields.io/github/issues/detail/title/astral-sh/ruff/9464?logo=github)](https://github.com/astral-sh/ruff/pull/9464)

[8334]: https://github.com/astral-sh/ruff/issues/8334
[9464]: https://github.com/astral-sh/ruff/pull/9464
[9464-comment]: https://github.com/astral-sh/ruff/pull/9464#pullrequestreview-1815926526_
[settings-struct]: https://github.com/astral-sh/ruff/blob/09f570af9271168cfca11388c33d5182168e1b4c/crates/ruff_workspace/src/settings.rs#L21-L40
[options-struct]: https://github.com/astral-sh/ruff/blob/09f570af9271168cfca11388c33d5182168e1b4c/crates/ruff_workspace/src/options.rs#L41-L460
[toml-keys]: https://toml.io/en/v1.0.0#keys
[toml-tables]: https://toml.io/en/v1.0.0#table
[toml-string]: https://toml.io/en/v1.0.0#string
[flake8_gettext_settings]: https://github.com/astral-sh/ruff/blob/09f570af9271168cfca11388c33d5182168e1b4c/crates/ruff_linter/src/rules/flake8_gettext/settings.rs#L6-L9
[flake8_gettext_options]: https://github.com/astral-sh/ruff/blob/09f570af9271168cfca11388c33d5182168e1b4c/crates/ruff_workspace/src/options.rs#L1449-L1472
[flake8_type_checking_settings]: https://github.com/astral-sh/ruff/blob/09f570af9271168cfca11388c33d5182168e1b4c/crates/ruff_linter/src/rules/flake8_type_checking/settings.rs#L7-L14
[flake8_type_checking_options]: https://github.com/astral-sh/ruff/blob/09f570af9271168cfca11388c33d5182168e1b4c/crates/ruff_workspace/src/options.rs#L2053-L2182


---

_Comment by @MichaReiser on 2025-09-25 08:06_

Thanks for the detailed write-up.

It's intentional that the `--show-settings` output doesn't resemble `.ruff.toml` because it isn't always a 1:1 mapping between configuration field and resolved value. You noted that some settings would require significant restructuring. Those structure differences are intentional: `Settings` is designed so that Ruff can look up the relevant values as fast as possible. 

>  [lint.pylint] accepts the key max-nested-blocks, which is not reported.

This is a bug

---

_Closed by @MichaReiser on 2025-09-25 08:06_

---

_Referenced in [astral-sh/ruff#20574](../../astral-sh/ruff/pulls/20574.md) on 2025-09-25 13:50_

---
