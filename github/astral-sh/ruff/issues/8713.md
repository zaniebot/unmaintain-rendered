---
number: 8713
title: Support multi-level member imports in fixes
type: issue
state: open
author: charliermarsh
labels:
  - bug
assignees: []
created_at: 2023-11-16T04:14:27Z
updated_at: 2023-12-01T01:58:35Z
url: https://github.com/astral-sh/ruff/issues/8713
synced_at: 2026-01-07T12:31:12-06:00
---

# Support multi-level member imports in fixes

---

_Issue opened by @charliermarsh on 2023-11-16 04:14_

```
ruff  *.py --select TRIO115 --no-cache --fix --unsafe-fixes --preview --isolated
```

file content:
```
from trio import Event, sleep
class _RouteMethod(Enum):
    def __init__(self, token: str):
        self._headers = {
        }
    async def request(
    ):
            try:
                        if bool(resp.headers.get("X-RateLimit-Global")):
                            logger.warning(
                        )
                        await sleep(reset_after)
            except OSError as err:
                    await sleep(5)
```

error
```
/home/rafal/test/tmp_folder/F_NAME_9541977883458822252.py:12:31: TRIO115 Use `trio.lowlevel.checkpoint()` instead of `trio.sleep(0)`
Found 1 error.
[*] 1 fixable with the --fix option.

error: Fix introduced a syntax error in `/home/rafal/test/tmp_folder/F_NAME_9541977883458822252.py` with rule codes TRIO115: invalid syntax. Got unexpected token '.' at byte offset 39
---
from trio import Event, sleep, lowlevel.checkpoint
class _RouteMethod(Enum):
    def __init__(self, token: str):
        self._headers = {
        }
    async def request(
    ):
            try:
                        if bool(resp.headers.get("X-RateLimit-Global")):
                            logger.warning(
                        )
                        await lowlevel.checkpoint
            except OSError as err:
                    await sleep(5)
---
```
[python_compressed.zip](https://github.com/astral-sh/ruff/files/13353656/python_compressed.zip)

_Originally posted by @qarmin in https://github.com/astral-sh/ruff/issues/8402#issuecomment-1810838129_
            

---

_Assigned to @charliermarsh by @charliermarsh on 2023-11-16 04:14_

---

_Label `bug` added by @charliermarsh on 2023-11-16 04:14_

---

_Comment by @dhruvmanila on 2023-12-01 01:03_

@charliermarsh Have you looked at this? Otherwise I can give it a look, seems like an easy fix :)

---

_Unassigned @charliermarsh by @charliermarsh on 2023-12-01 01:25_

---

_Comment by @charliermarsh on 2023-12-01 01:26_

@dhruvmanila - No, feel free! I don't know how hard or easy it is -- it likely requires some kind of iteration within the `Importer`.

---

_Referenced in [astral-sh/ruff#8933](../../astral-sh/ruff/pulls/8933.md) on 2023-12-01 01:37_

---

_Comment by @dhruvmanila on 2023-12-01 01:40_

Hmm, not sure where does this import come from: `from trio import Event, sleep, lowlevel.checkpoint` as for me it's always `from trio import Event, sleep, lowlevel`.

---

_Closed by @dhruvmanila on 2023-12-01 01:42_

---

_Comment by @dhruvmanila on 2023-12-01 01:44_

Oh, the import was a bug in `v0.1.5` which was fixed in `v0.1.6`.

---

_Comment by @charliermarsh on 2023-12-01 01:57_

I fixed this specific case, but it doesn't always do the optimal thing.

---

_Reopened by @charliermarsh on 2023-12-01 01:57_

---

_Comment by @charliermarsh on 2023-12-01 01:58_

For example, if the user has `import trio.lowlevel`, I don't think we leverage the fact that we can do `trio.lowlevel.checkpoint`.

---
