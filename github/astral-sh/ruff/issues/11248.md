---
number: 11248
title: "Workspace edits from `ruff server` commands occasionally fail in VS Code when operating on an yet-to-be-created file"
type: issue
state: closed
author: snowsignal
labels:
  - bug
  - server
assignees: []
created_at: 2024-05-02T17:18:30Z
updated_at: 2024-06-03T20:19:54Z
url: https://github.com/astral-sh/ruff/issues/11248
synced_at: 2026-01-07T12:31:13-06:00
---

# Workspace edits from `ruff server` commands occasionally fail in VS Code when operating on an yet-to-be-created file

---

_Issue opened by @snowsignal on 2024-05-02 17:18_

Steps to reproduce:

1. Disable VS Code auto-save.
2. Add `ALL` to the `select` setting in the extension
3. Create a new `.py` file, but don't save it yet.
4. Add this code to the file:
```py
import foo

def bar():
    unused = 4

```
5. Using the command palette (Ctrl/Cmd+Shift+P), repeatedly run `ruff.applyAutofix`.
6. The second time you run `applyAutofix`, you should see an error about a workspace edit that couldn't be applied.

---

_Label `bug` added by @snowsignal on 2024-05-02 17:18_

---

_Label `server` added by @snowsignal on 2024-05-02 17:18_

---

_Assigned to @snowsignal by @snowsignal on 2024-05-02 17:18_

---

_Referenced in [astral-sh/ruff#11206](../../astral-sh/ruff/pulls/11206.md) on 2024-05-14 06:22_

---

_Comment by @T-256 on 2024-05-28 22:47_

I can't repro this in v0.4.5. If you are still able to repro this, could you also provide the logs?

---

_Comment by @snowsignal on 2024-06-03 20:19_

@T-256 I think this was fixed in https://github.com/astral-sh/ruff/pull/11206. ðŸ˜„ 

The only caveat is that this fix involve omitting document versions from workspace edits, which I would like to add back eventually.

---

_Closed by @snowsignal on 2024-06-03 20:19_

---

_Referenced in [astral-sh/ruff#11730](../../astral-sh/ruff/issues/11730.md) on 2024-06-04 06:11_

---
