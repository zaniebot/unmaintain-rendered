---
number: 17361
title: "[red-knot] Incorrect type narrowing on homogeneous tuple of literals"
type: issue
state: closed
author: JelleZijlstra
labels: []
assignees: []
created_at: 2025-04-11T18:17:55Z
updated_at: 2025-04-11T18:21:17Z
url: https://github.com/astral-sh/ruff/issues/17361
synced_at: 2026-01-07T12:31:13-06:00
---

# [red-knot] Incorrect type narrowing on homogeneous tuple of literals

---

_Issue opened by @JelleZijlstra on 2025-04-11 18:17_

### Summary

https://playknot.ruff.rs/5cb0d1b2-81ee-4acd-945a-6a5e124b7204

```
from typing import Literal, reveal_type

def f(x: tuple[Literal[1, 2], ...], y: Literal[1, 2, 3]):
    if y in (1, 2):
        reveal_type(y)  # Literal[1, 2]
    else:
        reveal_type(y)  # Literal[3]
```
The narrowing in the negative case here is incorrect, since `x` could be `()` or `(1,)`.

### Version

_No response_

---

_Comment by @JelleZijlstra on 2025-04-11 18:19_

Pedantically the positive-case narrowing is also incorrect since `x` could be a subclass of `tuple` that overrides `__contains__` in a weird way. I feel like we can ignore that case, though.

---

_Comment by @MatthewMckee4 on 2025-04-11 18:20_

You don't use `x` in this function though?

---

_Comment by @JelleZijlstra on 2025-04-11 18:21_

Wait indeed, I was confused trying different versions. Sorry for the noise!

---

_Closed by @JelleZijlstra on 2025-04-11 18:21_

---
