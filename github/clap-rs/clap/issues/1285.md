---
number: 1285
title: "Question: how to extract {flags, opts, subcommands, ...}"
type: issue
state: closed
author: yoshuawuyts
labels:
  - E-hard
  - A-completion
assignees: []
created_at: 2018-06-03T12:41:00Z
updated_at: 2020-04-11T16:43:25Z
url: https://github.com/clap-rs/clap/issues/1285
synced_at: 2026-01-07T12:31:16-06:00
---

# Question: how to extract {flags, opts, subcommands, ...}

---

_Issue opened by @yoshuawuyts on 2018-06-03 12:41_

Heya :wave:,

I was wondering what the recommended approach is to extract the currently used flags, subcommands, opts (and similar).

My goal is to generate man pages from a Clap struct, with the short versions and descriptions included. I've tried `app.write_long_help()`, but having to parse strings using regexes seems a bit wasteful.

I've also been digging into Clap's (undocumented) internals but given it's all undocumented, I take it that it might not have any stability guarantees.

## Current Best Approach I've Found
```rust
#[macro_use]
extern crate structopt;

use structopt::StructOpt;

mod cli;

fn main() {
  let mut app = cli::Opts::clap();
  let mut stdout = std::io::stdout();
  app.write_long_help(&mut stdout).unwrap();   // We need to run this first.
  for f in app.p.flags() {
    println!("flag {:?}", &f);                 // Otherwise this doesn't work.
  }
}
```

So umm, to make these questions a bit more concrete:

## Concrete Questions
- What's going on in `app.write_long_help` that provisions `app.p.flags()` with its contents?
- Is there a better way to extract flags than what we're currently doing?
- If there currently isn't a better way, could we perhaps add an interface to access this information?

---

I hope these questions make sense. Thanks so much for your time! :sparkles:

---

_Referenced in [rust-cli/team#23](../../rust-cli/team/issues/23.md) on 2018-06-03 12:43_

---

_Referenced in [rust-cli/team#38](../../rust-cli/team/issues/38.md) on 2018-06-03 21:57_

---

_Comment by @kbknapp on 2018-06-04 21:15_

This is actually a goal of 3.x! So if you'd like to work on this problem set on the v3-master branch it would be HIGHLY appreciated! 

The v3-master branch is quite different from the current master branch (i.e. v2) in that you iterate the subcommands and args directly and not through a `Parser` facade. 

In the v3-master branch you'd use macros (`flags!`, `opts!`, `subcommands!`, `positionals!` etc.) which have already been defined.

---

_Label `T: new feature` added by @kbknapp on 2018-06-04 21:15_

---

_Label `D: hard` added by @kbknapp on 2018-06-04 21:15_

---

_Label `P3: want to have` added by @kbknapp on 2018-06-04 21:15_

---

_Label `W: 3.x` added by @kbknapp on 2018-06-04 21:15_

---

_Label `C: man page gen` added by @kbknapp on 2018-06-04 21:15_

---

_Label `C: completion gen` added by @kbknapp on 2018-06-04 21:15_

---

_Label `C: help pages gen` added by @kbknapp on 2018-06-04 21:15_

---

_Comment by @yoshuawuyts on 2018-06-05 10:09_

Oh, this is amazing! - I'll dig further into the v3 branch then. Thanks for taking your time to reply! :sparkles:

---

_Comment by @pksunkara on 2020-04-09 07:24_

Should be fixed by #1736. cc @CreepySkeleton 

---

_Added to milestone `3.0` by @pksunkara on 2020-04-09 07:24_

---

_Comment by @CreepySkeleton on 2020-04-10 02:12_

Yeah, right. Will get to it 11, should be done in a couple of days from then.

---

_Closed by @bors[bot] on 2020-04-11 16:43_

---
