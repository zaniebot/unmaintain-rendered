---
number: 5236
title: "Design Document: First Step Towards Modularity"
type: issue
state: open
author: epage
labels:
  - C-enhancement
  - E-hard
  - A-parsing
assignees: []
created_at: 2023-12-01T14:12:51Z
updated_at: 2023-12-01T14:12:52Z
url: https://github.com/clap-rs/clap/issues/5236
synced_at: 2026-01-07T12:31:17-06:00
---

# Design Document: First Step Towards Modularity

---

_Issue opened by @epage on 2023-12-01 14:12_

This is more of a note dumping ground so I don't forget this in the lead up to 5.0.

- Create sealed `UsageWriter` trait
  - Returns usage lines, without header or indentation
  - Create a `NoUsage`, `FixedUsage`, `AutoUsage`, `AdaptiveUsage`
- Create sealed `HelpWriter` trait
  - Create a `NoHelp`, `FixedHelp`, `HelpTemplate`, and `AutoHelp`
  - Generic over usage
- Create a `Storage` trait with sealed methods, making `ArgMatches` generic over it
  - Create new derive methods so this can be used implicitly to reduce constraints on derive and improve performance
- Create `ArgParser` that is generic over the above
- Deprecate all `Command::...get_matches...` functions except the most basic, pushing people to `ArgParser`
- Deprecate all `Command` help/usage writing functions (maybe)

End result
- Reduce binary size without the use of feature flags
- Reduce requirements on derive users
- Allow moving some `Command` state to `ArgParser`
- Open door for more experimentation with custom usage/help


---

_Label `C-enhancement` added by @epage on 2023-12-01 14:12_

---

_Label `E-hard` added by @epage on 2023-12-01 14:12_

---

_Label `A-parsing` added by @epage on 2023-12-01 14:12_

---

_Added to milestone `4.x` by @epage on 2023-12-01 14:12_

---

_Referenced in [clap-rs/clap#2914](../../clap-rs/clap/issues/2914.md) on 2023-12-27 18:12_

---

_Referenced in [clap-rs/clap#380](../../clap-rs/clap/issues/380.md) on 2024-01-08 17:16_

---
