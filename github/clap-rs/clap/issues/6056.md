---
number: 6056
title: "Changing the styling of spec values in long help from `literal` to `context_value` "
type: issue
state: closed
author: GilShoshan94
labels:
  - M-breaking-change
  - A-help
  - S-waiting-on-design
assignees: []
created_at: 2025-07-01T20:38:04Z
updated_at: 2025-08-06T20:46:18Z
url: https://github.com/clap-rs/clap/issues/6056
synced_at: 2026-01-07T12:31:17-06:00
---

# Changing the styling of spec values in long help from `literal` to `context_value` 

---

_Issue opened by @GilShoshan94 on 2025-07-01 20:38_

For "Possible values", the styling for the values is already set with the `literal` styling but just for the `long help`, so it feels inconsistent, but changing that could be considered a breaking change and therefore, we might leave it for 5.0.

Related to #5093, we are adding styling for `context` and `context_value`, so here we should apply the `context_value` styling instead of `literal`.

I think it would make senses to also apply the `context` styling on the header `Possible values:`, just like it is with the other contexts (default, aliases, ...). 
            

---

_Closed by @epage on 2025-07-01 20:40_

---

_Referenced in [clap-rs/clap#6057](../../clap-rs/clap/pulls/6057.md) on 2025-07-01 20:41_

---

_Reopened by @epage on 2025-07-01 20:45_

---

_Added to milestone `5.0` by @epage on 2025-07-01 20:45_

---

_Label `A-help` added by @epage on 2025-07-01 20:45_

---

_Label `S-waiting-on-design` added by @epage on 2025-07-01 20:45_

---

_Comment by @epage on 2025-07-01 20:46_

Sorry, the intent of this wasn't clear as it just quoted a comment.  Would you be able to be clearer in what this is saying?

---

_Comment by @GilShoshan94 on 2025-07-01 21:27_

Yes, it is a reference to my original discussion with you, from those 2 comments (with images): 
- https://github.com/clap-rs/clap/issues/5093#issuecomment-2091863555
- https://github.com/clap-rs/clap/issues/5093#issuecomment-2091916662

Bottom line the styling for "Possible values", the values are already treated with `literal` styling but just for the long help, so it feels inconsistent, but changing that would be a breaking change.
So, we split the issue in 2 PR, one to add the styling to the "contexts" and their values (while leaving it by default not styled to not introduce a breaking change) and the PR for this issue that will make it consistent but will be a breaking change and should be merged for the 5.0 release (that's what I understood from @pksunkara)

---

_Renamed from "Changing the styling of spec values in long help from `literal` to `context_possible_values_data` " to "Changing the styling of spec values in long help from `literal` to `context_data` " by @GilShoshan94 on 2025-07-01 22:34_

---

_Comment by @epage on 2025-07-02 20:23_

Could you update the issue description with what this issue is about?  I appreciate you taking the time to clarify but people shouldn't have to dig through the thread for that.

---

_Renamed from "Changing the styling of spec values in long help from `literal` to `context_data` " to "Changing the styling of spec values in long help from `literal` to `context_value` " by @GilShoshan94 on 2025-07-03 05:14_

---

_Comment by @GilShoshan94 on 2025-07-03 05:19_

Done, I updated the issue description

---

_Comment by @GilShoshan94 on 2025-07-07 23:58_

<img width="1760" height="1627" alt="Image" src="https://github.com/user-attachments/assets/45dab54c-5aa0-42b8-8823-f5e1d1a91ce8" />

---

_Comment by @GilShoshan94 on 2025-07-09 22:03_

I am adding here that in this issue I would like to style the context "title" with `context`, not just the values.

So in the code, replace:
`self.writer.push_str("Possible values:");`
by
`self.writer.push_string(format!("{ctx}Possible values:{ctx:#}"));`

---

_Comment by @GilShoshan94 on 2025-07-30 07:44_

Hi @epage,

I know this is a pretty minor ticket, just wanted to let you know that whenever you have time to revisit this in the coming months, I am here to discuss this with you and if you decide that you want to go ahead and apply my suggestion, I will be happy to prepare the PR for you.

---

_Label `M-breaking-change` added by @epage on 2025-07-30 21:33_

---

_Comment by @epage on 2025-08-05 20:34_

To make things easier to work with than a screenshot:

The thread at https://github.com/clap-rs/clap/pull/6057#discussion_r2182922085 is relevant, starting with:

> Let's defer out all "Possible Values" changes in long help to #6056.
> 
> The original issue was focused on the `[]` sections. The possibility of touching long help didn't come up until [#5093 (comment)](https://github.com/clap-rs/clap/issues/5093#issuecomment-2091863555) and I never got to reply to that.
> 
> I feel like the formatting of Possible Values is very different than `[]`. Instead of being a special syntax for context, its written more like what someone would write out and I don't feel confident that styling it like `[]` is the right call.
> 
> Take `rg --help` as an example
> 
> ```
>         --color <WHEN>
>             This flag controls when to use colors. The default setting is 'auto', which
>             means ripgrep will try to guess when to use colors. For example, if ripgrep is
>             printing to a terminal, then it will use colors, but if it is redirected to a
>             file or a pipe, then it will suppress color output. ripgrep will suppress color
>             output in some other circumstances as well. For example, if the TERM
>             environment variable is not set or set to 'dumb', then ripgrep will not use
>             colors.
> 
>             The possible values for this flag are:
> 
>                 never    Colors will never be used.
>                 auto     The default. ripgrep tries to be smart.
>                 always   Colors will always be used regardless of where output is sent.
>                 ansi     Like 'always', but emits ANSI escapes (even in a Windows console).
> 
>             When the --vimgrep flag is given to ripgrep, then the default value for the
>             --color flag changes to 'never'.
> ```
> 
> this isn't using clap anymore and it didn't use our Possible Values rendering, but the format is similar.

From https://github.com/clap-rs/clap/pull/6057#discussion_r2183241507

> But except for this case, the other "contexts" (default, env, ...) use the same formatting function for the long help, so they are automatically using the same styling `context` and `context_value` for the long help than in the short help.



---

_Comment by @epage on 2025-08-05 20:35_

If we did something, it would have to wait for the start of v5.0.0 work or go behind the `unstable-v5` flag.

---

_Comment by @epage on 2025-08-05 20:37_

> I feel like the formatting of Possible Values is very different than []. Instead of being a special syntax for context, its written more like what someone would write out and I don't feel confident that styling it like [] is the right call.

Currently, I lean towards the Possible Values section being different enough from `[specs]` that it is reasonable and expected to be rendered differently and would be inclined to close this.

---

_Comment by @GilShoshan94 on 2025-08-06 09:27_

> If we did something, it would have to wait for the start of v5.0.0 work or go behind the `unstable-v5` flag.

Indeed, agree.

> Currently, I lean towards the Possible Values section being different enough from [specs] that it is reasonable and expected to be rendered differently and would be inclined to close this.

While I don't agree with you, this is a matter of taste/opinion and I can be ok with that, the issue I think is that it does not feel consistent nor between the short help and the long help, and even in the long help, the "possible values" is treated differently according to if it does has long help on the values or not.

I slightly transformed the example `examples\typed-derive.rs` to showcase this to you.

I used the following styling:
```rust
const STYLING: Styles = Styles::styled()
    .header(AnsiColor::Green.on_default().bold())
    .usage(AnsiColor::Green.on_default().bold())
    .literal(AnsiColor::Cyan.on_default().bold())
    .placeholder(AnsiColor::Cyan.on_default())
    .error(AnsiColor::Red.on_default().bold())
    .valid(AnsiColor::Green.on_default().bold())
    .invalid(AnsiColor::Yellow.on_default().bold())
    .context(AnsiColor::Yellow.on_default().dimmed())
    .context_value(AnsiColor::Yellow.on_default());
```
So literals are in bold cyan and the context / context_value are in dimmed yellow / yellow.

Here is the result, I hope you can see the inconsistencies I am observing as well:

<img width="1853" height="1021" alt="Image" src="https://github.com/user-attachments/assets/aa359cf7-5645-4a83-8d89-0e30f06f4fd4" />

(Here I attached the modified example, if you want to try it yourself, I added the `.txt` just to be able to attach it here)

[test_clap.rs.txt](https://github.com/user-attachments/files/21615069/test_clap.rs.txt)



---

_Referenced in [clap-rs/clap#6091](../../clap-rs/clap/pulls/6091.md) on 2025-08-06 16:32_

---

_Comment by @epage on 2025-08-06 16:50_

imo the `[possible values: ]` form and the `Possible Values` form are very different, so I'm not concerned about consistency between them

Instead our goal is looking like we were part of the users `about`.  Seeing your screenshot, I realize there is an issue with that that is highlighted by the use of colors.  We should have Possible Values before context.  This was fixed in #6091.  

Also, #5156 might allow us to drop the `[possible values]` form in a lot of cases.

---

_Comment by @GilShoshan94 on 2025-08-06 18:03_

> imo the [possible values: ] form and the Possible Values form are very different

Thanks for taking the time to look into this, I appreciate the discussion.
It really comes down to personal preference. 
If you’re comfortable with the current approach, I’m okay leaving it as is. 
My only suggestion would be to consider seeking additional feedback, as I view` [possible values:]` and `Possible Values` as forms as closely related in context.

=> Unless you decide otherwise, I won’t open a PR on this for now.

> Instead our goal is looking like we were part of the users about. Seeing your screenshot, I realize there is an issue with that that is highlighted by the use of colors. We should have Possible Values before context. This was fixed in https://github.com/clap-rs/clap/pull/6091.
> 
> Also, https://github.com/clap-rs/clap/issues/5156 might allow us to drop the [possible values] form in a lot of cases.

Sorry, I don't follow to be honnest... I looked into the links you put but I fail to understand you.

---

_Comment by @epage on 2025-08-06 19:20_

> Sorry, I don't follow to be honnest... I looked into the links you put but I fail to understand you.

For #6091, re-run the code you used for the screenshot with the latest clap.  The `[default:]` no longer splits the user content from `Possible Values:`, making it look more cohesive.

For #5156, imagine if instead of 
```
--port <PORT>
    Support for discrete numbers

    [default: 22]
    [possible values: 22, 80]

--log-level <LOG_LEVEL>
    Support enum from a foreign crate that don't implement `ValueEnum`

    Possible Values:
    - trace: ...
    - debug: ...
    - info: ...
    - warn: ...
    - error: ...
```
we had
```
--port <22|80>
    Support for discrete numbers

    [default: 22]

--log-level <trace|debug|info|warn|error>
    Support enum from a foreign crate that don't implement `ValueEnum`

    Possible Values:
    - trace: ...
    - debug: ...
    - info: ...
    - warn: ...
    - error: ...
```

---

_Comment by @GilShoshan94 on 2025-08-06 19:47_

Ah, ok, I understand better, thank you.
Yes, it looks great.
I guess the only times it would not are in some edge case with either a large number of possible values or with too "wide" (many characters to display) values.

Just for those edge case, it would be nice to leave an option still display it as it is currently today, with the placeholder.

Now, I don't know what the better default is, to make the new behavior (without the placeholder for possible values) opt-in or opt-out.

---

_Comment by @epage on 2025-08-06 19:49_

I discuss potential for disabling the literals and opt-in/opt-out in #5156.  Likely a better conversation for that.

---

_Comment by @GilShoshan94 on 2025-08-06 19:52_

Ok so, we can continue this discussion there,
Do you want to close this ticket or leave it open to gather additional feedback?

---

_Comment by @epage on 2025-08-06 20:46_

I lean towards closing.  We can always re-visit it if a motivating enough case comes up.

---

_Closed by @epage on 2025-08-06 20:46_

---
