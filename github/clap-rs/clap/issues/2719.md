---
number: 2719
title: Argument group name must be unique - panics on more than one group in YAML
type: issue
state: closed
author: thargy
labels:
  - C-bug
assignees: []
created_at: 2021-08-18T16:03:40Z
updated_at: 2021-08-19T06:40:41Z
url: https://github.com/clap-rs/clap/issues/2719
synced_at: 2026-01-07T12:31:17-06:00
---

# Argument group name must be unique - panics on more than one group in YAML

---

_Issue opened by @thargy on 2021-08-18 16:03_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Rust Version

rustc 1.54.0 (a178d0322 2021-07-26)

### Clap Version

3.0.0-beta.4

### Minimal reproducible code

```YAML
name: app

args:
  - arg_1:
      short: a
  - arg_2:
      short: b
  - arg_3:
      short: c
  - arg_4:
      short: d

groups:
  - group_1:
      args:
        - arg_1
        - arg_2
  - group_2:
      args:
        - arg_3
        - arg_4
```


### Steps to reproduce the bug with the above code

```RUST
let yaml = load_yaml!("cli.yaml");
let matches = App::from(yaml).get_matches();
```

```bash
cargo run
```

### Actual Behaviour

```
        'group_1' is already in use', <USER>\.cargo\registry\src\github.com-1ecc6299db9ec823\clap-3.0.0-beta.4\src\build\app\debug_asserts.rs:218:9
```


### Expected Behaviour

Should allow multiple groups with unique names.

### Additional Context

The failed assertion code is from here:
https://github.com/clap-rs/clap/blob/476dd190b7f7a91926dc696f1cb80146c67aabd2/src/build/app/debug_asserts.rs#L218-L222

At the point of assertion `app.groups` contains:

<img width="229" alt="app groups" src="https://user-images.githubusercontent.com/1908506/129931483-634e097e-5c51-410b-85a9-5122fbdf5e6c.png">

As you can see, the `id`s are both set to `name: "", id: 0`, and the names are in a separate `name` field, so it is unsurprising the assert fails.

### Debug Output

```
[            clap::build::app]  App::_do_parse
[            clap::build::app]  App::_build
[            clap::build::app]  App::_propagate:app
[            clap::build::app]  App::_check_help_and_version
[            clap::build::app]  App::_propagate_global_args:app
[            clap::build::app]  App::_derive_display_order:app
[clap::build::app::debug_asserts]       App::_debug_asserts
[clap::build::arg::debug_asserts]       Arg::_debug_asserts:help
[clap::build::arg::debug_asserts]       Arg::_debug_asserts:version
[clap::build::arg::debug_asserts]       Arg::_debug_asserts:arg_1
[clap::build::arg::debug_asserts]       Arg::_debug_asserts:arg_2
[clap::build::arg::debug_asserts]       Arg::_debug_asserts:arg_3
[clap::build::arg::debug_asserts]       Arg::_debug_asserts:arg_4
thread 'main' panicked at 'Argument group name must be unique

        'group_1' is already in use', <USER>\.cargo\registry\src\github.com-1ecc6299db9ec823\clap-3.0.0-beta.4\src\build\app\debug_asserts.rs:218:9
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

---

_Label `T: bug` added by @thargy on 2021-08-18 16:03_

---

_Comment by @epage on 2021-08-18 16:18_

Thanks for the detailed report!  Looking at this now!

---

_Comment by @thargy on 2021-08-18 17:06_

Although it's probably obvious, I've only seen this on the YAML import and it's clear that the bug lies in the way it's importing groups rather than the assertion (which hasn't changed in at least 13 months).  Should be a quick fix.

---

_Referenced in [clap-rs/clap#2722](../../clap-rs/clap/pulls/2722.md) on 2021-08-18 20:17_

---

_Closed by @pksunkara on 2021-08-19 06:40_

---
