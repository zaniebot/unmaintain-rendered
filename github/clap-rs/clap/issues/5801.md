---
number: 5801
title: "Does MSRV apply to clap_complete's unstable-dynamic feature?"
type: issue
state: closed
author: senekor
labels:
  - C-bug
assignees: []
created_at: 2024-11-01T13:40:29Z
updated_at: 2024-11-04T15:55:09Z
url: https://github.com/clap-rs/clap/issues/5801
synced_at: 2026-01-07T12:31:17-06:00
---

# Does MSRV apply to clap_complete's unstable-dynamic feature?

---

_Issue opened by @senekor on 2024-11-01 13:40_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

1.74.0

### Clap Version

master

### Minimal reproducible code

N/A

### Steps to reproduce the bug with the above code

in the clap repo:
```sh
RUSTUP_TOOLCHAIN=1.74.0 cargo check --workspace --all-features
```

### Actual Behaviour

```
error[E0599]: no method named `split_at_checked` found for reference `&str` in the current scope
   --> clap_complete/src/engine/complete.rs:395:10
    |
394 |       let (prefix, value) = value
    |  ___________________________-
395 | |         .split_at_checked(pos + delimiter.len_utf8())
    | |         -^^^^^^^^^^^^^^^^ help: there is a method with a similar name: `split_at`
    | |_________|
    |
```

### Expected Behaviour

Should clap_complete compile with the MSRV and `unstable-dynamic` turned on? Or is the unstable feature exempt from the MSRV policy?

### Additional Context

The MSRV policy is 2 minor versions, behind, so 1.80 (which is required for `split_at_checked`) is within that policy. So it would be possible to bump the MSRV to fix it, if desired.

If `unstable-dynamic` should be covered by the MSRV policy, I think this could be checked in CI by extending this line in the Makefile:
```
_FEATURES_full = --features "deprecated derive cargo env unicode string wrap_help unstable-ext unstable-dynamic"
```

MSRV violations are also caught by clippy since 1.78:

```sh
cargo clippy --workspace --all-features
```

```
warning: current MSRV (Minimum Supported Rust Version) is `1.74.0` but this item is stable since `1.80.0`
   --> clap_complete/src/engine/complete.rs:395:10
    |
395 |         .split_at_checked(pos + delimiter.len_utf8())
    |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
    = help: for further information visit https://rust-lang.github.io/rust-clippy/master/index.html#incompatible_msrv
    = note: `#[warn(clippy::incompatible_msrv)]` on by default
```

(plus two unrelated clippy warnings in the `unstable-dynamic` code)

Exentding the Makefile as suggested would also surface these three clippy warnings as errors.

### Debug Output

_No response_

---

_Label `C-bug` added by @senekor on 2024-11-01 13:40_

---

_Referenced in [clap-rs/clap#5805](../../clap-rs/clap/pulls/5805.md) on 2024-11-04 15:48_

---

_Comment by @epage on 2024-11-04 15:49_

This was a slip up as our CI doesn't check this feature for MSRV

---

_Closed by @epage on 2024-11-04 15:55_

---
