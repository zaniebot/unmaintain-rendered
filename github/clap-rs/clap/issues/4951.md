---
number: 4951
title: "`unused_qualifications` complains"
type: issue
state: closed
author: tyranron
labels:
  - C-bug
assignees: []
created_at: 2023-06-05T15:55:54Z
updated_at: 2023-06-05T18:56:14Z
url: https://github.com/clap-rs/clap/issues/4951
synced_at: 2026-01-07T12:31:17-06:00
---

# `unused_qualifications` complains

---

_Issue opened by @tyranron on 2023-06-05 15:55_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.70.0 (90c541806 2023-05-31)

### Clap Version

4.3.1

### Minimal reproducible code

```rust
#![deny(unused_qualifications)]

use clap::Args;

#[derive(Args, Clone, Copy, Debug, Default)]
#[group(skip)]
pub struct Compose<L: Args> {
    #[command(flatten)]
    pub left: L,
}

fn main() {} 
```
[Playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=fa1c15f5e1652d03974294c7bb6c9ecd)

### Steps to reproduce the bug with the above code

cargo check

### Actual Behaviour

```
error: unnecessary qualification
 --> src/main.rs:8:15
  |
8 |     #[command(flatten)]
  |               ^^^^^^^
  |
note: the lint level is defined here
 --> src/main.rs:1:9
  |
1 | #![deny(unused_qualifications)]
  |         ^^^^^^^^^^^^^^^^^^^^^
```

### Expected Behaviour

Compiles OK.

### Additional Context

Appears starting from 1.70 Rust. On 1.69 Rust everything is OK.

### Debug Output

If we run `cargo expand` on [Playground](https://play.rust-lang.org/?version=stable&mode=debug&edition=2021&gist=fa1c15f5e1652d03974294c7bb6c9ecd), we would see the expansion like this:
```rust
#[allow(dead_code, unreachable_code, unused_variables, unused_braces)]
#[allow(clippy :: style, clippy :: complexity, clippy :: pedantic, clippy ::
restriction, clippy :: perf, clippy :: deprecated, clippy :: nursery, clippy
:: cargo, clippy :: suspicious_else_formatting, clippy :: almost_swapped,)]
impl<L: Args> clap::FromArgMatches for Compose<L> {
    // etc...
}
```

It seems, that starting from 1.70 Rust, the `unused_qualifications` became more clever and covers more code paths than it had done before. I wonder why the [`#[automatically_derived]` attribute](https://stackoverflow.com/questions/51481551/what-does-automatically-derived-mean) is not used in the macro expansions, which is used to handle most of such situations (modulo lint bugs)?

---

_Label `C-bug` added by @tyranron on 2023-06-05 15:55_

---

_Comment by @epage on 2023-06-05 17:12_

Never heard of `#[automatically_derived]` before.  In Veykril/tlborm#93, I suggested it gets covered in the Little Book of Macros.

---

_Referenced in [clap-rs/clap#4952](../../clap-rs/clap/pulls/4952.md) on 2023-06-05 17:56_

---

_Closed by @epage on 2023-06-05 18:56_

---

_Referenced in [enso-org/enso#7109](../../enso-org/enso/pulls/7109.md) on 2023-06-22 12:31_

---
