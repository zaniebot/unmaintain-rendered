---
number: 548
title: Required argument for subcommand?
type: issue
state: closed
author: kherge
labels: []
assignees: []
created_at: 2016-06-29T20:21:10Z
updated_at: 2018-08-02T03:29:50Z
url: https://github.com/clap-rs/clap/issues/548
synced_at: 2026-01-07T12:31:16-06:00
---

# Required argument for subcommand?

---

_Issue opened by @kherge on 2016-06-29 20:21_

When using `.value_of()` to get the value of a required subcommand argument, `None` is returned which causes a panic when I `unwrap` the value I was expecting to be available. I get `None` even if a value is provided.

Could you please help me understand what I am doing incorrectly?

``` rust
extern crate clap;

use self::clap::{App, AppSettings, Arg, SubCommand};

fn main() {
    let input = App::new("Bug")
        .about("Example code to demonstrate a bug.")
        .setting(AppSettings::SubcommandRequiredElseHelp)
        .subcommand(SubCommand::with_name("trigger")
                    .arg(Arg::with_name("culprit")
                         .required(true)))
        .get_matches();

    if Some("trigger") == input.subcommand_name() {
        let culprit = input.value_of("culprit").unwrap();

        println!("Culprit: {}", culprit);
    } else {
        println!("No match on: {}", input.subcommand_name().unwrap());
    }
}
```


---

_Comment by @kbknapp on 2016-06-30 01:17_

`"culprit"` is an argument of the subcommand `"trigger"`'s matches, not the parent `"Bug"`'s matches (stored in `input`).

You must first get the `"trigger"`'s matches in in order to see values of arguments defined on that subcommand. This is because any subcommands could have argument names that overlap, and it's also more efficent to pass around a small "subcommand matches" vice an all encompassing "all arguments of all subcommands" matches.

If you change your code slightly it'll work as intended:

``` rust
extern crate clap;

use self::clap::{App, AppSettings, Arg, SubCommand};

fn main() {
    let input = App::new("Bug")
        .about("Example code to demonstrate a bug.")
        .setting(AppSettings::SubcommandRequiredElseHelp)
        .subcommand(SubCommand::with_name("trigger")
                    .arg(Arg::with_name("culprit")
                         .required(true)))
        .get_matches();

    match input.subcommand() {
        ("trigger", Some(sub_input)) => {
            let culprit = sub_input.value_of("culprit").unwrap();

            println!("Culprit: {}", culprit);
        _ => /* no subcommand */,
    }
}
```


---

_Label `T: RFC / question` added by @kbknapp on 2016-06-30 01:17_

---

_Comment by @kherge on 2016-06-30 15:43_

That worked perfectly. Thanks!


---

_Closed by @kherge on 2016-06-30 15:43_

---
