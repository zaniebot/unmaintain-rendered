---
number: 1094
title: "-h, --help generate trailing spaces"
type: issue
state: closed
author: jakwings
labels:
  - C-enhancement
  - A-help
  - E-medium
  - E-help-wanted
assignees: []
created_at: 2017-11-06T04:10:49Z
updated_at: 2020-08-20T18:21:28Z
url: https://github.com/clap-rs/clap/issues/1094
synced_at: 2026-01-07T12:31:16-06:00
---

# -h, --help generate trailing spaces

---

_Issue opened by @jakwings on 2017-11-06 04:10_

<!-- Issuehunt Badges -->
[<img alt="Issuehunt badges" src="https://img.shields.io/badge/IssueHunt-%2410%20Rewarded-%237E24E3.svg" />](https://issuehunt.io/r/clap-rs/clap/issues/1094)
<!-- /Issuehunt Badges -->


### Rust Version

rustc 1.21.0 (3b72af97e 2017-10-09)

### Affected Version of clap

clap 2.27.1

### Expected Behavior Summary

The help info should not contain unexpected trailing spaces for any lines of text.

### Actual Behavior Summary

Some text ends with spaces, especially after the flag names.

### Steps to Reproduce the issue

`program --help` or `program -h`.

### Sample Code

```rust
extern crate clap;
use clap::{App, Arg};

fn main() {
    let _ = App::new("clap-space")
        .arg(Arg::with_name("a").long("flag-a").help("The first flag."))
        .arg(Arg::with_name("b").long("flag-b").help("The second flag."))
        .print_long_help();
}
```

### Debug output

```
DEBUG:clap:Parser::propagate_settings: self=clap-space, g_settings=AppFlags(
    NEEDS_LONG_HELP | NEEDS_LONG_VERSION | NEEDS_SC_HELP | UTF8_NONE | COLOR_AUTO
)
DEBUG:clap:Parser::create_help_and_version;
DEBUG:clap:Parser::create_help_and_version: Building --help
DEBUG:clap:Parser::create_help_and_version: Building --version
DEBUG:clap:Parser::propagate_settings: self=clap-space, g_settings=AppFlags(
    NEEDS_LONG_HELP | NEEDS_LONG_VERSION | NEEDS_SC_HELP | UTF8_NONE | COLOR_AUTO
)
DEBUG:clap:Parser::create_help_and_version;
DEBUG:clap:Help::write_app_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Help::write_parser_help;
DEBUG:clap:Parser::color;
DEBUG:clap:Parser::color: Color setting...Auto
DEBUG:clap:is_a_tty: stderr=false
DEBUG:clap:Help::new;
DEBUG:clap:Help::write_help;
DEBUG:clap:Help::write_default_help;
DEBUG:clap:Help::write_bin_name;
DEBUG:clap:Help::write_version;
DEBUG:clap:usage::create_usage_no_title;
DEBUG:clap:usage::get_required_usage_from: reqs=[], extra=None
DEBUG:clap:usage::get_required_usage_from: after init desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: no more children
DEBUG:clap:usage::get_required_usage_from: final desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: args_in_groups=[]
DEBUG:clap:usage::needs_flags_tag;
DEBUG:clap:usage::needs_flags_tag:iter: f=a;
DEBUG:clap:Parser::groups_for_arg: name=a
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::needs_flags_tag:iter: [FLAGS] required
DEBUG:clap:usage::create_help_usage: usage=clap-space [FLAGS]
DEBUG:clap:Help::write_all_args;
DEBUG:clap:Help::write_args;
DEBUG:clap:Help::write_args: Current Longest...2
DEBUG:clap:Help::write_args: New Longest...8
DEBUG:clap:Help::write_args: Current Longest...8
DEBUG:clap:Help::write_args: New Longest...8
DEBUG:clap:Help::write_args: Current Longest...8
DEBUG:clap:Help::write_args: New Longest...8
DEBUG:clap:Help::write_args: Current Longest...8
DEBUG:clap:Help::write_args: New Longest...9
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--flag-a
DEBUG:clap:Help::spec_vals: a=--flag-a
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width > (width - taken)...15 > (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=5
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...true
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--flag-b
DEBUG:clap:Help::spec_vals: a=--flag-b
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width > (width - taken)...16 > (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=5
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...true
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--help
DEBUG:clap:Help::spec_vals: a=--help
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width > (width - taken)...23 > (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=7
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...true
DEBUG:clap:Help::help: Too long...No
DEBUG:clap:Help::write_arg;
DEBUG:clap:Help::short;
DEBUG:clap:Help::long;
DEBUG:clap:Help::val: arg=--version
DEBUG:clap:Help::spec_vals: a=--version
DEBUG:clap:Help::val: Has switch...Yes
DEBUG:clap:Help::val: force_next_line...false
DEBUG:clap:Help::val: nlh...false
DEBUG:clap:Help::val: taken...21
DEBUG:clap:Help::val: help_width > (width - taken)...26 > (120 - 21)
DEBUG:clap:Help::val: longest...9
DEBUG:clap:Help::val: next_line...No
DEBUG:clap:write_spaces!: num=4
DEBUG:clap:Help::help;
DEBUG:clap:Help::help: Next Line...true
DEBUG:clap:Help::help: Too long...No
clap-space 

USAGE:
    clap-space [FLAGS]

FLAGS:
        --flag-a     
            The first flag.

        --flag-b     
            The second flag.

    -h, --help       
            Prints help information

    -V, --version    
            Prints version information
```


<!-- Issuehunt content -->

---

<details>
<summary>
<b>IssueHunt Summary</b>
</summary>

#### [<img src='https://avatars2.githubusercontent.com/u/28928944?v=4' alt='knightpp' width=24 height=24> knightpp](https://issuehunt.io/u/knightpp) has been rewarded.

### Backers (Total: $10.00)

- [<img src='https://avatars0.githubusercontent.com/u/174703?v=4' alt='pksunkara' width=24 height=24> pksunkara](https://issuehunt.io/u/pksunkara) ($10.00)

### Submitted pull Requests
- [#2085 Don't print spaces in long help](https://issuehunt.io/r/clap-rs/clap/pull/2085)
---

### Tips

- Checkout the [Issuehunt explorer](https://issuehunt.io/r/clap-rs/clap/) to discover more funded issues.
- Need some help from other developers? [Add your repositories](https://issuehunt.io/r/new) on IssueHunt to raise funds.
</details>
<!-- /Issuehunt content-->

---

_Comment by @kbknapp on 2017-11-06 17:53_

This is partly an implementation issue that doesn't have a good work around. The help generation is segmented off where each "section" is written in isolation. Without greater coupling (or a larger refactor), the section that writes the spaces between the flags/values and the actual help line can't look ahead to see if there is actually anything that requires those spaces.

For the `long_help` it *might* be possible to look ahead since there is no possible way they'd need those spaces, but I'd have to dig deeper.

I agree it'd be better to have them gone, but is there an issue that these spaces are causing other than some additional bytes written to stdout?

---

_Label `T: RFC / question` added by @kbknapp on 2017-11-06 17:53_

---

_Comment by @jakwings on 2017-11-06 21:50_

Thanks for the details. No serious issue here. :)

---

_Label `C: help message` added by @kbknapp on 2017-11-07 00:43_

---

_Label `D: intermediate` added by @kbknapp on 2017-11-07 00:43_

---

_Label `help wanted` added by @kbknapp on 2017-11-07 00:43_

---

_Label `M: mentored` added by @kbknapp on 2017-11-07 00:43_

---

_Label `P4: nice to have` added by @kbknapp on 2017-11-07 00:43_

---

_Label `T: enhancement` added by @kbknapp on 2017-11-07 00:43_

---

_Label `T: RFC / question` removed by @kbknapp on 2017-11-07 00:43_

---

_Added to milestone `3.1` by @pksunkara on 2020-04-12 10:10_

---

_Comment by @issuehunt-oss[bot] on 2020-05-27 14:31_

[@pksunkara](https://issuehunt.io/u/pksunkara) has funded $5.00 to this issue.

---
- Submit pull request via [IssueHunt](https://issuehunt.io/repos/31315121/issues/1094) to receive this reward.
- Want to contribute? Chip in to this issue via [IssueHunt](https://issuehunt.io/repos/31315121/issues/1094).
- Checkout the [IssueHunt Issue Explorer](https://issuehunt.io/issues) to see more funded issues.
- Need help from developers? [Add your repository](https://issuehunt.io/r/new) on IssueHunt to raise funds.

---

_Label `:dollar: Funded on Issuehunt` added by @issuehunt-oss[bot] on 2020-05-27 14:31_

---

_Comment by @issuehunt-oss[bot] on 2020-08-11 11:39_

[@pksunkara](https://issuehunt.io/u/pksunkara) has funded $5.00 to this issue.

---
- Submit pull request via [IssueHunt](https://issuehunt.io/repos/31315121/issues/1094) to receive this reward.
- Want to contribute? Chip in to this issue via [IssueHunt](https://issuehunt.io/repos/31315121/issues/1094).
- Checkout the [IssueHunt Issue Explorer](https://issuehunt.io/issues) to see more funded issues.
- Need help from developers? [Add your repository](https://issuehunt.io/r/new) on IssueHunt to raise funds.

---

_Referenced in [clap-rs/clap#2085](../../clap-rs/clap/pulls/2085.md) on 2020-08-20 12:57_

---

_Closed by @bors[bot] on 2020-08-20 18:16_

---

_Label `:dollar: Funded on Issuehunt` removed by @issuehunt-oss[bot] on 2020-08-20 18:21_

---

_Comment by @issuehunt-oss[bot] on 2020-08-20 18:21_

[@pksunkara](https://issuehunt.io/u/pksunkara) has rewarded $9.00 to [@knightpp](https://issuehunt.io/u/knightpp). [See it on IssueHunt](https://issuehunt.io/repos/31315121/issues/1094)

- :moneybag: Total deposit: $10.00
- :tada: Repository reward(0%): $0.00
- :wrench: Service fee(10%): $1.00

---

_Label `:gift: Rewarded on Issuehunt` added by @issuehunt-oss[bot] on 2020-08-20 18:21_

---
