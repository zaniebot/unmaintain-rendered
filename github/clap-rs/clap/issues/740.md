---
number: 740
title: what is the policy around minimum supported version of Rust?
type: issue
state: closed
author: BurntSushi
labels: []
assignees: []
created_at: 2016-11-12T15:34:32Z
updated_at: 2017-01-14T01:17:03Z
url: https://github.com/clap-rs/clap/issues/740
synced_at: 2026-01-07T12:31:16-06:00
---

# what is the policy around minimum supported version of Rust?

---

_Issue opened by @BurntSushi on 2016-11-12 15:34_

When clap gets an addition that requires a newer version of Rust, what is the policy regarding semver updates?

For example, PR #737 increased the minimum Rust version required to build clap from 1.11.0 (which can compile clap 2.18.0) to 1.13.0 (which is required because of the `questionmark` feature being recently stabilized).

This is a problem in practice for folks that need or want to support older versions of the Rust compiler specifically because `cargo update` will cause builds to break. e.g., `cargo update` will do a semver upgrade from clap `2.18.0` to clap `2.19.0` (once it's released), but this will break every single build on Rust 1.11 and Rust 1.12. There are solutions to the problem, such as adding a version constraint like `<= 2.18.0` to one's Cargo.toml. Typically, this can be a particularly nasty problem when the issue lies in a transitive dependency. In clap's case at least, it's likely to not be a transitive dependency, which probably makes it a little easier to deal with.

Note that this has been a contentious issue discussed at length. Some people think it qualifies as a breaking change, and therefore requires a semver version bump (in clap's case, a major version bump). Others think the constraints it places on projects are too onerous and will be hard to live up to in practice. See https://github.com/rust-lang/rfcs/pull/1619 for more discussion. See also: https://users.rust-lang.org/t/cargo-lock-libraries-and-ci/7698 --- Either way, I think it's important to establish a policy. One way to be proactive about it is (regardless of which side you come down on) is to put a specific Rust version in your CI testing. That way, you'll at least know when it happens, because it can otherwise be very tricky to keep track of!

---

_Comment by @kbknapp on 2016-11-12 17:04_

This is a good question, thanks for bringing it up! It's also one I was thinking about while pushing that particular PR. When pushing that PR I had that odd feeling in the pit of my stomach too, which should have been a sign!

As part of that PR my thought process was obviously _at least_ bump the minor because I regularly use `"~2.18.0"` styles in my `Cargo.toml` in order to _not_ automatically bump minors for cases like this. I also forgo that many people use `"2"` (or similar) in theirs.

While no official policy is in place, I think it may be time to adopt one. I went through and read those RFCs you linked to, and had seen them briefly in the past. I can see how this can be contentious, and personally I'm seeing myself leaning more towards the major version bump side of things, although it _does_ scare me to think of making multiple major version bumps relatively rapidly. In my mind, the more people bump the major version and only provide extremely small breaking changes you're conditioning the users of your library to expect small breaking changes, if any. Then one day you break everything for what should truly be a major version bump, and it'll throw people off.

### Moving Forward

Here's my plan moving forward. I'm going to roll back #737 and use the Stable-2 approach for officially supported. And _for the time being_ at least until Rust decides an official best practices policy. I will make bumping the minimum version of `rustc` a _minor_ version bump **but** will also very clearly dictate the "stable-2, and use `"~major.minor.patch"` in your `Cargo.toml` to avoid being caught off guard" in the readme and docs, as well as make it clear in the changelog when the minimum version of `rustc` has been bumped.

This to me seems the best approach for this project at this time. My reasoning is the way this project is structured, one typically doesn't _need_ to bump the minor version unless you're using one of the newer features released in said minor. It's true that there are bug fixes in future minors that aren't back-ported (because I don't have enough man power to do so), but unless you're affected by one of these bugs which in most cases is a small percentage of users anyways, you really don't have a reason to bump the minor. 

All this meaning, bumping the minor could, and perhaps should, be a conscious decision.

Thoughts? I'm open to any and all suggestions!


---

_Label `T: RFC / question` added by @kbknapp on 2016-11-12 17:04_

---

_Assigned to @kbknapp by @kbknapp on 2016-11-12 17:04_

---

_Comment by @BurntSushi on 2016-11-12 17:24_

@kbknapp That seems like a good compromise to me! Thanks for taking the time. :-)

(Loving clap so far btw!)


---

_Comment by @kbknapp on 2016-11-12 20:35_

Thanks! :smile: 

TODO:
- [x] Revert #737 
- [x] Update README.md with new policy
- [x] Add 1.11.0 to `.travis.yml`


---

_Referenced in [clap-rs/clap#752](../../clap-rs/clap/pulls/752.md) on 2016-11-16 12:05_

---

_Comment by @BurntSushi on 2016-11-16 12:07_

@kbknapp One thing to consider adding to your TODO list is to put a specific Rust version in your `.travis.yml`. [Example.](https://github.com/rust-lang-nursery/regex/blob/master/.travis.yml#L3)


---

_Comment by @matthiasbeyer on 2016-11-16 12:33_

@BurntSushi :+1: on putting a specific compiler into `.travis.yml`! I'd suggest at least one compiler that does not support the `?` syntax, at least for the next few weeks.


---

_Comment by @kbknapp on 2016-11-16 14:29_

Yep, I've got a local branch where I'm working on some of these fixes and that was one of the first things I did :smile: I should have the PR in today or tomorrow.


---

_Closed by @homu on 2016-11-21 04:52_

---

_Referenced in [BurntSushi/ripgrep#271](../../BurntSushi/ripgrep/issues/271.md) on 2016-12-06 18:28_

---

_Referenced in [TeXitoi/structopt#115](../../TeXitoi/structopt/issues/115.md) on 2018-06-06 10:19_

---
