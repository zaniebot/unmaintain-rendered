---
number: 1035
title: "`clap_app!` can't have default arguments with numbers/some characters."
type: issue
state: closed
author: jaccarmac
labels:
  - C-bug
assignees: []
created_at: 2017-08-21T04:47:28Z
updated_at: 2021-11-19T12:02:27Z
url: https://github.com/clap-rs/clap/issues/1035
synced_at: 2026-01-07T12:31:16-06:00
---

# `clap_app!` can't have default arguments with numbers/some characters.

---

_Issue opened by @jaccarmac on 2017-08-21 04:47_

### Rust Version

`rustc 1.21.0-nightly (8c303ed87 2017-08-20)`

### Affected Version of clap

`2.26.0`

### Expected Behavior Summary

The `clap_app!` macro can have arguments with defaults which are numbers or contain special characters, possibly with some quoting.

### Actual Behavior Summary

No amount of quoting can stop Clap from failing to parse the macro form properly.

### Steps to Reproduce the issue

Try to compile the sample code. Replace the default arguments with simple strings and see it compile successfully.

### Sample Code or Link to Sample Code

```
#[macro_use]
extern crate clap;

fn main() {
    let matches = clap_app!(app =>
        (@arg host: default_value[foo.com] "hostname")
        (@arg port: default_value[8080] "port number")).get_matches();
}
```

### Debug output

No output.

---

_Comment by @kbknapp on 2017-08-21 22:26_

Thanks for reporting! I'm in the process of trying to get 3.x out the door, so I'll verify/fix this issue on that branch.

---

_Label `W: 3.x` added by @kbknapp on 2017-08-21 22:26_

---

_Label `C: macros` added by @kbknapp on 2017-08-21 22:26_

---

_Label `D: intermediate` added by @kbknapp on 2017-08-21 22:26_

---

_Label `T: bug` added by @kbknapp on 2017-08-21 22:26_

---

_Comment by @gluxon on 2019-01-26 18:18_

I'm not sure if the following was possible back when this issue was originally created, but I'm able to create a default argument (that's a number) like so:

```rust
#[macro_use]
extern crate clap;

fn main() {
    let matches = clap_app!(app =>
        (@arg host: default_value[foo.com] "hostname")
        (@arg port: default_value("8080") "port number")).get_matches();
}
```

It's a workaround, but I hope that's helpful for others until 3.x arrives.

---

_Comment by @0x8f701 on 2019-06-06 01:47_

hello @gluxon , could you explain a bit the difference between `[]` and `()` in default_value, and also why we need to add double quote for 8080 not `foo.com`.

Thanks in advance!

---

_Comment by @gluxon on 2019-06-06 03:14_

> hello @gluxon , could you explain a bit the difference between [] and () in default_value

Sure.

[] and () are both valid ways to call a function-like macro. So in terms of the Rust programming language, they're both exactly the same. For example, the first two lines are common, but all 4 are valid lines of Rust code.

```rust
println!("hello");
let a = vec![1, 2, 3];
println!["hello"];
let a = vec!(1, 2, 3);
```

However, one works where the other doesn't here because of quirks in how `clap_app` and `default_value` are implemented. You would have to look at the source code for those two functions to see exactly why.

> and also why we need to add double quote for 8080 not foo.com.

I'm also not 100% sure, but it's for similar reasons as above. Command line arguments are parsed as strings, so the fact that it's quoted doesn't change the type, but it gets around quirks in the aforementioned macro implementations.

---

_Added to milestone `3.0` by @pksunkara on 2020-04-12 08:48_

---

_Comment by @pksunkara on 2020-04-12 09:59_

With the upcoming PR which would close this issue, for certain characters, you would need to wrap them in `"`. Otherwise, numbers will be allowed now

```rust
fn main() {
    let matches = clap_app!(app =>
        (@arg host: default_value["foo.com"] "hostname")
        (@arg port: default_value[8080] "port number")).get_matches();
}
```

---

_Referenced in [clap-rs/clap#1813](../../clap-rs/clap/pulls/1813.md) on 2020-04-12 10:03_

---

_Comment by @CreepySkeleton on 2020-04-12 17:31_

Um, I don't get what problem is about.
```rust
#[macro_use]
extern crate clap;

fn main() {
    let matches = clap_app!(app =>
        (@arg host: default_value["foo.com"] "hostname")
        (@arg port: default_value["8080"] "port number")).get_matches();
}
```

There's no way to distinguish between `"string literal"` and `<any other expression>` on `macro_rules!` level so I think requiring values to be `&str` is a fair compromise.

---

_Closed by @bors[bot] on 2020-04-12 22:28_

---

_Comment by @Osse on 2021-11-19 12:02_

Has something changed recently? When I compile your example I get:

```
error: no rules expected the token `-`
 --> src\main.rs:5:19
  |
5 |       let matches = clap_app!(app =>
  |  ___________________^
6 | |         (@arg host: default_value["foo.com"] "hostname")
7 | |         (@arg port: default_value["8080"] "port number")).get_matches();
  | |_________________________________________________________^ no rules expected this token in macro call
  |
  = note: this error originates in the macro `clap_app` (in Nightly builds, run with -Z macro-backtrace for more info)
```

---
