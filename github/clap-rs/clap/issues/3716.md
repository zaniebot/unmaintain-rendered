---
number: 3716
title: "Allow for generating a \"catch-all\" branch when generating completions"
type: issue
state: open
author: mattcl
labels:
  - C-enhancement
  - A-completion
  - S-triage
assignees: []
created_at: 2022-05-10T10:35:48Z
updated_at: 2022-11-08T04:31:07Z
url: https://github.com/clap-rs/clap/issues/3716
synced_at: 2026-01-07T12:31:17-06:00
---

# Allow for generating a "catch-all" branch when generating completions

---

_Issue opened by @mattcl on 2022-05-10 10:35_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Clap Version

3.1.9

### Describe your use case

`cargo` (and other things like git) allows for surfacing third-party completions https://github.com/rust-lang/cargo/blob/9fa2bba6791f9df06a13dbfe18bf7add9b9b2d1b/src/etc/_cargo#L341 (for zsh anyway) by assuming they are defined as `_cargo-<name>`. It would be a nice feature if `clap_complete` could generate a similar "catch-all" branch for the purposes of delegating to completions provided by external commands. Currently, I'm generating completions then invoking some `sed` magic to insert my own catch-all branch, but this is a little fragile (and I only have it working for zsh).

### Describe the solution you'd like

My preferred solution would be something that would enable me to customize the way completions are generated in such a way that  a "good enough" catch-all block was generated for me, though I realize `generate` doesn't have a builder, so adding a flag like `allow_fallback` or whatever would be a breaking change.

### Alternatives, if applicable

Possible alternatives include

- a hook/template into the completion generation so arbitrary text could be added
- a separate function that allows for the generation of the catch-all branch (to not break current users)

### Additional Context

_No response_

---

_Label `C-enhancement` added by @mattcl on 2022-05-10 10:35_

---

_Comment by @epage on 2022-05-10 13:58_

> My preferred solution would be something that would enable me to customize the way completions are generated in such a way that a "good enough" catch-all block was generated for me,

I feel like there is too much policy in a "good enough" fallback to have one at the `clap_complete` level.

The big issue is ideally we'd tag the Arg or Command with special behavior.  We are looking at supporting that soon-ish.  Say we go with the hook option you mentioned, we are looking at supporting `arg.set(clap_complete::shell::BashCompleter::new("..."))` and the `clap_complete` could check if that exists and get its value.

---

_Label `A-completion` added by @epage on 2022-05-10 13:59_

---

_Label `S-triage` added by @epage on 2022-11-08 04:31_

---
