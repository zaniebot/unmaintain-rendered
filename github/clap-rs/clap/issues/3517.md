---
number: 3517
title: "Derive feature: Add a prefix for env vars"
type: issue
state: closed
author: remoun
labels:
  - C-enhancement
assignees: []
created_at: 2022-02-28T03:14:32Z
updated_at: 2022-02-28T03:31:32Z
url: https://github.com/clap-rs/clap/issues/3517
synced_at: 2026-01-07T12:31:17-06:00
---

# Derive feature: Add a prefix for env vars

---

_Issue opened by @remoun on 2022-02-28 03:14_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Clap Version

3.1.2

### Describe your use case

I'm working on adding env var support to a fairly large number of flags, with the Derive API. It would be great if we could specify a common prefix for all the env vars, without having to spell it out for each flag.

### Describe the solution you'd like

Something like `all_env_prefix = "FOO_"`, e.g.

```rust
#[derive(Debug, Parser)]
#[clap(rename_all_env = "kebab", all_env_prefix="FOO_")]
struct BehaviorModel {
    #[clap(env)]
    be_nice: String,
}
```

### Alternatives, if applicable

The current alternative is to spell out each of the names with the `env = "..."` syntax, but that's very repetitive.

A more general approach would be to allow specifying a callback for mapping flag names to env vars, e.g.

```rust
#[derive(Debug, Parser)]
#[clap(rename_all_env = flag_to_env)]
struct BehaviorModel {
    #[clap(env)]
    be_nice: String,
}

pub fn flag_to_env(name: &str): String {
    use heck::ToShoutySnakeCase;
    return format!("FOO_{}", name.to_shouty_snake_case());
}
```
... but I'm not sure that's worth the overhead of supporting callbacks, for which there is no precedent AFAIK.

### Additional Context

This seems similar to https://github.com/clap-rs/clap/discussions/2463 but for env vars renaming.

---

_Label `C-enhancement` added by @remoun on 2022-02-28 03:14_

---

_Referenced in [mobilecoinfoundation/mobilecoin#1541](../../mobilecoinfoundation/mobilecoin/pulls/1541.md) on 2022-02-28 03:15_

---

_Comment by @remoun on 2022-02-28 03:31_

Oops, I guess this is a dupe of https://github.com/clap-rs/clap/issues/3221

---

_Closed by @remoun on 2022-02-28 03:31_

---
