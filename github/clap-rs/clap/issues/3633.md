---
number: 3633
title: "Support for adding a `validator` on a `#[derive(Args)]` struct"
type: issue
state: closed
author: nipunn1313
labels:
  - C-enhancement
assignees: []
created_at: 2022-04-15T01:00:54Z
updated_at: 2022-04-15T17:41:46Z
url: https://github.com/clap-rs/clap/issues/3633
synced_at: 2026-01-07T12:31:17-06:00
---

# Support for adding a `validator` on a `#[derive(Args)]` struct

---

_Issue opened by @nipunn1313 on 2022-04-15 01:00_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Clap Version

3.1.3

### Describe your use case

Given something like this (toy example)

```rust
#[derive(clap::Args)]
struct NameSelector {
    /// One or more names
    names: Vec<String>,
}
```

It might be nice to be able to achieve something similar to the [Arg validator ](https://docs.rs/clap/latest/clap/struct.Arg.html#method.validator), but for the whole struct.

May be particularly useful if `NameSelector` grows more complex and/or reused in multiple CLI commands.

### Describe the solution you'd like

```rust
// proposed idea

#[derive(clap::Args)]
#[clap(validator(name_validator))]
struct NameSelector {
    /// One or more names
    names: Vec<String>,
}

fn name_validator(v: &NameSelector) -> Result<(), String> {
    if v.names.contains("Hitler") {
        return Err("We don't like Hitler");
    }
    Ok(())
}
```

### Alternatives, if applicable

Alternate interface could be a trait that you impl on `NameSelector` - but that doesn't seem in the spirit of the existing `validator` implementation.

### Additional Context

_No response_

---

_Label `C-enhancement` added by @nipunn1313 on 2022-04-15 01:00_

---

_Comment by @epage on 2022-04-15 12:25_

We are looking at generalizing our validation logic so that its both optional and so users can provide their own.  We are tracking this work in #3008 though it will be working at the builder level rather than at the derive level.

---

_Closed by @epage on 2022-04-15 12:25_

---

_Comment by @nipunn1313 on 2022-04-15 17:41_

Cool. Thanks for the explanation. #3008 sounds challenging, but great. Looking forward to it.

---
