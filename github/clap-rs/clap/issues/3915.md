---
number: 3915
title: "clap_complete does not work as expected with Bash and ValueHint::Hostname"
type: issue
state: closed
author: Shatnerz
labels:
  - C-enhancement
  - A-completion
  - E-easy
assignees: []
created_at: 2022-07-13T04:45:26Z
updated_at: 2022-07-13T20:51:00Z
url: https://github.com/clap-rs/clap/issues/3915
synced_at: 2026-01-07T12:31:17-06:00
---

# clap_complete does not work as expected with Bash and ValueHint::Hostname

---

_Issue opened by @Shatnerz on 2022-07-13 04:45_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.62.0 (a8314ef7d 2022-06-27)

### Clap Version

3.2.10

### Minimal reproducible code

Build this: https://github.com/Shatnerz/clap-completion-example

which is effectively

```rust
use clap::{Parser, ValueHint};

#[derive(Parser, Debug)]

pub struct Args {
    /// Attempting to get hostname completion to work
    #[clap(long, value_hint = ValueHint::Hostname)]
    pub host: String,
}
```
and
```rust
use clap::*;
use clap_complete::{generate_to, shells};

include!("src/cli.rs");

const BIN_NAME: &str = "xxx"; // something easy and unique for this example

fn main() {
    let mut app = Args::into_app();
    app.set_bin_name(BIN_NAME);

    let outdir = std::path::Path::new(env!("CARGO_MANIFEST_DIR")).join("completions/");
    generate_to(shells::Bash, &mut app, BIN_NAME, outdir.clone()).unwrap();
}
```


### Steps to reproduce the bug with the above code

1. Build code
2. Either inspect the bash completion script or source it and attempt to use (`xxx <TAB> <TAB>`)


### Actual Behaviour

Completion does not suggestion homenames by including something similar to

```bash
_known_hosts_real -a -- "$cur"
```

and uses the default completions

### Expected Behaviour

I expect to see something like
```bash
_known_hosts_real -a -- "$cur"
```

so that hostnames are suggested

### Additional Context

```
[build-dependencies]
clap = "3.2.10"
clap_complete = "3.2.3"
```

### Debug Output

_No response_

---

_Label `C-bug` added by @Shatnerz on 2022-07-13 04:45_

---

_Label `C-bug` removed by @epage on 2022-07-13 13:53_

---

_Label `C-enhancement` added by @epage on 2022-07-13 13:53_

---

_Label `A-completion` added by @epage on 2022-07-13 13:53_

---

_Label `E-easy` added by @epage on 2022-07-13 13:53_

---

_Comment by @epage on 2022-07-13 13:54_

Correct, it is unsupported in bash.  [ValueHint](https://docs.rs/clap/latest/clap/enum.ValueHint.html) is only documented to work with zsh and fish at the moment.

However, we are shifting our focus to https://github.com/clap-rs/clap/issues/3166 which will ensure we get a consistent experience across shells.

---

_Comment by @Shatnerz on 2022-07-13 20:51_

Oh thanks, I completely missed that. I think my brain saw `zsh` and thought `bash`. Thanks a lot.

---

_Closed by @Shatnerz on 2022-07-13 20:51_

---
