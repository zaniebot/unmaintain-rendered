---
number: 2264
title: Some unicode input may cause print_help and print_long_help panic(found by afl.rs)
type: issue
state: closed
author: StevenJiang1110
labels:
  - C-bug
assignees: []
created_at: 2020-12-23T11:35:08Z
updated_at: 2020-12-23T17:22:55Z
url: https://github.com/clap-rs/clap/issues/2264
synced_at: 2026-01-07T12:31:17-06:00
---

# Some unicode input may cause print_help and print_long_help panic(found by afl.rs)

---

_Issue opened by @StevenJiang1110 on 2020-12-23 11:35_

### Code

```rust
extern crate clap;
fn main() {
    let param0 = "00000000000000-00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 璀璀璀";
    let mut app_ = clap::SubCommand::with_name(param0);
    let _ = clap::App::print_long_help(&mut app_);
}
```
or
```rust
extern crate clap;
fn main() {
    let app_ = clap::SubCommand::with_name("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000-қ00000000000000000 蚝");
    let mut app2_ = clap::App::display_order(app_ ,3472328296227680304);
    let _ = clap::App::print_help(&mut app2_);
}
```
### Steps to reproduce the issue

1. Run `cargo run`  
The bug report is as follows.
![截屏2020-12-23 下午7 30 13](https://user-images.githubusercontent.com/27764680/102991966-48bfd400-4555-11eb-9901-ff13dfd29cd0.png)

### Version

* **Rust**: rustc 1.46.0-dev
* **Clap**: 2.33.3

```toml
[dependencies]
clap = { version = "2.33.3" }
```
I also put reproduce files at [print_help](https://github.com/StevenJiang1110/afl_rust_crashes/tree/main/clap/replay_clap25-48)
and [print_long_help](https://github.com/StevenJiang1110/afl_rust_crashes/tree/main/clap/replay_clap26-20)
I hope you can check if this is a bug. Thanks a lot.


---

_Label `T: bug` added by @StevenJiang1110 on 2020-12-23 11:35_

---

_Comment by @pksunkara on 2020-12-23 11:47_

Please try with master.

---

_Comment by @StevenJiang1110 on 2020-12-23 12:19_

I tried and it seems the master has removed the subCommand.
![截屏2020-12-23 下午8 19 36](https://user-images.githubusercontent.com/27764680/102995518-2ed5bf80-455c-11eb-8da1-0e7a22ec22c8.png)


---

_Comment by @ldm0 on 2020-12-23 17:21_

@StevenJiang1110 The `Subcommand` is integrated with `App` now, and the corresponding codes are:
```rust
fn main() {
    let param0 = "00000000000000-00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 璀璀璀";
    let mut app_ = clap::App::new(param0);
    let _ = clap::App::print_long_help(&mut app_);
}
```
and:
```rust
fn main() {
    let app_ = clap::App::new("0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000-қ00000000000000000 蚝");
    let mut app2_ = clap::App::display_order(app_ ,3472328296227680304);
    let _ = clap::App::print_help(&mut app2_);
}
```

Both work fine.

---

_Closed by @pksunkara on 2020-12-23 17:22_

---

_Referenced in [clap-rs/clap#1649](../../clap-rs/clap/issues/1649.md) on 2021-11-18 19:21_

---
