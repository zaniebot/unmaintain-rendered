---
number: 2397
title: is_present returns wrong args
type: issue
state: closed
author: clark-ja
labels:
  - C-bug
assignees: []
created_at: 2021-03-09T15:19:33Z
updated_at: 2021-03-09T16:32:12Z
url: https://github.com/clap-rs/clap/issues/2397
synced_at: 2026-01-07T12:31:17-06:00
---

# is_present returns wrong args

---

_Issue opened by @clark-ja on 2021-03-09 15:19_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Rust Version

rustc 1.50.0 (cb75ad5db 2021-02-10)

### Clap Version

2.33.3

### Minimal reproducible code

```rust
// src/main.rs
use clap::{App, Arg};

fn build_cli() -> App<'static, 'static> {
    App::new("example").args(&[Arg::with_name("foo"), Arg::with_name("bar")])
}

fn main() {
    let m = build_cli().get_matches();

    if m.is_present("foo") {
        println!("foo");
    }
    if m.is_present("bar") {
        println!("bar");
    }
}
```


### Steps to reproduce the bug with the above code

`cargo run -- bar`

### Actual Behaviour

it returns "foo"

### Expected Behaviour

shouldn't it return "bar"?

### Additional Context

_No response_

### Debug Output

```
    Finished dev [unoptimized + debuginfo] target(s) in 0.00s
     Running `target/debug/example bar`
DEBUG:clap:Parser::propagate_settings: self=example, g_settings=AppFlags(
    (empty),
)
DEBUG:clap:Parser::get_matches_with;
DEBUG:clap:Parser::create_help_and_version;
DEBUG:clap:Parser::create_help_and_version: Building --help
DEBUG:clap:Parser::create_help_and_version: Building --version
DEBUG:clap:Parser::get_matches_with: Begin parsing '"bar"' ([98, 97, 114])
DEBUG:clap:Parser::is_new_arg:"bar":NotFound
DEBUG:clap:Parser::is_new_arg: arg_allows_tac=false
DEBUG:clap:Parser::is_new_arg: probably value
DEBUG:clap:Parser::is_new_arg: starts_new_arg=false
DEBUG:clap:Parser::possible_subcommand: arg="bar"
DEBUG:clap:Parser::get_matches_with: possible_sc=false, sc=None
DEBUG:clap:Parser::get_matches_with: Positional counter...1
DEBUG:clap:Parser::get_matches_with: Low index multiples...false
DEBUG:clap:ArgMatcher::process_arg_overrides:None;
DEBUG:clap:Parser::add_val_to_arg; arg=foo, val="bar"
DEBUG:clap:Parser::add_val_to_arg; trailing_vals=false, DontDelimTrailingVals=false
DEBUG:clap:Parser::add_single_val_to_arg;
DEBUG:clap:Parser::add_single_val_to_arg: adding val..."bar"
DEBUG:clap:Parser::groups_for_arg: name=foo
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:ArgMatcher::needs_more_vals: o=foo
DEBUG:clap:ArgMatcher::inc_occurrence_of: arg=foo
DEBUG:clap:Parser::groups_for_arg: name=foo
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:ArgMatcher::process_arg_overrides:Some("foo");
DEBUG:clap:Parser::remove_overrides:[];
DEBUG:clap:Validator::validate;
DEBUG:clap:Parser::add_defaults;
DEBUG:clap:Parser::add_defaults:iter:foo: doesn't have conditional defaults
DEBUG:clap:Parser::add_defaults:iter:foo: doesn't have default vals
DEBUG:clap:Parser::add_defaults:iter:bar: doesn't have conditional defaults
DEBUG:clap:Parser::add_defaults:iter:bar: doesn't have default vals
DEBUG:clap:Validator::validate_blacklist;
DEBUG:clap:Validator::validate_blacklist:iter:foo;
DEBUG:clap:Parser::groups_for_arg: name=foo
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:Validator::validate_required: required=[];
DEBUG:clap:Validator::validate_matched_args;
DEBUG:clap:Validator::validate_matched_args:iter:foo: vals=[
    "bar",
]
DEBUG:clap:Validator::validate_arg_num_vals:foo
DEBUG:clap:Validator::validate_arg_num_occurs: a=foo;
DEBUG:clap:Validator::validate_arg_values: arg="foo"
DEBUG:clap:Validator::validate_arg_requires:foo;
DEBUG:clap:usage::create_usage_with_title;
DEBUG:clap:usage::create_usage_no_title;
DEBUG:clap:usage::get_required_usage_from: reqs=[], extra=None
DEBUG:clap:usage::get_required_usage_from: after init desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: no more children
DEBUG:clap:usage::get_required_usage_from: final desc_reqs=[]
DEBUG:clap:usage::get_required_usage_from: args_in_groups=[]
DEBUG:clap:usage::needs_flags_tag;
DEBUG:clap:usage::needs_flags_tag:iter: f=hclap_help;
DEBUG:clap:usage::needs_flags_tag:iter: f=vclap_version;
DEBUG:clap:usage::needs_flags_tag: [FLAGS] not required
DEBUG:clap:usage::get_args_tag;
DEBUG:clap:usage::get_args_tag:iter:foo:
DEBUG:clap:Parser::groups_for_arg: name=foo
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::get_args_tag:iter: 1 Args not required or hidden
DEBUG:clap:usage::get_args_tag:iter:bar:
DEBUG:clap:Parser::groups_for_arg: name=bar
DEBUG:clap:Parser::groups_for_arg: No groups defined
DEBUG:clap:usage::get_args_tag:iter: 2 Args not required or hidden
DEBUG:clap:usage::get_args_tag:iter: More than one, returning [ARGS]
DEBUG:clap:usage::create_help_usage: usage=example [ARGS]
DEBUG:clap:ArgMatcher::get_global_values: global_arg_vec=[]
foo
```

I hope I didn't understand something wrong in the documentation or missed another issue referencing this.

---

_Label `T: bug` added by @clark-ja on 2021-03-09 15:19_

---

_Comment by @ldm0 on 2021-03-09 15:29_

This is not a bug. The argument you defined is called positional arguments, which takes a value. I guess you want flags, you can try `Arg::with_name("foo").long("foo"), Arg::with_name("bar").long("bar")` and then use `cargo run -- --bar`



---

_Closed by @ldm0 on 2021-03-09 15:29_

---

_Locked by @clap-rs on 2021-03-09 16:32_

---
