---
number: 6011
title: Better suggestions for shorter subcommand misspellings
type: issue
state: open
author: samueltardieu
labels:
  - A-help
assignees: []
created_at: 2025-05-23T08:19:11Z
updated_at: 2025-11-06T19:47:28Z
url: https://github.com/clap-rs/clap/issues/6011
synced_at: 2026-01-07T12:31:17-06:00
---

# Better suggestions for shorter subcommand misspellings

---

_Issue opened by @samueltardieu on 2025-05-23 08:19_

(Some)? shorter subcommands don't seem to get useful suggestions. For example, adding this test in `clap_builder/src/parser/features/suggestions.rs` fails ("gti" is not corrected into "git"):

```rust
        let p_vals = ["git"];
        assert_eq!(
            did_you_mean("gti", p_vals.iter()),
            vec!["git"],
        );
```

However, "gti" is corrected into (only) "util" even if "git" exists, and this test succeeds

```rust
        let p_vals = ["git", "util"];
        assert_eq!(
            did_you_mean("gti", p_vals.iter()),
            vec!["util"],
        );
```

The Jaro similarity between "git" and "gti" is 0.555â€¦, and clap uses a threshold of 0.7. Should the threshold be made variable depending on the length of the input string? Or should a different algorithm (Levenshtein? "util" and "git" would get the same score) be used in some cases?

Context: noticed when I mistyped `jj git fetch` as `jj gti fetch` and it suggested me to use `jj util` instead of `jj git`.

---

_Comment by @epage on 2025-05-23 14:16_

In #4668, we switched from Jaro-Winkler, to Jaro though the bug ix fixed, so we could switch back.

We've been using "Jaro-Winkler" from the beginning, #103.

I played with different algorithms and I'm not sure what a good route to go is.  On short strings, edit distance can also cause us problems.
https://play.rust-lang.org/?version=stable&mode=debug&edition=2024&gist=0a31a7cf27424db68c381c338d1a2a7c

---

_Comment by @samueltardieu on 2025-05-23 17:08_

Jaro-Winkler divided by Damerau-Levenshtein seems to beat others on those samples, but it feels like black magic.

---

_Label `A-help` added by @epage on 2025-11-06 19:47_

---
