---
number: 6100
title: "`name` ignored in usage, showing the binary file name"
type: issue
state: closed
author: winksaville
labels:
  - C-bug
  - A-help
  - S-wont-fix
assignees: []
created_at: 2025-08-10T05:53:39Z
updated_at: 2025-08-12T17:52:19Z
url: https://github.com/clap-rs/clap/issues/6100
synced_at: 2026-01-07T12:31:17-06:00
---

# `name` ignored in usage, showing the binary file name

---

_Issue opened by @winksaville on 2025-08-10 05:53_

### Please complete the following tasks

- [x] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [x] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.89.0 (29483883e 2025-08-04)

### Clap Version

4.5.43

### Minimal reproducible code

main.rs:
```rust
use clap::Parser;

// Arguments for the clap-test application
#[derive(Parser)]
#[command(name = "clap-test-name", version)]
struct Args {}

fn main() {
    Args::parse();
}
```
Cargo.toml:
```
[package]
name = "clap-test"
version = "0.1.0"
edition = "2024"

[dependencies]
clap = { version = "4.5.43", features = ["derive"] }
```

### Steps to reproduce the bug with the above code

Run `-h` and then `-V`:
```bash
cargo run -- -h
cargo run -- -V
```

### Actual Behaviour

The name is different:
```bash
$ cargo run -- -h
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.02s
     Running `target/debug/clap-test -h`
Usage: clap-test

Options:
  -h, --help     Print help
  -V, --version  Print version
$ cargo run -- -V
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.01s
     Running `target/debug/clap-test -V`
clap-test-name 0.1.0
```

### Expected Behaviour

Both should be the same "clap-test-name" or maybe "clap-test":
```bash
$ cargo run -- -h
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.02s
     Running `target/debug/clap-test -h`
Usage: clap-test-name

Options:
  -h, --help     Print help
  -V, --version  Print version
$ cargo run -- -V
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.01s
     Running `target/debug/clap-test -V`
clap-test-name 0.1.0
```

### Additional Context

_No response_

### Debug Output

```bash
$ cargo run -- -h
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.02s
     Running `target/debug/clap-test -h`
[clap_builder::builder::command]Command::_do_parse
[clap_builder::builder::command]Command::_build: name="clap-test-name"
[clap_builder::builder::command]Command::_propagate:clap-test-name
[clap_builder::builder::command]Command::_check_help_and_version:clap-test-name expand_help_tree=false
[clap_builder::builder::command]Command::long_help_exists
[clap_builder::builder::command]Command::_check_help_and_version: Building default --help
[clap_builder::builder::command]Command::_check_help_and_version: Building default --version
[clap_builder::builder::command]Command::_propagate_global_args:clap-test-name
[clap_builder::builder::debug_asserts]Command::_debug_asserts
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:help
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:version
[clap_builder::builder::debug_asserts]Command::_verify_positionals
[clap_builder::parser::parser]Parser::get_matches_with
[clap_builder::parser::parser]Parser::parse
[clap_builder::parser::parser]Parser::get_matches_with: Begin parsing '"-h"'
[clap_builder::parser::parser]Parser::possible_subcommand: arg=Ok("-h")
[clap_builder::parser::parser]Parser::get_matches_with: sc=None
[clap_builder::parser::parser]Parser::parse_short_arg: short_arg=ShortFlags { inner: "h", utf8_prefix: CharIndices { front_offset: 0, iter: Chars(['h']) }, invalid_suffix: None }
[clap_builder::parser::parser]Parser::parse_short_arg:iter:h
[clap_builder::parser::parser]Parser::parse_short_arg:iter:h: Found valid opt or flag
[clap_builder::parser::parser]Parser::react action=Help, identifier=Some(Short), source=CommandLine
[clap_builder::parser::parser]Help: use_long=false
[clap_builder::builder::command]Command::write_help_err: clap-test-name, use_long=false
[  clap_builder::output::help]write_help
[clap_builder::output::help_template]HelpTemplate::new cmd=clap-test-name, use_long=false
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]HelpTemplate::write_templated_help
[clap_builder::output::help_template]HelpTemplate::write_before_help
[ clap_builder::output::usage]Usage::create_usage_no_title
[ clap_builder::output::usage]Usage::create_usage_no_title
[ clap_builder::output::usage]Usage::write_help_usage
[ clap_builder::output::usage]Usage::write_arg_usage; incl_reqs=true
[ clap_builder::output::usage]Usage::needs_options_tag
[ clap_builder::output::usage]Usage::needs_options_tag:iter: f=help
[ clap_builder::output::usage]Usage::needs_options_tag:iter Option is built-in
[ clap_builder::output::usage]Usage::needs_options_tag:iter: f=version
[ clap_builder::output::usage]Usage::needs_options_tag:iter Option is built-in
[ clap_builder::output::usage]Usage::needs_options_tag: [OPTIONS] not required
[ clap_builder::output::usage]Usage::write_args: incls=[]
[ clap_builder::output::usage]Usage::get_args: unrolled_reqs=[]
[ clap_builder::output::usage]Usage::write_subcommand_usage
[ clap_builder::output::usage]Usage::create_usage_no_title: usage=clap-test
[clap_builder::output::help_template]HelpTemplate::write_all_args
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=version
[clap_builder::output::help_template]HelpTemplate::write_args Options
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]HelpTemplate::write_args: arg="help" longest=10
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=version
[clap_builder::output::help_template]HelpTemplate::write_args: arg="version" longest=13
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=help
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--help
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]should_show_arg: use_long=false, arg=version
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--version
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--help
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::short
[clap_builder::output::help_template]HelpTemplate::long
[clap_builder::output::help_template]HelpTemplate::align_to_about: arg=help, next_line_help=false, longest=13
[clap_builder::output::help_template]HelpTemplate::align_to_about: positional=false arg_len=10, spaces=5
[clap_builder::output::help_template]HelpTemplate::help
[clap_builder::output::help_template]HelpTemplate::help: help_width=17, spaces=10, avail=83
[clap_builder::output::help_template]HelpTemplate::spec_vals: a=--version
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found short aliases...[]
[clap_builder::output::help_template]HelpTemplate::spec_vals: Found aliases...[]
[clap_builder::output::help_template]HelpTemplate::short
[clap_builder::output::help_template]HelpTemplate::long
[clap_builder::output::help_template]HelpTemplate::align_to_about: arg=version, next_line_help=false, longest=13
[clap_builder::output::help_template]HelpTemplate::align_to_about: positional=false arg_len=13, spaces=2
[clap_builder::output::help_template]HelpTemplate::help
[clap_builder::output::help_template]HelpTemplate::help: help_width=17, spaces=13, avail=83
[clap_builder::output::help_template]HelpTemplate::write_after_help
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
Usage: clap-test

Options:
  -h, --help     Print help
  -V, --version  Print version
$ cargo run -- -V
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.02s
     Running `target/debug/clap-test -V`
[clap_builder::builder::command]Command::_do_parse
[clap_builder::builder::command]Command::_build: name="clap-test-name"
[clap_builder::builder::command]Command::_propagate:clap-test-name
[clap_builder::builder::command]Command::_check_help_and_version:clap-test-name expand_help_tree=false
[clap_builder::builder::command]Command::long_help_exists
[clap_builder::builder::command]Command::_check_help_and_version: Building default --help
[clap_builder::builder::command]Command::_check_help_and_version: Building default --version
[clap_builder::builder::command]Command::_propagate_global_args:clap-test-name
[clap_builder::builder::debug_asserts]Command::_debug_asserts
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:help
[clap_builder::builder::debug_asserts]Arg::_debug_asserts:version
[clap_builder::builder::debug_asserts]Command::_verify_positionals
[clap_builder::parser::parser]Parser::get_matches_with
[clap_builder::parser::parser]Parser::parse
[clap_builder::parser::parser]Parser::get_matches_with: Begin parsing '"-V"'
[clap_builder::parser::parser]Parser::possible_subcommand: arg=Ok("-V")
[clap_builder::parser::parser]Parser::get_matches_with: sc=None
[clap_builder::parser::parser]Parser::parse_short_arg: short_arg=ShortFlags { inner: "V", utf8_prefix: CharIndices { front_offset: 0, iter: Chars(['V']) }, invalid_suffix: None }
[clap_builder::parser::parser]Parser::parse_short_arg:iter:V
[clap_builder::parser::parser]Parser::parse_short_arg:iter:V: Found valid opt or flag
[clap_builder::parser::parser]Parser::react action=Version, identifier=Some(Short), source=CommandLine
[clap_builder::parser::parser]Version: use_long=false
[clap_builder::builder::command]Command::_render_version
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
[clap_builder::builder::command]Command::color: Color setting...
[clap_builder::builder::command]Auto
clap-test-name 0.1.0
```

---

_Label `C-bug` added by @winksaville on 2025-08-10 05:53_

---

_Label `A-help` added by @epage on 2025-08-11 14:32_

---

_Comment by @epage on 2025-08-11 14:40_

`Command` / `#[command()]` actually has a couple of different fields
- [`name`](https://docs.rs/clap/latest/clap/struct.Command.html#method.name)
  - For subcommands, this is meant to match what the user specified
  - For top-level commands, this serves as the default for `*_name` fields.  This doesn't have much meaning otherwise.
- [`bin_name`](https://docs.rs/clap/latest/clap/struct.Command.html#method.bin_name)
  - This shows up in Usage
- [`display_name`](https://docs.rs/clap/latest/clap/struct.Command.html#method.display_name)
  - This is used in `--version` or any other place where the application is being described.

It is traditional that Usage strings more literally match the command-line used.  For this reason, `bin_name` defaults to `argv[0].file_name()` if being used when parsing and `name` otherwise.  This is what is leading to your discrepancy.  `--help` is generated when parsing a command line, so `binary_name` is `argv[0].file_name()` while in `--version` you are getting a user-facing display name for the program.

---

_Comment by @winksaville on 2025-08-11 19:24_

You've explained why they are different, but should they be different, IMO they shouldn't.

---

_Comment by @epage on 2025-08-11 19:53_

Originally, we only had `name`.  The others were added to address various needs.

For example,
- In many cases, people want their bin name to be `space separated`
- In many cases, people want their display name to be `dash-separated`

A very strong case would need to be made to outweigh what we've already done and it would likely only happen with clap v5.

However, what we can do is see if there is anything we can improve about how these are communicated so people are less likely to be confused.

---

_Comment by @winksaville on 2025-08-11 23:47_

Here is another example using your demo.rs:
```
$ cat src/main.rs 
use clap::Parser;

/// Simple program to greet a person
#[derive(Parser, Debug)]
#[command(version, about, long_about = None)]
struct Args {
    /// Name of the person to greet
    #[arg(short, long)]
    name: String,

    /// Number of times to greet
    #[arg(short, long, default_value_t = 1)]
    count: u8,
}

fn main() {
    let args = Args::parse();

    for _ in 0..args.count {
        println!("Hello {}!", args.name);
    }
}
$ cat Cargo.toml 
[package]
name = "demo"
version = "0.1.0"
description = "A demo project using clap"
edition = "2024"

[dependencies]
clap = { version = "4.5.43", features = ["derive"] }
```

Install it:
```
$ cargo install --path .
  Installing demo v0.1.0 (/home/wink/data/prgs/clap/demo)
    Updating crates.io index
     Locking 30 packages to latest Rust 1.89.0 compatible versions
    Finished `release` profile [optimized] target(s) in 0.21s
  Installing /home/wink/.cargo/bin/demo
   Installed package `demo v0.1.0 (/home/wink/data/prgs/clap/demo)` (executable `demo`)
```

The default behavior is `-h` and `-V` are the same, as we expect:
```
$ demo -h
A demo project using clap

Usage: demo [OPTIONS] --name <NAME>

Options:
  -n, --name <NAME>    Name of the person to greet
  -c, --count <COUNT>  Number of times to greet [default: 1]
  -h, --help           Print help
  -V, --version        Print version
$ demo -V
demo 0.1.0
```

But now lets rename `demo` to `demoz`.

We see `-h` is `demoz` and `-V` is `demo`:
```
$ mv ~/.cargo/bin/demo ~/.cargo/bin/demoz
$ demoz -h
A demo project using clap

Usage: demoz [OPTIONS] --name <NAME>

Options:
  -n, --name <NAME>    Name of the person to greet
  -c, --count <COUNT>  Number of times to greet [default: 1]
  -h, --help           Print help
  -V, --version        Print version
$ demoz -V
demo 0.1.0
```

That doesn't feel right to me, but renaming an executable is an infrequent corner case and maybe not important.

---

_Comment by @epage on 2025-08-12 13:25_

Yes, Usage using the user-specified file name for the binary is partially what this is about, as mentioned at https://github.com/clap-rs/clap/issues/6100#issuecomment-3175169003

> It is traditional that Usage strings more literally match the command-line used. For this reason, `bin_name` defaults to `argv[0].file_name()` if being used when parsing and `name` otherwise. This is what is leading to your discrepancy. `--help` is generated when parsing a command line, so `binary_name` is `argv[0].file_name()` while in `--version` you are getting a user-facing display name for the program.

Some programs take this further and don't use `.file_name()` but use the full path.  So if you do `./target/debug/demoz`, then that whole string will appear in the usage, rather than just `demoz` like clap does.

---

_Comment by @winksaville on 2025-08-12 14:19_

So what do you think the solution for this issue?

---

_Comment by @epage on 2025-08-12 16:36_

I lean towards closing this because it is working as expected.

---

_Comment by @winksaville on 2025-08-12 17:45_

Your decision, but I think it's unexpected, but that's just me :)

---

_Closed by @epage on 2025-08-12 17:51_

---

_Label `S-wont-fix` added by @epage on 2025-08-12 17:52_

---

_Renamed from "Name field can be incorrect" to "`name` ignored in usage, showing the binary file name" by @epage on 2025-08-12 17:52_

---
