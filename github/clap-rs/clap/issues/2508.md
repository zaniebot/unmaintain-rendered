---
number: 2508
title: number_of_values should have improved help message
type: issue
state: closed
author: kunzaatko
labels:
  - C-enhancement
  - A-help
  - ":money_with_wings: $5"
assignees: []
created_at: 2021-05-29T09:14:04Z
updated_at: 2021-07-25T13:23:21Z
url: https://github.com/clap-rs/clap/issues/2508
synced_at: 2026-01-07T12:31:17-06:00
---

# number_of_values should have improved help message

---

_Issue opened by @kunzaatko on 2021-05-29 09:14_

### Please complete the following tasks

- [x] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Rust Version

rustc 1.52.1 (9bc8c42bb 2021-05-09)

### Clap Version

3.0.0-beta.2

### Minimal reproducible code

```rust
use clap::{App, Arg};

fn main() {
    let my_app = App::new("my_app")
        .arg(Arg::new("some_arg").long("some_arg").number_of_values(2))
        .arg(
            Arg::new("some_arg_issue")
                .long("some_arg_issue")
                .number_of_values(2)
                .value_name("ARG"),
        )
        .get_matches();
}
```


### Steps to reproduce the bug with the above code

cargo run -- --help

### Actual Behaviour

The `some_arg` argument has 2 values in the help page.
The `some_arg_issue` argument has only one value in the help page.

Whenever you add a name to the value, the number of arguments required is not represented in the help page.

[![asciicast](https://asciinema.org/a/5pGWQPNM27rxKnnUYvvkP20Nv.svg)](https://asciinema.org/a/5pGWQPNM27rxKnnUYvvkP20Nv)

### Expected Behaviour

The number of arguments should be preserved in the help page even when the `value_name` is specified.

### Additional Context

When I use `multiple()` than the normal '...' is represented in the help page.

### Debug Output

[            clap::build::app] 	App::_do_parse
[            clap::build::app] 	App::_build
[            clap::build::app] 	App::_propagate:my_app
[            clap::build::app] 	App::_derive_display_order:my_app
[            clap::build::app] 	App::_create_help_and_version
[            clap::build::app] 	App::_create_help_and_version: Building --help
[            clap::build::app] 	App::_create_help_and_version: Building --version
[clap::build::app::debug_asserts] 	App::_debug_asserts
[            clap::build::arg] 	Arg::_debug_asserts:some_arg
[            clap::build::arg] 	Arg::_debug_asserts:some_arg_issue
[            clap::build::arg] 	Arg::_debug_asserts:help
[            clap::build::arg] 	Arg::_debug_asserts:version
[         clap::parse::parser] 	Parser::get_matches_with
[         clap::parse::parser] 	Parser::_build
[         clap::parse::parser] 	Parser::_verify_positionals
[         clap::parse::parser] 	Parser::get_matches_with: Begin parsing '"--help"' ([45, 45, 104, 101, 108, 112])
[         clap::parse::parser] 	Parser::is_new_arg: "--help":NotFound
[         clap::parse::parser] 	Parser::is_new_arg: arg_allows_tac=false
[         clap::parse::parser] 	Parser::is_new_arg: -- found
[         clap::parse::parser] 	Parser::is_new_arg: starts_new_arg=true
[         clap::parse::parser] 	Parser::possible_subcommand: arg="--help"
[         clap::parse::parser] 	Parser::get_matches_with: possible_sc=false, sc=None
[         clap::parse::parser] 	Parser::parse_long_arg
[         clap::parse::parser] 	Parser::parse_long_arg: Does it contain '='...
[         clap::parse::parser] 	No
[         clap::parse::parser] 	Parser::parse_long_arg: Found valid opt or flag '--help'
[         clap::parse::parser] 	Parser::check_for_help_and_version_str
[         clap::parse::parser] 	Parser::check_for_help_and_version_str: Checking if --"help" is help or version...
[         clap::parse::parser] 	Help
[         clap::parse::parser] 	[         clap::parse::parser] 	Parser::use_long_help
Parser::help_err: use_long=false
[         clap::parse::parser] 	Parser::use_long_help
[         clap::parse::parser] 	Parser::color_help
[          clap::output::help] 	Help::new
[          clap::output::help] 	Help::write_help
[          clap::output::help] 	Help::write_templated_help
[          clap::output::help] 	Help::write_bin_name
[         clap::output::usage] 	Usage::create_usage_no_title
[         clap::output::usage] 	Usage::create_help_usage; incl_reqs=true
[         clap::output::usage] 	Usage::get_required_usage_from: incls=[], matcher=false, incl_last=false
[         clap::output::usage] 	Usage::get_required_usage_from: unrolled_reqs=[]
[         clap::output::usage] 	Usage::get_required_usage_from: ret_val=[]
[         clap::output::usage] 	Usage::needs_flags_tag
[         clap::output::usage] 	Usage::needs_flags_tag:iter: f=help
[         clap::output::usage] 	Usage::needs_flags_tag:iter: f=version
[         clap::output::usage] 	Usage::needs_flags_tag: [FLAGS] not required
[         clap::output::usage] 	Usage::create_help_usage: usage=clap_issue [OPTIONS]
[          clap::output::help] 	Help::write_all_args
[          clap::output::help] 	should_show_arg: use_long=false, arg=some_arg
[          clap::output::help] 	should_show_arg: use_long=false, arg=some_arg_issue
[          clap::output::help] 	Help::write_args
[          clap::output::help] 	should_show_arg: use_long=false, arg=help
[          clap::output::help] 	Help::write_args: Current Longest...2
[          clap::output::help] 	Help::write_args: New Longest...6
[          clap::output::help] 	should_show_arg: use_long=false, arg=version
[          clap::output::help] 	Help::write_args: Current Longest...6
[          clap::output::help] 	Help::write_args: New Longest...9
[          clap::output::help] 	Help::write_arg
[          clap::output::help] 	Help::short
[          clap::output::help] 	Help::long
[          clap::output::help] 	Help::val: arg=help
[          clap::output::help] 	Help::spec_vals: a=--help
[          clap::output::help] 	Help::val: Has switch...
[          clap::output::help] 	Yes
[          clap::output::help] 	Help::val: force_next_line...false
[          clap::output::help] 	Help::val: nlh...false
[          clap::output::help] 	Help::val: taken...21
[          clap::output::help] 	val: help_width > (width - taken)...23 > (100 - 21)
[          clap::output::help] 	Help::val: longest...9
[          clap::output::help] 	Help::val: next_line...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_nspaces!: num=7
[          clap::output::help] 	Help::help
[          clap::output::help] 	Help::help: Next Line...false
[          clap::output::help] 	Help::help: Too long...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_arg
[          clap::output::help] 	Help::short
[          clap::output::help] 	Help::long
[          clap::output::help] 	Help::val: arg=version
[          clap::output::help] 	Help::spec_vals: a=--version
[          clap::output::help] 	Help::val: Has switch...
[          clap::output::help] 	Yes
[          clap::output::help] 	Help::val: force_next_line...false
[          clap::output::help] 	Help::val: nlh...false
[          clap::output::help] 	Help::val: taken...21
[          clap::output::help] 	val: help_width > (width - taken)...26 > (100 - 21)
[          clap::output::help] 	Help::val: longest...9
[          clap::output::help] 	Help::val: next_line...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_nspaces!: num=4
[          clap::output::help] 	Help::help
[          clap::output::help] 	Help::help: Next Line...false
[          clap::output::help] 	Help::help: Too long...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_args
[          clap::output::help] 	should_show_arg: use_long=false, arg=some_arg
[          clap::output::help] 	Help::write_args: Current Longest...2
[          clap::output::help] 	Help::write_args: New Longest...32
[          clap::output::help] 	should_show_arg: use_long=false, arg=some_arg_issue
[          clap::output::help] 	Help::write_args: Current Longest...32
[          clap::output::help] 	Help::write_args: New Longest...32
[          clap::output::help] 	Help::write_arg
[          clap::output::help] 	Help::short
[          clap::output::help] 	Help::long
[          clap::output::help] 	Help::val: arg=some_arg
[          clap::output::help] 	Help::spec_vals: a=--some_arg <some_arg> <some_arg>
[          clap::output::help] 	Help::val: Has switch...
[          clap::output::help] 	Yes
[          clap::output::help] 	Help::val: force_next_line...false
[          clap::output::help] 	Help::val: nlh...false
[          clap::output::help] 	Help::val: taken...44
[          clap::output::help] 	val: help_width > (width - taken)...0 > (100 - 44)
[          clap::output::help] 	Help::val: longest...32
[          clap::output::help] 	Help::val: next_line...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_nspaces!: num=4
[          clap::output::help] 	Help::help
[          clap::output::help] 	Help::help: Next Line...false
[          clap::output::help] 	Help::help: Too long...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_arg
[          clap::output::help] 	Help::short
[          clap::output::help] 	Help::long
[          clap::output::help] 	Help::val: arg=some_arg_issue
[          clap::output::help] 	Help::spec_vals: a=--some_arg_issue <ARG>
[          clap::output::help] 	Help::val: Has switch...
[          clap::output::help] 	Yes
[          clap::output::help] 	Help::val: force_next_line...false
[          clap::output::help] 	Help::val: nlh...false
[          clap::output::help] 	Help::val: taken...44
[          clap::output::help] 	val: help_width > (width - taken)...0 > (100 - 44)
[          clap::output::help] 	Help::val: longest...32
[          clap::output::help] 	Help::val: next_line...
[          clap::output::help] 	No
[          clap::output::help] 	Help::write_nspaces!: num=14
[          clap::output::help] 	Help::help
[          clap::output::help] 	Help::help: Next Line...false
[          clap::output::help] 	Help::help: Too long...
[          clap::output::help] 	No
[           clap::output::fmt] 	is_a_tty: stderr=false
my_app 

USAGE:
    clap_issue [OPTIONS]

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

OPTIONS:
        --some_arg <some_arg> <some_arg>    
        --some_arg_issue <ARG>              


---

_Label `T: bug` added by @kunzaatko on 2021-05-29 09:14_

---

_Comment by @kunzaatko on 2021-05-29 10:06_

I am aware of `value_names` but this should probably also work.

---

_Comment by @ldm0 on 2021-05-29 10:08_

Have you tried it with current master?

---

_Comment by @kunzaatko on 2021-05-29 15:30_

I have now. The output changed for `some_arg_issue` to `<ARG>...`. This is still not the desired outcome, which would be `<ARG> <ARG>`.

---

_Renamed from "Number of arguments false when the `value_name` is specified" to "number_of_values should have improved help message" by @pksunkara on 2021-05-29 20:31_

---

_Label `T: bug` removed by @pksunkara on 2021-05-29 20:31_

---

_Label `:money_with_wings: $5` added by @pksunkara on 2021-05-29 20:31_

---

_Label `C: help message` added by @pksunkara on 2021-05-29 20:31_

---

_Label `T: enhancement` added by @pksunkara on 2021-05-29 20:31_

---

_Referenced in [clap-rs/clap#2610](../../clap-rs/clap/pulls/2610.md) on 2021-07-20 19:40_

---

_Closed by @pksunkara on 2021-07-25 13:23_

---
