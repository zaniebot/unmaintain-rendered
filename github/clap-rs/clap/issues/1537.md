---
number: 1537
title: How can I handle this case which requires any group
type: issue
state: open
author: oblique
labels:
  - C-enhancement
  - E-medium
  - A-validators
  - ":money_with_wings: $20"
assignees: []
created_at: 2019-08-28T16:20:29Z
updated_at: 2021-12-09T20:07:28Z
url: https://github.com/clap-rs/clap/issues/1537
synced_at: 2026-01-07T12:31:16-06:00
---

# How can I handle this case which requires any group

---

_Issue opened by @oblique on 2019-08-28 16:20_

I have a special flag which when it is set I want always one of two groups to match. This special flag should never passed alone.

To be more clear I created a simple example on what I want to achieve:

```rust
use clap::{App, Arg, ArgGroup};

fn main() {
    let mut app = App::new("my-app")
        .arg(Arg::with_name("special").long("special"))
        .arg(Arg::with_name("opt-a1").long("opt-a1"))
        .arg(Arg::with_name("opt-a2").long("opt-a2"))
        .arg(Arg::with_name("opt-b1").long("opt-b1"))
        .arg(Arg::with_name("opt-b2").long("opt-b2"))
        .group(
            ArgGroup::with_name("special-and-opt-a")
                .args(&["opt-a1", "opt-a2"])
                .requires_all(&["special", "opt-a1", "opt-a2"])
                .conflicts_with("special-and-opt-b")
                .multiple(true)
                .required(false),
        )
        .group(
            ArgGroup::with_name("special-and-opt-b")
                .args(&["opt-b1", "opt-b2"])
                .requires_all(&["special", "opt-b1", "opt-b2"])
                .conflicts_with("special-and-opt-a")
                .multiple(true)
                .required(false),
        );

    let valid_cases = vec![
        vec!["my-app"],
        vec!["my-app", "--special", "--opt-a1", "--opt-a2"],
        vec!["my-app", "--special", "--opt-b1", "--opt-b2"],
    ];

    let invalid_cases = vec![
        vec!["my-app", "--opt-a1", "--opt-a2"],
        vec!["my-app", "--opt-b1", "--opt-b2"],
        vec!["my-app", "--special"],
        vec!["my-app", "--special", "--opt-a1"],
        vec!["my-app", "--special", "--opt-b1"],
        vec!["my-app", "--special", "--opt-a1", "--opt-a2", "--opt-b1"],
        vec!["my-app", "--special", "--opt-b1", "--opt-b2", "--opt-a1"],
        vec!["my-app", "--special", "--opt-a1", "--opt-a2", "--opt-b1", "-opt-b2"],
    ];

    for x in valid_cases {
        assert!(app.get_matches_from_safe_borrow(x).is_ok());
    }

    for x in invalid_cases {
        assert!(app.get_matches_from_safe_borrow(x).is_err());
    }
}
```

The case which I can not find how to handle is ` ["my-app", "--special"]`. Of-course I can workaround this with `is_present`, but I'm curious if there is a solution via groups. Maybe this is a valid case where `requires_any` is needed.

---

_Assigned to @CreepySkeleton by @CreepySkeleton on 2020-02-01 12:47_

---

_Label `not-sure` added by @CreepySkeleton on 2020-02-01 14:28_

---

_Comment by @CreepySkeleton on 2020-02-06 09:04_

maybe we need to introduce `requires_any(&[group/option])`?

---

_Label `cc: CreepySkeleton` removed by @CreepySkeleton on 2020-02-06 09:05_

---

_Label `C: parsing` added by @CreepySkeleton on 2020-02-06 09:05_

---

_Label `P4: nice to have` added by @CreepySkeleton on 2020-02-06 09:05_

---

_Label `T: new feature` added by @CreepySkeleton on 2020-02-06 09:05_

---

_Label `W: 3.x` added by @CreepySkeleton on 2020-02-06 09:05_

---

_Added to milestone `3.1` by @CreepySkeleton on 2020-02-06 09:05_

---

_Unassigned @CreepySkeleton by @CreepySkeleton on 2020-02-06 09:08_

---

_Label `W: 3.x` removed by @pksunkara on 2021-08-13 10:40_

---

_Comment by @nrdxp on 2021-08-25 22:31_

Just ran into this situation today, and could use a `requires_any`

---

_Label `D: medium` added by @pksunkara on 2021-08-31 10:58_

---

_Label `:money_with_wings: 20` added by @pksunkara on 2021-08-31 11:00_

---

_Referenced in [epage/clapng#122](../../epage/clapng/issues/122.md) on 2021-12-06 18:35_

---

_Label `T: new feature` removed by @epage on 2021-12-08 21:16_

---

_Label `C-enhancement` added by @epage on 2021-12-08 21:16_

---

_Label `P4: nice to have` removed by @epage on 2021-12-09 20:07_

---

_Label `D: medium` removed by @epage on 2021-12-09 20:07_

---

_Label `A-parsing` removed by @epage on 2021-12-09 20:07_

---

_Label `A-validators` added by @epage on 2021-12-09 20:07_

---

_Label `E-medium` added by @epage on 2021-12-09 20:07_

---

_Removed from milestone `3.1` by @epage on 2021-12-09 20:07_

---
