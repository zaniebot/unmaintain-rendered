---
number: 4360
title: "line wrap unpredictable in after|before_long_help on input containing ascii control sequences"
type: issue
state: closed
author: hargut
labels:
  - C-bug
assignees: []
created_at: 2022-10-08T17:10:29Z
updated_at: 2022-10-09T00:57:22Z
url: https://github.com/clap-rs/clap/issues/4360
synced_at: 2026-01-07T12:31:17-06:00
---

# line wrap unpredictable in after|before_long_help on input containing ascii control sequences

---

_Issue opened by @hargut on 2022-10-08 17:10_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.63.0 (4b91a6ea7 2022-08-08)

### Clap Version

4.0.10

### Minimal reproducible code

Inline did not work, as code contains ```. Some parts of the sample are based on [ockam](https://github.com/build-trust/ockam) source.

[https://raw.githubusercontent.com/hargut/clap/fix/minimal-example/minimal_sample.rs](https://raw.githubusercontent.com/hargut/clap/fix/minimal-example/minimal_sample.rs)


### Steps to reproduce the bug with the above code

execute result with `--help`

### Actual Behaviour

line wraps are unpredictable, and too early when containing e.g. syntax highlighted text (ascii control sequences)

### Expected Behaviour

correct line wraps

### Additional Context

_No response_

### Debug Output

_No response_

---

_Label `C-bug` added by @hargut on 2022-10-08 17:10_

---

_Referenced in [clap-rs/clap#4361](../../clap-rs/clap/pulls/4361.md) on 2022-10-08 17:11_

---

_Referenced in [build-trust/ockam#3622](../../build-trust/ockam/pulls/3622.md) on 2022-10-08 17:12_

---

_Referenced in [build-trust/ockam#3434](../../build-trust/ockam/issues/3434.md) on 2022-10-08 17:15_

---

_Closed by @epage on 2022-10-09 00:57_

---
