---
number: 6178
title: Completion of FilePath adds space in zsh
type: issue
state: closed
author: windsource
labels:
  - C-bug
  - E-medium
  - A-completion
  - E-help-wanted
assignees: []
created_at: 2025-11-05T09:54:01Z
updated_at: 2025-12-30T13:46:10Z
url: https://github.com/clap-rs/clap/issues/6178
synced_at: 2026-01-07T12:31:17-06:00
---

# Completion of FilePath adds space in zsh

---

_Issue opened by @windsource on 2025-11-05 09:54_

### Please complete the following tasks

- [x] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [x] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.91.0 (f8297e351 2025-10-28)

### Clap Version

clap 4.5.51, clap_complete 4.5.60

### Minimal reproducible code

```rust
use std::path::PathBuf;

use clap::{CommandFactory, Parser, ValueHint};
use clap_complete::CompleteEnv;

#[derive(Parser, Debug, PartialEq)]
#[command(name = "mycomp")]
struct Opt {
    #[arg(value_hint = ValueHint::FilePath)]
    file: PathBuf,
}

fn main() {
    CompleteEnv::with_factory(|| Opt::command()).complete();
    let opt = Opt::parse();

    println!("{:#?}", opt.file);
}
```


### Steps to reproduce the bug with the above code

If the binary is called `mycomp`, then in zsh (not bash!):

```shell
source <(COMPLETE=zsh mycomp)
```

Then assume your current folder looks like

```
. -
  +- sub1
     +- sub2
```

Then using completion like

```
mycomp <TAB>
```

### Actual Behaviour

You get

```
mycomp sub1/<SPACE>
```

so pressing tab again will not show `sub2`. In bash the behavior is correct (not adding space here).

### Expected Behaviour

If there are still files or sub folders available for completion, no space should be added (same as in bash).

### Additional Context

Based on discussion in https://github.com/clap-rs/clap/discussions/6176

### Debug Output

_No response_

---

_Label `C-bug` added by @windsource on 2025-11-05 09:54_

---

_Label `S-triage` added by @windsource on 2025-11-05 09:54_

---

_Label `A-completion` added by @epage on 2025-11-05 14:45_

---

_Label `E-medium` added by @epage on 2025-11-05 14:46_

---

_Label `E-help-wanted` added by @epage on 2025-11-05 14:46_

---

_Label `S-triage` removed by @epage on 2025-11-05 14:46_

---

_Referenced in [eclipse-ankaios/ankaios#614](../../eclipse-ankaios/ankaios/issues/614.md) on 2025-11-06 08:02_

---

_Referenced in [clap-rs/clap#6203](../../clap-rs/clap/pulls/6203.md) on 2025-12-30 05:21_

---

_Closed by @epage on 2025-12-30 13:46_

---
