---
number: 1518
title: "idea: generate the yaml representation from mocked CLI usage"
type: issue
state: closed
author: nilslice
labels:
  - S-waiting-on-decision
assignees: []
created_at: 2019-07-07T20:26:41Z
updated_at: 2020-02-06T19:37:26Z
url: https://github.com/clap-rs/clap/issues/1518
synced_at: 2026-01-07T12:31:16-06:00
---

# idea: generate the yaml representation from mocked CLI usage

---

_Issue opened by @nilslice on 2019-07-07 20:26_

Hi - great work on `clap`! I am starting a CLI-related project and upon seeing `clap`'s support for a YAML-based representation, I thought maybe my project could be a PR to `clap` instead.. apologies for using a GitHub issue for this, but I figured others who use `clap` might also be interested. 

I'm working on a CLI "generator".. call it `cli-gen`, which allows a developer to _generate_ their CLI code by pretending to invoke the CLI app and it's flags/arguments before anything exists. For example, say I have an image resizing library, and I'd like to wrap it in a CLI.. I'd want to use this new CLI (call it `img-size`) like so:

```sh
$ img-size -i original.jpg -o resized.jpg --keep-proportion --max-width=420
```

If parsed well, the following can be inferred:
- command name: `img-size`
- arg: `i` _string_
- arg: `o` _string_
- arg: `keep-proportion` _boolean_
- arg: `max-width` _int_

The same parser could tell if there were subcommands, if no `-`/`--` token is found before an argument, after which it would recursively parse its args. Poorly illustrated, but for example: 

```sh
$ img-size convert -i original.jpg -o resized.png --conversion=jpg-to-png
```

The parser would capture the _intent_ of the CLI to be generated, and store some pseudo "intermediate representation" of the CLI in YAML (this is how I found your project)... we'd generate the YAML, use `clap`'s ability to turn that into Rust code, but also provide utils to go from YAML to Go, PHP, Bash, Python, etc.  

The ultimate usage would be something like:

1. generate your CLI representation:
```sh
$ cli-gen new img-size -i original.jpg -o resized.jpg --keep-proportion --max-width=420
> created "img-size.yml"
```
- this outputs the same structured [YAML](https://github.com/clap-rs/clap/blob/master/examples/17_yaml.yml) you have already defined, but with empty fields where the developer can fill more detail in (like long name if only short was used) 

2. modify/add sub-commands, etc. 
```sh
$ cli-gen add img-size convert -i original.jpg -o resized.png --conversion=jpg-to-png
> added "convert" sub-command to "img-size.yml"
```
- this would decode the YAML file (expected to exist), add a new sub-command `convert` along with the parsed arguments and example values, and encode it back to YAML on disk. 

3. generate language specific code to bind CLI usage to a developers codebase/lib
```sh
$ cli-gen generate -o python ./img-size.yml
```
- this assumes there is a executble called `cli-gen-python`  in the system $PATH which is invoked, and passed the `./img-size.yml` bytes to its `stdin`. `cli-gen-python` would read the YAML, decode it to then generate the file(s) needed for the python code to use as CLI bindings. 

If you don't think this belongs _within_ `clap`, that's all I need to know :) I figured I'd reach out in case this was something you'd like to support. Otherwise, I'll probably still use `clap` as the primary arg parser, and try to leverage your data structures for the YAML representation too. ~~Also, I noticed #1515 (whose name caught my eye as possibly similar) but couldn't find much about it...~~ I now see it's a separate project -- my bad! 

---

_Label `C: other` added by @CreepySkeleton on 2020-02-01 13:08_

---

_Label `W: maybe` added by @CreepySkeleton on 2020-02-01 13:08_

---

_Comment by @pksunkara on 2020-02-06 19:26_

While I think it is intriguing, I am not sure it falls into Clap's scope. You can generate a Clap template though.

---

_Comment by @nilslice on 2020-02-06 19:37_

Yea I agree - thanks for the input! Will close.

---

_Closed by @nilslice on 2020-02-06 19:37_

---
