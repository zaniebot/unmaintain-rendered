---
number: 1579
title: How to implement status flag?
type: issue
state: closed
author: hanusek
labels: []
assignees: []
created_at: 2019-10-23T16:13:09Z
updated_at: 2019-10-25T08:52:42Z
url: https://github.com/clap-rs/clap/issues/1579
synced_at: 2026-01-07T12:31:17-06:00
---

# How to implement status flag?

---

_Issue opened by @hanusek on 2019-10-23 16:13_

Hello, I'm implementing my daemon.
I would like have a status flag ( daemon status : **running** / **not running**) and other any else args.
Only the one arg is required (SERIAL-PORT). When I enter status then program must returned status - running or not running.

### Code
```
 let matches = App::new("My daemon")
                          .version("1.0")
                          .arg(Arg::with_name("status")
                            .short("s")
                            .long("status")
                            .help("Daemon status"))
                          .arg(Arg::with_name("SERIAL-PORT")
                               .help("Sets the serial-port to use")
                               .required(true)
                               .index(1))
                          .arg(Arg::with_name("BAUD-RATE")
                               .help("Sets the serial-port baud-rate to use")
                               .default_value("115200")
                               .index(2))
                          .arg(Arg::with_name("IP-ADDRESS")
                               .help("Sets the ip-address to use")
                               .default_value("0.0.0.0")
                               .index(3))
                         .arg(Arg::with_name("daemon")
                            .short("d")
                            .long("daemon")
                            .help("Daemonize a application"))
                         .get_matches();
```

---

_Comment by @CreepySkeleton on 2019-10-23 16:34_

And your question being..? The snippet above should work well.

Also, you don't need explicit `.index()` calls here, clap will assign them for you.

---

_Comment by @hanusek on 2019-10-24 13:30_

CreepySkeleton, 
My result : 
```
mhanusek@EtHanusek:~/work/tcp_server$ ./target/debug/tcp_server --status
error: The following required arguments were not provided:
    <SERIAL-PORT>

USAGE:
    tcp_server <SERIAL-PORT> --status

For more information try --help
```
Program require < SERIAL-PORT > with --status.
Same 'status' should work. How to do it?


---

_Comment by @CreepySkeleton on 2019-10-24 18:01_

OK, let me summarize it. 
Your program can be called with *either*:
- single `--status` flag, no other flags should be present
- `"SERIAL-PORT"`, `"BAUD-RATE"`, `"IP-ADDRESS"`, and `"daemon"` flags, only "SERIAL-PORT" is required.

If this is correct, that's how you do it:
```rust
App::new("My daemon")
    .version("1.0")
    .arg(Arg::with_name("status")
        .conflicts_with_all(&[
            "SERIAL-PORT",
            "BAUD-RATE",
            "IP-ADDRESS",
            "daemon"
        ])
        .short("s")
        .long("status")
        .help("Daemon status"))
    .arg(Arg::with_name("BAUD-RATE")
        .help("Sets the serial-port baud-rate to use")
        .default_value("115200"))
    .arg(Arg::with_name("IP-ADDRESS")
        .help("Sets the ip-address to use")
        .default_value("0.0.0.0"))
    arg(Arg::with_name("daemon")
        .short("d")
        .long("daemon")
        .help("Daemonize a application"))
    .arg(Arg::with_name("SERIAL-PORT")
        .help("Sets the serial-port to use")
        .required_unless("status"))   // <-- it's not required if "-s" is present
    .get_matches();
```

Also, [conflicting rules take precedence over being required](https://docs.rs/clap/2.33.0/clap/struct.Arg.html#method.required), so I believe you should be able to replace `required_unless("status")` with `required(true)` just well.

FYI, if you want to directly reply to someone and notify him, you should do it like this: @CreepySkeleton

---

_Referenced in [clap-rs/clap#1583](../../clap-rs/clap/issues/1583.md) on 2019-10-24 18:58_

---

_Comment by @hanusek on 2019-10-25 08:52_

CreepySkeleton, Thanks!

---

_Closed by @hanusek on 2019-10-25 08:52_

---
