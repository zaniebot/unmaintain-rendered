---
number: 3676
title: InvalidSubcommand and UnrecognizedSubcommand are redundant
type: issue
state: closed
author: epage
labels:
  - C-bug
  - M-breaking-change
  - A-help
  - E-easy
assignees: []
created_at: 2022-05-02T17:04:32Z
updated_at: 2022-07-22T17:24:28Z
url: https://github.com/clap-rs/clap/issues/3676
synced_at: 2026-01-07T12:31:17-06:00
---

# InvalidSubcommand and UnrecognizedSubcommand are redundant

---

_Issue opened by @epage on 2022-05-02 17:04_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

rustc 1.57.0 (f1edd0429 2021-11-29)

### Clap Version

3.1.13

### Minimal reproducible code

```rust
#[cfg(feature = "unstable-multicall")]
#[test]
fn bad_multicall_command_error() {
    let cmd = Command::new("repl")
        .version("1.0.0")
        .propagate_version(true)
        .multicall(true)
        .subcommand(Command::new("foo"))
        .subcommand(Command::new("bar"));

    let err = cmd.clone().try_get_matches_from(&["world"]).unwrap_err();
    assert_eq!(err.kind(), ErrorKind::UnrecognizedSubcommand);
    static HELLO_EXPECTED: &str = "\
error: The subcommand 'world' wasn't recognized

USAGE:
    <SUBCOMMAND>

For more information try help
";
    utils::assert_eq(HELLO_EXPECTED, err.to_string());

    let err = cmd.clone().try_get_matches_from(&["baz"]).unwrap_err();
    assert_eq!(err.kind(), ErrorKind::InvalidSubcommand);
    static BAZ_EXPECTED: &str = "\
error: The subcommand 'baz' wasn't recognized

\tDid you mean 'bar'?

If you believe you received this message in error, try re-running with ' -- baz'

USAGE:
    <SUBCOMMAND>

For more information try help
";
    utils::assert_eq(BAZ_EXPECTED, err.to_string());

    // Verify whatever we did to get the above to work didn't disable `--help` and `--version`.

    let err = cmd
        .clone()
        .try_get_matches_from(&["foo", "--help"])
        .unwrap_err();
    assert_eq!(err.kind(), ErrorKind::DisplayHelp);

    let err = cmd
        .clone()
        .try_get_matches_from(&["foo", "--version"])
        .unwrap_err();
    assert_eq!(err.kind(), ErrorKind::DisplayVersion);
}
```

### Steps to reproduce the bug with the above code

Run the above code

### Actual Behaviour

Suggested fixes are one error kind while lack of suggestion is another

### Expected Behaviour

A single error kind with the nuance handled in the error context

### Additional Context

_No response_

### Debug Output

_No response_

---

_Label `C-bug` added by @epage on 2022-05-02 17:04_

---

_Label `M-breaking-change` added by @epage on 2022-05-02 17:04_

---

_Label `A-help` added by @epage on 2022-05-02 17:04_

---

_Label `E-easy` added by @epage on 2022-05-02 17:04_

---

_Added to milestone `4.0` by @epage on 2022-05-02 17:04_

---

_Referenced in [clap-rs/clap#3968](../../clap-rs/clap/pulls/3968.md) on 2022-07-22 17:13_

---

_Closed by @epage on 2022-07-22 17:24_

---
