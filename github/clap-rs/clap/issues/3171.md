---
number: 3171
title: Make it easier to use clap validators with derive by generating arg associated constants?
type: issue
state: open
author: epage
labels:
  - C-enhancement
  - A-derive
  - S-experimental
assignees: []
created_at: 2021-12-14T00:31:48Z
updated_at: 2022-02-10T19:47:21Z
url: https://github.com/clap-rs/clap/issues/3171
synced_at: 2026-01-07T12:31:17-06:00
---

# Make it easier to use clap validators with derive by generating arg associated constants?

---

_Issue opened by @epage on 2021-12-14 00:31_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the existing issues

### Clap Version

3.0.0-rc.4

### Describe your use case

When deriving, if you define a group, deal with requires, conflicts, overrides, etc, then you need to reference the field name.  You can type it out and `App::debug_assert` will fail if you get it wrong.

Example
```rust
#[derive(Debug, Parser)]
struct Opts {
    #[clap(long, conflicts_with = "hello-world")] // I thought it should be hello_world
    one: Option<String>,
    #[clap(long)]
    hello_world: Option<String>,
}
```

### Describe the solution you'd like

What if instead we generated something like
```rust
impl Opt {
    const ONE_CLAP_ARG: &str = "one";
    const HELLO_WORLD_CLAP_ARG: &str = "hello-world";
}
```
So you could do
```rust
#[derive(Debug, Parser)]
struct Opts {
    #[clap(long, conflicts_with = Opts::HELLO_WORLD_CLAP_ARG)]
    one: Option<String>,
    #[clap(long)]
    hello_world: Option<String>,
}
```
I'm assuming this will work with macro expansion

### Alternatives, if applicable

Provide helpers to avoid it, like #3165

### Additional Context

This was inspired by #2475

---

_Label `C-enhancement` added by @epage on 2021-12-14 00:31_

---

_Label `A-derive` added by @epage on 2021-12-14 00:31_

---

_Label `S-experimental` added by @epage on 2021-12-14 00:31_

---

_Comment by @epage on 2022-02-10 19:47_

Benefits:
- Move errors to compile time

Downsides
- I personally find it confusing accessing items generated by a macro that are unrelated to the trait
- Potential name conflicts

---

_Referenced in [clap-rs/clap#3846](../../clap-rs/clap/issues/3846.md) on 2022-06-17 21:59_

---
