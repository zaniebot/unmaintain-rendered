---
number: 4729
title: "Generate `.env` string form Command"
type: issue
state: open
author: joepio
labels:
  - C-enhancement
  - A-help
  - E-easy
assignees: []
created_at: 2023-02-24T13:53:58Z
updated_at: 2024-07-25T16:03:15Z
url: https://github.com/clap-rs/clap/issues/4729
synced_at: 2026-01-07T13:12:20-06:00
---

# Generate `.env` string form Command

---

_Issue opened by @joepio on 2023-02-24 13:53_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues ([relevant](https://github.com/clap-rs/clap/issues/2367))

### Clap Version

4

### Describe your use case

Clap gives the options to either use flags or environment variables to configure their instance.

Generating a `.env` file can help users to setup more complex configurations. We can use the `env = "MY_ENV` marco setting to find out for which arguments we should generate such as file.

### Describe the solution you'd like

```rust
            use clap::CommandFactory;
            let command = Opts::command();

            let mut out = String::from("# Generated by `atomic-server setup-env` \n");
            for arg in command.get_arguments() {
                if let Some(env) = arg.get_env() {
                    let Some(hint) = arg.get_help() else {
                        continue;
                    };
                    out.push_str(&format!("# {}\n", hint));
                    let possible_vals = arg.get_possible_values();
                    if !possible_vals.is_empty() {
                        out.push_str(&format!(
                            "# Possible values: {:?}\n",
                            possible_vals
                                .iter()
                                .map(|v| v.get_name())
                                .collect::<Vec<&str>>()
                        ));
                    }
                    out.push_str(&format!(
                        "# {}=\n\n",
                        env.to_str().expect("Can't convert env to string"),
                    ));
                }
            }
```

This works for me, but it could be improved. The enums don't show their descriptions at the moment, and there is no hint about data type / boolean type. 

I think this feature could be available from `clap::Command::generate_dotenv`, which could return a string.

### Alternatives, if applicable

_No response_

### Additional Context

_No response_

---

_Label `C-enhancement` added by @joepio on 2023-02-24 13:53_

---

_Label `A-help` added by @epage on 2023-02-24 15:49_

---

_Label `E-easy` added by @epage on 2023-02-24 15:49_

---

_Comment by @epage on 2023-02-24 15:50_

I think something like this could be useful.  I think it should at least start as a separate crate like man and completions, maybe `clap_dotenv`.  I'm ambivalent on whether that is within the clap repo or not.

---

_Comment by @dzmitry-lahoda on 2024-07-25 16:03_

seems somewhat relevant https://github.com/clap-rs/clap/issues/3131 , so it ask to generate cli args. but in general idea of serialization is common.

---
