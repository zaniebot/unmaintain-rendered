---
number: 5627
title: "Arg::to_string panics"
type: issue
state: open
author: crowlKats
labels:
  - C-bug
  - S-waiting-on-decision
  - A-builder
assignees: []
created_at: 2024-08-06T06:53:56Z
updated_at: 2024-08-07T01:31:25Z
url: https://github.com/clap-rs/clap/issues/5627
synced_at: 2026-01-07T12:31:17-06:00
---

# Arg::to_string panics

---

_Issue opened by @crowlKats on 2024-08-06 06:53_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Rust Version

1.79.0

### Clap Version

4.5.13

### Minimal reproducible code

```rust
fn main() {
    let cmd = clap::Command::new("cargo")
      .bin_name("cargo")
      .arg(clap::Arg::new("manifest-path").long("manifest-path"));

    dbg!(cmd.get_arguments().next().unwrap().to_string());
}
```


### Steps to reproduce the bug with the above code

cargo run

### Actual Behaviour

its panicking with 
`thread 'main' panicked at /Users/crowlkats/.cargo/registry/src/index.crates.io-6f17d22bba15001f/clap_builder-4.5.13/src/builder/arg.rs:4001:29`
which is https://github.com/clap-rs/clap/blob/edcaf8fcae5b747cee7e70f196d70a49ffcbdb84/clap_builder/src/builder/arg.rs#L4024

### Expected Behaviour

shouldn't panic

### Additional Context

Am trying to get the arg usage representation to do a basic JSON output.

### Debug Output

_No response_

---

_Label `C-bug` added by @crowlKats on 2024-08-06 06:53_

---

_Comment by @epage on 2024-08-06 19:35_

You need to `cmd.build()` first. 

The next question is if our panic message should call that out.  I'm unsure.  There are a lot of corner cases and am unsure if we should go for "catastrophic failure" or "you didn't do one specific thing" (when you might have and instead something else went wrong).

---

_Comment by @crowlKats on 2024-08-06 22:55_

> You need to `cmd.build()` first.

Ah, that makes sense.

> The next question is if our panic message should call that out. I'm unsure. There are a lot of corner cases and am unsure if we should go for "catastrophic failure" or "you didn't do one specific thing" (when you might have and instead something else went wrong).

I tend to be in favour of more documentation, especially if its a behaviour that is here to stay indefinitively and has a reason, but I do understand your point, especially if such cases are common, so not sure either which would be better.

---

_Label `S-waiting-on-decision` added by @epage on 2024-08-07 01:31_

---

_Label `A-builder` added by @epage on 2024-08-07 01:31_

---
