---
number: 1695
title: Specify default text for optional arguments in help
type: issue
state: open
author: emilazy
labels:
  - C-enhancement
  - S-waiting-on-decision
  - A-help
assignees: []
created_at: 2020-02-14T17:05:22Z
updated_at: 2023-10-25T03:03:44Z
url: https://github.com/clap-rs/clap/issues/1695
synced_at: 2026-01-07T12:31:17-06:00
---

# Specify default text for optional arguments in help

---

_Issue opened by @emilazy on 2020-02-14 17:05_

### Describe your use case

Often, the default values of arguments are determined based on runtime computation, e.g. a `--threads` parameter defaulting to the number of available threads on the system, or a `--config` option defaulting to an OS-specific path in the user's home directory (e.g. `$XDG_CONFIG_HOME/app-name/config.ron` on Linux). It's beneficial for usability to be able to summarize the default arguments, e.g. `Number of threads to use [default: # of threads on system]` or `Path to configuration [default: $XDG_CONFIG_HOME/app-name/config.ron]`.

At present, there's no API to give a (purely cosmetic) default option text for an optional argument.

Currently, I just do:

```rust
#[derive(Clap)]
struct Opts {
    /// Option description [default: $XDG_DATA_HOME/...]
    pub path: Option<PathBuf>,
}
```

but this isn't quite correct (e.g. it doesn't format the default with `Colorizer::good`).

Arguably this is an X-Y problem and the real feature request is for "computed defaults" (related to #1694), but I think even with such a mechanism there's value in being able to summarize the default path (rather than e.g. inlining volatile variables like `$XDG_RUNTIME_DIR` in the help text).

### Describe the solution you'd like

```rust
#[derive(Clap)]
struct Opts {
    /// Option description
    #[clap(default_help = "$XDG_DATA_HOME/...")]
    pub path: Option<PathBuf>,
}
```

---

_Label `T: new feature` added by @emilazy on 2020-02-14 17:05_

---

_Label `C: args` added by @pksunkara on 2020-02-14 17:10_

---

_Label `C: help message` added by @pksunkara on 2020-02-14 17:10_

---

_Added to milestone `3.1` by @pksunkara on 2020-02-14 17:11_

---

_Comment by @pksunkara on 2020-04-14 22:01_

I actually removed the colorizing for default values in #1824. I wanted to rethink quite a bit on how to display all kinds of things like these. But, it's for v3.1

---

_Referenced in [clap-rs/clap#1456](../../clap-rs/clap/issues/1456.md) on 2020-04-14 22:03_

---

_Referenced in [epage/clapng#139](../../epage/clapng/issues/139.md) on 2021-12-06 19:13_

---

_Removed from milestone `3.1` by @epage on 2021-12-08 20:28_

---

_Label `C: args` removed by @epage on 2021-12-08 20:28_

---

_Label `T: new feature` removed by @epage on 2021-12-08 21:15_

---

_Label `C-enhancement` added by @epage on 2021-12-08 21:15_

---

_Label `S-waiting-on-mentor` added by @epage on 2021-12-09 21:10_

---

_Referenced in [clap-rs/clap#3321](../../clap-rs/clap/issues/3321.md) on 2022-01-20 15:32_

---

_Label `S-waiting-on-mentor` removed by @epage on 2022-01-20 15:33_

---

_Label `S-waiting-on-decision` added by @epage on 2022-01-20 15:33_

---

_Comment by @epage on 2022-01-20 15:36_

One proposal for https://github.com/clap-rs/clap/issues/2389 includes exposing some level of styling to the user.

https://github.com/clap-rs/clap/issues/3008 explores pulling defaulting logic out of the core of clap into helpers that you can pass into `App` and `Arg`.  https://github.com/clap-rs/clap/issues/3321 then brings up the idea of those traits offering a `hint(&self, app: &App) -> Option<&str>` function.  This would allow creating a no-op default trait impl that just adds information to the help.

Since both of these are not solid enough as alternatives yet, still keeping this open to ensure the use case gets covered by *something*

---

_Referenced in [clap-rs/clap#3008](../../clap-rs/clap/issues/3008.md) on 2022-01-24 14:52_

---

_Referenced in [clap-rs/clap#4643](../../clap-rs/clap/issues/4643.md) on 2023-01-16 16:46_

---

_Comment by @9999years on 2023-10-25 03:03_

It sounds like there's interest for this, so I might prepare a PR.

Related issues:

- #4976 (default text could be used to work around bad quoting for values like the empty string)
- #4558 (default text could be supplied to support non-`Display` default values)

---
