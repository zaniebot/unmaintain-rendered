---
number: 1422
title: Cargo subcommand ideal error messages
type: issue
state: closed
author: daxpedda
labels:
  - C-enhancement
  - A-help
  - E-help-wanted
assignees: []
created_at: 2019-02-28T11:07:31Z
updated_at: 2020-02-07T14:22:50Z
url: https://github.com/clap-rs/clap/issues/1422
synced_at: 2026-01-07T12:31:16-06:00
---

# Cargo subcommand ideal error messages

---

_Issue opened by @daxpedda on 2019-02-28 11:07_

### Affected Version of clap

* 2.32.0

### Feature Request

When creating a cargo subcommand and if wanting to handle *both* `cargo subcommand` and `cargo-subcommand` the suggested solution (https://github.com/clap-rs/clap/issues/937#issuecomment-296208355) seems to be as follow:
```rust
clap::app_from_crate!()
    .arg(
        Arg::with_name("dummy")
            .hidden(true)
            .possible_value("subcommand"),
    )
    ...
    .get_matches()
```
This arg is to swallow the first arg that would be passed if using `cargo subcommand`.
But as stated in the [documentation](https://docs.rs/clap/2.32.0/clap/struct.Arg.html#method.hidden): `NOTE: This does not hide the argument from usage strings on error`, which can result in "wrong" error messages.

Possible solutions would be to add another form of `hidden` that also hides on errors or any other workaround for this.
Maybe I'm doing this whole thing wrong, any feedback would be appreciated.

Thanks.

---

_Label `C: help message` added by @CreepySkeleton on 2020-02-01 15:04_

---

_Label `D: easy` added by @CreepySkeleton on 2020-02-01 15:04_

---

_Label `help wanted` added by @CreepySkeleton on 2020-02-01 15:04_

---

_Label `T: enhancement` added by @CreepySkeleton on 2020-02-01 15:04_

---

_Comment by @pksunkara on 2020-02-07 07:03_

What was the error message you are getting and please write down the expected error message you want.

---

_Comment by @daxpedda on 2020-02-07 14:21_

I am sorry for the very vague bug report here, I had a hard time figuring out myself what exactly my problem was.

In any case, this is fixed in master!

I'm going to explain the issue in `2.33.0`:

So using the exact code from above, let's say I have a crate called `cargo-subcommand`, using the following commands, I would get the following output:

`cargo subcommand --test`:
```
error: Found argument '--test' which wasn't expected, or isn't valid in this context

USAGE:
    cargo-subcommand.exe <dummy>

For more information try --help
```

You can see that showing `<dummy>` wouldn't be desired, it's just here to make it swallow the `subcommand` when used with in the combination of `cargo subcommand`.

The desired output would be:
```
error: Found argument '--test' which wasn't expected, or isn't valid in this context

USAGE:
    cargo-subcommand.exe

For more information try --help
```

Which is the case now in master.

---

_Closed by @daxpedda on 2020-02-07 14:21_

---
