---
number: 4682
title: "Add functions `required_unless_eq_any` and `required_unless_eq_all` for `Arg` and `ArgGroup`"
type: issue
state: open
author: rob-p
labels:
  - C-enhancement
  - S-waiting-on-decision
  - A-validators
assignees: []
created_at: 2023-01-28T05:26:12Z
updated_at: 2023-02-23T21:24:08Z
url: https://github.com/clap-rs/clap/issues/4682
synced_at: 2026-01-07T12:31:17-06:00
---

# Add functions `required_unless_eq_any` and `required_unless_eq_all` for `Arg` and `ArgGroup`

---

_Issue opened by @rob-p on 2023-01-28 05:26_

### Please complete the following tasks

- [X] I have searched the [discussions](https://github.com/clap-rs/clap/discussions)
- [X] I have searched the [open](https://github.com/clap-rs/clap/issues) and [rejected](https://github.com/clap-rs/clap/issues?q=is%3Aissue+label%3AS-wont-fix+is%3Aclosed) issues

### Clap Version

4.1.4

### Describe your use case

I would like to define an argument or argument group that is required *unless* some other argument takes on a specific value.

This would be very useful in my use case (a tool processing single-cell gene expression data), because in some situations, when a particular common protocol is used and passed as the value to some argument (in this case called `--geometry`), the values of several other arguments can be inferred and should no longer be required.  However, if the `--geometry` is not one of these common values, then the other arguments should be required.  

If the `--geometry` argument only took on a small number of possible values, then something like this might be possible with `required_if`, by listing all of the other values for which the argument should still be required.  However, in my use case, the potential values to `--geometry` are potentially unbounded since the user can provide custom values that are later parsed and interpreted by the program.  Thus, I need a way to specify a list of specific values for which other arguments should _not_ be required.

### Describe the solution you'd like

Just as there are now methods on `Arg` (and `ArgGroup`, I believe?) like `required_ifs` and `required_if_eq_any` and, I propose the addition of methods:

 * `required_unless_eq_any` and
 * `required_unless_eq_all`

These do pretty much what it says on the label. The first says an argument or argument group is required unless _any_ of the listed conditions are satisfied (i.e. some other argument has a particular value), and the second says an argument or argument group is required unless _all_ of the listed conditions are satisfied.

Given the existence of the other functions that are already present for related functionality, these seem a natural addition.

### Alternatives, if applicable

_No response_

### Additional Context

I brought up a discussion about this [here](https://github.com/clap-rs/clap/discussions/4677), but I am pretty sure that no way currently exists to accomplish this without the functionality requested above.

---

_Label `C-enhancement` added by @rob-p on 2023-01-28 05:26_

---

_Comment by @epage on 2023-02-23 21:23_

Sorry for the slow response!

Another route for this is to extend [`ArgPredicate`](https://docs.rs/clap/latest/clap/builder/enum.ArgPredicate.html).

A challenge we have is there is an arbitrary set of functionality people ask of clap while we are working on shrinking clap (#2037, #1365) and we have been exploring other ways of handling this in #3476. This makes me hesitant every time there is a new request for an additional variant of existing functionality.

---

_Label `S-waiting-on-decision` added by @epage on 2023-02-23 21:24_

---

_Label `A-validators` added by @epage on 2023-02-23 21:24_

---

_Referenced in [clap-rs/clap#3008](../../clap-rs/clap/issues/3008.md) on 2023-05-03 14:14_

---

_Referenced in [clap-rs/clap#6030](../../clap-rs/clap/issues/6030.md) on 2025-06-10 15:44_

---
