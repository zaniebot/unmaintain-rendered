---
number: 6167
title: "fix(clap_complete_nushell): order positional arguments by index"
type: pull_request
state: merged
author: nitsky
labels: []
assignees: []
merged: true
base: master
head: feat/nushell-completion-arguments-index
created_at: 2025-10-30T00:29:42Z
updated_at: 2025-10-31T14:29:13Z
url: https://github.com/clap-rs/clap/pull/6167
synced_at: 2026-01-07T12:31:17-06:00
---

# fix(clap_complete_nushell): order positional arguments by index

---

_Pull request opened by @nitsky on 2025-10-30 00:29_

In clap_complete_nushell, arguments are written in the order they are added to the `Command`, not according to the
`index` they are specified with. If required positional arguments with a lower `index` are added to the command after
optional positional arguments are added, nushell rejects the generated completion because nushell forbids required
arguments to come after optional arguments.

For example, if positional arguments are defined as:

- `.arg(Arg::new("second").index(2))` (optional)
- `.arg(Arg::new("first").index(1))` (required)

The current output would incorrectly place `second?` before `first`, which nushell rejects.

To fix this, I reordered the output so all non-positional arguments are written in their normal order, and then all
positional arguments are written, ordered by their `index`.

I'm not certain this is the best approach, I would appreciate feedback.


---
