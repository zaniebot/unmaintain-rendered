<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Specific .gitignore makes ripgrep find files in .git directory - BurntSushi/ripgrep #1040</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Specific .gitignore makes ripgrep find files in .git directory</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1040">#1040</a>
        opened by <a href="https://github.com/antoyo">@antoyo</a>
        on 2018-09-05 14:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/antoyo">@antoyo</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>ripgrep 0.9.0
-SIMD -AVX
</code></pre>
<h4>How did you install ripgrep?</h4>
<pre><code>pacman -S ripgrep
</code></pre>
<h4>What operating system are you using ripgrep on?</h4>
<p>Archlinux</p>
<pre><code>Linux pc080 4.18.5-arch1-1-ARCH #1 SMP PREEMPT Fri Aug 24 12:48:58 UTC 2018 x86_64 GNU/Linux
</code></pre>
<h4>Describe your question, feature request, or bug.</h4>
<p>When IÂ have this <code>.gitignore</code> file:</p>
<pre><code>*
!*.*
</code></pre>
<p>the command <code>ripgrep --files</code> will show files in the <code>.git</code> directory, which does not make sense, because the <code>.gitignore</code> does not affect the files in the <code>.git</code> directory.</p>
<h4>If this is a bug, what are the steps to reproduce the behavior?</h4>
<ol>
<li>In a git repository, create a <code>.gitignore</code> file with the above content.</li>
<li>Run <code>rg --files</code>.</li>
<li>See that <code>rg</code> shows files in the <code>.git</code> directory.</li>
</ol>
<h4>If this is a bug, what is the actual behavior?</h4>
<p><code>rg --files</code> shows the files in the <code>.git</code> directory.</p>
<h4>If this is a bug, what is the expected behavior?</h4>
<p><code>rg --files</code> should not show the files in the <code>.git</code> directory because of a pattern of the <code>.gitignore</code> file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-09-05 15:19</div>
            <div class="timeline-body"><p>This is a little tricky to fix in a consistent way. In particular, a <code>.git</code> directory is ignored because it's hidden, but the <a href="https://docs.rs/ignore/0.4.3/ignore/struct.WalkBuilder.html#ignore-rules">ignore matching rules</a> permit any ignore-related file (.gitignore, .ignore, .rgignore) to override skipping hidden files when there is an explicit whitelist, which is the case here. To make this work like you expect, we'd have to special case the handling of git-specific ignore files to make it so it does not impact <code>.git</code> directories.</p>
<p>A work-around to this problem is to add <code>.git/</code> to a <code>.ignore</code> file alongside your <code>.gitignore</code>. The simplicity of the work-around makes it tempting to declare this as <code>wontfix</code>, but I'll leave it open as something to consider if and when the <code>ignore</code> crate gets an overhaul.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @BurntSushi on 2018-09-05 15:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2018-09-05 15:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">icebox</span> added by @BurntSushi on 2019-01-24 16:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-05-08 11:40</div>
            <div class="timeline-body"><p>I think the right answer here is to probably just add <code>.git</code> to your ignore file. It's a corner case with a simple work around that I think is better than complicating <code>ignore</code> more than it is.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2020-05-08 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">icebox</span> removed by @BurntSushi on 2020-05-08 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">gitignore</span> added by @BurntSushi on 2020-05-08 11:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2020-05-08 11:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:40 UTC
    </footer>
</body>
</html>
