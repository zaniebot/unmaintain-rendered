<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>json output option to allow scripting - BurntSushi/ripgrep #359</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>json output option to allow scripting</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/359">#359</a>
        opened by <a href="https://github.com/timotheecour">@timotheecour</a>
        on 2017-02-12 06:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/timotheecour">@timotheecour</a></div>
            <div class="timeline-body"><p>Could we have a json output option?
use case: making it easier to integrate in other tools [1]
eg:</p>
<pre><code>rg &#x27;\bWORLD\b&#x27; $args --output=json
{&quot;path&quot;:&quot;foo/bar.txt&quot;,&quot;line&quot;:3,&quot;offset&quot;:258,&quot;column&quot;:4,&quot;length&quot;:5,&quot;match&quot;:&quot;WORLD&quot; ,&quot;context&quot;:&quot;hello WORLD !&quot; }
</code></pre>
<p>offset corresponds to byte offset in file (useful for efficient access for the other tool)
length is in bytes (in case of non-ascii)</p>
<p>The alternative (manual parsing) is error prone, eg:</p>
<ul>
<li>if filename is <code>foo/bar:13:foo.txt</code> (contains <code>:</code>)</li>
<li>if the escape codes colorizing the matched word are hard to find because the context contains some escape codes itself (eg it can actually happens if it&#x27;s a log file)</li>
<li>relying on --column doesn&#x27;t work for multiple matches in 1 line (ok just saw --vimgrep but doens&#x27;t show colors, so we can&#x27;t get the extent of each match)</li>
</ul>
<p>[1] NOTE: one of these other tools is multiline search built on top of ripgrep</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-12 15:26</div>
            <div class="timeline-body"><p>I think what you&#x27;re asking for is &quot;structured output,&quot; where JSON might be your preference. In that case, I think this is a dupe of #244. To be clear, I do <em>not</em> want to be in the business of producing a bunch of different output formats because there is so much complexity involved. (Every option that influences output has to be considered against the new format.)</p>
<blockquote>
<p>NOTE: one of these other tools is multiline search built on top of ripgrep</p>
</blockquote>
<p>While I&#x27;m in favor of adding some type of structured output to ripgrep, I would rather see these types of tools built with <a href="https://github.com/BurntSushi/ripgrep/milestone/1">libripgrep</a> than with ripgrep itself.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/timotheecour">@timotheecour</a> on 2017-02-13 01:21</div>
            <div class="timeline-body"><p>@BurntSushi</p>
<ul>
<li><p>since these structured output (json or not, doesn&#x27;t matter) will be meant  for machine consumption, it would make sense to keep options to a bare minimum for this mode: ignore color, and have a single formatting option (doesn&#x27;t matter so long all information is there to get to the match; byte offset as i said above would be useful, to allow efficient machine access to a match without having to parse the file).</p>
</li>
<li><p>One option maybe: whether or not to show the corresponding matching line of text from the file.</p>
</li>
<li><p>is there any doc on libripgrep, maybe a code snippet? can I link against it say from C-like languages?</p>
</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-13 03:19</div>
            <div class="timeline-body"><p>Then this should be closed as a duplicate.</p>
<p>There are <em>many</em> options, and their effects all need to be individually reasoned through.</p>
<blockquote>
<p>is there any doc on libripgrep, maybe a code snippet?</p>
</blockquote>
<p>Please see the link in my previous comment. It&#x27;s not done yet. Libripgrep refers to a collection of libraries. The endgame is to make ripgrep itself very small with most logic in reusable libraries. A lot of it is already done.</p>
<blockquote>
<p>can I link against it say from C-like languages?</p>
</blockquote>
<p>Someone (probably not me) will need to put in the work to build a C interface, and then ffi bindings for their favorite language.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-13 03:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:03 UTC
    </footer>
</body>
</html>
