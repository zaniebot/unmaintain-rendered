<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configure ripgrep to search in a certain gitignored directory  - BurntSushi/ripgrep #969</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Configure ripgrep to search in a certain gitignored directory</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/969">#969</a>
        opened by <a href="https://github.com/hiqsol">@hiqsol</a>
        on 2018-06-26 14:26
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/hiqsol">@hiqsol</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>ripgrep 0.8.1 (rev c8e9f25b85)
-SIMD -AVX</p>
<h4>How did you install ripgrep?</h4>
<p>Ubuntu deb package.</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>Ubuntu 16.04.3</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>I have <code>vendor</code> directory ignored in .gitignore.
I want ripgrep to search in <code>./vendor</code> directory in all of my projects but not in vendor directories deeper in the tree.
I've found a working solution with <code>.ignore</code> file with single line <code>!/vendor</code>.
But I would prefer to have it configured globally (e.g. in <code>.ripgreprc</code>) and not per project basis.</p>
<p>I tried <code>-g vendor</code> option and <code>--ignore-file ~/myglobal.ignore</code> with no success.</p>
<p>Could you please give me idea how to achieve such behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-06-26 14:47</div>
            <div class="timeline-body"><p><code>--ignore-file</code> cannot work because it's specifically designed to have low precedence. It takes effect <em>after</em> &quot;project specific&quot; files are applied. That is, when there are two competing ignore rules, the one that is more local to the project wins. <code>--ignore-file</code> is indeed a &quot;global&quot; sets of rules, so it is always overridden.</p>
<p>Using <code>-g</code> unfortunately isn't going to get you anywhere either. Namely, <code>-g vendor</code> specifies a whitelist, which implies everything you search must match the whitelist. If you look at the <code>--debug</code> output of ripgrep, you'll see that with <code>-g vendor</code>, your <code>vendor</code> directory will get whitelisted, but since the files inside that directory (and any other files) don't match <code>-g vendor</code>, they are excluded from search.</p>
<p>You could use <code>-g vendor -g 'vendor/**'</code>, but that will <em>only</em> search the files in your <code>vendor</code> directory, which I'm assuming doesn't achieve what you want (and would be done more simply as <code>rg pattern vendor</code>).</p>
<p>So the only solution available to you is a project specific <code>.ignore</code> file. Moreover, I argue that this is in fact the only suitable solution in general. Even if ripgrep provided a different kind of global ignore file that overruled project specific settings, it wouldn't be able to enforce your rule in general because your rule is specifically expressed <em>relative</em> to some other directory (whether it's your CWD or a project root or whatever). Therefore, a <code>.ignore</code> (or <code>.rgignore</code>) is the right answer.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2018-06-26 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2018-06-26 14:47</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-06-26 14:50</div>
            <div class="timeline-body"><p>Here is a somewhat idiosyncratic combination of glob flags that might strictly satisfy your question, but almost certainly screws something else up (like not respecting the rest of your <code>.gitignore</code>):</p>
<pre><code>$ rg -g '*' -g '!.*' -g '!*/**/vendor' &lt;pattern&gt;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/hiqsol">@hiqsol</a> on 2018-06-26 15:09</div>
            <div class="timeline-body"><p>Many thanks for such detailed explanation!
I'll stick to <code>.ignore</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/fcying">@fcying</a> on 2018-07-04 06:14</div>
            <div class="timeline-body"><p>you can use <code>--no-ignore</code>  and set your own exclude in ripgreprc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-04 11:32</div>
            <div class="timeline-body"><p>@fcying That doesn't make any sense to me. Could you please elaborate?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elquimista">@elquimista</a> on 2019-07-29 11:41</div>
            <div class="timeline-body"><p>@BurntSushi @fcying's comment worked perfectly for my case. The folder <code>node_modules</code> is usually gitignored, but I sometimes need to search inside installed module folder when I'm deeply involved in debugging.</p>
<p>I tried the following and didn't work:</p>
<pre><code>rg -g 'node_modules/&lt;package_name&gt;/**/*.js' '&lt;pattern&gt;'
</code></pre>
<p>And adding <code>--no-ignore</code> did the magic:</p>
<pre><code>rg --no-ignore -g 'node_modules/&lt;package_name&gt;/**/*.js' '&lt;pattern&gt;'
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-07-29 11:48</div>
            <div class="timeline-body"><p>@elquimista This is over-complicating it. I'd definitely recommend reading the <a href="https://github.com/BurntSushi/ripgrep/blob/master/GUIDE.md#automatic-filtering">guide's section on automatic filtering</a>.</p>
<p>Firstly, you can use <code>-u</code> instead of <code>--no-ignore</code>, where <code>-u</code> is a convenient synonym for telling ripgrep to disable handling of ignore rules.</p>
<p>Secondly, if <code>node_modules</code> is ignored, then specifying the <code>node_modules</code> directory itself will always override that. That is, if you do <code>rg foo some-file</code> and <code>some-file</code> is in your <code>.gitignore</code>, then ripgrep won't ignore because you explicitly told ripgrep to search it. So your command should be able to be reduced to just this:</p>
<pre><code>$ rg '&lt;pattern&gt;' node_modules/&lt;package_name&gt; -tjs
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dustinfreeman">@dustinfreeman</a> on 2019-08-05 15:44</div>
            <div class="timeline-body"><p>I'm currently working in a large git repo with some tracked files in the index whose pattern is also gitignored. In my situation, I was trying to use ripgrep to search the content of these files but they didn't appear because I did not know they were gitignored.</p>
<p>I believe this is a not-uncommon circumstance: in general a pattern is gitignored, but the repo has a few files that needed to be explicitly added.</p>
<p>I know this is perhaps wishful thinking, but it would be wonderful if rip grep's <a href="https://github.com/BurntSushi/ripgrep/blob/master/GUIDE.md#automatic-filtering">automatic filtering</a> was clever enough to include files tracked in the git index, even if their pattern is in the <code>.gitignore</code>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:35 UTC
    </footer>
</body>
</html>
