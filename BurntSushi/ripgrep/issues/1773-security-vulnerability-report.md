```yaml
number: 1773
title: "[Security] Vulnerability report"
type: issue
state: closed
author: Ry0taK
labels:
  - bug
assignees: []
created_at: 2021-01-03T09:02:48Z
updated_at: 2021-06-14T21:56:59Z
url: https://github.com/BurntSushi/ripgrep/issues/1773
synced_at: 2026-01-12T16:13:24Z
```

# [Security] Vulnerability report

---

_@Ry0taK_

I've sent an email that contains the detail of the vulnerability to ![](https://blog.burntsushi.net/images/gmail.png). (As I couldn't find proper contact information to report a vulnerability, I used the email from https://blog.burntsushi.net/about/)
Since I believe this vulnerability can be exploited, I'm not publishing the detail here.

@BurntSushi Can you check the inbox, please?

---

_Comment by @BurntSushi on 2021-01-04 13:20_

Thanks! That email is fine. I'm investigating it, but since it only happens on Windows, it will take me some time to get to it.

---

_Label `bug` added by @BurntSushi on 2021-01-04 13:20_

---

_Closed by @BurntSushi on 2021-05-29 13:53_

---

_Comment by @BurntSushi on 2021-05-29 13:53_

Also fixed by https://github.com/BurntSushi/ripgrep/commit/229d1a8d41b0023420e7815578fa0b39c0d5c2e4.

---

_Comment by @Ry0taK on 2021-05-29 13:56_

@BurntSushi Thank you so much for fixing this issue ;)

---

_Comment by @xfbs on 2021-05-29 15:20_

This almost sounds like a bug in Windows or `std::process::Command` to me. Other people that are used to *nix might find this behaviour surprising and introduce similar vulnerabilities. Should this be fixed in the stdlib maybe? Maybe have some method on a `Command` that optionally resolves the path to an executable like your `resolve_binary`, overriding the OS's search path (skipping the current working directory)? Just some food for thought (duplicated here because comments on commits might not be the best place).

---

_Comment by @BurntSushi on 2021-05-29 15:43_

I meant a file a bug against std. The library team did have a brief private conversation about it a couple months ago, and there does seem to be some appetite toward doing _something_ here.

I haven't gotten around to filing an issue, but we are okay doing it publicly. So anyone can create that issue. (And I would invite someone to do it.)

See also: https://github.com/golang/go/issues/38736

---

_Comment by @BurntSushi on 2021-05-29 15:45_

Note also that I created a CVE for this: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3013

(I sent mail to them to publish the CVE today, so that's pending.)

---

_Comment by @Shnatsel on 2021-06-14 20:00_

Does this also affect ripgrep being used as a crate? If so, it's probably a good idea to also file an advisory at https://github.com/RustSec/advisory-db - that way people relying on a vulnerable version would be notified through `cargo audit`, `cargo deny`, etc.

---

_Comment by @BurntSushi on 2021-06-14 21:56_

@Shnatsel Good idea. You're correct!

Done: https://github.com/RustSec/advisory-db/pull/939

---
