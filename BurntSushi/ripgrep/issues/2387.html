<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>support standard character escape sequences (e.g. \t, \x1D) in the replacement string - BurntSushi/ripgrep #2387</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>support standard character escape sequences (e.g. \t, \x1D) in the replacement string</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2387">#2387</a>
        opened by <a href="https://github.com/mwaitzman">@mwaitzman</a>
        on 2023-01-01 07:52
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mwaitzman">@mwaitzman</a></div>
            <div class="timeline-body"><p>I&#x27;d like ripgrep to natively support replacements with common escape sequences (e.g <code>--replace &#x27;\t&#x27;</code> to replace with a horizontal tab)</p>
<p>It is quite unwieldy to have to write e.g. <code>rg ... --replace ...$(echo -ne &#x27;\x1F&#x27;)...</code> instead of just being able to do <code>rg ... --replace ...\x1F...</code></p>
<p>Additionally, being able to easily add &#x27;\x00&#x27; would be very nice in certain situations (for example, when delimiting the end of file names that contain enough special characters to make it quite annoying to deal with (since <code>\0</code> is the <em>only</em> illegal character in filepaths)).</p>
<p>Perhaps you could simply implement the stuff described in https://docs.rs/regex/latest/regex/#escape-sequences (with perhaps the addition of a few others such as <a href="https://wikiless.org/wiki/Record_separator?lang=en#ESC">&#x27;\e&#x27;</a> and &#x27;\0&#x27; for convenience, especially the ones <a href="https://www.gnu.org/software/coreutils/manual/html_node/echo-invocation.html#index-backslash-escapes-1">available with <code>echo -e</code></a><a href="https://zsh.sourceforge.io/Doc/Release/Shell-Builtin-Commands.html"> at the </a><a href="https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html#index-echo">typical shell</a>)?</p>
<p>Personally, by far the most used of these for me would be \x1[C-F], \x1b (for highlighting sections of the output in the terminal), \t, \n, and \0, but I frequently wish to make use of this capability, and have to either resort to ugly workarounds like the one previously mentioned, or use a different program(s).</p>
<p>If you don&#x27;t wish to modify the base functionality of <code>--replace</code> due to it possibly breaking existing scripts (though I&#x27;d think that because of the replacement string being evaluated at startup time, and the user presumably being the one providing the input, and the relevant characters themselves, breakage would likely be small and easily fixable), perhaps you can create <code>--extended-replace &lt;extended replacement string&gt;</code> as an alternative to the current <code>--replace</code> that supports standard character escapes, and allow doing <code>-rx &lt;extended replacement string&gt;</code> (with the shorthand explicitly having <code>-r</code> followed immediately by &#x27;x&#x27; and then the replacement string being the next arg (unlike <code>-r</code> currently, which (somewhat confusingly) takes the rest of the current arg, if present as the replacement instead of the next argument) (I presume this could work due to rg&#x27;s implementation. The use of &#x27;x&#x27; is also kinda nice due to it being prominent in &#x27;\x&#x27; and &quot;extend&quot;).</p>
<p>I figure this all wouldn&#x27;t be too difficult to implement due to it mostly already being implemented elsewhere, would have a minimal (negative) impact on rg as a whole, and be quite useful in certain situations whilst adding functionality many people might expect to be present already, so is this something that could be added to rg, or would I have to maintain a fork of it if I want this?</p>
<p>Documentation could be something like</p>
<pre><code>-rx, --extended-replace REPLACEMENT_TEXT
  Like --replace, but interprets various backslash escapes
  \x([0-9A-Fa-f]{2,}) for the UTF-8 character with hexadecimal value $1
  Additionally, interprets
    \\ as a literal &#x27;\&#x27;
    \e as \x1b
    \0 as \x00 (the null byte)
    \t as \x09 (horizontal tab)
    \n ...
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-01-01 12:12</div>
            <div class="timeline-body"><blockquote>
<p>It is quite unwieldy to have to write e.g. <code>rg ... --replace ...$(echo -ne &#x27;\x1F&#x27;)...</code> instead of just being able to do <code>rg ... --replace ...\x1F...</code></p>
</blockquote>
<p>Why doesn&#x27;t <code>$&#x27;\x1F&#x27;</code> work for you? e.g.,</p>
<pre><code>$ echo &#x27;bar&#x27; | rg a -r $&#x27;\x1F&#x27; | xxd
00000000: 621f 720a                                b.r.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-22 21:55</div>
            <div class="timeline-body"><p>Seems like my suggestion above might have worked, so I don&#x27;t think this is needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-22 21:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-22 21:55</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:12 UTC
    </footer>
</body>
</html>
