<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add wasm feature which allows a more fine-grained control over regex features - BurntSushi/ripgrep #2057</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add wasm feature which allows a more fine-grained control over regex features</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2057">#2057</a>
        opened by <a href="https://github.com/d3lm">@d3lm</a>
        on 2021-11-11 08:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/d3lm">@d3lm</a></div>
            <div class="timeline-body"><p>For work I need to implement simplified version of <code>ripgrep</code> that operates on an in-memory file system to allow text and file search using glob patterns. It all gets compiled to WASM and ultimately is part of a kernel used for <a href="https://stackblitz.com/">StackBlitz</a> to run Node.js entirely in a browser. For supporting glob patterns I am using <code>globset</code>, however it uses <code>regex</code> internally for improved performance and it also enables the <code>perf</code> feature.</p>
<p>I was wondering if you would be open for some <code>wasm</code> feature for instance (just an example), that allows a more fine grained control over the regex features to reduce binary size. For example, when you enable the <code>wasm</code> feature for <code>globset</code> it would only enable <code>std</code> on regex but not <code>perf</code>. This way, users can transitively enable features on <code>regex</code> and if they can bare more bytes they could enable the <code>perf</code> feature themselves in their own <code>Cargo.toml</code>. Or you could choose to only enable <code>perf-dfa</code> also gives pretty good bench results.</p>
<p>Wondering what your thoughts are about this. I think WASM is a very valid use case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-11-11 09:45</div>
            <div class="timeline-body"><p>I would want to see what kind of actual difference it makes in binary size. I&#x27;m not convinced that simply disabling some features in the regex crate will be enough. And I do <em>not</em> want to start maintaining a totally alternate build path that is dedicated to reducing binary size. I think that&#x27;s exactly what would happen if a wasm feature were added.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/d3lm">@d3lm</a> on 2021-11-12 19:02</div>
            <div class="timeline-body"><p>Yes you&#x27;re right. I have investigated a bit more and the difference when disabling the <code>perf</code> feature is not that big. And if you enable only <code>perf-dfa</code> (even if it has no extra dependencies) it&#x27;s even less. So this might be neglectable.</p>
<p>Closing this issue then.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/d3lm">@d3lm</a> on 2021-11-12 19:02</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:11 UTC
    </footer>
</body>
</html>
