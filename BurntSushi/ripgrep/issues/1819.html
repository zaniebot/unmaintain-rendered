<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>incorrect parsing logic for .gitignore so that it cannot support gitignore in whitelist mode - BurntSushi/ripgrep #1819</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>incorrect parsing logic for .gitignore so that it cannot support gitignore in whitelist mode</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1819">#1819</a>
        opened by <a href="https://github.com/flw-cn">@flw-cn</a>
        on 2021-03-14 13:55
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/flw-cn">@flw-cn</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>❯ rg --version
ripgrep 12.1.1
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p><code>brew install rg</code></p>
<h4>What operating system are you using ripgrep on?</h4>
<pre><code>❯ uname -a
Darwin waker 19.6.0 Darwin Kernel Version 19.6.0: Tue Jan 12 22:13:05 PST 2021; root:xnu-6153.141.16~1/RELEASE_X86_64 x86_64
</code></pre>
<h4>Describe your bug.</h4>
<p>Some projects may generate messy files during the compilation process, or for other reasons, some developers prefer to whitelist rather than blacklist what files git needs to keep track of. In this case, the <code>.gitignore</code> file usually starts with <code>*</code> and then explicitly specifies the files you don't want to ignore in a whitelist.</p>
<p>At this point, rg will fail completely.
https://github.com/magiblot/tvision is one such project.</p>
<h4>What are the steps to reproduce the behavior?</h4>
<p><code>git clone https://github.com/magiblot/tvision</code> and type <code>rg TApplication::TApplication</code> in its working directory, and you'll find that you get nothing. Instead, with <code>rg --no-ignore TApplication::TApplication</code> you find the following result (which is exactly what you would expect).</p>
<pre><code>❯ rg --no-ignore TApplication::TApplication
source/tvision/tapplica.cpp
41:TApplication::TApplication() :
</code></pre>
<h4>What do you think ripgrep should have done?</h4>
<p>I would like rg to support whitelisting mode for <code>.gitignore</code>, which would mean processing the <code>.gitignore</code> from start to finish. Maybe this might affect performance, or maybe there is a workaround (like <code>git ls-files</code> or something like that), but in any case I want rg to work on this project, because I know some other developers who like to work this way.</p>
<p>Otherwise I'd have to use <code>rg --no-ignore</code> every time, which is a bit inconvenient.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-03-14 14:28</div>
            <div class="timeline-body"><p>ripgrep handles whitelisting just fine. If it didn't, then for example, <code>rg THelloApp</code> would return nothing in your repo too. But it finds results in whitelisted files.</p>
<p>The actual problem here is that your <code>.gitignore</code> has your <code>source</code> directory marked as ignored. There is no rule in your <code>.gitignore</code> file that whitelists the <code>source</code> directory. So ripgrep skips it.</p>
<p>Basically, in other words, your <code>.gitignore</code> is out of sync with the files actually checked into your repo. ripgrep <em>only</em> looks at your <code>.gitignore</code> files. Not what's checked into your repo.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2021-03-14 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> added by @BurntSushi on 2021-03-14 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/flw-cn">@flw-cn</a> on 2021-03-14 15:04</div>
            <div class="timeline-body"><p>Thanks, I appreciate you helping me find the problem. I'll go communicate with that repository.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:19 UTC
    </footer>
</body>
</html>
