<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Line numbers disappear in piping - BurntSushi/ripgrep #1443</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Line numbers disappear in piping</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1443">#1443</a>
        opened by <a href="https://github.com/peterbe">@peterbe</a>
        on 2019-12-06 21:22
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/peterbe">@peterbe</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>ripgrep 11.0.2
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p><code>brew install ripgrep</code> I think.</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>macOS</p>
<h4>Describe your question, feature request, or bug.</h4>
<pre><code>▶ rg quoteattr
kuma/wiki/content.py
4:from xml.sax.saxutils import quoteattr
152:                sample = pq(src).find('[id=%s]' % quoteattr(name))
</code></pre>
<p>In this particular example, there's just 2 results. But suppose it's 100 and I realize, I need to pipe it to some more filtering. E.g.</p>
<pre><code>▶ rg quoteattr | rg sample
kuma/wiki/content.py:                sample = pq(src).find('[id=%s]' % quoteattr(name))
</code></pre>
<p>Now, I list the line number. I wanted that. I need that.</p>
<p>You <em>can't</em> do this:</p>
<pre><code>▶ rg quoteattr | rg -n sample
2:kuma/wiki/content.py:                sample = pq(src).find('[id=%s]' % quoteattr(name))
</code></pre>
<p>I have no idea what that <code>2</code> is.</p>
<p>The reason <strong>this is a feature request</strong> is because there <em>is</em> a work-around:</p>
<pre><code>▶ rg -n quoteattr | rg sample
kuma/wiki/content.py:152:                sample = pq(src).find('[id=%s]' % quoteattr(name))
</code></pre>
<p>I think that's counter-intuitive.</p>
<blockquote>
<p>What do you think ripgrep should have done?</p>
</blockquote>
<p>I don't know if it's possible but ideally, I'd like that appending <code> | rg morefiltering</code> should be the equivalent of doing an <code>AND</code> operation which I don't know how to do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-12-06 21:47</div>
            <div class="timeline-body"><p>This is intended and correct behavior. When ripgrep detects that it isn't writing to a tty, then it not only removes line numbers but also reverts tk the traditional grep format instead of the ack format. If you want line numbers, then use the <code>-n</code> flag.</p>
<blockquote>
<p>I have no idea what that 2 is.</p>
</blockquote>
<p>It's the line number of the output from the first rg process.</p>
<blockquote>
<p>The reason this is a feature request is because there is a work-around:</p>
</blockquote>
<p>It's not a work around. It's exactly the right solution. You want line numbers from the first process.</p>
<blockquote>
<p>I don't know if it's possible but ideally,</p>
</blockquote>
<p>It's not. The first rg process doesn't know that its output is being consumed by another rg process.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2019-12-06 21:47</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2019-12-06 21:47</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:03 UTC
    </footer>
</body>
</html>
