<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell Write-Host unexpected behavior - BurntSushi/ripgrep #2891</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>PowerShell Write-Host unexpected behavior</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2891">#2891</a>
        opened by <a href="https://github.com/Saya47">@Saya47</a>
        on 2024-09-13 22:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Saya47">@Saya47</a></div>
            <div class="timeline-body"><h3>Please tick this box to confirm you have reviewed the above.</h3>
<ul>
<li>[X] I have a different issue.</li>
</ul>
<h3>What version of ripgrep are you using?</h3>
<p>ripgrep 14.1.1 (rev 4649aa9700)</p>
<h3>How did you install ripgrep?</h3>
<p>scoop</p>
<h3>What operating system are you using ripgrep on?</h3>
<p>Windows 11, PowerShell 7.4.2</p>
<h3>Describe your bug.</h3>
<p>ripgrep does not read stdin from Write-Host</p>
<p>https://github.com/BurntSushi/ripgrep/issues/643</p>
<h3>What are the steps to reproduce the behavior?</h3>
<p>02:05 ~
❯ echo hello | rg y</p>
<p>02:06 ~
✖  echo hello | rg he
hello</p>
<p>02:06 ~
❯ write-host hello | rg y
hello</p>
<p>02:06 ~
✖  write-host hello | rg he
hello</p>
<p>02:07 ~
✖</p>
<h3>What is the actual behavior?</h3>
<p>ripgrep does not read stdin from Write-Host</p>
<h3>What is the expected behavior?</h3>
<p>ripgrep should work on Write-Host</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-09-13 23:00</div>
            <div class="timeline-body"><p>What happens if you do <code>rg y -</code>?</p>
<p>My guess is that Write-Host isn't writing to stdout. Which means this is expected behavior. But I'm not familiar with Windows too much and I don't know what Write-Host is. Maybe you can do some debugging by comparing with other tools.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2024-09-14 13:03</div>
            <div class="timeline-body"><ul>
<li><p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-host">Write-Host</a> writes directly to PowerShell (the host), skipping the pipeline (stdin/stdout).</p>
<blockquote>
<p>The Write-Host cmdlet's primary purpose is to produce for-(host)-display-only output, such as printing colored text like when prompting the user for input in conjunction with <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/read-host">Read-Host</a>. Write-Host uses the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.object.tostring">ToString()</a> method to write the output. <strong>By contrast, to output data to the pipeline, use <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-output">Write-Output</a> or implicit output.</strong></p>
</blockquote>
</li>
<li><p><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-output">Write-Output</a> writes to the pipeline (stdout), and <code>echo</code> is an alias to it.</p>
<blockquote>
<p>Write-Output sends objects to the primary pipeline, also known as the success stream. To send error objects to the error stream, use Write-Error.</p>
</blockquote>
</li>
</ul>
<p>=&gt; ripgrep <em>can't</em> work with <code>Write-Host</code>, as it doesn't send its value to stdout. You can see this behavior with how ripgrep adds color to its output:</p>
<p><img src="https://github.com/user-attachments/assets/1e7f1a0c-a76e-44ad-947b-cd628884c1ae" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Locked by @ghost on 2024-09-14 13:36</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:50 UTC
    </footer>
</body>
</html>
