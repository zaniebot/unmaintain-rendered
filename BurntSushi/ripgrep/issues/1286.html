<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Provide a way to associate the match to the pattern - BurntSushi/ripgrep #1286</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Provide a way to associate the match to the pattern</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1286">#1286</a>
        opened by <a href="https://github.com/kewisch">@kewisch</a>
        on 2019-05-28 10:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/kewisch">@kewisch</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>ripgrep 0.10.0
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)</p>
<h4>Describe your feature request</h4>
<p>When running <code>rg -f patternfile</code> with multiple patterns, I'm wanting to find out which pattern triggered the match so I can group them in my results. Assuming a pattern file like</p>
<pre><code>foo+
bar
</code></pre>
<h5>A new option <code>--with-pattern</code></h5>
<p>Calling <code>rg -f patternfile --no-heading --with-pattern --with-filename --line-number</code> would show output like</p>
<pre><code>foo:src/cli.js:      // get all your foooooooo here
bar:src/quality.js   // There is a high bar for quality
</code></pre>
<p>This might need to be displayed somewhat differently with multiple patterns per line or with different options.</p>
<h5>Including pattern in JSON output</h5>
<p>This is what I am most interested in. When calling with <code>--json</code>, regardless of the pattern option, matches should include the pattern data:</p>
<pre><code class="language-json">{
   &quot;type&quot; : &quot;match&quot;,
   &quot;data&quot; : {
      &quot;absolute_offset&quot; : 0, &quot;line_number&quot; : 1,
      &quot;path&quot; : { &quot;text&quot; : &quot;src/cli.js&quot; },
      &quot;submatches&quot; : [
        {
            &quot;match&quot; : { &quot;text&quot; : &quot;foooooooo&quot; },
            &quot;pattern&quot; : &quot;foo+&quot;,
            &quot;start&quot; : 16, &quot;end&quot; : 25
         }
      ],
      
      &quot;lines&quot; : { &quot;text&quot; : &quot;// get all your foooooooo here\n&quot; }
   }
}
</code></pre>
<h5>Alternatives</h5>
<p>If this doesn't fit in well, what about exposing the named capture groups in the JSON output? This way I could modify the pattern to <code>(?P&lt;identifier&gt;foo+)</code> and in whatever way you choose read this from the JSON data.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-05-28 12:05</div>
            <div class="timeline-body"><p>I think there are too many variables, too much complexity and not enough user demand for a feature like this. I'd recommend writing your own program to do this. You can even use ripgrep's libraries to do it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2019-05-28 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-05-28 12:05</div>
            <div class="timeline-body"><p>(I'm pretty sure this is a duplicate, but I couldn't find the original issue.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @BurntSushi on 2019-05-28 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2019-05-28 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2019-05-28 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> removed by @BurntSushi on 2019-05-28 12:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kewisch">@kewisch</a> on 2019-05-28 16:59</div>
            <div class="timeline-body"><p>Would you accept a patch to ripgrep to add the pattern to the JSON output, or are you specifically saying you would not want this feature in ripgrep?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-05-28 17:01</div>
            <div class="timeline-body"><p>I do not think this feature belongs in ripgrep at the current time.</p>
<p>Also, it is possible for multiple patterns to match the same text, so you'd need to include all of them. In general, this feature is more difficult to implement than you might imagine, particularly if performance is a concern.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kewisch">@kewisch</a> on 2019-05-28 17:05</div>
            <div class="timeline-body"><p>Ok, thanks for the insight and for considering! I'll see what I can do without.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TheTechromancer">@TheTechromancer</a> on 2024-05-22 15:11</div>
            <div class="timeline-body"><p>@kewisch out of curiosity, did you ever find a solution to your problem of correlating regex patterns to their matches? I am looking at a similar problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kewisch">@kewisch</a> on 2024-05-22 19:22</div>
            <div class="timeline-body"><p>It has been quite a while and for a past job. I don't believe we created something substantial based on ripgrep that solved this issue, looking back over the code we had for this I think we managed to work around by not relying on the pattern at all.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TheTechromancer">@TheTechromancer</a> on 2024-05-22 20:20</div>
            <div class="timeline-body"><p>Thanks. Right now it's looking like the answer to our problem is <a href="https://github.com/VirusTotal/yara">yara</a>.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:55 UTC
    </footer>
</body>
</html>
