<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Running rg with sudo on / causes system hang - BurntSushi/ripgrep #2896</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Running rg with sudo on / causes system hang</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2896">#2896</a>
        opened by <a href="https://github.com/mgiv">@mgiv</a>
        on 2024-09-18 19:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mgiv">@mgiv</a></div>
            <div class="timeline-body"><h3>Please tick this box to confirm you have reviewed the above.</h3>
<ul>
<li>[X] I have a different issue.</li>
</ul>
<h3>What version of ripgrep are you using?</h3>
<p>ripgrep 14.1.1</p>
<h3>How did you install ripgrep?</h3>
<p>pacman</p>
<h3>What operating system are you using ripgrep on?</h3>
<p>Arch Linux</p>
<h3>Describe your bug.</h3>
<p>Without using sudo, searching in / will come up with errors such as:</p>
<pre><code>rg: /proc/1411/task/1411/net/nf_conntrack_expect: Permission denied (os error 13)
</code></pre>
<p>However, there seems to be others, such as Input/output error, Invalid argument, etc.</p>
<p>To avoid this I added sudo, which works on things like find. However with rg it completely hangs the system and gets stuck on something in /proc</p>
<p>This is only recoverable by force restarting the computer</p>
<h3>What are the steps to reproduce the behavior?</h3>
<p><code>sudo rg foobar /</code> from anywhere in the filesystem</p>
<h3>What is the actual behavior?</h3>
<p><a href="https://gist.github.com/bluescorpion35/66d5ad0285ad833affe768e341585292">Logs</a></p>
<p>Note: the actual output is longer, the terminal only showed a certain amount of it. Also I killed rg after a few seconds, in case it crashed the system again</p>
<h3>What is the expected behavior?</h3>
<p>Either not shown the errors, or at least not crash the entire system</p>
<p>I think rg should entirely ignore /proc unless an option is specified</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mgiv">@mgiv</a> on 2024-09-18 19:47</div>
            <div class="timeline-body"><p>Error logs from journalctl</p>
<pre><code>Sep 18 20:41:10 archlinux kernel: [Hardware Error]: System Fatal error.
Sep 18 20:41:10 archlinux kernel: [Hardware Error]: CPU:2 (19:21:0) MC5_STATUS[-|UE|MiscV|AddrV|PCC|TCC|SyndV|-|-|-]: 0xbea0000001000108
Sep 18 20:41:10 archlinux kernel: [Hardware Error]: Error Addr: 0x00ffffffc1315e4e
Sep 18 20:41:10 archlinux kernel: [Hardware Error]: IPID: 0x000500b000000000, Syndrome: 0x000000004d000000
Sep 18 20:41:10 archlinux kernel: [Hardware Error]: Execution Unit Ext. Error Code: 0
Sep 18 20:41:10 archlinux kernel: [Hardware Error]: cache level: RESV, tx: GEN, mem-tx: GEN
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Locked by @ghost on 2024-09-18 21:13</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:50 UTC
    </footer>
</body>
</html>
