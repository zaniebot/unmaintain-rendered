<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pcre2-sys not correctly retrieved, compilation fails in MSYS2/MinGW, GCC 11 - BurntSushi/ripgrep #2222</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>pcre2-sys not correctly retrieved, compilation fails in MSYS2/MinGW, GCC 11</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2222">#2222</a>
        opened by <a href="https://github.com/LigH-de">@LigH-de</a>
        on 2022-05-24 06:20
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/LigH-de">@LigH-de</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>HEAD sources = a726d03641e081aa0f4c4a1b9f24f5a905fd5d04</p>
<h4>How did you install ripgrep?</h4>
<p>vcs_fetch routine in media-autobuild_suite uses git to retrieve HEAD sources:</p>
<pre><code>vcs_fetch 
++ git rev-parse --git-dir
+ [[ -f .git/shallow ]]
+ unshallow=
+ git fetch --all -Ppft
Fetching origin
+ git remote set-head -a origin
origin/HEAD set to master
</code></pre>
<h4>What operating system are you using ripgrep on?</h4>
<p>MSYS2/MinGW on Windows (7 or 10)</p>
<h4>Describe your bug.</h4>
<p><a href="https://github.com/m-ab-s/media-autobuild_suite/issues/2195">media-autobuild_suite issue 2195</a> - please note especially https://github.com/m-ab-s/media-autobuild_suite/issues/2195#issuecomment-1135139851</p>
<p>Parts of build/ripgrep-git/ab-suite.rust.build.log:</p>
<pre><code>CPPFLAGS: -D_FORTIFY_SOURCE=0 -D__USE_MINGW_ANSI_STDIO=1
CFLAGS: -mthreads -mtune=generic -O2 -pipe
CXXFLAGS: -mthreads -mtune=generic -O2 -pipe
LDFLAGS: -pipe -static-libgcc -static-libstdc++
/opt/cargo/bin/cargo.exe build --release --target=i686-pc-windows-gnu --jobs=1 --features pcre2

...

error: failed to run custom build command for `pcre2-sys v0.2.5`

Caused by:
  process didn't exit successfully: `E:\MABS\build\ripgrep-git\target\release\build\pcre2-sys-a3cacd8a0f6685c4\build-script-build` (exit code: 1)

...

  running: &quot;ccache&quot; &quot;gcc&quot; &quot;-O3&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-g&quot; &quot;-fno-omit-frame-pointer&quot; &quot;-m32&quot; &quot;-mthreads&quot; &quot;-mtune=generic&quot; &quot;-O2&quot; &quot;-pipe&quot; &quot;-I&quot; &quot;pcre2/src&quot; &quot;-I&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\include&quot; &quot;-DPCRE2_CODE_UNIT_WIDTH=8&quot; &quot;-DHAVE_STDLIB_H=1&quot; &quot;-DHAVE_MEMMOVE=1&quot; &quot;-DHEAP_LIMIT=20000000&quot; &quot;-DLINK_SIZE=2&quot; &quot;-DMATCH_LIMIT=10000000&quot; &quot;-DMATCH_LIMIT_DEPTH=10000000&quot; &quot;-DMAX_NAME_COUNT=10000&quot; &quot;-DMAX_NAME_SIZE=32&quot; &quot;-DNEWLINE_DEFAULT=2&quot; &quot;-DPARENS_NEST_LIMIT=250&quot; &quot;-DPCRE2_STATIC=1&quot; &quot;-DSTDC_HEADERS=1&quot; &quot;-DSUPPORT_PCRE2_8=1&quot; &quot;-DSUPPORT_UNICODE=1&quot; &quot;-DHAVE_WINDOWS_H=1&quot; &quot;-DSUPPORT_JIT=1&quot; &quot;-o&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\src\\pcre2_chartables.o&quot; &quot;-c&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\src\\pcre2_chartables.c&quot;
  exit code: 1
  running: &quot;ccache&quot; &quot;gcc&quot; &quot;-O3&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-g&quot; &quot;-fno-omit-frame-pointer&quot; &quot;-m32&quot; &quot;-mthreads&quot; &quot;-mtune=generic&quot; &quot;-O2&quot; &quot;-pipe&quot; &quot;-I&quot; &quot;pcre2/src&quot; &quot;-I&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\include&quot; &quot;-DPCRE2_CODE_UNIT_WIDTH=8&quot; &quot;-DHAVE_STDLIB_H=1&quot; &quot;-DHAVE_MEMMOVE=1&quot; &quot;-DHEAP_LIMIT=20000000&quot; &quot;-DLINK_SIZE=2&quot; &quot;-DMATCH_LIMIT=10000000&quot; &quot;-DMATCH_LIMIT_DEPTH=10000000&quot; &quot;-DMAX_NAME_COUNT=10000&quot; &quot;-DMAX_NAME_SIZE=32&quot; &quot;-DNEWLINE_DEFAULT=2&quot; &quot;-DPARENS_NEST_LIMIT=250&quot; &quot;-DPCRE2_STATIC=1&quot; &quot;-DSTDC_HEADERS=1&quot; &quot;-DSUPPORT_PCRE2_8=1&quot; &quot;-DSUPPORT_UNICODE=1&quot; &quot;-DHAVE_WINDOWS_H=1&quot; &quot;-DSUPPORT_JIT=1&quot; &quot;-o&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\pcre2/src\\pcre2_auto_possess.o&quot; &quot;-c&quot; &quot;pcre2/src\\pcre2_auto_possess.c&quot;
  exit code: 1

  --- stderr
  fatal: not a git repository (or any of the parent directories): .git


  error occurred: Command &quot;ccache&quot; &quot;gcc&quot; &quot;-O3&quot; &quot;-ffunction-sections&quot; &quot;-fdata-sections&quot; &quot;-g&quot; &quot;-fno-omit-frame-pointer&quot; &quot;-m32&quot; &quot;-mthreads&quot; &quot;-mtune=generic&quot; &quot;-O2&quot; &quot;-pipe&quot; &quot;-I&quot; &quot;pcre2/src&quot; &quot;-I&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\include&quot; &quot;-DPCRE2_CODE_UNIT_WIDTH=8&quot; &quot;-DHAVE_STDLIB_H=1&quot; &quot;-DHAVE_MEMMOVE=1&quot; &quot;-DHEAP_LIMIT=20000000&quot; &quot;-DLINK_SIZE=2&quot; &quot;-DMATCH_LIMIT=10000000&quot; &quot;-DMATCH_LIMIT_DEPTH=10000000&quot; &quot;-DMAX_NAME_COUNT=10000&quot; &quot;-DMAX_NAME_SIZE=32&quot; &quot;-DNEWLINE_DEFAULT=2&quot; &quot;-DPARENS_NEST_LIMIT=250&quot; &quot;-DPCRE2_STATIC=1&quot; &quot;-DSTDC_HEADERS=1&quot; &quot;-DSUPPORT_PCRE2_8=1&quot; &quot;-DSUPPORT_UNICODE=1&quot; &quot;-DHAVE_WINDOWS_H=1&quot; &quot;-DSUPPORT_JIT=1&quot; &quot;-o&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\src\\pcre2_chartables.o&quot; &quot;-c&quot; &quot;E:\\MABS\\build\\ripgrep-git\\target\\i686-pc-windows-gnu\\release\\build\\pcre2-sys-7567a6bd01fdc6f7\\out\\src\\pcre2_chartables.c&quot; with args &quot;gcc&quot; did not execute successfully (status code exit code: 1).
</code></pre>
<h4>What are the steps to reproduce the behavior?</h4>
<p>compiling with rust and gcc 11 in media-autobuild_suite as verbosely logged</p>
<h4>What is the actual behavior?</h4>
<p>see above, and <a href="https://0x0.st/oa3a.zip">logs.zip</a> for more details</p>
<h4>What is the expected behavior?</h4>
<p>Successful compilation.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2022-05-24 13:10</div>
            <div class="timeline-body"><p>This isn't a problem with ripgrep or one of the crates maintained in its tree. I moved this issue to the rust-pcre2 repo: https://github.com/BurntSushi/rust-pcre2/issues/24</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2022-05-24 13:10</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> added by @BurntSushi on 2022-05-24 13:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:33 UTC
    </footer>
</body>
</html>
