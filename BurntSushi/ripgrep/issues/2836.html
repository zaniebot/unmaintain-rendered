<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Some directories in .ignore aren't ignored - BurntSushi/ripgrep #2836</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Some directories in .ignore aren&#x27;t ignored</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2836">#2836</a>
        opened by <a href="https://github.com/jknoos">@jknoos</a>
        on 2024-06-08 22:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jknoos">@jknoos</a></div>
            <div class="timeline-body">Please tick this box to confirm you have reviewed the above.
<ul>
<li>[X] I have a different issue.</li>
</ul>
What version of ripgrep are you using?
<p>ripgrep 14.1.0</p>
How did you install ripgrep?
<p>pacman</p>
What operating system are you using ripgrep on?
<p>Arch Linux</p>
Describe your bug.
<p>Some directories in ~/.ignore aren&#x27;t ignored correctly.</p>
What are the steps to reproduce the behavior?
<p>Run this script <code>~/test</code> under <code>~/testdir</code>:</p>
<pre><code>#!/bin/bash

mkdir -p ~/testdir/sub/sub2
cd ~/testdir
chmod -r sub/sub2
echo &#x27;sub/sub2&#x27; &gt;&gt; ~/.ignore
echo &#x27;sub/sub2/&#x27; &gt;&gt; ~/.ignore
echo &#x27;/testdir/sub/sub2&#x27; &gt;&gt; ~/.ignore
echo &#x27;/testdir/sub/sub2/&#x27; &gt;&gt; ~/.ignore
rg --debug test
</code></pre>
What is the actual behavior?
<pre><code>[~/testdir]$ ~/test
rg: DEBUG|rg::flags::parse|crates/core/flags/parse.rs:97: no extra arguments found from configuration file
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1099: using heuristics to determine whether to read from stdin or search ./ (is_readable_stdin=false, stdin_consumed=false, mode=Search(Standard))
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1109: heuristic chose to search ./
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1260: found hostname for hyperlink configuration: t480s
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1270: hyperlink format: &quot;&quot;
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:174: using 8 thread(s)
rg: DEBUG|grep_regex::config|crates/regex/src/config.rs:175: assembling HIR from 1 fixed string literals
rg: DEBUG|globset|crates/globset/src/lib.rs:453: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
rg: DEBUG|globset|crates/globset/src/lib.rs:453: built glob set; 8 literals, 0 basenames, 0 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
rg: ./sub/sub2: Permission denied (os error 13)
rg: No files were searched, which means ripgrep probably applied a filter you didn&#x27;t expect.
Running with --debug will show why files are being skipped.
[~/testdir]$ 
</code></pre>
What is the expected behavior?
<p><code>~/testdir/sub/sub2</code> should be ignored, i.e. the <code>rg: ./sub/sub2: Permission denied (os error 13)</code> error is unexpected.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-06-09 11:54</div>
            <div class="timeline-body"><p>Thanks for the bug report. I can reproduce this. Although here is something much simpler that doesn&#x27;t rely on cluttering your <code>$HOME</code> directory:</p>
<pre><code>$ mkdir -p /tmp/rg2836/testdir/sub/sub2
$ chmod -r /tmp/rg2836/testdir/sub/sub2
$ echo &#x27;/testdir/sub/sub2/&#x27; &gt; /tmp/rg2836/.ignore
</code></pre>
<p>And then:</p>
<pre><code>$ cd /tmp/rg2836
$ rg --files
create
$ cd testdir/
$ rg --files
rg: ./sub/sub2: Permission denied (os error 13)
</code></pre>
<p>Moving into the sub-directory should still result in the <code>.ignore</code> file being respected. But there&#x27;s probably an issue dealing with stripping the right prefix of candidate paths with respect to the directory of the <code>.ignore</code> file.</p>
<p>This may also be related to #829 and #278, although not necessarily so.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-06-09 11:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">gitignore</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-06-09 11:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tmccombs">@tmccombs</a> on 2024-08-08 05:45</div>
            <div class="timeline-body"><p>I think <a href="https://github.com/sharkdp/fd/issues/1591">sharkdp/fd#1591</a> may be a case of this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gstokkink">@gstokkink</a> on 2024-08-20 14:16</div>
            <div class="timeline-body"><p>@BurntSushi <a href="https://github.com/BurntSushi/ripgrep/issues/2770">BurntSushi/ripgrep#2770</a> might also be related</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rollup</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-07-11 16:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-09-20 01:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:14 UTC
    </footer>
</body>
</html>
