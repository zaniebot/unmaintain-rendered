<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ripgrep no way to exclude directory e.g. Tests and search for all *.c files - BurntSushi/ripgrep #839</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ripgrep no way to exclude directory e.g. Tests and search for all *.c files</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/839">#839</a>
        opened by <a href="https://github.com/sumonto">@sumonto</a>
        on 2018-02-28 03:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sumonto">@sumonto</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<p>ripgrep 0.7.1
-AVX -SIMD</p>
What operating system are you using ripgrep on?
<p>Mac High Sierra</p>
Describe your question, feature request, or bug.
<p>Imagine a folder structure like:
Feature
codefiles1 (contains *.c, *.h)
codefiles2 (contains *.c, *.h)
tests (contains *.c, *.h)</p>
<p>I would like to search a string str1 in *.c, *.h files however exclude/ignore all occurrences in &quot;tests&quot; folder</p>
<p>I would assume the below syntax would do it?
rg -w str1 -tc -g &#x27;!tests/*&#x27;</p>
<p>If a feature request, please describe the behavior you want and the motivation.
Please also provide an example of how ripgrep would be used if your feature
request were added.</p>
<p>If a bug, please see below.</p>
If this is a bug, what are the steps to reproduce the behavior?
<p>NA</p>
If this is a bug, what is the actual behavior?
<p>NA</p>
If this is a bug, what is the expected behavior?
<p>ripgrep should have excluded files from &quot;tests&quot; folder</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-02-28 03:23</div>
            <div class="timeline-body"><p>Please fill out the entire issue template. That&#x27;s why it is there to guide you, because the request you&#x27;ve made is insufficient to act on. In particular, I have no idea what you are asking for.</p>
<p>Please also make sure you&#x27;ve read the documentation. ripgrep can of course exclude directories.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-03-01 02:01</div>
            <div class="timeline-body"><p>@sumonto you&#x27;re correct <code>$ rg -w str1 -tc -g &#x27;!tests/*&#x27;</code> would do what you want. So is that not working for you? It works on my machine with v0.8.1</p>
<pre><code>kevin@beefcake:/tmp/rg$ rg --version
ripgrep 0.8.1
-SIMD -AVX
kevin@beefcake:/tmp/rg$ tree
.
├── code
│   ├── other.h
│   └── some.c
└── test
    └── bar.c

2 directories, 3 files
kevin@beefcake:/tmp/rg$ cat code/other.h 
foo
kevin@beefcake:/tmp/rg$ cat code/some.c 
foo
kevin@beefcake:/tmp/rg$ cat test/bar.c 
foo
kevin@beefcake:/tmp/rg$ rg -w foo -tc -g &#x27;!test/*&#x27;
code/some.c
1:foo

code/other.h
1:foo
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-03-10 12:46</div>
            <div class="timeline-body"><p>It&#x27;s not possible to act on this issue. Closing.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-03-10 12:46</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mmahmoudian">@mmahmoudian</a> on 2019-10-09 15:15</div>
            <div class="timeline-body"><p>I might know what the issue might be: ZSH</p>
<p>I was trying to make this work in ZSH:</p>
<pre><code>rg --stats --ignore-case --type r --max-filesize 200K -g &quot;!packrat&quot; --regexp &quot;stringi&quot;
</code></pre>
<p>The command was suppose to only search in specific file types (in this case <code>r</code> type) and search for the text <code>stringi</code> but I want it to exclude everything in &quot;packrat&quot; folders in the following scenario:</p>
<pre><code>.
├── Project1/
│   ├── packrat/
│   │   ├── lib1/R/
│   │   │   └── some_file.R
│   │   └── lib2/R/
│   │       └── some_file.R
│   ├── other_folder/
│   │   └── some_file.Rmd
│   └── some_file.R
│
└── Project2/
     ├── packrat/
     │   └── lib1/R/
     │       └── some_file.R
     └── some_file.R
</code></pre>
<p>the <code>!</code> has a meaning in ZSH, so you should escape the character (except if you use it as an alias). The correct command in my case is:</p>
<pre><code>rg --stats --ignore-case --type r --max-filesize 200K -g &quot;\!packrat&quot; --regexp &quot;stringi&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2019-10-09 15:38</div>
            <div class="timeline-body"><p>You can also just use single-quotes instead of double- (which is what the OP was doing, so i don&#x27;t think it was the issue there). Or you can turn off history expansion, but you lose some functionality obv</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BobrImperator">@BobrImperator</a> on 2021-03-06 15:26</div>
            <div class="timeline-body"><p>I found out that <code>-g</code> didn&#x27;t work for me, but <code>--glob</code> did as per <code>man rg</code>, and final command looks like this:
<code>.zshrc</code>
<code>export FZF_DEFAULT_COMMAND=&quot;rg --files --follow --hidden --glob=\!.git&quot;</code></p>
<p>which previously looked like this
`&quot;rg --files --follow --hidden -g !.git&quot;&#x27;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okybr">@okybr</a> on 2021-04-29 12:49</div>
            <div class="timeline-body"><p>@BobrImperator, use <code>-g &#x27;!.git&#x27;</code>, i.e. single-quotes ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joeky888">@joeky888</a> on 2021-06-10 03:11</div>
            <div class="timeline-body"><p>Hello everyone. How do you exclude multiple directories? Currently, I am using --glob multiple times like this:</p>
<pre><code>rg --hidden -g &#x27;!.git&#x27; -g &#x27;!.svn&#x27; -g &#x27;!.hg&#x27; -g &#x27;!CVS&#x27; -g &#x27;!.bzr&#x27; -g &#x27;!vendor&#x27; -g &#x27;!node_modules&#x27; -g &#x27;!dist&#x27; -g &#x27;!bin&#x27;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-06-10 10:26</div>
            <div class="timeline-body"><p>@joeky888 Why are you bumping old issues? Use Discussions to ask questions next time please.</p>
<p>In any case, you can use <code>-g &#x27;!{.git,.svn,.hg}&#x27;</code> (and so on) to exclude multiple directories. But your approach works fine too.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nyngwang">@nyngwang</a> on 2021-11-08 08:03</div>
            <div class="timeline-body"><p>@BurntSushi Thanks for the solution, it works!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dharmaturtle">@dharmaturtle</a> on 2022-01-06 16:25</div>
            <div class="timeline-body"><p>Apologies for necrobumping, but to emphasize the <code>directories</code> part of joeky888&#x27;s question, this works for me for (sub)directories: <code>-g &#x27;!{**/node_modules/*,**/.git/*}&#x27;</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Riveascore">@Riveascore</a> on 2023-01-20 03:49</div>
            <div class="timeline-body"><p>@dharmaturtle Thank you!!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:06 UTC
    </footer>
</body>
</html>
