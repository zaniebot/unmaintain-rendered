<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>images being searched? - BurntSushi/ripgrep #368</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>images being searched?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/368">#368</a>
        opened by <a href="https://github.com/ryanong">@ryanong</a>
        on 2017-02-17 15:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ryanong">@ryanong</a></div>
            <div class="timeline-body"><p>I was reading in the documentation binary files are skipped. Are images considered binary or not?</p>
<p>Other filetypes being search which I would consider binary:
font files
xls files</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:01</div>
            <div class="timeline-body"><p>Binary detection is, at best, a heuristic. The heuristic is similar to what GNU grep does. If the file contains a <code>NUL</code> byte, then the file is treated as a &quot;binary&quot; file. There is however a bug associated with detection that causes it to be too conservative. See #52.</p>
<p>Could you please provide more details on the problem you're having? In particular, can you provide a small reproducible example?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:09</div>
            <div class="timeline-body"><p>yea sure
download https://upload.wikimedia.org/wikipedia/commons/8/85/Capybara_portrait.jpg into a temp folder and run <code>rg --files</code> and it comes up as a valid searchable file.</p>
<p>I'm on <code>ripgrep 0.4.0</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:11</div>
            <div class="timeline-body"><blockquote>
<p>and it comes up as a valid searchable file</p>
</blockquote>
<p>That's because it is. The only way to know whether a file is binary or not is... to search it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2017-02-17 16:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:12</div>
            <div class="timeline-body"><p>fair point. I guess I was just expecting functionality similar to ag
https://github.com/ggreer/the_silver_searcher/blob/b5e750a42c28d0ac1f5acd6ac82cfdd8518c732e/src/util.c#L351 but I I understand that ripgrep is not ag</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:17</div>
            <div class="timeline-body"><blockquote>
<p>I guess I was just expecting functionality similar to ag</p>
</blockquote>
<p>It is similar. In fact, with your example file, the behavior is nearly identical. You're using the <code>--files</code> flag which say &quot;print all files that ripgrep <strong>will search</strong>.&quot; Watch:</p>
<pre><code>$ mkdir ripgrep-368
$ cd ripgrep-368
$ curl -sO 'https://upload.wikimedia.org/wikipedia/commons/8/85/Capybara_portrait.jpg'
$ rg purl
$ rg -a purl
Capybara_portrait.jpg
24:            xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot;&gt;
$ ag purl
$ ag -a purl
Binary file Capybara_portrait.jpg matches.
$ rg --files
Capybara_portrait.jpg
$ ag -g .
Capybara_portrait.jpg
</code></pre>
<p>Both tools emit <code>Capybara_portrait.jpg</code> as files that will be searched, but both tools ignore that file when actually executing the search.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:20</div>
            <div class="timeline-body"><p>Ah cool! thanks for making an awesome tool and taking the time to explain.</p>
<p>The reason I brought this up was I am trying to figure out why AG is faster searching my repo and I doubt that ag is faster than rg at individual files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:25</div>
            <div class="timeline-body"><p>When you say &quot;ag is faster,&quot; do you mean &quot;it beat ripgrep by a few milliseconds on my tiny repo&quot;? Or do you mean &quot;it beat ripgrep by several seconds on a very large repo&quot;?</p>
<p>If the former, then that's not too interesting. At that point, we're talking about process overhead and the cost of spinning up threads.</p>
<p>If the latter, then it's hard to say without a more thorough analysis. If you could reproduce your results on a repo we can both access, then I could probably tell you exactly what's going on if you're curious.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:31</div>
            <div class="timeline-body"><p>The later, ag does it in about a second and ripgrep takes about 5-10 seconds. I'll attempt to make a reproducible repo. I'll open a new issue with step by step replication.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:38</div>
            <div class="timeline-body"><p>@ryanong Wow that's a big difference! Thanks for the attempt. :-)</p>
<p>(The first thing I'd check for is whether they are searching the same files. ag's gitignore support isn't great, so if it's accidentally ignoring some large files or something, that might explain things.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:42</div>
            <div class="timeline-body"><p>yep that is what I was thinking, which is why I thought images were being searched.
I compared <code>ag -l</code> to <code>ripgrep --files</code> and the only thing that stuck out were images</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:43</div>
            <div class="timeline-body"><p>@ryanong You probably want to compare <code>ag -l</code> with <code>rg -l</code>. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:44</div>
            <div class="timeline-body"><p><code>ag -l</code> without an argument lists all files. <code>rg -l</code> requires an argument</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ryanong">@ryanong</a> on 2017-02-17 16:45</div>
            <div class="timeline-body"><p>I just did <code>rg -l &quot;&quot;</code> and that worked. there is no difference in files :/ I'll keep poking around</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:45</div>
            <div class="timeline-body"><p>@ryanong Try <code>ag -l '^'</code> vs <code>rg -l '^'</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-17 16:45</div>
            <div class="timeline-body"><p>ah yeah, weird. best bet is to find a reproduction we can both see i guess. thanks for your patience :-)</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:04 UTC
    </footer>
</body>
</html>
