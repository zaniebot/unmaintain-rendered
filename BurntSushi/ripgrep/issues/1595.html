<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rg crashes on every use.  - BurntSushi/ripgrep #1595</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>rg crashes on every use.</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1595">#1595</a>
        opened by <a href="https://github.com/WaterSibilantFalling">@WaterSibilantFalling</a>
        on 2020-05-25 01:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/WaterSibilantFalling">@WaterSibilantFalling</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<p>prompt&gt; rg --version
ripgrep 11.0.2
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)</p>
How did you install ripgrep?
<p>via Debian aptitude</p>
What operating system are you using ripgrep on?
<p>WSL on Windows 10</p>
<p>Linux DESKTOP-6PNTD6B 4.4.0-17763-Microsoft #1217-Microsoft Mon May 05 16:09:00 PST 2020 x86_64 x86_64 x86_64 GNU/Linux</p>
<p>Ubuntu focal</p>
Describe your bug.
<p>rg crashes whenever it runs</p>
What are the steps to reproduce the behavior?
<p>Run rg with any search pattern, with or without regex wildcards, character classes . . .</p>
What is the actual behavior?
<pre><code>rg -i --debug ConfigurationFragment *

DEBUG|grep_regex::literal|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/grep-regex-0.1.5/src/literal.rs:105: required literals found: [Cut(CONFI), Cut(cONFI), Cut(CoNFI), Cut(coNFI), Cut(COnFI), Cut(cOnFI), Cut(ConFI), Cut(conFI), Cut(CONfI), Cut(cONfI), Cut(CoNfI), Cut(coNfI), Cut(COnfI), Cut(cOnfI), Cut(ConfI), Cut(confI), Cut(CONFi), Cut(cONFi), Cut(CoNFi), Cut(coNFi), Cut(COnFi), Cut(cOnFi), Cut(ConFi), Cut(conFi), Cut(CONfi), Cut(cONfi), Cut(CoNfi), Cut(coNfi), Cut(COnfi), Cut(cOnfi), Cut(Confi), Cut(confi)]
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 13 basenames, 7 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; thread &#x27;0&lt;unnamed&gt; literals, &#x27; panicked at &#x27;0assertion failed: `(left == right)`
  left: `22`,
 right: `4` basenames, &#x27;, 11src/libstd/sys/unix/thread.rs extensions, thread &#x27;:0&lt;unnamed&gt;172 prefixes, &#x27; panicked at &#x27;:0assertion failed: `(left == right)`
  left: `22`,
 right: `4`21 suffixes, &#x27;,
0src/libstd/sys/unix/thread.rsnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace.
 required extensions, :0172 regexes:
21
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:430: glob converted to regex: Glob { glob: &quot;**/hs_err_pid*&quot;, re: &quot;(?-u)^(?:/?|.*/)hs_err_pid[^/]*$&quot;, opts: GlobOptions { case_insensitive: false, literal_separator: true, backslash_escape: true }, tokens: Tokens([RecursivePrefix, Literal(&#x27;h&#x27;), Literal(thread &#x27;&#x27;&lt;unnamed&gt;s&#x27; panicked at &#x27;&#x27;assertion failed: `(left == right)`
  left: `22`,
 right: `4`)&#x27;, , src/libstd/sys/unix/thread.rsLiteral:(172&#x27;:21
_&#x27;), Literal(&#x27;e&#x27;), Literal(&#x27;r&#x27;), Literal(&#x27;r&#x27;), Literal(&#x27;_&#x27;), Literal(&#x27;p&#x27;), Literal(&#x27;i&#x27;), Literal(&#x27;d&#x27;), ZeroOrMore]) }
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 2 literals, 5 basenames, 10 extensions, 0 prefixes, 0 suffixes, 1 required extensions, 1 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 0 literals, thread &#x27;0&lt;unnamed&gt; basenames, &#x27; panicked at &#x27;11assertion failed: `(left == right)`
  left: `22`,
 right: `4` extensions, 0&#x27;,  prefixes, src/libstd/sys/unix/thread.rs0: suffixes, 172:021 required extensions,
0 regexes
thread &#x27;&lt;unnamed&gt;&#x27; panicked at &#x27;assertion failed: `(left == right)`
  left: `22`,
 right: `4`&#x27;, src/libstd/sys/unix/thread.rs:172:DEBUG21|
globset|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/globset-0.4.4/src/lib.rs:435: built glob set; 1 literals, 0 basenames, 0 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|ignore::walk|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/ignore-0.4.10/src/walk.rs:1639: ignoring app/.gitignore: Ignore(IgnoreMatch(Hidden))
DEBUG|ignore::walk|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/ignore-0.4.10/src/walk.rs:1639: ignoring app/app.iml: Ignore(IgnoreMatch(Gitignore(Glob { from: Some(&quot;/mnt/c/sdm/SI App source/application.whitelabel.android/.gthread &#x27;i&lt;unnamed&gt;t&#x27; panicked at &#x27;iassertion failed: `(left == right)`
  left: `22`,
 right: `4`g&#x27;, nsrc/libstd/sys/unix/thread.rso:r172e:&quot;21)
, original: &quot;*.iml&quot;, actual: &quot;**/*.iml&quot;, is_whitelist: false, is_only_dir: false })))
DEBUG|ignore::walk|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/ignore-0.4.10/src/walk.rs:1639: ignoring gradle/wrapper/gradle-wrapper.jar: Ignore(IgnoreMatch(Gitignore(Glob { from: Some(&quot;/mnt/c/sdm/SI App source/application.whitelabel.android/.gitignore&quot;), original: &quot;*.jar&quot;, actual: &quot;**/*.jar&quot;, is_whitelist: false, is_only_dir: false })))
DEBUG|ignore::walk|/usr/share/cargo/registry/ripgrep-11.0.2/debian/cargo_registry/ignore-0.4.10/src/walk.rs:1639: ignoring app/build: Ignore(IgnoreMatch(Gitignore(Glob { from: Some(&quot;app/.gitignore&quot;), original: &quot;/build&quot;, actual: &quot;buildthread &#x27;&quot;&lt;unnamed&gt;, &#x27; panicked at &#x27;is_whitelist: assertion failed: `(left == right)`
  left: `22`,
 right: `4`false&#x27;, , src/libstd/sys/unix/thread.rsis_only_dir:: 172false: }21)
))

</code></pre>
<p>at this point rg freezes, computer CPU rises until one CPU is at 99%</p>
What is the expected behavior?
<ul>
<li>Found the string seached for</li>
<li>not spit out errors</li>
<li>not crashed &amp; hung</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-05-25 01:39</div>
            <div class="timeline-body"><p>This looks like a problem with your WSL environment. I&#x27;m not a Windows user, but IIRC, there is some problem with spawning threads in WSL1. ripgrep can&#x27;t fix a broken environment.</p>
<p>You might be able to work around this by using <code>-j1</code>, which will disable multi-threading. Searches will be slower.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-05-25 01:39</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-05-25 01:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/WaterSibilantFalling">@WaterSibilantFalling</a> on 2020-06-08 06:06</div>
            <div class="timeline-body"><p>BTW, adding <code>-j1</code> is the solution.</p>
<p>ripgrep / rg now works perfectly on Windows 10</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:10 UTC
    </footer>
</body>
</html>
