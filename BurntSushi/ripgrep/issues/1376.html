<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>&quot;rg --no-ignore --ignore-vcs&quot; does not ignore via .gitignore - BurntSushi/ripgrep #1376</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>&quot;rg --no-ignore --ignore-vcs&quot; does not ignore via .gitignore</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1376">#1376</a>
        opened by <a href="https://github.com/blueyed">@blueyed</a>
        on 2019-09-12 12:53
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/blueyed">@blueyed</a></div>
            <div class="timeline-body"><p>While looking into https://github.com/BurntSushi/ripgrep/issues/1374 I've noticed that <code>rg --no-config --no-ignore --ignore-vcs --debug</code> does not appear to use a <code>.gitignore</code> file (from the current directory):</p>
<pre><code>% rg --no-config --no-ignore --ignore-vcs --debug luarocks
DEBUG|rg::args|src/args.rs:544: not reading config files because --no-config is present
DEBUG|grep_regex::literal|grep-regex/src/literal.rs:59: literal prefixes detected: Literals { lits: [Complete(luarocks)], limit_size: 250, limit_class: 10 }
DEBUG|globset|globset/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|ignore::walk|ignore/src/walk.rs:1639: ignoring ./.SRCINFO: Ignore(IgnoreMatch(Hidden))
DEBUG|ignore::walk|ignore/src/walk.rs:1639: ignoring ./.git: Ignore(IgnoreMatch(Hidden))
DEBUG|ignore::walk|ignore/src/walk.rs:1639: ignoring ./.gitignore: Ignore(IgnoreMatch(PKGBUILD
13:makedepends=('luarocks')
15:source=(&quot;https://luarocks.org/$_rockname-$pkgver-$_rockrel.src.rock&quot;)
19:  luarocks --tree=&quot;$pkgdir/usr&quot; install --deps-mode=none &quot;$_rockname-$pkgver-$_rockrel.src.rock&quot;
Hidden))
DEBUG|globset|globset/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:435: built glob set; 0 literals, 0 basenames, 11 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
</code></pre>
<p><code>.gitignore</code> contains just &quot;*&quot;, i.e. everything should be ignored.</p>
<p>It works when using <code>--ignore</code> additionally, but <code>--ignore-vcs</code> should be enough to enable this, no?</p>
<p>It also does not work with all <code>--ignore-*</code> options:</p>
<blockquote>
<p>rg --no-config --no-ignore --ignore-vcs --ignore-global --ignore-dot --ignore-messages --ignore-parent â€¦</p>
</blockquote>
<h4>What version of ripgrep are you using?</h4>
<p>ripgrep 11.0.2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-09-12 13:05</div>
            <div class="timeline-body"><p>This is working as intended as far as I can see. The only way to override <code>--no-ignore</code> is with <code>--ignore</code>. If you add <code>--no-ignore</code>, then you can't selectively turn other things on. We could add logic that checks whether <code>--ignore-vcs</code> is set (I think), and then use its presence to override more general options. (And then to the same for other ignore flags.) The logic is already pretty hairy though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @BurntSushi on 2019-09-12 13:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/blueyed">@blueyed</a> on 2019-09-12 13:07</div>
            <div class="timeline-body"><p>Ah, I see.
Maybe it would help to add debug output for handling those args?
(I've expected <code>--no-ignore</code> to turn on all flags, and that <code>--ignore-vcs</code> would turn off the vcs flag again)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/blueyed">@blueyed</a> on 2019-09-12 13:08</div>
            <div class="timeline-body"><p>I.e. <code>--no-ignore</code> could be expanded internally into having specified all <code>--no-ignore</code> flags (except for <code>--no-ignore-messages</code> probably).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-09-12 13:11</div>
            <div class="timeline-body"><p>I don't have that kind of arbitrary control over arg parsing. Even with my suggested fix, <code>--no-ignore --ignore-vcs --no-ignore</code> wouldn't work like one would expect, since the second <code>--no-ignore</code> won't actually override <code>--ignore-vcs</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">gitignore</span> added by @BurntSushi on 2020-05-08 11:31</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rollup</span> added by @BurntSushi on 2023-11-25 19:30</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2023-11-25 20:04</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:00 UTC
    </footer>
</body>
</html>
