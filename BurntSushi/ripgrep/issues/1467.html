<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make it easier to use --multiline-dotall - BurntSushi/ripgrep #1467</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Make it easier to use --multiline-dotall</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1467">#1467</a>
        opened by <a href="https://github.com/waldyrious">@waldyrious</a>
        on 2020-01-22 14:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/waldyrious">@waldyrious</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>❯ rg --version
ripgrep 11.0.2
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p><code>brew install ripgrep</code></p>
<h4>What operating system are you using ripgrep on?</h4>
<p>MacOS Catalina (v10.15.2)</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>I often need to search for patterns that span multiple lines, for which the combination <code>--multiline --multiline-dotall</code> is very helpful. There are two changes that would make this feature less cumbersome to use, though:</p>
<ol>
<li>Passing <code>--multiline-dotall</code> could automatically assume <code>--multiline</code>;</li>
<li>A short option name could be added for <code>--multiline-dotall</code>, just like there's <code>-U</code> for <code>--multiline</code>.</li>
</ol>
<p>These two together would make a command like</p>
<pre><code>rg -U --multiline-dotall 'foo.+?bar'</code></pre>
<p>become, say:</p>
<pre><code>rg -µ 'foo.+?bar'</code></pre>
<p>(of course, replacing <code>-µ</code> with the actual short option name for <code>--multiline-dotall</code>).</p>
<p>Alternatively, if only (2) is implemented, it would still be quite more convenient:</p>
<pre><code>rg -Uµ 'foo.+?bar'</code></pre>
<p>I'd be happy to submit a PR if this is something that would be welcome.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-01-22 14:28</div>
            <div class="timeline-body"><p>Thanks for the thoughtful issue. I have a few thoughts.</p>
<p>I think making <code>--multiline-dotall</code> enable <code>--multiline</code> sounds plausible to me on the surface. However, the original intent was that folks could put <code>--multiline-dotall</code> in their config file (or alias), which would be inert without <code>--multiline</code> but otherwise enable the dotall behavior by default when <code>--multiline</code> is used. This is indeed a documented behavior, so I'm hesitant to change it. This may work for you if <code>--multiline-dotall</code> is indeed the most common thing. You could then use <code>--no-multiline-dotall</code> or <code>(?-s)</code> to disable it in the few cases where you don't want it.</p>
<p>Additionally, <code>--multiline-dotall</code> is not the only way to enable this behavior. For example, instead of</p>
<pre><code>$ rg -U --multiline-dotall 'foo.+?bar'
</code></pre>
<p>you could write</p>
<pre><code>$ rg -U '(?s)foo.+?bar'
</code></pre>
<p>Finally, the problem with using a short option is that we have very few choices left and I'm not quite sure this rises to the level of needing that. Especially when <code>(?s)</code> works and is fairly short on its own, although perhaps a bit more awkward to type than a short flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2020-01-22 14:28</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/waldyrious">@waldyrious</a> on 2020-01-22 14:51</div>
            <div class="timeline-body"><p>Thanks for the incredibly fast and detailed response!</p>
<p>Indeed I was reading through similar issues (especially the very informative #1150!) and realized that <code>(?s)</code> could be used as a somewhat more convenient alternative to spelling out <code>--multiline-dotall</code>. Not nearly as convenient as a single-letter option, but as you say, with the flag in the pattern itself and the config file method both being available, it may be hard to justify eating up yet another single-letter option.</p>
<p>Just to add a bit more concrete context: in order to type <code>rg -U '(?s)foo.+?bar'</code> I need 26 key-presses in my Portuguese keyboard layout, including modifiers like Shift:</p>
<ul>
<li><kbd>r</kbd>, <kbd>g</kbd>, <kbd>␣</kbd>, <kbd>-</kbd>, <kbd>Shift</kbd>+<kbd>u</kbd>, <kbd>␣</kbd>, <kbd>'</kbd>, <kbd>Shift</kbd>+<kbd>8</kbd>, <kbd>Shift</kbd>+<kbd>'</kbd>, <kbd>s</kbd>, <kbd>Shift</kbd>+<kbd>9</kbd>, <kbd>f</kbd>, <kbd>o</kbd>, <kbd>o</kbd>, <kbd>.</kbd>, <kbd>+</kbd>, <kbd>Shift</kbd>+<kbd>'</kbd>, <kbd>b</kbd>, <kbd>a</kbd>, <kbd>r</kbd>, <kbd>'</kbd></li>
</ul>
<p>...while for <code>rg -µ 'foo.+?bar'</code> (assuming, again, that µ would become a plain ASCII letter), I would only need 18 (19 at worst, if it's uppercase):</p>
<ul>
<li><kbd>r</kbd>, <kbd>g</kbd>, <kbd>␣</kbd>, <kbd>-</kbd>, <kbd>µ</kbd>, <kbd>␣</kbd>, <kbd>'</kbd>, <kbd>f</kbd>, <kbd>o</kbd>, <kbd>o</kbd>, <kbd>.</kbd>, <kbd>+</kbd>, <kbd>Shift</kbd>+<kbd>'</kbd>, <kbd>b</kbd>, <kbd>a</kbd>, <kbd>r</kbd>, <kbd>'</kbd></li>
</ul>
<p>That said, I would be OK with this issue being closed, but I'd suggest keeping this open for a while to gauge community interest. It may be that the trade-off is indeed worth if many people would support it.</p>
<p>ps - I will make sure to include some reference to the above options in <a href="https://github.com/tldr-pages/tldr/blob/master/pages/common/rg.md">ripgrep's tldr page</a> to make this more discoverable.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:05 UTC
    </footer>
</body>
</html>
