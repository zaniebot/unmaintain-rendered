<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[Request] Character-based context (-A / -B / -C) - BurntSushi/ripgrep #2617</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[Request] Character-based context (-A / -B / -C)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2617">#2617</a>
        opened by <a href="https://github.com/mazunki">@mazunki</a>
        on 2023-10-02 20:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mazunki">@mazunki</a></div>
            <div class="timeline-body"><p>It&#x27;s not too uncommon for files to have huge lines containing some data, including your match. When grepping over a directory with tons of files, this can be quite overwhelming.</p>
<p><em>See first picture below.</em></p>
<p>There are some workarounds, but they all have some drawbacks:</p>
<ul>
<li><code>-l</code> shows only matching files, with no context.</li>
<li><code>-M 24</code> is kind of useless by itself, as you might as well just use <code>-l</code> at that point</li>
<li><code>-M 24 --max-columns-preview</code> is partially useful, except it only displays the start of the line, and not the context of the match itself. Furthermore, <code>[... 0 more matches]</code> is kind of distracting. I feel this should be grayed out, at the very least (and hidden when there&#x27;s no more matches).</li>
</ul>
<p><em>See second picture below.</em></p>
<p>My suggestion and request here is to extend the <code>--after-context</code> (<code>-A</code>), <code>--before-context</code> (<code>-B</code>) and <code>--context</code> (<code>-C</code>) to support character-based limits, instead of only working per-line, by the use of an optional period.</p>
<p><code>rg -C=.24</code> would display 24 characters to the left, and 24 characters to the right. This could be combined as <code>-C=3.24</code> to display a context of 3 lines before and 3 lines after the match (also limited to the 24-character radius), although this is arguably not really useful in practice.</p>
<p>This would consider multiple matches in the same line as the center of a character range. If there&#x27;s an overlap between both matches, it should consider it as one longer range, instead of duplicating the output for each case.</p>
<p>Example 1:
<img src="https://github.com/BurntSushi/ripgrep/assets/32819373/4bc22105-ace3-4285-acad-c2ce8436cf67" alt="image"></p>
<p>Example 2:
<img src="https://github.com/BurntSushi/ripgrep/assets/32819373/1c74a317-9de7-42e7-848e-f4ecb913f370" alt="image"></p>
<p>cc: @nate-sys</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-10-05 14:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-10-05 14:37</div>
            <div class="timeline-body"><p>This is a duplicate of #1352.</p>
<p>If you want to copy your proposal in a comment on that issue, that would be great. I somewhat like your idea of reusing existing flags. But I haven&#x27;t noodled on it too much. I&#x27;m not sure if it is too cute or has other issues.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-10-05 14:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:13 UTC
    </footer>
</body>
</html>
