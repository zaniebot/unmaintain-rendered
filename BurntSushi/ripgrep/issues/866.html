<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recursive directory search behavior change with glob - BurntSushi/ripgrep #866</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Recursive directory search behavior change with glob</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/866">#866</a>
        opened by <a href="https://github.com/cmaughan">@cmaughan</a>
        on 2018-03-21 17:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/cmaughan">@cmaughan</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<p>0.8.1</p>
What operating system are you using ripgrep on?
<p>Win10</p>
Describe your question, feature request, or bug.
<p>I have a standard setup for Rg, which I used until I updated to the latest.  It goes like this:
%2 is the search term to find in a list of files.</p>
<pre><code>rg --no-ignore --hidden --follow --glob &quot;{^.git/*,^.*/Built/*,^.*/Built-Projects/*,*.cpp,*.js,*.config,*.html,*.h,*.txt,*.md,*.cmake}&quot; &quot;%2&quot;
</code></pre>
<p>This <em>used</em> to search recursively in the file types I provide here, and ignore .git, etc.
The behavior has changed; it now only searches the top level directory.</p>
<p>How do I modify it to again recurse into all folders?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-03-21 17:37</div>
            <div class="timeline-body"><p>Please provide a corpus that I can test on. Please show expected output and actual output.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cmaughan">@cmaughan</a> on 2018-03-21 17:46</div>
            <div class="timeline-body"><p><a href="https://github.com/BurntSushi/ripgrep/files/1834494/test.zip">test.zip</a>
Here is a test.  If you run the command in the .bat file, it should find &#x27;Hello&#x27; in 3 places.  It does not; it only finds it at the root.  This worked on whatever previous version I had; but when I refreshed my binary today, the exclude glob is effectively stopping recursive folder searches.  I don&#x27;t know if this is a bug fix or a regression!  Either way, I&#x27;d like to know how to make it work as before ;)</p>
<p>Actual Output:</p>
<pre><code>contents.txt
1:Hello at root
</code></pre>
<p>Expected:</p>
<pre><code>contents.txt
1:Hello at root

1\contents.txt
1:Hello In 1

2\contents.txt
1:Hello in 2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-02 22:21</div>
            <div class="timeline-body"><p>@cmaughan Thanks for the better example! I can indeed reproduce this, and I believe it was the result of a bug fix: #761</p>
<p>This command gives the output you want:</p>
<pre><code>$ rg --glob &quot;^.git/*&quot; --glob &quot;*.txt&quot; &quot;Hello&quot;
</code></pre>
<p>In particular, since your previous glob of <code>{^.git/*,*.txt}</code> contains a <code>/</code>, that prevents every <code>*</code> from matching a <code>/</code>, and therefore, <code>*.txt</code> will only match files in the current directory instead of also in nested directories. When you specify a glob of <code>*.txt</code> all on its own, since no literal <code>/</code> appears, the <code>*</code> is permitted to match a <code>*</code>.</p>
<p>These are heuristics laid out by the glob semantics documented in <code>man gitignore</code>. In previous releases of ripgrep, there was a bug where the literal <code>/</code> in your glob wasn&#x27;t detected, and therefore, <code>*</code> was permitted to match a <code>/</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-02 22:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-02 22:21</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-02 22:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cmaughan">@cmaughan</a> on 2018-04-12 06:38</div>
            <div class="timeline-body"><p>Thanks for the response; just got back from a trip, but this looks great; will try it!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:06 UTC
    </footer>
</body>
</html>
