<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panic when grepping in Ruby source - BurntSushi/ripgrep #1167</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Panic when grepping in Ruby source</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1167">#1167</a>
        opened by <a href="https://github.com/sirupsen">@sirupsen</a>
        on 2019-01-19 13:50
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sirupsen">@sirupsen</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<pre><code>ripgrep 0.10.0
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
How did you install ripgrep?
<p>Brew, latest version.</p>
What operating system are you using ripgrep on?
<p>MacOS Mojave, 10.14.1</p>
Describe your question, feature request, or bug.
<pre><code>git clone git@github.com:ruby/ruby.git /tmp/ruby
cd /tmp/ruby
rg RUBY_VM_SET_TIMER_INTERRUPT
</code></pre>
<p>Will result in the following panic:</p>
<pre><code>thread &#x27;&lt;unnamed&gt;&#x27; panicked at &#x27;index out of bounds: the len is 1 but the index is 1&#x27;, /Users/brew/Library/Caches/Homebrew/cargo_cache/registry/src/github.com-1ecc6299db9ec823/encoding_rs-0.8.6/src/handles.rs:309:21
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.
stack backtrace:
   0: std::sys::unix::backtrace::tracing::imp::unwind_backtrace
   1: std::sys_common::backtrace::print
   2: std::panicking::default_hook::{{closure}}
   3: std::panicking::default_hook
   4: std::panicking::rust_panic_with_hook
   5: std::panicking::continue_panic_fmt
   6: rust_begin_unwind
   7: core::panicking::panic_fmt
   8: core::panicking::panic_bounds_check
   9: encoding_rs::utf_16::Utf16Decoder::decode_to_utf8_raw
  10: encoding_rs::variant::VariantDecoder::decode_to_utf8_raw
  11: encoding_rs::Decoder::decode_to_utf8_without_replacement
  12: encoding_rs::Decoder::decode_to_utf8
  13: encoding_rs_io::util::TinyTranscoder::transcode
  14: &lt;encoding_rs_io::DecodeReaderBytes&lt;R, B&gt; as std::io::Read&gt;::read
  15: &lt;grep_searcher::line_buffer::LineBufferReader&lt;&#x27;b, R&gt;&gt;::fill
  16: &lt;grep_searcher::searcher::glue::ReadByLine&lt;&#x27;s, M, R, S&gt;&gt;::run
  17: grep_searcher::searcher::Searcher::search_path
  18: &lt;rg::search::SearchWorker&lt;W&gt;&gt;::search_impl
  19: rg::search_parallel::{{closure}}::{{closure}}
  20: ignore::walk::Worker::run
</code></pre>
If this is a bug, what are the steps to reproduce the behavior?
<pre><code>git clone git@github.com:ruby/ruby.git /tmp/ruby &amp;&amp; cd /tmp/ruby &amp;&amp; rg RUBY_VM_SET_TIMER_INTERRUPT
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Panic when grepping in Ruby&quot; to &quot;Panic when grepping in Ruby soource&quot; by <a href="https://github.com/sirupsen">@sirupsen</a> on 2019-01-19 13:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Panic when grepping in Ruby soource&quot; to &quot;Panic when grepping in Ruby source&quot; by <a href="https://github.com/sirupsen">@sirupsen</a> on 2019-01-19 13:57</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-01-19 13:59</div>
            <div class="timeline-body"><p>This is a duplicate of #1052. It was fixed on master in #1065. Unfortunately, there hasn&#x27;t been a release since then. I&#x27;ll try to get one out soonish.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-01-19 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">duplicate</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-01-19 13:59</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sirupsen">@sirupsen</a> on 2019-01-19 14:00</div>
            <div class="timeline-body"><p>Oops, sorry! Searched only the open bugs ü§¶‚Äç‚ôÇÔ∏è, that one escaped me.</p>
<p>Compiled latest master locally and it&#x27;s üëå thanks for the quick reply!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:08 UTC
    </footer>
</body>
</html>
