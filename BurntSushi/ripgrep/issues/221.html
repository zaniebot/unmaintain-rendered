<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ripgrep does not use parent-directory, same-repo .gitignore files - BurntSushi/ripgrep #221</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ripgrep does not use parent-directory, same-repo .gitignore files</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/221">#221</a>
        opened by <a href="https://github.com/srcreigh">@srcreigh</a>
        on 2016-11-04 03:28
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/srcreigh">@srcreigh</a></div>
            <div class="timeline-body"><p>Consider the following Git repo:</p>
<pre><code>.gitignore
foo/
foo/message  # contains &quot;hey&quot;
foo/bar/
foo/bar/message  # contains &quot;hey&quot;
</code></pre>
<p>where <code>.gitignore</code> contains:</p>
<pre><code>/foo/bar/
</code></pre>
<p>The issue is that when I run <code>rg hey</code> while in the <code>foo</code> directory, it returns 2 files (both <code>foo/message</code> and <code>foo/bar/message</code>). This is a bug because <code>foo/bar/message</code> is ignored by git, yet it&#x27;s returned by <code>rg</code>, and the whole point of using <code>rg</code> over <code>grep</code> (imo) is that it doesn&#x27;t include files that are ignored by Git.</p>
Reproduction steps
<p>Run these commands:</p>
<pre><code>mkdir -p rg-test rg-test/foo rg-test/foo/bar
echo &quot;hey&quot; &gt; rg-test/foo/message
echo &quot;hey&quot; &gt; rg-test/foo/bar/message
echo &quot;/foo/bar/&quot; &gt; rg-test/.gitignore
cd rg-test/foo
rg hey
</code></pre>
<p>Ex:</p>
<pre><code>λ /tmp/ mkdir -p rg-test rg-test/foo rg-test/foo/bar
λ /tmp/ echo &quot;hey&quot; &gt; rg-test/foo/message
λ /tmp/ echo &quot;hey&quot; &gt; rg-test/foo/bar/message
λ /tmp/ echo &quot;/foo/bar/&quot; &gt; rg-test/.gitignore
λ /tmp/ cd rg-test
λ /tmp/rg-test/ cd foo
λ /tmp/rg-test/foo/ rg hey
bar/message
1:hey

message
1:hey
λ /tmp/rg-test/foo/ 
</code></pre>
<p>Expected output (from the <code>rg</code> command):</p>
<pre><code>message
1:hey
</code></pre>
<p>Actual output:</p>
<pre><code>bar/message
1:hey

message
1:hey
</code></pre>
Screenshot
<img alt="screen shot 2016-11-03 at 11 21 04 pm" src="https://cloud.githubusercontent.com/assets/2747249/19993466/5128b6c4-a21c-11e6-84f2-b5dafe2853d9.png">

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-04 03:40</div>
            <div class="timeline-body"><p>What version of ripgrep are you using?</p>
<p>On Nov 3, 2016 11:28 PM, &quot;Shane Creighton-Young&quot; notifications@github.com
wrote:</p>
<blockquote>
<p>Consider the following Git repo:</p>
<p>.gitignore
foo/
foo/message  # contains &quot;hey&quot;
foo/bar/
foo/bar/message  # contains &quot;hey&quot;</p>
<p>where .gitignore contains:</p>
<p>/foo/bar/</p>
<p>The issue is that when I run rg hey while in the foo directory, it
returns 2 files (both foo/message and foo/bar/message). This is a bug
because foo/bar/message is ignored by git, yet it&#x27;s returned by rg, and
the whole point of using rg over grep (imo) is that it doesn&#x27;t include
files that are ignored by Git.
Reproduction steps</p>
<p>Run these commands:</p>
<p>mkdir -p rg-test rg-test/foo rg-test/foo/bar
echo &quot;hey&quot; &gt; rg-test/foo/message
echo &quot;hey&quot; &gt; rg-test/foo/bar/message
echo &quot;/foo/bar/&quot; &gt; rg-test/.gitignore
cd rg-test/foo
rg hey</p>
<p>Ex:</p>
<p>λ /tmp/ mkdir -p rg-test rg-test/foo rg-test/foo/bar
λ /tmp/ echo &quot;hey&quot; &gt; rg-test/foo/message
λ /tmp/ echo &quot;hey&quot; &gt; rg-test/foo/bar/message
λ /tmp/ echo &quot;/foo/bar/&quot; &gt; rg-test/.gitignore
λ /tmp/ cd rg-test
λ /tmp/rg-test/ cd foo
λ /tmp/rg-test/foo/ rg hey
bar/message
1:hey</p>
<p>message
1:hey
λ /tmp/rg-test/foo/</p>
<p>Expected output (from the rg command):</p>
<p>message
1:hey</p>
<p>Actual output:</p>
<p>bar/message
1:hey</p>
<p>message
1:hey</p>
<p>Screenshot [image: screen shot 2016-11-03 at 11 21 04 pm]
https://cloud.githubusercontent.com/assets/2747249/19993466/5128b6c4-a21c-11e6-84f2-b5dafe2853d9.png</p>
<p>—
You are receiving this because you are subscribed to this thread.
Reply to this email directly, view it on GitHub
<a href="https://github.com/BurntSushi/ripgrep/issues/221">BurntSushi/ripgrep#221</a>, or mute the thread
https://github.com/notifications/unsubscribe-auth/AAb34j9d89ypaOvjyI5MVhOelD05qYzEks5q6qZYgaJpZM4KpKHp
.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/srcreigh">@srcreigh</a> on 2016-11-04 03:43</div>
            <div class="timeline-body"><pre><code>λ ~/ rg --version
0.2.3
λ ~/
</code></pre>
<p>Installed via <code>brew install ripgrep</code> earlier today.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-04 03:48</div>
            <div class="timeline-body"><p>Ah okay. 0.2.6 is out, but not on brew yet (there is a binary download here
on github though). I&#x27;m on mobile, but I&#x27;ll check this out on the latest
version tomorrow. Thanks for the detailed report!</p>
<p>On Nov 3, 2016 11:43 PM, &quot;Shane Creighton-Young&quot; notifications@github.com
wrote:</p>
<blockquote>
<p>λ ~/ rg --version
0.2.3
λ ~/</p>
<p>Installed via brew install ripgrep earlier today.</p>
<p>—
You are receiving this because you commented.
Reply to this email directly, view it on GitHub
<a href="https://github.com/BurntSushi/ripgrep/issues/221">BurntSushi/ripgrep#221</a>#issuecomment-258338373,
or mute the thread
https://github.com/notifications/unsubscribe-auth/AAb34gQyZBWtL8ctDdEdKhkFKVXoKvRvks5q6qntgaJpZM4KpKHp
.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-04 13:22</div>
            <div class="timeline-body"><p>Yay, looks like this has already been fixed. :-)</p>
<pre><code>[andrew@Cheetah ripgrep] mkdir 221
[andrew@Cheetah ripgrep] cd 221/
[andrew@Cheetah 221] mkdir -p foo/bar
[andrew@Cheetah 221] echo &quot;hey&quot; &gt; foo/message
[andrew@Cheetah 221] echo &quot;hey&quot; &gt; foo/bar/message
[andrew@Cheetah 221] echo /foo/bar/ &gt; .gitignore
[andrew@Cheetah 221] rg hey
foo/message
1:hey
[andrew@Cheetah 221] cd foo/
[andrew@Cheetah foo] rg hey
message
1:hey
</code></pre>
<p>The gitignore logic recently went through a major overhaul, and I may have accidentally fixed a few bugs along the way.</p>
<p>I&#x27;ll see about submitting a PR to homebrew to update.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-04 13:22</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lyuha">@lyuha</a> on 2016-11-04 15:23</div>
            <div class="timeline-body"><p>I submitted PR to <a href="https://github.com/Homebrew/homebrew-core/pull/6590">Homebrew/homebrew-core#6590</a>, and accepted. So, latest rg is 0.2.6 at homebrew.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-04 15:28</div>
            <div class="timeline-body"><p>@lyuha Thanks! ^_^</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/srcreigh">@srcreigh</a> on 2016-11-04 17:25</div>
            <div class="timeline-body"><p>Thanks everyone. :smile:</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:02 UTC
    </footer>
</body>
</html>
