```yaml
number: 445
title: Error with Powershell tab completion script
type: issue
state: closed
author: elirnm
labels:
  - help wanted
  - question
assignees: []
created_at: 2017-04-11T04:24:09Z
updated_at: 2017-05-16T03:14:41Z
url: https://github.com/BurntSushi/ripgrep/issues/445
synced_at: 2026-01-12T16:13:22Z
```

# Error with Powershell tab completion script

---

_@elirnm_

Attempting to import the _rg.ps1 tab completion script into Powershell throws an exception:

```
At C:\PathTools\_rg.ps1:10 char:41
+                 switch ($_.ToString()) {
+                                         ~
Missing condition in switch statement clause.
    + CategoryInfo          : ParserError: (:) [], ParseException
    + FullyQualifiedErrorId : MissingSwitchConditionExpression
```

There's an empty switch statement there that seems like the cause.

$PSVersionTable:
```
Name                           Value
----                           -----
PSVersion                      5.1.14409.1005
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.14409.1005
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1

```

---

_Comment by @BurntSushi on 2017-04-11 11:06_

This is not something I'm capable of diagnosing and fixing. Someone else will need to do it.

---

_Label `help wanted` added by @BurntSushi on 2017-04-11 11:06_

---

_Label `question` added by @BurntSushi on 2017-04-11 11:06_

---

_Comment by @elirnm on 2017-04-11 19:14_

It looks like the file is generated by clap? If that's the case then I can create an issue over there.

---

_Comment by @BurntSushi on 2017-04-11 19:46_

@elirnm Indeed it is! Thanks. :-)

---

_Comment by @elirnm on 2017-04-19 20:40_

This is fixed in the latest clap.

---

_Comment by @elirnm on 2017-05-16 03:14_

This seems to work now in 0.5.2.

---

_Closed by @elirnm on 2017-05-16 03:14_

---
