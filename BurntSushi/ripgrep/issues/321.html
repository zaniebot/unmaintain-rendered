<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Switch to avoid crossing filesystem boundaries - BurntSushi/ripgrep #321</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Switch to avoid crossing filesystem boundaries</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/321">#321</a>
        opened by <a href="https://github.com/wavexx">@wavexx</a>
        on 2017-01-14 19:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/wavexx">@wavexx</a></div>
            <div class="timeline-body"><p>It&#x27;s often useful to search only files that reside on the same filesystem as the search paths, same as <code>find -xdev</code> or <code>ag --one-device</code>. I find ag&#x27;s &quot;one-device&quot; switch to be misleading, as it&#x27;s more correctly described by find as &quot;do not cross filesystem boundaries&quot;, since the restriction applies to each search path in turn (which can span more than <em>one</em> device).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-18 00:44</div>
            <div class="timeline-body"><p>This needs to be implemented in <code>walkdir</code> (see: <a href="https://github.com/BurntSushi/walkdir/issues/8">BurntSushi/walkdir#8</a>) and <code>ignore</code>&#x27;s parallel iterator, and then exposed up through ripgrep as a command line flag.</p>
<p>I agree with the naming choice. Using <code>find</code>&#x27;s flag name seems fine. It looks like GNU grep doesn&#x27;t have a similar flag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-18 00:44</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wavexx">@wavexx</a> on 2017-01-18 11:23</div>
            <div class="timeline-body"><p>On Wed, Jan 18 2017, Andrew Gallant wrote:</p>
<blockquote>
<p>I agree with the naming choice. Using find&#x27;s flag name seems fine. It looks like GNU grep doesn&#x27;t have
a similar flag?</p>
</blockquote>
<p>Indeed it doesn&#x27;t, which is a shame.</p>
<p>If you&#x27;re working with FUSE and/or remote filesystems, -xdev is very
useful (either to avoid crossing, and/or to escape the local fs).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">icebox</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-04-09 13:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-25 22:15</div>
            <div class="timeline-body"><p>I think I&#x27;m liking the name <code>--mount</code> for this. It&#x27;s supported by <code>find</code>, is relatively short, and feels a bit more generic than <code>--xdev</code>.</p>
<p>Does anyone know the provenance of the name <code>--xdev</code>? I guess &quot;dev&quot; means &quot;device&quot; (which seems consistent with the <code>dev</code> attribute in the <code>stat</code> structure) and I guess <code>x</code> means &quot;cross&quot; or &quot;don&#x27;t cross&quot; in this case.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssokolow">@ssokolow</a> on 2018-08-25 23:12</div>
            <div class="timeline-body"><blockquote>
<p>Does anyone know the provenance of the name --xdev? I guess &quot;dev&quot; means &quot;device&quot; (which seems consistent with the dev attribute in the stat structure) and I guess x means &quot;cross&quot; or &quot;don&#x27;t cross&quot; in this case.</p>
</blockquote>
<p>I suspect you&#x27;re correct there, given that tools like <code>ncdu</code> use the short option <code>-x</code> and describe it as follows:</p>
<blockquote>
<p><code>-x</code>  Do not cross filesystem boundaries, i.e. only count files and directories on the same filesystem as the directory being scanned.</p>
</blockquote>
<p>Also, I&#x27;m not so sure about <code>--mount</code>. It doesn&#x27;t feel at all intuitive to me, which is probably why the manpage for GNU find lists <code>-mount</code> it as being a compatibility alias for <code>-xdev</code> rather than the other way around.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2018-08-25 23:24</div>
            <div class="timeline-body"><blockquote>
<p>Does anyone know the provenance of the name --xdev?</p>
</blockquote>
<p>In 2.11BSD <code>find</code> uses a global variable called <code>Xdev</code> that is commented as <em>true if SHOULD cross devices</em>; the <code>-xdev</code> &#x27;primary&#x27; flips it off. Probably the latter is named after the former? Seems like <code>-noxdev</code> or something would have made more sense; not that <code>-mount</code> is especially better</p>
<blockquote>
<p>I suspect you&#x27;re correct there, given that tools like ncdu use the short option -x</p>
</blockquote>
<p>I think <code>du -x</code> comes from BSD&#x27;s <code>find -x</code>, which was a later alias/replacement for <code>-xdev</code>. GNU <code>du</code> gave <code>-x</code> the long option name <code>--one-file-system</code>, which has also been borrowed into GNU <code>cp</code>, GNU <code>rm</code>, GNU <code>tar</code>, BSD <code>tar</code>, and <code>rsync</code> (... and <code>ncdu</code>, apparently)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-25 23:27</div>
            <div class="timeline-body"><p>@okdana Ah nice, thanks! The prevalence of <code>--one-file-system</code> makes a compelling argument for that name. I guess we should probably go with that? It&#x27;s also seemingly the most accurate. The only downside is that it&#x27;s kind of long.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssokolow">@ssokolow</a> on 2018-08-25 23:28</div>
            <div class="timeline-body"><p>Another thing which just occurred to me is that I like the <code>x</code>-based names (<code>-x</code>, <code>-xdev</code>, etc.) because, in addition to &quot;crossing device boundaries&quot;, they also associate it with options like <code>--exclude</code> in my mind, which is technically accurate. (You&#x27;re eXcluding stuff outside the current filesystem.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-26 22:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wavexx">@wavexx</a> on 2018-12-03 14:23</div>
            <div class="timeline-body"><p>I know it&#x27;s late to comment on this, but if I explicitly pass two directories on different devices to perform searches on:</p>
<p><code>$ rg pat /dev1/ /dev2/</code></p>
<p>I do expect rg to scan/descend on both, as these were given explicitly. In this sense, I really preferred the original term &quot;same device&quot; or &quot;do not cross boundaries&quot; (aka xdev) more than &#x27;ag --one-device&#x27; as I originally pointed out, as &quot;one&quot; in this context is just a special case.</p>
<p>This is just for the sake of discussion, I know the name has already been settled.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:03 UTC
    </footer>
</body>
</html>
