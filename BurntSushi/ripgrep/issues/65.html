<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>--files doesn't correctly handle .gitignore'd directories when supplied paths are absolute - BurntSushi/ripgrep #65</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>--files doesn&#x27;t correctly handle .gitignore&#x27;d directories when supplied paths are absolute</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/65">#65</a>
        opened by <a href="https://github.com/nickstenning">@nickstenning</a>
        on 2016-09-24 14:45
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/nickstenning">@nickstenning</a></div>
            <div class="timeline-body"><p>It seems that specifying a path in a <code>.gitignore</code> which has a trailing slash, such as</p>
<pre><code>a/
</code></pre>
<p>(as opposed to simply <code>a</code>) causes <code>rg --files</code> to fail to correctly ignore files within that directory. This only happens when an absolute path is supplied as an argument.</p>
Steps to reproduce
<p>Here&#x27;s a shell session that shows the problem. In it I create a directory, ignore it, and then show that the files within that directory are correctly ignored if I run <code>rg --files</code> or <code>rg --files ignored .</code> (see <a href="https://github.com/BurntSushi/ripgrep/issues/64">BurntSushi/ripgrep#64</a> for why I&#x27;ve included the word <code>ignored</code> in that invocation), but not if I run <code>rg --files ignored $PWD</code>.</p>
<p>If I either specify the path as <code>.</code>, or remove the trailing slash from the line in <code>.gitignore</code>, the directory is correctly ignored.</p>
<pre><code>$ uname -mrsv
Darwin 15.6.0 Darwin Kernel Version 15.6.0: Mon Aug 29 20:21:34 PDT 2016; root:xnu-3248.60.11~1/RELEASE_X86_64 x86_64
$ rg --version
0.1.17
$ mkdir a
$ touch x y a/x a/y
$ echo a/ &gt; .gitignore
$ ag . -l -g &#x27;&#x27;
x
y
$ ag $PWD -l -g &#x27;&#x27;
/Users/redacted/mess/current/example/x
/Users/redacted/mess/current/example/y
$ rg --files ignored .
./x
./y
$ rg --files ignored $PWD
/Users/redacted/mess/current/example/a/x
/Users/redacted/mess/current/example/a/y
/Users/redacted/mess/current/example/x
/Users/redacted/mess/current/example/y
$ echo a &gt; .gitignore
$ rg --files ignored .
./x
./y
$ rg --files ignored $PWD
/Users/redacted/mess/current/example/x
/Users/redacted/mess/current/example/y
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-09-24 20:19</div>
            <div class="timeline-body"><p>Nice find. This is a dupe of #16.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-09-24 20:19</div>
            <div class="timeline-body"><p>(Fix incoming.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-09-24 20:19</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:00 UTC
    </footer>
</body>
</html>
