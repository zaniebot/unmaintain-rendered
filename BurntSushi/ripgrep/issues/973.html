<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rg not excluding full path, only relative path? - BurntSushi/ripgrep #973</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>rg not excluding full path, only relative path?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/973">#973</a>
        opened by <a href="https://github.com/rieje">@rieje</a>
        on 2018-07-07 17:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/rieje">@rieje</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>ripgrep 0.8.1
-SIMD -AVX</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>Arch Linux</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>I'm pretty sure it's not a bug, because the problem I'm experiencing is so simple. I can't exclude the path <code>~/system-admin/log</code> which contains a bunch of log files I don't want <code>rg</code> to search. <code>rg --no-heading -g '!*/log' db ~/system-admin/</code> works, but <code>rg --no-heading -g '!/home/rieje/system-admin/log' db ~/system-admin/</code> doesn't.</p>
<p>Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2018-07-07 18:10</div>
            <div class="timeline-body"><p>As far as i know, all glob/ignore paths that <code>rg</code> deals with are relative to the search directory, and there's no way to change that. See also #969 for example. So using an absolute path in a glob will only ever work when you're searching <code>/</code> (or some other directory tree that happens to replicate that structure).</p>
<p><code>!**/log/</code> should work from anywhere (assuming you're OK with excluding all directories named <code>log</code>), or, if you're trying to be more specific, you can anchor to the root of the search path with <code>!/log/</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-08 01:40</div>
            <div class="timeline-body"><p>@okdana is correct. This fundamentally cannot work. Firstly, it would require ripgrep to canonicalize every path it sees. This would be a dramatic performance regression. Secondly, even if we could isolate that performance regression to cases where absolute file paths are set in the globs, then you still run into problems like, &quot;what if the absolute path you specified contains a symlink in it?&quot; The canonicalization is, by definition, not going to contain any of those symlinks and thus your glob will never work. Thirdly and finally, even detecting the absolute path is itself tricky since <code>gitignore</code> semantics already specify a meaning for patterns that begin with a <code>/</code> that is incompatible with <code>/</code> actually meaning &quot;the root of the file system.&quot;</p>
<p>In other words, you need to find some other way to ignore your directory. The simplest possible solution that should work regardless of where you run ripgrep is the following simple command:</p>
<pre><code>$ echo '/log' &gt; /home/reije/system-admin/.ignore
</code></pre>
<p>By default, ripgrep will respect that <code>.ignore</code> file which should prevent <code>/home/reije/system-admin/log</code> and <em>only</em> <code>/home/reije/system-admin/log</code> from being searched.</p>
<p>If you need/want to use the <code>-g/--glob</code> flag to achieve this, then I believe @okdana's solutions are the best you can do.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2018-07-08 01:40</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2018-07-08 01:40</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:36 UTC
    </footer>
</body>
</html>
