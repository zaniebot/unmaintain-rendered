<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using the `ignore` create together with the `vfs` create, is it possible? - BurntSushi/ripgrep #3093</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Using the <code>ignore</code> create together with the <code>vfs</code> create, is it possible?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/3093">#3093</a>
        opened by <a href="https://github.com/TheKnarf">@TheKnarf</a>
        on 2025-07-06 12:48
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/TheKnarf">@TheKnarf</a></div>
            <div class="timeline-body"><h4>Describe your feature request</h4>
<p>Is it possible to use the <code>ignore</code> create together with the <code>vfs</code> create for <a href="https://crates.io/crates/vfs">virtual file system</a>. I use the <code>fvs</code> create so that its easy to write unit tests that use a mock file system in my project.</p>
<p>The best way I've found currently to use the <code>ignore</code> create and <code>vfs</code> together is to use the <code>GitignoreBuilder</code> manually and reimplement file traversal myself (I can't even add a file with <code>GitignoreBuilder</code> since that takes a path and not file content, so I'll have to <a href="https://docs.rs/ignore/0.4.23/ignore/gitignore/struct.GitignoreBuilder.html#method.add_line">add_line</a> manually for each line). In practice that means that I have to re-implement a lot of stuff myself when I'd prefer to just use the <code>WalkBuilder</code> directly.</p>
<p>Is there an more ergonomic way this could be done?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-07-06 13:36</div>
            <div class="timeline-body"><p>No. <code>ignore</code> is tightly coupled with file system APIs and I don't want to change that. Sorry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2025-07-06 13:36</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2025-07-06 13:36</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/TheKnarf">@TheKnarf</a> on 2025-07-06 13:45</div>
            <div class="timeline-body"><p>Wouldn't making a bit less tightly coupled with file system API make it easier to write unit test for the ripgrep project? And potentially open up more re-use across the ecosystem, ex if someone want to create a tool that reuses <code>ignore</code> / <code>ripgrep</code> logic for other things than a &quot;real filesystem&quot; like zip archives, AWS S3 filestorage, a filestructure loaded from a database or an api call, etc.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-07-06 13:53</div>
            <div class="timeline-body"><p>I have no problem writing tests using the real file system.</p>
<p>I understand the advantages of abstraction, but they don't really confer many advantages for me personally. I just don't need that sort of abstraction to write tests for <code>ignore</code>, and I'm not interested in working on making gitignore filtering work in contexts other than standard file systems. In contrast, you neglect to discuss the disadvantages, which involve a massive amount of work and API design across at least <code>ignore</code> and <code>walkdir</code>.</p>
<p>If this sort of abstraction is a requirement for you, then you'll need to build your own crate to do it.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:56 UTC
    </footer>
</body>
</html>
