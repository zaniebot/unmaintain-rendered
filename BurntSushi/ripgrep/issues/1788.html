<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ripgrep slow on single core CPU - BurntSushi/ripgrep #1788</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Ripgrep slow on single core CPU</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1788">#1788</a>
        opened by <a href="https://github.com/madnight">@madnight</a>
        on 2021-01-25 09:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/madnight">@madnight</a></div>
            <div class="timeline-body"><p>Ripgrep is very slow on a single core cpu if it has to search a few gigabytes of text. I think this because of the low thread size default, in case ripgrep detects only one core.</p>
<p>However, since it is almost always the hard drive that is the slow part, increasing the thread count e.g. to -j 16 provides an incredible boost of about x6-8 times faster rg search on my machine.</p>
<p>You should be able to reproduce the results with by spinning up a qemu VM with a single core or test it on a very low-end VPS.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-01-25 12:55</div>
            <div class="timeline-body"><p>I think this is probably why the <code>-j</code> flag exists. My guess is that most ripgrep searches are searching data in the OS's page cache and not reading the bulk of it from disk. My other guess is that using ripgrep on single core CPUs is not terribly common.</p>
<p>Changing ripgrep's settings here requires a detailed investigation. I'm not sure when I'll have time to do that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @BurntSushi on 2021-01-25 12:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by @BurntSushi on 2021-01-25 12:55</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/madnight">@madnight</a> on 2021-01-25 13:01</div>
            <div class="timeline-body"><blockquote>
<p>I think this is probably why the -j flag exists.</p>
</blockquote>
<p>Sure, but if there is a default that is up to 8x times faster for an not so uncommon use case, then I would probably pick that.</p>
<blockquote>
<p>My other guess is that using ripgrep on single core CPUs is not terribly common.</p>
</blockquote>
<p>You might underestimate how many users like me have a cheap 1 CPU VPS in the cloud for a few bucks/month.</p>
<blockquote>
<p>Changing ripgrep's settings here requires a detailed investigation. I'm not sure when I'll have time to do that.</p>
</blockquote>
<p>Sure, I understand that.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-02-23 21:57</div>
            <div class="timeline-body"><p>I'm going to close this since this setting is not something I'm planning on changing, and I don't really intend to do a thorough investigation of this myself. The OP talks about the hard disk being the slow aspect of the search, and while true, ripgrep tends to optimize for the case where its corpus is in memory. That is, many of ripgrep's optimizations don't have much impact if I/O is slow.</p>
<p>If someone else wants to do a thorough investigation here and make a solid case for changing the current defaults, then I'd be open to that. But a simple request isn't enough.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2021-02-23 21:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:18 UTC
    </footer>
</body>
</html>
