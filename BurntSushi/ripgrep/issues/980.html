<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>^$ erroneously matches around multiples of 4096 - BurntSushi/ripgrep #980</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>^$ erroneously matches around multiples of 4096</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/980">#980</a>
        opened by <a href="https://github.com/jleedev">@jleedev</a>
        on 2018-07-13 14:21
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jleedev">@jleedev</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<p>ripgrep 0.8.1
-SIMD -AVX</p>
How did you install ripgrep?
<p>cargo install
rustc 1.27.0 (3eda71b00 2018-06-19)</p>
What operating system are you using ripgrep on?
<p><code>Linux 3.13.0-43-generic #72-Ubuntu SMP Mon Dec 8 19:35:06 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux</code>
<code>Linux 4.14.34-v7+ #1110 SMP Mon Apr 16 15:18:51 BST 2018 armv7l GNU/Linux</code>
<code>Darwin 17.7.0 Darwin Kernel Version 17.7.0: Thu Jun 21 22:53:14 PDT 2018; root:xnu-4570.71.2~1/RELEASE_X86_64 x86_64</code></p>
Describe your question, feature request, or bug.
<pre><code>~$ yes | rg -n ^$ | head 
2:
4098:
8195:
12292:
16389:
20486:
24583:
28680:
32777:
36874:
</code></pre>
If this is a bug, what is the expected behavior?
<p><code>yes | rg ^$</code> should not find any matches.</p>
<p>This also seems to break line numbers on any pattern that could possibly match a blank line.</p>
<p>(I was searching for <code>^.{0,12}$</code> in a file that contains no empty lines and was surprised to find empty lines. My workaround was to change the pattern to <code>^{1,12}$</code>, but I was looking at incorrect line numbers until then.)</p>
<pre><code>~$ yes | rg -C1 -n ^$ | head 
1-y
2:
3-y
--
4097-y
4098:
4099-y
--
8194-y
8195:
</code></pre>
<p>This looks similar to #441, but that&#x27;s only at the end of file.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-13 14:38</div>
            <div class="timeline-body"><p>@jleedev Great bug. I suspect this is actually the similar or same bug as #441. The tipoff here is the multiple size, which seems close to lining up with the internal buffer size used by ripgrep, which probably triggers a similar condition as being at the end of a file.</p>
<p>This <em>should</em> be fixed in libripgrep. I&#x27;ll confirm this bug and add a regression test there.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-13 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">libripgrep</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-13 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Added to milestone &quot;libripgrep&quot; by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-13 14:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-20 11:10</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:06 UTC
    </footer>
</body>
</html>
