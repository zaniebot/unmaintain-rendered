<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(?&lt;!pattern) zero-width negative lookbehind assertion error - BurntSushi/ripgrep #2926</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>(?&lt;!pattern) zero-width negative lookbehind assertion error</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2926">#2926</a>
        opened by <a href="https://github.com/ItsFated">@ItsFated</a>
        on 2024-11-08 09:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ItsFated">@ItsFated</a></div>
            <div class="timeline-body">Please tick this box to confirm you have reviewed the above.
<ul>
<li>[X] I have a different issue.</li>
</ul>
What version of ripgrep are you using?
<p>ripgrep 14.1.1 (rev 4649aa9700)</p>
<p>features:+pcre2
simd(compile):+SSE2,-SSSE3,-AVX2
simd(runtime):+SSE2,+SSSE3,+AVX2</p>
<p>PCRE2 10.43 is available (JIT is available)</p>
How did you install ripgrep?
<p>Download from https://github.com/BurntSushi/ripgrep/releases/download/14.1.1/ripgrep-14.1.1-x86_64-pc-windows-msvc.zip</p>
What operating system are you using ripgrep on?
<p>Windows 10 版本21H2(操作系统内部版本19044.2673)
<img src="https://github.com/user-attachments/assets/5b41091e-b992-4c68-9824-aa8d9813f4fa" alt="image"></p>
Describe your bug.
<p>When I execute the following command:
<code>rg -iP &quot;(? &lt;! (ACodec|NuPlayerDecoder).*)(buffer)&quot; .\audio_config_main_20241108163659.log</code>
You will get the following error message:
<code>rg: PCRE2: error compiling pattern at offset 3: length of lookbehind assertion is not limited</code></p>
What are the steps to reproduce the behavior?
<p><strong>Just as described.</strong>
When I execute the following command:
<code>rg -iP &quot;(? &lt;! (ACodec|NuPlayerDecoder).*)(buffer)&quot; .\audio_config_main_20241108163659.log</code>
You will get the following error message:
<code>rg: PCRE2: error compiling pattern at offset 3: length of lookbehind assertion is not limited</code></p>
What is the actual behavior?
<pre><code>rg --debug -iP &quot;(?&lt;!(ACodec|NuPlayerDecoder).*)(buffer)&quot; .\audio_config_main_20241108163659.log
rg: DEBUG|rg::flags::parse|crates/core\flags\parse.rs:97: no extra arguments found from configuration file
rg: DEBUG|rg::flags::hiargs|crates/core\flags\hiargs.rs:1083: number of paths given to search: 1
rg: DEBUG|rg::flags::hiargs|crates/core\flags\hiargs.rs:1094: is_one_file? true
rg: DEBUG|rg::flags::hiargs|crates/core\flags\hiargs.rs:1269: found hostname for hyperlink configuration: WIN-76NEEBL0FS5
rg: DEBUG|rg::flags::hiargs|crates/core\flags\hiargs.rs:1279: hyperlink format: &quot;&quot;
rg: DEBUG|rg::flags::hiargs|crates/core\flags\hiargs.rs:174: using 1 thread(s)
rg: PCRE2: error compiling pattern at offset 3: length of lookbehind assertion is not limited
</code></pre>
What is the expected behavior?
<p>Just like the matching of the two strings shown in the following picture:
<img src="https://github.com/user-attachments/assets/5e09ce77-3bad-41d1-a135-9fada16a255f" alt="image"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2024-11-08 10:11</div>
            <div class="timeline-body"><p>I suppose you want to search for <code>(?&lt;!(ACodec|NuPlayerDecoder).*)(buffer)</code> like you did with <code>--debug</code> instead of that thing which begins with <code>(? &lt;! (</code>.</p>
<p>There&#x27;s a <code>.*</code> in the lookbehind which makes its size variable, and PCRE2 doesn&#x27;t support that. All the alternatives in a lookbehind must have a constant size.</p>
<p>You may change the regex to work aroud this limitation. I don&#x27;t know if this is what you&#x27;re looking for (your explanation is very unclear), but try this:</p>
<pre><code>(?:ACodec|NuPlayerDecoder).*(*SKIP)(*FAIL)|buffer
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ItsFated">@ItsFated</a> on 2024-11-08 10:49</div>
            <div class="timeline-body"><blockquote>
<p>I suppose you want to search for <code>(?&lt;!(ACodec|NuPlayerDecoder).*)(buffer)</code> like you did with <code>--debug</code> instead of that thing which begins with <code>(? &lt;! (</code>.</p>
<p>There&#x27;s a <code>.*</code> in the lookbehind which makes its size variable, and PCRE2 doesn&#x27;t support that. All the alternatives in a lookbehind must have a constant size.</p>
<p>You may change the regex to work aroud this limitation. I don&#x27;t know if this is what you&#x27;re looking for (your explanation is very unclear), but try this:</p>
<pre><code>(?:ACodec|NuPlayerDecoder).*(*SKIP)(*FAIL)|buffer
</code></pre>
</blockquote>
<p>Thanks for your reply, the following picture is what I want to do: find the string &quot;buffer&quot; that does not start with ACodec or NuPlayerDecoder.
<img src="https://github.com/user-attachments/assets/5e09ce77-3bad-41d1-a135-9fada16a255f" alt="image">
Then through your reply I have the following alternative method:
<code>rg -iP &quot;(?&lt;!(ACodec|NuPlayerDecoder).{0,99})buffer&quot;</code>
<img src="https://github.com/user-attachments/assets/d1f3798b-447f-4ae1-a64c-795a9963dc50" alt="image"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ItsFated">@ItsFated</a> on 2024-11-08 11:17</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I suppose you want to search for <code>(?&lt;!(ACodec|NuPlayerDecoder).*)(buffer)</code> like you did with <code>--debug</code> instead of that thing which begins with <code>(? &lt;! (</code>.
There&#x27;s a <code>.*</code> in the lookbehind which makes its size variable, and PCRE2 doesn&#x27;t support that. All the alternatives in a lookbehind must have a constant size.
You may change the regex to work aroud this limitation. I don&#x27;t know if this is what you&#x27;re looking for (your explanation is very unclear), but try this:</p>
<pre><code>(?:ACodec|NuPlayerDecoder).*(*SKIP)(*FAIL)|buffer
</code></pre>
</blockquote>
<p>Thanks for your reply, the following picture is what I want to do: find the string &quot;buffer&quot; that does not start with ACodec or NuPlayerDecoder. <img src="https://private-user-images.githubusercontent.com/13051752/384299626-5e09ce77-3bad-41d1-a135-9fada16a255f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzEwNjQ3OTYsIm5iZiI6MTczMTA2NDQ5NiwicGF0aCI6Ii8xMzA1MTc1Mi8zODQyOTk2MjYtNWUwOWNlNzctM2JhZC00MWQxLWExMzUtOWZhZGExNmEyNTVmLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDExMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMTA4VDExMTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWM2Mzc5NTI2YzNmMzZhZjc3NWExNWQ5YTA4MWE5MzVkMDU1NzM5ZjllMTIwOGVmNGMwNmM4OGJjNTc0NTMwNzMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.5WDgHJ9r7Fafn8E1K-kuDURlCyOaLI-M0bEN8MGDxQY" alt="image"> Then through your reply I have the following alternative method: <code>rg -iP &quot;(?&lt;!(ACodec|NuPlayerDecoder).{0,99})buffer&quot;</code> <img src="https://private-user-images.githubusercontent.com/13051752/384339219-d1f3798b-447f-4ae1-a64c-795a9963dc50.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzEwNjQ3OTYsIm5iZiI6MTczMTA2NDQ5NiwicGF0aCI6Ii8xMzA1MTc1Mi8zODQzMzkyMTktZDFmMzc5OGItNDQ3Zi00YWUxLWE2NGMtNzk1YTk5NjNkYzUwLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNDExMDglMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjQxMTA4VDExMTQ1NlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTc5NGNhYWJmOGU5ZTVhMjA0MGYxYTQ1YTlkMjhjOGI4MTM1YzYxMTU1NmZiMDZmODBjYTg1ODNmNjg3N2E2MDUmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.1QDmVeTehYCOO287v7htI5iYmhBx2YIQ31vRO1B6ocA" alt="image"></p>
</blockquote>
<p>I test the length is 255, length(ACodec) + 249 = 255
<img src="https://github.com/user-attachments/assets/ae11781d-3e18-497e-9c48-af48b6390604" alt="image"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/ItsFated">@ItsFated</a> on 2024-11-08 11:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2024-11-08 12:33</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:14 UTC
    </footer>
</body>
</html>
