<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannot search in symlink - BurntSushi/ripgrep #256</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Cannot search in symlink</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/256">#256</a>
        opened by <a href="https://github.com/phiresky">@phiresky</a>
        on 2016-11-27 13:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/phiresky">@phiresky</a></div>
            <div class="timeline-body"><p><code>db</code> is a symlink to a directory.</p>
<pre><code>$ rg --version
ripgrep 0.3.1
$ rg test db
db: Is a directory (os error 21)
$ rg test db/
(works as expected)
</code></pre>
<p>I would expect it to traverse the symlink in the first example, or at least to show an error message that is less confusing ;)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-27 13:46</div>
            <div class="timeline-body"><p>Oh interesting. I&#x27;m pretty sure this used to work. I wonder if it&#x27;s a regression in 0.3. I&#x27;m on mobile, but can you try <code>rg -j1 test db</code>? Does that work?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/phiresky">@phiresky</a> on 2016-11-27 13:47</div>
            <div class="timeline-body"><p>Same thing with <code>rg -j1 test db</code>. The problem already existed in 0.2.9</p>
<p>2016-11-27 14:46 GMT+01:00 Andrew Gallant <a href="mailto:notifications@github.com">notifications@github.com</a>:</p>
<blockquote>
<p>Oh interesting. I&#x27;m pretty sure this used to work. I wonder if it&#x27;s a
regression in 0.3. I&#x27;m on mobile, but can you try rg -j1 test db? Does
that work?</p>
<p>â€”
You are receiving this because you authored the thread.
Reply to this email directly, view it on GitHub
<a href="https://github.com/BurntSushi/ripgrep/issues/256#issuecomment-263122990">BurntSushi/ripgrep#256</a>,
or mute the thread
<a href="https://github.com/notifications/unsubscribe-auth/ACMnYf9KOvxbl5rsOIeANAjx2Wdqyf-Mks5rCYmlgaJpZM4K9Jco">https://github.com/notifications/unsubscribe-auth/ACMnYf9KOvxbl5rsOIeANAjx2Wdqyf-Mks5rCYmlgaJpZM4K9Jco</a>
.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jFransham">@jFransham</a> on 2016-11-28 14:10</div>
            <div class="timeline-body"><p>I tried to have a look at this issue since it looked like a decent beginner bug - looks like running <code>rg</code> with <code>--follow</code> fixes this issue. It seems like this is intended behaviour, at least to some extent, but it&#x27;s undeniably unintuitive that <code>somelink</code> and <code>somelink/</code> act differently. Maybe a fix would be to traverse symbolic links for all input paths, but then respect <code>--follow</code> when walking the resultant paths, but that might not play nice with globbing (like, you might accidentally end up traversing symlinks and causing a loop, and have no way to disable that without manually excluding the path).</p>
<p>I&#x27;d just make it so that it displays a better message, something like <code>somelink: is a symlinked directory - run again with --follow to traverse symbolic links</code>. If you&#x27;re up for this I&#x27;ll implement it (I&#x27;d like to start contributing to this project, since I use it daily).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-28 17:56</div>
            <div class="timeline-body"><blockquote>
<p>Maybe a fix would be to traverse symbolic links for all input paths</p>
</blockquote>
<p>This is indeed the intended behavior I think.</p>
<blockquote>
<p>(like, you might accidentally end up traversing symlinks and causing a loop, and have no way to disable that without manually excluding the path)</p>
</blockquote>
<p>The only way a loop can happen is if you use <code>--follow</code>, and when you do that, the underlying recursive iterator will detect loops. I don&#x27;t think you can wind up in a loop if you follow only symlinks that have been explicitly given though?</p>
<blockquote>
<p>(I&#x27;d like to start contributing to this project, since I use it daily)</p>
</blockquote>
<p>Great! I haven&#x27;t actually looked into this bug yet (just got back from vaca), but I do think we should just do the right thing here and follow symlinks if they&#x27;ve been explicitly given as a positional parameter. If I&#x27;ve missed some complication here that you see and I don&#x27;t, then don&#x27;t hesitate to push back! :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-28 22:41</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Assigned to <a href="https://github.com/BurntSushi">@BurntSushi</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-28 22:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Unassigned <a href="https://github.com/BurntSushi">@BurntSushi</a> by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-28 22:42</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-11-28 22:42</div>
            <div class="timeline-body"><p>@jFransham Let me know if you want to take a crack at this!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jFransham">@jFransham</a> on 2016-11-29 08:55</div>
            <div class="timeline-body"><p>@BurntSushi Yeah, I&#x27;ll get on it now. I was wondering whether you&#x27;d hang on opening if you had a recursive set of links (i.e. not a directory that <em>contains</em> a link to itself, but a link that transitively links to itself) but it looks like the Linux kernel just throws an exception. I don&#x27;t know what the behaviour is on other operating systems (*BSD, Windows, OS X) but I&#x27;d guess that at best it&#x27;s the same and at worst it&#x27;s not considered to be a problem for the application developer. Either way, that can be tackled as a seperate bug if it ever becomes a problem.</p>
<p>I&#x27;ll get back with a PR soon.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-06 01:06</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jdub">@jdub</a> on 2016-12-11 04:11</div>
            <div class="timeline-body"><p>Thanks for fixing this interaction bug in such a user friendly manner! ðŸ˜ƒ</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:02 UTC
    </footer>
</body>
</html>
