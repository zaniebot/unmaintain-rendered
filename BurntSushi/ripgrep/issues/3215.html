<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add feature to not cache file data in OS pagecache - BurntSushi/ripgrep #3215</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add feature to not cache file data in OS pagecache</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/3215">#3215</a>
        opened by <a href="https://github.com/mckellygit">@mckellygit</a>
        on 2025-11-01 15:17
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mckellygit">@mckellygit</a></div>
            <div class="timeline-body"><p>Hi,</p>
<p>Thank you for awesome rg.  I have done this with my own ag and grep, but to have it in rg would be awesome.  I will try to find out how in rust to do it myself soon, but will request the feature here.  I didn&#x27;t see this feature in rg currently.</p>
<p>Basically its to add -</p>
<p>posix_fadvise(fd, 0, 0, POSIX_FADV_DONTNEED);</p>
<p>after each read() or at least after some ok amount of reads (such as 64k bytes etc)</p>
<p>And could also add -</p>
<p>posix_fadvise(fd, 0, 0, POSIX_FADV_RANDOM);</p>
<p>after opening a file, before any reads.</p>
<p>I dont even know if rg uses mmap() instead of read(), so perhaps this isn&#x27;t quite applicable and please forgive me.</p>
<p>This could be added as an option (--no-pgcache or some such)</p>
<p>But the point here for my use is to be able to rg some really large (log) files on live production systems and not have that push out application data from the OS pagecache, which can affect application performance.</p>
<p>NB there are other ways, such as opening files with O_DIRECT or using preadv2 and RWF_UNCACHED, but those are more involved methods and the above works well enough.</p>
<p>I suppose some might say just export the log files to another system and rg them there to avoid disturbing production, and they would be right, but still to have this option would be for me very helpful for those crisis type sessions.</p>
<p>thx,
-m</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-01 15:22</div>
            <div class="timeline-body"><p>I don&#x27;t think this is a good fit for ripgrep. It seems extremely niche and it isn&#x27;t really something I want to maintain. It would be pretty easy for you, I think, to maintain a fork of ripgrep that does this though.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-01 15:22</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-01 15:23</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mckellygit">@mckellygit</a> on 2025-11-01 15:24</div>
            <div class="timeline-body"><p>ok.  Thanks again for rg.
-m</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:15 UTC
    </footer>
</body>
</html>
