<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add an option to override stdin autodetection? - BurntSushi/ripgrep #1140</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add an option to override stdin autodetection?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1140">#1140</a>
        opened by <a href="https://github.com/jugglerchris">@jugglerchris</a>
        on 2018-12-14 09:31
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jugglerchris">@jugglerchris</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<p>ripgrep 0.10.0 (rev 8a7db1a918)
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)</p>
How did you install ripgrep?
<p>Github binary release (ripgrep-0.10.0-x86_64-unknown-linux-musl.tar.gz)</p>
What operating system are you using ripgrep on?
<p>Ubuntu 18.04.1</p>
Describe your question, feature request, or bug.
<p>My editor spawns processes with a pipe on stdin, in case you want to script input to it; this means that with default options <code>rg foo</code> detects the pipe and sits there waiting for something on stdin, instead of searching from cwd.  I think it would help to have an option to override (in both directions) the special treatment of stdin (detecting pipe/file/other).</p>
<p>Not a high priority - I can explicitly add &quot;.&quot; if no filename supplied, but it would be simpler to just pass an option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-12-14 12:09</div>
            <div class="timeline-body"><p>I&#x27;d rather not, and instead just get stdin detection correct. Running <code>rg foo</code> in my editor works fine. If your editor is unconditionally attaching something to stdin, then that&#x27;s probably a bug on that the editor&#x27;s end (or with the way you&#x27;re invoking the subprocess).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-12-14 12:09</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-12-14 12:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jugglerchris">@jugglerchris</a> on 2019-01-24 10:04</div>
            <div class="timeline-body"><p>This editor has a simple spawn API which always attaches pipes to fds 0-2 in case you want to send/receive data.  I think <code>rg</code>&#x27;s stdin detection is correct in this case - it&#x27;s just that in this case the default magic behaviour isn&#x27;t what I want.  :-)</p>
<p>But as I said it&#x27;s not a big deal - it&#x27;s easy to work around with a trivial shell script.</p>
<p>While I&#x27;m here, thanks for ripgrep - a fantastic tool and great demonstration of what Rust can do!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dwang20151005">@dwang20151005</a> on 2019-04-29 20:31</div>
            <div class="timeline-body"><p>I also ran into this, because in OCaml one of the standard ways to spawn a new process (<code>Async.Process</code>) also attaches a pipe to stdin.  It is unfortunately not an option to use a different library; that would be akin to abandoning glibc or something.</p>
<p>I tried passing <code>.</code> but that caused all filenames in the output to be prefixed with <code>./</code>, which I did not want.</p>
<p>Instead, I wrapped the <code>rg</code> invocation in a <code>bash</code> script that redirects <code>/dev/null</code> to stdin.</p>
<p>Magic is great when it works, but when it doesn&#x27;t, it&#x27;s nice if I can explicitly ask for the behavior I know I want.  Any chance we could get that override flag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-04-29 20:48</div>
            <div class="timeline-body"><blockquote>
<p>Any chance we could get that override flag?</p>
</blockquote>
<p>No. Use <code>./</code> as a file path to search if you want to be explicit. If the leading <code>./</code> bothers you, then strip it. Either that, or figure out how to launch a process in Ocaml without a pipe attached (or attach it to a file). There really ought to be a way to do one of those things.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dwang20151005">@dwang20151005</a> on 2019-04-29 21:38</div>
            <div class="timeline-body"><p>Yep, I&#x27;ve wrapped my <code>rg</code> invocation in a bash script that redirects stdin to <code>/dev/null</code>, so this isn&#x27;t blocking me.</p>
<p>It just seems odd that this is the recommended way to communicate to ripgrep that its input is not on stdin.  I&#x27;m mocking out my environment s.t. this heuristic will conclude that there&#x27;s nothing interesting on stdin.  Why not let me say so explicitly?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-04-29 21:53</div>
            <div class="timeline-body"><blockquote>
<p>Why not let me say so explicitly?</p>
</blockquote>
<p>You can. <code>rg foo ./</code> or by not connecting a pipe.</p>
<p>This conversation is going in circles. If there&#x27;s nothing new to add, then please drop it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dwang20151005">@dwang20151005</a> on 2019-04-29 23:42</div>
            <div class="timeline-body"><p>Okay, I will stop arguing for this.</p>
<p>Thanks for the response, and for ripgrep.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:07 UTC
    </footer>
</body>
</html>
