<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ripgrep searches &quot;no files&quot; (No such file or directory (os error 2)) but grep works - BurntSushi/ripgrep #888</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ripgrep searches &quot;no files&quot; (No such file or directory (os error 2)) but grep works</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/888">#888</a>
        opened by <a href="https://github.com/gerdneuman">@gerdneuman</a>
        on 2018-04-17 10:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gerdneuman">@gerdneuman</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>ripgrep 0.8.1 (rev c8e9f25b85)
-SIMD -AVX</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>Ubuntu 16.04. rg is installed using snap as outlined in the README here.</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>I used to use grep to search through wordpress code under <code>/var/www/</code> but thought of giving <code>rg</code> a try. But what is working with <code>grep</code> results in an error with <code>rg</code>.</p>
<p>So with <code>grep</code> I did:</p>
<pre><code class="language-sh">$ grep -R calculate_order_weight plugins/
plugins/dhl-for-woocommerce/includes/abstract-pr-dhl-wc-order.php:			$selected_weight_val = $this-&gt;calculate_order_weight( $order_id );
plugins/dhl-for-woocommerce/includes/abstract-pr-dhl-wc-order.php:	protected function calculate_order_weight( $order_id ) {
</code></pre>
<p>with <code>rg</code> I get:</p>
<pre><code class="language-sh">$ rg calculate_order_weight plugins/
plugins/: No such file or directory (os error 2)
No files were searched, which means ripgrep probably applied a filter you didn't expect. Try running again with --debug.
</code></pre>
<p>Running the same with <code>--debug</code>:</p>
<pre><code class="language-sh">$ rg --debug calculate_order_weight plugins/
DEBUG/grep::search/grep/src/search.rs:195: regex ast:
Literal {
    chars: [
        'c',
        'a',
        'l',
        'c',
        'u',
        'l',
        'a',
        't',
        'e',
        '_',
        'o',
        'r',
        'd',
        'e',
        'r',
        '_',
        'w',
        'e',
        'i',
        'g',
        'h',
        't'
    ],
    casei: false
}
DEBUG/grep::literals/grep/src/literals.rs:38: literal prefixes detected: Literals { lits: [Complete(calculate_order_weight)], limit_size: 250, limit_class: 10 }
plugins/: No such file or directory (os error 2)
No files were searched, which means ripgrep probably applied a filter you didn't expect. Try running again with --debug.
</code></pre>
<p>Not sure where <code>No such file or directory (os error 2)</code> comes from, because there are files and grep is also able to search them:</p>
<pre><code class="language-sh">$ ls -lisa plugins/
total 108
4486924 4 drwxr-xr-x 26 www-data www-data 4096 Apr 17 09:19 .
4471937 4 drwxr-xr-x  7 www-data www-data 4096 Apr 17 12:29 ..
4489631 4 drwxr-xr-x  4 www-data www-data 4096 Apr 17 08:33 akismet
4489541 4 drwxr-xr-x  6 www-data www-data 4096 Apr 17 08:33 black-studio-tinymce-widget
4490432 4 drwxr-xr-x  8 www-data www-data 4096 Apr 17 08:33 dhl-for-woocommerce
4491712 4 drwxr-xr-x  4 www-data www-data 4096 Apr 17 08:33 google-sitemap-generator
4489419 4 drwxr-xr-x  8 www-data www-data 4096 Apr 17 08:33 groups
4486925 4 -rw-r--r--  1 www-data www-data   30 Apr 17 08:33 index.php
4490752 4 drwxr-xr-x  7 www-data www-data 4096 Apr 17 08:33 kadence-woo-extras
4492185 4 drwxr-xr-x  8 www-data www-data 4096 Apr 17 08:33 mailchimp-for-wp
4490175 4 drwxr-xr-x  4 www-data www-data 4096 Apr 17 08:33 paymill
4492120 4 drwxr-xr-x  2 www-data www-data 4096 Apr 17 08:33 pll-merge-comments
4488422 4 drwxr-xr-x 12 www-data www-data 4096 Apr 17 08:33 polylang-pro
4487303 4 drwxr-xr-x  9 www-data www-data 4096 Apr 17 08:33 polylang-wc
4492122 4 drwxr-xr-x  8 www-data www-data 4096 Apr 17 08:33 shariff
4489978 4 drwxr-xr-x 11 www-data www-data 4096 Apr 17 08:33 siteorigin-panels
4492477 4 drwxr-xr-x  2 www-data www-data 4096 Apr 17 08:33 varnish-http-purge
4487356 4 drwxr-xr-x  7 www-data www-data 4096 Apr 17 08:33 woocommerce
4490677 4 drwxr-xr-x  5 www-data www-data 4096 Apr 17 08:33 woocommerce-gateway-stripe
4486926 4 drwxr-xr-x  7 www-data www-data 4096 Apr 17 08:33 woocommerce-germanized
4491799 4 drwxr-xr-x  5 www-data www-data 4096 Apr 17 08:33 woocommerce-google-analytics-integration
4488856 4 drwxr-xr-x  7 www-data www-data 4096 Apr 17 08:33 woocommerce-pdf-invoices-packing-slips
4491814 4 drwxr-xr-x  9 www-data www-data 4096 Apr 17 08:33 woocommerce-pdf-ips-pro
4489655 4 drwxr-xr-x  7 www-data www-data 4096 Apr 17 08:33 woocommerce-subscriptions
4490641 4 drwxr-xr-x  6 www-data www-data 4096 Apr 17 08:33 woothemes-updater
4487290 4 drwxr-xr-x  6 www-data www-data 4096 Apr 17 08:33 wpovernight-sidekick
4492487 4 drwxr-xr-x  6 www-data www-data 4096 Apr 17 08:33 wpseo

$ ls -ld plugins/
drwxr-xr-x 26 www-data www-data 4096 Apr 17 09:19 plugins/

</code></pre>
<h4>If this is a bug, what is the expected behavior? What do you think ripgrep should have done?</h4>
<p>I do not understand why <code>ripgrep</code> is not able to search through the files, whereas <code>grep</code> is. Maybe also the error message could indicate what I as user should do different, because I do not know what to do instead...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-17 10:41</div>
            <div class="timeline-body"><blockquote>
<p>Ubuntu 16.04. rg is installed using snap as outlined in the README here.</p>
</blockquote>
<p>Please show the exact command you use. In particular, did you install with the <code>--classic</code> flag?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gerdneuman">@gerdneuman</a> on 2018-04-17 10:49</div>
            <div class="timeline-body"><p>I used <code>sudo snap install rg</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-17 10:49</div>
            <div class="timeline-body"><p>............. Please try with the <code>--classic</code> flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gerdneuman">@gerdneuman</a> on 2018-04-17 10:53</div>
            <div class="timeline-body"><p>Just did, after seeing your commit (sorry, that I did not see the permissions note in the README beforehand). But all the same:</p>
<pre><code>$ sudo snap remove rg
[sudo] password for x: 
rg removed
$ sudo snap install --classic rg
rg 0.8.1 from 'tasdomas' installed
$ rg --debug calculate_order_weight plugins/
DEBUG/grep::search/grep/src/search.rs:195: regex ast:
Literal {
    chars: [
        'c',
        'a',
        'l',
        'c',
        'u',
        'l',
        'a',
        't',
        'e',
        '_',
        'o',
        'r',
        'd',
        'e',
        'r',
        '_',
        'w',
        'e',
        'i',
        'g',
        'h',
        't'
    ],
    casei: false
}
DEBUG/grep::literals/grep/src/literals.rs:38: literal prefixes detected: Literals { lits: [Complete(calculate_order_weight)], limit_size: 250, limit_class: 10 }
plugins/: No such file or directory (os error 2)
No files were searched, which means ripgrep probably applied a filter you didn't expect. Try running again with --debug.
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-17 11:03</div>
            <div class="timeline-body"><p>Then I don't know what's wrong. The error you're getting is very clear: ripgrep believes that there is no <code>plugins/</code> path. There's nothing else it can do and there is no possible better error message. Given that I've been consistently surprised by the behavior of <code>snap</code> installed packages, I would be surprised if the issue was still because of <code>snap</code>, but I cannot begin to speculate as to why.</p>
<p>You might consider trying a binary Linux x86_64 release instead and see if that fixes things: https://github.com/BurntSushi/ripgrep/releases --- If it does, then there is something wrong either with <code>snap</code> or some other aspect of your environment.</p>
<p>If a binary release yields the same error, then I'm pretty well stumped. At that point, I'd probably request that you run ripgrep under strace and report back. e.g.,</p>
<pre><code>$ strace rg calculate_order_weight plugins/ 2&gt; strace.log
</code></pre>
<p>and then gist the contents of <code>strace.log</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gerdneuman">@gerdneuman</a> on 2018-04-17 12:17</div>
            <div class="timeline-body"><p>It works with ripgrep-0.8.1-x86_64-unknown-linux-musl.tar.gz and it also works with ripgrep_0.8.1_amd64.deb (which I now use). Does not work <code>sudo snap install --classic rg</code></p>
<p>So closing because it seems to be a snap issue.</p>
<p>PS Since I already have your full attention, I'd like to let you know that I discovered <code>xsv</code> some weeks ago and have since used it for joining different CSV tables. Best tool I've discovered for years, same league like <code>sed</code>, <code>find</code> and the like, absolutely filling a gap! <code>xsv</code> is so awesome and so powerful for piping results in and out. And now I see, that you're the same maintainer. Wow! Let's see what <code>ripgrep</code> can bring to my life now that it is working :)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @gerdneuman on 2018-04-17 12:17</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-04-17 12:36</div>
            <div class="timeline-body"><p>@gerdneuman Thanks for the kind words, and glad you got it working. :-)</p>
<p>I am very close to removing the <code>snap</code> install instructions from the README. It has caused a large amount of frustration, and I don't have time to wade through its weeds.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:31 UTC
    </footer>
</body>
</html>
