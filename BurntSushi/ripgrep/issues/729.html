<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Handling of regex patterns that can match the empty string - BurntSushi/ripgrep #729</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Handling of regex patterns that can match the empty string</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/729">#729</a>
        opened by <a href="https://github.com/simark">@simark</a>
        on 2018-01-03 20:58
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/simark">@simark</a></div>
            <div class="timeline-body"><p>A regex that can match an empty string, like this:</p>
<pre><code>rg '(thisstringdoesnotexist)?'</code></pre>
<p>makes rg output one match for every line of every file searched.  With the --vimgrep option, it's one match per character.  When searching a big directory, it makes rg take a lot of time and resources to output meaningless results.  I think that rg should not output matches that are zero-length, I can't think of a use case where it would be useful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2018-01-03 21:06</div>
            <div class="timeline-body"><p>There is one use case i know of: If you want to colourise matches, but don't want to restrict the output to the lines containing those matches, it's common (with <code>grep</code> too) to do something like <code>rg '^|foo'</code>. That way every instance of <code>foo</code> is coloured, but it prints all of the 'non-matching' lines too</p>
<p>I suppose <code>rg -C65535 foo</code> would be a viable alternative to that though</p>
<p>Edit: In your case it just seems like a weird pattern though. Why would you search for <code>(thisstringdoesnotexist)?</code> instead of just <code>thisstringdoesnotexist</code>?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/simark">@simark</a> on 2018-01-03 21:15</div>
            <div class="timeline-body"><p>Ah ok thanks, didn't know about that use case...</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/simark">@simark</a> on 2018-01-03 21:19</div>
            <div class="timeline-body"><blockquote>
<p>Edit: In your case it just seems like a weird pattern though. Why would you search for (thisstringdoesnotexist)? instead of just thisstringdoesnotexist?</p>
</blockquote>
<p>Indeed, it would not be a useful search pattern.  However, I am integrating rg in an IDE, and am trying to handle gracefully anything the user throws at us, good or bad.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-01-03 22:00</div>
            <div class="timeline-body"><p>This is intended behavior. You can simply never avoid resource hungry regexes. For example, <code>rg .</code> is a thing that will also match and color every character. You'll need to design around it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2018-01-03 22:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2018-01-03 22:00</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2018-01-03 22:00</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:23 UTC
    </footer>
</body>
</html>
