<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFC: do you care which version of the Rust compiler ripgrep targets? - BurntSushi/ripgrep #1019</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>RFC: do you care which version of the Rust compiler ripgrep targets?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1019">#1019</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2018-08-20 12:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a></div>
            <div class="timeline-body"><p>In this issue, I&#x27;m asking for feedback from any user, and I&#x27;m particularly interested in getting feedback from folks that maintain ripgrep in some package repository.</p>
<p>What I&#x27;d like to know is: do you care which version of the Rust compiler ripgrep targets, and if so, how does it impact you?</p>
<p>There are at least a couple different aspects to this question. For example:</p>
<ul>
<li>That we document a minimum Rust compiler version at all.</li>
<li>That we support Rust compilers older than a few months.</li>
</ul>
<p>My policy for this has been relatively ad hoc, but fairly conservative in the context of the Rust ecosystem.  I&#x27;ve mostly done this out of &quot;good sense,&quot; in that it seems better for ripgrep to compile on more versions of the Rust compiler than not. However, what I&#x27;d like to know is whether it&#x27;s worth doing this. For example, if ripgrep changed to &quot;only guaranteed to compile on the latest stable release of the Rust compiler,&quot; how would that impact you?</p>
<p>What I&#x27;m trying to figure out here is what kind of room I have to maneuver. For example, sometime around the end of the year, Rust 2018 will be released, and ripgrep will eventually want to move to that. What I&#x27;d like to figure out is <em>when</em> that kind of move would be acceptable, and in order to do that, I need to ask people how the minimum supported Rust version impacts them. So any kind of experience you can offer would be great!</p>
<p>cc @svenstaro @roblourens @dstcruz @joshtriplett @infinity0 @carlwgeorge @ignatenkobrain @cuviper @sylvestre</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-20 12:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feedback wanted: do you care which version of the Rust compiler that ripgrep targets?&quot; to &quot;feedback wanted: do you care which version of the Rust compiler ripgrep targets?&quot; by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-20 12:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/igor-raits">@igor-raits</a> on 2018-08-20 12:19</div>
            <div class="timeline-body"><p>In Fedora we will always keep latest compiler once it gets release. So &quot;stick to the latest and coolest release&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/svenstaro">@svenstaro</a> on 2018-08-20 12:38</div>
            <div class="timeline-body"><p>In Arch we don&#x27;t care about any compiler but the latest stable. :P</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/tshepang">@tshepang</a> on 2018-08-20 13:18</div>
            <div class="timeline-body"><p>Not to speak for Debian, but my guess is that whichever version of rustc is in Testing should be one that is supported, or one in Unstable at worst. Stable does not feature in this decision since the version of ripgrep there will not change, essentially.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2018-08-20 15:37</div>
            <div class="timeline-body"><p>As long as it targets latest stable I don&#x27;t care</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sylvestre">@sylvestre</a> on 2018-08-20 16:34</div>
            <div class="timeline-body"><p>For debian and Ubuntu, last stable is fine.</p>
<p>For now, I don&#x27;t think we will backport rg to debian stable.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/federicomenaquintero">@federicomenaquintero</a> on 2018-08-20 17:44</div>
            <div class="timeline-body"><p>For openSUSE, we pick up the latest compiler version.</p>
<p>For SLE (Suse Linux Enterprise), we&#x27;ll freeze the compiler at the version that the long-term Firefox release will require.  I believe FF60 needs rustc 1.26.2, so that&#x27;s what we&#x27;ll use in SLE.</p>
<p>(For librsvg, I&#x27;m trying to tie it to the same version that Firefox requires, so that they will both work in the enterprise distro.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cuviper">@cuviper</a> on 2018-08-20 17:54</div>
            <div class="timeline-body"><p>Fedora&#x27;s <code>rustc</code> is continuously updated, as mentioned, and I update EPEL7 this way too.  For RHEL proper, we&#x27;re currently only shipping Rust in the Developer Tools <code>rust-toolset</code>, rebased quarterly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-20 18:03</div>
            <div class="timeline-body"><p>Thanks for the feedback so far! One of the things I&#x27;m interested in is figuring out the ramifications of tracking Rust stable instead of &quot;Rust stable minus N&quot; where N is somewhat loosely determined. I know some of you already mentioned that tracking Rust stable is fine, but for example, @federicomenaquintero, if ripgrep started tracking Rust stable, how would that impact you? Would you be able to just package last version of ripgrep that worked on the version of Rust that you&#x27;re using?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2018-08-20 20:57</div>
            <div class="timeline-body"><p>Generally speaking, if rustc isn&#x27;t getting updated then neither will ripgrep. So you don&#x27;t need to worry too much about the scenario where ripgrep gets updated but the update can&#x27;t get packaged because rustc doesn&#x27;t get updated.</p>
<p>The one case where that might cause a problem: if you ever need to put out an urgent bugfix for ripgrep (e.g. a hypothetical security issue parsing untrusted ignore files) then many other considerations for minimal updates and working on older rustc versions would apply.</p>
<p>Apart from that, using new features from the latest stable Rust seems fine in ripgrep itself. (Some of the crates ripgrep uses may have longer-term compatibility requirements.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-20 20:59</div>
            <div class="timeline-body"><blockquote>
<p>The one case where that might cause a problem: if you ever need to put out an urgent bugfix for ripgrep (e.g. a hypothetical security issue parsing untrusted ignore files) then many other considerations for minimal updates and working on older rustc versions would apply.</p>
</blockquote>
<p>Yeah that&#x27;s a good one. I feel like if something like that were ever to happen, I&#x27;d just cut a branch at whatever version of ripgrep needs the fix and publish a patch release there. I don&#x27;t really have the infrastructure in place to do it, and I&#x27;m not sure if I have the bandwidth to do it either, but I&#x27;d be willing to entertain the occasional backport if it&#x27;s strongly motivated.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cuviper">@cuviper</a> on 2018-08-20 21:01</div>
            <div class="timeline-body"><blockquote>
<p>Generally speaking, if rustc isn&#x27;t getting updated then neither will ripgrep.</p>
</blockquote>
<p>That&#x27;s true of the <em>packaged</em> ripgrep.  The remaining question is whether you want to support folks using their distro toolchain to <code>cargo install ripgrep</code> on their own.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-20 21:07</div>
            <div class="timeline-body"><blockquote>
<p>That&#x27;s true of the packaged ripgrep. The remaining question is whether you want to support folks using their distro toolchain to <code>cargo install ripgrep</code> on their own.</p>
</blockquote>
<p>Yeah, it&#x27;s becoming clear to me that this will be the key thing that is lost if ripgrep were to switch to &quot;latest stable only&quot; policy. I&#x27;m not sure how highly to weight this use case. :-/ I do know that users appreciate being able to <code>cargo install ripgrep</code>, but I also feel like those with <code>cargo</code> installed are <em>probably</em> writing Rust code, and if they&#x27;re writing Rust code, they&#x27;re probably not on an older Rust version or are even using <code>rustup</code>. But I&#x27;m of course waving my hands here!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2018-08-20 21:11</div>
            <div class="timeline-body"><p>@cuviper At one point, I worried a lot more about that, since packaging Rust software for Debian and other distros felt much further off. But I feel like, now that we have a much better story for how distributions can package software like ripgrep, and people <em>can</em> <code>apt install ripgrep</code> or equivalent in popular distributions (and other distributions have examples to follow to make that work), I&#x27;m a lot less worried about <code>cargo install ripgrep</code> building the latest ripgrep on old cargo/rustc. I <em>especially</em> don&#x27;t think people should expect that to work on, say, Debian stable, or testing during a freeze.</p>
<p>I&#x27;d still like to see us add metadata to <code>Cargo.toml</code> for rustc/cargo dependencies so that we get an early, clear error message for that kind of thing. (And that would also help when generating build dependencies.) But that isn&#x27;t ripgrep&#x27;s problem.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/cuviper">@cuviper</a> on 2018-08-20 21:25</div>
            <div class="timeline-body"><p>I do expect that most C and C++ software should be able to build with the system GCC, even on LTS-ish distros.  (Although I admit el7&#x27;s gcc-4.8.5 is now old enough to be annoying, nevermind el6, but that&#x27;s why we have devtoolset.) In the long term, I expect that Rust will settle down in a similar way.  For <code>ripgrep</code> in particular, it appears to be settling as a standard packaged distro tool too. üòÑ</p>
<blockquote>
<p>I&#x27;d still like to see us add metadata to Cargo.toml for rustc/cargo dependencies so that we get an early, clear error message for that kind of thing.</p>
</blockquote>
<p>Big üëç</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/joshtriplett">@joshtriplett</a> on 2018-08-20 21:29</div>
            <div class="timeline-body"><p>@cuviper C projects tend to adopt new C features more conservatively, not least of which due to requirements for portability to other compilers; if you need to build on the C compiler from a random proprietary UNIX, you&#x27;ll probably build on old GCC too. But I&#x27;ve definitely found that &quot;modern C++&quot; software often doesn&#x27;t build with LTS C++ compilers.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Ameobea">@Ameobea</a> on 2018-08-20 22:26</div>
            <div class="timeline-body"><p>I&#x27;m usually nightly all the time, so as long as it doesn&#x27;t break <em>every</em> new nightly release (looking at you clippy) I&#x27;m happy.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/dcarosone">@dcarosone</a> on 2018-08-21 10:08</div>
            <div class="timeline-body"><p>Nightly on anything where rustup works, and/or pkgsrc on smartos + netbsd</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-21 15:19</div>
            <div class="timeline-body"><p>All righty, based on the feedback I&#x27;ve got so far, I&#x27;m going to try switching to a <strong>latest stable</strong> policy for the next release. In detail, it will probably look like this:</p>
<ul>
<li>Every patch release will compile on the same version of the Rust compiler as the previous patch release.</li>
<li>New minor version releases of ripgrep may require a Rust compiler as recent as the latest stable release.</li>
</ul>
<p>I think this should satisfy most everyone who commented, and should also let us backport patches if that becomes necessary.</p>
<p>If this doesn&#x27;t work out for some reason or another, we can revert to a more conservative policy, but the benefits of sticking the latest stable release are too big to not try this at all.</p>
<p>@roblourens - I don&#x27;t think I&#x27;ve heard from you on this, but I think you build your own ripgrep and probably easily control the version of the Rust compiler you use.</p>
<p>I also don&#x27;t think I heard from any folks using Homebrew, but IIRC, they track the latest stable version of Rust as well.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/roblourens">@roblourens</a> on 2018-08-21 16:56</div>
            <div class="timeline-body"><p>That&#x27;s right, I usually just update to the latest stable each time I build it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-08-22 03:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;feedback wanted: do you care which version of the Rust compiler ripgrep targets?&quot; to &quot;RFC: do you care which version of the Rust compiler ripgrep targets?&quot; by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-05-01 12:29</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:07 UTC
    </footer>
</body>
</html>
