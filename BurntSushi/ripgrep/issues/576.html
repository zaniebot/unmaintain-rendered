<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Somehow using rg in an alias breaks it - BurntSushi/ripgrep #576</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Somehow using rg in an alias breaks it</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/576">#576</a>
        opened by <a href="https://github.com/lexicalunit">@lexicalunit</a>
        on 2017-08-17 15:33
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/lexicalunit">@lexicalunit</a></div>
            <div class="timeline-body"><p>When I run the exact same command as an alias, it works as expected. The intent is to search all files, disregarding any vcs or ignore files, and only exclude <code>.yml</code> files from the search.</p>
<pre><code>$ cd /tmp
$ git clone git@github.com:lexicalunit/atom-notes.git
$ cd atom-notes
$ alias foo=&#x27;rg --no-ignore -g &quot;\!.yml&quot; -c &#x27;
$ foo this
No files were searched, which means ripgrep probably applied a filter you didn&#x27;t expect. Try running again with --debug.
$ rg --no-ignore -g &quot;\!.yml&quot; -c this
LICENSE.md:2
README.md:4
lib/atom-notes.js:27
lib/notes-view-list-item.js:6
lib/notes-view-list.js:44
lib/notes-view.js:18
lib/utility.js:12
notebook/Welcome.md:1
$ foo --debug this
DEBUG:globset: built glob set; 0 literals, 1 basenames, 0 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG:grep::search: regex ast:
Literal {
    chars: [
        &#x27;t&#x27;,
        &#x27;h&#x27;,
        &#x27;i&#x27;,
        &#x27;s&#x27;
    ],
    casei: false
}
DEBUG:grep::literals: literal prefixes detected: Literals { lits: [Complete(this)], limit_size: 250, limit_class: 10 }
DEBUG:ignore::walk: ignoring ./.all-contributorsrc: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./.eslintrc.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./.git: Ignore(IgnoreMatch(Hidden))
DEBUG:ignore::walk: ignoring ./.gitignore: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./.nvatom-all-contributorsrc: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./.travis.yml: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./appveyor.yml: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./circle.yml: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./LICENSE.md: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./package-lock.json: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./package.json: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./README.md: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./grammars/notes.cson: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/atom-notes.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/config.coffee: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/interlink.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/notes-view-list-item.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/notes-view-list.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/notes-view.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./lib/utility.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./menus/atom-notes.cson: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./notebook/How to use.md: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./notebook/Welcome.md: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./spec/.eslintrc.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./spec/atom-notes-spec.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./spec/interlink-spec.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./spec/utility-spec.js: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
DEBUG:ignore::walk: ignoring ./styles/atom-notes.less: Ignore(IgnoreMatch(Override(Glob(UnmatchedIgnore))))
No files were searched, which means ripgrep probably applied a filter you didn&#x27;t expect. Try running again with --debug.
</code></pre>
Versions
<p>macOS 10.12.5</p>
<pre><code>$ eval &quot;$SHELL --version&quot;
zsh 5.2 (x86_64-apple-darwin16.0)
$ rg --version
ripgrep 0.5.2
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-08-17 15:47</div>
            <div class="timeline-body"><p>My guess is that you&#x27;re experiencing a problem with your shell, and in particular, its interaction with the <code>!</code>. For example, neither of your commands output results in my shell, but if I surround the <code>!</code> in single quotes, it works:</p>
<pre><code>[andrew@Serval ~] cd /tmp/
[andrew@Serval tmp] g clone git://github.com/lexicalunit/atom-notes
Cloning into &#x27;atom-notes&#x27;...
remote: Counting objects: 1007, done.
remote: Compressing objects: 100% (51/51), done.
remote: Total 1007 (delta 33), reused 47 (delta 19), pack-reused 937
Receiving objects: 100% (1007/1007), 212.45 KiB | 4.25 MiB/s, done.
Resolving deltas: 100% (592/592), done.
[andrew@Serval tmp] cd atom-notes/
[andrew@Serval atom-notes] alias foo=&#x27;rg --no-ignore -g &quot;\!.yml&quot; -c &#x27;
[andrew@Serval atom-notes] foo this
No files were searched, which means ripgrep probably applied a filter you didn&#x27;t expect. Try running again with --debug.
[andrew@Serval atom-notes] rg --no-ignore -g &quot;\!.yml&quot; -c this
No files were searched, which means ripgrep probably applied a filter you didn&#x27;t expect. Try running again with --debug.
[andrew@Serval atom-notes] rg --no-ignore -g &#x27;!.yml&#x27; -c this
README.md:4
LICENSE.md:2
notebook/Welcome.md:1
lib/utility.js:12
lib/notes-view.js:18
lib/notes-view-list-item.js:6
lib/notes-view-list.js:44
lib/atom-notes.js:27
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2017-08-17 16:12</div>
            <div class="timeline-body"><p>Yeah, your <code>\</code> is being interpreted literally. I <em>think</em> that&#x27;s because <code>!</code> begins a history expansion, which happens to be the only thing that is processed <em>before</em> alias expansion in zsh. Since the <code>!</code> ceases to be a special character after history expansion is performed, the shell leaves the quoted <code>\</code> alone instead of consuming it.</p>
<p>You can either remove the <code>\</code> or remove the double-quotes around it.</p>
<p>Also, you have a space at the end of your alias, which tells the shell to expand the following word as an alias too. This will cause problems if you ever try to search for a pattern that matches an alias name (for example, if you alias <code>bar=baz</code>, then use your <code>foo</code> alias like <code>foo bar</code>, it will search for <code>baz</code>). So you should probably remove the space too.</p>
<p>Lastly, <code>-g &#x27;!.yml&#x27;</code> will exclude files named exactly <code>.yml</code>. I assume that&#x27;s not what you want? Maybe <code>-g &#x27;!*.yml&#x27;</code> instead?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/lexicalunit">@lexicalunit</a> on 2017-08-17 16:50</div>
            <div class="timeline-body"><p>Yep! My bad, y&#x27;all. Using <code>&#x27;!...&#x27;</code> worked as I had intended. Also yeah I needed <code>!*.yml</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/lexicalunit">@lexicalunit</a> on 2017-08-17 16:50</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:04 UTC
    </footer>
</body>
</html>
