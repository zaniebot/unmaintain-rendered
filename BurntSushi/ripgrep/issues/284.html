<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[QUESTION/SUGGESTION] Does/should ripgrep support ag/ack's -g flag for searching filenames? - BurntSushi/ripgrep #284</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[QUESTION/SUGGESTION] Does/should ripgrep support ag/ack's -g flag for searching filenames?</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/284">#284</a>
        opened by <a href="https://github.com/YPCrumble">@YPCrumble</a>
        on 2016-12-21 15:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/YPCrumble">@YPCrumble</a></div>
            <div class="timeline-body"><p>Per the ack documentation:</p>
<blockquote>
<p>-g PATTERN Print files where the relative path + filename matches PATTERN.  This option can be combined with --color to make it easier to spot the match.</p>
</blockquote>
<p>I've searched the documentation and can't find this feature. Is this something that you'd be interested in for ripgrep? I'd be happy to submit a PR for it - I'm not a Rust expert but would love to jump in.</p>
<p>Thanks for writing such a great search tool!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-21 15:38</div>
            <div class="timeline-body"><p>Dupe of #193, #54, #75, #91, #48</p>
<blockquote>
<p>I've searched the documentation and can't find this feature.</p>
</blockquote>
<p>Three things are clear to me:</p>
<ol>
<li>This is a desirable feature.</li>
<li>It exists in ripgrep, but under a different name from ag.</li>
<li>(2) is hard to discover.</li>
</ol>
<p>Could you help me figure out how to make this feature more discoverable?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">doc</span> added by @BurntSushi on 2016-12-21 15:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YPCrumble">@YPCrumble</a> on 2016-12-21 15:40</div>
            <div class="timeline-body"><p>@BurntSushi :) I was <em>just</em> typing up the nuance in one of those issues. I don't think the -g flag works the way I'm looking for (how it works using ag or ack). Let me know if I can explain further?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-21 15:41</div>
            <div class="timeline-body"><p>@YPCrumble Did you click on the duplicate links? The <code>-g</code> flag applies globs to file paths for filtering. The <code>--files</code> flag modifies what ripgrep actually prints.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YPCrumble">@YPCrumble</a> on 2016-12-21 15:41</div>
            <div class="timeline-body"><p>@BurntSushi I'm going to create a quick repo to explain</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-21 16:01</div>
            <div class="timeline-body"><p>@YPCrumble Have you tried the <code>--files</code> flag yet?</p>
<pre><code>[andrew@Serval 193] mkdir stories
[andrew@Serval 193] echo 'Once upon a time' &gt; stories/story.txt
[andrew@Serval 193] rg -g 'story*' --files
stories/story.txt
</code></pre>
<p>Let's try to keep discussion on one issue.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YPCrumble">@YPCrumble</a> on 2016-12-21 16:35</div>
            <div class="timeline-body"><p>@BurntSushi would you take a look at https://github.com/YPCrumble/rg_example - I added my questions in the <code>README.md</code>. Thank you for taking the time! Hoping I can help you resolve all confusion at a minimum by adding clarity to the docs :).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YPCrumble">@YPCrumble</a> on 2016-12-21 16:36</div>
            <div class="timeline-body"><p>@BurntSushi also I'm by no means an expert I apologize in advance if this is just confusion or a silly error on my end!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-21 16:48</div>
            <div class="timeline-body"><p>@YPCrumble Are you not quoting the values you give to <code>-g</code>? If you don't quote them, your shell will expand them and probably result in behavior you didn't expect.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YPCrumble">@YPCrumble</a> on 2016-12-21 17:07</div>
            <div class="timeline-body"><p>@BurntSushi OK now I got it. This solves my issue. What do you think about either adding either an example of how to search file/path names OR an alias (ala your -p flag) that would add the -g --files and the quotes around the searched term?</p>
<p>I would be happy to try implementing the alias if that's interesting. I would suggest using the -P/--path flag as -p is already taken. My ideal would be to use the same -g flag as ag/ack or use -P for --pretty and -p for --path but seems like it would be a breaking (and therefore undesirable) change.</p>
<p>For updating the docs option I suggest adding an example to both <code>-g</code> and <code>--files</code>, like so:</p>
<p><strong>-g</strong></p>
<blockquote>
<p>Include or exclude files for searching that match the given glob.  This always overrides any other ignore logic.  Multiple  glob  flags  may  be used.  Globbing rules match .gitignore globs.  Precede a glob with a '!' to exclude it. Values given to -g must be quoted or your shell will expand them and result in unexpected behavior. Combine with the <code>--files</code> flag to return matched filenames (i.e., to replicate ack/ag's -g flag). For example: <code>rg -g &quot;&lt;pattern&gt;&quot; --files</code>.</p>
</blockquote>
<p><strong>--files</strong></p>
<blockquote>
<p>Print each file that would be searched (but don't search). Combine with the <code>-g</code> flag to return matched paths, for example: <code>rg -g &quot;&lt;pattern&gt;&quot; --files</code>.</p>
</blockquote>
<p>Thank you for your patience!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-21 17:21</div>
            <div class="timeline-body"><p>I like your documentation suggestions. :-)</p>
<p>I'd like to hold off on aliases for now since I think it makes the tool more confusing to use overall. I made a special exception for <code>-p</code> because it was useful to add quickly if you piped your results through a pager but still wanted the nice colored output. (If I could go back in time, I probably wouldn't have added this alias.)</p>
<p>Here is something that might be helpful to you though:</p>
<pre><code>$ cat $HOME/bin/rgg
#!/bin/sh

exec rg --files -g &quot;$1&quot;
</code></pre>
<p>Then you can just do <code>rgg 'file*'</code>. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/YPCrumble">@YPCrumble</a> on 2016-12-21 17:22</div>
            <div class="timeline-body"><p>Cool, will put into a PR!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2016-12-21 17:29</div>
            <div class="timeline-body"><p>@YPCrumble Yay thanks! Don't forget to modify <code>doc/rg.1.md</code> and run <code>cd doc &amp;&amp; ./convert-to-man</code>. If you don't have <code>pandoc</code> that's OK, I can run the conversion script.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2016-12-22 12:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jmatraszek">@jmatraszek</a> on 2017-04-02 20:20</div>
            <div class="timeline-body"><p>Hi @BurntSushi and @YPCrumble,
sorry for commenting on so old thread, but I found one case that this is not working (or more precisely: is working differently then I expect;)).</p>
<p>First of all, for me the whole point of using <code>--files -g</code> (or <code>ag</code>'s <code>-g</code>) is to use it as a <code>g:unite_source_rec_async_command</code> (if anyone is not familiar with Vim's Unite plugin: it lets quickly open a file that matches given pattern and uses this command to collect matches).</p>
<p>The workaround proposed in this thread works quite well, except one thing: the glob does not recursively go into directories (ergo: it's not usable in Unite). One way to fix it is to enable recursive globs by <code>shopt -s globstar</code> and then use it like that: <code>rgg **/*'PATTERN_FROM_UNITE'*</code>. However, this works terribly slow. For example a query that returns 20 matching files (in a directory that contains in all its subdirectories 1430 files combined) takes 1-2 seconds, while <code>ag</code> runs for 0.1 second.</p>
<p>Is there a way to benefit from ripgrep's raw speed in Unite, or <code>ag</code> is the only way to go? Or am I missing something and I've been using this wrong?</p>
<p>My <code>rgg</code>:</p>
<pre><code>#!/bin/sh

exec rg --follow --color=never --no-heading --hidden --files -g *$1*
</code></pre>
<p>Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-04-02 20:37</div>
            <div class="timeline-body"><p>@jmatraszek It's too hard for me to reason about your desired behavior without examples. Could you craft some specific examples using <em>plain</em> <code>rg</code> (no aliases) and <em>plain</em> <code>ag</code> on this repo? https://github.com/BurntSushi/linux Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-04-02 20:38</div>
            <div class="timeline-body"><p>@jmatraszek Could you also please open a new issue? Bumping old closed issues is a sure fire way for your feedback to fall off my radar. :-(</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:41:58 UTC
    </footer>
</body>
</html>
