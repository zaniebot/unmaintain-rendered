<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>bash completion for -g glob - BurntSushi/ripgrep #792</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>bash completion for -g glob</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/792">#792</a>
        opened by <a href="https://github.com/jzinn">@jzinn</a>
        on 2018-02-12 22:24
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jzinn">@jzinn</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>Ripgrep:</p>
<pre><code>$ rg --version
ripgrep 0.8.0 (rev 23d1b91ead)
-SIMD -AVX
</code></pre>
<p>Bash:</p>
<pre><code>bash-4.4.12-13.fc27.src.rpm
</code></pre>
<p>Bash-completion:</p>
<pre><code>bash-completion-2.6-2.fc27.src.rpm
</code></pre>
<h4>What operating system are you using ripgrep on?</h4>
<pre><code>$ uname -a
Linux ammonite 4.14.16-300.fc27.x86_64 #1 SMP Wed Jan 31 19:24:27 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
</code></pre>
<pre><code>$ cat /etc/redhat-release 
Fedora release 27 (Twenty Seven)
</code></pre>
<h4>Describe your question, feature request, or bug.</h4>
<p><strong>Bug</strong>: <code>rg -g Foo&lt;tab&gt;</code> should not be replaced with <code>rg -g &lt;GLOB&gt;...</code>.</p>
<p>When typing an argument to <code>-g</code> and hitting the tab character, then whatever you have typed for the argument is erased and replaced with the characters <code>&lt;GLOB&gt;...</code>.  It would be better not to do anything at all to preserve what was typed.</p>
<p>Even better than doing nothing would be to use file names for completion, so ...</p>
<p><strong>Feature request</strong>: <code>rg -g Foo&lt;tab&gt;</code> should use files in the current directory for tab auto-completion in Bash.  If possible, it should also work with negation (<code>rg -g &quot;!&quot;Foo&lt;tab&gt;</code>).</p>
<p>For example, the following should work:</p>
<pre><code>touch Foo.txt
rg -g Fo&lt;tab&gt;  # hit tab to initiate completion
rg -g Foo.txt  # after completion
</code></pre>
<p>This should also work:</p>
<pre><code>mkdir vendor
rg -g &quot;!&quot;vend&lt;tab&gt;  # hit tab to initiate completion
rg -g &quot;!&quot;vendor     # after completion
</code></pre>
<h4>If this is a bug, what are the steps to reproduce the behavior?</h4>
<p>Make a file:</p>
<pre><code>touch Foo.txt
</code></pre>
<p>Attempt to use it with autocomplete:</p>
<pre><code>rg -g Fo&lt;tab&gt;
</code></pre>
<h4>If this is a bug, what is the actual behavior?</h4>
<p>The command line is changed to</p>
<pre><code>rg -g &lt;GLOB&gt;...
</code></pre>
<h4>If this is a bug, what is the expected behavior?</h4>
<p>Either maintain the original command:</p>
<pre><code>rg -g Fo
</code></pre>
<p>or use file name:</p>
<pre><code>rg -g Foo.txt
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-02-12 22:27</div>
            <div class="timeline-body"><p>This sounds like a clap bug. Completion rules for ripgrep are provided on a best effort basis. Right now, the bash completion rules are automatically generated. I don't personally have the bandwidth to do anything more than that. (We either provide what clap provides, or someone else maintains them (like @okdana has been doing for zsh), or we drop them completely.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2018-02-12 22:27</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-02-12 22:27</div>
            <div class="timeline-body"><p>Thank you for the awesome bug report though. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jzinn">@jzinn</a> on 2018-02-12 22:28</div>
            <div class="timeline-body"><p>Thank you for the incredible response time!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kbknapp">@kbknapp</a> on 2018-02-12 23:11</div>
            <div class="timeline-body"><p>@jzinn would you mind filing a bug at <a href="https://github.com/kbknapp/clap-rs">kbknapp/clap-rs</a> please? In general the completion script generation was meant to get to the 95% solution, so they're not perfect. I agree it shouldn't replace anything already typed on the command line with a generic <code>&lt;GLOB&gt;...</code>, and actually should ideally just fallback to file matching.</p>
<p>It should be fairly simple on my end to just remove all generic completions and simply use file completion which I would say is what people expect 99% of the time. Even when it's actually wrong and not what the flag is asking for, it still doesn't surprise people like totally erasing what they wrote and replacing with a generic statement.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jzinn">@jzinn</a> on 2018-02-13 00:12</div>
            <div class="timeline-body"><p>Certainly.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-22 16:24</div>
            <div class="timeline-body"><p>This appears to have been fixed in clap.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2018-07-22 16:24</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:26 UTC
    </footer>
</body>
</html>
