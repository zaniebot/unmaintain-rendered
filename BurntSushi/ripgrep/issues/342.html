<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ripgrep output is invisible in PowerShell - BurntSushi/ripgrep #342</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ripgrep output is invisible in PowerShell</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/342">#342</a>
        opened by <a href="https://github.com/nzbart">@nzbart</a>
        on 2017-01-24 18:15
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/nzbart">@nzbart</a></div>
            <div class="timeline-body"><p>When I launch cmd.exe and run PowerShell from within that console window, the output is perfectly legible:</p>
<p><img src="https://cloud.githubusercontent.com/assets/1592130/22260190/287ee1de-e2cd-11e6-8edd-7a36cc123aa5.png" alt="image"></p>
<p>However, if I launch PowerShell and run rg within the default window, it appears that ripgrep renders the file name in blue rather than magenta, making it invisible:</p>
<p><img src="https://cloud.githubusercontent.com/assets/1592130/22260289/8c94631a-e2cd-11e6-9094-acc822e6c123.png" alt="image"></p>
<p>When I tried setting my colour scheme using the PowerShell console configuration window (Alt-Space, P from within the console) so that it matched the cmd.exe settings, I noticed that ripgrep was outputting blue text.</p>
<p>Why would ripgrep change the output colour of the file name in some cases, particularly when the background colour is blue, and is it possible to make this algorithm a bit smarter?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-24 18:22</div>
            <div class="timeline-body"><p>These are the default styles used by ripgrep in all circumstances: https://github.com/BurntSushi/ripgrep/blob/f5a2d022ecd16dfe67ea829267e9220136f20167/src/args.rs#L706-L711</p>
<pre><code>        let mut specs = vec![
            &quot;path:fg:magenta&quot;.parse().unwrap(),
            &quot;line:fg:green&quot;.parse().unwrap(),
            &quot;match:fg:red&quot;.parse().unwrap(),
            &quot;match:style:bold&quot;.parse().unwrap(),
        ];
</code></pre>
<p>In other words, ripgrep isn&#x27;t changing anything on you. I can&#x27;t really explain what you&#x27;re observing though. Maybe the blend of colors makes it invisible? Maybe Powershell has a more limited color palette and can&#x27;t display magenta? I don&#x27;t know.</p>
<p>You might consider trying to experiment with the color settings, which are configurable on the command line:</p>
<pre><code>        --colors &lt;SPEC&gt;...
            This flag specifies color settings for use in the output. This flag may be provided
            multiple times. Settings are applied iteratively. Colors are limited to one of eight
            choices: red, blue, green, cyan, magenta, yellow, white and black. Styles are limited
            to nobold, bold, nointense or intense.
            
            The format of the flag is {type}:{attribute}:{value}. {type} should be one of path,
            line or match. {attribute} can be fg, bg or style. {value} is either a color (for fg
            and bg) or a text style. A special format, {type}:none, will clear all color settings
            for {type}.
            
            For example, the following command will change the match color to magenta and the
            background color for line numbers to yellow:
            
            rg --colors &#x27;match:fg:magenta&#x27; --colors &#x27;line:bg:yellow&#x27; foo.
</code></pre>
<blockquote>
<p>and is it possible to make this algorithm a bit smarter?</p>
</blockquote>
<p>I would rather have a single set of defaults with no smarts. If those don&#x27;t work for whatever reason, then I&#x27;d like to encourage users to set their own colors with the <code>--colors</code> flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-01-24 18:55</div>
            <div class="timeline-body"><p>I&#x27;m not sure why the colour changes between the consoles, but this is the solution I&#x27;m using to work around it thanks to your suggestion.</p>
<p><img src="https://cloud.githubusercontent.com/assets/1592130/22261820/469ed600-e2d3-11e6-8c3d-67d048fce48d.png" alt="image"></p>
<p>For anyone else who runs into this issue, this should fix it:</p>
<pre><code>Add-Content $PROFILE -Encoding UTF8 &quot;`r`nfunction rg { rg.exe --colors &#x27;path:bg:white&#x27; `$args }`r`n&quot;
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-24 18:56</div>
            <div class="timeline-body"><p>@nzbart Oh cool! Could you explain your <code>Add-Content</code> command in more details for folks that aren&#x27;t familiar with Powershell? I&#x27;d love to add something like to the docs.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-01-24 19:08</div>
            <div class="timeline-body"><p>That command line adds the following to the current user&#x27;s PowerShell profile, whose path is stored in the variable <code>$PROFILE</code>:</p>
<pre><code>function rg { rg.exe --colors &#x27;path:bg:white&#x27; $args }
</code></pre>
<p>Unfortunately, it may not be 100% reliable in all cases depending on how people have configured their profile, so I&#x27;d be a bit reluctant to promote it to the official docs.</p>
<p>Something that might be worth adding to the docs is that the simplest way to install ripgrep on Windows may be the Chocolatey package that @dstcruz has kindly created:</p>
<ul>
<li><a href="https://chocolatey.org/packages/ripgrep">ripgrep package on Chocolatey.org</a></li>
</ul>
<p>Chocolatey is an increasingly popular way of installing software from the command-line. For example to install ripgrep:</p>
<pre><code>choco install ripgrep
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-24 19:18</div>
            <div class="timeline-body"><p>@nzbart Awesome, thanks for the info! I&#x27;ll try to improve the docs soon with your helpful feedback. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">doc</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-24 19:19</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;File name not readable in default PowerShell colour scheme&quot; to &quot;improve tips for Windows users in docs&quot; by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-01-24 19:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-02-11 12:34</div>
            <div class="timeline-body"><p>@nzbart Note that when you use such alias (through function) rg will not work through pipe
i.e. <code>rg -h | rg hidden</code> will not search output of <code>rg -h</code> but instead will regularly search files in directory.</p>
<p>P.s. the problem is that when you try to pipe output to such function. It will not pipe output to <code>rg.exe</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-11 13:35</div>
            <div class="timeline-body"><p>@DoumanAsh is there anyway to work around that and write a functional alias on Windows?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-02-11 14:03</div>
            <div class="timeline-body"><p>It took a bit of re-search but so far i found simple solution:</p>
<pre><code>function grep {
    $input | rg.exe --hidden $args
}
</code></pre>
<p>$input goes obviously for piping, and it works just fine even if you would have no pipe.</p>
<p>Reference to powershell builtin variables https://msdn.microsoft.com/en-us/powershell/reference/5.1/microsoft.powershell.core/about/about_automatic_variables</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-02-11 17:25</div>
            <div class="timeline-body"><p>@DoumanAsh nice improvement, thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;improve tips for Windows users in docs&quot; to &quot;Improve tips for Windows users in docs&quot; by <a href="https://github.com/nzbart">@nzbart</a> on 2017-02-28 22:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-03-06 02:06</div>
            <div class="timeline-body"><p>@DoumanAsh I&#x27;ve found that the function above doesn&#x27;t seem to work unless piping into it (Windows 10):</p>
<pre><code>&gt; gcm rg | select -expand definition

    $input | rg.exe --colors &#x27;path:bg:white&#x27; $args

&gt; set-content -Path test.txt -Value &quot;Something&quot; -Encoding UTF8
&gt; rg thing
&gt; rg.exe thing
test.txt
1:﻿Something
&gt; ls | cat | rg thing
1:Something
</code></pre>
<p>Does the test scenario above work for you (run steps in a clean directory)?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-06 05:19</div>
            <div class="timeline-body"><p>It works for me:</p>
<pre><code>08:15:21 &gt; set-content -Path test.txt -Value &quot;Something&quot; -Encoding UTF8
D:\repos\test
08:15:21 &gt; rg thing
test.txt
1:﻿Something
</code></pre>
<p>Maybe it depends on version of powershell?
Which do you use?
Try something above version 2.</p>
<p>You can do it by starting powershell with option <code>-version &lt;num&gt;</code></p>
<p>I tested on version from 3 to 5 and it works. Cannot go below because my profile wouldn&#x27;t load :D</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-03-06 22:07</div>
            <div class="timeline-body"><p>@DoumanAsh That is strange. Could you please confirm that <code>rg</code> in your test above is calling the function and not <code>rg.exe</code> directly? One way to do this is to run <code>gcm rg | select -expand definition</code>.</p>
<p>This is my PowerShell version:</p>
<pre><code>&gt; $PSVersionTable.PSVersion.ToString()
5.1.14393.693
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-07 04:54</div>
            <div class="timeline-body"><p>Opps... you&#x27;re right, i forgot that i aliased it to <code>grep</code>
Yes, it doesn&#x27;t work like that. I wonder why i didn&#x27;t notice it before :(</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-07 06:02</div>
            <div class="timeline-body"><p>Ok, i suspect <code>$input</code> has something even when stdin is empty and therefore <code>rg</code> is trying to read from there regardless.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-07 06:27</div>
            <div class="timeline-body"><p>Ok, i found work-arond:</p>
<pre><code>function grep {
    $count = @($input).Count
    $input.Reset()

    if ($count) {
        $input | rg.exe --hidden $args
    }
    else {
        rg.exe --hidden $args
    }
}
</code></pre>
<p>Basically i convert $input to Array and count number of elements.
And then i reset it back and depending wether there is something inside $input i pipe it to rg</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-03-30 19:31</div>
            <div class="timeline-body"><p>Unfortunately, it&#x27;s just much simpler to go back to the Silver Searcher than it is to have to work around this issue on every Windows machine I work on. Below is a comparison of these two tools when run in in the default PowerShell window on a clean Windows 10 install:</p>
<p><img src="https://cloud.githubusercontent.com/assets/1592130/24522125/0ae469cc-15eb-11e7-9abe-e4a52299e88c.png" alt="image"></p>
<p>As stated in my original post, it does work when starting the default cmd.exe console rather than PowerShell:</p>
<p><img src="https://cloud.githubusercontent.com/assets/1592130/24522234/57f72d44-15eb-11e7-8e28-ee5788096525.png" alt="image"></p>
<p>Hopefully, the out-of-the-box experience will be improved in a future version for Windows PowerShell users.</p>
<p>As an additional curiosity, I&#x27;m unsure why the UTF8 BOM is rendered differently by ripgrep between the two consoles.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-30 19:59</div>
            <div class="timeline-body"><p>@nzbart I don&#x27;t understand how ripgrep can work on all possible terminal color schemes out of the box. I think what you&#x27;re saying is, &quot;ag happens to pick a default color that works in my color scheme&quot;?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-30 19:59</div>
            <div class="timeline-body"><p>@nzbart Would #196 solve it? I guess I don&#x27;t understand why your work-around is so annoying.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 00:10</div>
            <div class="timeline-body"><p>I think the underlying issue here is not that the ripgrep color scheme doesn&#x27;t match the Powershell scheme, but that the colorization isn&#x27;t always working properly on Powershell.</p>
<p><code>&quot;path:bg:yellow&quot;</code> renders with a white background, but not the same white as <code>&quot;path:bg:white&quot;</code>. See pictures below.</p>
<p><code>&quot;path:bg:magenta:&quot;</code> renders with the exact same background color as the default background. This is a blue color, but not the same blue that&#x27;s produced by <code>&quot;path:bg:blue&quot;</code>.</p>
<p><code>&quot;path:bg:green&quot;</code>, <code>&quot;path:bg:red&quot;</code>, <code>&quot;path:bg:blue&quot;</code>, <code>&quot;path:bg:cyan&quot;</code>, <code>&quot;path:bg:white&quot;</code>, and <code>&quot;path:bg:black&quot;</code>all render correctly.</p>
<p>The same thing happens with <code>&quot;path:fg:whatever&quot;</code>.</p>
<p>Note that this seems to only happen with the powershell.exe executable itself. If I open cmd.exe and invoke powershell within that window, everything works fine.</p>
<p>These were all tested with Powershell 5.0.10586.117 (note: not the most recent version) on Windows 7 with the default Powershell color scheme.</p>
<p><code>&quot;path:bg:yellow&quot;</code>:</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24530998/9ce9d446-156a-11e7-86e0-1e866412c131.PNG" alt="bg-yellow"></p>
<p><code>&quot;path:bg:white&quot;</code>:</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24531006/a3dc21f0-156a-11e7-8aea-f72fd8beb9da.PNG" alt="bg-white"></p>
<p><code>&quot;path:bg:magenta&quot;</code> (with the background color of Powershell changed to make ripgrep&#x27;s colorization visible, and <code>&quot;path:fg:white&quot;</code> set to make the foreground text visible):</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24531028/cd864e86-156a-11e7-95e2-1e9627f9c691.PNG" alt="gb-magenta"></p>
<p><code>&quot;path:bg:magenta&quot;</code> (in the default Powershell color scheme, with <code>&quot;path:fg:white&quot;</code> set to make the text readable. The background color is completely invisible.</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24531304/c3a02bce-156c-11e7-9a44-8cd7b43f59ad.PNG" alt="bg_magenta-default"></p>
<p><code>&quot;path:bg:blue&quot;</code> (in the default Powershell color scheme, with <code>&quot;path:fg:white&quot;</code> set to make the text readable). Note that this is not the same blue as <code>&quot;path:bg:magenta&quot;</code> gets, and it&#x27;s (somewhat) readable even on the default color scheme.</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24531210/148393e2-156c-11e7-8ab9-08638e15046f.PNG" alt="bg-blue"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-31 00:20</div>
            <div class="timeline-body"><p>@elirnm If you toggle between <code>--colors &#x27;path:style:intense&#x27;</code> and <code>--colors &#x27;path:style:nointense&#x27;</code>, does that help at all?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 00:25</div>
            <div class="timeline-body"><p><code>--colors &quot;path:bg:yellow&quot; --colors &quot;path:style:intense&quot; --colors &quot;path:fg:black&quot;</code></p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24531419/da8ebfca-156d-11e7-8c5f-ce597dabf77d.PNG" alt="bg-yellow-intense"></p>
<p><code>--colors &quot;path:bg:magenta&quot; --colors &quot;path:style:intense&quot; --colors &quot;path:fg:white&quot;</code></p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24531424/e382ab14-156d-11e7-8e8a-c65482bf9159.PNG" alt="bg-intense-magenta"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-31 00:27</div>
            <div class="timeline-body"><p>Interesting. So I can&#x27;t really tell if there&#x27;s an actual bug in the communication with the Windows console. It seems like not? Maybe ripgrep should pick a default color scheme on Windows that fits the default color scheme of PowerShell and call it a day?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 01:12</div>
            <div class="timeline-body"><p>It seems like it might be a bug in powershell.exe, actually, or powershell.exe has a weird idea of colors, because this is happening natively as well.</p>
<p>In powershell.exe:</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24532314/67b3672e-1574-11e7-8ac1-55349933e858.PNG" alt="write-ps"></p>
<p>In a Powershell session invoked from cmd.exe:</p>
<p><img src="https://cloud.githubusercontent.com/assets/19817004/24532319/7538e572-1574-11e7-8793-7ca1d59c02fe.PNG" alt="write-cmd"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 01:26</div>
            <div class="timeline-body"><p>I don&#x27;t know much about console coloring, but <a href="https://github.com/PowerShell/PowerShell/issues/2381">PowerShell/PowerShell#2381</a> might be relevant. Also https://stackoverflow.com/questions/20541456/list-of-all-colors-available-for-powershell</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-31 04:54</div>
            <div class="timeline-body"><p>I&#x27;m using black color sceheme in powershell and it looks fine to me.
It is a bit dark but overall ripgrep&#x27;s default color scheme is fine.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 05:11</div>
            <div class="timeline-body"><p>@DoumanAsh By &quot;looks fine&quot; do you mean it&#x27;s readable or do you mean the colors are actually correct? If you execute <code>Write-Host &quot;blah&quot; -ForegroundColor DarkYellow</code> is the output actually dark yellow or is it white? Does <code>Write-Host &quot;blah&quot; -ForegroundColor DarkMagenta</code> produce dark magenta or a dark blue? Are the file paths that ripgrep prints out in magenta or dark blue?</p>
<p>It should obviously be perfectly readable on any shell where the background color doesn&#x27;t conflict with ripgrep&#x27;s colors.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-31 05:22</div>
            <div class="timeline-body"><p>Here is example of my look: http://i.imgur.com/gXU5l00.png
To me it seems to match <code>-ForegroundColor</code></p>
<p><code>-ForegroundColor DarkYellow</code> is actual dark yellow and the same for Magenta and Red</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 05:23</div>
            <div class="timeline-body"><p>What version of Powershell do you have? <code>$PSVersionTable</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/DoumanAsh">@DoumanAsh</a> on 2017-03-31 05:24</div>
            <div class="timeline-body"><pre><code>&gt; $PSVersionTable

Name                           Value
----                           -----
PSVersion                      5.1.14393.0
PSEdition                      Desktop
PSCompatibleVersions           {1.0, 2.0, 3.0, 4.0...}
BuildVersion                   10.0.14393.0
CLRVersion                     4.0.30319.42000
WSManStackVersion              3.0
PSRemotingProtocolVersion      2.3
SerializationVersion           1.1.0.1
</code></pre>
<p>I&#x27;m using latest PS</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/elirnm">@elirnm</a> on 2017-03-31 06:04</div>
            <div class="timeline-body"><p>I just updated to Powershell version 5.1.14409.1005 and it still doesn&#x27;t work correctly for me. Both magenta and yellow print the wrong colors. Maybe something with different Windows versions? I don&#x27;t know.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nzbart">@nzbart</a> on 2017-03-31 07:21</div>
            <div class="timeline-body"><p>@elirnm I think you might have hit upon the problem in your comment above (<a href="https://github.com/BurntSushi/ripgrep/issues/342">BurntSushi/ripgrep#342</a>#issuecomment-290588540) - well diagnosed!</p>
<p>@BurntSushi you asked above (<a href="https://github.com/BurntSushi/ripgrep/issues/342">BurntSushi/ripgrep#342</a>#issuecomment-290527465) whether this was a big problem. I prefer ripgrep over Silver Searcher, but they are both great tools, and one of them works out of the box on multiple machines without having to come up with unsatisfactory workarounds. Each of the PowerShell workarounds we tried above have some kind of deficiency that makes it annoying to use, along with the fact that I work on multiple machines that need the workaround applied instead of just running <code>choco install ag</code> or <code>choco install ripgrep</code> to get up and going.</p>
<p>I still use ripgrep in Vim via <a href="https://github.com/mhinz/vim-grepper">Grepper</a> because console colour isn&#x27;t a problem in this case, and because ripgrep has some very useful features such as understanding .gitignore files and having the <code>--smart-case</code> option.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/latkin">@latkin</a> on 2017-07-13 23:44</div>
            <div class="timeline-body"><p>This is because the default shortcuts for Windows Powershell use a customization of the standard console color palette, redefining &quot;DarkMagenta&quot; to be RGB(1,36,86) and &quot;DarkYellow&quot; to be RGB(238,237,240), then setting the background color as &quot;DarkMagenta.&quot;  This was done in order to give powershell a custom, distinctive blue color, see http://www.leeholmes.com/blog/2008/06/01/powershells-noble-blue/.</p>
<p>They overwrote dark magenta because it was judged to be rarely used (speculation). Dark yellow was updated because it didn&#x27;t have enough contrast against the new blue background.</p>
<p>You can see the 2 altered colors when you compare options from Powershell and Cmd:</p>
<p><img src="https://user-images.githubusercontent.com/5943573/28192119-04f7d2ec-67e9-11e7-9482-27b16e086567.png" alt="image"></p>
<p>The overriding of the RGB values is done via the registry:</p>
<p><img src="https://user-images.githubusercontent.com/5943573/28192178-4980c3f6-67e9-11e7-917c-61db861f16c6.png" alt="image"></p>
<p>Upshot is that any tools that write with DarkMagenta foreground are gonna be invisible in standard powershell consoles. IMO this was a total hack from Microsoft, but at this point it&#x27;s spilled milk.</p>
<p>I think one possible workaround is to check if rg is 1. running on windows and 2. current console background color is dark magenta. That&#x27;s a very strong indication that you are within a powershell console, and regardless file names will be invisible (either magenta/magenta or &quot;noble blue&quot;/&quot;noble blue&quot;). In this case output file names with intense magenta (which will still look good).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Improve tips for Windows users in docs&quot; to &quot;ripgrep output is invisible in PowerShell&quot; by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-07-15 16:19</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-07-15 16:20</div>
            <div class="timeline-body"><p>I am open to any easily maintainable hack that fixes this. Even something like, &quot;change the default colors on Windows regardless of shell&quot; would be OK with me I think.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/latkin">@latkin</a> on 2017-07-16 05:25</div>
            <div class="timeline-body"><blockquote>
<p>one possible workaround is to check if rg is 1. running on windows and 2. current console background color is dark magenta. ... In this case output file names with intense magenta (which will still look good).</p>
</blockquote>
<p>I have this implemented (though I&#x27;m new to rust, so hacks, surely). Should I send a PR?</p>
<p><img src="https://user-images.githubusercontent.com/5943573/28244875-3634777e-69ac-11e7-8b14-ebf2254d62f5.png" alt="image"></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-07-16 13:50</div>
            <div class="timeline-body"><p>@latkin Sure! I can help you get it into a non-hacky state. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-07-17 22:01</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:03 UTC
    </footer>
</body>
</html>
