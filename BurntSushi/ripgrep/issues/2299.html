<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`--engine kleenexp` - BurntSushi/ripgrep #2299</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>--engine kleenexp</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2299">#2299</a>
        opened by <a href="https://github.com/SonOfLilit">@SonOfLilit</a>
        on 2022-09-04 07:49
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/SonOfLilit">@SonOfLilit</a></div>
            <div class="timeline-body"><p>Hello,</p>
<p>I wrote and am about to launch <a href="https://github.com/SonOfLilit/kleenexp">Kleenexp</a>, a (Rust) compiler from a nice pleasant syntax to regular expressions, with some desirable features like needing a lot less escaping (and no double escaping), macros, number ranges (e.g. <code>#0..255</code> =&gt; <code>(?:\d|[1-9]\d|2[0-4]\d|25[0-5]</code>) and separators (<code>[separated:, 4 [#digits]]</code> =&gt; <code>(?:\d+)(?:,\d+){3}</code>).</p>
<p>Though I assume the project won&#x27;t be considered mature enough right now, in the long term I&#x27;d like submit a PR to <code>ripgrep</code> that implements <code>--engine kleenexp</code> (so I can <code>alias kg=rg --engine=kleenexp</code> and enjoy grepping with the same syntax I use to search in <code>vscode</code>), so I&#x27;d like to ask in advance what needs to happen for such a PR to be welcomed, so I can plan to evolve the project to meet those requirements.</p>
<p>For example an answer might involve:</p>
<ul>
<li>Just &quot;no, it&#x27;s out of scope and always will be&quot;</li>
<li>Better support for rust regex syntax in the generator, obviously (which I expect to get done this week), full support for all esoteric regex features</li>
<li>Some indication of code stability and maturity? Indication that it&#x27;s likely to stay maintained for many years to come? Which?</li>
<li>Some code size/performance metrics? Which?</li>
</ul>
<p>Thanks a lot,
Aur</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2022-09-04 16:57</div>
            <div class="timeline-body"><p>I don&#x27;t think it&#x27;s out of scope, but yeah I think the answer here is &quot;just no.&quot; Scope is maybe <em>part</em> of that, but there&#x27;s actually a whole host of reasons:</p>
<ul>
<li>Kleenexp is one of many many many &quot;regex for humans&quot; flavors. There are even several of them written in Rust. Either one is a clear and obvious winner (which I don&#x27;t believe is the case) or ripgrep allows all of them (which is impractical). Since I am personally not invested in the &quot;regex for humans&quot; idea---especially in a grep tool---I don&#x27;t see myself taking any action here.</li>
<li>The maintenance burden of a third regex engine inside of ripgrep.</li>
<li>Backwards compatibility. How do I know you aren&#x27;t going to break the syntax in a future revision? That breakage will be passed on to users of ripgrep.</li>
<li>A whole new dependency tree. Right now, I do my best to keep a tight leash on ripgrep&#x27;s dependency tree. Your project doesn&#x27;t have many dependencies (assuming you split it up into a library and dropped <code>clap</code>), but maybe that won&#x27;t be true a year from now.</li>
<li>Maturity in general. That is, at what point does one gain confidence that your new regex dialect is appealing to the masses? I&#x27;m not sure.</li>
</ul>
<p>My suspicion is that PCRE2 is and will always be the only other regex engine supported by ripgrep.</p>
<p>Note that it is possible to maintain a fork of ripgrep with an additional regex engine inside of it. Someone does that for Hyperscan for example: https://sr.ht/~pierrenn/ripgrep/ ... Hopefully, the actual patch to ripgrep is itself small, and most of the changes are just in new code. With that said, it looks like Kleenexp works by compiling down to Rust regex syntax. So I imagine you might actually just be able to write a wrapper script that translates your Kleenexp to a Rust regex and then invoke ripgrep. It&#x27;d be fair of work to make it right in all cases, but I bet you could have something simple working without much effort. Otherwise, yeah, I think the best route would be a patch to ripgrep that you maintain.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2022-09-04 16:57</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Locked by <a href="https://github.com/ghost">@ghost</a> on 2022-09-04 16:57</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:12 UTC
    </footer>
</body>
</html>
