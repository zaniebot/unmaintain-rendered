<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Option to print file paths as file URLs - BurntSushi/ripgrep #665</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Option to print file paths as file URLs</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/665">#665</a>
        opened by <a href="https://github.com/sanmai-NL">@sanmai-NL</a>
        on 2017-11-06 21:18
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sanmai-NL">@sanmai-NL</a></div>
            <div class="timeline-body"><p>Printing file paths as <code>file</code> URLs is very handy since you can click on them and the file will open. This happens in Konsole at least.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-11-06 21:25</div>
            <div class="timeline-body"><p>Do other command line tools have an option like this? I don't think I've seen anything like it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2017-11-06 21:25</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sanmai-NL">@sanmai-NL</a> on 2017-11-07 16:05</div>
            <div class="timeline-body"><p>@BurntSushi: I don't know off the top of my head. You also encounter such such links while paging log output, for example.</p>
<p>To be clear, this isn't a question but a feature request. ðŸ™‚</p>
<p><strong>Similar feature requests</strong></p>
<ul>
<li>robotframework/robotframework#2435</li>
<li>...</li>
</ul>
<p><strong>Added value</strong></p>
<ul>
<li>Quicker access to files due to clickable paths in KDE Konsole, macOS Terminal, ...</li>
<li><a href="http://blog.gypsydave5.com/2016/02/04/xargs-and-curl/">URLs can be read by <code>wget</code> and <code>curl</code></a></li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kpp">@kpp</a> on 2017-11-23 13:52</div>
            <div class="timeline-body"><pre><code>echo -e &quot;/path1\n/path2&quot; | xargs -n1 -I{} echo file://{}
file:///path1
file:///path2
</code></pre>
<p>You may do the same for <code>rg</code> without modifying it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-01-31 02:38</div>
            <div class="timeline-body"><p>I think I'm going to close this. I don't see a lot of other tools doing this, and it should be possible to write a wrapper script to do this for you if you really want it.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2018-01-31 02:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sanmai-NL">@sanmai-NL</a> on 2018-09-15 17:35</div>
            <div class="timeline-body"><p>@BurntSushi:
Important interesting precedent: https://github.com/systemd/systemd/blob/903511951892008b991991962fef2e8ecc65bc6c/NEWS#L220-L232.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adrianocr">@adrianocr</a> on 2019-07-22 21:22</div>
            <div class="timeline-body"><p>I think this should be reopened and properly considered. Its insanely useful. Certain terminal apps such as iterm2 does it by default. But it could work across ALL of them if rg outputted links with the <code>file://</code> syntax.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/alex">@alex</a> on 2020-06-28 22:16</div>
            <div class="timeline-body"><p>@BurntSushi I am not quite sure how this is implemented, but I just learned that <code>ls</code> has a feature <code>ls --hyperlink=auto</code> (or <code>always</code> or <code>never</code>), which causes it to emit things with ANSI shell magic that makes them clickable links in my terminal. Here's an example:</p>
<pre><code>alexgaynor@penguin ~/p/step-expirements&gt; ls --hyperlink=always example.py
example.py
alexgaynor@penguin ~/p/step-expirements&gt; ls --hyperlink=always example.py | xxd
00000000: 1b5d 383b 3b66 696c 653a 2f2f 7065 6e67  .]8;;file://peng
00000010: 7569 6e2f 686f 6d65 2f61 6c65 7867 6179  uin/home/alexgay
00000020: 6e6f 722f 7072 6f6a 6563 7473 2f73 7465  nor/projects/ste
00000030: 702d 6578 7069 7265 6d65 6e74 732f 6578  p-expirements/ex
00000040: 616d 706c 652e 7079 0765 7861 6d70 6c65  ample.py.example
00000050: 2e70 791b 5d38 3b3b 070a                 .py.]8;;..
</code></pre>
<p>If <code>ls</code> can have nice things, surely a program as awesome as <code>rg</code> can ðŸ˜‚</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/saleemrashid">@saleemrashid</a> on 2020-06-28 22:41</div>
            <div class="timeline-body"><p>This is fairly comprehensive documentation on the hyperlink feature that @alex mentioned: https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mx-psi">@mx-psi</a> on 2020-08-05 15:19</div>
            <div class="timeline-body"><p>Any chance this will be reopened? As mentioned above, there is widespread support for hyperlinks on modern terminal emulators and tools like <code>ls</code> have built-in support for this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kovidgoyal">@kovidgoyal</a> on 2020-10-06 08:28</div>
            <div class="timeline-body"><p>FYI: Here is a wrapper implementation that actually allows you to click on results and open them in your editor at the matched line. https://sw.kovidgoyal.net/kitty/kittens/hyperlinked_grep.html</p>
<p>Note that it works with the kitty terminal.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/adrian-gierakowski">@adrian-gierakowski</a> on 2021-02-06 22:15</div>
            <div class="timeline-body"><p>@BurntSushi would you be so kind and reconsider? it would be amazing to have it supported out of the box and not have to use wrappers</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2021-05-13 15:42</div>
            <div class="timeline-body"><p>The following things seem to be needed for supporting hyperlinked file paths in ripgrep. I'm just writing for no reason, maybe it's useful.</p>
<ul>
<li>Resolve paths to absolute paths (I would suggest do so without touching the filesystem, don't want canonicalization) and url escape paths to be printable-ascii-safe as <code>file://</code> URIs.</li>
<li>Lookup current hostname (bonus feature but should preferably be in the URL according to the spec, this seems to be a bit of a layer-busting complication)</li>
<li>Add cli parameter --hyperlink={always|ansi|auto|never}  (I don't know if ansi is useful here, but I think so)</li>
<li>Use the hyperlink escapes in the printer crate. I'm not sure if it's a great fit to try to put it inside termcolor - even if the spec says it works very similarly to colors.</li>
</ul>
<p>This feature is supported with the same escape code in Linux (various terminals including gnome-terminal), Windows (microsoft/terminal), macos (iTerm2). The pager less supports it in new versions.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-05-13 18:08</div>
            <div class="timeline-body"><p>@bluss Thanks for laying that out! Some quick feedback:</p>
<ul>
<li>If possible, I'd like to avoid the hostname lookup aspect of this. You're spot on about it being layer busting. I think the key thing here is, what does the hostname buy us? i.e., What do we lose if we don't bother with it.</li>
<li>Putting this inside of termcolor might be nice to be honest, especially if it's an ANSI escape sequence. Or at least, putting the <em>emission</em> of that ANSI escape inside termcolor would be good. Having it be outside of termcolor would probably be more problematic.</li>
<li>When supporting the legacy Windows console, I think we would just not emit the escape sequence, like we do now for things not supported by the Windows console.</li>
</ul>
<p>I think that's all I can think of for right now. I'll re-open.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by @BurntSushi on 2021-05-13 18:08</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @BurntSushi on 2021-05-13 18:08</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/NightMachinery">@NightMachinery</a> on 2021-05-13 19:17</div>
            <div class="timeline-body"><p>@burntsushi The <code>hostname</code> can enable usage on SSH. With the hostnames present, one can configure their editor to open the remote files (both Vim and Emacs support this very well, and VSCode kind of supports it as well). If there is a performance concern, just cache the hostname every, say, week.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-05-13 19:21</div>
            <div class="timeline-body"><p>The concern isn't performance. Folks asking for file URIs can afford to pay for one hostname query per ripgrep execution. The issue (in my head) is abstraction. It likely means refactoring. I don't know how severe it is.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/bluss">@bluss</a> on 2021-05-13 19:36</div>
            <div class="timeline-body"><p>Thanks! The main feature of the hostname is just for the terminal to know if it's a local path or not, as I understand it, so that it can avoid trying to open a remote path locally. (I haven't seen other features that are worth the bother, but they might come, too.)  Just for fun, here's a snippet for making hyperlinks in the shell <code>printf '\e]8;;%s\e\\%s\e]8;;\e\\\n' &quot;$LINK&quot; &quot;$TITLE&quot;</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kovidgoyal">@kovidgoyal</a> on 2021-05-14 01:13</div>
            <div class="timeline-body"><p>If you leave out hostname, you make it impossible for things like this
to function: https://sw.kovidgoyal.net/kitty/kittens/remote_file.html</p>
<p>That allows the user to click on hyperlinks pointing to a file on a
remote machine via SSH and have the file edited locally and
automatically re-uploaded, seamlessly by just clicking on it.</p>
<p>Please do not leave it out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/XhstormR">@XhstormR</a> on 2021-08-16 11:07</div>
            <div class="timeline-body"><p>This feature is really helpful.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghost">@ghost</a> on 2022-08-08 21:54</div>
            <div class="timeline-body"><p>Hello. This would be a good addition to rg. About the hostname part of this, I've never seen a file:/// url with the hostname part specified (I've been using Linux since 2007); yes the spec talks about it, but in the real world it doesn't seem to be used for file:/// urls.</p>
<p><code>ls</code> has this feature for local files only, right?</p>
<p>I think adding this for local files only would cover 90% of the use-cases.</p>
<p>My 2p's.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Jackenmen">@Jackenmen</a> on 2022-08-08 22:13</div>
            <div class="timeline-body"><blockquote>
<p><code>ls</code> has this feature for local files only, right?</p>
</blockquote>
<p>No, it properly includes the hostname. As said above, it actually allows for existence of useful features such as clicking on the hyperlink in SSH session and opening or saving it with the local editor:
<img src="https://user-images.githubusercontent.com/6032823/183522483-e3692dc3-1bf6-4f5d-afaa-c63c9d385ae0.png" alt="image" />
<img src="https://user-images.githubusercontent.com/6032823/183522548-777e7136-b527-477a-a7cf-843d4c9fbd7a.png" alt="image" /></p>
<blockquote>
<p>About the hostname part of this, I've never seen a file:/// url with the hostname part specified (I've using Linux since 2007); yes the spec talks about it, but in the real world it doesn't seem to be used for file:/// urls.</p>
</blockquote>
<p><strong>Escape sequences</strong> for hyperlinks did not exist in 2007. You might have not seen <code>file://</code> with the hostname part specified in the typical contexts where you've seen <code>file://</code> (browsers, desktop environments, etc.) but you need to look at this within the context of terminal emulators and within that context, specifying hostname is well-established by this extension of the VT protocol:
https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda#file-uris-and-the-hostname</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghost">@ghost</a> on 2022-08-08 22:41</div>
            <div class="timeline-body"><p>That would require support in the terminal emulators, to fetch the file using scp, edit it, then reupload it... I don't know what terminal emulators, other than kitty, will actually support that.</p>
<p>My main point is, this can be implemented for local files only now (looking at the above comments the hostname querying seems to be a big obstacle for implementing this), and extended later.</p>
<p>Also note that, even gnome-terminal itself, will just tell you it can't open such kind of url:</p>
<pre><code>Could not open the address &quot;file://foo/bar/baz&quot;
&quot;file&quot; scheme with remote hostname not supported
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Jackenmen">@Jackenmen</a> on 2022-08-08 22:56</div>
            <div class="timeline-body"><blockquote>
<p>My main point is, this can be implemented for local files only now</p>
</blockquote>
<p>If you want to follow the specification that I linked (and the spec that all the terminals seem to be using), I'm not sure you can as it seems to be quite clear on this:</p>
<blockquote>
<p>Web browsers, desktop environments etc. tend to ignore the hostname component of a <code>file://hostname/path/to/file.txt</code> URI. In terminal emulators, such ignorance would lead to faulty targets if you <code>ssh</code> to a remote computer. <strong>As such, we don't allow this sloppiness. Utilities that print hyperlinks are requested to fill out the <code>hostname</code></strong>, and terminal emulators are requested to match it against the local hostname and refuse to open the file if the hostname doesn't match (or offer other possibilities, e.g. to download with <code>scp</code> as iTerm2 does).</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2022-10-01 18:51</div>
            <div class="timeline-body"><p>Note that currently, Windows Terminal does not support the hostname:</p>
<p>https://github.com/microsoft/terminal/blob/54dc2c4432857919a6a87682a09bca06608155ed/src/cascadia/TerminalApp/TerminalPage.cpp#L2304-L2309</p>
<p>Which basically means the hostname should be omitted, at least on Windows. Note that the spec <em>requests</em> for utilities to add the hostname, it does not <em>require</em> it.</p>
<p>(I'd like to work on this feature BTW)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kovidgoyal">@kovidgoyal</a> on 2022-10-02 02:06</div>
            <div class="timeline-body"><p>On Sat, Oct 01, 2022 at 11:52:09AM -0700, Lucas Trzesniewski wrote:</p>
<blockquote>
<p>Note that currently, Windows Terminal does not support the hostname:</p>
<p>https://github.com/microsoft/terminal/blob/54dc2c4432857919a6a87682a09bca06608155ed/src/cascadia/TerminalApp/TerminalPage.cpp#L2304-L2309</p>
<p>Which basically means the hostname should be omitted, at least on Windows. Note that the spec <em>requests</em> for utilities to add the hostname, it does not <em>require</em> it.</p>
</blockquote>
<p>One terminal not supporting it on Windows doesnt mean it should be
omitted on windows.</p>
<p>And as has been noted above multiple times, not adding hostname will
<em>break</em> functionality in advanced terminal emulators. Both iTerm2 and
kitty use hostname to allow hyperlinks to work over ssh.</p>
<p>If ls can output hostnames in its hyperlinks with no ill effects so can
rg.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2022-10-02 10:10</div>
            <div class="timeline-body"><blockquote>
<p>One terminal not supporting it on Windows doesnt mean it should be omitted on windows.</p>
</blockquote>
<p>Well, the problem on Windows is not really Windows Terminal itself (though that's the main terminal app). The problem is that the <em>shell</em> doesn't support the hostname in file hyperlinks. Any terminal app trying to open a link using the shell will have the same issue. You cannot make hyperlinks broken by default on Windows.</p>
<p>I just tried opening such an URI with the shell, and I got the following error: <em>&quot;The system cannot find the file specified.&quot;</em>. Windows Terminal prevents it and displays a more user-friendly error instead.</p>
<p>Here are the options I can see:</p>
<ul>
<li>Omit the hostname everywhere (breaks SSH)</li>
<li>Include the hostname everywhere (breaks Windows Terminal and other apps which use the shell)</li>
<li>Omit the hostname on Windows, include it everywhere else (good compromise IMO, SSH would work with kitty)</li>
<li>Omit the hostname if the <code>WT_SESSION</code> environment variable is set (special-cases Windows Terminal)</li>
<li>Add a command line argument for this (maybe overkill)</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ssbarnea">@ssbarnea</a> on 2022-10-02 10:26</div>
            <div class="timeline-body"><p>There is no need for hostname for local file URI, they only need <code>file://</code> prefix, followed by the FULL-PATH (whatever is that on windows, especially as running under WSL would mean a unix path). URI cannot have relative paths, not supported by default. Feel free to consult the specification or details at https://datatracker.ietf.org/doc/html/rfc8089#appendix-D.2</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2022-10-02 10:32</div>
            <div class="timeline-body"><blockquote>
<p>There is no need for hostname for local file URI</p>
</blockquote>
<p>The concern here is running ripgrep through SSH. That would output &quot;local&quot; files paths from the point of view of the remote machine. The terminal would need the hostname to detect those aren't really local.</p>
<blockquote>
<p>whatever is that on windows, especially as running under WSL would mean a unix path</p>
</blockquote>
<p>Those work:</p>
<ul>
<li><code>file:///C:/SomeDir/SomeFile.txt</code></li>
<li><code>file://localhost/C:/SomeDir/SomeFile.txt</code></li>
<li><code>file://wsl$/Ubuntu/SomeDir/SomeFile.txt</code></li>
</ul>
<p>Those don't:</p>
<ul>
<li><code>file://local_hostname/C:/SomeDir/SomeFile.txt</code></li>
</ul>
<p>I just realized WSL links work fine with the shell, but Windows Terminal blocks them. I'll open an issue for that.</p>
<p>Ew, actually, remote hostnames work fine, but the local hostname is rejected unless it's literally <code>localhost</code>. ðŸ˜­</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/kovidgoyal">@kovidgoyal</a> on 2022-10-02 11:42</div>
            <div class="timeline-body"><p>On Sun, Oct 02, 2022 at 03:10:22AM -0700, Lucas Trzesniewski wrote:</p>
<blockquote>
<blockquote>
<p>One terminal not supporting it on Windows doesnt mean it should be omitted on windows.</p>
</blockquote>
<p>Well, the problem on Windows is not really Windows Terminal itself (though that's the main terminal app). The problem is that the <em>shell</em> doesn't support the hostname in file hyperlinks. Any terminal app trying to open a link using the shell will have the same issue. You cannot make hyperlinks broken by default on Windows.</p>
</blockquote>
<p>I dont follow, any halfway decent terminal running on windows should
just parse the URI, if it detects that it has a hostname, match it
against the hostname of the local machine, if it is local it can remove
the hostname from the URI before passing it on to the shell. Or just
extract the local file path and pass it to the shell.</p>
<p>There is absolutely zero need for individual terminal applications to
try to specialize their output based on intended destination OS, which
is anyway not possible to determine, given that they could be running
over SSH.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2022-10-02 11:51</div>
            <div class="timeline-body"><p>@kovidgoyal it seems you're reading this discussion through your mails, so you probably didn't see it, but I have made lots of edits to my posts, and opened an issue with Windows Terminal which requests them to do exactly what you suggest. ðŸ™‚</p>
<p>But <em>today</em>, it's unfortunately broken, and we need to deal with it. If you run ripgrep over SSH, the remote process won't be on Windows anyway so it'll output the hostname just fine.</p>
<p>Note that ripgrep already specializes on the OS for much more trivial things:</p>
<p>https://github.com/BurntSushi/ripgrep/blob/4386b8e805e273a9795ad4e256c455c74407c949/crates/printer/src/color.rs#L16-L19</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2022-10-19 18:17</div>
            <div class="timeline-body"><p>I started implementing this in #2322, and have a preview version available if you're interested.</p>
<p>If you'd like to try it out, I made a <a href="https://github.com/ltrzesniewski/ripgrep/actions/workflows/preview.yml?query=is%3Asuccess">GitHub workflow</a> which builds ripgrep with this feature. Just open the latest build and download the artifact for your platform (at the bottom of the build summary - unfortunately, many warnings are produced by the rustup action).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guettli">@guettli</a> on 2023-01-06 09:59</div>
            <div class="timeline-body"><p>if i use <code>rg myterm | cat</code> I get output like this:</p>
<pre><code>internal/annotation/load_balancer_test.go:                              annotation.LBSvcProtocol:            hcloud.LoadBalancerServiceProtocolTCP,
internal/annotation/load_balancer_test.go:                              annotation.LBSvcHealthCheckProtocol: hcloud.LoadBalancerServiceProtocolTCP,
</code></pre>
<p>In vscode I can click on <code>internal/annotation/load_balancer_test.go</code> and jump to the source code.</p>
<p>I don't think file URLs like <code>file://...</code> are needed.</p>
<p>But the line-numbers are missing. It would be great to include them somehow.</p>
<p>Update: I use this in my .bashrc now, and it works fine:</p>
<pre><code>if [[ &quot;$TERM_PROGRAM&quot; == 'vscode' ]]; then
  alias 'rg'='rg --no-heading --column'
fi
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-01-06 10:42</div>
            <div class="timeline-body"><p>Oh, that's a nice feature of VSCode ðŸ™‚</p>
<p>If you use <code>rg -n myterm | cat</code> the output will include line numbers in the <code>file:line</code> format, and VSCode is able to interpret that and jump to the correct line number.</p>
<p>Unfortunately, that only works in the VSCode terminal (or in terminals which treat <code>file:line</code> command output as a link)... Also, note that VSCode underlines <code>file://</code> links so they stand out.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guettli">@guettli</a> on 2023-01-06 12:07</div>
            <div class="timeline-body"><p>Thank you for the hint. <code>rg -n myterm | cat </code> works fine. I can jump the the correct line via vscode.</p>
<p>The pattern <code>file:linenumber ....</code> for output of compilers/lints is very common. This worked even 20 years ago (when I used emacs).</p>
<p>Adding <code>file://</code> would make the output more ugly for the human eyes.</p>
<p>Is there a way to configure rg to always use the output of <code>rg -n ... | cat</code> ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-01-06 12:14</div>
            <div class="timeline-body"><p>Use the <code>--no-heading</code> flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-01-06 13:38</div>
            <div class="timeline-body"><blockquote>
<p>Adding <code>file://</code> would make the output more ugly for the human eyes.</p>
</blockquote>
<p>It renders like that in VSCode:</p>
<p><img src="https://user-images.githubusercontent.com/7913492/211023176-53bbfa0a-cab0-443e-b653-83422fe757bd.png" alt="image" /></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/guettli">@guettli</a> on 2023-01-06 13:42</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>Adding <code>file://</code> would make the output more ugly for the human eyes.</p>
</blockquote>
<p>It renders like that in VSCode:</p>
<p><img src="https://user-images.githubusercontent.com/7913492/211023176-53bbfa0a-cab0-443e-b653-83422fe757bd.png" alt="image" /></p>
</blockquote>
<p>This looks great.</p>
<p>The line-numbers are hyperlinks to the corresponding lines?</p>
<p>How to enable this output?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-01-06 14:13</div>
            <div class="timeline-body"><p>No, unfortunately the line numbers aren't hyperlinks. Only the heading is a hyperlink, that's why it's underlined.</p>
<p>There would need to be a <em>standardized</em> way in the <code>file://</code> protocol to target a specific line in a file, and the terminal would need to understand these kinds of links, but there's no such standard AFAIK. Also, having each line number underlined wouldn't look great I suppose.</p>
<p>The screenshot was taken using a build of ripgrep which includes my #2322 PR. If you'd like to try it, you can <a href="https://github.com/ltrzesniewski/ripgrep/actions/runs/3283869673">download it here</a> (scroll to the bottom of the page where the artifacts are located).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/diktomat">@diktomat</a> on 2023-01-06 19:42</div>
            <div class="timeline-body"><p>@guettli:</p>
<blockquote>
<p>The pattern <code>file:linenumber ....</code> for output of compilers/lints is very common. This worked even 20 years ago (when I used emacs).</p>
</blockquote>
<p>Because editors can implement this, using the knowledge they have. Like in Vim, the exact format is specified via the buffer-local <code>grepformat</code> and <code>errorformat</code> options, the latter most times set by the filetype/compiler plugin. Terminals don't have this knowledge.</p>
<blockquote>
<p>Adding <code>file://</code> would make the output more ugly for the human eyes.</p>
</blockquote>
<p>That's one reason why it's requested to implement the escape codes, so it's not visible to the eye, only to the terminal.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ghost">@ghost</a> on 2023-01-07 12:22</div>
            <div class="timeline-body"><blockquote>
<p>@guettli:</p>
<blockquote>
<p>The pattern <code>file:linenumber ....</code> for output of compilers/lints is very common. This worked even 20 years ago (when I used emacs).</p>
</blockquote>
<p>Because editors can implement this, using the knowledge they have. Like in Vim, the exact format is specified via the buffer-local <code>grepformat</code> and <code>errorformat</code> options, the latter most times set by the filetype/compiler plugin. Terminals don't have this knowledge.</p>
</blockquote>
<p>FWIW, have a look at KDE's Konsole (Edit current profile -&gt; Mouse -&gt; Miscellaneous), it's had this functionality for some time (using regular expressions to detect file urls, both absolute and relative), i.e. clicking something in the output of grep/rg/compiler errors ...etc in the form <code>path/to/some/file.h:100:10</code> would open file.h at line 100 and column 10 in a variety of Linux text editors, Kate, gVim, Gedit ...etc, with an option to specify a custom command line to an editor that has cli options to open at line/column.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nbenitez">@nbenitez</a> on 2023-03-22 18:26</div>
            <div class="timeline-body"><p>It'd be cool to have this feature in, so we can eg. open matches directly in our code editor by clicking on them, or any similar use case.</p>
<p>The maintainer of the now default GNOME console app <a href="https://gitlab.gnome.org/GNOME/console/-/issues/142#note_1451871">has said</a> that is not adding a custom hyperlink feature because they already support the standard link format. So I think ripgrep should use this standard link format so we can open files directly from ripgrep output.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-03-26 13:54</div>
            <div class="timeline-body"><p>How about making the hyperlink format configurable?</p>
<p>That's what <a href="https://github.com/dandavison/delta">delta</a> does for its ripgrep support, as described by @dandavison <a href="https://github.com/BurntSushi/ripgrep/issues/86#issuecomment-1469717706">here</a>. See the <a href="https://dandavison.github.io/delta/grep.html">delta docs</a>.</p>
<p>In a nutshell:<br />
Given that any problem can be solved by adding an extra level of indirection, ripgrep could use a custom URI protocol, which would be registered to invoke a tool such as <a href="https://github.com/dandavison/open-in-editor">open-in-editor</a>, which would know how to open an editor at a specific line.<br />
(I'm assuming that knowing how to open a given editor at a specific line is out-of-scope for ripgrep itself).</p>
<p>This would need to be enabled with an additional parameter, maybe something such as:<br />
<code>--hyperlink-format 'editor://{file}:{line}'</code></p>
<p>The default pattern could be <code>file://{hostname}/{file}</code> on Unix and <code>file:///{file}</code> on Windows (with a special provision for WSL).</p>
<p>Also, having the hyperlink format be configurable would accommodate everyone's needs.</p>
<p>I can add that to #2322 if there's a chance it could be accepted.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-03-31 17:02</div>
            <div class="timeline-body"><p>I noticed that VSCode <a href="https://code.visualstudio.com/docs/editor/command-line#_opening-vs-code-with-urls">provides an URL handler</a> out of the box, so using it would be very simple with this option:</p>
<p><code>--hyperlink-format 'vscode://file/{file}:{line}'</code></p>
<p>I think I'm going to implement it, as it'll allow hyperlinking line numbers.</p>
<p>After a few months of using ripgrep with file hyperlinks, I can tell they make exploring match results much more convenient, but directly going to the matching line in the editor would be so much better.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-04-02 21:14</div>
            <div class="timeline-body"><p>I implemented customizable hyperlinks (which <em>can</em> link directly to a matching line/column) in #2483 if you want to give them a try. Optimized builds can be found <a href="https://github.com/ltrzesniewski/ripgrep/actions/workflows/preview.yml?query=is%3Asuccess">here</a> (just pick the newest one). See the PR description for more details.</p>
<p>For Windows Terminal users, be aware that anything other than <code>file://</code> won't work until the next preview release, as <a href="https://github.com/microsoft/terminal/pull/14993">this change</a> needs to ship first.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/097115">@097115</a> on 2023-04-10 16:48</div>
            <div class="timeline-body"><p>@ltrzesniewski</p>
<p>Thanks for your builds!</p>
<p>However, the hyperlinks seem not to work under <code>tmux</code> (<code>ls</code> still works, though). Tested in <code>kitty</code> and <code>alacritty</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/nbenitez">@nbenitez</a> on 2023-04-10 16:58</div>
            <div class="timeline-body"><p>@097115 Excerpt from https://superuser.com/questions/1771573/file-hyperlink-not-working-under-tmux :</p>
<p><em>Support for hyperlinks has been added to tmux in Git a few months ago and will be available in the next release, probably 3.4</em></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/097115">@097115</a> on 2023-04-10 17:04</div>
            <div class="timeline-body"><p>I'm on 3.4 and <strong>as I said in my first comment</strong>, <code>ls --hyperlink=always</code> does work for me in <code>tmux</code>. While @ltrzesniewski's custom build of <code>rg</code> doesn't.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-04-10 17:34</div>
            <div class="timeline-body"><p>@097115 thanks for your feedback. I'll take a look.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2023-04-12 21:02</div>
            <div class="timeline-body"><p>@097115 I believe this is an issue in tmux, and have reported it here: https://github.com/tmux/tmux/issues/3525</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/097115">@097115</a> on 2023-04-13 01:40</div>
            <div class="timeline-body"><p>Thanks again, Lucas!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-09-22 17:57</div>
            <div class="timeline-body"><p>For anyone following this issue, there is active discussion about adding support for it in this PR: https://github.com/BurntSushi/ripgrep/pull/2483</p>
<p>Opinions are welcome because this is clearly a very thorny feature to add support for. It is not simple and it looks like it is going to be integration specific. I won't be surprised if I get this wrong in some way in the initial release unfortunately.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2023-09-25 18:39</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-09-25 18:56</div>
            <div class="timeline-body"><p>Support for hyperlinks is on master. I would love feedback here: https://github.com/BurntSushi/ripgrep/discussions/2611</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:20 UTC
    </footer>
</body>
</html>
