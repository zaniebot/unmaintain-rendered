<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Follow symlinks by default - BurntSushi/ripgrep #692</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Follow symlinks by default</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/692">#692</a>
        opened by <a href="https://github.com/ChengCat">@ChengCat</a>
        on 2017-11-27 02:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ChengCat">@ChengCat</a></div>
            <div class="timeline-body"><p>It is a very surprising behavior to not follow symlinks by default. It could lead to unnoticed errors when the correctness is depended upon. I read through the issues, and there are other people also encountering issues related to this.</p>
<p>I understand that following symlinks can impact performance, but I don&#x27;t think the default trade-off should be sacrificing reliability for performance. We could make not following symlinks an optional flag when extra performance is needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2017-11-27 02:31</div>
            <div class="timeline-body"><p>Not following symlinks is the default behaviour of almost all traditional UNIX CLI tools that work on files, including notably <code>find</code>, <code>grep</code>, and <code>ag</code>, so i think one could make a strong case that that is the least surprising behaviour.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-11-27 02:40</div>
            <div class="timeline-body"><p>@okdana is right. Not following symlinks is the default behavior for Unix tools. If you want to follow symlinks by default, then add the -L switch to an rg alias.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-11-27 02:40</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ChengCat">@ChengCat</a> on 2017-11-27 02:54</div>
            <div class="timeline-body"><p>As the traditional alternative of ripgrep, <code>grep</code> doens&#x27;t search recursively by default, but provides two flags <code>-R</code> and <code>-r</code> for searching recursively with symlinks followed and not followed. I&#x27;d say <code>-R</code> is &#x27;more default&#x27;, since recursion is usually indicated by &#x27;-R&#x27;. I don&#x27;t even know about <code>-r</code> before, and have always used <code>-R</code>.</p>
<p>Moreover, I don&#x27;t think the default behavior for Unix tools matters here. I expect <code>ripgrep</code> to be a modern alternative to <code>grep</code>, and this gives us the opportunity to rethink about this. Those related issues reported by others indicate that this behavior is actually surprising.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-11-28 02:14</div>
            <div class="timeline-body"><p>I&#x27;m finally back from vacation and have a bit more time to respond to this.</p>
<p>First and foremost, in my own personal experience, I very rarely see anyone use <code>grep -R</code>, but rather <code>grep -r</code>. Before I wrote ripgrep, I used plain old grep for searching code repositories. I had a script named <code>grepfr</code> in my <code>$HOME/bin</code> for many many years:</p>
<pre><code>#!/bin/bash

first=$1
shift
grep -nrHIF &quot;$first&quot; $@
</code></pre>
<p>And this is pretty consistent with similar shortcuts that I&#x27;ve seen other people use.</p>
<p>Now with that said, I very much believe that reasonable people can disagree on this matter. I could easily argue both sides of this particular issue myself. In one sense, symlinks are just an implementation detail that otherwise should be treated as a normal part of a directory tree. In another sense, symlinks are typically not followed by standard tools by default, which in turn creates an expectation that other tools will behave the same. Therefore, it&#x27;s quite difficult to make the &quot;surprising&quot; argument here, because either side of this is surprising depending on your prior.</p>
<p>As a more personal anecdote, I&#x27;d like to note that if ripgrep did follow symlinks by default, then I personally would actually wind up disabling that behavior behind an alias because I typically don&#x27;t want to follow symlinks based on my use of them. My use of symlinks tend to be as shortcuts to various parts of my home directory or nas, and therefore if ripgrep searched them, then it would wind up showing duplicate results or worse, irrelevant results. I don&#x27;t know if others have a similar setup as me, but it wouldn&#x27;t surprise me, and in particular, the duplicate result problem is pretty annoying which is another reason for symbolic link following to be behind a flag. (You might see this as an invitation to in turn solve the duplicate result problem, but that&#x27;s just another type of behavior that standard tooling doesn&#x27;t do and would likely have performance implications along the lines of &quot;store data proportional to the directory tree that is being searched.&quot;)</p>
<p>My own tendencies are to be conservative in the presence of a choice that has no obvious answer because the conservative path is typically quite obvious, and indeed, in this case, the obvious conservative path is to do what standard Unix tooling has done for eons: don&#x27;t follow symbolic links by default, but provide a flag that does it for you.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ChengCat">@ChengCat</a> on 2017-11-28 02:32</div>
            <div class="timeline-body"><p>Thanks for the reply. This is pretty reasonable. I actually do prefer solving the duplication problem by sacrificing performance, and this is from the idea that implementation details should be hidden from users at all cost.</p>
<p>I would show my use case, as that may help. I am using NixOS, which in turn uses symlinks extensively across the whole system. Many config files in /etc are symlinks. Not including symlinks is probably not what I want when I am dealing with NixOS files.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ChengCat">@ChengCat</a> on 2017-11-28 06:19</div>
            <div class="timeline-body"><p>After reconsidering about the duplication problem, IMO a separate option to enable symlink deduplication would be better. A simple way to understand a file system with symlinks is: there are no symlinks, and all original symlinks are expanded.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/snan">@snan</a> on 2026-01-02 23:47</div>
            <div class="timeline-body"><p>Just FWIW, <code>grep stuff*</code> does find stuff in symlinked files. As does <code>rg stuff *</code>, of course, but normally I don&#x27;t provide file arguments to ripgrep the way I normally do with grep where I&#x27;m way more likely to grep in <code>*</code> than in either <code>-R .</code> or <code>-r .</code>. Standard anecdata disclaimer and I&#x27;m not trying to relitigate or reopen this issue; it&#x27;s just one more data point or perspective in case this comes up again down the road.</p>
<p>I will say that I was very baffled why rg wouldn&#x27;t find certain strings (it turned out that those strings were in files that were symlinks, which was kinda tricky to figure out. Thanks for <code>--debug</code>, that helped) and I immediatedly added <code>--follow</code> to my deadgrep settings for <code>rg</code> arguments.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:05 UTC
    </footer>
</body>
</html>
