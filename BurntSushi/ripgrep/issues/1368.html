<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>support empty alternate glob patterns - BurntSushi/ripgrep #1368</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>support empty alternate glob patterns</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1368">#1368</a>
        opened by <a href="https://github.com/StaticPH">@StaticPH</a>
        on 2019-09-07 22:41
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/StaticPH">@StaticPH</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>ripgrep 11.0.2
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p>Installed with cargo</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>Windows 8.1 Pro (x86_64)
If it's relevant, I'm also using the latest version of msys2-x86_64</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>Bash and ripgrep evaluate globs differently, which seems like a bug to me.
If this behavior is actually intended, I'd like help finding a glob pattern that will give the result bash does for my test pattern.</p>
<h4>If this is a bug, what are the steps to reproduce the behavior?</h4>
<p>In a directory I have 5 files containing only the string 'qwertyuiop'
The files are named:
<code>'.foo'  '.foo_baz'  'bar.foo'  'baz.foo_bar'  'SHOULD_NOT_BE_GLOBBED'</code></p>
<p>I do not have any .ignore-like files, am not instructing ripgrep to use a configuration file, and have not set <code>RIPGREP_CONFIG_PATH</code></p>
<p>The glob pattern I am using for this test is <code>{*,}.foo{_*,}</code>
The regex is simply &quot;\D&quot;, which should match every character in the 5 files</p>
<h4>If this is a bug, what is the actual behavior?</h4>
<p>See https://gist.github.com/StaticPH/c52d9ddee8a1a43a23196f5f46f1503e</p>
<h4>If this is a bug, what is the expected behavior?</h4>
<p>Simply calling <code>echo {*,}.foo{_*,}</code> in bash prints out <code>baz.foo_bar bar.foo .foo_baz .foo</code>, so I would have expected both</p>
<pre><code>~/.cargo/bin/rg -uu --type-add 'foo: {*,}.foo{_*,}' -tfoo &quot;\D&quot;
and
~/.cargo/bin/rg -uu -g '{*,}.foo{_*,}' &quot;\D&quot;
</code></pre>
<p>to output</p>
<pre><code>.foo_baz
1:qwertyuiop

.foo
1:qwertyuiop

bar.foo
1:qwertyuiop

baz.foo_bar
1:qwertyuiop
</code></pre>
<p>and for</p>
<pre><code>~/.cargo/bin/rg -uu --type-add 'foo:{*,}.foo{_*,}' -Tfoo --debug &quot;\D&quot;
</code></pre>
<p>to output</p>
<pre><code>SHOULD_NOT_BE_GLOBBED
1:qwertyuiop
</code></pre>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/StaticPH">@StaticPH</a> on 2019-09-07 22:45</div>
            <div class="timeline-body"><p>Possibly related to globbing behavior mentioned in https://github.com/BurntSushi/ripgrep/issues/1221 ?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2019-09-07 23:02</div>
            <div class="timeline-body"><p>That ticket seems only tangentially related. I think your problem here is related to the fact that ripgrep just drops empty alternates, so where you're expecting for example <code>{_*,}</code> to be converted to something like <code>(_[^/]*|)</code> (or technically <code>(_[^/]*)?</code>, since the underlying regex engine doesn't support empty alternates itself), it's actually converting it to <code>_[^/]*</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "ripgrep's globbing doesn't match that of bash" to "support empty alternate glob patterns" by @BurntSushi on 2020-05-08 11:35</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">enhancement</span> added by @BurntSushi on 2020-05-08 11:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:00 UTC
    </footer>
</body>
</html>
