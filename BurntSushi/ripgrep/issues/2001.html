<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[globset] supporting paths with Windows separators - BurntSushi/ripgrep #2001</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[globset] supporting paths with Windows separators</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2001">#2001</a>
        opened by <a href="https://github.com/sunshowers">@sunshowers</a>
        on 2021-09-23 18:16
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/sunshowers">@sunshowers</a></div>
            <div class="timeline-body"><h4>Describe your feature request</h4>
<p>Hi Andrew! Thanks for all your wonderful crates.</p>
<p>I noticed that <code>globset</code> currently seems to have certain Unix assumptions baked in, such as <code>literal_separator</code> only excluding <code>/</code> and not <code>\</code>.</p>
<p>I'm wondering if it would be possible to run it in a mode where it supports Windows paths, without having the path converted from <code>\</code> to <code>/</code>. The general approach I'm thinking is:</p>
<ul>
<li>globs are still provided in Unix format with <code>/</code> path separators.</li>
<li><code>literal_separator</code> is turned on.</li>
<li>a new config <code>match_backslash_separator</code> is provided (people can turn it on on <code>#[cfg(windows)]</code>, or maybe it could take an enum with values like <code>Never</code>, <code>OnWindows</code>, <code>Always</code>).</li>
<li>internally, <code>globset</code> converts <code>/</code> in the glob to <code>[/\\]</code> in the regex, and makes it so that <code>literal_separator</code> doesn't match either <code>/</code> or <code>\</code>.</li>
</ul>
<p>I might have missed something but I believe this should work. (It could also run in a &quot;canonical Windows path&quot; mode, where <code>/</code> in the glob <em>only</em> matches <code>\</code> in the string, but I'm not sure if there's a good use case for that.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-09-23 18:19</div>
            <div class="timeline-body"><p>I think there might be a ticket for this already.</p>
<p>In general, I'm not opposed to this, but I don't know when it's going to happen. The globbing/gitignore code is pretty hairy and one of the more common source of ripgrep bugs. So even just reviewing changes to it is difficult.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sunshowers">@sunshowers</a> on 2021-09-23 18:22</div>
            <div class="timeline-body"><p>Thanks! (I tried looking for a ticket but I couldn't find one -- totally might have missed it.)</p>
<p>I'm happy to give it a go if that works for you -- I have some experience in this area from working on source control.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/milesj">@milesj</a> on 2022-02-23 07:18</div>
            <div class="timeline-body"><p>@sunshowers Seeing as how this hasn't landed yet, how are y'all using globs for windows targets? Converting everything to <code>/</code> first?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/sunshowers">@sunshowers</a> on 2022-02-23 07:19</div>
            <div class="timeline-body"><p>Yes, I've come to believe that using / as the canonical relative path separator, and \ as the canonical absolute path separator, makes the most sense on Windows.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Habetdin">@Habetdin</a> on 2023-08-26 11:58</div>
            <div class="timeline-body"><p>I support the idea of adding a possibility to canonize the file paths because currently rg on Windows produces mixed-separator paths sometimes:</p>
<pre><code class="language-sh"># rg guid Sample/Dir0
Sample/Dir0\Dir1\File.meta
2:guid: 550e8400e29b41d4a716446655440000
</code></pre>
<p>@BurntSushi may be there should be option for choosing preferred path separator for the output? Like <code>OS native</code> (default), <code>Unix style</code>, <code>Windows style</code> (not sure about having the latter)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-08-26 12:03</div>
            <div class="timeline-body"><p>@Habetdin I'm not sure if this ticket is really what you want here. This ticket is about a <code>globset</code> (a library used by ripgrep) feature.</p>
<p>Otherwise, ripgrep is printing a mixed path because you're using it on a system whose native path separator is <code>\</code> but you've provided a file path using <code>/</code>. You can set the path separator that ripgrep uses with the <code>--path-separator</code> flag.</p>
<p>If you have a follow up, please don't pollute this issue. Please <a href="https://github.com/BurntSushi/ripgrep/discussions/">ask a question</a> instead.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:26 UTC
    </footer>
</body>
</html>
