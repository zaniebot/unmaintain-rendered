<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>`--hyperlink-format-no-line-number` for just file path without line number (from `--heading`) - BurntSushi/ripgrep #3197</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1><code>--hyperlink-format-no-line-number</code> for just file path without line number (from <code>--heading</code>)</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/3197">#3197</a>
        opened by <a href="https://github.com/wind0204">@wind0204</a>
        on 2025-10-21 08:04
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/wind0204">@wind0204</a></div>
            <div class="timeline-body"><p>Hello!</p>
<p>I would love to have <code>ripgrep</code> write a hyperlink in a different format when there is no line number information for the line, instead of writing 1 in the place of the line number or column number using the same <code>--hyperlink-format</code> format</p>
<p>I could imagine issuing a command sequence like this:</p>
<pre><code>$ rg  --line-number --heading --hyperlink-format='myeditor:////{path}:{line}:{column}' --hyperlink-format-no-line-number='myeditor:////{path}
filepath
(hyperlink: myeditor://filepath)
linenr:columnnr:file_content
(hyperlink: myeditor://filepath:linenr:columnnr)
</code></pre>
<p>Opening the hyperlink for the heading would make <code>vim</code> open the file and go to the last cursor position that it has recorded in the <code>.viminfo</code> file. This behavior would be very nice to see!</p>
<p>The status quo:</p>
<pre><code>$ rg  --line-number --heading --hyperlink-format='myeditor:////{path}:{line}:{column}'
filepath
(hyperlink: myeditor://filepath:1:1)
linenr:columnnr:file_content
(hyperlink: myeditor://filepath:linenr:columnnr)
</code></pre>
<p>In this case, opening the hyperlink for the heading would make <code>vim</code> open the file and overwrite the last cursor position in the <code>.viminfo</code> file that might have been useful to me.</p>
<p>Thank you so much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-10-21 11:05</div>
            <div class="timeline-body"><p>I understand the request and I get why you want it, but I'm not adding more flags for this. ripgrep's output is not meant to be arbitrarily customizable. Sorry.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2025-10-21 11:05</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by @BurntSushi on 2025-10-21 11:05</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2025-10-21 11:41</div>
            <div class="timeline-body"><p>Just some thoughts:</p>
<p>We could trim everything after <code>{path}</code> in the format string, but I'm afraid this wouldn't be reliable enough. Or add a second pattern to the same format string after a separator, but I don't really like the idea either.</p>
<p>That being said, it would be easy to add a second pattern to the <a href="https://github.com/BurntSushi/ripgrep/blob/master/crates/printer/src/hyperlink/aliases.rs"><em>built-in</em> aliases</a>, but vim doesn't have any because AFAIK there's no standard way to open vim through a hyperlink.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wind0204">@wind0204</a> on 2025-10-21 11:49</div>
            <div class="timeline-body"><blockquote>
<p>We could trim everything after {path} in the format string, but I'm afraid this wouldn't be reliable enough. Or add a second pattern to the same format string after a separator, but I don't really like the idea either.</p>
</blockquote>
<p>Yeah, I guess trimming after <code>{path}</code> would be totally fine for most users, including me.</p>
<p>In a rare case some people might need something like this in, my wild imagination:
<code>--hyperlink-format='{default_format=myeditor:////{path}:{line}:{column}@{host}},{heading_format=myeditor:////{path}@{host}}'</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/wind0204">@wind0204</a> on 2025-10-21 12:08</div>
            <div class="timeline-body"><blockquote>
<p>That being said, it would be easy to add a second pattern to the <a href="https://github.com/BurntSushi/ripgrep/blob/master/crates/printer/src/hyperlink/aliases.rs">built-in aliases</a>, but vim doesn't have any because AFAIK there's no standard way to open vim through a hyperlink.</p>
</blockquote>
<p>I just saw the code in <code>crates/printer/src/hyperlink/aliases.rs</code> to find out that macvim has a way to handle a special URL format <code>mvim://open?url=file://{path}&amp;line={line}&amp;column={column}</code></p>
<p>And I can guess that macvim can remember the last cursor location like the traditional vim; And the feature I requested can benefit the users of macvim too, or at least a few future users..</p>
<p>Here's how I make my own solution:</p>
<p>~/.vim/vimrc:</p>
<pre><code class="language-vim">    &quot; When editing a file, always jump to the last known cursor position.
    &quot; Don't do it when the position is invalid or
    &quot; when inside an event handler (happens when dropping a file on gvim).
    autocmd BufWinEnter *
    \ if line(&quot;'\&quot;&quot;) &gt; 1 | 
    \   if line(&quot;'\&quot;&quot;) &gt; line(&quot;$&quot;) |
    \     exe &quot;normal! ggj&quot; |
    \   else |
    \     exe &quot;normal! G&quot; |
    \     if line(&quot;'\&quot;&quot;) == line(&quot;$&quot;) &amp;&amp; col(&quot;'\&quot;&quot;) &gt; col(&quot;$&quot;) |
    \         call setpos(&quot;'\&quot;&quot;, [0,line(&quot;'\&quot;&quot;),1,0]) |
    \         exe &quot;normal! g'\&quot;&quot; |
    \     else |
    \       exe &quot;normal! g`\&quot;&quot; |
    \     endif |
    \   endif |
    \ endif
</code></pre>
<p>~/bin/summon_editor.sh:</p>
<pre><code class="language-sh">#!/bin/sh

file_to_open=&quot;$(echo $1 | sed -nre 's/^.+:\/\/([^:]+).*/\1/p')&quot;
line_nr=&quot;$(echo $1 | sed -nre 's/^.+:\/\/([^:]+)(:([^:]+))?(:([^:]+))?/\3/p')&quot;
column_nr=&quot;$(echo $1 | sed -nre 's/^.+:\/\/([^:]+)(:([^:]+))?(:([^:]+))?/\5/p')&quot;

if [ -z &quot;$column_nr&quot; ]; then
  if [ -z &quot;$line_nr&quot; ]; then
    $EDITOR $file_to_open
  else
    $EDITOR &quot;+${line_nr}&quot; $file_to_open
  fi
else
  $EDITOR &quot;+${line_nr}&quot; -c &quot;norm!$(expr $column_nr - 1)l&quot; $file_to_open
fi
</code></pre>
<p>~/.local/share/applications/myeditor.desktop:</p>
<pre><code class="language-desktop">[Desktop Entry]
Name=Summon my editor
Comment=Opens a file at a specific line
Exec=summon_editor.sh %u
Terminal=true
Type=Application
Categories=Utility;TextEditor;
StartupNotify=false
MimeType=text/english;text/plain;text/x-makefile;text/x-c++hdr;text/x-c++src;text/x-chdr;text/x-csrc;text/x-java;text/x-moc;text/x-pascal;text/x-tcl;text/x-tex;application/x-shellscript;text/x-c;text/x-c++;x-scheme-handler/myeditor;
</code></pre>
<p>~/.config/mimeapps.list:</p>
<pre><code class="language-mimeapps.list">x-scheme-handler/myeditor=myeditor.desktop
</code></pre>
<p>ripgrep:</p>
<pre><code class="language-sh">rg --hyperlink-format='myeditor:////{path}:{line}:{column}'
</code></pre>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:59 UTC
    </footer>
</body>
</html>
