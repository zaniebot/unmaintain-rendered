<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>document Windows locale and path separator settings - BurntSushi/ripgrep #1667</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>document Windows locale and path separator settings</h1>

    <div class="meta">
        <span class="state-icon state-open"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1667">#1667</a>
        opened by <a href="https://github.com/SandraEickel">@SandraEickel</a>
        on 2020-08-27 12:12
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/SandraEickel">@SandraEickel</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<p>ripgrep 12.1.1 (rev 7cb211378a)
-SIMD -AVX (compiled)
+SIMD -AVX (runtime)</p>
How did you install ripgrep?
<p>Unzipped Windows 64 bit versions (both MSVC and GNU behave identical, using MSVC).</p>
What operating system are you using ripgrep on?
<p>Windows 10 Pro
Build 18362.19h1_release.190318-1202</p>
Describe your bug.
<p>Inconsistent output of umlauts on Windows depending on running ripgrep from CMD or Git Bash.</p>
What are the steps to reproduce the behavior?
<p>Both shells are configured to use Lucida Console font.</p>
<p><strong>Using standard CMD (PowerShell not tested):</strong>
cd ripgrep-test</p>
<p>type subdir\ExampleWithUmlauts.cs</p>
<ul>
<li>Displays garbled umlauts</li>
</ul>
<p>rg SubjectCodes</p>
<ul>
<li>Displays file name with Windows-like backslash</li>
<li>Displays correct umlauts</li>
</ul>
<p><strong>Using Git Bash (MINGW64):</strong>
cd ripgrep-test</p>
<p>cat subdir/ExampleWithUmlauts.cs</p>
<ul>
<li>Displays correct umlauts</li>
</ul>
<p>rg SubjectCodes</p>
<ul>
<li>Displays file name with unwanted backslash instead for UNIX-like (forward) slash</li>
<li>Displays garbled umlauts</li>
</ul>
What is the actual behavior?
<p>CMD:</p>
<pre><code>C:\Users\Sandra.Eickel\Documents\ripgrep-test&gt;type subdir\ExampleWithUmlauts.cs
namespace ZUGFeRD_Test
{
    class ZugFerd1ExtendedWarenrechnungGenerator
    {
        private InvoiceDescriptor _generateDescriptor()
        {
            desc.AddNote(&quot;Es bestehen Rabatt- oder Bonusvereinbarungen.&quot;, SubjectCodes.AAK, ContentCodes.ST3);
            desc.AddNote(&quot;Der Verk├ñufer bleibt Eigent├╝mer der Waren bis zu vollst├ñndigen Erf├╝llung der Kaufpreisforderung.&quot;, SubjectCodes.AAJ, ContentCodes.EEV);
            desc.AddNote(&quot;MUSTERLIEFERANT GMBH BAHNHOFSTRASSE 99 99199 MUSTERHAUSEN Gesch├ñftsf├╝hrung: Max Mustermann USt-IdNr: DE123456789 Telefon: +49 932 431 0 www.musterlieferant.de HRB Nr. 372876 Amtsgericht Musterstadt GLN 4304171000002 WEEE-Reg-Nr.: DE87654321&quot;,
                         SubjectCodes.REG);
            desc.AddNote(&quot;Leergutwert: 46,50&quot;);
        };
    }
}

C:\Users\Sandra.Eickel\Documents\ripgrep-test&gt;rg --debug SubjectCodes
DEBUG|grep_regex::literal|crates\regex\src\literal.rs:58: literal prefixes detected: Literals { lits: [Complete(SubjectCodes)], limit_size: 250, limit_class: 10 }
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, subdir\ExampleWithUmlauts.cs
7:            desc.AddNote(&quot;Es bestehen Rabatt- oder Bonusvereinbarungen.&quot;, SubjectCodes.AAK, ContentCodes.ST3);
8:            desc.AddNote(&quot;Der Verkäufer bleibt Eigentümer der Waren bis zu vollständigen Erfüllung der Kaufpreisforderung.&quot;, SubjectCodes.AAJ, ContentCodes.EEV);
10:                         SubjectCodes.REG);
12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
</code></pre>
<p>Git Bash:</p>
<pre><code>$ cat subdir/ExampleWithUmlauts.cs
namespace ZUGFeRD_Test
{
    class ZugFerd1ExtendedWarenrechnungGenerator
    {
        private InvoiceDescriptor _generateDescriptor()
        {
            desc.AddNote(&quot;Es bestehen Rabatt- oder Bonusvereinbarungen.&quot;, SubjectCodes.AAK, ContentCodes.ST3);
            desc.AddNote(&quot;Der Verkäufer bleibt Eigentümer der Waren bis zu vollständigen Erfüllung der Kaufpreisforderung.&quot;, SubjectCodes.AAJ, ContentCodes.EEV);
            desc.AddNote(&quot;MUSTERLIEFERANT GMBH BAHNHOFSTRASSE 99 99199 MUSTERHAUSEN Geschäftsführung: Max Mustermann USt-IdNr: DE123456789 Telefon: +49 932 431 0 www.musterlieferant.de HRB Nr. 372876 Amtsgericht Musterstadt GLN 4304171000002 WEEE-Reg-Nr.: DE87654321&quot;,
                         SubjectCodes.REG);
            desc.AddNote(&quot;Leergutwert: 46,50&quot;);
        };
    }
}

$ rg --debug SubjectCodes
DEBUG|grep_regex::literal|crates\regex\src\literal.rs:58: literal prefixes detected: Literals { lits: [Complete(SubjectCodes)], limit_size: 250, limit_class: 10 }
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|crates\globset\src\lib.rs:431: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
subdir\ExampleWithUmlauts.cs
7:            desc.AddNote(&quot;Es bestehen Rabatt- oder Bonusvereinbarungen.&quot;, SubjectCodes.AAK, ContentCodes.ST3);
8:            desc.AddNote(&quot;Der Verk├ñufer bleibt Eigent├╝mer der Waren bis zu vollst├ñndigen Erf├╝llung der Kaufpreisforderung.&quot;, SubjectCodes.AAJ, ContentCodes.EEV);
10:                         SubjectCodes.REG);
</code></pre>
What is the expected behavior?
<p>While it is nice that it produces readable umlauts when run from CMD, the behaviour when run via Git Bash is not that helpful. It should output readable umlauts and it should print paths with UNIX-like slashes instead of problematic backslashes, including support for drives like &quot;/c/path&quot; for &quot;C:\path&quot;.
I did not test with paths containing spaces or umlauts, which - at least for spaces - might have to be treated differently depending on the environment ...</p>
<p><a href="https://github.com/BurntSushi/ripgrep/files/5136139/ripgrep-test.zip">ripgrep-test.zip</a></p>
<p>See also #234 and #530 - even if those refer to file name globbing differences.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 13:13</div>
            <div class="timeline-body"><p>I don&#x27;t think this is a bug with ripgrep. It&#x27;s almost certainly some kind of misconfiguration of your locale settings in Git Bash. You might try running the <code>locale</code> command and pasting the output here. From ripgrep&#x27;s perspective, files are just bytes and it prints them as is. Your shell and terminal emulator are responsible for rendering them, not ripgrep. You could potentially demonstrate this as a ripgrep bug if you could show that the bytes emitted by ripgrep are different.</p>
<blockquote>
<p>It should output readable umlauts and it should print paths with UNIX-like slashes instead of problematic backslashes, including support for drives like &quot;/c/path&quot; for &quot;C:\path&quot;.</p>
</blockquote>
<p>It&#x27;s Windows and Windows uses backslashes. So that&#x27;s what ripgrep uses. AIUI, things like <code>/c/path</code> are specifically cygwin constructs, not Windows constructs, and there is no easy way for ripgrep to &quot;just do what cygwin does.&quot; There are many issues in this space: https://github.com/BurntSushi/ripgrep/search?q=windows+cygwin+path&amp;type=Issues And in particular, see this issue: <a href="https://github.com/BurntSushi/ripgrep/issues/275">BurntSushi/ripgrep#275</a> which was resolved by adding a <code>--path-separator</code> flag to ripgrep. It sounds like that&#x27;s what you want.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 13:13</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/SandraEickel">@SandraEickel</a> on 2020-08-27 16:10</div>
            <div class="timeline-body"><p>Thanks for your hint with the path separator from #275.</p>
<p>For the other problem with garbled umlauts I found a solution at <a>https://superuser.com/questions/269818/change-default-code-page-of-windows-console-to-utf-8/1435645#1435645</a>.</p>
<p>As probably many other users of ripgrep with a UNIX-like environment like CygWin or MingW64 Git Bash are affected, these solutions should be mentioned in FAQ.md (for umlaut problem) or even in README.md (for alias).</p>
<p>Suggested text:</p>
<p>Define an alias for rg which generates (forward) slashes instead of backslashes:
<code>alias rg=&quot;rg --path-separator //&quot;</code>
Double slash to prevent (at least) Git bash from doing single slash magic.</p>
<p>If your files contain UTF-8 encoded umlauts or other non-ASCII characters (and rg in Bash does not display them nicely), you can enable a beta feature of Windows 10. This fixes issue #1667 but might cause unwanted side effects for other software.</p>
<p>English system:
&quot;Start&quot; -&gt; &quot;Settings&quot; -&gt; &quot;Time and Language&quot; -&gt; &quot;Language settings&quot; -&gt; &quot;Administrative language settings&quot;., Click &quot;Change system locale...&quot;
Check &quot;Beta: Use Unicode UTF-8 for worldwide language support&quot; box.
Click OK and restart your pc.</p>
<p>German system:
&quot;Start&quot; -&gt; &quot;Einstellungen&quot; -&gt; &quot;Zeit und Sprache&quot; -&gt; &quot;Sprache&quot; -&gt; &quot;Administrative Sprachoptionen&quot;.
A new window opens, you are on tab &quot;Verwaltung&quot;.
Click on &quot;Gebietsschema ändern&quot;.
Mark &quot;Beta: Unicode UTF-8 für die Unterstützung weltweiter Sprachen&quot; checkbox.
Click OK and reboot.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">doc</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 16:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> removed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 16:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;Inconsistent Umlaut output Windows CMD vs. Git Bash&quot; to &quot;document Windows locale and path separator settings&quot; by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 16:20</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Reopened by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 16:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 16:21</div>
            <div class="timeline-body"><p>Aye, better docs here would be great. Thanks for the idea and the text!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">help wanted</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-08-27 16:21</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-25 19:04</div>
            <div class="timeline-body"><p>If someone wants to open a PR to improve the FAQ for ripgrep here that would be great. Otherwise I don&#x27;t quite feel qualified to write this myself.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:10 UTC
    </footer>
</body>
</html>
