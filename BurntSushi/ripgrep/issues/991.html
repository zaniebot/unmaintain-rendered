<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ripgrep freezes Linux PC - BurntSushi/ripgrep #991</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ripgrep freezes Linux PC</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/991">#991</a>
        opened by <a href="https://github.com/jovere">@jovere</a>
        on 2018-07-23 22:01
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jovere">@jovere</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>ripgrep 0.8.1 (rev c8e9f25b85)
-SIMD -AVX</p>
<h4>How did you install ripgrep?</h4>
<p>Came as a module with VSCode (https://github.com/Microsoft/vscode)</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>Linux x64 4.10.0-20-generic
Ubuntu 16.04 LTS</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>When running a search on a directory of many many files using <code>rg</code>, the entire system, except for mouse movement freezes.  If I'm quick enough and attempt to kill <code>rg</code>, it results in a zombie process while all the child processes continue running forever.  I don't use <code>rg</code> under normal circumstances, but it is apparently bundled with vscode.  I'm doing a search through the Qt source code base, as stated in the VSCode issue below.</p>
<p>@roblourens suggested I post a bug report here in the following issue https://github.com/Microsoft/vscode/issues/54730.</p>
<p>Show the command you ran and the actual output. Include the <code>--debug</code> flag in
your invocation of ripgrep.</p>
<p><code>/usr/share/code/resources/app/node_modules.asar.unpacked/vscode-ripgrep/bin/rg --no-ignore --debug &quot;QT_QPA_EGLFS_INTEGRATION&quot; Qt/5.9.6/Src</code></p>
<p>I apologize for the horrible camera picture, but once it &quot;hangs&quot;, I can't start any new processes.  If I try to do an <code>ls</code> in a separate console window, nothing happens.  I can't shut down except for hard resetting the machine.</p>
<p>If the output is large, put it in a gist:  https://gist.github.com/jovere/47fd22f6caad3c28a27915528e6a6c55
<a href="url">
<img src="https://user-images.githubusercontent.com/10420943/43104576-89d90f00-8e97-11e8-9942-8adc51eeda5a.jpg" alt="screenshot" />
</a></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-23 22:24</div>
            <div class="timeline-body"><p>Exciting! Can you tell me how exactly to get a checkout of the code you're searching? I mean, I realize it's Qt, but what are the exact commands I should be running? (There are many Qt repos in my Google search results.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-23 22:26</div>
            <div class="timeline-body"><p>See also #975, which produces a similar symptom, but on macOS.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-23 22:29</div>
            <div class="timeline-body"><p>My guess is this is the repo: https://github.com/qt/qt5</p>
<p>I ran</p>
<pre><code>$ git clone git://github.com/qt/qt5 --recursive
</code></pre>
<p>will that get me into the same state you're in?</p>
<p>Looking at <code>htop</code>, it is interesting that all of your cores appear to be pegged while executing kernel code (assuming the red means &quot;sys&quot; time). That suggests <code>strace</code> might show something interesting.</p>
<p>Another thing to try is to run ripgrep in single threaded mode, to see if that fairs any better. You can force that with <code>-j1</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-23 22:40</div>
            <div class="timeline-body"><p>Sadly, nothing interesting happens when searching that repo on my system. It finishes in about <code>350ms</code> and uses a maximum heap size of ~100MB. Running single threaded finishes in about <code>2.3s</code> with a maximum heap size of ~24MB.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">question</span> added by @BurntSushi on 2018-07-24 12:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jovere">@jovere</a> on 2018-07-24 13:09</div>
            <div class="timeline-body"><p>Thank you for noticing the CPU time being kernel time (would explain why the entire system is brought to its knees).  I updated to the latest kernel available for Ubuntu 16.04 (4.15.0-29-generic) and it finishes nearly instantaneously.  Hopefully this doesn't result in any other issues.
Thanks!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @jovere on 2018-07-24 13:09</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-24 13:21</div>
            <div class="timeline-body"><p>Wow. Does this mean ripgrep tripped over a kernel bug? That's pretty cool. I'd love to know what it was.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/jovere">@jovere</a> on 2018-07-24 13:31</div>
            <div class="timeline-body"><p>I don't think it's pretty cool... It's been a thorn in my side for the last few days.  I think I've gone through at least a dozen resets.</p>
<p>If you're masochistic, the version was 4.10.0-20.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:37 UTC
    </footer>
</body>
</html>
