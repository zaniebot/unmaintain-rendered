<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ripgrep doesn't seem to work with .tar.xz - BurntSushi/ripgrep #1060</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ripgrep doesn't seem to work with .tar.xz</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1060">#1060</a>
        opened by <a href="https://github.com/upsuper">@upsuper</a>
        on 2018-09-21 12:32
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/upsuper">@upsuper</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>ripgrep 0.10.0
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p>Homebrew prebuilt binary.</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>macOS 10.13.6</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>I tried to use <code>rg -z</code> to search text in a directory filled with <code>.tar.xz</code> files, but it finds nothing. I tried to use <code>xz</code> to uncompress a file into <code>.tar</code> and it still doesn't find anything. If I use <code>tar</code> to extract all files in the package, then <code>rg</code> can find the text from several files in the package.</p>
<p>It doesn't work even when I explicitly put the file in the command line.</p>
<p>I can confirm that <code>xz</code> and <code>tar</code> are all in my PATH.</p>
<h4>If this is a bug, what are the steps to reproduce the behavior?</h4>
<p>Just <code>rg -z &quot;some content&quot;</code>, and it lists nothing.</p>
<h4>If this is a bug, what is the actual behavior?</h4>
<p><code>rg -z 'David' --debug</code> gives:</p>
<pre><code>DEBUG|grep_regex::literal|grep-regex/src/literal.rs:58: literal prefixes detected: Literals { lits: [Complete(David)], limit_size: 250, limit_class: 10 }
DEBUG|globset|globset/src/lib.rs:424: glob converted to regex: Glob { glob: &quot;*.xcodeproj/xcuserdata&quot;, re: &quot;(?-u)^[^/]*\\.xcodeproj/xcuserdata$&quot;, opts: GlobOptions { case_insensitive: false, literal_separator: true, backslash_escape: true }, tokens: Tokens([ZeroOrMore, Literal('.'), Literal('x'), Literal('c'), Literal('o'), Literal('d'), Literal('e'), Literal('p'), Literal('r'), Literal('o'), Literal('j'), Literal('/'), Literal('x'), Literal('c'), Literal('u'), Literal('s'), Literal('e'), Literal('r'), Literal('d'), Literal('a'), Literal('t'), Literal('a')]) }
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 3 basenames, 0 extensions, 0 prefixes, 0 suffixes, 3 required extensions, 1 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
DEBUG|globset|globset/src/lib.rs:429: built glob set; 0 literals, 0 basenames, 8 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
</code></pre>
<h4>If this is a bug, what is the expected behavior?</h4>
<p>It should be able to find the content in the tar.xz packages.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-09-21 12:38</div>
            <div class="timeline-body"><p>ripgrep doesn't open archive files. It searches them like any other file. Archives are generally detected as binary files pretty quickly, so if you just want to search the raw data of an archive, then you should use the <code>-a</code> flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2018-09-21 12:38</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-09-21 12:38</div>
            <div class="timeline-body"><p>(I plan to improve how ripgrep handles binary files, in particular, showing better log messages. But I haven't gotten around to it yet. I suspect that once that lands, the <code>--debug</code> log would have made it clear that ripgrep is searching your archive but is quitting early because it detects it as binary data.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/upsuper">@upsuper</a> on 2018-09-21 12:41</div>
            <div class="timeline-body"><p>Hmm, okay, that works, thanks.</p>
<p>I guess it would be great if you can also go through archives like directories. <code>tar</code> crate should be pretty solid to use for this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-09-21 12:45</div>
            <div class="timeline-body"><p>You could probably hack something together with ripgrep's <code>--pre</code> and <code>--pre-glob</code> flags. But yeah, otherwise there are no plans to add explicit archive support.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-09-21 12:51</div>
            <div class="timeline-body"><p>Actually, the <code>tar</code> crate does look pretty good. I hadn't looked carefully at it yet. It looks like it would be fairly easy to use.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:41 UTC
    </footer>
</body>
</html>
