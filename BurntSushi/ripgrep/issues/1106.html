<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>--files-without-match reports an error when used with a single file path - BurntSushi/ripgrep #1106</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>--files-without-match reports an error when used with a single file path</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1106">#1106</a>
        opened by <a href="https://github.com/ShadowIce">@ShadowIce</a>
        on 2018-11-14 17:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ShadowIce">@ShadowIce</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<p>ripgrep 0.10.0
-SIMD -AVX (compiled)</p>
<h4>How did you install ripgrep?</h4>
<p>cargo install ripgrep</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>Windows 10</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>I'm trying to get a list of files that contain one word, but not another word. To do that I call &quot;rg -l foo&quot; to get a list of files that I pass on to another call with &quot;rg --files-without-match bar&quot;. The call looks something like this: rg -l foo | xargs -i -d '\n' rg --files-without-match bar {}</p>
<p>This doesn't work because --files-without-match cannot be used with a single file. The error message is &quot; output kind PathWithoutMatch requires a file path&quot;. However I don't understand why that shouldn't be possible.
Maybe there's a better way to do this? If not I'd really appreciate it if that could be implemented.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-11-14 17:12</div>
            <div class="timeline-body"><p>Please provide a fully reproducible example, which should include a corpus
to search.</p>
<p>On Wed, Nov 14, 2018, 12:06 Maurice Gilden &lt;notifications@github.com wrote:</p>
<blockquote>
<p>What version of ripgrep are you using?</p>
<p>ripgrep 0.10.0
-SIMD -AVX (compiled)
How did you install ripgrep?</p>
<p>cargo install ripgrep
What operating system are you using ripgrep on?</p>
<p>Windows 10
Describe your question, feature request, or bug.</p>
<p>I'm trying to get a list of files that contain one word, but not another
word. To do that I call &quot;rg -l foo&quot; to get a list of files that I pass on
to another call with &quot;rg --files-without-match bar&quot;. The call looks
something like this: rg -l foo | xargs -i -d '\n' rg --files-without-match
bar {}</p>
<p>This doesn't work because --files-without-match cannot be used with a
single file. The error message is &quot; output kind PathWithoutMatch requires a
file path&quot;. However I don't understand why that shouldn't be possible.
Maybe there's a better way to do this? If not I'd really appreciate it if
that could be implemented.</p>
<p>â€”
You are receiving this because you are subscribed to this thread.
Reply to this email directly, view it on GitHub
<a href="https://github.com/BurntSushi/ripgrep/issues/1106">https://github.com/BurntSushi/ripgrep/issues/1106</a>, or mute the thread
<a href="https://github.com/notifications/unsubscribe-auth/AAb34tQF8B0lL928CvtUt5Dd-mdoTz3Nks5uvE16gaJpZM4YeL2C">https://github.com/notifications/unsubscribe-auth/AAb34tQF8B0lL928CvtUt5Dd-mdoTz3Nks5uvE16gaJpZM4YeL2C</a>
.</p>
</blockquote>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ShadowIce">@ShadowIce</a> on 2018-11-14 17:41</div>
            <div class="timeline-body"><p>If you need an example, use the ripgrep source code with this (it lists all files with an impl block, but no tests):
rg -l -g '*.rs' &quot;impl &quot; | xargs -i -d '\n' grep -L 'cfg(test)' {}</p>
<p>What I would like is to use rg for the second part as well, which probably would be: rg -l -g '*.rs' &quot;impl &quot; | xargs -i -d '\n' rg --files-without-match 'cfg\(test\)' {}</p>
<p>My use case is searching in C++ code for includes that are not needed, e.g. rg -l &quot;#include &lt;vector&gt;&quot; | xargs -i -d '\n' grep -L &quot;vector&lt;&quot; {}</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-11-14 17:55</div>
            <div class="timeline-body"><p>Thanks. As a suggestion, your <code>xargs</code> use is a bit indiosyncratic. <code>rg -l -g '*.rs' &quot;impl &quot; -0 | xargs -0 grep -L 'cfg(test)'</code> is simpler.</p>
<p>Also, <code>xargs</code> is not needed for a reproduction. Here's a very simple example:</p>
<pre><code>$ rg --files-without-match 'cfg(test)' src/main.rs
src/main.rs: output kind PathWithoutMatch requires a file path

$ rg --files-without-match 'cfg(test)' src/main.rs src/main.rs
src/main.rs
src/main.rs
</code></pre>
<p>This is definitely a bug. Thanks for reporting it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">bug</span> added by @BurntSushi on 2018-11-14 17:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from "Feature request: Parameters --files-without-match / --files-with-matches should work with single file" to "--files-without-match reports an error when used with a single file path" by @BurntSushi on 2018-11-14 17:55</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2019-01-23 02:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:42:44 UTC
    </footer>
</body>
</html>
