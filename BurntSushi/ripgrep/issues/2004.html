<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Returns multi-line error for escaped \\n searches - BurntSushi/ripgrep #2004</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Returns multi-line error for escaped \n searches</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2004">#2004</a>
        opened by <a href="https://github.com/Mattsi-Jansky">@Mattsi-Jansky</a>
        on 2021-09-24 10:13
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/Mattsi-Jansky">@Mattsi-Jansky</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>ripgrep 12.1.1
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p>apt-get</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>PopOS (a flavour of Ubuntu)</p>
<h4>Describe your bug.</h4>
<p>The error &quot;the literal '&quot;\n&quot;' is not allowed in a regex&quot; returns an error for the regex <code>\\n</code> because RG thinks it should be a multi-line search. Yet the <code>\n</code> is actually escaped so it doesn't match a literal newline character, it matches <code>\n</code> literally. The error message should only appear for <code>\n</code>, not <code>\\n</code>.</p>
<h4>What are the steps to reproduce the behavior?</h4>
<p>Run <code>rg \\n</code></p>
<h4>What is the actual behavior?</h4>
<pre><code>$ rg \\n
the literal '&quot;\n&quot;' is not allowed in a regex

Consider enabling multiline mode with the --multiline flag (or -U for short).
When multiline mode is enabled, new line characters can be matched.
</code></pre>
<h4>What is the expected behavior?</h4>
<p>Not return an error for regexes containing <code>\\n</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-09-24 11:56</div>
            <div class="timeline-body"><p>The behavior here is correct. It's your escaping that is not right. Try, for example, <code>rg \n</code>. That doesn't search for a newline. It searches for <code>n</code>. It's <code>rg \\n</code> that searches for a newline. To do it your way, I believe you would need <code>rg \\\\n</code>.</p>
<p>To be honest, I confess that I do not quite grok the full unquoted escaping rules of shell, so i can't give you a full explanation here. Instead, I can offer you some wisdom: when using escape sequences or special characters, consider putting them in single quotes. For example, <code>rg '\\n'</code> behaves how you want here.</p>
<p>Note that ripgrep does not detect newline characters in regexes with a simple search. Its detection is precisely done via the regex parser itself. So if the regex parser gets it wrong, then either something is very very very wrong (unlikely) or your input isn't the input you think it is (much more likely).</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2021-09-24 11:56</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">invalid</span> added by @BurntSushi on 2021-09-24 11:56</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/Mattsi-Jansky">@Mattsi-Jansky</a> on 2021-09-24 14:12</div>
            <div class="timeline-body"><p>You're totally right, I forgot about my terminal's own escaping. Thanks</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:27 UTC
    </footer>
</body>
</html>
