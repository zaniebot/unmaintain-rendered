<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fish-shell completions for `--type` - BurntSushi/ripgrep #1543</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fish-shell completions for <code>--type</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1543">#1543</a>
        opened by <a href="https://github.com/thomcc">@thomcc</a>
        on 2020-04-06 07:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/thomcc">@thomcc</a></div>
            <div class="timeline-body"><h4>What version of ripgrep are you using?</h4>
<pre><code>ripgrep 12.0.0
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
<h4>How did you install ripgrep?</h4>
<p>Pretty sure itÂ was <code>cargo install</code>, but I also downloaded the completion set from the releases.</p>
<h4>What operating system are you using ripgrep on?</h4>
<p>macOS 10.14.6. Also, using fish-shell version 3.0.2.</p>
<h4>Describe your question, feature request, or bug.</h4>
<p>Feature request: fish autocompletions for <code>--type</code> / <code>-t</code> argument.</p>
<p>This can be done by appending the following to the generated fish completions. I added this for myself (because I have to constantly look up what the valid types are) and figured I'd upstream it rather than have it blown away each time I update ripgrep (and y'know, so that someone else can benefit).</p>
<pre><code class="language-fish">complete -xc rg -n &quot;__fish_use_subcommand&quot; -s t -l type -a '(__rg_types)'

function __rg_types
    for item in (rg --type-list)
        if set -l match (string match -r '^(.*?)\:\s*(.*?)$' -- &quot;$item&quot;)
            set -l name $match[2]
            set -l val $match[3]
            set -l spl (string split ', ' -- &quot;$val&quot;)
            # If there are more than 4 example extensions take the
            # first 3 and end with ellipsis.
            if test (count $spl) -gt 4
                # Note: in fish indexing starts at 1 and ranges
                # are inclusive by default
                set val (string join ', ' -- $spl[1..3])
                set val &quot;$val, ...&quot;
            end
            echo &quot;$name&quot;\t&quot;$val&quot;
        end
    end
end
</code></pre>
<p>I'm not sure if you're interested in this. I could try and get the completions upstreamed into fish-shell/fish-shell instead if you aren't.</p>
<p>If you are interested, I can move this to a PR. That doesn't sound too bad (use https://docs.rs/clap/2.33.0/clap/struct.App.html#method.gen_completions_to and append this data to it. I guess I'd just put this as a raw string literal? Or would you prefer I include_str it or something -- my uncertainty here is part of why I didn't just submit a PR).</p>
<p>For reference, with this the completions on my machine look like:</p>
<img width="996" alt="Screen Shot 2020-04-06 at 12 07 58 AM" src="https://user-images.githubusercontent.com/860665/78531966-4802ca00-779b-11ea-8c12-075b48477068.png">

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-04-06 12:35</div>
            <div class="timeline-body"><p>I think I'd prefer that this sort of thing get upstreamed to fish shell completions. I think it would be hard for me to maintain this myself. If it wasn't for clap's autogeneration of completion files, I probably wouldn't offer them at all. (Other than zsh, which are hand written, tested and dogfooded by me.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thomcc">@thomcc</a> on 2020-04-06 15:37</div>
            <div class="timeline-body"><p>Okay, that's fine. Assuming that lands I'll try to keep it up to date with rg releases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @thomcc on 2020-04-06 15:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:09 UTC
    </footer>
</body>
</html>
