<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fish-shell completions for `--type` - BurntSushi/ripgrep #1543</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>fish-shell completions for <code>--type</code></h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/1543">#1543</a>
        opened by <a href="https://github.com/thomcc">@thomcc</a>
        on 2020-04-06 07:14
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/thomcc">@thomcc</a></div>
            <div class="timeline-body">What version of ripgrep are you using?
<pre><code>ripgrep 12.0.0
-SIMD -AVX (compiled)
+SIMD +AVX (runtime)
</code></pre>
How did you install ripgrep?
<p>Pretty sure itÂ was <code>cargo install</code>, but I also downloaded the completion set from the releases.</p>
What operating system are you using ripgrep on?
<p>macOS 10.14.6. Also, using fish-shell version 3.0.2.</p>
Describe your question, feature request, or bug.
<p>Feature request: fish autocompletions for <code>--type</code> / <code>-t</code> argument.</p>
<p>This can be done by appending the following to the generated fish completions. I added this for myself (because I have to constantly look up what the valid types are) and figured I&#x27;d upstream it rather than have it blown away each time I update ripgrep (and y&#x27;know, so that someone else can benefit).</p>
<pre><code>complete -xc rg -n &quot;__fish_use_subcommand&quot; -s t -l type -a &#x27;(__rg_types)&#x27;

function __rg_types
    for item in (rg --type-list)
        if set -l match (string match -r &#x27;^(.*?)\:\s*(.*?)$&#x27; -- &quot;$item&quot;)
            set -l name $match[2]
            set -l val $match[3]
            set -l spl (string split &#x27;, &#x27; -- &quot;$val&quot;)
            # If there are more than 4 example extensions take the
            # first 3 and end with ellipsis.
            if test (count $spl) -gt 4
                # Note: in fish indexing starts at 1 and ranges
                # are inclusive by default
                set val (string join &#x27;, &#x27; -- $spl[1..3])
                set val &quot;$val, ...&quot;
            end
            echo &quot;$name&quot;\t&quot;$val&quot;
        end
    end
end
</code></pre>
<p>I&#x27;m not sure if you&#x27;re interested in this. I could try and get the completions upstreamed into fish-shell/fish-shell instead if you aren&#x27;t.</p>
<p>If you are interested, I can move this to a PR. That doesn&#x27;t sound too bad (use https://docs.rs/clap/2.33.0/clap/struct.App.html#method.gen_completions_to and append this data to it. I guess I&#x27;d just put this as a raw string literal? Or would you prefer I include_str it or something -- my uncertainty here is part of why I didn&#x27;t just submit a PR).</p>
<p>For reference, with this the completions on my machine look like:</p>
<img alt="Screen Shot 2020-04-06 at 12 07 58 AM" src="https://user-images.githubusercontent.com/860665/78531966-4802ca00-779b-11ea-8c12-075b48477068.png">

</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-04-06 12:35</div>
            <div class="timeline-body"><p>I think I&#x27;d prefer that this sort of thing get upstreamed to fish shell completions. I think it would be hard for me to maintain this myself. If it wasn&#x27;t for clap&#x27;s autogeneration of completion files, I probably wouldn&#x27;t offer them at all. (Other than zsh, which are hand written, tested and dogfooded by me.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/thomcc">@thomcc</a> on 2020-04-06 15:37</div>
            <div class="timeline-body"><p>Okay, that&#x27;s fine. Assuming that lands I&#x27;ll try to keep it up to date with rg releases.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/thomcc">@thomcc</a> on 2020-04-06 15:37</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:10 UTC
    </footer>
</body>
</html>
