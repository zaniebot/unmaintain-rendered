<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>rg '&lt;,'&gt; file.txt | will clear the contents of file.txt - BurntSushi/ripgrep #2887</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>rg '&lt;,'&gt; file.txt | will clear the contents of file.txt</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2887">#2887</a>
        opened by <a href="https://github.com/AnthonyGithubCorner">@AnthonyGithubCorner</a>
        on 2024-09-12 05:08
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/AnthonyGithubCorner">@AnthonyGithubCorner</a></div>
            <div class="timeline-body"><h3>Please tick this box to confirm you have reviewed the above.</h3>
<ul>
<li>[X] I have a different issue.</li>
</ul>
<h3>What version of ripgrep are you using?</h3>
<p>ripgrep 14.1.1</p>
<p>features:+pcre2
simd(compile):+SSE2,+SSSE3,-AVX2
simd(runtime):+SSE2,+SSSE3,+AVX2</p>
<p>PCRE2 10.43 is available (JIT is available)</p>
<h3>How did you install ripgrep?</h3>
<p>Homebrew</p>
<h3>What operating system are you using ripgrep on?</h3>
<p>MacOS 14.6.1</p>
<h3>Describe your bug.</h3>
<p>ripgrep clears the entire content of the file or will replace the file with random garbage.
This happens when running the mistake command
rg '&lt;,'&gt; file.txt</p>
<h3>What are the steps to reproduce the behavior?</h3>
<p>You will see that the file is completely cleared after issuing the command. I would be careful debugging this problem as it might result in data lost.</p>
<pre><code>echo hello &gt;&gt; hello.txt
cat hello.txt
rg '&lt;,'&gt; hello.txt
cat hello.txt 
</code></pre>
<h3>What is the actual behavior?</h3>
<pre><code>rg --debug '&lt;,'&gt; hello.txt
rg: DEBUG|rg::flags::parse|crates/core/flags/parse.rs:97: no extra arguments found from configuration file
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1083: number of paths given to search: 0
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1108: using heuristics to determine whether to read from stdin or search ./ (is_readable_stdin=false, stdin_consumed=false, mode=Search(Standard))
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1118: heuristic chose to search ./
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1269: found hostname for hyperlink configuration: something_hidden.lan
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:1279: hyperlink format: &quot;&quot;
rg: DEBUG|rg::flags::hiargs|crates/core/flags/hiargs.rs:174: using 8 thread(s)
rg: DEBUG|grep_regex::config|/private/tmp/ripgrep-20240910-11501-ez7f5q/ripgrep-14.1.1/crates/regex/src/config.rs:175: assembling HIR from 1 fixed string literals
rg: DEBUG|globset|crates/globset/src/lib.rs:453: built glob set; 0 literals, 0 basenames, 12 extensions, 0 prefixes, 0 suffixes, 0 required extensions, 0 regexes
</code></pre>
<h3>What is the expected behavior?</h3>
<p>I ended up running the command trying to see if I can pass through selected content in vim to ripgrep. I wasn't too worried but imagine my surprise when something I did cleared the file I was searching. I narrowed it down to this command. The expected behaviour is no matches and the file isn't touched.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2024-09-12 09:57</div>
            <div class="timeline-body"><p>This is a shell command typo that ripgrep can't do anything about. The shell interprets the quoting and redirect syntax before ripgrep is even executed, all it knows is that you've told it to search for the pattern <code>&lt;,</code> and output the results to a file. Even if it could see the raw shell command, it's perfectly valid, so there's no way for it (or the shell) to figure out that you meant to type something else</p>
<p>If you want, you can enable the <code>noclobber</code> option in your shell profile to make it so that <code>&gt;</code> isn't allowed to overwrite the contents of existing files:</p>
<pre><code># In bash:
set -o noclobber

# In zsh:
setopt no_clobber
# Also set this to make it work like bash, where you can still use &gt;&gt; to create files:
setopt append_create
# ETA: Also set this to make it work like bash, where you can't use &gt; to overwrite *empty* files:
setopt no_clobber_empty
</code></pre>
<p>If you do this you will have to remember to use <code>&gt;|</code> instead of <code>&gt;</code> whenever you want to actually overwrite a file</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Locked by @ghost on 2024-09-12 13:07</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 16:43:50 UTC
    </footer>
</body>
</html>
