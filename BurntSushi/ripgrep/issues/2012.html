<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apply --text to some file types but not others - BurntSushi/ripgrep #2012</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Apply --text to some file types but not others</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/issues/2012">#2012</a>
        opened by <a href="https://github.com/jpeloquin">@jpeloquin</a>
        on 2021-10-01 02:43
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/jpeloquin">@jpeloquin</a></div>
            <div class="timeline-body"><p><em>Summary</em>: To ensure search of files that are mostly text while still excluding fully-binary files, it would be helpful to be able to declare that certain file types should be treated as text even when null bytes are present.</p>
<p><em>Motivation</em>: Ripgrep currently uses a simple heuristic to detect binary files, for a variety of good reasons.  Still, this heuristic sometimes excludes files of interest that are mostly text, such as texinfo or log files.  Since these file types are <em>often</em> 100% text and always <em>mostly</em> text, the user may not realize that a subset of their files contain null bytes and are affected by the binary exclusion heuristic.  When it is critical to avoid unwanted exclusions, the user can use <code>--text</code> as a precaution, but the resulting inclusion of every genuinely binary file can (a) slow the search by including extra data and (b) return many junk results.  Applying --text to specific file types of interest would mitigate these disadvantages.</p>
<p>Note that workarounds exist: the user can search once with the default heuristic, <code>rg foo</code>, and a second time with the mostly-text file types of interest, <code>rg --text -g &#x27;*.info foo</code> or <code>rg --text --type all foo</code>.  (The latter won&#x27;t include extensionless files like README so it doesn&#x27;t suffice on its own.)  So the request is just a minor quality-of-life increase; if the implementation would be complex it might not be worth it.</p>
<p><em>Tentative syntax</em>: If this request is favorable in principle, I tentatively suggest two possibilities for syntax (probably pick only one):</p>
<ol>
<li>Extend <code>--type-add</code>&#x27;s <code>TYPE_SPEC</code> pattern to take a text declaration, like <code>--type-add &#x27;log:*log type=text&#x27;</code>.  Relative to the following option, this is harder to use on an ad-hoc basis.</li>
<li>Extend the <code>--text</code> flag to take a TYPE pattern, like <code>--text bar</code>. (Presumably the user would define a type <code>bar</code> with everything they want always treated as text.)  This has the disadvantage that the existing use, <code>--text</code>, has no type pattern (a missing type is not equivalent to &quot;all&quot;) and would have to be special-cased for compatibility.</li>
</ol>
<p>The syntax isn&#x27;t that important though and I&#x27;m certainly not the best person to choose it.  Regardless, the user would presumably use the new arguments in their .ripgreprc to make sure certain file types of interest are always searched.  Much like .gitattributes is used to configure whether git diff treats certain file types as binary or text.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-24 20:15</div>
            <div class="timeline-body"><p>I&#x27;m going to pass on this. I think it&#x27;s too subtle of a behavior.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-24 20:15</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">wontfix</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-11-24 20:15</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:11 UTC
    </footer>
</body>
</html>
