<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add warning if nothing was searched - BurntSushi/ripgrep #1762</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add warning if nothing was searched</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/1762">#1762</a>
        opened by <a href="https://github.com/goto-engineering">@goto-engineering</a>
        on 2020-12-15 08:05
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/goto-engineering">@goto-engineering</a></div>
            <div class="timeline-body"><p>Ok, another attempt at fixing <a href="https://github.com/BurntSushi/ripgrep/issues/1404">BurntSushi/ripgrep#1404</a>.</p>
<p>I somehow messed up the other PR in the Github UI, not sure how. You can delete it.</p>
<p>Let me know if this is on the right track, and I&#x27;ll look into tests.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-12-15 13:06</div>
            <div class="timeline-body"><blockquote>
<p>I somehow messed up the other PR in the Github UI, not sure how. You can delete it.</p>
</blockquote>
<p>Please don&#x27;t delete PRs or issues. I&#x27;m really surprised GitHub gives you the ability to delete issues/PRs filed on another repo. Please don&#x27;t do that. Because you deleted it, we&#x27;ve now lost some historical context and some helpful info on a false start. Sure, the PR might have been wrong, but we don&#x27;t just sweep wrong things under the rug. We learn from them.</p>
<p>Aside from that, you shouldn&#x27;t have needed to open a new PR. For a small change like this, it&#x27;s enough to keep it inside a single commit. When you make a change, just amend the commit. (<code>git commit -a --amend</code> for example.) And since the history is altered, you&#x27;ll need to force push it, e.g., <code>git push &lt;remote&gt; &lt;branch&gt; --force</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> requested changes on 2020-12-15 13:21</div>
            <div class="timeline-body"><p>I think this looks correct to me! Have you tried it? Does it work?</p>
<p>I think adding some tests would be a good idea. They should go in <code>tests/feature.rs</code>. I think you&#x27;ll find <code>assert_non_empty_stderr()</code> helpful in this case. Here&#x27;s an example of another test that uses it: https://github.com/BurntSushi/ripgrep/blob/a6d05475fb353c756e88f605fd5366a67943e591/tests/feature.rs#L44-L47</p>
<p>Take a look at other tests in that file to see how to setup directory trees and what not.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/goto-engineering">@goto-engineering</a> on 2020-12-15 18:13</div>
            <div class="timeline-body"><blockquote>
<blockquote>
<p>I somehow messed up the other PR in the Github UI, not sure how. You can delete it.</p>
</blockquote>
<p>Please don&#x27;t delete PRs or issues. I&#x27;m really surprised GitHub gives you the ability to delete issues/PRs filed on another repo. Please don&#x27;t do that. Because you deleted it, we&#x27;ve now lost some historical context and some helpful info on a false start. Sure, the PR might have been wrong, but we don&#x27;t just sweep wrong things under the rug. We learn from them.</p>
<p>Aside from that, you shouldn&#x27;t have needed to open a new PR. For a small change like this, it&#x27;s enough to keep it inside a single commit. When you make a change, just amend the commit. (<code>git commit -a --amend</code> for example.) And since the history is altered, you&#x27;ll need to force push it, e.g., <code>git push &lt;remote&gt; &lt;branch&gt; --force</code>.</p>
</blockquote>
<p>Sorry, I got confused with the whole fork thing on github. Since there was only 1 commit, I deleted the branch on my fork, not realizing that would close the PR. I had intended to just force push my new commit to the same branch name.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/goto-engineering">@goto-engineering</a> on 2020-12-15 18:15</div>
            <div class="timeline-body"><blockquote>
<p>I think this looks correct to me! Have you tried it? Does it work?</p>
<p>I think adding some tests would be a good idea. They should go in <code>tests/feature.rs</code>. I think you&#x27;ll find <code>assert_non_empty_stderr()</code> helpful in this case. Here&#x27;s an example of another test that uses it:</p>
<p>https://github.com/BurntSushi/ripgrep/blob/a6d05475fb353c756e88f605fd5366a67943e591/tests/feature.rs#L44-L47</p>
<p>Take a look at other tests in that file to see how to setup directory trees and what not.</p>
</blockquote>
<p>Yes, I&#x27;ve tried it with this setup of files:</p>
<pre><code>.ignore - (ignored-dir/**)
ignored-dir/file.txt (&quot;needle&quot;)
other-file.txt (doesn&#x27;t contain needle)
</code></pre>
<p>Then I do <code>rg needle</code>. If <code>other-file.txt</code> is there, it doesn&#x27;t show the warning. If only <code>ignored-dir</code> is there, it does show up.</p>
<p>Thanks for the hints, I&#x27;ll look into the tests later!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/goto-engineering">@goto-engineering</a> on 2020-12-18 04:48</div>
            <div class="timeline-body"><p>@BurntSushi I added a test case for the warning and it passes. But another test (<code>regression::r428_unrecognized_style</code>) fails because its setup also triggers the warning.</p>
<p>I think it&#x27;s because the case being tested there throws an exception and therefore never triggers my <code>searched = true</code>. I&#x27;m not really sure how to handle that. Since it&#x27;s about an unrecognized style, is this happening in the builder itself?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/goto-engineering">@goto-engineering</a> on 2020-12-27 19:07</div>
            <div class="timeline-body"><p>@BurntSushi Ping just in case you hadn&#x27;t seen this</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rollup</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-05-30 14:17</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2021-06-01 01:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:18 UTC
    </footer>
</body>
</html>
