<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>updates clap and removes home rolled -h/--help distinction - BurntSushi/ripgrep #438</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>updates clap and removes home rolled -h/--help distinction</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/438">#438</a>
        opened by <a href="https://github.com/kbknapp">@kbknapp</a>
        on 2017-04-05 05:27
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/kbknapp">@kbknapp</a></div>
            <div class="timeline-body"><p>~~<strong>DO NOT MERGE - until clap v2.23.1 is on crates.io</strong>~~</p>
<p>It&#x27;s safe to merge now.</p>
<ul>
<li>[x] crates.io needs to contain clap v2.23.1</li>
<li>[x] I need to rebase the <code>Cargo.lock</code></li>
</ul>
<p>This commit updates clap to v2.23.1</p>
<p>The update contained a bug fix in clap that results in broken code in
ripgrep. ripgrep was unknowingly relying on the bug, but this commit fixes that
issue. The bug centered around not being able to override the
auto-generated help message by supplying a flag with a long of <code>help</code>.</p>
<p>Normally, supplying a flag with a long of <code>help</code> means whenever the user
passes <code>--help</code>, the consuming code (e.g. ripgrep) is responsible for
displaying the help message. However, due to the bug in clap this wasn&#x27;t
necessary for ripgrep to do unless the user passed <code>-h</code>. With the bug
fixed, it meant the user passing <code>--help</code> and clap expected ripgrep to
display the help, yet ripgrep expected clap to display the help. This
has been fixed in this commit of ripgrep.</p>
<p>All is well now!</p>
<p>v2.23.0 also brings the abilty to use <code>Arg::help</code> or <code>Arg::long_help</code>
allowing one to distinguish between <code>-h</code> and <code>--help</code>. This commit
leaves all doc strings in the <code>lazy_static!</code> hashmap however only for
aesthetic reasons.</p>
<p>This means all home rolled handling of <code>-h</code>/<code>--help</code> has been removed
from ripgrep, yet functionality <em>and</em> appearances are 100% the same.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-04-05 11:16</div>
            <div class="timeline-body"><p><em>Excellent!</em> Thanks so much for doing this. I much appreciate the simpler case analysis. :-)</p>
<p>At some point, I&#x27;ll get rid of the <code>USAGES</code> map and inline the docs, but I like that this PR doesn&#x27;t do that. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Renamed from &quot;updates clap and removes home rolled -h/--help distinction (DO NOT MERGE YET)&quot; to &quot;updates clap and removes home rolled -h/--help distinction&quot; by <a href="https://github.com/kbknapp">@kbknapp</a> on 2017-04-05 15:04</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-04-05 15:38</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-04-05 15:38</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:16 UTC
    </footer>
</body>
</html>
