<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[FEATURE] Added --mtime flag and logic - BurntSushi/ripgrep #3220</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>[FEATURE] Added --mtime flag and logic</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/3220">#3220</a>
        opened by <a href="https://github.com/gege42o">@gege42o</a>
        on 2025-11-16 10:25
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/gege42o">@gege42o</a></div>
            <div class="timeline-body">Feature Description
<p>The <code>--mtime</code> flag allows users to filter files based on their modification time before searching them.</p>
Syntax
<p>The flag accepts three formats, matching the behavior of <code>find -mtime</code>:</p>
<p>| Format | Description | Example |
|--------|-------------|---------|
| <code>--mtime N</code> | Files modified exactly N days ago | <code>--mtime 3</code> |
| <code>--mtime -N</code> | Files modified less than N days ago (within last N days) | <code>--mtime -7</code> |
| <code>--mtime +N</code> | Files modified more than N days ago (older than N days) | <code>--mtime +30</code> |</p>
Behavior Characteristics
<ol>
<li><p><strong>Fractional Day Handling</strong>: When calculating days ago, fractional parts are <strong>truncated</strong> (not rounded)</p>
<ul>
<li>A file modified 1.9 days ago is considered &quot;1 day old&quot;</li>
<li><code>--mtime +1</code> requires at least 2 full days</li>
</ul>
</li>
<li><p><strong>24-Hour Periods</strong>: Each day is exactly 24×60×60 = 86,400 seconds</p>
</li>
<li><p><strong>Filter-Only</strong>: This flag only affects which files are searched, not the output format</p>
</li>
<li><p><strong>Metadata Required</strong>: Files without accessible metadata are skipped with debug logging</p>
</li>
</ol>
<hr>
Data Flow
<ol>
<li><p><strong>Parsing Phase</strong>: User provides <code>--mtime VALUE</code></p>
<ul>
<li>Value is parsed to determine format (<code>+</code>, <code>-</code>, or plain number)</li>
<li>Converted to <code>MtimeFilter</code> enum variant</li>
<li>Stored in <code>LowArgs.mtime</code></li>
</ul>
</li>
<li><p><strong>Configuration Phase</strong>: Arguments converted from low to high level</p>
<ul>
<li><code>LowArgs.mtime</code> → <code>HiArgs.mtime</code></li>
<li>No transformation, direct copy</li>
</ul>
</li>
<li><p><strong>Execution Phase</strong>: Files are filtered during traversal</p>
<ul>
<li><code>HiArgs.mtime</code> → <code>HaystackBuilder.mtime_filter</code></li>
<li>For each file encountered:<ul>
<li>Get file metadata</li>
<li>Extract modification time</li>
<li>Compare against filter</li>
<li>Include/exclude file</li>
</ul>
</li>
</ul>
</li>
</ol>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Converted to draft by <a href="https://github.com/gege42o">@gege42o</a> on 2025-11-16 10:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Marked ready for review by <a href="https://github.com/gege42o">@gege42o</a> on 2025-11-16 11:00</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gege42o">@gege42o</a> on 2025-11-16 11:36</div>
            <div class="timeline-body"><p>It appears that the feature works and is not flagged by rust-fmt. The errors are related to the help message but I don&#x27;t know exactly where it is wrong. A little help would be appreciated and if needed I will provide further explanations about the code, idea and execution.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-16 12:10</div>
            <div class="timeline-body"><p>If someone other than me is going to add this to ripgrep, then it needs design first before going to a PR. See #3214.</p>
<p>There are a number of issues with the approach here. Like being limited to days. Or always assuming 1 day is 24 hours (some are longer, some are shorter). And I&#x27;m not a fan of the name &quot;mtime.&quot;</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-11-16 12:10</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/gege42o">@gege42o</a> on 2025-11-16 12:34</div>
            <div class="timeline-body"><p>I understand, I saw the same issue before i started designing this. Wanted to do a 1:1 copy to find&#x27;s --mtime that works only for days because thats what the person who wrote the original issue wanted. What names would be suitable for this option? Maybe I can try again while using jiff.</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:21 UTC
    </footer>
</body>
</html>
