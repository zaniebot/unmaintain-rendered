<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add --suppress-error flag for permission-denied handling - BurntSushi/ripgrep #3239</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add --suppress-error flag for permission-denied handling</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/3239">#3239</a>
        opened by <a href="https://github.com/M1tsumi">@M1tsumi</a>
        on 2025-12-06 20:51
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/M1tsumi">@M1tsumi</a></div>
            <div class="timeline-body"><p>This PR introduces a new <code>--suppress-error</code> flag that lets users control how ripgrep handles permission-denied errors during file traversal and searching.</p>
<p>The new flag has two modes:</p>
<ul>
<li><code>--suppress-error=permission</code> - suppresses the error output but still exits with code 2</li>
<li><code>--suppress-error=nopermission</code> - suppresses output AND treats these files as skipped (exit code unaffected)</li>
</ul>
Changes
<p><strong>Flag and enum</strong> (<code>lowargs.rs</code>, <code>defs.rs</code>, <code>hiargs.rs</code>)</p>
<ul>
<li><p>Added <code>SuppressErrorMode</code> enum with <code>PermissionSilence</code> and <code>PermissionSkip</code> variants</p>
</li>
<li><p>Hooked it up through the low-args → hi-args pipeline</p>
</li>
<li><p>Added <code>handle_search_error()</code> helper used by both single-threaded and parallel search</p>
</li>
<li><p>Checks error kind against suppression mode to decide whether to print/set error flag</p>
</li>
</ul>
<p><strong>Tests</strong></p>
<ul>
<li>Flag parsing tests in <code>defs.rs</code></li>
<li>Unit tests for the error handler covering mode × error type combinations</li>
<li>Existing tests pass</li>
</ul>
<p>This leaves the Default behavior unchanged - new behavior only kicks in if you pass the flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-12-06 21:12</div>
            <div class="timeline-body"><p>ripgrep already has a <code>--no-messages</code> flag.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-12-06 21:12</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2025-12-06 21:16</div>
            <div class="timeline-body"><p>Wow, you even left the prompt in the PR /s</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2025-12-06 21:35</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:21 UTC
    </footer>
</body>
</html>
