<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Use clap's overrides_with and default_value_if - BurntSushi/ripgrep #499</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Use clap's overrides_with and default_value_if</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/499">#499</a>
        opened by <a href="https://github.com/ericbn">@ericbn</a>
        on 2017-06-01 23:38
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ericbn">@ericbn</a></div>
            <div class="timeline-body"><p>to better organize options. These are the changes:</p>
<ul>
<li>color will have default value of &quot;never&quot; if <code>--vimgrep</code> is given, and only if no <code>--color</code> option is given</li>
<li>last overrides previous: <code>--line-number</code> and <code>--no-line-number</code>, <code>--heading</code> and <code>--no-heading</code>, <code>--with-filename</code> and <code>--no-filename</code>, and <code>--vimgrep</code> and -<code>-count</code></li>
<li>no heading will be show if <code>--vimgrep</code> is defined. This worked inside vim actually because heading is also only shown if tty is stdout (which is not the case when rg is called from vim).</li>
</ul>
<p>Unfortunately, clap does not behave like a usual GNU/POSIX in some cases, as reported in https://github.com/kbknapp/clap-rs/issues/970 and https://github.com/kbknapp/clap-rs/issues/976 (having all the bells and whistles, on the other hand). So we still have issues like rg failing when same argument is given more than once (unless for the few ones marked with <code>multiple(true)</code>), or having unintuitive precedence rules (and probably non-intentional, just there because of clap's limitations) like:</p>
<ul>
<li><code>--no-filename</code> over <code>--vimgrep</code></li>
<li><code>--no-line-number</code> over <code>--column</code>, <code>--pretty</code> or <code>--vimgrep</code></li>
<li><code>--no-heading</code> over <code>--pretty</code></li>
</ul>
<p>regardless of the order in which options where given, where the desired behavior would be that the last option would override the previous ones given.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-06-12 14:29</div>
            <div class="timeline-body"><p>Sorry this took me so long to get to, but I think I buy all of this. Thanks for thinking through it!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by @BurntSushi on 2017-06-12 14:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2017-06-12 14:29</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2017-06-12 14:31</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 18:27:51 UTC
    </footer>
</body>
</html>
