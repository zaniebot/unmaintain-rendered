<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>regex: fix fast path for -w/--word-regexp flag - BurntSushi/ripgrep #2576</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>regex: fix fast path for -w/--word-regexp flag</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/2576">#2576</a>
        opened by <a href="https://github.com/BurntSushi">@BurntSushi</a>
        on 2023-07-31 12:06
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a></div>
            <div class="timeline-body"><p>It turns out our fast path for -w/--word-regexp wasn&#x27;t quite correct in some cases. Namely, we use <code>(?m:^|\W)(&lt;original-regex&gt;)(?m:\W|$)</code> as the implementation of -w/--word-regexp since <code>\b(&lt;original-regex&gt;)\b</code> has some unintuitive results in certain cases, specifically when  matches non-word characters at match boundaries.</p>
<p>The problem is that using this formulation means that you need to extract the capture group around  to find the &quot;real&quot; match, since the surrounding (^|\W) and (\W|$) aren&#x27;t part of the match. This is fine, but the capture group engine is usually slow, so we have a fast path where we try to deduce the correct match boundary after an initial match (before running capture groups). The problem is that doing this is rather tricky because it&#x27;s hard to know, in general, whether the <code>^</code> or the <code>\W</code> matched.</p>
<p>This still doesn&#x27;t seem quite right overall, but we at least fix one more case.</p>
<p>Fixes #2574</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-07-31 12:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2023-07-31 12:51</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Branch deleted on 2023-07-31 12:51</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:19 UTC
    </footer>
</body>
</html>
