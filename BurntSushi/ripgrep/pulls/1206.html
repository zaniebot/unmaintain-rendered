<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape documentation braces from a2x - BurntSushi/ripgrep #1206</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Escape documentation braces from a2x</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/1206">#1206</a>
        opened by <a href="https://github.com/ravron">@ravron</a>
        on 2019-02-28 03:02
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/ravron">@ravron</a></div>
            <div class="timeline-body"><p><code>a2x</code> is used to convert these documentation strings into a man page. However, the AsciiDoc format reserves the <code>{identifier}</code> syntax for <a href="http://www.methods.co.nz/asciidoc/userguide.html#_document_attributes">attribute references</a>, and <code>a2x</code> interprets the unescaped substring <code>{any}</code> as such an attribute reference. The documentation at that link warns:</p>
<blockquote>
<p>If an attribute is not defined then the line containing the attribute reference is dropped. This property is used extensively in AsciiDoc configuration files to facilitate conditional markup generation.</p>
</blockquote>
<p>Indeed, the generated <code>man</code> page is missing two lines (here, &quot;lines&quot; means lines of source code), which you can see in a release build like <a href="https://github.com/BurntSushi/ripgrep/releases/download/0.10.0/ripgrep-0.10.0-x86_64-apple-darwin.tar.gz">this one</a>, in the <code>doc/rg.1</code> file, resulting in this ill-formed paragraph:</p>
<blockquote>
<p>When multiline mode is enabled, ripgrep will lift the restriction that a match cannot include a line terminator. For example, when multiline mode is not codepoint other than \n. Similarly, the regex \n is explicitly forbidden, and if you try to use it, ripgrep will return an error. However, when multiline and regexes like \n are permitted.</p>
</blockquote>
<p>The <a href="http://methods.co.nz/asciidoc/faq.html#_how_can_i_escape_asciidoc_markup">FAQ says</a> the fix is to simply escape the unintentional markup with a backslash, which is what this PR does. I don&#x27;t have the ripgrep build set up on my machine, so I have not verified this change. I would ask that a maintainer do so before merging.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2019-02-28 03:11</div>
            <div class="timeline-body"><p>This came up before:</p>
<ul>
<li>https://github.com/BurntSushi/ripgrep/issues/1101#issuecomment-436092239</li>
<li>https://github.com/BurntSushi/ripgrep/commit/b41e5963279d5a7c633514d4a6afcb480c6c6915#commitcomment-31192307</li>
</ul>
<p>And i believe @BurntSushi fixed it with that commit</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-04-06 12:05</div>
            <div class="timeline-body"><p>@ravron Thanks! As @okdana points out, I think this has already been fixed. In particular, one reason why I went my route instead of explicitly escaping the text in the help output is that the text in the help output is used in both the man page <em>and</em> the <code>-h/--help</code> output. The extra escaping here would end up making the output of <code>--help</code> look weird. (We&#x27;re bound to run into some trouble because of this dual use, and if we <em>had</em> to deal with the extra escaping to make it work, then I&#x27;d accept that. This is all basically at the service of keeping one copy of the docs in a fairly simplistic way.)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2019-04-06 12:05</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:17 UTC
    </footer>
</body>
</html>
