<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tweak snapcraft.yaml - BurntSushi/ripgrep #979</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Tweak snapcraft.yaml</h1>

    <div class="meta">
        <span class="state-icon state-merged"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/979">#979</a>
        opened by <a href="https://github.com/mati865">@mati865</a>
        on 2018-07-13 10:42
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/mati865">@mati865</a></div>
            <div class="timeline-body"><p>I know you don&#x27;t have time to work with snaps, is there any way I could help you?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-13 10:54</div>
            <div class="timeline-body"><blockquote>
<p>I know you don&#x27;t have time to work with snaps, is there any way I could help you?</p>
</blockquote>
<p>Seems unlikely. My position has changed on this from &quot;I don&#x27;t have time&quot; to &quot;actively discourage the use of snap.&quot; I&#x27;ve never been able to figure out how to get it working, and moreover, the use of snap has generated so many bug reports that I can do nothing about that I&#x27;ve had to put a special call out about snap in the issue template and I removed it from the list of suggested installation instructions: https://github.com/BurntSushi/ripgrep/commit/6ffb4b7466c914a2683847b5fb4e30ea16749e94#diff-0b6c1416b1293274c4e2d11fb49e1795</p>
<p>Maybe these problems are fixable, but I just don&#x27;t have the bandwidth to fix them. For example, I understand exactly nothing about the change that&#x27;s being submitted here. Why is it necessary? What does it do? What does it fix? None of this is obvious to me and none of it is in the commit message.</p>
<p>Sorry to be so harsh sounding. I appreciate folks trying to increase the number of ways that ripgrep can be installed. But snap has been nothing but a headache for me.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mati865">@mati865</a> on 2018-07-13 11:45</div>
            <div class="timeline-body"><p>@BurntSushi there is extremely simple reason why it didn&#x27;t work before as I wrote in <a href="https://github.com/BurntSushi/ripgrep/issues/902">BurntSushi/ripgrep#902</a>#issuecomment-404798881</p>
<blockquote>
<p>For example, I understand exactly nothing about the change that&#x27;s being submitted here. Why is it necessary? What does it do? What does it fix? None of this is obvious to me and none of it is in the commit message.</p>
</blockquote>
<p>Snap by default creates wrappers for running package which can be useful for other apps to configure their dynamic libs location but totally redundant for static libs. This change gives very small benefit to startup time.
I can add commit message.</p>
<p>I haven&#x27;t used this option but if https://dashboard.snapcraft.io/snaps/ripgrep/collaboration/ does what it looks to do I could take care of managing releases.</p>
<p>I&#x27;ll understand if you don&#x27;t want to touch it anymore, in this case feel free to close this PR.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-13 11:55</div>
            <div class="timeline-body"><p>@mati865 If you can improve the commit message and ideally include a link to the relevant snap documentation (so that I can start learning how to diagnose these problems myself), then I&#x27;m happy to merge this.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/mati865">@mati865</a> on 2018-07-13 14:04</div>
            <div class="timeline-body"><p>Snap documentation is a bit lacking, discussion about this feature is available <a href="https://forum.snapcraft.io/t/telling-snapcraft-to-skip-generating-wrapper-scripts/1635">here</a>.</p>
<blockquote>
<p>so that I can start learning how to diagnose these problems myself</p>
</blockquote>
<p>Those issues were related to AppArmor.
As long as this snap is using <code>classic</code> confinement AppArmor will let it do everything and <code>ripgrep</code> will behave just like normal app.</p>
<p>This section doesn&#x27;t apply for <code>classic</code> snaps:
To improve security snaps are confined and given only explicitly requested (just like Android or iOS apps). Problematic snap <code>rg</code>requested only <code>home</code> interface which gives access only to user files (hence the permission errors). List of available interfaces is <a href="https://docs.ubuntu.com/core/en/reference/interfaces/">here</a>.
AppArmor debugging guide is available <a href="https://docs.ubuntu.com/core/en/guides/intro/security">here</a>
To make <code>ripgrep</code> confined it would need interface giving read access to everything user can read. The problem is interface like that doesn&#x27;t exists (<a href="https://bugs.launchpad.net/snappy/+bug/1603838">request was filed</a>). Of course one <a href="http://www.zygoon.pl/2016/08/creating-your-first-snappy-interface.html">can create interface</a> like that but it wouldn&#x27;t differ from <code>classic</code> confinement too much and Ubuntu developer made valid point <code>the request is at odds with snappy&#x27;s application isolation goals</code>.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Merged by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-21 17:28</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2018-07-21 17:28</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:17 UTC
    </footer>
</body>
</html>
