<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ignore: use git commondir for sourcing .git/info/exclude - BurntSushi/ripgrep #1446</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>ignore: use git commondir for sourcing .git/info/exclude</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/1446">#1446</a>
        opened by <a href="https://github.com/krobelus">@krobelus</a>
        on 2019-12-11 18:37
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/krobelus">@krobelus</a></div>
            <div class="timeline-body"><p>Git looks for this file in GIT_COMMON_DIR, which is usually the same
as GIT_DIR (.git). However, when searching inside a linked worktree,
.git is usually a file that contains the path of the actual git dir,
which in turn contains a file &quot;commondir&quot; which references the directory
where info/exclude may reside, alongside other configuration shared across
all worktrees. This directory is usually the git dir of the main worktree.</p>
<p>Unlike git this does <em>not</em> read environment variables GIT_DIR and
GIT_COMMON_DIR, because it is not clear how to interpret them when
searching multiple repositories.</p>
<p>Fixes #1445</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rollup</span> added by @BurntSushi on 2020-02-17 02:49</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2020-02-17 02:51</div>
            <div class="timeline-body"><p>Thanks! I'll be merging this with some minorish changes in #1486. The main changes were:</p>
<ul>
<li>Fix the style of the code. Namely, the lines were quite long. It's best to stick to the style of the surrounding code. I'll be switching to rustfmt soon, so this hopefully shouldn't be a problem too much longer.</li>
<li>I added an integration level regression test.</li>
<li>I slightly refactored the code such that it doesn't introduce an extra stat call for every directory. These can add up and wind up being surprisingly expensive. Since we are already checking for the existence of <code>.git</code> in each directory, I just reused the result of that stat call.</li>
</ul>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2020-02-17 22:16</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 18:28:11 UTC
    </footer>
</body>
</html>
