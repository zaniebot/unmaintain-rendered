<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>complete/zsh: improve --hyperlink-format completion - BurntSushi/ripgrep #3102</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>complete/zsh: improve --hyperlink-format completion</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/3102">#3102</a>
        opened by <a href="https://github.com/okdana">@okdana</a>
        on 2025-07-13 23:47
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/okdana">@okdana</a></div>
            <div class="timeline-body"><p>here&#x27;s better completion for <code>--hyperlink-format</code></p>
<p>three known annoyances:</p>
<ul>
<li><p>zsh doesn&#x27;t perform brace expansion on single words, so users might be inclined to leave the variable braces unquoted, as in <code>--hyperlink-format=foo://{path}</code>. but i guess it generally assumes that it might and handles it at an earlier stage, which means our function doesn&#x27;t even know the <code>{</code> is there. this causes unexpected behaviour. there is also a bug (i assume zsh&#x27;s rather than mine but idk) where it re-inserts the <code>{</code> in a weird place, e.g. <code>\{ho{st\}</code></p>
</li>
<li><p>zsh converts the the argument in <code>--opt=arg</code> style options to the <code>\</code>-escaped (rather than quoted) form when completing it, which is not pleasant with the syntax used here and exacerbates the above issue</p>
</li>
<li><p>if you have like <code>--hyperlink-format &#x27;{}</code>, press tab between the <code>{}</code>, and then press <code>}</code> after adding one of the matches, it won&#x27;t swallow the extra <code>}</code></p>
</li>
</ul>
<p>off the top of my head idk if there&#x27;s anything to be done about the first two. the last one can probably be fixed with <code>compadd -R</code> or sth. but tbh i got bored of the problem</p>
<p>if these limitations bother you i can simplify it so it only tries to complete the aliases i guess</p>
<p>i also made it so helper functions aren&#x27;t re-defined if they exist. this is a convention of many completion functions that allows end-users to more easily define their own helpers if they want them to behave differently. i just forgot to do it before</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2025-07-15 21:03</div>
            <div class="timeline-body"><p>We were discussing with @ilyagr about the removal of duplicate hyperlink alias names in #3096  (<a href="https://github.com/BurntSushi/ripgrep/compare/3b7fd442a6f3aa73f650e763d7cbb902c03d700e...ltrzesniewski:ripgrep:41a7d17349b87555f3bc2adb6fe7dd5804ba7a80">here&#x27;s my draft</a> of this idea if you&#x27;re interested).</p>
<p>If this would end up being accepted, what would you think about adding a <code>!HYPERLINK_ALIAS_NAMES!</code> variable (or similar) to be replaced, just like <code>!ENCODINGS!</code> is today?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/okdana">@okdana</a> on 2025-07-15 21:34</div>
            <div class="timeline-body"><p>oh. i was semi-conscious of the fact that i was getting e-mails about that, which is why i thought to do this. but i must&#x27;ve forgot about it already by the time i went to actually work on it, i never even looked at it</p>
<p>yes, that would be convenient</p>
<p>though i think, in contrast to the encodings, it makes sense for these to have descriptions for what they actually do. since they&#x27;re auto-generated it could be as simple as the strings they expand to. so something like <code>file:file://{host}{path}</code> (or whatever delimiter)? if that&#x27;s too cute just the names will work ofc, it&#x27;s just not quite as helpful</p>
<p>then again the man page isn&#x27;t explicit about them either so w/e</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2025-07-15 22:07</div>
            <div class="timeline-body"><p>Either having the strings they expand to or adding a custom description to <code>HYPERLINK_PATTERN_ALIASES</code> would be possible. I think I&#x27;d also prefer having a description, especially since I like the ones you provided.</p>
<p>Lots of variants are possible here, and also for the main page.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/ltrzesniewski">@ltrzesniewski</a> on 2025-07-16 20:41</div>
            <div class="timeline-body"><p>I made #3103 to be used as a baseline, but didn&#x27;t add descriptions yet since they wouldn&#x27;t be used. Adding them won&#x27;t be a problem if needed.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-09-06 18:41</div>
            <div class="timeline-body"><p>Thank you! I took this as-is, except I added descriptions to the new <code>HyperlinkAlias</code> and auto-generated that part of the completion script.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Label <span class="label">rollup</span> added by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-09-06 18:42</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2025-09-20 01:08</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-20 18:48:20 UTC
    </footer>
</body>
</html>
