<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add option --max-columns to truncate long lines - BurntSushi/ripgrep #356</title>
    <link rel="stylesheet" href="../../../style.css">
</head>
<body>
    <div class="back-link">
        <a href="../../../index.html">Back to index</a>
    </div>

    <h1>Add option --max-columns to truncate long lines</h1>

    <div class="meta">
        <span class="state-icon state-closed"></span>
        <a href="https://github.com/BurntSushi/ripgrep/pull/356">#356</a>
        opened by <a href="https://github.com/RalfJung">@RalfJung</a>
        on 2017-02-11 18:30
    </div>

    <div class="timeline">
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/RalfJung">@RalfJung</a></div>
            <div class="timeline-body"><p>This implements what we discussed in <a href="https://github.com/BurntSushi/ripgrep/issues/129#issuecomment-276946474">https://github.com/BurntSushi/ripgrep/issues/129#issuecomment-276946474</a>.</p>
<p>One open question from my side: how bad is it that by always using <code>CountingReplacer</code>, we lose the optimization offered by returning something from <code>Replacer::no_expansion</code>? In principle, we could use <code>CountingReplacer</code> only if <code>max_columns</code> is <code>Some</code>, therefore only incurring a performance cost if <code>--max-columns</code> is set. Is that worth the additional effort?</p>
<p>TODO: Add some tests.</p>
<p>Fixes #129.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/app.rs</code>:462 on 2017-02-18 16:47</div>
            <div class="timeline-body"><p>We should try to keep a consistent style. One space after periods please. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:291 on 2017-02-18 16:50</div>
            <div class="timeline-body"><p>I think we should write code that is consistent with the style of the surrounding code. Could you please adhere to a 79 column limit (inclusive)? Thanks.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:295 on 2017-02-18 16:53</div>
            <div class="timeline-body"><p><code>if self.max_columns.map_or(false, |m| line.len() &gt; m)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:297 on 2017-02-18 16:55</div>
            <div class="timeline-body"><p>I don't think there should be a leading space here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:296 on 2017-02-18 16:55</div>
            <div class="timeline-body"><p>I think I would rather see this use the match color instead of the line number color.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:315 on 2017-02-18 16:56</div>
            <div class="timeline-body"><p><code>if self.max_columns.map_or(false, |m| buf.len() &gt; m)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:318 on 2017-02-18 16:57</div>
            <div class="timeline-body"><p>I don't think we need the leading space here.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:317 on 2017-02-18 16:57</div>
            <div class="timeline-body"><p>&quot;match&quot; color instead of &quot;line&quot; color.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:365 on 2017-02-18 16:58</div>
            <div class="timeline-body"><p><code>if self.max_columns.map_or(false, |m| end - start &gt; m)</code></p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Review comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on <code>src/printer.rs</code>:367 on 2017-02-18 16:58</div>
            <div class="timeline-body"><p>Drop leading space.</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header"><a href="https://github.com/BurntSushi">@BurntSushi</a> requested changes on 2017-02-18 17:00</div>
            <div class="timeline-body"><p>The overall approach looks OK, but I have several nits, and I do think tests are necessary before this can be merged.</p>
<p>I think something we need to think about are the likely features that will be requested as a result of this addition. I can imagine, for example, that some folks may not want to see the various &quot;ignored long line&quot; messages, might want to drop the long lines completely. We don't need to add that functionality in this PR, but if we did, how would it impact this feature?</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-02-18 17:01</div>
            <div class="timeline-body"><p>@RalfJung Thank you for working on this. :-)</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/BurntSushi">@BurntSushi</a> on 2017-03-13 01:11</div>
            <div class="timeline-body"><p>I'd like to push a new release out soon and you got this PR so close to completion that I picked it up in #406. Thanks so much!</p>
</div>
        </div>
        <div class="timeline-entry">
            <div class="event">Closed by @BurntSushi on 2017-03-13 01:11</div>
        </div>
        <div class="timeline-entry">
            <div class="timeline-header">Comment by <a href="https://github.com/RalfJung">@RalfJung</a> on 2017-03-13 08:54</div>
            <div class="timeline-body"><p>Ah, so sorry for not coming back to this earlier. Busy times. I was hoping to do something this week. Thanks for completing this!</p>
</div>
        </div>
    </div>

    <footer>
        Synced at 2026-01-12 18:27:48 UTC
    </footer>
</body>
</html>
